[{"tags": ["haskell", "uri"], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 0, "last_activity_date": 1432165014, "last_edit_date": 1432165014, "creation_date": 1432164487, "answer_id": 30362054, "question_id": 30361822, "link": "https://stackoverflow.com/questions/30361822/how-to-denote-a-static-haskell-uri-in-code-with-network-uri/30362054#30362054", "title": "How to denote a static Haskell URI in code with Network.URI?", "body": "<blockquote>\n  <p>Is it reasonable to write the following?</p>\n</blockquote>\n\n<p>No, don't pattern match with <code>Just</code> unless you are sure that your URI isn't malformed. A URI like this will give <code>Nothing</code> leading to runtime error:</p>\n\n<pre><code>\u03bb&gt; parseURI \"http:/\\\\/google.com/\"\nNothing\n</code></pre>\n\n<p>Instead, just represent the URI in <code>Maybe</code> type and do your computations on that using functions like <code>fmap</code> and others. One another way would be to check if it contains a valid URI using the function <code>isURI</code> or any of the other appropriate functions defined in <a href=\"https://hackage.haskell.org/package/network-uri-2.6.0.3/docs/Network-URI.html\" rel=\"nofollow\">Network.URI</a> and then handle the appropriate cases:</p>\n\n<pre><code>\u03bb&gt; isURI \"http:/\\\\/google.com/\"\nFalse\n\u03bb&gt; isURI \"http://google.com\"\nTrue\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 866, "user_id": 2872507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49ebde219395d677c399d8e950f5a48c?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Vieth", "link": "https://stackoverflow.com/users/2872507/alexander-vieth"}, "is_accepted": false, "score": 0, "last_activity_date": 1432166508, "creation_date": 1432166508, "answer_id": 30362357, "question_id": 30361822, "link": "https://stackoverflow.com/questions/30361822/how-to-denote-a-static-haskell-uri-in-code-with-network-uri/30362357#30362357", "title": "How to denote a static Haskell URI in code with Network.URI?", "body": "<p>I recommend using the <code>URI</code> and <code>URIAuth</code> constructors directly. You get a bit more text, but you also get a static guarantee that you really do have a <code>URI</code>. But this is what you want to avoid :)</p>\n\n<blockquote>\n  <p>I'd like to avoid the tedium of constructing the URI datatype directly\n  (which breaks apart the URI and makes it lose its conceptual meaning\n  somewhat).</p>\n</blockquote>\n\n<p>If you're really set on using string literals, then you could turn on <code>OverloadedStrings</code> and define an <code>IsString</code> instance for <code>Maybe URI</code> like so:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.String\nimport Network.URI\n\ninstance IsString (Maybe URI) where\n    isString = parseURI\n\nsomeUri :: Maybe URI\nsomeUri = \"http://google.ca\"\n</code></pre>\n\n<p>You cannot safely dump the <code>Maybe</code>; you'll just have to work with it.</p>\n"}, {"tags": [], "owner": {"reputation": 4614, "user_id": 1378868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a42920594ee2a0cc33012c407fd9d5?s=128&d=identicon&r=PG", "display_name": "snak", "link": "https://stackoverflow.com/users/1378868/snak"}, "is_accepted": false, "score": 6, "last_activity_date": 1432180715, "last_edit_date": 1432180715, "creation_date": 1432170698, "answer_id": 30362918, "question_id": 30361822, "link": "https://stackoverflow.com/questions/30361822/how-to-denote-a-static-haskell-uri-in-code-with-network-uri/30362918#30362918", "title": "How to denote a static Haskell URI in code with Network.URI?", "body": "<p>How about using Template Haskell to validate a static URL using <code>isURI</code> at compile time? It's safe to use <code>fromJust</code> at runtime now that the URL must be valid. </p>\n\n<p>For example, define <code>staticURI</code> like this.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nmodule URI where\n\nimport Data.Maybe (fromJust)\nimport Network.URI (URI, isURI, parseURI)\nimport Language.Haskell.TH (Q, TExp)\n\nstaticURI :: String -&gt; Q (TExp URI)\nstaticURI uri | isURI uri = [|| fromJust $ parseURI uri ||]\n              | otherwise = fail $ \"Invalid URI: \" ++ uri\n</code></pre>\n\n<p>Then, you can define your URL in other modules like this.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nimport Network.URI (URI)\nimport URI (staticURI)\n\nurl :: URI\nurl = $$(staticURI \"http://www.google.com/\")\n\nbadUrl :: URI\nbadUrl = $$(staticURI \"http://www.google.com/##\")\n</code></pre>\n\n<p>When you pass a malformed URL to <code>staticURI</code>, a compiler will emit an error.</p>\n\n<pre><code>Invalid URI: http://www.google.com/##\nIn the Template Haskell splice\n  $$(staticURI \"http://www.google.com/##\")\nIn the expression: $$(staticURI \"http://www.google.com/##\")\nIn an equation for \u2018url\u2019:\n    url = $$(staticURI \"http://www.google.com/##\")\n</code></pre>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "answer_count": 3, "score": 6, "last_activity_date": 1432180715, "creation_date": 1432163070, "question_id": 30361822, "link": "https://stackoverflow.com/questions/30361822/how-to-denote-a-static-haskell-uri-in-code-with-network-uri", "title": "How to denote a static Haskell URI in code with Network.URI?", "body": "<p>In the Haskell package <a href=\"https://hackage.haskell.org/package/network-uri\" rel=\"noreferrer\"><code>Network.URI</code></a> there is the <code>parseURI :: String -&gt; Maybe URI</code> function. </p>\n\n<p>I'd like to have a couple of static URIs in my code. Is it reasonable to write the following?</p>\n\n<pre><code>Just myURI = parseURI \"http://google.com/\"\n</code></pre>\n\n<p>The \"problem\" with this is that if the URI string is actually malformed, it is only caught at runtime with a pattern failed exception.</p>\n\n<p>I'd like to avoid the tedium of constructing the <code>URI</code> datatype directly (which breaks apart the URI and makes it lose its conceptual meaning somewhat). </p>\n\n<p>Is there a better way to have the static URI in code and be more \"safe\"?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 8, "last_activity_date": 1432154702, "last_edit_date": 1432154702, "creation_date": 1432146880, "answer_id": 30357771, "question_id": 30357722, "link": "https://stackoverflow.com/questions/30357722/a-little-confusion-with-the-sorted-function-in-haskell/30357771#30357771", "title": "A little confusion with the sorted function in Haskell", "body": "<p>If a function <code>pairs :: [a] -&gt; [(a, a)]</code> is defined somewhere, the expression</p>\n\n<pre><code>[x &lt;= y | (x,y) &lt;- pairs xs]\n</code></pre>\n\n<p>is a list of a booleans (that is, its type is <code>[Bool]</code>). <a href=\"http://haddocks.fpcomplete.com/fp/7.8/20140916-162/base/Prelude.html#v:and\" rel=\"nofollow\"><code>and</code></a> is a function whose type is <code>[Bool] -&gt; Bool</code>: It takes a list of booleans and it gives back <code>True</code> if all of the booleans in the list are <code>True</code> and <code>False</code> otherwise.</p>\n\n<p><code>and [x &lt;= y | (x,y) &lt;- pairs xs]</code> is a function application (<code>and</code> is being applied to the value created by the list comprehension).</p>\n\n<p>One thing to note is that Haskell doesn't have a lot of special keywords, comparatively. Many operations are represented by functions rather than by special syntax or keywords.</p>\n"}, {"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 1, "last_activity_date": 1432246056, "creation_date": 1432246056, "answer_id": 30385173, "question_id": 30357722, "link": "https://stackoverflow.com/questions/30357722/a-little-confusion-with-the-sorted-function-in-haskell/30385173#30385173", "title": "A little confusion with the sorted function in Haskell", "body": "<p><code>and</code> is not the function for taking the logical-and of two boolean values; that's <code>&amp;&amp;</code> (with type <code>Bool -&gt; Bool -&gt; Bool</code>).</p>\n\n<p>Instead <code>and</code> has type <code>[Bool] -&gt; Bool</code>; it condenses an arbitrary number of boolean values down to a single one by \"anding them all\".</p>\n"}], "owner": {"reputation": 536, "user_id": 4364070, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/70921bd2321275b2bbf42fa255aa82fe?s=128&d=identicon&r=PG&f=1", "display_name": "eyes enberg", "link": "https://stackoverflow.com/users/4364070/eyes-enberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 30357771, "answer_count": 2, "score": 1, "last_activity_date": 1432246056, "creation_date": 1432146720, "question_id": 30357722, "link": "https://stackoverflow.com/questions/30357722/a-little-confusion-with-the-sorted-function-in-haskell", "title": "A little confusion with the sorted function in Haskell", "body": "<pre><code>sorted :: Ord a =&gt; [a] -&gt; Bool\nsorted xs = and [x &lt;= y | (x,y) &lt;- pairs xs]\n</code></pre>\n\n<p>Can anyone explain to me what this random <code>and</code> is doing after <code>=</code>? It works when I compile it but it doesn't make logical sense to me. Is it because Haskell works recursively and it uses the <code>and</code> to compare the next item? </p>\n\n<p>Any insight is highly appreciated. </p>\n"}, {"tags": ["haskell", "ambiguous"], "answers": [{"comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1432151027, "post_id": 30357125, "comment_id": 48809629, "body": "Or using another name, like <code>concatenate</code>"}, {"owner": {"reputation": 73, "user_id": 4674301, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a1ba3ada110f4ea71ce8a7e9c3ba4c9?s=128&d=identicon&r=PG&f=1", "display_name": "TyKitsune", "link": "https://stackoverflow.com/users/4674301/tykitsune"}, "edited": false, "score": 0, "creation_date": 1432153119, "post_id": 30357125, "comment_id": 48810838, "body": "This is perfect! Thankyou so much :D I didnt realise you had to import something!"}, {"owner": {"reputation": 1190, "user_id": 1560890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DnL9W.jpg?s=128&g=1", "display_name": "kaz", "link": "https://stackoverflow.com/users/1560890/kaz"}, "edited": false, "score": 0, "creation_date": 1432153331, "post_id": 30357125, "comment_id": 48810955, "body": "Well - the problem is that you already were importing Prelude, you just didn&#39;t realize it :-)."}], "tags": [], "owner": {"reputation": 1190, "user_id": 1560890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DnL9W.jpg?s=128&g=1", "display_name": "kaz", "link": "https://stackoverflow.com/users/1560890/kaz"}, "is_accepted": true, "score": 8, "last_activity_date": 1432144829, "creation_date": 1432144829, "answer_id": 30357125, "question_id": 30356970, "link": "https://stackoverflow.com/questions/30356970/haskell-ambiguous-occurrence/30357125#30357125", "title": "Haskell - Ambiguous Occurrence", "body": "<p><code>concat</code> is already defined in prelude (which is imported by default).  If you want to use the same name, you can import it as qualified (meaning you have to use a specific reference to prelude for other functions:</p>\n\n<pre><code>import qualified Prelude as Prelude\n</code></pre>\n\n<p>Or not import concat:</p>\n\n<pre><code>import Prelude hiding (concat)\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 4674301, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1a1ba3ada110f4ea71ce8a7e9c3ba4c9?s=128&d=identicon&r=PG&f=1", "display_name": "TyKitsune", "link": "https://stackoverflow.com/users/4674301/tykitsune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 30357125, "answer_count": 1, "score": 1, "last_activity_date": 1548820657, "creation_date": 1432144319, "last_edit_date": 1548820657, "question_id": 30356970, "link": "https://stackoverflow.com/questions/30356970/haskell-ambiguous-occurrence", "title": "Haskell - Ambiguous Occurrence", "body": "<p>I am getting an Ambiguous Occurrence error. I am trying to teach myself haskell and whenever I try and write bits of code, I keep getting this error.</p>\n\n<p>The file name is \"concats.hs\"</p>\n\n<p>and this is the code</p>\n\n<pre><code>concat    :: [[a]] -&gt; [a]\nconcat xss = [x | xs &lt;- xss, x &lt;- xs]\n</code></pre>\n\n<p>Why this keeps happening?</p>\n"}, {"tags": ["haskell", "parallel-processing", "monads"], "answers": [{"comments": [{"owner": {"reputation": 1882, "user_id": 4374258, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh5.googleusercontent.com/-DeMaV4USpUE/AAAAAAAAAAI/AAAAAAAAB8Y/zZu_WWDxSNg/photo.jpg?sz=128", "display_name": "Sohail Si", "link": "https://stackoverflow.com/users/4374258/sohail-si"}, "edited": false, "score": 0, "creation_date": 1432144161, "post_id": 30356839, "comment_id": 48805682, "body": "Is there any way of combining the print monads (like <code>a+b+c</code> ) to make the combined one work with <code>Control.Parallel</code> ?"}, {"owner": {"reputation": 1521, "user_id": 365807, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8c9db2824164d60fe55d2b0c1c361f20?s=128&d=identicon&r=PG", "display_name": "Fraser", "link": "https://stackoverflow.com/users/365807/fraser"}, "reply_to_user": {"reputation": 1882, "user_id": 4374258, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh5.googleusercontent.com/-DeMaV4USpUE/AAAAAAAAAAI/AAAAAAAAB8Y/zZu_WWDxSNg/photo.jpg?sz=128", "display_name": "Sohail Si", "link": "https://stackoverflow.com/users/4374258/sohail-si"}, "edited": false, "score": 2, "creation_date": 1432144676, "post_id": 30356839, "comment_id": 48806012, "body": "no, because that&#39;s not what <code>Control.Parallel</code> is for (telling the compiler &quot;hey, if you can calculate both these results at the same time, work them out together because you&#39;ll get the full answer faster&quot;), <code>Async</code> is for saying &quot;do this at the same time as this other thing&quot;."}], "tags": [], "owner": {"reputation": 1521, "user_id": 365807, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8c9db2824164d60fe55d2b0c1c361f20?s=128&d=identicon&r=PG", "display_name": "Fraser", "link": "https://stackoverflow.com/users/365807/fraser"}, "is_accepted": false, "score": 6, "last_activity_date": 1432143964, "creation_date": 1432143964, "answer_id": 30356839, "question_id": 30356702, "link": "https://stackoverflow.com/questions/30356702/synchronising-parallel-processes-in-haskell/30356839#30356839", "title": "Synchronising parallel processes in Haskell", "body": "<p>Don't use <code>Control.Parallel</code> for running IO actions concurrently.</p>\n\n<p><a href=\"https://hackage.haskell.org/package/async-2.0.2/docs/Control-Concurrent-Async.html#v:mapConcurrently\"><code>Control.Concurrent.Async</code></a> should do what you want \u2013 <code>Control.Parallel</code> is used for hinting which pure operations can be evaluated simultaneously, not for running multiple actions (monadic or otherwise) at the same time.</p>\n"}, {"comments": [{"owner": {"reputation": 1882, "user_id": 4374258, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh5.googleusercontent.com/-DeMaV4USpUE/AAAAAAAAAAI/AAAAAAAAB8Y/zZu_WWDxSNg/photo.jpg?sz=128", "display_name": "Sohail Si", "link": "https://stackoverflow.com/users/4374258/sohail-si"}, "edited": false, "score": 0, "creation_date": 1461942502, "post_id": 30363878, "comment_id": 61442550, "body": "Thanks for the complete answer."}], "tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 1, "last_activity_date": 1432534962, "last_edit_date": 1432534962, "creation_date": 1432177699, "answer_id": 30363878, "question_id": 30356702, "link": "https://stackoverflow.com/questions/30356702/synchronising-parallel-processes-in-haskell/30363878#30363878", "title": "Synchronising parallel processes in Haskell", "body": "<p>In the C family of languages, there's a difference between these 2 lines</p>\n\n<pre><code>a = foobar; // This just sets a to be a function pointer to foobar\nb = foobar(); // This actually runs foobar and stores the result in `b`\n</code></pre>\n\n<p>Your code basically has the same problem as if you were writing C and forgot the <code>()</code> at the end of all your function calls. It assigns the function pointers <code>a</code> and <code>b</code> in parallel but doesn't actually call them.</p>\n\n<p>If you are writing pure functions in Haskell, you can add parallelism using <code>par</code>, but it doesn't work for <code>IO</code> because <code>IO a</code> is like a function pointer. Your code \"evaluates\" <code>a</code> and <code>b</code> in parallel but the result of that evaluation is still waiting for you to actually execute it.</p>\n\n<p>For code that lives in <code>IO</code>, you have to import <code>Control.Concurrent</code> and use the function <code>forkIO</code> to create the new thread. Then because the child threads all automatically die when the main thread finishes, you need some way of making the main thread wait (I'll use <code>MVar</code>s in the example because they're the simplest reliable way to do it)</p>\n\n<pre><code>import Control.Concurrent\nimport Control.Concurrent.MVar\n\nmain = do\n  -- MVars have a type parameter because you can also use them to send data\n  -- between threads, but in this example I'm basically just using them as locks\n  await &lt;- newEmptyMVar :: IO (MVar ())\n  bwait &lt;- newEmptyMVar :: IO (MVar ())\n  forkIO $ print (\"ack\",ack 3 10) &gt;&gt; putMVar await ()\n  forkIO $ print (\"fac\",fac 42) &gt;&gt; putMVar bwait ()\n  takeMVar await\n  takeMVar bwait\n</code></pre>\n"}], "owner": {"reputation": 1882, "user_id": 4374258, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh5.googleusercontent.com/-DeMaV4USpUE/AAAAAAAAAAI/AAAAAAAAB8Y/zZu_WWDxSNg/photo.jpg?sz=128", "display_name": "Sohail Si", "link": "https://stackoverflow.com/users/4374258/sohail-si"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1432534962, "creation_date": 1432143539, "question_id": 30356702, "link": "https://stackoverflow.com/questions/30356702/synchronising-parallel-processes-in-haskell", "title": "Synchronising parallel processes in Haskell", "body": "<p>In Haskell, how can I run multiple (monad?) functions (such as <code>print</code>) in parallel and see their output in the order of their finish time? I want three processes each one ending up in a print function.</p>\n\n<pre><code>import Control.Parallel\nmain = a `par` b `pseq` (a,b)\n    where\n        a = print(\"ack\",ack 3 10)\n        b = print(\"fac\",fac 42)\n</code></pre>\n\n<p>If I don't use <code>pseq</code>, it will show the last one specified in <code>par</code> combination. I want to make sure all processes are finished before the program ends. I tried this but it does not show the output of a,b:</p>\n\n<pre><code>...\nmain = a `par` b `pseq` print(\"done.\")\n...\n</code></pre>\n\n<p>Note: my program ends with the following lines:</p>\n\n<pre><code>fac 0 = 1\nfac n = n * fac (n-1)\nack 0 n = n+1\nack m 0 = ack (m-1) 1\nack m n = ack (m-1) (ack m (n-1))\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "yesod-forms"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1432157537, "post_id": 30356096, "comment_id": 48813249, "body": "Generic advice: google &quot;hs-boot&quot; files, or restructure your module hierarchy. If you want more specific advice, please give us a minimal but complete code sample that causes that error."}, {"owner": {"reputation": 14562, "user_id": 71116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e3643cd0195fab5a3bfa310b5ea27e7?s=128&d=identicon&r=PG", "display_name": "Michael Steele", "link": "https://stackoverflow.com/users/71116/michael-steele"}, "edited": false, "score": 0, "creation_date": 1432162272, "post_id": 30356096, "comment_id": 48814918, "body": "Assuming you&#39;re building off of the scafolding site, the <code>Handler</code> type alias is generated inside Foundation.hs from <code>mkYesodData</code>."}, {"owner": {"reputation": 716, "user_id": 4118267, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xIgkR.jpg?s=128&g=1", "display_name": "oriaj", "link": "https://stackoverflow.com/users/4118267/oriaj"}, "edited": false, "score": 0, "creation_date": 1432175988, "post_id": 30356096, "comment_id": 48818568, "body": "Hi thanks for their answers I add the code detail and the beginning to my foundation.hs, maybe someone have a example to a subSite different to the chat that have in a book"}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 4118267, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xIgkR.jpg?s=128&g=1", "display_name": "oriaj", "link": "https://stackoverflow.com/users/4118267/oriaj"}, "is_accepted": false, "score": 2, "last_activity_date": 1432241950, "creation_date": 1432241950, "answer_id": 30384214, "question_id": 30356096, "link": "https://stackoverflow.com/questions/30356096/use-aform-in-a-subsite-yesod/30384214#30384214", "title": "use AForm in a subsite Yesod", "body": "<p>When you are in a SubSite use <code>(HandlerT master IO)</code></p>\n"}], "owner": {"reputation": 716, "user_id": 4118267, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xIgkR.jpg?s=128&g=1", "display_name": "oriaj", "link": "https://stackoverflow.com/users/4118267/oriaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1432241950, "creation_date": 1432141552, "last_edit_date": 1432175674, "question_id": 30356096, "link": "https://stackoverflow.com/questions/30356096/use-aform-in-a-subsite-yesod", "title": "use AForm in a subsite Yesod", "body": "<p>I want create a subsite to all CRUD operation in my project, I have the following code</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances     #-}\n\nmodule Demo (\n   module Demo.Data,\n   module Demo\n   )where\n\nimport Data.Maybe   (Maybe)\n\n\nimport Demo.Data\nimport Yesod\nimport Prelude (IO,($))\n\nimport Model\nimport Crud.FormsC\n\n\ngetDemoNewR :: Yesod master =&gt; HandlerT YesodDemo (HandlerT master IO) Html\ngetDemoNewR = do \n           (widget, encoding) &lt;- generateFormPost $ renderBootstrap3 BootstrapBasicForm $ demoForm  Nothing\n           defaultLayout $ do                        \n                $(widgetFile \"Exam/createExam\") \n</code></pre>\n\n<p>but have this error  <code>Not in scope: type constructor or class \u2018Handler\u2019</code>   </p>\n\n<p>I can't import the Foundation  because generate a cycle reference because I have a import Demo in my Foundation.hs  </p>\n\n<pre><code>import Demo\nimport Demo.Data \n\ndata App = App\n{ appSettings    :: AppSettings\n, appStatic      :: Static -- ^ Settings for static file serving.\n, appConnPool    :: ConnectionPool -- ^ Database connection pool.\n, appHttpManager :: Manager\n, appLogger      :: Logger\n, getDemo        :: YesodDemo\n}\n</code></pre>\n\n<p>so what have import to use Handler o how I create a subSite?</p>\n"}, {"tags": ["haskell", "clay-css"], "answers": [{"comments": [{"owner": {"reputation": 11743, "user_id": 2597135, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9b8c6248f917c92724a033de96708542?s=128&d=identicon&r=PG", "display_name": "Uli K&#246;hler", "link": "https://stackoverflow.com/users/2597135/uli-k%c3%b6hler"}, "edited": false, "score": 0, "creation_date": 1432149714, "post_id": 30356696, "comment_id": 48808914, "body": "Thanks! I needed to add parentheses (possibly due to to operator precedence) but it works that way!"}], "tags": [], "owner": {"reputation": 1521, "user_id": 365807, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8c9db2824164d60fe55d2b0c1c361f20?s=128&d=identicon&r=PG", "display_name": "Fraser", "link": "https://stackoverflow.com/users/365807/fraser"}, "is_accepted": true, "score": 3, "last_activity_date": 1432152482, "last_edit_date": 1432152482, "creation_date": 1432143526, "answer_id": 30356696, "question_id": 30355910, "link": "https://stackoverflow.com/questions/30355910/adding-important-marker-to-clay-css-rules/30356696#30356696", "title": "Adding !important marker to Clay CSS rules", "body": "<p>You can use the <a href=\"https://hackage.haskell.org/package/clay-0.10.1/docs/Clay-Stylesheet.html#v:-45-:\" rel=\"nofollow\"><code>-:</code></a> operator to specify a custom value:</p>\n\n<pre><code>cssStyle :: Css\ncssStyle = body ? (\"padding-top\" -: \"60px !important\")\n</code></pre>\n"}], "owner": {"reputation": 11743, "user_id": 2597135, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/9b8c6248f917c92724a033de96708542?s=128&d=identicon&r=PG", "display_name": "Uli K&#246;hler", "link": "https://stackoverflow.com/users/2597135/uli-k%c3%b6hler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 30356696, "answer_count": 1, "score": 0, "last_activity_date": 1432152482, "creation_date": 1432140882, "question_id": 30355910, "link": "https://stackoverflow.com/questions/30355910/adding-important-marker-to-clay-css-rules", "title": "Adding !important marker to Clay CSS rules", "body": "<p>I'm using <a href=\"http://fvisser.nl/clay/\" rel=\"nofollow\">Clay</a> to generate CSS rules in Haskell.\nFor example:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>cssStyle :: Css\ncssStyle = body ? paddingTop (px 60)\n</code></pre>\n\n<p>generates this CSS:</p>\n\n<pre class=\"lang-css prettyprint-override\"><code>body {padding-top : 60px;}\n</code></pre>\n\n<p>How can I add an <code>!important</code> tag to this rule that yields</p>\n\n<pre><code>body {padding-top : 60px !important;}\n</code></pre>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 1794, "user_id": 2245304, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2eabe31c921bc9f27cd56f3d574a17a2?s=128&d=identicon&r=PG", "display_name": "AJJ", "link": "https://stackoverflow.com/users/2245304/ajj"}, "edited": false, "score": 0, "creation_date": 1432132868, "post_id": 30352789, "comment_id": 48798219, "body": "What about outputting f n over a range?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 1794, "user_id": 2245304, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2eabe31c921bc9f27cd56f3d574a17a2?s=128&d=identicon&r=PG", "display_name": "AJJ", "link": "https://stackoverflow.com/users/2245304/ajj"}, "edited": false, "score": 0, "creation_date": 1432134624, "post_id": 30352789, "comment_id": 48799612, "body": "I&#39;m not sure I understand that part of your question. Are you saying that <code>f</code> takes a number and returns a list of numbers?"}, {"owner": {"reputation": 1794, "user_id": 2245304, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2eabe31c921bc9f27cd56f3d574a17a2?s=128&d=identicon&r=PG", "display_name": "AJJ", "link": "https://stackoverflow.com/users/2245304/ajj"}, "edited": false, "score": 0, "creation_date": 1432135146, "post_id": 30352789, "comment_id": 48800016, "body": "What was wrong with the code I posted? Why does this work but not mine?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 1794, "user_id": 2245304, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2eabe31c921bc9f27cd56f3d574a17a2?s=128&d=identicon&r=PG", "display_name": "AJJ", "link": "https://stackoverflow.com/users/2245304/ajj"}, "edited": false, "score": 0, "creation_date": 1432135245, "post_id": 30352789, "comment_id": 48800091, "body": "<code>putStrLn</code> prints a <code>String</code>. Not a number or a list or anything else, only a <code>String</code>. You need some other function to convert it to a string first. <code>mapM_ print</code> would work (but wouldn&#39;t give you the formatting you&#39;re after here)."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 7, "last_activity_date": 1432135026, "last_edit_date": 1432135026, "creation_date": 1432132483, "answer_id": 30352789, "question_id": 30352733, "link": "https://stackoverflow.com/questions/30352733/outputting-a-list-in-haskell-without-the-brackets-and-over-a-range/30352789#30352789", "title": "Outputting a list in Haskell without the brackets, and over a range?", "body": "<p>You can do something like</p>\n\n<pre><code>list_to_string = unwords . map show\n</code></pre>\n\n<p>to get the output format you want. Then instead of doing</p>\n\n<pre><code>print [1, 2, 3, 4]\n</code></pre>\n\n<p>you can do</p>\n\n<pre><code>putStrLn $ list_to_string $ [1, 2, 3, 4]\n</code></pre>\n\n<p>which should display how you want.</p>\n\n<p><strong>Edit:</strong> As for printing a range, try this:</p>\n\n<pre><code>main = do\n  n &lt;- readLn :: IO Int\n  mapM_ (putStrLn . list_to_string) [ f i | i &lt;- [1..n] ]\n</code></pre>\n"}], "owner": {"reputation": 1794, "user_id": 2245304, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2eabe31c921bc9f27cd56f3d574a17a2?s=128&d=identicon&r=PG", "display_name": "AJJ", "link": "https://stackoverflow.com/users/2245304/ajj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1958, "favorite_count": 0, "accepted_answer_id": 30352789, "answer_count": 1, "score": 1, "last_activity_date": 1432135026, "creation_date": 1432132339, "last_edit_date": 1432134718, "question_id": 30352733, "link": "https://stackoverflow.com/questions/30352733/outputting-a-list-in-haskell-without-the-brackets-and-over-a-range", "title": "Outputting a list in Haskell without the brackets, and over a range?", "body": "<p>I have a function that returns a list, call it <code>f n</code>.</p>\n\n<p>If I print the list, it looks like <code>[1,2,3,4]</code> whereas I want it to look like <code>1 2 3 4</code>.</p>\n\n<p>Also I want to output many lists over a range of <code>n</code>, so <code>f 1</code> on the first line, <code>f 2</code> on the second line, ... <code>f n</code> on the nth line.</p>\n\n<p>I have my <code>f n</code> function working but cannot get the output to work for the life of me.</p>\n\n<p>Current attempt:</p>\n\n<pre><code>main = do\n    n &lt;- readLn :: IO Int\n    mapM_ putStrLn [f i | i &lt;- [1..n]]\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "bytestring"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1432127019, "post_id": 30349698, "comment_id": 48793434, "body": "My guess: You have two packages installed- one globally and one per-user."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432127036, "post_id": 30349698, "comment_id": 48793446, "body": "you should be able to manage those with the <code>ghc-pkg</code> helper - if all else fails you can always reset your installation :("}], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 2, "last_activity_date": 1432131040, "creation_date": 1432131040, "answer_id": 30352183, "question_id": 30349698, "link": "https://stackoverflow.com/questions/30349698/haskell-inbuilt-libraries-where-does-it-go/30352183#30352183", "title": "Haskell inbuilt libraries, where does it go?", "body": "<blockquote>\n  <p>Why does haskell store <code>bytestring</code> libraries in two different places. This is leading to compilation errors due to type/version mis-match.</p>\n</blockquote>\n\n<p>Well, no. The problem is that you have two versions of the <code>bytestring</code> library installed, period. It doesn't matter whether they are in the same package database or not.</p>\n\n<p>You should fix this with <code>ghc-pkg unregister bytestring-0.10.6.0</code> (first unregistering any packages that would break, if any) and then add a line</p>\n\n<pre><code>constraint: bytestring installed\n</code></pre>\n\n<p>to your <code>~/.cabal/config</code> to prevent it from happening again. You probably want to do the same with other packages that came with GHC, at least all the ones that are dependencies of the <code>ghc</code> package (see <code>ghc-pkg describe ghc</code>).</p>\n\n<p>I don't know if there is a way to tell cabal to never install a second version of <em>any</em> package. (In practice I find temporarily installing multiple versions of packages useful enough that I would find it more annoying than helpful.)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2879704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 30352183, "answer_count": 1, "score": 0, "last_activity_date": 1432131040, "creation_date": 1432124997, "last_edit_date": 1432126044, "question_id": 30349698, "link": "https://stackoverflow.com/questions/30349698/haskell-inbuilt-libraries-where-does-it-go", "title": "Haskell inbuilt libraries, where does it go?", "body": "<p>In my <code>/home/sk/.ghc/x86_64-linux-7.8.4/package.conf.d</code> folder, there is an entry for <code>bytestring</code> package as,</p>\n\n<pre><code>bytestring-0.10.6.0-7682cf7d45ee92d104399a67f3bce6ba.conf\n</code></pre>\n\n<p>In my <code>/opt/ghc/7.8.4/lib/ghc-7.8.4/package.conf.d</code> folder, there is an entry for bytestring as, </p>\n\n<pre><code>bytestring-0.10.4.0-d6f1d17d717e8652498cab8269a0acd5.conf\n</code></pre>\n\n<p>Why does haskell store <code>bytestring</code> libraries in two different places. This is leading to compilation errors due to type/version mis-match.</p>\n\n<p>How can i ensure, only one version of any library is stored and used at a time on my ubuntu 14.04 machine?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "edited": false, "score": 1, "creation_date": 1432107447, "post_id": 30342740, "comment_id": 48779671, "body": "Lists are immutable, right. But you can construct new ones from other lists."}, {"owner": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "edited": false, "score": 0, "creation_date": 1432107543, "post_id": 30342740, "comment_id": 48779748, "body": "Also, if first integer is always 1 why would you pass it? In your example it looks pretty pointless. You can start by defining function <code>switch :: Int -&gt; [Int] -&gt; [Int] -&gt; ([Int], [Int])</code> so you don&#39;t mess with sublists expansion in this function."}, {"owner": {"reputation": 319, "user_id": 4916010, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c1ccc8f19d83f83174b053fe436eba2?s=128&d=identicon&r=PG&f=1", "display_name": "Lerul Ler", "link": "https://stackoverflow.com/users/4916010/lerul-ler"}, "reply_to_user": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "edited": false, "score": 0, "creation_date": 1432108106, "post_id": 30342740, "comment_id": 48780084, "body": "@d12frosted I can switch the elements both ways, but I gave this example  hoping for a explanation and once I understand how it&#39;s done, I suppose it&#39;s quite easy for me to adjust the function so it works fine both ways"}], "answers": [{"tags": [], "owner": {"reputation": 300, "user_id": 4767807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/672d5954b219fc35f495dd3a97770b67?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/4767807/damien"}, "is_accepted": true, "score": 2, "last_activity_date": 1432108074, "creation_date": 1432108074, "answer_id": 30343401, "question_id": 30342740, "link": "https://stackoverflow.com/questions/30342740/how-to-switch-2-elements-in-a-list-in-haskell/30343401#30343401", "title": "How to switch 2 elements in a list in Haskell", "body": "<pre><code>switch i j l = [a,b]\n    where (a,b) = unzip [if j==n then (l!!1!!n, l!!0!!n) else (l!!0!!n,l!!1!!n) | n&lt;-[0..3]] \n</code></pre>\n\n<p>the first integer is useless</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1432109108, "creation_date": 1432109108, "answer_id": 30343745, "question_id": 30342740, "link": "https://stackoverflow.com/questions/30342740/how-to-switch-2-elements-in-a-list-in-haskell/30343745#30343745", "title": "How to switch 2 elements in a list in Haskell", "body": "<pre><code>switch _ n [xs,ys] = [xs',ys']\n   where (xs',ys',_) = unzip3 $ \n                       map (\\t@(x,y,m) -&gt; if m==n then (y,x,m) else t) $\n                       zip3 xs ys [0..]\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 4916010, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c1ccc8f19d83f83174b053fe436eba2?s=128&d=identicon&r=PG&f=1", "display_name": "Lerul Ler", "link": "https://stackoverflow.com/users/4916010/lerul-ler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 30343401, "answer_count": 2, "score": 2, "last_activity_date": 1432404356, "creation_date": 1432105970, "last_edit_date": 1432404356, "question_id": 30342740, "link": "https://stackoverflow.com/questions/30342740/how-to-switch-2-elements-in-a-list-in-haskell", "title": "How to switch 2 elements in a list in Haskell", "body": "<p>I will start with an example (I think it will show exactly my problem)</p>\n\n<pre><code>switch 1 2 [[1,2,3,4],[5,6,0,7]] -&gt; [[1,2,0,4],[5,6,3,7]]\n</code></pre>\n\n<p>Where [[1,2,3,4],[5,6,0,7]] !! 1 !! 2 is the zero element. The first integer is always 1 and the second one ranges between 0 and 3 and I want to change the element I give as parameter through his indexes (from the second component list) with the element from the same position in the first component list.</p>\n\n<p>I know the lists are immutable in Haskell, however I still can't figure it out.</p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["haskell", "concurrent-programming", "stm"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1432157883, "post_id": 30340159, "comment_id": 48813386, "body": "Re: &quot;what&#39;s the difference between -threaded and not?&quot;, you might like <a href=\"http://dmwit.com/gtk2hs\" rel=\"nofollow noreferrer\">my exposition on Haskell&#39;s threading model</a>. Ignore the gtk-specific bits."}], "answers": [{"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1432101554, "post_id": 30340326, "comment_id": 48776135, "body": "Is there any module/library that can simplify this <code>forkChild</code>/<code>waitForChildren</code> thing?"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 10, "last_activity_date": 1432096833, "last_edit_date": 1432096833, "creation_date": 1432096384, "answer_id": 30340326, "question_id": 30340159, "link": "https://stackoverflow.com/questions/30340159/haskell-channels-stm-threaded-message-passing/30340326#30340326", "title": "Haskell, Channels, STM, -threaded, Message Passing", "body": "<p>No your idea is right - this is kindof what <code>TChan</code>s are for - you just missed a minor point of <code>forkIO</code>:</p>\n\n<p>The problem is that your main thread will not wait for the termination of the threads created with <code>forkIO</code> (<a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Concurrent.html#g:12\">see here for reference</a>)</p>\n\n<p>so if I use the <em>hint</em> given in the reference:</p>\n\n<pre><code>import Control.Concurrent\nimport Control.Concurrent.STM\n\np :: Num a =&gt; TChan a -&gt; IO ()\np chan = do\n    atomically $ writeTChan chan 1\n    atomically $ writeTChan chan 2\n\nq chan = do\n    msg1 &lt;- atomically $ readTChan chan \n    msg2 &lt;- atomically $ readTChan chan\n    -- for testing purposes\n    putStrLn $ show msg1 \n    putStrLn $ show msg2\n\nmain :: IO ()\nmain = do\n    children &lt;- newMVar []\n    chan &lt;- atomically $ newTChan\n    _ &lt;- forkChild children $ p chan\n    _ &lt;- forkChild children $ q chan\n    waitForChildren children\n    return ()\n\nwaitForChildren :: MVar [MVar ()] -&gt; IO ()\nwaitForChildren children = do\n  cs &lt;- takeMVar children\n  case cs of\n    []   -&gt; return ()\n    m:ms -&gt; do\n      putMVar children ms\n      takeMVar m\n      waitForChildren children\n\nforkChild :: MVar [MVar ()] -&gt; IO () -&gt; IO ThreadId\nforkChild children io = do\n  mvar &lt;- newEmptyMVar\n  childs &lt;- takeMVar children\n  putMVar children (mvar:childs)\n  forkFinally io (\\_ -&gt; putMVar mvar ())\n</code></pre>\n\n<p>it works as expected:</p>\n\n<pre><code>d:/Temp $ ghc --make -threaded tchan.hs\n[1 of 1] Compiling Main             ( tchan.hs, tchan.o )\nLinking tchan.exe ...\nd:/Temp $ ./tchan.exe \n1\n2\nd:/Temp $\n</code></pre>\n\n<p>and of course it will continue to work if you switch the calls to <code>p</code> and <code>q</code> too</p>\n"}], "owner": {"reputation": 1905, "user_id": 1819861, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/d6a4df7c88cd6b6049278e30a88d3596?s=128&d=identicon&r=PG", "display_name": "Jonathan Gallagher", "link": "https://stackoverflow.com/users/1819861/jonathan-gallagher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 1, "accepted_answer_id": 30340326, "answer_count": 1, "score": 6, "last_activity_date": 1432096833, "creation_date": 1432095318, "question_id": 30340159, "link": "https://stackoverflow.com/questions/30340159/haskell-channels-stm-threaded-message-passing", "title": "Haskell, Channels, STM, -threaded, Message Passing", "body": "<p>I am trying to use channels/STM to implement message passing in Haskell.  Maybe this is a terrible idea, and there is a better way to implement/use message passing in Haskell.  If this is the case, do let me know; however, my quest has opened some basic questions on concurrent Haskell.</p>\n\n<p>I have heard great things about STM, and in particular the implementation in Haskell.  Since it supports reading to and writing from, and has some safety benefits, I figured one would start there.  This brings up my biggest question: does</p>\n\n<pre><code>msg &lt;- atomically $ readTChan chan\n</code></pre>\n\n<p>where chan is a TChan Int, cause a wait that waits for the channel to have a value on it?</p>\n\n<p>Consider the following program:</p>\n\n<pre><code>p chan = do\n    atomically $ writeTChan chan 1\n    atomically $ writeTChan chan 2\n\nq chan = do\n    msg1 &lt;- atomically $ readTChan chan \n    msg2 &lt;- atomically $ readTChan chan\n    -- for testing purposes\n    putStrLn $ show msg1 \n    putStrLn $ show msg2\n\nmain = do\n    chan &lt;- atomically $ newTChan\n    p chan\n    q chan\n</code></pre>\n\n<p>Compile this with ghc --make -threaded, and then run the program, and indeed you get 1 followed by 2 printed to console.  Now, suppose we do</p>\n\n<pre><code>main = do \n    chan &lt;- atomically $ newTChan\n    forkIO $ p chan \n    forkIO $ q chan\n</code></pre>\n\n<p>instead.  Now, if we use - threaded, it will either print nothing, 1, or 1 followed by 2 to the terminal; however, if you don't compile with -threaded it always prints 1 followed by 2.  Question 2: what is the difference between -threaded and not?  I imagine that they aren't really running as concurrent things, and they are just run one after the other.  This is consistent with what follows.</p>\n\n<p>Now, in my thinking if I had p and q running concurrently; i.e. I forkIO'd them, they should be able to run in the opposite order.  Supposing</p>\n\n<pre><code>main = do\n    chan &lt;- atomically newTChan\n    forkIO $ q chan\n    forkIO $ p chan\n</code></pre>\n\n<p>Now, if I compile this without -threaded, I never get anything printed to console.  If I compile with -threaded, I sometimes do.  Although, it is very rare to get 1 followed by 2 -- usually just 1 or nothing.  I tried this with Control.Concurrent.Chan as well, and got consistent results.</p>\n\n<p>Second big question: how do channels and fork play together, and what is going on in the above program?</p>\n\n<p>At any rate, it seems that I can't so naively simulate message passing with STM.  Perhaps Cloud Haskell is an option that solves these problems -- I really don't know.  Any information on how to get message passing going short of serialize ~~> write to socket ~~> read from socket ~~> deserialize would be hugely appreciated.</p>\n"}, {"tags": ["haskell", "sum"], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 4, "last_activity_date": 1432093781, "creation_date": 1432093781, "answer_id": 30339941, "question_id": 30339844, "link": "https://stackoverflow.com/questions/30339844/how-come-the-data-types-arent-passing-through-in-this-haskell-code/30339941#30339941", "title": "How come the data types aren&#39;t passing through in this Haskell code?", "body": "<p>Functions aren't called with parentheses and commas, unless you're pretending by using tuples.  Functions are called how they're declared, with only whitespace between arguments:</p>\n\n<pre><code>solve l r a b = [sumfunc l r a b]\n\nsumfunc l r a b = sum [0.0001 | x &lt;- [1000 * l .. 1000 * r]]\n</code></pre>\n\n<p>Function calling is very lightweight in Haskell.  This syntax also permits partial application and higher order functions very cleanly, which is what allows you to do something like</p>\n\n<pre><code>&gt; filter even [1, 2, 3, 4]\n[2, 4]\n</code></pre>\n\n<p>Where <code>even</code> is a function passed to the <code>filter</code> function.</p>\n\n<p>You can do something like</p>\n\n<pre><code>solve :: (Int, Int, [Int], [Int]) -&gt; [Double]\nsolve (l, r, a, b) = [sumfunc (l, r, a, b)]\n\nsumfunc :: (Int, Int, [Int], [Int]) -&gt; Double\nsumfunc (l, r, a, b) = sum ([0.001 | x &lt;- [1000*l..1000*r]])\n</code></pre>\n\n<p>But here <code>(l, r, a, b)</code> is a single value, a 4-tuple, it's passed as a single argument, not as 4 independent arguments.</p>\n"}], "owner": {"reputation": 45, "user_id": 4906860, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/708460742e20884bf71c7501f5b31989?s=128&d=identicon&r=PG&f=1", "display_name": "user4906860", "link": "https://stackoverflow.com/users/4906860/user4906860"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 30339941, "answer_count": 1, "score": 1, "last_activity_date": 1432093781, "creation_date": 1432092988, "last_edit_date": 1432093412, "question_id": 30339844, "link": "https://stackoverflow.com/questions/30339844/how-come-the-data-types-arent-passing-through-in-this-haskell-code", "title": "How come the data types aren&#39;t passing through in this Haskell code?", "body": "<p>Trying to learn Haskell.</p>\n\n<pre><code>solve :: Int -&gt; Int -&gt; [Int] -&gt; [Int] -&gt; [Double]\nsolve l r a b = [sumfunc(l,r,a,b)]\n\n\nsumfunc :: Int -&gt; Int -&gt; [Int] -&gt; [Int] -&gt; Double\nsumfunc l r a b = sum([0.001 | x &lt;- [1000*l..1000*r]])\n</code></pre>\n\n<p>Trying to return the contents of solve. l and r are integers, a and b are lists of integers. It's telling me \"Couldn't match expected type 'Double'\" as well as for type \"Int\". Not sure what I am doing wrong.</p>\n"}, {"tags": ["haskell", "yesod", "hamlet"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 1, "last_activity_date": 1432087343, "creation_date": 1432087343, "answer_id": 30339074, "question_id": 30338553, "link": "https://stackoverflow.com/questions/30338553/yesod-how-to-output-pretty-html/30339074#30339074", "title": "Yesod: how to output pretty html", "body": "<p>According to <a href=\"https://hackage.haskell.org/package/shakespeare-2.0.5/docs/Text-Hamlet.html#t:Html\" rel=\"nofollow\"><code>Text.Hamlet.Html</code>'s definition</a>, Hamlet uses <code>blaze-markup</code> for its output. <code>blaze-markup</code>, in turn, has a renderer backend with the promising name <a href=\"https://hackage.haskell.org/package/blaze-markup-0.7.0.2/docs/Text-Blaze-Renderer-Pretty.html\" rel=\"nofollow\"><code>Text.Blaze.Renderer.Pretty</code></a>. </p>\n\n<p>So I think what should work is if you run your Hamlet templates to get the final <code>Html</code>, and then render it yourself by calling <code>Text.Blaze.Renderer.Pretty.renderMarkup</code>.</p>\n"}], "owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1432087343, "creation_date": 1432083636, "last_edit_date": 1432084886, "question_id": 30338553, "link": "https://stackoverflow.com/questions/30338553/yesod-how-to-output-pretty-html", "title": "Yesod: how to output pretty html", "body": "<p>How do i print nice formatted html?</p>\n\n<p>I want something like <code>app.locals.pretty = true</code>.\n<a href=\"https://stackoverflow.com/questions/5276892/expressjs-how-to-output-pretty-html\">ExpressJS: how to output pretty html</a></p>\n"}, {"tags": ["haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1432068097, "post_id": 30335658, "comment_id": 48765980, "body": "<code>\\xs ys -&gt; sum [x*y | (x,y) &lt;- zip xs ys]</code>"}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 0, "creation_date": 1432071347, "post_id": 30335658, "comment_id": 48767469, "body": "Note that this is the <i>raison d&#39;&#234;tre</i> for <code>zipWith</code>; <code>zipWith (*) xs ys</code> does exactly what you want."}, {"owner": {"reputation": 233, "user_id": 4903882, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2017ad4fa91f176ed36fbd1f96d603e0?s=128&d=identicon&r=PG&f=1", "display_name": "brzepkowski", "link": "https://stackoverflow.com/users/4903882/brzepkowski"}, "edited": false, "score": 0, "creation_date": 1432071689, "post_id": 30335658, "comment_id": 48767628, "body": "I did it befor using <code>zipWith</code>, but I wanted to know how it can be done using <code>list comprehension</code> :)"}], "answers": [{"comments": [{"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 0, "creation_date": 1432071421, "post_id": 30335726, "comment_id": 48767514, "body": "If someone else has this problem and sees this answer: one key take-home point here is that you can pattern-match on the left hand side of a <code>&lt;-</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 8, "last_activity_date": 1432068090, "creation_date": 1432068090, "answer_id": 30335726, "question_id": 30335658, "link": "https://stackoverflow.com/questions/30335658/how-to-multiply-two-elements-of-each-pair-from-list-of-pairs-haskell/30335726#30335726", "title": "How to multiply two elements of each pair from list of pairs - Haskell", "body": "<p>As a rule of thumb, you should have one <code>&lt;-</code> for each nested iteration. Since you only want to iterate over one list -- namely, <code>zip xs ys</code> -- there should be only one <code>&lt;-</code>. Thus:</p>\n\n<pre><code>scalarproduct xs ys = sum [x*y | (x,y) &lt;- zip xs ys]\n</code></pre>\n\n<p>You may also like the <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Prelude.html#v:zipWith\" rel=\"noreferrer\"><code>zipWith</code></a> function:</p>\n\n<pre><code>scalarproduct xs ys = sum (zipWith (*) xs ys)\nscalarproduct = (sum .) . zipWith (*) -- may be readable, depending on your bent\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 3, "last_activity_date": 1432078268, "creation_date": 1432078268, "answer_id": 30337864, "question_id": 30335658, "link": "https://stackoverflow.com/questions/30335658/how-to-multiply-two-elements-of-each-pair-from-list-of-pairs-haskell/30337864#30337864", "title": "How to multiply two elements of each pair from list of pairs - Haskell", "body": "<blockquote>\n  <p>I want to do this using list comprehension. [...]</p>\n</blockquote>\n\n<p>My advice is: don't!  List comprehensions are a tool, and if they're not helping you, then use a different tool.</p>\n\n<p>Simple solution:</p>\n\n<pre><code>product :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\nproduct xs ys = zipWith (*) xs ys\n</code></pre>\n"}], "owner": {"reputation": 233, "user_id": 4903882, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/2017ad4fa91f176ed36fbd1f96d603e0?s=128&d=identicon&r=PG&f=1", "display_name": "brzepkowski", "link": "https://stackoverflow.com/users/4903882/brzepkowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1213, "favorite_count": 1, "accepted_answer_id": 30335726, "answer_count": 2, "score": 2, "last_activity_date": 1432078268, "creation_date": 1432067800, "last_edit_date": 1432068168, "question_id": 30335658, "link": "https://stackoverflow.com/questions/30335658/how-to-multiply-two-elements-of-each-pair-from-list-of-pairs-haskell", "title": "How to multiply two elements of each pair from list of pairs - Haskell", "body": "<p>I want to make function which returns list of multiplied elements from each pair from list of pairs. For example:</p>\n\n<pre><code>&gt;product [1,2] [3,4]\n[3,8]\n</code></pre>\n\n<p>I want to do this using <code>list comprehension</code>. I tried something like this:</p>\n\n<pre><code>product :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\nproduct xs ys = [x*y | z&lt;-zip xs ys, (x, _)&lt;-z, (_, y)&lt;-z]\n</code></pre>\n\n<p>but it's not working. What should be changed?</p>\n"}, {"tags": ["string", "list", "haskell", "recursion", "character"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1432058734, "post_id": 30332783, "comment_id": 48760566, "body": "Am I right that this is for your homework? Because it seems that two of your fellow students might have asked for almost the same in the last few days ;) (and they two just registered here)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432058917, "post_id": 30332783, "comment_id": 48760695, "body": "btw: it will be <code>undefined</code> for 4 because you told your function to be this with your very first case - also I give you the same hint as your fellow students: instead of dropping the <code>x</code> you might want to put it somewhere where further calls <code>repeat2&#39;</code>might find it yet again ... further hint: you can use <code>x : ...</code> to prepend <code>x</code> to a list ... maybe you know something that can append it instead ..."}, {"owner": {"reputation": 33, "user_id": 4917364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60ae7ef17b5b6171893c47b5a790b9d3?s=128&d=identicon&r=PG&f=1", "display_name": "hello", "link": "https://stackoverflow.com/users/4917364/hello"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432086699, "post_id": 30332783, "comment_id": 48771811, "body": "Yeah it is haha except im not asking for an answer; just ideas and suggestions; Also im not quite getting what you are saying by &quot;put it somewhere for further calls&quot;..im pretty new to this language and not sure how you would do that.. im stll not sure how to pass the string to start from the head!"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432095311, "post_id": 30332783, "comment_id": 48773939, "body": "well at least one of the other was saying as much from the start (you see: usually we handle homework questions a bit different - as Luqui did) - for your question, I gave you another hint (but you should read the first maybe again): your problems with <code>&quot;hey&quot; 4</code> start when there is <code>&quot;&quot; 1</code> left - wouldn&#39;t it be nice if it where <code>&quot;h&quot; 1&quot;</code> or even <code>&quot;hey&quot; 1</code> instead? (also see luqui&#39;s hint) - not looking at performance you can get to this if you will end up with <code>&quot;eyh&quot; 3</code> for your second recursive call - now how can you get the <code>h</code> from the start to the end of the list?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 4917364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60ae7ef17b5b6171893c47b5a790b9d3?s=128&d=identicon&r=PG&f=1", "display_name": "hello", "link": "https://stackoverflow.com/users/4917364/hello"}, "edited": false, "score": 0, "creation_date": 1432086863, "post_id": 30333781, "comment_id": 48771841, "body": "Oh okay I see how its going; but yeah, i am stuck with passing the string again to go through the list... I&#39;ve tried to do &quot; (k /= 0) = x: repeat2&#39; x:xs (k-1)\t &quot; where if there is an empty list with &quot;k&quot; that still has more character to go through, pass the string again to start from the head again except it still doesnt work..I just cant think of other way around..any more hint?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432095435, "post_id": 30333781, "comment_id": 48773972, "body": "the easiest way you can pass the string again (or remember it) if you extend your function by one more parameter like: <code>repeat list (x:xs) k = ...</code> instead and then start your with <code>repeat &quot;hey&quot; &quot;hey&quot; 4</code>"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 0, "last_activity_date": 1432061367, "creation_date": 1432061367, "answer_id": 30333781, "question_id": 30332783, "link": "https://stackoverflow.com/questions/30332783/haskell-recursion-with-list-of-characters/30333781#30333781", "title": "Haskell recursion with list of characters", "body": "<p>Let me label the equations to refer to them later.</p>\n\n<pre><code>   repeat2' :: [Char] -&gt; Int -&gt; [Char]\n1) repeat2' [] _ = undefined\n2) repeat2' (x:xs) 1 = [x]\n   repeat2' (x:xs) k\n3)     | (k &gt; 0) = x: repeat2' xs(k-1)\n</code></pre>\n\n<p>Let's trace the reduction of <code>repeat2' \"hey\" 4</code>.  First I will desugar the string into a list</p>\n\n<pre><code>repeat2' ['h', 'e', 'y'] 4\n</code></pre>\n\n<p>then the list into its cons cells</p>\n\n<pre><code>repeat2' ('h':'e':'y':[]) 4\n</code></pre>\n\n<p>Now we can begin</p>\n\n<pre><code>repeat2' ('h':'e':'y':[]) 4\n-- equation 3 applies, x = 'h', xs = 'e':'y':[], k = 4\n'h' : repeat2' ('e':'y':[]) 3\n-- the first element of the result is known now, so it is printed by the repl\n-- equation 3 applies ot the remainder\n'h' : 'e' : repeat2' ('y':[]) 2\n-- e is now known and printed\n-- equation 3 applies\n'h' : 'e' : 'y' : repeat2' [] 1 \n-- y is known and printed\n-- equation 1 applies\n'h' : 'e' : 'y' : undefined\n-- the repl errors out because of undefined\n</code></pre>\n\n<p>Thus explaining the output</p>\n\n<pre><code>\"hey***Exception: Prelude.undefined\n</code></pre>\n\n<p>I hope this helps you understand.</p>\n\n<p>One problem is that in order to cycle the list, you need to keep it around for recursive calls.  Note that by the time we have printed h, e, y the information to use next is no longer there.  You need to pass the list along untouched in addition to the one you are traversing.</p>\n"}], "owner": {"reputation": 33, "user_id": 4917364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60ae7ef17b5b6171893c47b5a790b9d3?s=128&d=identicon&r=PG&f=1", "display_name": "hello", "link": "https://stackoverflow.com/users/4917364/hello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 727, "favorite_count": 0, "accepted_answer_id": 30333781, "answer_count": 1, "score": 1, "last_activity_date": 1432061367, "creation_date": 1432058059, "question_id": 30332783, "link": "https://stackoverflow.com/questions/30332783/haskell-recursion-with-list-of-characters", "title": "Haskell recursion with list of characters", "body": "<p>I am studying Haskell and something came up where I am stuck on for few days.. so I am basically trying to recurse through the list of character (String) and once it reaches the end of the string, is there a way for me to recurse through the list from the head again?  </p>\n\n<p>Here is the code that works for recursing through the string once.</p>\n\n<pre><code>repeat2' :: [Char] -&gt; Int -&gt; [Char]\nrepeat2' [] _ = undefined\nrepeat2' (x:xs) 1 = [x]\nrepeat2' (x:xs) k\n    | (k &gt; 0) = x: repeat2' xs(k-1)\n</code></pre>\n\n<p>It works for </p>\n\n<p>repeat2' \"hey\" 1 = \"h\"</p>\n\n<p>repeat2' \"hey\" 2 = \"he\"</p>\n\n<p>repeat2' \"hey\" 3 = \"hey\"</p>\n\n<p>but once I try </p>\n\n<p>repeat2' \"hey\" 4 = \"hey*** Exception: Prelude.undefined\"</p>\n\n<p>As it is going to \" repeat2' [] _ = undefined\"; </p>\n\n<p>But I want it to print</p>\n\n<p>repeat2' \"hey\" 4 = \"heyh\"</p>\n\n<p>..So how I do i go back to the head of the string?</p>\n\n<p>Thanks for helping!</p>\n"}, {"tags": ["haskell", "pattern-matching", "polymorphic-functions"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1432061083, "post_id": 30332723, "comment_id": 48761934, "body": "<code>Data.Typeable</code> allows to query types at run-time, but it shouldn&#39;t be used lightly."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1432060730, "post_id": 30333292, "comment_id": 48761754, "body": "You also need <code>OverlappingInstances</code> to actually use that class -- I find this extension particularly tricky and hard to fully grasp. E.g. <a href=\"http://stackoverflow.com/questions/29504107/which-dictionary-does-ghc-choose-when-more-than-one-is-in-scope\" title=\"which dictionary does ghc choose when more than one is in scope\">stackoverflow.com/questions/29504107/&hellip;</a>"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432061250, "post_id": 30333292, "comment_id": 48762045, "body": "@chi Thanks for bringing that up! For a moment I thought it wasn&#39;t necessary because <code>choice &#39;a&#39;</code> worked without it (even though I originally thought it would be). It isn&#39;t possible to use the other two instances without it though. I find that extension hard to understand too and I definitely think it adds additional complexity that should be avoided if possible. I updated my answer to mention it."}, {"owner": {"reputation": 1969, "user_id": 3041008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cqLI9.png?s=128&g=1", "display_name": "mucaho", "link": "https://stackoverflow.com/users/3041008/mucaho"}, "edited": false, "score": 0, "creation_date": 1432067004, "post_id": 30333292, "comment_id": 48765374, "body": "Thanks for the valuable information. So you are suggesting stick to data constructors if possible, right?"}, {"owner": {"reputation": 1969, "user_id": 3041008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cqLI9.png?s=128&g=1", "display_name": "mucaho", "link": "https://stackoverflow.com/users/3041008/mucaho"}, "edited": false, "score": 0, "creation_date": 1432068712, "post_id": 30333292, "comment_id": 48766277, "body": "Regarding <code>OverlappingInstances</code> - take a look at the <a href=\"https://ghc.haskell.org/trac/ghc/wiki/SafeHaskell#RestrictedandDisabledGHCHaskellFeatures\" rel=\"nofollow noreferrer\"><code>Safe</code> GHC extension</a> - it  restricts those (all?) cases where more specialized typeclass instances in a referring module could lead to run-time errors"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 1969, "user_id": 3041008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cqLI9.png?s=128&g=1", "display_name": "mucaho", "link": "https://stackoverflow.com/users/3041008/mucaho"}, "edited": false, "score": 1, "creation_date": 1432072863, "post_id": 30333292, "comment_id": 48768131, "body": "@mucaho That has to do with interactions between modules and which instances can be exported by a module. That is interesting, I didn&#39;t think there was any case where you could prevent an instance from being exported. That&#39;s probably the only time that you can prevent it. Also, yeah, I would definitely suggest sticking to data constructors. Type classes are almost exclusively for when you have an <i>very</i> general interface that will likely be able to be expanded with new instances by other people. Good examples include <code>Monoid</code> and <code>Functor</code>."}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": false, "score": 5, "last_activity_date": 1432061202, "last_edit_date": 1432061202, "creation_date": 1432059808, "answer_id": 30333292, "question_id": 30332723, "link": "https://stackoverflow.com/questions/30332723/pattern-match-on-type-of-polymorphic-parameter-alternatives/30333292#30333292", "title": "Pattern match on type of polymorphic parameter - alternatives", "body": "<p>This is confusing two different kinds of polymorphism. What you want is <i>ad-hoc polymorphism</i>, which is done through type classes. The kind of polymorphism of a function of type <code>a -&gt; Int</code> is <i>parametric polymorphism</i>. With parametric polymorphism, one function definition for <code>choice</code> must work for <em>any</em> possible type <code>a</code>. In this case, this means it can't actually use the value of type <code>a</code> since it doesn't know anything about it, so <code>choice</code> would have to be a constant function such as <code>choice _ = 3</code>. This actually gives you very strong guarantees about what a function can do, just by looking it its type (this property is called <i>parametricity</i>).</p>\n\n<p>With a type class, you can implement your example as:</p>\n\n<pre><code>class ChoiceClass a where\n  choice :: a -&gt; Int\n\ninstance ChoiceClass Int where\n  choice _ = 0\n\ninstance ChoiceClass String where\n  choice _ = 1\n\ninstance ChoiceClass a where\n  choice _ = 2\n</code></pre>\n\n<p>Now, I should point out that this type class approach is often the wrong one especially when someone who is just starting wants to use it. You <em>definitely</em> don't want to do it to avoid a simple type like the <code>Choice</code> type in your question. It can add lots of complexity and instance resolution can be confusing at first. Note that in order to get the type class solution to work, two extensions needed to be turned on: <code>FlexibleInstances</code> and <code>TypeSynonymInstances</code> since <code>String</code> is a synonym for <code>[Char]</code>. <code>OverlappingInstances</code> is also needed because type classes work on an \"open world\" assumption (meaning that anyone can later come along and add a instance for a new type, and this must be taken into account). This is not <em>necessarily</em> a bad thing, but here it is a sign of the creeping complexity caused by using the type class solution over the much simpler data type solution. <code>OverlappingInstances</code> in particular can make things harder to think about and work with.</p>\n"}, {"comments": [{"owner": {"reputation": 1969, "user_id": 3041008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cqLI9.png?s=128&g=1", "display_name": "mucaho", "link": "https://stackoverflow.com/users/3041008/mucaho"}, "edited": false, "score": 0, "creation_date": 1432067549, "post_id": 30333777, "comment_id": 48765666, "body": "Thank you for clarifying the alternatives. <i>&quot;it&#39;s impossible to distinguish a value of type Int from a value whose type is a newtype of Int: those types have identical runtime representations&quot;</i> - isn&#39;t that what <code>TypeSynonymInstances</code> is for? (mentioned in <a href=\"http://stackoverflow.com/a/30333292/3041008\">david&#39;s answer</a>). Would you be so kind and provide a definition for the <code>choice</code> function using the <code>Typeable</code> type class?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 1969, "user_id": 3041008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cqLI9.png?s=128&g=1", "display_name": "mucaho", "link": "https://stackoverflow.com/users/3041008/mucaho"}, "edited": false, "score": 3, "creation_date": 1432072423, "post_id": 30333777, "comment_id": 48767936, "body": "@mucaho <code>TypeSynonymInstances</code> is specifically for type class instances. In particular, it lets you make an instance for a type synonym. A type synonym is a type that is treated the same as another type by the type system (in this case, <code>type String = [Char]</code>). Even with that extension and <code>OverlappingInstances</code>, you can&#39;t make an instance of both <code>String</code> and <code>[Char]</code> though, since they are synonymous. <code>newtype</code>s, on the other hand, <i>are</i> treated as different types by the type system but they have the exact same runtime representation."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 4, "last_activity_date": 1432090581, "last_edit_date": 1432090581, "creation_date": 1432061352, "answer_id": 30333777, "question_id": 30332723, "link": "https://stackoverflow.com/questions/30332723/pattern-match-on-type-of-polymorphic-parameter-alternatives/30333777#30333777", "title": "Pattern match on type of polymorphic parameter - alternatives", "body": "<blockquote>\n  <p>Question: Do you know of a way to circumvent this? Is there a feature in Haskell2010, GHC or any of the extensions that allows me to use the first variant (or something similar)?</p>\n</blockquote>\n\n<p>No, there is no feature either in Haskell 2010 or provided by any GHC extension that lets you write a function of type</p>\n\n<pre><code>choice :: a -&gt; Int\n</code></pre>\n\n<p>whose return value depends on the type of its argument. You can count on such a feature never existing in the future either.</p>\n\n<p>Even with hacks to inspect GHC's internal data representation at runtime, it's impossible to distinguish a value of type <code>Int</code> from a value whose type is a newtype of <code>Int</code>: those types have identical runtime representations.</p>\n\n<p>The <code>Int</code> returned by your function is a value that exists at runtime, so it needs to be determined by another value that exists at runtime. That could be either</p>\n\n<ol>\n<li><p>an ordinary value, like in your <code>data Choice a = IntChoice Int | StringChoice String | OtherChoice a; choice :: Choice a -&gt; Int</code> example, or</p></li>\n<li><p>a type class dictionary, using either a custom class as in David Young's answer, or the built-in <code>Typeable</code> class:</p>\n\n<pre><code>choice :: Typeable a =&gt; a -&gt; Int\nchoice a\n  | typeOf a == typeOf (undefined :: Int)    = 0\n  | typeOf a == typeOf (undefined :: String) = 1\n  | otherwise                                = 2\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 1969, "user_id": 3041008, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cqLI9.png?s=128&g=1", "display_name": "mucaho", "link": "https://stackoverflow.com/users/3041008/mucaho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 2, "accepted_answer_id": 30333777, "answer_count": 2, "score": 2, "last_activity_date": 1432090581, "creation_date": 1432057849, "last_edit_date": 1432067690, "question_id": 30332723, "link": "https://stackoverflow.com/questions/30332723/pattern-match-on-type-of-polymorphic-parameter-alternatives", "title": "Pattern match on type of polymorphic parameter - alternatives", "body": "<p>Let's say I need different output depending on the type of the polymorphic parameter of a function. My initial attempt fails with some cryptic error message:</p>\n\n<pre><code>choice :: a -&gt; Int\nchoice (_ :: Int) = 0\nchoice (_ :: String) = 1\nchoice _ = 2\n</code></pre>\n\n<p>However, we can fix that easily by wrapping the desired types in different data constructors and use those in pattern-matching:</p>\n\n<pre><code>data Choice a = IntChoice Int | StringChoice String | OtherChoice a\n\nchoice :: Choice a -&gt; Int\nchoice (IntChoice _) = 0\nchoice (StringChoice _) = 1\nchoice (OtherChoice _) = 2\n</code></pre>\n\n<p><strong>Question:</strong> Do you know of a way to circumvent this? Is there a feature in Haskell2010, GHC or any of the extensions that allows me to use the first variant (or something similar)?</p>\n"}, {"tags": ["haskell", "bytestring"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 1777520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62005e612ebb105e9a29d28baf117e72?s=128&d=identicon&r=PG", "display_name": "jchmrt", "link": "https://stackoverflow.com/users/1777520/jchmrt"}, "edited": false, "score": 0, "creation_date": 1432055543, "post_id": 30331222, "comment_id": 48758617, "body": "Thanks a lot for your answer! I hadn&#39;t thought of it being a problem with acid-state."}], "tags": [], "owner": {"reputation": 23816, "user_id": 572606, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c20a126ad0dce40e8fc4a43456107919?s=128&d=identicon&r=PG", "display_name": "shang", "link": "https://stackoverflow.com/users/572606/shang"}, "is_accepted": true, "score": 0, "last_activity_date": 1432052970, "creation_date": 1432052970, "answer_id": 30331222, "question_id": 30330550, "link": "https://stackoverflow.com/questions/30330550/safecopy-migrating-from-string-to-bytestring/30331222#30331222", "title": "Safecopy migrating from string to bytestring", "body": "<p>It's because of <code>acid-state</code>. You've changed the types of <code>getT</code> and <code>setT</code> between the implementations which messes up the transaction log. You essentially cannot change any functions you've tagged with <code>makeAcidic</code> without first clearing the transaction log with <a href=\"http://hackage.haskell.org/package/acid-state-0.12.4/docs/Data-Acid.html#v:createCheckpoint\" rel=\"nofollow\"><code>createCheckpoint</code></a> (using the older version of the codebase). </p>\n"}], "owner": {"reputation": 33, "user_id": 1777520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62005e612ebb105e9a29d28baf117e72?s=128&d=identicon&r=PG", "display_name": "jchmrt", "link": "https://stackoverflow.com/users/1777520/jchmrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 30331222, "answer_count": 1, "score": 3, "last_activity_date": 1432052970, "creation_date": 1432051121, "question_id": 30330550, "link": "https://stackoverflow.com/questions/30330550/safecopy-migrating-from-string-to-bytestring", "title": "Safecopy migrating from string to bytestring", "body": "<p>I am trying to use the <a href=\"https://hackage.haskell.org/package/safecopy\" rel=\"nofollow\">safecopy</a> haskell library, but when I try to migrate a string to a bytestring, the last 4 characters are lost and 4 '\\NULL' characters get prepended to the string:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell, DeriveDataTypeable, TypeFamilies #-}\nimport Data.SafeCopy\nimport Data.Acid\nimport Data.Typeable\nimport Control.Monad.State.Class\nimport Control.Monad.Reader.Class\n\ndata T = T { str :: String }\n         deriving (Show, Typeable)\n\ngetT :: Query T String\ngetT = fmap str ask\n\nsetT :: String -&gt; Update T ()\nsetT str = put $ T str\n\nderiveSafeCopy 0 'base  ''T\n\nmakeAcidic ''T ['setT, 'getT]\n\nmain :: IO ()\nmain = do\n  state &lt;- openLocalState (T \"string set with default\")\n  update state (SetT \"string set with SetT\")\n  str &lt;- query state GetT\n  putStrLn str\n</code></pre>\n\n<p>This outputs: <code>string set with SetT</code>, but when you run the following modificated version after that:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell, DeriveDataTypeable, TypeFamilies #-}\nimport Data.SafeCopy\nimport Data.Acid\nimport Data.Typeable\nimport Control.Monad.State.Class\nimport Control.Monad.Reader.Class\nimport Data.ByteString.Char8 as B\n\ndata T_v0 = T_v0 String\n         deriving (Show, Typeable)\nderiveSafeCopy 0 'base  ''T_v0\n\ndata T = T { str :: B.ByteString }\n         deriving (Show, Typeable)\nderiveSafeCopy 1 'extension ''T\n\ninstance Migrate T where\n  type MigrateFrom T = T_v0\n  migrate (T_v0 str) = T $ B.pack str\n\ngetT :: Query T B.ByteString\ngetT = fmap str ask\n\nsetT :: B.ByteString -&gt; Update T ()\nsetT str = put $ T str\nmakeAcidic ''T ['setT, 'getT]\n\nmain :: IO ()\nmain = do\n  state &lt;- openLocalState (T $ B.pack \"bytestring set with default\")\n  str &lt;- query state GetT\n  print str\n</code></pre>\n\n<p>it outputs: <code>\"\\NUL\\NUL\\NUL\\NULstring set with \"</code>. I have no idea why this is happening. Am I doing something wrong in the migration step? I have tried to stay as close as possible to the <a href=\"https://hackage.haskell.org/package/safecopy-0.8.5/docs/Data-SafeCopy.html\" rel=\"nofollow\">example code</a>. Does anyone know why this is happening?</p>\n\n<p>P.S: Sorry for the big amount of code, but I couldn't think of any better way to convey the problem.</p>\n"}, {"tags": ["haskell", "data-structures", "f#"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432050383, "post_id": 30330110, "comment_id": 48755296, "body": "are you hinting at <a href=\"http://patrickthomson.ghost.io/an-introduction-to-recursion-schemes/\" rel=\"nofollow noreferrer\">recursion schemes</a> or something?"}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432050673, "post_id": 30330110, "comment_id": 48755488, "body": "@CarstenK&#246;nig I have only read the title of that paper, I had no idea it could be the answer to this question, but it would make sense, since I&#39;m indeed trying to restructure an App to be more reactive using f# and reactive extensions. Let me check it out. Thanks a lot."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432050845, "post_id": 30330110, "comment_id": 48755608, "body": "well the thing is there will be some recursive definition finally and it kind of depends on what you see as the defining property of a list - for example you could equate a list with a <code>fold</code>ing-operation and it will have no recursion in it&#39;s data-structure (it will just be a function) but it will most likely have it in it&#39;s evaluation - or you could see it as a big array with a length, or ..."}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432051005, "post_id": 30330110, "comment_id": 48755723, "body": "@CarstenK&#246;nig Yeah, we all want the execution to appear recursive, but not the data structures that we use, is that what you tried to say?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432051697, "post_id": 30330110, "comment_id": 48756258, "body": "no - the question is just hard to answer if you don&#39;t say exactly what a list should be"}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432052170, "post_id": 30330110, "comment_id": 48756567, "body": "I&#39;m reading the paper, perhaps I meant &quot;call-tree&quot; instead of &quot;execution&quot;. Or I might be trying to hard to connect the ideas, I&#39;ll keep reading."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1432052400, "post_id": 30330110, "comment_id": 48756735, "body": "If your currently not 100% sure what your actual question is, it might be a better idea to close (not delete) this question for a while. It could reopened later."}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1432053860, "post_id": 30330110, "comment_id": 48757667, "body": "@Zeta, I&#39;m sure about my question, the answer could be as simple as yes or no. What I&#39;m not sure is if the paper answers it."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432054761, "post_id": 30330110, "comment_id": 48758199, "body": "@LayGonz&#225;lez it does not - I was just wondering if your question was in that direction - but as I said your question is really hard to answer (I can think of several ways to cheat my way out if you don&#39;t give the exact properties you want a list to have - for example in F# it will never be infinite so I could define a list to be a record of a really big array and a contained elements (length) parameter)"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1432187366, "post_id": 30332200, "comment_id": 48822021, "body": "Now I&#39;m wondering if there&#39;s a version of <code>Fix</code> for functions of kinds other than <code>*-&gt;*</code>."}], "tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": false, "score": 6, "last_activity_date": 1432056193, "creation_date": 1432056193, "answer_id": 30332200, "question_id": 30330110, "link": "https://stackoverflow.com/questions/30330110/can-all-recursive-structures-be-replaced-by-a-non-recursive-solution/30332200#30332200", "title": "Can all recursive structures be replaced by a non recursive solution?", "body": "<p>That's a bit of an odd question. I think the answer is <em>not really</em>, but the definition of the data type does not have to be recursive directly.</p>\n\n<p>Ultimately, lists are recursive data structures. You can't define them without having some sort of recursion <em>somewhere</em>. It's core to their essence.</p>\n\n<p>However, we don't have to make the actual definition of <code>List</code> recursive. Instead, we can factor out recursion into a single data type <code>Fix</code> and then define all other recursive types with it. In a sense, <code>Fix</code> just captures the essence of what it means for a data structure to be recursive. (It's the type-level version of the <code>fix</code> function, which does the same thing for functions.)</p>\n\n<pre><code>data Fix f = Roll (f (Fix f))\n</code></pre>\n\n<p>The idea is that <code>Fix f</code> corresponds to <code>f</code> applied to itself repeatedly. To make it work with Haskell's algebraic data types, we have to throw in a <code>Roll</code> constructor at every level, but this does not change what the type represents.</p>\n\n<p>Essentially, <code>f</code> applied to itself repeatedly like this is the essence of recursion.</p>\n\n<p>Now we can define a non-recursive analog to <code>List</code> that takes an extra type argument <code>f</code> that replaces our earlier recursion:</p>\n\n<pre><code>data ListF a f = Empty | Cons a f\n</code></pre>\n\n<p>This is a straightforward data type that is <em>not</em> recursive.</p>\n\n<p>If we combine the two, we get our old <code>List</code> type except with some extra <code>Roll</code> constructors at each recursive step.</p>\n\n<pre><code>type List a = Fix (ListF a)\n</code></pre>\n\n<p>A value of this type looks like this:</p>\n\n<pre><code>Roll (Cons 1 (Roll (Cons 2 (Roll Empty))))\n</code></pre>\n\n<p>It carries the same information as <code>(Cons 1 (Cons 2 Empty))</code> or even just <code>[1, 2]</code>, but a few extra constructors sprinkled through.</p>\n\n<p>So if you were given <code>Fix</code>, you could define <code>List</code> without using recursion. But this isn't particularly special because, in a sense, <code>Fix</code> <em>is</em> recursion.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1432059996, "post_id": 30333085, "comment_id": 48761318, "body": "The above encoding is general enough to cover the vast majority of recursive definitions. Maybe something which is not covered is polymorphic recursion, e.g. <code>data A a = Empty | Branch a (A (a,a))</code> -- note that <code>A a</code> is not defined in terms of <code>A a</code> but of <code>A (a,a)</code>. So it&#39;s <code>A</code> which is defined in terms of itself, not <code>A a</code>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1432230651, "post_id": 30333085, "comment_id": 48851134, "body": "@chi That&#39;s a good point. I wonder if there <i>is</i> a function type encoding that would work for that kind of non-regular data type..."}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": false, "score": 6, "last_activity_date": 1432059129, "creation_date": 1432059129, "answer_id": 30333085, "question_id": 30330110, "link": "https://stackoverflow.com/questions/30330110/can-all-recursive-structures-be-replaced-by-a-non-recursive-solution/30333085#30333085", "title": "Can all recursive structures be replaced by a non recursive solution?", "body": "<p>I'm not sure if <em>all</em> recursive structures can be replaced by a non-recursive version but some certainly can, including lists. One possible way to do this is with what is called a <i><a href=\"http://www.haskellforall.com/2014/09/morte-intermediate-language-for-super.html#recursion\">Boehm-Berarducci encoding</a></i>. This a way to represent a structure as a function, specifically the fold over that structure (<code>foldr</code> in the case of a list):</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE RankNTypes #-}\n\ntype List a = forall x . (a -&gt; x -&gt; x) -&gt; x -&gt; x\n                      -- ^^^^^^^^^^^^^    ^\n                      -- Cons branch      Nil branch\n</code></pre>\n\n<p>(From the above link with slightly different formatting)</p>\n\n<p>This type is also something like a case analysis over the list. The first argument represents the cons case and the second argument represents the nil case.</p>\n\n<p>In general, the branches of a sum type become different arguments to the function and fields of a product type become function types with an argument for each field. Note that in the encoding above, the nil branch is (in general) a non-function because the nil constructor takes no arguments, while the cons branch has two arguments since the cons constructor takes two arguments. The recursion parts of the definition are \"replaced\" with a Rank N type (called <code>x</code> here).</p>\n"}, {"comments": [{"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1432227840, "post_id": 30360033, "comment_id": 48849353, "body": "Perhaps the least exciting answer, but is simple and true. Arrays, loops, gotos, int and floats are enough for everything. Recursive data types can me replaced by other solution, which may not even be data types. So, if you can model an assembly or c interpreter in haskell, then that would be one solution."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 2, "last_activity_date": 1432155459, "last_edit_date": 1432155459, "creation_date": 1432154653, "answer_id": 30360033, "question_id": 30330110, "link": "https://stackoverflow.com/questions/30330110/can-all-recursive-structures-be-replaced-by-a-non-recursive-solution/30360033#30360033", "title": "Can all recursive structures be replaced by a non recursive solution?", "body": "<p>I think this question breaks down into considering three distinct feature subsets that Haskell provides:</p>\n\n<ol>\n<li>Facilities for defining new data types.</li>\n<li>A repertoire of built-in types.</li>\n<li>A foreign function interface that allows interfacing with functionality external to the language.</li>\n</ol>\n\n<p>Looking only at (1), the native type definition facilities don't really provide for defining any infinitely-large types other than by recursion.</p>\n\n<p>Looking at (2), however, <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch14.html\" rel=\"nofollow\">Haskell 2010 provides the <code>Data.Array</code> module</a>, which provides array types that together with (1) can be used to build non-recursive definitions of many different structures.</p>\n\n<p>And even if the language did not provide arrays, (3) means that we could bolt them to the language as an FFI extension.  Haskell implementations are also allowed to provide extra functionality that can be used for this in stead of the FFI, and many libraries for GHC exploit those (e.g., <a href=\"https://hackage.haskell.org/package/vector\" rel=\"nofollow\"><code>vector</code></a>).</p>\n\n<p>So I'd say that the best answer is that Haskell only allows you to define nonrecursive collection types only to the extent that it provides you with basic built-in ones that you can use as building blocks for more complex ones.</p>\n"}], "owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 30360033, "answer_count": 3, "score": 4, "last_activity_date": 1432231419, "creation_date": 1432049831, "last_edit_date": 1432231419, "question_id": 30330110, "link": "https://stackoverflow.com/questions/30330110/can-all-recursive-structures-be-replaced-by-a-non-recursive-solution", "title": "Can all recursive structures be replaced by a non recursive solution?", "body": "<p>For example, could you define a list in Haskell without defining a recursive structure? Or replace all lists by some function(s)?</p>\n\n<pre><code>data List a = Empty | (a, List a) -- &lt;- recursive definition\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>I gave the list as an example, but I was really asking about all data structures in general.\nMaybe we only need one recursive data structure for all cases where recursion is needed? Like the Y combinator being the only recursive function needed. @TikhonJelvis 's answer made me think about that.\nNow I'm pretty sure this post is better suited for cs.stackexchange.</p>\n\n<p><strong>About current selected answer</strong></p>\n\n<p>I was really looking for answers that looked more like the ones given by @DavidYoung &amp; @TikhonJelvis, but they only give a partial answer and I appreciate them.\nSo, if any has an answer that uses functional concepts, please share.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1432060699, "post_id": 30330015, "comment_id": 48761739, "body": "Are you using a sandbox? <code>ghc-pkg list</code> won&#39;t show you packages installed in the sandbox."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2879704"}, "edited": false, "score": 0, "creation_date": 1432082750, "post_id": 30337252, "comment_id": 48770847, "body": "i ran the comment... It shows two entries, one in $HOME/.ghc and the other in /opt/ghc/7.8.4/... The exact output is, <code>&#47;opt&#47;ghc&#47;7.8.4&#47;lib&#47;ghc-7.8.4&#47;package.conf.d    bytestring-0.10.4.0 &#47;home&#47;sk&#47;.ghc&#47;x86_64-linux-7.8.4&#47;package.conf.d    bytestring-0.10.6.0 </code>"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1432074535, "creation_date": 1432074535, "answer_id": 30337252, "question_id": 30330015, "link": "https://stackoverflow.com/questions/30330015/bytestring-package-version-number-mismatch/30337252#30337252", "title": "Bytestring - package version number mismatch", "body": "<p>It is possible that you are using a sandbox, in which case you can see which packages are in the sandbox with, for example,</p>\n\n<pre><code>cabal exec ghc-pkg list bytestring\n</code></pre>\n\n<blockquote>\n  <p>I haven't seen any language that checks for type safety across library versions. Why does haskell do that?</p>\n</blockquote>\n\n<p>There is no a priori reason to believe that the type named <code>ByteString</code> in one version of a package is semantically the same as the type with the same name in another version of the package. As a conservative rule, GHC simply doesn't allow mixing. Note that checking that the two types are semantically the same is not restricted to merely looking at the representation of their data; one would also need to compare their type-class instances, an obviously undecidable problem. One might imagine that future GHCs would try to do some more analysis on this front, but it has not been a pressing need -- usually, it is not hard to simply build your package against one and only one version of each dependency.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2879704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 30337252, "answer_count": 1, "score": 0, "last_activity_date": 1432074535, "creation_date": 1432049576, "question_id": 30330015, "link": "https://stackoverflow.com/questions/30330015/bytestring-package-version-number-mismatch", "title": "Bytestring - package version number mismatch", "body": "<p>I am trying to run <a href=\"https://github.com/tcrayford/hafka/blob/master/Network/Kafka/Request.hs#L14\" rel=\"nofollow\">hafka</a> on my system. And for same element type, <code>Data.ByteString.Internal.ByteString</code>, haskell throws error due to version number mismatch. </p>\n\n<pre><code>Couldn't match expected type \u2018bytestring-0.10.4.0:Data.ByteString.Internal.ByteString\u2019\n                with actual type \u2018B.ByteString\u2019\n    NB: \u2018bytestring-0.10.4.0:Data.ByteString.Internal.ByteString\u2019\n          is defined in \u2018Data.ByteString.Internal\u2019\n              in package \u2018bytestring-0.10.4.0\u2019\n        \u2018B.ByteString\u2019\n          is defined in \u2018Data.ByteString.Internal\u2019\n              in package \u2018bytestring-0.10.6.0\u2019\n</code></pre>\n\n<p>On my system, when i run <code>ghc-pkg list | grep bytestring</code>, it shows, \n                                                                        <code>bytestring-0.10.4.0</code>.</p>\n\n<p><code>ghc</code> is not using the package versioned <code>bytestring-0.14.0</code>. Where does haskell get the actual type version - <code>bytestring-0.10.6.0</code>?</p>\n\n<p>I have n't seen any language that checks for type safety across library versions. Why does haskell do that? </p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432044356, "post_id": 30327770, "comment_id": 48750380, "body": "I guess you cloned the git right? In this case I would use a sandbox and <code>cabal install</code> there - after this you should be fine using <code>cabal repl</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "is_accepted": true, "score": 2, "last_activity_date": 1432046604, "creation_date": 1432046604, "answer_id": 30328879, "question_id": 30327770, "link": "https://stackoverflow.com/questions/30327770/add-local-files-to-haskell-libraries-search-path/30328879#30328879", "title": "Add local files to haskell libraries search path", "body": "<p>You can include it as is by using <code>-i</code> when compiling with ghc.</p>\n\n<p>Fore example, <code>ghc ...... -i/path/to/local/fs</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2879704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 30328879, "answer_count": 1, "score": 3, "last_activity_date": 1432046604, "creation_date": 1432043813, "question_id": 30327770, "link": "https://stackoverflow.com/questions/30327770/add-local-files-to-haskell-libraries-search-path", "title": "Add local files to haskell libraries search path", "body": "<p>I am running <code>Examples/Producer.hs</code> from the <a href=\"https://github.com/tcrayford/hafka\" rel=\"nofollow\">hafka</a> project. It throws error as, </p>\n\n<pre><code>Could not find module \u2018Network.Kafka.Producer\u2019\n</code></pre>\n\n<p>Library file <code>Network.Kafka.Producer</code> is sitting in my local repository and not inside default library paths (<code>/home/user/.cabal</code>). How can i add this local file system path to the Cabal/Haskell library?</p>\n\n<p>In python terms, this question is equivalent to appending an entry to <code>PYTHONPATH</code> list as,</p>\n\n<pre><code>export PYTHONPATH=$PYTHONPATH:/path/to/local/fs\n</code></pre>\n"}, {"tags": ["haskell", "at-sign"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1432040574, "post_id": 30326249, "comment_id": 48747228, "body": "Search for &quot;as patterns&quot; in <a href=\"http://learnyouahaskell.com/syntax-in-functions#pattern-matching\" rel=\"nofollow noreferrer\">learnyouahaskell.com/syntax-in-functions#pattern-matching</a> for an introduction."}, {"owner": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "edited": false, "score": 7, "creation_date": 1432040647, "post_id": 30326249, "comment_id": 48747284, "body": "While traditional search engines won&#39;t return useful results when searching for special characters, Haskell&#39;s own <a href=\"https://www.haskell.org/hoogle/?hoogle=%40\" rel=\"nofollow noreferrer\">hoogle is usually quite useful</a> for such questions."}, {"owner": {"reputation": 11683, "user_id": 1614973, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/1gpM0.jpg?s=128&g=1", "display_name": "Dmitri Zaitsev", "link": "https://stackoverflow.com/users/1614973/dmitri-zaitsev"}, "reply_to_user": {"reputation": 42863, "user_id": 577603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/70c19b44cc2eb6f1a87a08fc892c502b?s=128&d=identicon&r=PG", "display_name": "ComicSansMS", "link": "https://stackoverflow.com/users/577603/comicsansms"}, "edited": false, "score": 0, "creation_date": 1482731566, "post_id": 30326249, "comment_id": 69857458, "body": "@ComicSansMS More helpful then the answer!"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1573318786, "post_id": 30326249, "comment_id": 103846862, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/27467650/understanding-the-haskell-as-pattern\">Understanding the Haskell as-pattern</a>"}], "answers": [{"comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1432043572, "post_id": 30326349, "comment_id": 48749719, "body": "Even simpler would be <code>someFunction leaf@Leaf{} = leaf</code>."}, {"owner": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1432043649, "post_id": 30326349, "comment_id": 48749791, "body": "@Andr&#225;sKov&#225;cs, but doesn&#39;t it require some explanations on <code>Leaf{}</code>?"}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1432102226, "post_id": 30326349, "comment_id": 48776447, "body": "The 2 are slightly different in ghci (in the second one it will re-apply the constructor arguments), but I&#39;d be very surprised if that were the case in ghc compiled code"}, {"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 0, "creation_date": 1541357485, "post_id": 30326349, "comment_id": 93179841, "body": "What does <code>@</code> mean in a context like <code>Proxy @Foo</code>?"}, {"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 1, "creation_date": 1541357837, "post_id": 30326349, "comment_id": 93179932, "body": "Whew, finally figured out it needs <code>{-# LANGUAGE TypeApplications #-}</code>, still learning what it is though."}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "reply_to_user": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 0, "creation_date": 1573338034, "post_id": 30326349, "comment_id": 103851445, "body": "@Josh.F - In that context, it is some sort of type cast &#224; la C/C++. I would expect your <code>Foo</code> thing to be a <i>type</i>. Formally, this @_type_ notation allows you to give explicit type arguments to a polymorphic function. Like: <code>let x = (read  @Integer  &quot;33&quot;)</code> setting x to be an Integer object of value 33. <a href=\"https://gitlab.haskell.org/ghc/ghc/wikis/type-application\" rel=\"nofollow noreferrer\">Details here</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1573341048, "post_id": 30326349, "comment_id": 103852032, "body": "@jpmarinier, no, it is not a type cast of any sort. It does indeed let you apply type arguments, but what those mean depend on the particular functions or methods involved."}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1573343671, "post_id": 30326349, "comment_id": 103852468, "body": "@dfeuer I agree it is only a loose analogy, as a C/C++ <i>cast</i> applies to a value, while this Haskell construct applies to a function, with for example the expression <code>(read @Integer)</code> having type <code>String -&gt; Integer</code>. Please note I did not use the word <i>cast</i> in my answer below."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1573346241, "post_id": 30326349, "comment_id": 103852878, "body": "@jpmarinier, it&#39;s so loose I can&#39;t even guess what it means. <code>foo @Int</code> could easily be a function that takes two characters and produces an <code>IO</code> action returning <code>()</code>."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 18, "last_activity_date": 1432040693, "last_edit_date": 1432040693, "creation_date": 1432040368, "answer_id": 30326349, "question_id": 30326249, "link": "https://stackoverflow.com/questions/30326249/what-does-mean-in-haskell/30326349#30326349", "title": "What does &#39;@&#39; mean in Haskell?", "body": "<p>It is used in pattern matching. Now <code>node</code> variable will refer to the entire <code>Node</code> data type for the argument <code>Node a b c l r</code>. So instead of passing to the function as <code>Node a b c l r</code>, you can use <code>node</code> instead to pass it up.</p>\n\n<p>A much simpler example to demonstrate it:</p>\n\n<pre><code>data SomeType = Leaf Int Int Int | Nil deriving Show\n\nsomeFunction :: SomeType -&gt; SomeType\nsomeFunction leaf@(Leaf _ _ _) = leaf\nsomeFunction Nil = Leaf 0 0 0\n</code></pre>\n\n<p>The <code>someFunction</code> can also be written as:</p>\n\n<pre><code>someFunction :: SomeType -&gt; SomeType\nsomeFunction (Leaf x y z) = Leaf x y z\nsomeFunction Nil = Leaf 0 0 0\n</code></pre>\n\n<p>See how simpler was the first version ?</p>\n"}, {"tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": false, "score": 5, "last_activity_date": 1573317148, "creation_date": 1573317148, "answer_id": 58781280, "question_id": 30326249, "link": "https://stackoverflow.com/questions/30326249/what-does-mean-in-haskell/58781280#58781280", "title": "What does &#39;@&#39; mean in Haskell?", "body": "<p>Besides the argument pattern matching usage described in the answer of @Sibi, in Haskell the \"at\" character ('@', also known as an <a href=\"https://en.wikipedia.org/wiki/At_sign\" rel=\"noreferrer\">arobase</a> character) can be used in some contexts to force a typing decision. This is mentioned in the comments by @Josh.F.</p>\n\n<p>This is <strong>not</strong> part of the default language features, and is known as the <a href=\"https://gitlab.haskell.org/ghc/ghc/wikis/type-application\" rel=\"noreferrer\">Type Application</a> Haskell language extension. In summary, the extension allows you to give explicit type arguments to a polymorphic function such as <code>read</code>. In a classic .hs source file, the relevant pragma must be included:</p>\n\n<pre><code>{-#  LANGUAGE TypeApplications  #-}\n</code></pre>\n\n<h2>Example:</h2>\n\n<pre><code>$ ghci\nGHCi, version 8.2.2: http://www.haskell.org/ghc/  :? for help\n \u03bb&gt; \n \u03bb&gt; let x = (read @Integer \"33\")\n\n &lt;interactive&gt;:4:10: error:\n    Pattern syntax in expression context: read@Integer\n    Did you mean to enable TypeApplications?\n \u03bb&gt; \n \u03bb&gt; :set -XTypeApplications\n \u03bb&gt;\n \u03bb&gt; let x = (read @Integer \"33\")\n \u03bb&gt;\n \u03bb&gt; :t x\n x :: Integer\n \u03bb&gt; \n \u03bb&gt; x\n 33\n \u03bb&gt; \n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 3969239, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/218eacbd9d5baf17f1e5acf279758b2f?s=128&d=identicon&r=PG&f=1", "display_name": "Rewbert", "link": "https://stackoverflow.com/users/3969239/rewbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5945, "favorite_count": 1, "accepted_answer_id": 30326349, "answer_count": 2, "score": 9, "last_activity_date": 1573317148, "creation_date": 1432040111, "last_edit_date": 1432040720, "question_id": 30326249, "link": "https://stackoverflow.com/questions/30326249/what-does-mean-in-haskell", "title": "What does &#39;@&#39; mean in Haskell?", "body": "<p>I've tried googling but come up short. I am furthering my Haskell knowledge by reading some articles and I came across one that uses a syntax I've never seen before.\nAn example would be:</p>\n\n<pre><code>reconstruct node@(Node a b c l r) parent@(Node b d le ri)\n</code></pre>\n\n<p>I've never seen these @'s before. I tried searching online for an answer but came up short. Is this simply a way to embed tags to help make things clearer, or do they have an actual impact on the code?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1432042240, "post_id": 30323479, "comment_id": 48748529, "body": "This doesn&#39;t answer the question. Yes, it will help the user tremendously in his future, but you should at least add <code>pageBody</code>&#39;s current location."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 2, "last_activity_date": 1432032474, "creation_date": 1432032474, "answer_id": 30323479, "question_id": 30322402, "link": "https://stackoverflow.com/questions/30322402/where-does-pagebody-pc-come-from/30323479#30323479", "title": "where does ^{pageBody pc} come from?", "body": "<p>Hoogle on stackage.org is a great resource for these kinds of questions:</p>\n\n<p><a href=\"http://www.stackage.org/lts/hoogle?q=pageBody\" rel=\"nofollow\">http://www.stackage.org/lts/hoogle?q=pageBody</a></p>\n"}, {"tags": [], "owner": {"reputation": 163, "user_id": 3416793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hSVtV.jpg?s=128&g=1", "display_name": "blazej", "link": "https://stackoverflow.com/users/3416793/blazej"}, "is_accepted": false, "score": 0, "last_activity_date": 1432049142, "creation_date": 1432049142, "answer_id": 30329850, "question_id": 30322402, "link": "https://stackoverflow.com/questions/30322402/where-does-pagebody-pc-come-from/30329850#30329850", "title": "where does ^{pageBody pc} come from?", "body": "<p>pageBody is a function that is called on the \"variable\" called pc.  Like Michael said, pageBody is part of the standard Yesod library.  It will be evaluated when your page template is processed by the whamlet engine (this is what the ^{...} does).  If you actually create a scaffolded site with Yesod, take some time to read through the auto-generated handling functions - you will see there how templates are processed.</p>\n"}, {"tags": [], "owner": {"reputation": 620, "user_id": 2576287, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh5.googleusercontent.com/-VegFz4P9Ovc/AAAAAAAAAAI/AAAAAAAAATo/Z-69W9rBCno/photo.jpg?sz=128", "display_name": "mrLSD", "link": "https://stackoverflow.com/users/2576287/mrlsd"}, "is_accepted": false, "score": 0, "last_activity_date": 1432996861, "last_edit_date": 1432996861, "creation_date": 1432906530, "answer_id": 30531041, "question_id": 30322402, "link": "https://stackoverflow.com/questions/30322402/where-does-pagebody-pc-come-from/30531041#30531041", "title": "where does ^{pageBody pc} come from?", "body": "<p>Simplified types:</p>\n\n<pre><code>data PageContent url = PageContent\n    { pageTitle :: Html\n    , pageHead :: HtmlUrl url\n    , pageBody :: HtmlUrl url\n    }\nwidgetToPageContent :: Widget -&gt; Handler (PageContent url)\n</code></pre>\n\n<p>...\nAnd code example:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE QuasiQuotes       #-}\n{-# LANGUAGE TemplateHaskell   #-}\n{-# LANGUAGE TypeFamilies      #-}\nimport           Yesod\n\ndata App = App\nmkYesod \"App\" [parseRoute|\n/ HomeR GET\n|]\n\nmyLayout :: Widget -&gt; Handler Html\nmyLayout widget = do\n    pc &lt;- widgetToPageContent $ do\n        widget\n        toWidget [lucius| body { font-family: arial } |]\n    withUrlRenderer\n        [hamlet|\n            $doctype 5\n            &lt;html&gt;\n                &lt;head&gt;\n                    &lt;title&gt;#{pageTitle pc}\n                    &lt;meta charset=utf-8&gt;\n                    ^{pageHead pc}\n                &lt;body&gt;\n                    &lt;article&gt;\n                        ^{pageBody pc}\n        |]\n\ninstance Yesod App where\n    defaultLayout = myLayout\n\ngetHomeR :: Handler Html\ngetHomeR = defaultLayout\n    [whamlet|\n        &lt;p&gt;Some text!\n    |]\n\nmain :: IO ()\nmain = warp 3000 App\n</code></pre>\n\n<p>and at scafolding Foundations.hs:</p>\n\n<pre><code>defaultLayout widget = do\n    master &lt;- getYesod\n    mmsg &lt;- getMessage\n\n    -- We break up the default layout into two components:\n    -- default-layout is the contents of the body tag, and\n    -- default-layout-wrapper is the entire page. Since the final\n    -- value passed to hamletToRepHtml cannot be a widget, this allows\n    -- you to use normal widget features in default-layout.\n\n    pc &lt;- widgetToPageContent $ do\n        addStylesheet $ StaticR css_bootstrap_css\n        $(widgetFile \"default-layout\")\n    withUrlRenderer $(hamletFile \"templates/default-layout-wrapper.hamlet\")\n</code></pre>\n"}], "owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 30323479, "answer_count": 3, "score": 1, "last_activity_date": 1432996861, "creation_date": 1432029499, "last_edit_date": 1432030146, "question_id": 30322402, "link": "https://stackoverflow.com/questions/30322402/where-does-pagebody-pc-come-from", "title": "where does ^{pageBody pc} come from?", "body": "<p>In default-layout-wrapper.hamlet file, there is ^{pageBody pc} which allows me to embed body content. I can find the <em>pc</em> part in Foundation.hs file. but where is pageBody constructed (in what file)?\nSame question for this variable #{pageTitle pc}.</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432024486, "post_id": 30320320, "comment_id": 48735993, "body": "like in <code>cabal install --dependencies-only</code>? - It just means: look at the projects <code>.cabal</code> file and install all the listed dependencies (the needed packages to compile the code)"}, {"owner": {"reputation": 6620, "user_id": 375570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e21580d3238dfce3b9b68d8a87108e12?s=128&d=identicon&r=PG", "display_name": "Bijou Trouvaille", "link": "https://stackoverflow.com/users/375570/bijou-trouvaille"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432024661, "post_id": 30320320, "comment_id": 48736099, "body": "What&#39;s then the difference between it and simply running <code>cabal install</code>, which has worked for me so far?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1432024857, "post_id": 30320320, "comment_id": 48736221, "body": "<code>cabal install</code> will install the library(project) itself too ;)"}, {"owner": {"reputation": 6620, "user_id": 375570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e21580d3238dfce3b9b68d8a87108e12?s=128&d=identicon&r=PG", "display_name": "Bijou Trouvaille", "link": "https://stackoverflow.com/users/375570/bijou-trouvaille"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432024956, "post_id": 30320320, "comment_id": 48736279, "body": "I see. Thanks for the clarification."}], "answers": [{"tags": [], "owner": {"reputation": 69792, "user_id": 493122, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/1f90ae01c2e24801c2df9189179b0ccd?s=128&d=identicon&r=PG", "display_name": "Shoe", "link": "https://stackoverflow.com/users/493122/shoe"}, "is_accepted": true, "score": 6, "last_activity_date": 1432024704, "creation_date": 1432024704, "answer_id": 30320630, "question_id": 30320320, "link": "https://stackoverflow.com/questions/30320320/for-cabal-what-does-only-dependencies-flag-mean/30320630#30320630", "title": "For cabal, what does only-dependencies flag mean?", "body": "<blockquote>\n  <p>For cabal, what does only-dependencies flag mean?</p>\n</blockquote>\n\n<p>It can be spelled as both <code>--dependencies-only</code> and <code>--only-dependencies</code> and it simply means that it will install all, and only, the dependencies the specific package requires (without installing or building the packages themselves). Note that by default tests and benchmark dependencies will not be installed; for them you need to add <code>--enable-tests</code> and <code>--enable-benchmarks</code> respectively.</p>\n\n<blockquote>\n  <p>Is this flag applicable to either of these situations?</p>\n</blockquote>\n\n<p>Yes, this can be used just fine with cabal sandboxes as well as without.</p>\n\n<blockquote>\n  <p>What's then the difference between it and simply running cabal install, which has worked for me so far?</p>\n</blockquote>\n\n<p><code>cabal install</code> will install both those dependencies and the packages themselves. Same for <code>cabal build</code>. <code>cabal install --only-dependencies</code> will only install the dependencies those packages require.</p>\n"}], "owner": {"reputation": 6620, "user_id": 375570, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e21580d3238dfce3b9b68d8a87108e12?s=128&d=identicon&r=PG", "display_name": "Bijou Trouvaille", "link": "https://stackoverflow.com/users/375570/bijou-trouvaille"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 2, "accepted_answer_id": 30320630, "answer_count": 1, "score": 5, "last_activity_date": 1432024704, "creation_date": 1432023807, "question_id": 30320320, "link": "https://stackoverflow.com/questions/30320320/for-cabal-what-does-only-dependencies-flag-mean", "title": "For cabal, what does only-dependencies flag mean?", "body": "<p>I'm fairly new to Haskell, and upon seeing this flag, e.g. in this <a href=\"https://github.com/freebroccolo/docker-haskell/blob/master/examples/7.8/snap/Dockerfile\" rel=\"noreferrer\">dockerfile</a>, I can't ever seem to find an explanation for what it does. <em>\"Install only the dependencies necessary to build the given packages,\"</em> in the <code>cabal help install</code> doesn't say much to me.</p>\n\n<p>If I'm not building inside a docker container, I use sandboxes. Is this flag applicable to either of these situations?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432023420, "post_id": 30320087, "comment_id": 48735350, "body": "I think the easiest way would probably be be to use <a href=\"https://wiki.haskell.org/Functional_dependencies\" rel=\"nofollow noreferrer\">functional dependencies</a> for your <code>ContextGenerator</code> like <code>class ContextGenerator m a | a -&gt; m where ...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 222, "user_id": 2051432, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a802810986fbce9e8fcfe7e1deb89652?s=128&d=identicon&r=PG", "display_name": "sgillis", "link": "https://stackoverflow.com/users/2051432/sgillis"}, "edited": false, "score": 0, "creation_date": 1432026041, "post_id": 30320467, "comment_id": 48737032, "body": "Thanks, this is indeed what I needed. I never seem to stop learning new things in Haskell!"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1432026099, "last_edit_date": 1432026099, "creation_date": 1432024223, "answer_id": 30320467, "question_id": 30320087, "link": "https://stackoverflow.com/questions/30320087/inferred-type-is-ambiguous/30320467#30320467", "title": "Inferred type is ambiguous", "body": "<p>You can make this work using <a href=\"https://wiki.haskell.org/Functional_dependencies\" rel=\"nofollow\">functional dependencies</a> in GHC - just add the language-extension and rewrite your type-class to:</p>\n\n<pre><code>class ContextGenerator m a | a -&gt; m where ...\n</code></pre>\n\n<p>this basically says that <code>a</code> should include the choice for <code>m</code> (you could say  <code>ContextGenerator</code> is now not a binary relation for the types <code>m</code> and <code>a</code> but a function from <code>a -&gt; m</code> - which is implied by the <em>syntax</em> of the extension too)</p>\n\n<h2><em>working</em> example:</h2>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE FunctionalDependencies #-}\n\nimport Data.Text\nimport Control.Monad.IO.Class\n\ndata ContextNode m = ContextText Text\n                   | ContextSub (Context m)\n\ntype Context m = (Text -&gt; m (Maybe (ContextNode m)))\n\nclass ContextGenerator m a | a -&gt; m where\n  clookup :: a -&gt; Text -&gt; m (Maybe (ContextNode m))\n\ninstance (MonadIO m) =&gt; ContextGenerator m (Context m) where\n  clookup a s = a s\n\nmkContext :: MonadIO m =&gt; Text -&gt; ContextNode m -&gt; Context m\nmkContext s n = \\s' -&gt; if s' == s then return (Just n) else return Nothing\n</code></pre>\n\n<h3>test-session:</h3>\n\n<pre><code>\u03bb&gt; let ctx = mkContext \"hello\" (ContextText \"world\")\n\n\u03bb&gt; (Just (ContextText t)) &lt;- clookup ctx \"hello\"\n\n\u03bb&gt; t\n\"world\"\n\n\u03bb&gt; Just _ &lt;- clookup ctx \"???\"\n*** Exception: user error (Pattern match failure in do expression at &lt;interactive&gt;:41:1-6)\n\n\u03bb&gt; Nothing &lt;- clookup ctx \"???\"\n(...empty of course...)\n</code></pre>\n\n<h2>remark</h2>\n\n<p>as those types and classes are dependent of each other I am unsure that you really have a use-case for the type-class here- maybe you would be fine with just the function without all the overhead instead?</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.Text\nimport Control.Monad.IO.Class\n\nclookup :: Context m -&gt; Text -&gt; m (Maybe (ContextNode m))\nclookup a s = a s\n\ndata ContextNode m\n  = ContextText Text\n  | ContextSub (Context m)\n\ntype Context m = (Text -&gt; m (Maybe (ContextNode m)))\n\nmkContext :: MonadIO m =&gt; Text -&gt; ContextNode m -&gt; Context m\nmkContext s n = \\s' -&gt; if s' == s then return (Just n) else return Nothing\n</code></pre>\n"}], "owner": {"reputation": 222, "user_id": 2051432, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a802810986fbce9e8fcfe7e1deb89652?s=128&d=identicon&r=PG", "display_name": "sgillis", "link": "https://stackoverflow.com/users/2051432/sgillis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 0, "accepted_answer_id": 30320467, "answer_count": 1, "score": 2, "last_activity_date": 1432026099, "creation_date": 1432023004, "question_id": 30320087, "link": "https://stackoverflow.com/questions/30320087/inferred-type-is-ambiguous", "title": "Inferred type is ambiguous", "body": "<p>I'm trying to build a library to fill in a template based on some context.</p>\n\n<p>The relevant data types are a <code>ContextNode</code> and <code>Context</code>.</p>\n\n<pre><code>data ContextNode m = ContextText Text\n                   | ContextSub (Context m)\n\ntype Context m = (Text -&gt; m (Maybe (ContextNode m)))\n</code></pre>\n\n<p>I defined a typeclass <code>ContextGenerator</code> to be able to derive something context like for data types using generics.</p>\n\n<pre><code>class ContextGenerator m a where\n    clookup :: a -&gt; Text -&gt; m (Maybe (ContextNode m))\n</code></pre>\n\n<p><code>Context</code> should be an instance of <code>ContextGenerator</code></p>\n\n<pre><code>instance (MonadIO m) =&gt; ContextGenerator m (Context m) where\n    clookup a s = a s\n</code></pre>\n\n<p>Some code to make contexts</p>\n\n<pre><code>mkContext :: MonadIO m =&gt; Text -&gt; ContextNode m -&gt; Context m\nmkContext s n = \\s' -&gt; if s' == s then return (Just n) else return Nothing\n</code></pre>\n\n<p>The thing that isn't working is when I do the following (in repl where I enabled OverloadedStrings and FlexibleContexts)</p>\n\n<pre><code>&gt; let ctx = mkContext \"hello\" (ContextText \"world\")\n\n&gt; clookup ctx \"hello\"\n\nCould not deduce (Control.Monad.IO.Class.MonadIO m0)\nfrom the context (Control.Monad.IO.Class.MonadIO m1,\n                  ContextGenerator m (Context m1))\n  bound by the inferred type for \u2018it\u2019:\n             (Control.Monad.IO.Class.MonadIO m1,\n              ContextGenerator m (Context m1)) =&gt;\n             m (Maybe (ContextNode m))\n  at &lt;interactive&gt;:18:1-19\nThe type variable \u2018m0\u2019 is ambiguous\nWhen checking that \u2018it\u2019 has the inferred type\n  it :: forall (m :: * -&gt; *) (m1 :: * -&gt; *).\n        (Control.Monad.IO.Class.MonadIO m1,\n         ContextGenerator m (Context m1)) =&gt;\n        m (Maybe (ContextNode m))\nProbable cause: the inferred type is ambiguous\n</code></pre>\n\n<p>It seems to me that the GHC infers that the two <code>m</code>'s in the instance definition are different, is that correct? How can I tell GHC that these should be the same?</p>\n"}, {"tags": ["haskell", "architecture", "purescript"], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 4914903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ac7fcfbb9192989cd71ccfb042dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "starper", "link": "https://stackoverflow.com/users/4914903/starper"}, "edited": false, "score": 0, "creation_date": 1432071026, "post_id": 30325829, "comment_id": 48767321, "body": "Thank you for your answer. I&#39;ve edited my question and added a simple example."}], "tags": [], "owner": {"reputation": 4314, "user_id": 139614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3f2ea13b0b182e926e8bd5ff59be201?s=128&d=identicon&r=PG", "display_name": "gb.", "link": "https://stackoverflow.com/users/139614/gb"}, "is_accepted": false, "score": 3, "last_activity_date": 1432039007, "creation_date": 1432039007, "answer_id": 30325829, "question_id": 30319965, "link": "https://stackoverflow.com/questions/30319965/how-to-structure-app-in-purescript/30325829#30325829", "title": "How to structure app in purescript", "body": "<p>This is a bit of an open ended question, so it's hard to answer specifically without concrete examples.</p>\n\n<blockquote>\n  <p>You have input and you have output, everything in between are just pure functions</p>\n</blockquote>\n\n<p>Statements like this are actually pretty close to the truth. Since there are no stateful objects in Haskell and PureScript, the majority of the code in an app will be based around pure functions and simple data types (or records), and therefore it is not tightly coupled to any particular library (aside from things like <code>Maybe</code>, <code>Either</code>, <code>Tuple</code>, and so on, which aren't really libraries in the sense you're talking about).</p>\n\n<p>As much as possible you should try to push code that uses effects to the \u201coutside\u201d. This is where you interleave the various libraries you require to process whatever inputs and produce whatever outputs your app requires. This layering makes it easy to switch libraries in and out, as here you'll mostly be lifting your core pure code into the <code>Eff</code> monad to \u201cwire it up\u201d to the external inputs and ouputs.</p>\n\n<p>One way of looking at it, is if you find yourself using <code>Eff</code> much outside of the main module or top layer of your app, you're probably \u201cdoing it wrong\u201d.</p>\n\n<p>If you're writing Haskell, substitute anywhere I mention <code>Eff</code> with <code>IO</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2567, "user_id": 3780203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3f3f9ab585dc56fa27e203ce4eb27fd?s=128&d=identicon&r=PG&f=1", "display_name": "ephrion", "link": "https://stackoverflow.com/users/3780203/ephrion"}, "is_accepted": true, "score": 6, "last_activity_date": 1434166394, "creation_date": 1434166394, "answer_id": 30814790, "question_id": 30319965, "link": "https://stackoverflow.com/questions/30319965/how-to-structure-app-in-purescript/30814790#30814790", "title": "How to structure app in purescript", "body": "<p>There's no reason you can't have a middle layer for abstracting over dependencies. Let's say you want to use a router for your application. You can define a \"router abstraction\" library that would look like the following:</p>\n\n<pre><code>module App.Router where\n\nimport SomeRouterLib\n\n-- Type synonym to make it easy to change later\ntype Route = SomeLibraryRouteType\n\n-- Just an alias to the Router library\nmakeRoute :: String -&gt; Route -&gt; Route\nmakeRoute = libMakeRoute\n</code></pre>\n\n<p>And then the new shiny comes out, and you want to switch your routing library. You'll need to make a new module that conforms to the same API, but has the same functions -- an adapter, if you will.</p>\n\n<pre><code>module App.RouterAlt where\n\nimport AnotherRouterLib\n\ntype Route = SomeOtherLibraryType\n\nmakeRoute :: String -&gt; Route -&gt; Route\nmakeRoute = otherLibMakeRoute\n</code></pre>\n\n<p>In your main app, you can now swap the imports, and everything should work alright. There will likely be more massaging that needs to happen to get the types and functions working as you'd expect them, but that's the general idea. </p>\n\n<p>Your example code is very imperative in nature. It's not idiomatic functional code, and I think you're correct in noting that it's not sustainable. More functional idioms include <a href=\"https://github.com/slamdata/purescript-halogen\" rel=\"noreferrer\">purescript-halogen</a> and <a href=\"https://github.com/paf31/purescript-thermite\" rel=\"noreferrer\">purescript-thermite</a>.</p>\n\n<p>Consider the UI as a pure function of current application state. In other words, given the current value of things, what does my app look like? Also, consider that the current state of the application can be derived from applying a series of pure functions to some initial state.</p>\n\n<p>What is your application state?</p>\n\n<pre><code>data AppState = AppState { buttons :: [Button] }\ndata Button = Button { numClicks :: Integer }\n</code></pre>\n\n<p>What kind of events are you looking at?</p>\n\n<pre><code>data Event = ButtonClick { buttonId :: Integer }\n</code></pre>\n\n<p>How do we handle that Event?</p>\n\n<pre><code>handleEvent :: AppState -&gt; Event -&gt; AppState\nhandleEvent state (ButtonClick id) =\n    let newButtons = incrementButton id (buttons state)\n    in  AppState { buttons = newButtons }\n\nincrementButton :: Integer -&gt; [Button] -&gt; [Button]\nincrementButton _ []      = []\nincrementButton 0 (b:bs)  = Button (1 + numClicks b) : bs\nincrementButton i (b:bs)  = b : incrementButton (i - 1) buttons\n</code></pre>\n\n<p>How do you render the application, based on the current state?</p>\n\n<pre><code>render :: AppState -&gt; Html\nrender state =\n    let currentButtons = buttons state\n        btnList = map renderButton currentButtons\n        renderButton btn = \"&lt;li&gt;&lt;button&gt;\" ++ show (numClicks btn) ++ \"&lt;/button&gt;&lt;/li&gt;\" \n    in  \"&lt;div&gt;&lt;ul&gt;\" ++ btnList ++ \"&lt;/ul&gt;&lt;/div&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 4914903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ac7fcfbb9192989cd71ccfb042dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "starper", "link": "https://stackoverflow.com/users/4914903/starper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1095, "favorite_count": 0, "accepted_answer_id": 30814790, "answer_count": 2, "score": 5, "last_activity_date": 1434166394, "creation_date": 1432022682, "last_edit_date": 1432083822, "question_id": 30319965, "link": "https://stackoverflow.com/questions/30319965/how-to-structure-app-in-purescript", "title": "How to structure app in purescript", "body": "<p>I've decided to try functional programming and Purescript. After reading <code>\"Learn you a Haskell for great good\"</code> and <code>\"PureScript by Example\"</code> and playing with code a little I think that I can say that I understand the basics, but one thing bothers me a lot - code looks very coupled. It's usual for me to change libraries very often and in OOP I can use onion architecture to decouple my own code from the library specific one, but I have no idea how to do this in Purescript.</p>\n\n<p>I've tried to find how people do this in Haskell, but all I could find were answers like \"No one has ever made complex apps in Haskell, so no one knows how to do it\" or \"You have input and you have output, everything in between are just pure functions\". But at this moment I have a toy app that uses virtal dom, signals, web storage, router libs and each of them have their own effects and data structures, so it doesn't sound like one input and one output.</p>\n\n<p>So my question is how should I structure my code or <em>what technics should I use</em> so that I could change my libs without rewriting half of my app?</p>\n\n<p><strong>Update:</strong></p>\n\n<p>Suggestion to use several layers and keep effects in the main module is quite common too and I understand why I should do so.<br>\nHere is a simple example that hopefully will illustrate the problem i'm talking about:  </p>\n\n<pre><code>btnHandler :: forall ev eff. (MouseEvent ev) =&gt; ev -&gt; Eff (dom :: DOM, webStorage :: WebStorage, trace :: Trace | eff) Unit\nbtnHandler e = do\n  btn &lt;- getTarget e\n  Just btnId &lt;- getAttribute \"id\" btn\n  Right clicks &lt;- (getItem localStorage btnId) &gt;&gt;= readNumber\n  let newClicks = clicks + 1\n  trace $ \"Button #\" ++ btnId ++ \" has been clicked \" ++ (show newClicks) ++ \" times\"\n  setText (show newClicks) btn\n  setItem localStorage btnId $ show newClicks\n  -- ... maybe some other actions\n  return unit\n\n-- ... other handlers for different controllers\n\nbtnController :: forall e. Node -&gt; _ -&gt; Eff (dom :: DOM, webStorage :: WebStorage, trace :: Trace | e) Unit\nbtnController mainEl _ = do\n  delegateEventListener mainEl \"click\" \"#btn1\" btnHandler\n  delegateEventListener mainEl \"click\" \"#btn2\" btnHandler\n  delegateEventListener mainEl \"click\" \"#btn3\" btnHandler\n  -- ... render buttons\n  return unit\n\n-- ... other controllers\n\nmain :: forall e. Eff (dom :: DOM, webStorage :: WebStorage, trace :: Trace, router :: Router | e) Unit\nmain = do\n  Just mainEl &lt;- body &gt;&gt;= querySelector \"#wrapper\"\n  handleRoute \"/\" $ btnController mainEl\n  -- ... other routes each with it's own controller\n  return unit\n</code></pre>\n\n<p>Here we have simple counter app with routing, web storage, dom manipulations and console logging. As you can see there is no single input and single output. We can get inputs from router or event listeners and use console or dom as an output, so it becomes a little more complicated.</p>\n\n<p>Having all this effectful code in main module feels wrong for me for two reasons:</p>\n\n<ol>\n<li>If I will keep adding routes and controllers this module will quickly turn into a thousand line mess.</li>\n<li>Keeping routing, dom manipulations and data storing in the same module violates single responsibility principle (and I assume that it is important in FP too)</li>\n</ol>\n\n<p>We can split this module into several ones, for example one module per controller and create some kind of effectful layer. But then when I have ten controller modules and I want to change my dom specific lib I should edit them all.</p>\n\n<p>Both of this approaches are far from ideal, so the question is wich one I should choose? Or maybe there is some other way to go?</p>\n"}, {"tags": ["performance", "haskell", "profiling", "ghc", "memoization"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1432048153, "post_id": 30319423, "comment_id": 48753700, "body": "The numbers you should find notable are 8855742 and 3707851, which indicate that your memoization is not working at all. madjar&#39;s answer explains why."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 2755310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc44bffba313ed4e66549e858c81a613?s=128&d=identicon&r=PG", "display_name": "brettwines", "link": "https://stackoverflow.com/users/2755310/brettwines"}, "edited": false, "score": 0, "creation_date": 1432060559, "post_id": 30321191, "comment_id": 48761659, "body": "Ah, but of course! I added the two <code>Int</code> arguments in an attempt to leverage <code>Memo.integral</code>, which should be faster than <code>Memo.list</code> -- as you see, the two <code>Int</code>s are just passed around and never used anywhere.  Hence, I would expect the following to perform better:      <code>longestCommonSubsequence&#39; i j xs ys = (Memo.memo2 Memo.integral Memo.integral longestCommonSubsequence&#39;&#39;) i j xs ys</code>  since it&#39;s always memoizing the same function, and building its lookup table only based on two integers. However, I&#39;m still seeing pretty similar profiling results. Am I misunderstanding something? Thanks! :)"}, {"owner": {"reputation": 89, "user_id": 2755310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc44bffba313ed4e66549e858c81a613?s=128&d=identicon&r=PG", "display_name": "brettwines", "link": "https://stackoverflow.com/users/2755310/brettwines"}, "edited": false, "score": 0, "creation_date": 1432068094, "post_id": 30321191, "comment_id": 48765977, "body": "Just to clarify, here; with the original implementation, it was building many tables, for one function each with one input each because the currying uniquely determines what i and j will be. In the alternative in the above comment, I would expect it to only build one table, for one function (<code>longestCommonSubsequence&#39;&#39;</code>), with many different inputs (all values of <code>i</code> and <code>j</code>), so it seems odd that it would still be so slow."}, {"owner": {"reputation": 89, "user_id": 2755310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc44bffba313ed4e66549e858c81a613?s=128&d=identicon&r=PG", "display_name": "brettwines", "link": "https://stackoverflow.com/users/2755310/brettwines"}, "edited": false, "score": 0, "creation_date": 1432108310, "post_id": 30321191, "comment_id": 48780207, "body": "Hmm; it seems like you can&#39;t memoize only some arguments. For someone reading this in the future with the same issue: I got around this by writing <code>longestCommonSubsequence&#39;</code> and <code>&#39;&#39;</code> to be 2-ary functions that take <code>Int</code>s and declared referenced <code>xs</code> and <code>ys</code> in this lower scope (note that list indexing will be slow so you might want to use Data.HashMap or Data.Vector for faster indexing)!"}, {"owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "reply_to_user": {"reputation": 89, "user_id": 2755310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc44bffba313ed4e66549e858c81a613?s=128&d=identicon&r=PG", "display_name": "brettwines", "link": "https://stackoverflow.com/users/2755310/brettwines"}, "edited": false, "score": 0, "creation_date": 1432156889, "post_id": 30321191, "comment_id": 48812930, "body": "I was about to suggest you create your own <code>Memo</code> that memoize only on the list size, but I looked into it and it seems more complex than your solution."}, {"owner": {"reputation": 89, "user_id": 2755310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc44bffba313ed4e66549e858c81a613?s=128&d=identicon&r=PG", "display_name": "brettwines", "link": "https://stackoverflow.com/users/2755310/brettwines"}, "edited": false, "score": 0, "creation_date": 1432259925, "post_id": 30321191, "comment_id": 48863597, "body": "Thanks for the suggestion! Yeah -- this is pretty simple to code, although a bit less elegant; I guess."}, {"owner": {"reputation": 89, "user_id": 2755310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc44bffba313ed4e66549e858c81a613?s=128&d=identicon&r=PG", "display_name": "brettwines", "link": "https://stackoverflow.com/users/2755310/brettwines"}, "edited": false, "score": 1, "creation_date": 1432541585, "post_id": 30321191, "comment_id": 48951445, "body": "Heyhey! Yeah -- good idea; here&#39;s a link: <a href=\"https://hackage.haskell.org/package/filediff-1.0.0.5/docs/src/Filediff.html#longestCommonSubsequence\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/filediff-1.0.0.5/docs/src/&hellip;</a>"}], "tags": [], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "is_accepted": true, "score": 1, "last_activity_date": 1432026307, "creation_date": 1432026307, "answer_id": 30321191, "question_id": 30319423, "link": "https://stackoverflow.com/questions/30319423/haskell-data-memocombinators-performance-issues/30321191#30321191", "title": "Haskell Data.Memocombinators performance issues?", "body": "<p>When you call <code>Memo.memo2 Memo.integral Memo.integral (longestCommonSubsequence'' xs ys)</code>, it creates a memoizer for the function <code>longestCommonSubsequence'' xs ys</code>. This means that there is one memoizer for each different value of <code>xs</code> and <code>ys</code>. I guess that most of the execution time is spent creating all those data structures for all those memoizers.</p>\n\n<p>Did you mean to memoize on the 4 arguments of  <code>longestCommonSubsequence''</code>?</p>\n"}], "owner": {"reputation": 89, "user_id": 2755310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cc44bffba313ed4e66549e858c81a613?s=128&d=identicon&r=PG", "display_name": "brettwines", "link": "https://stackoverflow.com/users/2755310/brettwines"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 30321191, "answer_count": 1, "score": 0, "last_activity_date": 1432060857, "creation_date": 1432020940, "last_edit_date": 1432060857, "question_id": 30319423, "link": "https://stackoverflow.com/questions/30319423/haskell-data-memocombinators-performance-issues", "title": "Haskell Data.Memocombinators performance issues?", "body": "<p>_</p>\n\n<p>Hi, there,</p>\n\n<p>Part of <a href=\"http://hackage.haskell.org/package/filediff\" rel=\"nofollow\">my program to compute differences between files</a> makes use of the standard DP algorithm to compute the longest common noncontiguous subsequence between two lists. I've been running into performance issues with some of this functionality, so I ran HPC to profile, and found the following result:</p>\n\n<pre><code>                                                individual     inherited\nCOST CENTRE                       no. entries  %time %alloc   %time %alloc\n(ommitted lines above)\nlongestCommonSubsequence             1          0.0    0.0    99.9  100.0\n longestCommonSubsequence'           8855742   94.5   98.4    99.9  100.0\n  longestCommonSubsequence''         8855742    4.2    0.8     5.4    1.6\n   longestCommonSubsequence''.caseY  3707851    0.6    0.6     0.6    0.6\n   longestCommonSubsequence''.caseX  3707851    0.6    0.2     0.6    0.2\n(ommitted lines below)\n</code></pre>\n\n<p>Here's the offending code:</p>\n\n<pre><code>longestCommonSubsequence' :: forall a. (Eq a) =&gt; [a] -&gt; [a] -&gt; Int -&gt; Int -&gt; [a]\nlongestCommonSubsequence' xs ys i j =\n      (Memo.memo2 Memo.integral Memo.integral (longestCommonSubsequence'' xs ys)) i j\n\nlongestCommonSubsequence'' :: forall a. (Eq a) =&gt; [a] -&gt; [a] -&gt; Int -&gt; Int -&gt; [a]\nlongestCommonSubsequence'' [] _ _ _ = []\nlongestCommonSubsequence'' _ [] _ _ = []\nlongestCommonSubsequence'' (x:xs) (y:ys) i j =\n    if x == y\n        then x : (longestCommonSubsequence' xs ys (i + 1) (j + 1)) -- WLOG\n        else if (length caseX) &gt; (length caseY)\n            then caseX\n            else caseY\n    where\n        caseX :: [a]\n        caseX = longestCommonSubsequence' xs (y:ys) (i + 1) j\n\n        caseY :: [a]\n        caseY = longestCommonSubsequence' (x:xs) ys i (j + 1)\n</code></pre>\n\n<p>I find it notable that all the time and memory usage is happening in <code>longestCommonSubsequence'</code>, the memoizing wrapper. Hence, I would conclude that the performance hit is coming from all the lookups and cachings done by <code>Data.Memocombinators</code>, despite how it's always performed admirably the many other times I've used it.</p>\n\n<p>I guess my question is... this conclusion seems reasonable; is it? If so, then does anyone have any recommendations for other ways to achieve the DP?</p>\n\n<p>For reference, it takes 12 seconds - which is absurdly long - to compare two 14-line-long files with respective contents <code>\"a\\nb\\nc\\n...m\"</code> and <code>\"*a\\nb\\nc\\n...m*\"</code> (same contents but with <code>'*'</code> pre-pended and post-pended).</p>\n\n<p>Thanks in advance! :)</p>\n\n<p>EDIT: trying <code>ghc-core</code> stuff now; will post an update if I can get it to play nicely with a Cabal project and get any useful information!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1432011570, "post_id": 30316971, "comment_id": 48729220, "body": "Is it possible to have a side effect in side-effect-free programming? \u2026 no. <a href=\"https://wiki.haskell.org/State_Monad\" rel=\"nofollow noreferrer\">wiki.haskell.org/State_Monad</a> might help."}, {"owner": {"reputation": 15, "user_id": 4742290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AJjnBM3UU6s/AAAAAAAAAAI/AAAAAAAAAE4/AWT4IkLZRB4/photo.jpg?sz=128", "display_name": "seedkey", "link": "https://stackoverflow.com/users/4742290/seedkey"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1432011683, "post_id": 30316971, "comment_id": 48729260, "body": "But is there a way to do this, without making it as a side effect"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 6, "creation_date": 1432011932, "post_id": 30316971, "comment_id": 48729354, "body": "the reasonable answer for a beginner can only be: <i>no there isn&#39;t</i> - instead make the thing you <i>remembered</i> a argument of your function for now (the <i>state-monad</i> just make this implicit) - <i>btw</i> why do you event want something like it when you can use (in your example) just <code>maximum</code> with the list of all things to find the max. element for instead?"}, {"owner": {"reputation": 15, "user_id": 4742290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AJjnBM3UU6s/AAAAAAAAAAI/AAAAAAAAAE4/AWT4IkLZRB4/photo.jpg?sz=128", "display_name": "seedkey", "link": "https://stackoverflow.com/users/4742290/seedkey"}, "edited": false, "score": 0, "creation_date": 1432012453, "post_id": 30316971, "comment_id": 48729521, "body": "Well, am attempting alpha-beta pruning, so the I need a function that keeps on restricting the alpha and beta bounds. Starting with (-500, 500)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 9, "creation_date": 1432012543, "post_id": 30316971, "comment_id": 48729549, "body": "this is really no problem - just pass your alpha/beta values around (and return the updated versions obviously) - it will even make you understand the algorithm better! - Of course it might get tedious in this case and the state-monad might not be a bad idea after all - but I would recommend it only if you already understand this stuff - if not stick with the explicit arguments/returns for now"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1432051211, "post_id": 30316971, "comment_id": 48755879, "body": "@seedkey Just make alpha and beta arguments."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 4742290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AJjnBM3UU6s/AAAAAAAAAAI/AAAAAAAAAE4/AWT4IkLZRB4/photo.jpg?sz=128", "display_name": "seedkey", "link": "https://stackoverflow.com/users/4742290/seedkey"}, "edited": false, "score": 0, "creation_date": 1432093778, "post_id": 30335943, "comment_id": 48773533, "body": "That look&#39;s interesting, I am just trying to understand scanl, which seems to take a predicament, a value and a list, but in your code it is taking a tuple and a list?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 15, "user_id": 4742290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AJjnBM3UU6s/AAAAAAAAAAI/AAAAAAAAAE4/AWT4IkLZRB4/photo.jpg?sz=128", "display_name": "seedkey", "link": "https://stackoverflow.com/users/4742290/seedkey"}, "edited": false, "score": 0, "creation_date": 1432095562, "post_id": 30335943, "comment_id": 48774005, "body": "<a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Prelude.html#v:scanl\" rel=\"nofollow noreferrer\"><code>scanl</code></a> is like <code>foldl</code> but collects partial results."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 0, "last_activity_date": 1432069531, "last_edit_date": 1432069531, "creation_date": 1432068834, "answer_id": 30335943, "question_id": 30316971, "link": "https://stackoverflow.com/questions/30316971/update-values-in-haskell/30335943#30335943", "title": "Update values in Haskell?", "body": "<p>Here's a direct translation of the alpha-beta <a href=\"http://en.wikipedia.org/wiki/Alpha%E2%80%93beta_pruning#Pseudocode\" rel=\"nofollow\">pseudocode.</a> I haven't tested it, but I hope it gets the general method of translating the algorithm across, even if it's not entirely correct.</p>\n\n<pre><code>alphaBeta ::\n     (state -&gt; Int) -- heuristic\n  -&gt; (state -&gt; Bool -&gt; [state]) -- next states\n  -&gt; state     \n  -&gt; Int   -- depth\n  -&gt; Int   -- alpha\n  -&gt; Int   -- beta\n  -&gt; Bool  -- is max player  \n  -&gt; Int   -- score\nalphaBeta heu children = go where\n  go s d a b p | d == 0 || null ss = heu s\n               | otherwise         = score \n    where      \n      ss = children s p\n\n      score = fst $ head $ case p of\n        True -&gt;\n          takeWhile ((&lt;b) . snd) $ scanl step (minBound, a) ss where\n            step (v, a) s = (v', max a v') where\n              v' = max v (go s (d - 1) a b (not p))\n        False -&gt;\n          takeWhile ((a&lt;) . snd) $ scanl step (maxBound, b) ss where\n            step (v, b) s = (v', min b v') where\n              v' = min v (go s (d - 1) a b (not p))\n</code></pre>\n\n<p>We use <code>scanl</code> to process each child state of the current state while remembering partial results. We use <code>takeWhile</code> to do the cut. Since lists are lazy, we don't process children after the cut. Also, list fusion or garbage collection (depending on optimization levels and GHC version) ensures that <code>scanl</code>  uses constant space here. This is a fine example of laziness allowing us to define algorithms compositionally. </p>\n\n<p>Alternatively, we could do the cutting and processing simultaneously, thereby sticking closer to the original presentation. <code>foldM</code>  with <code>Either</code> lets us process the children one by one and decide at each step whether to stop and return a value with <code>Left</code> or continue with <code>Right</code>. So we use <code>Left</code> as an analogue of the <code>break</code> statement in the imperative pseudocode.</p>\n\n<pre><code>import Control.Monad\n\nalphaBeta ::\n     (state -&gt; Int) -- heuristic\n  -&gt; (state -&gt; Bool -&gt; [state]) -- next states\n  -&gt; state     \n  -&gt; Int   -- depth\n  -&gt; Int   -- alpha\n  -&gt; Int   -- beta\n  -&gt; Bool  -- is max player  \n  -&gt; Int   -- score\nalphaBeta heu children = go where\n  go s d a b p | d == 0 || null ss = heu s\n               | otherwise         = score \n    where      \n      ss = children s p\n\n      score = either id fst $ case p of\n        True -&gt;\n          foldM step (minBound, a) ss where\n            step (v, a) s | b &lt;= a'   = Left v'\n                          | otherwise = Right (v', a')\n              where v' = max v (go s (d - 1) a b (not p))\n                    a' = max a v'                    \n        False -&gt;\n          foldM step (maxBound, b) ss where\n            step (v, b) s | b' &lt;= a   = Left v'\n                          | otherwise = Right (v', b')\n              where v' = min v (go s (d - 1) a b (not p))\n                    b' = min b v'\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4742290, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AJjnBM3UU6s/AAAAAAAAAAI/AAAAAAAAAE4/AWT4IkLZRB4/photo.jpg?sz=128", "display_name": "seedkey", "link": "https://stackoverflow.com/users/4742290/seedkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 355, "favorite_count": 0, "accepted_answer_id": 30335943, "answer_count": 1, "score": 0, "last_activity_date": 1432069531, "creation_date": 1432010940, "last_edit_date": 1432036585, "question_id": 30316971, "link": "https://stackoverflow.com/questions/30316971/update-values-in-haskell", "title": "Update values in Haskell?", "body": "<p>I'm trying to write a function that constantly takes in integer values and outputs the maximum value given so far. </p>\n\n<p>This seems as easy as a simple</p>\n\n<pre><code>max a b = maximum [a,b]\n</code></pre>\n\n<p>But the function should \"remember\" what values were given to it in the past, and compare new values with those as well.</p>\n\n<p>For example: The initial value I want to start with is <code>-500</code>. If I call my function with an argument of <code>5</code>, then it should return<code>5</code>, because 5 is greater than <code>-500</code>.</p>\n\n<p>If I then call the function again, this time with an argument of <code>3</code>, it should still returns <code>5</code>, because even though <code>3</code> is greater than <code>-500</code>, it is less than <code>5</code>.</p>\n\n<p>Is this even possible with side-effect free programming?</p>\n"}, {"tags": ["string", "haskell", "string-length", "non-exhaustive-patterns"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1432010561, "post_id": 30316833, "comment_id": 48728856, "body": "just to make sure: you may only use <code>length</code> and have to do it all using recursion and pattern matching on the list of characters?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432010666, "post_id": 30316833, "comment_id": 48728887, "body": "the error in your code is easily explained: when your second parameter (the list <code>[a]</code>) is empty <code>[]</code> you cannot match it against <code>(x:xs)</code> so you have to include a <i>case</i> for it (like <code>makeString val [] = ...</code>) in a separate line"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432010715, "post_id": 30316833, "comment_id": 48728908, "body": "also your <code>otherwise</code> case seems strange - why would you return the complete string if your <code>val</code> = 0 - don&#39;t you want the empty string there instead?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432010816, "post_id": 30316833, "comment_id": 48728939, "body": "as an additional tipp: as you see you run out of characters because you <i>drop</i>  the <code>x</code> from <code>(x:xs)</code> - maybe you want to <i>save</i> them for later use somewhere (where could this be ... <i>hint</i>: you want to somehow give them to the recursive call to <code>makeString</code> for <i>later</i> use ;) )"}, {"owner": {"reputation": 15, "user_id": 4914505, "user_type": "registered", "profile_image": "https://graph.facebook.com/711091299018540/picture?type=large", "display_name": "Ahmed Zaidi", "link": "https://stackoverflow.com/users/4914505/ahmed-zaidi"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432010820, "post_id": 30316833, "comment_id": 48728942, "body": "Yes, i am only allowed to use &quot;length&quot; and have to do it all using recursion and pattern matching. And as for your second response, i need to handle such a case separately? Is it possible if i can load my first list again and repeat doing it? Edit: I see what you are trying to say. Thank you! :)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432010864, "post_id": 30316833, "comment_id": 48728964, "body": "you cannot <i>load</i> the list from somewhere - you have to use what is given to the function - aka it&#39;s parameters"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432010908, "post_id": 30316833, "comment_id": 48728979, "body": "btw: I think you are on the right track to get <code>makeString</code> to <i>repeat</i>  the characters, you just have to figure out the details I mentioned"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1432020071, "post_id": 30316833, "comment_id": 48733275, "body": "Are you allowed to use <code>let</code> or <code>where</code>?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432021458, "post_id": 30316833, "comment_id": 48734109, "body": "@AhmedZaidi in case you don&#39;t have any more questions you should probably either answer it yourself or close/delete the question - just to keep the Haskell tag tidy ;)"}, {"owner": {"reputation": 15, "user_id": 4914505, "user_type": "registered", "profile_image": "https://graph.facebook.com/711091299018540/picture?type=large", "display_name": "Ahmed Zaidi", "link": "https://stackoverflow.com/users/4914505/ahmed-zaidi"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1432053499, "post_id": 30316833, "comment_id": 48757444, "body": "@Zeta yes i am allowed to use <code>where</code> but not let. We havent gotten that far in class."}, {"owner": {"reputation": 15, "user_id": 4914505, "user_type": "registered", "profile_image": "https://graph.facebook.com/711091299018540/picture?type=large", "display_name": "Ahmed Zaidi", "link": "https://stackoverflow.com/users/4914505/ahmed-zaidi"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1432054792, "post_id": 30316833, "comment_id": 48758220, "body": "@CarstenK&#246;nig i was actually thinking the same but since i am new to this site, i am still exploring all the features. Cant seem to find how to make a question from &quot;unanswered&quot; to &quot;answered&quot;."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1452720264, "post_id": 30316833, "comment_id": 57299725, "body": "@AhmedZaidi: You probably want to read <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\" title=\"how does accepting an answer work\">meta.stackexchange.com/questions/5234/&hellip;</a>."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1432049504, "post_id": 30324158, "comment_id": 48754705, "body": "You can drop the second parameter of <code>extend&#39;</code>."}, {"owner": {"reputation": 15, "user_id": 4914505, "user_type": "registered", "profile_image": "https://graph.facebook.com/711091299018540/picture?type=large", "display_name": "Ahmed Zaidi", "link": "https://stackoverflow.com/users/4914505/ahmed-zaidi"}, "edited": false, "score": 0, "creation_date": 1432053566, "post_id": 30324158, "comment_id": 48757483, "body": "thank you for the help! its a great pointer but i am not allowed to use any other functions other than &#39;length&#39;"}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1432065966, "post_id": 30324158, "comment_id": 48764852, "body": "@Zeta i can but is more explicit what&#39;s happen there."}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "reply_to_user": {"reputation": 15, "user_id": 4914505, "user_type": "registered", "profile_image": "https://graph.facebook.com/711091299018540/picture?type=large", "display_name": "Ahmed Zaidi", "link": "https://stackoverflow.com/users/4914505/ahmed-zaidi"}, "edited": false, "score": 0, "creation_date": 1432066076, "post_id": 30324158, "comment_id": 48764914, "body": "@AhmedZaidi you are not using any other functions. The first one is just a function which solve ur problem and i&#39;m pretty sure you are allowed to use Haskell syntaxes"}], "tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": true, "score": 1, "last_activity_date": 1432034379, "creation_date": 1432034379, "answer_id": 30324158, "question_id": 30316833, "link": "https://stackoverflow.com/questions/30316833/implementation-of-a-program-in-which-characters-of-a-string-repeated-certain-tim/30324158#30324158", "title": "Implementation of a program in which characters of a string repeated certain times in haskell", "body": "<p>I think this code is enough to solve your problem:</p>\n\n<pre><code>extend :: String -&gt; String -&gt; String\nextend src dst = extend' src src (length dst)\n    where\n        extend' :: String -&gt; String -&gt; Int -&gt; String\n        extend' _ _ 0 = []\n        extend' [] src size = extend' src src size\n        extend' (x:xs) src size  = x : extend' xs src (size - 1)\n</code></pre>\n\n<p>The <code>extend'</code> function will cycle the first string until is is consumed then will begin to consume it again.</p>\n\n<p>You can also make it using <code>take</code> and <code>cycle</code> like functions:</p>\n\n<pre><code>repeatString :: String -&gt; String\nrepeatString x = x ++ repeatString x\n\nfirstN :: Int -&gt; String -&gt; String\nfirstN 0 _ = []\nfirstN n (x:xs) = x : firstN ( n - 1 ) xs\n\nextend :: String -&gt; String -&gt; String\nextend src dst = firstN (length dst) (repeatString src)\n</code></pre>\n\n<p>or a more generic version</p>\n\n<pre><code>repeatString :: [a] -&gt; [a]\nrepeatString x = x ++ repeatString x\n\nfirstN :: (Num n, Eq n ) =&gt; n -&gt; [a] -&gt; [a]\nfirstN 0 _ = []\nfirstN n (x:xs) = x : firstN ( n - 1 ) xs\n\nextend :: [a] -&gt; [b] -&gt; [a]\nextend _ [] = error \"Empty target\"\nextend [] _ = error \"Empty source\"\nextend src dst = firstN (length dst) (repeatString src)\n</code></pre>\n\n<p>which is capable of taking any type of lists:</p>\n\n<pre><code>&gt;extend [1,2,3,4] \"foo bar\"\n[1,2,3,4,1,2,3]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 300, "user_id": 4767807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/672d5954b219fc35f495dd3a97770b67?s=128&d=identicon&r=PG&f=1", "display_name": "Damien", "link": "https://stackoverflow.com/users/4767807/damien"}, "is_accepted": false, "score": 1, "last_activity_date": 1432034994, "creation_date": 1432034994, "answer_id": 30324384, "question_id": 30316833, "link": "https://stackoverflow.com/questions/30316833/implementation-of-a-program-in-which-characters-of-a-string-repeated-certain-tim/30324384#30324384", "title": "Implementation of a program in which characters of a string repeated certain times in haskell", "body": "<p>Like Carsten said, you should </p>\n\n<ul>\n<li>handle the case when the list is empty</li>\n<li>push the first element at the end of the list when you drop it.</li>\n<li>return an empty list when n is 0 or lower</li>\n</ul>\n\n<p>For example:</p>\n\n<pre><code>makeString :: Int -&gt; [a] -&gt; [a]\nmakeString _ [] = []    -- makeString 10 \"\" should return \"\"\nmakeString n (x:xs)\n    | n &gt; 0 = x:makeString (n-1) (xs++[x])\n    | otherwise = []    -- makeString 0 \"key\" should return \"\"\n</code></pre>\n\n<p>trying this in ghci :</p>\n\n<pre><code>&gt;makeString (length \"Ahmed\") \"Key\"\n\"KeyKe\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 0, "last_activity_date": 1452720317, "creation_date": 1452720317, "answer_id": 34777305, "question_id": 30316833, "link": "https://stackoverflow.com/questions/30316833/implementation-of-a-program-in-which-characters-of-a-string-repeated-certain-tim/34777305#34777305", "title": "Implementation of a program in which characters of a string repeated certain times in haskell", "body": "<p><sup>Note: This answer is written in <a href=\"https://wiki.haskell.org/Literate_programming\" rel=\"nofollow\">literate Haskell</a>. Save it as <code>Filename.lhs</code> and try it in GHCi.</sup></p>\n\n<p>I think that <code>length</code> is a <a href=\"http://en.wikipedia.org/wiki/Red_herring\" rel=\"nofollow\">red herring</a> in this case. You can solve this solely with recursion and pattern matching, which will even work on <em>very long lists</em>. But first things first. </p>\n\n<p>What type should our function have? We're taking two strings, and we will repeat the first string over and over again, which sounds like <code>String -&gt; String -&gt; String</code>. However, this \"repeat over and over\" thing isn't really unique to strings: you can do that with every kind of list, so we pick the following type:</p>\n\n<pre><code>&gt; repeatFirst :: [a] -&gt; [b] -&gt; [a]\n&gt; repeatFirst as bs = go as bs\n</code></pre>\n\n<p>Ok, so far nothing fancy happened, right? We defined <code>repeatFirst</code> in terms of <code>go</code>, which is still missing. In <code>go</code> we want to exchange the items of <code>bs</code> with the corresponding items of <code>as</code>, so we already know a base case, namely what should happen if <code>bs</code> is empty:</p>\n\n<pre><code>&gt;    where go  _     []     = []\n</code></pre>\n\n<p>What if <code>bs</code> isn't empty? In this case we want to use the right item from <code>as</code>. So we should traverse both at the same time:</p>\n\n<pre><code>&gt;          go (x:xs) (_:ys) = x : go xs ys\n</code></pre>\n\n<p>We're currently handling the following cases: empty second argument list, and non-empty lists. We still need to handle the empty first argument list:</p>\n\n<pre><code>&gt;          go []     ys     = \n</code></pre>\n\n<p>What should happen in this case? Well, we need to start again with <code>as</code>. And indeed, this works:</p>\n\n<pre><code>&gt;                              go as ys\n</code></pre>\n\n<p>Here's everything again at a single place:</p>\n\n<pre><code>repeatFirst :: [a] -&gt; [b] -&gt; [a]\nrepeatFirst as bs = go as bs\n   where go  _     []     = []\n         go (x:xs) (_:ys) = x : go xs ys\n         go []     ys     =     go as ys\n</code></pre>\n\n<p>Note that you could use <code>cycle</code>, <code>zipWith</code> and <code>const</code> instead if you didn't have constraints:</p>\n\n<pre><code>repeatFirst :: [a] -&gt; [b] -&gt; [a]\nrepeatFirst = zipWith const . cycle\n</code></pre>\n\n<p>But that's probably for another question.</p>\n"}], "owner": {"reputation": 15, "user_id": 4914505, "user_type": "registered", "profile_image": "https://graph.facebook.com/711091299018540/picture?type=large", "display_name": "Ahmed Zaidi", "link": "https://stackoverflow.com/users/4914505/ahmed-zaidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 30324158, "answer_count": 3, "score": 0, "last_activity_date": 1452720353, "creation_date": 1432010109, "last_edit_date": 1432011703, "question_id": 30316833, "link": "https://stackoverflow.com/questions/30316833/implementation-of-a-program-in-which-characters-of-a-string-repeated-certain-tim", "title": "Implementation of a program in which characters of a string repeated certain times in haskell", "body": "<p>This is a question from my homework thus tips would be much likely appreciated.</p>\n\n<p>I am learning <em>Haskell</em> this semester and my first assignment requires me to write a function that inputs 2 string (<code>string1</code> and  <code>string2</code>) and returns a string that is composed of (the repeated) characters of first string <code>string1</code>  until a string of same length as <code>string2</code> has been created. </p>\n\n<p>I am only allowed to use the <em>Prelude</em> function <code>length</code>.</p>\n\n<p>For example: take as <code>string1</code> <code>\"Key\"</code> and my name <code>\"Ahmed\"</code> as <code>string2</code> the function should return <code>\"KeyKe\"</code>.</p>\n\n<p>Here is what I've got so far:</p>\n\n<pre><code>    makeString :: Int -&gt; [a] -&gt; [a]\n    makeString val (x:xs)\n        | val &gt; 0 = x : makeString (val-1) xs\n        | otherwise = x:xs\n</code></pre>\n\n<p>Instead of directly giving it two strings i am giving it an integer value (since i can subtitute it for length later on), but this is giving me a runtime-error:</p>\n\n<pre><code>*Main&gt; makeString 8 \"ahmed\"\n\n\"ahmed*** Exception: FirstScript.hs: (21,1)-(23,21) : Non-exhaustive patterns in function makeString\n</code></pre>\n\n<p>I think it might have something to do my list running out and becoming an empty list(?).</p>\n\n<p>A little help would be much appreciated.</p>\n"}, {"tags": ["haskell", "polymorphism", "memoization"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1431983820, "post_id": 30312891, "comment_id": 48721191, "body": "How exactly is this question different from <a href=\"http://stackoverflow.com/questions/25057803/is-there-an-automatic-way-to-memoise-global-polymorphic-values-in-haskell\">my earlier one</a>?"}, {"owner": {"reputation": 433, "user_id": 3728012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58cea308cea64991e4f3ebc0271dd01?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Peikert", "link": "https://stackoverflow.com/users/3728012/chris-peikert"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1431985204, "post_id": 30312891, "comment_id": 48721819, "body": "From what I can tell, the costliness in your question comes from recursion combined with dictionary passing, which causes exponential reevaluation. Once the latter is fixed, the computation itself is fast. But if two modules referred to fibsImplicitDict, they&#39;d get different thunks that would be evaluated separately. I can&#39;t afford that, because my computation is inherently expensive (not due to recursion)."}, {"owner": {"reputation": 433, "user_id": 3728012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58cea308cea64991e4f3ebc0271dd01?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Peikert", "link": "https://stackoverflow.com/users/3728012/chris-peikert"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1431985645, "post_id": 30312891, "comment_id": 48722004, "body": "PS -- the fact that there are class instances with constraints on them is also playing a role here, it seems."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1431988484, "post_id": 30312891, "comment_id": 48723058, "body": "Do you need to use a type class here? If it only has the one instance, you shouldn&#39;t need it."}, {"owner": {"reputation": 433, "user_id": 3728012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58cea308cea64991e4f3ebc0271dd01?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Peikert", "link": "https://stackoverflow.com/users/3728012/chris-peikert"}, "edited": false, "score": 0, "creation_date": 1431988776, "post_id": 30312891, "comment_id": 48723151, "body": "In my real program, yes -- I have many instances.  Costly represents a ring that has roots of unity, and I have instances for complex numbers, integers mod q, finite fields, etc.  Their roots of unity aren&#39;t cheap enough to recompute all over the place."}], "answers": [{"comments": [{"owner": {"reputation": 433, "user_id": 3728012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58cea308cea64991e4f3ebc0271dd01?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Peikert", "link": "https://stackoverflow.com/users/3728012/chris-peikert"}, "edited": false, "score": 0, "creation_date": 1432060387, "post_id": 30333329, "comment_id": 48761557, "body": "Outstanding!  I had tried the memo trick, and NOINLINE with SPECIALIZE (only to get the same error), but hadn&#39;t thought to combine them in this way.  This trick will work for some of my global values, but for others I can&#39;t SPECIALIZE because I only know the concrete types at the topmost application module.  Is there any hope for that case?"}, {"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "reply_to_user": {"reputation": 433, "user_id": 3728012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58cea308cea64991e4f3ebc0271dd01?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Peikert", "link": "https://stackoverflow.com/users/3728012/chris-peikert"}, "edited": false, "score": 0, "creation_date": 1432060581, "post_id": 30333329, "comment_id": 48761667, "body": "@ChrisPeikert I haven&#39;t checked, but maybe inlining <code>costly</code> could achieve the same effect as specialization in this case?"}, {"owner": {"reputation": 433, "user_id": 3728012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58cea308cea64991e4f3ebc0271dd01?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Peikert", "link": "https://stackoverflow.com/users/3728012/chris-peikert"}, "edited": false, "score": 0, "creation_date": 1432060657, "post_id": 30333329, "comment_id": 48761707, "body": "Right, inlining is the opposite of what I want (i.e., sharing)."}, {"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "reply_to_user": {"reputation": 433, "user_id": 3728012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58cea308cea64991e4f3ebc0271dd01?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Peikert", "link": "https://stackoverflow.com/users/3728012/chris-peikert"}, "edited": false, "score": 0, "creation_date": 1432061115, "post_id": 30333329, "comment_id": 48761958, "body": "@ChrisPeikert I don&#39;t think this is possible. If GHC doesn&#39;t know in advance which types the function should be memoized for, there is no way to make the appropriate &quot;top-level memos&quot; that store the memoized value. The only way this could work is if you inlined all functions using <code>costly</code> and then somehow arranged for all the memos to be floated out and eliminated by CSE. I doubt that this would work reliably though ..."}, {"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "reply_to_user": {"reputation": 433, "user_id": 3728012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58cea308cea64991e4f3ebc0271dd01?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Peikert", "link": "https://stackoverflow.com/users/3728012/chris-peikert"}, "edited": false, "score": 0, "creation_date": 1432061211, "post_id": 30333329, "comment_id": 48762016, "body": "Or alternatively, get GHC to auto-specialize costly and CSE all the specializations of <code>memo</code> for the same type."}], "tags": [], "owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "is_accepted": true, "score": 6, "last_activity_date": 1432059951, "creation_date": 1432059951, "answer_id": 30333329, "question_id": 30312891, "link": "https://stackoverflow.com/questions/30312891/reuse-memoization-of-global-polymorphic-class-values-in-haskell/30333329#30333329", "title": "reuse/memoization of global polymorphic (class) values in Haskell", "body": "<p>Controlling sharing is tricky in GHC. There are many optimizations that GHC does which can affect sharing (such as inlining, floating things out, etc).</p>\n\n<p>In this case, to answer the question why the SPECIALIZE pragma did not achieve the intended effect, let's look at the Core of the B module, in particular of the <code>bar</code> function:</p>\n\n<pre><code>Rec {\nbar_xs\nbar_xs = : x1_r3lO bar_xs\nend Rec }\n\nbar1 = $w!! bar_xs 10000000\n--     ^^^ this repeats the computation. bar_xs is just repeat 1\n\nbar =\n  case trace $fCostlyi2 bar1 of _ { I# x_aDm -&gt; I# (+# x_aDm 2) }\n  --         ^^^ this is just the \"costly!\" string\n</code></pre>\n\n<p>That didn't work as we wanted. Instead of reusing <code>costly</code>, GHC decided to just inline the <code>costly</code> function.</p>\n\n<p>So we have to prevent GHC from inlining costly, or the computation will be duplicated. How do we do that? You might think adding a <code>{-# NOINLINE costly #-}</code> pragma would be enough, but unfortunately specialization without inlining don't seem to work together well:</p>\n\n<pre><code>A.hs:13:3: Warning:\n    Ignoring useless SPECIALISE pragma for NOINLINE function: \u2018$ccostly\u2019\n</code></pre>\n\n<p>But there is a trick to convince GHC to do what we want: we can write <code>costly</code> in the following way:</p>\n\n<pre><code>instance Num i =&gt; Costly i where\n  -- an expensive (but non-recursive) computation\n  costly = memo where\n    memo :: i\n    memo = trace \"costly!\" $ (repeat 1) !! 10000000\n    {-# NOINLINE memo #-}\n  {-# SPECIALIZE instance Costly Int #-}\n-- (this might require -XScopedTypeVariables)\n</code></pre>\n\n<p>This allows us to specialize <code>costly</code>, will simultanously avoiding the inlining of our computation. </p>\n"}], "owner": {"reputation": 433, "user_id": 3728012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c58cea308cea64991e4f3ebc0271dd01?s=128&d=identicon&r=PG&f=1", "display_name": "Chris Peikert", "link": "https://stackoverflow.com/users/3728012/chris-peikert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 30333329, "answer_count": 1, "score": 8, "last_activity_date": 1432059951, "creation_date": 1431983542, "last_edit_date": 1495535480, "question_id": 30312891, "link": "https://stackoverflow.com/questions/30312891/reuse-memoization-of-global-polymorphic-class-values-in-haskell", "title": "reuse/memoization of global polymorphic (class) values in Haskell", "body": "<p>I'm concerned with if and when a polymorphic \"global\" <em>class value</em> is shared/memoized, particularly across module boundaries.  I have read <a href=\"https://stackoverflow.com/questions/3951012/when-is-memoization-automatic-in-ghc-haskell\">this</a> and <a href=\"https://stackoverflow.com/questions/25057803/is-there-an-automatic-way-to-memoise-global-polymorphic-values-in-haskell\">this</a>, but they don't quite seem to reflect my situation, and I'm seeing some different behavior from what one might expect from the answers.</p>\n\n<p>Consider a class that exposes a value that can be expensive to compute:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, UndecidableInstances #-}\n\nmodule A\n\nimport Debug.Trace\n\nclass Costly a where\n  costly :: a\n\ninstance Num i =&gt; Costly i where\n  -- an expensive (but non-recursive) computation\n  costly = trace \"costly!\" $ (repeat 1) !! 10000000\n\nfoo :: Int\nfoo = costly + 1\n\ncostlyInt :: Int\ncostlyInt = costly\n</code></pre>\n\n<p>And a separate module:</p>\n\n<pre><code>module B\nimport A\n\nbar :: Int\nbar = costly + 2\n\nmain = do\n  print foo\n  print bar\n  print costlyInt\n  print costlyInt\n</code></pre>\n\n<p>Running <code>main</code> yields two separate evaluations of <code>costly</code> (as indicated by the trace): one for <code>foo</code>, and one for <code>bar</code>.  I know that <code>costlyInt</code> just returns the (evaluated) <code>costly</code> from <code>foo</code>, because if I remove <code>print foo</code> from <code>main</code> then the first <code>costlyInt</code> becomes costly.  (I can also cause <code>costlyInt</code> to perform a separate evaluation no matter what, by generalizing the type of <code>foo</code> to <code>Num a =&gt; a</code>.)</p>\n\n<p>I think I know why this behavior happens: the instance of <code>Costly</code> is effectively a function that takes a <code>Num</code> dictionary and generates a <code>Costly</code> dictionary.  So when compiling <code>bar</code> and resolving the reference to <code>costly</code>, ghc generates a fresh <code>Costly</code> dictionary, which has an expensive thunk in it.  Question 1: am I correct about this?</p>\n\n<p>There are a few ways to cause just one evaluation of <code>costly</code>, including:</p>\n\n<ul>\n<li>Put everything in one module.</li>\n<li>Remove the <code>Num i</code> instance constraint and just define a <code>Costly Int</code> instance.</li>\n</ul>\n\n<p>Unfortunately, the analogs of these solutions are not feasible in my program -- I have several modules that use the class value in its polymorphic form, and only in the top-level source file are concrete types finally used.</p>\n\n<p>There are also changes that <em>don't</em> reduce the number of evaluations, such as:</p>\n\n<ul>\n<li>Using INLINE, INLINABLE, or NOINLINE on the <code>costly</code> definition in the instance.  (I didn't expect this to work, but hey, worth a shot.)</li>\n<li>Using a <code>SPECIALIZE instance Costly Int</code> pragma in the instance definition.</li>\n</ul>\n\n<p>The latter is surprising to me -- I'd expected it to be essentially equivalent to the second item above that <em>did</em> work.  That is, I thought it would generate a special <code>Costly Int</code> dictionary, which all of <code>foo</code>, <code>bar</code>, and <code>costlyInt</code> would share.  My question 2: what am I missing here? </p>\n\n<p>My final question: is there any relatively simple and foolproof way to get what I want, i.e., all references to <code>costly</code> of a particular concrete type being shared across modules?  From what I've seen so far, I suspect the answer is no, but I'm still holding out hope.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1431985788, "post_id": 30312722, "comment_id": 48722061, "body": "Note that this is probably a lousy way to calculate the area of a triangle. I&#39;m no expert, but I think you&#39;ll probably get more precise results much more quickly by taking the magnitude of the cross product of <code>p2-p1</code> with <code>p3-p1</code>."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1431983531, "post_id": 30312849, "comment_id": 48721057, "body": "Right, except <code>Float</code> <a href=\"https://wiki.haskell.org/Performance/Floating_point\" rel=\"nofollow noreferrer\">shouldn&#39;t be used at all</a> (or, only as a space optimisation in unboxed arrays)."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1431983592, "post_id": 30312849, "comment_id": 48721083, "body": "@leftaroundabout I&#39;d say that&#39;s a bit beyond the scope of this question, but yes, <code>Double</code> would be a better choice here."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431984612, "post_id": 30312849, "comment_id": 48721539, "body": "Isn&#39;t this a <code>RealFloat</code> thing?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1431984767, "post_id": 30312849, "comment_id": 48721633, "body": "@leftaroundabout, <code>Float</code> is also the way to go if you&#39;re implementing something specifically tuned for single-precision floating point (e.g., from a numerical algorithms cookbook), but that certainly does not seem to be the case here."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1432023190, "post_id": 30312849, "comment_id": 48735201, "body": "@dfeuer: it might, but really you can only get any significant performance benefit from float when running on a 32-bit / RISC processor. On x86-64, only vectorised instructions (SSE etc.) can give <code>Float</code> much of a boost; I think GHC starts being able to benefit from this, but it&#39;s still not something you&#39;d consider before unboxing your arrays."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1432041980, "post_id": 30312849, "comment_id": 48748309, "body": "@leftaroundabout, I wasn&#39;t talking about speed; I was talking about precision. If an algorithm is specifically designed for <code>Float</code> (e.g., with specific corrections for the expected rounding), it may not work properly with <code>Double</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1432042711, "post_id": 30312849, "comment_id": 48748946, "body": "@dfeuer: well \u2013 somebody who implements algorithms like that should surely be aware of all subtleties and not heed any so basic advice. (Apart from that: in many of these cases you&#39;ll probably get better results if you throw away all of the corrections and switch to <code>Double</code>.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1432043487, "post_id": 30312849, "comment_id": 48749642, "body": "@leftaroundabout, true though that last bit may be, it may not always be obvious where the corrections are that you need to throw away!"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 2, "last_activity_date": 1431983281, "creation_date": 1431983281, "answer_id": 30312849, "question_id": 30312722, "link": "https://stackoverflow.com/questions/30312722/polygon-area-haskell/30312849#30312849", "title": "Polygon area - Haskell", "body": "<p><code>distBetween</code> works on two pairs of <code>Float</code>s, but <code>v1</code>, <code>v2</code>, and <code>v3</code> are all just single <code>Float</code>s.  If you had</p>\n\n<pre><code>-- Just creates an alias for `(Float, Float)`, since otherwise it'd be a lot of typing\ntype Point = (Float, Float)\n</code></pre>\n\n<p>Then you can write this as</p>\n\n<pre><code>distBetween :: Point -&gt; Point -&gt; Float\ndistBetween (x1, y1) (x2, y2) = sqrt $ (x1-x2)^2 + (y1-y2)^2\n-- You also had a typo in your distance function here    ^\n\nar :: (Point, Point, Point) -&gt; Float\nar (v1, v2, v3) =\n    let a = distBetween v1 v2\n        b = distBetween v2 v3\n        c = distBetween v3 v1\n        s = 0.5 * (a + b + c)\n    in sqrt $ s * (s - a) * (s - b) * (s - c)\n</code></pre>\n\n<p>Then it will compile just fine.  Since you had told the compiler that <code>v1</code>, <code>v2</code>, and <code>v3</code> were all just <code>Float</code>s, it just couldn't match that with <code>(Float, Float)</code> as needed for the arguments to <code>distBetween</code>.</p>\n"}], "owner": {"reputation": 19, "user_id": 4907791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3e3336ba3550b86c5191d4052f62cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/4907791/andi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 695, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431985075, "creation_date": 1431982744, "last_edit_date": 1431985075, "question_id": 30312722, "link": "https://stackoverflow.com/questions/30312722/polygon-area-haskell", "title": "Polygon area - Haskell", "body": "<p>I want to calculate the area of a polygon, but the code implemented by me doesn't work. Can someone help me with a better solution?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>ar :: (Float,Float,Float)-&gt; Float\nar (v1,v2,v3) = let a=distBetween v1 v2\n        b=distBetween v2 v3\n        c=distBetween v3 v1\n        s=0.5*(a+b+c)\n        in sqrt (s*(s-a)*(s-b)*(s-c))\n\ndistBetween :: (Float,Float)-&gt;(Float,Float)-&gt;Float\ndistBetween (x1,y1) (x2,y2) = sqrt ((x1-x2)^2+(y1-y2^2))\n</code></pre>\n\n<p>And this is my error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Type error in application\n*** Expression     : distBetween v1 v2\n*** Term           : v2\n*** Type           : Float\n*** Does not match : (Float,Float)\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "script-tag", "yesod-forms"], "answers": [{"comments": [{"owner": {"reputation": 590, "user_id": 3029543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100004855955180/picture?type=large", "display_name": "ptkato", "link": "https://stackoverflow.com/users/3029543/ptkato"}, "edited": false, "score": 0, "creation_date": 1445471453, "post_id": 30316882, "comment_id": 54343369, "body": "Can I change the <code>jsLoader</code>?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 590, "user_id": 3029543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100004855955180/picture?type=large", "display_name": "ptkato", "link": "https://stackoverflow.com/users/3029543/ptkato"}, "edited": false, "score": 0, "creation_date": 1445484789, "post_id": 30316882, "comment_id": 54346717, "body": "Yes, when declaring your Yesod instance"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 5, "last_activity_date": 1432010410, "creation_date": 1432010410, "answer_id": 30316882, "question_id": 30311520, "link": "https://stackoverflow.com/questions/30311520/yesod-how-to-make-addscriptremote-add-the-script-in-the-head-section/30316882#30316882", "title": "Yesod - how to make addScriptRemote add the script in the head section?", "body": "<p>Where scripts get placed will depend on <a href=\"https://www.stackage.org/haddock/lts-2.9/yesod-core-1.4.9.1/Yesod-Core.html#v:jsLoader\" rel=\"noreferrer\">jsLoader</a>. If you want to make a change for a specific script, you can use <code>toWidgetHead [hamlet|&lt;script src=...\"&gt;|]</code>.</p>\n"}], "owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "accepted_answer_id": 30316882, "answer_count": 1, "score": 5, "last_activity_date": 1432010970, "creation_date": 1431977954, "last_edit_date": 1432010970, "question_id": 30311520, "link": "https://stackoverflow.com/questions/30311520/yesod-how-to-make-addscriptremote-add-the-script-in-the-head-section", "title": "Yesod - how to make addScriptRemote add the script in the head section?", "body": "<p>In Yesod/Haskell, I'd like to call addScriptRemote and have it add the <code>&lt;script&gt;</code> tag in the head section. As is, it seems to add the script only to the body section.</p>\n"}, {"tags": ["haskell", "cabal", "cabal-install"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1431973470, "post_id": 30310179, "comment_id": 48715916, "body": "Why is this surprising, if you used <code>--allow-newer</code> when installing your project but not when installing interpolate-0.1.0? Presumably the version of haskell-src-meta that built successfully in the latter case was not 0.6.0.9, the version cabal thought it could use when you installed with <code>--allow-newer</code>."}, {"owner": {"reputation": 677, "user_id": 2659595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62be5bdb8707d16bd9247792d857d296?s=128&d=identicon&r=PG", "display_name": "tom", "link": "https://stackoverflow.com/users/2659595/tom"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1431974901, "post_id": 30310179, "comment_id": 48716669, "body": "Oh, good point. Maybe I shouldn&#39;t be using <code>--allow-newer</code> so indiscriminately. I&#39;m retrying to test this, will let you know how it goes!"}], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 5, "last_activity_date": 1431974987, "creation_date": 1431974987, "answer_id": 30310779, "question_id": 30310179, "link": "https://stackoverflow.com/questions/30310179/cabal-fails-to-install-dependencies-but-can-install-them-if-asked-directly/30310779#30310779", "title": "Cabal fails to install dependencies, but can install them if asked directly", "body": "<p>Actually it's not a problem with the version of <code>haskell-src-meta</code> but rather with the version of its dependency <code>th-orphans</code>.</p>\n\n<p><code>haskell-src-meta</code> (versions 0.6.0.8 and 0.6.0.9) has an upper bound <code>th-orphans &lt;0.12</code>.</p>\n\n<p>With <code>--allow-newer</code> you told Cabal to ignore version upper bounds, so Cabal decided to use <code>th-orphans</code> version 0.12.0, since it's newer and presumably better. But, in fact, <code>haskell-src-meta</code> really does not build with <code>th-orphans</code> version 0.12.0, as you found out.</p>\n\n<p>Unrestricted use of <code>--allow-newer</code> is likely to run into this kind of problem in general. It's better to specify the packages whose upper bounds you want to ignore with <code>--allow-newer=base,containers,...</code>, though in some cases doing so can be rather tedious.</p>\n\n<p>In the first sentence of your question you mentioned repeatable builds. If that is what you want, there is no substitute for simply recording the exact versions that you want of all of your direct and indirect dependencies.</p>\n"}], "owner": {"reputation": 677, "user_id": 2659595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62be5bdb8707d16bd9247792d857d296?s=128&d=identicon&r=PG", "display_name": "tom", "link": "https://stackoverflow.com/users/2659595/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 0, "accepted_answer_id": 30310779, "answer_count": 1, "score": 3, "last_activity_date": 1431974987, "creation_date": 1431972839, "question_id": 30310179, "link": "https://stackoverflow.com/questions/30310179/cabal-fails-to-install-dependencies-but-can-install-them-if-asked-directly", "title": "Cabal fails to install dependencies, but can install them if asked directly", "body": "<p>I've seen a very strange recurring problem with Cabal that's interfering with my ability to get repeatable Haskell builds. I have a cabal project with a sandbox. If I do <code>cabal install</code>, I get errors of the form</p>\n\n<p><code>Y failed during the building phase. The exception was:\nExitFailure 1\nX depends on Y which failed to install.\n</code></p>\n\n<p>where X is a direct dependency of my project and Y is some transitive dependency. However, if I just type <code>cabal install X</code>, then it works!</p>\n\n<p>Here's a specific example: my project depends on the <code>interpolate</code> package. When I do <code>cabal install --allow-newer</code>, I get errors like this:</p>\n\n<pre><code>Resolving dependencies...\nConfiguring haskell-src-meta-0.6.0.9...\nBuilding haskell-src-meta-0.6.0.9...\nPreprocessing library haskell-src-meta-0.6.0.9...\n[1 of 6] Compiling Language.Haskell.TH.Instances.Lift ( src/Language/Haskell/TH/Instances/Lift.hs, dist/dist-sandbox-d2861272/build/Language/Haskell/TH/Instances/Lift.o )\n[2 of 6] Compiling Language.Haskell.Meta.Syntax.Translate ( src/Language/Haskell/Meta/Syntax/Translate.hs, dist/dist-sandbox-d2861272/build/Language/Haskell/Meta/Syntax/Translate.o )\n[3 of 6] Compiling Language.Haskell.Meta.Parse ( src/Language/Haskell/Meta/Parse.hs, dist/dist-sandbox-d2861272/build/Language/Haskell/Meta/Parse.o )\n[4 of 6] Compiling Language.Haskell.Meta.Parse.Careful ( src/Language/Haskell/Meta/Parse/Careful.hs, dist/dist-sandbox-d2861272/build/Language/Haskell/Meta/Parse/Careful.o )\n[5 of 6] Compiling Language.Haskell.Meta ( src/Language/Haskell/Meta.hs, dist/dist-sandbox-d2861272/build/Language/Haskell/Meta.o )\n[6 of 6] Compiling Language.Haskell.Meta.Utils ( src/Language/Haskell/Meta/Utils.hs, dist/dist-sandbox-d2861272/build/Language/Haskell/Meta/Utils.o )\n\nsrc/Language/Haskell/Meta/Utils.hs:67:1:\n    Duplicate instance declarations:\n      instance Typeable Q\n        -- Defined at src/Language/Haskell/Meta/Utils.hs:67:1\n      instance Typeable Q -- Defined in \u2018Language.Haskell.TH.Instances\u2019\n\nsrc/Language/Haskell/Meta/Utils.hs:71:1:\n    Duplicate instance declarations:\n      instance Typeable QuasiQuoter\n        -- Defined at src/Language/Haskell/Meta/Utils.hs:71:1\n      instance Typeable QuasiQuoter\n        -- Defined in \u2018Language.Haskell.TH.Instances\u2019\nFailed to install haskell-src-meta-0.6.0.9\n\n...\n\nhaskell-src-meta-0.6.0.9 failed during the building phase. The exception was:\nExitFailure 1\ninterpolate-0.1.0 depends on haskell-src-meta-0.6.0.9 which failed to install.\n</code></pre>\n\n<p><em>However</em>, if I proceed to type <code>cabal install interpolate-0.1.0</code>, the installation <em>succeeds</em> and I'm able to keep installing my project.</p>\n\n<p>This is frustrating because I have to \"manually\" install several packages before I can get all my dependencies installed. The fact that the original installations fail with compiler errors seems to suggest that the compiler is configured differently somehow?</p>\n\n<p>I'm using GHC 7.8.3 and cabal-install 1.22.4.0 (version 1.22.3.0 of the Cabal library). Many thanks for any help!</p>\n"}, {"tags": ["haskell", "markdown", "interpolation", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "edited": false, "score": 0, "creation_date": 1431986647, "post_id": 30311052, "comment_id": 48722400, "body": "Yes, I use it (and <code>widgetFile</code>) a lot and I believe it gives a <code>widget</code> as a result. Though it will help with interpolation, I guess it expects a hamlet as input and will not give a possibility to apply <code>markdown</code> function to result. Also it seems that widget is a rendered HTML but <code>markdown</code> takes a lazy Text."}], "tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": false, "score": 0, "last_activity_date": 1431976103, "creation_date": 1431976103, "answer_id": 30311052, "question_id": 30308892, "link": "https://stackoverflow.com/questions/30308892/haskell-yesod-how-to-read-text-from-file-and-apply-variable-interpolation-to-it/30311052#30311052", "title": "Haskell Yesod: How to read text from file and apply variable interpolation to its content?", "body": "<p>There is function called whamletFile (<a href=\"http://hackage.haskell.org/package/yesod-core-1.4.9.1/docs/Yesod-Core-Widget.html#v:whamletFile\" rel=\"nofollow\">http://hackage.haskell.org/package/yesod-core-1.4.9.1/docs/Yesod-Core-Widget.html#v:whamletFile</a>) that does exactly what you want, I think. See some more info at <a href=\"https://www.safaribooksonline.com/library/view/developing-web-applications/9781449336868/ch05s06.html\" rel=\"nofollow\">https://www.safaribooksonline.com/library/view/developing-web-applications/9781449336868/ch05s06.html</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "edited": false, "score": 0, "creation_date": 1510181473, "post_id": 30409959, "comment_id": 81331546, "body": "Do you have any idea how to do this if the filename is dynamic, say an argument to the handler?"}, {"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "reply_to_user": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "edited": false, "score": 0, "creation_date": 1510348518, "post_id": 30409959, "comment_id": 81413162, "body": "@Isund, I believe there is a workaround, but I have no quick answer for you now."}], "tags": [], "owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "is_accepted": true, "score": 1, "last_activity_date": 1432371331, "last_edit_date": 1432371331, "creation_date": 1432364711, "answer_id": 30409959, "question_id": 30308892, "link": "https://stackoverflow.com/questions/30308892/haskell-yesod-how-to-read-text-from-file-and-apply-variable-interpolation-to-it/30409959#30409959", "title": "Haskell Yesod: How to read text from file and apply variable interpolation to its content?", "body": "<p>Well, finally I've found really simple solution.</p>\n\n<p>Any quasi quoter could be easily switched to file input rather than inline text with <code>quoteFile</code> function from <code>Language.Haskell.TH.Quote</code> module<sup><a href=\"http://www.stackage.org/haddock/lts-2.9/template-haskell-2.9.0.0/Language-Haskell-TH-Quote.html#v:quoteFile\" rel=\"nofollow\">1</a></sup>. Let's describe in <code>Foundation</code> module following function:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>import           Language.Haskell.TH.Quote (QuasiQuoter, quoteFile)\nimport           Text.Shakespeare.Text     (st)\n\nstFile :: QuasiQuoter\nstFile = quoteFile st\n</code></pre>\n\n<p>Now we can use this new quasi quoter in handler modules:</p>\n\n<pre><code>-- file: Handler.SomeHandler.hs\nimport           Foundation       (stFile)\nimport           Text.Markdown    (markdown)\nimport qualified Data.Text.Lazy   as L\n\ngetSomeHandlerR :: Handler Html\ngetSomeHandlerR =\n  do let userName = \"Guest\" :: Text\n         -- | `interpolated` is a strict `Text`\n         interpolated = [stFile|text-input.md|]\n         md           = markdown def (L.fromStrict interpolated)\n     defaultLayout [whamlet|&lt;div .static-content&gt;#{md}|]\n\n-- file: text-input.md\n# Welcome!\nHello, **#{userName}**!\n</code></pre>\n\n<p>This will produce following content:</p>\n\n\n\n<pre><code>&lt;div class=\"static-content\"&gt;\n    &lt;h1&gt;Welcome!&lt;/h1&gt;\n    &lt;p&gt;Hello, &lt;b&gt;Guest&lt;/b&gt;!&lt;/p&gt;\n</code></pre>\n\n<p>That's all!</p>\n"}], "owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 30409959, "answer_count": 2, "score": 1, "last_activity_date": 1432371331, "creation_date": 1431968113, "last_edit_date": 1431968416, "question_id": 30308892, "link": "https://stackoverflow.com/questions/30308892/haskell-yesod-how-to-read-text-from-file-and-apply-variable-interpolation-to-it", "title": "Haskell Yesod: How to read text from file and apply variable interpolation to its content?", "body": "<p>I have quite big markdown text hardcoded inside my handler function currently. To render it I use <code>whamlet</code> quasiquoter and <code>Text.Markdown.markdown</code> from <code>markdown</code> package:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>let md :: L.Text\n    md = \"#Some markdown stuff\"\nauthLayout $\n    [whamlet|\n        &lt;div .StaticContent&gt;\n            #{markdown def md}\n        |]\n</code></pre>\n\n<p>There are some hardcoded links in the text but I'd rather use variable interpolation.<br>\nI want to put this big text into external file, read its contents (this is a markdown with placeholders), apply interpolation (final markdown to be converted into HTML) and finally output the result. How can I do this?  </p>\n"}, {"tags": ["haskell", "textview", "gtk", "gtk2hs"], "comments": [{"owner": {"reputation": 10424, "user_id": 3408572, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/0f3a08b145553b98749d3d0572d01265?s=128&d=identicon&r=PG&f=1", "display_name": "andlabs", "link": "https://stackoverflow.com/users/3408572/andlabs"}, "edited": false, "score": 1, "creation_date": 1432404627, "post_id": 30308529, "comment_id": 48918093, "body": "<a href=\"http://blogs.msdn.com/b/oldnewthing/archive/2009/08/04/9856634.aspx\" rel=\"nofollow noreferrer\">Snap some blocks together</a>: <a href=\"https://developer.gnome.org/gtk2/stable/GtkTextBuffer.html\" rel=\"nofollow noreferrer\"><code>gtk_text_buffer_get_text()</code> + <code>gtk_text_buffer_get_iter_at_offset()</code> + <code>gtk_text_buffer_apply_tag()</code></a>. I don&#39;t know what the gtk2hs equivalents to these are. What are you trying to do?"}], "owner": {"reputation": 123, "user_id": 4306316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0c7e3af9fbf4fab6c001381969b475e?s=128&d=identicon&r=PG&f=1", "display_name": "user297876", "link": "https://stackoverflow.com/users/4306316/user297876"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1431966869, "creation_date": 1431966869, "question_id": 30308529, "link": "https://stackoverflow.com/questions/30308529/gtk2hs-textview-find-substring-and-color-it", "title": "gtk2hs textview find substring and color it", "body": "<p>I've made a window in Haskell using GTK (gtk2hs library) and added a Text View to it. Now I'm trying to find a specific sub-string in the Text View buffer and change it's foreground color. How can I do that ?</p>\n"}, {"tags": ["haskell", "graph", "polymorphism", "typeclass"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431965096, "post_id": 30307450, "comment_id": 48711272, "body": "Ask yourself: How is the compiler supposed to know what type <code>v</code> is?"}, {"owner": {"reputation": 320, "user_id": 600970, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/83b88466713b8815acba29d7d8c81ea3?s=128&d=identicon&r=PG", "display_name": "Mortimer McMire", "link": "https://stackoverflow.com/users/600970/mortimer-mcmire"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431967436, "post_id": 30307450, "comment_id": 48712771, "body": "I&#39;m aware that this is an issue - see &quot;Problem 1&quot; and &quot;Problem 2&quot; in my question. The challenge was finding a good solution to the issue."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1431969333, "post_id": 30307450, "comment_id": 48713773, "body": "Type families would be ideal in this case, then. Look at the <code>GHC.Exts</code> package&#39;s <code>IsList</code> class if you want to see what I mean."}], "answers": [{"comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1431965118, "post_id": 30307896, "comment_id": 48711287, "body": "I started writing an answer, and I was so busy describing fundeps and ATs that I completely missed the obvious Haskell 2010 solution. Well played!"}, {"owner": {"reputation": 320, "user_id": 600970, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/83b88466713b8815acba29d7d8c81ea3?s=128&d=identicon&r=PG", "display_name": "Mortimer McMire", "link": "https://stackoverflow.com/users/600970/mortimer-mcmire"}, "edited": false, "score": 0, "creation_date": 1431967312, "post_id": 30307896, "comment_id": 48712703, "body": "Wow. I was so upset with the thought of an unused type variable to a simple edge, and for some reason it didn&#39;t occur to me that I could just hide it with a type synonym. While your first answer makes sense, I&#39;d rather go the minimalist route - as you said, using type classes in this situation doesn&#39;t feel right. Thanks so much for your help."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431969380, "post_id": 30307896, "comment_id": 48713796, "body": "I Love type-families soo much. Great answer, great example."}], "tags": [], "owner": {"reputation": 23816, "user_id": 572606, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c20a126ad0dce40e8fc4a43456107919?s=128&d=identicon&r=PG", "display_name": "shang", "link": "https://stackoverflow.com/users/572606/shang"}, "is_accepted": true, "score": 6, "last_activity_date": 1431965125, "last_edit_date": 1431965125, "creation_date": 1431964834, "answer_id": 30307896, "question_id": 30307450, "link": "https://stackoverflow.com/questions/30307450/using-a-typeclass-to-access-fields-of-similar-data-types-in-haskell/30307896#30307896", "title": "Using a typeclass to access fields of similar data types in Haskell", "body": "<p>Your type class can be fixed by including the type parameters <code>v</code> and <code>w</code> in the class definition.</p>\n\n<pre><code>class Edge e where\n    endpoints :: e v w -&gt; (v,v)\n    weight :: e v w -&gt; w\n</code></pre>\n\n<p>Now <code>e</code> has the kind <code>* -&gt; * -&gt; *</code> meaning that it needs to be a type that takes two additional type parameters and these parameters are then used in <code>endpoints</code> and <code>weight</code> to actually link the result type to the type of the edge.</p>\n\n<p>However, you need to tweak your <code>ColoredEdge</code> type a bit so that <code>v</code> and <code>w</code> are the last two parameters, so</p>\n\n<pre><code>data BasicEdge v w = BasicEdge { b_endpoints :: (v,v), b_weight :: w}\ndata ColoredEdge c v w = ColoredEdge { c_endpoints :: (v,v), c_weight :: w, color :: c}\n</code></pre>\n\n<p>Now you can define the instances as</p>\n\n<pre><code>instance Edge BasicEdge where\n    endpoints = b_endpoints\n    weight = b_weight\n\ninstance Edge (ColoredEdge c) where\n    endpoints = c_endpoints\n    weight = c_weight\n</code></pre>\n\n<p>Another option is to use the <code>TypeFamilies</code> language extension and make the vertex and weight types associated type synonyms in the <code>Edge</code> class. That way the order to type parameters in the instance types becomes irrelevant.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nclass Edge e where\n    type Vertex e\n    type Weight e\n\n    endpoints :: e -&gt; (Vertex e, Vertex e)\n    weight :: e -&gt; Weight e\n\ninstance Edge (BasicEdge v w) where\n    type Vertex (BasicEdge v w) = v\n    type Weight (BasicEdge v w) = w\n\n    endpoints = b_endpoints\n    weight = b_weight\n\ninstance Edge (ColoredEdge v w c) where\n    type Vertex (ColoredEdge v w c) = v\n    type Weight (ColoredEdge v w c) = w\n\n    endpoints = c_endpoints\n    weight = c_weight\n</code></pre>\n\n<p>However, usually type classes are not the best solution for this kind of polymorphism. I would simply include an extra parameter in your <code>Edge</code> type for any additional data, as in</p>\n\n<pre><code>data Edge v w d = Edge { endpoints :: (v,v), weight :: w, edgeData :: d }\n</code></pre>\n\n<p>Now you can put color in <code>d</code> or a record that contains multiple fields of data for an edge and still query the shape of the graph in a generic way.</p>\n\n<p>Your original edge types could now be represented with the type synonyms</p>\n\n<pre><code>type BasicEdge   v w   = Edge v w ()\ntype ColoredEdge v w c = Edge v w c\n</code></pre>\n"}], "owner": {"reputation": 320, "user_id": 600970, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/83b88466713b8815acba29d7d8c81ea3?s=128&d=identicon&r=PG", "display_name": "Mortimer McMire", "link": "https://stackoverflow.com/users/600970/mortimer-mcmire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 30307896, "answer_count": 1, "score": 4, "last_activity_date": 1431965125, "creation_date": 1431963582, "question_id": 30307450, "link": "https://stackoverflow.com/questions/30307450/using-a-typeclass-to-access-fields-of-similar-data-types-in-haskell", "title": "Using a typeclass to access fields of similar data types in Haskell", "body": "<p>I am in the process of working on some graph problems in Haskell. In the middle of my work, I decided that I wanted to be able to represent edge colors within a graph data type. So I started with edges: Edges could be either colored or uncolored. Here's a quick mock-up of what I was thinking about. Keep in mind, I'm aware that there are terrible flaws in this code.</p>\n\n<pre><code>data BasicEdge v w = BasicEdge { b_endpoints :: (v,v), b_weight :: w}\ndata ColoredEdge v w c = ColoredEdge { c_endpoints :: (v,v), c_weight :: w, color :: c}\n\nclass Edge e where\n    endpoints :: e -&gt; (v,v)\n    weight :: e -&gt; w\n\ninstance Edge (BasicEdge v w) where\n    endpoints = b_endpoints\n    weight = b_weight\n\ninstance Edge (ColoredEdge v w c) where\n    endpoints = c_endpoints\n    weight = c_weight\n</code></pre>\n\n<p>Problem 1: <code>v</code> and <code>w</code> in BasicEdge are different type variables than <code>v</code> and <code>w</code> in ColoredEdge. Thus, attempting to access them in a polymorphic manner is preposterous.</p>\n\n<p>Problem 2: return values in the Edge class definition are free type variables, so they cannot be matched with the return values of <code>b_endpoints</code> and <code>c_endpoints</code>, etc.</p>\n\n<p>I do need the type variables - Vertices could be characters, strings, integers, etc..  Edge weights could be any sort of number (Floats are helpful for some problems). Colors could even be a constructed data type.</p>\n\n<p>Is there an \"idiomatic\" way to do this in the language? It seems that this is a basic type of polymorphism, but I am struggling to understand how to implement it.</p>\n\n<p>Thanks in advance for your help, and please understand that I have spent the past day trying to search on the internet for guidance. It is difficult to structure a search query for this problem.</p>\n"}, {"tags": ["regex", "haskell", "finite-automata"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431983085, "post_id": 30311102, "comment_id": 48720852, "body": "Roman Cheplyaka&#39;s been working on that! See <code>regex-applicative</code>. I know he hasn&#39;t gotten the performance where he wants it yet, and the interface is a bit limited, but if you really just want to parse a regular language, it offers a really pretty way to do it."}, {"owner": {"reputation": 23, "user_id": 4912363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a95ef10483012a7213f91b4559495dda?s=128&d=identicon&r=PG&f=1", "display_name": "Vladilen", "link": "https://stackoverflow.com/users/4912363/vladilen"}, "edited": false, "score": 1, "creation_date": 1432036586, "post_id": 30311102, "comment_id": 48744258, "body": "There is the note to attoparsec: Note:incremental input does not imply that attoparsec will release portions of its internal state for garbage collection as it proceeds.Its internal representation is equivalent to a single ByteString:if you feed incremental input to a parser, it will require memory proportional to the amount of input you supply.(This is necessary to support arbitrary backtracking) It is not good for me, because it can be large input, divided in small packets and can&#39;t  save it all. I think regex uses backtracking,too,so in my issue better case is some FA like aho-corasick."}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 3, "last_activity_date": 1431976300, "creation_date": 1431976300, "answer_id": 30311102, "question_id": 30305439, "link": "https://stackoverflow.com/questions/30305439/can-i-save-regex-state-for-next-input/30311102#30311102", "title": "Can I save regex state for next input?", "body": "<p>Instead of regular expressions I'd suggest you to use <a href=\"https://hackage.haskell.org/package/attoparsec\" rel=\"nofollow\">attoparsec</a>. It's fast, robust and allows <a href=\"https://hackage.haskell.org/package/attoparsec-0.13.0.0/docs/Data-Attoparsec-ByteString.html#g:2\" rel=\"nofollow\">incremental input</a>:</p>\n\n<blockquote>\n  <p>A fast parser combinator library, aimed particularly at dealing efficiently with network protocols and complicated text/binary file formats.</p>\n</blockquote>\n\n<p>Regular expressions get ugly easily and in particular in Haskell, using a typed combinator parsing library makes things much clearer.</p>\n\n<p>There is also package <a href=\"https://hackage.haskell.org/package/network-attoparsec\" rel=\"nofollow\">network-attoparsec</a>:</p>\n\n<blockquote>\n  <p>Utility functions for running a parser against a socket, without the need of a bigger framework such as Pipes or Conduit.</p>\n</blockquote>\n"}], "owner": {"reputation": 23, "user_id": 4912363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a95ef10483012a7213f91b4559495dda?s=128&d=identicon&r=PG&f=1", "display_name": "Vladilen", "link": "https://stackoverflow.com/users/4912363/vladilen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 30311102, "answer_count": 1, "score": 2, "last_activity_date": 1431976300, "creation_date": 1431958146, "question_id": 30305439, "link": "https://stackoverflow.com/questions/30305439/can-i-save-regex-state-for-next-input", "title": "Can I save regex state for next input?", "body": "<p>I parse TCP packets with some data and this data can divided in several packets. I can't save packets, so after passing first packet I can't read it again. I need to know if there is my pattern in data, when, for example, first packet contains \"hello wo\" and second contains \"rld!\" and I want to know if there is the \"world\" in sequence.</p>\n\n<p>For simply example, I have two files and I can search in them:</p>\n\n<pre><code>-- file: Seq.hs\nimport Text.Regex.TDFA\nimport System.Environment\n\nmain = do\n    args &lt;- getArgs\n    inpStr1 &lt;- readFile (args !! 0)\n    putStrLn $ show (inpStr1 =~ \"foo\" :: Bool)\n    inpStr2 &lt;- readFile (args !! 1)\n    putStrLn $ show (inpStr2 =~ \"foo\" :: Bool)\n</code></pre>\n\n<p>Can I save state of FA after processing inpStr1 to continue searching with inpStr2?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1431929943, "post_id": 30296205, "comment_id": 48688890, "body": "What is the output of <code>cabal info base</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 4, "last_activity_date": 1431929975, "creation_date": 1431929975, "answer_id": 30296305, "question_id": 30296205, "link": "https://stackoverflow.com/questions/30296205/cabal-install-d3js-error/30296305#30296305", "title": "cabal install d3js error", "body": "<p>Cabal's error message could ideally be a lot better in this case. Anyway, what it means is:</p>\n\n<ul>\n<li>The package d3js has a dependency on base-4.6.*</li>\n<li>You're using GHC 7.8, which ships with base-4.7.0.1</li>\n<li>base is a special package (wired in), so I can't install a new version</li>\n<li>So, I can't install the package for you with this GHC version</li>\n</ul>\n\n<p>Your options are:</p>\n\n<ul>\n<li>Try again with the <code>--allow-newer</code> flag</li>\n<li>Install GHC 7.6 and try with that</li>\n</ul>\n"}], "owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 30296305, "answer_count": 1, "score": 1, "last_activity_date": 1431929975, "creation_date": 1431929567, "last_edit_date": 1431929832, "question_id": 30296205, "link": "https://stackoverflow.com/questions/30296205/cabal-install-d3js-error", "title": "cabal install d3js error", "body": "<p>I got an error when installing d3js. I'm using ghc-7.8.3, cabal-1.22, debian Wheezy.</p>\n\n<pre><code># cabal install d3js\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: d3js-0.1.0.0 (user goal)\nnext goal: base (dependency of d3js-0.1.0.0)\nrejecting: base-4.7.0.1/installed-1a5... (conflict: d3js =&gt; &gt; base&gt;=4.6 &amp;&amp; &lt;4.7)\nrejecting: base-4.8.0.0, 4.7.0.2, 4.7.0.1, 4.7.0.0, 4.6.0.1, 4.6.0.0, 4.5.1.0,\n4.5.0.0, 4.4.1.0, 4.4.0.0, 4.3.1.0, 4.3.0.0, 4.2.0.2, 4.2.0.1, 4.2.0.0,\n4.1.0.0, 4.0.0.0, 3.0.3.2, 3.0.3.1 (global constraint requires installed instance) Dependency tree exhaustively searched.\n</code></pre>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1431929977, "post_id": 30294683, "comment_id": 48688905, "body": "can you give the complete code (including <code>imports</code>)?  Because just your code will not compile with the obvious imports - <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.1/docs/Test-QuickCheck-Gen.html#v:choose\" rel=\"nofollow noreferrer\"><code>choose</code></a> will want <code>Micro</code> to be an instance of <code>Random</code>"}, {"owner": {"reputation": 555, "user_id": 943029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeaa60a541620708e327dd9ab67fc292?s=128&d=identicon&r=PG", "display_name": "ianthetechie", "link": "https://stackoverflow.com/users/943029/ianthetechie"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1431961082, "post_id": 30294683, "comment_id": 48708428, "body": "@CarstenK&#246;nig I have edited the question to include the full code. Sorry about that. In the process, you have caused me to question my <code>Random</code> instance... My thought was to convert the input to <code>Fractional</code> values and then call the <code>Fractional</code> instance of <code>randomR</code>, but I may have inadvertently created an infinitely recursing function..."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 1, "last_activity_date": 1431964175, "creation_date": 1431964175, "answer_id": 30307652, "question_id": 30294683, "link": "https://stackoverflow.com/questions/30294683/simple-quickcheck-test-never-completes/30307652#30307652", "title": "Simple QuickCheck Test Never Completes", "body": "<p>Seems you have an issue inside your <code>Random</code> instance for <code>Micro</code></p>\n\n<p>Here is a quick hack to fix it:</p>\n\n<pre><code>{-# LANGUAGE TypeSynonymInstances #-}\n{-# LANGUAGE FlexibleInstances #-}\n\nimport Data.Fixed\nimport System.Random\nimport Test.QuickCheck\n\ntoDouble :: Micro -&gt; Double\ntoDouble = realToFrac . toRational\n\ninstance Random Micro where\n    randomR (lo, hi) g =\n      let (a,g') = randomR (toDouble lo, toDouble hi) g\n      in (fromRational (toRational a), g')\n    random = randomR (-999999, 999999)\n\ndata FooType = FooType { foo :: Micro } deriving (Show)\n\ninstance Arbitrary FooType where\n    arbitrary =\n        FooType &lt;$&gt; x\n        where\n            x = choose (0.0, 1.0)\n\nmain :: IO ()\nmain = quickCheck prop_foo_is_gte_zero\n  where prop_foo_is_gte_zero ft = foo ft &gt;= 0.0\n</code></pre>\n"}], "owner": {"reputation": 555, "user_id": 943029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eeaa60a541620708e327dd9ab67fc292?s=128&d=identicon&r=PG", "display_name": "ianthetechie", "link": "https://stackoverflow.com/users/943029/ianthetechie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 30307652, "answer_count": 1, "score": 2, "last_activity_date": 1431964175, "creation_date": 1431919910, "last_edit_date": 1431960719, "question_id": 30294683, "link": "https://stackoverflow.com/questions/30294683/simple-quickcheck-test-never-completes", "title": "Simple QuickCheck Test Never Completes", "body": "<p>I'm having a bit of trouble wrapping my mind around QuickCheck. Consider the following simple data type and it's corresponding arbitrary instance.</p>\n\n<p>EDIT: Full code below as requested in a comment. <code>fixedToFractional</code> converts fixed numeric types such as <code>Micro</code> to <code>Fractional</code>.</p>\n\n<pre><code>import Data.Fixed\nimport System.Random\nimport Control.Applicative\nimport Test.QuickCheck\n\nfixedToFractional :: (HasResolution a, Fractional b) =&gt; Data.Fixed.Fixed a -&gt; b\nfixedToFractional = fromRational . toRational\n\ninstance Random Micro where\n    randomR (lo, hi) g = randomR (fixedToFractional lo, fixedToFractional hi) g\n    random g           = randomR (-999999, 999999) g\n\ndata FooType = FooType { foo :: Micro } deriving (Show)\n\ninstance Arbitrary FooType where\n    arbitrary =\n        FooType &lt;$&gt; x\n        where\n            x = choose (0.0, 1.0)\n</code></pre>\n\n<p>If I understand things correctly, this should allow random <code>FooType</code> values to be generated, with the <code>foo</code> field set to a random value between 0 and 1.</p>\n\n<p>Next, consider the following simple test.</p>\n\n<pre><code>prop_foo_is_gte_zero ft = (foo ft) &gt;= 0.0\n</code></pre>\n\n<p>When I attempt to run the above test, whether in ghci, or in a test file using <code>quickCheckAll</code>, the test never completes. <code>ghc</code> eats up a few gigs of RAM in a matter of seconds, and will eventually run my machine out of swap space if I don't kill it. I'm probably missing something incredibly fundamental/stupid, but (obviously) don't know what. Any ideas?</p>\n\n<p>EDIT: I am now questioning my <code>Random</code> instance. Perhaps the problem is there and not with my <code>Arbitrary</code> instance.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1431916624, "post_id": 30293650, "comment_id": 48685017, "body": "Change the type signature to <code>(Coercible a b, a ~ (o r), b ~ (n m&#39; r)) =&gt; [o r] -&gt; [n m&#39; r]</code> and the error goes away. This is on ghc-7.10.1. This looks like a bug to me."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 5, "creation_date": 1431919745, "post_id": 30293650, "comment_id": 48685606, "body": "Hrm, it seemed too simple to be a bug. Reported <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10428\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1432186954, "post_id": 30293650, "comment_id": 48821879, "body": "Could one of you turn these comments into an answer so the question doesn&#39;t show up as unanswered? @user2407038"}], "answers": [{"tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": false, "score": 2, "last_activity_date": 1440266260, "creation_date": 1440266260, "answer_id": 32159146, "question_id": 30293650, "link": "https://stackoverflow.com/questions/30293650/coercible-with-ghc-7-10/32159146#32159146", "title": "Coercible with GHC 7.10", "body": "<p>There's nothing wrong with your code.</p>\n\n<p>The error is due to a <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10494\" rel=\"nofollow\">bug</a> in the type-checker. The issue tracker says this will be fixed in GHC 7.11.</p>\n\n<hr>\n\n<p><sup>Posting simply to provide an answer, since the original author doesn't post one. Feel free to add details if you wish (and are able).</sup></p>\n"}], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 1, "answer_count": 1, "score": 16, "last_activity_date": 1440266260, "creation_date": 1431910014, "question_id": 30293650, "link": "https://stackoverflow.com/questions/30293650/coercible-with-ghc-7-10", "title": "Coercible with GHC 7.10", "body": "<p>The following code works in GHC 7.8.4:</p>\n\n<pre><code>import Data.Coerce\ncoerceNewtype :: (Coercible (o r) (n m' r)) =&gt; [o r] -&gt; [n m' r]\ncoerceNewtype = coerce\n</code></pre>\n\n<p>but in 7.10 I get the error:</p>\n\n<pre><code>Couldn't match representation of type \u2018n m' r\u2019 with that of \u2018o r\u2019\narising from trying to show that the representations of\n  \u2018[o r]\u2019 and\n  \u2018[n m' r]\u2019 are the same\nRelevant role signatures: type role [] representational\n</code></pre>\n\n<p>I'm not quite sure where the magic happens in <code>Data.Coerce</code>, but given that <code>coerce</code> has the signature <code>(Coercible a b) =&gt; a -&gt; b</code>, I think the function above should still compile in 7.10. Any ideas why the behavior is different, or how I can get use coercible with polymorphic types in 7.10?</p>\n"}, {"tags": ["haskell", "types", "ghc", "typeclass"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1431908463, "post_id": 30293467, "comment_id": 48683405, "body": "Not quite sure what you&#39;re doing here, but is it just a case of a missing kind signature? It looks like GHC is defaulting the kind of <code>a</code> to <code>*</code>. Try <code>(a :: * -&gt; *)</code> with <code>-XKindSignatures</code>."}, {"owner": {"reputation": 949, "user_id": 1219515, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/64ce0ac7d44d2076d23b21ac62214970?s=128&d=identicon&r=PG", "display_name": "Maciej Goszczycki", "link": "https://stackoverflow.com/users/1219515/maciej-goszczycki"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1431908720, "post_id": 30293467, "comment_id": 48683461, "body": "Thanks. But that just changes the error to <code>The signature specified kind \u2018* -&gt; *\u2019, but \u2018a\u2019 has kind \u2018*\u2019</code>"}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1431909375, "post_id": 30293467, "comment_id": 48683574, "body": "Okay, it looks like what you&#39;re trying to do just won&#39;t work. In the class <code>Default</code>, the parameter <code>a</code> <i>must</i> have kind <code>*</code> because <code>def</code> returns a value of type <code>a</code>. In your instance for <code>GDefault</code>, <code>(:+:)</code> expects its first paratmeter to have kind <code>*-&gt;*</code>, but you have the constraint <code>Default a</code>, which means <code>a</code> has kind <code>*</code>."}, {"owner": {"reputation": 949, "user_id": 1219515, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/64ce0ac7d44d2076d23b21ac62214970?s=128&d=identicon&r=PG", "display_name": "Maciej Goszczycki", "link": "https://stackoverflow.com/users/1219515/maciej-goszczycki"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1431909568, "post_id": 30293467, "comment_id": 48683624, "body": "@eric So how would you fix that? I&#39;m still learning Generics so it&#39;s quite possible my code is silly."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1431910270, "post_id": 30293467, "comment_id": 48683758, "body": "The problem is certianly not specific to Generics; your code simply has a vanilly kind mismatch. I don&#39;t know much about Generics, and I don&#39;t know what you are trying to do, so it will be hard to help you."}], "answers": [{"comments": [{"owner": {"reputation": 949, "user_id": 1219515, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/64ce0ac7d44d2076d23b21ac62214970?s=128&d=identicon&r=PG", "display_name": "Maciej Goszczycki", "link": "https://stackoverflow.com/users/1219515/maciej-goszczycki"}, "edited": false, "score": 0, "creation_date": 1431911649, "post_id": 30293766, "comment_id": 48684032, "body": "Thanks. I knew it was something silly, my code still has errors after the fix, but at least <i>this</i> question is fixed."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 6, "last_activity_date": 1431911345, "creation_date": 1431911345, "answer_id": 30293766, "question_id": 30293467, "link": "https://stackoverflow.com/questions/30293467/wrong-argument-kind-when-using-ghc-generics/30293766#30293766", "title": "Wrong argument kind when using GHC Generics", "body": "<p>Don't you mean...?</p>\n\n<pre><code>instance (GDefault a, GDefault b) =&gt; GDefault (a :+: b) where ...\n  --      ^           ^\n</code></pre>\n"}], "owner": {"reputation": 949, "user_id": 1219515, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/64ce0ac7d44d2076d23b21ac62214970?s=128&d=identicon&r=PG", "display_name": "Maciej Goszczycki", "link": "https://stackoverflow.com/users/1219515/maciej-goszczycki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 30293766, "answer_count": 1, "score": 2, "last_activity_date": 1431911345, "creation_date": 1431908122, "question_id": 30293467, "link": "https://stackoverflow.com/questions/30293467/wrong-argument-kind-when-using-ghc-generics", "title": "Wrong argument kind when using GHC Generics", "body": "<p>I've been following the <a href=\"https://wiki.haskell.org/GHC.Generics\" rel=\"nofollow\">GHC.Generics</a> tutorial to make a simple generic typeclass for providing default values for arbitrary types. However when I try to load my file (relevant snippet, which still produces the error)</p>\n\n<pre><code>{-# LANGUAGE DefaultSignatures, DeriveGeneric, TypeOperators, FlexibleContexts #-}\nimport GHC.Generics\n\nclass Default a where\n    def :: a\n    default def :: (Generic a, GDefault (Rep a)) =&gt; a\n    def = to gdef\n\nclass GDefault f where\n    gdef :: f a\n\ninstance (Default a, Default b) =&gt; GDefault (a :+: b) where\n    gdef (L1 x) = gdef x\n    gdef (R1 x) = gdef x\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>Generic.hs:12:46:\n    The first argument of \u2018:+:\u2019 should have kind \u2018* -&gt; *\u2019,\n      but \u2018a\u2019 has kind \u2018*\u2019\n    In the instance declaration for \u2018GDefault (a :+: b)\u2019\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell", "backtracking"], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 4, "last_activity_date": 1431906844, "creation_date": 1431906844, "answer_id": 30293344, "question_id": 30293184, "link": "https://stackoverflow.com/questions/30293184/implementing-backtracking-on-haskell/30293344#30293344", "title": "Implementing Backtracking on Haskell", "body": "<p>There have been several articles published recently on classic brute-force search problems.</p>\n\n<ul>\n<li>Mark Dominus published <a href=\"http://blog.plover.com/prog/haskell/monad-search.html\" rel=\"nofollow\">a simple example of using lists</a> for a simple exhaustive search.</li>\n<li>Justin Le followed up with <a href=\"http://blog.jle.im/entry/unique-sample-drawing-searches-with-list-and-statet\" rel=\"nofollow\">a small modification</a> to the previous article that simplified tracking the current state of the search.</li>\n<li>I followed up with <a href=\"https://www.fpcomplete.com/user/chowells79/even-more-money\" rel=\"nofollow\">a further modification</a> that allowed measuring the gains from early rejection of part of the search tree.</li>\n</ul>\n\n<p>Note that the code in my article is quite slow because it's measuring the amount of work done as well as doing it. My article has good examples for how to quickly reject parts of the search tree, but it should be considered only an illustration - not production code.</p>\n"}, {"tags": [], "owner": {"reputation": 2464, "user_id": 1076715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf07aa4cdf24f3a770c21cb26e61bc7f?s=128&d=identicon&r=PG", "display_name": "Eric", "link": "https://stackoverflow.com/users/1076715/eric"}, "is_accepted": false, "score": 1, "last_activity_date": 1432027209, "last_edit_date": 1432027209, "creation_date": 1431977782, "answer_id": 30311488, "question_id": 30293184, "link": "https://stackoverflow.com/questions/30293184/implementing-backtracking-on-haskell/30311488#30311488", "title": "Implementing Backtracking on Haskell", "body": "<p>A brute force approach using recursion:</p>\n\n<pre><code>import Data.List (filter, (\\\\), reverse, delete, sortBy)\nimport Data.Ord  (comparing)\n\nneighbour :: String -&gt; String -&gt; Bool\nneighbour word = (1 ==) . length . (\\\\ word)\n\nprocess :: String -&gt; String -&gt; [String] -&gt; [(Int, [String])]\nprocess start end dict = \n  let \n    loop :: String -&gt; String -&gt; [String] -&gt; [String] -&gt; [(Int,[String])] -&gt; [(Int,[String])]\n    loop start end dict path results = \n      case next of\n        [] -&gt; results\n        xs -&gt;\n          if   elem end xs\n          then (length solution, solution) : results\n          else results ++ branches xs\n      where\n        next        = filter (neighbour start) dict'\n        dict'       = delete start dict\n        path'       = start : path\n        branches xs = [a | x &lt;- xs, a &lt;- loop x end dict' path' results]\n        solution    = reverse (end : path')\n  in\n  loop start end dict [] []\n\nshortestSolution :: Maybe Int\nshortestSolution = shortest solutions\n  where \n    solutions  = process start end dict\n    shortest s = \n      case s of\n        [] -&gt; Nothing\n        xs -&gt; Just $ fst $ head $ sortBy (comparing fst) xs\n\nstart = \"spice\"\nend   = \"stock\"\ndict  = [\"spice\",\"stick\",\"smice\",\"slice\",\"slick\",\"stock\"]\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li><p>This code computes all possibles solutions (<code>process</code>) and select the shortest one (<code>shortestSolution</code>), as Carl said, you might want to prune parts of the search tree for better performance.</p></li>\n<li><p>Using a <code>Maybe</code> instead of returning <code>-1</code> when a function can fail to return results is preferred.</p></li>\n</ul>\n\n<hr>\n\n<p>Another way using a tree with breadth-first search:</p>\n\n<pre><code>import Data.Tree\nimport Data.List( filter, (\\\\), delete )\nimport Data.Maybe\n\nnode :: String -&gt; [String] -&gt; Tree String\nnode label dict = Node{ rootLabel = label, subForest = branches label (delete label dict) }\n\nbranches :: String -&gt; [String] -&gt; [Tree String]\nbranches start dict = map (flip node dict) (filter (neighbour start) dict)\n\nneighbour :: String -&gt; String -&gt; Bool\nneighbour word = (1 ==) . length . (\\\\ word)\n\n-- breadth first traversal\nshortestBF tree end = find [tree] end 0\n  where \n    find ts end depth \n      | null ts = Nothing\n      | elem end (map rootLabel ts) = Just depth\n      | otherwise = find (concat (map subForest ts)) end (depth+1)\n\nresult = shortestBF tree end\n\ntree :: Tree String\ntree = node start dict\n\nstart = \"spice\"\nend   = \"stock\"\ndict  = [\"spice\",\"stick\",\"smice\",\"slice\",\"slick\",\"stock\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 6, "last_activity_date": 1431997855, "last_edit_date": 1431997855, "creation_date": 1431987314, "answer_id": 30313645, "question_id": 30293184, "link": "https://stackoverflow.com/questions/30293184/implementing-backtracking-on-haskell/30313645#30313645", "title": "Implementing Backtracking on Haskell", "body": "<p>Not thoroughly tested, but this hopefully will help:</p>\n\n<pre><code>import Data.Function (on)\nimport Data.List (minimumBy, delete)\nimport Control.Monad (guard)\n\ntype Word = String\ntype Path = [String]\n\nwordF :: [Word] -&gt; Word -&gt; Word -&gt; Path\nwordF words start end = \n    start : minimumBy (compare `on` length) (generatePaths words start end)\n\n-- Use the list monad to do the nondeterminism and backtracking.\n-- Returns a list of all paths that lead from `start` to `end` \n-- in steps that `differByOne`.\ngeneratePaths :: [Word] -&gt; Word -&gt; Word -&gt; [Path]\ngeneratePaths words start end = do\n  -- Choose one of the words, nondeterministically\n  word &lt;- words\n\n  -- If the word doesn't `differByOne` from `start`, reject the choice\n  -- and backtrack.\n  guard $ differsByOne word start\n\n  if word == end\n  then return [word]\n  else do \n        next &lt;- generatePaths (delete word words) word end\n        return $ word : next\n\ndiffersByOne :: Word -&gt; Word -&gt; Bool\ndiffersByOne \"\" \"\" = False\ndiffersByOne (a:as) (b:bs) \n    | a == b = differsByOne as bs\n    | otherwise = as == bs\n</code></pre>\n\n<p>Example run:</p>\n\n<pre><code>&gt;&gt;&gt; wordF [\"spice\",\"stick\",\"smice\",\"stock\",\"slice\",\"slick\",\"stock\"] \"spice\" \"stock\"\n[\"spice\",\"slice\",\"slick\",\"stick\",\"stock\"]\n</code></pre>\n\n<p>The list monad in Haskell is commonly described as a form of nondeterministic, backtracking computation.  What the code above is doing is allowing the list monad to take on the responsibility of generating alternatives, testing whether they satisfy criteria, and backtracking on failure to the most recent choice point.  The bind of the list monad, e.g. <code>word &lt;- words</code>, means \"nondeterministically pick one of the <code>words</code>.  <code>guard</code> means \"if the choices so far don't satisfy this condition, backtrack and make a different choice.  The result of a list monad computation is the list of all the results that stem from choices that did not violate any <code>guard</code>s.</p>\n\n<p>If this looks like list comprehensions, well, list comprehensions are the same thing as the list monad\u2014I chose to express it with the monad instead of comprehensions.</p>\n"}], "owner": {"reputation": 151, "user_id": 3851498, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/1406722834/picture?type=large", "display_name": "Juan Figueira", "link": "https://stackoverflow.com/users/3851498/juan-figueira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2760, "favorite_count": 0, "accepted_answer_id": 30313645, "answer_count": 3, "score": 7, "last_activity_date": 1432027209, "creation_date": 1431905361, "last_edit_date": 1431985188, "question_id": 30293184, "link": "https://stackoverflow.com/questions/30293184/implementing-backtracking-on-haskell", "title": "Implementing Backtracking on Haskell", "body": "<p>I have a problem making Backtracking on Haskell, I know how to do recursive functions but I get troubles when I try to get multiple solutions or the best one (backtracking).</p>\n\n<p>There's a list with some strings, then I need to get the solutions to get from a string to another one changing one letter from the string, I will get the list, the first string and the last one. If there is solution return the count of steps that it did, if there is not solution it returns <code>-1</code>. here's an example:</p>\n\n<pre><code>wordF [\"spice\",\"stick\",\"smice\",\"stock\",\"slice\",\"slick\",\"stock\"] \"spice\" \"stock\"\n</code></pre>\n\n<p>Then I have my list and I need to start with <code>\"spice\"</code> and get to <code>\"stock\"</code>\nand the best solution is <code>[\"spice\",\"slice\",\"slick\",\"stick\",\"stock\"]</code> with four steps to get from <code>\"spice\"</code> to <code>\"stock\"</code>. then it return <code>4</code>.</p>\n\n<p>Another solution is <code>[\"spice\",\"smice\",\"slice\",\"slick\",\"stick\",\"stock\"]</code> with five steps to get to <code>\"stock\"</code> then it return `5. But this is a wrong solution because there's another one that's better with lesser steps than this one.</p>\n\n<p>I'm having troubles making a backtracking to get the best solution, because I don't know how to make that my code search another solutions and just not one..</p>\n\n<p>Here's a code that i tried to make but i get some errors, btw i dont know if my way to \"make\" backtracking is good or if there are some mistakes that im not seeing..</p>\n\n<pre><code>  wordF :: [String] -&gt; String -&gt; String -&gt; (String, String, Int)\n  wordF [] a b = (a, b, -1)\n  wordF list a b | (notElem a list || notElem b list) = (a, b, -1)\n           | otherwise = (a, b, (wordF2 list a b [a] 0 (length list)))\n  wordF2 :: [String] -&gt; String -&gt; String -&gt; [String] -&gt; Int -&gt; Int -&gt; Int\n  wordF2 list a b list_aux cont maxi | (cont==maxi) = 1000\n                               | (a==b) = length list_aux\n                               | (a/=b) &amp;&amp; (cont&lt;maxi) &amp;&amp; notElemFound &amp;&amp; (checkin /= \"ThisWRONG\") &amp;&amp; (wording1&lt;=wording2) = wording1\n                               | (a/=b) &amp;&amp; (cont&lt;maxi) &amp;&amp; notElemFound &amp;&amp; (checkin /= \"ThisWRONG\") &amp;&amp; (wording1&gt;wording2) = wording2\n                               | (a/=b) &amp;&amp; (checkin == \"ThisWRONG\") = wordF2 list a b list_aux (cont+1) maxi\n                               where \n                               checkin = (check_word2 a (list!!cont) (list!!cont) 0)\n                               wording1 = (wordF2 list checkin b (list_aux++[checkin]) 0 maxi)\n                               wording2 = (wordF2 list checkin b (list_aux++[checkin]) 1 maxi)\n                               notElemFound = ((any (==(list!!cont)) list_aux) == False)\n check_word2 :: String -&gt; String -&gt; String -&gt; Int -&gt; String\n check_word2 word1 word2 word3 dif | (dif &gt; 1) = \"ThisWRONG\"\n                              | ((length word1 == 1) &amp;&amp; (length word2 == 1) &amp;&amp; (head word1 == head word2)) = word3\n                              | ((length word1 == 1) &amp;&amp; (length word2 == 1) &amp;&amp; (head word1 /= head word2) &amp;&amp; (dif&lt;1)) = word3\n                              | ((head word1) == (head word2)) = check_word2 (tail word1) (tail word2) word3 dif\n                              | otherwise = check_word2 (tail word1) (tail word2) word3 (dif+1)\n</code></pre>\n\n<p>My first function <code>wordF2</code> get the list, the start, the end, an auxiliary list to get the current solution with the first element that always will be there (<code>[a]</code>), a counter with <code>0</code>, and the max size of the counter (<code>length list</code>)..</p>\n\n<p>and the second function <code>check_word2</code> it checks if a word can pass to another word, like <code>\"spice\"</code> to <code>\"slice\"</code> if it cant like <code>\"spice\"</code> to <code>\"spoca\"</code> it returns <code>\"ThisWRONG\"</code>.</p>\n\n<p>This solution gets an error of pattern match failure</p>\n\n<pre><code>  Program error: pattern match failure: wordF2 [\"slice\",\"slick\"] \"slice\" \"slick\" [\"slice\"] 0 1\n</code></pre>\n\n<p>I was trying with little cases and nothing, and I'm restricting that i get a wrong position of the list with the count and the max.</p>\n\n<p>Or may be I dont know how to implement backtracking on haskell to get multiple solutions, the best solution, etc..</p>\n\n<p><strong>UPDATE: I did a solution but its not backtracking</strong></p>\n\n<pre><code>wordF :: [String] -&gt; String -&gt; String -&gt; (String, String, Int)\nwordF [] a b = (a, b, -1)\nwordF list a b | (notElem a list || notElem b list) = (a, b, -1)\n           | otherwise = (a, b, (wordF1 list a b))\n\nwordF1 :: [String] -&gt; String -&gt; String -&gt; Int\nwordF1 list a b | ((map length (wordF2 (subconjuntos2 (subconjuntos list) a b))) == []) = -1\n            | (calculo &gt; 0) = calculo\n            | otherwise = -1\n             where\n             calculo = (minimum (map length (wordF2 (subconjuntos2 (subconjuntos list) a b))))-1\n\nwordF2 :: [[String]] -&gt; [[String]]\nwordF2 [[]] = []\nwordF2 (x:xs) | ((length xs == 1) &amp;&amp; ((check_word x) == True) &amp;&amp; ((check_word (head xs)) == True)) = x:xs\n          | ((length xs == 1) &amp;&amp; ((check_word x) == False) &amp;&amp; ((check_word (head xs)) == True)) = xs\n          | ((length xs == 1) &amp;&amp; ((check_word x) == True) &amp;&amp; ((check_word (head xs)) == False)) = [x]\n          | ((length xs == 1) &amp;&amp; ((check_word x) == False) &amp;&amp; ((check_word (head xs)) == False)) = []\n          | ((check_word x) == True) = x:wordF2 xs\n          | ((check_word x) == False ) = wordF2 xs\n\ncheck_word :: [String] -&gt; Bool\ncheck_word [] = False\ncheck_word (x:xs) | ((length xs == 1) &amp;&amp; ((check_word2 x (head xs) 0) == True)) = True\n              | ((length xs &gt;1) &amp;&amp; ((check_word2 x (head xs) 0) == True)) = True &amp;&amp; (check_word xs)\n              | otherwise = False \n\ncheck_word2 :: String -&gt; String -&gt; Int -&gt; Bool\ncheck_word2 word1 word2 dif | (dif &gt; 1) = False\n                        | ((length word1 == 1) &amp;&amp; (length word2 == 1) &amp;&amp; (head word1 == head word2)) = True\n                        | ((length word1 == 1) &amp;&amp; (length word2 == 1) &amp;&amp; (head word1 /= head word2) &amp;&amp; (dif&lt;1)) = True\n                        | ((head word1) == (head word2)) = check_word2 (tail word1) (tail word2) dif\n                        | otherwise = check_word2 (tail word1) (tail word2) (dif+1)\n\nsubconjuntos2 :: [[String]] -&gt; String -&gt; String -&gt; [[String]]\nsubconjuntos2 [] a b     = []\nsubconjuntos2 (x:xs) a b | (length x &lt;= 1) = subconjuntos2 xs a b\n                     | ((head x == a) &amp;&amp; (last x == b)) = (x:subconjuntos2 xs a b)\n                     | ((head x /= a) || (last x /= b)) = (subconjuntos2 xs a b)\n\nsubconjuntos :: [a] -&gt; [[a]]\nsubconjuntos []     = [[]]\nsubconjuntos (x:xs) = [x:ys | ys &lt;- sub] ++ sub\nwhere sub = subconjuntos xs\n</code></pre>\n\n<p><strong>Mmm may be its inefficient but at least it does the solution.. \ni search all posible solutions, i compare head == \"slice\" and last == \"stock\", then i filter the ones that are solution and print the shorter one,\nthanks and if you guys have any suggest say it :)</strong> </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57, "user_id": 4910114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420218ded8135c3a75e5b38b4f06e17c?s=128&d=identicon&r=PG&f=1", "display_name": "abourbaki", "link": "https://stackoverflow.com/users/4910114/abourbaki"}, "reply_to_user": {"reputation": 3761, "user_id": 4755863, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFZmD.jpg?s=128&g=1", "display_name": "APH", "link": "https://stackoverflow.com/users/4755863/aph"}, "edited": false, "score": 0, "creation_date": 1431905966, "post_id": 30293140, "comment_id": 48682925, "body": "Sadly, I am still enough of a beginner that I was unable to actually try anything. Hence the reason why I was looking for a workable example to help me grasp certain concepts."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1431907256, "post_id": 30293140, "comment_id": 48683177, "body": "Both the pages you linked have complete, executable examples. If you have problems with working on them, please tell us what your exact problems are. Start trying."}, {"owner": {"reputation": 57, "user_id": 4910114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420218ded8135c3a75e5b38b4f06e17c?s=128&d=identicon&r=PG&f=1", "display_name": "abourbaki", "link": "https://stackoverflow.com/users/4910114/abourbaki"}, "edited": false, "score": 0, "creation_date": 1431909603, "post_id": 30293140, "comment_id": 48683629, "body": "I did my best to try something. See my edit : )"}], "answers": [{"tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 2, "last_activity_date": 1431949761, "creation_date": 1431949761, "answer_id": 30302446, "question_id": 30293140, "link": "https://stackoverflow.com/questions/30293140/a-simple-pi-simulation-in-haskell-using-replicatem/30302446#30302446", "title": "A simple pi simulation in Haskell - using replicateM", "body": "<p>The return type of <a href=\"https://hackage.haskell.org/package/hstatistics-0.1.0.4/docs/Numeric-GSL-Distribution-Continuous.html#v:random_2p\" rel=\"nofollow\"><code>random_2p</code></a> is <code>Double</code> and not <code>m Double</code> where <code>m</code> would be a Monad. As a consequence, you don't need to <code>liftM2</code> the pair constructor.</p>\n\n<p>If you look <a href=\"https://hackage.haskell.org/package/hstatistics-0.1.0.4/docs/src/Numeric-GSL-Distribution-Continuous.html#random_2p\" rel=\"nofollow\">under the hood</a>, all these functions use <code>unsafePerformIO</code> so they are indeed effectful but presented as pure for some reason. It is quite unidiomatic to do so. I don't know this library but this is a bit of red flag for me.</p>\n"}], "owner": {"reputation": 57, "user_id": 4910114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/420218ded8135c3a75e5b38b4f06e17c?s=128&d=identicon&r=PG&f=1", "display_name": "abourbaki", "link": "https://stackoverflow.com/users/4910114/abourbaki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 30302446, "answer_count": 1, "score": 0, "last_activity_date": 1431949761, "creation_date": 1431904920, "last_edit_date": 1431909918, "question_id": 30293140, "link": "https://stackoverflow.com/questions/30293140/a-simple-pi-simulation-in-haskell-using-replicatem", "title": "A simple pi simulation in Haskell - using replicateM", "body": "<p>I am working on writing a simple pi simulation in Haskell, and I was wondering if there was a way of doing so using replicateM and without using one of the packages mentionning in the following two articles :</p>\n\n<p><a href=\"http://ptrckprry.com/blog/programming/2008/08/26/a-monte-carlo-monad-for-haskell/\" rel=\"nofollow\">http://ptrckprry.com/blog/programming/2008/08/26/a-monte-carlo-monad-for-haskell/</a></p>\n\n<p><a href=\"https://www.fpcomplete.com/blog/2014/03/monte-carlo-haskell\" rel=\"nofollow\">https://www.fpcomplete.com/blog/2014/03/monte-carlo-haskell</a></p>\n\n<p>If there exists a simple simulation of pi written in Haskell, I would like to hear about it - I've tried searching on GitHub as well.</p>\n\n<p>----- EDIT ------</p>\n\n<p>I tried to rewrite the unitBox part of Patrick Perry's example, but I am an error regarding the use of liftM2. Am I mal-interpreting how to use liftM2 or is it with random_2p ? I am really new to all of this and it is hard to see where I am making a mistake.</p>\n\n<p>Here is my code :</p>\n\n<pre><code>import Numeric.GSL.Distribution.Continuous\nimport Control.Monad\n\nunitbox :: (Double,Double)\nunitbox = liftM2 (,) (random_2p Uniform 0 0 1)\n                     (random_2p Uniform 0 0 1)\n</code></pre>\n\n<p>And is the error message :</p>\n\n<pre><code>Prelude Numeric.GSL.Distribution.Continuous&gt; :l unitBox.hs\n[1 of 1] Compiling Main             ( unitBox.hs, interpreted )\n\nunitBox.hs:5:18:\n    Couldn't match type \u2018(a10, a20)\u2019 with \u2018Double\u2019\n    Expected type: a10 -&gt; a20 -&gt; Double\n      Actual type: a10 -&gt; a20 -&gt; (a10, a20)\n    In the first argument of \u2018liftM2\u2019, namely \u2018(,)\u2019\n    In the expression:\n      liftM2 (,) (random_2p Uniform 0 0 1) (random_2p Uniform 0 0 1)\n\nunitBox.hs:5:23:\n    Couldn't match expected type \u2018(Double, a10)\u2019\n                with actual type \u2018Double\u2019\n    In the second argument of \u2018liftM2\u2019, namely\n      \u2018(random_2p Uniform 0 0 1)\u2019\n    In the expression:\n      liftM2 (,) (random_2p Uniform 0 0 1) (random_2p Uniform 0 0 1)\n\nunitBox.hs:6:23:\n    Couldn't match expected type \u2018(Double, a20)\u2019\n                with actual type \u2018Double\u2019\n    In the third argument of \u2018liftM2\u2019, namely\n      \u2018(random_2p Uniform 0 0 1)\u2019\n    In the expression:\n      liftM2 (,) (random_2p Uniform 0 0 1) (random_2p Uniform 0 0 1)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Thank you for your input.</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1431891318, "post_id": 30291172, "comment_id": 48679193, "body": "have a look at <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Prelude.html#v:cycle\" rel=\"nofollow noreferrer\"><code>cylce</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Prelude.html#v:take\" rel=\"nofollow noreferrer\"><code>take</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 402, "user_id": 4674225, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f4e8f49f5ccc43297b4b185cd3866b?s=128&d=identicon&r=PG&f=1", "display_name": "No_signal", "link": "https://stackoverflow.com/users/4674225/no-signal"}, "edited": false, "score": 6, "creation_date": 1431893092, "post_id": 30291297, "comment_id": 48679732, "body": "this should be faster <code>repString p k = zipWith const (cycle p) k</code> and pointfree <code>repString = zipWith const . cycle</code>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1431978220, "post_id": 30291297, "comment_id": 48718450, "body": "Should be a <i>lot</i> faster for infinite lists, No_signal!"}], "tags": [], "owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "is_accepted": true, "score": 5, "last_activity_date": 1431891315, "creation_date": 1431891315, "answer_id": 30291297, "question_id": 30291172, "link": "https://stackoverflow.com/questions/30291172/recursive-repetition-of-a-string/30291297#30291297", "title": "recursive repetition of a string", "body": "<p>What you're trying to write is something like:</p>\n\n<pre><code>repString :: [Char] -&gt; [Char] -&gt; [Char]\nrepString [] k = []\nrepString p [] = []\nrepString p k\n   | length p &lt;= n = p ++ repString p (drop (length p) k)\n   | otherwise     = take n p\n   where n = length k\n</code></pre>\n\n<p>But would be better written as:</p>\n\n<pre><code>repString :: [Char] -&gt; [Char] -&gt; [Char]\nrepString p k = take (length k) (cycle p)\n</code></pre>\n"}], "owner": {"reputation": 837, "user_id": 4072022, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2b8d2b1ab1299eb31efacc0843964517?s=128&d=identicon&r=PG&f=1", "display_name": "Rumen Hristov", "link": "https://stackoverflow.com/users/4072022/rumen-hristov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 30291297, "answer_count": 1, "score": 0, "last_activity_date": 1431891315, "creation_date": 1431890746, "question_id": 30291172, "link": "https://stackoverflow.com/questions/30291172/recursive-repetition-of-a-string", "title": "recursive repetition of a string", "body": "<p>I am trying to write a function that will take 2 strings, p and k. It will check the lengths of p and k and repeat the letters in p consecutively until the result word is of the length of k. ex: Let p = 123 and k = 45678. Then result word = 12312, because length of k is 5. So the chars of p are consecutively repeated until end word reaches length of k. My code below does not work as I want it to:</p>\n\n<pre><code>repString::[Char]-&gt;[Char]-&gt;[Char]\nrepString [] (y:ys)         =[]\nrepString (x:xs) []         =[]\nrepString (x:xs) (y:ys)\n |length(x:xs)&lt;length(y:ys) =(x:xs)++x:repString (xs) []\n\nmain = do\nprint $ repString \"123\" \"45678\"\n</code></pre>\n\n<p>I am not sure how to make this work, because every time it reaches the end of x:xs, it will see an empty string and then it will fulfill the appropriate base case and terminate. I don't know how to make it go back to the beginning of (x:xs) and start printing again.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 996028, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/PUCrl.png?s=128&g=1", "display_name": "Sawny", "link": "https://stackoverflow.com/users/996028/sawny"}, "edited": false, "score": 1, "creation_date": 1431899411, "post_id": 30292370, "comment_id": 48681475, "body": "Full context can be found <a href=\"https://github.com/s4wny/Haskell-TCP-chat/blob/master/client.hs#L42\" rel=\"nofollow noreferrer\">here</a>. The handle is created by <code>handle &lt;- connectTo &quot;localhost&quot; (PortNumber 4000)</code>. The server is created in <a href=\"https://github.com/s4wny/Haskell-TCP-chat/blob/master/server.hs#L48\" rel=\"nofollow noreferrer\">server.hs</a>."}], "tags": [], "owner": {"reputation": 178, "user_id": 4556658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176748782a450651ab1ef750943e5f35?s=128&d=identicon&r=PG&f=1", "display_name": "sdx23", "link": "https://stackoverflow.com/users/4556658/sdx23"}, "is_accepted": false, "score": 1, "last_activity_date": 1431898363, "creation_date": 1431898363, "answer_id": 30292370, "question_id": 30291109, "link": "https://stackoverflow.com/questions/30291109/how-to-finish-the-race-function/30292370#30292370", "title": "How to finish the race_ function?", "body": "<p>Used in context</p>\n\n<pre><code>import System.IO\nimport Control.Concurrent.Async\nimport Control.Monad\n\nmain = do\n    h &lt;- openFile \"./a\" ReadWriteMode\n    mainLoop h \"user\"\n    hClose h\n</code></pre>\n\n<p>this works fine also without hPutStrLn - what did you do? (where ./a is a large file, like \"dmesg > a\")</p>\n"}], "owner": {"reputation": 1376, "user_id": 996028, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/PUCrl.png?s=128&g=1", "display_name": "Sawny", "link": "https://stackoverflow.com/users/996028/sawny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1431899577, "creation_date": 1431890355, "last_edit_date": 1431899577, "question_id": 30291109, "link": "https://stackoverflow.com/questions/30291109/how-to-finish-the-race-function", "title": "How to finish the race_ function?", "body": "<p>I want to finish the <a href=\"https://hackage.haskell.org/package/async-2.0.0.0/docs/Control-Concurrent-Async.html#v:race\" rel=\"nofollow\"><code>race_</code></a> function but I don't know how to do that.</p>\n\n<p>This is the code I have right now:</p>\n\n<pre><code>mainLoop :: Handle -&gt; String -&gt; IO ()\nmainLoop handle username = do\n    _ &lt;- race_ fromServer toServer\n\n    putStrLn \"Race is done\"\n    return ()\n\n    where\n        fromServer = forever $ do\n            line &lt;- hGetLine handle\n            putStrLn $ \"Server: \" ++ line\n\n        toServer = do\n            line &lt;- getLine\n            case line of\n                \":quit\" -&gt; do\n                    --hPutStrLn handle \"blabla\"\n                    return ()\n                _       -&gt; do\n                    hPutStrLn handle $ line\n                    toServer\n</code></pre>\n\n<p>If I uncomment the line <code>hPutStrLn handle \"blabla\"</code> the user will see <code>Race is done</code> when he types <code>:quit</code>. Without that line the program just hang when the user types <code>:quit</code>.</p>\n\n<p>I feels wrong to use <code>hPutStrLn handle \"blabla\"</code> just to finish the <code>race_</code>. I assume that there exists a better function to finish the <code>race_</code> function. Any idea?</p>\n\n<p>I find it strange that a simple <code>return ()</code> doesn't work since both <code>hPutStrLn</code> and <code>return</code> returns an empty IO action.</p>\n\n<p>Full context can be found <a href=\"https://github.com/s4wny/Haskell-TCP-chat/blob/master/client.hs#L42\" rel=\"nofollow\">here</a>. The handle is created by <code>handle &lt;- connectTo \"localhost\" (PortNumber 4000)</code>. The server is created in <a href=\"https://github.com/s4wny/Haskell-TCP-chat/blob/master/server.hs#L48\" rel=\"nofollow\">server.hs</a>. I'm running this code on Windows 7 in \"Git bash\" (msysgit) with <code>runhaskell</code>.</p>\n"}, {"tags": ["haskell", "design-patterns", "data-structures", "typeclass"], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1431888770, "post_id": 30289807, "comment_id": 48678336, "body": "Thanks, can I ask just a small clarification? There are some functions that use different constraints across that library, but all somewhat similar. So, you suggest I should use a single synonym that covered everything, or one per function, covering the exact function needs? How would it be called idiomatically?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431890763, "post_id": 30289807, "comment_id": 48678999, "body": "I think synonyms should be defined in a way so that they can be used as much as possible. Single use synonyms are no good. If have multiple slightly different synonyms, you could try finding some unifying pattern or principle and use type families to generate the constraints (type families can also return <code>Constraint</code>-s)."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 6, "last_activity_date": 1431883483, "creation_date": 1431883483, "answer_id": 30289807, "question_id": 30289310, "link": "https://stackoverflow.com/questions/30289310/type-constraints-become-huge-and-unreadable-for-simple-code/30289807#30289807", "title": "Type constraints become huge and unreadable for simple code", "body": "<p>Use constraint synonyms:</p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds #-}\n\ntype ConstraintSynonym f a = (\n  Foldable f,\n  Metric f,\n  Ord a, \n  Num (f a), \n  Fractional (f a), \n  Floating a)\n</code></pre>\n\n<p>With <code>ConstraintKinds</code>, lifted tuples can be used to express conjunction of constraints (and <code>()</code> can refer to the trivially satisfied constraint). You can now use <code>ConstraintSynonym</code> instead of the big tuple of constraints in annotations. </p>\n"}, {"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431884234, "post_id": 30289853, "comment_id": 48676749, "body": "When exactly Vectors don&#39;t act like numbers?"}, {"owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431884910, "post_id": 30289853, "comment_id": 48676982, "body": "How would you do <code>toRational :: Real a =&gt; a -&gt; Rational</code> for a vector? You can do some operations component wise but they don&#39;t always make sense in the geometric interpretation of a vector, like multiplying. Normally when you &quot;multiply&quot; two vectors is a dot product or cross product."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431886273, "post_id": 30289853, "comment_id": 48677467, "body": "Not convinced, I&#39;d need more elaboration than that, but that&#39;s out of the scope of the question, of course. Thank you!"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431888084, "post_id": 30289853, "comment_id": 48678086, "body": "Note: moved this question to <a href=\"http://math.stackexchange.com/questions/1286711/vectors-arent-really-numbers-how-sound-is-that-statement\">math SO</a>, just in case..."}, {"owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431940022, "post_id": 30289853, "comment_id": 48694105, "body": "@Viclib What about complex numbers? (there&#39;s no <code>Metric</code> instance for <code>Complex</code> for some reason, but you could write your function in terms of <code>Additive</code>). With your current definition this makes no sense but it would work if you did component-wise division using <code>liftI2 (&#47;)</code>. I recommend you stick to the standard &quot;vector&quot; notation (<code>^+^</code> ect.), they&#39;re there for a reason and you&#39;ll have nicer type signatures (<code>Num (f a)</code> is ugly)."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431970075, "post_id": 30289853, "comment_id": 48714148, "body": "@Viclib, one simple way vectors are not numbers is in the type of &quot;multiplication&quot;.  Vectors have scaling (scalar * vector -&gt; vector) and inner product (vector * vector -&gt; scalar), but no multiplication (vector * vector -&gt; vector)"}], "tags": [], "owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "is_accepted": true, "score": 2, "last_activity_date": 1431885235, "last_edit_date": 1431885235, "creation_date": 1431883776, "answer_id": 30289853, "question_id": 30289310, "link": "https://stackoverflow.com/questions/30289310/type-constraints-become-huge-and-unreadable-for-simple-code/30289853#30289853", "title": "Type constraints become huge and unreadable for simple code", "body": "<p>Your particular example could be solved by using <code>^-^</code> and <code>liftI2 (/)</code> instead of <code>-</code> and <code>/</code> respectively. This reduces the constraint to <code>(Foldable f, Metric f, Ord a, Floating a)</code>.</p>\n\n<p>Using <code>ConstraintKinds</code> you can make constant aliases to reduce cluster:</p>\n\n<pre><code>type OrderedField a = (Ord a, Floating a)\ntype FoldableMetric f = (Foldable f, Metric f)\n</code></pre>\n\n<p>So the constraint becomes <code>(FoldableMetric f, OrderedField a)</code>. You can also do this without <code>ConstraintKinds</code> by making a dummy class:</p>\n\n<pre><code>class (Ord a, Floating a) =&gt; OrderedField a\ninstance (Ord a, Floating a) =&gt; OrderedField a\n</code></pre>\n\n<p>but this needs <code>UndecidableInstances</code>.</p>\n\n<p>Vectors aren't really numbers. You can't write reasonable <code>Ord</code> or <code>Real</code> instances for them (whether they should even have a <code>Num</code> instance is debatable). I think keeping the vector and number types separate is a good thing.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 30289853, "answer_count": 2, "score": 4, "last_activity_date": 1431885235, "creation_date": 1431880455, "last_edit_date": 1431882618, "question_id": 30289310, "link": "https://stackoverflow.com/questions/30289310/type-constraints-become-huge-and-unreadable-for-simple-code", "title": "Type constraints become huge and unreadable for simple code", "body": "<p>Mind the following code:</p>\n\n<pre><code>-- A n-dimensional axis aligned bounding box.\ndata AABB v a = AABB {\n    aabbMin :: !(v a), \n    aabbMax :: !(v a)\n    } deriving (Show)\n\n-- `v` is a container, representing the number of dimensions. Ex:\n-- type Box2DFloat = AABB V2 Float\n-- type Box4DFloat = AABB V4 Float \n\n-- A n-dimensional ray.\ndata Ray v a = Ray {\n    rayPos :: !(v a),\n    rayDir :: !(v a)\n    } deriving (Show)\n\n-- Traces a n-d ray through a n-d box, returns \n-- the intersection indexes (tmin, tmax).\nintersectAABB \n    :: (Foldable f, \n        Metric f, \n        Ord a, \n        Num (f a), \n        Fractional (f a), \n        Floating a) \n    =&gt; Ray f a \n    -&gt; AABB f a \n    -&gt; [a]\nintersectAABB (Ray rayPos rayDir) (AABB aabbMin aabbMax) \n    = [tmin, tmax] where\n        t1   = (aabbMin - rayPos) / rayDir\n        t2   = (aabbMax - rayPos) / rayDir\n        tmin = foldr1 max $ liftI2 min t1 t2\n        tmax = foldr1 min $ liftI2 max t1 t2\n</code></pre>\n\n<p>That is an usual Ray\u2192AABB intersection function, and it is pretty simple and clean, except for <strong>the type signature, which is almost bigger than the function itself</strong>! Someone suggested I could use kind constraints that \"encapsule my needs\" to make it less verbose, but I can't find a kind constraint that \"encapsules my needs\" properly. \"My needs\", on this case, are basically \"the type acts like a number should\". So, on my mind, the following would make sense:</p>\n\n<pre><code>class Real a where\n    ... anything I want a real number to do ...\n\ninstance Real Float where\n    ...\n\ninstance (Real a) =&gt; Real (V2 a) where\n    ...\n\ninstance (Real a) =&gt; Real (V3 a) where\n    ...\n\ntype AABB a = V2 a\ntype Ray a  = V2 a\n\ntype Box2DFloat = AABB (V2 Float)\ntype Box4DFloat = AABB (V4 Float)\ntype Ray2D a = Ray (V2 a)\ntype Ray3DRatio = Ray (V3 Ratio)\n... etc ...\n</code></pre>\n\n<p>That way, my signatures would become, simply:</p>\n\n<pre><code>intersectAABB :: (Real r, Real s) =&gt; Ray r -&gt; AABB r -&gt; [s]\n</code></pre>\n\n<p>Which looks much better. But, if nobody using Haskell has bothered to define such class, there should be a reason. What is the reason there is no \"Real\" class, and, if defining such a class would be a bad idea, what is the proper solution to my issue?</p>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1431883190, "post_id": 30289702, "comment_id": 48676399, "body": "Thanks @bheklilr . You are right about the ordering being important, and generally I have refrained from optimizing before profiling."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1431883394, "post_id": 30289702, "comment_id": 48676473, "body": "@dsign If that&#39;s the case then simply use your <code>Headers</code> type, replace <code>M.lookup</code> with <code>Prelude.lookup</code> and re-implement <a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/src/Data-Map-Base.html#alter\" rel=\"nofollow noreferrer\"><code>Data.Map.alter</code></a> for association lists, which will be the tricky bit.  Or you could browse around Hackage for a while trying to find if someone else has done that already, because they probably have."}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1431884022, "post_id": 30289702, "comment_id": 48676693, "body": "Good point. One nasty little detail that I just realized is that I can not obey the lens laws in my current setup.... so yes I think I need to switch to a map and order the keys with a custom function (it is not lexicographical, but there is a <i>proper</i> ordering). Thanks!"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1431884144, "post_id": 30289702, "comment_id": 48676723, "body": "@dsign You could wrap <code>ByteString</code> in a newtype that implements <code>Ord</code> in the correct way, and then you wouldn&#39;t have any problems whatsoever, so long as that ordering is well behaved.  There are functions in <code>Data.Map</code> for getting ascending or descending association lists, too, so once you need the order you can extract it."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 4, "last_activity_date": 1431882894, "creation_date": 1431882894, "answer_id": 30289702, "question_id": 30289012, "link": "https://stackoverflow.com/questions/30289012/use-a-lens-to-replace-a-specific-element-of-a-key-value-list/30289702#30289702", "title": "Use a lens to replace a specific element of a (key,value) list", "body": "<p>Well, if you were to use <code>Data.Map.Map</code> as your structure instead (should be a pretty easy refactor) you won't have to replicate all this work yourself:</p>\n\n<pre><code>import qualified Data.Map as M\nimport Control.Lens\n\ntype Headers = M.Map ByteString ByteString\n\nfetchHeader :: Headers -&gt; ByteString -&gt; Maybe ByteString\nfetchHeader = flip M.lookup\n\nreplaceHeaderValue :: Headers -&gt; ByteString -&gt; Maybe ByteString -&gt; Headers\nreplaceHeaderValue headers header_name maybe_header_value\n    = M.alter (const maybe_header_value) header_name headers\n</code></pre>\n\n<p>Then you could keep your <code>headerLens</code> as it is.  Or you could look into something like</p>\n\n<pre><code>headerLens name = lens (M.lookup name) (\\hs mhv -&gt; M.alter (const mhv) name hs)\n</code></pre>\n\n<p>Which doesn't need the supporting functions at all and can have a pretty generic signature for working with more types of <code>Map</code>s.  Example usage:</p>\n\n<pre><code>&gt; let hs = M.fromList [(\"foo\", \"bar\")]\n&gt; hs ^. headerLens \"foo\"\nJust \"bar\"\n&gt; hs ^. headerLens \"baz\"\nNothing\n&gt; headerLens \"foo\" .~ Just \"baz\" $ hs\nfromList [(\"foo\", \"baz\")]\n&gt; headerLens \"foo\" .~ Nothing $ hs\nfromList []\n&gt; headerLens \"qux\" .~ Just \"baz\" $ hs\nfromList [(\"foo\", \"bar\"), (\"qux\", \"baz\")]\n&gt; headerLens \"qux\" .~ Nothing $ hs\nfromList [(\"foo\", \"bar\")]\n</code></pre>\n\n<p>However, this won't preserve the order of the elements, which might be a problem for you.  There's probably an ordered map out there somewhere, similar to Python's <code>OrderedDict</code>, but I haven't used it in Haskell before.</p>\n"}], "owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 30289702, "answer_count": 1, "score": 6, "last_activity_date": 1431882894, "creation_date": 1431878900, "last_edit_date": 1431881192, "question_id": 30289012, "link": "https://stackoverflow.com/questions/30289012/use-a-lens-to-replace-a-specific-element-of-a-key-value-list", "title": "Use a lens to replace a specific element of a (key,value) list", "body": "<p>I want to use Kmett's <a href=\"https://hackage.haskell.org/package/lens\" rel=\"noreferrer\">lens library</a> to access an element of a (key, value) list under a specific key. In other words, I would like to replace this code with something more idiomatic and perhaps shorter:</p>\n\n<pre><code>type Headers = [ (ByteString, ByteString) ]\n\nheaderLens :: \n  Functor f =&gt; \n  ByteString -&gt; \n  (Maybe ByteString -&gt; f (Maybe ByteString)) -&gt;\n  Headers -&gt;\n  f Headers\nheaderLens header_name f headers \n    | old_header_value &lt;- fetchHeader headers header_name = fmap \n       (\\ new_header_value -&gt; \n              replaceHeaderValue \n              headers \n              header_name \n              new_header_value\n       )\n       (f old_header_value )\n</code></pre>\n\n<p>where the support functions are defined as below:</p>\n\n<pre><code>-- | Looks for a given header and returns the value, if any\nfetchHeader :: Headers -&gt; ByteString -&gt; Maybe ByteString\nfetchHeader headers header_name = \n    snd &lt;$&gt; find ( \\ x -&gt; fst x == header_name ) headers \n\n-- | replaceHeaderValue headers header_name maybe_header_value looks for \n--   header_name. If header_name is found and maybe_header_value is nothing, it \n--   returns a new headers list with the header deleted. If header_name is found\n--   and header_value is Just new_value, it returns a new list with the header \n--   containing the new value. If header_name is not in headers and maybe_header_value\n--   is Nothing, it returns the original headers list. If header_name is not in headers\n--   and maybe_header_value is Just new_value, it returns a new list where the last element\n--   is (header_name, new_value)\nreplaceHeaderValue :: Headers -&gt; ByteString -&gt; Maybe ByteString -&gt; Headers \nreplaceHeaderValue headers header_name maybe_header_value = \n    disect id headers\n  where \n    disect builder [] = case maybe_header_value of \n        Nothing -&gt; headers\n        Just new_value -&gt; builder $ (header_name, new_value):[]\n    disect builder ( el@(hn,hv) : rest) \n        | hn /= header_name = \n            disect\n                (\\ constructed_list -&gt; builder $ el:constructed_list )\n                rest\n        | otherwise = case maybe_header_value of \n            Nothing -&gt; builder rest \n            Just new_value -&gt; builder $ (hn, new_value):rest    \n</code></pre>\n"}, {"tags": ["scala", "haskell", "functional-programming", "functor"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1431878048, "post_id": 30288847, "comment_id": 48674676, "body": "Because Scala isn&#39;t a research language? Haskell is a less general/practical-use language than Scala, one might say."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 12, "creation_date": 1431878349, "post_id": 30288847, "comment_id": 48674768, "body": "@AJFarmar, since <code>Functor</code> is of immense practical value, I&#39;m not sure how that answers it. That would better express why it doesn&#39;t have, say, a <code>Category</code> trait."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1431878458, "post_id": 30288847, "comment_id": 48674803, "body": "@dfeuer But the word itself is derived from category theory, which I wouldn&#39;t expect to appear in Scala or any other mainstream language. Maybe it&#39;s under a different name?"}, {"owner": {"reputation": 21396, "user_id": 2650437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a8f26b0e42bb2b3e732f6552693452d?s=128&d=identicon&r=PG", "display_name": "Marth", "link": "https://stackoverflow.com/users/2650437/marth"}, "edited": false, "score": 2, "creation_date": 1431878709, "post_id": 30288847, "comment_id": 48674892, "body": "There is a <a href=\"http://www.scala-lang.org/api/2.11.5/index.html#scala.collection.generic.FilterMonadic\" rel=\"nofollow noreferrer\">FilterMonadic</a>  trait which contains both <code>.map</code> and <code>.flatMap</code> methods. It does however also contains the <code>.foreach</code> method as well as the <code>.withFilter</code> method. However I don&#39;t know why it was named this way, nor why <code>.withFilter</code> was put here together with <code>.map</code> and <code>.flatMap</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 6, "creation_date": 1431878979, "post_id": 30288847, "comment_id": 48674993, "body": "@AJFarmar, oh, well, the name is a whole different story. I once heard a Haskell researcher say <code>Functor</code> should&#39;ve been called <code>Mappable</code>."}, {"owner": {"reputation": 135502, "user_id": 334519, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bf774a4e24c33e4bb6d19ea1939f01a2?s=128&d=identicon&r=PG", "display_name": "Travis Brown", "link": "https://stackoverflow.com/users/334519/travis-brown"}, "edited": false, "score": 2, "creation_date": 1431886336, "post_id": 30288847, "comment_id": 48677485, "body": "This isn&#39;t a good question for Stack Overflow."}], "answers": [{"comments": [{"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 2, "creation_date": 1431880826, "post_id": 30289041, "comment_id": 48675604, "body": "&quot;I don&#39;t know&quot; - good answer!"}, {"owner": {"reputation": 96489, "user_id": 788207, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KQmlY.jpg?s=128&g=1", "display_name": "Vladimir Matveev", "link": "https://stackoverflow.com/users/788207/vladimir-matveev"}, "reply_to_user": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 1, "creation_date": 1431881901, "post_id": 30289041, "comment_id": 48675951, "body": "@ZhekaKozlov, I believe I&#39;ve answered the original question (why there is no functor <i>trait</i> in stdlib) - it&#39;s just it is not that useful and convenient. &quot;I don&#39;t know&quot; bit was about type classes."}, {"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 2, "creation_date": 1431882862, "post_id": 30289041, "comment_id": 48676252, "body": "This is factually incorrect. Scala&#39;s std lib does have some typeclasses: Numeric (== Haskell&#39;s Num), Integral (== Integral), Fractional (== Fractional), Ordering (== Ord), Equiv (== Eq)."}, {"owner": {"reputation": 96489, "user_id": 788207, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KQmlY.jpg?s=128&g=1", "display_name": "Vladimir Matveev", "link": "https://stackoverflow.com/users/788207/vladimir-matveev"}, "reply_to_user": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1431934034, "post_id": 30289041, "comment_id": 48690829, "body": "@ZhekaKozlov, again, I didn&#39;t mean <i>all</i> type classes. I meant categorical type classes, like functor, monad, etc. Please don&#39;t find superfluous meaning in what I&#39;m saying."}, {"owner": {"reputation": 9485, "user_id": 20371, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32c7a412ad0caf812ae974df5eb8ffcd?s=128&d=identicon&r=PG", "display_name": "Yawar", "link": "https://stackoverflow.com/users/20371/yawar"}, "edited": false, "score": 0, "creation_date": 1442766758, "post_id": 30289041, "comment_id": 53207884, "body": "@VladimirMatveev - as to why Scala doesn&#39;t provide categorical typeclasses in the standard library, I would guess because they cordon off higher-kinded types as an explicitly optional language feature and they don&#39;t want to use optional features in the standard library."}, {"owner": {"reputation": 96489, "user_id": 788207, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KQmlY.jpg?s=128&g=1", "display_name": "Vladimir Matveev", "link": "https://stackoverflow.com/users/788207/vladimir-matveev"}, "reply_to_user": {"reputation": 9485, "user_id": 20371, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32c7a412ad0caf812ae974df5eb8ffcd?s=128&d=identicon&r=PG", "display_name": "Yawar", "link": "https://stackoverflow.com/users/20371/yawar"}, "edited": false, "score": 0, "creation_date": 1442780767, "post_id": 30289041, "comment_id": 53212588, "body": "@Yawar, well, higher-kinded types are exactly as optional as the collections library is. The collections library uses higher-kinded types, for example <a href=\"http://www.scala-lang.org/api/current/index.html#scala.collection.generic.GenericTraversableTemplate\" rel=\"nofollow noreferrer\"><code>GenTraversableTemplate</code></a>. or <a href=\"http://www.scala-lang.org/api/current/index.html#scala.collection.generic.GenericCompanion\" rel=\"nofollow noreferrer\"><code>GenericCompanion</code></a>."}], "tags": [], "owner": {"reputation": 96489, "user_id": 788207, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/KQmlY.jpg?s=128&g=1", "display_name": "Vladimir Matveev", "link": "https://stackoverflow.com/users/788207/vladimir-matveev"}, "is_accepted": true, "score": 10, "last_activity_date": 1431879033, "creation_date": 1431879033, "answer_id": 30289041, "question_id": 30288847, "link": "https://stackoverflow.com/questions/30288847/why-is-there-no-functor-trait-in-scala/30289041#30289041", "title": "Why is there no &quot;Functor&quot; trait in Scala?", "body": "<p>How would such trait look like? Remember, functor is determined by an <code>fmap</code> function which lifts a regular function to a function acting on \"functorial\" values (or, alternatively, applies a regular function to functor contents). The closest I can think of is</p>\n\n<pre><code>trait Functor[T] {\n  type Self[U] &lt;: Functor[U]\n  def fmap[U](f: T =&gt; U): Self[U]\n}\n</code></pre>\n\n<p>Such definition is not really useful and relatively complex. Traits do not have necessary flexibility for abstracting higher-kinded concepts like functors.</p>\n\n<p>However, Scala does have type classes, that is, it is possible to use traits and implicit parameters in a clever way to implement the type class pattern:</p>\n\n<pre><code>trait Functor[F[_]] {\n  def fmap[T, U](f: T =&gt; U)(v: F[T]): F[U]\n}\n\nimplicit object OptionFunctor extends Functor[Option] {\n  def fmap[T, U](f: T =&gt; U)(v: Option[T]): Option[U] = v match {\n    case Some(r) =&gt; Some(f(r))\n    case None =&gt; None\n  }\n}\n\ndef doSomething[F[_]: Functor](f1: F[Int], f2: F[String]): F[Long] = ???  // whatever\n// equivalent to:\n// doSomething :: Functor f =&gt; f Int -&gt; f String -&gt; f Long\n// in Haskell\n</code></pre>\n\n<p>And that's precisely what <a href=\"http://docs.typelevel.org/api/scalaz/nightly/index.html#scalaz.Functor\">scalaz</a> provides.</p>\n\n<p>As for why this is not present in the standard library - I don't know. Maybe the type class pattern was not discovered immediately, and the library had already been formed at that moment. Maybe it's just because these are somewhat advanced concepts which don't really belong to the standard library. Maybe something else.</p>\n"}, {"tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 5, "last_activity_date": 1431886572, "creation_date": 1431886572, "answer_id": 30290408, "question_id": 30288847, "link": "https://stackoverflow.com/questions/30288847/why-is-there-no-functor-trait-in-scala/30290408#30290408", "title": "Why is there no &quot;Functor&quot; trait in Scala?", "body": "<p>I think the assumption is that anyone interested in using Functor/Applicative/Monad/etc. is better served by using Scalaz. Not being in the standard library means it's more free to evolve, isn't tied to the Scala release schedule, etc. <a href=\"https://wiki.haskell.org/Functor-Applicative-Monad_Proposal\" rel=\"noreferrer\">Just look at how long it took to make <code>Monad</code> extend <code>Applicative</code> in GHC!</a></p>\n"}], "owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 850, "favorite_count": 0, "closed_date": 1432236324, "accepted_answer_id": 30289041, "answer_count": 2, "score": 7, "last_activity_date": 1431939532, "creation_date": 1431877942, "last_edit_date": 1431939532, "question_id": 30288847, "link": "https://stackoverflow.com/questions/30288847/why-is-there-no-functor-trait-in-scala", "closed_reason": "Needs more focus", "title": "Why is there no &quot;Functor&quot; trait in Scala?", "body": "<p>In Scala, the generic classes such as <code>Future</code>, <code>Option</code> and <code>List</code> all have methods <code>map</code> and <code>flatMap</code>. As I understand, all of them are like <a href=\"https://wiki.haskell.org/Functor\" rel=\"noreferrer\">Functors</a> in Haskell. </p>\n\n<p>I was just wondering why there isn't a trait (interface) called Functor in Scala..</p>\n\n<p>Does anyone have ideas about this?</p>\n"}, {"tags": ["haskell", "wrapper", "monads", "xmonad"], "answers": [{"comments": [{"owner": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "edited": false, "score": 0, "creation_date": 1432029901, "post_id": 30303029, "comment_id": 48739777, "body": "I ended up using something similar, except defining a Monoid structure for CleanupData instead (see OP).  Can you please check whether I defined <code>needsCleanup_GrabButton</code> correctly?  (I think, but I&#39;m not sure, that&#39;s how I&#39;m supposed to use <code>tell</code>.)"}, {"owner": {"reputation": 4645, "user_id": 1283954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d123f9a0a3b56c4fc1b6f03cdc26eb9d?s=128&d=identicon&r=PG", "display_name": "Ilmo Euro", "link": "https://stackoverflow.com/users/1283954/ilmo-euro"}, "reply_to_user": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "edited": false, "score": 0, "creation_date": 1432102086, "post_id": 30303029, "comment_id": 48776385, "body": "@spacingissue it looks ok, although a bit non-idiomatic. I would do it as <code>liftIO $ ...; tell cleanup_data; return ()</code>"}, {"owner": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "edited": false, "score": 0, "creation_date": 1432106950, "post_id": 30303029, "comment_id": 48779348, "body": "Okay, I think I got it, thanks; had to make <code>NeedsCleanup</code> an instance of <code>MonadWriter CleanupData</code>.  Correct me if I&#39;m wrong, but I don&#39;t think that last <code>return ()</code> is necessary?"}], "tags": [], "owner": {"reputation": 4645, "user_id": 1283954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d123f9a0a3b56c4fc1b6f03cdc26eb9d?s=128&d=identicon&r=PG", "display_name": "Ilmo Euro", "link": "https://stackoverflow.com/users/1283954/ilmo-euro"}, "is_accepted": true, "score": 1, "last_activity_date": 1432102150, "last_edit_date": 1495539870, "creation_date": 1431951422, "answer_id": 30303029, "question_id": 30288778, "link": "https://stackoverflow.com/questions/30288778/haskell-xmonad-wrapper-around-a-monad-that-also-keeps-track-of-data/30303029#30303029", "title": "Haskell/XMonad: wrapper around a Monad that also keeps track of data", "body": "<p>You can use, for example, the <code>Writer</code> monad for that:</p>\n\n<pre><code>import Control.Monad.Writer\n\ndata DirtyThing = Keyboard |\u00a0Mouse\nnewtype Dirty m a = Dirty { unDirty :: WriterT [DirtyThing] m a }\n\ndoFoo :: Dirty IO ()\ndoFoo = -- doing something dirty\n\ncleanup :: Dirty m a -&gt; m a\ncleanup action = do\n    (val, dirtyThings) &lt;- runWriterT (unDirty action)\n    -- cleanup dirtyThings\n    return val\n</code></pre>\n\n<p>For efficiency, you could use <code>Set</code> instead of lists (and define a newtype wrapper for it with an appropriate <code>Monoid</code> instance). Another, more type-safe (but much more tedious) way would be to use <a href=\"https://stackoverflow.com/questions/28690448/what-is-indexed-monad\">indexed monads</a>.</p>\n"}], "owner": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 30303029, "answer_count": 1, "score": 1, "last_activity_date": 1448187536, "creation_date": 1431877559, "last_edit_date": 1448187536, "question_id": 30288778, "link": "https://stackoverflow.com/questions/30288778/haskell-xmonad-wrapper-around-a-monad-that-also-keeps-track-of-data", "title": "Haskell/XMonad: wrapper around a Monad that also keeps track of data", "body": "<p>This is a followup to <a href=\"https://stackoverflow.com/a/30119966/1732572\">Ben's previous answer</a>.  I had asked for type checking for cases in which <code>X t</code> actions \"require cleanup\" (ungrabbing of buttons and/or keyboard after it has been completed).  His response was a monadic wrapper <code>NeedsCleanup</code>, for which my current implementation goes something like this:</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nnewtype NeedsCleanup m t = \n  NeedsCleanup\n    {\n      -- | Escape hatch from the NeedsCleanup Monad;\n      --   returns the original action.\n      original_action :: m t\n    }\n  deriving (Functor, Applicative, Monad)\n\n-- | executes unclean_action and cleans up afterwards.\n--   (cleanedUp action) is a normal X() action\ncleanedUp :: NeedsCleanup X t -&gt; X t\ncleanedUp unclean_action = do\n  result &lt;- original_action unclean_action\n  doCleanup\n  return result\n</code></pre>\n\n<p>That way, if <code>action</code> has type <code>NeedsCleanup X ()</code>, I can't accidentally use it as an <code>X ()</code> without sending it through <code>(cleanedUp action)</code> first.  Fantastic!</p>\n\n<hr>\n\n<p>I wish to improve the <code>NeedsCleanup</code> wrapper, so that it also \"monadically\" passes data, indicating what exactly needs cleaning up.</p>\n\n<p>This is because, I have found, different <code>NeedsCleanup X ()</code> actions may require different things to be cleaned up, and I have to clean up after all that have been binded together.</p>\n\n<p>To be more precise, for each <code>NeedsCleanup X t</code> action, I would like for there to be associated a <code>CleanupData</code>:</p>\n\n<pre><code>data CleanupData = CleanupData\n  {\n       keyboard_needs_cleanup :: Bool\n     , buttons_needing_cleanup :: Set.Set Buttons\n\n     -- any other fields\n     -- ...\n  }\n</code></pre>\n\n<p>Two <code>CleanupData</code> can be combined, resulting in roughly a union (\"afterwards, you have to clean up both for these actions\").</p>\n\n<pre><code>-- | combines two CleanupData into the resulting CleanupData\ncombineCleanupData :: CleanupData -&gt; CleanupData -&gt; CleanupData\ncombineCleanupData dta1 dta2 =\n  CleanupData\n    {\n         keyboard_needs_cleanup =\n           (keyboard_needs_cleanup dta1) || (keyboard_needs_cleanup dta2)\n\n       , buttons_needing_cleanup =\n           (buttons_needing_cleanup dta1) `Set.union` (buttons_needing_cleanup dta2)\n\n      -- union other data fields\n      -- ...\n    }\n</code></pre>\n\n<p>For example, if:</p>\n\n<p><code>action1 :: NeedsCleanup X ()</code> is associated with <code>dta1 :: CleanupData</code></p>\n\n<p><code>action2 :: NeedsCleanup X ()</code> is associated with <code>dta2 :: CleanupData</code></p>\n\n<p>Then, <code>action1 &gt;&gt; action2</code> should be associated with <code>combineCleanupData dta1 dta2</code> (roughly \"what you need to clean up for both\").  </p>\n\n<p>Finally, at the end, the function <code>cleanedUp :: NeedsCleanup X t -&gt; X t</code> should execute the underlying <code>X t</code> action and get the action's <code>CleanupData</code> (to see what needs cleaning up).</p>\n\n<p>Is it possible to use a monadic wrapper to keep track of data in this way?</p>\n\n<hr>\n\n<p><strong>Update:</strong></p>\n\n<p>I ended up using something similar to Ilmo Euro's answer, except defining a Monoid structure for CleanupData instead of using the List Monoid.  Something similar to:</p>\n\n<pre><code>import Control.Monad.Writer.Lazy (WriterT(..), runWriterT, tell, MonadWriter(..))\nimport Control.Monad.Trans.Class (MonadTrans(..))\nimport Data.Monoid (Monoid(..))\n\ninitialCleanupData =\n  CleanupData\n    {\n        keyboard_needs_cleanup = False\n      , buttons_needing_cleanup = Set.empty\n\n      -- initial values for other fields\n    }\n\ninstance Monoid CleanupData where\n  mempty = initialCleanupData\n  mappend = combineCleanupData\n\nnewtype NeedsCleanup m t = \n  NeedsCleanup\n    {\n      to_writable :: WriterT CleanupData m t\n    } deriving (MonadTrans, Monad, Applicative, Functor, MonadIO, MonadWriter CleanupData)\n\ncleanup :: NeedsCleanup X t -&gt; X t\ncleanup action = do\n  (ret_val, cleanup_data) &lt;- runWriterT (to_writable action)\n\n  -- clean up based on cleanup_data\n  --   ...\n\n  return ret_val \n</code></pre>\n\n<p>In order to define an action that needs cleanup, I would <code>tell</code> it its <code>CleanupData</code>, for example, something similar to:</p>\n\n<pre><code>needsCleanup_GrabButton\n  :: MonadIO m =&gt; Display -&gt; Window -&gt; Button -&gt; NeedsCleanup m ()\nneedsCleanup_GrabButton dply window button = do\n    liftIO $ grabButton dply button anyModifier window True buttonReleaseMask grabModeAsync grabModeAsync none none\n\n    tell cleanup_data\n  where\n    -- the stuff we need to clean up from this\n    -- particular action\n    cleanup_data = initialCleanupData\n      {\n          buttons_needing_cleanup = Set.singleton button\n      }\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 245145, "user_id": 1348195, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f6dca2295546af21e1cde8e68f2d49bd?s=128&d=identicon&r=PG", "display_name": "Benjamin Gruenbaum", "link": "https://stackoverflow.com/users/1348195/benjamin-gruenbaum"}, "is_accepted": false, "score": 3, "last_activity_date": 1431875915, "last_edit_date": 1431875915, "creation_date": 1431875517, "answer_id": 30288358, "question_id": 30288336, "link": "https://stackoverflow.com/questions/30288336/variables-in-instance-declaration/30288358#30288358", "title": "Variables in instance declaration", "body": "<p>Well, <code>==</code> is an <em>infix</em> function, you can read this as a pattern matching on:</p>\n\n<pre><code>(==) (Just x) (Just y)\n</code></pre>\n\n<p>In which case it is clear that <code>x</code> and <code>y</code> are the function parameters in the pattern matching.</p>\n\n<p>A simpler example can be shown (without type classes) as: </p>\n\n<pre><code>areBothFive:: Int -&gt; Int -&gt; Bool\n5 `areBothFive` 5 = True \nx `areBothFive` y = False -- the x and y are variables in the pattern match here\n\nareBothFive 5 5 -- true\nareBothFive 4 5 -- false\n</code></pre>\n\n<p>Here's <a href=\"http://coliru.stacked-crooked.com/a/7384558ae53c736e\" rel=\"nofollow\">a fiddle illustrating the issue</a>. </p>\n\n<p>LYAH gives an example using this syntax in the \"Syntax in Functions\" chapter.</p>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 2, "last_activity_date": 1431875623, "creation_date": 1431875623, "answer_id": 30288371, "question_id": 30288336, "link": "https://stackoverflow.com/questions/30288336/variables-in-instance-declaration/30288371#30288371", "title": "Variables in instance declaration", "body": "<p>They are there to <a href=\"https://en.wikibooks.org/wiki/Haskell/Pattern_matching\" rel=\"nofollow\">deconstruct the pattern</a> <code>Just _</code> - so:</p>\n\n<ul>\n<li><code>let (Just x) = Just 5</code> will give you <code>x &lt;- 5</code> </li>\n<li>on the other hand <code>let (Just x) = Nothing</code> will just match (and fall through to another case - here it will be the <code>_ == _</code></li>\n</ul>\n\n<h3>remark</h3>\n\n<p>the <code>let</code> is just there so that you can try this out in <strong>GHCi</strong>:</p>\n\n<pre><code>&gt; let (Just x) = Just 5\n&gt; x\n5\n\n&gt; let (Just x) = Nothing\n&gt; x\n*** Exception: &lt;interactive&gt;:4:5-22: Irrefutable pattern failed for pattern (Just x)\n</code></pre>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1431875915, "creation_date": 1431875399, "question_id": 30288336, "link": "https://stackoverflow.com/questions/30288336/variables-in-instance-declaration", "title": "Variables in instance declaration", "body": "<p>This snippet is from LYAH:</p>\n\n<pre><code>instance\u00a0(Eq\u00a0m)\u00a0=&gt;\u00a0Eq\u00a0(Maybe\u00a0m)\u00a0where\u00a0\u00a0\u00a0\u00a0\u00a0\n\nJust\u00a0x\u00a0==\u00a0Just\u00a0y\u00a0=\u00a0x\u00a0==\u00a0y\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\nNothing\u00a0==\u00a0Nothing\u00a0=\u00a0True\u00a0\u00a0\u00a0\u00a0\u00a0\n\u00a0_\u00a0==\u00a0_\u00a0=\u00a0False\n</code></pre>\n\n<p>I am totally confused as to what <code>x</code> and <code>y</code> are supposed to be since they are not defined anywhere. Can anyone help me understand this?</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 1921, "user_id": 524504, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6d715d98c43cfab37541a28d1c60360e?s=128&d=identicon&r=PG", "display_name": "masterxilo", "link": "https://stackoverflow.com/users/524504/masterxilo"}, "edited": false, "score": 1, "creation_date": 1481658295, "post_id": 30288313, "comment_id": 69462517, "body": "True, the compiler does not know what the methods are supposed to do. But maybe a worthwhile addition to the language would be a way to tell it. Related: <a href=\"http://stackoverflow.com/a/3864801/524504\">stackoverflow.com/a/3864801/524504</a>"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 10, "last_activity_date": 1431875295, "creation_date": 1431875295, "answer_id": 30288313, "question_id": 30288119, "link": "https://stackoverflow.com/questions/30288119/in-haskell-how-to-derive-such-a-custom-class-automatically/30288313#30288313", "title": "In Haskell, how to derive such a custom class automatically?", "body": "<p>You can't use deriving with user-defined classes. Usually <code>deriving</code> automatically generates code for the given class's methods, which is only possible because the compiler knows what the methods are supposed to do and can thus generate suitable implementations based on your type's structure. This is obviously not possible for user-defined classes as the compiler has no way of knowing how the methods are supposed to behave.</p>\n\n<p>In your case it looks like all you want is to use the default implementations of the one method your class has, so no implementation would need to be generated by the compiler. Of course that means that <code>deriving</code> isn't necessary at all and you can just use an instance declaration without a body.</p>\n\n<p>PS: If you'll always want to use the default implementation of the method, it might make the most sense not to use a class at all, but just define <code>myAnd</code> as a function.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 9, "last_activity_date": 1431881812, "creation_date": 1431881812, "answer_id": 30289520, "question_id": 30288119, "link": "https://stackoverflow.com/questions/30288119/in-haskell-how-to-derive-such-a-custom-class-automatically/30289520#30289520", "title": "In Haskell, how to derive such a custom class automatically?", "body": "<p>For this specific problem, you can simply avoid defining a custom class:</p>\n\n<pre><code>data TrafficLight = Red | Yellow | Green deriving Show\n\nmyAnd :: (Show a) =&gt; a -&gt; a -&gt; String\nx `myAnd` y = (show x) ++ \" and \" ++ (show y)\n</code></pre>\n\n<p>Now, <code>myAnd</code> is applicable to <code>TrafficLight</code>s (as well as all the other <code>Show</code>able types).</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 5221348, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-kOCIlDdx-ns/AAAAAAAAAAI/AAAAAAAAAyo/ueDHObVyNM8/photo.jpg?sz=128", "display_name": "lvsz", "link": "https://stackoverflow.com/users/5221348/lvsz"}, "is_accepted": false, "score": 0, "last_activity_date": 1548064437, "creation_date": 1548064437, "answer_id": 54287346, "question_id": 30288119, "link": "https://stackoverflow.com/questions/30288119/in-haskell-how-to-derive-such-a-custom-class-automatically/54287346#54287346", "title": "In Haskell, how to derive such a custom class automatically?", "body": "<p>Found this question while trying to figure out how to use GHC's <code>DeriveAnyClass</code> extension, which had only been out for three weeks back when this was asked.</p>\n\n<p>Using it, the following works as you'd expect:</p>\n\n<pre><code>{-# LANGUAGE DeriveAnyClass #-}\n\nclass Show a =&gt; MyAnd a where\n    myAnd :: a -&gt; a -&gt; String\n    x `myAnd` y = (show x) ++ \" and \" ++ (show y)\n\ndata TrafficLight = Red | Yellow | Green deriving (Show, MyAnd)\n</code></pre>\n\n<p>Should be used with caution though, as it will literally derive <em>any</em> class, creating empty instances when necessary.</p>\n"}], "owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 1, "answer_count": 3, "score": 10, "last_activity_date": 1548064437, "creation_date": 1431874176, "question_id": 30288119, "link": "https://stackoverflow.com/questions/30288119/in-haskell-how-to-derive-such-a-custom-class-automatically", "title": "In Haskell, how to derive such a custom class automatically?", "body": "<p>The codes looks like this:</p>\n\n<pre><code>class MyAnd a where\n  myAnd :: (Show a) =&gt; a -&gt; a -&gt; String\n  x `myAnd` y = (show x) ++ \" and \" ++ (show y)\n\ndata TrafficLight = Red | Yellow | Green deriving(Show, MyAnd)\n</code></pre>\n\n<p>Here <code>MyAnd</code> is a type class which has a function <code>myAnd</code>, I thought it is generic and the only constraint is the <code>a</code> has to has an instance of <code>Show</code> class..</p>\n\n<p>In the <code>TrafficLight</code> type, it already derived from <code>Show</code> type class. However, when I compiled the codes, the compiler complains</p>\n\n<pre><code>    Can't make a derived instance of \u2018MyAnd TrafficLight\u2019:\n      \u2018MyAnd\u2019 is not a derivable class\n    In the data declaration for \u2018TrafficLight\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Does anyone have ideas about this?</p>\n"}, {"tags": ["json", "haskell", "types", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 1079, "user_id": 1909658, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cfMSw.png?s=128&g=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/1909658/bradley"}, "edited": false, "score": 0, "creation_date": 1431859576, "post_id": 30286003, "comment_id": 48669554, "body": "Confirming my suspicion whilst providing a great response, thanks!"}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 11, "last_activity_date": 1431859347, "creation_date": 1431859347, "answer_id": 30286003, "question_id": 30285789, "link": "https://stackoverflow.com/questions/30285789/expecting-a-type-but-actually-getting-a-maybe-a0/30286003#30286003", "title": "Expecting a type but actually getting a Maybe a0", "body": "<p>The reason for the error is that <code>decode</code> does not always succeed. Its type is</p>\n\n<pre><code>decode :: Data a =&gt; ByteString -&gt; Maybe a\n</code></pre>\n\n<p>Correspondingly,</p>\n\n<pre><code>(decode &lt;$&gt;) :: Data a =&gt; IO ByteString -&gt; IO (Maybe a)\n                          -- desired type, IO Temperatures, won't unify\n</code></pre>\n\n<p>The type error message gives you the abstract <code>Maybe a0</code> as the actual type because it detects the conflict between <code>Maybe</code> and <code>Temperatures</code> before it gets anywhere near the point of choosing an appropriate instance for the <code>Data a</code> in the type of <code>decode</code>.</p>\n\n<p>Your code needs to account for the possibility that the file delivers its contents but that they don't successfully <code>decode</code> to <code>Temperatures</code>.</p>\n\n<p>Something like</p>\n\n<pre><code>do mt &lt;- decode &lt;$&gt; getFile\n   case mt of\n     Nothing -&gt; -- handle failure here\n     Just t  -&gt; return t\n</code></pre>\n\n<p>or if you're happy for <code>decode</code> failure to trigger an <code>IO</code> \"user error\", just</p>\n\n<pre><code>do Just t &lt;- decode &lt;$&gt; getFile\n   return t\n</code></pre>\n\n<p>Any way up, there's a failure mode that your code does not address, and that's what's surfacing as a type error.</p>\n"}], "owner": {"reputation": 1079, "user_id": 1909658, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cfMSw.png?s=128&g=1", "display_name": "Bradley", "link": "https://stackoverflow.com/users/1909658/bradley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 30286003, "answer_count": 1, "score": 1, "last_activity_date": 1431859347, "creation_date": 1431857879, "question_id": 30285789, "link": "https://stackoverflow.com/questions/30285789/expecting-a-type-but-actually-getting-a-maybe-a0", "title": "Expecting a type but actually getting a Maybe a0", "body": "<p>I have a function which uses Aeson to get data from a json object within a file. The data and function are both defined below.</p>\n\n<pre><code>data Data = Data { date :: String\n                   , temperature :: Int\n                    } deriving (Show, Read, Generic)\n\ndata Temperatures = Temperatures { temperatures :: [Data]\n                                 } deriving (Show, Generic)\n\nmooStuff :: IO Temperatures\nmooStuff  = decode &lt;$&gt; getFile\n    where\n        getFile = B.readFile \"Hello.txt\"\n</code></pre>\n\n<p>The file the function is using contains:</p>\n\n<pre><code>Data {date = \"2015-02-28T20:16:12+00:00\", temperature = 0}\nData {date = \"2015-01-01T21:46:55+00:00\", temperature = 2}\nData {date = \"2015-04-08T21:46:53+00:00\", temperature = 3}\nData {date = \"2015-04-09T21:46:01+00:00\", temperature = 4}\nData {date = \"2015-04-10T21:46:40+00:00\", temperature = 5}\nData {date = \"2015-04-11T21:46:36+00:00\", temperature = 6}\nData {date = \"2015-04-12T20:36:25+00:00\", temperature = 7}\n</code></pre>\n\n<p>However I'm getting a type error:</p>\n\n<pre><code>test.hs:37:13:\n    Couldn't match type \u2018Maybe a0\u2019 with \u2018Temperatures\u2019\n    Expected type: B.ByteString -&gt; Temperatures\n      Actual type: B.ByteString -&gt; Maybe a0\n    In the first argument of \u2018(&lt;$&gt;)\u2019, namely \u2018decode\u2019\n    In the expression: decode &lt;$&gt; getFile\n</code></pre>\n\n<p>I've been staring at this for hours now, to no avail. Any ideas about where I'm going wrong would be greatly appreciated!</p>\n"}, {"tags": ["list", "function", "haskell", "elements"], "comments": [{"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1431866863, "post_id": 30285327, "comment_id": 48671353, "body": "I think the div problem is that you may need extra parentheses. It&#39;s possible that you may be trying to compute div (x !! l) 2 instead of x !! (div l 2). The former would require the element type to be Integral; the latter merely requires Int to be Integral."}], "answers": [{"comments": [{"owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "edited": false, "score": 0, "creation_date": 1431857352, "post_id": 30285405, "comment_id": 48668984, "body": "also,when [a]-&gt;a is Num and <i>div</i> needs Integral, how can I fix it. I have edited my question"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "edited": false, "score": 0, "creation_date": 1431867071, "post_id": 30285405, "comment_id": 48671400, "body": "@user4325010 Probably you lack parentheses, try <code>xs !! (l `div` 2)</code>"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1431855218, "last_edit_date": 1431855218, "creation_date": 1431854866, "answer_id": 30285405, "question_id": 30285327, "link": "https://stackoverflow.com/questions/30285327/error-while-getting-the-middle-element-of-a-list-in-haskell/30285405#30285405", "title": "Error while getting the middle element of a list in Haskell", "body": "<p>Note that <code>x</code> is just an element, not a list. So, using <code>x !! anything</code> is a type error. Did you mean <code>xs !! anything</code> instead?</p>\n\n<p>Further,</p>\n\n<pre><code>middle [] = []\n</code></pre>\n\n<p>is wrong since you must return an element, not a list. Since there is no middle element, we can only return bottom, e.g.</p>\n\n<pre><code>middle [] = error \"middle: empty list\"\n</code></pre>\n\n<p>The above makes the function a partial one, i.e. if in a larger program you call the function with an empty list, the program will crash. </p>\n\n<p>If you want to forbid that, you can change the type to <code>Maybe</code>:</p>\n\n<pre><code>middle :: [a] -&gt; Maybe a\nmiddle []     = Nothing\nmiddle (x:xs) = Just (.....)\n</code></pre>\n"}], "owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 30285405, "answer_count": 1, "score": 1, "last_activity_date": 1431857416, "creation_date": 1431854390, "last_edit_date": 1431857416, "question_id": 30285327, "link": "https://stackoverflow.com/questions/30285327/error-while-getting-the-middle-element-of-a-list-in-haskell", "title": "Error while getting the middle element of a list in Haskell", "body": "<p>First, I am completely new to Haskell, so sorry for the question in advance, as it might look kind of simple, but still I get this error message:</p>\n\n<pre><code>Couldn't match expected type `[a]' with actual type `a'\n  `a' is a rigid type variable bound by\n      the type signature for middle :: [a] -&gt; a\n      at myFile.lhs:18:12\nRelevant bindings include\n  xs :: [a] (bound at myFile.lhs:20:12)\n  x :: a (bound at myFile.lhs:20:10)\n  middle :: [a] -&gt; a\n    (bound at myFile.lhs:19:2)\nIn the first argument of `(!!)', namely `x'\nIn the first argument of `div', namely `x !! length xs'\n</code></pre>\n\n<p>Failed, modules loaded: none.</p>\n\n<p>While trying to load: </p>\n\n<pre><code>&gt;middle :: [a] -&gt; a\n&gt;middle [] = []\n&gt;middle (x:xs) = if (l `mod` 2 == 0) then xs !! (l`div` 2) - 1 else x !! l `div` 2\n    where l = length xs\n</code></pre>\n\n<p>If something is vague or unclear, please comment.</p>\n\n<p><strong>EDIT</strong>\nBecause of the use of <em>div</em> I get:</p>\n\n<pre><code>Error:     No instance for (Integral a) arising from a use of `div'\nPossible fix:\n  add (Integral a) to the context of\n    the type signature for middle :: [a] -&gt; a\nIn the expression: xs !! l `div` 2\nIn the expression:\n  if (l `mod` 2 == 0) then xs !! (l `div` 2) - 1 else xs !! l `div` 2\nIn an equation for `middle':\n    middle (x : xs)\n      = if (l `mod` 2 == 0) then\n            xs !! (l `div` 2) - 1\n        else\n            xs !! l `div` 2\n      where\n          l = length xs\n</code></pre>\n"}, {"tags": ["haskell", "shake-build-system"], "answers": [{"comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1431897965, "post_id": 30291541, "comment_id": 48681095, "body": "Thanks. The tagging looks fine."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1431898612, "post_id": 30291541, "comment_id": 48681259, "body": "Although, when done naively, it creates the marker now also when a certain rule is run, but has no effect, by using <code>writeFileChanged</code>. And <code>writeFileChanged</code> does not tell me whether it actually changed the file. I might have to use my own <code>writeFileChanged</code> for that."}, {"owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1431945667, "post_id": 30291541, "comment_id": 48697725, "body": "That&#39;s a bit yuk, but yes, would be required (and suggests the other two approaches wouldn&#39;t really work, since if you are getting that far, there&#39;s been quite a lot of rebuilding)."}], "tags": [], "owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "is_accepted": false, "score": 2, "last_activity_date": 1431892832, "creation_date": 1431892832, "answer_id": 30291541, "question_id": 30284679, "link": "https://stackoverflow.com/questions/30284679/shake-signal-whether-anything-had-to-be-rebuilt-at-all/30291541#30291541", "title": "Shake: Signal whether anything had to be rebuilt at all", "body": "<p>Currently there is no direct/simple way to determine if anything built. It's also not such a useful concept as for simpler build systems, as certain rules (especially those that define <code>storedValue</code> to return <code>Nothing</code>) will always \"rerun\", but then very quickly decide they don't need to run the rules that depend on them. To Shake, that is the same as rerunning. I can think of a few approaches, which one is best probably depends on your situation:</p>\n\n<p><strong>Tag the interesting rules</strong></p>\n\n<p>You could tag each interesting rule (one that produces something that needs uploading) with a function that writes to a specific file. If that specific file exists, then you need to upload. This might work slightly better, as if you do multiple Shake runs, and in the first something changes but the second nothing does, the file will still be present. If it makes sense, use an <code>IORef</code> instead of a file.</p>\n\n<p><strong>Use profiling</strong></p>\n\n<p>Shake has quite advanced profiling. If you pass <code>shakeProfile=[\"output.json\"]</code> it will produce a JSON file detailing what built and when. Runs are indexed by an Int, with <code>0</code> for the most recent run, and any runs that built nothing are excluded. If you have one rule that always fires (e.g. write to a dummy file with <code>alwaysRerun</code>) then if anything fired at the same time, it rebuilt.</p>\n\n<p><strong>Watch the <code>.shake.database</code> file size</strong></p>\n\n<p>Shake has a database, stored under <code>shakeFiles</code>. Each uninteresting run it will grow by a fairly small amount (~100 bytes) - but a fixed size given your system. If it changes in size by a greater amount, then it did something interesting.</p>\n\n<p>Of these approaches, tagging the interesting rules is probably the simplest and most direct (although does run the risk of you forgetting to tag something).</p>\n"}], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1431892832, "creation_date": 1431849768, "question_id": 30284679, "link": "https://stackoverflow.com/questions/30284679/shake-signal-whether-anything-had-to-be-rebuilt-at-all", "title": "Shake: Signal whether anything had to be rebuilt at all", "body": "<p>I use shake to build a bunch of static webpages, which I then have to upload to a remote host, using sftp. Currently, the cronjob runs</p>\n\n<pre><code>git pull # get possibly updated sources\n./my-shake-system \nlftp ... # upload\n</code></pre>\n\n<p>I\u2019d like to avoid running the final command if shake did not actually rebuild anything. Is there a way to tell shake \u201cRun command <code>foo</code>, after everything else, and only if you changed something!\u201d?</p>\n\n<p>Or alternatively, have shake report whether it did something in the process exit code?</p>\n\n<p>I guess I can add a rule that depends on all possibly generated file, but that seems to be redundant and error prone. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 19, "user_id": 4907791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3e3336ba3550b86c5191d4052f62cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/4907791/andi"}, "reply_to_user": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 0, "creation_date": 1431848186, "post_id": 30284364, "comment_id": 48666850, "body": "No. But if you have any idea for my example, please help me with an implementation."}, {"owner": {"reputation": 2862, "user_id": 3125120, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TGiXu.png?s=128&g=1", "display_name": "DeJaVo", "link": "https://stackoverflow.com/users/3125120/dejavo"}, "edited": false, "score": 0, "creation_date": 1431848387, "post_id": 30284364, "comment_id": 48666883, "body": "the appropriate name is subset and not  &quot;Arrangements of a list&quot;. please update your question. I&#39;ve added an answer for what you are looking for.."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2862, "user_id": 3125120, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TGiXu.png?s=128&g=1", "display_name": "DeJaVo", "link": "https://stackoverflow.com/users/3125120/dejavo"}, "edited": false, "score": 2, "creation_date": 1431872990, "post_id": 30284364, "comment_id": 48672959, "body": "@DeJaVo, no, that is not the appropriate name either. &quot;Subsets&quot; suggests that order does not matter. According to Wikipedia, these are called &quot;partial permutations&quot;, or when specific sizes are known, &quot;k-permutations of n&quot; (e.g., 2-permutations of 3)."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 4907791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3e3336ba3550b86c5191d4052f62cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/4907791/andi"}, "edited": false, "score": 0, "creation_date": 1431860229, "post_id": 30285491, "comment_id": 48669716, "body": "I wrote the code for permutations, but it still doesn&#39;t work.                                   &#39;import Data.List (delete)&#39;     pick :: Int -&gt; [a] -&gt; [[a]]     pick 0 _ = [[]]      pick _ [] = []     pick n (x:xs) = map (x:) (pick (n-1) xs) ++ pick n xs       permutations :: [a] -&gt; [[a]]     permutations [] = [[]]     permutations xs = [ x:ys | x &lt;- xs, ys &lt;- permutations (delete x xs)]       arrange :: Int -&gt; [a] -&gt; [[a]]     arrange n = concatMap permutations . pick n"}, {"owner": {"reputation": 19, "user_id": 4907791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3e3336ba3550b86c5191d4052f62cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/4907791/andi"}, "edited": false, "score": 0, "creation_date": 1431860487, "post_id": 30285491, "comment_id": 48669787, "body": "I get this error: ERROR file:{Hugs}\\An III\\Haskell\\aranj2.hs:10 - Cannot justify constraints in explicitly typed binding *** Expression    : permutations *** Type          : [a] -&gt; [[a]] *** Given context : () *** Constraints   : Eq a"}, {"owner": {"reputation": 19, "user_id": 4907791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3e3336ba3550b86c5191d4052f62cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/4907791/andi"}, "edited": false, "score": 0, "creation_date": 1431860605, "post_id": 30285491, "comment_id": 48669829, "body": "And if I modify the declaration of permutations with this one permutations :: Eq a =&gt; [a] -&gt; [[a]], I get this error: Cannot justify constraints in explicitly typed binding *** Expression    : arrange *** Type          : Int -&gt; [a] -&gt; [[a]] *** Given context : () *** Constraints   : Eq a"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 19, "user_id": 4907791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3e3336ba3550b86c5191d4052f62cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/4907791/andi"}, "edited": false, "score": 0, "creation_date": 1431861638, "post_id": 30285491, "comment_id": 48670148, "body": "well using <code>delete</code> you have to include the <code>Eq a</code> everywhere you are using it (including my <code>arrange</code>) but there is a way (obvious) of writing <code>permutations</code> without delete ;) - but yours is fine - just add the constraints"}, {"owner": {"reputation": 19, "user_id": 4907791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3e3336ba3550b86c5191d4052f62cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/4907791/andi"}, "edited": false, "score": 0, "creation_date": 1431862888, "post_id": 30285491, "comment_id": 48670547, "body": "Thank you for your indications. It helps me a lot."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 19, "user_id": 4907791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3e3336ba3550b86c5191d4052f62cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/4907791/andi"}, "edited": false, "score": 0, "creation_date": 1431865521, "post_id": 30285491, "comment_id": 48671081, "body": "Glad I could help - if this answers your question you might want to accept it - if not I will happily try to help you further"}, {"owner": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "edited": false, "score": 0, "creation_date": 1503820380, "post_id": 30285491, "comment_id": 78764298, "body": "Could you explain what the pick function actually does?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 1713, "user_id": 3989939, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/530734853101ecc62e278406ed5b9065?s=128&d=identicon&r=PG&f=1", "display_name": "JavascriptLoser", "link": "https://stackoverflow.com/users/3989939/javascriptloser"}, "edited": false, "score": 0, "creation_date": 1503831636, "post_id": 30285491, "comment_id": 78766930, "body": "@JavascriptLoser it generates a list of ways to pick n elements from the input list (without reordering) - for example <code>pick 2 [1,2,3] = [[1,2],[1,3],[2,3]]</code>"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 3, "last_activity_date": 1431855543, "creation_date": 1431855543, "answer_id": 30285491, "question_id": 30284364, "link": "https://stackoverflow.com/questions/30284364/subsets-of-elements-of-a-list-in-haskell/30285491#30285491", "title": "Subsets of elements of a list in Haskell", "body": "<p>Well based on your example this is a possible solution:</p>\n\n<pre><code>import Data.List (permutations)\n\npick :: Int -&gt; [a] -&gt; [[a]]\npick 0 _ = [[]]\npick _ [] = []\npick n (x:xs) = map (x:) (pick (n-1) xs) ++ pick n xs\n\narrange :: Int -&gt; [a] -&gt; [[a]]\narrange n = concatMap permutations . pick n\n</code></pre>\n\n<h3>example</h3>\n\n<pre><code>\u03bb&gt; arrange 2 [2,3,4]\n[[2,3],[3,2],[2,4],[4,2],[3,4],[4,3]]\n</code></pre>\n\n<p>as you can see the trick is just picking a number of elements and then getting all permutations of the results (using <code>concatMap</code> to concat them together)</p>\n\n<p>of course this might be homework so you might want to implement <code>permutations</code> by yourself ;)</p>\n"}], "owner": {"reputation": 19, "user_id": 4907791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3e3336ba3550b86c5191d4052f62cbf?s=128&d=identicon&r=PG&f=1", "display_name": "Andi", "link": "https://stackoverflow.com/users/4907791/andi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2360, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431863550, "creation_date": 1431847157, "last_edit_date": 1431863550, "question_id": 30284364, "link": "https://stackoverflow.com/questions/30284364/subsets-of-elements-of-a-list-in-haskell", "title": "Subsets of elements of a list in Haskell", "body": "<p>Can anyone help me to generate all the subsets of a given set?</p>\n\n<p>Example:If I have [2,3,4] and if I want K=2, that means I need pairs of two => [[2,3], [3,2], [2,4], [4,2], [3,4], [4,3]]</p>\n\n<p>I wrote this code, but it generates only the number of subsets:</p>\n\n<pre><code>arrange::Int-&gt;Int-&gt;Int\narrange n 1=n\narrange n r=n*arrange (n-1) (r-1)\n</code></pre>\n\n<p>Another version, but this doesn't generate all solutions of the subsets:</p>\n\n<pre><code>  arrange 0 _ =[[]]\n  arrange _ []=[]\n  arrange n (x:xs)=(map(x:)) (arrange (n-1) xs)++\n                   (arrange n xs)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 0, "creation_date": 1431846061, "post_id": 30284056, "comment_id": 48666403, "body": "Are you getting any errors?"}], "answers": [{"comments": [{"owner": {"reputation": 837, "user_id": 4072022, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2b8d2b1ab1299eb31efacc0843964517?s=128&d=identicon&r=PG&f=1", "display_name": "Rumen Hristov", "link": "https://stackoverflow.com/users/4072022/rumen-hristov"}, "edited": false, "score": 0, "creation_date": 1431846927, "post_id": 30284254, "comment_id": 48666579, "body": "Thanks. I know how to use $. :)) I am looking back at old code and I am seeing indeed that they all start with a print $ ..... statement."}], "tags": [], "owner": {"reputation": 26541, "user_id": 1532460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dc5b338bf194a9e117af20bd9b2e4edb?s=128&d=identicon&r=PG", "display_name": "awesoon", "link": "https://stackoverflow.com/users/1532460/awesoon"}, "is_accepted": true, "score": 3, "last_activity_date": 1431846112, "creation_date": 1431846112, "answer_id": 30284254, "question_id": 30284056, "link": "https://stackoverflow.com/questions/30284056/what-is-wrong-in-the-call-of-this-simple-haskell-test-function/30284254#30284254", "title": "what is wrong in the call of this simple haskell test function", "body": "<p><code>main</code> function is an entry point of a program and it <strong>must</strong> be of type <code>IO ()</code>, but you are defining it in terms of function with <code>Int</code> type. So, you should transform <code>Int</code> to <code>IO ()</code>, that is why you need a function with type <code>Int -&gt; IO()</code>. It may print the given number to <em>stdout</em>, or just sleep the program for a given duration. You could find out such functions using <a href=\"https://www.haskell.org/hoogle/?hoogle=Int+-%3E+IO+%28%29\" rel=\"nofollow\">Hoogle</a>. </p>\n\n<p>Note, that <code>print</code> function has <code>Show a =&gt; a -&gt; IO ()</code> type, so, it is better to search this function by name, not by type <code>Int -&gt; IO ()</code>.</p>\n\n<p>So, if you want to print the result of your function, you should rewrite <code>main</code> function in the following way:</p>\n\n<pre><code>main = print $ convChar 'A'\n</code></pre>\n\n<p>Just a note: if you are not familiar with <code>$</code> function, you could use brackets, to define the order of execution</p>\n\n<pre><code>main = print (convChar 'A')\n</code></pre>\n\n<p>But using <code>$</code> makes your code cleaner</p>\n"}], "owner": {"reputation": 837, "user_id": 4072022, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2b8d2b1ab1299eb31efacc0843964517?s=128&d=identicon&r=PG&f=1", "display_name": "Rumen Hristov", "link": "https://stackoverflow.com/users/4072022/rumen-hristov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 30284254, "answer_count": 1, "score": 0, "last_activity_date": 1431846112, "creation_date": 1431844410, "question_id": 30284056, "link": "https://stackoverflow.com/questions/30284056/what-is-wrong-in-the-call-of-this-simple-haskell-test-function", "title": "what is wrong in the call of this simple haskell test function", "body": "<p>Been a loooong time since I wrote code in Haskell, so while I do know quite a bit about it (from previous experience) it is slowly comming back. I am not sure why the following snippet does not want to run. Could you point out please.</p>\n\n<pre><code>convChar::Char-&gt;Int\nconvChar chr\n |chr == 'A'    =0\n |otherwise     =28\n\nmain = do\nconvChar 'A'\n</code></pre>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "edited": false, "score": 0, "creation_date": 1431916707, "post_id": 30283746, "comment_id": 48685028, "body": "thank you so you mean i can store JSON on a session? what bout in Cache is it also possible?"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 1, "last_activity_date": 1431841249, "creation_date": 1431841249, "answer_id": 30283746, "question_id": 30283585, "link": "https://stackoverflow.com/questions/30283585/storing-a-non-string-data-in-yesod-session/30283746#30283746", "title": "Storing a non-String data in Yesod Session?", "body": "<p>You need to serialize the data to Text somehow. One option is via JSON using the aeson library.</p>\n"}], "owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1431841249, "creation_date": 1431839406, "question_id": 30283585, "link": "https://stackoverflow.com/questions/30283585/storing-a-non-string-data-in-yesod-session", "title": "Storing a non-String data in Yesod Session?", "body": "<p>I want know if it is possible to Store a non-String Data on a session?\ne.g: is a  <code>List</code>.</p>\n\n<p>If not what would be the great suggestion in this. the purpose of this is i have a planning using the <a href=\"http://jdabbs.com/resquing-yesod/\" rel=\"nofollow\"><code>Background Worker</code></a> to do some work and store it in a list.</p>\n\n<p>hope you help me.</p>\n"}, {"tags": ["c", "haskell", "functional-programming", "procedural"], "comments": [{"owner": {"reputation": 1350, "user_id": 4413370, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fWSa5.jpg?s=128&g=1", "display_name": "Jorge Torres", "link": "https://stackoverflow.com/users/4413370/jorge-torres"}, "edited": false, "score": 0, "creation_date": 1431838504, "post_id": 30283364, "comment_id": 48665103, "body": "The answer is more theoretical than practical, but if you want a practical example, think about multi-threading and race conditions for shared data as one of the side-effects that can happen in a procedural paradigm. A pure functional programming tool would be designed to avoid such conditions. You might find this link useful: <a href=\"http://www.quora.com/Why-does-functional-programming-favor-concurrency\" rel=\"nofollow noreferrer\">quora.com/Why-does-functional-programming-favor-concurrency</a>"}, {"owner": {"reputation": 779, "user_id": 2611355, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Iil2x.jpg?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/2611355/james"}, "edited": false, "score": 0, "creation_date": 1431840113, "post_id": 30283364, "comment_id": 48665359, "body": "The way i understand it is functional languages try to use <a href=\"http://en.wikipedia.org/wiki/Pure_function\" rel=\"nofollow noreferrer\">pure functions</a> plus they are declarative so you tell them <i>what</i> you would like to do and the compiler figures out how and since it&#39;s philosophy is to use pure functions it does it that way with no side effects while procedural languages are imperative, you tell them <i>how</i> to do something, they just follow instructions step by step and don&#39;t care if it&#39;s a pure function or not."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 3413479, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-RA29hoLzCZw/AAAAAAAAAAI/AAAAAAAAAFk/y_0xE-d-l6Y/photo.jpg?sz=128", "display_name": "jfjhh", "link": "https://stackoverflow.com/users/3413479/jfjhh"}, "is_accepted": false, "score": 3, "last_activity_date": 1431928809, "last_edit_date": 1431928809, "creation_date": 1431839933, "answer_id": 30283630, "question_id": 30283364, "link": "https://stackoverflow.com/questions/30283364/difference-between-procedural-and-functional-languages/30283630#30283630", "title": "Difference between procedural and functional languages?", "body": "<p>Purely functional languages operate such that the same input <em>always</em> produces the same output, with pure functions having no side effects. However, in procedural or not purely functional languages, such as C, side effects can occur, such as a pointer being modified, or other outside factors such as time or file I/O. Even Haskell can do file I/O. Therefore if Haskell with I/O is a purely functional language, then <a href=\"http://conal.net/blog/posts/the-c-language-is-purely-functional\" rel=\"nofollow\">C and the <code>cpp</code> are purely functional, too</a>.</p>\n\n<p>Take this C program as an example:</p>\n\n<pre><code>#ifndef _BSD_SOURCE\n#define _BSD_SOURCE\n#endif\n\n#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n\nint get_num(int n)\n{\n    usleep(1100000);\n    return (time(NULL) - n) % (n / 10);\n}\n\nint main(void)\n{\n    int i;\n\n    for (i = 0; i &lt; 10; i++)\n        printf(\"%d\\n\", get_num(4242));\n\n    return 0;\n}\n</code></pre>\n\n<p>We take a constant parameter of input, <code>4242</code>, to <code>get_num</code>. After the arbitrary math, it is because of the time factor and the sleeping that the same input does not produce the same output in this procedural language.</p>\n\n<p>Run at one time, we get:</p>\n\n<pre><code>247\n248\n249\n250\n251\n253\n254\n255\n256\n257\n</code></pre>\n\n<p>And run later, we get:</p>\n\n<pre><code>270\n271\n272\n273\n274\n275\n277\n278\n279\n280\n</code></pre>\n\n<p>In most C, side-effects abound. In a purely functional language though, such side-effects would not be present or possible.</p>\n"}, {"comments": [{"owner": {"reputation": 2401, "user_id": 5652872, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pCjVs.png?s=128&g=1", "display_name": "Akash Bisariya", "link": "https://stackoverflow.com/users/5652872/akash-bisariya"}, "edited": false, "score": 0, "creation_date": 1524394403, "post_id": 30285385, "comment_id": 86946081, "body": "Best answer..You nailed with the examples you have given. Thanks @chi"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1431854737, "creation_date": 1431854737, "answer_id": 30285385, "question_id": 30283364, "link": "https://stackoverflow.com/questions/30283364/difference-between-procedural-and-functional-languages/30285385#30285385", "title": "Difference between procedural and functional languages?", "body": "<p>In imperative programming, functions are allowed to have side-effects, such as modifying the value of variables, writing to files, accessing the network, etc. The second time the same function is run, it can detect the previous side effects and return something different. A simple C example is:</p>\n\n<pre><code>int i = 0;\nint foo() {\n  return i++;\n}\n</code></pre>\n\n<p>Calling this multiple times will generate different numbers. As another example:</p>\n\n<pre><code>int foo(int *p) {\n  return (*p)++;\n}\n</code></pre>\n\n<p>Even if you call the above with the same parameter, i.e. the same pointer, the result will be different because of the increment.</p>\n\n<p>In <em>pure</em> functional programming, side effects like <code>i++</code> are forbidden by design. In this way, the output of the function must depend only on the value of its arguments. E.g. if in Haskell we have a function <code>f</code> with type <code>Int -&gt; Int</code>, we can be sure that <code>f 3</code> will always return the same integer at every call.</p>\n\n<p>Well, the above is not entirely true -- a program eventually has to do some I/O, or would be meaningless. Because of this, side-effects must be available in some form. In Haskell, functions with side effects are actually allowed, but their type must tell these are not pure functions. E.g. if function <code>g</code> has type <code>Int -&gt; IO Int</code>, then it can perform I/O and have side-effects: running <code>print =&lt;&lt; g 3</code> can print different values every time, just as in imperative programming.</p>\n\n<p>So, summing up, in pure functional programming functions having side effects have a different type from functions who do not. Often, in a well-designed functional program, I/O and side-effects are rarely needed, and pure functions comprise the vast majority of the code. Because of this, sometimes we say that \"pure functional programming forbids side effects\", since most of the code is written under this constraint.</p>\n"}, {"comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1431951952, "post_id": 30286177, "comment_id": 48701912, "body": "It should be noted that even though <code>printTwice</code> is an pure function, it can be easily made <code>impure</code> because of the <code>IO</code> type constructor."}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 1, "last_activity_date": 1431860552, "creation_date": 1431860552, "answer_id": 30286177, "question_id": 30283364, "link": "https://stackoverflow.com/questions/30283364/difference-between-procedural-and-functional-languages/30286177#30286177", "title": "Difference between procedural and functional languages?", "body": "<p>To clarify further, it is not so much a property of a language. No imperative language forces you to write side effecting procedures only. It is also perfectly possible to write in a pure functional style, though it is not explicitly supported. </p>\n\n<p>Whereas in a <em>pure</em> functional language, there simply are no language constructs that allow you to modify variables, access globally visible storage etc. Thus it is a bit exaggerating to say that pure FP languages \"forbid\" impure functions - rather, there is just no way to write one in the first place. Note that even functions like:</p>\n\n<pre><code>printTwice x = do {putStrLn x; putStrLn x}\n</code></pre>\n\n<p>are <em>not</em> impure. Application of <code>printTwice</code> results in an IO action. You can do this many times, put the result in lists or tuples and pass them around, this is all pure. Specifically, there is no difference between:</p>\n\n<pre><code> twoActions = (printTwice \"hello\", printTwice \"hello\")\n</code></pre>\n\n<p>and </p>\n\n<pre><code> twoActions = (a,a) where a = printTwice \"hello\"\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 1534214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c2011b49450f3be70aaa41244362c9a?s=128&d=identicon&r=PG&f=1", "display_name": "EnthusiatForProgramming", "link": "https://stackoverflow.com/users/1534214/enthusiatforprogramming"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1040, "favorite_count": 0, "accepted_answer_id": 30285385, "answer_count": 3, "score": -2, "last_activity_date": 1431928809, "creation_date": 1431836866, "last_edit_date": 1495540333, "question_id": 30283364, "link": "https://stackoverflow.com/questions/30283364/difference-between-procedural-and-functional-languages", "title": "Difference between procedural and functional languages?", "body": "<p>I was asked this question in an interview recently. I could not get the right answer. </p>\n\n<p>When you repeatedly call a function in a procedural language(like C) and a functional language(like haskell) with same arguments in which language you might get a different result ? I read on [this] (<a href=\"https://stackoverflow.com/questions/23277/what-is-the-difference-between-procedural-programming-and-functional-programming_\">What is the difference between procedural programming and functional programming?</a>) post that pure functional languages will always result in the same answer. Why is this so for functional languages and not for procedural languages?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1431820465, "post_id": 30281541, "comment_id": 48661956, "body": "I would suggest an explicit <code>module Main (main) where</code>, to be sure the imports are not re-exported, which would force linking."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1431831925, "post_id": 30281541, "comment_id": 48664060, "body": "@chi <code>module Main (main) where</code> is the default."}], "answers": [{"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 5, "last_activity_date": 1431849971, "last_edit_date": 1431849971, "creation_date": 1431849606, "answer_id": 30284659, "question_id": 30281541, "link": "https://stackoverflow.com/questions/30281541/will-ghc-strip-out-unused-imports/30284659#30284659", "title": "Will GHC strip out unused imports?", "body": "<p>I did this simple test:</p>\n\n<pre><code>import Data.Map as M\nimport Data.Text as T\n\nmain = do\n  let m = M.fromList [(1, 2), (3, 4)]\n  putStrLn $ show m\n</code></pre>\n\n<p>and got:</p>\n\n<pre><code>$ ghc imports.hs\n$ $ ls -l imports\n-rwxr-xr-x+ 1 erik  staff  1583112 May 17 10:56 imports\n</code></pre>\n\n<hr>\n\n<p>I then commented out the unused <code>Data.Text</code> import:</p>\n\n<pre><code>import Data.Map as M\n-- import Data.Text as T\n\nmain = do\n  let m = M.fromList [(1, 2), (3, 4)]\n  putStrLn $ show m\n</code></pre>\n\n<p>and got this:</p>\n\n<pre><code>$ ghc imports.hs \n$ ls -l imports\n-rwxr-xr-x+ 1 erik  staff  1583112 May 17 10:56 imports\n</code></pre>\n\n<p>Nothing changed, so I must assume <code>Data.Text</code> was already ignored since it was unused.</p>\n\n<hr>\n\n<p>I then tried 2 more variants.</p>\n\n<p>Leaving in the <code>Data.Map</code> import and the <code>fromList</code> call, but not using the value in <code>m</code>:</p>\n\n<pre><code>import Data.Map as M\n-- import Data.Text as T\n\nmain = do\n  let m = M.fromList [(1, 2), (3, 4)]\n  putStrLn \"hello\"\n</code></pre>\n\n<p>which got me:</p>\n\n<pre><code>$ ghc imports.hs \n$ ls -l imports\n-rwxr-xr-x+ 1 erik  staff  1505292 May 17 10:56 imports\n</code></pre>\n\n<hr>\n\n<p>I then also removed the construction of <code>m</code> using <code>fromList</code>:</p>\n\n<pre><code>import Data.Map as M\n-- import Data.Text as T\n\nmain = do\n  putStrLn \"hello\"\n</code></pre>\n\n<p>which got me:</p>\n\n<pre><code>$ ghc imports.hs \n$ ls -l imports\n-rwxr-xr-x+ 1 erik  staff  1505284 May 17 10:56 imports\n</code></pre>\n\n<p>\u2014 the size barely changed. </p>\n\n<p>So my interpretation is that even if you're importing a library and using it superficially, but the use itself is unused, <strong>GHC will not link libraries whose imports are unused.</strong></p>\n"}], "owner": {"reputation": 4318, "user_id": 1382925, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6831bb8d29306532c9c511d144bdf4e2?s=128&d=identicon&r=PG", "display_name": "Profpatsch", "link": "https://stackoverflow.com/users/1382925/profpatsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "accepted_answer_id": 30284659, "answer_count": 1, "score": 4, "last_activity_date": 1431849971, "creation_date": 1431816687, "last_edit_date": 1431849918, "question_id": 30281541, "link": "https://stackoverflow.com/questions/30281541/will-ghc-strip-out-unused-imports", "title": "Will GHC strip out unused imports?", "body": "<p>When I don\u2019t use certain imports from the <code>main</code> function (which should be easily detectable), will GHC strip out the corresponding bindings?</p>\n\n<p>Example:</p>\n\n<pre><code>import Text.Parsec (parse)\nimport My.Testframework (test)\n\nmain = parse \u2026\n\ntests = test \u2026\n</code></pre>\n\n<p>Will <code>My.Testframework</code> be linked in the executable?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4897277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24181b454417d08cdef4c45d26a73f19?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Voicu", "link": "https://stackoverflow.com/users/4897277/adrian-voicu"}, "edited": false, "score": 0, "creation_date": 1431860593, "post_id": 30281241, "comment_id": 48669824, "body": "Thank you very much. At this moment, I don&#39;t really know how to work with drop, zip Width. For now, I choose to resolve the problem recursively."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1431813910, "creation_date": 1431813910, "answer_id": 30281241, "question_id": 30280843, "link": "https://stackoverflow.com/questions/30280843/check-if-a-list-has-ascending-elements-descending-elements-or-descending-eleme/30281241#30281241", "title": "check if a list has ascending elements - descending elements or descending elements - ascending elements", "body": "<p>You should start by thinking about the base case. You've started with a base case of a list with 1 element, but there's a simpler base case: the empty list. The empty list is normally considered to be <em>both</em> ascending <em>and</em> descending. The next thing you should do is to quit using <code>head</code>. It's partial, and will lead you into errors. Instead, pattern match everything.</p>\n\n<p>Hint on writing a really simple version, after you write the pattern-matching one: use <code>zipWith</code> and <code>drop</code>. Note that unlike <code>tail</code>, <code>drop</code> is a total function.</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 4897277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24181b454417d08cdef4c45d26a73f19?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Voicu", "link": "https://stackoverflow.com/users/4897277/adrian-voicu"}, "edited": false, "score": 0, "creation_date": 1431861821, "post_id": 30281576, "comment_id": 48670203, "body": "I made the changes below,  but i don&#39;t really know how to solve this error:  Type error in application *** Expression     : lung $ localMinima $ rmAdjacentDups xs *** Term           : lung *** Type           : [Integer] -&gt; Integer *** Does not match : Integer -&gt; Integer"}], "tags": [], "owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "is_accepted": true, "score": 0, "last_activity_date": 1431817008, "creation_date": 1431817008, "answer_id": 30281576, "question_id": 30280843, "link": "https://stackoverflow.com/questions/30280843/check-if-a-list-has-ascending-elements-descending-elements-or-descending-eleme/30281576#30281576", "title": "check if a list has ascending elements - descending elements or descending elements - ascending elements", "body": "<p>Here's a strategy: a list is a \"mountain\" if it has only one <a href=\"https://www.mathsisfun.com/algebra/functions-maxima-minima.html\" rel=\"nofollow\">local maximum</a> once you remove adjacent repeated elements. Likewise, a \"valley\" is a list that has only one local minimum once adjacent repeated elements are removed. The functions below will tell if a list is a mountain or a valley:</p>\n\n<pre><code>isMountain :: [Integer] -&gt; Bool\nisMountain xs = 1 == (length $ localMaxima $ rmAdjacentDups xs)\n\nisValley :: [Integer] -&gt; Bool\nisValley xs = 1 == (length $ localMinima $ rmAdjacentDups xs)\n\n*Main&gt; isMountain [1,2,3,4,5,6,3,2,1]\nTrue\n*Main&gt; isMountain [1,2,3,4,5,6,5,6,3,2,1]\nFalse\n*Main&gt; isValley [4,3,2,1,1,2,3,4]\nTrue\n*Main&gt; isValley [4,3,2,1,2,1,1,2,3,4]\nFalse\n</code></pre>\n\n<p>Leave a comment if you're stuck implementing <code>localMaxima</code>, <code>localMinima</code> or <code>rmAdjacentDups</code>. Hope this helps!</p>\n"}, {"comments": [{"owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "edited": false, "score": 0, "creation_date": 1431864982, "post_id": 30286380, "comment_id": 48670949, "body": "A local minimum of a list is an element of the list which is strictly smaller than both the elements immediately before and after it. For example, in the list <code>[4, 3, 5, 4, 1]</code>, the only local minimum is <code>3</code>, since it is smaller than the elements immediately before and after it (<code>4</code>and <code>5</code>). <code>1</code> is not a local minimum since there is no element that comes after it. Hence <code>localMinima [1]</code> shouldn&#39;t return <code>1</code> because there is no element that comes before nor after it. Also <code>localMinima</code> should return <code>[Integer]</code> because there can be more than one local minima in a list."}, {"owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "edited": false, "score": 0, "creation_date": 1431865280, "post_id": 30286380, "comment_id": 48671024, "body": "Give a shot at <a href=\"http://hspec.github.io/\" rel=\"nofollow noreferrer\">HSpec</a> to test your functions. For example, once <code>localMinima</code> pass your tests, then you can forget about it and move to <code>rmAdjacentDups</code>."}], "tags": [], "owner": {"reputation": 25, "user_id": 4897277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24181b454417d08cdef4c45d26a73f19?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Voicu", "link": "https://stackoverflow.com/users/4897277/adrian-voicu"}, "is_accepted": false, "score": 1, "last_activity_date": 1431861923, "creation_date": 1431861923, "answer_id": 30286380, "question_id": 30280843, "link": "https://stackoverflow.com/questions/30280843/check-if-a-list-has-ascending-elements-descending-elements-or-descending-eleme/30286380#30286380", "title": "check if a list has ascending elements - descending elements or descending elements - ascending elements", "body": "<pre><code>localMinima :: [Integer] -&gt; Integer\nlocalMinima [x]=x\nlocalMinima (x:xs) = if x&lt;m then x\n                 else m where m=localMinima xs\n\n\nrmAdjacentDups :: [Integer]-&gt;[Integer]\nrmAdjacentDups []     = []\nrmAdjacentDups (x:xs) = x : (rmAdjacentDups $ dropWhile (== x) xs)\n\n\nisValley :: [Integer] -&gt; Bool\nisValley xs = 1 == (length $ localMinima $ rmAdjacentDups xs)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4897277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24181b454417d08cdef4c45d26a73f19?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Voicu", "link": "https://stackoverflow.com/users/4897277/adrian-voicu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "accepted_answer_id": 30281576, "answer_count": 3, "score": 1, "last_activity_date": 1431861923, "creation_date": 1431810956, "question_id": 30280843, "link": "https://stackoverflow.com/questions/30280843/check-if-a-list-has-ascending-elements-descending-elements-or-descending-eleme", "title": "check if a list has ascending elements - descending elements or descending elements - ascending elements", "body": "<p>I'm beginner in Haskell. I have found a problem in a book: Check if a list has aspect of a \"mountain\", ascending elements - descending elements. Check if a list has aspect of a \"valley\",descending elements - ascending elements.Please help me. </p>\n\n<p>Exemple:</p>\n\n<p>\"Mountain\": [1,2,3,4,5,6,3,2,1]  </p>\n\n<p>\"Valley\": [4,3,2,1,1,2,3,4]</p>\n\n<p>My code looks: </p>\n\n<ol>\n<li><p>Mountain  </p>\n\n<pre><code>ordered::[Int]-&gt;Bool\nordered [a]=True\nordered (a:l)=if(a&gt;head(l)) then False\n          else ordered(l) \n</code></pre></li>\n<li><p>Valley</p>\n\n<pre><code>ordered::[Int]-&gt;Bool\nordered [a]=True\nordered (a:l)=if(a&lt;head(l)) then False\n          else ordered(l) \n</code></pre></li>\n</ol>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "lazy-evaluation", "formal-methods"], "comments": [{"owner": {"reputation": 269, "user_id": 2290347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/owtS1.jpg?s=128&g=1", "display_name": "lando", "link": "https://stackoverflow.com/users/2290347/lando"}, "edited": false, "score": 1, "creation_date": 1431805764, "post_id": 30279884, "comment_id": 48658305, "body": "This is the sequence: <a href=\"https://oeis.org/A000041\" rel=\"nofollow noreferrer\">oeis.org/A000041</a>"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 2, "creation_date": 1431805859, "post_id": 30279884, "comment_id": 48658342, "body": "You should say that &quot;P_0=1&quot;, as a starting-point."}, {"owner": {"reputation": 16267, "user_id": 1346276, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Tu8Re.jpg?s=128&g=1", "display_name": "phipsgabler", "link": "https://stackoverflow.com/users/1346276/phipsgabler"}, "edited": false, "score": 0, "creation_date": 1431852939, "post_id": 30279884, "comment_id": 48667872, "body": "Not entirely serious: May one of <a href=\"http://comonad.com/reader/2009/recursion-schemes/\" rel=\"nofollow noreferrer\">these</a>..."}], "answers": [{"tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": false, "score": 5, "last_activity_date": 1431805631, "creation_date": 1431805631, "answer_id": 30280054, "question_id": 30279884, "link": "https://stackoverflow.com/questions/30279884/computing-a-term-of-a-list-depending-on-all-previous-terms/30280054#30280054", "title": "Computing a term of a list depending on all previous terms", "body": "<p>How about using self-reference and lazyness?</p>\n\n<p>Assume the values of \u03c3 are in the infinite list <code>sigma</code>, then</p>\n\n<pre><code>p = [sum (zipWith (*) sigmas (reverse ps)) | ps &lt;- inits p]\n</code></pre>\n\n<p>would implement this recursion quite neatly.</p>\n\n<p>I am ignoring the factor of <code>n</code> here, for simplicity of the code, and also because I\u2019m not sure what P_0 should be.</p>\n"}, {"tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 8, "last_activity_date": 1431885777, "creation_date": 1431885777, "answer_id": 30290249, "question_id": 30279884, "link": "https://stackoverflow.com/questions/30279884/computing-a-term-of-a-list-depending-on-all-previous-terms/30290249#30290249", "title": "Computing a term of a list depending on all previous terms", "body": "<p><strong>Statutory Calculus Warning.</strong> The basic answer to this question involves specialising a standard recursion scheme. But I got a bit carried away pulling at the thread of it. Things take a more abstract turn as I seek to apply the same method to structures other than lists. I end up reaching for Isaac Newton and Ralph Fox, and in the process devise the <em>alopegmorphism</em>, which may be something new.</p>\n\n<p><strong>But anyway,</strong> something of the sort ought to exist. It looks like a special case of the <em>anamorphism</em> or \"unfold\". Let's start with what's called <code>unfoldr</code> in the library.</p>\n\n<pre><code>unfoldr :: (seed -&gt; Maybe (value, seed)) -&gt; seed -&gt; [value]\n</code></pre>\n\n<p>It shows how to grow a list of values from a seed, repeatedly using a function called a <em>coalgebra</em>. At each step, the coalgebra says whether to stop with <code>[]</code> or to carry on by consing a value onto a list grown from a new seed.</p>\n\n<pre><code>unfoldr coalg s = case coalg s of\n  Nothing       -&gt; []\n  Just (v, s')  -&gt; v : unfoldr coalg s'\n</code></pre>\n\n<p>Here, the <em>seed</em> type can be whatever you like &mdash; whatever local state is appropriate to the unfolding process. One entirely sensible notion of seed is simply \"the list so far\", perhaps in reverse order, so that the most recently added elements are nearest.</p>\n\n<pre><code>growList :: ([value] -&gt; Maybe value) -&gt; [value]\ngrowList g = unfoldr coalg B0 where\n  coalg vz = case g vz of   -- I say \"vz\", not \"vs\" to remember it's reversed\n    Nothing  -&gt; Nothing\n    Just v   -&gt; Just (v, v : vz)\n</code></pre>\n\n<p>At each step, our <code>g</code> operation looks at the context of values we already have and decides whether to add another: if so, the new value becomes both the head of the list and the most recent value in the new context.</p>\n\n<p>So, this <code>growList</code> hands you at each step your list of previous results, ready for <code>zipWith (*)</code>. The reversal is rather handy for the convolution, so perhaps we're looking at something like</p>\n\n<pre><code>ps = growList $ \\ pz -&gt; Just (sum (zipWith (*) sigmas pz) `div` (length pz + 1))\nsigmas = [sigma j | j &lt;- [1..]]\n</code></pre>\n\n<p>perhaps?</p>\n\n<p><strong>A recursion scheme?</strong> For lists, we have a special case of the anamorphism, where the seed is the context of what we've built so far, and once we've said how to build a bit more, we know how to grow the context by the same token. It's not hard to see how that works for lists. But how does it work for anamorphisms in general? <strong>Here's where things get hairy.</strong></p>\n\n<p>We build up possibly infinite values whose node shape is given by some functor <code>f</code> (whose parameter turns out to be \"substructures\" when we \"tie the knot\").</p>\n\n<pre><code>newtype Nu f = In (f (Nu f))\n</code></pre>\n\n<p>In an anamorphism, the coalgebra uses the seed to choose a shape for the outermost node, populated with seeds for the substructures. (Co)recursively, we map the anamorphism across, growing those seeds into substructures.</p>\n\n<pre><code>ana :: Functor f =&gt; (seed -&gt; f seed) -&gt; seed -&gt; Nu f\nana coalg s = In (fmap (ana coalg) (coalg s))\n</code></pre>\n\n<p>Let's reconstruct <code>unfoldr</code> from <code>ana</code>. We can build lots of ordinary recursive structures from <code>Nu</code> and a few simple parts: the <em>polynomial Functor kit</em>.</p>\n\n<pre><code>newtype  K1 a      x  = K1 a                  -- constants (labels)\nnewtype  I         x  = I x                   -- substructure places\ndata     (f :+: g) x  = L1 (f x) | R1 (g x)   -- choice (like Either)\ndata     (f :*: g) x  = f x :*: g x           -- pairing (like (,))\n</code></pre>\n\n<p>with <code>Functor</code> instances</p>\n\n<pre><code>instance Functor (K1 a) where fmap f (K1 a) = K1 a\ninstance Functor I      where fmap f (I s) = I (f s)\ninstance (Functor f, Functor g) =&gt; Functor (f :+: g) where\n  fmap h (L1 fs) = L1 (fmap h fs)\n  fmap h (R1 gs) = R1 (fmap h gs)\ninstance (Functor f, Functor g) =&gt; Functor (f :*: g) where\n  fmap h (fx :*: gx) = fmap h fx :*: fmap h gx\n</code></pre>\n\n<p>For lists of <code>value</code>, the node shape functor is</p>\n\n<pre><code>type ListF value = K1 () :+: (K1 value :*: I)\n</code></pre>\n\n<p>meaning \"either a boring label (for nil) or the (cons) pair of a <code>value</code> label and a sublist\". The type of a <code>ListF value</code> coalgebra becomes</p>\n\n<pre><code>seed -&gt; (K1 () :+: (K1 value :*: I)) seed\n</code></pre>\n\n<p>which is isomorphic (by \"evaluating\" the polynomial <code>ListF value</code> at <code>seed</code>) to</p>\n\n<pre><code>seed -&gt; Either () (value, seed)\n</code></pre>\n\n<p>which is but a hair's breadth from the</p>\n\n<pre><code>seed -&gt; Maybe (value, seed)\n</code></pre>\n\n<p>that <code>unfoldr</code> expects. You can recover an ordinary list like so</p>\n\n<pre><code>list :: Nu (ListF a) -&gt; [a]\nlist (In (L1 _))                = []\nlist (In (R1 (K1 a :*: I as)))  = a : list as\n</code></pre>\n\n<p>Now, how do we grow some general <code>Nu f</code>? A good start is to choose the <em>shape</em> for the outermost node. A value of type <code>f ()</code> gives just the shape of a node, with trivial stubs in the substructure positions. Indeed, to grow our trees, we basically need some way to choose the \"next\" node shape given some idea where we've got to and what we've done so far. We should expect</p>\n\n<pre><code>grow :: (..where I am in a Nu f under construction.. -&gt; f ()) -&gt; Nu f\n</code></pre>\n\n<p>Note that for growing lists, our step function returns a <code>ListF value ()</code>, which is isomorphic to <code>Maybe value</code>.</p>\n\n<p>But how do we express where we are in a <code>Nu f</code> so far? We're going to be so-many-nodes-in from the root of the structure, so we should expect a stack of layers. Each layer should tell us (1) its shape, (2) which position we're currently at, and (3) the structures already built to the left of that position, but we expect still to have stubs in the positions at which we have not yet arrived. In other words, it's an example of the <em>dissection</em> structure from my 2008 POPL paper about <a href=\"http://strictlypositive.org/CJ.pdf\">Clowns and Jokers</a>.</p>\n\n<p>The dissection operator turns a functor <code>f</code> (seen as a container of elements) into a bifunctor <code>Diss f</code> with two different sorts of elements, those on the left (clowns) and those on the right (jokers) of a \"cursor position\" within an <code>f</code> structure. First, let's have the <code>Bifunctor</code> class and some instances.</p>\n\n<pre><code>class Bifunctor b where\n  bimap :: (c -&gt; c') -&gt; (j -&gt; j') -&gt; b c j -&gt; b c' j'\n\nnewtype K2 a       c j = K2 a\ndata    (f :++: g) c j = L2 (f c j) | R2 (g c j)\ndata    (f :**: g) c j = f c j :**: g c j\nnewtype Clowns f   c j = Clowns (f c)\nnewtype Jokers f   c j = Jokers (f j)\n\ninstance Bifunctor (K2 a) where\n  bimap h k (K2 a) = K2 a\ninstance (Bifunctor f, Bifunctor g) =&gt; Bifunctor (f :++: g) where\n  bimap h k (L2 fcj) = L2 (bimap h k fcj)\n  bimap h k (R2 gcj) = R2 (bimap h k gcj)\ninstance (Bifunctor f, Bifunctor g) =&gt; Bifunctor (f :**: g) where\n  bimap h k (fcj :**: gcj) = bimap h k fcj :**: bimap h k gcj\ninstance Functor f =&gt; Bifunctor (Clowns f) where\n  bimap h k (Clowns fc) = Clowns (fmap h fc)\ninstance Functor f =&gt; Bifunctor (Jokers f) where\n  bimap h k (Jokers fj) = Jokers (fmap k fj)\n</code></pre>\n\n<p>Note that <code>Clowns f</code> is the bifunctor which amounts to an <code>f</code> structure containing only clowns, whilst <code>Jokers f</code> has only jokers. If you feel bothered by the repetition of all the <code>Functor</code> paraphernalia to get the <code>Bifunctor</code> paraphernalis, you're right to be bothered: it gets less laborious if we abstract away the arity and work with functors between <em>indexed</em> sets, but that's a whole other story.</p>\n\n<p>Let's define <em>dissection</em> as a class which associates a bifunctor with a functor.</p>\n\n<pre><code>class (Functor f, Bifunctor (Diss f)) =&gt; Dissectable f where\n  type Diss f :: * -&gt; * -&gt; *\n  rightward   ::  Either (f j) (Diss f c j, c) -&gt;\n                  Either (j, Diss f c j) (f c)\n</code></pre>\n\n<p>The type <code>Diss f c j</code> represents an <code>f</code>-structure with a \"hole\" or \"cursor position\" at one element position, and in the positions to the left of the hole we have \"clowns\" in <code>c</code>, and to the right we have \"jokers\" in <code>j</code>. (The terminology is lifted from the <em>Stealer's Wheel</em> song \"Stuck in the Middle with You\".)</p>\n\n<p>The key operation in the class is the isomorphism <code>rightward</code> which tells us how to move one place to the right, starting from either</p>\n\n<ul>\n<li>left of a whole structure full of jokers, or</li>\n<li>a hole in the structure, together with a clown to put in the hole</li>\n</ul>\n\n<p>and arriving at either</p>\n\n<ul>\n<li>a hole in the structure, together with the joker which came out of it, or</li>\n<li>right of a whole structure full of clowns.</li>\n</ul>\n\n<p>Isaac Newton was fond of dissections, but he called them <em>divided differences</em> and defined them on real-valued functions to get the slope between two points on a curve, thus</p>\n\n<pre><code>divDiff f c j  =  (f c - f j) / (c - j)\n</code></pre>\n\n<p>and he used them to make best polynomial approximations to any old functions, and the like. Multiply up and multiply out</p>\n\n<pre><code>divDiff f c j * c - j * divDiff f c j  =  f c - f j\n</code></pre>\n\n<p>then get rid of the subtraction by adding to both sides</p>\n\n<pre><code>f j + divDiff f c j * c  =  f c + j * divDiff f c j\n</code></pre>\n\n<p>and you've got the <code>rightward</code> isomorphism.</p>\n\n<p>We might build a bit more intuition for these things if we look at the instances, and then we can get back to our original problem.</p>\n\n<p>A boring old constant has zero as its divided difference.</p>\n\n<pre><code>instance Dissectable (K1 a) where\n  type Diss (K1 a) = K2 Void\n  rightward (Left (K1 a)) = (Right (K1 a))\n  rightward (Right (K2 v, _)) = absurd v\n</code></pre>\n\n<p>If we start to the left and go to the right, we jump over the whole structure, because there are no element positions. If we start in an element position, someone is lying!</p>\n\n<p>The identity functor has just <em>one</em> position.</p>\n\n<pre><code>instance Dissectable I where\n  type Diss I = K2 ()\n  rightward (Left (I j))       = Left (j, K2 ())\n  rightward (Right (K2 (), c)) = Right (I c)\n</code></pre>\n\n<p>If we start to the left, we arrive in the position and out pops the joker; push in a clown and we finish on the right.</p>\n\n<p>For sums, the structure is inherited: we just have to get the detagging and retagging correct.</p>\n\n<pre><code>instance (Dissectable f, Dissectable g) =&gt; Dissectable (f :+: g) where\n  type Diss (f :+: g) = Diss f :++: Diss g\n  rightward x = case x of\n      Left (L1 fj)      -&gt; ll (rightward (Left fj))\n      Right (L2 df, c)  -&gt; ll (rightward (Right (df, c)))\n      Left (R1 gj)      -&gt; rr (rightward (Left gj))\n      Right (R2 dg, c)  -&gt; rr (rightward (Right (dg, c)))\n    where\n      ll (Left (j, df)) = Left (j, L2 df)\n      ll (Right fc)     = Right (L1 fc)\n      rr (Left (j, dg)) = Left (j, R2 dg)\n      rr (Right gc)     = Right (R1 gc)\n</code></pre>\n\n<p>For products, we must be somewhere in a pair of structures: either we're on the left between clowns and jokers with the right structure all jokers, or the left structure is all clowns and we're on the right between clowns and jokers.</p>\n\n<pre><code>instance (Dissectable f, Dissectable g) =&gt; Dissectable (f :*: g) where\n  type Diss (f :*: g) = (Diss f :**: Jokers g) :++: (Clowns f :**: Diss g)\n  rightward x = case x of\n      Left (fj :*: gj) -&gt; ll (rightward (Left fj)) gj\n      Right (L2 (df :**: Jokers gj), c) -&gt; ll (rightward (Right (df, c))) gj\n      Right (R2 (Clowns fc :**: dg), c) -&gt; rr fc (rightward (Right (dg, c)))\n    where\n      ll (Left (j, df)) gj = Left (j, L2 (df :**: Jokers gj))\n      ll (Right fc)     gj = rr fc (rightward (Left gj))  -- (!)\n      rr fc (Left (j, dg)) = Left (j, R2 (Clowns fc :**: dg))\n      rr fc (Right gc)     = Right (fc :*: gc)\n</code></pre>\n\n<p>The <code>rightward</code> logic ensures that we work our way through the left structure, then once we're done with it, we start work on the right. The line marked <code>(!)</code> is the key moment in the middle, where we emerge from the right of the left structure and then enter the left of the right structure.</p>\n\n<p>Huet's notion of \"left\" and \"right\" cursor movements in data structures arise from dissectability (if you complete the <code>rightward</code> isomorphism with its <code>leftward</code> counterpart). The <em>derivative</em> of <code>f</code> is just the limit when the difference between clowns and jokers tend to zero, or for us, what you get when you have the same sort of stuff either side of the cursor.</p>\n\n<p>Moreover, if you take clowns to be zero, you get</p>\n\n<pre><code>rightward :: Either (f x) (Diss f Void x, Void) -&gt; Either (x, Diss f Void x) (f Void)\n</code></pre>\n\n<p>but we can remove the impossible input case to get</p>\n\n<pre><code>type Quotient f x = Diss f Void x\nleftmost :: f x -&gt; Either (x, Quotient f x) (f Void)\nleftmost = rightward . Left\n</code></pre>\n\n<p>which tells us that every <code>f</code> structure either has a leftmost element or none at all, a result we learn in school as the \"Remainder Theorem\". The multivariate version of the <code>Quotient</code> operator is the \"derivative\" which Brzozowski applied to regular expressions.</p>\n\n<p>But <em>our</em> special case is Fox's derivative (about which I learned from <a href=\"http://blog.sigfpe.com/2007/01/foxs-ubiquitous-free-derivative.html\">Dan Piponi</a>):</p>\n\n<pre><code>type Fox f x = Diss f x ()\n</code></pre>\n\n<p>That's the type of <code>f</code>-structures with stubs to the right of a cursor. <em>Now</em> we can give the type of our general <code>grow</code> operator.</p>\n\n<pre><code>grow :: Dissectable f =&gt; ([Fox f (Nu f)] -&gt; f ()) -&gt; Nu f\n</code></pre>\n\n<p>Our \"context\" is a stack of layers, each of which has fully grown data to the left and stubs to the right. We can implement <code>grow</code> directly as follows:</p>\n\n<pre><code>grow g = go [] where\n  go stk = In (walk (rightward (Left (g stk)))) where\n    walk (Left ((), df)) = walk (rightward (Right (df, go (df : stk))))\n    walk (Right fm)      = fm\n</code></pre>\n\n<p>As we arrive at each position, the joker we extract is just a stub, but its context tells us how to extend the stack in order to grow a substructure of the tree, which gives us the clown that we need to move right. Once we've filled in all the stubs with trees, we're done!</p>\n\n<p>But here's the twist: <code>grow</code> is not so easy to express as an anamorphism. It's easy to give the \"seed\" for the leftmost child of each node, because we have only stubs to the right of us. But to give the next seed to the right, we need more than the leftmost seed &mdash; we need the tree that grows from it! The anamorphism pattern requires us to give all the seeds for substructures before growing any of them. Our <code>growList</code> is an anamorphism only because list nodes have <em>at most one</em> child.</p>\n\n<p>So it's something new, after all, growing from nothing, but allowing later growth at a given layer to depend on earlier trees, with the Fox derivative capturing the idea of \"stubs where we have yet to work\". Perhaps we should call it an <em>alopegmorphism</em>, from the Greek &alpha;&lambda;&omega;&pi;&eta;&xi; for \"fox\".</p>\n"}], "owner": {"reputation": 269, "user_id": 2290347, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/owtS1.jpg?s=128&g=1", "display_name": "lando", "link": "https://stackoverflow.com/users/2290347/lando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 552, "favorite_count": 1, "accepted_answer_id": 30290249, "answer_count": 2, "score": 1, "last_activity_date": 1431885777, "creation_date": 1431804675, "last_edit_date": 1431808998, "question_id": 30279884, "link": "https://stackoverflow.com/questions/30279884/computing-a-term-of-a-list-depending-on-all-previous-terms", "title": "Computing a term of a list depending on all previous terms", "body": "<p>I have the following identity, that defines (implicitly) the number of partitions of positive integers (that is, the number of ways you can write the integer as the sum of ordered positive nonzero integers):\n<img src=\"https://i.stack.imgur.com/q1vcN.png\" alt=\"\"></p>\n\n<p>Some notes:</p>\n\n<ol>\n<li><p>This is studied in the book Analytic Combinatorics by Flajolet and Sedjewick, and the image of the formula is taken from there, since stackoverflow doesn't support LaTeX.</p></li>\n<li><p>sigma is the sum of the divisors of a number</p></li>\n</ol>\n\n<p>I want to write a haskell program that computes a list with P coefficients.\nThe i-th term depends on all previous terms (is a sum of the list resulting on zipping the sigmas and the previous Ps). \nThis problem is a good example of how you can \"calculate\" a program from its specification, like Gibbons writes in his <a href=\"http://www.cs.ox.ac.uk/jeremy.gibbons/publications/acmmpc-calcfp.pdf\" rel=\"nofollow noreferrer\">paper</a>.</p>\n\n<p>The question is: Is there a known recursion scheme that captures this kind of computation? Every term in the list depends on a computation with all previous terms, (and the result has no relation with the previous ones, I mean, you have to do a new traversal for every term)</p>\n"}, {"tags": ["haskell", "html5-canvas", "raycasting", "haste"], "answers": [{"comments": [{"owner": {"reputation": 17293, "user_id": 736162, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/eb6854f56cb2aa14ce798b53ea667639?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/736162/andrea"}, "edited": false, "score": 1, "creation_date": 1431878483, "post_id": 30280588, "comment_id": 48674811, "body": "@K3N I know. You have to wait a while before accepting any answer though, even your own."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1545122767, "post_id": 30280588, "comment_id": 94506841, "body": "heh I remember I got the same problem in the past due to 2 reasons one was if player was on a cell boundary and the other was the same as you ... I ended up with a small translation of the ray in the first case and the other is solved by z sorting each two horizontal and vertical hits ... see <a href=\"https://stackoverflow.com/a/47251071/2521214\">Ray Casting with different height size</a>"}], "tags": [], "owner": {"reputation": 17293, "user_id": 736162, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/eb6854f56cb2aa14ce798b53ea667639?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/736162/andrea"}, "is_accepted": true, "score": 3, "last_activity_date": 1431809150, "creation_date": 1431809150, "answer_id": 30280588, "question_id": 30278850, "link": "https://stackoverflow.com/questions/30278850/raycaster-displays-phantom-perpendicular-wall-faces/30280588#30280588", "title": "Raycaster displays phantom perpendicular wall faces", "body": "<p>The \"phantom faces\" are occurring because an incorrect <code>HitSide</code> is being reported: you're saying the face was hit on a horizontal move (<code>EastWest</code>), but was actually hit on a vertical move (<code>NorthSouth</code>), or vice-versa.</p>\n\n<p>Why is it reporting an incorrect value, then? <code>if sideDistX &lt; sideDistY then EastWest else NorthSouth</code> seems pretty foolproof, right? And it is.</p>\n\n<p>The problem isn't how we calculated that value. It's <em>when</em> we calculated that value. The distance calculation function needs to know the direction we moved in to get to the wall. However, what we've actually given is the direction we would move in if we were to keep going (that is, if that tile wasn't a wall, or we were to ignore it for some reason).</p>\n\n<p>Look at the Haskell code:</p>\n\n<pre><code>traceRayInner arr step@(stepX, stepY) deltaDist@(deltaDistX, deltaDistY) tile sideDist@(sideDistX, sideDistY)\n    -- a wall has been hit, report hit direction and co\u00f6rdinates\n    | arr ! tile /= Empty   = (hitSide, tile)\n    -- advance until a wall is hit\n    | otherwise             = case hitSide of\n        EastWest -&gt;\n            let newSideDist = first (deltaDistX+) sideDist\n                newTile     = first (stepX+) tile\n            in\n                traceRayInner arr step deltaDist newTile newSideDist\n        NorthSouth -&gt;\n            let newSideDist = second (deltaDistY+) sideDist\n                newTile     = second (stepY+) tile\n            in\n                traceRayInner arr step deltaDist newTile newSideDist\n    where\n        hitSide = if sideDistX &lt; sideDistY then EastWest else NorthSouth\n</code></pre>\n\n<p>Notice that we do things in this order:</p>\n\n<ol>\n<li>calculate <code>hitSide</code></li>\n<li>check if a wall has been hit, and if so, report <code>hitSide</code></li>\n<li>move</li>\n</ol>\n\n<p>Compare this to the original C++ code:</p>\n\n<pre><code>//perform DDA\nwhile (hit == 0)\n{\n  //jump to next map square, OR in x-direction, OR in y-direction\n  if (sideDistX &lt; sideDistY)\n  {\n    sideDistX += deltaDistX;\n    mapX += stepX;\n    side = 0;\n  }\n  else\n  {\n    sideDistY += deltaDistY;\n    mapY += stepY;\n    side = 1;\n  }\n  //Check if ray has hit a wall\n  if (worldMap[mapX][mapY] &gt; 0) hit = 1;\n}\n</code></pre>\n\n<p>It does things in a different order:</p>\n\n<ol>\n<li>check if a wall has been hit, and if so, report <code>side</code> (equivalent to <code>hitSide</code>)</li>\n<li>move and calculate <code>side</code></li>\n</ol>\n\n<p>The C++ code only calculates <code>side</code> when it moves, and then it reports that value if it hits a wall. So, it reports the way it moved in order to hit the wall.</p>\n\n<p>The Haskell code calculates <code>side</code> whether or not it moves: so it's correct for each move, but when it hits a wall, it reports the way it would have moved were it to keep going.</p>\n\n<p>So, the Haskell code can be fixed by re-ordering it so that it checks for a hit <em>after</em> moving, and if so, reports the <code>hitSide</code> value from that move. This isn't pretty code, but it works:</p>\n\n<pre><code>traceRayInner arr step@(stepX, stepY) deltaDist@(deltaDistX, deltaDistY) tile sideDist@(sideDistX, sideDistY) =\n    let hitSide = if sideDistX &lt; sideDistY then EastWest else NorthSouth\n    in  case hitSide of\n        EastWest -&gt;\n            let newSideDist = first (deltaDistX+) sideDist\n                newTile     = first (stepX+) tile\n            in  case arr ! newTile of\n                -- advance until a wall is hit\n                Empty   -&gt;  traceRayInner arr step deltaDist newTile newSideDist\n                -- a wall has been hit, report hit direction and co\u00f6rdinates\n                _       -&gt;  (hitSide, newTile)\n        NorthSouth -&gt;\n            let newSideDist = second (deltaDistY+) sideDist\n                newTile     = second (stepY+) tile\n            in  case arr ! newTile of\n                -- advance until a wall is hit\n                Empty   -&gt;  traceRayInner arr step deltaDist newTile newSideDist\n                -- a wall has been hit, report hit direction and co\u00f6rdinates\n                _       -&gt;  (hitSide, newTile)\n</code></pre>\n\n<p>Problem solved!</p>\n\n<hr>\n\n<p>Side note: I figured out what was wrong after carrying out the algorithm on paper. While in that particular case it just so happened the last two <code>HitSide</code> values matched, it became obvious that that they might not in every case. So, a big thanks to <code>Madsy</code> on Freenode's <code>#algorithms</code> for suggesting trying it out on paper. :)</p>\n"}], "owner": {"reputation": 17293, "user_id": 736162, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/eb6854f56cb2aa14ce798b53ea667639?s=128&d=identicon&r=PG", "display_name": "Andrea", "link": "https://stackoverflow.com/users/736162/andrea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 1, "accepted_answer_id": 30280588, "answer_count": 1, "score": 1, "last_activity_date": 1431809150, "creation_date": 1431798312, "last_edit_date": 1431805430, "question_id": 30278850, "link": "https://stackoverflow.com/questions/30278850/raycaster-displays-phantom-perpendicular-wall-faces", "title": "Raycaster displays phantom perpendicular wall faces", "body": "<p>The output looks like this:</p>\n\n<p><img src=\"https://i.imgur.com/fXXHwdi.gif\" alt=\"\"></p>\n\n<p>You should just see a flat, continuous red wall on one side, blue wall on another, green on another, yellow on another (see the definition of the map, <code>testMapTiles</code>, it's just a map with four walls). Yet there are these phantom wall faces of varying height, which are perpendicular to the real walls. Why?</p>\n\n<p>Note that the white \"gaps\" aren't actually gaps: it's trying to draw a wall of height <code>Infinity</code> (distance 0). If you specifically account for it (this version of the code doesn't) and just cap it at screen height, then you just see a very high wall there.</p>\n\n<p>The source code is below. It's plain Haskell, using <a href=\"http://haste-lang.org/\" rel=\"nofollow noreferrer\">Haste</a> to compile to JavaScript and render to canvas. It is based on the C++ code from <a href=\"http://lodev.org/cgtutor/raycasting.html#Untextured_Raycaster_\" rel=\"nofollow noreferrer\">this tutorial</a>, though note that I replaced <code>mapX</code> and <code>mapY</code> with <code>tileX</code> and <code>tileY</code>, and I don't have the <code>ray</code> prefix for <code>pos</code> and <code>dir</code> within the main loop. Any discrepancies from the C++ code are probably what's breaking everything, but I can't seem to find any after having pored over this code many times.</p>\n\n<p>Any help?</p>\n\n<pre><code>import Data.Array.IArray\nimport Control.Arrow (first, second)\n\nimport Control.Monad (forM_)\n\nimport Haste\nimport Haste.Graphics.Canvas\n\ndata MapTile = Empty | RedWall | BlueWall | GreenWall | YellowWall deriving (Eq)\n\ntype TilemapArray = Array (Int, Int) MapTile\n\nemptyTilemapArray :: (Int, Int) -&gt; TilemapArray\nemptyTilemapArray dim@(w, h) = listArray ((1, 1), dim) $ replicate (w * h) Empty\n\ntestMapTiles :: TilemapArray\ntestMapTiles =\n    let arr = emptyTilemapArray (16, 16)\n        myBounds@((xB, yB), (w, h)) = bounds arr\n    in  listArray myBounds $ flip map (indices arr) (\\(x, y) -&gt;\n            if x == xB then RedWall\n            else if y == yB then BlueWall\n            else if x == w then GreenWall\n            else if y == h then YellowWall\n            else Empty)\n\ntype Vec2 a = (a, a)\ntype DblVec2 = Vec2 Double\ntype IntVec2 = Vec2 Int\n\nadd :: (Num a) =&gt; Vec2 a -&gt; Vec2 a -&gt; Vec2 a\nadd (x1, y1) (x2, y2) = (x1 + x2, y1 + y2)\n\nmul :: (Num a) =&gt; Vec2 a -&gt; a -&gt; Vec2 a\nmul (x, y) factor = (x * factor, y * factor)\n\nrot :: (Floating a) =&gt; Vec2 a -&gt; a -&gt; Vec2 a\nrot (x, y) angle =\n    (x * (cos angle) - y * (sin angle), x * (sin angle) + y * (cos angle))\n\ndbl :: Int -&gt; Double\ndbl = fromIntegral\n\n-- fractional part of a float\n-- `truncate` matches behaviour of C++'s int()\nfrac :: Double -&gt; Double\nfrac d = d - dbl (truncate d)\n\n-- get whole and fractional parts of a float\nsplit :: Double -&gt; (Int, Double)\nsplit d = (truncate d, frac d)\n\n-- stops 'Warning: Defaulting the following constraint(s) to type \u2018Integer\u2019'\nsquare :: Double -&gt; Double\nsquare = (^ (2 :: Int))\n\n-- raycasting algorithm based on code here:\n-- http://lodev.org/cgtutor/raycasting.html#Untextured_Raycaster_\n\ndata HitSide = NorthSouth | EastWest deriving (Show)\n\n-- direction, tile, distance\ntype HitInfo = (HitSide, IntVec2, Double)\n\n-- pos: start position\n-- dir: initial direction\n-- plane: camera \"plane\" (a line, really, perpendicular to the direction)\ntraceRays :: TilemapArray -&gt; Int -&gt; DblVec2 -&gt; DblVec2 -&gt; DblVec2 -&gt; [HitInfo]\ntraceRays arr numRays pos dir plane = \n    flip map [0..numRays] $ \\x -&gt; \n        let cameraX = 2 * ((dbl x) / (dbl numRays)) - 1\n        in  traceRay arr pos $ dir `add` (plane `mul` cameraX)\n\ntraceRay :: TilemapArray -&gt; DblVec2 -&gt; DblVec2 -&gt; HitInfo\ntraceRay arr pos@(posX, posY) dir@(dirX, dirY) =\n    -- map tile we're in (whole part of position)\n    -- position within map tile (fractional part of position)\n    let ((tileX, fracX), (tileY, fracY)) = (split posX, split posY)\n        tile = (tileX, tileY)\n    -- length of ray from one x or y-side to next x or y-side\n        deltaDistX = sqrt $ 1 + (square dirY / square dirX)\n        deltaDistY = sqrt $ 1 + (square dirX / square dirY)\n        deltaDist  = (deltaDistX, deltaDistY)\n    -- direction of step\n        stepX = if dirX &lt; 0 then -1 else 1\n        stepY = if dirY &lt; 0 then -1 else 1\n        step  = (stepX, stepY)\n    -- length of ray from current position to next x or y-side\n        sideDistX = deltaDistX * if dirX &lt; 0 then fracX else 1 - fracX\n        sideDistY = deltaDistY * if dirY &lt; 0 then fracY else 1 - fracY\n        sideDist  = (sideDistX, sideDistY)\n        (hitSide, wallTile) = traceRayInner arr step deltaDist tile sideDist\n    in  (hitSide, wallTile, calculateDistance hitSide pos dir wallTile step)\n\ntraceRayInner :: TilemapArray -&gt; IntVec2 -&gt; DblVec2 -&gt; IntVec2 -&gt; DblVec2 -&gt; (HitSide, IntVec2)\ntraceRayInner arr step@(stepX, stepY) deltaDist@(deltaDistX, deltaDistY) tile sideDist@(sideDistX, sideDistY)\n    -- a wall has been hit, report hit direction and co\u00f6rdinates\n    | arr ! tile /= Empty   = (hitSide, tile)\n    -- advance until a wall is hit\n    | otherwise             = case hitSide of\n        EastWest -&gt;\n            let newSideDist = first (deltaDistX+) sideDist\n                newTile     = first (stepX+) tile\n            in\n                traceRayInner arr step deltaDist newTile newSideDist\n        NorthSouth -&gt;\n            let newSideDist = second (deltaDistY+) sideDist\n                newTile     = second (stepY+) tile\n            in\n                traceRayInner arr step deltaDist newTile newSideDist\n    where\n        hitSide = if sideDistX &lt; sideDistY then EastWest else NorthSouth\n\n-- calculate distance projected on camera direction\n-- (an oblique distance would give a fisheye effect)\ncalculateDistance :: HitSide -&gt; DblVec2 -&gt; DblVec2 -&gt; IntVec2 -&gt; IntVec2 -&gt; Double\ncalculateDistance EastWest (startX, _) (dirX, _) (tileX, _) (stepX, _) =\n    ((dbl tileX) - startX + (1 - dbl stepX) / 2) / dirX\ncalculateDistance NorthSouth (_, startY) (_, dirY) (_, tileY) (_, stepY) =\n    ((dbl tileY) - startY + (1 - dbl stepY) / 2) / dirY\n\n-- calculate the height of the vertical line on-screen based on the distance\ncalculateHeight :: Double -&gt; Double -&gt; Double\ncalculateHeight screenHeight 0 = screenHeight\ncalculateHeight screenHeight perpWallDist = screenHeight / perpWallDist\n\nwidth   :: Double\nheight  :: Double\n(width, height) = (640, 480)\n\nmain :: IO ()\nmain = do\n    cvElem &lt;- newElem \"canvas\" `with` [\n            attr \"width\" =: show width,\n            attr \"height\" =: show height\n        ]\n    addChild cvElem documentBody\n    Just canvas &lt;- getCanvas cvElem\n    let pos     = (8, 8)\n        dir     = (-1, 0)\n        plane   = (0, 0.66)\n    renderGame canvas pos dir plane\n\nrenderGame :: Canvas -&gt; DblVec2 -&gt; DblVec2 -&gt; DblVec2 -&gt; IO ()\nrenderGame canvas pos dir plane = do\n    let rays    = traceRays testMapTiles (floor width) pos dir plane\n    render canvas $ forM_ (zip [0..width - 1] rays) (\\(x, (side, tile, dist)) -&gt;\n        let lineHeight  = calculateHeight height dist\n            wallColor   = case testMapTiles ! tile of\n                RedWall     -&gt; RGB 255 0 0\n                BlueWall    -&gt; RGB 0 255 0\n                GreenWall   -&gt; RGB 0 0 255\n                YellowWall  -&gt; RGB 255 255 0\n                _           -&gt; RGB 255 255 255\n            shadedWallColor = case side of\n                EastWest    -&gt; \n                    let (RGB r g b) = wallColor\n                    in  RGB (r `div` 2) (g `div` 2) (b `div` 2)\n                NorthSouth  -&gt; wallColor\n        in  color shadedWallColor $ do\n                translate (x, height / 2) $ stroke $ do\n                    line (0, -lineHeight / 2) (0, lineHeight / 2))\n    -- 25fps\n    let fps             = 25\n        timeout         = (1000 `div` fps) :: Int\n        rots_per_min    = 1\n        rots_per_sec    = dbl rots_per_min / 60\n        rots_per_frame  = rots_per_sec / dbl fps\n        tau             = 2 * pi\n        increment       = tau * rots_per_frame \n\n    setTimeout timeout $ do\n       renderGame canvas pos (rot dir $ -increment) (rot plane $ -increment)\n</code></pre>\n\n<p>HTML page:</p>\n\n<pre><code>&lt;!doctype html&gt;\n&lt;meta charset=utf-8&gt;\n&lt;title&gt;Raycaster&lt;/title&gt;\n\n&lt;noscript&gt;If you're seeing this message, either your browser doesn't support JavaScript, or it is disabled for some reason. This game requires JavaScript to play, so you'll need to make sure you're using a browser which supports it, and enable it, to play.&lt;/noscript&gt;\n&lt;script src=raycast.js&gt;&lt;/script&gt;\n</code></pre>\n"}, {"tags": ["haskell", "template-haskell", "scotty"], "comments": [{"owner": {"reputation": 721, "user_id": 2512324, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f9d51819edf28a5befe8b255e51d95d7?s=128&d=identicon&r=PG", "display_name": "user2512324", "link": "https://stackoverflow.com/users/2512324/user2512324"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1431944833, "post_id": 30277790, "comment_id": 48697238, "body": "Without using TH I have been able to do <code>do {middleware logStdoutDev; ((get (&quot;&#47;hello&quot;)) (text (LTB.pack (&quot;hello&quot;)))) ; ((get (&quot;&#47;world&quot;)) (text (LTB.pack (&quot;world&quot;))))}</code> How can I compose actions dynamically inside the <code>ScottyM ()</code>monad based on some list?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1431952960, "post_id": 30277790, "comment_id": 48702566, "body": "small <i>hint</i>: you can remove (most if not all) of your <code>LTB.pack</code> in there if you just use <code>{-# LANGUAGE OverloadedStrings #-}</code> (and <code>Text</code> instead <code>String</code> might be a good idea too if you don&#39;t really need the <code>String = [Char]</code> part)"}], "answers": [{"comments": [{"owner": {"reputation": 721, "user_id": 2512324, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f9d51819edf28a5befe8b255e51d95d7?s=128&d=identicon&r=PG", "display_name": "user2512324", "link": "https://stackoverflow.com/users/2512324/user2512324"}, "edited": false, "score": 0, "creation_date": 1431965058, "post_id": 30303300, "comment_id": 48711241, "body": "I didn&#39;t about <code>forM_</code>. Thanks a lot. Too bad I couldn&#39;t use TH. I was looking for an opportunity to learn it."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 2, "last_activity_date": 1432016615, "last_edit_date": 1432016615, "creation_date": 1431952316, "answer_id": 30303300, "question_id": 30277790, "link": "https://stackoverflow.com/questions/30277790/dynamically-add-routes-at-compile-time-in-scotty/30303300#30303300", "title": "Dynamically add routes at compile time in Scotty", "body": "<p>OK, so given the above list, I am assuming you are looking to something that is equivalent to writing the following by hand:</p>\n\n<pre><code>{-! LANGUAGE OverloadedStrings #-}\nimport Web.Scotty\nimport Data.String\n\nmain = scotty 3000 $ do\n  middleware logStdoutDev\n  get (fromString $ '/' : \"hello\") (text \"hello\")\n  get (fromString $ '/' : \"world\") (text \"world\")\n</code></pre>\n\n<p>The good news is, there's nothing in there that would need any TH magic!</p>\n\n<p>Remember, <code>addroute</code> / <code>get</code> are just regular functions that return a <code>ScottyM ()</code> value. If I have</p>\n\n<pre><code>r1 = get (fromString $ '/' : \"hello\") (text \"hello\")\nr2 = get (fromString $ '/' : \"world\") (text \"world\")\n</code></pre>\n\n<p>then the preceding <code>main</code> function is exactly equivalent to</p>\n\n<pre><code>main = do\n  middleware logStdoutDev\n  r1\n  r2\n</code></pre>\n\n<p>This, and the common structure of <code>r1</code> and <code>r2</code> suggests the following solution:</p>\n\n<pre><code>import Control.Monad (forM_)\n\nmain = do\n  middleware logStdoutDev\n  forM_ sampleRoutes $ \\(name, response) -&gt; \n    get (fromString $ '/':name) (text response)\n</code></pre>\n"}], "owner": {"reputation": 721, "user_id": 2512324, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/f9d51819edf28a5befe8b255e51d95d7?s=128&d=identicon&r=PG", "display_name": "user2512324", "link": "https://stackoverflow.com/users/2512324/user2512324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 30303300, "answer_count": 1, "score": 0, "last_activity_date": 1432016615, "creation_date": 1431791948, "last_edit_date": 1431951779, "question_id": 30277790, "link": "https://stackoverflow.com/questions/30277790/dynamically-add-routes-at-compile-time-in-scotty", "title": "Dynamically add routes at compile time in Scotty", "body": "<p>Is it possible to add routes dynamically at compile time through a config file by using Template Haskell or any other way.</p>\n\n<p>Scotty has a function <a href=\"https://hackage.haskell.org/package/scotty-0.9.1/docs/Web-Scotty.html#v:addroute\" rel=\"nofollow\">addRoute</a> but I want to use it dynamically.</p>\n\n<p>Example</p>\n\n<pre><code>import qualified Data.Text.Lazy as LTB\n\nsampleRoutes :: [(String, LTB.Text)]\nsampleRoutes = [(\"hello\", LTB.pack \"hello\"), (\"world\", LTB.pack \"world\")]\n</code></pre>\n\n<p>I want to iterate over the sampleRoutes array and define routes and responses at compile time.</p>\n\n<pre><code>import Web.Scotty\n\nmain = scotty 3000 $ do\n  middleware logStdoutDev\n  someFunc sampleRoutes\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 1, "creation_date": 1431794539, "post_id": 30276551, "comment_id": 48654829, "body": "when searching for symbols, <a href=\"https://www.haskell.org/hoogle/?hoogle=-%3C\" rel=\"nofollow noreferrer\">hoogle</a> and <a href=\"http://hayoo.fh-wedel.de/?query=-%3C\" rel=\"nofollow noreferrer\">hayoo</a> are your friends."}], "answers": [{"tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 16, "last_activity_date": 1431785484, "creation_date": 1431785484, "answer_id": 30276697, "question_id": 30276551, "link": "https://stackoverflow.com/questions/30276551/what-the-heck-is-anyway/30276697#30276697", "title": "What the heck is &quot;-&lt;&quot;, anyway?", "body": "<p>Yes, that is the same kind of arrow.  There is sugar syntax for arrows just like there is sugar syntax for monads.  You can't use Google to search for <code>-&lt;</code>, but you can use <a href=\"https://www.haskell.org/hoogle/\">Hoogle</a>.</p>\n\n<p>See: <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/arrow-notation.html\">GHC Language Features</a>, <a href=\"http://en.wikibooks.org/wiki/Haskell/Arrow_tutorial\">Arrow tutorial</a>.</p>\n\n<p>Arrow syntax is indeed poorly documented.  The reason that you can't use <code>$</code> instead of <code>-&lt;</code> is that <code>-&lt;</code> injects a pure value into the arrow, but <code>-&gt;</code> is only one example of an arrow.  So, <code>$</code> works fine if your arrow is <code>-&gt;</code>.  There are also monadic arrows (the <code>Kleisli</code> constructor creates those) and you can make your own arrows, and in these cases <code>-&lt;</code> is different.</p>\n"}], "owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 2, "accepted_answer_id": 30276697, "answer_count": 1, "score": 8, "last_activity_date": 1433823302, "creation_date": 1431784593, "last_edit_date": 1433823302, "question_id": 30276551, "link": "https://stackoverflow.com/questions/30276551/what-the-heck-is-anyway", "title": "What the heck is &quot;-&lt;&quot;, anyway?", "body": "<p>The other day I came across an operator, <code>-&lt;</code>, appearing in the context of binding a value to a variable in a monad; specifically, it looks like this passes a value to a function which is then assigned (and possibly evaluated?) to a variable existing in the scope of a monad.</p>\n\n<p>Example usage:</p>\n\n<pre><code>myMonad = do\n    myVar &lt;- f -&lt; x\n</code></pre>\n\n<p>A few questions about this: first off, what's it called? The operator itself is un-googleable (Google doesn't like <code>&lt;</code> or <code>&gt;</code>), and the one name I've found, \"<a href=\"https://www.haskell.org/arrows/syntax.html\">arrow application</a>\", usually links to <a href=\"https://www.haskell.org/arrows/\">the other kind of <code>Arrow</code> present in Haskell</a>, which seems unrelated.</p>\n\n<p>Second, why is this operator not explained in most of the learning resources out there? Neither the \"Gentle Introduction to Monads\" nor LYAH give it so much as a passing mention, and most lists of Haskell operators forego it as well. (Is it considered bad practice?)</p>\n\n<p>Finally, is this equivalent to using parentheses, as in, <code>(myVar &lt;- f -&lt; x) == (myVar &lt;- (f x))</code>? Or is it more like using <code>let myVar = (f x)</code>? In either case, if this is how it's used, why use <code>-&lt;</code> over parens or <code>$</code>?</p>\n"}, {"tags": ["class", "haskell", "instance"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4787851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9c4afc96729edb7611edcede10d10db?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny1002", "link": "https://stackoverflow.com/users/4787851/jonny1002"}, "edited": false, "score": 0, "creation_date": 1431780442, "post_id": 30275789, "comment_id": 48650415, "body": "ok it works. Thank you. But i thought you had to do this if a class already exists and you want your own type to be a part of the typeclass?"}, {"owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "reply_to_user": {"reputation": 13, "user_id": 4787851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9c4afc96729edb7611edcede10d10db?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny1002", "link": "https://stackoverflow.com/users/4787851/jonny1002"}, "edited": false, "score": 0, "creation_date": 1431780788, "post_id": 30275789, "comment_id": 48650530, "body": "You have to do it when you need to enforce some constraint on some type variables. For example, in your instance of <code>Ord (Down a)</code>, if you were not to have the constraint <code>Ord a</code>, you wouldn&#39;t be able to use <code>compare x y</code> as <code>x</code> and <code>y</code> are of type <code>a</code>."}, {"owner": {"reputation": 13, "user_id": 4787851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9c4afc96729edb7611edcede10d10db?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny1002", "link": "https://stackoverflow.com/users/4787851/jonny1002"}, "edited": false, "score": 0, "creation_date": 1431781087, "post_id": 30275789, "comment_id": 48650633, "body": "Ah thank you. Now it makes sence. One last question if its ok for you. I have <code>compare (Egg) (Sausage 2) = EQ</code> and that works fine and now i want another pattern like <code>compare (Sausage 3) (Egg) = GT</code> and that get me a parse error on the second &quot; = &quot;. Do you know why?"}, {"owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "reply_to_user": {"reputation": 13, "user_id": 4787851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9c4afc96729edb7611edcede10d10db?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny1002", "link": "https://stackoverflow.com/users/4787851/jonny1002"}, "edited": false, "score": 0, "creation_date": 1431782108, "post_id": 30275789, "comment_id": 48650954, "body": "It shouldn&#39;t be. Check the indentation."}, {"owner": {"reputation": 13, "user_id": 4787851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9c4afc96729edb7611edcede10d10db?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny1002", "link": "https://stackoverflow.com/users/4787851/jonny1002"}, "edited": false, "score": 0, "creation_date": 1431784595, "post_id": 30275789, "comment_id": 48651664, "body": "you are right. It was just a tab or something. Thank you so much! Really appreciate your help"}], "tags": [], "owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "is_accepted": true, "score": 5, "last_activity_date": 1431779961, "creation_date": 1431779961, "answer_id": 30275789, "question_id": 30275732, "link": "https://stackoverflow.com/questions/30275732/defining-own-instance-classes/30275789#30275789", "title": "Defining own instance classes", "body": "<p>Just remove the constraint on your instance definition:</p>\n\n<pre><code>instance Ord Breakfast where\n  compare (Egg) (Sausage 2) = EQ \n  ...\n</code></pre>\n\n<p>You had a constraint on a type variable <code>a</code> which wasn't used on the right-hand side (the instance head).</p>\n"}], "owner": {"reputation": 13, "user_id": 4787851, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e9c4afc96729edb7611edcede10d10db?s=128&d=identicon&r=PG&f=1", "display_name": "Jonny1002", "link": "https://stackoverflow.com/users/4787851/jonny1002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 30275789, "answer_count": 1, "score": 1, "last_activity_date": 1431779961, "creation_date": 1431779584, "question_id": 30275732, "link": "https://stackoverflow.com/questions/30275732/defining-own-instance-classes", "title": "Defining own instance classes", "body": "<p>I struggle with creating own instances for my datatypes. \nI defined a type like: </p>\n\n<p><code>data Breakfast = Egg | Sausage Int | Bread Breakfast deriving (Eq, Show)</code></p>\n\n<p>and want it to be an instance of the class Ord. I want to compare it by some rules like: A Egg is as good as 2 Sausages etc. </p>\n\n<p>I tried it like this: </p>\n\n<pre><code>instance Ord a =&gt; Ord (Breakfast) where\n compare (Egg) (Sausage 2) = EQ \n ...\n</code></pre>\n\n<p>but I get the error: \n Variable <code>a</code> occurs more often than in the instance head. \ni tried another example and this works fine:</p>\n\n<pre><code>data Down a = Down a deriving (Eq, Show, Read)\n\ninstance Ord a =&gt; Ord (Down a) where\n compare (Down x) (Down y) = y `compare` x\n</code></pre>\n\n<p>Hope you guys can help me whats wrong. Im very new to Haskell. Thanks</p>\n"}, {"tags": ["unit-testing", "haskell", "quickcheck", "property-based-testing"], "answers": [{"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 4, "last_activity_date": 1431773312, "creation_date": 1431773312, "answer_id": 30274698, "question_id": 30274536, "link": "https://stackoverflow.com/questions/30274536/what-to-use-property-testing-for/30274698#30274698", "title": "What to use property testing for", "body": "<p>How about the following properties: </p>\n\n<ol>\n<li>For all odd numbers in the source list, its square is element of the result list.</li>\n<li>For all numbers in the result list, there is a number in the source list whose square it is.</li>\n</ol>\n\n<p>By the way, <code>odd</code> is easier to read than <code>\\x -&gt; x % 2 == 1</code></p>\n"}, {"tags": [], "owner": {"reputation": 669, "user_id": 3714434, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06a65866e8ef0ee97ab4cd4c4ffaadc6?s=128&d=identicon&r=PG&f=1", "display_name": "ibotty", "link": "https://stackoverflow.com/users/3714434/ibotty"}, "is_accepted": false, "score": 3, "last_activity_date": 1432445746, "creation_date": 1432445746, "answer_id": 30420412, "question_id": 30274536, "link": "https://stackoverflow.com/questions/30274536/what-to-use-property-testing-for/30420412#30420412", "title": "What to use property testing for", "body": "<h2>Reference algorithm</h2>\n\n<p>It's very common to have a (possibly inefficient) reference implementation and test against that. In fact, that's one of the most common quickcheck strategies when implementing numeric algorithms. But not every part of the algorithm needs one. Sometimes there are some properties that characterize the algorithm completely.\nIngo's comment is spot on in that regard: These properties determine the results of your algorithm (up to order and duplicates). To recover order and duplicates you can modify the properties to include \"in the resulting list truncated after the position of the source element\" and vice versa in the other property.</p>\n\n<h2>Granularity of tests</h2>\n\n<p>Of course, given Haskell's composability it's nice to test each reasonable small part of an algorithm by itself. I trust e.g. <code>\\x -&gt; x*x</code> and <code>filter odd</code> as reference without looking twice.</p>\n\n<p>Whether there should be properties for each part is not as clear as you might inline that part of the algorithm later and thus make the properties moot. Due to Haskell's laziness that's not a common thing to do, but it happens.</p>\n"}], "owner": {"reputation": 5892, "user_id": 293205, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/49d9dd9a9dc4f639823256df0ae14535?s=128&d=identicon&r=PG", "display_name": "coubeatczech", "link": "https://stackoverflow.com/users/293205/coubeatczech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 2, "answer_count": 2, "score": 16, "last_activity_date": 1432445746, "creation_date": 1431772259, "last_edit_date": 1431946827, "question_id": 30274536, "link": "https://stackoverflow.com/questions/30274536/what-to-use-property-testing-for", "title": "What to use property testing for", "body": "<p>I'd like to know what is the property testing aiming for, what is it's sweet point, where it should be used. Let' have an example function that I want to test:</p>\n\n<pre><code>f :: [Integer] -&gt; [Integer]\n</code></pre>\n\n<p>This function, <code>f</code>, takes a list of numbers and will square the odd numbers and filter out the even numbers. I can state some properties about the function, like</p>\n\n<ol>\n  <li>Given a list of even numbers, return empty list.</li>\n  <li>Given a list of odd numbers, the result list will have the same size as input.</li>\n  <li>Given that I have a list of even numbers and a list of odd numbers, when I join them, shuffle and pass to the function, the length of the result will be the length of the list of odd numbers.</li>\n  <li>Given I provide a list of positive odd numbers, then each element in the result list at the same index will be greater than in the original list</li>\n  <li>Given I provide a list of odd numbers and even numbers, join and shuffle them, then I will get a list, where each number is odd</li>\n  <li>etc.</li>\n</ol>\n\n<p>None of the properties test, that the function works for the simplest case, e.g. I can make a simple case, that will pass these properties if I implement the <code>f</code> incorrectly:</p>\n\n<pre><code>f = fmap (+2) . filter odd\n</code></pre>\n\n<p>So, If I want to cover some simple case, It looks like I either need to repeat a fundamental part of the algorithm in the property specification, or I need to use value based testing. The first option, that I have, to repeat the algorithm may be useful, If I plan to improve the algorithm if I plan to change it's implementation, for speed for example. In this way, I have a referential implementation, that I can use to test again. </p>\n\n<p>If I want to check, that the algorithm doesn't fail for some trivial cases and I don't want to repeat the algorithm in the specification, it looks like I need some unit testing. I would write for example these checks:</p>\n\n<pre><code>f ([2,5]) == [25]\nf (-8,-3,11,1) == [9,121,1]\n</code></pre>\n\n<p>Now I have a lot more confidence it the algorithm.</p>\n\n<p>My question is, is the property based testing meant to replace the unit testing, or is it complementary? Is there some general idea, how to write the properties, so they are useful or it just totally depends on the understanding of the logic of the function? I mean, can one tell that writing the properties in some way is especially beneficial?</p>\n\n<p>Also, should one strive to make the properties test every part of the algorithm? I could put the squaring out of the algorithm, and then test it elsewhere, let the properties test just the filtering part, which it looks like, that it covers it well.</p>\n\n<pre><code>f :: (Integer -&gt; Integer) -&gt; [Integer] -&gt; [Integer]\nf g = fmap g . filter odd\n</code></pre>\n\n<p>And then I can pass just <code>Prelude.id</code> and test the <code>g</code> elsewhere using unit testing.</p>\n"}, {"tags": ["parsing", "haskell", "lazy-evaluation", "ghci"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 3, "creation_date": 1431781565, "post_id": 30274226, "comment_id": 48650778, "body": "it would be nice if you could link to a self contained, runnable version of the code."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 2, "creation_date": 1431853159, "post_id": 30274226, "comment_id": 48667929, "body": "I suspect the problem may lie in your definition of &quot;+++&quot;, which throws away all but the first parse. The &quot;case&quot; statement is strict; it forces the parse to find the first full parse of p +++ q, and if you do some more tracing you may find out that this has to scan to the end of the text in order to determine what a valid parse is. &quot;sepBy&quot; and &quot;many&quot; are likely to have this problem as they use &quot;+++&quot; to allow an empty parse. Why don&#39;t you say &quot;(+++) = mplus&quot; ?"}, {"owner": {"reputation": 868, "user_id": 4051512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8bd3beb8e3334400c9d43118b2206a62?s=128&d=identicon&r=PG&f=1", "display_name": "papagaga", "link": "https://stackoverflow.com/users/4051512/papagaga"}, "reply_to_user": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1431858165, "post_id": 30274226, "comment_id": 48669199, "body": "@PaulJohnson: (+++) is a deterministic version of mplus. But you were right, I know get: *Main&gt; :p psd psd = ([&quot;123&quot;;1456&quot;,&quot;123&quot;,&quot;122&quot;] : (_t1::[[String]]),[]) :       (_t2::[([[String]], String)]). But it doesn&#39;t explain why ghci was showing a thunk and a consumed stream, or does it?"}, {"owner": {"reputation": 868, "user_id": 4051512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8bd3beb8e3334400c9d43118b2206a62?s=128&d=identicon&r=PG&f=1", "display_name": "papagaga", "link": "https://stackoverflow.com/users/4051512/papagaga"}, "edited": false, "score": 0, "creation_date": 1431858559, "post_id": 30274226, "comment_id": 48669292, "body": "PS: I&#39;ve changed my test string obviously"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 1, "creation_date": 1431878091, "post_id": 30274226, "comment_id": 48674689, "body": "I think that the string was showing as consumed rather than a thunk because one of the components of the parser had indeed forced the whole string before failing."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "reply_to_user": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1458457486, "post_id": 30274226, "comment_id": 59863665, "body": "@PaulJohnson it looks like your comments could be turned into an answer...?"}], "answers": [{"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 1, "last_activity_date": 1458496368, "creation_date": 1458496368, "answer_id": 36117334, "question_id": 30274226, "link": "https://stackoverflow.com/questions/30274226/is-my-parser-lazy/36117334#36117334", "title": "is my parser lazy?", "body": "<p>The problem may lie in your definition of \"+++\", which throws away all but the first parse. The \"case\" statement is strict; it forces the parse to find the first full parse of p +++ q, and if you do some more tracing you may find out that this has to scan to the end of the text in order to determine what a valid parse is. \"sepBy\" and \"many\" are likely to have this problem as they use \"+++\" to allow an empty parse. </p>\n\n<p>Why don't you say \"(+++) = mplus\" ?</p>\n"}], "owner": {"reputation": 868, "user_id": 4051512, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8bd3beb8e3334400c9d43118b2206a62?s=128&d=identicon&r=PG&f=1", "display_name": "papagaga", "link": "https://stackoverflow.com/users/4051512/papagaga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 2, "accepted_answer_id": 36117334, "answer_count": 1, "score": 4, "last_activity_date": 1458496368, "creation_date": 1431770280, "last_edit_date": 1431789165, "question_id": 30274226, "link": "https://stackoverflow.com/questions/30274226/is-my-parser-lazy", "title": "is my parser lazy?", "body": "<p>I'm playing with the functional pearl by Hutton and Meijer (<a href=\"https://www.cs.nott.ac.uk/~gmh/pearl.pdf\" rel=\"nofollow\">https://www.cs.nott.ac.uk/~gmh/pearl.pdf</a>). With the primitive functions defined in it, I've made a very basic csv parser:</p>\n\n<pre><code>csvFile :: Parser [[String]]\ncsvFile = record `sepBy` char '\\n'\n\nrecord :: Parser [String]\nrecord = (quotedField +++ unquotedField) `sepBy` char ';'\n\nunquotedField :: Parser String\nunquotedField = many (sat (not . (`elem` \";\\n\")))\n\nquotedField :: Parser String\nquotedField = do\n    char '\"'\n    xs &lt;- many (sat (not . (== '\"')))\n    char '\"'\n    ys &lt;- do { zs &lt;- quotedField; return ('\"':zs) } +++ return []\n    return (xs++ys)\n</code></pre>\n\n<p>I was trying to get a sense of what was really evaluated when I call this parser. So in GHCI:</p>\n\n<pre><code>*Main&gt; let tst = \"123;123;123\\n123;\\\"123;123\\\";124\\n124;122;125\"\n*Main&gt; let psd = parse csvFile tst\n*Main&gt; let x = head . fst . head $ psd\n*Main&gt; x\n[\"123\",\"123\",\"123\"]\n*Main&gt; :p psd\npsd = [([\"123\",\"123\",\"123\"] : (_t5::[[String]]),[])]\n</code></pre>\n\n<p>So I see that the next parsing step is still a thunk (_t5). However the input stream is now: [] -so it seems to have been consumed entirely.</p>\n\n<p>Where did it go? What shall I deduce from this? I'm wondering if my parser is lazy at all...</p>\n\n<p>Edit: self-contained code as requested:</p>\n\n<pre><code>import Control.Monad\nimport Data.Char\n\nnewtype Parser a = Parser (String -&gt; [(a, String)])\n\nparse :: (Parser a) -&gt; (String -&gt; [(a, String)])\nparse (Parser p) = p\n\ninstance Monad Parser where\n     return a = Parser (\\cs -&gt; [(a, cs)])\n     p &gt;&gt;= f  = Parser (\\cs -&gt; concat [parse (f a) cs' | (a, cs') &lt;- parse p cs])\n\ninstance MonadPlus Parser where\n    mzero = Parser(\\cs -&gt; [])\n    mplus p q = Parser (\\cs -&gt; (parse p cs) ++ (parse q cs))\n\n(+++) :: Parser a -&gt; Parser a -&gt; Parser a \np +++ q = Parser (\\cs -&gt; case (parse (p `mplus` q) cs) of\n                                [] -&gt; []\n                                (x:xs) -&gt; [x])\n\nitem :: Parser Char\nitem = Parser (\\cs -&gt; case cs of \n                        (c:nc) -&gt; [(c, nc)]\n                        _ -&gt; [])\n\nsat :: (Char -&gt; Bool) -&gt; Parser Char\nsat f = do { c &lt;- item ; if f c then return c else mzero }\n\nchar :: Char -&gt; Parser Char\nchar c = sat (c ==)\n\nmany :: Parser a -&gt; Parser [a]\nmany p = many1 p +++ (return [])\n\nmany1 :: Parser a -&gt; Parser [a]\nmany1 p = do {t &lt;- p; ts &lt;- many p; return (t:ts) }\n\nsepBy :: Parser a -&gt; Parser b -&gt; Parser [a]\np `sepBy` sep = sepBy1 p sep +++ do {x &lt;- p; return [x]} \n\nsepBy1 :: Parser a -&gt; Parser b -&gt; Parser [a]\np `sepBy1` sep = do { x &lt;- p; sep; xs &lt;- p `sepBy` sep; return (x:xs)}\n\ncsvFile :: Parser [[String]]\ncsvFile = record `sepBy` char '\\n'\n\nrecord :: Parser [String]\nrecord = (quotedField +++ unquotedField) `sepBy` char ';'\n\nunquotedField :: Parser String\nunquotedField = many (sat (not . (`elem` \";\\n\")))\n\nquotedField :: Parser String\nquotedField = do\n    char '\"'\n    xs &lt;- many (sat (not . (== '\"')))\n    char '\"'\n    ys &lt;- do { zs &lt;- quotedField; return ('\"':zs) } +++ return []\n    return (xs++ys)\n</code></pre>\n"}, {"tags": ["haskell", "template-haskell", "haskell-lens"], "answers": [{"tags": [], "owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "is_accepted": true, "score": 8, "last_activity_date": 1431776683, "last_edit_date": 1495541160, "creation_date": 1431776683, "answer_id": 30275240, "question_id": 30274027, "link": "https://stackoverflow.com/questions/30274027/is-this-expected-behavior-of-template-haskell/30275240#30275240", "title": "Is this expected behavior of Template Haskell?", "body": "<p>Only the definitions before the template haskell call are accessible in the scope.</p>\n\n<p>See this previous question on the same topic: <a href=\"https://stackoverflow.com/questions/20876147/haskell-template-haskell-and-the-scope\">Haskell: Template Haskell and the scope</a>.</p>\n"}], "owner": {"reputation": 1117, "user_id": 1641035, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b63d948c23003346549369112f336519?s=128&d=identicon&r=PG", "display_name": "Alexey Vagarenko", "link": "https://stackoverflow.com/users/1641035/alexey-vagarenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 30275240, "answer_count": 1, "score": 6, "last_activity_date": 1431776683, "creation_date": 1431768852, "last_edit_date": 1431775177, "question_id": 30274027, "link": "https://stackoverflow.com/questions/30274027/is-this-expected-behavior-of-template-haskell", "title": "Is this expected behavior of Template Haskell?", "body": "<p>Can anyone tell why this code doesn't compile</p>\n\n<pre><code>data A = A {\n  _b  :: B\n}\nmakeLenses ''A\n\ntype B = String\n</code></pre>\n\n<p>with message</p>\n\n<pre><code>Not in scope: type constructor or class B\n</code></pre>\n\n<p>and this does:</p>\n\n<pre><code>type B = String\n\ndata A = A {\n  _b  :: B\n}\nmakeLenses ''A\n</code></pre>\n\n<p>Without <code>makeLenses</code> everything compiles fine.</p>\n\n<p>Why can't I have type synonim declaration after makeLenses?</p>\n"}, {"tags": ["haskell", "cycle", "infinite"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 12, "creation_date": 1431761386, "post_id": 30272662, "comment_id": 48645091, "body": "Well, you suddenly can return different values for the same inputs: <code>f x = if isCycle x then 1 else 2</code>. This would return <code>1</code> or <code>2</code> for the value <code>ones</code> depending on how you build that same list. This seems pretty big a breakage considering that one of the most obvious advantages of functional languages is that a function will always return the same result if given the same values in input..."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 5, "creation_date": 1431763160, "post_id": 30272662, "comment_id": 48645485, "body": "This is only ever considered acceptable when constrained to <code>IO</code>. You can write <code>isCycle :: [a] -&gt; IO Bool</code> in terms of an explicit structure of the graph of a list obtained from <a href=\"https://hackage.haskell.org/package/data-reify\" rel=\"nofollow noreferrer\">data-reify</a> which internally uses <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/System-Mem-StableName.html#t:StableName\" rel=\"nofollow noreferrer\"><code>StableName</code>s</a>. If you look too hard at memory with <code>IO</code> you can do absolutely evil things, like <a href=\"http://stackoverflow.com/a/28701687/414413\">break the purity of pure functions without resorting to anything <code>unsafe</code></a>."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1431780887, "post_id": 30272662, "comment_id": 48650561, "body": "Checking if a list is physaclly cyclic would require to check all the nodes until a cycle is found. This wont&#39; terminate on infinite list in Haskell. However it will in Lisp (and probably all imperative languages), because cyclic list is the only way to do infinite list."}, {"owner": {"reputation": 36975, "user_id": 94977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8341c5bff3dcbd8ed34d9d68bd4169f2?s=128&d=identicon&r=PG", "display_name": "Jason Orendorff", "link": "https://stackoverflow.com/users/94977/jason-orendorff"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1432177944, "post_id": 30272662, "comment_id": 48819024, "body": "@Bakuriu The function I proposed &quot;returns <code>True</code> if the list is physically cyclic and <code>False</code> if the argument is of finite length. Otherwise it will fail to terminate.&quot; So the function <code>f</code> you proposed certainly would not return <code>2</code> for the value <code>ones</code>."}], "answers": [{"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 0, "last_activity_date": 1431790243, "creation_date": 1431790243, "answer_id": 30277485, "question_id": 30272662, "link": "https://stackoverflow.com/questions/30272662/would-the-ability-to-detect-cyclic-lists-in-haskell-break-any-properties-of-the/30277485#30277485", "title": "Would the ability to detect cyclic lists in Haskell break any properties of the language?", "body": "<p>In the general case, no you can't identify a cyclic list. However if the list is being generated by an unfold operation then you can. Data.List contains this:</p>\n\n<pre><code>unfoldr :: (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]\n</code></pre>\n\n<p>The first argument is a function that takes a \"state\" argument of type \"b\" and may return an element of the list and a new state. The second argument is the initial state. \"Nothing\" means the list ends.</p>\n\n<p>If the state ever recurs then the list will repeat from the point of the last state. So if we instead use a different unfold function that returns a list of (a, b) pairs we can inspect the state corresponding to each element. If the same state is seen twice then the list is cyclic. Of course this assumes that the state is an instance of Eq or something.</p>\n"}, {"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1431891627, "post_id": 30278282, "comment_id": 48679294, "body": "I think you mean <code>fmap id ones</code>, not <code>fmap ones</code>."}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 12, "last_activity_date": 1431891739, "last_edit_date": 1495541769, "creation_date": 1431794763, "answer_id": 30278282, "question_id": 30272662, "link": "https://stackoverflow.com/questions/30272662/would-the-ability-to-detect-cyclic-lists-in-haskell-break-any-properties-of-the/30278282#30278282", "title": "Would the ability to detect cyclic lists in Haskell break any properties of the language?", "body": "<blockquote>\n  <p>Would the existence of this function break any interesting properties of the language?</p>\n</blockquote>\n\n<p><strong>Yes</strong> it would. It would break <a href=\"https://stackoverflow.com/q/210835/1333025\">referential transparency</a> (see also <a href=\"https://en.wikipedia.org/wiki/Referential_transparency_%28computer_science%29\" rel=\"nofollow noreferrer\">the Wikipedia article</a>). A Haskell expression can be always replaced by its value. In other words, it depends only on the passed arguments and nothing else. If we had</p>\n\n<pre><code>isCycle :: [a] -&gt; Bool\n</code></pre>\n\n<p>as you propose, expressions using it would not satisfy this property any more. They could depend on the internal memory representation of values. In consequence, other laws would be violated. For example the <a href=\"https://en.wikipedia.org/wiki/Functor#Definition\" rel=\"nofollow noreferrer\">identity law</a> for <a href=\"https://wiki.haskell.org/Functor\" rel=\"nofollow noreferrer\"><code>Functor</code></a></p>\n\n<pre><code>fmap id === id\n</code></pre>\n\n<p>would not hold any more: You'd be able to distinguish between <code>ones</code> and <code>fmap id ones</code>, as the latter would be acyclic. And compiler optimizations such as applying the above law would not longer preserve program properties.</p>\n\n<p>However another question would be having function</p>\n\n<pre><code>isCycleIO :: [a] -&gt; IO Bool\n</code></pre>\n\n<p>as <code>IO</code> actions are allowed to examine and change anything.</p>\n\n<p>A pure solution could be to have a data type that internally distinguishes the two:</p>\n\n<pre><code>import qualified Data.Foldable as F\n\ndata SmartList a = Cyclic [a] | Acyclic [a]\n\ninstance Functor SmartList where\n    fmap f (Cyclic xs) = Cyclic (map f xs)\n    fmap f (Acyclic xs) = Acyclic (map f xs)\n\ninstance F.Foldable SmartList where\n    foldr f z (Acyclic xs) = F.foldr f z xs\n    foldr f _ (Cyclic xs) = let r = F.foldr f r xs in r\n</code></pre>\n\n<p>Of course it wouldn't be able to recognize if a generic list is cyclic or not, but for many operations it'd be possible to preserve the knowledge of having <code>Cyclic</code> values.</p>\n"}], "owner": {"reputation": 36975, "user_id": 94977, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8341c5bff3dcbd8ed34d9d68bd4169f2?s=128&d=identicon&r=PG", "display_name": "Jason Orendorff", "link": "https://stackoverflow.com/users/94977/jason-orendorff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 1, "accepted_answer_id": 30278282, "answer_count": 2, "score": 19, "last_activity_date": 1431891739, "creation_date": 1431758706, "last_edit_date": 1495539855, "question_id": 30272662, "link": "https://stackoverflow.com/questions/30272662/would-the-ability-to-detect-cyclic-lists-in-haskell-break-any-properties-of-the", "title": "Would the ability to detect cyclic lists in Haskell break any properties of the language?", "body": "<p>In Haskell, some lists are cyclic:</p>\n\n<pre><code>ones = 1 : ones\n</code></pre>\n\n<p>Others are not:</p>\n\n<pre><code>nums = [1..]\n</code></pre>\n\n<p>And then there are things like this:</p>\n\n<pre><code>more_ones = f 1 where f x = x : f x\n</code></pre>\n\n<p>This denotes the same value as <code>ones</code>, and certainly that value is a repeating sequence. But whether it's represented in memory as a cyclic data structure is doubtful. (An implementation could do so, but <a href=\"https://stackoverflow.com/a/25498493/94977\">this answer explains that \"it's unlikely that this will happen in practice\"</a>.)</p>\n\n<p>Suppose we take a Haskell implementation and hack into it a built-in function <code>isCycle :: [a] -&gt; Bool</code> that examines the structure of the <em>in-memory representation</em> of the argument. It returns <code>True</code> if the list is physically cyclic and <code>False</code> if the argument is of finite length. Otherwise, it will fail to terminate. (I imagine \"hacking it in\" because it's impossible to write that function in Haskell.)</p>\n\n<p><strong>Would the existence of this function break any interesting properties of the language?</strong></p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1431776411, "post_id": 30271592, "comment_id": 48649174, "body": "<i>So the Haskell committee decided to skip it.</i> Could you add some reference for that?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1431777723, "post_id": 30271592, "comment_id": 48649531, "body": "@Jubobs I&#39;m not sure exactly what you want to see here. There are no type-level lambdas in the Report; but it&#39;s not like there&#39;s a specific section they&#39;re not in or something like that."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1431780475, "post_id": 30271592, "comment_id": 48650428, "body": "Type inference with type lambdas is decidable for Miller&#39;s pattern fragment, which includes all the things we have with current Haskell type constructors. I think it&#39;s better to say we don&#39;t have type lambdas in Haskell because there hasn&#39;t been much need for it and dependent typing has been an experimental design space for until recently."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1431781275, "post_id": 30271592, "comment_id": 48650695, "body": "@DanielWagner &quot;the Haskell committee decided to skip it&quot; implies that some discussion took place; I was wondering if there was a trace of that discussion, perhaps on a mailing list..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1431805633, "post_id": 30271592, "comment_id": 48658254, "body": "@Andr&#225;sKov&#225;cs Interesting; <a href=\"http://programmers.stackexchange.com/a/185439/63596\">this answer</a> seems to agree with me, though it doesn&#39;t cite its claims either. I can&#39;t seem to find a citation on Google Scholar that actually proves this one way or the other; perhaps you have a reference in mind?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1431815376, "post_id": 30271592, "comment_id": 48660937, "body": "@Jubobs I don&#39;t have a reference to a mailing list or anything like that. The best evidence I can offer is that I have worked for several years with some of the people that were on the committee and can attest to the depth of their expertise and broad knowledge of these kind of type system questions."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1431840079, "post_id": 30271592, "comment_id": 48665354, "body": "@DanielWagner: I don&#39;t have a reference, it was just my snap judgement:). I thought a bit more about it, and I think my point basically still stands if we add type lambdas but restrict instance heads to type constructors  (as it is the staus quo). Then the type checker can assume that a value with type (something -&gt; Constraint) must be a type constructor, and then we can deduce (f ~ g, a ~ b) from (Functor f, Functor g, f a ~ g b), for example."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1431840120, "post_id": 30271592, "comment_id": 48665360, "body": "@DanielWagner: type functions in instance heads imply incoherent instances anyway, which may or may not be an acceptable tradeoff, but I don&#39;t really have space to expound these matters here."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1431885009, "post_id": 30271592, "comment_id": 48677020, "body": "@Andr&#225;sKov&#225;cs You don&#39;t even need the excitement of type classes to make type-level lambdas exciting. Suppose you have <code>a :: ta</code> and <code>b :: tb</code>. Then type-checking the term <code>[a,b]</code> involves finding a substitution for all the free variables in the lambda-calculus term <code>ta</code> and a substitution for free variables in the lambda-calculus term <code>tb</code> that makes the two terms alpha-beta equal. That&#39;s higher-order unification, and it&#39;s known undecidable."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1431888667, "post_id": 30271592, "comment_id": 48678293, "body": "Haskell type inference has been undecidable for years. The stable door&#39;s open; the horse has bolted for better things. The question is not whether we need type annotations but how many, how big, and where? You can get a long way with explicit type signatures on definitions, from which information propagates inwards. The real kicker for Haskell is that the &quot;type constructor class&quot; machinery hangs off the &quot;fact&quot; that function application is injective: types are a first-order syntax. The shift to actual functional programming seems like just too much of a lurch!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 10, "last_activity_date": 1431747790, "creation_date": 1431747790, "answer_id": 30271592, "question_id": 30271553, "link": "https://stackoverflow.com/questions/30271553/the-kind-literal-in-haskell/30271592#30271592", "title": "The kind literal in Haskell", "body": "<p>It can't be done, unfortunately.</p>\n\n<p>One might wish for \"type-level lambdas\" (let's write them <code>/\\</code>); then you would be able to write <code>forall a b. /\\c. a -&gt; b -&gt; c</code> to denote this. This would be a really handy feature, and there has been much study into type systems that allow this, but the price you pay is that type inference becomes undecidable. So the Haskell committee decided to skip it.</p>\n"}], "owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 30271592, "answer_count": 1, "score": 9, "last_activity_date": 1431747790, "creation_date": 1431747276, "question_id": 30271553, "link": "https://stackoverflow.com/questions/30271553/the-kind-literal-in-haskell", "title": "The kind literal in Haskell", "body": "<p>As I know, the <code>-&gt;</code> has kind <code>*-&gt;*-&gt;*</code>, and the <code>((-&gt;) r)</code> has kind <code>*-&gt;*</code>.</p>\n\n<p>Assuming there is a type <code>(a-&gt;b-&gt;c)</code>, is there a way to represent the <code>(a-&gt;b-&gt;)</code>?</p>\n\n<p>I tried <code>((-&gt;) a ((-&gt;) b))</code> but it's error.</p>\n\n<p>I tried:</p>\n\n<pre><code>type Kab a b c = (a -&gt; b -&gt; c) -- it is ok\n</code></pre>\n\n<p>But it is failed to use the <code>Kab</code> in instance declaration:</p>\n\n<pre><code>instance KClass (Kab a b) where -- error\n</code></pre>\n\n<p>The only way I found that works is declare a <code>data</code>:</p>\n\n<pre><code>data Kab a b c = Kab (a -&gt; b -&gt; c)\ninstance KClass (Kab a b) where ..\n</code></pre>\n\n<p>But if I use the data, I have to unwrap the <code>Kab</code>, while my idea is to implement a KClass on native function type.</p>\n\n<p>So how to do it?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1431738470, "post_id": 30270629, "comment_id": 48641112, "body": "The answer below (you can&#39;t do this) is probably about the best we can say; but this smells like an <a href=\"http://meta.stackexchange.com/q/66377\">XY problem</a>. Perhaps you can open another question discussing how you came to the conclusion that you want this operation; then we may be able to suggest an alternative that helps with what you actually want to do."}, {"owner": {"reputation": 111, "user_id": 2259850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ae34bdeb7699f7f03e82ca4bf2a166?s=128&d=identicon&r=PG", "display_name": "Nicol&#225;s Kim", "link": "https://stackoverflow.com/users/2259850/nicol%c3%a1s-kim"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1431757390, "post_id": 30270629, "comment_id": 48644283, "body": "@user3237465 Good eye!"}, {"owner": {"reputation": 111, "user_id": 2259850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ae34bdeb7699f7f03e82ca4bf2a166?s=128&d=identicon&r=PG", "display_name": "Nicol&#225;s Kim", "link": "https://stackoverflow.com/users/2259850/nicol%c3%a1s-kim"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1431757546, "post_id": 30270629, "comment_id": 48644318, "body": "@DanielWagner You&#39;re right. I managed to work around it. Thanks for the advice!"}], "answers": [{"tags": [], "owner": {"reputation": 866, "user_id": 2872507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49ebde219395d677c399d8e950f5a48c?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Vieth", "link": "https://stackoverflow.com/users/2872507/alexander-vieth"}, "is_accepted": true, "score": 8, "last_activity_date": 1431737126, "creation_date": 1431737126, "answer_id": 30270674, "question_id": 30270629, "link": "https://stackoverflow.com/questions/30270629/inverse-of-sequence-from-data-traversable-in-haskell/30270674#30270674", "title": "Inverse of `sequence` from Data.Traversable in Haskell", "body": "<p>There can be no such function, because not every monad admits a kind of \"exit function\" <code>m a -&gt; a</code>. <code>IO</code> exemplifies this: if you have an <code>IO a</code>, you cannot remove the <code>IO</code> constructor (except via <code>unsafePerformIO</code> which you probably don't want to use).</p>\n\n<p>The monad typeclass functions </p>\n\n<pre><code>return :: a -&gt; m a\n(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>each have an <code>m a</code> after the rightmost arrow, so without more constraints on your function, the <code>m</code> constructor cannot be removed from around the list <code>[a]</code>.</p>\n"}], "owner": {"reputation": 111, "user_id": 2259850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56ae34bdeb7699f7f03e82ca4bf2a166?s=128&d=identicon&r=PG", "display_name": "Nicol&#225;s Kim", "link": "https://stackoverflow.com/users/2259850/nicol%c3%a1s-kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 1, "closed_date": 1431760282, "accepted_answer_id": 30270674, "answer_count": 1, "score": 0, "last_activity_date": 1431737126, "creation_date": 1431736619, "question_id": 30270629, "link": "https://stackoverflow.com/questions/30270629/inverse-of-sequence-from-data-traversable-in-haskell", "closed_reason": "Duplicate", "title": "Inverse of `sequence` from Data.Traversable in Haskell", "body": "<p>I need a function of type <code>Monad m =&gt; m [a] -&gt; [m a]</code>, which works just as <code>sequence</code> does, but in reverse. </p>\n\n<p>I've tried searching for any function with this type signature on Hoogle, but there doesn't seem to exist any. Is it impossible in general? Should I be avoiding this type of construction to begin with? </p>\n"}, {"tags": ["haskell", "cabal", "haskell-platform", "cabal-install"], "answers": [{"comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1431953713, "post_id": 30270816, "comment_id": 48703043, "body": "On my Windows 8 machine, the config file is located at <code>C:\\Users\\Orchid\\AppData\\Roaming\\cabal\\config</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1431738806, "creation_date": 1431738806, "answer_id": 30270816, "question_id": 30270480, "link": "https://stackoverflow.com/questions/30270480/how-does-cabal-determine-where-to-install-packages-globally-windows/30270816#30270816", "title": "How does cabal determine where to install packages globally (windows)?", "body": "<p>Your cabal configuration has a block labeled <code>install-dirs global</code> which gives the directories to use for global installations. I'm not sure where this file sits on Windows, but in Linux, it is in <code>~/.cabal/config</code>; so perhaps you can poke around in your profile's local settings directory for a directory named <code>cabal</code> or similar that contains a <code>config</code> file in it.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 3223410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c720065633d3f77f432396256c99a81a?s=128&d=identicon&r=PG&f=1", "display_name": "saps", "link": "https://stackoverflow.com/users/3223410/saps"}, "is_accepted": false, "score": 1, "last_activity_date": 1490162129, "last_edit_date": 1495540447, "creation_date": 1490162129, "answer_id": 42943779, "question_id": 30270480, "link": "https://stackoverflow.com/questions/30270480/how-does-cabal-determine-where-to-install-packages-globally-windows/42943779#42943779", "title": "How does cabal determine where to install packages globally (windows)?", "body": "<p>Adding to what <a href=\"https://stackoverflow.com/users/1006010/mathematicalorchid\">MathematicalOrchid</a> already mentioned, from the <a href=\"https://wiki.haskell.org/Cabal-Install\" rel=\"nofollow noreferrer\">Cabal-Install</a> wiki page:</p>\n\n<blockquote>\n  <p>You can edit the cabal configuration file to set defaults, for *nix\n  based systems this is:</p>\n  \n  <p>~/.cabal/config </p>\n  \n  <p>The config file on a Windows system is</p>\n  \n  <p>%appdata%\\cabal\\config</p>\n</blockquote>\n"}], "owner": {"reputation": 1764, "user_id": 970673, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94b2447e847a20d32c93c5e77e66b041?s=128&d=identicon&r=PG", "display_name": "Jordan Morris", "link": "https://stackoverflow.com/users/970673/jordan-morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2783, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1490162129, "creation_date": 1431735145, "question_id": 30270480, "link": "https://stackoverflow.com/questions/30270480/how-does-cabal-determine-where-to-install-packages-globally-windows", "title": "How does cabal determine where to install packages globally (windows)?", "body": "<p>I have installed haskell into a custom location, which I have in my PATH:</p>\n\n<pre><code>C:\\platforms\\haskell\\2014.2.0.0\\bin\n</code></pre>\n\n<p>However, when I install a package globally, I get this:</p>\n\n<pre><code>Installing executable(s) in C:\\Program Files\\Haskell\\bin\nWarning: The directory C:\\Program Files\\Haskell\\bin is not in the system\n</code></pre>\n\n<p>Where is it getting this path from, and how can I control where haskell will install packages globally? I would prefer they were installed in either the haskell install directory or my user profile somewhere.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 4333950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cff0f9fa0dbe8138e17ba4129d906d4?s=128&d=identicon&r=PG&f=1", "display_name": "Jan kowalski", "link": "https://stackoverflow.com/users/4333950/jan-kowalski"}, "edited": false, "score": 0, "creation_date": 1431766145, "post_id": 30270508, "comment_id": 48646268, "body": "What means &quot;guard&quot; in your code? Is it possible to edit list in resonable time?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 75, "user_id": 4333950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cff0f9fa0dbe8138e17ba4129d906d4?s=128&d=identicon&r=PG&f=1", "display_name": "Jan kowalski", "link": "https://stackoverflow.com/users/4333950/jan-kowalski"}, "edited": false, "score": 0, "creation_date": 1431807152, "post_id": 30270508, "comment_id": 48658780, "body": "What do you mean by edit?   As for guard... play with the example and see if you can figure it out. ;)"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 5, "last_activity_date": 1431735447, "creation_date": 1431735447, "answer_id": 30270508, "question_id": 30269897, "link": "https://stackoverflow.com/questions/30269897/minesweeper-like-boards-generating-in-haskell-ideas/30270508#30270508", "title": "Minesweeper like boards generating in Haskell - ideas", "body": "<p>Backtracking is super easy in Haskell using the list monad.  Here's an example:</p>\n\n<pre><code>import Control.Monad (guard)\n\npairs :: [(Int,Int)]\npairs = do\n    x &lt;- [1..10]\n    y &lt;- [1..x]\n    guard (even (x + y))\n    return (x,y)\n</code></pre>\n\n<p>Will give you all pairs <code>(x,y)</code> such that <code>y &lt;= x</code> and <code>x + y</code> is even.</p>\n\n<p>So you will want something like</p>\n\n<pre><code>type Board = ...\n\ninsertMine :: (Int,Int) -&gt; Board -&gt; [Board]\n-- return all ways of inserting a mine adjacent to the given coordinate\n\ninsertMines :: (Int,Int) -&gt; Board -&gt; [Board]\ninsertMines p board = do\n    b1 &lt;- insertMine p board\n    b2 &lt;- insertMine p b1\n    b3 &lt;- insertMine p b2\n    return b3\n</code></pre>\n\n<p>There are lots of ways to make this simpler and more abstract, but I'm trying to give an example near what I perceive to be your level.  Backtracking via the list monad is a great way to get comfortable with monads, too!</p>\n"}], "owner": {"reputation": 75, "user_id": 4333950, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cff0f9fa0dbe8138e17ba4129d906d4?s=128&d=identicon&r=PG&f=1", "display_name": "Jan kowalski", "link": "https://stackoverflow.com/users/4333950/jan-kowalski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 1, "accepted_answer_id": 30270508, "answer_count": 1, "score": 1, "last_activity_date": 1431735447, "creation_date": 1431730423, "last_edit_date": 1495539824, "question_id": 30269897, "link": "https://stackoverflow.com/questions/30269897/minesweeper-like-boards-generating-in-haskell-ideas", "title": "Minesweeper like boards generating in Haskell - ideas", "body": "<p>First of all I want to describe a problem (it's very similar to Minesweeper). We've given an <em>n</em> &times; <em>m</em> board and a list of special points (<em>x</em>,<em>y</em>,<em>z</em>). Each point says that around field (<em>x</em>,<em>y</em>) we need to place exactly <em>z</em> mines.</p>\n\n<p>You can find also better discription of problem here : <a href=\"https://stackoverflow.com/questions/9983206/prolog-where-to-begin-solving-minesweeper-like-puzzel\">Prolog: where to begin solving Minesweeper-like puzzel?</a>\n(it's in prolog but don't care about programming language)</p>\n\n<p>Our task is to generate all possible boards that satisfies task conditions.\nFor example:\nLet <code>n = 3</code>, <code>m = 3</code> and <code>L = [(2,2,1)]</code> is a list of special points, so possible solution is:</p>\n\n<pre><code>[[' ', ' ', ' '], [' ', 1, ' '], [' ', ' ', *]]\n</code></pre>\n\n<p>where ' ' is blank space and '*' is mine.</p>\n\n<p>I want to find some usefull ideas to write this problem in Haskell. My only idea is to generate all possible combinations of setting mines or use backtracking but i found it very hard to implement in haskell.</p>\n\n<p>Any ideas how to do it? </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 4602927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9zfg5.jpg?s=128&g=1", "display_name": "m0rphism", "link": "https://stackoverflow.com/users/4602927/m0rphism"}, "is_accepted": true, "score": 8, "last_activity_date": 1431805295, "last_edit_date": 1431805295, "creation_date": 1431730228, "answer_id": 30269875, "question_id": 30269870, "link": "https://stackoverflow.com/questions/30269870/ghci-error-no-instance-for-show/30269875#30269875", "title": "Ghci error: No instance for Show", "body": "<p>You are using the wrong syntax for function application. The following code does what you want:</p>\n\n<pre><code>let x = Cons 21 (Cons 12 Empty)\n</code></pre>\n\n<p>The reason for this is that the <code>Cons</code> constructor is a curried function, but you are treating it as an uncurried function.</p>\n\n<h2>Curried functions</h2>\n\n<p>Consider the following function adding two integers:</p>\n\n<pre><code>add :: Int -&gt; (Int -&gt; Int)\nadd = \\x -&gt; (\\y -&gt; x + y)\n</code></pre>\n\n<p>Here we say <code>add</code> is a function, which takes an argument <code>x</code> of type <code>Int</code> and returns a function,\nwhich takes an argument <code>y</code> of type <code>Int</code> and returns <code>x + y</code> of type <code>Int</code>.</p>\n\n<p>We can apply this function for example as <code>(add 1) 2</code> evaluating to <code>3</code>.</p>\n\n<p>Function application is <em>left-associative</em> in Haskell, which means that we don't need the parentheses\nin <code>(add 1) 2</code> and can simply write <code>add 1 2</code>.</p>\n\n<p>The function type constructor <code>-&gt;</code> is <em>right-associative</em> in Haskell, which means that we don't need the parentheses in <code>add :: Int -&gt; (Int -&gt; Int)</code> and can simply write <code>add :: Int -&gt; Int -&gt; Int</code>.</p>\n\n<p>Also we don't have to explicitly define <code>add</code> using lambdas and can use the following notation:</p>\n\n<pre><code>add :: Int -&gt; Int -&gt; Int\nadd x y = x + y\n</code></pre>\n\n<p>Encoding multi-parameter functions as single-parameter functions returning single-parameter functions is quite common in Haskell. This approach has the nice property, that we can also partially apply a function. For example the following function takes a single <code>Int</code> and adds 2:</p>\n\n<pre><code>add2 :: Int -&gt; Int\nadd2 x = add 2 x\n</code></pre>\n\n<p>But we can also <em>partially apply</em> <code>add</code> and simply write:</p>\n\n<pre><code>add2 :: Int -&gt; Int\nadd2 = add 2\n</code></pre>\n\n<p>This is also called <em>point-free notation</em>, where parameters are referred to as points.</p>\n\n<h2>Uncurried functions</h2>\n\n<p>An alternative encoding of multi-parameter functions can be done using tuple-values, i.e.</p>\n\n<pre><code>add' :: (Int, Int) -&gt; Int\nadd' (x, y) = x + y\n</code></pre>\n\n<p>We can invoke this function for example as <code>add' (2, 3)</code>, which constructs the pair <code>(2, 3) :: (Int, Int)</code> and passes it as a single argument to the <code>add'</code> function.</p>\n\n<h2>Uncurried &lt;-> Curried</h2>\n\n<p>In the standard library are two functions to convert functions between the two styles.</p>\n\n<pre><code>curry :: ((a, b) -&gt; c) -&gt; a -&gt; b -&gt; c\ncurry f x y = f (x, y)\n\nuncurry :: (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c\nuncurry f (x, y) = f x y\n</code></pre>\n\n<p>For example <code>curry add'</code> gives us <code>add</code>, and <code>uncurry add</code> gives us <code>add'</code>.</p>\n\n<h2>Back to explaining ghci's rambling</h2>\n\n<p>Note that we could also write the uncurried application as <code>add'(2, 3)</code>, which together with partial application and polymorphism explains why <code>let x = Cons(21, Cons(12, Empty))</code> doesn't directly lead to an error, but ghci subsequently says misterious things about the evaluation of <code>x</code>.\nWhat happens here is that <code>(12, Empty)</code> is pair of type <code>(Int, MyList a)</code> for some type <code>a</code>.\nThis pair is then used as the first argument in <code>Cons (12, Empty)</code>, so we get a partially applied function which takes\na <code>MyList (Int, MyList a)</code> and appends <code>(12, Empty)</code> as an element to this list.\nThe same happens for <code>Cons(21, Cons(12, Empty))</code> where we partially apply a pair of 21 and the before mentioned partial function. In the end we tell ghci to print a function, which it cannot display and hence complains about a missing <code>Show</code> instance for the corresponding function type.</p>\n"}], "owner": {"reputation": 103, "user_id": 4602927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9zfg5.jpg?s=128&g=1", "display_name": "m0rphism", "link": "https://stackoverflow.com/users/4602927/m0rphism"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 472, "favorite_count": 0, "accepted_answer_id": 30269875, "answer_count": 1, "score": 1, "last_activity_date": 1431805295, "creation_date": 1431730189, "last_edit_date": 1431730843, "question_id": 30269870, "link": "https://stackoverflow.com/questions/30269870/ghci-error-no-instance-for-show", "title": "Ghci error: No instance for Show", "body": "<p>This works in the ghci</p>\n\n<pre><code>data MyList a = Empty | Cons a (MyList a) deriving (Show, Eq, Read, Ord)\n\nlet x = Cons(21, Cons(12, Empty))\n</code></pre>\n\n<p>However when I type:</p>\n\n<pre><code>Prelude&gt; x\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>No instance for (Show (MyList (Integer, MyList (Integer, MyList a0) -&gt;\nMyList (Integer, MyList a0)) -&gt;\nMyList (Integer, MyList (Integer, MyList a0) -&gt;\nMyList (Integer, MyList a0)))) arising from a use of `print'\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1431726112, "post_id": 30269097, "comment_id": 48638085, "body": "I think you&#39;re getting confused between type and type class. Only a type, not another type class, can be made an instance of a type class. <code>instance Eq Num where ...</code> is invalid syntax."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1431726223, "post_id": 30269097, "comment_id": 48638121, "body": "@Jubobs Isnt <code>Num</code> in this case a type that extends <code>Eq</code>?"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1431726377, "post_id": 30269097, "comment_id": 48638190, "body": "Excerpt from LYAH:  You can also make typeclasses that are subclasses of other typeclasses. The class declaration for Num is a bit long, but here&#39;s the first part:      <code>class (Eq a) =&gt; Num a where  </code>"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1431726410, "post_id": 30269097, "comment_id": 48638199, "body": "<code>Num</code> is a type class (a subclass of <code>Eq</code>), not a type."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1431726743, "post_id": 30269097, "comment_id": 48638365, "body": "@Jubobs But suppose it wasn&#39;t. What if I wanted to define Num&#39;? What would the difference be?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1431726835, "post_id": 30269097, "comment_id": 48638391, "body": "@dopatraman How will you define <code>Num</code> as a type ? Typeclass are a way of providing ad hoc polymorphism. You cannot achieve that by creating a type."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1431727034, "post_id": 30269097, "comment_id": 48638469, "body": "not sure i understand what you mean by ad hoc polymorphism. My understanding was that <code>Num</code> could extend <code>Eq</code> to build abstraction and to avoid redundancy in code. Is that not true?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1431727225, "post_id": 30269097, "comment_id": 48638531, "body": "@dopatraman ad hoc polymorphism provides overloading. You can use the same functions on different types (for whom you have provided instances). Like <code>+</code> function can be used on <code>Int</code>, <code>Float</code>, <code>Double</code> etc. What <code>class (Eq a) =&gt; Num a where</code> says is that for a type to be of <code>Num</code> instance it should already have an instance on <code>Eq</code> typeclass."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1431727386, "post_id": 30269097, "comment_id": 48638579, "body": "Could you explain a bit more about how using <code>instance</code> would not serve the same purpose?"}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1431731783, "post_id": 30269097, "comment_id": 48639780, "body": "<code>Num</code> is <i>not</i> a type.  <code>Num</code> is a type class which other types, like <code>Int</code>, might implement.  You can&#39;t have a value of type <code>Num</code>, but you can have a value of type <code>Int</code>."}], "answers": [{"comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1433198293, "post_id": 30269598, "comment_id": 49238567, "body": "According to your example, type <code>Brilliant</code> is a member of set <code>Eq</code>. Why isnt type <code>Num</code> also a member of <code>Eq</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1433206124, "post_id": 30269598, "comment_id": 49240862, "body": "@dopatraman As discussed in my answer: <code>Num</code> is a set of types (and therefore not, itself, a type); since <code>Num</code> is not a type, it <i>cannot</i> be a member of any set of types. <code>Eq</code> is a set of types, so <code>Num</code> cannot be a member of <code>Eq</code>."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1433269755, "post_id": 30269598, "comment_id": 49275890, "body": "Suppose <code>Num</code> was not a pre defined Haskell type. Say it was <code>Num&#39;</code> or some such thing. Couldnt it be true that <code>Num&#39;</code> is a member of <code>Eq</code>? Then say that <code>Num&#39;</code> has all the properties of a member of <code>Num</code>, isnt it true that <code>instance Eq Num&#39;</code> ?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 1, "creation_date": 1433278122, "post_id": 30269598, "comment_id": 49280525, "body": "@dopatraman You can certainly define a new type named <code>Num&#39;</code> and make it an instance of the <code>Eq</code> class. What you cannot do is define a new class named <code>Num&#39;</code> and make it an instance of the <code>Eq</code> class. Classes and types are <i>fundamentally different</i> things (and the Haskell meaning of <code>class</code> is very different from, say, the Java meaning of <code>class</code>)."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1433344110, "post_id": 30269598, "comment_id": 49313920, "body": "I see. Without going through LYAH again, can you sum up how classes and types are different from each other? Also how they compare to classes in an OOP language?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1433357732, "post_id": 30269598, "comment_id": 49322609, "body": "The answer I wrote above <i>is</i> a description of how classes and types are different from each other. Classes are sets of types that all support some common methods."}, {"owner": {"reputation": 160, "user_id": 5731841, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/NSoa0.jpg?s=128&g=1", "display_name": "sigma", "link": "https://stackoverflow.com/users/5731841/sigma"}, "edited": false, "score": 0, "creation_date": 1572434760, "post_id": 30269598, "comment_id": 103556335, "body": "For the case class Eq a =&gt; Num a, did you mean to say that Eq is a superset of Num instead of the other way round? As you said, any type in Num must also be in Eq, making Eq a superset."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 7, "last_activity_date": 1572447532, "last_edit_date": 1572447532, "creation_date": 1431728487, "answer_id": 30269598, "question_id": 30269097, "link": "https://stackoverflow.com/questions/30269097/defining-an-instance-vs-using-class-constraints/30269598#30269598", "title": "defining an instance vs using class constraints", "body": "<p>Let's pronounce a couple of these Haskell declarations in English; perhaps that will clarify a few things. I'll give the Haskell declaration first, and an English transliteration afterwards.</p>\n\n<pre><code>class Eq a where (==) :: a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>There is a set of types. We name this set <code>Eq</code>. If <code>a</code> is a type in this set, then we can compare two values of that type for equality using a function named <code>(==)</code>.</p>\n\n<pre><code>data Brillant = T | F | FileNotFound\ninstance Eq Brillant where\n    T == T = True\n    F == F = True\n    FileNotFound == FileNotFound = True\n    _ == _ = False\n</code></pre>\n\n<p>There is a type named <code>Brillant</code>. It has constructors <code>T</code>, <code>F</code>, and <code>FileNotFound</code>. The <code>Brillant</code> type is an element of the <code>Eq</code> set. Two terms of type <code>Brillant</code> can be compared for equality by checking whether they use the same constructor.</p>\n\n<pre><code>data Maybe a = Nothing | Just a\ninstance Eq a =&gt; Eq (Maybe a) where\n    Nothing == Nothing = True\n    Just v == Just v' = v == v'\n</code></pre>\n\n<p>Whenever we have a type <code>a</code>, there is another type <code>Maybe a</code>. If <code>a</code> is an element of the <code>Eq</code> set, then <code>Maybe a</code> is an element of the <code>Eq</code> set.</p>\n\n<pre><code>class Eq a =&gt; Num a where\n    (+) :: a -&gt; a -&gt; a\n</code></pre>\n\n<p>There is a set of types. We name this set <code>Num</code>. If <code>a</code> is a type in this set, then <code>a</code> is also in the set <code>Eq</code> (or, in other words, <code>Num</code> is a subset of <code>Eq</code>). If <code>a</code> is a type in the <code>Num</code> set, then we can add two values of this type and get a third using the <code>(+)</code> function.</p>\n\n<p>If the following declaration were valid Haskell, here's what it would mean:</p>\n\n<pre><code>instance Eq Num where -- ...\n</code></pre>\n\n<p>The set named <code>Num</code> of types is an element of the set named <code>Eq</code> of types.</p>\n\n<p>Now let's compare the last two, namely, <code>class Eq a =&gt; Num a</code> and <code>instance Eq Num</code>. The former says that members of the <code>Num</code> set are also members of the <code>Eq</code> set, while the latter says that the <code>Num</code> set itself is a member of the <code>Eq</code> set. Hopefully the latter sets off some kind of alarm bell in your head. Since we said <code>Eq</code> is a set of types, all members of that set should be types. But we also said <code>Num</code> is a set of types, not a type; so it can't be a member.</p>\n\n<p>It can make sense to talk about sets of sets of types -- that is, classes whose instances are other classes -- but neither <code>Eq</code> nor <code>Num</code> do that. So it would not be correct to claim that <code>Num</code> is an instance of <code>Eq</code>.</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1572447532, "creation_date": 1431725711, "question_id": 30269097, "link": "https://stackoverflow.com/questions/30269097/defining-an-instance-vs-using-class-constraints", "title": "defining an instance vs using class constraints", "body": "<p>I'm going through <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#recursive-data-structures\" rel=\"nofollow\">Learn You a Haskell</a></p>\n\n<p>and am on the chapter that discusses typeclasses. There is this snippet:</p>\n\n<pre><code>class (Eq a) =&gt; Num a where\n</code></pre>\n\n<p>I understood this as a class constraint being imposed on the <code>Num</code> class, forcing it to act as an equatable class. My question is, why wasn't <code>Num</code> implemented as an instance of <code>Eq</code>? Like this:</p>\n\n<pre><code>instance Eq Num where\n... stuff\n</code></pre>\n\n<p>Defining an instance seems like a cleaner way to do this, but maybe I'm missing something. Can someone please explain the difference to me?</p>\n"}, {"tags": ["haskell", "list-comprehension"], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 2, "last_activity_date": 1431721946, "creation_date": 1431721946, "answer_id": 30268255, "question_id": 30268181, "link": "https://stackoverflow.com/questions/30268181/why-string-int-is-expected-instead-of-char-int/30268255#30268255", "title": "Why (String, Int) is expected instead of (Char, Int)?", "body": "<blockquote>\n  <p>Why a String is expected, when zip will clearly \"disunite\" the string into individual characters?</p>\n</blockquote>\n\n<p>Because <code>read</code> takes a String. In order to convert a single digit to an integer, use <code>digitToInt</code>, not <code>read</code> (alternatively you could also use <code>read [theChar]</code> to create a single-character string and convert it, but there's no need for that here as <code>digitToInt</code> exists).</p>\n\n<p>PS: Instead of <code>snd x</code> and <code>snd pair</code>, it would be more idiomatic to use pattern matching to name the elements of the pair individually.</p>\n"}, {"comments": [{"owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "edited": false, "score": 0, "creation_date": 1431875134, "post_id": 30268260, "comment_id": 48673646, "body": "Thank you for the answer. It was really helpful."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 3, "last_activity_date": 1431722465, "last_edit_date": 1431722465, "creation_date": 1431721974, "answer_id": 30268260, "question_id": 30268181, "link": "https://stackoverflow.com/questions/30268181/why-string-int-is-expected-instead-of-char-int/30268260#30268260", "title": "Why (String, Int) is expected instead of (Char, Int)?", "body": "<p>The function you're mapping <code>read . fst</code> has the type <code>Read a =&gt; (String, b) -&gt; a</code>.  So <code>map (read . fst) :: Read a =&gt; [(String, b)] -&gt; [a]</code>.  But <code>zipped</code> has the type <code>[(Char, Int)]</code>, and <code>takeRange</code> returns the same type of list as its input.</p>\n\n<p>As an aside, you could implement <code>takeRange</code> as</p>\n\n<pre><code>takeRange n elem list = take n $ drop (snd elem) $ list\n</code></pre>\n\n<p>You're doing extra work by counting the indices manually, and as @sepp2k mentions this would be even more idiomatic with pattern matching on the tuple.</p>\n"}], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 30268260, "answer_count": 2, "score": 0, "last_activity_date": 1431722465, "creation_date": 1431721626, "last_edit_date": 1431722275, "question_id": 30268181, "link": "https://stackoverflow.com/questions/30268181/why-string-int-is-expected-instead-of-char-int", "title": "Why (String, Int) is expected instead of (Char, Int)?", "body": "<p>I am completely lost why the following doesn't work:</p>\n\n<pre><code>takeRange :: Int -&gt; (a,Int) -&gt; [(a,Int)] -&gt; [(a,Int)]\ntakeRange n elem list = dropWhile (\\x -&gt; snd x &lt; snd elem) (takeWhile (\\x -&gt; snd x &lt; (snd elem) + n) list)\n\nseriesLargestProd :: String -&gt; Int -&gt; Int\nseriesLargestProd \"\" _ = 0\nseriesLargestProd _ 0 = 0\nseriesLargestProd s n = maximum [foldl1 (*) $ map (read . fst) (takeRange n pair zipped)\n                                | pair &lt;- zipped, snd pair &lt;= lastStartingIndex] \n                                    where zipped = zip s [1..]\n                                          lastStartingIndex = (length s) - (n-1)\n</code></pre>\n\n<p>The error messages I get:</p>\n\n<blockquote>\n<pre><code>Couldn't match type `Char' with `[Char]'\n    Expected type: (String, Int)\n      Actual type: (Char, Int)\n    In the second argument of `takeRange', namely `pair'\n    In the second argument of `map', namely `(takeRange n pair zipped)'\n\nCouldn't match type `Char' with `[Char]'\n    Expected type: [(String, Int)]\n      Actual type: [(Char, Int)]\n    In the third argument of `takeRange', namely `zipped'\n    In the second argument of `map', namely `(takeRange n pair zipped)'\n</code></pre>\n</blockquote>\n\n<p>If anyone's interested, this is supposed to be an answer to problem 8 of <a href=\"https://projecteuler.net/\" rel=\"nofollow\">Project Euler</a>.</p>\n"}, {"tags": ["haskell", "ghcjs", "reflex"], "answers": [{"tags": [], "owner": {"reputation": 1189, "user_id": 348201, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b5c1cb1e1615645078717836ffc3eaf?s=128&d=identicon&r=PG", "display_name": "somesoaccount", "link": "https://stackoverflow.com/users/348201/somesoaccount"}, "is_accepted": true, "score": 6, "last_activity_date": 1431887768, "creation_date": 1431887768, "answer_id": 30290639, "question_id": 30264504, "link": "https://stackoverflow.com/questions/30264504/xhrrequest-with-reflex-reflex-dom/30290639#30290639", "title": "XhrRequest with reflex/reflex-dom", "body": "<p>With help from <code>#reflex-frp</code> on freenode I found a solution: replacing <code>decodeXhrResponse</code> with <code>_xhrResponse_body</code> and using <code>Text</code> for the default string worked:</p>\n\n<pre><code>buttonDyn &lt;- holdDyn (Just $ T.pack \"default\") $ fmap _xhrResponse_body asyncEvent\n</code></pre>\n\n<p><code>decodeXhrResponse</code> expects some sort of JSON and although I tried to serve JSON via Scotty at one point it still didn't work.</p>\n"}, {"tags": [], "owner": {"reputation": 68390, "user_id": 55246, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c25ae0f8b2c34d0766717abab05b2efb?s=128&d=identicon&r=PG", "display_name": "Sridhar Ratnakumar", "link": "https://stackoverflow.com/users/55246/sridhar-ratnakumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1531096890, "last_edit_date": 1531096890, "creation_date": 1531093554, "answer_id": 51236791, "question_id": 30264504, "link": "https://stackoverflow.com/questions/30264504/xhrrequest-with-reflex-reflex-dom/51236791#51236791", "title": "XhrRequest with reflex/reflex-dom", "body": "<p>I wrote this simplified helper function to basically retrieve a remote URL from reflex:</p>\n\n<pre><code>curlGet :: MonadWidget t m =&gt; Text -&gt; m (Event t Text)\ncurlGet url = do\n  let req = xhrRequest \"GET\" url def\n  pb &lt;- getPostBuild\n  asyncReq &lt;- performRequestAsync (tag (constant req) pb)\n  pure $ fmap (fromMaybe \"Unknown error\" . _xhrResponse_responseText) asyncReq\n</code></pre>\n"}], "owner": {"reputation": 1189, "user_id": 348201, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b5c1cb1e1615645078717836ffc3eaf?s=128&d=identicon&r=PG", "display_name": "somesoaccount", "link": "https://stackoverflow.com/users/348201/somesoaccount"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 992, "favorite_count": 2, "accepted_answer_id": 30290639, "answer_count": 2, "score": 7, "last_activity_date": 1531096890, "creation_date": 1431707548, "last_edit_date": 1431729480, "question_id": 30264504, "link": "https://stackoverflow.com/questions/30264504/xhrrequest-with-reflex-reflex-dom", "title": "XhrRequest with reflex/reflex-dom", "body": "<p>I want to perform a basic Ajax request, that's all.</p>\n\n<p>I use <code>reflex</code> for the frontend and <code>Scotty</code> for the backend. The Firefox Web Console tells me the request was a success and I see the expected result there. But the website switches from <code>Just \"default\"</code> to <code>Nothing</code> instead of <code>Just \"success!\"</code>.</p>\n\n<p>Here is a complete minimal example:</p>\n\n<pre><code>import Reflex (holdDyn)\nimport Reflex.Dom (button, el, mainWidget, display)\nimport Reflex.Dom.Xhr (performRequestAsync, xhrRequest, decodeXhrResponse)\nimport Reflex.Class (tag, constant)\nimport Data.Default (def)\n\nmain :: IO ()\nmain = do\n  mainWidget $ el \"div\" $ do\n    buttonEvent &lt;- button \"click me\"\n    let defaultReq = xhrRequest \"GET\" \"mystring\" def  --served by Scotty\n    asyncEvent &lt;- performRequestAsync (tag (constant defaultReq) buttonEvent)\n    buttonDyn &lt;- holdDyn (Just \"default\") $ fmap decodeXhrResponse asyncEvent\n    display buttonDyn\n</code></pre>\n\n<p>and the <code>Scotty</code> part:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Web.Scotty\nimport Network.Wai.Middleware.Static\n\nmain = scotty 3000 $ do\n  middleware $ staticPolicy (noDots &gt;-&gt; addBase \"/mnt/b/haskell/try-reflex/hello.jsexe\")\n  get \"/\" $ do\n    file \"/mnt/b/haskell/try-reflex/hello.jsexe/index.html\"\n  get \"/mystring\" $ html \"success!\"\n</code></pre>\n\n<p>Since the debug tools tell me the request was a success, I suspect the error somewhere near <code>decodeXhrResponse</code> but I am a bit lost how I should proceed debugging since it just gets compiled to (unreadable) Javascript.</p>\n\n<p>I used the try-reflex Nix script from GitHub to set up everything and compiled with <code>ghcjs hello.hs</code> in the Nix environment.</p>\n\n<p>Edit: Adding the output of <code>curl</code>:</p>\n\n<pre><code>$ curl -G http://localhost:3000/mystring\nsuccess!% \n</code></pre>\n"}, {"tags": ["scala", "haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 11549, "user_id": 244473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d1cd517cd22ec9ce1fb5f7d8653387b?s=128&d=identicon&r=PG", "display_name": "gpampara", "link": "https://stackoverflow.com/users/244473/gpampara"}, "is_accepted": false, "score": 4, "last_activity_date": 1431703613, "creation_date": 1431703613, "answer_id": 30263287, "question_id": 30263044, "link": "https://stackoverflow.com/questions/30263044/in-scala-is-there-an-equivalent-of-haskells-fromlistwith-for-map/30263287#30263287", "title": "In Scala, is there an equivalent of Haskell&#39;s &quot;fromListWith&quot; for Map?", "body": "<p>The stdlib doesn't have such a feature, however, there is a port of <code>Data.Map</code> available in <code>scalaz</code> that <a href=\"https://github.com/scalaz/scalaz/blob/series/7.2.x/core/src/main/scala/scalaz/Map.scala#L1114\" rel=\"nofollow\">does have</a> this function available.</p>\n"}, {"comments": [{"owner": {"reputation": 3341, "user_id": 4041697, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1111ca84bea276e04e670172e31a40a5?s=128&d=identicon&r=PG&f=1", "display_name": "Kulu Limpa", "link": "https://stackoverflow.com/users/4041697/kulu-limpa"}, "edited": false, "score": 0, "creation_date": 1431704096, "post_id": 30263365, "comment_id": 48626687, "body": "Was about to write something similar. +1 for teaching me that <code>mapValues</code> exists."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 2, "creation_date": 1431748113, "post_id": 30263365, "comment_id": 48642690, "body": "Note that <code>mapValues</code> returns a view which will recalculate the value on every access, which may not be desirable in this case."}], "tags": [], "owner": {"reputation": 13201, "user_id": 1098230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c8776a6aefb37bf25d866707973593e?s=128&d=identicon&r=PG", "display_name": "Kolmar", "link": "https://stackoverflow.com/users/1098230/kolmar"}, "is_accepted": true, "score": 11, "last_activity_date": 1431705602, "last_edit_date": 1431705602, "creation_date": 1431703832, "answer_id": 30263365, "question_id": 30263044, "link": "https://stackoverflow.com/questions/30263044/in-scala-is-there-an-equivalent-of-haskells-fromlistwith-for-map/30263365#30263365", "title": "In Scala, is there an equivalent of Haskell&#39;s &quot;fromListWith&quot; for Map?", "body": "<p>Apart from using <code>scalaz</code> you could also define one yourself:</p>\n\n<pre><code>implicit class ListToMapWith[K, V](list: List[(K, V)]) {\n  def toMapWith(op: (V, V) =&gt; V) = \n    list groupBy (_._1) mapValues (_ map (_._2) reduce op)\n}\n</code></pre>\n\n<p>Here is a usage example:</p>\n\n<pre><code>scala&gt; val testList = List((5,\"a\"), (5,\"b\"), (3,\"b\"), (3,\"a\"), (5,\"a\"))\nscala&gt; testList toMapWith (_ + _)\nres1: scala.collection.immutable.Map[Int,String] = Map(5 -&gt; aba, 3 -&gt; ba)\n</code></pre>\n"}], "owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 30263365, "answer_count": 2, "score": 8, "last_activity_date": 1431705602, "creation_date": 1431702784, "question_id": 30263044, "link": "https://stackoverflow.com/questions/30263044/in-scala-is-there-an-equivalent-of-haskells-fromlistwith-for-map", "title": "In Scala, is there an equivalent of Haskell&#39;s &quot;fromListWith&quot; for Map?", "body": "<p>In Haskell, there is a function called <a href=\"http://hackage.haskell.org/package/containers-0.2.0.1/docs/Data-Map.html#15\">fromListWith</a> which can generate a Map from a function (used to merge values with the same key) and a list:</p>\n\n<pre><code>fromListWith :: Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a\n</code></pre>\n\n<p>The following expression will be evaluated to <code>true</code>:</p>\n\n<pre><code>fromListWith (++) [(5,\"a\"), (5,\"b\"), (3,\"b\"), (3,\"a\"), (5,\"a\")] == fromList [(3, \"ab\"), (5, \"aba\")]\n</code></pre>\n\n<p>In Scala, there is a similar function called <code>toMap</code> on <code>List</code> objects , which can also convert a list to a Map, but it can't have a parameter of function to deal with duplicated keys.</p>\n\n<p>Does anyone have ideas about this?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "edited": false, "score": 0, "creation_date": 1431703982, "post_id": 30263010, "comment_id": 48626610, "body": "Thanks, but ... my problem is more complicated than that.  Of the manyOtherFields, some will be Maybe&#39;s, some won&#39;t - at different stages of the program. I&#39;m trying to avoid creating many near clones for each possible variation."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "edited": false, "score": 0, "creation_date": 1431705239, "post_id": 30263010, "comment_id": 48627459, "body": "@Simon You could try the <a href=\"http://www.cs.nott.ac.uk/~wss/Publications/DataTypesALaCarte.pdf\" rel=\"nofollow noreferrer\">Data Types a la Carte</a> approach."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "edited": false, "score": 1, "creation_date": 1431705432, "post_id": 30263010, "comment_id": 48627588, "body": "@Simon I fear that you need a type which is so much parametrized it&#39;s actually a tuple (perhaps under another name)."}, {"owner": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431705888, "post_id": 30263010, "comment_id": 48627913, "body": "@bheklilr - that link broken :/"}, {"owner": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "edited": false, "score": 0, "creation_date": 1431705892, "post_id": 30263010, "comment_id": 48627919, "body": "@chi: what i&#39;m doing in principle is really simple. I wonder if there&#39;s an inherent weakness with Haskells type system?   The real world is full of maybe values (nulls in databases, empty form fields etc) such that I&#39;d need to use Maybe <i>almost everywhere</i> but that would be nightmarish and ugly. Alternatively I can force the software to &quot;resolve the maybes&quot; but then I end up with different types to acting as &quot;gateways&quot; to different processing stages."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "edited": false, "score": 1, "creation_date": 1431706103, "post_id": 30263010, "comment_id": 48628060, "body": "@Simon Are you trying to avoid using <code>Maybe</code>s because you&#39;re used to having null values in other languages?  The <code>Maybe</code> values really aren&#39;t difficult to work with in Haskell when you use the tools provided by <code>Functor</code>, <code>Applicative</code>, and <code>Monad</code>, along with the combinators in <code>Data.Maybe</code>.  Yes, the real world is full of nulls, which is why Haskell&#39;s type system allows you to encode that fact into your data types with <code>Maybe</code>.  This helps you avoid null pointer errors, a serious problem in more traditional languages."}, {"owner": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431706395, "post_id": 30263010, "comment_id": 48628259, "body": "@bheklilr - basically, yes. except it&#39;s more having to repetitively use fromMaybe <i>everywhere</i> to deal with possibility of a Nothing. This is especially annoying when I&#39;ve done the processing to ensure that a value exists."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "edited": false, "score": 0, "creation_date": 1431706512, "post_id": 30263010, "comment_id": 48628333, "body": "@Simon Could you possibly make a gist/pastebin/whatever of an actual use case here?  It could just be that there&#39;s a better way to make it less painful, maybe a combinator or technique that you&#39;re unaware of.  I&#39;m not saying that&#39;s the case, it&#39;s just hard to know without seeing real code."}, {"owner": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431709491, "post_id": 30263010, "comment_id": 48630099, "body": "@bheklilr - posted an example here -&gt;  <a href=\"http://lpaste.net/132675\" rel=\"nofollow noreferrer\">lpaste.net/132675</a> I&#39;ve added explanatory comments starting on line 54"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "edited": false, "score": 0, "creation_date": 1431716090, "post_id": 30263010, "comment_id": 48633550, "body": "@Simon It actually doesn&#39;t look like <code>digestive-functors</code> supports a default file name being shown on the form (although this is just what I&#39;ve gleaned from reading the docs and source for the library, I&#39;ve never used it before). But if you did want to at least provide a default you could do something like <a href=\"https://gist.github.com/bheklilr/ab9b17001cd3cbbe8b32\" rel=\"nofollow noreferrer\">this</a>. It compiles at least, and the introduction of <code>&lt;?</code> (think &quot;feeds a maybe&quot; as a mnemonic) along with some alignment results in a very readable block of code. I can&#39;t guarantee that <code>fileWithDefault</code> works, but it should in theory."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "edited": false, "score": 0, "creation_date": 1431716178, "post_id": 30263010, "comment_id": 48633592, "body": "@Simon I also chose to use <code>RecordWildCards</code>, but it isn&#39;t necessary.  Without it you&#39;d just add <code>m</code> at the end of all of those lines and replace <code>Media{..}</code> with <code>m</code>, which isn&#39;t bad either.  When you have lots of record fields it can come in handy, though."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "edited": false, "score": 0, "creation_date": 1431717081, "post_id": 30263010, "comment_id": 48634032, "body": "@Simon Nope, that won&#39;t set a default.  That&#39;s rather obnoxious... I would file an issue on <a href=\"https://github.com/jaspervdj/digestive-functors\" rel=\"nofollow noreferrer\">github</a> to say that <code>fmap (fromMaybe defaultFile) file</code> does not do what one might expect, and the <code>defaultFile</code> value is dropped when converting to a <code>View</code>."}, {"owner": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431723986, "post_id": 30263010, "comment_id": 48637218, "body": "@bheklilr - many thanks, that&#39;s very enlightening. will give it a try tomorrow."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1431703073, "last_edit_date": 1431703073, "creation_date": 1431702673, "answer_id": 30263010, "question_id": 30262854, "link": "https://stackoverflow.com/questions/30262854/how-to-handle-multiple-but-similar-record-types/30263010#30263010", "title": "How to handle multiple but similar record types", "body": "<p>I forgot the name of this technique... however, here it is:</p>\n\n<pre><code>import Data.Maybe\nimport Data.Functor.Identity\n\ndata MyType f = MyType\n   { field1 :: f Text\n   , manyOtherFields :: f Whatever\n   }\ntype MyType1 = MyType Maybe\ntype MyType2 = MyType Identity\n</code></pre>\n\n<p>The price to pay is to have an <code>Identity</code> constructor wrapping the data when it's fully processed.</p>\n\n<p>For instance:</p>\n\n<pre><code>x :: MyType1  -- partially processed\nx = MyType{field1 = Nothing, manyOtherFields = Just whatever}\n\ny :: MyType2  -- fully processed\ny = MyType{field1 = Identity someText, manyOtherFields = Identity whatever}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1431723588, "creation_date": 1431723588, "answer_id": 30268636, "question_id": 30262854, "link": "https://stackoverflow.com/questions/30262854/how-to-handle-multiple-but-similar-record-types/30268636#30268636", "title": "How to handle multiple but similar record types", "body": "<p>You give three data types in your gist:</p>\n\n<pre><code>data Media = Media {\n    mediaId :: Int\n  , mediaName :: Text\n  , mediaFilePath :: FilePath\n  , mediaMimeType :: Text\n  , mediaHash :: Text\n  , mediaWidth :: Int\n  , mediaHeight :: Int\n  , mediaCreated :: UTCTime\n  , mediaUpdated :: UTCTime\n}\ndata Media2 = Media2 {\n    mediaId :: Int\n  , mediaName :: Text\n  , mediaFilePath :: Maybe FilePath\n  , mediaMimeType :: Text\n  , mediaHash :: Text\n  , mediaWidth :: Int\n  , mediaHeight :: Int\n  , mediaCreated :: UTCTime\n  , mediaUpdated :: UTCTime\n}\ndata Media3= Media3 {\n    media3Id :: Int\n  , media3Name :: Text\n  , media3FilePath :: FilePath\n  , media3NewFilePath :: Maybe FilePath\n  , media3MimeType :: Text\n  , media3Hash :: Text\n  , media3Width :: Int\n  , media3Height :: Int\n  , media3Created :: UTCTime\n  , media3Updated :: UTCTime\n}\n</code></pre>\n\n<p>...and complain that these violate the DRY principle (and I agree!). One simple solution is to split out the shared parts, thus:</p>\n\n<pre><code>data Metadata = Metadata\n  { id :: Int\n  , name :: Text\n  , mimeType :: Text\n  , hash :: Text\n  , width :: Int\n  , height :: Int\n  , created :: UTCTime\n  , updated :: UTCTime\n  }\n</code></pre>\n\n<p>Then you have a few options for parameterizing the remaining bits. One choice is to have type modifiers; for example:</p>\n\n<pre><code>data Located   a = Located   { location :: FilePath, locatedValue :: a }\ndata Motion    a = Motion    { oldLocation, newLocation :: FilePath, motionValue :: a }\ndata UILocated a = UILocated { uiField :: Maybe FilePath, uilocatedValue :: a }\n</code></pre>\n\n<p>so that the old <code>Media</code> type, for example, would now be a <code>Located Metadata</code>. Another choice would be to have a sum type for locations:</p>\n\n<pre><code>data Location\n    = OnDisk FilePath\n    | Nowhere\n    | Moving FilePath FilePath\n</code></pre>\n\n<p>Then you could use <code>(Metadata, Location)</code> as your type for all three, or put the location in a field of <code>Metadata</code>. This loses some static checking, but may be convenient in some situations.</p>\n\n<p>Yet a third option is to add a polymorphic field to the metadata type:</p>\n\n<pre><code>data Metadata a = Metadata\n  { id :: Int\n  , name :: Text\n  , mimeType :: Text\n  , hash :: Text\n  , width :: Int\n  , height :: Int\n  , created :: UTCTime\n  , updated :: UTCTime\n  , extra :: a\n  }\n</code></pre>\n\n<p>so that your old <code>Media</code> type, for example, would now be <code>Metadata FilePath</code>, and <code>Media3</code> would be <code>Metadata (FilePath, Maybe FilePath)</code>.</p>\n"}], "owner": {"reputation": 86, "user_id": 1440103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b7ec8efa1f77ec791d541cce6ce091a?s=128&d=identicon&r=PG", "display_name": "Simon", "link": "https://stackoverflow.com/users/1440103/simon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1431723588, "creation_date": 1431702233, "last_edit_date": 1431704791, "question_id": 30262854, "link": "https://stackoverflow.com/questions/30262854/how-to-handle-multiple-but-similar-record-types", "title": "How to handle multiple but similar record types", "body": "<p>So let's say I have the following nearly identical type declarations. The types are related to each other in that MyType2 is a \"processed\" version of MyType1.</p>\n\n<pre><code>data MyType1 = MyType1 {\n   field1 :: Maybe Text\n   manyOtherFields :: Maybe Whatever\n}\n\ndata MyType2 = MyType2 {\n  field1 :: Text,\n  manyOtherFields :: Whatever\n}\n</code></pre>\n\n<p>Initially field1 is a Maybe because the data is coming from user input. Once processed however it becomes a Just value.</p>\n\n<p>This pattern of processing Maybes into Justs is likely to be repeated 10's or even 100's of times throughout my program with potentially many similar combinations describing variations of essentially the same entity at different processing stages.</p>\n\n<p>How do I avoid duplicating my type definitions for all the similar combinations ?</p>\n\n<p>Further explanation:</p>\n\n<p>In my actual program, the problem is accepting a file as input from a web form. When the form is received by my code the file input field is a Maybe FilePath, so I have a data type like:</p>\n\n<pre><code>data Media = Media {\n  filePath :: Maybe FilePath\n  altText :: Text,\n}\n</code></pre>\n\n<p>Once the input has been processed I'd need a new data type:</p>\n\n<pre><code>data Media2 = Media2 {\n  filePath :: FilePath\n  altText :: Text,\n  height :: Int,\n  width :: Int\n}\n</code></pre>\n\n<p>This seems ugly and impractical since similar patterns will be repeated over and over in my program. It's quite possible I'll need a Media3 (and 4) not to mention all the other entities and their variations.</p>\n"}, {"tags": ["haskell", "abstract-data-type"], "answers": [{"tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 6, "last_activity_date": 1431702034, "creation_date": 1431702034, "answer_id": 30262777, "question_id": 30262718, "link": "https://stackoverflow.com/questions/30262718/why-adt-data-myc-c-emptyc-consc-c-myc-not-type-safe/30262777#30262777", "title": "Why ADT &quot;data MyC c = EmptyC | ConsC c MyC&quot; not type safe?", "body": "<p>This is not <em>valid</em>, it has nothing to do with safety, it is simply incorrect.</p>\n\n<pre><code>data MyC c = EmptyC | ConsC c MyC\n</code></pre>\n\n<p>The problem here is that <code>MyC</code> takes an argument, but when it is used, it is not given an argument.  It should be as follows:</p>\n\n<pre><code>data MyC c = EmptyC | ConsC c (MyC c)\n--                            ^^^^^^^ The parameter is necessary\n</code></pre>\n\n<p>Note that <code>MyC Int</code> is basically the same as <code>IntList</code>.</p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 30262777, "answer_count": 1, "score": -1, "last_activity_date": 1431702034, "creation_date": 1431701859, "question_id": 30262718, "link": "https://stackoverflow.com/questions/30262718/why-adt-data-myc-c-emptyc-consc-c-myc-not-type-safe", "title": "Why ADT &quot;data MyC c = EmptyC | ConsC c MyC&quot; not type safe?", "body": "<pre><code>--This is type safe \ndata IntList = Empty | Cons Int IntList\n  deriving Show\n\n--This is type safe\ndata MyB b = EmptyB | ConsB b b\n  deriving Show\n\ndata MyC c = EmptyC | ConsC c MyC\n  deriving Show\n</code></pre>\n\n<p>Why is abstract data type MyC not type safe ?\nThe gaurd clause <code>ConsC c MyC</code> should construct the\nCons list as it is invokding <code>MyC</code> in same way that IntList\nis invoked from  <code>Cons Int IntList</code> for <code>IntList</code> ADT ?</p>\n"}, {"tags": ["list", "haskell", "data-structures", "append", "immutability"], "answers": [{"comments": [{"owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "edited": false, "score": 1, "creation_date": 1431699376, "post_id": 30261479, "comment_id": 48623412, "body": "I agree to what you say but the your Big O notation is not correct. O(500000500000) == O(1) == constant time (see <a href=\"http://en.wikipedia.org/wiki/Big_O_notation#Multiplication_by_a_constant\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a> ). Sure, you can argue that if you try to &quot;append a million elements&quot; then it always runs in O(1) as there&#39;s no variable left and the operation &quot;append a million times&quot; does indeed run in constant time. But I don&#39;t think that&#39;s what you want to say."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "edited": false, "score": 0, "creation_date": 1431699519, "post_id": 30261479, "comment_id": 48623526, "body": "@JohannesWei&#223; Better?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1431706563, "post_id": 30261479, "comment_id": 48628361, "body": "I know you didn&#39;t exactly claim otherwise, but GHC never changes the value of an existing heap object in the way you describe in the last paragraph. (What GHC is fairly good at is avoiding constructing the intermediate value on the heap in the first place.)"}, {"owner": {"reputation": 1040, "user_id": 4031371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/442e7ad304b6b890126c2edc315570e1?s=128&d=identicon&r=PG", "display_name": "Robin", "link": "https://stackoverflow.com/users/4031371/robin"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1431715922, "post_id": 30261479, "comment_id": 48633451, "body": "Hey @ReidBarton could you tell me more (or post a resource) about how GHC avoids constructing the intermediate value on the heap?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 1040, "user_id": 4031371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/442e7ad304b6b890126c2edc315570e1?s=128&d=identicon&r=PG", "display_name": "Robin", "link": "https://stackoverflow.com/users/4031371/robin"}, "edited": false, "score": 0, "creation_date": 1431732781, "post_id": 30261479, "comment_id": 48639996, "body": "@jackrandom, it&#39;s a complicated subject. Look for information on inlining, unboxing and list fusion."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 12, "last_activity_date": 1592810674, "last_edit_date": 1592810674, "creation_date": 1431698583, "answer_id": 30261479, "question_id": 30261346, "link": "https://stackoverflow.com/questions/30261346/list-manipulation-performance-in-haskell/30261479#30261479", "title": "List manipulation performance in Haskell", "body": "<p>It depends on the data structure you're using.  If you're using normal Haskell lists, these would be analogous to a typical linked list implementation in C or C++.  With this structure, appends and indexing (worst-case) are O(n) complexity, while prepends are O(1) complexity.  If you are appending frequently and your list is growing linearly this will effectively be O(n^2). For large lists this is a problem. This is regardless of what language you're using, Haskell, C, C++, Python, Java, C#, or even Assembler.</p>\n<p>However, if you were to use a structure like <a href=\"http://hackage.haskell.org/package/containers-0.2.0.1/docs/Data-Sequence.html\" rel=\"nofollow noreferrer\"><code>Data.Sequence.Seq</code></a>, then it uses the proper structure internally to provide O(1) prepends and appends, but the cost is that it can take up a bit more RAM.  All data structures have tradeoffs, though, it's up to you which one you want to use.</p>\n<p>Alternatively, you can also use <code>Data.Vector.Vector</code> or <code>Data.Array.Array</code>, which both provide fixed-length, contiguous memory arrays, but appending and prepending is expensive because you have to copy the entire array to a new location in RAM.  Indexing is O(1), though, and mapping or folding over one of these structures would be much faster because chunks of the array can fit into your CPU cache at a time, as opposed to linked lists or sequences that have elements scattered all over your RAM.</p>\n<blockquote>\n<p>Does Haskell &quot;copy&quot; the whole list (1 million elements) and adds the element to that copy?</p>\n</blockquote>\n<p>Not necessarily, the compiler can determine if it's safe to just have the last value's <code>next</code> pointer change to point at the new value instead of the empty list, or if it's unsafe it may be necessary to copy the entire list.  These problems are inherent to the data structure, not the language, though.  In general, I would say that Haskell's lists are better than C linked lists because the compiler is more capable of analyzing when this is safe than a programmer is, and C compiler won't do this sort of analysis, they just do exactly as they're told.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1520506357, "post_id": 30261588, "comment_id": 85347626, "body": "the appendings are not the problem. nothing precludes lists being implemented with their elements stored in a big pre-allocated array, plus <code>start</code> and <code>end</code> position. both <code>xs</code> and <code>xs ++ [a]</code> can use the same array. even prependings are not a problem if we start in the middle, or use lists (/ arrays) of (pointers to) array blocks. it is the <i>insertions</i> that are problematic. <code>case xs of (a:as) ...</code> would just create <code>as = (start+1,end,array)</code>  from <code>xs = (start,end,array)</code>, behind the scenes."}], "tags": [], "owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "is_accepted": false, "score": 3, "last_activity_date": 1431698884, "creation_date": 1431698884, "answer_id": 30261588, "question_id": 30261346, "link": "https://stackoverflow.com/questions/30261346/list-manipulation-performance-in-haskell/30261588#30261588", "title": "List manipulation performance in Haskell", "body": "<p>When using lists, appending is expensive and the list has to be copied, though not the elements. Also, prepending is cheap as the new value is just pointing to the original list.</p>\n\n<p>Take appending <code>\"third\"</code> to <code>[\"first\", \"second\"]</code>: the new list is <code>(:) \"first\" ((:) \"second\" ((:) \"third\" []))</code>. Thus the first constructor must be a new one as the second argument must be a new value as the ... The strings are not duplicated though. The new list points to the same strings in memory.</p>\n\n<p>Note that in the case where the old value is discarded, the compiler might decide to reuse it instead of allocating memory for new values and garbage collecting the old ones. In any case, appending will be done in O(n) as it needs to find the end of it.</p>\n\n<p>Now if your program is appending a lot to lists, you might want to use a different data structures to be able to append in O(1) such as <code>DList</code> form the package <code>dlist</code>. (<a href=\"https://hackage.haskell.org/package/dlist-0.5/docs/Data-DList.html\" rel=\"nofollow\">https://hackage.haskell.org/package/dlist-0.5/docs/Data-DList.html</a>)</p>\n"}, {"comments": [{"owner": {"reputation": 1040, "user_id": 4031371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/442e7ad304b6b890126c2edc315570e1?s=128&d=identicon&r=PG", "display_name": "Robin", "link": "https://stackoverflow.com/users/4031371/robin"}, "edited": false, "score": 0, "creation_date": 1431726864, "post_id": 30269187, "comment_id": 48638405, "body": "Nice! I didn&#39;t know about structure sharing."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 13, "last_activity_date": 1431729527, "last_edit_date": 1431729527, "creation_date": 1431726109, "answer_id": 30269187, "question_id": 30261346, "link": "https://stackoverflow.com/questions/30261346/list-manipulation-performance-in-haskell/30269187#30269187", "title": "List manipulation performance in Haskell", "body": "<p>This is a surprisingly complex question, because of two features of Haskell and GHC:</p>\n\n<ol>\n<li>Lazy evaluation</li>\n<li>List fusion</li>\n</ol>\n\n<p>List fusion means that in some situations, GHC can rewrite list processing code into a loop that doesn't allocate list cells.  So depending on the context where it is used, the same code could incur no additional cost.</p>\n\n<p>Lazy evaluation means that if the result of an operation is not consumed, then you don't pay the cost of computing it.  So for example, this is cheap, because you only have to construct the first ten elements of the list:</p>\n\n<pre><code>example = take 10 ([1..1000000] ++ [1000001])\n</code></pre>\n\n<p>In fact, in that code the <code>take 10</code> can fuse with the list append, so it's the same as just <code>[1..10]</code>.</p>\n\n<p>But let's just assume that we're consuming all of the elements of all of the lists that we make, and that the compiler isn't fusing our list operations.  Now to your questions:</p>\n\n<blockquote>\n  <p>If I add an element to a List in Haskell, Haskell returns a (completly?) new list, and doesn't manipulate the original one.  Now let's say I have a List of a million elements and I append one element at the end. Does Haskell \"copy\" the whole list (1 million elements) and adds the element to that copy? Or is there a neat \"trick\" going on behind the scenes to avoid copying the whole list?</p>\n</blockquote>\n\n<p>There exist tricks to avoid copying the whole list, but by appending to its end you defeat them.  The thing to understand is that functional data structures are normally designed so that operations that \"modify\" them will exploit <strong>structure-sharing</strong> to reuse as much of the old structure as possible.  So for example, appending two lists can be defined like this:</p>\n\n<pre><code>(++) :: [a] -&gt; [a] -&gt; [a]\n[] ++ ys = ys\n(x:xs) ++ ys = x : xs ++ ys\n</code></pre>\n\n<p>Looking at this definition, you can tell that the list <code>ys</code> will be reused in the result.  So if we have <code>xs = [1..3]</code>, <code>ys = [4..5]</code> and <code>xs ++ ys</code>, all fully evaluated and retained in memory at once, it will look something like this memory-wise:</p>\n\n<pre><code>           +---+---+    +---+---+    +---+---+\n      xs = | 1 | -----&gt; | 2 | -----&gt; | 3 | -----&gt; []\n           +---+---+    +---+---+    +---+---+\n\n           +---+---+    +---+---+ \n      ys = | 4 | -----&gt; | 5 | -----&gt; []\n           +---+---+    +---+---+    \n             ^\n             |\n             +------------------------------------+\n                                                  |\n           +---+---+    +---+---+    +---+---+    |\nxs ++ ys = | 1 | -----&gt; | 2 | -----&gt; | 3 | -------+\n           +---+---+    +---+---+    +---+---+\n</code></pre>\n\n<p>That is the long way of saying this: if you do <code>xs ++ ys</code>, and it doesn't fuse, and you consume the whole list, then that will create a copy of <code>xs</code> but reuse the memory for <code>ys</code>.</p>\n\n<p>But now let's look again at this bit of your question:</p>\n\n<blockquote>\n  <p>Now let's say I have a List of a million elements and I append one element at the end. Does Haskell \"copy\" the whole list (1 million elements) and adds the element to that copy?</p>\n</blockquote>\n\n<p>That would be something like <code>[1..1000000] ++ [1000001]</code>, and yes, it would copy the whole million elements.  But on the other hand, <code>[0] ++ [1..1000000]</code> would only copy the <code>[0]</code>.  The rule of thumb is this:</p>\n\n<ul>\n<li>Adding elements at the beginning of a list is most efficient.</li>\n<li>Adding elements at the end of a list is often inefficient, particularly if you do it over and over.</li>\n</ul>\n\n<p>The general solutions to this sort of problem are:</p>\n\n<ol>\n<li>Modify your algorithm so that you use lists in an access pattern they support efficiently.</li>\n<li>Don't use lists; use some other sequence data structure that efficiently supports the access pattern you need for the problem at hand.  Another answer mentioned difference lists, but others worth mentioning are:\n<ul>\n<li><a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Sequence.html\"><code>Data.Sequence</code></a></li>\n<li><a href=\"http://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Set.html\"><code>Data.Set</code></a></li>\n<li><a href=\"https://hackage.haskell.org/package/vector-0.10.12.3/docs/Data-Vector.html\"><code>Data.Vector</code></a></li>\n</ul></li>\n</ol>\n"}], "owner": {"reputation": 1040, "user_id": 4031371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/442e7ad304b6b890126c2edc315570e1?s=128&d=identicon&r=PG", "display_name": "Robin", "link": "https://stackoverflow.com/users/4031371/robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3182, "favorite_count": 4, "accepted_answer_id": 30261479, "answer_count": 3, "score": 13, "last_activity_date": 1592810674, "creation_date": 1431698199, "last_edit_date": 1520505225, "question_id": 30261346, "link": "https://stackoverflow.com/questions/30261346/list-manipulation-performance-in-haskell", "title": "List manipulation performance in Haskell", "body": "<p>I am currently learning Haskell and I am curious about the following:</p>\n\n<p>If I add an element to a list in Haskell, Haskell returns a (completely?) new list, and doesn't manipulate the original one.</p>\n\n<p>Now let's say I have a list of a million elements and I append one element at the end. Does Haskell \"copy\" the whole list (1 million elements) and adds the element to that copy? Or is there a neat \"trick\" going on behind the scenes to avoid copying the whole list?</p>\n\n<p>And if there isn't a \"trick\", is the process of copying large lists not as expensive as I think it is?</p>\n"}, {"tags": ["haskell", "threepenny-gui"], "answers": [{"comments": [{"owner": {"reputation": 655, "user_id": 2424911, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6YlX9.jpg?s=128&g=1", "display_name": "Maarten Faddegon", "link": "https://stackoverflow.com/users/2424911/maarten-faddegon"}, "edited": false, "score": 0, "creation_date": 1431801126, "post_id": 30273324, "comment_id": 48656909, "body": "Appending # and a counter that is incremented on each redraw to the image url works for me, so no need to add these functions again. Thanks!"}], "tags": [], "owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "is_accepted": true, "score": 1, "last_activity_date": 1431763806, "last_edit_date": 1495541659, "creation_date": 1431763806, "answer_id": 30273324, "question_id": 30260610, "link": "https://stackoverflow.com/questions/30260610/how-to-reload-updated-file-in-threepenny-gui-0-6/30273324#30273324", "title": "How to reload updated file in Threepenny-gui 0.6?", "body": "<p>(Author here.) Apparently, I didn't consider your use case when removing these functions. :-) I can add them back in if you like, could make an issue on github?</p>\n\n<p>There are various methods on the JavaScript side to reload a file at a certain URL. See for instance the question <a href=\"https://stackoverflow.com/q/1077041/403805\">\"Refresh image with a new one at the same url\"</a>.</p>\n"}], "owner": {"reputation": 655, "user_id": 2424911, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/6YlX9.jpg?s=128&g=1", "display_name": "Maarten Faddegon", "link": "https://stackoverflow.com/users/2424911/maarten-faddegon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 30273324, "answer_count": 1, "score": 1, "last_activity_date": 1431763806, "creation_date": 1431695995, "question_id": 30260610, "link": "https://stackoverflow.com/questions/30260610/how-to-reload-updated-file-in-threepenny-gui-0-6", "title": "How to reload updated file in Threepenny-gui 0.6?", "body": "<p>The Threepenny-gui changelog (<a href=\"https://hackage.haskell.org/package/threepenny-gui-0.6.0.1/changelog\" rel=\"nofollow\">https://hackage.haskell.org/package/threepenny-gui-0.6.0.1/changelog</a>) reads: \"The functions loadFile and loadDirectory have been removed, as I felt that the jsStatic option is sufficient for most use cases.\"</p>\n\n<p>My question is: <strong>how can we reload an image that is updated during execution without loadFile?</strong></p>\n\n<p>With Threepenny-gui 0.5 I used the following code:</p>\n\n<pre><code>redraw :: UI.Element -&gt; IORef CompTree -&gt; (Maybe Vertex) -&gt; UI ()\nredraw img treeRef mcv\n  = do tree &lt;- UI.liftIO $ readIORef treeRef\n       UI.liftIO $ writeFile \".Hoed/debugTree.dot\" (shw $ summarize tree mcv)\n       UI.liftIO $ system $ \"dot -Tpng -Gsize=9,5 -Gdpi=100 .Hoed/debugTree.dot \"\n                          ++ \"&gt; .Hoed/wwwroot/debugTree.png\"\n       url &lt;- UI.loadFile \"image/png\" \".Hoed/wwwroot/debugTree.png\"\n       UI.element img # UI.set UI.src url\n</code></pre>\n\n<p>When, with Threepenny-gui 0.6, I set <code>jsStatic</code> to <code>Just \"./.Hoed/wwwroot\"</code>, the following code (obviously) results in my GUI only showing the initial image that already was there when my application started: </p>\n\n<pre><code>redraw :: UI.Element -&gt; IORef CompTree -&gt; (Maybe Vertex) -&gt; UI ()\nredraw img treeRef mcv\n  = do tree &lt;- UI.liftIO $ readIORef treeRef\n       UI.liftIO $ writeFile \".Hoed/debugTree.dot\" (shw $ summarize tree mcv)\n       UI.liftIO $ system $ \"dot -Tpng -Gsize=9,5 -Gdpi=100 .Hoed/debugTree.dot \"\n                          ++ \"&gt; .Hoed/wwwroot/debugTree.png\"\n       UI.element img # UI.set UI.src \"static/debugTree.png\"\n       return ()\n</code></pre>\n\n<p>My full code for Threepenny-gui 0.5 is here: <a href=\"https://github.com/MaartenFaddegon/Hoed/blob/master/Debug/Hoed/DemoGUI.hs\" rel=\"nofollow\">https://github.com/MaartenFaddegon/Hoed/blob/master/Debug/Hoed/DemoGUI.hs</a></p>\n"}, {"tags": ["haskell", "formatting"], "comments": [{"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 2, "creation_date": 1431688247, "post_id": 30257774, "comment_id": 48615651, "body": "Can you write some example usage?"}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 4149214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6ea83c98d47b4feae6c0d80ee065529?s=128&d=identicon&r=PG&f=1", "display_name": "prophet-on-that", "link": "https://stackoverflow.com/users/4149214/prophet-on-that"}, "edited": false, "score": 0, "creation_date": 1431704066, "post_id": 30263215, "comment_id": 48626657, "body": "Thank you, your reasoning makes a lot of sense. I&#39;ve found the Holey type to be slightly complicated so I was wondering if I was missing something. Anyway, you&#39;re right that the type of the list combinator you suggest is general enough to work with the rest of the library, so I&#39;ll use that."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 1, "last_activity_date": 1431703377, "creation_date": 1431703377, "answer_id": 30263215, "question_id": 30257774, "link": "https://stackoverflow.com/questions/30257774/modifying-formatters-in-haskells-formatting-library/30263215#30263215", "title": "Modifying formatters in Haskell&#39;s formatting library", "body": "<p>Let's expand out the <a href=\"http://hackage.haskell.org/package/formatting-6.0.0/docs/Formatting-Holey.html#t:Format\" rel=\"nofollow\"><code>Format</code></a> types from <code>list :: ([Builder] -&gt; Builder) -&gt; Format r (a -&gt; r) -&gt; Format r ([a] -&gt; r)</code></p>\n\n<pre><code> Format            r     (a -&gt; r) -&gt; Format            r     ([a] -&gt; r)\n Holey  Builder    r     (a -&gt; r) -&gt; Holey  Builder    r     ([a] -&gt; r)\n(      (Builder -&gt; r) -&gt; (a -&gt; r))-&gt;(      (Builder -&gt; r) -&gt; ([a] -&gt; r))\n</code></pre>\n\n<p>We can try to build the definition of <code>list</code>.</p>\n\n<pre><code>list append m = Holey $ \\k -&gt; ...\n</code></pre>\n\n<p>We need to return an <code>[a] -&gt; r</code> where the <code>...</code> is. We don't have very many possible moves because we know nothing about the type <code>r</code>. We can pass <code>k :: Builder -&gt; r</code> to <code>runHM m</code> to get an <code>a -&gt; r</code>. If we <code>map</code> that over the <code>[a]</code> we have a <code>[r]</code>, but we know nothing about <code>r</code>, so we can't do anything with it.</p>\n\n<p>If a function like <code>list</code> exists it has a different type than <code>([Builder] -&gt; Builder) -&gt; Format r (a -&gt; r) -&gt; Format r ([a] -&gt; r)</code>.</p>\n\n<hr>\n\n<p>We can define <code>list</code> with a different type <code>list :: ([Builder] -&gt; Builder) -&gt; Format Builder (a -&gt; Builder) -&gt; Format r ([a] -&gt; r)</code>. This should work for most first arguments since most of the formatting components are universally qualified over all <code>r</code>.</p>\n\n<pre><code>list append m = Holey $ \\k -&gt; k . append . map (runHM m id)\n</code></pre>\n\n<p>This can be written more succinctly as</p>\n\n<pre><code>list append m = later (append . map (bprint m))\n</code></pre>\n"}], "owner": {"reputation": 179, "user_id": 4149214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f6ea83c98d47b4feae6c0d80ee065529?s=128&d=identicon&r=PG&f=1", "display_name": "prophet-on-that", "link": "https://stackoverflow.com/users/4149214/prophet-on-that"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 30263215, "answer_count": 1, "score": 0, "last_activity_date": 1431703377, "creation_date": 1431687406, "last_edit_date": 1431690609, "question_id": 30257774, "link": "https://stackoverflow.com/questions/30257774/modifying-formatters-in-haskells-formatting-library", "title": "Modifying formatters in Haskell&#39;s formatting library", "body": "<p>I'm using Chris Done's <a href=\"http://hackage.haskell.org/package/formatting-6.0.0\" rel=\"nofollow\">formatting</a> library (specifically formatting-6.0.0). I'm finding it difficult to construct a `higher order' function which maps a formatter to a list formatter, performing a custom action on the resultant list of Builders:</p>\n\n<pre><code>list :: ([Builder] -&gt; Builder) -&gt; Format r (a -&gt; r) -&gt; Format r ([a] -&gt; r)\n</code></pre>\n\n<p>This is desirable because it allows me to embed builder formatting logic in the format string.</p>\n\n<p>As an example, suppose the builder function is simply <code>mconcat</code>. Then <code>format (list mconcat int) [1,2,3]</code> would yield <code>\"123\"</code>. In practice, I may use a builder function which formats a list as an English list, such that the output for the above input would be <code>\"1, 2 and 3\"</code>.</p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "edited": false, "score": 6, "creation_date": 1431685141, "post_id": 30256923, "comment_id": 48613710, "body": "What do mean by meaningless? It is a composition of two functions. Btw, the linked article clearly states it."}, {"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "reply_to_user": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "edited": false, "score": 0, "creation_date": 1431685206, "post_id": 30256923, "comment_id": 48613742, "body": "@kraskevich ive updated question."}], "answers": [{"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1431685710, "post_id": 30257119, "comment_id": 48614059, "body": "<i>it greatly reduces the number of possible implementations of the function foo</i> - is there even <i>one</i> implementation different from the regular one?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1431686050, "post_id": 30257119, "comment_id": 48614275, "body": "@BartekBanachewicz - I don&#39;t think so, I&#39;m sure someone more knowledgeable than me could prove it."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431693516, "post_id": 30257119, "comment_id": 48619074, "body": "I believe <code>f=(.)</code> should follow by considering a normalized natural deduction proof of the corresponding proposition. Or possibly from its free theorem (even though I just failed a quick attempt to this)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1431722643, "post_id": 30257119, "comment_id": 48636570, "body": "@BartekBanachewicz <code>undefined</code>, <code>\\_ -&gt; undefined</code>, <code>\\_ _ -&gt; undefined</code>, and <code>\\_ _ _ -&gt; undefined</code> all have the given type and are different in meaningful ways from the regular one. There are also many variants like <code>\\f -&gt; f `seq` \\g x -&gt; f (g x)</code> that force their arguments at different times. Some of these are not only different but also useful."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 2, "last_activity_date": 1431685467, "creation_date": 1431685467, "answer_id": 30257119, "question_id": 30256923, "link": "https://stackoverflow.com/questions/30256923/are-there-any-use-cases-for-this-function-foo-b-c-a-b-a/30257119#30257119", "title": "Are there any use cases for this function : foo :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)", "body": "<p>The function <code>b -&gt; c</code> can be constructed - since <code>b</code> and <code>c</code> can be any type, then any function is compatible with it. However the function <code>foo</code> cannot <em>itself</em> (sensibly) construct such a function since it has no knowledge of <code>b</code> and <code>c</code>. This is a great benefit since it greatly reduces the number of possible implementations of the function <code>foo</code>. This is called <a href=\"http://en.wikipedia.org/wiki/Parametricity\" rel=\"nofollow\">parametricity</a></p>\n\n<p>This function is the type of the function composition operator <code>(.)</code>:</p>\n"}, {"tags": [], "owner": {"reputation": 17464, "user_id": 2040251, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UsW2G.jpg?s=128&g=1", "display_name": "kraskevich", "link": "https://stackoverflow.com/users/2040251/kraskevich"}, "is_accepted": true, "score": 5, "last_activity_date": 1431696990, "last_edit_date": 1431696990, "creation_date": 1431686472, "answer_id": 30257458, "question_id": 30256923, "link": "https://stackoverflow.com/questions/30256923/are-there-any-use-cases-for-this-function-foo-b-c-a-b-a/30257458#30257458", "title": "Are there any use cases for this function : foo :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)", "body": "<p>If the question is about using function composition in practice, here is a small example. Let's assume that we want to write a function which the sum of squares of all elements of a list of numbers. How could we do that? Well, we could write something like: <code>squareSum xs = sum (map (^2)) xs</code>. But we can also use function composition instead: <code>squareSum = sum . map (^2)</code>(I use <code>.</code> for function composition here instead of <code>foo</code>, but it doesn't really matter). This example shows a function which is obtained using function composition(it is practical at least in a sense that it compiles and works correctly). The benefits of function composition become more obvious when we need to compose multiple functions(possibly partially applied). </p>\n"}, {"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 0, "last_activity_date": 1431694351, "creation_date": 1431694351, "answer_id": 30260037, "question_id": 30256923, "link": "https://stackoverflow.com/questions/30256923/are-there-any-use-cases-for-this-function-foo-b-c-a-b-a/30260037#30260037", "title": "Are there any use cases for this function : foo :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)", "body": "<p>I just would like to chime in that <code>(.)</code> is probably somewhere in the top-three most-used functions in any good Haskell codebase.  It certainly is in my code.</p>\n\n<p>The other two of the top three are implicit calls to <code>fromInteger</code> inserted by the compiler due to integral literals, and implicit calls to <code>(&gt;&gt;=)</code> from <code>do</code> notation. And the latter there is, in a deep sense, the same operation as <code>(.)</code> but on values with slightly-differently-shaped types.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1431776865, "creation_date": 1431776865, "answer_id": 30275273, "question_id": 30256923, "link": "https://stackoverflow.com/questions/30256923/are-there-any-use-cases-for-this-function-foo-b-c-a-b-a/30275273#30275273", "title": "Are there any use cases for this function : foo :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)", "body": "<p>To complement other answers, let me try to prove that there is only one (total) function</p>\n\n<pre><code>foo :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)\n</code></pre>\n\n<p>or, in other words, that <code>foo = (.)</code>. By extensionality, we want to prove</p>\n\n<pre><code>foo f g n = f (g n)\n</code></pre>\n\n<p>where <code>f,g,n</code> are abritrary values of the types mandated by the signature of <code>foo</code>. </p>\n\n<pre><code>f :: b -&gt; c\ng :: a -&gt; b\nn :: a\n</code></pre>\n\n<p>We start from the associated free theorem, which can be <a href=\"http://www-ps.iai.uni-bonn.de/cgi-bin/free-theorems-webui.cgi\" rel=\"nofollow\">automatically generated on the web</a>:</p>\n\n<pre><code>forall t1,t2 in TYPES, R in REL(t1,t2).\n forall t3,t4 in TYPES, S in REL(t3,t4).\n  forall t5,t6 in TYPES, R1 in REL(t5,t6).\n   forall p :: t3 -&gt; t5.\n    forall q :: t4 -&gt; t6.\n     (forall (x, y) in S. (p x, q y) in R1)\n     ==&gt; (forall r :: t1 -&gt; t3.\n           forall s :: t2 -&gt; t4.\n            (forall (z, v) in R. (r z, s v) in S)\n            ==&gt; (forall (w, u) in R.\n                  (foo p r w, foo q s u) in R1))\n</code></pre>\n\n<p>Let's simplify this huge formula by specializing it. We pick:</p>\n\n<pre><code>t1 = a    t2 = ()\nt3 = b    t4 = ()\nt5 = c    t6 = ()\n</code></pre>\n\n<p>and we choose the relations as follows:</p>\n\n<pre><code>R = { (n       , ()) }  which is indeed in REL(t1,t2) = REL(a,())\nS = { (g n     , ()) }  which is indeed in REL(t3,t4) = REL(b,())\nR1= { (f (g n) , ()) }  which is indeed in REL(t5,t6) = REL(c,())\n</code></pre>\n\n<p>The free theorem becomes:</p>\n\n<pre><code>   forall p :: b -&gt; c.\n    forall q :: () -&gt; ().\n     (forall (x, y) in S. (p x, q y) in R1)\n     ==&gt; (forall r :: a -&gt; b.\n           forall s :: () -&gt; ().\n            (forall (z, v) in R. (r z, s v) in S)\n            ==&gt; (forall (w, u) in R.\n                  (foo p r w, foo q s u) in R1))\n</code></pre>\n\n<p>Picking <code>p = f</code> and <code>q = id</code> we obtain, by definition of <code>S</code> and <code>R1</code>:</p>\n\n<pre><code>     (forall x = g n, y = () . f x = f (g n) /\\ y = id y)\n     ==&gt; (forall r :: a -&gt; b.\n           forall s :: () -&gt; ().\n            (forall (z, v) in R. (r z, s v) in S)\n            ==&gt; (forall (w, u) in R.\n                  (foo f r w, foo id s u) in R1))\n</code></pre>\n\n<p>The premise of the top-level implication is true, so we discharge it.\nWe now pick <code>r = g</code> and <code>s = id</code>. We get, by definition of <code>r1</code> and <code>R</code>:</p>\n\n<pre><code>            (forall z = n, v = () . g z = g n , id v = ())\n            ==&gt; (forall (w, u) in R.\n                  (foo f g w, foo id id u) in R1)\n</code></pre>\n\n<p>We can discharge the true premise. Further, we can pick <code>w = n</code> and <code>u = ()</code>. We finally obtain:</p>\n\n<pre><code>                  foo f g n = f (g n) /\\ foo id id u = ()\n</code></pre>\n\n<p><strong>Q.E.D.</strong></p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 30257458, "answer_count": 4, "score": -1, "last_activity_date": 1431776865, "creation_date": 1431684908, "last_edit_date": 1431685875, "question_id": 30256923, "link": "https://stackoverflow.com/questions/30256923/are-there-any-use-cases-for-this-function-foo-b-c-a-b-a", "title": "Are there any use cases for this function : foo :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)", "body": "<p>For this function : </p>\n\n<p><code>foo :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)</code></p>\n\n<p>taken from <a href=\"http://www.seas.upenn.edu/~cis194/spring13/lectures/04-higher-order.html\" rel=\"nofollow\">http://www.seas.upenn.edu/~cis194/spring13/lectures/04-higher-order.html</a></p>\n\n<p>Is this a function with no practical use ? As <code>(b -&gt; c)</code> cannot be constructed unless type c is another input parameter within this function ?</p>\n\n<p>And same for <code>(a -&gt; b) -&gt; (a -&gt; c)</code> : b &amp; c are not input parameters to these functions.</p>\n\n<p>Are there any use cases for this function ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2627, "user_id": 215924, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/db83b716acfe0f3a1de6faa176d63fca?s=128&d=identicon&r=PG&f=1", "display_name": "Squidly", "link": "https://stackoverflow.com/users/215924/squidly"}, "edited": false, "score": 1, "creation_date": 1431680073, "post_id": 30255321, "comment_id": 48610481, "body": "Are you wanting to know what functions you can call on an Int? Try looking for Int in hoogle. Then try <code>:i Int</code> to see what typeclasses an Int implements, and look for functions that work on those typeclasses."}, {"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "reply_to_user": {"reputation": 2627, "user_id": 215924, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/db83b716acfe0f3a1de6faa176d63fca?s=128&d=identicon&r=PG&f=1", "display_name": "Squidly", "link": "https://stackoverflow.com/users/215924/squidly"}, "edited": false, "score": 0, "creation_date": 1431680873, "post_id": 30255321, "comment_id": 48610993, "body": "@MrBones +1 hoogle looks good, thanks"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4903115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318abc58dbe7a2b65b6353d956796f63?s=128&d=identicon&r=PG&f=1", "display_name": "Home Cheesy", "link": "https://stackoverflow.com/users/4903115/home-cheesy"}, "is_accepted": false, "score": 0, "last_activity_date": 1431680053, "creation_date": 1431680053, "answer_id": 30255344, "question_id": 30255321, "link": "https://stackoverflow.com/questions/30255321/how-to-use-where-to-find-haskell-api/30255344#30255344", "title": "How to use / where to find Haskell API?", "body": "<p>Hoogle is a Haskell API search engine, which allows you to search many standard Haskell libraries by either function name, or by approximate type signature. The Hoogle manual contains more details, including further details on search queries, how to install Hoogle as a command line application and how to integrate Hoogle with Firefox/Emacs/Vim etc. \nThanks,\n<a href=\"http://www.thecheesyanimation.com/3d-home-interior-design.html\" rel=\"nofollow\">http://www.thecheesyanimation.com/3d-home-interior-design.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 3, "last_activity_date": 1431680114, "creation_date": 1431680114, "answer_id": 30255372, "question_id": 30255321, "link": "https://stackoverflow.com/questions/30255321/how-to-use-where-to-find-haskell-api/30255372#30255372", "title": "How to use / where to find Haskell API?", "body": "<p>ghc-api is the API for interacting with the GHC compiler. The \"standard library\" is documented at <a href=\"http://hackage.haskell.org/package/base\" rel=\"nofollow\">http://hackage.haskell.org/package/base</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "is_accepted": false, "score": 1, "last_activity_date": 1431717035, "last_edit_date": 1431717035, "creation_date": 1431681800, "answer_id": 30255894, "question_id": 30255321, "link": "https://stackoverflow.com/questions/30255321/how-to-use-where-to-find-haskell-api/30255894#30255894", "title": "How to use / where to find Haskell API?", "body": "<blockquote>\n  <p>Can search from here or other Haskell doc for how each type should be\n  used?</p>\n</blockquote>\n\n<p>In Haskel you usually think <em>functions first</em>, i.e. you may want to know what functions are available, what input they accept and what output they produce. This is typically expressed by class constraints (\"must be a list of something\") and sometimes as concrete types.</p>\n\n<p>If you want to find particular functions, then try <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow\">Hoogle</a>. If you enter <code>Prelude</code> into the search field, you will find <code>module Prelude</code> among the answers. You may see the Prelude as the \"Haskell API\", i.e. the functions which are always available. </p>\n\n<p>Then there is the <a href=\"http://hackage.haskell.org/package/base\" rel=\"nofollow\">base</a> package, which consists of a number of additional modules (as already pointed out by Rein Henrichs), which are also widely used.</p>\n\n<p>Finally there is all the rest, i.e. special purpose modules. Many of the can also be found on Hoogle.</p>\n\n<p>But frankly, I don't think that \"learning the API\" is a good way to approach Haskell. This may work in Java, where you're dealing with Classes, Object and Methods all the time. </p>\n\n<p>In Haskell you are at a much higher level of abstaction. In Haskell you may find ways to implement Classes, Objects and Methods as <em>one</em> example showcase for a certain abstraction. However, it would not be abvious from reading the API that you can simulate OOP with it.</p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 30255372, "answer_count": 3, "score": 0, "last_activity_date": 1431717035, "creation_date": 1431679960, "last_edit_date": 1431682231, "question_id": 30255321, "link": "https://stackoverflow.com/questions/30255321/how-to-use-where-to-find-haskell-api", "title": "How to use / where to find Haskell API?", "body": "<p>Is this the documentation I should use for learning about the various haskell functions: <a href=\"https://www.haskell.org/platform/doc/2013.2.0.0/ghc-api/GHC.html\" rel=\"nofollow\">https://www.haskell.org/platform/doc/2013.2.0.0/ghc-api/GHC.html</a> ?</p>\n\n<p>Can search from <a href=\"https://www.haskell.org/platform/doc/2013.2.0.0/ghc-api/GHC.html\" rel=\"nofollow\">here</a> or other Haskell doc for how each type should be used? For example if I wanted to learn more about the <code>Int</code> type (without tying <code>:t</code> on command line) can this be searched upon ?</p>\n\n<p>If above is the API it seems much more minimalist that say a Java/Scala API. But perhaps this is one of the strong points of Haskell provide a succinct, yet very powerful set of base functions to build my abstractions upon ? </p>\n"}, {"tags": ["haskell", "generics", "recursion"], "comments": [{"owner": {"reputation": 7283, "user_id": 348716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9d46cbdc3830248a0615f14ae4b7b33d?s=128&d=identicon&r=PG", "display_name": "Anupam Jain", "link": "https://stackoverflow.com/users/348716/anupam-jain"}, "edited": false, "score": 1, "creation_date": 1431699408, "post_id": 30254830, "comment_id": 48623431, "body": "Turn infix to prefix to get the types - <code>(Int -&gt; Int -&gt; a)</code> is simply <code>((-&gt;) Int ((-&gt;) Int))</code>, and <code>(Int -&gt; Int -&gt; Int -&gt; a)</code> is <code>((-&gt;) Int (((-&gt;) Int ((-&gt;) Int))))</code> and so on"}, {"owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "reply_to_user": {"reputation": 7283, "user_id": 348716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9d46cbdc3830248a0615f14ae4b7b33d?s=128&d=identicon&r=PG", "display_name": "Anupam Jain", "link": "https://stackoverflow.com/users/348716/anupam-jain"}, "edited": false, "score": 0, "creation_date": 1431699630, "post_id": 30254830, "comment_id": 48623598, "body": "@AnupamJain Tried, still error :("}], "answers": [{"comments": [{"owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "edited": false, "score": 0, "creation_date": 1432181489, "post_id": 30345228, "comment_id": 48819955, "body": "It is awsome! I wonder how do you figure out such a solution? The Memo is cool but abstract, how to solve such problem step by step?"}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 1, "last_activity_date": 1432113095, "creation_date": 1432113095, "answer_id": 30345228, "question_id": 30254830, "link": "https://stackoverflow.com/questions/30254830/haskell-make-the-memoization-of-algebraic-recursion-generic/30345228#30345228", "title": "Haskell make the memoization of algebraic recursion generic", "body": "<p>How about something like below. However, in practice you could just pick one of the existing memoization libraries from Hackage.</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses, FlexibleInstances #-}\n\nclass Memo m a where\n    memo :: m -&gt; a\n\ninstance Memo a a where\n    memo = id\n\ninstance (Memo m a) =&gt; Memo (Int -&gt; m) [a] where\n    memo f = map (memo . f) [0..]\n\nfib :: Int -&gt; Int\nfib 0 = 1\nfib 1 = 1\nfib n = memo_fib (n - 1) + memo_fib (n - 2)\nmemo_fib = (memo fib !!)\n\nfib2 0 0 = 1\nfib2 0 1 = 1\nfib2 1 0 = 1\nfib2 i j = sum . concat $ [ [ memo_fib2 i (j-1) | j &gt; 0 ]\n                          , [ memo_fib2 i (j-2) | j &gt; 1 ]\n                          , [ memo_fib2 (i-1) j | i &gt; 0 ]\n                          , [ memo_fib2 (i-2) j | i &gt; 1 ]\n                          ]\nmemo_fib2 = let tab = memo fib2 in \\x y -&gt; tab !! x !! y\n</code></pre>\n"}], "owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 30345228, "answer_count": 1, "score": 0, "last_activity_date": 1432113095, "creation_date": 1431678223, "last_edit_date": 1431684659, "question_id": 30254830, "link": "https://stackoverflow.com/questions/30254830/haskell-make-the-memoization-of-algebraic-recursion-generic", "title": "Haskell make the memoization of algebraic recursion generic", "body": "<p>My idea is to do something like:</p>\n\n<pre><code>class Memo1D m where -- for one-Dimensional function\n    memo1D :: m a -&gt; [a]\n\ninstance Memo1D ((-&gt;) Int) where\n    memo1D f = map f [0 ..]\n</code></pre>\n\n<p>So, to add memoization to a Integer-recursive-problem would be very generic:</p>\n\n<pre><code>fib :: Int -&gt; Int\nfib 0 = 1\nfib 1 = 1\nfib n = (memo_fib !! (n - 1)) + (memo_fib !! (n - 2))\nmemo_fib = memo1D fib\n</code></pre>\n\n<p>And furthermore, if I also want to do the memoization in 2-D function, recieve 2 Integer as parameters, I have to add more code (the <code>(Int-&gt;Int-&gt;)</code> is error, how to declare it?):</p>\n\n<pre><code>class Memo2D m where\n    memo2D :: m a -&gt; [[a]]\ninstance Memo2D (Int -&gt; Int -&gt;) where -- (Int -&gt; Int -&gt;) is error, how to declare the kind that recieve `a` type and then become (Int-&gt;Int-&gt;a) ?\n    memo2D f = map (\\v -&gt; map v [0 ..]) (map f [0 ..])\n</code></pre>\n\n<p>And the \"2-D fibnacci number\" with memoization would be coded like:</p>\n\n<pre><code>fib2 0 0 = 1\nfib2 0 1 = 1\nfib2 1 0 = 1\nfib2 i j = if j &gt; 0 then memo_fib2 !! i !! (j - 1) else 0 +\n           if j &gt; 1 then memo_fib2 !! i !! (j - 2) else 0 +\n           if i &gt; 0 then memo_fib2 !! (i - 1) !! j else 0 +\n           if i &gt; 1 then memo_fib2 !! (i - 2) !! j else 0\nmemo_fib2 = memo2D fib2\n</code></pre>\n\n<p>And for 3-D, 4-D, etc. I also have to type corresponding class and instance.\nIs there a way to make these elegant and effective on multiple-dimension function, in here the multiple-dimension specific for the (Int->Int-> ... -> a) kind function?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1431661367, "post_id": 30251118, "comment_id": 48602731, "body": "You can&#39;t unless you use (some type isomorphic to) Either so that both types are encapsulated by a single type. What&#39;s more, you shouldn&#39;t want to: Haskell is not designed to allow you to pass different types to the same function."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1431661630, "post_id": 30251118, "comment_id": 48602803, "body": "You could also use <code>const</code> to pass in the value as a function that ignores its argument."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1431661797, "post_id": 30251118, "comment_id": 48602846, "body": "@ReinHenrichs, I bet there&#39;s also some horrifying trick with <code>OverlappingInstances</code> and <code>TypeFamilies</code> and maybe <code>DataKinds</code>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1431661936, "post_id": 30251118, "comment_id": 48602878, "body": "@dfeuer I am choosing to restrict myself to what I consider to be reasonable solutions..."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1431662629, "post_id": 30251118, "comment_id": 48603054, "body": "I don&#39;t see how your question applies to your edit. You aren&#39;t passing a function to a function. A direct translation of the Python solution would work in Haskell."}, {"owner": {"reputation": 833, "user_id": 679702, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2f1884ffd0d06fa7541684bcfa7857c4?s=128&d=identicon&r=PG", "display_name": "seanomlor", "link": "https://stackoverflow.com/users/679702/seanomlor"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1431663306, "post_id": 30251118, "comment_id": 48603250, "body": "@ReinHenrichs forgive me if i&#39;m misunderstanding, but I think the Python version can be called like this <code>f(f(7))</code>. Out of pure curiosity I&#39;m just wondering how/if a function in Haskell might be defined to support being called like <code>f 7</code> as well as <code>f f 7</code> or even <code>f f f f 7</code>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1431663640, "post_id": 30251118, "comment_id": 48603341, "body": "<code>f(f(7))</code> calls <code>f</code> with the result of <code>f(7)</code>. It never calls <code>f(f)</code>. The Haskell versions would be <code>f (f 7)</code> and <code>f (f (f 7))</code>, not <code>f f 7</code>."}, {"owner": {"reputation": 833, "user_id": 679702, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2f1884ffd0d06fa7541684bcfa7857c4?s=128&d=identicon&r=PG", "display_name": "seanomlor", "link": "https://stackoverflow.com/users/679702/seanomlor"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1431663886, "post_id": 30251118, "comment_id": 48603407, "body": "@ReinHenrichs ahhh, I see. Thank you!"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1431663943, "post_id": 30251118, "comment_id": 48603424, "body": "@seanomlor Are you referring to the answer by viraptor? That seems to fit what you&#39;re describing and I think that&#39;s where this confusion is arising (I assumed you were talking about the accepted answer at first, too). The accepted answer doesn&#39;t need that kind of trick."}, {"owner": {"reputation": 833, "user_id": 679702, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2f1884ffd0d06fa7541684bcfa7857c4?s=128&d=identicon&r=PG", "display_name": "seanomlor", "link": "https://stackoverflow.com/users/679702/seanomlor"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1431665391, "post_id": 30251118, "comment_id": 48603862, "body": "@DavidYoung I think my main issue here is that I was just caught up in a complete misunderstanding of Haskell function calls. The solution does not actually ever need to handle a function as an argument. \u2299\ufe4f\u2299"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1431672582, "post_id": 30251118, "comment_id": 48606571, "body": "A &quot;function that itself takes no arguments&quot; isn&#39;t a thing in Haskell. Without side effects, there is no semantic difference between &quot;a thing that will give me a value when I run it, needing no information&quot; and just having the return value. With laziness, there&#39;s not even the operational difference of having already done all the computational work, or not."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1431683891, "post_id": 30251118, "comment_id": 48612941, "body": "@Ben right about functions without arguments (there&#39;s no such thing). However, functions <i>of no meaningful argument</i>, <code>() -&gt; A</code>, are possible and indeed not quite the same to bare values of type <code>A</code>: <a href=\"https://wiki.haskell.org/Constant_applicative_form\" rel=\"nofollow noreferrer\">normal, lazy-evaluated values</a> are <i>memoised</i>, function results aren&#39;t."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1431688160, "post_id": 30251118, "comment_id": 48615603, "body": "@leftaroundabout, except that the full laziness transformation makes it hard to rely on memoization not happening."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1431711144, "post_id": 30251118, "comment_id": 48630991, "body": "@leftaroundabout A is denotationally isomorphic to A^1 (this is also generally true of algebraic structures with units and exponents)  but operationally may be different. Of course it&#39;s even more different in a strict language, where the transformation A -&gt; A^1 is often used to create a &quot;thunk&quot;, taking advantage of their denotational equivalence."}], "answers": [{"tags": [], "owner": {"reputation": 28662, "user_id": 10311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ee697b9dc2411d50fb66a4f330ba4df?s=128&d=identicon&r=PG", "display_name": "porges", "link": "https://stackoverflow.com/users/10311/porges"}, "is_accepted": false, "score": 2, "last_activity_date": 1431661564, "creation_date": 1431661564, "answer_id": 30251175, "question_id": 30251118, "link": "https://stackoverflow.com/questions/30251118/haskell-function-that-accepts-function-or-value-then-calls-function-or-returns/30251175#30251175", "title": "Haskell function that accepts function or value, then calls function or returns value", "body": "<p>You <em>could</em> do it like this:</p>\n\n<pre><code>data FunctionOrValue a\n    = Function (() -&gt; a)\n    | Value a\n\ngetValue :: FunctionOrValue a -&gt; a\ngetValue (Function f) = f ()\ngetValue (Value x) = x\n</code></pre>\n\n<p>However this is a bit silly.</p>\n\n<p>It sounds like you're trying to defer values manually, but since Haskell is lazy, there's not normally a need to do this.</p>\n"}, {"comments": [{"owner": {"reputation": 833, "user_id": 679702, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2f1884ffd0d06fa7541684bcfa7857c4?s=128&d=identicon&r=PG", "display_name": "seanomlor", "link": "https://stackoverflow.com/users/679702/seanomlor"}, "edited": false, "score": 0, "creation_date": 1431700823, "post_id": 30251231, "comment_id": 48624465, "body": "Definitely XY problem, thanks for all your help anyway!"}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 4, "last_activity_date": 1431661902, "last_edit_date": 1490005774, "creation_date": 1431661902, "answer_id": 30251231, "question_id": 30251118, "link": "https://stackoverflow.com/questions/30251118/haskell-function-that-accepts-function-or-value-then-calls-function-or-returns/30251231#30251231", "title": "Haskell function that accepts function or value, then calls function or returns value", "body": "<p>You can't write a function with two different signatures (unless you use typeclasses, but typeclasses are not suitable for this problem). You must solve this in a way that lets you treat both functions and non-function values as the same type. There are two obvious options:</p>\n\n<ol>\n<li><p>Use a sum type.</p>\n\n<pre><code>f :: Either (Int -&gt; Char) Char -&gt; Char\nf (Left g) = g 1\nf (Right c) = c\n</code></pre></li>\n<li><p>Use <code>const</code> to convert your non-function value into a function that ignores its argument:</p>\n\n<pre><code>f = ($ 42)\nf chr         --&gt; '*'\nf (const 'a') --&gt; 'a'\n</code></pre></li>\n</ol>\n\n<p><strong>However, since this is a very unHaskelly thing to ask for, I suspect that this is an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>.</strong></p>\n"}, {"comments": [{"owner": {"reputation": 833, "user_id": 679702, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2f1884ffd0d06fa7541684bcfa7857c4?s=128&d=identicon&r=PG", "display_name": "seanomlor", "link": "https://stackoverflow.com/users/679702/seanomlor"}, "edited": false, "score": 0, "creation_date": 1431665112, "post_id": 30251478, "comment_id": 48603775, "body": "This is cool. Curious how you might write this if requirement <i>was</i> Int result?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1431677048, "post_id": 30251478, "comment_id": 48609002, "body": "You inspired me to look for a solution to <code>Integer -&gt; Integer</code> without a range.  It is possible!"}, {"owner": {"reputation": 833, "user_id": 679702, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2f1884ffd0d06fa7541684bcfa7857c4?s=128&d=identicon&r=PG", "display_name": "seanomlor", "link": "https://stackoverflow.com/users/679702/seanomlor"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1431707460, "post_id": 30251478, "comment_id": 48628933, "body": "@luqui can you post the solution you found without a range?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 833, "user_id": 679702, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2f1884ffd0d06fa7541684bcfa7857c4?s=128&d=identicon&r=PG", "display_name": "seanomlor", "link": "https://stackoverflow.com/users/679702/seanomlor"}, "edited": false, "score": 0, "creation_date": 1431710482, "post_id": 30251478, "comment_id": 48630637, "body": "I found the same one as @seanomlor (just expressed a little differently)"}], "tags": [], "owner": {"reputation": 1409, "user_id": 1876583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf666782fb48c703f4fae045f681c13?s=128&d=identicon&r=PG", "display_name": "WolfeFan", "link": "https://stackoverflow.com/users/1876583/wolfefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1431666317, "last_edit_date": 1431666317, "creation_date": 1431663768, "answer_id": 30251478, "question_id": 30251118, "link": "https://stackoverflow.com/questions/30251118/haskell-function-that-accepts-function-or-value-then-calls-function-or-returns/30251478#30251478", "title": "Haskell function that accepts function or value, then calls function or returns value", "body": "<p>An answer based on the interview question you posted:</p>\n\n<pre><code>f n = if (abs fracN) &gt; 1 then 1/fracN else - (1/fracN)\n  where\n    fracN = realToFrac n\n</code></pre>\n\n<p>The question specified that the input is an int; it did not specify that the result must also be an int.</p>\n\n<p>Edit: if you must return an Int, note that the question allows you to specify a range of possible inputs. I use a limit of 1073741823 (half of the max value of a signed 32-bit int), which allows me to write this:</p>\n\n<pre><code>fint :: Int -&gt; Int\nfint 0 = 0\nfint n = if (abs n) &lt;= rangeVal then n+addend else -(n-addend)\n  where\n    rangeVal = 1073741823\n    negator = if n &lt; 0 then -1 else 1\n    addend = negator*rangeVal  \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 833, "user_id": 679702, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2f1884ffd0d06fa7541684bcfa7857c4?s=128&d=identicon&r=PG", "display_name": "seanomlor", "link": "https://stackoverflow.com/users/679702/seanomlor"}, "edited": false, "score": 0, "creation_date": 1431704933, "post_id": 30259247, "comment_id": 48627247, "body": "Wow! Incredible. Thank you. \u0298\u203f\u0298"}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 5, "last_activity_date": 1431691900, "last_edit_date": 1495541836, "creation_date": 1431691900, "answer_id": 30259247, "question_id": 30251118, "link": "https://stackoverflow.com/questions/30251118/haskell-function-that-accepts-function-or-value-then-calls-function-or-returns/30259247#30259247", "title": "Haskell function that accepts function or value, then calls function or returns value", "body": "<blockquote>\n  <p>I'm mostly curious how to solve this problem in Haskell without bit twiddling: <a href=\"https://stackoverflow.com/questions/731832/interview-question-ffn-n\">Designing function f(f(n)) == -n</a></p>\n</blockquote>\n\n<p>That's actually quite easy to solve:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>when :: (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a\nwhen p f x = if p x then f x else x\n\nf :: Integer -&gt; Integer\nf = (+) &lt;$&gt; when even negate &lt;*&gt; signum\n</code></pre>\n\n<p>How do we derive this? Consider:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f (f n) = (-n) -- (0) - from the interview question\n\nf x     = y    -- (1) - assumption\n\nf y     = (-x) -- (2) - from (0) and (1), f (f x) = (-x)\n\nf (-x)  = (-y) -- (3) - from (0) and (2), f (f y) = (-y)\n\nf (-y)  = x    -- (4) - from (0) and (3), f (f (-x)) = x\n</code></pre>\n\n<p>Now, if you see the left hand sides of these equations then you'll notice that there are four cases:</p>\n\n<ol>\n<li><code>f x</code>.</li>\n<li><code>f y</code>.</li>\n<li><code>f (-x)</code>.</li>\n<li><code>f (-y)</code>.</li>\n</ol>\n\n<p>Notice that the domain of the function <code>f</code> is divided into positive and negative numbers, <code>x</code> and <code>(-x)</code>, and <code>y</code> and <code>(-y)</code>. Let's assume that <code>x</code> and <code>y</code> together form the set of positive numbers and <code>(-x)</code> and <code>(-y)</code> together form the set of negative numbers.</p>\n\n<p>The set of positive numbers is divided into two <a href=\"http://mathworld.wolfram.com/ProperSubset.html\" rel=\"nofollow noreferrer\">proper</a> <a href=\"http://mathworld.wolfram.com/DisjointSets.html\" rel=\"nofollow noreferrer\">disjoint</a> subsets, <code>x</code> and <code>y</code>. How do we divide the set of positive numbers into two proper disjoint subsets? Odd and even numbers are a good candidate. Hence, let's assume that <code>x</code> is the set of positive odd numbers and <code>y</code> is the set of positive even numbers.</p>\n\n<p>Another advantage of using odd and even numbers is that when negated odd numbers remain odd and even numbers remain even. Hence, <code>(-x)</code> is the set of negative odd numbers and <code>(-y)</code> is the set of negative even numbers.</p>\n\n<p>Now, consider the four cases again. Notice that the sign only changes when the number is even:</p>\n\n<ol>\n<li><code>f x = y</code> (sign does not change).</li>\n<li><code>f y = (-x)</code> (sign changes).</li>\n<li><code>f (-x) = (-y)</code> (sign does not change).</li>\n<li><code>f (-y) = x</code> (sign changes).</li>\n</ol>\n\n<p>Hence, we only negate the number when it is even (i.e. <code>when even negate</code>).</p>\n\n<p>Next, we need to convert odd numbers into even numbers and vice versa. The easiest way to do so is to add or subtract one from the number. However, care should be taken that the resulting number is not <code>0</code>. Consider the special case of <code>0</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f 0    = z    -- (a) - assumption\n\nf z    = (-0) -- (b) - from (0) and (a), f (f 0) = (-0)\n\nf (-0) = (-z) -- (c) - from (0) and (b), f (f z) = (-z)\n\n(-0)   = 0    -- (d) - reflexivity\n\nf (-0) = f 0  -- (e) - from (d)\n\n(-z)   = z    -- (f) - from (a) and (c) and (e)\n\nz      = 0    -- (g) - from (d) and (f)\n\nf 0    = 0    -- (h) - from (a) and (g)\n</code></pre>\n\n<p>Hence, <code>f n = 0</code> <a href=\"https://en.wikipedia.org/wiki/If_and_only_if\" rel=\"nofollow noreferrer\">if and only if</a> <code>n = 0</code>. So let's consider the neighbors of <code>0</code>, <code>1</code> and <code>(-1)</code>. Both of them are odd numbers. Hence, they are not negated. However, they do need to be converted into an even number (except for <code>0</code>). Hence, <code>1</code> is converted into <code>2</code> and <code>(-1)</code> is converted into <code>(-2)</code>.</p>\n\n<p>Thus, for odd numbers we simply add the sign of the number to the number itself.</p>\n\n<p>Now, consider even numbers. We know:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f 1    = 2    -- (A)\n\nf (-1) = (-2) -- (B)\n</code></pre>\n\n<p>Therefore:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f 2    = (-1) -- (C), from (0) and (A), f (f 1) = (-1)\n\nf (-2) = 1    -- (D), from (0) and (B), f (f (-1)) = 1\n</code></pre>\n\n<p>We know that even numbers are always negated. Hence, <code>2</code> first becomes <code>(-2)</code> and vice versa. Let the original even number be <code>n</code>. Hence, first we <code>negate n</code> and then add <code>signum n</code> to it:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>evenF n    = negate n    + signum n\n\nevenF 2    = negate 2    + signum 2\n           = (-2)        + 1\n           = (-1)\n\nevenF (-2) = negate (-2) + signum (-2)\n           = 2           + (-1)\n           = 1\n\nevenF 0    = negate 0    + signum 0\n           = 0           + 0\n           = 0\n</code></pre>\n\n<p>Thus, for both the odd case and the even case we add the sign of the original number to <code>when even negate</code>. Therefore, <code>f</code> is defined as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f :: Integer -&gt; Integer\nf = (+) &lt;$&gt; when even negate &lt;*&gt; signum\n</code></pre>\n\n<p>Hope that helps.</p>\n"}, {"comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1431699860, "post_id": 30260182, "comment_id": 48623764, "body": "Values are not &quot;functions without parameters&quot;. That&#39;s absolutely wrong. <a href=\"http://stackoverflow.com/a/30148316/783743\">Values and functions are different things altogether</a>. Laziness and referential transparency (purity) are orthogonal concepts to functions and values. Yes, <code>head []</code> doesn&#39;t blow up because of laziness but that doesn&#39;t make it &quot;a function without a parameter&quot; because it is not a function at all. It&#39;s an unevaluated expression. Also, <code>f = ...</code> is neither a function nor a value. It&#39;s just a name binding. Finally, Haskell does have nullary functions. They are simply IO actions. 3=D"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1431700064, "post_id": 30260182, "comment_id": 48623913, "body": "In addition, I don&#39;t see how your answer addresses the OP&#39;s question at all. Hence, it should be a comment instead of an answer."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1431709024, "post_id": 30260182, "comment_id": 48629823, "body": "@AaditMShah That&#39;s your definition of nullary function which includes side-effect. I agree that technically, &quot;value&quot; are not instance of <code>(-&gt;)</code> and therefore are not function as such, but neither are <code>IO</code> value. There are actions, not function. If you agree that nullary function exists in haskell, then value and nullary function are semantically equivalent : It&#39;s the generalisation of <code>a -&gt; b -&gt; c</code>  is a function with 2 args, <code>a -&gt; b</code>, 1 arg, <code>a</code>: 0."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1431709173, "post_id": 30260182, "comment_id": 48629908, "body": "... this equivalance is not true in other language, for example in python you can have <code>x = 3</code> and <code>def f(): 3</code> and they will behave differenty. In Haskell, theres is no equivalent to <code>def f(): 3</code>. I think that&#39;s what the OP is confused with."}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 1, "last_activity_date": 1431694729, "creation_date": 1431694729, "answer_id": 30260182, "question_id": 30251118, "link": "https://stackoverflow.com/questions/30251118/haskell-function-that-accepts-function-or-value-then-calls-function-or-returns/30260182#30260182", "title": "Haskell function that accepts function or value, then calls function or returns value", "body": "<p>One of the nice thing in Haskell (IMHO) is there is no difference between a value and a function without parameter returning a value (thanks to lazyness AND purity). Or if you prefer, every value is in fact a function without parameter which will be evaluated when needed. Therefore there is no need to worry about that type of problem. There is no such thing like <code>f()</code>, it's just <code>f</code>.</p>\n\n<p>For example, you can write</p>\n\n<pre><code>x = 3 :: Int \nf = head [] :: Int -- should blow up but doesn't\n\nhead [x, f] -- note that f and x have the same type\n&gt; 3  -- doesn't blow up on f, because f is not called\n\nhead [f] -- blows up, when trying to print f\n</code></pre>\n"}], "owner": {"reputation": 833, "user_id": 679702, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2f1884ffd0d06fa7541684bcfa7857c4?s=128&d=identicon&r=PG", "display_name": "seanomlor", "link": "https://stackoverflow.com/users/679702/seanomlor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 1, "accepted_answer_id": 30259247, "answer_count": 5, "score": 2, "last_activity_date": 1431694729, "creation_date": 1431661093, "last_edit_date": 1495540442, "question_id": 30251118, "link": "https://stackoverflow.com/questions/30251118/haskell-function-that-accepts-function-or-value-then-calls-function-or-returns", "title": "Haskell function that accepts function or value, then calls function or returns value", "body": "<p>How can I write a type declaration and function in Haskell that takes either a function (that itself takes no arguments) <em>or</em> a value. When given a function it calls the function. When given a value it returns the value.</p>\n\n<p><strong>[edit]</strong> To give more context, I'm mostly curious how to solve this problem in Haskell without bit twiddling: <a href=\"https://stackoverflow.com/questions/731832/interview-question-ffn-n\">Designing function f(f(n)) == -n</a></p>\n\n<p>Sean</p>\n"}, {"tags": ["haskell", "binary"], "answers": [{"tags": [], "owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "is_accepted": false, "score": 1, "last_activity_date": 1431789669, "creation_date": 1431789669, "answer_id": 30277386, "question_id": 30251045, "link": "https://stackoverflow.com/questions/30251045/query-ip2location-lite-binary-databases-using-haskell/30277386#30277386", "title": "Query IP2Location LITE binary databases using Haskell?", "body": "<p>I don't know about ip2location, but there is geoip2 native module that works with Geoip2 database. Depending on what you want to use it for it may work for you.</p>\n"}, {"tags": [], "owner": {"reputation": 1281, "user_id": 6647585, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cac5dd1f2f2645dcc1dbf1165fed77c6?s=128&d=identicon&r=PG&f=1", "display_name": "Vlam", "link": "https://stackoverflow.com/users/6647585/vlam"}, "is_accepted": false, "score": 1, "last_activity_date": 1476753214, "last_edit_date": 1476753214, "creation_date": 1476670994, "answer_id": 40077636, "question_id": 30251045, "link": "https://stackoverflow.com/questions/30251045/query-ip2location-lite-binary-databases-using-haskell/40077636#40077636", "title": "Query IP2Location LITE binary databases using Haskell?", "body": "<p>You can use the following example code from <a href=\"https://github.com/ip2location/ip2location-haskell\" rel=\"nofollow\">Github</a>:</p>\n\n<pre><code>import IP2Location\n\nmain :: IO ()\nmain = do\n    let myfile = \"IPV6-COUNTRY-REGION-CITY-LATITUDE-LONGITUDE-ZIPCODE-TIMEZONE-ISP-DOMAIN-NETSPEED-AREACODE-WEATHER-MOBILE-ELEVATION-USAGETYPE.BIN\"\n    meta &lt;- doInit myfile\n    result &lt;- doQuery myfile meta \"8.8.8.8\"\n    putStrLn $ \"country_short: \" ++ (show (country_short result))\n    putStrLn $ \"country_long: \" ++ (show (country_long result))\n    putStrLn $ \"region: \" ++ (show (region result))\n    putStrLn $ \"city: \" ++ (show (city result))\n    putStrLn $ \"isp: \" ++ (show (isp result))\n    putStrLn $ \"latitude: \" ++ (show (latitude result))\n    putStrLn $ \"longitude: \" ++ (show (longitude result))\n    putStrLn $ \"domain: \" ++ (show (domain result))\n    putStrLn $ \"zipcode: \" ++ (show (zipcode result))\n    putStrLn $ \"timezone: \" ++ (show (timezone result))\n    putStrLn $ \"netspeed: \" ++ (show (netspeed result))\n    putStrLn $ \"iddcode: \" ++ (show (iddcode result))\n    putStrLn $ \"areacode: \" ++ (show (areacode result))\n    putStrLn $ \"weatherstationcode: \" ++ (show (weatherstationcode result))\n    putStrLn $ \"weatherstationname: \" ++ (show (weatherstationname result))\n    putStrLn $ \"mcc: \" ++ (show (mcc result))\n    putStrLn $ \"mnc: \" ++ (show (mnc result))\n    putStrLn $ \"mobilebrand: \" ++ (show (mobilebrand result))\n    putStrLn $ \"elevation: \" ++ (show (elevation result))\n    putStrLn $ \"usagetype: \" ++ (show (usagetype result))\n</code></pre>\n\n<p>You'll need to install the IP2Location package using cabal:</p>\n\n<pre><code>cabal install IP2Location\n</code></pre>\n\n<p>Hackage page: <a href=\"https://hackage.haskell.org/package/ip2location-8.0.4/docs/IP2Location.html\" rel=\"nofollow\">https://hackage.haskell.org/package/ip2location-8.0.4/docs/IP2Location.html</a></p>\n"}], "owner": {"reputation": 1, "user_id": 4902285, "user_type": "registered", "profile_image": "https://graph.facebook.com/369822999891331/picture?type=large", "display_name": "Gennie Candy", "link": "https://stackoverflow.com/users/4902285/gennie-candy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1476753214, "creation_date": 1431660424, "last_edit_date": 1431665970, "question_id": 30251045, "link": "https://stackoverflow.com/questions/30251045/query-ip2location-lite-binary-databases-using-haskell", "title": "Query IP2Location LITE binary databases using Haskell?", "body": "<p>I would like to use Haskell to query the IP2Location LITE binary databases from <a href=\"http://lite.ip2location.com/databases\" rel=\"nofollow\">here</a>. So I am wondering if there are any existing modules or codes to read the databases?</p>\n"}, {"tags": ["haskell", "monads", "typeclass", "functor", "applicative"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1431648071, "post_id": 30249108, "comment_id": 48599279, "body": "<code>unwrap</code> describes a behaviour that none of <code>Monad</code>&#39;s methods implement; if that weren&#39;t the case, <code>unwrap</code> would allow you to extract an <code>a</code> from an <code>IO a</code> computation (like <code>unsafePerformIO</code> does), which would defeat the purpose of having an <code>IO</code> monad in the first place. A class can only be less powerful/expressive than its subclasses."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1431649391, "post_id": 30249108, "comment_id": 48599640, "body": "What will be definition of <code>unwrap</code> for <code>Nothing</code> when defining instance for <code>Maybe</code> type ?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 3, "creation_date": 1431651451, "post_id": 30249108, "comment_id": 48600137, "body": "@Sibi Simple, there is no instance for Maybe. I don&#39;t think he claimed there was. Also, I doubt Wrapper implies Monad without any laws (other than the free ones) on it."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 2, "creation_date": 1431653630, "post_id": 30249108, "comment_id": 48600776, "body": "@Jubobs Nevertheless, Luka&#39;s actual claim (which was that anything that can be made an instance of <code>Wrapper</code> and satisfy a few obvious laws can also be made an instance of <code>Monad</code> in a mechanical way) is correct."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1431684925, "post_id": 30249108, "comment_id": 48613577, "body": "Implementing all superclasses at once by giving an instance for a subclass is possible in <a href=\"https://github.com/Frege/frege\" rel=\"nofollow noreferrer\">github.com/Frege/frege</a>. This is especially useful in cases where the subclass has default implementations for superclass functions, which is also supported. OTOH, Frege supports only single parameter type classes &#225; la Haskell 2010."}], "answers": [{"comments": [{"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 0, "creation_date": 1431675131, "post_id": 30250006, "comment_id": 48608004, "body": "Thanks for answering. Everything makes sense. It might be worth noting that as of GHC 7.10, <code>OverlappingInstances</code> and <code>IncoherentInstances</code> are deprecated in favor of per-instance pragma deflarations <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/type-class-extensions.html#instance-overlap\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/users_guide/&hellip;</a>"}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 0, "creation_date": 1431696682, "post_id": 30250006, "comment_id": 48621425, "body": "Hey, I just realized. To write the default signature, <code>Applicative</code> needs to know about <code>Monad</code>, but since <code>Applicative</code> is a superclass of <code>Monad</code>, <code>Monad</code> needs to know about <code>Applicative</code>. Doesn&#39;t this mean that you can only use <code>DefaultSignatures</code> if all of your typeclasses are in the same file?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 0, "creation_date": 1431710303, "post_id": 30250006, "comment_id": 48630546, "body": "@LukaHorvat The Haskell Report explicitly allows recursive imports. (However, implementations generally require you to jump through some extra hoops if you try to use this feature; e.g. GHC requires .hs-boot files to break any import cycle.)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 12, "last_activity_date": 1431652523, "creation_date": 1431652523, "answer_id": 30250006, "question_id": 30249108, "link": "https://stackoverflow.com/questions/30249108/why-are-instances-matched-only-by-their-heads/30250006#30250006", "title": "Why are instances matched only by their heads?", "body": "<p>There's a lot of questions rolled into one here. But let's take them one at a time.</p>\n\n<p>First: why doesn't the compiler look at instance contexts when choosing which instance to use? This is to keep instance search efficient. If you require the compiler to consider only instances whose instance heads are satisfied, you essentially end up requiring your compiler to do back-tracking search among all possible instances, at which point you have implemented 90% of Prolog. If, on the other hand, you take the stance (as Haskell does) that you look only at instance heads when choosing which instance to use, and then simply enforce the instance context, there is no backtracking: at every moment, there is only one choice you can make.</p>\n\n<p>Next: why can't you have one class be a superclass of another one, and provide a default implementation of the subclass? There is no fundamental reason for this restriction, so GHC offers this feature as an extension. You could write something like this:</p>\n\n<pre><code>{-# LANGUAGE DefaultSignatures #-}\nclass Applicative f where\n    pure :: a -&gt; f a\n    (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n\n    default pure :: Monad f =&gt; a -&gt; f a\n    default (&lt;*&gt;) :: Monad f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b\n    pure = return\n    (&lt;*&gt;) = ap\n</code></pre>\n\n<p>Then once you had provided an <code>instance Monad M where ...</code>, you could simply write <code>instance Applicative M</code> with no <code>where</code> clause and have it Just Work. I don't really know why this wasn't done in the standard library.</p>\n\n<p>Last: why can't the compiler allow many instances and just pick the most specific one? The answer to this one is sort of a mix of the previous two: there are very good fundamental reasons this doesn't work well, yet GHC nevertheless offers an extension that does it. The fundamental reason this doesn't work well is that the most specific instance for a given value can't be known before runtime. GHC's answer to this is, for polymorphic values, to pick the most specific one compatible with the full polymorphism available. If later that thing thing gets monomorphised, well, too bad for you. The result of this is that some functions may operate on some data with one instance and others may operate on that same data with another instance; this can lead to very subtle bugs. If after all this discussion you still think that's a good idea, and refuse to learn from the mistakes of others, you can turn on <code>IncoherentInstances</code>.</p>\n\n<p>I think that covers all the questions.</p>\n"}, {"comments": [{"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "edited": false, "score": 0, "creation_date": 1431681678, "post_id": 30250736, "comment_id": 48611498, "body": "Thank you for answering."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 4, "last_activity_date": 1431659117, "last_edit_date": 1431659117, "creation_date": 1431658100, "answer_id": 30250736, "question_id": 30249108, "link": "https://stackoverflow.com/questions/30249108/why-are-instances-matched-only-by-their-heads/30250736#30250736", "title": "Why are instances matched only by their heads?", "body": "<p>Consistency and separate compilation.</p>\n\n<p>If we have two instances whose heads both match, but have different constraints, say:</p>\n\n<pre><code>-- File: Foo.hs\n\ninstance Monad m =&gt; Applicative m\ninstance            Applicative Foo\n</code></pre>\n\n<p>Then either this is valid code producing an <code>Applicative</code> instance for <code>Foo</code>, or it's an error producing two different <code>Applicative</code> instances for <code>Foo</code>. Which one it is <em>depends on whether a monad instance exists for <code>Foo</code></em>. That's a problem, because it's difficult to guarantee that knowledge about whether <code>Monad Foo</code> holds will make it to the compiler when it's compiling this module.</p>\n\n<p>A different module (say <code>Bar.hs</code>) may produce a <code>Monad</code> instance for <code>Foo</code>. If <code>Foo.hs</code> doesn't import that module (even indirectly), then how is the compiler to know? Worse, we can <em>change</em> whether this is an error or a valid definition by changing whether we later include <code>Bar.hs</code> in the final program or not!</p>\n\n<p>For this to work, we'd need to know that all instances that exist in the final compiled program are visible in every module, which leads to the conclusion that every module is a dependency of every other module <em>regardless of whether the module actually imports the other</em>. You'd have to go quite far along the path to requiring whole-program-analysis to support such a system, which makes distributing pre-compiled libraries difficult to impossible.</p>\n\n<p>The only way to avoid this is to never have GHC make decisions based on <em>negative information</em>. You can't choose an instance based on the <strong>non</strong>-existence of another instance.</p>\n\n<p>This means that the constraints on an instance have to be ignored for instance resolution. You need to select an instance regardless of whether the constraints hold; if that leaves more than one possibly-applicable instance, then you would need negative information (namely that all but one of them require constraints that do not hold) to accept the code as valid.</p>\n\n<p>If you have only one instance that's even a candidate, and you can't see a proof of its constraints, you can accept the code by just passing the constraints on to where the instance is used (we can rely on getting this information to other modules, because they'll have to import this one, even if only indirectly); if <em>those</em> positions can't see a required instance either, then they'll generate an appropriate error about an unsatisfied constraint.</p>\n\n<p>So by ignoring the constraints, we ensure that a compiler can make correct decisions about instances even by only knowing about other modules that it imports (transitively); it doesn't have to know about everything that's defined in every other module in order to know which constraints <em>do not</em> hold.</p>\n"}], "owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 30250006, "answer_count": 2, "score": 8, "last_activity_date": 1431659117, "creation_date": 1431645974, "question_id": 30249108, "link": "https://stackoverflow.com/questions/30249108/why-are-instances-matched-only-by-their-heads", "title": "Why are instances matched only by their heads?", "body": "<p>I'll start by introducing a concrete problem (StackOverflow guys like that).\nSay you define a simple type</p>\n\n<pre><code>data T a = T a\n</code></pre>\n\n<p>This type is a <code>Functor</code>, <code>Applicative</code> and a <code>Monad</code>. Ignoring automatic deriving, to get those instances you have to write each one of them, even though <code>Monad</code> implies <code>Applicative</code>, which implies <code>Functor</code>.\nMore than that, I could define a class like this</p>\n\n<pre><code>class Wrapper f where\n    wrap   :: a -&gt; f a\n    unwrap :: f a -&gt; a\n</code></pre>\n\n<p>This is a pretty strong condition and it definitely implies <code>Monad</code>, but I can't write</p>\n\n<pre><code>instance Wrapper f =&gt; Monad f where\n    return = wrap\n    fa &gt;&gt;= f = f $ unwrap fa\n</code></pre>\n\n<p>because this, for some reason, means \"everything is a <code>Monad</code> (every <code>f</code>), only if it's a <code>Wrapper</code>\", instead of \"everything that's a <code>Wrapper</code> is a <code>Monad</code>\".</p>\n\n<p>Similarly you can't define the <code>Monad a =&gt; Applicative a</code> and <code>Applicative a =&gt; Functor a</code> instances.</p>\n\n<p>Another thing you can't do (which is only probably related, I really don't know) is have one class be a superclass of another one, and provide a default implementation of the subclass. Sure, it's great that <code>class Applicative a =&gt; Monad a</code>, but it's much less great that I still have to define the <code>Applicative</code> instance before I can define the <code>Monad</code> one.</p>\n\n<p>This isn't a rant. I wrote a lot because otherwise this would quickly the marked as \"too broad\" or \"unclear\". The question boils down to the title.\nI know (at least I'm pretty sure) that there is some theoretical reason for this, so I'm wondering what exactly are the benefits here.</p>\n\n<p>As a sub question, I would like to ask if there are viable alternatives that still keep all (or most) of those advantages, but allow what I wrote.</p>\n\n<p>Addition:\nI suspect one of the answers might be something along the lines \"What if my type is a <code>Wrapper</code>, but I don't want to use the <code>Monad</code> instance that that implies?\". To this I ask, why couldn't the compiler just pick the most specific one? If there is an <code>instance Monad MyType</code>, surely it's more specific than <code>instance Wrapper a =&gt; Monad a</code>.</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1431653780, "post_id": 30248909, "comment_id": 48600825, "body": "emacs haskell-mode does that for me, but I don&#39;t know of a general solution."}, {"owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1431655517, "post_id": 30248909, "comment_id": 48601294, "body": "@ReinHenrichs I think that the code for the feature you mentioned is this  <a href=\"https://github.com/haskell/haskell-mode/blob/7100354a16a0502ed1730d1dfd1e3b9776969041/haskell-cabal.el\" rel=\"nofollow noreferrer\">haskell-mode at github, search for defun haskell-cabal-section-add-build-dependency</a>. I wonder if the contributors of cabal made something similar."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 4, "creation_date": 1431661708, "post_id": 30248909, "comment_id": 48602817, "body": "Automatically? Based on what? Surely you don&#39;t want ALL your installed packages in your build-depends?"}, {"owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1431686819, "post_id": 30248909, "comment_id": 48614780, "body": "@Cubic Take, for instance, the <a href=\"http://hackage.haskell.org/package/yesod-core-1.4.9.1/src/\" rel=\"nofollow noreferrer\">yesod-core .cabal file</a>. It&#39;s build-depends list 47 packages, some with version constraints. Did the author had to include them all by hand, writting them on the .cabal file himself, or did cabal help him with that?"}, {"owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "edited": false, "score": 1, "creation_date": 1431696866, "post_id": 30248909, "comment_id": 48621552, "body": "They were probably added by hand. You can see the history of that file on GitHub: <a href=\"https://github.com/yesodweb/yesod/commits/master/yesod-core/yesod-core.cabal\" rel=\"nofollow noreferrer\">github.com/yesodweb/yesod/commits/master/yesod-core/&hellip;</a>"}, {"owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "reply_to_user": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "edited": false, "score": 0, "creation_date": 1431699309, "post_id": 30248909, "comment_id": 48623358, "body": "@TaylorFausak Thanks, but how do you know that the changes were added by hand?"}, {"owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "edited": false, "score": 0, "creation_date": 1431704896, "post_id": 30248909, "comment_id": 48627220, "body": "I don&#39;t. I&#39;m guessing based on my experience with Cabal files in my own projects."}, {"owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "edited": false, "score": 2, "creation_date": 1431705042, "post_id": 30248909, "comment_id": 48627327, "body": "Also it&#39;s worth noting that <a href=\"http://www.mew.org/~kazu/proj/cab/en/\" rel=\"nofollow noreferrer\">Cab</a> (a wrapper around Cabal) does not have this feature. There is <a href=\"https://github.com/kazu-yamamoto/cab/issues/12\" rel=\"nofollow noreferrer\">an issue</a> for it, though."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 4, "last_activity_date": 1517907678, "creation_date": 1517907678, "answer_id": 48639072, "question_id": 30248909, "link": "https://stackoverflow.com/questions/30248909/cabal-how-to-automatically-update-the-build-depends-field-in-the-cabal-file/48639072#48639072", "title": "cabal: how to automatically update the build-depends field in the .cabal file?", "body": "<p>There are two tools in modern <code>cabal-install</code> for aiding with managing bounds of dependencies. First is <code>gen-bounds</code> which suggests proper version-ranges for packages based on the specifications of versions currently installed. The second is <code>outdated</code>, which lists dependencies in the <code>cabal</code> file for which newer versions exist on <code>hackage</code>. Both are documented in the cabal manual: <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#generating-dependency-version-bounds\" rel=\"nofollow noreferrer\">https://www.haskell.org/cabal/users-guide/developing-packages.html#generating-dependency-version-bounds</a></p>\n"}, {"tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": false, "score": 0, "last_activity_date": 1519670467, "creation_date": 1519670467, "answer_id": 48995014, "question_id": 30248909, "link": "https://stackoverflow.com/questions/30248909/cabal-how-to-automatically-update-the-build-depends-field-in-the-cabal-file/48995014#48995014", "title": "cabal: how to automatically update the build-depends field in the .cabal file?", "body": "<p>A possible alternative is to use hpack, yaml, sponge and jq:</p>\n\n<p>You will need hpack package.yaml file.</p>\n\n<p>For example to add <code>aeson</code> as a dependency:</p>\n\n<pre><code>cp package.yaml package.yaml.backup &amp;&amp; (yaml2json package.yaml | jq '.dependencies += [\"aeson\"]' | json2yaml | sponge package.yaml ) &amp;&amp; hpack\n</code></pre>\n"}], "owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1537, "favorite_count": 2, "answer_count": 2, "score": 21, "last_activity_date": 1519670467, "creation_date": 1431644707, "last_edit_date": 1507716150, "question_id": 30248909, "link": "https://stackoverflow.com/questions/30248909/cabal-how-to-automatically-update-the-build-depends-field-in-the-cabal-file", "title": "cabal: how to automatically update the build-depends field in the .cabal file?", "body": "<p>Is there a way to automatically update the <em>build-depends</em> field in the <em>.cabal-file</em>? For example, if we start with the following <code>.cabal</code> file:</p>\n\n<pre><code>name:           HUnit\nversion:        1.1.1\nsynopsis:       A unit testing framework for Haskell\nhomepage:       http://hunit.sourceforge.net/\ncategory:       Testing\nauthor:         Dean Herington\nlicense:        BSD3\nlicense-file:   LICENSE\ncabal-version:  &gt;= 1.10\nbuild-type:     Simple\n\nlibrary\n  build-depends:      base &gt;= 2 &amp;&amp; &lt; 4\n  exposed-modules:    Test.HUnit.Base, Test.HUnit.Lang,\n                      Test.HUnit.Terminal, Test.HUnit.Text, Test.HUnit\n  default-extensions: CPP\n</code></pre>\n\n<p>Then, install a package:</p>\n\n<pre><code>cabal install warp\n</code></pre>\n\n<p>Now, I have to add <code>warp &gt;=3.0 &amp;&amp; &lt;3.1</code> to the <code>build-depends</code> field, to make the file look like this:</p>\n\n<pre><code>name:           HUnit\nversion:        1.1.1\nsynopsis:       A unit testing framework for Haskell\nhomepage:       http://hunit.sourceforge.net/\ncategory:       Testing\nauthor:         Dean Herington\nlicense:        BSD3\nlicense-file:   LICENSE\ncabal-version:  &gt;= 1.10\nbuild-type:     Simple\n\nlibrary\n  build-depends:      base &gt;= 2 &amp;&amp; &lt; 4, warp &gt;=3.0 &amp;&amp; &lt;3.1\n  exposed-modules:    Test.HUnit.Base, Test.HUnit.Lang,\n                      Test.HUnit.Terminal, Test.HUnit.Text, Test.HUnit\n  default-extensions: CPP\n</code></pre>\n\n<p>My question is: how do we update this file automatically?</p>\n"}, {"tags": ["haskell", "memoization"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1431637063, "post_id": 30246931, "comment_id": 48595321, "body": "There are many, many memoization packages on <a href=\"http://hackage.haskell.org/packages/\" rel=\"nofollow noreferrer\">Hackage</a>."}, {"owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1431638471, "post_id": 30246931, "comment_id": 48596038, "body": "Thanks!  I&#39;m going to check them"}], "owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1431635996, "creation_date": 1431635996, "last_edit_date": 1486652996, "question_id": 30246931, "link": "https://stackoverflow.com/questions/30246931/memoization-in-recursive-expressions-using-a-map", "title": "Memoization in recursive expressions using a Map", "body": "<p>I'm calculating some recursive expressions that are of the form,</p>\n\n<p><img src=\"https://latex.codecogs.com/gif.latex?let%5C%20%5Cboldsymbol%7BV%7D%20%3D%20%5Cboldsymbol%7B%5Chat%7Bx%7D%7DX%20&plus;%20%5Cboldsymbol%7B%5Chat%7By%7D%7DY%20&plus;%20%5Cboldsymbol%7B%5Chat%7Bz%7D%7DZ%20%5Cnewline%20%5Cboldsymbol%7BR%7D_%7B000%7D%5E%7Bn%7D%20%28%5Cboldsymbol%7BV%7D%29%20%3D%20someFunction%28n%2C%5Cboldsymbol%7BV%7D%29%20%5Cnewline%20%5Cboldsymbol%7BR%7D_%7Bt&plus;1%2Cu%2Cv%7D%5E%7Bn%7D%20%28%5Cboldsymbol%7BV%7D%29%20%3Dt%5Cboldsymbol%7BR%7D_%7Bt-1%2Cu%2Cv%7D%5E%7Bn-1%7D%20%28%5Cboldsymbol%7BV%7D%29%20&plus;%20X%5Cboldsymbol%7BR%7D_%7Btuv%7D%5E%7Bn&plus;1%7D%20%28%5Cboldsymbol%7BV%7D%29%20%5Cnewline%20%5Cboldsymbol%7BR%7D_%7Bt%2Cu&plus;1%2Cv%7D%5E%7Bn%7D%20%28%5Cboldsymbol%7BV%7D%29%20%3Du%5Cboldsymbol%7BR%7D_%7Bt%2Cu-1%2Cv%7D%5E%7Bn-1%7D%20%28%5Cboldsymbol%7BV%7D%29%20&plus;%20Y%5Cboldsymbol%7BR%7D_%7Btuv%7D%5E%7Bn&plus;1%7D%20%28%5Cboldsymbol%7BV%7D%29%20%5Cnewline%20%5Cboldsymbol%7BR%7D_%7Bt%2Cu%2Cv&plus;1%7D%5E%7Bn%7D%20%28%5Cboldsymbol%7BV%7D%29%20%3Dv%5Cboldsymbol%7BR%7D_%7Bt%2Cu%2Cv-1%7D%5E%7Bn-1%7D%20%28%5Cboldsymbol%7BV%7D%29%20&plus;%20Z%5Cboldsymbol%7BR%7D_%7Btuv%7D%5E%7Bn&plus;1%7D%20%28%5Cboldsymbol%7BV%7D%29\" alt=\"Where\"></p>\n\n<p>Now, let suppose that I have a list of indexes <em>t,u,v</em> <code>([t,u,v]::Int)</code> that for simplicity we can represent as <code>[[Int]]</code>, and I want to calculate the <strong>R</strong> function for each index <code>[t,u,v]</code> using something similar to the following code:</p>\n\n<pre><code>import qualified Data.Vector.Unboxed as U\nimport qualified Data.Map.Strict as M\n\ndata HermiteStateIntegral = HermiteStateIntegral {\n               getmapI :: M.Map [Int] Double\n              ,getkeyI :: [[Int]]\n               } deriving Show\n\ncalcIntegrals :: [Double] -&gt;[[Int]] -&gt; Double -&gt; Vector Double\ncalcIntegrals vs listIndex f0 = U.unfoldr (calcRecExpr vs) seedI\nseedI     = HermiteStateIntegral mapI0 listIndex\nmapI0     = M.insert [0,0,0] f0 M.empty\n\ncalcRecExpr :: [Double] -&gt; HermiteStateIntegral -&gt; Maybe (Double,HermiteStateIntegral)\ncalcRecExpr vs hs@(HermiteStateIntegral m is)= do\n           i &lt;- safeHead is -- safeHead :: [a] -&gt; Maybe a\n           -- if the value associated with the indexes t,u,v is not in the map\n           -- calculate it using the recursive equations\n           let Just (val,newMap) = (lookupM i m) `mplus` (fun vs i m)\n               newSt = hs{getmapI = newMap,getkeyI = tail is}\n           return (val,newSt)\n\n\n where lookupM :: Ord k =&gt; k -&gt; M.Map k a -&gt; Maybe (a , M.Map k a)\n       lookupM k m = do \n          val &lt;- M.lookup k m\n          return (val,m)  \n\nfun :: [Double] -&gt; [Int] -&gt;  M.Map [Int] Double -&gt; Maybe (Double, M.Map [Int] Double)\nfun vs i m = -- fun computes the value associated with some index [t,u,v]\n             -- that is not in the Map, using the recursive equations. And   \n             -- insert this value on the Map.\n</code></pre>\n\n<p>So, I am using a <code>Map</code> to explicitly store the <strong>R</strong> subexpressions. If I want to calculate for example the index [1,1,1] the Map will store the indexes [0,1,1],[0,0,1],[0,0,0] that I can use in future calculations.</p>\n\n<p>My questions are there: Is this an efficient implementation for explicitly caching the subexpression of <strong>R</strong> ? Is it there a more efficient way to express memoization using lazy evaluation?</p>\n"}, {"tags": ["haskell", "frp"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 3, "creation_date": 1431633258, "post_id": 30245961, "comment_id": 48593219, "body": "Do you want to <i>model</i> the time events, or you want the time events?"}, {"owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1431633782, "post_id": 30245961, "comment_id": 48593565, "body": "Sounds like you might enjoy Erlang a bit more for this task...."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1431640112, "post_id": 30245961, "comment_id": 48596783, "body": "<a href=\"http://conal.net/papers/push-pull-frp/push-pull-frp.pdf\" rel=\"nofollow noreferrer\"><i>Push-Pull FRP</i></a> describes an efficient implementation of <code>Event</code> and <code>Behaviour</code> (as well as a formal semantics for each)."}], "answers": [{"tags": [], "owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "is_accepted": false, "score": 3, "last_activity_date": 1431640340, "last_edit_date": 1431640340, "creation_date": 1431639863, "answer_id": 30247905, "question_id": 30245961, "link": "https://stackoverflow.com/questions/30245961/how-do-i-model-time-based-events-in-haskell/30247905#30247905", "title": "How do I model time-based events in haskell?", "body": "<p>If I understand you correctly, this sounds like a job for <code>Control.Concurrent</code>. The parts you'd use would be <code>forkIO</code> to spawn one of haskell's lightweight threads to handle your timing loop, and a <code>Chan</code> to receive timing signals.</p>\n\n<pre><code>import Control.Concurrent\nimport Control.Concurrent.Chan\nimport Control.Monad (forever)\n\nmain = do\n  -- channel to receive messages from the timing thread\n  chan &lt;- newChan :: IO (Chan String)\n\n  -- spawn a new thread to send periodic signals\n  forkIO $ forever $ do\n    writeChan chan \"hi!\"\n    threadDelay $ 1 * 1000 * 1000 -- delay in microseconds\n\n  -- in the main thread, listen for messages from the chan.\n  forever $ readChan chan &gt;&gt;= print \n</code></pre>\n\n<p>To expand on this, instead of writing <code>String</code>s to the <code>Chan</code> you could make an ADT for your events, something like:</p>\n\n<pre><code>data Event = CheckEvent | SwitchEvent deriving Show\n</code></pre>\n\n<p>And then have your listening thread do different things based on the event type.</p>\n"}], "owner": {"reputation": 2510, "user_id": 47481, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/621e0dd83466aef9e4d7a4d1ae7cb7f1?s=128&d=identicon&r=PG", "display_name": "Darren", "link": "https://stackoverflow.com/users/47481/darren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1431640340, "creation_date": 1431632549, "question_id": 30245961, "link": "https://stackoverflow.com/questions/30245961/how-do-i-model-time-based-events-in-haskell", "title": "How do I model time-based events in haskell?", "body": "<p>I'm building a queue multiplexer in haskell, partly as a way to learn and partly as a replacement for some dodgy shell scripts.</p>\n\n<p>What it does is periodically connect to each queue (we're using rabbitmq) in turn to measure the queue depth. If the main system is currently consuming from a queue and that queue has messages, we do nothing. If the connected queue is empty we switch to the queue with the most messages on it. If all queues are empty we do nothing.  So far so good.</p>\n\n<p>I also need a time-based switch, such that if the main application has been connected to a queue for more than 1 hour and the queue is empty, then switch even if all other queues are empty.</p>\n\n<p>I'm thinking that I want something that emits events periodically that will trigger the next cycle of behavior, something like 'check' events every minute and 'time-switch' events every hour.</p>\n\n<p>Is there an idiomatic way to model time-based events in haskell?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 9, "last_activity_date": 1536010852, "last_edit_date": 1536010852, "creation_date": 1431631088, "answer_id": 30245547, "question_id": 30245108, "link": "https://stackoverflow.com/questions/30245108/haskell-flipping-a-curried-dollar-operator/30245547#30245547", "title": "Haskell: Flipping a curried dollar operator", "body": "<p>Follow the types:</p>\n\n<pre><code>($ 5) :: (Int -&gt; a) -&gt; a\nflip  :: (x -&gt; y -&gt; z) -&gt; y -&gt; x -&gt; z\n</code></pre>\n\n<p>But since <code>-&gt;</code> is right associative, the type <code>x -&gt; y -&gt; z</code> is equivalent to <code>x -&gt; (y -&gt; z)</code>, so</p>\n\n<pre><code>flip  :: (x         -&gt; (y -&gt; z)) -&gt; y -&gt; x -&gt; z\n($ 5) :: (Int -&gt; a) -&gt; a\n</code></pre>\n\n<p>So <code>x ~ (Int -&gt; a)</code> and <code>(y -&gt; z) ~ a</code>, so substituting back in:</p>\n\n<pre><code>($ 5) :: (Int -&gt; (y -&gt; z)) -&gt; (y -&gt; z)\n</code></pre>\n\n<p>And simplified</p>\n\n<pre><code>($ 5) :: (Int -&gt; y -&gt; z) -&gt; y -&gt; z\n</code></pre>\n\n<p>So</p>\n\n<pre><code>flip ($ 5) :: y -&gt; (Int -&gt; y -&gt; z) -&gt; z\n</code></pre>\n\n<p>Which is equivalent to the type you're seeing (although I used <code>Int</code> instead of <code>Integer</code> to save typing).</p>\n\n<p>What this is saying is that the type of <code>($ 5)</code> gets specialized when passed to <code>flip</code> such that it takes a function of 2 arguments.  It is perfectly valid to have something like <code>($ 5) const</code>, where <code>const :: a -&gt; b -&gt; a</code> and <code>($ 5) const :: b -&gt; Int</code>.  All <code>($ 5)</code> is doing is applying <code>5</code> as <em>an</em> argument to a function, not necessarily <em>the</em> argument for a function.  This is an example of partial application, where not all of the arguments are supplied to a function.  That's why you can do things like <code>map (subtract 1) [1, 2, 3]</code>.</p>\n\n<p>An example of how to use <code>flip ($ 5)</code> is:</p>\n\n<pre><code>&gt; flip ($ 5) 2 (**)\n25.0\n&gt; flip ($ 5) 1 (-)\n4.0\n&gt; let f x y = (x, y)\n&gt; flip ($ 5) 1 f\n(5, 1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4521, "user_id": 4137738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3249bb96d79f6162b498803fc90860ab?s=128&d=identicon&r=PG&f=1", "display_name": "wmk", "link": "https://stackoverflow.com/users/4137738/wmk"}, "is_accepted": false, "score": 1, "last_activity_date": 1431631609, "creation_date": 1431631609, "answer_id": 30245685, "question_id": 30245108, "link": "https://stackoverflow.com/questions/30245108/haskell-flipping-a-curried-dollar-operator/30245685#30245685", "title": "Haskell: Flipping a curried dollar operator", "body": "<p>the function <code>flip</code> flips the order of the arguments, so all of these are equal:</p>\n\n<pre><code>f (\\x y -&gt; x:y) [2, 4, 6]\n</code></pre>\n\n<blockquote>\n  <p>[5,2,4,6]</p>\n</blockquote>\n\n<pre><code>flip f  [2, 4, 6] (\\x y -&gt; x:y)\n</code></pre>\n\n<blockquote>\n  <p>[5,2,4,6]</p>\n</blockquote>\n\n<pre><code>g [2, 4, 6] (\\x y -&gt; x:y)\n</code></pre>\n\n<blockquote>\n  <p>[5,2,4,6]</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1431633123, "last_edit_date": 1431633123, "creation_date": 1431632510, "answer_id": 30245948, "question_id": 30245108, "link": "https://stackoverflow.com/questions/30245108/haskell-flipping-a-curried-dollar-operator/30245948#30245948", "title": "Haskell: Flipping a curried dollar operator", "body": "<p>The confusion arises from the loose concept of \"number of arguments\" for polymorphic functions. For instance, it is tempting to say that</p>\n\n<pre><code>f :: (Integer -&gt; b) -&gt; b\n</code></pre>\n\n<p>has one argument (a function). Yet, a more precise statement would be that <code>f</code> is a function with <em>at least</em> one argument. This is because the type variable <code>b</code> can be substituted with any type, thanks to polymorphism, giving rise to e.g.</p>\n\n<pre><code>f :: (Integer -&gt; String) -&gt; String\nf :: (Integer -&gt; Double) -&gt; Double\n...\n</code></pre>\n\n<p>which are indeed functions with one argument, but <em>also</em> to, e.g.</p>\n\n<pre><code>f :: (Integer -&gt; (String -&gt; Double)) -&gt; (String -&gt; Double)\n</code></pre>\n\n<p>where <code>b</code> has been replaced with a functional type <code>String -&gt; Double</code>. This substitution makes a second argument \"appear\" in an apparently magic way: <code>f</code> can take a first argument (a binary function <code>Integer -&gt; String -&gt; Double</code>), and then a second one (a <code>String</code>), before returning a <code>Double</code>.</p>\n\n<p>Note that this phenomenon always appears when a polymorphic type ends with <code>... -&gt; b</code> for some type variable <code>b</code>.</p>\n\n<p>Let me conclude with a trivia: how \"many\" arguments has the identity function <code>id</code>? Well, intuitively I would say <em>one</em>, but let me check ...</p>\n\n<pre><code>&gt; id (+) 3 4\n7\n&gt; id id id id id (+) 3 4\n7\n</code></pre>\n\n<p>... and perhaps <em>many</em> is a better answer.</p>\n"}], "owner": {"reputation": 766, "user_id": 398206, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cdc3a8f8ea67905801f3a0d8df94b2de?s=128&d=identicon&r=PG", "display_name": "AmirW", "link": "https://stackoverflow.com/users/398206/amirw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 30245547, "answer_count": 3, "score": 12, "last_activity_date": 1536010852, "creation_date": 1431629587, "last_edit_date": 1431632506, "question_id": 30245108, "link": "https://stackoverflow.com/questions/30245108/haskell-flipping-a-curried-dollar-operator", "title": "Haskell: Flipping a curried dollar operator", "body": "<p>Say I define this function:</p>\n\n<pre><code>f = ($ 5)\n</code></pre>\n\n<p>Then I can apply it:</p>\n\n<pre><code>&gt; f (\\x -&gt; x ^ 2)\n25\n</code></pre>\n\n<p>Its type is:</p>\n\n<pre><code>:t f\nf :: (Integer -&gt; b) -&gt; b\n</code></pre>\n\n<p>Which makes sense, it gets a function as an argument, and returns this function applied on the <code>Integer</code> <code>5</code>.</p>\n\n<p>Now I define this function:</p>\n\n<pre><code>g = flip f\n</code></pre>\n\n<p>I would expect this to not make sense, because <code>f</code> is a function of a single argument.</p>\n\n<p>But, checking its type:</p>\n\n<pre><code>:t g\ng :: b -&gt; (Integer -&gt; b -&gt; c) -&gt; c\n</code></pre>\n\n<p>So now <code>g</code> is a function of 2 arguments!</p>\n\n<p>Applying it on some values:</p>\n\n<pre><code>&gt; g [2, 4, 6] (\\x y -&gt; x:y)\n[5,2,4,6]\n</code></pre>\n\n<p>What is going on here? What does <code>flip ($ 5)</code> really mean? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 0, "creation_date": 1431629700, "post_id": 30244831, "comment_id": 48591186, "body": "Always try your SPOJ code on <a href=\"https://ideone.com/\" rel=\"nofollow noreferrer\">ideone</a>. They are using the same engine, but here you&#39;ll get detailed compiler output."}], "answers": [{"tags": [], "owner": {"reputation": 326, "user_id": 3367994, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cf2923d974f73ea2cc17787af58ea4a0?s=128&d=identicon&r=PG&f=1", "display_name": "Unknown User", "link": "https://stackoverflow.com/users/3367994/unknown-user"}, "is_accepted": true, "score": 1, "last_activity_date": 1431628766, "creation_date": 1431628766, "answer_id": 30244854, "question_id": 30244831, "link": "https://stackoverflow.com/questions/30244831/haskell-spoj-code-test/30244854#30244854", "title": "Haskell \u2013 SPOJ \u2013 Code &#39;TEST&#39;", "body": "<p>I once had the same problem solving SPOJ problems. Your editor probably mixes tabs and spaces. Try to use spaces only and everything will work just fine.</p>\n"}, {"tags": [], "owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "is_accepted": false, "score": 1, "last_activity_date": 1431628790, "creation_date": 1431628790, "answer_id": 30244859, "question_id": 30244831, "link": "https://stackoverflow.com/questions/30244831/haskell-spoj-code-test/30244859#30244859", "title": "Haskell \u2013 SPOJ \u2013 Code &#39;TEST&#39;", "body": "<p>The problem is indentation, try this:</p>\n\n<pre><code>main = do input &lt;- getLine\n      if input == \"42\" \n         then putStr \"\" \n         else do putStrLn input\n              main\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4900979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bdfaee72868ea3226d2250797f13f59?s=128&d=identicon&r=PG&f=1", "display_name": "UsualStranger", "link": "https://stackoverflow.com/users/4900979/usualstranger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 30244854, "answer_count": 2, "score": 1, "last_activity_date": 1431628790, "creation_date": 1431628712, "question_id": 30244831, "link": "https://stackoverflow.com/questions/30244831/haskell-spoj-code-test", "title": "Haskell \u2013 SPOJ \u2013 Code &#39;TEST&#39;", "body": "<p>I am trying to solve the first SPOJ-problem in Haskell, but always end up having a parse error on input <code>if</code>. Is this a common problem?</p>\n\n<pre><code>main = do input &lt;- getLine\n      if input == \"42\" then putStr \"\" \n      else do putStrLn input\n              main\n</code></pre>\n"}, {"tags": ["haskell", "optimization", "garbage-collection", "ghc"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431628157, "post_id": 30244139, "comment_id": 48590290, "body": "Check whether the GC is actually <i>collecting</i> memory, and not merely wasting time (there should be some stat showing this), just to make sure there is nothing &quot;updating&quot; that huge vector (i.e., building a copy of it with just a small change)."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1431633062, "post_id": 30244139, "comment_id": 48593100, "body": "Is it a mutable or an immutable vector? Mutable objects can greatly degrade GC performance."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1431635756, "post_id": 30244139, "comment_id": 48594671, "body": "Your characterization of what the garbage collector is doing does not mesh well with my understanding of how GHC&#39;s garbage collector works. How certain are you that your claim that the &quot;GC is crazily scanning my vector even though it never changes&quot; is correct?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431636254, "post_id": 30244139, "comment_id": 48594918, "body": "I&#39;m not that certain actually. Also, I could try making a minimal file replicating the problem if you want."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 1, "creation_date": 1431637441, "post_id": 30244139, "comment_id": 48595511, "body": "Some example code would indeed help us to help you."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431642103, "post_id": 30244139, "comment_id": 48597626, "body": "Can I just lock this question til tomorrow/after somehow, though? I&#39;m working hard right now so I don&#39;t have the time to make it (and the original problematic file ihas a lot of personal deps, so you&#39;ll not be able to compile...)."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1431693767, "post_id": 30244139, "comment_id": 48619239, "body": "@JoachimBreitner and others, sorry for the delay. There it is."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1431699279, "post_id": 30244139, "comment_id": 48623334, "body": "Have you tried profiling? Also, are you sure that the vector is the problem? What if you replace <code>vec ! n</code> with <code>gen n</code>?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431701096, "post_id": 30244139, "comment_id": 48624665, "body": "Yep, the profiling didn&#39;t accuse anything other than the garbage collector. If I replace <code>vec ! n</code> by <code>gen n</code> the program will run smoothly, despite being obviously much &quot;worse&quot; since it creates a new map each frame - adding to the point the GC is the issue. (Note: on the actual code I obviously can&#39;t just replace it since the map generation isn&#39;t as trivial and is called much more often.)"}], "answers": [{"comments": [{"owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "edited": false, "score": 3, "creation_date": 1431661065, "post_id": 30249295, "comment_id": 48602643, "body": "I think you meant <code>-rtsopts</code>. <code>-with-rtsopts</code> bakes provided options in at compilation time."}], "tags": [], "owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "is_accepted": false, "score": 2, "last_activity_date": 1431647654, "last_edit_date": 1431647654, "creation_date": 1431647254, "answer_id": 30249295, "question_id": 30244139, "link": "https://stackoverflow.com/questions/30244139/how-to-keep-very-big-elements-on-memory-without-exhausting-the-garbage-collector/30249295#30249295", "title": "How to keep very big elements on memory without exhausting the garbage collector?", "body": "<p>I would try compiling <code>-with-rtsopts</code> and then playing with the heap (<code>-H</code>) and/or allocator (<code>-A</code>) options. Those greatly influence how the GC works.</p>\n\n<p>More info here: <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/runtime-control.html\" rel=\"nofollow\">https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/runtime-control.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1431725747, "post_id": 30268273, "comment_id": 48637914, "body": "@Michael, that&#39;s strange, I have not seen any version use more than about 1.2G."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1431728134, "post_id": 30268273, "comment_id": 48638809, "body": "@ReidBarton wow, I couldn&#39;t ask for a better and more informative answer. You nailed it. Thank you!"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 2, "creation_date": 1431728485, "post_id": 30268273, "comment_id": 48638909, "body": "No worries, I think about it sometimes too."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 4, "last_activity_date": 1431722006, "creation_date": 1431722006, "answer_id": 30268273, "question_id": 30244139, "link": "https://stackoverflow.com/questions/30244139/how-to-keep-very-big-elements-on-memory-without-exhausting-the-garbage-collector/30268273#30268273", "title": "How to keep very big elements on memory without exhausting the garbage collector?", "body": "<p>gloss is the culprit here.</p>\n\n<p>First, a little background on GHC's garbage collector. GHC uses (by default) a generational, copying garbage collector. This means that the heap consists of several memory areas called generations. Objects are allocated into the youngest generation. When a generation becomes full, it is scanned for live objects and the live objects are copied into the next older generation, and then the generation that was scanned is marked as empty. When the oldest generation becomes full, the live objects are instead copied into a new version of the oldest generation.</p>\n\n<p>An important fact to take away from this is that the GC only ever examines <em>live</em> objects. Dead objects are never touched at all. This is great when collecting generations that are mostly garbage, as often happens in the youngest generation. It's not good if long-lived data undergoes many GCs, as it will be copied repeatedly. (It can also be counterintuitive to those used to malloc/free-style memory management, where allocation and deallocation are both quite expensive, but leaving objects allocated for a long time has no direct cost.)</p>\n\n<p>Now, the \"generational hypothesis\" is that most objects are either short-lived or long-lived. The long-lived objects will quickly end up in the oldest generation since they are alive at every collection. Meanwhile, most of the short-lived objects that are allocated will never survive the youngest generation; only those that happen to be alive when it is collected will be promoted to the next generation. Similarly, most of those short-lived objects that do get promoted will not survive to the third generation. As a result, the oldest generation that holds the long-lived objects should fill up very slowly, and its expensive collections that have to copy all the long-lived objects should occur rarely.</p>\n\n<p>Now, all of this is actually true in your program, except for one problem:</p>\n\n<pre><code>    let displayFun backendRef = do\n            -- extract the current time from the state\n            timeS           &lt;- animateSR `getsIORef` AN.stateAnimateTime\n\n            -- call the user action to get the animation frame\n            picture         &lt;- frameOp (double2Float timeS)\n\n            renderS         &lt;- readIORef renderSR\n            portS           &lt;- viewStateViewPort &lt;$&gt; readIORef viewSR\n\n            windowSize      &lt;- getWindowDimensions backendRef\n\n            -- render the frame\n            displayPicture\n                    windowSize\n                    backColor\n                    renderS\n                    (viewPortScale portS)\n                    (applyViewPortToPicture portS picture)\n\n            -- perform GC every frame to try and avoid long pauses\n            performGC\n</code></pre>\n\n<p>gloss tells the GC to collect the oldest generation every frame!</p>\n\n<p>This might be a good idea if those collections are expected to take less time than the delay between frames anyways, but it's clearly not a good idea for your program. If you remove that <code>performGC</code> call from gloss, then your program runs quite quickly. Presumably if you let it run for long enough, then the oldest generation will eventually fill up and you might get a delay of a few tenths of a second as the GC copies all your long-lived data, but that's much better than paying that cost every frame.</p>\n\n<p>All that said, there is a ticket <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9052\" rel=\"nofollow\">#9052</a> about adding a stable generation, which would also suit your needs nicely. See there for more details.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 1859524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f190ea71082532c0f40c23b5ce319f79?s=128&d=identicon&r=PG", "display_name": "Luke Iannini", "link": "https://stackoverflow.com/users/1859524/luke-iannini"}, "is_accepted": false, "score": 1, "last_activity_date": 1457925006, "creation_date": 1457925006, "answer_id": 35978944, "question_id": 30244139, "link": "https://stackoverflow.com/questions/30244139/how-to-keep-very-big-elements-on-memory-without-exhausting-the-garbage-collector/35978944#35978944", "title": "How to keep very big elements on memory without exhausting the garbage collector?", "body": "<p>To add to Reid's answer, I've found <code>performMinorGC</code> (added in  <a href=\"https://ghc.haskell.org/trac/ghc/ticket/8257\" rel=\"nofollow\">https://ghc.haskell.org/trac/ghc/ticket/8257</a>) to be the best of both worlds here. </p>\n\n<p>Without any explicit GC scheduling,  I still get frequent collection-related frame drops as the nursery becomes exhausted. But <code>performGC</code> indeed becomes performance-killing as soon as there is any significant long-lived memory usage.</p>\n\n<p><code>performMinorGC</code> does what we want, ignoring long-term memory and cleaning up the garbage from each frame predictably - especially if you tune <code>-H</code> and <code>-A</code> to ensure that the per-frame garbage fits in the nursery.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 2, "accepted_answer_id": 30268273, "answer_count": 3, "score": 15, "last_activity_date": 1457925006, "creation_date": 1431626293, "last_edit_date": 1448478275, "question_id": 30244139, "link": "https://stackoverflow.com/questions/30244139/how-to-keep-very-big-elements-on-memory-without-exhausting-the-garbage-collector", "title": "How to keep very big elements on memory without exhausting the garbage collector?", "body": "<p>In Haskell, I created a Vector of 1000000 IntMaps. I then used Gloss to render a picture in a way that accesses random intmaps from that vector.<br>\nThat is, I had keep every single one of them in memory. The rendering function itself is very lightweight, so the performance was supposed to be good.<br>\nYet, the program was running at 4fps. Upon profiling, I noticed 95% of the time was spent on GC. Fair enough:<br>\nThe GC is crazily scanning my vector, even though it never changes.</p>\n\n<p>Is there any way to tell GHC <em>\"this big value is needed and will not change - do not try to collect anything inside it\"</em>.</p>\n\n<p>Edit: the program below is sufficient to replicate the issue.</p>\n\n<pre><code>import qualified Data.IntMap as Map\nimport qualified Data.Vector as Vec\nimport Graphics.Gloss\nimport Graphics.Gloss.Interface.IO.Animate\nimport System.Random\n\nmain = do\n    let size  = 10000000\n    let gen i = Map.fromList $ zip [mod i 10..0] [0..mod i 10]\n    let vec   = Vec.fromList $ map gen [0..size]\n    let draw t = do \n            rnd &lt;- randomIO :: IO Int\n            let empty = Map.null $ vec Vec.! mod rnd size\n            let rad   = if empty then 10 else 50\n            return $ translate (20 * cos t) (20 * sin t) (circle rad)\n    animateIO (InWindow \"hi\" (256,256) (1,1)) white draw\n</code></pre>\n\n<p>This accesses a random map on a huge vector and draws a rotating circle whose radius depend on whether the map is empty.<br>\nDespite that logic being very simple, the program struggles at around 1 FPS here.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 4, "creation_date": 1431623551, "post_id": 30243088, "comment_id": 48587590, "body": "What? Read <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">some material</a> first."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1431623568, "post_id": 30243088, "comment_id": 48587600, "body": "<code>(+3) (+3)</code> won&#39;t work, unless you&#39;ve made <code>a -&gt; a</code> a <code>Num</code> instance. That being said, if you&#39;re interested in definitions, you should have a look at the Haskell report."}, {"owner": {"reputation": 139, "user_id": 4900821, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/644bb1795728d359e37d5f1c6de924c7?s=128&d=identicon&r=PG&f=1", "display_name": "alex suhai&#246;", "link": "https://stackoverflow.com/users/4900821/alex-suhai%c3%b6"}, "edited": false, "score": 0, "creation_date": 1431624017, "post_id": 30243088, "comment_id": 48587876, "body": "const x y =  x negate x  = -x  we should calc const const(negate1)(negate2)3    At the first step my Tutor calculate                const const(negate1) to const but"}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "edited": false, "score": 2, "creation_date": 1431625281, "post_id": 30243088, "comment_id": 48588614, "body": "@EugeneSh. Have you ever wondered what was your mindstate before learning something? Perhaps when you are writing teaching material. I have and this questions allow me to see a little bit of myself in the past. And it is a valid question anyway, so why not let the search engines decide how relevant/good question it is."}, {"owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "reply_to_user": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "edited": false, "score": 1, "creation_date": 1431625717, "post_id": 30243088, "comment_id": 48588864, "body": "@LayGonz&#225;lez The <b>right</b> mind state before learning something should be the curiosity. I guess we have it here. But then comes the learning skill, that can be learned by itself. The very first learning skill should be: <i>first things first</i>."}], "answers": [{"tags": [], "owner": {"reputation": 12530, "user_id": 381619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8f67f35200cf319e30329dddd412b6d?s=128&d=identicon&r=PG", "display_name": "Neil Mayhew", "link": "https://stackoverflow.com/users/381619/neil-mayhew"}, "is_accepted": false, "score": 3, "last_activity_date": 1431624486, "creation_date": 1431624486, "answer_id": 30243592, "question_id": 30243088, "link": "https://stackoverflow.com/questions/30243088/haskell-functions-and-values/30243592#30243592", "title": "Haskell: functions and values", "body": "<p><code>(+3)</code> isn't what you probably think it is. In other languages, this means the numerical value <em>positive\u2011three</em>. In Haskell it's the partial application of the <code>+</code> operator, and is a function taking one argument (the other number to add). It adds three to whatever it's given. So <code>(+3)\u00a0x</code> is the application of the function <code>(+3)</code> to the value <code>x</code> and returns <code>x+3</code>. However, <code>(+3)</code> <code>(+3)</code> tries to add <code>3</code> to the <em>function</em> <code>(+3)</code> which doesn't make sense and gives a type error.</p>\n\n<p>It might help to imagine replacing <code>+</code> with a regular function called <code>plus</code>:</p>\n\n<pre><code>plus x y = y + x\n</code></pre>\n\n<p>Then, <code>(+3)</code> is equivalent to <code>plus\u00a03</code>, and <code>(+3)\u00a03</code> to <code>(plus\u00a03)\u00a03</code> which is the same as <code>plus\u00a03\u00a03</code>. However, <code>(+3)\u00a0(+3)</code> is equivalent to <code>(plus\u00a03)\u00a0(plus\u00a03)</code> or <code>plus\u00a03\u00a0(plus\u00a03)</code> which doesn't make sense.</p>\n\n<p>You might want to think about what <code>(+3) . (+3)</code> means. This chains together two applications of adding three, and is a single-argument function that adds six.</p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 4900821, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/644bb1795728d359e37d5f1c6de924c7?s=128&d=identicon&r=PG&f=1", "display_name": "alex suhai&#246;", "link": "https://stackoverflow.com/users/4900821/alex-suhai%c3%b6"}, "edited": false, "score": 0, "creation_date": 1431627492, "post_id": 30243674, "comment_id": 48589911, "body": "thats make sense. but why does  compose = foldr (.) id      work                  foldr::(a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b   but id type is b-&gt;b"}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 139, "user_id": 4900821, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/644bb1795728d359e37d5f1c6de924c7?s=128&d=identicon&r=PG&f=1", "display_name": "alex suhai&#246;", "link": "https://stackoverflow.com/users/4900821/alex-suhai%c3%b6"}, "edited": false, "score": 0, "creation_date": 1431631603, "post_id": 30243674, "comment_id": 48592257, "body": "The type of <code>(.)</code> is <code>(b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code>, which is the same as <code>(b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)</code>. It makes sense, function compositions, takes 2 functions and returns a function. The type of foldr is <code>(a -&gt; b -&gt; c) -&gt; b -&gt; [a] -&gt; b</code>. To remove ambiguity, lets rename the type variables to this: <code>foldr :: (fa -&gt; fb -&gt; fb) -&gt; fb -&gt; [fa] -&gt; fb</code>. <code>(.) :: (cb -&gt; cc) -&gt; (ca -&gt; cb) -&gt; (ca -&gt; cc)</code>. Then, it&#39;s clear that the application <code>foldr (.)</code> has this type: <code>(ca -&gt; cb) -&gt; [cb -&gt; cb] -&gt; (ca -&gt; cb)</code>. Also: <code>(.) :: x -&gt; x</code>. and finally, <code>foldr (.) id</code>is: <code>[x -&gt; x] -&gt; (x -&gt; x)</code>."}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 139, "user_id": 4900821, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/644bb1795728d359e37d5f1c6de924c7?s=128&d=identicon&r=PG&f=1", "display_name": "alex suhai&#246;", "link": "https://stackoverflow.com/users/4900821/alex-suhai%c3%b6"}, "edited": false, "score": 0, "creation_date": 1431631898, "post_id": 30243674, "comment_id": 48592414, "body": "The key idea that you seem to be missing is that types of this kind: <code>(cb -&gt; cc)</code> can be unified with type variables like <code>fa</code>; what I did was to exactly replace all <code>fa</code>s with <code>(cb -&gt; cc)</code>. And something similar for <code>fb</code>&amp;<code>(ca-&gt;cb)</code>."}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 139, "user_id": 4900821, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/644bb1795728d359e37d5f1c6de924c7?s=128&d=identicon&r=PG&f=1", "display_name": "alex suhai&#246;", "link": "https://stackoverflow.com/users/4900821/alex-suhai%c3%b6"}, "edited": false, "score": 0, "creation_date": 1431632061, "post_id": 30243674, "comment_id": 48592501, "body": "And also, if you have types like <code>a</code>=<code>(x -&gt; y)</code> and <code>b</code>=<code>(x -&gt; z)</code> and you unify <code>a</code> with <code>b</code> then, that unification will force <code>y</code>=<code>z</code>. That is why we ended with only 1 type variable, <code>x</code>; because the unifications that where done forced to all type variables to belong to the same type."}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 139, "user_id": 4900821, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/644bb1795728d359e37d5f1c6de924c7?s=128&d=identicon&r=PG&f=1", "display_name": "alex suhai&#246;", "link": "https://stackoverflow.com/users/4900821/alex-suhai%c3%b6"}, "edited": false, "score": 0, "creation_date": 1431632562, "post_id": 30243674, "comment_id": 48592792, "body": "Since <code>(ca -&gt; cb)</code> got unified with <code>(ca -&gt; cc)</code> that means that <code>cb = cc</code> and therefore I actually replaced <code>fa</code> with <code>(cb -&gt; cb)</code> instead of <code>(cb -&gt;cc)</code>, but it is the same. <code>(ca -&gt; cb)</code> got unified with <code>(ca -&gt; cc)</code> because <code>foldrs</code> type says that the resulting type of <code>foldr</code> is the same as the type of its second parameter: <code>(fa -&gt; fb -&gt; fb) -&gt; fb -&gt; [fa] -&gt; fb</code>, see how <code>fb</code> appears as the type for the second parameter and the resulting value?"}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 139, "user_id": 4900821, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/644bb1795728d359e37d5f1c6de924c7?s=128&d=identicon&r=PG&f=1", "display_name": "alex suhai&#246;", "link": "https://stackoverflow.com/users/4900821/alex-suhai%c3%b6"}, "edited": false, "score": 0, "creation_date": 1431632812, "post_id": 30243674, "comment_id": 48592938, "body": "So, you can say that <code>(a -&gt; b)</code> = <code>c</code> since the three are all <b>type variables</b>, but you can&#39;t say that <code>(Int -&gt; Int)</code> = <code>Int</code>, because Int is a <b>type</b> not a type variable and the <b>kind</b> of <code>(Int -&gt; Int) :: (* -&gt; *)</code> doesn&#39;t match the kind of <code>Int :: (*)</code>. <code>(* -&gt; *)</code> != <code>*</code>"}, {"owner": {"reputation": 139, "user_id": 4900821, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/644bb1795728d359e37d5f1c6de924c7?s=128&d=identicon&r=PG&f=1", "display_name": "alex suhai&#246;", "link": "https://stackoverflow.com/users/4900821/alex-suhai%c3%b6"}, "edited": false, "score": 0, "creation_date": 1431632929, "post_id": 30243674, "comment_id": 48593015, "body": "Thank you very much! so simply a parameter like a can stand for (b-&gt;c)       and that was the main point  i didnt get. Thank you for your  detailed answer"}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 139, "user_id": 4900821, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/644bb1795728d359e37d5f1c6de924c7?s=128&d=identicon&r=PG&f=1", "display_name": "alex suhai&#246;", "link": "https://stackoverflow.com/users/4900821/alex-suhai%c3%b6"}, "edited": false, "score": 0, "creation_date": 1431633201, "post_id": 30243674, "comment_id": 48593178, "body": "Yes, <code>a</code> could be unified with <code>b -&gt; c</code>. The unification algorithm is very clever and if you say <code>a</code> = <code>b -&gt; c</code> &amp; <code>a</code> = <code>b -&gt; d</code>, then the algorithm will unify <code>c</code> with <code>d</code>. And if for some reason <code>c</code> != <code>d</code> (maybe you previously unified <code>c</code> with <code>Int</code> and <code>d</code> with <code>(Int -&gt; Int)</code> then the unification would fail and you would get a compile error."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1431636224, "post_id": 30243674, "comment_id": 48594900, "body": "@LayGonz&#225;lez <code>Int -&gt; Int</code> does not have kind <code>* -&gt; *</code>; it has kind <code>*</code>, just like <code>Int</code>. But the outer-most (type) constructor of <code>Int -&gt; Int</code> is <code>(-&gt;)</code>, while the outer-most constructor of <code>Int</code> is <code>Int</code>, and only type with the same outer-most constructor may unify."}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1431636330, "post_id": 30243674, "comment_id": 48594965, "body": "@DanielWagner Oh that is correct. Thanks for pointing it out. I will edit my response and give you some credit."}], "tags": [], "owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "is_accepted": true, "score": 1, "last_activity_date": 1431636538, "last_edit_date": 1431636538, "creation_date": 1431624733, "answer_id": 30243674, "question_id": 30243088, "link": "https://stackoverflow.com/questions/30243088/haskell-functions-and-values/30243674#30243674", "title": "Haskell: functions and values", "body": "<p><code>(+3) (+3)</code> is simply a type error and, therefore, it won't compile.</p>\n\n<p>The type of <code>(+3)</code> is <code>Int -&gt; Int</code>, which means that when applying an <code>Int</code>, we get another <code>Int</code>. It also means that <strong>you can only apply values of type <code>Int</code>!</strong></p>\n\n<p>So, you can't apply to <code>(+3)</code> a value of type <code>Int -&gt; Int</code>, only values of type <code>Int</code>.</p>\n\n<p>So yes, <code>(+3)</code> is value, but not of the right type to apply it to a function that expects a value of type <code>Int</code>.</p>\n\n<p><code>Int</code> can't be unified with <code>Int -&gt; Int</code> because they have different <strong>type constructor</strong>, which makes them different types, as pointed out by @DanielWagner. The outermost constructor of <code>Int -&gt; Int</code> is <code>-&gt;</code> while the outermost constructor of <code>Int</code> is simply <code>Int</code>. It is sufficient that two types have different outermost constructor for considering them different.</p>\n"}], "owner": {"reputation": 139, "user_id": 4900821, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/644bb1795728d359e37d5f1c6de924c7?s=128&d=identicon&r=PG&f=1", "display_name": "alex suhai&#246;", "link": "https://stackoverflow.com/users/4900821/alex-suhai%c3%b6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 30243674, "answer_count": 2, "score": 1, "last_activity_date": 1431636538, "creation_date": 1431622881, "question_id": 30243088, "link": "https://stackoverflow.com/questions/30243088/haskell-functions-and-values", "title": "Haskell: functions and values", "body": "<p>I am a beginner in Haskell and have a problem with the def of functions in Haskell.\nValues are functions in Haskell, right?\n(+3) 3 = 6 but what does (+3) (+3) mean.\nDoes (+3)  counts as  an value  ?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 12, "creation_date": 1431621788, "post_id": 30242703, "comment_id": 48586538, "body": "Another option would be to just use <code>filter (not . (`elem` &quot;,.?!-:;\\&quot;\\&#39;&quot;)) xs</code>"}, {"owner": {"reputation": 1137, "user_id": 1058740, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/99a89a702a48067006ccef4f6d389c4c?s=128&d=identicon&r=PG", "display_name": "James Meade", "link": "https://stackoverflow.com/users/1058740/james-meade"}, "edited": false, "score": 1, "creation_date": 1431621824, "post_id": 30242703, "comment_id": 48586561, "body": "that worked thank you! I was just missing the square brackets."}, {"owner": {"reputation": 671, "user_id": 9591441, "user_type": "registered", "profile_image": "https://graph.facebook.com/214436282644042/picture?type=large", "display_name": "Edwin Pratt", "link": "https://stackoverflow.com/users/9591441/edwin-pratt"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1612088438, "post_id": 30242703, "comment_id": 116652425, "body": "Another option is a modification of @bheklilr&#39;s answer: <code>filter (`notElem` &quot;,.?!-:;\\&quot;\\&#39;&quot;) xs</code>"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1431621708, "creation_date": 1431621708, "answer_id": 30242703, "question_id": 30242668, "link": "https://stackoverflow.com/questions/30242668/remove-characters-from-string-in-haskell/30242703#30242703", "title": "Remove characters from String in Haskell", "body": "<p>You probably want:</p>\n\n<pre><code>removePunc xs = [ x | x &lt;- xs, not (x `elem` \",.?!-:;\\\"\\'\") ]\n</code></pre>\n\n<p>with the brackets.</p>\n"}], "owner": {"reputation": 1137, "user_id": 1058740, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/99a89a702a48067006ccef4f6d389c4c?s=128&d=identicon&r=PG", "display_name": "James Meade", "link": "https://stackoverflow.com/users/1058740/james-meade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14557, "favorite_count": 1, "accepted_answer_id": 30242703, "answer_count": 1, "score": 4, "last_activity_date": 1431621840, "creation_date": 1431621584, "question_id": 30242668, "link": "https://stackoverflow.com/questions/30242668/remove-characters-from-string-in-haskell", "title": "Remove characters from String in Haskell", "body": "<p>I am creating a program that reads a text file and splits up words and stores them in a list. I have been trying to create a function that takes in a String which is the whole text String from the file and remove punctuation e.g. \";\", \",\", \".\" but unfortunately haven't had any luck yet. The program works without the punctuation function, but not when I include it to <code>(toWords fileContents)</code> Please can someone look at what I have done and see what I am doing wrong.</p>\n\n<p>Here is the code that I have so far:</p>\n\n<pre><code>main = do  \n       contents &lt;- readFile \"LargeTextFile.txt\"\n       let lowContents = map toLower contents\n       let outStr = countWords (lowContents)\n       let finalStr = sortOccurrences (outStr)\n       let reversedStr = reverse finalStr\n       putStrLn \"Word | Occurrence \"\n       mapM_ (printList) reversedStr\n\n-- Counts all the words.\ncountWords :: String -&gt; [(String, Int)]\ncountWords fileContents = countOccurrences (toWords (removePunc fileContents))\n\n-- Splits words and removes linking words.\ntoWords :: String -&gt; [String]\ntoWords s = filter (\\w -&gt; w `notElem` [\"an\",\"the\",\"for\"]) (words s)\n\n-- Remove punctuation from text String.\nremovePunc :: String -&gt; String\nremovePunc xs = x | x &lt;- xs, not (x `elem` \",.?!-:;\\\"\\'\")\n\n-- Counts, how often each string in the given list appears.\ncountOccurrences :: [String] -&gt; [(String, Int)]\ncountOccurrences xs = map (\\xs -&gt; (head xs, length xs)) . group . sort $ xs\n\n-- Sort list in order of occurrences.\nsortOccurrences :: [(String, Int)] -&gt; [(String, Int)]\nsortOccurrences sort = sortBy (comparing snd) sort\n\n-- Prints the list in a format.\nprintList a = putStrLn((fst a) ++ \" | \" ++ (show $ snd a))\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1431619133, "post_id": 30241513, "comment_id": 48584983, "body": "In practice, it is not different, as they both have the same type and behavior."}], "answers": [{"tags": [], "owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "is_accepted": true, "score": 5, "last_activity_date": 1431618647, "last_edit_date": 1431618647, "creation_date": 1431618314, "answer_id": 30241574, "question_id": 30241513, "link": "https://stackoverflow.com/questions/30241513/why-is-the-use-of-100-partial-application/30241574#30241574", "title": "Why is the use of (&gt;100) partial application?", "body": "<blockquote>\n  <p>Why is this partial application as the > operator is being applied to the entire Integer list ?</p>\n</blockquote>\n\n<p>It is not applied to the entire list, as a whole, but to the individual elements, one by one. When the <code>&gt;</code> is partially applied over 100, it creates a new function.</p>\n\n<pre><code>Prelude&gt; :type (&gt; 100)\n(&gt; 100) :: (Num a, Ord a) =&gt; a -&gt; Bool\n</code></pre>\n\n<p>Now, the function accepts an argument and returns <code>Bool</code>. This function is applied to all the elements in the list by the <code>filter</code> function.</p>\n\n<hr>\n\n<blockquote>\n  <p>How is this different from lambda expression (\\x -> x > 100) which apparently is not partial application ?</p>\n</blockquote>\n\n<p><code>&gt;</code> is a function which needs two operands to operate. You are already passing one of them, as <code>100</code>. To completely execute the function, you need one more argument. So, the function <code>&gt;</code> is partially applied with <code>100</code>.</p>\n\n<p>In the second case, you are creating a new function which needs only one argument to execute. Once you pass that argument, your function will be executed. So, the lambda function is not applied partially.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1431620054, "creation_date": 1431620054, "answer_id": 30242152, "question_id": 30241513, "link": "https://stackoverflow.com/questions/30241513/why-is-the-use-of-100-partial-application/30242152#30242152", "title": "Why is the use of (&gt;100) partial application?", "body": "<blockquote>\n  <p>How is this [<code>(&lt;) 100</code>] different from lambda expression <code>(\\x -&gt; (&lt;) 100 x)</code> which apparently is not partial application? [1]</p>\n</blockquote>\n\n<p>I think it is important to draw a distinction between semantic properties and syntactic properties. The two terms you suggested are <em>semantically</em> identical -- that is, there is no Haskell function you can write that reduces to one thing when applied to <code>(&lt;) 100</code> and reduces to a different thing when applied to <code>(\\x -&gt; (&lt;) 100 x)</code>.</p>\n\n<p>However, partial application is a <em>syntactic</em> property -- that is, it is a property not of the <em>behavior</em> of a term but of the <em>particular implementation</em> chosen. (In analogous terms to my definition of a semantic property, a syntactic property is about whether you could write a Haskell function that reduces to one thing when applied to <em>the string</em> <code>\"(&lt;) 100\"</code> and reduces to a different thing when applied to the string <code>\"(\\x -&gt; (&lt;) 100 x)\"</code>, which is eminently possible.) If I had to define it, I would define it this way: partial application is an application term with an arrow type. [2] Both of your terms are well-typed and have arrow types. But <code>(&lt;) 100</code> is an application term, whereas <code>\\x -&gt; (&lt;) 100 x</code> is a lambda term (that has an application in its body).</p>\n\n<p>As for operator sections like <code>(100&lt;)</code> and <code>(&gt;100)</code>, it is not immediately obvious what to do with these. One choice is to simply decree that all operator sections are partial applications (or to simply decree that no operator sections are partial applications, of course). Another is to treat them as shorthand for <code>(&lt;) 100</code> and <code>flip (&gt;) 100</code>, respectively, in which case we would still consider them partial applications (since they are application terms and have arrow types). [3] Yet a third is to treat them as shorthand for <code>\\x -&gt; (&lt;) 100 x</code> and <code>\\x -&gt; (&gt;) x 100</code>, respectively, in which case one might claim they are not partial applications.</p>\n\n<p>But the distinction is, in my opinion, not too important: generally, semantic properties are more interesting and useful than merely syntactic ones.</p>\n\n<p>[1] To avoid muddying the waters, I have used <code>(&lt;) 100</code> instead of <code>(&gt;100)</code>. We will discuss this distinction shortly.<br>\n[2] There is some question about what to do if the type is polymorphic. Let's punt on that question for now.<br>\n[3] This differs from simply decreeing that all operator sections are partial applications; consider some one-argument operator <code>(!)</code> and its section <code>(100!)</code>, which we would then be treating as shorthand for <code>(!) 100</code>. This is an application term, but does not have an arrow in its type.</p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 30241574, "answer_count": 2, "score": 2, "last_activity_date": 1431620072, "creation_date": 1431618144, "last_edit_date": 1431620072, "question_id": 30241513, "link": "https://stackoverflow.com/questions/30241513/why-is-the-use-of-100-partial-application", "title": "Why is the use of (&gt;100) partial application?", "body": "<p>This code illustrates the use of partial application through the use of an operator section : </p>\n\n<pre><code>gt100 :: Integer -&gt; Bool\ngt100 x = x &gt; 100\n\n\ngreaterThan100 :: [Integer] -&gt; [Integer]\ngreaterThan100 xs = filter gt100 xs\n\ngreaterThan100_2 :: [Integer] -&gt; [Integer]\ngreaterThan100_2 xs = filter (\\x -&gt; x &gt; 100) xs\n\n\ngreaterThan100_3 :: [Integer] -&gt; [Integer]\ngreaterThan100_3 xs = filter (&gt;100) xs\n</code></pre>\n\n<p>The operator section (>100) partially applies the operator to one\nof its two arguments. So the operator in this case is >\nWhy is this partial application as the > operator is being applied\nto the entire Integer list ?</p>\n\n<p>How is this different from lambda expression <code>(\\x -&gt; x &gt; 100)</code> which\napparently is not partial application ?</p>\n\n<p>Taken from <a href=\"http://www.seas.upenn.edu/~cis194/spring13/lectures/04-higher-order.html\" rel=\"nofollow\">http://www.seas.upenn.edu/~cis194/spring13/lectures/04-higher-order.html</a></p>\n\n<p>Update : </p>\n\n<p>Thanks to answers this appears clearer.</p>\n\n<p>So here now is my understanding : </p>\n\n<pre><code>*Main&gt; :t (&gt;)\n(&gt;) :: Ord a =&gt; a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>Is not applied at all as it accepts two parameters \"a -> a\" but they are not applied.</p>\n\n<pre><code>*Main&gt; :t (&gt;100)\n(&gt;100) :: (Ord a, Num a) =&gt; a -&gt; Bool\n</code></pre>\n\n<p>Is partially applied as a function of type \"a -> Bool\" is created</p>\n\n<pre><code>*Main&gt; :t (3&gt;100)\n(3&gt;100) :: Bool\n</code></pre>\n\n<p>Is evaluated to type Bool which is the return type of operator <code>(&gt;)</code> as illustrated by <code>:t (&gt;)</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 1, "creation_date": 1431616082, "post_id": 30240738, "comment_id": 48582963, "body": "Try <code>let x = greaterThan100 [1,9,349,6,907,98,105]</code>"}, {"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "reply_to_user": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 0, "creation_date": 1431616259, "post_id": 30240738, "comment_id": 48583085, "body": "@thefourtheye this works &quot;gt = greaterThan100 [1,9,349,6,907,98,105]&quot; I was double assigning the same value. I&#39;m running this from within .hs file so do not need let statement."}], "answers": [{"tags": [], "owner": {"reputation": 1409, "user_id": 1876583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdf666782fb48c703f4fae045f681c13?s=128&d=identicon&r=PG", "display_name": "WolfeFan", "link": "https://stackoverflow.com/users/1876583/wolfefan"}, "is_accepted": true, "score": 2, "last_activity_date": 1431617286, "creation_date": 1431617286, "answer_id": 30241212, "question_id": 30240738, "link": "https://stackoverflow.com/questions/30240738/assign-the-result-of-a-function-to-variable/30241212#30241212", "title": "Assign the result of a function to variable?", "body": "<p>In a .hs file:</p>\n\n<pre><code>x = greaterThan100 [1,9,349,6,907,98,105]\n</code></pre>\n\n<p>In GHCi:</p>\n\n<pre><code>let x = greaterThan100 [1,9,349,6,907,98,105]\n</code></pre>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 30241212, "answer_count": 1, "score": 1, "last_activity_date": 1431617286, "creation_date": 1431615955, "question_id": 30240738, "link": "https://stackoverflow.com/questions/30240738/assign-the-result-of-a-function-to-variable", "title": "Assign the result of a function to variable?", "body": "<p>Below code just invokes a function of type : </p>\n\n<pre><code>greaterThan100 :: [Integer] -&gt; [Integer]\n</code></pre>\n\n<p>I'm struggling with the simplest of concepts but how to bind/assign the result of this function to a variable ?</p>\n\n<pre><code>greaterThan100 :: [Integer] -&gt; [Integer]\ngreaterThan100 [1,9,349,6,907,98,105] = [349,907,105]\n</code></pre>\n\n<p>Cannot use <code>x = greaterThan100 [1,9,349,6,907,98,105] = [349,907,105]</code> This syntax does not make sense ? </p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "edited": false, "score": 0, "creation_date": 1431613499, "post_id": 30239294, "comment_id": 48581084, "body": "Did you take a look at the Persistent page of the Yesod Web Framework Book ? <a href=\"http://www.yesodweb.com/book/persistent\" rel=\"nofollow noreferrer\">yesodweb.com/book/persistent</a>"}, {"owner": {"reputation": 31706, "user_id": 479180, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a6a0fe77d0b255095771224c05db75cc?s=128&d=identicon&r=PG", "display_name": "LuxuryMode", "link": "https://stackoverflow.com/users/479180/luxurymode"}, "reply_to_user": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "edited": false, "score": 0, "creation_date": 1431614521, "post_id": 30239294, "comment_id": 48581846, "body": "@zigazou as I linked to in my question, yes."}, {"owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "edited": false, "score": 0, "creation_date": 1431614997, "post_id": 30239294, "comment_id": 48582222, "body": "I\u2019m also new to Persistent and Yesod. This page helped me to understand how it works. Could you be more precise on what blocks you ? Have you tried the scaffolded site ?"}, {"owner": {"reputation": 31706, "user_id": 479180, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a6a0fe77d0b255095771224c05db75cc?s=128&d=identicon&r=PG", "display_name": "LuxuryMode", "link": "https://stackoverflow.com/users/479180/luxurymode"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1431624065, "post_id": 30239294, "comment_id": 48587905, "body": "@Cubic close, but that question is Yesod-specific"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1431624627, "post_id": 30239294, "comment_id": 48588241, "body": "@LuxuryMode It&#39;s not. Yesod is in the title, but it&#39;s about Persist and the answer has nothing to do with Yesod."}, {"owner": {"reputation": 31706, "user_id": 479180, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a6a0fe77d0b255095771224c05db75cc?s=128&d=identicon&r=PG", "display_name": "LuxuryMode", "link": "https://stackoverflow.com/users/479180/luxurymode"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1431625627, "post_id": 30239294, "comment_id": 48588810, "body": "@Cubic you&#39;re right, I didn&#39;t look closely enough. toSqlKey is what I was looking for. What should I do with this question now, vote to close? ;)"}], "answers": [{"comments": [{"owner": {"reputation": 31706, "user_id": 479180, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a6a0fe77d0b255095771224c05db75cc?s=128&d=identicon&r=PG", "display_name": "LuxuryMode", "link": "https://stackoverflow.com/users/479180/luxurymode"}, "edited": false, "score": 0, "creation_date": 1431616981, "post_id": 30240626, "comment_id": 48583539, "body": "This is very helpful, thank you! I am not using Yesod however. I&#39;m using Persistent as a standalone ORM together with Scotty on the web side of things."}], "tags": [], "owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "is_accepted": false, "score": 0, "last_activity_date": 1431615642, "creation_date": 1431615642, "answer_id": 30240626, "question_id": 30239294, "link": "https://stackoverflow.com/questions/30239294/get-by-id-with-persistent/30240626#30240626", "title": "Get by ID with Persistent", "body": "<p>As an example, say I have an <code>Article</code> in my <code>models</code> file :</p>\n\n<pre><code>Article\n    artname     Text\n    title       Text\n    keywords    Text Maybe\n    description Text Maybe\n    body        Markdown\n    parent      ArticleId Maybe\n    user        UserId\n    lastUpdate  UTCTime\n    weight      Int\n    public      Bool\n\n    UniqueArt   artname\n\n    deriving    Typeable\n</code></pre>\n\n<p>I do not need to create a primary key <code>articleId</code> as it is handled by Persistent.</p>\n\n<p>In my <code>routes</code> file:</p>\n\n<pre><code>/new/page                       ArticleNewR GET POST\n/page/#ArticleId/edit           ArticleEditR GET POST\n/page/#ArticleId/delete         ArticleDeleteR GET POST\n/page/#ArticleId                ArticleViewR GET\n</code></pre>\n\n<p>The <code>#ArticleId</code> tells Yesod to only accept an <code>ArticleId</code> as second argument in my URLs. The <code>Article*R</code> are just handlers for each URL.</p>\n\n<p>In <code>Handler/Article.hs</code>, I need to have the corresponding function handlers. For example, if I told Yesod of the <code>ArticleViewR</code> GET handler, I need to define the following function:</p>\n\n<pre><code>getArticleViewR :: ArticleId -&gt; Handler Html\ngetArticleViewR articleId = do\n    -- The article\n    article &lt;- runDB $ get404 articleId\n\n    -- The parent article (if any)\n    let parentIdM = articleParent article\n    parentM &lt;- case parentIdM of\n                    Just parentId -&gt; runDB $ get parentId\n                    Nothing -&gt; return Nothing\n\n    -- The child articles\n    children &lt;- runDB $ selectList [ArticleParent ==. Just articleId]\n                                   [Asc ArticleWeight, Asc ArticleTitle]\n\n    -- Author\n    author &lt;- runDB $ get (articleUser article)\n\n    defaultLayout $ do\n        setTitle $ toHtml (articleTitle article)\n        setDescription $ articleDescription article\n        setKeywords $ articleKeywords article\n        setAuthor $ userUsername &lt;$&gt; author\n        $(widgetFile \"article/view\")\n</code></pre>\n\n<p>That\u2019s basically how you link each piece.</p>\n"}], "owner": {"reputation": 31706, "user_id": 479180, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a6a0fe77d0b255095771224c05db75cc?s=128&d=identicon&r=PG", "display_name": "LuxuryMode", "link": "https://stackoverflow.com/users/479180/luxurymode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 797, "favorite_count": 0, "closed_date": 1431626344, "answer_count": 1, "score": 1, "last_activity_date": 1431615642, "creation_date": 1431611891, "question_id": 30239294, "link": "https://stackoverflow.com/questions/30239294/get-by-id-with-persistent", "closed_reason": "Duplicate", "title": "Get by ID with Persistent", "body": "<p>I'm new to Persistent and trying to figure out how to fetch a row using an ID. The <a href=\"http://www.yesodweb.com/book/persistent#persistent_fetching_by_id\" rel=\"nofollow\">docs show an example</a> that looks like this:</p>\n\n<pre><code>personId &lt;- insert $ Person \"Michael\" \"Snoyman\" 26\nmaybePerson &lt;- get personId\ncase maybePerson of\n    Nothing -&gt; liftIO $ putStrLn \"Just kidding, not really there\"\n    Just person -&gt; liftIO $ print person\n</code></pre>\n\n<p>This example uses the ID generated from insertion to do the query. I don't fully understand how it works, but the idea here is that there are type safe keys so that one cannot query for a Foo with a BarID. </p>\n\n<p>How can I generate a type safe ID/Key for my particular entity? I'd like to be able to take an Int, for example from some url path, and then query my table with that as an ID. </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 4, "last_activity_date": 1431612602, "creation_date": 1431612602, "answer_id": 30239528, "question_id": 30239057, "link": "https://stackoverflow.com/questions/30239057/typing-algebraic-data-type-with-generic-type/30239528#30239528", "title": "Typing algebraic data type with generic type", "body": "<p>In the first type:</p>\n\n<pre><code>data List t = E | C t (List t)\n</code></pre>\n\n<p><code>t</code> is a <em>type parameter</em>, it must be provided as an existing type.  <code>E</code> is not a type, it is a <em>data constructor</em>, or <em>value constructor</em>.  <code>C</code> is also a data constructor.  They have the types:</p>\n\n<pre><code>E :: List t\nC :: t -&gt; List t -&gt; List t\n</code></pre>\n\n<p>You could construct values like</p>\n\n<pre><code>&gt; E :: List Int  -- Equivalent to []\nE\n&gt; C 1 E :: List Int  -- Equivalent to [1]\nC 1 E\n&gt; C 1 (C 2 E) :: List Int  -- Equivalent to [1, 2]\nC 1 (C 2 E)\n</code></pre>\n\n<p>And so on.  You can treat <code>E</code> as the empty list <code>[]</code> and <code>C</code> as the list constructor <code>:</code>, so <code>C 1 (C 2 (C 3 E))</code> is equivalent to <code>1 : 2 : 3 : []</code> which is the same as <code>[1, 2, 3]</code>.</p>\n\n<p>In the second type:</p>\n\n<pre><code>data NonEmptyList a = NEL a [a]\n</code></pre>\n\n<p>You have the data constructor</p>\n\n<pre><code>NEL :: a -&gt; [a] -&gt; NonEmptyList a\n</code></pre>\n\n<p>You can construct values like</p>\n\n<pre><code>&gt; NEL 1 [] :: NonEmptyList Int  -- Equivalent to [1]\nNEL 1 []\n&gt; NEL 1 [2] :: NonEmptyList Int  -- Equivalent to [1, 2]\n</code></pre>\n\n<p>And so on.  This type forces you to always have at least one value, so it can't be non-empty.</p>\n\n<p>When you write <code>lst2 :: NonEmptyList = 2</code>, this is a syntax error, and it's hard to guess what you meant, but the equivalent <code>NonEmptyList Int</code> to the <code>lst1 :: List Int</code> would be written as <code>NEL 2 [] :: NonEmptyList Int</code>.</p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 30239528, "answer_count": 1, "score": 1, "last_activity_date": 1431612602, "creation_date": 1431611239, "last_edit_date": 1431612105, "question_id": 30239057, "link": "https://stackoverflow.com/questions/30239057/typing-algebraic-data-type-with-generic-type", "title": "Typing algebraic data type with generic type", "body": "<pre><code>data List t = E | C t (List t)\n  deriving Show\n\nlst1 :: List Int\nlst1 = C 2 E\n</code></pre>\n\n<p>Why is <code>t</code> typed to 2 in case ?\nAs the first guard defines \"t = E\" is this reason <code>(List t)</code> is allowed, so \"C t (List t)\" can also be read \"C t E\" ?</p>\n\n<pre><code>data NonEmptyList a = NEL a [a]\nlst2 :: NonEmptyList = 2\n</code></pre>\n\n<p>Why can't 2 be typed to <code>a</code> as <code>t</code> is typed to 2 in above case ?</p>\n"}, {"tags": ["javascript", "haskell", "cross-compiling", "ffi", "ghcjs"], "comments": [{"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1444556227, "post_id": 30236937, "comment_id": 53946029, "body": "any info on this since ?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1444556432, "post_id": 30236937, "comment_id": 53946075, "body": "nope, unfortunately..."}], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 177, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1444556541, "creation_date": 1431605025, "last_edit_date": 1444556541, "question_id": 30236937, "link": "https://stackoverflow.com/questions/30236937/triggering-a-javascript-import-require-from-ghcjs-ffi-bindings", "title": "Triggering a JavaScript import/require from GHCJS FFI bindings", "body": "<p>I'll use a Famo.us example as the starting point:</p>\n\n<pre class=\"lang-javascript prettyprint-override\"><code>var Engine = require(\"famous/core/Engine\");  // or just var Engine = famous.core.Engine;\nvar Surface = require(\"famous/core/Surface\");\n\nvar ctx = Engine.createContext();\nctx.add(new Surface({...}));\n</code></pre>\n\n<p>now I have these GHCJS FFI bindings:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>foreign import javascript unsafe \"$r = famous.core.Engine;\"\n  engine :: Engine\n\nforeign import javascript safe \"$r = ($1).createContext();\"\n  fms_Engine_createContext0 :: Engine -&gt; IO Context\n\nforeign import javascript safe \"$r = new famous.core.Surface($1);\"\n  fms_Surface_new :: JSRef Surface -&gt; IO (JSRef Surface)\n\nforeign import javascript safe \"$r = $2.add($1)\"\n  fms_Context_add :: JSRef a -&gt; Context -&gt; IO RenderNode\n</code></pre>\n\n<p>\u2014 as you can see, in the inline JavaScript code, I always need to refer to things like <code>famous.core.FOO</code> using fully qualified names instead of just <code>FOO</code> like one normally would.</p>\n\n<p>here's the equivalent Haskell snippet using these FFI bindings (hidden behind high level wrappers for clarity):</p>\n\n<pre><code>main = do\n  -- calls fms_Engine_createContext0 under the hood\n  ctx &lt;- createContext engine\n  -- calls fms_Surface_new under the hood\n  sf &lt;- surface [ SfSize       $ XY 200 200\n                , SfContent    $ content\n                , SfProperties $ fromList [ (\"backgroundColor\", \"rgb(240, 238, 233)\")\n                                          , (\"textAlign\"      , \"center\") ] ]\n  -- calls fms_Context_add under the hood\n  sf `addToContext` ctx\n</code></pre>\n\n<p>And here's the question: is it possible to make GHCJS auto-generate e.g. <code>var Engine = famous.core.Engine</code> and <code>var Surface = famous.core.Surface</code> imports in the outputted JavaScript whenever an FFI binding gets used that depends on it? Or are my only options to either always use fully qualified names in my inline JS or to always just manually import a name per every FFI binding?</p>\n"}]