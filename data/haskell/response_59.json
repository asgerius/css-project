[{"tags": ["haskell", "generic-programming", "haskell-lens"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1456479782, "post_id": 35615345, "comment_id": 58976689, "body": "If you just want <code>traverse</code>, you could enable <code>-XDeriveTraversable</code> and have GHC derive the traversable instance for you."}, {"owner": {"reputation": 715, "user_id": 4883127, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/428914dd1ba6786d9242170f4bbce2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Hardy", "link": "https://stackoverflow.com/users/4883127/bradley-hardy"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456507608, "post_id": 35615345, "comment_id": 58996367, "body": "@Zeta this was just an example, but the datatype I&#39;m actually using is monomorphic, and there are different branches with different types of data in them. I asked the question more out of curiosity (and perhaps for future utility) to be honest: it obviously makes more sense in my current situation just to write the traversal manually in a few minutes rather than wait days for someone to answer my Stack Overflow question!"}], "answers": [{"tags": [], "owner": {"reputation": 1958, "user_id": 939108, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/055cba8d3eb565a817f6f7f20f936814?s=128&d=identicon&r=PG", "display_name": "Hjulle", "link": "https://stackoverflow.com/users/939108/hjulle"}, "is_accepted": true, "score": 3, "last_activity_date": 1459224649, "creation_date": 1459224649, "answer_id": 36275279, "question_id": 35615345, "link": "https://stackoverflow.com/questions/35615345/can-i-get-a-traversal-to-items-stored-in-branches-using-control-lens-plated/36275279#36275279", "title": "Can I get a `Traversal` to items stored in branches using `Control.Lens.Plated`?", "body": "<p>I do not believe it is possible to do using <code>Plated</code>, but it is trivial to do using <code>template</code> from <a href=\"http://hackage.haskell.org/package/lens/docs/Data-Data-Lens.html\" rel=\"nofollow\"><code>Data.Data.Lens</code></a>:</p>\n\n<pre><code>branchData :: Data a =&gt; Traversal' (Tree a) a\nbranchData = template\n</code></pre>\n\n<p>Template finds all elements of a type that can be accessed without going through the same type.</p>\n\n<hr>\n\n<p>The closest thing to a traversal that I can get from <code>Plated</code> (except for the <code>cosmos</code> fold you mentioned) is <code>transformM :: (Monad m, Plated a) =&gt; LensLike' m a a</code>. It can be used as a <code>Setter</code> and can do some other stuff.</p>\n\n<p>The reason that transformM needs a Monad (instead of an Applicative that would be required for a traversal) is that we need to update the children before updating the node, which means that ordering is needed. It is impossible to make a traversal that points at both a node and a child of that node.</p>\n"}], "owner": {"reputation": 715, "user_id": 4883127, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/428914dd1ba6786d9242170f4bbce2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Hardy", "link": "https://stackoverflow.com/users/4883127/bradley-hardy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 36275279, "answer_count": 1, "score": 3, "last_activity_date": 1459224649, "creation_date": 1456356630, "question_id": 35615345, "link": "https://stackoverflow.com/questions/35615345/can-i-get-a-traversal-to-items-stored-in-branches-using-control-lens-plated", "title": "Can I get a `Traversal` to items stored in branches using `Control.Lens.Plated`?", "body": "<p>I can easily get a <code>Traversal</code> to items stored in leaves:</p>\n\n<pre><code>data Tree a = Br (Tree a) (Tree a) | Lf a\n    deriving (Data)\n\ninstance Plated (Tree a) where\n\nmakePrisms ''Tree\n\nleaves :: Traversal' (Tree a) a\nleaves = deep _Lf\n</code></pre>\n\n<p>But <code>deep</code> can't keep going if I take something out of a branch. The best I can seem to achieve with data in branches is a <code>Fold</code>:</p>\n\n<pre><code>data Tree a = Br a (Tree a) (Tree a) | Lf\n    deriving (Data)\n\ninstance Plated (Tree a) where\n\nmakePrisms ''Tree\n\nbranchData :: Fold (Tree a) a\nbranchData = cosmos._Br._1\n</code></pre>\n\n<p>It is obviously possible to manually construct a <code>Traversal</code> because this <code>Tree</code> can be made <code>Traversable</code>:</p>\n\n<pre><code>instance Traversable Tree where\n    sequenceA Lf = pure Lf\n    sequenceA (Br x l r) = Br &lt;$&gt; x &lt;*&gt; sequenceA l &lt;*&gt; sequenceA r\n</code></pre>\n\n<p>Can <code>Plated</code> do it for us automatically somehow?</p>\n"}, {"tags": ["haskell", "operators", "associativity"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 1, "creation_date": 1456355091, "post_id": 35614815, "comment_id": 58913644, "body": "None of the code you&#39;ve provided does anything about right associativity.  Right associativity only does something when you use a function infix.  Function application <i>always</i> has the highest precedence."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1456355203, "post_id": 35614815, "comment_id": 58913694, "body": "@LouisWasserman Now I understand where the OP&#39;s confusion stems from!"}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 3, "creation_date": 1456355247, "post_id": 35614815, "comment_id": 58913710, "body": "I think the OP expects <code>(&gt;+ 5)</code> to apply to <code>10</code> before <code>(`mod` 14)</code>, but that&#39;s never going to happen, basically."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1456357226, "post_id": 35614815, "comment_id": 58914439, "body": "Associativity rules essentially let you omit a few parentheses in expressions like <code>x + y - z * w &lt;&lt; a</code>, involving infix operators. Nothing more than that."}], "answers": [{"tags": [], "owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "is_accepted": false, "score": 1, "last_activity_date": 1456357359, "creation_date": 1456357359, "answer_id": 35615483, "question_id": 35614815, "link": "https://stackoverflow.com/questions/35614815/how-to-use-right-associative-op-in-the-expression/35615483#35615483", "title": "How to use right associative op in the expression?", "body": "<p>Thats not how associativity works.</p>\n\n<p>Associativity defines the behavior of chained operation with the same operator.</p>\n\n<p>For example, when an operator * is left associative, then <code>a * b * c * d</code> is evaluated as <code>((a * b) * c) * d</code>.</p>\n\n<p>If * is right associative, then it will be evaluated as <code>a * (b * (c * d))</code></p>\n\n<p>In conclusion, your <code>&gt;+</code> does nothing since addition is commutative. That is, <code>a + b + c</code> is equivalent to <code>a &gt;+ b &gt;+ c</code> since <code>(a + b) + c = a + (b + c)</code>.</p>\n\n<p>In Haskell you can also define non-associative operators. It means that the operations cannot be chained, or your compiler will raise a parse error.</p>\n"}], "owner": {"reputation": 2578, "user_id": 3552363, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/052c914bea4fdfdbd0d603b2321c49b2?s=128&d=identicon&r=PG&f=1", "display_name": "Finkelson", "link": "https://stackoverflow.com/users/3552363/finkelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456417877, "creation_date": 1456354147, "last_edit_date": 1456417877, "question_id": 35614815, "link": "https://stackoverflow.com/questions/35614815/how-to-use-right-associative-op-in-the-expression", "title": "How to use right associative op in the expression?", "body": "<p>I've defined my own operator:</p>\n\n<pre><code>infixr 6 &gt;+\nx &gt;+ y = (+ x) y\n</code></pre>\n\n<p>It is right associative.</p>\n\n<p>And now I want to use in the next expression:</p>\n\n<pre><code>(`mod` 14) (&gt;+ 5) 10\n</code></pre>\n\n<p>But I get an error:</p>\n\n<pre><code>&lt;interactive&gt;:11:1:\n    Non type-variable argument in the constraint: Integral (a -&gt; a)\n    (Use FlexibleContexts to permit this)\n    When checking that \u2018it\u2019 has the inferred type\n      it :: forall a. (Integral (a -&gt; a), Num a) =&gt; a\n</code></pre>\n\n<p>How can I fix it?</p>\n"}, {"tags": ["haskell", "io"], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 0, "creation_date": 1456378638, "post_id": 35614099, "comment_id": 58921052, "body": "This answer is fantastic. You helped me a lot. Thank you!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1456352391, "last_edit_date": 1456352391, "creation_date": 1456351389, "answer_id": 35614099, "question_id": 35613771, "link": "https://stackoverflow.com/questions/35613771/change-a-function-to-support-io-string-instead-of-string/35614099#35614099", "title": "Change a function to support IO String instead of String", "body": "<p><strong>First</strong>, to emphasize: <em>an <code>IO String</code> is not a string</em>. It's an IO action which, when you bind it somewhere within the <code>main</code> action, will <em>yield</em> a result of type <code>String</code>, but you should not think of it as some sort of &ldquo;variation on the string type&rdquo;. Rather, it's <em>a special instantiation of the <code>IO a</code> type</em>.</p>\n\n<p>For this reason, you almost certainly do <em>not</em> want to &ldquo;change a function to support <code>IO String</code> instead of <code>String</code>&rdquo;. <strong>Instead</strong>, you want to apply this string-accepting function, as it is, to an <em>outcome of the <code>crawlType</code> action</em>. Such an outcome, as I said, has type <code>String</code>, so you're fine there. For instance,</p>\n\n<pre><code>main :: IO ()\nmain = do\n   pkm = \"blablabla\"\n   typeString &lt;- crawlType pkm\n   let typeSpec = getType typeString\n   print typeSpec -- or whatever you wish to do with it.\n</code></pre>\n\n<p>You can omit the <code>typeString</code> variable by writing<sup>&dagger;</sup></p>\n\n<pre><code>   typeSpec &lt;- getType &lt;$&gt; crawlType pkm\n</code></pre>\n\n<p>if you prefer; this corresponds to what in a procedural language might look like</p>\n\n<pre><code>   var typeSpec = getType(crawlType(pkm));\n</code></pre>\n\n<p><strong>Alternatively</strong>, you can of course include the parsing right in <code>crawlType</code>:</p>\n\n<pre><code>crawlType' :: String -&gt; IO (String, String)\ncrawlType' pkm = do\n  src &lt;- openURL url\n  return . getType . fromBody $ parseTags src\n  where\n    fromBody = unwords . drop 6 . take 7 . words . innerText . dropWhile (~/= \"&lt;p&gt;\")\n    url = \"http://pokemon.wikia.com/wiki/\" ++ pkm\n</code></pre>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>If you're curious what the <a href=\"http://hayoo.fh-wedel.de/?query=%3C%24%3E\" rel=\"noreferrer\"><code>&lt;$&gt;</code> operator</a> does: this is not built-in syntax like <code>do</code>/<code>&lt;-</code> notation. Instead, it's just an infix version of <code>fmap</code>, which you may better know in its list-specialised version <code>map</code>. Both list <code>[]</code> and <code>IO</code> are <a href=\"https://en.wikipedia.org/wiki/Functor\" rel=\"noreferrer\">functors</a>, which means you can pull them through ordinary functions, changing only the element/outcome values but not the structure of the IO action / list spine.</sub></p>\n"}], "owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 35614099, "answer_count": 1, "score": 0, "last_activity_date": 1456352391, "creation_date": 1456350167, "question_id": 35613771, "link": "https://stackoverflow.com/questions/35613771/change-a-function-to-support-io-string-instead-of-string", "title": "Change a function to support IO String instead of String", "body": "<p>I get an IO String via:</p>\n\n<pre><code>import Data.Char\nimport Network.HTTP\nimport Text.HTML.TagSoup\n\nopenURL :: String -&gt; IO String\nopenURL x = getResponseBody =&lt;&lt; simpleHTTP (getRequest x)\n\ncrawlType :: String -&gt; IO String\ncrawlType pkm = do\n  src &lt;- openURL url\n  return . fromBody $ parseTags src\n  where\n    fromBody = unwords . drop 6 . take 7 . words . innerText . dropWhile (~/= \"&lt;p&gt;\")\n    url = \"http://pokemon.wikia.com/wiki/\" ++ pkm\n</code></pre>\n\n<p>and I want to parse its data via:</p>\n\n<pre><code>getType :: String -&gt; (String, String)\ngetType pkmType = (dropWhile (== '/') $ fst b, dropWhile (== '/') $ snd b)\n                  where b = break (== '/') pkmType\n</code></pre>\n\n<p>But like you see, <code>getType</code> doesn't support the IO String yet.</p>\n\n<p>I'm new to IO, so how to make it working?\nI also tryed to understand the error when giving the IO String to that function, but it's too complicated for me up to now :/</p>\n"}, {"tags": ["haskell", "ghc", "read-eval-print-loop", "ghci"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456350209, "post_id": 35613612, "comment_id": 58911246, "body": "<a href=\"http://stackoverflow.com/a/14461928/745903\">stackoverflow.com/a/14461928/745903</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1456406252, "post_id": 35613793, "comment_id": 58938210, "body": "Protip: assign <code>ghci -interactive-print=BetterPrint.betterPrint</code> to an alias."}, {"owner": {"reputation": 7054, "user_id": 1313611, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ee895c4ad3fa29cf3aaa4abddda289f?s=128&d=identicon&r=PG", "display_name": "pyrospade", "link": "https://stackoverflow.com/users/1313611/pyrospade"}, "edited": false, "score": 0, "creation_date": 1518038810, "post_id": 35613793, "comment_id": 84345453, "body": "You can also put this in your ~/.ghci <code>:set -interactive-print=betterPrint</code>"}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 12, "last_activity_date": 1518037493, "last_edit_date": 1518037493, "creation_date": 1456350260, "answer_id": 35613793, "question_id": 35613612, "link": "https://stackoverflow.com/questions/35613612/how-can-i-get-ghci-to-use-my-show-function/35613793#35613793", "title": "How can I get `ghci` to use my `show` function?", "body": "<p>You can define your own <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#ghc-flag--interactive-print%20%E2%9F%A8expr%E2%9F%A9\" rel=\"nofollow noreferrer\">interactive print</a> function e.g:</p>\n\n<pre><code>module BetterPrint\nbetterPrint a = putStrLn (take 1000 $ show a)\n</code></pre>\n\n<p>then start ghci as</p>\n\n<pre><code>ghci -interactive-print=BetterPrint.betterPrint\n</code></pre>\n"}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 1, "answer_count": 1, "score": 8, "last_activity_date": 1518037493, "creation_date": 1456349691, "question_id": 35613612, "link": "https://stackoverflow.com/questions/35613612/how-can-i-get-ghci-to-use-my-show-function", "title": "How can I get `ghci` to use my `show` function?", "body": "<p>Let's say you want to use your own show function (for example, <code>let show = take 1000 . Prelude.show</code>). How can you allow <code>ghci</code> to use that for printing instead of the built in <code>show</code>?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1456348530, "post_id": 35613184, "comment_id": 58910291, "body": "you can just <i>break</i>  by pressing <code>CTRL-C</code> (as with most other programs out there ;))"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456348673, "post_id": 35613184, "comment_id": 58910376, "body": "btw: if you do it in inside emacs you might have to hit C twice (C-c-c) and it will probably fill up quite a bit of memory as the buffer will remember it"}, {"owner": {"reputation": 2910, "user_id": 4683264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Ufhvj.png?s=128&g=1", "display_name": "J Atkin", "link": "https://stackoverflow.com/users/4683264/j-atkin"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456349222, "post_id": 35613184, "comment_id": 58910686, "body": "Cool! I never knew that worked! I almost never use the console for anything except for a interactive console like ghci or python."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1456351767, "post_id": 35613184, "comment_id": 58912104, "body": "See <a href=\"http://stackoverflow.com/q/35613612/1172541\">stackoverflow.com/q/35613612/1172541</a> for a work around."}], "answers": [{"comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1456349011, "post_id": 35613315, "comment_id": 58910571, "body": "A more general solution (if you aren&#39;t just using lists) is <code>take x . show</code>."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 2, "last_activity_date": 1456348675, "creation_date": 1456348675, "answer_id": 35613315, "question_id": 35613184, "link": "https://stackoverflow.com/questions/35613184/how-do-i-prevent-ghci-from-evaluating-an-infinite-stream/35613315#35613315", "title": "How do I prevent GHCI from evaluating an infinite stream?", "body": "<p>Simply use <kbd>Ctrl</kbd>+<kbd>C</kbd> to interrupt the process:</p>\n\n<pre><code>Prelude &gt; let x = 1\nPrelude &gt; [1..]\nlots of stuff... Interrupted.\nPrelude &gt; print x\n1\n</code></pre>\n\n<p>Other than this I believe you cannot really do anything about it except starting writing your expressions with <code>take</code> to be sure to have a finite output... In the end lists are only <em>one</em> of possible infinite outputs and the ghci cannot reliably know what requires shortening and what not. He simply <code>show</code>s the result and output it.</p>\n"}], "owner": {"reputation": 2910, "user_id": 4683264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Ufhvj.png?s=128&g=1", "display_name": "J Atkin", "link": "https://stackoverflow.com/users/4683264/j-atkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 35613315, "answer_count": 1, "score": 1, "last_activity_date": 1456348675, "creation_date": 1456348257, "question_id": 35613184, "link": "https://stackoverflow.com/questions/35613184/how-do-i-prevent-ghci-from-evaluating-an-infinite-stream", "title": "How do I prevent GHCI from evaluating an infinite stream?", "body": "<p>Sometimes when using GHCI I accidentally try to evaluate an infinite stream (e.g. <code>[1..]</code>). It keeps printing... and printing... and printing... and printing... So the problem is that the only way to stop the printing is to quit the console, losing all the stuff that I've already done in that session. Is there a way to make GHCI take only the first x items from a list by default?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456345515, "post_id": 35611414, "comment_id": 58908631, "body": "Is your data is binary or human readable? Should the 4 byte bytestring <code>0x31343239</code> get interpreted as <code>1429</code>, <code>9241</code> or as binary <code>Word32</code> 825,504,313?"}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1456345475, "post_id": 35612197, "comment_id": 58908608, "body": "I&#39;m not really sure whether <code>ByteString.Conversion</code> does the right thing. It parses the numbers as <code>Char8</code> with attoparsec."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1456365091, "post_id": 35612197, "comment_id": 58916804, "body": "If the ultimate goal is something of type <code>ByteString -&gt; ByteString</code>, won&#39;t the reassembly step from 4-byte chunks kill the performance?"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 4, "last_activity_date": 1456346313, "last_edit_date": 1456346313, "creation_date": 1456345012, "answer_id": 35612197, "question_id": 35611414, "link": "https://stackoverflow.com/questions/35611414/apply-a-word32-function-to-a-bytestring/35612197#35612197", "title": "Apply a Word32 function to a ByteString", "body": "<p>You can <em>chunk up</em> the <code>ByteString</code> very efficiently, given that <a href=\"https://hackage.haskell.org/package/bytestring-0.10.6.0/docs/Data-ByteString.html#v:take\" rel=\"nofollow\"><code>B.take</code></a> and <a href=\"https://hackage.haskell.org/package/bytestring-0.10.6.0/docs/Data-ByteString.html#v:drop\" rel=\"nofollow\"><code>B.drop</code></a> are both <code>O(1)</code> operations:</p>\n\n<pre><code>import Data.ByteString (ByteString)\nimport qualified Data.ByteString as B\n\nchunk :: Int -&gt; ByteString -&gt; [ByteString]\nchunk k = takeWhile (not . B.null) . map (B.take k) . iterate (B.drop k) \n</code></pre>\n\n<p>then:</p>\n\n<pre><code>\\&gt; :set -XOverloadedStrings\n\\&gt; chunk 4 \"abcdefghijkl\"\n[\"abcd\",\"efgh\",\"ijkl\"]\n</code></pre>\n\n<p>the rest would be to map over the list converting to and from desired type, and a single call to <a href=\"https://hackage.haskell.org/package/bytestring-0.10.6.0/docs/Data-ByteString.html#v:concat\" rel=\"nofollow\"><code>B.concat</code></a> at the end.</p>\n\n<p>A possible <code>fromByteString</code> could be implemented using bit shifts and left fold:</p>\n\n<pre><code>import Data.Bits (Bits, shiftL, (.|.))\n\nfromByteString :: (Num a, Bits a) =&gt; ByteString -&gt; a\nfromByteString = B.foldl go 0\n    where go acc i = (acc  `shiftL` 8) .|. (fromIntegral i)\n</code></pre>\n\n<p>then:</p>\n\n<pre><code>\\&gt; map fromByteString $ chunk 4 \"abcdefghijkl\" :: [Word32]\n[1633837924,1701209960,1768581996]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456345829, "post_id": 35612381, "comment_id": 58908813, "body": "<i>&quot;Depending on this library should be seen as a way to document and standardize an existing hack, and not as an absolute guarantee of correct behavior. &quot;</i> Given that the library is from 2011 and does not have a version in Stack&#39;s LTS, is it still working as intended?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456345907, "post_id": 35612381, "comment_id": 58908875, "body": "I had my doubts too, but it does seem to work fine. Perhaps somebody should port those conversions to a well-maintained package."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1456346418, "post_id": 35612381, "comment_id": 58909131, "body": "I think monotraversable&#39;s [<code>Data.ByteVector</code>](<a href=\"http://hackage.haskell.org/package/mono-traversable-0.10.1/docs/Data-ByteVector.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/mono-traversab&zwnj;&#8203;le-0.10.1/docs/&hellip;</a> ) is the most visible thing like this - at least when taken together with <a href=\"http://hackage.haskell.org/package/vector-0.11.0.0/docs/src/Data-Vector-Storable-Mutable.html#unsafeCast\" rel=\"nofollow noreferrer\"><code>unsafeCast</code></a> Maybe monotraversable could do with a few more functions like this."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1456346554, "post_id": 35612381, "comment_id": 58909208, "body": "also <i>&quot;This function can produce Vectors which do not obey architectural alignment requirements.&quot;</i> which is what I was wondering about"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456346797, "post_id": 35612381, "comment_id": 58909328, "body": "@leftaroundabout: Well, neither <code>ForeignPtr</code> leaks. As long as there is nothing in <code>vector</code> or <code>bytestring</code> that modifies the <code>ForeignPtr</code> of a non-mutable object it should be fine. How did you find this? Hayoo or hoogle?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456347482, "post_id": 35612381, "comment_id": 58909749, "body": "@Zeta: hm, I know little about the internals of either vector or bytestring; makes me rather a bit uneasy thinking that vector might cause trouble by doing some clever re-allocations! This <code>spool</code> package I found through Google, strangely enough."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 1, "creation_date": 1456408519, "post_id": 35612381, "comment_id": 58939889, "body": "In terms of standard library functions, then, these are <code>bytestringToVector bs = runST (V.unsafeThaw (toByteVector bs) &gt;&gt;= V.unsafeFreeze . M.unsafeCast)</code> and <code>vectorToByteString v =  runST (V.unsafeThaw v &gt;&gt;= fmap fromByteVector . V.unsafeFreeze . M.unsafeCast )</code>"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1456485225, "last_edit_date": 1495542227, "creation_date": 1456345595, "answer_id": 35612381, "question_id": 35611414, "link": "https://stackoverflow.com/questions/35611414/apply-a-word32-function-to-a-bytestring/35612381#35612381", "title": "Apply a Word32 function to a ByteString", "body": "<p>A hackish but efficient way is to <a href=\"https://hackage.haskell.org/package/spool-0.1/docs/Data-Vector-Storable-ByteString.html\" rel=\"nofollow noreferrer\">convert to a storable vector</a> (which does not require a copy!), map over that, and convert back:</p>\n\n<pre><code>import Data.Vector.Storable.ByteString\nimport qualified Data.Vector.Storable as VS\nimport qualified Data.ByteString as BS\n\nmapBSChunks :: (VS.Storable a, VS.Storable b)\n              =&gt; (a-&gt;b) -&gt; BS.ByteString -&gt; BS.ByteString\nmapBSChunks f = vectorToByteString . VS.map f . byteStringToVector\n</code></pre>\n\n<p>As per <a href=\"https://stackoverflow.com/questions/35611414/apply-a-word32-function-to-a-bytestring/35612381?noredirect=1#comment58939889_35612381\">Michael's comment</a>, you can easily define those hackish conversion functions locally:</p>\n\n<pre><code>bytestringToVector bs = runST\n   ( V.unsafeThaw (toByteVector bs) &gt;&gt;= V.unsafeFreeze . M.unsafeCast )\nvectorToByteString v = runST\n   ( V.unsafeThaw v &gt;&gt;= fmap fromByteVector . V.unsafeFreeze . M.unsafeCast )\n</code></pre>\n\n<p>though I'd rather depend on a library to provide this, <em>in particular</em> because the unsafe casting is a bit fishy.</p>\n"}], "owner": {"reputation": 465, "user_id": 3541888, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/341f9846dc6bfc0a531e074a507a3e1e?s=128&d=identicon&r=PG&f=1", "display_name": "dmw64", "link": "https://stackoverflow.com/users/3541888/dmw64"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 35612197, "answer_count": 2, "score": 6, "last_activity_date": 1456485225, "creation_date": 1456342574, "question_id": 35611414, "link": "https://stackoverflow.com/questions/35611414/apply-a-word32-function-to-a-bytestring", "title": "Apply a Word32 function to a ByteString", "body": "<p>I have a ByteString <code>b</code> with a length of the form 4*n (with integer n) and want to use <code>map</code> with a function <code>f::Word32-&gt;Word32</code> on <code>b</code> (so that <code>f</code> gets applied to \"<code>b[0..3]</code>\", \"<code>b[4..7]</code>\", etc). How can this be done in an efficient (and elegant) way?</p>\n"}, {"tags": ["haskell", "redis"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456357509, "post_id": 35610524, "comment_id": 58914531, "body": "&quot;I have no way to peek into the Queued monad without executing it.&quot; Really? What about <code>&gt;&gt;= :: Queued a -&gt; (a -&gt; Queued b) -&gt; Queued</code>? You have given <code>computation :: MyRedis (R.Queued R.Status)</code> - very sensible type.  But <code>load</code> should probably be <code>load :: ByteString -&gt; MyRedis (Queued ())</code>. Browsing the library docs, it seems that &quot;Queued&quot; and &quot;RedisTx&quot; are somehow intrinsically tied together.. I don&#39;t see why RedixTx would every be able to appear without Queued (in polymorphic functions, sure, but these will only ever be instantiated with Queued)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456357985, "post_id": 35610524, "comment_id": 58914677, "body": "As an aside, this question is very, very broad. It&#39;s clearly five questions in one! Especially &quot;Is it the right approach?&quot; - this is nearly impossible to answer. How does one quantify what the &quot;right&quot; approach is? In practice, I think, most things are not &quot;right&quot; - simply &quot;good enough&quot;. You can almost certainly accomplish your stated goals, the real question will be, will the design decisions of redis (and of the Haskell bindings to it) help or hinder you? But this is naturally a very difficult question to answer a priori..."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1456358769, "post_id": 35610524, "comment_id": 58914941, "body": "&quot;I have no way to peek into the Queued monad without executing it.&quot; The reason the redis library is designed in that manner is to prevent later <code>RedisTx</code> actions from depending on the result of earlier ones. At the time that you&#39;re batching up the transaction, the earlier commands haven&#39;t run yet. What you want cannot be done. Now, if it were me, I&#39;d probably try to make that more obvious by only exposing an <code>Applicative</code> interface for batched commands, but I expect the author of the lib had a good reason to do it that way."}], "answers": [{"comments": [{"owner": {"reputation": 3393, "user_id": 1350862, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ca95e245ab6f2df8ea64ab934108cc9?s=128&d=identicon&r=PG&f=1", "display_name": "cpa", "link": "https://stackoverflow.com/users/1350862/cpa"}, "edited": false, "score": 0, "creation_date": 1456434204, "post_id": 35616089, "comment_id": 58957984, "body": "Thanks for the lengthy reply. Indeed, I did not correctly understand Redis transaction model. Totally agree with you and the fact that I&#39;d need an applicative interface. As for the worthiness of it all, I was doing that a bit because I wanted to abstract over redis but mostly to have fun abusing the type system."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 3, "last_activity_date": 1456410870, "last_edit_date": 1456410870, "creation_date": 1456360827, "answer_id": 35616089, "question_id": 35610524, "link": "https://stackoverflow.com/questions/35610524/building-a-monad-on-top-of-hedis-a-haskell-redis-lib/35616089#35616089", "title": "Building a monad on top of hedis, a haskell redis lib", "body": "<p>What you want is not possible. In particular, you can't provide a monadic interface while a running a computation in one Redis transaction. Nothing to do with the library you're using - it's just not something Redis can do.</p>\n\n<p>Redis transactions are rather different from the ACID transactions you may be used to from the world of relational databases. Redis transactions have <em>batching</em> semantics, which means that later commands cannot in any way depend on the result of earlier commands.</p>\n\n<p>Look: here's something similar to your example, run at the Redis command line.</p>\n\n<pre><code>&gt; set \"foo\" \"bar\"\nOK\n&gt; multi\nOK\n&gt; get \"foo\"\nQUEUED  -- I can't now set \"baz\" to the result of this command because there is no result!\n&gt; exec\n1) \"bar\"  -- I only get the result after running the whole tran\n</code></pre>\n\n<p>Anyway, that's the purpose of that library's slightly odd <code>Queued</code> type: the idea is to prevent you from accessing any of the results of a batched command until the end of the batch. (It seems that the author wanted to abstract over batched and non-batched commands but there are simpler ways to do that. See below for how I'd simplify the transactional interface.)</p>\n\n<p>So there's no \"choosing what to do next\" when Redis transactions are involved, but the whole point of <code>(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b</code> is that later effects can depend on earlier results. You have to choose between monads and transactions.</p>\n\n<hr>\n\n<p>If you decide you want transactions, there's an alternative to <code>Monad</code> called <code>Applicative</code> which handlily supports purely-static effects. This is exactly what we need. Here's some (entirely untested) code illustrating how I'd cook an <code>Applicative</code> version of your idea.</p>\n\n<pre><code>newtype RedisBatch a = RedisBatch (R.RedisTx (R.Queued a))\n-- being a transactional batch of commands to send to redis\n\ninstance Functor RedisBatch where\n    fmap = liftA\n\ninstance Applicative RedisBatch where\n    pure x = RedisBatch (pure (pure x))\n    (RedisBatch rf) &lt;*&gt; (RedisBatch rx) = RedisBatch $ (&lt;*&gt;) &lt;$&gt; rf &lt;*&gt; rx\n\n-- no monad instance\n\nget :: ByteString -&gt; RedisBatch (Maybe ByteString)\nget key = RedisBatch $ get key\n\nset :: ByteString -&gt; ByteString -&gt; RedisBatch (R.Status)\nset key val = RedisBatch $ set key val\n\nrunBatch :: R.Connection -&gt; RedisBatch a -&gt; IO (R.TxResult a)\nrunBatch conn (RedisBatch x) = R.runRedis conn (R.multiExec x)\n</code></pre>\n\n<p>If I wanted to abstract over transactional-or-not behaviour, as the library author has attempted to do, I'd write a second type <code>RedisCmd</code> exposing a <em>monadic</em> interface, and a class containing my primitive operations, with instances for my two <code>RedisBatch</code> and <code>RedisCmd</code> types.</p>\n\n<pre><code>class Redis f where\n    get :: ByteString -&gt; f (Maybe ByteString)\n    set :: ByteString -&gt; ByteString -&gt; f (R.Status)\n</code></pre>\n\n<p>Now, computations with a type of <code>(Applicative f, Redis f) =&gt; ...</code> could work for either behaviour (transactional or not), but those which require a monad <code>(Monad m, Redis m) =&gt; ...</code> would only be able to run in non-transactional mode.</p>\n\n<hr>\n\n<p>When all's said and done, I'm not convinced it's worth it. People seem to like building abstractions over libraries like this, invariably providing less functionality than the library did and writing more code for bugs to lurk in. Whenever someone says \"I may want to switch databases\" I sigh: the only sufficiently abstract abstraction for that purpose is one which provides no functionality. Worry about switching databases when the time comes that you need to (that is, never).</p>\n\n<p>On the other hand, if your goal is not to abstract the database but just to clean up the interface, the best thing may be to fork the library.</p>\n"}], "owner": {"reputation": 3393, "user_id": 1350862, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2ca95e245ab6f2df8ea64ab934108cc9?s=128&d=identicon&r=PG&f=1", "display_name": "cpa", "link": "https://stackoverflow.com/users/1350862/cpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 1, "accepted_answer_id": 35616089, "answer_count": 1, "score": 2, "last_activity_date": 1456410870, "creation_date": 1456339727, "last_edit_date": 1456350948, "question_id": 35610524, "link": "https://stackoverflow.com/questions/35610524/building-a-monad-on-top-of-hedis-a-haskell-redis-lib", "title": "Building a monad on top of hedis, a haskell redis lib", "body": "<p>I want to write a simple DSL on top of <a href=\"https://hackage.haskell.org/package/hedis-0.7.0/docs/Database-Redis.html\" rel=\"nofollow\">hedis</a>, a redis lib. The goal is to write functions like:</p>\n\n<pre><code>iWantThis :: ByteString -&gt; MyRedis ()\niWantThis bs = do\n  load bs -- :: MyRedis () It fetches a BS from Redis and puts it as\n          -- the state in a state monad\n  bs &lt;- get -- :: MyRedis (Maybe ByteString) Gets the current state\n  put $ doSomethingPure bs -- :: MyMonad () Updates the state\n  commit -- :: MyRedis () Write to redis\n</code></pre>\n\n<p>The basic idea is to fetch data from redis, put it in a state monad, do some stuff with the state and then put the updated state back into redis.</p>\n\n<p>Obviously, it should be atomic so <code>load</code> and <code>put</code> should happen in the same Redis transaction. Hedis permits that by wrapping calls to <code>Redis</code> in a <code>RedisTx (Queued a)</code>. For example, we have <code>get :: ByteString -&gt; RedisTx (Queued a)</code>.\n<code>Queued</code> is a monad and you then run <code>multiExec</code> on your <code>Queued a</code> to execute everything in the <code>Queued a</code> in the same transaction. So I tried to define my <code>MyRedis</code> as such:</p>\n\n<pre><code>import qualified Database.Redis as R\nnewtype MyRedis a = MyRedis { runMyRedis :: StateT MyState R.RedisTx a } -- deriving MonadState, MyState...\n</code></pre>\n\n<p>The <code>run</code> function calls <code>multiExec</code> so I'm sure that as long as I stay in <code>MyRedis</code> everything happens in the same transaction.</p>\n\n<pre><code>run :: MyRedis (R.Queued a) -&gt; MyState -&gt; IO (R.TxResult a)\nrun m s = R.runRedis (undefined :: R.Connection) (R.multiExec r)\n  where r = evalStateT (runMyRedis m) s\n</code></pre>\n\n<p>Furthermore, I can define <code>commit</code> as:</p>\n\n<pre><code>commit :: ByteString -&gt; MyRedis (R.Queued R.Status)\ncommit bs = do\n  MyState new &lt;- get\n  (MyRedis . lift) (R.set bs new)\n</code></pre>\n\n<p>And a <code>computation</code> would look like:</p>\n\n<pre><code>computation :: MyRedis (R.Queued R.Status)\ncomputation =  do\n  load gid\n  MyState bs &lt;- get\n  put $ MyState (reverse bs)\n  commit gid\n  where gid = \"123\"\n</code></pre>\n\n<p>But I can't figure out how to write \"load\"</p>\n\n<pre><code>load :: ByteString -&gt; MyRedis ()\nload gid = undefined\n</code></pre>\n\n<p>Actually, I think that it is not possible to write <code>load</code>, because <code>get</code> is of type <code>ByteString -&gt; RedisTx (Queued (Maybe ByteString))</code> and I have no way to peek into the <code>Queued</code> monad without executing it.</p>\n\n<p>Questions: </p>\n\n<ol>\n<li><p>Is it correct that because of the type of Hedis's get, it doesn't make sense to define a <code>load</code> function with the semantics above?</p></li>\n<li><p>Is it possible to change the <code>MyRedis</code> type definition to make it work?</p></li>\n<li><p>Hedis doesn't define a <code>RedisT</code> monad transformer. If such a transformer existed, would it be of any help?</p></li>\n<li><p>Hedis defines (but does not export to lib users) a <code>MonadRedis</code> typeclass; would making my monad an instance of that typeclass help?</p></li>\n<li><p>Is it the right approach? I want to: </p>\n\n<ul>\n<li>Abstract over Redis (I may switch someday to another DB)</li>\n<li>Restrict the Redis functions available to my users (basically only lifting to <code>MyRedis</code> <code>get</code> and <code>set</code>)</li>\n<li>Guarantee that when I run my monad everything happens in the same (redis) transaction</li>\n<li>Put my redis abstraction at the same level as other functions in my monad</li>\n</ul></li>\n</ol>\n\n<p>You can play with the code at <a href=\"http://pastebin.com/MRqMCr9Q\" rel=\"nofollow\">http://pastebin.com/MRqMCr9Q</a>. Sorry for the pastebin, lpaste.net is down at the moment.</p>\n"}, {"tags": ["haskell", "haskell-lens", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 3100, "user_id": 933616, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ac358baf891ce02fb4a686c1ad6b9ac4?s=128&d=identicon&r=PG", "display_name": "Benjamin Kovach", "link": "https://stackoverflow.com/users/933616/benjamin-kovach"}, "edited": false, "score": 0, "creation_date": 1456341622, "post_id": 35610552, "comment_id": 58906319, "body": "A Traversal is fine; this was exactly what I was looking for."}], "tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 2, "last_activity_date": 1456339834, "creation_date": 1456339834, "answer_id": 35610552, "question_id": 35610248, "link": "https://stackoverflow.com/questions/35610248/cleanly-accessing-nested-data-in-lens-aeson/35610552#35610552", "title": "Cleanly accessing nested data in lens-aeson", "body": "<p>Use <code>_Value</code> for the empty case:</p>\n\n<pre><code>&gt; (\"null\" :: String) ^? _Value\nJust Null\n&gt; (\"null\" :: String) ^? (foldl (.) _Value $ map key [\"foo\", \"bar\"])\nNothing\n&gt; (\"{ \\\"a\\\": { \\\"b\\\": 8} }\" :: String) ^? (foldl (.) _Value $ map key [\"a\", \"b\"])\nJust (Number 8.0)\n</code></pre>\n\n<p>Also <code>path</code> as you describe cannot be a <code>Lens</code> as it's partial (as you mention!), at best it is <code>Traversal</code>. Yet if you are really sure what you are doing, than you can use <a href=\"http://haddock.stackage.org/lts-5.4/lens-4.13/Control-Lens-Traversal.html#v:singular\" rel=\"nofollow\"><code>signular</code></a> to convert <code>Traversal</code> into <code>Lens</code>.</p>\n"}], "owner": {"reputation": 3100, "user_id": 933616, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/ac358baf891ce02fb4a686c1ad6b9ac4?s=128&d=identicon&r=PG", "display_name": "Benjamin Kovach", "link": "https://stackoverflow.com/users/933616/benjamin-kovach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "accepted_answer_id": 35610552, "answer_count": 1, "score": 1, "last_activity_date": 1456339834, "creation_date": 1456338841, "question_id": 35610248, "link": "https://stackoverflow.com/questions/35610248/cleanly-accessing-nested-data-in-lens-aeson", "title": "Cleanly accessing nested data in lens-aeson", "body": "<p>I have the following bit of code, and I'm not happy with it:</p>\n\n<p><pre><code>\nimport Data.Aeson.Lens\nimport Data.Aeson.Types\nimport Data.Text hiding (foldl, map)</p>\n\n<p>path :: (Applicative f, AsValue t) => [Text] -> (Value -> f Value) -> t -> f t\npath [] = error \"No path provided\" \npath (i:is) = foldl (.) (key i) (map key is)\n</pre></code></p>\n\n<p><code>path</code> is meant to be a lens into a nested JSON object. For instance:</p>\n\n<pre><code>\"{ \\\"a\\\": { \\\"b\\\": 8} }\" ^? path [\"a\", \"b\"] == Just (Number 8.0)\n</code></pre>\n\n<p>Currently this works, but the somewhat obvious shortcoming is that the function is not total.</p>\n\n<p>I tried the following definitions:</p>\n\n<ol>\n<li><pre><code>path is = foldl (.) id (map key is)\n</code></pre></li>\n<li><pre><code>path [] = id\npath (i:is) = foldl (.) (key i) (map key is)\n</code></pre></li>\n<li><pre><code>-- This one doesn't compile\npath [] = _Object\npath (i:is) = foldl (.) (key i) (map key is)\n</code></pre></li>\n</ol>\n\n<p>Running the same code block as above with these definitions yields <code>Nothing</code>, instead of the expected <code>8</code>.</p>\n\n<p>I'm almost sure this is a case of type juggling that I'm just missing, but I can't figure out how to make this work with a total function. The expected behavior is for <code>path []</code> to be a <code>Lens</code> which focused on the whole json object.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 5, "creation_date": 1456334435, "post_id": 35608734, "comment_id": 58901882, "body": "I&#39;m afraid this is not possible. But note that you can circumvent the name clash by using  <code>import Prelude hiding (not)</code>. \u2014 On another note, it seems a pretty bad idea to call this function <code>not</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456336462, "post_id": 35609375, "comment_id": 58903255, "body": "If you still have to use <code>Foo.Bar.not</code> instead of <code>B.not</code>, what&#39;s the point of going to all the extra trouble of making this a recursive module import? And if you say you can use <code>B.not</code>, please test this. I did, and it&#39;s not so easy as you might think."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456336766, "post_id": 35609375, "comment_id": 58903450, "body": "@DanielWagner Whoops, sorry, that&#39;s a typo."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456336813, "post_id": 35609375, "comment_id": 58903478, "body": "@DanielWagner My compiler doesn&#39;t implement Mutually recursive modules (at least not very well)."}], "tags": [], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "is_accepted": false, "score": 0, "last_activity_date": 1456336774, "last_edit_date": 1456336774, "creation_date": 1456336024, "answer_id": 35609375, "question_id": 35608734, "link": "https://stackoverflow.com/questions/35608734/alias-a-module-defined-in-the-same-file-in-haskell/35609375#35609375", "title": "Alias a module defined in the same file in Haskell", "body": "<p>This should work</p>\n\n<pre><code>module Foo.Bar (\n  Bar,\n  B.not\n) where\n\nimport qualified Foo.Bar as B (not)\n\ndata Bar = Some Int | Other Int\nnot (Some x) = undefined\nnot (Other x) = B.not $ Some x\n</code></pre>\n\n<p>be warned though, that if you are using GHC, you will probably need to do some extra work: <a href=\"https://wiki.haskell.org/Mutually_recursive_modules#GHC\" rel=\"nofollow\">https://wiki.haskell.org/Mutually_recursive_modules#GHC</a></p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1456336865, "creation_date": 1456336865, "answer_id": 35609631, "question_id": 35608734, "link": "https://stackoverflow.com/questions/35608734/alias-a-module-defined-in-the-same-file-in-haskell/35609631#35609631", "title": "Alias a module defined in the same file in Haskell", "body": "<p>I think it should be technically possible, if a bit painful, in GHC. For example, I would expect things to work if you produced the following two files (following the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/separate-compilation.html#mutual-recursion\" rel=\"nofollow\">documentation on mutual recursion</a>):</p>\n\n<pre><code>-- Foo/Bar.hs-boot\nmodule Foo.Bar where\nimport Prelude(Either)\nnot :: Either a a -&gt; a\n\n-- Foo/Bar.hs\nmodule Foo.Bar where\nimport Prelude (Either(..))\nimport {-# SOURCE #-} Foo.Bar as B\nnot (Left x) = x\nnot (Right x) = B.not (Left x)\n</code></pre>\n\n<p>However, when I try this, I get a complaint that <code>B.not</code> is not in scope. I suspect this is a bug in GHC, and have filed a ticket <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11637\" rel=\"nofollow\">here</a> to see if the devs agree.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1456338525, "post_id": 35610076, "comment_id": 58904464, "body": "Well, if you&#39;re going to change the question, a simple <code>NoImplicitPrelude</code> (or <code>import Prelude ()</code> or <code>import Prelude hiding (not)</code>) seems like it fixes things without spurious names or redefinition gymnastics."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456338737, "post_id": 35610076, "comment_id": 58904586, "body": "@DanielWagner: Sure, but the question seems a bit like an XY problem. My answer originally contained <code>import Prelude hiding (...)</code>, but that was more or less already covered by yours, so I removed it before posting."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456338979, "post_id": 35610076, "comment_id": 58904741, "body": "Your solution to an XY problem is to post an answer covering Z...?"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1456339948, "post_id": 35610076, "comment_id": 58905352, "body": "@DanielWagner <i>nomen omen</i>"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1456340005, "post_id": 35610076, "comment_id": 58905392, "body": "Anyway it should be noted that <code>not = notBar</code> without a type signature may trigger the monomorphism restriction (depending on the ghc version etc) and thus be more monomorphic than it needs to be."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1456340261, "post_id": 35610076, "comment_id": 58905547, "body": "@Bakuriu: Eh, <code>not</code> has a type signature (although it&#39;s slightly hidden). Also, I think I might be missing something on your &quot;nomen omen&quot; remark."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1456340455, "post_id": 35610076, "comment_id": 58905663, "body": "Oh, didn&#39;t see that. Anyway I was just jokingly pointing out that Daniel Wagner said you were trying to cover the Z in an XY problem when your nickname is Zeta so... <a href=\"https://en.wikipedia.org/wiki/Nominative_determinism\" rel=\"nofollow noreferrer\">nomen omen</a>"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 1, "last_activity_date": 1456392201, "last_edit_date": 1456392201, "creation_date": 1456338271, "answer_id": 35610076, "question_id": 35608734, "link": "https://stackoverflow.com/questions/35608734/alias-a-module-defined-in-the-same-file-in-haskell/35610076#35610076", "title": "Alias a module defined in the same file in Haskell", "body": "<blockquote>\n  <p>Is there a way to alias <code>Foo.Bar</code> to e.g. <code>B</code> [...]?</p>\n</blockquote>\n\n<p>While I'm not sure whether there is a way to alias a module in itself, you could easily alias <code>not</code>:</p>\n\n<pre><code>module Foo.Bar (\n   Bar,\n   Foo.Bar.not\n ) where\n\ndata Bar = Some Int | Other Int\n\nnotBar, not :: Bar -&gt; Bool\nnotBar (Some  x) = ...\nnotBar (Other x) = notBar (Some x)\n\n-- Use 'notBar' in this module, but export only 'not'.    \nnot = notBar\n</code></pre>\n\n<p>Given that <code>notBar</code> and <code>B.not</code> differ only a single character in length, I think this is more or less a valid solution. Furthermore, it doesn't depend on any compiler quirks.</p>\n\n<p>Alternatively, hide the bindings that use the same name from <code>Prelude</code>:</p>\n\n<pre><code>module Foo.Bar (\n   Bar,\n   not\n ) where\n\nimport Prelude hiding (not)    \n\ndata Bar = Some Int | Other Int\n\nnot :: Bar -&gt; Bool\nnot (Some  x) = ...\nnot (Other x) = notBar (Some x)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "is_accepted": false, "score": 0, "last_activity_date": 1456347088, "creation_date": 1456347088, "answer_id": 35612830, "question_id": 35608734, "link": "https://stackoverflow.com/questions/35608734/alias-a-module-defined-in-the-same-file-in-haskell/35612830#35612830", "title": "Alias a module defined in the same file in Haskell", "body": "<p>Here is a GHC compatible answer, although its a bit of a clutch:</p>\n\n<pre><code>-- B.hs\nmodule B (\n  Bar,\n  B.not\n) where\ndata Bar = Some Int | Other Int\nnot (Some x) = undefined\nnot (Other x) = B.not $ Some x\n-- Foo.Bar.hs\nmodule Foo.Bar (module Foo.Bar) where\nimport B as Foo.Bar\n</code></pre>\n\n<p>When <code>Foo.Bar</code> is imported, <code>Bar</code>, <code>not</code>, <code>Foo.Bar.Bar</code> and <code>Foo.Bar.not</code> are provided (the first two are suppresed if <code>Foo.Bar</code> is imported qualified.)</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2757025"}, "is_accepted": true, "score": 0, "last_activity_date": 1456363423, "last_edit_date": 1495542225, "creation_date": 1456363423, "answer_id": 35616529, "question_id": 35608734, "link": "https://stackoverflow.com/questions/35608734/alias-a-module-defined-in-the-same-file-in-haskell/35616529#35616529", "title": "Alias a module defined in the same file in Haskell", "body": "<p>It seems like this isn't possible using anything compliant with the Haskell specification and working in GHC.</p>\n\n<p>Anyway, there are ways a similar result can be achieved:</p>\n\n<ul>\n<li>As @leftaroundabout <a href=\"https://stackoverflow.com/questions/35608734/alias-a-module-defined-in-the-same-file-in-haskell/35612830#comment58901882_35608734\">pointed out</a>, <code>import Prelude hiding (not)</code> will help.</li>\n<li>@PyRulez' <a href=\"https://stackoverflow.com/a/35612830/2757025\">answer</a> suggests creating a module called <code>B</code> and exporting that module within <code>Foo.Bar</code></li>\n<li>@Zeta's <a href=\"https://stackoverflow.com/a/35610076/2757025\">answer</a> suggests aliasing <code>Foo.Bar.not</code> to <code>notBar</code></li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2757025"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 35616529, "answer_count": 5, "score": 2, "last_activity_date": 1456392201, "creation_date": 1456334163, "question_id": 35608734, "link": "https://stackoverflow.com/questions/35608734/alias-a-module-defined-in-the-same-file-in-haskell", "title": "Alias a module defined in the same file in Haskell", "body": "<p>I've got a module like that:</p>\n\n<pre><code>module Foo.Bar (\n  Bar,\n  not\n) where\ndata Bar = Some Int | Other Int\nnot (Some x) = ...\nnot (Other x) = Foo.Bar.not $ Some x\n</code></pre>\n\n<p>As you see, I have to write <code>Foo.Bar.not</code> because <code>not</code> is defined in <code>Prelude</code>.</p>\n\n<p>Is there a way to alias <code>Foo.Bar</code> to e.g. <code>B</code> so that I can write <code>not (Other x) = B.not $ Some x</code> in the very file where <code>not</code> is defined?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "edited": false, "score": 1, "creation_date": 1456328656, "post_id": 35606523, "comment_id": 58897358, "body": "there is another problem with <code>fs == []</code> and &quot;No instance for (Eq (Int -&gt; Int))&quot;"}], "tags": [], "owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "is_accepted": false, "score": 1, "last_activity_date": 1456328601, "creation_date": 1456328601, "answer_id": 35606523, "question_id": 35606068, "link": "https://stackoverflow.com/questions/35606068/maybe-you-havent-applied-enough-arguments-to-a-function/35606523#35606523", "title": "Maybe you haven&#39;t applied enough arguments to a function?", "body": "<pre><code>|f  : (compose fs x)\n    ^\n</code></pre>\n\n<p>I think your problem is that this colon shouldn't be here.\n<code>:</code> in Haskell is the list constructor which is why the compiler is telling you that you are trying to return an <code>[Int -&gt; Int]</code>. If it wasn't there, f would simply be applied and you'd be returning an <code>Int</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456329471, "post_id": 35606565, "comment_id": 58897999, "body": "This changes the semantics of the original function, since <code>comp [negate, (+2)] 3</code> is <code>-5</code> in the question, but <code>-1</code> in your variant."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1456330034, "last_edit_date": 1456330034, "creation_date": 1456328723, "answer_id": 35606565, "question_id": 35606068, "link": "https://stackoverflow.com/questions/35606068/maybe-you-havent-applied-enough-arguments-to-a-function/35606565#35606565", "title": "Maybe you haven&#39;t applied enough arguments to a function?", "body": "<p>You have to apply the functions on the result repeatedly, and empty function list should be treated as id.</p>\n\n<pre><code>Prelude&gt; let comp :: [(Int-&gt;Int)] -&gt; Int -&gt; Int\nPrelude|     comp [] x = x\nPrelude|     comp (f:fs) x = comp fs (f x)\nPrelude|\nPrelude&gt; comp [(^2),(+1)] 3\n10\n</code></pre>\n\n<p>I read the problem wrong, above is applying functions from left to right.  If you're composing from left to right (rightmost function will be applied first) it should be like this (now point-free)</p>\n\n<pre><code>Prelude&gt; let comp2 :: [(Int-&gt;Int)] -&gt; Int -&gt; Int\nPrelude|     comp2 [] = id\nPrelude|     comp2 (f:fs) = f . comp2 fs\nPrelude|\nPrelude&gt; comp2 [(^2),(+1)] 3\n16\nPrelude&gt; comp2 [negate,(+2)] 3\n-5\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 5975200, "user_type": "registered", "profile_image": "https://graph.facebook.com/1108310225846550/picture?type=large", "display_name": "David Jambalaya", "link": "https://stackoverflow.com/users/5975200/david-jambalaya"}, "edited": false, "score": 0, "creation_date": 1456330031, "post_id": 35606699, "comment_id": 58898451, "body": "wow, thank you all very much. I just had some spaghetti, and when I came back here there are so many qualitative answers. Now I believe that I understand what the problem is/ was. Thank you. ( I guess you mean fold ?) :D. Thank you all"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 63, "user_id": 5975200, "user_type": "registered", "profile_image": "https://graph.facebook.com/1108310225846550/picture?type=large", "display_name": "David Jambalaya", "link": "https://stackoverflow.com/users/5975200/david-jambalaya"}, "edited": false, "score": 1, "creation_date": 1456330850, "post_id": 35606699, "comment_id": 58899073, "body": "@DavidJambalaya You&#39;re welcome. Note that <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">you want to accept an answer</a>, so that others know that you&#39;re question has been answered. You can change the accepted answer at any time. Aaaaaaand I just noticed an error in my answer. And yes, it&#39;s a fold. Not going to tell you which one, though :D."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456349284, "post_id": 35606699, "comment_id": 58910721, "body": "What do you mean &quot;which fold&quot;? <code>foldMap</code> will certainly do it regardless!"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456350494, "post_id": 35606699, "comment_id": 58911408, "body": "@dfeuer <code>foldMap Endo</code> is a neat trick; / for newcomers it&#39;s dark magic. / With <code>fold*</code> you&#39;re almost on par / if you replace <code>*</code> by <code>l</code> or <code>r</code>."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456350911, "post_id": 35606699, "comment_id": 58911637, "body": "At least until the default books use post FTP material."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456351012, "post_id": 35606699, "comment_id": 58911701, "body": "@Zeta, see my answer for a way that goes a bit beyond :-)"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 6, "last_activity_date": 1456331003, "last_edit_date": 1456331003, "creation_date": 1456329069, "answer_id": 35606699, "question_id": 35606068, "link": "https://stackoverflow.com/questions/35606068/maybe-you-havent-applied-enough-arguments-to-a-function/35606699#35606699", "title": "Maybe you haven&#39;t applied enough arguments to a function?", "body": "<p>First of all, <code>(:)</code> is only for adding elements at the front of a list (or pattern match against those), so you have to replace </p>\n\n<pre><code>f : compose fs x\n</code></pre>\n\n<p>with</p>\n\n<pre><code>f (compose fs x)\n</code></pre>\n\n<p>Next, you have to use an expression of type <code>Bool</code> or a pattern match in a guard:</p>\n\n<pre><code>| fs == []  = -- this line is still wrong, see below\n| otherwise = f (compose f xs)\n</code></pre>\n\n<p>However, there is no <code>Eq</code> instance for functions. The equivalence of two functions is undecidable (in general), so use <code>null :: [a] -&gt; Bool</code> instead of <code>(==) :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool</code>:</p>\n\n<pre><code>compose :: [(Int -&gt; Int)] -&gt; Int -&gt; Int\ncompose [] x = x\ncompose (f:fs) x  \n  | null fs   = f x\n  | otherwise = f (compose fs x)\n</code></pre>\n\n<p>Since <code>compose [] x</code> is the same as <code>x</code> you can even remove the check:</p>\n\n<pre><code>compose :: [(Int -&gt; Int)] -&gt; Int -&gt; Int\ncompose []     x = x\ncompose (f:fs) x = f (compose fs x)\n</code></pre>\n\n<h3>Exercises</h3>\n\n<ul>\n<li>Extend <code>compose [(+1), (+2)] 1</code> (replace it with its definition) without getting rid of intermediate terms. Do you notice a pattern?</li>\n<li>Does this pattern remind you of a library function?</li>\n<li>Try to use that library function in order to write <code>compose</code>.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456377939, "post_id": 35613981, "comment_id": 58920770, "body": "<i>Your answer is quite off the hook, / though it&#39;s a shame for the time it took. / Please don&#39;t see this as critique / but your this answer is off topic.</i> I&#39;m not sure how far they go <a href=\"https://www.uni-bamberg.de/?id=24762\" rel=\"nofollow noreferrer\">in David&#39;s lecture</a>, but given the syntactical errors, I don&#39;t think they handled <code>Foldable</code> or <code>Monoid</code>. Also given that you don&#39;t answer the original question you&#39;re using an orbital cannon to shoot a tree but slightly miss it. After  all, <code>compose1 = foldr (.) id</code> and <code>compose2 = foldr (flip (.)) id</code> (with <code>Control.Category</code>)."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456378397, "post_id": 35613981, "comment_id": 58920943, "body": "Well, not 100% off-topic, you provide a working <code>compose</code>, but you get what I mean (and the rhyme on &quot;critique&quot; was really nice; have no idea why I&#39;m rhyming lately, though)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456380024, "post_id": 35613981, "comment_id": 58921659, "body": "@Zeta, that&#39;s not quite true, since an infinite snoc list, say, may give a result in some categories using my code, but never using <code>foldr</code>."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1456382412, "post_id": 35613981, "comment_id": 58922737, "body": "Sure, probably should have added &quot; in the context of this question&quot;. For &quot;How can I fold endomorphisms in a <code>Foldable</code> into a single one&quot;, your answer is pretty much spot on. (Don&#39;t you need to sleep once in a while?)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456382634, "post_id": 35613981, "comment_id": 58922846, "body": "@Zeta, I try, but I&#39;m not very good at going to bed at sensible hours."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1456353266, "last_edit_date": 1456353266, "creation_date": 1456350953, "answer_id": 35613981, "question_id": 35606068, "link": "https://stackoverflow.com/questions/35606068/maybe-you-havent-applied-enough-arguments-to-a-function/35613981#35613981", "title": "Maybe you haven&#39;t applied enough arguments to a function?", "body": "<p>Since its been a few hours, let me offer a couple hints about writing this as a fold. Since there are two directions you can compose the functions, and I don't get any points for doing it the right way, I'll just show both.</p>\n\n<p>First, some boilerplate:</p>\n\n<pre><code>import Data.Monoid (Dual (..))\nimport Control.Category (Category (..))\nimport Data.Foldable (Foldable (foldMap))\nimport Prelude hiding (id, (.))\n</code></pre>\n\n<p>Next, a type explaining that a monoid is a category with exactly one object:</p>\n\n<pre><code>newtype Cat c a = Cat { getCat :: c a a }\n\ninstance Category c =&gt; Monoid (Cat c a) where\n  mempty = Cat id\n  mappend (Cat f) (Cat g) = Cat (f . g)\n</code></pre>\n\n<p>Finally, the functions you seek, generalized from <code>-&gt;</code> to an arbitrary <code>Category</code>:      </p>\n\n<pre><code>compose1 :: (Foldable f, Category c) =&gt; f (c a a) -&gt; c a a\ncompose1 = getCat . foldMap Cat\n\ncompose2 :: (Foldable f, Category c) =&gt; f (c a a) -&gt; c a a\ncompose2 = getCat . getDual . foldMap (Dual . Cat)\n</code></pre>\n\n<p>Exercise for the reader: write the equivalent functions replacing <code>Category</code> with <code>Semigroupoid</code> and <code>Foldable</code> with <code>Foldable1</code>.</p>\n\n<p>Another exercise for the reader: write the <code>Monoid (Cat c a)</code> instance using <code>Data.Coerce.coerce</code> and/or <code>#.</code> and <code>.#</code> from <code>Data.Profunctor.Unsafe</code> to avoid spurious closure allocation.</p>\n\n<hr>\n\n<p>P.S. The <code>Cat</code> type only explains half the story. Here's the rest:</p>\n\n<pre><code>newtype Mon m a b = Mon m\n\ninstance Monoid m =&gt; Category (Mon m) where\n  id = Mon mempty\n  Mon m . Mon n = Mon (m `mappend` n)\n</code></pre>\n\n<p>It would arguably be more precise to use</p>\n\n<pre><code>data Mon m a b where\n  Mon :: m -&gt; Mon m a a\n</code></pre>\n\n<p>But this would be less efficient without really adding much value.</p>\n"}], "owner": {"reputation": 63, "user_id": 5975200, "user_type": "registered", "profile_image": "https://graph.facebook.com/1108310225846550/picture?type=large", "display_name": "David Jambalaya", "link": "https://stackoverflow.com/users/5975200/david-jambalaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1259, "favorite_count": 1, "accepted_answer_id": 35606699, "answer_count": 4, "score": 6, "last_activity_date": 1456353266, "creation_date": 1456327464, "last_edit_date": 1456328977, "question_id": 35606068, "link": "https://stackoverflow.com/questions/35606068/maybe-you-havent-applied-enough-arguments-to-a-function", "title": "Maybe you haven&#39;t applied enough arguments to a function?", "body": "<p>I am learning Haskell in a course in university, and there is a Exam-Exercise, where we need to define a function which takes a List of functions  <code>[(Int -&gt;Int)]</code> and another parameter of Type <code>Int</code> and returns an <code>Int</code>. So the Type should be </p>\n\n<pre><code>compose :: [(Int -&gt;Int)] -&gt; Int -&gt; Int.\n</code></pre>\n\n<p>The function should return a composition of the functions in the list from left to right and apply it to the 2nd parameter.\nI tried the following :</p>\n\n<pre><code>compose :: [(Int -&gt; Int)] -&gt; Int -&gt; Int\ncompose [] x = x\ncompose (f:fs) x  \n    |fs == [] = f x\n    |f  : (compose fs x)\n</code></pre>\n\n<p>But the compiler throws an error :</p>\n\n<pre><code>003Exam.hs:24:22:\n    Couldn't match expected type \u2018Int\u2019 with actual type \u2018[Int -&gt; Int]\u2019\n    In the expression: f : (compose fs x)\n    In an equation for \u2018compose\u2019:\n        compose (f : fs) x\n          | fs == [] = f x\n          | otherwise = f : (compose fs x)\n\n003Exam.hs:24:28:\n    Couldn't match expected type \u2018[Int -&gt; Int]\u2019 with actual type \u2018Int\u2019\n    In the second argument of \u2018(:)\u2019, namely \u2018(compose fs x)\u2019\n    In the expression: f : (compose fs x)\n</code></pre>\n\n<p>If I leave the last line away, like :</p>\n\n<pre><code>compose :: [(Int -&gt; Int)] -&gt; Int -&gt; Int\ncompose [] x = x\ncompose (f:fs) x  \n    |fs == [] = f x\n</code></pre>\n\n<p>then I also get an error - this is the one that I realy don't understand : </p>\n\n<pre><code>003Exam.hs:23:13:\n    No instance for (Eq (Int -&gt; Int))\n      (maybe you haven't applied enough arguments to a function?)\n      arising from a use of \u2018==\u2019\n    In the expression: fs == []\n    In a stmt of a pattern guard for\n               an equation for \u2018compose\u2019:\n      fs == []\n    In an equation for \u2018compose\u2019: compose (f : fs) x | fs == [] = f x\n</code></pre>\n\n<p>I would be happy for any help that clarifies what I am doing wrong.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 2, "creation_date": 1456320065, "post_id": 35603309, "comment_id": 58891204, "body": "Try run <code>stack clean</code> and delete the <code>.stack-work</code> folder at your project root. I fixed some of my building issues by doing so."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 5, "creation_date": 1456320571, "post_id": 35603309, "comment_id": 58891577, "body": "on a first glance this look like you forgot to put an module in the ` exposed-modules` list in the cabal-file (you can use <code>other-modules</code> too - but they have to go in one or the other AFAIK)"}, {"owner": {"reputation": 185, "user_id": 5947160, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/014d62812c166da62bbd18cdbf719d01?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/5947160/mario"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456376289, "post_id": 35603309, "comment_id": 58920127, "body": "@Carsten, it&#39;s there."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456378650, "post_id": 35603309, "comment_id": 58921054, "body": "what do you men with &quot;it&#39;s there&quot;? Is <code>Web.MyLib.SomeFile.MyFile</code> in <code>exposed-modules</code> (for the lib - not for your executable)? - Please post your <code>.cabal</code> and your folder-structure"}, {"owner": {"reputation": 185, "user_id": 5947160, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/014d62812c166da62bbd18cdbf719d01?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/5947160/mario"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456392933, "post_id": 35603309, "comment_id": 58928772, "body": "@Carsten, yes, it&#39;s in exposed-modules. moreover, as I said, so far it&#39;s compiled well, for weeks."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456393148, "post_id": 35603309, "comment_id": 58928926, "body": "well then sorry but I&#39;m afraid that there is just not enough information to remote-debug your problem - have you tried to clean up the build artifacts as zakyggaps proposed?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456393872, "post_id": 35603309, "comment_id": 58929456, "body": "Also if you a minimal example somewhere I can grab it I could try to look at it for you."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 1, "creation_date": 1461445892, "post_id": 35603309, "comment_id": 61205409, "body": "There&#39;s a known <a href=\"http://docs.haskellstack.org/en/stable/faq/#i-get-strange-ld-errors-about-recompiling-with-fpic\" rel=\"nofollow noreferrer\">non-deterministic issue with <code>ld</code></a>. I&#39;m not sure whether your problem is related. There&#39;s a suggested workaround <a href=\"https://www.reddit.com/r/haskell/comments/3qv1rl/a_link_error_in_haskellr/\" rel=\"nofollow noreferrer\">in this reddit thread</a>. Does that work for you?"}], "owner": {"reputation": 185, "user_id": 5947160, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/014d62812c166da62bbd18cdbf719d01?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/5947160/mario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1475881560, "creation_date": 1456319853, "last_edit_date": 1475881560, "question_id": 35603309, "link": "https://stackoverflow.com/questions/35603309/an-error-in-stack-build-of-haskell-which-doesnt-make-sense", "title": "An error in &quot;stack build&quot; of haskell which doesn&#39;t make sense", "body": "<p>So far, for weeks, everything has been ok. But all of a sudden \"stack build\" has begun returning this (obfuscated a bit):</p>\n\n<pre><code>$ stack build\nMyLib-0.1.0.1: build\nPreprocessing library MyLib-0.1.0.1...\n[53 of 55] Compiling Web.MyLib.SomeFile.MyFile ( src/Web/MyLib/SomeFile/MyFile.hs, .stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/Web/MyLib/SomeFile/MyFile.o )\nIn-place registering MyLib-0.1.0.1...\nPreprocessing executable 'MyLib-exe' for MyLib-0.1.0.1...\nLinking .stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/MyLib-exe/MyLib-exe ...\n.stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/MyLib-exe/MyLib-exe-tmp/Main.o:(.text+0xf6): undefined reference to `fdsfdzuC6HIw1NjUcr0zzrqlCnCP5y_WebziMyLibziSomeFileziMyFile_MyFileGetSingle1_info'\n.stack-work/dist/x86_64-linux/Cabal-1.22.5.0/build/MyLib-exe/MyLib-exe-tmp/Main.o: In function `S6VL_srt':\n(.data+0xe8): undefined reference to `fdsfdzuC6HIw1NjUcr0zzrqlCnCP5y_WebziMyLibziSomeFileziMyFile_MyFileGetSingle1_closure'\ncollect2: error: ld returned 1 exit status\n\n--  While building package MyLib-0.1.0.1 using:\n      /home/me123/.stack/setup-exe-cache/x86_64-linux/setup-Simple-Cabal-1.22.5.0-ghc-7.10.3 --builddir=.stack-work/dist/x86_64-linux/Cabal-1.22.5.0 build lib:MyLib exe:MyLib-exe --ghc-options \" -ddump-hi -ddump-to-file\"\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p>I've done \"stack update, upgrade\" but it's not helped.</p>\n"}, {"tags": ["haskell", "ghc", "haskell-stack", "haskell-turtle"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1456314261, "post_id": 35600243, "comment_id": 58887052, "body": "<code>stack runghc</code> is excuted in the global project. You can add the dependency to the <code>stack.yaml</code> of your global project."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1456314977, "post_id": 35600243, "comment_id": 58887551, "body": "Or you can put a <code>stack.yaml</code> file along with your script and refer this config file in your script by <code>--stack-yaml .&#47;your-stack.yaml</code> to achieve some portability, but the additional package still have to be installed in your global project I guess."}, {"owner": {"reputation": 1593, "user_id": 2287402, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Q5Rvg.png?s=128&g=1", "display_name": "Elie G&#233;nard", "link": "https://stackoverflow.com/users/2287402/elie-g%c3%a9nard"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1456317258, "post_id": 35600243, "comment_id": 58889193, "body": "The thing is that I don&#39;t have a global project. I&#39;d like to execute this script as a standalone program, as you can do with a normal turtle script."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1456317853, "post_id": 35600243, "comment_id": 58889658, "body": "That&#39;s weird. When I run <code>stack runghc</code> I see &quot;Run from outside a project, using implicit global project config, using resolver: lts-5.1 from implicit global project&#39;s config file:\\path\\to\\global\\stack.yaml&quot; in my console, are you sure the behavior of your stack is different?"}], "answers": [{"tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": false, "score": 2, "last_activity_date": 1458267180, "creation_date": 1458267180, "answer_id": 36074954, "question_id": 35600243, "link": "https://stackoverflow.com/questions/35600243/stack-interpreter-option-add-an-external-dependency/36074954#36074954", "title": "Stack interpreter option - Add an external dependency", "body": "<p>We do not support all of stack.yaml options on the commandline.  I recommend putting a stack.yaml somewhere.  If you don't want to just put it in the same folder as the script, use \"--stack-yaml\"</p>\n"}], "owner": {"reputation": 1593, "user_id": 2287402, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Q5Rvg.png?s=128&g=1", "display_name": "Elie G&#233;nard", "link": "https://stackoverflow.com/users/2287402/elie-g%c3%a9nard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1458267180, "creation_date": 1456311620, "last_edit_date": 1456317185, "question_id": 35600243, "link": "https://stackoverflow.com/questions/35600243/stack-interpreter-option-add-an-external-dependency", "title": "Stack interpreter option - Add an external dependency", "body": "<p>I'm making a script with <a href=\"https://hackage.haskell.org/package/turtle\" rel=\"nofollow\">Turtle</a> and I need a dependency from GitHub. I saw that you can add such a dependency when you make a project by putting this in your <code>stack.yaml</code>:</p>\n\n<pre><code>packages:\n- location:\n    git: https://github.com/githubuser/reponame.git\n    commit: somecommitID\n</code></pre>\n\n<p>But is it possible to add it via the command line? </p>\n\n<p>This is the command line used to run the script:</p>\n\n<pre><code>stack --resolver lts-3.2 --install-ghc runghc --package turtle\n</code></pre>\n\n<p><strong>Edit</strong>:</p>\n\n<p>These are the first lines of my script:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-3.1 --install-ghc runghc --package turtle\n\nimport Turtle\n...\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1456289879, "post_id": 35593539, "comment_id": 58873113, "body": "Reuse the pre-existing Maybe and tuple instances."}, {"owner": {"reputation": 185, "user_id": 5947160, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/014d62812c166da62bbd18cdbf719d01?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/5947160/mario"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1456290593, "post_id": 35593539, "comment_id": 58873356, "body": "@ThomasM.DuBuisson, how?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456291849, "post_id": 35593539, "comment_id": 58873797, "body": "&quot;Doesn&#39;t work&quot; - how so? Does it compile? Is the runtime behaviour different that expected?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456292320, "post_id": 35593539, "comment_id": 58873965, "body": "By calling <code>parseJSON</code> within."}, {"owner": {"reputation": 185, "user_id": 5947160, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/014d62812c166da62bbd18cdbf719d01?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/5947160/mario"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456293680, "post_id": 35593539, "comment_id": 58874536, "body": "@dfeuer, for which part of it?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456296216, "post_id": 35593539, "comment_id": 58875590, "body": "@Mario your inner object (<code>var2</code> from what I can guess) - btw: it would help if you just add a small example of you input-JSON ^^"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456296456, "post_id": 35593539, "comment_id": 58875701, "body": "@Carsten: <code>{ &quot;id&quot; :&quot;GA23210X&quot;, &quot;var1&quot;: false, &quot;var2&quot;: null}</code> and <code>{ &quot;id&quot; :&quot;A211MNLR&quot;, &quot;var1&quot;: false, &quot;var2&quot;: { &quot;id&quot;: &quot;GA23210X&quot;, &quot;name&quot;: &quot;child&quot;} }</code>. Or something similar, I guess."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 1, "last_activity_date": 1456301676, "last_edit_date": 1456301676, "creation_date": 1456301359, "answer_id": 35596548, "question_id": 35593539, "link": "https://stackoverflow.com/questions/35593539/how-can-i-parse-data-for-parsejson/35596548#35596548", "title": "How can I parse data for parseJSON?", "body": "<p>this based on the <em>suspected</em> JSON @zeta gave and the idea of @dfeuer </p>\n\n<p>here is a compiling/working example</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule ParseJson where\n\nimport Data.Aeson\nimport Data.Text\nimport Data.Text.Encoding\nimport Data.ByteString.Lazy (fromStrict)\n\ntestData :: Text\ntestData = \"{ \\\"id\\\" :\\\"A211MNLR\\\", \\\"var1\\\": false, \\\"var2\\\": { \\\"id\\\": \\\"GA23210X\\\", \\\"name\\\": \\\"child\\\"} }\"\n\ntestData2 :: Text\ntestData2 = \"{ \\\"id\\\" :\\\"GA23210X\\\", \\\"var1\\\": false, \\\"var2\\\": null}\"\n\ndata MyData = MyData \n    { myDataId :: Text\n    , myDataVar1 :: Bool\n    , myDataVar2 :: Maybe (Text, Text)\n    } deriving Show\n\ninstance FromJSON MyData where\n  parseJSON (Object v) =\n    MyData &lt;$&gt; v .: \"id\"\n           &lt;*&gt; v .: \"var1\"\n           &lt;*&gt; (v .:? \"var2\" &gt;&gt;= parsePair)\n    where parsePair (Just (Object o)) = Just &lt;$&gt; ((,) &lt;$&gt; o .: \"id\" &lt;*&gt; o.: \"name\")\n          parsePair _                 = pure Nothing\n\nparse :: Text -&gt; Maybe MyData\nparse = decode . fromStrict . encodeUtf8\n</code></pre>\n\n<p>here are the tests:</p>\n\n<pre><code>\u03bb&gt; parse testData\nJust (MyData {myDataId = \"A211MNLR\", myDataVar1 = False, myDataVar2 = Just (\"GA23210X\",\"child\")})\n\u03bb&gt; parse testData2\nJust (MyData {myDataId = \"GA23210X\", myDataVar1 = False, myDataVar2 = Nothing})\n</code></pre>\n\n<h3>remarks</h3>\n\n<ul>\n<li>I used <code>Text</code> instead of <code>UUID</code> - as far as I can see there is a <code>fromText</code> in the <code>uuid</code> package you can use to transform it further (but it's a <code>Maybe UUID</code> as well) or you could write the <code>FromJSON</code> instance for it - sadly I have no time to do it right - sorry :(</li>\n<li>it's not pretty and there is probably an operator for what I did with <code>parsePair</code> already there </li>\n</ul>\n\n<p>but it should be a start for you to figure it out</p>\n"}], "owner": {"reputation": 185, "user_id": 5947160, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/014d62812c166da62bbd18cdbf719d01?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/5947160/mario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "accepted_answer_id": 35596548, "answer_count": 1, "score": 0, "last_activity_date": 1456301676, "creation_date": 1456289551, "last_edit_date": 1456290806, "question_id": 35593539, "link": "https://stackoverflow.com/questions/35593539/how-can-i-parse-data-for-parsejson", "title": "How can I parse data for parseJSON?", "body": "<p>I have a data which I want to parse from json:</p>\n\n<pre><code>data MyData = MyData \n    { myDataId :: UUID \n    , myDataVar1 :: Bool\n    , myDataVar2 :: Maybe (UUID, String)\n    }\n\ninstance FromJSON MyData where\n  parseJSON (Object v) =\n    MyData &lt;$&gt; v .: \"id\"\n        &lt;*&gt; v .: \"var1\"\n        &lt;*&gt; ((,) &lt;$&gt; ((v .: \"var2\") &gt;&gt;= (.: \"id\")) &lt;*&gt; ((v .: \"var2\") &gt;&gt;= (.: \"name\"))) --- ??? doesn't work\n</code></pre>\n\n<p>How can I parse myDataVar2?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 372, "user_id": 2534752, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/RodVg.jpg?s=128&g=1", "display_name": "Marek Milkovi\u010d", "link": "https://stackoverflow.com/users/2534752/marek-milkovi%c4%8d"}, "edited": false, "score": 0, "creation_date": 1456285448, "post_id": 35592745, "comment_id": 58871835, "body": "Thanks. So conclusion is that I need to somewhat convert between them. Is function like yours <code>maybeToIO</code> common and good practice in Haskell code? I recently have to do one project in Haskell and do not want to produce some kind of spaghetti code. Also, I recently found out that doing something like <code>foo :: Int -&gt; IO (Maybe Int)</code> seems to kinda work for me, but is it bad thing to do? Is it ugly?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1456285560, "post_id": 35592745, "comment_id": 58871862, "body": "It may also help to see how do notation is desugared into the standard monadic operators. <a href=\"https://en.wikibooks.org/wiki/Haskell/Syntactic_sugar#Do_notation\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/Syntactic_sugar#Do_notation</a>"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 372, "user_id": 2534752, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/RodVg.jpg?s=128&g=1", "display_name": "Marek Milkovi\u010d", "link": "https://stackoverflow.com/users/2534752/marek-milkovi%c4%8d"}, "edited": false, "score": 0, "creation_date": 1456290655, "post_id": 35592745, "comment_id": 58873377, "body": "@MarekMilkovi\u010d I would say only for IO, since IO is error-prone anyway. In general, each monad conversion has to be done differently, and is occasionally impossible. Also, you will find that <code>foo</code> won&#39;t really be that useful (in particular, most uses of <code>foo</code> will have a better way to do it.)"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 372, "user_id": 2534752, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/RodVg.jpg?s=128&g=1", "display_name": "Marek Milkovi\u010d", "link": "https://stackoverflow.com/users/2534752/marek-milkovi%c4%8d"}, "edited": false, "score": 2, "creation_date": 1456290708, "post_id": 35592745, "comment_id": 58873396, "body": "@MarekMilkovi\u010d Note that you can convert both of them into a <i>third</i> monad. That is what behzad.nouri is doing. He converts both <code>IO</code> and <code>Maybe</code> into <code>MaybeT IO</code>, a kind of fusion of the two monads."}, {"owner": {"reputation": 372, "user_id": 2534752, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/RodVg.jpg?s=128&g=1", "display_name": "Marek Milkovi\u010d", "link": "https://stackoverflow.com/users/2534752/marek-milkovi%c4%8d"}, "edited": false, "score": 0, "creation_date": 1456291154, "post_id": 35592745, "comment_id": 58873563, "body": "@PyRulez I&#39;ll probably need more time to dive into Haskell world and play around first a bit before actually starting my school project. I&#39;ll accept your answer since you were first, but both answers here were really useful and learned me something. Thanks again."}], "tags": [], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "is_accepted": true, "score": 8, "last_activity_date": 1456284901, "creation_date": 1456284901, "answer_id": 35592745, "question_id": 35592415, "link": "https://stackoverflow.com/questions/35592415/multiple-monads-in-one-do-block/35592745#35592745", "title": "Multiple monads in one do-block", "body": "<p>The short answer is no. do notation is based on two things</p>\n\n<pre><code>return :: a -&gt; m a\n&gt;&gt;= :: m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>Notice in <code>&gt;&gt;=</code> that although you can work with two different inner types (<code>a</code> and <code>b</code>), it only works with one outer type, one monad (<code>m</code>). Both <code>m a</code> and <code>a -&gt; m b</code> are the same monad.</p>\n\n<p>The longer answer is, you have to convert them to the same monad. For example, <code>Maybe</code> can be converted to <code>IO</code> like so:</p>\n\n<pre><code>maybeToIO Nothing = error \"No thing\"\nmaybeToIO (Just a) = return a\n</code></pre>\n\n<p>Monads, in general, can not be converted into each other though, except in special cases.</p>\n\n<hr>\n\n<p>So why does <code>&gt;&gt;=</code> only work with one monad? Well just look at <a href=\"https://hackage.haskell.org/package/base/docs/Control-Monad.html#v:-62--62--61-\" rel=\"noreferrer\">this</a>. It is <em>defined</em> so as to work with a single monad at a time, and do-notation is <em>defined</em> to work with <code>&gt;&gt;=</code>. The reasons why this definition was chosen is somewhat complicated, but I can edit it in if someone wants.</p>\n\n<p>You could come up with your own <code>&gt;&gt;=</code> that works with multiple monads, and then use <a href=\"https://ocharles.org.uk/blog/guest-posts/2014-12-06-rebindable-syntax.html\" rel=\"noreferrer\">rebindable syntax</a>, but this would probably be hard.</p>\n"}, {"comments": [{"owner": {"reputation": 372, "user_id": 2534752, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/RodVg.jpg?s=128&g=1", "display_name": "Marek Milkovi\u010d", "link": "https://stackoverflow.com/users/2534752/marek-milkovi%c4%8d"}, "edited": false, "score": 0, "creation_date": 1456290156, "post_id": 35593166, "comment_id": 58873207, "body": "Thank you. I seem to start getting the concept, but I have one question. Is this a preferable way of doing what I need, or should I reconsider my design? It&#39;s just that it seems for my like I would have to have <code>-&gt; IO a</code> in almost every single function."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 372, "user_id": 2534752, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/RodVg.jpg?s=128&g=1", "display_name": "Marek Milkovi\u010d", "link": "https://stackoverflow.com/users/2534752/marek-milkovi%c4%8d"}, "edited": false, "score": 0, "creation_date": 1456290771, "post_id": 35593166, "comment_id": 58873419, "body": "@MarekMilkovi\u010d It depends on how you want errors to propagate (do you want to use exceptions, or <code>Nothing</code>s.)"}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 372, "user_id": 2534752, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/RodVg.jpg?s=128&g=1", "display_name": "Marek Milkovi\u010d", "link": "https://stackoverflow.com/users/2534752/marek-milkovi%c4%8d"}, "edited": false, "score": 2, "creation_date": 1456291348, "post_id": 35593166, "comment_id": 58873632, "body": "@MarekMilkovi\u010d ideally only very few small functions should do IO. Everything else should be pure"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 12, "last_activity_date": 1456289068, "last_edit_date": 1495541867, "creation_date": 1456287466, "answer_id": 35593166, "question_id": 35592415, "link": "https://stackoverflow.com/questions/35592415/multiple-monads-in-one-do-block/35593166#35593166", "title": "Multiple monads in one do-block", "body": "<p>With monad transformers, all you need to do is</p>\n\n<ol>\n<li><p>change the function signature from <code>Int -&gt; Maybe Int</code> to</p>\n\n<pre><code>foo :: Int -&gt; MaybeT IO Int\n</code></pre></li>\n<li><p><a href=\"https://wiki.haskell.org/Lifting#Monad_lifting\" rel=\"nofollow noreferrer\"><strong>lift</strong></a> all the IO actions inside the <code>do</code> block (or <code>liftIO</code> in this case). See <a href=\"https://stackoverflow.com/a/34913872/625914\">here why you need this lifting and what exactly it does</a>.</p></li>\n<li><p>run the function using <code>runMaybeT</code></p></li>\n</ol>\n\n<p>A minimal example would be:</p>\n\n<pre><code>import Control.Monad.Trans (lift)\nimport Control.Monad.Trans.Maybe (MaybeT, runMaybeT)\n\nimport System.IO (openFile, hClose, hSeek, hIsEOF)\nimport System.IO (IOMode(ReadMode), SeekMode(AbsoluteSeek))\n\nfoo :: Int -&gt; MaybeT IO Int\nfoo i = do\n    h &lt;- lift $ openFile \"test.txt\" ReadMode\n    -- move the handle i bytes ahead\n    lift . hSeek h AbsoluteSeek $ fromIntegral i\n    eof &lt;- lift $ hIsEOF h  -- check if hit end of file\n    lift $ hClose h\n    if eof then fail \"eof!\" else return i\n</code></pre>\n\n<p>then, </p>\n\n<pre><code>\\&gt; runMaybeT $ foo 1\nJust 1\n\\&gt; runMaybeT $ foo 100  -- would hit eof\nNothing\n</code></pre>\n\n<p>what you get out of this would be of the type:</p>\n\n<pre><code>(runMaybeT . foo) :: Int -&gt; IO (Maybe Int)\n</code></pre>\n"}], "owner": {"reputation": 372, "user_id": 2534752, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/RodVg.jpg?s=128&g=1", "display_name": "Marek Milkovi\u010d", "link": "https://stackoverflow.com/users/2534752/marek-milkovi%c4%8d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1924, "favorite_count": 2, "accepted_answer_id": 35592745, "answer_count": 2, "score": 11, "last_activity_date": 1456289068, "creation_date": 1456282764, "question_id": 35592415, "link": "https://stackoverflow.com/questions/35592415/multiple-monads-in-one-do-block", "title": "Multiple monads in one do-block", "body": "<p>I am currently trying to learn Haskell and I really cannot understand the concept of using just one one monad in do-block. If I have <code>foo :: Int -&gt; Maybe Int</code> and want to use for example function <code>hIsEOF :: Handle -&gt; IO Bool</code> in this function. Can someone please explain me on some basic example how would I use <code>hIsEOF</code> and could somehow work with <code>Bool</code>?</p>\n\n<p>I have been trying to search here and on google, but I always run into some advanced stuff where basically noone explains how, they just give advice on how to fit it right into OP's code. I saw monad transformers mentioned in those threads but even after reading few resources, I cannot seem to find the right way on how to use them.</p>\n"}, {"tags": ["html", "haskell", "scotty"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 5947160, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/014d62812c166da62bbd18cdbf719d01?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/5947160/mario"}, "edited": false, "score": 0, "creation_date": 1456392867, "post_id": 35597570, "comment_id": 58928715, "body": "so theoretically I can use Heist exactly the same way in Snap?"}, {"owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "reply_to_user": {"reputation": 185, "user_id": 5947160, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/014d62812c166da62bbd18cdbf719d01?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/5947160/mario"}, "edited": false, "score": 0, "creation_date": 1456393862, "post_id": 35597570, "comment_id": 58929445, "body": "@Mario I have no experience with Snap, but if you can hand it a ByteString in response to a request, sure."}], "tags": [], "owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "is_accepted": true, "score": 0, "last_activity_date": 1456304554, "creation_date": 1456304554, "answer_id": 35597570, "question_id": 35592164, "link": "https://stackoverflow.com/questions/35592164/scotty-html-how-to-intertwine-them/35597570#35597570", "title": "Scotty + Html -&gt; how to intertwine them?", "body": "<p>You can use <code>Heist.renderTemplate</code> to turn a template into <code>Blaze.ByteString.Builder.Builder</code> (that's not blaze-html, I assume that's okay) and then set that via <code>Web.Scotty.raw</code>. For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE OverloadedStrings #-}\nimport Heist\nimport Heist.Interpreted\n\nimport Web.Scotty (scotty, get, raw, setHeader)\n\nimport Control.Monad.Trans.Either (runEitherT)\nimport Control.Monad.IO.Class (liftIO)\nimport Blaze.ByteString.Builder (toByteString)\n\nimport qualified Data.ByteString.Lazy as DBL\nimport qualified Data.Text.Lazy.Encoding as DT\n\nimport Text.XmlHtml\n\nmain = scotty 3000 $\n    get \"/\" $ do\n        -- normally you would probably load your templates from a file,\n        -- but to keep the example small\n        (Right heist) &lt;- liftIO $ runEitherT $ initHeist emptyHeistConfig\n        let heist' = addTemplate \"foo\" [TextNode \"Hello world!\"] Nothing heist\n\n        (Just (builder, mime)) &lt;- renderTemplate heist' \"foo\"\n\n        setHeader \"Content-Type\" (DT.decodeUtf8 $ DBL.fromStrict mime)\n        raw $ DBL.fromStrict $ toByteString builder\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 5947160, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/014d62812c166da62bbd18cdbf719d01?s=128&d=identicon&r=PG&f=1", "display_name": "Mario", "link": "https://stackoverflow.com/users/5947160/mario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 35597570, "answer_count": 1, "score": 1, "last_activity_date": 1456304554, "creation_date": 1456280959, "question_id": 35592164, "link": "https://stackoverflow.com/questions/35592164/scotty-html-how-to-intertwine-them", "title": "Scotty + Html -&gt; how to intertwine them?", "body": "<p>How can I work with html pages, <strong>including</strong> html templates, in Scotty? But not via Blaze because I don't like describing its structure in haskell code. It think I should heist, but how exactly to intertwine it with Scotty?</p>\n"}, {"tags": ["haskell", "automation", "quickcheck"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1456267699, "post_id": 35589705, "comment_id": 58865889, "body": "This error should get cought at compile time, e.g. <code>-fwarn-incomplete-patterns -Werror</code> (<a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/options-sanity.html\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/users_guide/&hellip;</a>). Depending on what your other errors are, <code>-Wall -Werror</code> could be sufficient, even before a single QuickCheck test runs."}, {"owner": {"reputation": 385, "user_id": 5725848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1086e1b40cdecc9467217bd45406c126?s=128&d=identicon&r=PG&f=1", "display_name": "44701", "link": "https://stackoverflow.com/users/5725848/44701"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456267805, "post_id": 35589705, "comment_id": 58865931, "body": "Thanks but I am aware of such flags. I am interested in general purpose runtime error checking."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1456268509, "post_id": 35589705, "comment_id": 58866233, "body": "See <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.2/docs/Test-QuickCheck-Monadic.html\" rel=\"nofollow noreferrer\">Test.QuickCheck.Monadic</a>, which allows for the testing of arbitrary <code>IO</code> wrapped values. You can check for runtime errors using <code>Control.Exception.catch</code> or the like. In this specific case, you would want to catch the <code>PatternMatchFail</code> exception - but of course you can check for any exception you like."}, {"owner": {"reputation": 385, "user_id": 5725848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1086e1b40cdecc9467217bd45406c126?s=128&d=identicon&r=PG&f=1", "display_name": "44701", "link": "https://stackoverflow.com/users/5725848/44701"}, "edited": false, "score": 0, "creation_date": 1456269399, "post_id": 35589705, "comment_id": 58866618, "body": "What I mean is to ensure that there are no errors. I am not interested in specific errors, or looking for custom errors I define. If that is what you are trying to say I apologies for misunderstanding."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1456272525, "post_id": 35589705, "comment_id": 58867845, "body": "I haven&#39;t thought it through, but could you use a dummy prop like <code>dummy f = \\x -&gt; seq (f x) True</code> in combination with <code>catch</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456275076, "post_id": 35589705, "comment_id": 58868652, "body": "@epsilonhalbe, the dummy you seek is <code>Control.Exception.evaluate</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1456277407, "post_id": 35589705, "comment_id": 58869364, "body": "This is not the Haskell way. Convert your partial functions into total ones with a codomain that has an observable failure; then it is trivial to write a quickcheck property that failure is not observed. I make this a comment rather than an answer as trying to influence the reader to change his question in such a fundamental regard is not the StackOverflow way. ;-)"}, {"owner": {"reputation": 385, "user_id": 5725848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1086e1b40cdecc9467217bd45406c126?s=128&d=identicon&r=PG&f=1", "display_name": "44701", "link": "https://stackoverflow.com/users/5725848/44701"}, "edited": false, "score": 0, "creation_date": 1456282580, "post_id": 35589705, "comment_id": 58871021, "body": "There are all kinds of functions, and situations in Haskell where testing like this is nice. Real world Haskell is not always perfect. Just look at the standard library there are all kinds of partial functions, and functions that can fail at run time. Index bounds errors are another common one. When larger programs are written functions may expect data to be encoded in a way that cannot easily be represented in the type. This leads to partial functions or strangely typed functions where maybe is inconvenient."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456329665, "post_id": 35589705, "comment_id": 58898151, "body": "@HarpoRoeder, lots of real world Haskell <i>bugs</i> are caused by programmers trying to take the easy way out using partial functions, calling <code>error</code> to report user errors, etc. They think these are all fine for days, weeks, or months till they run into some weird error they can&#39;t seem to debug, some wacky space leak, etc., and then someone has to dig through the whole pile of crud and redo it properly. Obviously, there&#39;s a balance, and some code will need to have (hopefully-unreachable) errors, but that should only be done with due consideration."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 2, "last_activity_date": 1456312652, "creation_date": 1456312652, "answer_id": 35600656, "question_id": 35589705, "link": "https://stackoverflow.com/questions/35589705/quickcheck-for-runtime-errors/35600656#35600656", "title": "Quickcheck for runtime errors", "body": "<p>Rather make sure that functions that don't handle <code>IO</code> don't throw exceptions if possible.\nExceptions can only get caught in <code>IO</code>, and they kind of break the things you otherwise expect from a pure function.</p>\n\n<p>It's possible with some helpers from\n<a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Exception.html\" rel=\"nofollow\"><code>Control.Exception</code></a>\nand <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.2/docs/Test-QuickCheck-Monadic.html\" rel=\"nofollow\"><code>Test.QuickCheck.Monadic</code></a>:</p>\n\n<pre><code>&gt; import           Control.Exception       (Exception, PatternMatchFail,\n&gt;                                           SomeException, evaluate,\n&gt;                                           fromException, try)\n&gt; import           Data.Either             (either)\n&gt; import           Test.Hspec              (anyException, describe, hspec, it,\n&gt;                                           shouldThrow)\n&gt; import           Test.QuickCheck         hiding (Result)\n&gt; import           Test.QuickCheck.Monadic (assert, monadicIO, run)\n</code></pre>\n\n<p>For starters, let's write a function that enables us to check that a certain exception is thrown:</p>\n\n<pre><code>&gt; throwsExceptionOr :: Exception e =&gt; (e -&gt; Bool) -&gt; (a -&gt; Bool) -&gt; a -&gt; IO Bool\n&gt; throwsExceptionOr pe pa = fmap (either pe pa) . try . evaluate\n</code></pre>\n\n<p>This enables you to write tests like this:</p>\n\n<pre><code>&gt; prop_fun_1 x = monadicIO . run $\n&gt;   throwsExceptionOr (const True :: SomeException -&gt; Bool)\n&gt;                     (== 5)\n&gt;                     (foo x)\n</code></pre>\n\n<p><code>throwsExceptionOr</code> is very general, so that you can define your own helpers:</p>\n\n<pre><code>&gt; -- | Should always throw an exception.\n&gt; throwsException :: Exception e =&gt; (e -&gt; Bool) -&gt; a -&gt; IO Bool\n&gt; throwsException p = fmap (either p (const False)) . try . evaluate\n\n&gt; -- | Should either pass the test or throw an exception.\n&gt; exceptionOr :: a -&gt; (a -&gt; Bool) -&gt; IO Bool\n&gt; exceptionOr x p = fmap (either anyException p) . try . evaluate $ x\n&gt;   where\n&gt;     anyException :: SomeException -&gt; Bool\n&gt;     anyException = const True\n</code></pre>\n\n<p>Now you can write your tests as usual:</p>\n\n<pre><code>&gt; data Result = A | B deriving (Enum, Show, Eq, Ord, Bounded, Read)\n&gt; \n&gt; instance Arbitrary Result where\n&gt;   arbitrary = elements [A, B]\n&gt; \n&gt; foo :: Result -&gt; Int\n&gt; foo A = 5\n&gt; \n&gt; prop_foo x = monadicIO . run $ foo x `exceptionOr` (== 5)\n</code></pre>\n\n<p>You can go further and move the <code>monadicIO . run</code> into another helper, but\nthat's left as an exercise. Furthermore, you can make the functions compatible\nwith other testing frameworks, such as <code>hspec</code> or <code>tasty</code>:</p>\n\n<pre><code>&gt; main :: IO ()\n&gt; main = hspec $ do\n&gt;   describe \"foo\" $ do\n&gt;     it \"either returns five or throws a pattern match fail\" $ propertyIO $ \\x -&gt;\n&gt;       throwsExceptionOr patternMatchFail (==5) (foo x)\n&gt; \n&gt;     it \"throws an exception on input B\" $\n&gt;       evaluate (foo B) `shouldThrow` anyException\n&gt; \n&gt;  where\n&gt;   patternMatchFail :: PatternMatchFail -&gt; Bool\n&gt;   patternMatchFail _ = True\n&gt; \n&gt;   -- I think there is a better combinator for this\n&gt;   propertyIO f = property $ \\x -&gt; monadicIO . run $ f x\n</code></pre>\n\n<p>That being said, <strong>regardless of the used languages</strong> you want to get rid of\npossible runtime errors at <strong>compile time</strong> if possible.  This includes getting\nrid of partial functions or possible type nonsense.  This depends on the actual\nuse, of course.  If you can verify that <code>head</code> <strong>always</strong> gets called on a non-empty\nlist throughout your program, go ahead and use it.  If you can't, use pattern\nmatching (see <a href=\"https://stackoverflow.com/questions/6364409/why-does-haskells-head-crash-on-an-empty-list-or-why-doesnt-it-return-an\">this discussion</a>\n on <code>head</code>'s type).</p>\n\n<p>Either way, given that older versions of GHC don't provide stack calls, you rather want to have errors at compile time than errors without a stack trace at runtime (recent versions of GHC have some nice features for this).</p>\n"}], "owner": {"reputation": 385, "user_id": 5725848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1086e1b40cdecc9467217bd45406c126?s=128&d=identicon&r=PG&f=1", "display_name": "44701", "link": "https://stackoverflow.com/users/5725848/44701"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 35600656, "answer_count": 1, "score": 1, "last_activity_date": 1456312652, "creation_date": 1456267280, "last_edit_date": 1456267908, "question_id": 35589705, "link": "https://stackoverflow.com/questions/35589705/quickcheck-for-runtime-errors", "title": "Quickcheck for runtime errors", "body": "<p>I have interest in using the quick check library but it seems that it is designed to test properties. What I would like to do is generate random data for my defined data types and test functions I have written. I do not care about what the result is, just if the function produces a runtime error when fed random data. All of the quick check examples I have seen are for testing properties of functions like is the result greater than 5 when fed random data. Is there a way to use quick check in this manner? Something like</p>\n\n<pre><code>data Result = A | B\n\nfun :: Result -&gt; Int\nfun A = 5\n\nmain = check fun\n</code></pre>\n\n<p>In the above code I have a custom data type, and a incomplete function. This function will fail if passed B. There are of course more types of runtime errors than just incomplete functions. I would like to have check generate data, and feed it to the function. Not caring what the result is. Is quick check able to do this?</p>\n\n<p>Edit -\nI should note that I am not looking for flags that check for incomplete patterns, and what not. I am interested in general purpose runtime error checks.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456266168, "post_id": 35588785, "comment_id": 58865159, "body": "Also note if you name your function <code>zipWith</code> - you have to <code>import qualified Prelude as P</code> or <code>import Prelude hiding (zipWith)</code>. Or just name your function <code>myZipWith</code>."}, {"owner": {"reputation": 2910, "user_id": 4683264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Ufhvj.png?s=128&g=1", "display_name": "J Atkin", "link": "https://stackoverflow.com/users/4683264/j-atkin"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1456266285, "post_id": 35588785, "comment_id": 58865217, "body": "@epsilonhalbe True, but what would be even better IMO is to name it <code>zipWith&#39;</code> (LYAHFGG is rubbing off on me ;)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1456286270, "post_id": 35588785, "comment_id": 58872051, "body": "<code>zipWith f [] []</code> isn&#39;t necessary; that case is covered by either of <code>[] _</code> or <code>_ []</code>."}, {"owner": {"reputation": 2910, "user_id": 4683264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Ufhvj.png?s=128&g=1", "display_name": "J Atkin", "link": "https://stackoverflow.com/users/4683264/j-atkin"}, "edited": false, "score": 0, "creation_date": 1457381351, "post_id": 35588785, "comment_id": 59371777, "body": "@R.Monks I just updated my answer with a small change."}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 11, "last_activity_date": 1456263835, "creation_date": 1456263835, "answer_id": 35588828, "question_id": 35588785, "link": "https://stackoverflow.com/questions/35588785/write-zipwith-in-haskell/35588828#35588828", "title": "Write Zipwith in Haskell", "body": "<p>Function names must start with a lowercase letter (or symbol). Upper-case letters are reserved for new data types. Your definition would be perfectly correct if it were named <code>zipWith</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2910, "user_id": 4683264, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/Ufhvj.png?s=128&g=1", "display_name": "J Atkin", "link": "https://stackoverflow.com/users/4683264/j-atkin"}, "is_accepted": true, "score": 11, "last_activity_date": 1457402370, "last_edit_date": 1457402370, "creation_date": 1456264128, "answer_id": 35588914, "question_id": 35588785, "link": "https://stackoverflow.com/questions/35588785/write-zipwith-in-haskell/35588914#35588914", "title": "Write Zipwith in Haskell", "body": "<p>Haskell functions <strong><em>must</em></strong> start with a lower case. Upper case names are reserved for other stuff, like data types. In this case it would be a good idea to name your function <code>zipWith'</code>, because <code>'</code> is often used to indicate that the function is almost the same, but with a small change.</p>\n\n<p>P.S.  </p>\n\n<p>Small critique of your code: You can remove the line <code>zipwith f [] [] = []</code> because the other lines catch this case already. If you want you can even write it like this:</p>\n\n<pre><code>zipwith f (x:xs) (y:ys) = f x y : zipwith f xs ys\nzipwith _ _ _ = []\n</code></pre>\n\n<p>Since the first one is the only pattern you care about.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456270327, "post_id": 35589131, "comment_id": 58867008, "body": "I think it assumes it&#39;s a data constructor, which it&#39;s not, and then probably complains that the same variables are bound multiple times by different pattern bindings."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 4, "last_activity_date": 1456264921, "creation_date": 1456264921, "answer_id": 35589131, "question_id": 35588785, "link": "https://stackoverflow.com/questions/35588785/write-zipwith-in-haskell/35589131#35589131", "title": "Write Zipwith in Haskell", "body": "<p>To echo the other answers: Function names <em>must</em> start with a lowercase letter. This is not merely a coding convention; it is part of the actual language syntax. As in, it actually stops stuff compiling if you don't do this.</p>\n\n<p>Other programming languages often have conventions on how you should use case, but the Haskell compiler actually uses this to decide what kind of name you're referring to. In this case, it thinks that <code>Zipwith</code> is some sort of data type, which (naturally) doesn't actually exist, which is why the compiler is confused.</p>\n"}], "owner": {"reputation": 93, "user_id": 5458700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a3c16494eb3ebe0c4bc56455019e643?s=128&d=identicon&r=PG&f=1", "display_name": "R. Monks", "link": "https://stackoverflow.com/users/5458700/r-monks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3527, "favorite_count": 0, "accepted_answer_id": 35588914, "answer_count": 3, "score": 4, "last_activity_date": 1457402370, "creation_date": 1456263714, "last_edit_date": 1456312077, "question_id": 35588785, "link": "https://stackoverflow.com/questions/35588785/write-zipwith-in-haskell", "title": "Write Zipwith in Haskell", "body": "<p>I'm trying to write the <code>Zipwith</code> function in Haskell.</p>\n\n<p>If I run it with the following values, it should return this result:</p>\n\n<pre><code>Prelude&gt; zipWith (+) [10,20,30] [33,44,94]\n[43,64,124]\n</code></pre>\n\n<p>My code so far is:</p>\n\n<pre><code>Zipwith f [] [] = []\nZipwith f [] _ = []\nZipwith f _ [] = []\nZipwith f (x:xs) (y:ys) = (f x y) : (Zipwith f xs ys)\n</code></pre>\n\n<p>However, the compiler tells me that I have multiple functions, all <code>Zipwith</code>, that don't have a data definition, but I thought having one wasn't necessary in Haskell.\nAlso, then it says that I have multiple declarations of f, but it is just an argument, I thought it wouldn't matter that there are multiple definitions of an argument.</p>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["java", "haskell", "frege"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1456244341, "post_id": 35581300, "comment_id": 58852068, "body": "I&#39;m not familiar with frege so I&#39;m assuming it is sufficiently similair to Haskell. You declared <code>PApplet.new</code> to have type <code>() -&gt; IO PApplet</code>, but you&#39;ve used it without an argument: <code>p &lt;- PApplet.new</code> should be <code>p &lt;- PApplet.new ()</code> (and <code>pStr &lt;- p.toString</code> should be <code>pStr &lt;- p.toString p</code>). The line <code>p &lt;- PApplet.new</code> is <i>not</i> a type error, however, because <code>(-&gt;) ()</code> is a monad! The compiler believes you are working in this monad, not IO. I think that the first error (regarding <code>fromList (&quot;test&quot;:[])</code>) is unrelated, but the errors complaining about <code>()\u2192t1</code> are due to this one omission."}, {"owner": {"reputation": 811, "user_id": 4515400, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/JjvHb.png?s=128&g=1", "display_name": "libnull-dev", "link": "https://stackoverflow.com/users/4515400/libnull-dev"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456245151, "post_id": 35581300, "comment_id": 58852664, "body": "Yes, calling <code>PApplet.new</code> without <code>()</code> is a cause of most compiler complains! Really silly am I."}, {"owner": {"reputation": 811, "user_id": 4515400, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/JjvHb.png?s=128&g=1", "display_name": "libnull-dev", "link": "https://stackoverflow.com/users/4515400/libnull-dev"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456245485, "post_id": 35581300, "comment_id": 58852911, "body": "Now the question is simply about how to get rid of <code>Process.fr:14: type error in expression fromList (&quot;test&quot;:[])   type is : STMutable t1 (JArray String)   expected: ArrayOf RealWorld String</code>"}], "answers": [{"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": true, "score": 5, "last_activity_date": 1456246271, "creation_date": 1456246271, "answer_id": 35583405, "question_id": 35581300, "link": "https://stackoverflow.com/questions/35581300/interoperability-with-java-in-frege-especially-in-io-monad/35583405#35583405", "title": "Interoperability with Java in Frege, especially in IO Monad", "body": "<p>You have </p>\n\n<pre><code>ST s X\n</code></pre>\n\n<p>and you want</p>\n\n<pre><code>X\n</code></pre>\n\n<p>and you are in <code>IO</code>, which is nothing but <code>ST RealWorld</code></p>\n\n<p>So, the most natural solution would be to replce the <code>=</code> with <code>&lt;-</code> in the line</p>\n\n<pre><code>args = JArray.fromList [\"test\"]\n</code></pre>\n\n<p>and you're set!</p>\n\n<p>Granted, the whole story is a bit difficult because of the type aliases:</p>\n\n<pre><code>type ArrayOf a x = Mutable a (JArray x)\ntype STMutable s a = ST s (Mutable s a)\n</code></pre>\n\n<p>Had the de-aliaser choosen to translate</p>\n\n<pre><code>ST s (Mutable s (JArray String))\n</code></pre>\n\n<p>back to</p>\n\n<pre><code>ST s (ArrayOf s String)\n</code></pre>\n\n<p>you probably would have seen it.</p>\n"}], "owner": {"reputation": 811, "user_id": 4515400, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/JjvHb.png?s=128&g=1", "display_name": "libnull-dev", "link": "https://stackoverflow.com/users/4515400/libnull-dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 35583405, "answer_count": 1, "score": 4, "last_activity_date": 1456246271, "creation_date": 1456240737, "last_edit_date": 1456241057, "question_id": 35581300, "link": "https://stackoverflow.com/questions/35581300/interoperability-with-java-in-frege-especially-in-io-monad", "title": "Interoperability with Java in Frege, especially in IO Monad", "body": "<p>I would like to translate this java code into Frege Haskell:</p>\n\n<pre><code>    PApplet pApplet = new PApplet();\n    System.out.print(pApplet.toString());\n    PApplet.runSketch(new String[]{\"test\"}, pApplet);\n</code></pre>\n\n<p>I did so far:</p>\n\n<pre><code>data PApplet = mutable native processing.core.PApplet\n  where\n    native new :: () -&gt; IO PApplet\n    native toString :: PApplet -&gt; IO String\n\nnative runSketch processing.core.PApplet.runSketch\n  :: ArrayOf RealWorld String -&gt; PApplet -&gt; IO ()\n\nmain _ = do p &lt;- PApplet.new\n            pStr &lt;- p.toString\n            putStrLn pStr\n            args = JArray.fromList [\"test\"]\n            runSketch args p\n</code></pre>\n\n<p>Part up to <code>main</code> compiles but then I get those errors:</p>\n\n<pre><code>E Process.fr:14: type error in expression fromList (\"test\":[])\n    type is : STMutable t1 (JArray String)\n    expected: ArrayOf RealWorld String\nE Process.fr:15: type error in expression p\n    type is : IO PApplet\n    expected: PApplet\nE Process.fr:12: type error in expression &gt;&gt;= p.toString (\u03bbpStr -&gt; &gt;&gt; (putStrLn pStr) (runSketch (fromList (\"test\":[])) p))\n    type is : IO ()\n    expected: ()\u2192t1\nE Process.fr:11: type error in expression \u03bbp -&gt; &gt;&gt;= p.toString (\u03bbpStr -&gt; &gt;&gt; (putStrLn pStr) (runSketch (fromList (\"test\":[])) p))\n    type is : IO ()\n    expected: ()\u2192t1\nE Process.fr:11: type error in expression &gt;&gt;= new (\u03bbp -&gt; &gt;&gt;= p.toString (\u03bbpStr -&gt; &gt;&gt; (putStrLn pStr) (runSketch (fromList (\"test\":[])) p)))\n    type is : ()\u2192t1\n    expected: IO ()\nE Process.fr:11: type error in expression \u03bb_ -&gt; &gt;&gt;= new (\u03bbp -&gt; &gt;&gt;= p.toString (\u03bbpStr -&gt; &gt;&gt; (putStrLn pStr) (runSketch (fromList (\"test\":[])) p)))\n    type is : ()\u2192t1\n    expected: IO ()\nE Process.fr:12: can't find a type for  p.toString `toString`\n    is neither an overloaded function nor a member of  IO PApplet\n</code></pre>\n\n<p>I'm trying hard to meet compiler criteria, but without success. After countless random combinations this snippet above seems the most reasonable to me. Do I need type hints in <code>do</code> block? I don't get why <code>p &lt;- PApplet.new</code> evaluates into <code>IO PApplet</code>? and how to make <code>JArray.fromList</code> to return <code>ArrayOf RealWorld String</code> ? Frege is great but interoperability is quite daunting. Is it possible to have more examples focused on it on Frege github?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1456240275, "post_id": 35581050, "comment_id": 58848790, "body": "It would kinda help if you showed us how you approached the problem so far, i.e., code please..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1456240828, "post_id": 35581050, "comment_id": 58849291, "body": "Blind guessing: replace <code>read</code> with <code>readMaybe</code>, and handle the error case (<code>import Text.Read</code> first). You should really provide more information in your question."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 10, "creation_date": 1456251030, "post_id": 35581050, "comment_id": 58856576, "body": "Listen up, oh younger one,  / as this is a maddening song. /   Take a look and you will see  / <code>read :: String -&gt; Int</code> is wrong for ye. / It&#39;s type is wrong, it&#39;s result is unknown / if you use it on a random string like <code>&quot;frown&quot;</code>. / But here is for a final hint / you&#39;re looking for <code>readMaybe :: String -&gt; Maybe Int</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1456262088, "post_id": 35581050, "comment_id": 58862939, "body": "lol ... there should be a platinum badge for answers/comments like this ... <b>yo</b>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1456274842, "post_id": 35581050, "comment_id": 58868581, "body": "@Zeta, why isn&#39;t that an answer?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456296191, "post_id": 35581050, "comment_id": 58875576, "body": "@dfeuer: Because I also wanted to improve the question&#39;s quality, but didn&#39;t have the time yesterday."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1456304198, "post_id": 35581050, "comment_id": 58879762, "body": "@Carsten Time for a new challenge: Write at least one answer per week as a poem."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456416960, "post_id": 35581050, "comment_id": 58946797, "body": "The indentation doesn&#39;t really make sense. Please <i>add</i> any that you need."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1456905485, "post_id": 35581050, "comment_id": 59156386, "body": "@Carsten: Second week, <a href=\"http://stackoverflow.com/a/35733380/1139697\">second poem</a> :D."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1456421130, "post_id": 35594952, "comment_id": 58949894, "body": "@dfeuer OK, OK, I will rollback / but please just keep your rep in check / while a bounty would be fine / this reputation should not be mine. / A new who knows more than me / would lighten up with joy and glee. / But if you think it&#39;s <b>that</b> well done / your gift is certainly welcome."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 16, "last_activity_date": 1456512418, "last_edit_date": 1456512418, "creation_date": 1456295736, "answer_id": 35594952, "question_id": 35581050, "link": "https://stackoverflow.com/questions/35581050/stop-program-from-crashing-when-entering-not-numbers-in-a-menu-with-numbered-opt/35594952#35594952", "title": "Stop program from crashing when entering not-numbers in a menu with numbered options", "body": "<p>Listen up, oh younger one,<br>\nas this is a maddening song.<br>\nTake a look and you will see<br>\n<code>read :: String -&gt; Int</code> is wrong for ye. </p>\n\n<p>Its type is wrong, its result is unknown;<br>\nif been used on a string like <code>\"frown\"</code>.<br>\nBut here is for the final hint<br>\nyou're looking for <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Text-Read.html#v:readMaybe\"><code>readMaybe :: String -&gt; Maybe Int</code></a>.</p>\n\n<hr>\n\n<p>The problem with <code>read</code> is that there is no notion of failure in its type signature:</p>\n\n<pre><code>read :: Read a =&gt; String -&gt; a\n</code></pre>\n\n<p>What happens if we set <code>a</code> to <code>Int</code> and try to use it on the string <code>\"frown\"</code>? It will result in an exception:</p>\n\n<pre><code>ghci&gt; read \"frown\" :: Int\n*** Exception: Prelude.read: no parse\n</code></pre>\n\n<p>After all, what should it return? Anything from the domain of <code>Int</code> is a valid value.</p>\n\n<p>Enter <code>readMaybe :: Read a =&gt; String -&gt; Maybe a</code>. Now the potential error is covered in the type signature, and it does not result in an exception anymore:</p>\n\n<pre><code>ghci&gt; import Text.Read\nghci&gt; readMaybe \"frown\" :: Maybe Int\nNothing\nghci&gt; readMaybe \"15\" :: Maybe Int\nJust 15\n</code></pre>\n\n<p>We can wrap this in a new function called <code>getNumber</code> that repeatedly asks for an <code>Int</code> until the user actually provides one:</p>\n\n<pre><code>getNumber :: IO Int\ngetNumber = do\n  line &lt;- getLine\n  case (readMaybe line :: Maybe Int) of\n     Just x  -&gt; return x\n     Nothing -&gt; putStrLn \"Please enter a number!\" &gt;&gt; getNumber\n</code></pre>\n\n<p>You can then use it to get an <code>Int</code> instead of a <code>String</code> for your <code>age</code>:</p>\n\n<pre><code>searchAge = do\n    ...\n    age   &lt;- getNumber\n    input &lt;- readFile \"databas.txt\"\n    putStrLn \"\\n Here are all the people that matches your search: \\n\"\n    let people = parse input\n        output = map personToString (filter (\\p -&gt; personAge p == age) people)\n    in putStrLn (unlines output)\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5969243, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e51661e50e52ca200f948e7f60077b4?s=128&d=identicon&r=PG", "display_name": "prawniie", "link": "https://stackoverflow.com/users/5969243/prawniie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 1, "answer_count": 1, "score": -5, "last_activity_date": 1456512418, "creation_date": 1456240103, "last_edit_date": 1456416914, "question_id": 35581050, "link": "https://stackoverflow.com/questions/35581050/stop-program-from-crashing-when-entering-not-numbers-in-a-menu-with-numbered-opt", "title": "Stop program from crashing when entering not-numbers in a menu with numbered options", "body": "<p>My search function works properly when the input is a number, but crashes when it is not. What can I add to my code to prevent that from happening?</p>\n\n<pre><code>searchAge = do\n  putStrLn \"\\n Please type the age of the person you're looking for: \\n\"\n  age &lt;- getLine\n  input &lt;- readFile $ \"databas.txt\"\n  putStrLn \"\\n Here are all the people that matches your search: \\n\"\n  let people = parse input\n      output = map personToString (filter (\\p -&gt; personAge p == read age) people)\n    in putStrLn (unlines output)\n\nputStrLn \"Let's get back to the search menu again!\"     \nsearchDatabase\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 5, "creation_date": 1456226673, "post_id": 35576239, "comment_id": 58838930, "body": "Do you understand why <code>[&quot;abc&quot;, &quot;def&quot;] :: [String]</code>?"}, {"owner": {"reputation": 103, "user_id": 5905842, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72a475cb0ae5799b68eaf7006bf00c1b?s=128&d=identicon&r=PG&f=1", "display_name": "something", "link": "https://stackoverflow.com/users/5905842/something"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1456226805, "post_id": 35576239, "comment_id": 58839034, "body": "Yes but what is confusing me is <code>(fst, snd) :: ((a, b) -&gt; a, (a1, b1) -&gt; b1)</code>, why is it not the same for lists?"}, {"owner": {"reputation": 103, "user_id": 5905842, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72a475cb0ae5799b68eaf7006bf00c1b?s=128&d=identicon&r=PG&f=1", "display_name": "something", "link": "https://stackoverflow.com/users/5905842/something"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 3, "creation_date": 1456227069, "post_id": 35576239, "comment_id": 58839215, "body": "Ok I get it now, a list can only have the same type in it, so whether it is either first or second it is still a? Is this a correct explanation?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1456227621, "post_id": 35576239, "comment_id": 58839570, "body": "@something Yes, lists are <i>homogeneous</i>, meaning that they can contain only elements of the same type. Here, the types <code>fst::(a,b)-&gt;a</code> and <code>snd::(a,b)-&gt;b</code> are specialized to a <i>common type</i>, so that they can be put together in the same list. Such common type occurs when <code>a=b</code>, so GHC infers that."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 5905842, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72a475cb0ae5799b68eaf7006bf00c1b?s=128&d=identicon&r=PG&f=1", "display_name": "something", "link": "https://stackoverflow.com/users/5905842/something"}, "edited": false, "score": 0, "creation_date": 1456228373, "post_id": 35576596, "comment_id": 58840103, "body": "Thanks, this has clarified it alot for me."}], "tags": [], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "is_accepted": true, "score": 13, "last_activity_date": 1456227636, "creation_date": 1456227636, "answer_id": 35576596, "question_id": 35576239, "link": "https://stackoverflow.com/questions/35576239/haskell-why-is-fst-snd-a-a-a/35576596#35576596", "title": "Haskell why is [fst,snd] :: [(a,a) -&gt; a]", "body": "<p>The point is that lists, in Haskell, are a homogeneous data structure (of course, you can have heterogeneous lists, but it is another story). So, when you use polymorphic functions as lists elements they should have the same type. </p>\n\n<p>In your case you are using <code>fst :: (a , b) -&gt; a</code> and <code>snd :: (a, b) -&gt; b</code> as list elements so, they <strong>must</strong> have the same type. To ensure the sameness of these types, type inference resort to first-order unification. Unifying </p>\n\n<pre><code> (a , b) -&gt; a\n</code></pre>\n\n<p>and</p>\n\n<pre><code> (a , b) -&gt; b\n</code></pre>\n\n<p>we notice that the following substitution make these types equal is</p>\n\n<pre><code> [b +-&gt; a] -- means substitute occurrences of b for a\n</code></pre>\n\n<p>Applying it to both types, we get</p>\n\n<pre><code> (a,a) -&gt; a\n</code></pre>\n\n<p>as Haskell is telling you. </p>\n"}], "owner": {"reputation": 103, "user_id": 5905842, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/72a475cb0ae5799b68eaf7006bf00c1b?s=128&d=identicon&r=PG&f=1", "display_name": "something", "link": "https://stackoverflow.com/users/5905842/something"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 658, "favorite_count": 0, "accepted_answer_id": 35576596, "answer_count": 1, "score": 10, "last_activity_date": 1456227636, "creation_date": 1456226599, "question_id": 35576239, "link": "https://stackoverflow.com/questions/35576239/haskell-why-is-fst-snd-a-a-a", "title": "Haskell why is [fst,snd] :: [(a,a) -&gt; a]", "body": "<p>I am learning Haskell and am wondering why</p>\n\n<pre><code>[fst,snd] :: [(a,a) -&gt; a]\n</code></pre>\n\n<p>I originally wrote</p>\n\n<pre><code>[fst,snd] :: [(a,b) -&gt; a, (c, d) -&gt; d]\n</code></pre>\n\n<p>I cannot understand why it is the way it is; could someone please explain?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "types", "api-design", "parametric-polymorphism"], "comments": [{"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1456227718, "post_id": 35575847, "comment_id": 58839648, "body": "Already discussed in <a href=\"http://stackoverflow.com/questions/12770278/typeclass-constraints-on-data-declarations\">this answer</a>."}, {"owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "reply_to_user": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1456228043, "post_id": 35575847, "comment_id": 58839868, "body": "Yes, you&#39;re right. Thanks. I still like the API-design aspects of my question though, and Twan&#39;s answer below satisfies agrees with my other solution which was to contrain it on the functions, which is not covered in that other question."}], "answers": [{"comments": [{"owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "edited": false, "score": 0, "creation_date": 1456226432, "post_id": 35576018, "comment_id": 58838749, "body": "I had wondered this. My reason for not doing so was that I had attached the need to work with <code>Fractional</code>s to the <code>Rating</code> type, i.e. it doesn&#39;t make sense to use a <code>Rating</code> if you&#39;re not working with some derivative of <code>Fractional</code> (but which one is used is up to the user...). Does this make sense? Not sure if it changes your answer or not..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "edited": false, "score": 0, "creation_date": 1456229163, "post_id": 35576018, "comment_id": 58840665, "body": "@atc, this answer reflects community consensus about best practices. People have tried a lot of things, and this is the way that usually works best. There are special circumstances where a GADT is the way to go, but this isn&#39;t one of those. Also, note that this answer writer&#39;s standing in the Haskell community far exceeds his SO reputation score ;-)"}, {"owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "edited": false, "score": 0, "creation_date": 1456235174, "post_id": 35576018, "comment_id": 58844876, "body": "I was just trying to add a little more context and certainly wasn&#39;t intending to argue or suggest Twan was wrong, just trying to express my thoughts were around why I was attempting what I was."}], "tags": [], "owner": {"reputation": 2342, "user_id": 1683460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2535857ac59d18baeda7b081c645f901?s=128&d=identicon&r=PG", "display_name": "Twan van Laarhoven", "link": "https://stackoverflow.com/users/1683460/twan-van-laarhoven"}, "is_accepted": true, "score": 6, "last_activity_date": 1456226045, "creation_date": 1456226045, "answer_id": 35576018, "question_id": 35575847, "link": "https://stackoverflow.com/questions/35575847/can-i-constrain-the-parametric-polymorphic-type-on-type-data-constructor-in-hask/35576018#35576018", "title": "Can I constrain the parametric polymorphic type on type/data constructor in Haskell?", "body": "<p>You shouldn't put the <code>Fractional</code> constraint on the datatype, but rather on the functions that work with it. So</p>\n\n<pre><code>data Rating a = Score a | Unscored deriving (Show, Eq)\n\nmakeSomeRating :: Fractional a =&gt; a -&gt; Rating a\nmakeSomeRating x = Score (x / 2) -- can use Fractional functions here\n\ndoSomethingElseWithRating :: Fractional a =&gt; Rating a -&gt; Something\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "is_accepted": false, "score": 2, "last_activity_date": 1456229292, "last_edit_date": 1456229292, "creation_date": 1456228060, "answer_id": 35576766, "question_id": 35575847, "link": "https://stackoverflow.com/questions/35575847/can-i-constrain-the-parametric-polymorphic-type-on-type-data-constructor-in-hask/35576766#35576766", "title": "Can I constrain the parametric polymorphic type on type/data constructor in Haskell?", "body": "<p>As the error says, you can do this with <code>GADTs</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE GADTs, StandaloneDeriving #-}\n\ndata Rating a where\n    Score :: (Fractional a) =&gt; a -&gt; Rating a\n    Unscored :: Rating a\n\nderiving instance (Show a) =&gt; Show (Rating a)\nderiving instance (Eq a) =&gt; Eq (Rating a)\n\n-- No need for a context here!\nhalfScore :: Rating a -&gt; Rating a\nhalfScore (Score a) = Score (a / 2)\nhalfScore Unscored = Unscored\n</code></pre>\n\n<p><code>StandaloneDeriving</code> is necessary because GHC can't derive <code>Show</code> and <code>Eq</code> for GADTs otherwise.</p>\n"}], "owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 1, "accepted_answer_id": 35576018, "answer_count": 2, "score": 2, "last_activity_date": 1456229292, "creation_date": 1456225586, "question_id": 35575847, "link": "https://stackoverflow.com/questions/35575847/can-i-constrain-the-parametric-polymorphic-type-on-type-data-constructor-in-hask", "title": "Can I constrain the parametric polymorphic type on type/data constructor in Haskell?", "body": "<p>I have a parameterised type that I'd like to constrain to a numeric type, more specifically a <code>Fractional</code>, e.g.:</p>\n\n<pre><code>data Rating a = (Fractional a) =&gt; Score a | Unscored deriving (Show, Eq)\n</code></pre>\n\n<p>so that the user of the API can define which non-integer type they might utilise (<code>Float</code> or <code>Double</code>?), but the internal API code I write can still perform arithmetic operations on a numeric type. I do not want it to be an integer because results of my \"internal operations\" may not be integers and my understanding is that using <code>Fractional</code> would lead to more accurate results.</p>\n\n<p>Compiling the above (in GHCI at least) gives me the following error:</p>\n\n<pre><code>    Data constructor `Score' has existential type variables, a context, or a specialised result type\n  Score :: forall a. Fractional a =&gt; a -&gt; Rating a\n  (Use ExistentialQuantification or GADTs to allow this)\nIn the definition of data constructor `Score'\nIn the data declaration for `Rating'\n</code></pre>\n\n<p>which suggests to me I'm doing something that I probably don't want to keep trying; i.e. my design is rubbish.</p>\n\n<p>I guess I'm trying to say the following in this API: \"when you use a Rating type, its parameter must be a subclass of <code>Fractional</code> so I can perform accurate arithmetic on it\". How might I achieve this? Or am I way off the mark and/or overengineering?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 2, "creation_date": 1456217645, "post_id": 35572837, "comment_id": 58832597, "body": "Newer GHC versions support values at the type level."}, {"owner": {"reputation": 7240, "user_id": 327201, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/0ee53216660fae93d26f8dcaba3945a0?s=128&d=identicon&r=PG", "display_name": "Ramon Snir", "link": "https://stackoverflow.com/users/327201/ramon-snir"}, "edited": false, "score": 1, "creation_date": 1456217816, "post_id": 35572837, "comment_id": 58832711, "body": "<a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/promotion.html\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/users_guide/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1456219634, "post_id": 35573487, "comment_id": 58833961, "body": "I think your last sentence in the first paragraph is misleading, since <b><code>Bool</code></b> is promoted to a kind. <code>True</code> is only promoted to a type constructor, not to a kind on it&#39;s own, and both <code>True</code> and <code>False</code> are of kind <code>Bool</code> in this context."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456232024, "post_id": 35573487, "comment_id": 58842622, "body": "For now, not all types can be promoted. That feature is coming in ... 8.0? 8.2? I don&#39;t really know."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1456233036, "last_edit_date": 1456233036, "creation_date": 1456219390, "answer_id": 35573487, "question_id": 35572837, "link": "https://stackoverflow.com/questions/35572837/confusion-about-type-level-bools-in-base/35573487#35573487", "title": "Confusion about type level bools in base", "body": "<blockquote>\n  <p>the links to <code>True</code> and <code>False</code> just refer to data constructors of <code>Bool</code>, not types themselves</p>\n</blockquote>\n\n<p>That's right. In fact they are not types (what values would e.g. <code>True</code> have<sup>*</sup>)? They are still themselves just values, of type <code>Bool</code>. Only, that entire type has been &ldquo;lifted&rdquo; one level through the <a href=\"https://downloads.haskell.org/~ghc/7.4.1/docs/html/users_guide/kind-polymorphism-and-promotion.html\" rel=\"nofollow\"><code>-XDataKinds</code> extension</a>, so <code>Bool</code> is now also a type-level type: aka a <strong>kind</strong>.</p>\n\n<p>Traditionally in Haskell, we work mainly with a damn single kind: <code>*</code>, the kind of ordinary types<sup>&dagger;</sup>. This kind contains <code>Bool</code> and <code>String</code> and <code>IO ()</code> and <code>(Int -&gt; Double) -&gt; Char</code>... everything that actually has values<sup>&ddagger;</sup>. Plus the constructor-kinds, which are all of some form <code>* -&gt; *</code> and contain things like <code>Maybe</code> or <code>[]</code> (when <em>not</em> applied to a contained-type argument).</p>\n\n<p>With <code>DataKinds</code> now, we have a whole added arsenal of kinds: any type<sup>&sect;</sup> you could use in runtime-Haskell code can now also be used as a kind in compile-time! All of these kinds contain exactly the values they also have on the runtime level. But those type-level values, such as the <code>False</code> and <code>True</code> you asked about, are <em>not</em> actually types, they just live in the type-level. But you can <em>build</em> actual <code>*</code> types from them, e.g. with something like</p>\n\n<pre><code>data CanContain :: Bool -&gt; * -&gt; * where\n  Interesting :: a -&gt; CanContain True a\n  Boring :: CanContain False a\n</code></pre>\n\n<p>then a function with type <code>X -&gt; CanContain True Y</code> must actually generate an <code>Y</code> value, but a function with type <code>X -&gt; CanContain False Y</code> needs not.</p>\n\n<hr>\n\n<p><sup>*</sup><sub>No, the answer is not <code>True</code>. Though, then we could implement <code>type Bool = Either False True</code>, which would kinda make sense.</sub></p>\n\n<p><sup>&dagger;</sup><sub>Arguably, that not a very good name in a language which otherwise parses <code>*</code> as an infix symbol. It will actually be changed in the future.</sub></p>\n\n<p><sup>&ddagger;</sup><sub>It's not quite so simple: there are also unboxed kinds, but those are a bit of a technical detail.</sub></p>\n\n<p><sup>&sect;</sup><sub>As dfeuer remarks, not <em>all</em> types can be lifted right now (GHC-7.10), but simple ones such as <code>Bool</code> certainly can.</sub></p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 1, "accepted_answer_id": 35573487, "answer_count": 1, "score": 2, "last_activity_date": 1456233036, "creation_date": 1456217452, "question_id": 35572837, "link": "https://stackoverflow.com/questions/35572837/confusion-about-type-level-bools-in-base", "title": "Confusion about type level bools in base", "body": "<p><code>Base</code> contains a number of type families for type level boolean operations as seen here:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Type-Bool.html\" rel=\"nofollow\">https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Type-Bool.html</a></p>\n\n<p>However, the links to <code>True</code> and <code>False</code> just refer to data constructors of <code>Bool</code>, not types themselves, so presumably they can't be used for type level operations, as they're values, not types. </p>\n\n<p>Could someone explain what's happening here and where I can find the type level definitions?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456207727, "post_id": 35568141, "comment_id": 58827749, "body": "All constructors, not just the constructors for tuples, can appear in patterns. You can discriminate between patterns and expressions by seeing which side of an <code>=</code> symbol (in a function) they occur on - the left hand side is a pattern, and the right hand side is an expression. The semantics of patterns can be found in the <a href=\"https://www.haskell.org/definition/haskell2010.pdf\" rel=\"nofollow noreferrer\">Haskell Report</a>, s3.17."}], "answers": [{"tags": [], "owner": {"reputation": 431, "user_id": 3360918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cc9097de8b89e2e470ce4c85f46756?s=128&d=identicon&r=PG&f=1", "display_name": "Shumush", "link": "https://stackoverflow.com/users/3360918/shumush"}, "is_accepted": false, "score": 2, "last_activity_date": 1456201213, "last_edit_date": 1456201213, "creation_date": 1456200512, "answer_id": 35568660, "question_id": 35568141, "link": "https://stackoverflow.com/questions/35568141/how-to-understand-and-discriminate-pattern-match-and-tuple/35568660#35568660", "title": "How to understand and discriminate pattern match and tuple?", "body": "<p>Pattern matching is used to name variables which are set in a specific pattern.\nHere, you can say that \"the variables <code>skinny</code> <code>normal</code> and <code>fat</code> represent values of a tuple which is equal to <code>(18.5, 25.0, 30.0)</code>\"</p>\n\n<p>You can use pattern matching in other cases, such as lists.</p>\n\n<pre><code>first_element [] = error \"Empty list\"\nfirst_element (x:rest) = x\n</code></pre>\n\n<p>Here the pattern is either an empty list <code>[]</code> or a value <code>x</code> followed by the rest of the given list.</p>\n\n<p>If you type in GHCI</p>\n\n<pre><code>let (x:xs) = [2, 3, 4]\n</code></pre>\n\n<p>Then by pattern matching <code>x</code> will have the value <code>2</code> and xs the value <code>[3, 4]</code>.</p>\n\n<p>Tuples are just \"boxes\" which can contain multiple values of multiple types.\nA point can be represented as a tuple of type <code>(Double, Double)</code>.</p>\n\n<p>You can construct any tuple of any type. In your example, <code>(18.5, 25.0, 30.0)</code> may be of type <code>(Double, Double, Double)</code></p>\n"}, {"comments": [{"owner": {"reputation": 431, "user_id": 3360918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cc9097de8b89e2e470ce4c85f46756?s=128&d=identicon&r=PG&f=1", "display_name": "Shumush", "link": "https://stackoverflow.com/users/3360918/shumush"}, "edited": false, "score": 0, "creation_date": 1456201463, "post_id": 35568707, "comment_id": 58825331, "body": "But <code>(:)</code> and <code>(,)</code> are not functions. Functions can not be used in pattern matching, only constructors can because they &quot;construct data&quot; and do not &quot;compute values&quot;."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 431, "user_id": 3360918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cc9097de8b89e2e470ce4c85f46756?s=128&d=identicon&r=PG&f=1", "display_name": "Shumush", "link": "https://stackoverflow.com/users/3360918/shumush"}, "edited": false, "score": 0, "creation_date": 1456201764, "post_id": 35568707, "comment_id": 58825435, "body": "Yes, they are functions. Type <code>:t (:)</code> in GHCI, for example, to see its type. Infix operators are simply functions whose names consist only of symbols. Where regular functions can be treated as infix operators by including them in backquotes (<code>fmap f [1,2]</code> is the same as <code>f `fmap` [1,2]</code>), infix operators can be treated as regular functions by enclosing them in parentheses."}, {"owner": {"reputation": 431, "user_id": 3360918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cc9097de8b89e2e470ce4c85f46756?s=128&d=identicon&r=PG&f=1", "display_name": "Shumush", "link": "https://stackoverflow.com/users/3360918/shumush"}, "edited": false, "score": 0, "creation_date": 1456201944, "post_id": 35568707, "comment_id": 58825498, "body": "<code>Just</code> is a constructor, but if you type <code>:t Just</code> you will have <code>Just :: a -&gt; Maybe a</code>. Constructors can be defined as infix operators. You can define a list like this <code>data List a = [] | a : List a</code>. Constructors are &#39;like&#39; functions because they take some values and &quot;compute&quot; another value, but only constructors can be used in pattern matching.  You can&#39;t use <code>mktuple a b = (a, b)</code> for pattern matching. <code>a </code>mktuple` b = (1, 2)` is not valid"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 431, "user_id": 3360918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cc9097de8b89e2e470ce4c85f46756?s=128&d=identicon&r=PG&f=1", "display_name": "Shumush", "link": "https://stackoverflow.com/users/3360918/shumush"}, "edited": false, "score": 0, "creation_date": 1456202304, "post_id": 35568707, "comment_id": 58825616, "body": "Yes, I forget the rule, though (they have to begin with <code>:</code>, I think?) <code>,</code> is a little weird, since <code>(,,)</code> isn&#39;t an infix operator so much as a ternary operator. You write <code>(,,) 1 2 3</code> or <code>(1, 2, 3)</code>, not <code>1 ,, 2 ,, 3</code>, so I think maybe in the case of <code>,</code>, pattern matching is a little bit of a special case, rather than a direct result of it being a constructor. While <code>Just</code> is an actual data constructor (<code>data Maybe a = Just a | Nothing</code>), I think <code>(,)</code> and family are just functions that <i>look</i> like constructors. I&#39;ll see if I can find the actual definition of the various tuple types."}, {"owner": {"reputation": 431, "user_id": 3360918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cc9097de8b89e2e470ce4c85f46756?s=128&d=identicon&r=PG&f=1", "display_name": "Shumush", "link": "https://stackoverflow.com/users/3360918/shumush"}, "edited": false, "score": 0, "creation_date": 1456202737, "post_id": 35568707, "comment_id": 58825752, "body": "In <a href=\"http://stackoverflow.com/a/7086771/3360918\">this post</a> C. A. McCann explains that tuple constructors (used this way : <code>(1,2,3)</code> ) are syntaxic sugar, and therefore not implemented as <code>Maybe</code> or other data types could be."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 431, "user_id": 3360918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cc9097de8b89e2e470ce4c85f46756?s=128&d=identicon&r=PG&f=1", "display_name": "Shumush", "link": "https://stackoverflow.com/users/3360918/shumush"}, "edited": false, "score": 0, "creation_date": 1456203167, "post_id": 35568707, "comment_id": 58825901, "body": "OK, the comment that tuple syntax is built-in, like the <code>IO</code> action, is what I suspected. <code>(a, b, c)</code> isn&#39;t syntactic sugar for another Haskell expression; it just <i>is</i> the type of 3-element tuples defined by Haskell. <code>(,,)</code> is then just an ordinary function (not even an infix operator, really) that (currying aside) returns a <code>(a, b, c)</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": -1, "last_activity_date": 1456202772, "last_edit_date": 1456202772, "creation_date": 1456200874, "answer_id": 35568707, "question_id": 35568141, "link": "https://stackoverflow.com/questions/35568141/how-to-understand-and-discriminate-pattern-match-and-tuple/35568707#35568707", "title": "How to understand and discriminate pattern match and tuple?", "body": "<p>(What follows is not strictly true; as Shumush points out, pattern matching can only be done with data constructors, not just any function. <code>(:)</code> and <code>Just</code> mentioned below are actual data constructors; the various comma functions don't appear to be, so I don't actually know how pattern matching with tuples work. Perhaps consider this as a coincidental analogy for how tuples pattern match.)</p>\n\n<p>First, think about how pattern matching applies to lists, using the definition of <code>map</code> as an example.</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap f [] = []\nmap f (x:xs) = f x (map f xs)\n</code></pre>\n\n<p>Here, you can pattern match against a list because <code>(:)</code> is a function that produces a list from an element and another list. That is, <code>(x:xs)</code> can match <code>[1,2,3]</code> by binding 1 to <code>x</code> and <code>[2,3]</code> to <code>xs</code> because <code>(:) 1 [2, 3] = 1 : [2,3] = [1,2,3]</code>.</p>\n\n<p><code>(,)</code> is a function that produces a tuple:</p>\n\n<pre><code>&gt; :t (,)\n(,) :: a -&gt; b -&gt; (a, b)\n</code></pre>\n\n<p>so <code>(,) 1 2 = (1, 2)</code>. You can thus pattern match with <code>(,)</code> the same way you can with <code>(:)</code>:</p>\n\n<pre><code>(skinny, normal, fat) = (18.5, 25.0, 30.0)\n</code></pre>\n\n<p>(Definitions for <code>(,,) :: a -&gt; b -&gt; c -&gt; (a, b, c)</code>, <code>(,,,)</code>, and a few more are provided by the Prelude.)</p>\n\n<p>binds 18.5 to <code>skinny</code>, 25.0 to <code>normal</code>, and 30.0 to <code>fat</code> because</p>\n\n<pre><code>(,) 18.5 25.0 30.0 = (18.5, 25.0, 30.0)\n</code></pre>\n\n<p>Think of pattern matching as the opposite of function evaluation. Instead of applying a function to values to produce a new value, you \"break apart\" a value to get the operands used to produce that value.</p>\n\n<p>Pattern matching can be done with <em>any</em> function call, which is why you can pattern match on things like <code>Maybe</code> values</p>\n\n<pre><code>-- From the Functor instance of Maybe\nfmap :: (a -&gt; b) -&gt; (Maybe a) -&gt; (Maybe b)\nfmap f Nothing = Nothing\nfmap f (Just x) = f x\n</code></pre>\n\n<p>Since <code>Just :: a -&gt; Maybe a</code> is a function (specifically, a data constructor), you can pattern match by binding the value wrapped in a <code>Maybe</code> created by <code>Just</code> to <code>x</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 1, "last_activity_date": 1456257408, "creation_date": 1456257408, "answer_id": 35586976, "question_id": 35568141, "link": "https://stackoverflow.com/questions/35568141/how-to-understand-and-discriminate-pattern-match-and-tuple/35586976#35586976", "title": "How to understand and discriminate pattern match and tuple?", "body": "<p>In Haskell, patterns and expressions largely share the same internal syntax, the difference is <strong>where they occur</strong>.  So in your example:</p>\n\n<pre><code>where bmi = weight / height ^ 2  \n      (skinny, normal, fat) = (18.5, 25.0, 30.0)  \n</code></pre>\n\n<p>...<code>(skinny, normal, fat)</code> is a pattern because it occurs on the <strong>left-hand side</strong> of the equals sign, and <code>(18.5, 25.0, 30.0)</code> is an expression because it's on the <strong>right-hand side</strong> of the equals sign.  </p>\n\n<p>There's a definite list of contexts in Haskell where patterns are allowed, so patterns are the things that appear in those contexts.  First context: the left-hand sides of a definition's equations.  This can be a top-level definition, or local definitions inside a <code>where</code> or <code>let</code>:</p>\n\n<pre><code> -- Top level definition\n (pat1, pat2) = ...\n   where\n     -- Local definition in `where`\n     (pat3:pat4:_) = let \n                        -- Local definition in `let`\n                        Maybe pat5 = ...\n                     in ...\n</code></pre>\n\n<p>Second context:  the left-hand side of a <code>-&gt;</code> in a <code>case</code> expression:</p>\n\n<pre><code>case expr of\n  Just pat -&gt; 2*a\n  Nothing -&gt; 42\n</code></pre>\n\n<p>Third context: the left-hand side of the <code>&lt;-</code> in <code>do</code>-notation or list comprehensions:</p>\n\n<pre><code>example1 = do\n  (pat1, pat2) &lt;- ...\n  ...\n\nexample2 = [f x y | (x, y) &lt;- ...]\n</code></pre>\n\n<p>I might be missing some other context, but these are the major ones at least.</p>\n\n<hr>\n\n<p>The other important concept here is that of a <strong>data constructor</strong>: a constant or operator in Haskell that serves two functions:</p>\n\n<ol>\n<li>As an <strong>expression</strong> that can be used to construct values of its type;</li>\n<li>As a <strong>pattern</strong> that can be used to deconstruct values of its type.</li>\n</ol>\n\n<p>And again, whether a specific use of a data constructor counts as the former or the latter depends entirely on whether it's a \"left-hand side\" vs. a \"right-hand side\" use of it.</p>\n"}], "owner": {"reputation": 14298, "user_id": 2106207, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/960430ab7aba908bb9aa62d530618a75?s=128&d=identicon&r=PG", "display_name": "Nan Xiao", "link": "https://stackoverflow.com/users/2106207/nan-xiao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1456257408, "creation_date": 1456197335, "last_edit_date": 1456198900, "question_id": 35568141, "link": "https://stackoverflow.com/questions/35568141/how-to-understand-and-discriminate-pattern-match-and-tuple", "title": "How to understand and discriminate pattern match and tuple?", "body": "<p>I am a novice of <code>Haskell</code>, and get a little confused with pattern matching and tuples. E.g., in <a href=\"http://learnyouahaskell.com/syntax-in-functions#where\" rel=\"nofollow\">Learn You a Haskell for Great Good!</a>:  </p>\n\n<blockquote>\n  <p>You can also use where bindings to pattern match! We could have rewritten the where section of our previous function as:  </p>\n</blockquote>\n\n<pre><code>...  \nwhere bmi = weight / height ^ 2  \n      (skinny, normal, fat) = (18.5, 25.0, 30.0)  \n</code></pre>\n\n<p>The <code>(skinny, normal, fat) = (18.5, 25.0, 30.0)</code> is a pattern match, but it is also a tuple, right? How can I understand and discriminate pattern match and tuple?</p>\n"}, {"tags": ["haskell", "huffman-code"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1456222302, "post_id": 35567534, "comment_id": 58835848, "body": "Usually  the <i>first</i> things stated to introduce huffman codings in lectures are 1) optimal codings aren&#39;t unique 2) There exist an optimal coding were the two least probable symbols are siblings and their height is maximal. From these observations follows the classical algorithm."}], "answers": [{"tags": [], "owner": {"reputation": 78348, "user_id": 1180620, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/FXaAg.jpg?s=128&g=1", "display_name": "Mark Adler", "link": "https://stackoverflow.com/users/1180620/mark-adler"}, "is_accepted": true, "score": 6, "last_activity_date": 1456197375, "creation_date": 1456197375, "answer_id": 35568149, "question_id": 35567534, "link": "https://stackoverflow.com/questions/35567534/are-there-multiple-ways-to-do-huffman-encoding/35568149#35568149", "title": "Are there multiple ways to do Huffman encoding?", "body": "<p>Yes, you can assign 0 and 1 to left and right branches however you like, and you'll still have an optimal Huffman code. Both answers are correct, unless the assignment specified how to assign bit values to the branches. In fact, there are 32 correct answers since there are five branches with two choices each.</p>\n\n<p>As it happens for those frequencies, that tree is the only possible tree. However there are some sets of frequencies that can give trees with different topologies.</p>\n\n<p>A simple example is the set of frequencies 1, 1, 2, 2. When you apply the Huffman algorithm, you will find that you have an arbitrary choice to make when picking the two lowest frequencies in the second step. Depending on which choice you make, you will end up with a tree with all codes the same length (2), or you will end up with codes of lengths 1, 2, 3, and 3. Both codes are the correct answer. Oh, and for the 1, 2, 3, 3 tree, you can pick which symbol with frequency 2 is at the top. So really three distinct trees are possible. And for each tree you have eight ways to assign the 0's and 1's. So there are 24 correct answers in that case. If you multiply the code lengths times the frequencies and add them up, you will see that both tree topologies give 12, so both are optimal.</p>\n"}], "owner": {"reputation": 329, "user_id": 968117, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8b8eb69f0ce6c574c6c913d2a33e3fe5?s=128&d=identicon&r=PG", "display_name": "error_null_pointer", "link": "https://stackoverflow.com/users/968117/error-null-pointer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 2, "accepted_answer_id": 35568149, "answer_count": 1, "score": 2, "last_activity_date": 1456200984, "creation_date": 1456193372, "last_edit_date": 1456200984, "question_id": 35567534, "link": "https://stackoverflow.com/questions/35567534/are-there-multiple-ways-to-do-huffman-encoding", "title": "Are there multiple ways to do Huffman encoding?", "body": "<p>So I made a program that should do Huffman encoding. When comparing my answers to the correct ones, not all of mine matched up. </p>\n\n<p>I got </p>\n\n<pre><code>[(\"a\",\"0\"),(\"c\",\"100\"),(\"b\",\"101\"),(\"d\",\"110\"),(\"f\",\"1110\"),(\"e\",\"1111\")]\n</code></pre>\n\n<p>The correct answer is </p>\n\n<pre><code>[('a',\"0\"),('b',\"101\"),('c',\"100\"),('d',\"111\"),('e',\"1101\"),('f',\"1100\")]\n</code></pre>\n\n<p>The correct tree is \n<a href=\"https://i.stack.imgur.com/mq4tu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mq4tu.png\" alt=\"Correct Tree\"></a></p>\n\n<p>Mine method however gives me me a slight change. On branch 30 I use a 0 to get to D instead of a 1. </p>\n\n<p>So this makes me wonder, are both answers correct? After all they both have the same string lengths. </p>\n\n<p>If I am wrong, can someone explain why? </p>\n\n<p>In case anyone wants it, my code is written in Haskell below</p>\n\n<pre><code>mergHufffman::(String,Int) -&gt; (String,Int) -&gt; (String,Int)\nmergHufffman x y =  (fst x ++ fst y, snd x + snd y)\n\ndata HTree a = Leaf a | Branch (HTree a) (HTree a) deriving Show\n\ntreeHuff::[(String,Int)] -&gt; HTree (String,Int)\ntreeHuff (x:[]) = Leaf x\ntreeHuff (x:y:[])\n        | snd x &lt; snd y = Branch (Leaf x) (Leaf y)\n        | snd x &gt; snd y = Branch (Leaf y) (Leaf x)\ntreeHuff (x:y:z:list)\n        | snd x &gt; snd merged = Branch (Leaf x) (treeHuff $ sortFirst $ y:z:list)\n        | otherwise = Branch (treeHuff $ y:z:[]) (treeHuff $ sortFirst $ x:list)\n        where merged = mergHufffman y z \n\nsortFirst::[(String,Int)]-&gt;[(String,Int)]\nsortFirst freq = reverse $ sortBy (comparing snd) freq\n\nreadHuffTree :: HTree (String,Int)-&gt; String -&gt; [(String, String)]\nreadHuffTree (Branch x y) code = f1 ++ f2\n                          where \n                          f1 = readHuffTree x (code ++ \"0\")\n                          f2 = readHuffTree y (code ++ \"1\")\nreadHuffTree (Leaf x) code = ((fst x, code):[])\n</code></pre>\n"}, {"tags": ["haskell", "construct", "referential"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1456194503, "post_id": 35567448, "comment_id": 58823272, "body": "I&#39;m voting to close this question as off-topic because it is about general English vocabulary."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456194563, "post_id": 35567448, "comment_id": 58823278, "body": "<a href=\"https://en.wiktionary.org/wiki/construct#Noun\" rel=\"nofollow noreferrer\">en.wiktionary.org/wiki/construct#Noun</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456196339, "post_id": 35567448, "comment_id": 58823740, "body": "Don&#39;t get me wrong. I&#39;m not saying you should have <i>known</i> this was a general English vocabulary question; that&#39;s just what it turns out to be."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1456213642, "post_id": 35567448, "comment_id": 58830445, "body": "Oh, this appears to be a duplicate of <a href=\"http://stackoverflow.com/q/10057524/1048572\">What does &#39;Language Construct&#39; mean?</a> anyway."}], "answers": [{"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1456195382, "post_id": 35567710, "comment_id": 58823494, "body": "I&#39;m pretty sure they refer to a <i>syntax</i> construct, not constructible things (in the OOP sense)."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1456196368, "post_id": 35567710, "comment_id": 58823745, "body": "@Bergi syntax isn&#39;t referentially transparent or not. That&#39;s a category error. I also do not mean construction in any OOP sense."}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 1, "last_activity_date": 1456194596, "creation_date": 1456194596, "answer_id": 35567710, "question_id": 35567448, "link": "https://stackoverflow.com/questions/35567448/does-haskell-has-the-concept-construct-like-c-and-ml-language/35567710#35567710", "title": "Does Haskell has the concept &quot;construct&quot; like C and ML language?", "body": "<p>\"Construct\" is being used as a general noun for things that can be constructed in those languages. You could use \"thing\" instead without really changing the meaning: C and ML contain things that are not referentially transparent.</p>\n"}], "owner": {"reputation": 8007, "user_id": 5890784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dec46088a284202a3be71897845a669d?s=128&d=identicon&r=PG&f=1", "display_name": "Hind Forsum", "link": "https://stackoverflow.com/users/5890784/hind-forsum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1456210217, "accepted_answer_id": 35567710, "answer_count": 1, "score": 1, "last_activity_date": 1456194596, "creation_date": 1456192909, "last_edit_date": 1456193541, "question_id": 35567448, "link": "https://stackoverflow.com/questions/35567448/does-haskell-has-the-concept-construct-like-c-and-ml-language", "closed_reason": "Not suitable for this site", "title": "Does Haskell has the concept &quot;construct&quot; like C and ML language?", "body": "<p>This wiki page: <a href=\"https://wiki.haskell.org/Referential_transparency\" rel=\"nofollow\">https://wiki.haskell.org/Referential_transparency</a> talks about \"C and ML are languages with constructs that are not referentially transparent.\" My question is, what is \"Constructs\"? Is it an abstract concept?\nThanks.</p>\n"}, {"tags": ["haskell", "ghc", "cabal"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456184474, "post_id": 35565955, "comment_id": 58820491, "body": "What GHC is this, anyway?"}, {"owner": {"reputation": 372, "user_id": 2534752, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/RodVg.jpg?s=128&g=1", "display_name": "Marek Milkovi\u010d", "link": "https://stackoverflow.com/users/2534752/marek-milkovi%c4%8d"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456184631, "post_id": 35565955, "comment_id": 58820546, "body": "<code>The Glorious Glasgow Haskell Compilation System, version 7.8.4</code>"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 2, "creation_date": 1456185119, "post_id": 35565955, "comment_id": 58820732, "body": "If you are really desperate, you can use stack: <a href=\"http://haskellstack.org/\" rel=\"nofollow noreferrer\">haskellstack.org</a> . It&#39;s better tool in my opinion."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1456204151, "post_id": 35565955, "comment_id": 58826292, "body": "why desperate - IMO it&#39;s the recommended way by now ;)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1456209656, "post_id": 35565955, "comment_id": 58828537, "body": "Clearly there is a mismatch between the cabal version you think it is using, and the actual version which it is using. You should ensure that 1. you have a single copy of the <code>cabal</code> executable on your filesystem, and 2. you have at most one copy of every package in your global and user package databases. It looks like you&#39;re installing in the global package database - if there is some inconsistency this will often lead to cryptic errors like this one. You should try installing in a sandbox, or use stack (which handles all this &quot;automagically&quot; for you). Also run with -v3 if you want to debug.."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456248795, "post_id": 35565955, "comment_id": 58855227, "body": "What does <code>ghc-pkg list Cabal</code> say?"}, {"owner": {"reputation": 372, "user_id": 2534752, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/RodVg.jpg?s=128&g=1", "display_name": "Marek Milkovi\u010d", "link": "https://stackoverflow.com/users/2534752/marek-milkovi%c4%8d"}, "edited": false, "score": 0, "creation_date": 1456268484, "post_id": 35565955, "comment_id": 58866215, "body": "Thanks everyone for help. I have managed to resolve it with completely removing everything related to <code>ghc</code> and <code>cabal</code> then installing it again. It seems to work. However, <code>stack</code> seems like an interesting tool so I will give it a try."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 2, "last_activity_date": 1456346198, "creation_date": 1456346198, "answer_id": 35612563, "question_id": 35565955, "link": "https://stackoverflow.com/questions/35565955/cabal-install-refuses-to-install-module-because-of-missing-cabal-library/35612563#35612563", "title": "Cabal install refuses to install module because of missing cabal library", "body": "<p>For the record (although this is apparently resolved), the issue is that <code>cabal</code> is the cabal install tool, but <code>Cabal</code> in the error message refers to a library, so running a <code>ghc-pkg list</code> to check if that library is installed and what version would have been the appropriate next step.</p>\n"}], "owner": {"reputation": 372, "user_id": 2534752, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/RodVg.jpg?s=128&g=1", "display_name": "Marek Milkovi\u010d", "link": "https://stackoverflow.com/users/2534752/marek-milkovi%c4%8d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 549, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456346198, "creation_date": 1456183708, "question_id": 35565955, "link": "https://stackoverflow.com/questions/35565955/cabal-install-refuses-to-install-module-because-of-missing-cabal-library", "title": "Cabal install refuses to install module because of missing cabal library", "body": "<p>I am really desperate with this one. Trying to install <code>mtl</code> for my <code>ghc</code>, so I installed <code>cabal-install</code> package (I am running Fedora 23). Then I tried to run <code>cabal update</code> which finished OK, but <code>cabal install mtl</code> gives me this.</p>\n\n<pre><code>Resolving dependencies...\nConfiguring transformers-0.5.2.0...\nFailed to install transformers-0.5.2.0\nLast 10 lines of the build log ( /home/metthal/.cabal/logs/transformers-0.5.2.0.log ):\ncabal: Error: some packages failed to install:\nmtl-2.2.1 depends on transformers-0.5.2.0 which failed to install.\ntransformers-0.5.2.0 failed during the configure step. The exception was:\nuser error (The package 'transformers' requires Cabal library version -any &amp;&amp;\n&gt;=1.6 but no suitable version is installed.)\n</code></pre>\n\n<p>The mentioned log file is completely empty. The package <code>ghc-Cabal</code> is installed. <code>cabal --version</code> reports this.</p>\n\n<pre><code>cabal-install version 1.18.1.0\nusing version 1.18.1.5 of the Cabal library\n</code></pre>\n\n<p>I also tried <code>cabal install cabal-install</code> but that gave me just the same errors on all the dependencies.</p>\n\n<p>I really don't understand it anymore and I am out of ideas how to solve this issue. Googling doesn't help as it seems I am the only one with this kind of problem. I appreciate any help.</p>\n"}, {"tags": ["regex", "haskell"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1456181968, "post_id": 35565319, "comment_id": 58819575, "body": "Check <a href=\"https://github.com/c089/haskell-craft3e/blob/master/Chapter12.hs#L52\" rel=\"nofollow noreferrer\">this resource</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456184309, "post_id": 35565319, "comment_id": 58820432, "body": "I don&#39;t know that this will help with the particular exercise, but <a href=\"https://hackage.haskell.org/package/regex-applicative\" rel=\"nofollow noreferrer\"><code>regex-applicative</code></a> offers a particularly pleasant API for dealing with regular languages."}], "answers": [{"tags": [], "owner": {"reputation": 431, "user_id": 3360918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79cc9097de8b89e2e470ce4c85f46756?s=128&d=identicon&r=PG&f=1", "display_name": "Shumush", "link": "https://stackoverflow.com/users/3360918/shumush"}, "is_accepted": true, "score": 1, "last_activity_date": 1456205619, "last_edit_date": 1456205619, "creation_date": 1456205093, "answer_id": 35569504, "question_id": 35565319, "link": "https://stackoverflow.com/questions/35565319/haskell-regular-expressions/35569504#35569504", "title": "Haskell regular expressions", "body": "<p>According to the <code>star</code> function, <code>plus</code> function should be like this:</p>\n\n<pre><code>plus :: RegExp -&gt; RegExp\nplus e = e &lt;*&gt; star e\n</code></pre>\n\n<p>Where <code>a &lt;*&gt; b</code> means \"a followed by b\", and <code>star</code> matches 0 or multiple occurences.</p>\n\n<p>Try to use <code>epsilon</code> and <code>(|||)</code> for <code>option</code> function.</p>\n"}], "owner": {"reputation": 33, "user_id": 5244683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ba8ba68ea205cabf47cdb2557e283ce?s=128&d=identicon&r=PG&f=1", "display_name": "christine90", "link": "https://stackoverflow.com/users/5244683/christine90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 1, "accepted_answer_id": 35569504, "answer_count": 1, "score": 1, "last_activity_date": 1456205619, "creation_date": 1456180552, "question_id": 35565319, "link": "https://stackoverflow.com/questions/35565319/haskell-regular-expressions", "title": "Haskell regular expressions", "body": "<p>Im new to learning Haskell and have been using the book \"Haskell-The Craft of Functional Programming 3rd edition\" and am stuck on Chapter 12 regarding regular expressions, problem 12.16 in particular:</p>\n\n<p>implement the following functions:\n   option,plus:: RegExp->RegExp\n-where option e matches 0 or 1 occurence of e and plus e matches 1 or more occurence of e.</p>\n\n<p>Im not sure where to evenbegin so any help would be appreciated! Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456171086, "post_id": 35562595, "comment_id": 58813499, "body": "it&#39;s the last part of <code>treeHuff :: [(String,Int)] -&gt; HTree</code> - the last is no <b>type</b> yet - you need to provide a type for the <code>a</code> int <code>HTree a</code> - in this case <code>HTree (String,Int)</code> (or so it seems)"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1456173718, "post_id": 35562595, "comment_id": 58814978, "body": "The error message <b>says</b> that HTree is expecting one more argument, and pinpoints exactly where it&#39;s expecting it."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456176419, "post_id": 35562595, "comment_id": 58816604, "body": "To make matters more confusing, the word &quot;type&quot; sometimes refers to type-level entities of all kinds, and sometimes only to those of kind <code>*</code> or <code>#</code>."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 7, "last_activity_date": 1500926009, "last_edit_date": 1500926009, "creation_date": 1456171082, "answer_id": 35562672, "question_id": 35562595, "link": "https://stackoverflow.com/questions/35562595/expected-a-type-but-typename-has-kind/35562672#35562672", "title": "Expected a type, but TYPENAME has kind \u2018* -&gt; *\u2019", "body": "<p>The error message is telling you that <code>HTree</code> is not a type until you give it one more argument. That is <code>HTree String</code> or <code>HTree Int</code> would be types, but <code>HTree</code> by itself is not.</p>\n\n<p>Another way of putting it: when you say \"I want to return a tree\", Haskell asks \"A tree of what?\".</p>\n"}], "owner": {"reputation": 329, "user_id": 968117, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/8b8eb69f0ce6c574c6c913d2a33e3fe5?s=128&d=identicon&r=PG", "display_name": "error_null_pointer", "link": "https://stackoverflow.com/users/968117/error-null-pointer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2441, "favorite_count": 1, "accepted_answer_id": 35562672, "answer_count": 1, "score": 0, "last_activity_date": 1500926009, "creation_date": 1456170802, "last_edit_date": 1456193655, "question_id": 35562595, "link": "https://stackoverflow.com/questions/35562595/expected-a-type-but-typename-has-kind", "title": "Expected a type, but TYPENAME has kind \u2018* -&gt; *\u2019", "body": "<p>I am having issues with an error I don't understand</p>\n\n<p><strong>Code</strong>:</p>\n\n<pre><code>mergHufffman::(String,Int) -&gt; (String,Int) -&gt; (String,Int)\nmergHufffman x y = (fst x ++ fst y, snd x + snd y)\n\n\ndata HTree a = Leaf a | Branch (HTree a) (HTree a) deriving Show\n\n\ntreeHuff::[(String,Int)] -&gt; HTree\ntreeHuff (x:[]) = Leaf x\ntreeHuff (x:y:[])\n        | snd x &lt; snd y = Branch Leaf x Leaf y\n        | snd x &gt; snd y = Branch Leaf y Leaf x\ntreeHuff (x:y:z:list)\n        | snd x &gt; snd merged = Branch (Leaf x) (treeHuff y:z:list)\n        | otherwise = Branch (treeHuff y:z:[]) (treeHuff x:list)\n        where merged = mergHufffman y z \n</code></pre>\n\n<p><strong>Error</strong>:</p>\n\n<pre><code>Expecting one more argument to \u2018HTree\u2019\n    Expected a type, but \u2018HTree\u2019 has kind \u2018* -&gt; *\u2019\n    In the type signature for \u2018treeHuff\u2019:\n      treeHuff :: [(String, Int)] -&gt; HTree\n</code></pre>\n\n<p>If possible can you explain both the error, and where I made it. </p>\n\n<p><strong>Solution</strong>:</p>\n\n<p>Thanks to Sepp2k and Carsten I fixed the issue.</p>\n\n<pre><code>mergHufffman::(String,Int) -&gt; (String,Int) -&gt; (String,Int)\nmergHufffman x y =  (fst x ++ fst y, snd x + snd y)\n\ndata HTree a = Leaf a | Branch (HTree a) (HTree a) deriving Show\n\ntreeHuff::[(String,Int)] -&gt; HTree (String,Int)\ntreeHuff (x:[]) = Leaf x\ntreeHuff (x:y:[])\n        | snd x &lt; snd y = Branch (Leaf x) (Leaf y)\n        | snd x &gt; snd y = Branch (Leaf y) (Leaf x)\ntreeHuff (x:y:z:list)\n        | snd x &gt; snd merged = Branch (Leaf x) (treeHuff $ sortFirst $ y:z:list)\n        | otherwise = Branch (treeHuff $ y:z:[]) (treeHuff $ sortFirst $ x:list)\n        where merged = mergHufffman y z \n\nsortFirst::[(String,Int)]-&gt;[(String,Int)]\nsortFirst freq = reverse $ sortBy (comparing snd) freq\n\nreadHuffTree :: HTree (String,Int)-&gt; String -&gt; [(String, String)]\nreadHuffTree (Branch x y) code = f1 ++ f2\n                          where \n                          f1 = readHuffTree x (code ++ \"0\")\n                          f2 = readHuffTree y (code ++ \"1\")\nreadHuffTree (Leaf x) code = ((fst x, code):[])\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "ghc"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456176219, "post_id": 35560930, "comment_id": 58816477, "body": "What happens if you use <code>deriving instance Read (t r) =&gt; Read (U t rep r)</code>? Is that not accepted? Would life be easier if you defined your GADT to have only two parameters, <code>tr</code> and <code>rep</code>, and defined a newtype around it to combine <code>t</code> with <code>r</code>?"}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456178326, "post_id": 35560930, "comment_id": 58817746, "body": "@dfeuer I don&#39;t think that works in my example, but even if it does, it definitely doesn&#39;t work in my real code."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456178409, "post_id": 35560930, "comment_id": 58817791, "body": "I actually meant <code>Show</code>, not <code>Read</code>. <code>Show</code> is much easier to derive."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456178889, "post_id": 35560930, "comment_id": 58818015, "body": "@dfeuer Since my <code>Read</code> instance has to be manually derived, I figure I have to have a corresponding <code>Show</code> instance, which is certainly not what GHC would generate (even if it could)."}], "answers": [{"comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1456171819, "post_id": 35562543, "comment_id": 58813912, "body": "I&#39;m looking for some intuition. <i>Why</i> should I define <code>showsPrec</code> instead of <code>show</code>? Regarding the derived <code>Show</code> instance, my <code>U</code> type is too complicated for GHC to derive an instance, which is why I&#39;m doing it by hand."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1456172532, "post_id": 35562543, "comment_id": 58814280, "body": "I added some links and explanation."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 1, "last_activity_date": 1456172393, "last_edit_date": 1456172393, "creation_date": 1456170599, "answer_id": 35562543, "question_id": 35560930, "link": "https://stackoverflow.com/questions/35560930/parse-error-when-reading/35562543#35562543", "title": "Parse error when reading", "body": "<p>Your custom <code>Show</code> instance for <code>Foo</code> doesn't parenthesize correctly.</p>\n\n<pre><code>&gt; U2 $ Foo $ Bar 3\nU2Wrap Bar 3\n</code></pre>\n\n<p>When writing custom <code>Show</code> instances, you should define <code>showsPrec</code> instead. That's because <code>show</code> just gives back a string independently of the context, while <code>showsPrec</code> parenthesizes based on precendence. See <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.8.2.0/Text-Show.html\" rel=\"nofollow\"><code>Text.Show</code></a> for further documentation.</p>\n\n<pre><code>instance (Show r) =&gt; Show (Foo r) where\n showsPrec n (Foo x) = showsPrec n x\n</code></pre>\n\n<p>Which works here.</p>\n\n<p>I don't know of an elegant approach that would automacially get us a <code>Read</code> instance for this <code>GADT</code>. The deriving mechanism can't seem to figure out that only a single constructor has to be considered for each <code>rep</code>. </p>\n\n<p>At least <code>Show</code> can be derived even here. I also include here a manual <code>Read</code> instance  which I hope conforms to <code>Show</code>. I tried to mimic the definitions in <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.8.2.0/Text-Read.html\" rel=\"nofollow\"><code>Text.Read</code></a>, which you could also do in other cases. Alternatively, one could use the <code>-ddump-deriv</code> GHC argument to look at derived <code>Read</code> instances, and try to copy them in custom code.</p>\n\n<pre><code>{-# LANGUAGE GADTs, StandaloneDeriving, FlexibleInstances, FlexibleContexts #-}\n\nimport Text.Read\nimport Data.Proxy\n\ndata U t rep r where\n  U1 :: t r -&gt; U t Int r\n  U2 :: t r -&gt; U t Char r\n\nderiving instance Show (t r) =&gt; Show (U t rep r)\n\ninstance Read (t r) =&gt; Read (U t Int r) where\n  readPrec = parens $ do\n    prec 10 $ do\n      Ident \"U1\" &lt;- lexP\n      U1 &lt;$&gt; readPrec\n\ninstance Read (t r) =&gt; Read (U t Char r) where\n  readPrec = parens $ do\n    prec 10 $ do\n      Ident \"U2\" &lt;- lexP\n      U2 &lt;$&gt; readPrec\n</code></pre>\n"}], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 35562543, "answer_count": 1, "score": 2, "last_activity_date": 1456172393, "creation_date": 1456165052, "last_edit_date": 1456172355, "question_id": 35560930, "link": "https://stackoverflow.com/questions/35560930/parse-error-when-reading", "title": "Parse error when reading", "body": "<p>GHC can't derive <code>Read</code> or <code>Show</code> for complicated GADTs, so I attempted to define custom instances below that satisfy <code>read . show == id</code>. I've simplified the example as much as possible (while still triggering the runtime error like my real code). I decided to let GHC do the heavy lifting of writing <code>Read</code> and <code>Show</code> instances by making <code>newtype</code> wrappers for each GADT constructor (more accurately: for each <em>type</em> output by the GADT). In the <code>Read</code>/<code>Show</code> instances, I simply read/show the newtype wrapper and convert where necessary. I assumed this was foolproof: I'm letting GHC define all of the non-trivial instances. However, I seem to have done something wrong.</p>\n\n<p>In my real code, <code>Foo</code> below is a complicated GADT that GHC won't derive <code>Show</code> or <code>Read</code> for. Since <code>Foo</code> is a wrapper (in part) around a newtype, I use the derived <code>Show</code>/<code>Read</code> instances for that. </p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts, FlexibleInstances, GADTs, ScopedTypeVariables #-}\n\nimport Text.Read (Read(readPrec))\n\nnewtype Bar r = Bar r deriving (Show, Read)\nnewtype Foo r = Foo (Bar r)\n-- use the GHC-derived Show/Read for Bar\ninstance (Show r) =&gt; Show (Foo r) where\n  show (Foo x) = show x\ninstance (Read r) =&gt; Read (Foo r) where\n  readPrec = Foo &lt;$&gt; readPrec\n</code></pre>\n\n<p>This instance seems to work: I can call <code>read . show</code> and I get back the input.\nNow I have a wrapper around <code>Foo</code>:</p>\n\n<pre><code>data U t rep r where\n  U1  :: t r -&gt; U t Int r\n  U2 :: t r -&gt; U t Char r\n-- use the Read/Show instances for U1Wrap and U2Wrap\nnewtype U1Wrap t r = U1Wrap {unU1Wrap :: t r} deriving (Show, Read)\nnewtype U2Wrap t r = U2Wrap (t r) deriving (Show, Read)\ninstance (Read (t r)) =&gt; Read (U t Int r) where\n  readPrec = (U1 . unU1Wrap) &lt;$&gt; readPrec\ninstance (Read (U2Wrap t r)) =&gt; Read (U t Char r) where\n  readPrec = do\n    x &lt;- readPrec\n    return $ case x of\n      (U2Wrap y) -&gt; U2 y\ninstance (Show (t r)) =&gt; Show (U t Int r) where\n  show (U1 x) = show $ U1Wrap x\ninstance (Show (t r)) =&gt; Show (U t Char r) where\n  show (U2 x) = show (U2Wrap x :: U2Wrap t r)\n</code></pre>\n\n<p>Like <code>Foo</code>, <code>U</code> is a complicated GADT, so I define custom newtype wrappers for each output type of the GADT. Unfortunately, my <code>Show</code>/<code>Read</code> instances don't work:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  let x = U1 $ Foo $ Bar 3\n      y = U2 $ Foo $ Bar 3\n  print $ show (read (show x) `asTypeOf` x)\n  print $ show (read (show y) `asTypeOf` y)\n</code></pre>\n\n<p><code>main</code> prints the first line, but I get <code>Exception: Prelude.read: no parse</code> on the second line.</p>\n\n<p>This is my first time using <code>Read</code>, so I suspect I'm doing something incorrectly, though I don't see what that is.  </p>\n\n<p>My questions are: </p>\n\n<ol>\n<li>Why am I getting this error, and <em>logically</em> how can I fix it? (There are several ways to poke the minimal example above to make the error go away, but I can't do those things in my real code.)</li>\n<li>Is there a different/better high-level approach to <code>Read</code>ing GADTs?</li>\n</ol>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1456160650, "post_id": 35559514, "comment_id": 58807281, "body": "The code looks OK to me. I guess the real question is: why do you want to do this?"}, {"owner": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1456160985, "post_id": 35559514, "comment_id": 58807528, "body": "I&#39;d like to solve the <a href=\"https://benchmarksgame.alioth.debian.org/u64q/fannkuchredux-description.html#fannkuchredux\" rel=\"nofollow noreferrer\">fannkuch-redux problem</a>. The current solution is slow and ugly."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1456161184, "post_id": 35559514, "comment_id": 58807679, "body": "Right. So it&#39;s a benchmark to see how quickly you can swap stuff, rather than produce an actual useful result..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1456165742, "post_id": 35559514, "comment_id": 58810479, "body": "If you are doing this for a benchmark against other languages which use arrays instead of linked lists, I would use arrays instead of linked lists. Otherwise, the comparison is quite unfair, IMHO."}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 3, "creation_date": 1456169518, "post_id": 35559514, "comment_id": 58812605, "body": "The current solution does use arrays.  I&#39;m not sure why you consider it &quot;slow and ugly,&quot; though...or why you think linked lists would outperform arrays."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1456183214, "post_id": 35559514, "comment_id": 58820057, "body": "@LouisWasserman, well, it <i>is</i> a lot slower than the leading implementations. This may be due in part to it being sequential rather than parallel. The heavy use of unsafe vector operations could be seen as ugly, and the code could really use some comments."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456166630, "post_id": 35559679, "comment_id": 58810983, "body": "If I read the STG correctly (big if), you&#39;re building a closure for each of the reversed elements, at least on GHC 7.8.3."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1456161063, "creation_date": 1456161063, "answer_id": 35559679, "question_id": 35559514, "link": "https://stackoverflow.com/questions/35559514/reverse-first-k-elements-of-a-list/35559679#35559679", "title": "Reverse first k elements of a list", "body": "<p>Well, usually I'd just write <code>splitAt 3 &gt;&gt;&gt; first reverse &gt;&gt;&gt; uncurry(++)</code> to achieve the goal.</p>\n\n<p>If you're anxious about performance, you can consider a difference list:</p>\n\n<pre><code>reverseFirstN :: Int -&gt; [a] -&gt; [a]\nreverseFirstN = go id\n where go rev 0 xs = rev xs\n       go rev k (x:xs) = go ((x:).rev) (k-1) xs\n</code></pre>\n\n<p>but frankly I wouldn't expect this to be a lot faster: you need to traverse the first <em>n</em> elements either way. Actual performance will depend a lot on what the compiler is able to fuse away.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 5, "last_activity_date": 1456182891, "last_edit_date": 1456182891, "creation_date": 1456162216, "answer_id": 35560083, "question_id": 35559514, "link": "https://stackoverflow.com/questions/35559514/reverse-first-k-elements-of-a-list/35560083#35560083", "title": "Reverse first k elements of a list", "body": "<p>Let's think about the usual structure of <code>reverse</code>:</p>\n\n<pre><code>reverse = rev [] where\n  rev acc [] = acc\n  rev acc (x : xs) = rev (x : acc) xs\n</code></pre>\n\n<p>It starts with the empty list and tacks on elements from the front of the argument list till it's done. We want to do something similar, except we want to tack the elements onto the front of the portion of the list that we don't reverse. How can we do that when we don't <em>have</em> that un-reversed portion yet?</p>\n\n<p>The simplest way I can think of to avoid traversing the front of the list twice is to use laziness:</p>\n\n<pre><code>reverseFirst :: Int -&gt; [a] -&gt; [a]\nreverseFirst k xs = dis where\n  (dis, dat) = rf dat k xs\n\n  rf acc 0 ys = (acc, ys)\n  rf acc n [] = (acc, [])\n  rf acc n (y : ys) = rf (y : acc) (n - 1) ys\n</code></pre>\n\n<p><code>dat</code> represents the portion of the list that is left alone. We calculate it in the same helper function <code>rf</code> that does the reversing, but we also <em>pass it</em> to <code>rf</code> in the initial call. It's never actually examined in <code>rf</code>, so everything just works. Looking at the generated core (using <code>ghc -O2 -ddump-simpl -dsuppress-all -dno-suppress-type-signatures</code>) suggests that the pairs are compiled away into unlifted pairs and the <code>Int</code>s are unboxed, so everything should probably be quite efficient.</p>\n\n<hr>\n\n<p>Profiling suggests that this implementation is about 1.3 times as fast as the difference list one, and allocates about 65% as much memory.</p>\n"}], "owner": {"reputation": 2442, "user_id": 3666302, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e9aed854fcd666aba1316ef908ad5913?s=128&d=identicon&r=PG&f=1", "display_name": "TomTom", "link": "https://stackoverflow.com/users/3666302/tomtom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 1, "accepted_answer_id": 35560083, "answer_count": 2, "score": 2, "last_activity_date": 1456182891, "creation_date": 1456160544, "question_id": 35559514, "link": "https://stackoverflow.com/questions/35559514/reverse-first-k-elements-of-a-list", "title": "Reverse first k elements of a list", "body": "<p>I'd like to reverse the first k elements of a list efficiently.</p>\n\n<p><strong>This is what I came up with:</strong></p>\n\n<pre><code>reverseFirst :: Int -&gt; [a] -&gt; [a] -&gt; [a]\nreverseFirst 0 xs rev     = rev ++ xs\nreverseFirst k (x:xs) rev = reverseFirst (k-1) xs (x:rev)\n\nreversed = reverseFirst 3 [1..5] mempty -- Result: [3,2,1,4,5]\n</code></pre>\n\n<p>It is fairly nice, but the <code>(++)</code> bothers me. Or should I maybe consider using another data structure? I want to do this many million times with short lists.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456228973, "post_id": 35557964, "comment_id": 58840538, "body": "Nice work-around. I suspect the library itself probably <i>should</i> be using a similar technique."}], "answers": [{"comments": [{"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1456158293, "post_id": 35558365, "comment_id": 58805560, "body": "Nope; <code>{-# NOINLINE [0] insEdge #-}</code> didn&#39;t work. Trying again without the phase restriction, though is there any way to get the compiler to dump intermediate places where it could have applied rules, but just didn&#39;t?"}, {"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1456158491, "post_id": 35558365, "comment_id": 58805720, "body": "And trying it again without the phase restriction as <code>{-# NOINLINE insEdge #-}</code> also failed to work."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1456158633, "post_id": 35558365, "comment_id": 58805817, "body": "@DanielMartin, what happens if you <code>SPECIALIZE</code> <code>makeGraph</code> to <code>Pt.Gr</code> or mark it <code>INLINE</code>? (especially with the phased <code>NOINLINE</code>, but also without, to compare). If it&#39;s using it compiled unspecialized, then the rules surely won&#39;t fire."}, {"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1456159509, "post_id": 35558365, "comment_id": 58806451, "body": "Well, <code>-ddump-rule-firings</code> implies that it&#39;s already getting specialized automatically. More to the point though, if I modify <code>Data.Graph.Inductive.PatriciaTree</code> to have a special version of <code>insEdges</code> (defined exactly as the generic version but using <code>fastInsEdge</code>), then both <code>main1</code> and <code>main2</code> are fast, so the issue isn&#39;t <code>makeGraph</code> getting inlined or not specialized; it&#39;s something about the <code>insEdge</code> rule not firing in the expansion of <code>insEdges</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1456159739, "post_id": 35558365, "comment_id": 58806614, "body": "@DanielMartin, my point there is that the specialization has to reach (a not-yet-inlined) <code>insEdge</code> to give that rule a chance to fire. If any link in the chain decides not to specialize/inline, then it won&#39;t. Like I said, fussy. You may want to mark <code>insEdges</code> <code>INLINABLE</code> and see if that works."}, {"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1456160362, "post_id": 35558365, "comment_id": 58807090, "body": "Okay, so adding <code>{-# INLINABLE insEdges #-}</code> made everything fast (didn&#39;t even need a <code>NOINLINE</code> on <code>insEdge</code>). But... why? This was debugging by random code changes! Also, the description of the pragma says &quot;In other words the choice is left to GHC, which uses the same rules as for pragma-free functions.&quot; Why then does it have any effect at all?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1456160776, "post_id": 35558365, "comment_id": 58807373, "body": "@DanielMartin, without <code>INLINABLE</code>, GHC may choose not to export an unfolding for <code>insEdges</code> from its module, and apparently it decides that (this should be filed as a bug against the library for sure). With <code>INLINABLE</code>, the unfolding is exported, so GHC at least has the option of inlining <i>or specializing</i> in the importing module, based on whether it sees a potential advantage there that may not have been apparent in the defining module. Yes, this is all rather flaky! I&#39;d still advise adding the phased <code>NOINLINE</code> for <code>insEdge</code>, just to be sure."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1456161321, "post_id": 35558365, "comment_id": 58807770, "body": "@DanielMartin, I just <a href=\"https://github.com/haskell/fgl/issues/26\" rel=\"nofollow noreferrer\">opened an issue</a>."}, {"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1456165146, "post_id": 35558365, "comment_id": 58810133, "body": "Actually, it appears from what --show-iface has to say that at least part of the issue is that without INLINABLE, <code>insEdges</code> is getting compiled so as to call a function <code>$winsEdge</code> instead of <code>insEdge</code>. That function is exactly like <code>insEdge</code> except that it has the signature <code>(DynGraph gr) =&gt; Node -&gt; Node -&gt; b -&gt; gr a b -&gt; gr a b</code>. That is, <code>$winsEdge</code> has the initial tuple decomposed. the INLINABLE version of <code>insEdges</code> calls the proper <code>insEdge</code>, which can get replaced by the RULE. Why? No clue."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1456166021, "post_id": 35558365, "comment_id": 58810623, "body": "@DanielMartin, the non-inlinable one is compiled un-specialized, using <code>$winsEdge</code>, the un-specialized compiled form of <code>insEdge</code>. The inlinable one exposes an unfolding with (approximately) the original text of the function, which uses <code>insEdge</code>. That then gets specialized properly."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 1, "last_activity_date": 1456160992, "last_edit_date": 1456160992, "creation_date": 1456157312, "answer_id": 35558365, "question_id": 35557964, "link": "https://stackoverflow.com/questions/35557964/library-ghc-rules-dont-activate/35558365#35558365", "title": "Library ghc RULES don&#39;t activate", "body": "<p>I haven't done any experiments, but here's my guess. The <code>insEdge</code> function is not marked with a (phased) <code>INLINE</code> or <code>NOINLINE</code>, so the inliner is free to inline it whenever it's fully applied. In the definition of <code>insEdges</code>, we see</p>\n\n<pre><code>foldl' (flip insEdge) g es\n</code></pre>\n\n<p>Inlining <code>foldl'</code> gives</p>\n\n<pre><code>foldr f' id es g\n  where f' x k z = k $! flip insEdge z x\n</code></pre>\n\n<p><code>flip</code> is now fully applied, so we can inline it:</p>\n\n<pre><code>foldr f' id es g\n  where f' x k z = k $! insEdge x z\n</code></pre>\n\n<p>Now <code>insEdge</code> is fully applied, so GHC may choose to inline it right then and there, before the rule ever has a chance to fire.</p>\n\n<p>Try adding <code>{-# NOINLINE [0] insEdge #-}</code> right by the definition of <code>insEdge</code> and see what happens. If it works, submit a pull request to <code>fgl</code>.</p>\n\n<p>P.S. In my opinion, this sort of thing should really be done by using class methods with defaults, rather than rewrite rules. Rules are always a bit fussy.</p>\n\n<hr>\n\n<p>As the comments revealed, the big problem wasn't premature inlining, but rather a failure to specialize <code>insEdge</code>. In particular, <code>Data.Graph.Inductive.Graph</code> does not export an unfolding for <code>insEdges</code>, so it's impossible to specialize it, and the <code>insEdge</code> it calls, to the appropriate type. The ultimate fix was to mark <code>insEdges</code> <code>INLINABLE</code>, but I would still advise marking <code>insEdge</code> <code>NOINLINE [0]</code> out of an abundance of caution.</p>\n"}], "owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 35558365, "answer_count": 1, "score": 1, "last_activity_date": 1456228600, "creation_date": 1456156219, "last_edit_date": 1456228600, "question_id": 35557964, "link": "https://stackoverflow.com/questions/35557964/library-ghc-rules-dont-activate", "title": "Library ghc RULES don&#39;t activate", "body": "<p><code>fgl</code> is a Haskell library for graph manipulation. This library comes with an implementation of its base classes - <code>Data.Graph.Inductive.PatriciaTree</code> - that is supposedly highly tuned for performance. Part of that performance tuning involves ghc RULES pragmas to replace certain generic functions with specialized versions that are much faster.</p>\n\n<p>However, my evidence is that these RULES don't seem to work at all, and I don't understand why not. For people trying to replicate exactly what I see, I've put my test project up at <a href=\"https://github.com/fizbin/GraphOptiTest\" rel=\"nofollow\">https://github.com/fizbin/GraphOptiTest</a> and am using ghc version <code>7.10.2</code>.</p>\n\n<hr>\n\n<p>Here's my test program:</p>\n\n<pre><code>{-# LANGUAGE TupleSections #-}\n\nmodule Main where\n\nimport Control.Exception\nimport Control.Monad\nimport Data.Graph.Inductive\nimport qualified Data.Graph.Inductive.PatriciaTree as Pt\nimport qualified MyPatriciaTree as MPt\n\nmakeGraph :: (DynGraph gr) =&gt; Int -&gt; gr () Int\nmakeGraph n = mkGraph (map (,()) [1 .. n])\n  (concatMap (\\x -&gt; map (\\y -&gt; (x, y, x*y)) [x .. n]) [1 .. n])\n\nmain1 :: IO ()\nmain1 =\n  replicateM_ 200 $ let x = makeGraph 200 :: Pt.Gr () Int\n                    in evaluate (length $ show x)\n\nmain2 :: IO ()\nmain2 =\n  replicateM_ 200 $ let x = makeGraph 200 :: MPt.Gr () Int\n                    in evaluate (length $ show x)\n\nmain :: IO ()\nmain = main1 &gt;&gt; main2\n</code></pre>\n\n<p>Now, <code>Data.Graph.Inductive.PatriciaTree</code> has this definition for the class function <code>mkGraph</code>:</p>\n\n<pre><code>    mkGraph vs es   = insEdges es\n                      . Gr\n                      . IM.fromList\n                      . map (second (\\l -&gt; (IM.empty,l,IM.empty)))\n                      $ vs\n</code></pre>\n\n<p>Where <code>insEdges</code> is a function defined in the module <code>Data.Graph.Inductive.Graph</code> as:</p>\n\n<pre><code>insEdges :: (DynGraph gr) =&gt; [LEdge b] -&gt; gr a b -&gt; gr a b\ninsEdges es g = foldl' (flip insEdge) g es\n</code></pre>\n\n<p>And <code>Data.Graph.Inductive.PatriciaTree</code> has this to say about <code>insEdge</code>:</p>\n\n<pre><code>{-# RULES\n      \"insEdge/Data.Graph.Inductive.PatriciaTree\"  insEdge = fastInsEdge\n  #-}\nfastInsEdge :: LEdge b -&gt; Gr a b -&gt; Gr a b\nfastInsEdge (v, w, l) (Gr g) = g2 `seq` Gr g2\n  where\n    g1 = IM.adjust addSucc' v g\n    g2 = IM.adjust addPred' w g1\n\n    addSucc' (ps, l', ss) = (ps, l', IM.insertWith addLists w [l] ss)\n    addPred' (ps, l', ss) = (IM.insertWith addLists v [l] ps, l', ss)\n</code></pre>\n\n<p>So, in theory, when I run <code>main1</code> in my test program I should get that compiled down into something that eventually calls <code>fastInsEdge</code>.</p>\n\n<p>To test this, I compare against a modified version of <code>Data.Graph.Inductive.PatriciaTree</code> that uses this as its definition of the <code>mkGraph</code> method: (this is the class <code>MyPatriciaTree</code> used above in <code>main2</code>)</p>\n\n<pre><code>    mkGraph vs es   = doInsEdges\n                      . Gr\n                      . IM.fromList\n                      . map (second (\\l -&gt; (IM.empty,l,IM.empty)))\n                      $ vs\n      where\n        doInsEdges g = foldl' (flip fastInsEdge) g es\n</code></pre>\n\n<p>When I run my test program (after <code>cabal configure --enable-library-profiling --enable-executable-profiling</code> and <code>cabal build GraphOptiTest</code>), though, the <code>main2</code> method smokes the <code>main1</code> method. It isn't even close - the profile shows 99.2% of the program's time is spent inside <code>main1</code>. (and changing the program to just run <code>main2</code> shows that yes, <code>main2</code> is really fast on its own)</p>\n\n<p>Yes, I do have <code>-O</code> in the <code>ghc-options</code> section of my cabal file.</p>\n\n<p>Trying ghc options like <code>-ddump-rule-firings</code> doesn't really help - all I can see is that these replacement rules aren't firing, but I have no idea why. I don't know how to get the compiler to tell me why it didn't activate the replacement rules.</p>\n\n<hr>\n\n<p>Bringing up something discovered by messing around with <code>fgl</code>'s source in response @dfeuer's answer below:</p>\n\n<p>If I add a specialized version of <code>insEdges</code> to <code>Data.Graph.Inductive.PatriciaTree</code> as:</p>\n\n<pre><code>{-# RULES\n      \"insEdges/Data.Graph.Inductive.PatriciaTree\"  insEdges = fastInsEdges\n  #-}\nfastInsEdges :: [LEdge b] -&gt; Gr a b -&gt; Gr a b\nfastInsEdges es g = foldl' (flip fastInsEdge) g es\n</code></pre>\n\n<p>Then both <code>main1</code> and <code>main2</code> are now fast. This replacement rule fires; why doesn't the other one? (And no, telling ghc to <code>NOINLINE</code> the function <code>insEdge</code> does no good)</p>\n\n<hr>\n\n<p>EPILOGUE:</p>\n\n<p>So there's now a bug filed with the <code>fgl</code> package for not tagging their functions that use <code>insEdge</code> and <code>insNode</code> appropriately so that the fast versions will be used. But in my code now I work around this and the workaround may be useful in more situations, so I thought I'd share it. At the top of my code now, I have:</p>\n\n<pre><code>import qualified Data.Graph.Inductive as G\nimport qualified Data.Graph.Inductive.PatriciaTree as Pt\n\n-- Work around design and implementation performance issues\n-- in the Data.Graph.Inductive package.\n-- Specifically, the tuned versions of insNode, insEdge, gmap, nmap, and emap\n-- for PatriciaTree graphs are exposed only through RULES pragmas, meaning\n-- that you only get them when the compiler can specialize the function\n-- to that specific instance of G.DynGraph. Therefore, I create my own\n-- type class with the functions that have specialized versions and use that\n-- type class here; the compiler then can do the specialized RULES\n-- replacement on the Pt.Gr instance of my class.\nclass (G.DynGraph gr) =&gt; MyDynGraph gr where\n  mkGraph :: [G.LNode a] -&gt; [G.LEdge b] -&gt; gr a b\n  insNodes :: [G.LNode a] -&gt; gr a b -&gt; gr a b\n  insEdges :: [G.LEdge b] -&gt; gr a b -&gt; gr a b\n  insNode :: G.LNode a -&gt; gr a b -&gt; gr a b\n  insEdge :: G.LEdge b -&gt; gr a b -&gt; gr a b\n  gmap :: (G.Context a b -&gt; G.Context c d) -&gt; gr a b -&gt; gr c d\n  nmap :: (a -&gt; c) -&gt; gr a b -&gt; gr c b\n  emap :: (b -&gt; c) -&gt; gr a b -&gt; gr a c\n\ninstance MyDynGraph Pt.Gr where\n  mkGraph nodes edges = insEdges edges $ G.mkGraph nodes []\n  insNodes vs g = foldl' (flip G.insNode) g vs\n  insEdges es g = foldl' (flip G.insEdge) g es\n  insNode = G.insNode\n  insEdge = G.insEdge\n  gmap = G.gmap\n  nmap = G.nmap\n  emap = G.emap\n</code></pre>\n\n<p>(Had I used the <code>nemap</code> function in my code I would have included that in the class too) Then, any code of mine which was formerly written in terms of <code>(G.DynGraph gr) =&gt; ...</code> is now written in terms of <code>(MyDynGraph gr) =&gt; ...</code>. The compiler RULES activate for the <code>Pt.Gr</code> instance, and I then get the optimized version for each function.</p>\n\n<p>Essentially, this trades away the ability of the compiler to inline any of these functions into the calling code and possibly do other optimizations for always getting the optimized versions. (and the cost of an extra pointer indirection at runtime, but that's trivial in comparison) Since profiling showed that those other optimizations never yielded anything significant anyway, this was a clear net win in my case.</p>\n\n<p>Many people's code could use <code>SPECIALIZE</code> rules aggressively to get the optimized versions everywhere; however, sometimes that isn't possible and it wasn't in the real production code that caused my question without refactoring huge chunks of the application. I had a data structure with a member that has the type <code>(forall gr. G.DynGraph gr =&gt; tokType -&gt; gr () (MyEdge c))</code> - that now uses <code>MyDynGraph</code> for the class constraint, but completely unwinding it to not have <code>forall gr.</code> in the signature would have been a huge effort, and such a signature prevents specialization from working across that boundary.</p>\n"}, {"tags": ["list", "haskell", "primes", "lazy-evaluation", "infinite"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1456154586, "post_id": 35557199, "comment_id": 58802722, "body": "Can you make <code>member 1 (OL [2..10])</code> to return <code>False</code>, as one would expect? Possibly, also <code>member 1 (OL [])</code>. Otherwise, it really requires an infinite list."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1456174094, "post_id": 35557199, "comment_id": 58815186, "body": "The essence of this answer is &quot;you can&#39;t teach <code>elem</code> about the ordering; searching a presumed-sorted list is a different operation, so make a different function&quot;. The newtype wrapper isn&#39;t really directly relevant (though it&#39;s a nice answer to the follow up question &quot;how could I keep from accidentally applying <code>member</code> to a list that might not be sorted&quot;)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1456315277, "post_id": 35557199, "comment_id": 58887756, "body": "@Ben +1. I&#39;d stress it even more, as &quot;<b>No</b>, you <b>can&#39;t</b> teach <code>elem</code>&quot; new tricks; you have to define a new function for that."}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": false, "score": 4, "last_activity_date": 1456156618, "last_edit_date": 1456156618, "creation_date": 1456154037, "answer_id": 35557199, "question_id": 35556683, "link": "https://stackoverflow.com/questions/35556683/how-does-one-signify-an-infinite-list-to-be-ascending-for-elem-checks/35557199#35557199", "title": "How does one signify an infinite list to be ascending for elem checks?", "body": "<p>Sure. You can define your own <code>OrderedList</code> newtype, wrap the infinite list, define more efficient searching function that takes <code>OrderedList</code> as its argument.</p>\n\n<pre><code>newtype OrderedList a = OL [a]\nmember a (OL as) = case dropWhile (&lt;a) as of\n  []    -&gt; False\n  (x:_) -&gt; a == x\n</code></pre>\n\n<hr>\n\n<p>You cannot override the behavior of <code>elem</code> eventhough it's a class method of <code>Foldable</code>, since the definition of <code>elem</code> only requires the underlying element type to be <code>Eq</code>able, namely:</p>\n\n<pre><code>member :: (Ord a, Eq a) =&gt; a -&gt; OrderedList a -&gt; Bool\nelem :: (Eq a, Foldable t) =&gt; a -&gt; t a -&gt; Bool\n</code></pre>\n\n<p>You can verify that by the following code:</p>\n\n<pre><code>instance Foldable OrderedList where\n  foldMap f (OL as) = foldMap f as\n  elem = member -- error: Could not deduce `Ord a` arising from a use of `member`\n</code></pre>\n\n<hr>\n\n<p>Just a note: when your list is not infinite, you'd better consider make use of the tree-like structures (e.g. IntSet), they optimize the complexity of search operaton from O(n) to O(log(n)).</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1456314065, "post_id": 35557208, "comment_id": 58886908, "body": "or in general <a href=\"http://stackoverflow.com/a/28828217/849891\"><code>ordElem y xs = take 1 (dropWhile (&lt; y) xs) == [y]</code></a> which works with finite lists also."}], "tags": [], "owner": {"reputation": 30577, "user_id": 476496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85197b0087c5bee323d2690c977878f8?s=128&d=identicon&r=PG", "display_name": "Vincent Savard", "link": "https://stackoverflow.com/users/476496/vincent-savard"}, "is_accepted": true, "score": 6, "last_activity_date": 1456154063, "creation_date": 1456154063, "answer_id": 35557208, "question_id": 35556683, "link": "https://stackoverflow.com/questions/35556683/how-does-one-signify-an-infinite-list-to-be-ascending-for-elem-checks/35557208#35557208", "title": "How does one signify an infinite list to be ascending for elem checks?", "body": "<p>One possibility would be to use <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:dropWhile\" rel=\"noreferrer\"><code>dropWhile</code></a>:</p>\n\n<pre><code>isPrime n = (head $ dropWhile (&lt; n) primes) == n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1456319930, "last_edit_date": 1456319930, "creation_date": 1456155509, "answer_id": 35557751, "question_id": 35556683, "link": "https://stackoverflow.com/questions/35556683/how-does-one-signify-an-infinite-list-to-be-ascending-for-elem-checks/35557751#35557751", "title": "How does one signify an infinite list to be ascending for elem checks?", "body": "<p>One can code it as a fold:</p>\n\n<pre><code>memberOrd :: (Eq a, Ord a) =&gt; a -&gt; [a] -&gt; Bool\nmemberOrd x = foldr (\\y b -&gt; y==x || y&lt;x &amp;&amp; b) False\n</code></pre>\n\n<p>The laziness of <code>||</code> makes it work on infinite lists as well.</p>\n\n<p>(Clearly, we must assume that the list does not contain infinitely many elements <code>&lt; x</code>. We are not suddenly able to solve undecidable problems... ;-) )</p>\n\n<p>Will Ness below suggests the following variant, which performs fewer comparisons:</p>\n\n<pre><code>memberOrd x = foldr (\\y b -&gt; y&lt;x &amp;&amp; b || y==x) False\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 1207515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/yTgeq.jpg?s=128&g=1", "display_name": "Paradoxian", "link": "https://stackoverflow.com/users/1207515/paradoxian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 35557208, "answer_count": 3, "score": 3, "last_activity_date": 1456319930, "creation_date": 1456152771, "last_edit_date": 1456315579, "question_id": 35556683, "link": "https://stackoverflow.com/questions/35556683/how-does-one-signify-an-infinite-list-to-be-ascending-for-elem-checks", "title": "How does one signify an infinite list to be ascending for elem checks?", "body": "<p>I have an infinite list of primes initialized by the following list comprehension:</p>\n\n<pre><code>primes = [x | x &lt;- [2..], 0 `notElem` map (x `mod`) [2..(x `quot` 2)]]\n</code></pre>\n\n<p>This allows me to make checks like <code>17 `elem` primes</code> to confirm that 17 is a prime. However, when I check whether a non-prime is in the list, the program does not stop computing. I assume that this is because it does not realize that if the number cannot be found in the list before a prime that is greater than the number, it cannot be found anywhere in the list. Therefore, is there anyway in Haskell to signify to the compiler that a list contains only ascending numbers, so that an <code>elem</code> check will know to stop and return false if it reaches a number in the list greater than its first argument?   </p>\n"}, {"tags": ["haskell", "recursion", "fixpoint-combinators"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456151088, "post_id": 35555893, "comment_id": 58800024, "body": "wow ... I did not get the part with <code>fact</code> ^^ - but thanks for the update"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1456152183, "post_id": 35555938, "comment_id": 58800743, "body": "Interesting. For the same reason <code>f = bar f</code> will &quot;work&quot; with any <code>bar :: F a -&gt; a</code> where <code>F a</code> is any type (which may depend on <code>a</code>). E.g. <code>proj2 :: (a,a) -&gt; a</code>. I actually think there&#39;s nothing special about <code>fix</code> which is being exploited here."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1456152483, "post_id": 35555938, "comment_id": 58800972, "body": "Regarding <code>fix</code>, these also type check: <code>f3 :: a -&gt; a ; f3 = fix f3</code> and <code>f4 :: (a -&gt; a) -&gt; a -&gt; a ; f4 = fix f4</code>. Polymorphic recursion is still needed (of course!), but I find it interesting that we have more typings than <code>::a</code> (infinitely many, I presume)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1456154816, "post_id": 35555938, "comment_id": 58802923, "body": "@chi, see my edit responding to your first comment. Your second is valid as well, but because Haskell&#39;s evil <code>seq</code> can distinguish among <code>\u22a5</code>, <code>const \u22a5</code>, <code>const (const \u22a5)</code>, etc., the most general <code>forall a . a</code> typing is also the most informative."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1456155587, "post_id": 35555938, "comment_id": 58803585, "body": "What do you mean by parametricity in the answer ? I cannot immediately see that it is a bottom from parametricity."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1456156482, "post_id": 35555938, "comment_id": 58804296, "body": "@Sibi, something with type <code>forall a . a</code> must be able to produce something of type <code>a</code> for any <code>a</code>, without any information about <code>a</code>. This is impossible, but for \u22a5."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1456156565, "post_id": 35555938, "comment_id": 58804355, "body": "Ah, thanks. That makes it clear. Probably adding <code>forall</code> to the function <code>f</code> will make it easier."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 6, "last_activity_date": 1456154689, "last_edit_date": 1495535306, "creation_date": 1456150662, "answer_id": 35555938, "question_id": 35555893, "link": "https://stackoverflow.com/questions/35555893/what-is-the-fixed-point-of-fix/35555938#35555938", "title": "What is the fixed point of fix?", "body": "<p>Indeed, it will type check given a more general type, thanks to polymorphic recursion:</p>\n\n<pre><code>f :: a\nf = fix f\n</code></pre>\n\n<p>By parametricity, we can immediately see that it must be bottom, and based on the definition of <code>fix</code>, it must be an infinite loop rather than an exception.</p>\n\n<p>chi <a href=\"https://stackoverflow.com/questions/35555893/what-is-the-fixed-point-of-fix/35555938?noredirect=1#comment58800743_35555938\">comments</a>, \"For the same reason <code>f = bar f</code> will 'work' with any <code>bar :: F a -&gt; a</code> where <code>F a</code> is any type (which may depend on <code>a</code>)\". The definition looks like this:</p>\n\n<pre><code>foo :: forall f a .\n       (forall b . f b -&gt; b) -&gt; a\nfoo g = g (foo g)\n</code></pre>\n\n<p>Again, the type signature is bogus by parametricity, since I can choose, for example, <code>f ~ Identity</code>, at which point it is clear that the first argument is useless for producing the result.</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1563168043, "creation_date": 1456150519, "last_edit_date": 1563168043, "question_id": 35555893, "link": "https://stackoverflow.com/questions/35555893/what-is-the-fixed-point-of-fix", "title": "What is the fixed point of fix?", "body": "<p>A recent poster best left anonymous attempted to implement the factorial function like this:</p>\n\n<pre><code>f :: Int -&gt; Int\nf = fix f\n</code></pre>\n\n<p>This obviously didn't work out too well. But then I got to wondering: can I make it pass the type checker? What will its type reveal?</p>\n"}, {"tags": ["haskell", "compiler-errors"], "comments": [{"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "reply_to_user": {"reputation": 1464, "user_id": 3603374, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/MRRo6.gif?s=128&g=1", "display_name": "Sandeep", "link": "https://stackoverflow.com/users/3603374/sandeep"}, "edited": false, "score": 0, "creation_date": 1456148125, "post_id": 35554980, "comment_id": 58797959, "body": "@Sandeep Biradar: code formatting is for code only. Haskell is not code, it&#39;s a proper name."}, {"owner": {"reputation": 1464, "user_id": 3603374, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/MRRo6.gif?s=128&g=1", "display_name": "Sandeep", "link": "https://stackoverflow.com/users/3603374/sandeep"}, "reply_to_user": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "edited": false, "score": 0, "creation_date": 1456148240, "post_id": 35554980, "comment_id": 58798045, "body": "@Mat i did it for highlighting it."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456148257, "post_id": 35554980, "comment_id": 58798054, "body": "There are a whole lot of problems with your code, but none causes the error you quoted. Please post the exact contents of the file you tried to compile."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1456148700, "post_id": 35554980, "comment_id": 58798341, "body": "Guards should be indented more: try adding one or two spaces before each <code>|</code>. This will not fix all errors, but let&#39;s start with that."}, {"owner": {"reputation": 188064, "user_id": 635608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIJia.png?s=128&g=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/635608/mat"}, "reply_to_user": {"reputation": 1464, "user_id": 3603374, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/MRRo6.gif?s=128&g=1", "display_name": "Sandeep", "link": "https://stackoverflow.com/users/3603374/sandeep"}, "edited": false, "score": 1, "creation_date": 1456148714, "post_id": 35554980, "comment_id": 58798352, "body": "@SandeepBiradar: do not use code formatting for non-code. If normal English needs highlighting, use bold or italics (and use very little of it). No highlighting is necessary here anyway, just proper capitalization."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1456150832, "post_id": 35554980, "comment_id": 58799851, "body": "@leftaroundabout, the style of error message makes me wonder if the OP is using Hugs for some reason."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1456151694, "post_id": 35554980, "comment_id": 58800428, "body": "I guess your <code>sqrt</code> arguments are wrong, and turn out to be negative. Note that they are not the same as the value used in the guard above..."}, {"owner": {"reputation": 11, "user_id": 5963197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e81d23240972f2253e80f1ca8dfcf76?s=128&d=identicon&r=PG&f=1", "display_name": "bsas94", "link": "https://stackoverflow.com/users/5963197/bsas94"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1456151734, "post_id": 35554980, "comment_id": 58800445, "body": "@chi thanks! I took your advice and I indented the guards. The code hasn&#39;t worked out all right as yet, but at least it fixed the bad layout error. And yes, I am using WinHugs.  The fixed code is below:  <code>eqs a b c    | ((b^2) - (4*a*c)) &lt; 0 = &quot;Nao existem raizes reais&quot;   | otherwise =  &quot;x1= &quot; ++ show ((-b + sqrt((b^2) - (4*a*c))) &#47; (2*a)) ++ &quot; x2= &quot; ++ show (((-b - sqrt((b^2) - (4*a*c)))) &#47; (2*a))</code>  Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "is_accepted": false, "score": 1, "last_activity_date": 1456148199, "creation_date": 1456148199, "answer_id": 35555104, "question_id": 35554980, "link": "https://stackoverflow.com/questions/35554980/error-when-using-guards-in-haskell/35555104#35555104", "title": "Error when using guards in Haskell", "body": "<p>The unique problem I see in your code is a type error, not the parser error you've posted. The type error is on the following expression:</p>\n\n<pre><code> (-b + ((b^2) - (4*a*c))))2*a \n</code></pre>\n\n<p>I believe that you probably want to use division, so the correct expression should be</p>\n\n<pre><code> (-b + ((b^2) - (4*a*c)))) / (2*a)\n</code></pre>\n\n<p>Hope that this can help you. In order to better help you, please consider to post the whole content of your Haskell program file.</p>\n"}], "owner": {"reputation": 11, "user_id": 5963197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e81d23240972f2253e80f1ca8dfcf76?s=128&d=identicon&r=PG&f=1", "display_name": "bsas94", "link": "https://stackoverflow.com/users/5963197/bsas94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456148199, "creation_date": 1456147826, "last_edit_date": 1456148062, "question_id": 35554980, "link": "https://stackoverflow.com/questions/35554980/error-when-using-guards-in-haskell", "title": "Error when using guards in Haskell", "body": "<p>I created the following code in Haskell:</p>\n\n<pre><code>eqs a b c \n| ((b^2) - (4*a*c)) &lt; 0 = \"MESSAGE\"\n| otherwise =  \"x1= \" ++ show (sqrt((-b + ((b^2) - (4*a*c))))2*a) ++ \"x2= \" show (sqrt((-b - ((b^2) - (4*a*c))))2*a)\n</code></pre>\n\n<p>Why do I get the following error message?</p>\n\n<blockquote>\n  <p>ERROR file:.\\file.hs:2 - Syntax error in declaration (unexpected `;', possibly due to bad layout)</p>\n</blockquote>\n"}, {"tags": ["haskell", "conduit"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1456141656, "post_id": 35552262, "comment_id": 58793503, "body": "Judging from <code>Data.Conduit.List.map</code> implementation, i&#39;d say yes."}], "answers": [{"comments": [{"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 3, "creation_date": 1456145122, "post_id": 35553736, "comment_id": 58795912, "body": "It would be cool if <code>idC = awaitForever yield</code> were added to the library. Maybe I will create a PR for this."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1503786820, "post_id": 35553736, "comment_id": 78759368, "body": "@Mark any news regarding the PR?"}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "reply_to_user": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1503819136, "post_id": 35553736, "comment_id": 78764012, "body": "@SwiftsNamesake, please see <a href=\"https://github.com/snoyberg/conduit/issues/255\" rel=\"nofollow noreferrer\">github.com/snoyberg/conduit/issues/255</a>"}], "tags": [], "owner": {"reputation": 3116, "user_id": 353187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfdc97f71e1b8c257ae1bbd52989785d?s=128&d=identicon&r=PG", "display_name": "xnyhps", "link": "https://stackoverflow.com/users/353187/xnyhps"}, "is_accepted": true, "score": 6, "last_activity_date": 1456144214, "creation_date": 1456144214, "answer_id": 35553736, "question_id": 35552262, "link": "https://stackoverflow.com/questions/35552262/is-there-identity-conduit/35553736#35553736", "title": "Is there identity conduit?", "body": "<p>The simplest way to write an identity conduit is probably:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>awaitForever yield\n</code></pre>\n\n<p>because this doesn't require an extra import.</p>\n\n<p>The definition of <code>Data.Conduit.List.map</code> is very similar:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>mapC f = awaitForever $ yield . f\n</code></pre>\n\n<p>(The difference between <code>mapC</code> and <code>map</code> has something to do with CPP macros to define fusion.)</p>\n\n<p>When optimization is on (<code>-O1</code>), it appears both options result in identical code, so it's just a matter of taste.</p>\n"}], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 35553736, "answer_count": 1, "score": 7, "last_activity_date": 1456145562, "creation_date": 1456139900, "last_edit_date": 1456145562, "question_id": 35552262, "link": "https://stackoverflow.com/questions/35552262/is-there-identity-conduit", "title": "Is there identity conduit?", "body": "<p>The title says it all. I've seen that some people apparently use <code>Data.Conduit.List.map id</code> as identity conduit, but is this the recommended way to stream data unchanged?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 5962100, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uqHqJMWVxFY/AAAAAAAAAAI/AAAAAAAAADw/QaNJIM01UeM/photo.jpg?sz=128", "display_name": "Martin V", "link": "https://stackoverflow.com/users/5962100/martin-v"}, "edited": false, "score": 0, "creation_date": 1456142856, "post_id": 35551469, "comment_id": 58794291, "body": "Thank you so much! It works as intended. I&#39;ll just modify it a bit to fit my program :)"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 5, "last_activity_date": 1525482926, "last_edit_date": 1525482926, "creation_date": 1456137535, "answer_id": 35551469, "question_id": 35551207, "link": "https://stackoverflow.com/questions/35551207/how-to-filter-unwanted-words-in-a-text-file-haskell/35551469#35551469", "title": "How to filter unwanted words in a text file Haskell", "body": "<p>This exercise can be completed using only bits and pieces from the Prelude. First let's parse your text into something more structured:</p>\n\n<pre><code>data Person = Person {\n    personName :: String,\n    personAge :: Int,\n    personLocation :: String\n}\n\nparse :: String -&gt; [Person]\nparse txt = let rows = map words (lines txt)\n            in map (\\[name, age, location] -&gt; Person name (read age) location) rows\n</code></pre>\n\n<p>I'm using the magical power of <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:map\" rel=\"nofollow noreferrer\"><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code></a> to drill down into the list produced by <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:lines\" rel=\"nofollow noreferrer\"><code>lines</code></a>. The lambda function I'm mapping over it is partial, though - it'll crash your program if any of the input lines are not in the correct format. In real-world code I'd be sure to handle failure more elegantly by building error-handling into my parser: I'd change the return type to <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#t:Either\" rel=\"nofollow noreferrer\"><code>Either String [Person]</code></a> and return <code>Left \"an error message\"</code> if it failed to parse. Parser libraries like <a href=\"https://hackage.haskell.org/package/parsec\" rel=\"nofollow noreferrer\">Parsec</a> provide error handling out of the box.</p>\n\n<p>Now we can straightforwardly <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:filter\" rel=\"nofollow noreferrer\"><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code></a> out the people we're not interested in.</p>\n\n<pre><code>londonPeople :: [Person] -&gt; [Person]\nlondonPeople = filter (\\p -&gt; personLocation p == \"London\")\n</code></pre>\n\n<p>Printing the output is simple too:</p>\n\n<pre><code>personToString :: Person -&gt; String\npersonToString (Person name age location) = unwords [name, show age, location]\n</code></pre>\n\n<p>We can plug together the pieces into a program:</p>\n\n<pre><code>input = \"Eric 27 London\\nJosefine 34 Stockholm\\nHans 50 London\"\n\nmain = let people = parse input\n           output = map personToString (londonPeople people)\n       in putStrLn (unlines output)\n</code></pre>\n\n<p>And running it produces the expected output.</p>\n\n<pre><code>$ runhaskell people.hs\nEric 27 London\nHans 50 London\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 5962100, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-uqHqJMWVxFY/AAAAAAAAAAI/AAAAAAAAADw/QaNJIM01UeM/photo.jpg?sz=128", "display_name": "Martin V", "link": "https://stackoverflow.com/users/5962100/martin-v"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 283, "favorite_count": 0, "accepted_answer_id": 35551469, "answer_count": 1, "score": -2, "last_activity_date": 1525482926, "creation_date": 1456136781, "last_edit_date": 1456136942, "question_id": 35551207, "link": "https://stackoverflow.com/questions/35551207/how-to-filter-unwanted-words-in-a-text-file-haskell", "title": "How to filter unwanted words in a text file Haskell", "body": "<p>I'm trying to write a program in Haskell that can filter out unwanted keywords from a text document. The text document contains information about persons, for example name, age and city, and I want to filter out all of the information associated to those persons who dose not fulfill the keyword.</p>\n\n<p>The database looks something like this: </p>\n\n<pre><code>\"Eric\" 27 \"London\"\n\"Josefine\" 34 \"Stockholm\"\n\"Hans\" 50 \"London\"\n</code></pre>\n\n<p>So if the keyword is \"London\", I want the following output:</p>\n\n<pre><code>\"Eric\" 27 \"London\"\n\"Hans\" 50 \"London\"\n</code></pre>\n\n<p>I've tried a bunch of different ways to store the information and to filter out the unwanted persons, but I'm now clueless on how this should be done.</p>\n"}, {"tags": ["haskell", "heroku"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456119455, "post_id": 35546310, "comment_id": 58781509, "body": "I just googled for <code>scotty heroku</code> and found <a href=\"https://github.com/egonSchiele/scotty-heroku\" rel=\"nofollow noreferrer\">this</a> - isn&#39;t this what you are looking for?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456119558, "post_id": 35546310, "comment_id": 58781540, "body": "<a href=\"http://adit.io/posts/2013-04-15-making-a-website-with-haskell.html\" rel=\"nofollow noreferrer\">this one</a> (second entry in the search) is older but should still work"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456119601, "post_id": 35546310, "comment_id": 58781550, "body": "this question here was the 3rd entry while the 4th yielded another <a href=\"https://haskellonheroku.com/tutorial/\" rel=\"nofollow noreferrer\">website</a> explaining it (not with scotty though - but the way to use the env. variables is present in the short git repo from the first comment)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456125390, "post_id": 35546310, "comment_id": 58783862, "body": "@Carsten, none of them worked for me. Why do you give advice if you haven&#39;t tried?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1456126492, "post_id": 35546310, "comment_id": 58784464, "body": "are you kidding me? You did not show any effort nor any code and I should try to magically check 3rd party blog posts against your project? For your information I played with the second one and while it might be outdated in some parts it worked for me - of course you probably have to look into some issues yourself - if you cannot get it working come back and give the errors you get with what <b>you</b> tried (code included)"}], "owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1456118656, "creation_date": 1456118656, "question_id": 35546310, "link": "https://stackoverflow.com/questions/35546310/how-to-deploy-a-haskell-web-app-to-heroku-in-a-simple-way", "title": "How to deploy a Haskell web app to Heroku in a simple way?", "body": "<p>I've been googling for a while but haven't found an answer to my question. What's a simple way to deploy a haskell application, in particular Snap and Scotty, to heroku? \nI'm looking for a lightweight solution. </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456126254, "post_id": 35546293, "comment_id": 58784318, "body": "@dfeuer yes I do ... happens do me all the time when I cannot check/compile my answers - sorry"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 4, "last_activity_date": 1456126334, "last_edit_date": 1456126334, "creation_date": 1456118522, "answer_id": 35546293, "question_id": 35546217, "link": "https://stackoverflow.com/questions/35546217/operator-and-map-function/35546293#35546293", "title": "&quot;&gt;&gt;=&quot; operator and &quot;map&quot; function", "body": "<h2>using <code>forM</code></h2>\n\n<p>In this case I would use <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:forM\" rel=\"nofollow\"><code>forM_</code></a>:</p>\n\n<pre><code>main = \n    forM_ [\"http://haskell.org/\",\"http://google.com/\"] (openBrowser &gt;=&gt; print)\n</code></pre>\n\n<p>which you can use to <em>repeat</em> an <code>a -&gt; IO b</code> action for each item in an list <code>[a]</code> and get an <code>IO ()</code> (the result of the action will be discarded - with the <code>forM_</code> version which is what we want as it should be our <code>main</code> so it has to be <code>IO ()</code> - the <code>forM</code> version would yield <code>IO [()]</code> instead)</p>\n\n<h2>using <code>mapM</code></h2>\n\n<p>or if you want to stick closer to your idea you can use <code>map</code> <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:mapM\" rel=\"nofollow\"><code>mapM_</code></a> instead:</p>\n\n<pre><code>main = \n    mapM_ (openBrowser &gt;=&gt; print) [\"http://haskell.org/\",\"http://google.com/\"]\n</code></pre>\n\n<p>which is just <code>forM_</code> with the arguments flipped - the type-explanation is just the same.</p>\n\n<h2>using <code>sequence</code></h2>\n\n<p>the reason yours does not work is that <code>openBrowswer</code> will return an <code>IO Bool</code> action (or so it seems based on the error message) and so the <code>map</code> will return an <code>[IO Bool]</code> but to use <code>(&gt;&gt;=)</code> you need some <code>IO a</code></p>\n\n<p>So you would need to first <em>collapse</em> the list into one <code>IO</code> action (which can be done with <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:sequence\" rel=\"nofollow\"><code>sequence :: [IO a] -&gt; IO [a]</code></a>):</p>\n\n<pre><code>main = \n    sequence (map openBrowser [\"http://haskell.org/\",\"http://google.com/\"]) &gt;&gt;= print\n</code></pre>\n\n<p>which should print an list <code>[True, True]</code> hopefully</p>\n\n<hr>\n\n<p>But I think what you really wanted to do is to open the site and print the result <em>for each</em> (on a newline without the list brackets)</p>\n"}], "owner": {"reputation": 19, "user_id": 5961119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66a9ba0161645483b30258872b0eaff2?s=128&d=identicon&r=PG&f=1", "display_name": "surmonter", "link": "https://stackoverflow.com/users/5961119/surmonter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1456126334, "creation_date": 1456117999, "question_id": 35546217, "link": "https://stackoverflow.com/questions/35546217/operator-and-map-function", "title": "&quot;&gt;&gt;=&quot; operator and &quot;map&quot; function", "body": "<p>I have a working code from the example of the openbrowser library.</p>\n\n<pre><code>import Web.Browser (openBrowser)\nmain :: IO ()\nmain = openBrowser \"http://haskell.org/\" &gt;&gt;= print\n</code></pre>\n\n<p>What I would like to do is to open two websites.</p>\n\n<p>So I was think doing something like:</p>\n\n<pre><code>main = map openBrowser [\"http://haskell.org/\",\"http://google.com/\"] &gt;&gt;= print\n</code></pre>\n\n<p>And I would get </p>\n\n<pre><code>Couldn't match type \u2018[]\u2019 with \u2018IO\u2019\nExpected type: IO (IO Bool)\nActual type: [IO Bool]\n</code></pre>\n\n<p>But I have a very hard time figuring out what is the proper way to call this >>= print command if I use map. </p>\n"}, {"tags": ["haskell", "char", "representation"], "answers": [{"tags": [], "owner": {"reputation": 26541, "user_id": 1532460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/dc5b338bf194a9e117af20bd9b2e4edb?s=128&d=identicon&r=PG", "display_name": "awesoon", "link": "https://stackoverflow.com/users/1532460/awesoon"}, "is_accepted": true, "score": 3, "last_activity_date": 1456116920, "creation_date": 1456116920, "answer_id": 35546039, "question_id": 35545906, "link": "https://stackoverflow.com/questions/35545906/why-in-haskell-char-is-represented-by-symbol-designed-like-this/35546039#35546039", "title": "Why in Haskell, &quot;Char&quot; is represented by &quot;\\&quot; symbol? Designed like this?", "body": "<p><code>Char</code> in Haskell represents Unicode symbols. </p>\n\n<p>The first symbol has code <code>0</code> and defined in Unicode as <a href=\"http://www.fileformat.info/info/unicode/char/0000/index.htm\" rel=\"nofollow\"><code>NULL</code></a>. It is also a part of ASCII character set and everyone associates <code>\\NUL</code> (as well as <code>\\NULL</code>) with <code>0</code>.</p>\n\n<p>The largest possible symbol has code <code>1114111</code> (<code>0x10ffff</code>) and defined as <a href=\"http://www.fileformat.info/info/unicode/char/10ffff/index.htm\" rel=\"nofollow\"><code>Noncharacter</code></a>. There are at least two Unicode symbols named <code>Noncharacter</code>: the second is <a href=\"http://www.fileformat.info/info/unicode/char/10fffe/index.htm\" rel=\"nofollow\"><code>0x10fffe</code></a>. </p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 35546039, "answer_count": 1, "score": 1, "last_activity_date": 1456116920, "creation_date": 1456115857, "question_id": 35545906, "link": "https://stackoverflow.com/questions/35545906/why-in-haskell-char-is-represented-by-symbol-designed-like-this", "title": "Why in Haskell, &quot;Char&quot; is represented by &quot;\\&quot; symbol? Designed like this?", "body": "<pre><code>Prelude&gt; maxBound::(Bool,Int,Char)\n(True,9223372036854775807,'\\1114111')\nPrelude&gt; minBound::Char\n'\\NUL'\n</code></pre>\n\n<p>Why it's showing \\NUL,  not a number like '\\1114111'?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1456111738, "post_id": 35545305, "comment_id": 58779358, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/14092801/haskell-where-clause-syntax-inside-a-do-block\">Haskell where clause syntax inside a do block</a>"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1456116227, "last_edit_date": 1456116227, "creation_date": 1456111925, "answer_id": 35545371, "question_id": 35545305, "link": "https://stackoverflow.com/questions/35545305/error-using-where-clause-in-let-statement/35545371#35545371", "title": "Error using where clause in let statement", "body": "<p>You presented lots of syntax issues.</p>\n\n<pre><code>contents = &lt;- getContents\n</code></pre>\n\n<p>That is invalid and should be <code>contents &lt;- getContents</code>.</p>\n\n<pre><code>let threes = groupsOf 3 (map read $ lines contents)\n   where groupsOf 0 _ = []\n</code></pre>\n\n<p>You can't have <code>where</code> after a let clause without further indentation.  You could either move the <code>where</code> clause to after the function,\\ declare <code>groupsOf</code> in a let clause, or indent the <code>where</code> a little past the indentation of the variables in the let clause:</p>\n\n<pre><code>let threes = groupsOf 3 (map read $ lines contents)\n    groupsOf 0 _ = []\n    groupsOf _ [] = []\n    groupsOf n xs = take n xs : groupsOf n (drop n xs)\n</code></pre>\n\n<p>Edit: And after referring to the Haskell 2010 report, I don't think <code>let { decls } where {decls}</code> is actually valid Haskell.  GHC parses the expressions, which I think is legitimate and nice in some situations although bad style here.</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1456116227, "creation_date": 1456111367, "last_edit_date": 1456112581, "question_id": 35545305, "link": "https://stackoverflow.com/questions/35545305/error-using-where-clause-in-let-statement", "title": "Error using where clause in let statement", "body": "<p>Here's my code:</p>\n\n<pre><code>main = do\n   contents &lt;- getContents \n   let threes = groupsOf 3 (map read $ lines contents)\n      where groupsOf 0 _ = []\n            groupsOf _ [] = []\n            groupsOf n xs = take n xs : groupsOf n (drop n xs)\n    putStrLn $ show threes\n</code></pre>\n\n<p>When I run this while piping a text file into the input I get:</p>\n\n<pre><code>test.hs:4:13: parse error on input `groupsOf'\n</code></pre>\n\n<p>Not sure what I'm doing wrong here. From what I can tell my syntax is correct...</p>\n"}, {"tags": ["list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1456110622, "post_id": 35544962, "comment_id": 58779072, "body": "You would get this error even for two lists of the same size, even for two empty lists. Can you think of a reason why?"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "edited": false, "score": 0, "creation_date": 1456111378, "post_id": 35545215, "comment_id": 58779256, "body": "oh wow, i have been on this thing forever and i didnt know if i dont handle those cases it would give me such an error!! i got it now! i learned it the hard way @Sibi"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 3, "last_activity_date": 1456110695, "creation_date": 1456110695, "answer_id": 35545215, "question_id": 35544962, "link": "https://stackoverflow.com/questions/35544962/convert-a-tuple-of-lists-into-one-list/35545215#35545215", "title": "convert a tuple of lists, into one list", "body": "<blockquote>\n  <p>Non-exhaustive patterns in function func</p>\n</blockquote>\n\n<p>This indicates the you haven't handled all the cases. Imagine what happens in the following cases:</p>\n\n<pre><code>func (x,[]) = ???\nfunc ([],y) = ???\n</code></pre>\n\n<p>Let me know if you need more hints.</p>\n"}], "owner": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "accepted_answer_id": 35545215, "answer_count": 1, "score": 1, "last_activity_date": 1456110695, "creation_date": 1456108782, "last_edit_date": 1456109223, "question_id": 35544962, "link": "https://stackoverflow.com/questions/35544962/convert-a-tuple-of-lists-into-one-list", "title": "convert a tuple of lists, into one list", "body": "<p>im trying to convert a tuple of lists to a list but i have not had any success\nso i have the function</p>\n\n<pre><code>func :: ([a],[a]) -&gt; [a]\n</code></pre>\n\n<p>which gets input such as :  </p>\n\n<blockquote>\n  <p>( [1,2,3,4], [7,8,9] )</p>\n</blockquote>\n\n<p>and should return :</p>\n\n<blockquote>\n  <p>[1,7,2,8,3,9,4]</p>\n</blockquote>\n\n<p>and i have</p>\n\n<pre><code>func (x:xs , y:ys) = x : y : func (xs, ys) \n</code></pre>\n\n<p>what i get as a result is :</p>\n\n<blockquote>\n  <p>[1,7,2,8,3,9*** Exception: hw2.hs:29:1-54: Non-exhaustive patterns in function func</p>\n</blockquote>\n\n<p>i know i get this error because lists are not the same size, how do you guys think i can fix this issue</p>\n"}, {"tags": ["haskell", "haskell-pipes"], "answers": [{"comments": [{"owner": {"reputation": 1729, "user_id": 3859522, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fe4a78465ab98520ed124337edad97c8?s=128&d=identicon&r=PG&f=1", "display_name": "Dulguun Otgon", "link": "https://stackoverflow.com/users/3859522/dulguun-otgon"}, "edited": false, "score": 0, "creation_date": 1456140661, "post_id": 35545396, "comment_id": 58792920, "body": "is everything after <code>buzzHash</code> in a state monad?"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "reply_to_user": {"reputation": 1729, "user_id": 3859522, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fe4a78465ab98520ed124337edad97c8?s=128&d=identicon&r=PG&f=1", "display_name": "Dulguun Otgon", "link": "https://stackoverflow.com/users/3859522/dulguun-otgon"}, "edited": false, "score": 1, "creation_date": 1456144373, "post_id": 35545396, "comment_id": 58795368, "body": "The three pipe things linked by <code>&gt;-&gt;</code> all transform <code>(StateT Word64 IO)</code>, yes. So, <code>buzzHash</code> is specialized to <code>Pipe Word8 Word64 (StateT Word64 IO) ()</code>, <code>P.print</code> specializes to <code>Consumer Word64 (StateT Word64 IO) ()</code>, and <code>view PB.unpack PB.stdin</code> to <code>Producer Word8 (StateT Word64 IO) ()</code> to use the type-synonyms pipes uses. So when you glue them together side by side, you get an <code>Effect (StateT Word64 IO) ()</code>. So then when you apply <code>runEffect</code> you get a <code>StateT Word64 IO ()</code>. And next when you apply <code>runStateT</code> you have a <code>Word64 -&gt; IO ((),Word64)</code>."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "reply_to_user": {"reputation": 1729, "user_id": 3859522, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fe4a78465ab98520ed124337edad97c8?s=128&d=identicon&r=PG&f=1", "display_name": "Dulguun Otgon", "link": "https://stackoverflow.com/users/3859522/dulguun-otgon"}, "edited": false, "score": 1, "creation_date": 1456150236, "post_id": 35545396, "comment_id": 58799443, "body": "I added a bit about <code>evalStateP</code> etc. at the end. Maybe this is more suitable, since it doesn&#39;t involve tuning the pipeline so that everything agrees. Rather, we just write a <code>buzzHash</code> function that doesn&#39;t explicitly involve <code>StateT</code> in the type."}], "tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": true, "score": 3, "last_activity_date": 1456150160, "last_edit_date": 1456150160, "creation_date": 1456112065, "answer_id": 35545396, "question_id": 35544646, "link": "https://stackoverflow.com/questions/35544646/pipe-that-maintains-state/35545396#35545396", "title": "Pipe that maintains state", "body": "<p>You were almost there; you just need to run the state.</p>\n\n<pre><code>main = do\n  bs &lt;- L.unpack `fmap` L.getContents\n  flip execStateT 0 $ runEffect $ produceList bs &gt;-&gt; buzzHash &gt;-&gt; hoist lift stdoutLn\n</code></pre>\n\n<p>I assume you don't want to recover the state, so I use <code>execStateT</code> rather than <code>runStateT</code>.</p>\n\n<p>The only curiosity here is that <code>stdoutLn</code> was marked as <code>Consumer Word64 IO ()</code> . So I use <code>hoist lift</code> to make it <code>Consumer Word64 (StateT Word64 IO) ()</code> Everything in the series <code>a &gt;-&gt; b &gt;-&gt; c</code> must agree in the underlying monad and return type.</p>\n\n<p>Here are a few further comments that might save you time. First <code>produceFromList</code> is <code>each</code>.</p>\n\n<p>Moreover, you could have avoided the <code>hoist lift</code> by relabeling your <code>stdoutLn</code>:</p>\n\n<pre><code>stdoutLn :: MonadIO m =&gt; Consumer Word64 m ()\nstdoutLn = do \n   a &lt;- await \n   liftIO $ print a\n</code></pre>\n\n<p>But here there is some trouble: you are not repeating the action. This should pretty clearly be a loop:  </p>\n\n<pre><code>stdoutLn :: MonadIO m =&gt; Consumer Word64 m ()\nstdoutLn = do \n   a &lt;- await \n   liftIO $ print a\n   stdoutLn\n</code></pre>\n\n<p>in fact this is already available as <code>P.print</code>, so we can write </p>\n\n<pre><code>import qualified Pipes.Prelude as P\nmain = do\n  bs &lt;- L.unpack `fmap` L.getContents\n  flip execStateT 0 $ runEffect $ each bs &gt;-&gt; buzzHash &gt;-&gt; P.print\n</code></pre>\n\n<p>If I understand you, <code>buzzHash</code> is meant to be repeated indefinitely too:</p>\n\n<pre><code>buzzHash = do\n  x &lt;- await\n  h &lt;- lift $ get -- pull out previous value\n  let h' = rotate h 1 `xor` (hashArrW8!x) -- calculate new value\n  lift $ put h' -- save new value \n  yield h'\n  buzzHash\n</code></pre>\n\n<p>(this is <code>forever buzzHash</code>, where we use your <code>buzzHash</code>) </p>\n\n<p>Finally, if you </p>\n\n<pre><code> import qualified Pipes.ByteString as PB\n import Control.Lens (view) -- (or Lens.Micro.MTL or Lens.Simple)\n</code></pre>\n\n<p>we see we don't need the lazy bytestring IO, which doesn't stream properly anyway.\n<code>Pipes.ByteString</code> already has the <code>unpack</code> we want, packaged as a lens, so that we use <code>view PB.unpack</code> where elsewhere we would use <code>B.unpack</code>. So in the end we can write</p>\n\n<pre><code>main = flip evalStateT 0 $ runEffect $ view PB.unpack PB.stdin &gt;-&gt; buzzHash &gt;-&gt; P.print\n</code></pre>\n\n<p>Once it is in this form we see we aren't using the underlying state of the pipeline except in <code>buzzHash</code>, so we can localize this </p>\n\n<pre><code>import Pipes.Lift (evalStateP) \nmain =  runEffect $ view PB.unpack PB.stdin &gt;-&gt; evalStateP 0 buzzHash &gt;-&gt; P.print\n</code></pre>\n\n<p>or, if you like you can rewrite </p>\n\n<pre><code>buzzHash' :: Monad m =&gt; Word64 -&gt; Pipe Word8 Word64 m r\nbuzzHash' n = evalStateP n $ forever $ do\n    x &lt;- await\n    h &lt;- lift $ get -- pull out previous value\n    let h' = rotate h 1 `xor` (hashArrW8!x) -- calculate new value\n    lift $ put h' -- save new value \n    yield h'\n</code></pre>\n\n<p>Then you would write </p>\n\n<pre><code>main =  runEffect $ view PB.unpack PB.stdin &gt;-&gt; buzzHash' 0 &gt;-&gt; P.print\n</code></pre>\n"}], "owner": {"reputation": 1729, "user_id": 3859522, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/fe4a78465ab98520ed124337edad97c8?s=128&d=identicon&r=PG&f=1", "display_name": "Dulguun Otgon", "link": "https://stackoverflow.com/users/3859522/dulguun-otgon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 1, "accepted_answer_id": 35545396, "answer_count": 1, "score": 1, "last_activity_date": 1456150160, "creation_date": 1456106350, "question_id": 35544646, "link": "https://stackoverflow.com/questions/35544646/pipe-that-maintains-state", "title": "Pipe that maintains state", "body": "<p>I'm trying to calculate rolling hash values (buzzhash) for a big file using <code>pipes</code>.</p>\n\n<p>Currently I have this. But don't know how to write a pipe that maintains a state.</p>\n\n<pre><code>import qualified Data.ByteString.Lazy as L\nimport Data.Word\nimport Data.Bits(xor,rotate)\nimport Data.Array\nimport Pipes\nimport Control.Monad.State.Strict\nimport Control.Monad(forever)\n\nproduceFromList (x:xs) = do \n  yield x\n  produceFromList xs\n\nbuzzHash = do\n  x &lt;- await\n  h &lt;- lift $ get -- pull out previous value\n  let h' = rotate h 1 `xor` (hashArrW8!x) -- calculate new value\n  lift $ put h' -- save new value \n  yield h'\n\nstdoutLn :: Consumer Word64 IO ()\nstdoutLn = do \n  a &lt;- await \n  lift $ print a\n\nmain = do \n  bs &lt;- L.unpack `fmap` L.getContents\n  runEffect $ produceFromList bs &gt;-&gt; buzzHash &gt;-&gt; stdoutLn\n\nhashArrW8 :: Array Word8 Word64\n</code></pre>\n\n<p>How do I make buzzHash save previous value and use it for the calculation of next value? Initial state value should be 0.</p>\n"}, {"tags": ["haskell", "asynchronous"], "answers": [{"tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": true, "score": 1, "last_activity_date": 1456108617, "creation_date": 1456108617, "answer_id": 35544945, "question_id": 35544635, "link": "https://stackoverflow.com/questions/35544635/behavior-of-async-package/35544945#35544945", "title": "Behavior of async package", "body": "<blockquote>\n  <p>Will this merely spawn a single thread in which mapM_ occurs?</p>\n</blockquote>\n\n<p>Yes, it will fork a thread and immediately block waiting for the mapM_ to finish and return a <code>()</code> (or to throw an exception). </p>\n\n<p>The <code>async</code> package is very simple; you might like to look at the source to see how it all works together and learn more about the underlying haskell concurrency primitives.</p>\n"}], "owner": {"reputation": 330, "user_id": 5021764, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc1f8d5f08ef935d1f2a51db7cf02144?s=128&d=identicon&r=PG&f=1", "display_name": "the spectre", "link": "https://stackoverflow.com/users/5021764/the-spectre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 1, "accepted_answer_id": 35544945, "answer_count": 1, "score": 0, "last_activity_date": 1456155513, "creation_date": 1456106235, "last_edit_date": 1456155513, "question_id": 35544635, "link": "https://stackoverflow.com/questions/35544635/behavior-of-async-package", "title": "Behavior of async package", "body": "<p>What would the following code using the <code>async</code> package do:</p>\n\n<pre><code>action &lt;- async $ mapM_ someFunc someList\nwait action\n</code></pre>\n\n<p>Will this merely spawn a single thread in which <code>mapM_</code> occurs? (Implying that this has no benefit over just <code>mapM_ someFunc someList</code>)</p>\n\n<p>Or will it perform the <code>mapM_</code> action asynchronously (or is <code>mapConcurrently</code> the only way to get such behavior)?</p>\n"}, {"tags": ["haskell", "smt", "liquid-haskell"], "answers": [{"comments": [{"owner": {"reputation": 3629, "user_id": 379639, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4fa63505dd4dd4691b87d30508b1bfd3?s=128&d=identicon&r=PG", "display_name": "Xavier Shay", "link": "https://stackoverflow.com/users/379639/xavier-shay"}, "edited": false, "score": 0, "creation_date": 1456187944, "post_id": 35546483, "comment_id": 58821539, "body": "This did indeed work, but it&#39;s not clear to me why this matters - I&#39;m not making any assertions based on the concrete String type. Is this a limitation of the tool, or is my reasoning wrong?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "reply_to_user": {"reputation": 3629, "user_id": 379639, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4fa63505dd4dd4691b87d30508b1bfd3?s=128&d=identicon&r=PG", "display_name": "Xavier Shay", "link": "https://stackoverflow.com/users/379639/xavier-shay"}, "edited": false, "score": 0, "creation_date": 1456227014, "post_id": 35546483, "comment_id": 58839183, "body": "@XavierShay updated. I hope my explanation is satisfactory."}, {"owner": {"reputation": 3629, "user_id": 379639, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4fa63505dd4dd4691b87d30508b1bfd3?s=128&d=identicon&r=PG", "display_name": "Xavier Shay", "link": "https://stackoverflow.com/users/379639/xavier-shay"}, "edited": false, "score": 0, "creation_date": 1456247296, "post_id": 35546483, "comment_id": 58854176, "body": "thank you! The final example helped (&quot;One evidence...&quot;)."}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 4, "last_activity_date": 1456229836, "last_edit_date": 1456229836, "creation_date": 1456119537, "answer_id": 35546483, "question_id": 35544348, "link": "https://stackoverflow.com/questions/35544348/how-to-specify-a-function-operating-on-non-empty-data-structure-with-liquidhaske/35546483#35546483", "title": "How to specify a function operating on non-empty data structure with LiquidHaskell?", "body": "<p>Your refined type of <code>okList</code> is not restricting the type. It restricted the size but loose the type from <code>String</code> to <code>a</code>.</p>\n\n<p>Change</p>\n\n<pre><code>{-@ okList :: NEList a @-}\nokList = SL 1 [\"cat\"]\n</code></pre>\n\n<p>to</p>\n\n<pre><code>{-@ okList :: NEList String @-}\nokList = SL 1 [\"cat\"]\n</code></pre>\n\n<p>And it will work.</p>\n\n<hr>\n\n<p>I have to admit that I don't know liquidhaskell very well so everything below may only be my wild guess:  </p>\n\n<p>The main reason you have to do this is you are defining <code>okList</code> separately with the default constructor <code>SL</code>. The refined type of <code>SList</code> only promises that <code>size v = realSize (elems v)</code>, the size of the list is inspected when you call the constructor, compared with the number literal and then discarded, not stored at (liquid) type level. So when you feed <code>okList</code> to <code>hd</code>, the only information available for reasoning are <code>size v = realSize (elems v)</code> (from the refined data type) and <code>size v &gt;= 0</code> (<code>size</code> is defined as a <code>Nat</code>), <code>hd</code> won't know if it's positive.</p>\n\n<p>In <code>hd okList</code>, liquidhaskell may not be able to evaluate the expression and by doing so substitute <code>okList</code> with <code>Sl 1 [\"cat\"]</code> and gain information about the size, so it can only make judgement depend on the refined type of <code>okList</code> it inferred (in this case, <code>SList String</code>). One evidence is <code>hd $ SL 1 [\"cat\"]</code> will work with no refined type.</p>\n"}], "owner": {"reputation": 3629, "user_id": 379639, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4fa63505dd4dd4691b87d30508b1bfd3?s=128&d=identicon&r=PG", "display_name": "Xavier Shay", "link": "https://stackoverflow.com/users/379639/xavier-shay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 1, "accepted_answer_id": 35546483, "answer_count": 1, "score": 3, "last_activity_date": 1462143549, "creation_date": 1456103957, "last_edit_date": 1462143549, "question_id": 35544348, "link": "https://stackoverflow.com/questions/35544348/how-to-specify-a-function-operating-on-non-empty-data-structure-with-liquidhaske", "title": "How to specify a function operating on non-empty data structure with LiquidHaskell?", "body": "<p>I am trying to do the first exercise in the LiquidHaskell <a href=\"https://ucsd-progsys.github.io/liquidhaskell-tutorial/09-case-study-lazy-queues.html\" rel=\"nofollow\">case study on Lazy Queues</a></p>\n\n<pre><code>module Main where\n\nmain :: IO ()\nmain = putStrLn \"hello\"\n\n{-@ type Nat   = {v:Int | 0 &lt;= v}        @-}\n\n{-@ die :: {v:String | false} -&gt; a @-}\ndie x = error x\n\n{-@ measure realSize @-}\nrealSize      :: [a] -&gt; Int\nrealSize []     = 0\nrealSize (_:xs) = 1 + realSize xs\n\n{-@ data SList a = SL {\n       size  :: Nat \n     , elems :: {v:[a] | realSize v = size}\n     }\n  @-}\ndata SList a = SL { size :: Int, elems :: [a]}\n\n{-@ type NEList a = {v:SList a | 0 &lt; size v} @-}\n\n{-@ hd           :: NEList a -&gt; a @-}\nhd (SL _ (x:_))  = x \nhd _             = die \"empty SList\"\n\nokList = SL 1 [\"cat\"]\nokHd   = hd okList\n</code></pre>\n\n<p><code>okHd</code> fails:</p>\n\n<pre><code> app/Main.hs:30:13-18: Error: Liquid Type Mismatch\n   Inferred type\n     VV : {VV : (SList [Char]) | VV == Main.okList}\n\n   not a subtype of Required type\n     VV : {VV : (SList [Char]) | 0 &lt; size VV}\n\n   In Context\n     VV : {VV : (SList [Char]) | VV == Main.okList}\n     Main.okList\n        : (SList [Char])\n</code></pre>\n\n<p>From the error message, I'm pretty sure I'm not giving enough information to LH for it to \"know\" that <code>okList</code> is non-empty, but I can't figure out how to fix it.</p>\n\n<p>I tried telling it explicitly with a post-condition(?):</p>\n\n<pre><code>{-@ okList :: NEList a @-}\nokList = SL 1 [\"cat\"]\n</code></pre>\n\n<p>But this doesn't work:</p>\n\n<pre><code> app/Main.hs:29:5: Error: Specified Type Does Not Refine Haskell Type for Main.okList\n Haskell: Main.SList [GHC.Types.Char]\n Liquid : forall a. Main.SList a\n</code></pre>\n"}, {"tags": ["haskell", "generics", "testing", "quickcheck"], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 5, "last_activity_date": 1456129295, "last_edit_date": 1456129295, "creation_date": 1456093235, "answer_id": 35542869, "question_id": 35542734, "link": "https://stackoverflow.com/questions/35542734/how-can-i-make-my-type-an-instance-of-arbitrary/35542869#35542869", "title": "How can I make my type an instance of Arbitrary?", "body": "<p>There are two reasonable approaches:</p>\n\n<h3>Reuse an existing instance</h3>\n\n<p>If there's another instance that looks similar, you can <em>use it</em>. The <code>Gen</code> type is an instance of <code>Functor</code>, <code>Applicative</code>, and even <code>Monad</code>, so you can easily build generators from other ones. This is probably the most important general technique for writing <code>Arbitrary</code> instances. Most complex instances will be built up from one or more simpler ones.</p>\n\n<pre><code>boolToFoo :: Bool -&gt; Foo\nboolToFoo False = A\nboolToFoo True = B\n\ninstance Arbitrary Foo where\n  arbitrary = boolToFoo &lt;$&gt; arbitrary\n</code></pre>\n\n<p>In this case, <code>Foo</code> can't be \"shrunk\" to subparts in any meaningful way, so the default trivial implementation of <code>shrink</code> will work fine. If it were a more interesting type, you could have used some analogue of</p>\n\n<pre><code>  shrink = map boolToFoo . shrink . fooToBool\n</code></pre>\n\n<h3>Use the pieces available in <code>Test.QuickCheck.Arbitrary</code> and/or <code>Test.QuickCheck.Gen</code></h3>\n\n<p>In this case, it's pretty easy to just put together the pieces:</p>\n\n<pre><code>import Test.QuickCheck.Arbitrary\n\ndata Foo = A | B\n  deriving (Show,Enum,Bounded)\ninstance Arbitrary Foo where\n  arbitrary = arbitraryBoundedEnum\n</code></pre>\n\n<p>As mentioned, the default <code>shrink</code> implementation would be fine in this case. In the case of a recursive type, you'd likely want to add</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\nimport GHC.Generics (Generic)\n</code></pre>\n\n<p>and then derive <code>Generic</code> for your type and use</p>\n\n<pre><code>instance Arbitrary ... where\n  ...\n  shrink = genericShrink\n</code></pre>\n\n<p>As the documentation warns, <code>genericShrink</code> does not respect any internal validity conditions you may wish to impose, so some care may be required in some cases.</p>\n\n<hr>\n\n<p>You asked about <code>DeriveAnyClass</code>. If you wanted that, you'd add</p>\n\n<pre><code>{-# LANGUAGE DeriveAnyClass #-}\n</code></pre>\n\n<p>to the top of your file. But <em>you don't want that</em>. You certainly don't want it here, anyway. It only works for classes that have a full complement of defaults based on Generics, typically using the <code>DefaultSignatures</code> extension. In this case, there is no <code>default arbitrary :: Generic a =&gt; Gen a</code> line in the <code>Arbitrary</code> class definition, and <code>arbitrary</code> is mandatory. So an instance of <code>Arbitrary</code> produced by <code>DeriveAnyClass</code> will produce a <em>runtime error</em> as soon as QuickCheck tries to call its <code>arbitrary</code> method.</p>\n"}], "owner": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1268, "favorite_count": 0, "accepted_answer_id": 35542869, "answer_count": 1, "score": 2, "last_activity_date": 1456129295, "creation_date": 1456092361, "question_id": 35542734, "link": "https://stackoverflow.com/questions/35542734/how-can-i-make-my-type-an-instance-of-arbitrary", "title": "How can I make my type an instance of Arbitrary?", "body": "<p>I have the following data and function</p>\n\n<pre><code>data Foo = A | B deriving (Show)\n\nfoolist :: Maybe Foo -&gt; [Foo]\nfoolist Nothing  = [A]\nfoolist (Just x) = [x]\n\nprop_foolist x = (length (foolist x)) == 1\n</code></pre>\n\n<p>when running <code>quickCheck prop_foolist</code>, ghc tells me that Foo needs to be an instance of Arbitrary. </p>\n\n<pre><code>No instance for (Arbitrary Foo) arising from a use of  \u2018quickCheck\u2019\nIn the expression: quickCheck prop_foolist\nIn an equation for \u2018it\u2019: it = quickCheck prop_foolist\n</code></pre>\n\n<p>I tried <code>data Foo = A | B deriving (Show, Arbitrary)</code>, but this results in</p>\n\n<pre><code>Can't make a derived instance of \u2018Arbitrary Foo\u2019:\n  \u2018Arbitrary\u2019 is not a derivable class\n  Try enabling DeriveAnyClass\nIn the data declaration for \u2018Foo\u2019\n</code></pre>\n\n<p>However, I can't figure out how to enble <code>DeriveAnyClass</code>. I just wanted to use quickcheck with my simple function! The possible values of x is Nothing, Just A and Just B. Surely this should be possible to test? </p>\n"}, {"tags": ["haskell", "tuples"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 4671626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36eebd49b65136f8b6720c3f105e444c?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson Jacob", "link": "https://stackoverflow.com/users/4671626/jackson-jacob"}, "edited": false, "score": 0, "creation_date": 1456092567, "post_id": 35542629, "comment_id": 58774191, "body": "Thank you, for 1) Telling me where I&#39;m going wrong when posting! 2) For pointing me in the right direction. It did the trick"}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 2, "last_activity_date": 1456093510, "last_edit_date": 1456093510, "creation_date": 1456091761, "answer_id": 35542629, "question_id": 35542337, "link": "https://stackoverflow.com/questions/35542337/tuple-comprehension-haskell/35542629#35542629", "title": "Tuple comprehension Haskell", "body": "<p>First: when asking why something ins't working, please provide a paste of what is actually happening: you would get better help more quickly if you included the compiler error message, so prospective answerers don't have to copy and paste your code to see what's wrong.</p>\n\n<p>The first thing that jumps out at me is that</p>\n\n<pre><code>(map fst ratings)/= newUser\n</code></pre>\n\n<p>doesn't look well-typed at all: <code>newUser</code> is a String, so it can't possibly be equal to <code>(map fst ratings)</code>, a list of strings. You want something more like:</p>\n\n<pre><code>filter ((newUser /=) . fst) . ratings\n</code></pre>\n\n<p>Another problem is that you've made this point-free: that's cool sometimes, but here I think it's making it a lot harder to read. It's much simpler to write like this:</p>\n\n<pre><code>uniquify :: [Rating] -&gt; [Rating]\nuniquify [] = []\nuniquify (rate@(newUser,_):more) = rate : uniquify (filter ((newUser /=) . fst) more)\n</code></pre>\n\n<p>But better still is to find an appropriate built-in function, and in this case that's <code>Data.List.nubBy</code>, combined with <code>Data.Function.on</code>:</p>\n\n<pre><code>uniquify' :: Eq a =&gt; [(a,b)] -&gt; [(a,b)]\nuniquify' = nubBy ((==) `on` fst)\n</code></pre>\n\n<p>That's a more general type, which you can specialize to the type given to <code>uniquify</code>, and a lot simpler to implement.</p>\n"}], "owner": {"reputation": 119, "user_id": 4671626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36eebd49b65136f8b6720c3f105e444c?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson Jacob", "link": "https://stackoverflow.com/users/4671626/jackson-jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "accepted_answer_id": 35542629, "answer_count": 1, "score": 1, "last_activity_date": 1456093796, "creation_date": 1456090237, "last_edit_date": 1456093796, "question_id": 35542337, "link": "https://stackoverflow.com/questions/35542337/tuple-comprehension-haskell", "title": "Tuple comprehension Haskell", "body": "<p>The end goal is to get a list of ratings such that no same user should be duplicated in the list. Therefore you cannot have \"Emma\" rating twice. </p>\n\n<p>Data and Tuple defined as: </p>\n\n<pre><code>type Rating = (String, Int)\ndata Film = Film {  title :: String,\n                    director :: String,\n                    year :: Int,\n                    ratings :: [Rating] } deriving (Read,Show)\n</code></pre>\n\n<p>old function defined as (Which works):</p>\n\n<pre><code>newRatings :: [Rating] -&gt; Rating -&gt; [Rating]\nnewRatings oldRatings (newUser,newRate) = [(user,rate) | (user,rate) &lt;- oldRatings, user /= newUser] ++ [(newUser,newRate)]\n</code></pre>\n\n<p>creating a better function defined as:</p>\n\n<pre><code>newRating :: Rating -&gt; [Rating] -&gt; [Rating]\nnewRating (newUser,newRate) = ((newUser,newRate): ) . filter(((map fst ratings)/= newUser). ratings)\n</code></pre>\n\n<p>I don't understand where I am going wrong. \nMy understanding of the function is. -> Get the rating and compare it the an old list of ratings to check if the users match. If they do, don't include their specific rating and carry on passing list until empty. Then append the new rating to the list. </p>\n\n<p>Could someone explain where I am going wrong?</p>\n\n<p>The Error I'm getting:</p>\n\n<pre><code> v3.hs:104:63:\n    Couldn't match expected type \u2018[Rating] -&gt; Bool\u2019\n                with actual type \u2018Bool\u2019\n    In the first argument of \u2018(.)\u2019, namely\n      \u2018((map fst ratings) /= newUser)\u2019\n    In the first argument of \u2018filter\u2019, namely\n      \u2018(((map fst ratings) /= newUser) . ratings)\u2019\n    In the second argument of \u2018(.)\u2019, namely\n      \u2018filter (((map fst ratings) /= newUser) . ratings)\u2019\n\nv3.hs:104:72:\n    Couldn't match expected type \u2018[(Char, b0)]\u2019\n                with actual type \u2018Film -&gt; [Rating]\u2019\n    Probable cause: \u2018ratings\u2019 is applied to too few arguments\n    In the second argument of \u2018map\u2019, namely \u2018ratings\u2019\n    In the first argument of \u2018(/=)\u2019, namely \u2018(map fst ratings)\u2019\n\nv3.hs:104:93:\n    Couldn't match type \u2018(String, Int)\u2019 with \u2018Film\u2019\n    Expected type: Rating -&gt; [Rating]\n      Actual type: Film -&gt; [Rating]\n    In the second argument of \u2018(.)\u2019, namely \u2018ratings\u2019\n    In the first argument of \u2018filter\u2019, namely\n      \u2018(((map fst ratings) /= newUser) . ratings)\u2019\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1456091632, "post_id": 35542271, "comment_id": 58773777, "body": "Is <code>twice :: Functor f =&gt; (forall a . f a -&gt; g a) -&gt; (forall a . f (f a) -&gt; g (g a))</code> good enough? <code>twice=twice1</code> with <code>f~Identity</code>, and <code>twice=twice2</code> with <code>g~Identity</code>. Something like <code>twice (Id . head) . twice (\\(Id a) -&gt; [a])</code> for example, works."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1456092633, "last_edit_date": 1456092633, "creation_date": 1456092137, "answer_id": 35542692, "question_id": 35542271, "link": "https://stackoverflow.com/questions/35542271/haskell-apply-a-polymorphic-function-twice/35542692#35542692", "title": "Haskell: apply a polymorphic function twice", "body": "<pre><code>{-# LANGUAGE TypeFamilies, RankNTypes, UnicodeSyntax #-}\n\ntype family Fundep a :: *\n\ntype instance Fundep Bool = Int\ntype instance Fundep Int = String\n...\n\ntwice :: \u2200 a . (\u2200 c . c -&gt; Fundep c) -&gt; a -&gt; Fundep (Fundep a)\ntwice f = f . f\n</code></pre>\n\n<p>Now, that won't be much use actually because you can't define a (meaningful) polymorphic function that works with <em>any</em> <code>c</code>. One possibility is to toss in a class constraint, like</p>\n\n<pre><code>class Showy a where\n  type Fundep a :: *\n  showish :: a -&gt; Fundep a\n\ninstance Showy Bool where\n  type Fundep Bool = Int\n  showish = fromEnum\ninstance Showy Int where\n  type Fundep Int = String\n  showish = show\n\ntwice :: \u2200 a b . (Showy a, b ~ Fundep a, Showy b) =&gt;\n    (\u2200 c . Showy c =&gt; c -&gt; Fundep c) -&gt; a -&gt; Fundep b\ntwice f = f . f\n\nmain = print $ twice showish False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 3, "last_activity_date": 1456134206, "creation_date": 1456134206, "answer_id": 35550291, "question_id": 35542271, "link": "https://stackoverflow.com/questions/35542271/haskell-apply-a-polymorphic-function-twice/35550291#35550291", "title": "Haskell: apply a polymorphic function twice", "body": "<p>You can't make <code>twice</code> generic enough even in a dependently typed setting, but it's possible with intersection types:</p>\n\n<pre><code>twice :: (a -&gt; b /\\ b -&gt; c) -&gt; a -&gt; c\ntwice f x = f (f x)\n</code></pre>\n\n<p>Now whenever <code>f :: a -&gt; b</code> and <code>f :: b -&gt; c</code> typecheck, <code>twice</code> will typecheck too.</p>\n\n<p>There is also a beautiful spell in <a href=\"https://www.cs.cmu.edu/~rwh/theses/pierce.pdf\" rel=\"nofollow\">Benjamin Pierce's thesis</a> (I changed the syntax slightly):</p>\n\n<pre><code>self : (A /\\ A -&gt; B) -&gt; B\nself f = f f\n</code></pre>\n\n<p>So self-application is typeable with intersection types as well.</p>\n"}], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1456134206, "creation_date": 1456089843, "last_edit_date": 1456094529, "question_id": 35542271, "link": "https://stackoverflow.com/questions/35542271/haskell-apply-a-polymorphic-function-twice", "title": "Haskell: apply a polymorphic function twice", "body": "<p>We can have a polymorphic function <code>f :: a -&gt; b</code> implemented for different pairs of <code>a</code> and <code>b</code>. How can we make</p>\n\n<pre><code>twice :: (a -&gt; b) -&gt; a -&gt; c\ntwice f x = f (f x)\n</code></pre>\n\n<p>type check? i.e. how can I write a function which applies a <em>polymorphic</em> function twice?</p>\n\n<p>With <a href=\"https://prime.haskell.org/wiki/Rank2Types\" rel=\"nofollow\"><code>Rank2Types</code></a> we can get a bit closer but not quite there:</p>\n\n<pre><code>{-# LANGUAGE Rank2Types #-}\n\ntwice1 :: (forall a. a -&gt; (m a)) -&gt; b -&gt; (m (m b))\ntwice1 f = f . f\n\ntwice2 :: (forall a. m a -&gt; a) -&gt; m (m b) -&gt; b\ntwice2 f = f . f\n</code></pre>\n\n<p>so then some polymorphic functions can be applied twice:</p>\n\n<pre><code>\\&gt; twice1 (:[]) 1\n[[1]]\n\\&gt; twice2 head [[1]]\n1\n</code></pre>\n\n<p>Can we go further?</p>\n\n<p><a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2006-November/thread.html#19456\" rel=\"nofollow\">The question was asked over Haskell cafe</a> <em>10 years ago</em> but wasn't quite answered (with type classes it becomes a lot of boilerplate).</p>\n"}, {"tags": ["haskell", "gtk", "cabal-install"], "comments": [{"owner": {"reputation": 3844, "user_id": 1346996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f3eea4163ec574bad1bd83c17267b2?s=128&d=identicon&r=PG", "display_name": "aribeiro", "link": "https://stackoverflow.com/users/1346996/aribeiro"}, "edited": false, "score": 1, "creation_date": 1456085139, "post_id": 35541162, "comment_id": 58771259, "body": "Did you ensure this <code>After installing gtk2hs-buildtools, make sure that gtk2hsC2hs is in a directory that is on your %PATH%.</code>? And please, do not post links with images hosted elsewhere. Try to narrow your problem first and then try to post small logs."}, {"owner": {"reputation": 108, "user_id": 5959745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76967da7084d0771b470c2a0c5f7ff1?s=128&d=identicon&r=PG&f=1", "display_name": "Pepelev Alexey", "link": "https://stackoverflow.com/users/5959745/pepelev-alexey"}, "reply_to_user": {"reputation": 3844, "user_id": 1346996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f3eea4163ec574bad1bd83c17267b2?s=128&d=identicon&r=PG", "display_name": "aribeiro", "link": "https://stackoverflow.com/users/1346996/aribeiro"}, "edited": false, "score": 0, "creation_date": 1456118957, "post_id": 35541162, "comment_id": 58781347, "body": "<code>gtk2hsC2hs.exe</code> is in a directory that is on my %PATH%"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1456131843, "post_id": 35541162, "comment_id": 58787297, "body": "The error says &quot;error: ld returned 1 exit status&quot; but then it says &quot;command was: ... gcc.exe&quot;. gcc is obviously calling ld, which fails. If you want to know why you&#39;ll have to figure out which ld command it is running (you need to pass -v to gcc as well - cabal has a <code>cc-options</code> field). Since you are on windows, and a link step is failing, there is 99% chance it is due to one of three things: missing libraries, architecture (x86 v i386) mismatch in one of many possible places, or the <code>ld</code> command is simply too long for windows (<a href=\"https://support.microsoft.com/en-us/kb/830473\" rel=\"nofollow noreferrer\">8191 chars max</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 120, "user_id": 6110448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/933bdac19cecdbb41785ea4e2293cf87?s=128&d=identicon&r=PG&f=1", "display_name": "auermich", "link": "https://stackoverflow.com/users/6110448/auermich"}, "is_accepted": true, "score": 0, "last_activity_date": 1461434209, "creation_date": 1461434209, "answer_id": 36814402, "question_id": 35541162, "link": "https://stackoverflow.com/questions/35541162/installing-gtk2hs-failure/36814402#36814402", "title": "Installing gtk2hs failure", "body": "<p>I am suffering from the same error message for the last two days and\nfinally got a work-around (though I am using win7 -x64).</p>\n\n<p>You need to download glib separately from <a href=\"https://hackage.haskell.org/package/glib\" rel=\"nofollow\">https://hackage.haskell.org/package/glib</a>. Then you need to adjust glib.cabal as described here:\n<a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2015-October/121935.html\" rel=\"nofollow\">https://mail.haskell.org/pipermail/haskell-cafe/2015-October/121935.html</a>\n(you have to remove the cpp-option: '-D__attribute__(A)=')</p>\n\n<p>Finally, switch to your glib directory and run:</p>\n\n<pre><code>cabal install glib.cabal\n</code></pre>\n\n<p>This should work. You may have to do the same steps with the other gtk+ dependencies.</p>\n"}], "owner": {"reputation": 108, "user_id": 5959745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b76967da7084d0771b470c2a0c5f7ff1?s=128&d=identicon&r=PG&f=1", "display_name": "Pepelev Alexey", "link": "https://stackoverflow.com/users/5959745/pepelev-alexey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 414, "favorite_count": 0, "accepted_answer_id": 36814402, "answer_count": 1, "score": 1, "last_activity_date": 1461434209, "creation_date": 1456084250, "last_edit_date": 1456088160, "question_id": 35541162, "link": "https://stackoverflow.com/questions/35541162/installing-gtk2hs-failure", "title": "Installing gtk2hs failure", "body": "<p>I followed the instructions to install <code>gtk</code> library on <code>Windows 8.1 x64</code> using <a href=\"http://wiki.haskell.org/Gtk2Hs/Installation\" rel=\"nofollow\">http://wiki.haskell.org/Gtk2Hs/Installation</a>.</p>\n\n<p>I've installed <code>MSYS2</code> and used it to download and build <code>gtk</code>. Then I've run:</p>\n\n<pre><code>cabal update // ok\n\ncabal install gtk2hs-buildtools // ok\n\ncabal install gtk // failed, \n</code></pre>\n\n<p><code>cabal</code> logs: </p>\n\n<ul>\n<li><p>glib.log</p>\n\n<p>Building glib-0.13.2.2...<br>\nPreprocessing library glib-0.13.2.2...<br>\ndist\\build\\System\\Glib\\StoreValue_hsc_utils.o:StoreValue_hsc_utils.c:(.text+0x0): multiple definition of `__debugbreak'<br>\ndist\\build\\System\\Glib\\StoreValue_hsc_make.o:StoreValue_hsc_make.c:(.text+0x0): first defined here<br>\ncollect2.exe: error: ld returned 1 exit status<br>\nlinking dist\\build\\System\\Glib\\StoreValue_hsc_make.o failed (exit code 1)<br>\ncommand was: C:\\Program Files\\Haskell Platform\\7.10.3\\mingw\\bin\\gcc.exe dist\\build\\System\\Glib\\StoreValue_hsc_make.o dist\\build\\System\\Glib\\StoreValue_hsc_utils.o -o dist\\build\\System\\Glib\\StoreValue_hsc_make.exe -LC:/msys64/mingw64/lib -lgobject-2.0 -lglib-2.0 -lintl -LC:\\Users\\Lexa27\\AppData\\Roaming\\cabal\\x86_64-windows-ghc-7.10.3\\utf8-string-1.0.1.1-L8eKHa7Iv9q7FVKUYW6u4b -LC:\\Program Files\\Haskell Platform\\7.10.3\\lib\\extralibs\\text-1.2.1.3 -LC:\\Program Files\\Haskell Platform\\7.10.3\\lib\\binar_3uXFWMoAGBg0xKP9MHKRwi -LC:\\Program Files\\Haskell Platform\\7.10.3\\lib\\conta_2C3ZI8RgPO2LBMidXKTvIU -LC:\\Program Files\\Haskell Platform\\7.10.3\\lib\\bytes_6VWy06pWzJq9evDvK2d4w6 -LC:\\Program Files\\Haskell Platform\\7.10.3\\lib\\deeps_6vMKxt5sPFR0XsbRWvvq59 -LC:\\Program Files\\Haskell Platform\\7.10.3\\lib\\array_67iodizgJQIIxYVTp4emlA -LC:\\Program Files\\Haskell Platform\\7.10.3\\lib\\base_HQfYBxpPvuw8OunzQu6JGM -lwsock32 -luser32 -lshell32 -LC:\\Program Files\\Haskell Platform\\7.10.3\\lib\\integ_2aU3IZNMF9a7mQ0OzsZ0dS -LC:\\Program Files\\Haskell Platform\\7.10.3\\lib\\ghcpr_8TmvWUcS1U1IKHT0levwg3 -LC:\\Program Files\\Haskell Platform\\7.10.3\\lib/rts -lm -lwsock32 -lgdi32 -lwinmm</p></li>\n<li>build.log\n<a href=\"https://drive.google.com/file/d/0B9t961_0P4GbMWhhMklSMDlpRkE/view?usp=sharing\" rel=\"nofollow\">https://drive.google.com/file/d/0B9t961_0P4GbMWhhMklSMDlpRkE/view?usp=sharing</a></li>\n<li>gtk2hs-buildtools <a href=\"https://drive.google.com/file/d/0B9t961_0P4GbdXpGT081V0hHeFE/view?usp=sharing\" rel=\"nofollow\">https://drive.google.com/file/d/0B9t961_0P4GbdXpGT081V0hHeFE/view?usp=sharing</a></li>\n</ul>\n"}, {"tags": ["file", "haskell", "tuples"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1456084001, "post_id": 35541009, "comment_id": 58770771, "body": "The format you&#39;ve given isn&#39;t compatible with the generated <code>Read</code> and <code>Show</code> instances for <code>Film</code>, so they won&#39;t be useful. You would need to read and write <code>Film</code>s specially rather than using the generated instances. The list of ratings will not <code>read</code> as <code>[Rating]</code> either. It doesn&#39;t matter too much whether you use a data type or a tuple as long as what you write to the file is what the <code>Read</code> instance expects."}, {"owner": {"reputation": 119, "user_id": 4671626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36eebd49b65136f8b6720c3f105e444c?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson Jacob", "link": "https://stackoverflow.com/users/4671626/jackson-jacob"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1456084638, "post_id": 35541009, "comment_id": 58771030, "body": "Thank you for the insight! This have proven to be very useful"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456084777, "post_id": 35541009, "comment_id": 58771093, "body": "Your life will generally be easier if you nix that tuple. That&#39;s just not a good place for one. You should also consider abandoning <code>read</code> in favor of something like <code>attoparsec</code>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456086483, "post_id": 35541009, "comment_id": 58771790, "body": "@dfeuer for this use, the error messages provided by Parsec or trifecta are probably more important than the speed of attoparsec."}], "answers": [{"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": true, "score": 3, "last_activity_date": 1456084475, "creation_date": 1456084475, "answer_id": 35541212, "question_id": 35541009, "link": "https://stackoverflow.com/questions/35541009/tuple-or-data-for-loading-file-haskell/35541212#35541212", "title": "tuple or data for loading file haskell", "body": "<p><code>(String, Int)</code> and <code>data Rating = { name :: String, score :: Int }</code> are the same \u2014 because they are <em>isomorphic</em>. The practical difference is one has better field names than the other \u2014 i.e. would you rather <code>fst</code> and <code>snd</code> or <code>name</code> and <code>score</code>?</p>\n\n<p>This has little to do with reading and writing to files, however. As far as I know there is no appreciable difference between the two in this regard. At the worst, they are isomorphic and so you can convert between the representations.</p>\n"}], "owner": {"reputation": 119, "user_id": 4671626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36eebd49b65136f8b6720c3f105e444c?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson Jacob", "link": "https://stackoverflow.com/users/4671626/jackson-jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 35541212, "answer_count": 1, "score": 0, "last_activity_date": 1456084475, "creation_date": 1456083481, "question_id": 35541009, "link": "https://stackoverflow.com/questions/35541009/tuple-or-data-for-loading-file-haskell", "title": "tuple or data for loading file haskell", "body": "<p>I have to load a database of the format:</p>\n\n<pre><code>\"Blade Runner\"\n\"Ridley Scott\"\n1982\n(\"Amy\",5), (\"Bill\",8), (\"Ian\",7), (\"Kevin\",9), (\"Emma\",4), (\"Sam\",7), (\"Megan\",4)\n</code></pre>\n\n<p>into </p>\n\n<pre><code>type Rating = (String, Int)\ndata Film = Film {  title :: String,\n                    director :: String,\n                    year :: Int,\n                    ratings :: [Rating] } deriving (Read,Show)\n</code></pre>\n\n<p>Would it better to leave Rating as a tuple or change to a data type?\nAs I will have to save the file as well.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "edited": false, "score": 2, "creation_date": 1456083764, "post_id": 35540985, "comment_id": 58770702, "body": "This is an odd question because it does not indicate why True should mean 1 and False should mean 0. You can simply assign <code>fromIntegral.fromEnum</code> to a shorter name, but I suspect you&#39;re looking for alternative approaches, in which case I need to understand why Bools are being interpreted as numbers."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456085065, "post_id": 35540985, "comment_id": 58771230, "body": "That particular example would be better written <code>lst = cycle [(1,-1), (1,0)]</code>, at least for most purposes, so it&#39;s not really a good example."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1456085334, "post_id": 35540985, "comment_id": 58771335, "body": "How about <code>if even i then 0 else -1</code>? Or <code>i `mod` (-2)</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456085428, "post_id": 35540985, "comment_id": 58771380, "body": "For some purposes, <code>map ((,) 1) $ iterate (\\x -&gt; (-1) - x) (-1)</code> may be better."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1456084352, "last_edit_date": 1456084352, "creation_date": 1456083869, "answer_id": 35541092, "question_id": 35540985, "link": "https://stackoverflow.com/questions/35540985/using-bool-in-haskell-with-other-numerical-types/35541092#35541092", "title": "Using Bool in haskell with other numerical types", "body": "<p>I don't believe there's a standard way. You can write your own, of course:</p>\n\n<pre><code>enumToNum :: (Enum e, Num n) =&gt; e -&gt; n\nenumToNum = fromIntegral . fromEnum\n</code></pre>\n\n<p>The existence of this and similar functions really points to the silly nature of the <code>Enum</code> class.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2512323"}, "is_accepted": false, "score": 1, "last_activity_date": 1456084004, "creation_date": 1456084004, "answer_id": 35541119, "question_id": 35540985, "link": "https://stackoverflow.com/questions/35540985/using-bool-in-haskell-with-other-numerical-types/35541119#35541119", "title": "Using Bool in haskell with other numerical types", "body": "<p>Package <code>Foreign.Marshal.Utils</code> contains <code>fromBool</code> function with the following definition:</p>\n\n<pre><code>-- |Convert a Haskell 'Bool' to its numeric representation\n--\nfromBool       :: Num a =&gt; Bool -&gt; a\nfromBool False  = 0\nfromBool True   = 1\n</code></pre>\n\n<p>While I don't recommend to import this package for <code>fromBool</code> alone, you can copy it into your code.</p>\n\n<p>By the way, good way to discover functions by type in the standard library is <a href=\"https://www.haskell.org/hoogle/?hoogle=Num+a%3D%3EBool-%3Ea\" rel=\"nofollow\">Hoogle</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": true, "score": 1, "last_activity_date": 1456085113, "creation_date": 1456085113, "answer_id": 35541336, "question_id": 35540985, "link": "https://stackoverflow.com/questions/35540985/using-bool-in-haskell-with-other-numerical-types/35541336#35541336", "title": "Using Bool in haskell with other numerical types", "body": "<p>I do not understand the general purpose of interpreting Bools as Integers from the question, so I am only answering to the example given. Let me know how I can expand my answer.</p>\n\n<pre><code>lst::[(Double, Double)]\nlst = [(1, -1 * (odd i)) | i&lt;- [1..]]\n</code></pre>\n\n<p>The first element of the tuple is always 1, so this example can be simplified.</p>\n\n<pre><code>lst :: [Double]\nlst = [-1 * (odd i) | i&lt;- [1..]]\n</code></pre>\n\n<p>For the reader, <code>odd :: Integral a =&gt; a -&gt; Bool</code>, and <code>fromEnum True = 1; fromEnum False = 0</code>.</p>\n\n<p>Under the <code>fromEnum</code> interpretation, <code>lst</code> is an infinite list of <code>-1</code> interspersed with zeroes. How else can we implement this list?</p>\n\n<pre><code>intersperse 0 (repeat (-1))\n</code></pre>\n\n<p>Then how do we get back the desired tuples? Apply <code>fmap (1,)</code> to the list.</p>\n"}], "owner": {"reputation": 91, "user_id": 3165667, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3a0ffb42836472764b11d7a737ba0df1?s=128&d=identicon&r=PG&f=1", "display_name": "Arseny Nerinovsky", "link": "https://stackoverflow.com/users/3165667/arseny-nerinovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 35541336, "answer_count": 3, "score": 0, "last_activity_date": 1456085113, "creation_date": 1456083374, "last_edit_date": 1456084175, "question_id": 35540985, "link": "https://stackoverflow.com/questions/35540985/using-bool-in-haskell-with-other-numerical-types", "title": "Using Bool in haskell with other numerical types", "body": "<p>Is there any 'elegant' way to use Bool type in numerical expressions ?\nMy current solution is using <code>fromIntegral.fromEnum</code> but is seems long.\nExample:</p>\n\n<pre><code>lst::[(Double, Double)]\nlst = [(1, -1 * (odd i)) | i&lt;- [1..]]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 2, "creation_date": 1456080889, "post_id": 35540441, "comment_id": 58769455, "body": "if it was <code>a -&gt; b</code> you could not apply the function for a second time, because after the first time you will have type <code>b</code>, but your function only takes <code>a</code> as an input arg"}, {"owner": {"reputation": 548, "user_id": 5069373, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/684f313653e6ae98c35615feb7e4e05d?s=128&d=identicon&r=PG&f=1", "display_name": "dijam", "link": "https://stackoverflow.com/users/5069373/dijam"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1456081930, "post_id": 35540441, "comment_id": 58769931, "body": "Okay that makes sense so that&#39;s why it&#39;s all as for the type signatures"}], "answers": [{"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": true, "score": 4, "last_activity_date": 1456083211, "creation_date": 1456083211, "answer_id": 35540957, "question_id": 35540441, "link": "https://stackoverflow.com/questions/35540441/haskell-function-inside-function-signature-type/35540957#35540957", "title": "Haskell function inside function signature type", "body": "<p>Let's see what happens!</p>\n\n<pre><code>twice :: (a -&gt; b) -&gt; a -&gt; b\ntwice f x = f (f x)\n</code></pre>\n\n<p>Just reading the type of <code>twice</code>, we immediately know:</p>\n\n<pre><code>f :: a -&gt; b\nx :: a\n</code></pre>\n\n<p>Therefore:</p>\n\n<pre><code>f x :: b\n</code></pre>\n\n<p>If <code>f :: a -&gt; b</code> and <code>f x :: b</code>, what is the type of <code>f (f x)</code>? We do not know if <code>a = b</code>, so we do not know if we can apply <code>f x</code> to <code>f</code>. If we don't know then we cannot safely compile the program.</p>\n\n<pre><code>Couldn't match expected type `a' with actual type `b'\n...\nIn the first argument of `f', namely `(f x)'\nIn the expression: f (f x)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 0, "last_activity_date": 1456083217, "creation_date": 1456083217, "answer_id": 35540958, "question_id": 35540441, "link": "https://stackoverflow.com/questions/35540441/haskell-function-inside-function-signature-type/35540958#35540958", "title": "Haskell function inside function signature type", "body": "<p>You are right, the function's type can also be written in the more general form <code>(a -&gt; b) -&gt; a -&gt; b</code>. However, you get a slight problem with <code>f (f x)</code> then: the result of <code>f x</code> is <code>b</code>, but the outer <code>f</code> expects its argument to have type <code>a</code>. So <code>a</code> and <code>b</code> must actually be the same type! You could write this as</p>\n\n<pre><code>twice :: (a~b) =&gt; (a -&gt; b) -&gt; a -&gt; b\n</code></pre>\n\n<p>where <code>a~b</code> is an <em>equality constraint</em> (you need one of the GHC extensions <code>TypeFamilies</code> or <code>GATDs</code> so this is accepted). But if both are the same type anyway, you might as well give them the same name right away... for example, <code>a</code>. This simplifies the signature to</p>\n\n<pre><code>twice :: (a -&gt; a) -&gt; a -&gt; a\n</code></pre>\n"}], "owner": {"reputation": 548, "user_id": 5069373, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/684f313653e6ae98c35615feb7e4e05d?s=128&d=identicon&r=PG&f=1", "display_name": "dijam", "link": "https://stackoverflow.com/users/5069373/dijam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 35540957, "answer_count": 2, "score": 0, "last_activity_date": 1456083217, "creation_date": 1456080789, "question_id": 35540441, "link": "https://stackoverflow.com/questions/35540441/haskell-function-inside-function-signature-type", "title": "Haskell function inside function signature type", "body": "<p>I am struggling to understand function within function signature types in Haskell, \nI have seen this function;</p>\n\n<pre><code>twice :: (a -&gt; a) -&gt; a -&gt; a\ntwice f x = f(f x)\n</code></pre>\n\n<p>Which does twice the chosen function on a parameter. I understand f is a function however do not understand why we have the signature type <code>(a -&gt; a) -&gt; a -&gt; a</code>\nI thought it would be <code>(a -&gt; b) -&gt; a -&gt; b</code> because </p>\n\n<ol>\n<li>You provide a as a parameter so the input of the function must accept the type of a. </li>\n<li>b is the output type of the function so the overall output type is of type b.</li>\n</ol>\n\n<p>I am new to Haskell :) </p>\n"}, {"tags": ["haskell", "lazy-evaluation", "xmonad"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1456075125, "post_id": 35539195, "comment_id": 58767120, "body": "<code>void</code> is simply <code>void x = x &gt;&gt; return ()</code>. It doesn&#39;t do anything fancy, it just makes sure a <code>()</code> value is returned after your action. It&#39;s completely unrelated to <code>IO</code> or <code>MonadIO</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1456077004, "post_id": 35539288, "comment_id": 58767902, "body": "...but you absolutely should trust this package."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1456077049, "post_id": 35539288, "comment_id": 58767929, "body": "About the last comment: what about <code>void :: Functor f =&gt; f a -&gt; f ()</code>? Wouldn&#39;t that force <code>void = fmap (const ())</code>? (Aside from non-terminating terms)"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1456082049, "post_id": 35539288, "comment_id": 58769983, "body": "@chi, as long as you assume the Functor laws. Someone could write a non-law-abiding <code>(&lt;$)</code> for a particular type that is an instance of MonadIO that executes the action 0 times, or multiple times."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1456173258, "post_id": 35539288, "comment_id": 58814714, "body": "&quot;Note that it says it <i>ignores the result of evaluation</i>, implying that the evaluation does take place.&quot;  I think remark is unhelpful at best, because the term &quot;evaluation&quot; to my mind is unclear about what&#39;s being <b>forced</b> and what isn&#39;t.  Notably, there&#39;s no exception raised by <code>void (return (div 1 0)) :: IO ()</code>, which somebody could gloss as &quot;<code>div 1 0</code> is not evaluated.&quot;"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1456214760, "post_id": 35539288, "comment_id": 58831016, "body": "@LuisCasillas I clarified what I meant. If the result is ignored it means all the side effects of the monad take place, which is what the OP is interested about."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": false, "score": 2, "last_activity_date": 1456214725, "last_edit_date": 1456214725, "creation_date": 1456075136, "answer_id": 35539288, "question_id": 35539195, "link": "https://stackoverflow.com/questions/35539195/is-void-guaranteed-to-execute-action-in-any-monadio/35539288#35539288", "title": "Is void guaranteed to execute action in any MonadIO?", "body": "<p>That's <strong>exactly</strong> the purpose of <code>void</code>: to execute the action and ignore the result value. From the <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:void\" rel=\"nofollow\">documentation</a>:</p>\n\n<blockquote>\n  <p><code>void value</code> discards or ignores the result of evaluation, such as the\n  return value of an <code>IO</code> action.</p>\n</blockquote>\n\n<p>Note that it says it <em>ignores the result of evaluation</em>, implying that the evaluation does take place, i.e. the side effects take place.</p>\n\n<p>It can be defined as:</p>\n\n<pre><code>void action = action &gt;&gt; return ()\n</code></pre>\n\n<p>(Or in many other ways. The <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/src/Data.Functor.html#void\" rel=\"nofollow\"><code>base</code>'s implementation</a> is more general).</p>\n\n<p>Obviously you could have a bogus definition like:</p>\n\n<pre><code>void _ = return ()\n</code></pre>\n\n<p>which doesn't execute the action. AFAIK the types aren't expressive enough to remove this possibility so if you really don't trust the package you'll have to write your own implementation.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456214725, "creation_date": 1456074708, "question_id": 35539195, "link": "https://stackoverflow.com/questions/35539195/is-void-guaranteed-to-execute-action-in-any-monadio", "title": "Is void guaranteed to execute action in any MonadIO?", "body": "<p>I have an <code>IO a</code> value but need to pass <code>IO ()</code> to a <code>Xmonad</code> function. I use:</p>\n\n<pre><code>void . spawn :: MonadIO f =&gt; String -&gt; f ()\n</code></pre>\n\n<p>What guarantees that my action will execute? Does it apply to all correct <code>MonadIO</code> instances?</p>\n"}, {"tags": ["function", "haskell", "lambda", "notation"], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 6, "last_activity_date": 1456062806, "creation_date": 1456062806, "answer_id": 35536979, "question_id": 35536928, "link": "https://stackoverflow.com/questions/35536928/haskell-interpretation-of-lambda-function/35536979#35536979", "title": "Haskell interpretation of lambda function", "body": "<p>Now your <code>(\\y -&gt; y)</code> function is equivalent to <code>id</code>. Let's rewrite your function using that:</p>\n\n<pre><code>i = ((\\g x -&gt; g x + g x) id) 3\n</code></pre>\n\n<p>Now apply the <code>id</code> function to <code>(\\g x -&gt; g x + g x)</code>. This will get reduced to:</p>\n\n<pre><code>i = (\\x -&gt; id x + id x) 3\n</code></pre>\n\n<p>Now it's simple:</p>\n\n<pre><code>i = id 3 + id 3\ni = 6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 3, "last_activity_date": 1456062888, "creation_date": 1456062888, "answer_id": 35536987, "question_id": 35536928, "link": "https://stackoverflow.com/questions/35536928/haskell-interpretation-of-lambda-function/35536987#35536987", "title": "Haskell interpretation of lambda function", "body": "<p><code>(\\g x -&gt; g x + g x)</code> takes the arguments <code>g</code>, which must be a function, and <code>x</code>, which must be a valid argument to that function, and then adds the result of applying <code>g</code> to <code>x</code> to itself.</p>\n\n<p>In this case <code>\\y -&gt; y</code> is supplied as the value for <code>g</code> and <code>3</code> as the value for <code>x</code>, so we get <code>(\\y -&gt; y) 3 + (\\y -&gt; y) 3</code>. <code>(y -&gt; y) 3</code> is <code>3</code>, so we get <code>3 + 3</code>, which is <code>6</code>.</p>\n"}], "owner": {"reputation": 821, "user_id": 4932576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f85f56857e19a24da8f743d45b1f2952?s=128&d=identicon&r=PG&f=1", "display_name": "Stanislav", "link": "https://stackoverflow.com/users/4932576/stanislav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1456074284, "creation_date": 1456062473, "last_edit_date": 1456074284, "question_id": 35536928, "link": "https://stackoverflow.com/questions/35536928/haskell-interpretation-of-lambda-function", "title": "Haskell interpretation of lambda function", "body": "<p>i have one Haskell function, which i don't understand but want to.</p>\n\n<pre><code> i :: Int\n i = ((\\g x -&gt; g x + g x) (\\y -&gt; y)) 3\n</code></pre>\n\n<p>I know what a lambda function is: a nameless function.\nE.g. <code>(\\x -&gt; x) 3</code> takes 3 and returns it, <code>(\\x y -&gt; x+y) 3 4</code> takes 3, 4 and returns 7. \nBut in this special case i can't interpret it. I hope you can help me.\nBtw. the solution for this function is 6.</p>\n"}, {"tags": ["haskell", "typeclass", "overlapping-instances"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1456062635, "post_id": 35536661, "comment_id": 58762420, "body": "I don&#39;t think anything funny is happening - if you want to see the incoherence, add an instance for <code>CB Int</code>, etc. It will now pick one of those arbitrarily when solving <code>g (undefined :: Int)</code>. The reason that that it seems to &quot;just work&quot; is that it can&#39;t actually pick <i>any</i> of those <code>CAll</code> instances, because of the extra type variables in the head. But when you allow incoherence, it essentially says &quot;do <i>any</i> of these instances work?&quot; if it can&#39;t find one by regular inference (which it can <i>never</i> do here). In your case, you have it nicely set up so that only one instance will ever be valid."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1456062917, "post_id": 35536661, "comment_id": 58762518, "body": "To clarify, your point 1 is true - GHC does not backtrack on instance context failures, when doing <i>type constraint solving</i>. Picking an instance &quot;arbitrarily&quot; in the presence of incoherent instances is <i>not</i> constraint solving. It <i>does</i> consider the contexts - in fact it essentially just reduces every possible instantiation until it gets one that works and then it says - yep its this one - because it&#39;s arbitrary. Doesn&#39;t matter if there is another instantiation which also works."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1456063455, "post_id": 35536661, "comment_id": 58762708, "body": "Just ... don&#39;t. <code>IncoherentInstances</code> is a highly effective way to shoot yourself in the foot."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456064237, "post_id": 35536661, "comment_id": 58762993, "body": "Thanks @user2407038. See my edit, is this a roughly correct understanding of what&#39;s happening?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456066411, "post_id": 35536661, "comment_id": 58763743, "body": "@Clinton I believe something completely different is happening. In step 1, <i>all</i> of the instances match! This is because <code>t</code> is completely free in all of them - and there is no relation as far as the typecheck is concerned between <code>t</code> and the rest of the type vars. Step 2 eliminates no instances. Step 3 does &quot;select an arbitary one&quot; - they are all incoherent. Step 4 returns this candidate - step 5 never happens!"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1456066662, "post_id": 35536661, "comment_id": 58763840, "body": "How is it always selecting the right one at step 3 then?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456066690, "post_id": 35536661, "comment_id": 58763853, "body": "&quot;Match&quot; refers to the instance head matching algorithm. &quot;Unify&quot; is sort of borrowing a word from another part of typechecking. In general two <i>types</i> are said to unify if there is an instantiation which makes them equal. In this context, a <i>constraint</i> and a <i>instance head</i> are said to &quot;unify&quot; if there is an instantiation which makes them <i>match</i>."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1456066779, "post_id": 35536661, "comment_id": 58763885, "body": "Surely if step 1 and 2 eliminate no candidates than I wouldn&#39;t get the right one very often."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456067461, "post_id": 35536661, "comment_id": 58764169, "body": "Sorry... I must be wrong. Step 5 finds that all of the instances qualify as &quot;might match when the target constraint is further instantiated.&quot;. When it does this further instantiation, it finds that only one matches (when it does this - the alg doesn&#39;t specify). That must be how it finds the correct instance... What I can&#39;t figure out, is how it even gets to step 5. There are certainly <i>no</i> coherent candidates at all, meaning step 4 must return. There must be some tricky edge cases not mentioned in the docs... might have to dig into to source code to find out what&#39;s going on."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1456068088, "post_id": 35536661, "comment_id": 58764433, "body": "I&#39;m thinking somehow by step 4 we only have on instance. If incoherent instances is on, it&#39;s selected, but if incoherent instances is off, we then go to step 5 and get problems."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1456070268, "post_id": 35536661, "comment_id": 58765286, "body": "I suspect the GHC docs are not quite precise about what&#39;s happening in the actual code; they were probably written before type families existed and not revisited after, even though changes to instance selection almost surely happened at that time."}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 136, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1456065957, "creation_date": 1456060919, "last_edit_date": 1456065957, "question_id": 35536661, "link": "https://stackoverflow.com/questions/35536661/strange-program-that-requires-incoherent-instances-yet-always-seems-to-pick-the", "title": "Strange program that requires incoherent instances yet always seems to pick the &quot;right&quot; one?", "body": "<p>Consider the following <a href=\"http://ideone.com/kFFlGT\" rel=\"nofollow\">program</a>, which only compiles with incoherent instances enabled:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, MultiParamTypeClasses, FlexibleInstances #-}\n{-# LANGUAGE IncoherentInstances #-}\n\nmain = do\n  print (g (undefined :: Int))\n  print (g (undefined :: Bool))\n  print (g (undefined :: Char))\n\ndata True\n\nclass CA t where\n  type A t; type A t = True\n  fa :: t -&gt; String\ninstance CA Int where\n  fa _ = \"Int\"\n\nclass CB t where\n  type B t; type B t = True\n  fb :: t -&gt; String\ninstance CB Bool where\n  fb _ = \"Bool\"\n\nclass CC t where\n  type C t; type C t = True\n  fc :: t -&gt; String\ninstance CC Char where\n  fc _ = \"Char\"\n\nclass CAll t t1 t2 t3 where\n  g :: (t1 ~ A t, t2 ~ B t, t3 ~ C t) =&gt; t -&gt; String\n\ninstance (CA t) =&gt; CAll t True  t2   t3  where g = fa\ninstance (CB t) =&gt; CAll t  t1  True  t3  where g = fb\ninstance (CC t) =&gt; CAll t  t1   t2  True where g = fc\n</code></pre>\n\n<p>When compiling without incoherent instances it claims multiple instances match. This would seem to imply that when incoherent instances are allowed, the instances would be chosen arbitrarily.</p>\n\n<p>Unless I'm exceedingly lucky, this would result in compile errors as the instance constraints in most cases would not be satisfied.</p>\n\n<p>But with incoherent instances I get no compile errors, and indeed get the following output with the \"correct\" instances chosen:</p>\n\n<pre><code>\"Int\"\n\"Bool\"\n\"Char\"\n</code></pre>\n\n<p>So I can only conclude either one of a few things here:</p>\n\n<ol>\n<li>GHC is backtracking on instance context failures (something it says it doesn't do in it's own documentation)</li>\n<li>GHC actually knows there's only one instance that matches, but isn't brave enough to use it unless one turns on incoherent instances</li>\n<li>I've just got exceedingly lucky (1 in 3<sup>3</sup> = 27 chance)</li>\n<li>Something else is happening.</li>\n</ol>\n\n<p>I suspect the answer is 4 (maybe combined with 2). I'd like any answer to explain what's going on here, and how much I can rely on this behavior with incoherent instances? If it's reliable it seems I could use this behaviour to make quite complex class hierarchies, that actually behave somewhat like subtyping, e.g. I could say all types of class A and class B are in class C, and an instance writer could make an instance for A without having to explicitly make an instance for C. </p>\n\n<p><strong>Edit:</strong></p>\n\n<p>I suspect the answer has something to do with <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/type-class-extensions.html\" rel=\"nofollow\">this</a> in the GHC docs:</p>\n\n<blockquote>\n  <ol>\n  <li>Find all instances I that match the target constraint; that is, the target constraint is a substitution instance of I. These instance declarations are the candidates.</li>\n  <li>Eliminate any candidate IX for which both of the following hold:\n  \n  <ul>\n  <li>There is another candidate IY that is strictly more specific; that is, IY is a substitution instance of IX but not vice versa.</li>\n  <li>Either IX is overlappable, or IY is overlapping. (This \"either/or\" design, rather than a \"both/and\" design, allow a client to deliberately override an instance from a library, without requiring a change to the library.)</li>\n  </ul></li>\n  <li><p>If exactly one non-incoherent candidate remains, select it. If all   remaining candidates are incoherent, select an arbitary one. Otherwise the search fails (i.e. when more than one surviving candidate is not incoherent).</p></li>\n  <li><p>If the selected candidate (from the previous step) is incoherent, the    search succeeds, returning that candidate.</p></li>\n  <li><p>If not, find all instances that unify with the target constraint, but   do not match it. Such non-candidate instances might match when the target constraint is further instantiated. If all of them are incoherent, the search succeeds, returning the selected candidate; if not, the search fails.</p></li>\n  </ol>\n</blockquote>\n\n<p>Correct me if I'm wrong, but whether incoherent instances is selected or not, in the first step, there's only one instance that \"matches\". In the incoherent case, we fall out with that \"matched\" case at step 4. But in the non-incoherent case, we then go to step 4, and even though only one instance \"matches\", we find other instances \"unify\". So we must reject.</p>\n\n<p>Is this understanding correct?</p>\n\n<p>And if so, could someone explain exactly what \"match\" and \"unify\" mean, and the difference between them?</p>\n"}, {"tags": ["haskell", "unicode", "ghc"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1456049818, "post_id": 35534795, "comment_id": 58758307, "body": "What is your locale? BTW bash has nothing to do with this. Editing tags. Just guessing you have ghc. Feel free to correct this."}, {"owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1456050008, "post_id": 35534795, "comment_id": 58758364, "body": "Umm - sorry, what do I need to type in to find my locale?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1456050074, "post_id": 35534795, "comment_id": 58758385, "body": "Try typing <code>locale</code> and see if it helps."}, {"owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1456050149, "post_id": 35534795, "comment_id": 58758409, "body": "OK - I see lots of &quot;POSIX&quot; strings.  Is there a specific line that would help?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456050213, "post_id": 35534795, "comment_id": 58758430, "body": "usually all those are the same (I am from germany so I see lot&#39;s of de_DE.UTF-8`) - I thinkg n.m. s question was what&#39;s yours?"}, {"owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "edited": false, "score": 0, "creation_date": 1456050267, "post_id": 35534795, "comment_id": 58758445, "body": "All of the strings after the &#39;=&#39;s are &quot;POSIX&quot;.  LANG and LANGUAGE are blank."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456050327, "post_id": 35534795, "comment_id": 58758466, "body": "oh ... that&#39;s strange - is this Arch? ... you should set your locale IMO"}, {"owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "edited": false, "score": 0, "creation_date": 1456050442, "post_id": 35534795, "comment_id": 58758512, "body": "Umm - it&#39;s Debian.  If it&#39;s unusual that probably because it&#39;s a <a href=\"https://github.com/dnschneid/crouton/\" rel=\"nofollow noreferrer\">chroot</a>.  What do I need to do to set my locale?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456050577, "post_id": 35534795, "comment_id": 58758559, "body": "if you don&#39;t see yours with <code>locale -a</code> you have to generate it with something like <code>sudo locale-gen de_DE.UTF-8</code> - once you have it you can activate it with <code>update-locale LANG=de_DE.UTF-8</code> then after reboot it should be set"}, {"owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456050603, "post_id": 35534795, "comment_id": 58758566, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/104086/discussion-between-rhubarbandc-and-carsten\">continue this discussion in chat</a>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1456051022, "post_id": 35534795, "comment_id": 58758710, "body": "&quot;it&#39;s a chroot&quot; that explains it."}], "answers": [{"comments": [{"owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "edited": false, "score": 0, "creation_date": 1456052556, "post_id": 35535026, "comment_id": 58759200, "body": "I found this link more useful than the one you suggested though: <a href=\"http://perlgeek.de/en/article/set-up-a-clean-utf8-environment\" rel=\"nofollow noreferrer\">perlgeek.de/en/article/set-up-a-clean-utf8-environment</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "edited": false, "score": 0, "creation_date": 1456052813, "post_id": 35535026, "comment_id": 58759260, "body": "You&#39;re right, I have replaced it with your suggested link."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1456052768, "last_edit_date": 1456052768, "creation_date": 1456050914, "answer_id": 35535026, "question_id": 35534795, "link": "https://stackoverflow.com/questions/35534795/cant-display-unicode/35535026#35535026", "title": "Can&#39;t display unicode", "body": "<p>Your user environment is not set up correctly to handle Unicode. Your locale should be set to <code>&lt;language&gt;_&lt;territory&gt;.utf-8</code> or some spelling variation thereof (some systems use UTF8 or utf8). Type <code>locale -a</code> to see a list of supported locales. Type</p>\n\n<pre><code> export LANG=&lt;your preferred locale name&gt;\n</code></pre>\n\n<p>and run your progran again. The program should stop complaining. If you don't see correct characters, and you are running X11, type <code>xterm&amp;</code> (or whatever terminal emulator you prefer) in the same session, and try again.</p>\n\n<p>If there are no suitable locales, you may need to generate some. <a href=\"http://perlgeek.de/en/article/set-up-a-clean-utf8-environment\" rel=\"nofollow\">This</a> seem to explain how to do that on Debian.</p>\n"}], "owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 35535026, "answer_count": 1, "score": 0, "last_activity_date": 1456052768, "creation_date": 1456049463, "last_edit_date": 1456050040, "question_id": 35534795, "link": "https://stackoverflow.com/questions/35534795/cant-display-unicode", "title": "Can&#39;t display unicode", "body": "<p>I have a feeling that this has already been answered somewhere: if so I apologise.</p>\n\n<p>I am trying to use an executable that writes Unicode characters to standard output.  All I get is this error message (hPutChar from Haskell):</p>\n\n<pre><code>&lt;stderr&gt;: hPutChar: invalid argument (invalid character)\n</code></pre>\n\n<p>Just to be clear: the executable is not mine, I cannot change what it outputs.</p>\n\n<p>Is there some way to get bash to display these characters?  My bash version is 4.3.30 on Debian Jessie.</p>\n\n<p>Thanks very much.</p>\n"}, {"tags": ["haskell", "opengl", "shader", "vbo"], "answers": [{"comments": [{"owner": {"reputation": 1143, "user_id": 1233615, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b941941886b3fdc1e8a3596ff5cd3f0a?s=128&d=identicon&r=PG", "display_name": "fuji", "link": "https://stackoverflow.com/users/1233615/fuji"}, "edited": false, "score": 0, "creation_date": 1456072772, "post_id": 35536069, "comment_id": 58766268, "body": "Thank you very much, I was not even looking in this place. I will embrace your tip with the type annotations, this has cost me so much time."}], "tags": [], "owner": {"reputation": 111, "user_id": 5775500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b51929ee4bffd3be650835e5cd111fd7?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bexelius", "link": "https://stackoverflow.com/users/5775500/tobias-bexelius"}, "is_accepted": true, "score": 5, "last_activity_date": 1456057437, "creation_date": 1456057437, "answer_id": 35536069, "question_id": 35534590, "link": "https://stackoverflow.com/questions/35534590/drawing-colored-quads-in-haskell-with-gpipe/35536069#35536069", "title": "Drawing colored quads in Haskell with gpipe", "body": "<p>When you get errors like these, a good idea is to start with confining the type error by adding type annotations. Top level definitions like <code>loop</code> are good candidates for this, so in your case add this:</p>\n\n<pre><code>loop :: Buffer os (B4 Float, B3 Float) \n     -&gt; CompiledShader os (ContextFormat RGBFloat ()) ShaderEnvironment \n     -&gt; Buffer os (Uniform (V4 (B4 Float)))\n     -&gt; ContextT GLFW.GLFWWindow os (ContextFormat RGBFloat ()) IO ()\n</code></pre>\n\n<p>With this type annotation in place the real issues appear:</p>\n\n<ul>\n<li>You have forgot parentheses around <code>-1.0</code> in the <code>ortho</code> call.</li>\n<li>You try to call <code>clearContextDepth 1</code> even though the context was created without a depth buffer.</li>\n</ul>\n\n<p>After fixing those two issues the module compiles fine even after you remove the type annotation for <code>loop</code> (but I recommend you to keep it around).</p>\n"}], "owner": {"reputation": 1143, "user_id": 1233615, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/b941941886b3fdc1e8a3596ff5cd3f0a?s=128&d=identicon&r=PG", "display_name": "fuji", "link": "https://stackoverflow.com/users/1233615/fuji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 35536069, "answer_count": 1, "score": 3, "last_activity_date": 1456057437, "creation_date": 1456048001, "question_id": 35534590, "link": "https://stackoverflow.com/questions/35534590/drawing-colored-quads-in-haskell-with-gpipe", "title": "Drawing colored quads in Haskell with gpipe", "body": "<p>I am trying to draw quads at random position on the screen in Haskell using the <code>gpipe</code> package. Since the quads will lie in 2D, I also want to set up an orthographic projection. How ever I don't seem to get the types right for rasterization. This is my code (pieced together using the gpipe tutorials):</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, PackageImports, FlexibleContexts, TypeFamilies #-}\nmodule Main where\n\nimport Graphics.GPipe\nimport qualified \"GPipe-GLFW\" Graphics.GPipe.Context.GLFW as GLFW\nimport Control.Monad (unless)\n\nimport System.Random\n\n-- Generate random points in 2d\ngetRandomPoints2D :: (Float, Float) -&gt; StdGen -&gt; [V4 Float]\ngetRandomPoints2D range sg = zipWith createPoint x y\n    where createPoint x y = V4 x y 0 1\n          (sg1, sg2) = split sg\n          x = randomRs range sg1\n          y = randomRs range sg2\n\ngetPoints :: Int -&gt; StdGen -&gt; [V4 Float]\ngetPoints n sg = take n $ getRandomPoints2D (-1,1) sg\n\nexamplePoints :: Int -&gt; IO [V4 Float]\nexamplePoints n = newStdGen &gt;&gt;= return . getPoints n\n\n-- Quads from point\nquadFromPoint :: V4 Float -&gt; [V4 Float]\nquadFromPoint p = map (p +) [ v4 (-off) (-off), v4 (-off) off\n                            , v4 off (-off), v4 off (-off)\n                            , v4 off off, v4 (-off) off\n                            ]\n    where off = 0.1\n          v4 x y = V4 x y 0 0\n\nmain = do\n    let width = 720\n        height = 540\n        windowConf = GLFW.WindowConf width height \"hs-visu\"\n        context = GLFW.newContext' [] windowConf\n    let numPoints = 6\n    points &lt;- examplePoints numPoints\n    let quadPoints = concatMap quadFromPoint points\n        pointsWithColor = zip quadPoints $ repeat (V3 1 0 0)\n    runContextT context (ContextFormatColor RGB8) $ do\n\n        -- Create buffers for the vertices\n        vertexBuffer :: Buffer os (B4 Float, B3 Float) &lt;- newBuffer (length pointsWithColor)\n        writeBuffer vertexBuffer 0 pointsWithColor\n\n        -- Create a buffer for the uniform values\n        uniformBuffer :: Buffer os (Uniform (V4 (B4 Float))) &lt;- newBuffer 1\n\n        shader &lt;- compileShader $ do\n            -- Vertex shader\n            primitiveStream &lt;- toPrimitiveStream primitives\n            modelViewProj &lt;- getUniform (const (uniformBuffer, 0))\n            let projPrimitiveStream = proj modelViewProj &lt;$&gt; primitiveStream\n\n            -- Fragment shader\n            fragmentStream &lt;- rasterize rasterOptions projPrimitiveStream\n            let colorOption = ContextColorOption NoBlending (pure True)\n            drawContextColor (const colorOption) fragmentStream\n\n        -- Run the loop\n        loop vertexBuffer shader uniformBuffer\n\nloop vertexBuffer shader uniformBuffer = do\n    -- Construct the ModelViewProjection matrix\n    size@(V2 w h) &lt;- getContextBuffersSize\n    let halfWidth = (fromIntegral w)/2.0\n        halfHeight = (fromIntegral h)/2.0\n        projMat = ortho (-halfWidth) halfWidth halfHeight (-halfHeight) -1.0 1.0\n\n    writeBuffer uniformBuffer 0 [projMat]\n\n    render $ do\n        clearContextColor 1 -- White background\n        clearContextDepth 1 -- Far plane\n        vertexArray &lt;- newVertexArray vertexBuffer\n        let primitiveArray = toPrimitiveArray TriangleList vertexArray\n        shader $ ShaderEnvironment primitiveArray (FrontAndBack, ViewPort 0 size, DepthRange 0 1)\n    swapContextBuffers\n\n    closeRequested &lt;- GLFW.windowShouldClose\n    unless closeRequested $ loop vertexBuffer shader uniformBuffer\n\ndata ShaderEnvironment = ShaderEnvironment\n    { primitives :: PrimitiveArray Triangles (B4 Float, B3 Float)\n    , rasterOptions :: (Side, ViewPort, DepthRange)\n    }\n\n-- Projects the position of the vertices with the ModelViewProjection matrix\nproj :: (V4 (V4 VFloat)) -&gt; (V4 VFloat, V3 VFloat) -&gt; (V4 VFloat, V3 VFloat)\nproj modelViewProj (p,c) = (modelViewProj !* p, c)\n</code></pre>\n\n<p>However, if I try to compile my code, I will get the following error messages:</p>\n\n<pre><code>Main.hs:58:31:\n    Couldn't match type \u2018Color c0 (S F (ColorElement c0))\u2019\n                   with \u2018V3 FFloat\u2019\n    The type variable \u2018c0\u2019 is ambiguous\n    Expected type: Shader\n                     os\n                     (ContextFormat c0 ds0)\n                     ShaderEnvironment\n                     (FragmentStream (FragColor c0))\n      Actual type: Shader\n                     os\n                     (ContextFormat c0 ds0)\n                     ShaderEnvironment\n                     (FragmentStream (FragmentFormat (V3 VFloat)))\n    In a stmt of a 'do' block:\n      fragmentStream &lt;- rasterize rasterOptions projPrimitiveStream\n    In the second argument of \u2018($)\u2019, namely\n      \u2018do { primitiveStream &lt;- toPrimitiveStream primitives;\n            modelViewProj &lt;- getUniform (const (uniformBuffer, 0));\n            let projPrimitiveStream = proj modelViewProj &lt;$&gt; primitiveStream;\n            fragmentStream &lt;- rasterize rasterOptions projPrimitiveStream;\n            .... }\u2019\n\nMain.hs:59:62:\n    Couldn't match type \u2018Color c0 Bool\u2019 with \u2018f0 Bool\u2019\n    The type variables \u2018f0\u2019, \u2018c0\u2019 are ambiguous\n    Expected type: ColorMask c0\n      Actual type: f0 Bool\n    Relevant bindings include\n      colorOption :: ContextColorOption c0 (bound at Main.hs:59:17)\n      fragmentStream :: FragmentStream (FragColor c0)\n        (bound at Main.hs:58:13)\n    In the second argument of \u2018ContextColorOption\u2019, namely\n      \u2018(pure True)\u2019\n    In the expression: ContextColorOption NoBlending (pure True)\n\nMain.hs:65:1:\n    Could not deduce (Fractional a0)\n    from the context (Fractional a,\n                      Fractional a1,\n                      Fractional (a1 -&gt; a -&gt; a -&gt; M44 a),\n                      Num (Color c Float),\n                      Num (a -&gt; a -&gt; M44 a),\n                      DepthRenderable ds,\n                      ContextColorFormat c,\n                      Control.Monad.IO.Class.MonadIO m,\n                      Control.Monad.Exception.MonadException m,\n                      HostFormat b ~ (a -&gt; a -&gt; M44 a))\n      bound by the inferred type for \u2018loop\u2019:\n                 (Fractional a, Fractional a1, Fractional (a1 -&gt; a -&gt; a -&gt; M44 a),\n                  Num (Color c Float), Num (a -&gt; a -&gt; M44 a), DepthRenderable ds,\n                  ContextColorFormat c, Control.Monad.IO.Class.MonadIO m,\n                  Control.Monad.Exception.MonadException m,\n                  HostFormat b ~ (a -&gt; a -&gt; M44 a)) =&gt;\n                 Buffer os (B4 Float, B3 Float)\n                 -&gt; (ShaderEnvironment -&gt; Render os (ContextFormat c ds) ())\n                 -&gt; Buffer os b\n                 -&gt; ContextT GLFW.GLFWWindow os (ContextFormat c ds) m ()\n      at Main.hs:(65,1)-(83,66)\n    The type variable \u2018a0\u2019 is ambiguous\n    When checking that \u2018loop\u2019 has the inferred type\n      loop :: forall os (m :: * -&gt; *) a a1 b c ds.\n              (Fractional a, Fractional a1, Fractional (a1 -&gt; a -&gt; a -&gt; M44 a),\n               Num (Color c Float), Num (a -&gt; a -&gt; M44 a), DepthRenderable ds,\n               ContextColorFormat c, Control.Monad.IO.Class.MonadIO m,\n               Control.Monad.Exception.MonadException m,\n               HostFormat b ~ (a -&gt; a -&gt; M44 a)) =&gt;\n              Buffer os (B4 Float, B3 Float)\n              -&gt; (ShaderEnvironment -&gt; Render os (ContextFormat c ds) ())\n              -&gt; Buffer os b\n              -&gt; ContextT GLFW.GLFWWindow os (ContextFormat c ds) m ()\n    Probable cause: the inferred type is ambiguous\n</code></pre>\n\n<p>I don't understand why the types are different from the Hello World tutorial found <a href=\"http://tobbebex.blogspot.de/2015/10/gpu-programming-in-haskell-using-gpipe.html\" rel=\"nofollow\">here</a>. And what can be done to fix this problem.</p>\n"}, {"tags": ["haskell", "haskell-snap-framework"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1456049855, "post_id": 35533857, "comment_id": 58758318, "body": "Did you look at <a href=\"http://snapframework.com/docs/tutorials/heist\" rel=\"nofollow noreferrer\">this page</a>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1456050693, "post_id": 35533857, "comment_id": 58758592, "body": "@Bakuriu, I don&#39;t want to add a new level of abstruction. Is there any to avoid using Heist?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "edited": false, "score": 0, "creation_date": 1456115496, "post_id": 35545399, "comment_id": 58780286, "body": "can I use Heist with any other web framework, say, Scotty?"}, {"owner": {"reputation": 7154, "user_id": 527460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cece5abd2f9ad9056f5ac3830ac0bfe?s=128&d=identicon&r=PG", "display_name": "mightybyte", "link": "https://stackoverflow.com/users/527460/mightybyte"}, "edited": false, "score": 0, "creation_date": 1456119956, "post_id": 35545399, "comment_id": 58781665, "body": "Yes.  Heist was specifically designed to not depend on anything from Snap.  However, you&#39;ll probably have to write a bit more infrastructure code with other frameworks than you would have to do with Snap.  For instance, <a href=\"http://hackage.haskell.org/package/happstack-heist\" rel=\"nofollow noreferrer\">this package</a> has the small amount of infrastructure code that makes it easier to use Heist with Happstack."}], "tags": [], "owner": {"reputation": 7154, "user_id": 527460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cece5abd2f9ad9056f5ac3830ac0bfe?s=128&d=identicon&r=PG", "display_name": "mightybyte", "link": "https://stackoverflow.com/users/527460/mightybyte"}, "is_accepted": true, "score": 1, "last_activity_date": 1456112101, "creation_date": 1456112101, "answer_id": 35545399, "question_id": 35533857, "link": "https://stackoverflow.com/questions/35533857/how-to-work-with-html-files-in-snap/35545399#35545399", "title": "How to work with html files in snap?", "body": "<p>The simplest way to serve static files is with <a href=\"http://hackage.haskell.org/package/snap-core-0.9.8.0/docs/Snap-Util-FileServe.html#v:serveFile\" rel=\"nofollow\">serveFile</a>.  You would probably have something like this in your routes:</p>\n\n<pre><code>[ ...your routes here\n, (\"markup\", serveFile \"mymarkup.html\")\n]\n</code></pre>\n\n<p>This makes it so that when a user goes to <code>http://yoursite/markup</code>, the file <code>mymarkup.html</code> in whatever directory you ran the app from gets served.  If you are trying to serve many different HTML files, a better solution is <a href=\"http://hackage.haskell.org/package/snap-core-0.9.8.0/docs/Snap-Util-FileServe.html#v:serveDirectory\" rel=\"nofollow\">serveDirectory</a>.  You might use it like this:</p>\n\n<pre><code>[ ...your routes here\n, (\"static\", serveDirectory \"html\")\n]\n</code></pre>\n\n<p>This makes it so that when a user goes to <code>http://yoursite/static/mymarkup.html</code>, the file <code>html/mymarkup.html</code> gets served.</p>\n\n<p>For your question of how to make one file be the template for all your pages, that is precisely what Heist does for you!  There are certainly ways to avoid using Heist, but you will probably be reinventing a lot of what Heist does for you.  At the basic level that you're asking about, Heist is pretty straightforward.  All valid HTML files are valid Heist templates.  I would recommend reading through the <a href=\"http://snapframework.com/docs/tutorials/heist\" rel=\"nofollow\">tutorial</a> like Bakuriu mentioned.  I believe Heist's <code>apply</code> tag is almost exactly what you're looking for.  </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 35545399, "answer_count": 1, "score": 1, "last_activity_date": 1456112101, "creation_date": 1456042644, "last_edit_date": 1456050735, "question_id": 35533857, "link": "https://stackoverflow.com/questions/35533857/how-to-work-with-html-files-in-snap", "title": "How to work with html files in snap?", "body": "<p>I begin learning snap framework. I'm trying to render an html file and layout html file (\"template\") in a simple way. That is to say, I have a shared html file I want to use as a template one for all the page in my website. How can I do that? And, a similar question, how can I render an html file?</p>\n\n<p>UPDATE:</p>\n\n<p>I don't want to add a new level of abstruction. Is there any to avoid using Heist? </p>\n"}, {"tags": ["haskell", "functional-programming", "ghci"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456038127, "post_id": 35533265, "comment_id": 58755550, "body": "It&#39;s not mutation; it&#39;s just shadowing."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1456038254, "post_id": 35533265, "comment_id": 58755569, "body": "Please read <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/interactive-evaluation.html#idp46760125930848\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/users_guide/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456063561, "post_id": 35533323, "comment_id": 58762758, "body": "The last part is true. The first part isn&#39;t quite, and is confusing."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456070969, "post_id": 35533323, "comment_id": 58765566, "body": "@dfeuer: Please feel free to elaborate."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1456074410, "post_id": 35533323, "comment_id": 58766848, "body": "@PaulJohnson Well, there are actually 3 different ways ghci handles expressions.  The one you described, showable expressions without IO, and IO expressions without a showable result."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 8, "last_activity_date": 1456038498, "creation_date": 1456038498, "answer_id": 35533323, "question_id": 35533265, "link": "https://stackoverflow.com/questions/35533265/does-the-it-variable-in-ghci-haskell-mutate/35533323#35533323", "title": "Does the &#39;it&#39; variable in GHCi Haskell mutate?", "body": "<p>Expressions typed into ghci have an implicit type of</p>\n\n<pre><code>it :: (Show a) =&gt; IO a\n</code></pre>\n\n<p>In other words everything you do is in the IO monad (the \"Show\" means you have to be able to convert the result to text for printing). When you type a series of expressions in, it works like this:</p>\n\n<pre><code>do\n   it &lt;- foo\n   it &lt;- bar\n</code></pre>\n\n<p>Haskell's \"do\" notation desugars into nested lambdas something like this</p>\n\n<pre><code>  foo &gt;&gt;= $ \\it -&gt;\n     bar &gt;&gt;= $ \\it -&gt; ... -- and so on.\n</code></pre>\n\n<p>In other words the value of \"it\" is not changing, rather a new value is being declared in a scope that shadows the previous one.</p>\n"}], "owner": {"reputation": 903, "user_id": 3123371, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3cc2cc6fd44c6293a20aa27571dbad8b?s=128&d=identicon&r=PG&f=1", "display_name": "guru107", "link": "https://stackoverflow.com/users/3123371/guru107"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1456050845, "creation_date": 1456038040, "last_edit_date": 1456050845, "question_id": 35533265, "link": "https://stackoverflow.com/questions/35533265/does-the-it-variable-in-ghci-haskell-mutate", "title": "Does the &#39;it&#39; variable in GHCi Haskell mutate?", "body": "<p>Just started with Haskell and it is said that Haskell has immutable variables. Then why does 'it' variable keep mutating its value every time an expression is entered in GHCi prompt?</p>\n\n<pre><code>GHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; 7*2\n14\nPrelude&gt; it\n14\nPrelude&gt; \"foo\"\n\"foo\"\nPrelude&gt; it\n\"foo\"\nPrelude&gt;\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1456047733, "post_id": 35533237, "comment_id": 58757690, "body": "This question is not clear to me. What is the first parameter for? Why can&#39;t you simply use <code>reverse myList</code> for reversing? E.g. <code>let reversed = reverse myList in somehowUseResult reversed</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1456048581, "post_id": 35533237, "comment_id": 58757962, "body": "Ate you sure you need <code>++[x]</code>? Does it fall under &quot;reverse&quot; part or under &quot;do some work on it&quot; part?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1456083477, "post_id": 35533237, "comment_id": 58770598, "body": "Instead of <code>reverse xs ++ [x]</code>, use <code>reverse (x : xs)</code>. Note that this does nothing to the list <code>(x:xs)</code>, aside from reverse it."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "edited": false, "score": 0, "creation_date": 1456040514, "post_id": 35533387, "comment_id": 58756048, "body": "i understand your code but it doesnt fix the problem, the point here is, im trying to reverse the list i get then apply the guards, so when you do test f     xs = f xs&#39;     where xs&#39; = reverse xs it is not going to apply the guards anymore"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "edited": false, "score": 1, "creation_date": 1456042122, "post_id": 35533387, "comment_id": 58756373, "body": "just put your <i>guards</i>  in whatever <code>f</code> is - but maybe I get you wrong - why don&#39;t you just post what you are really trying to do? In your first <i>try</i> you did not have any <i>guards</i> at all btw"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1456047583, "post_id": 35533387, "comment_id": 58757653, "body": "Note that <code>f :: a-&gt;Bool</code> does not take a list. Either the type of the OP is wrong, or the OP means entirely something else."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1456047658, "post_id": 35533387, "comment_id": 58757669, "body": "@chi true ... I completely missed this sorry (my bad) - I even copy&amp;pasted ... doh"}, {"owner": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "edited": false, "score": 0, "creation_date": 1456072083, "post_id": 35533387, "comment_id": 58766008, "body": "ok so here is what im trying to do @Carsten . so my second input will be a list, i need to reverse that list first, then with the answer which is the reversed list , check on some guards conditions, for ex: if i have my second input as [1,2,3,4,5] , i need to reverse it first so i get [5,4,3,2,1] then check if this reversed list have an odd number at the second index, hopefully this clarifies abit"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456072323, "post_id": 35533387, "comment_id": 58766099, "body": "this fit&#39;s in just fine if you use the <i>unfiltered</i> variant (<code>test f = f . reverse</code>)  with <code>f xs = odd (xs !! 1)</code>: <code>test (\\xs -&gt; odd (xs !! 1)) [1..5]</code> yields <code>False</code>, same with <code>[1..4]</code> yields <code>True</code>"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1456047883, "last_edit_date": 1456047883, "creation_date": 1456039031, "answer_id": 35533387, "question_id": 35533237, "link": "https://stackoverflow.com/questions/35533237/how-to-reverse-a-list-then-use-the-reversed-list/35533387#35533387", "title": "How to reverse a list then use the reversed list", "body": "<h3>remark:</h3>\n\n<p>as @chi just pointed out there is something fishy with the types/function</p>\n\n<p>So you either want to <em>filter</em> or <em>use</em> the resulting map - I assumed the later (as you talked about it) but your signature suggests the former.</p>\n\n<p>I'll edit the post and put on the first version as well</p>\n\n<hr>\n\n<p>When you do your pattern matching like this:</p>\n\n<pre><code>test _ (x:xs)\ntest func (x:xs)\n</code></pre>\n\n<p>then both lines will match the same thing - the only difference is that in\nthe later case you named the first parameter (<code>func</code>) while in the first\nyou say <em>I don't need the function</em></p>\n\n<p>And as Haskell matches from top to bottom you will never see the last line\nand so you will never get to the right-side of it</p>\n\n<p>so </p>\n\n<pre><code>test :: ([a] -&gt; b) -&gt; [a] -&gt; b\ntest f []     = f []\ntest f (x:xs) = f (reverse xs ++ [x])\n</code></pre>\n\n<p>or (the filter version)</p>\n\n<pre><code>test :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\ntest _ []     = []\ntest f (x:xs) = filter f (reverse xs ++ [x])\n</code></pre>\n\n<p>would have worked (although the deconstruction into <code>(x:xs)</code> and even the\nfirst case are not really needed as @foo remarked)</p>\n\n<hr>\n\n<p>The idea with the <code>where</code> was a good step but you try to mix it with pattern matching the list (you <em>don't</em> have to here at all - <code>reverse</code> will do it for you):</p>\n\n<pre><code>test :: ([a] -&gt; b) -&gt; [a] -&gt; b\ntest f xs = f xs'\n    where xs' = reverse xs\n</code></pre>\n\n<p>or <em>filter</em> version:</p>\n\n<pre><code>test :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\ntest f xs = filter f xs'\n    where xs' = reverse xs\n</code></pre>\n\n<p>of course once you have this you might see that you can use\ncomposition too:</p>\n\n<pre><code>test f xs = f (reverse xs) = (f . reverse) xs\n</code></pre>\n\n<p>or <em>filter</em> version</p>\n\n<pre><code>test f xs = filter f (reverse xs) = (filter f . reverse) xs\n</code></pre>\n\n<p>so that you can write</p>\n\n<pre><code>test f = f . reverse\n</code></pre>\n\n<p>or <em>filtered</em></p>\n\n<pre><code>test f = filter f . reverse\n</code></pre>\n\n<p>instead too</p>\n\n<p><strong>btw:</strong> here you can see what I meant by </p>\n\n<blockquote>\n  <p>just put your guards in whatever <code>f</code> is </p>\n</blockquote>\n\n<p>in my comment as if you implement the first version then you get the second by just replacing <code>f</code> with <code>filter g</code> where <code>g</code> is your guard</p>\n"}, {"comments": [{"owner": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "edited": false, "score": 0, "creation_date": 1456085713, "post_id": 35541028, "comment_id": 58771500, "body": "thanks man thats exactly what i needed and after the processing on the reverse list if i want to reverse the list again to show as output ? @Rein Henrichs"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "edited": false, "score": 0, "creation_date": 1456086159, "post_id": 35541028, "comment_id": 58771662, "body": "@NimaFarahani <code>reverse (func&#39; f (reverse xs))</code>"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "edited": false, "score": 0, "creation_date": 1456086365, "post_id": 35541028, "comment_id": 58771742, "body": "@NimaFarahani this is a nice place to use composition: <code>func f = reverse . func&#39; f . reverse</code>"}, {"owner": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "edited": false, "score": 0, "creation_date": 1456086793, "post_id": 35541028, "comment_id": 58771915, "body": "thats awesome ! @Rein Henrichs"}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 1, "last_activity_date": 1456083594, "creation_date": 1456083594, "answer_id": 35541028, "question_id": 35533237, "link": "https://stackoverflow.com/questions/35533237/how-to-reverse-a-list-then-use-the-reversed-list/35541028#35541028", "title": "How to reverse a list then use the reversed list", "body": "<p>The easiest way to reverse the list before further processing is to use a helper function:</p>\n\n<pre><code>func f xs = func' f (reverse xs)\n  where\n    func' _ [] = ...\n    func' f (x:xs) = ...\n</code></pre>\n\n<p>(Note that reversing the empty list is a no-op, so you don't need to handle it specially in <code>func</code>.)</p>\n"}], "owner": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 0, "accepted_answer_id": 35541028, "answer_count": 2, "score": 0, "last_activity_date": 1456083594, "creation_date": 1456037781, "last_edit_date": 1456040731, "question_id": 35533237, "link": "https://stackoverflow.com/questions/35533237/how-to-reverse-a-list-then-use-the-reversed-list", "title": "How to reverse a list then use the reversed list", "body": "<p>I'm trying to reverse a list in Haskell, and then use the reversed list and do some work on it, but I don't know how, since Haskell picks up the third line and ignores my last line of code</p>\n\n<p><strong>Note: I know I have pattern match overlap but I don't know how to fix it.</strong> </p>\n\n<p>This is what I have :</p>\n\n<pre><code>test :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\ntest _ [] = []\ntest _ (x:xs) = reverse xs ++ [x]\ntest func (x:xs)\n</code></pre>\n\n<p>I  tried to use the <code>where</code> clause like this:</p>\n\n<pre><code>test :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\ntest _ [] = []\ntest func (x:xs)\n    | some code here\n    | some code here \n    where test _ (x:xs) = reverse xs ++ [x]\n</code></pre>\n\n<p>But it does not look like it accepts it.</p>\n"}, {"tags": ["haskell", "haskell-platform"], "comments": [{"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 2, "creation_date": 1456038745, "post_id": 35533179, "comment_id": 58755673, "body": "I&#39;m not sure what you want your code to do \u2013 your question isn&#39;t clear.  Could you elaborate, maybe with the desired result?  Relatedly, your code currently doesn&#39;t typecheck; you can&#39;t have <code>first &lt;- &quot;mfwew&quot;</code> and <code>putStrLn (b)</code> in the same <code>do</code> block."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1456039747, "post_id": 35533179, "comment_id": 58755888, "body": "This question cannot be answered without the types of <code>func</code>, <code>func1</code> and <code>func2</code> and the expected type of the whole <code>do</code> block."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 1, "creation_date": 1456039846, "post_id": 35533179, "comment_id": 58755916, "body": "What do you mean &quot;it won&#39;t work&quot;?  That works if, for instance, <code>func = return</code>, <code>func1 = return . reverse</code>, <code>func2 = putStrLn</code>, and <code>a = &quot;Hello, world!&quot;</code> \u2013 it prints <code>!dlrow ,olleH</code>.  It sounds like you&#39;re having a typechecking issue, which means we need to see the specific code that doesn&#39;t typecheck in order to be helpful."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1456049145, "post_id": 35533179, "comment_id": 58758117, "body": "check out <a href=\"http://stackoverflow.com/questions/11323300/using-return-vs-not-using-return-in-the-list-monad/11326549#11326549\">this answer</a> for some nice pictures and explanations."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 3230613, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2cb3afa0383ae896d06e3580ce74c778?s=128&d=identicon&r=PG&f=1", "display_name": "user3230613", "link": "https://stackoverflow.com/users/3230613/user3230613"}, "edited": false, "score": 0, "creation_date": 1456040136, "post_id": 35533502, "comment_id": 58755976, "body": "I have to use b &lt;- func a"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 133, "user_id": 3230613, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2cb3afa0383ae896d06e3580ce74c778?s=128&d=identicon&r=PG&f=1", "display_name": "user3230613", "link": "https://stackoverflow.com/users/3230613/user3230613"}, "edited": false, "score": 0, "creation_date": 1456040151, "post_id": 35533502, "comment_id": 58755980, "body": "why do you have to use this?"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 3, "last_activity_date": 1456040011, "creation_date": 1456040011, "answer_id": 35533502, "question_id": 35533179, "link": "https://stackoverflow.com/questions/35533179/haskell-how-to-use-previous-assigned-variable/35533502#35533502", "title": "haskell how to use previous assigned variable", "body": "<p>If I read your question and comments right than you want to just use the <em>value</em> of <code>func a</code> in <code>func1 ..</code> and you tried imperative <code>do</code>-style but then noticed that this only works for (the <code>IO</code>)-Monad(s).</p>\n\n<p>In this case <code>let</code> comes quite close:</p>\n\n<pre><code>myResult a =\n   let b = func a\n       c = func1 b\n   in func2 c\n</code></pre>\n\n<p>but in Haskell we usually do it with composition instead:</p>\n\n<pre><code>myResult a = func2 (func1 (func a))\n</code></pre>\n\n<p>which is</p>\n\n<pre><code>myResult a = func2 . func1 . func $ a\n</code></pre>\n\n<p>and finally you can drop the <em>point</em> <code>a</code> to get <em>point-free-style</em>:</p>\n\n<pre><code>myResult = func2 . func1 . func\n</code></pre>\n\n<p>if you like</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1456047439, "creation_date": 1456047439, "answer_id": 35534513, "question_id": 35533179, "link": "https://stackoverflow.com/questions/35533179/haskell-how-to-use-previous-assigned-variable/35534513#35534513", "title": "haskell how to use previous assigned variable", "body": "<p>The thumb rule is, you have to look at the type of your functions.</p>\n\n<p>When a function returns <code>IO</code> (or any monad you are working in), use <code>&lt;-</code> to run the monadic action, as in your code</p>\n\n<pre><code>do\n  b &lt;- func a\n  c &lt;- func1 b\n  func2 c\n</code></pre>\n\n<p>When a function simply returns a value, without wrapping it in the monad, use <code>let</code>.</p>\n\n<pre><code>do  -- do is not really necessary here... but let's play along\n  let b = func a\n  let c = func1 b\n  func2 c\n</code></pre>\n\n<p>Usually you need to mix both. E.g., if <code>func</code> is monadic while <code>func2</code> is not, we write</p>\n\n<pre><code>do\n  b &lt;- func a\n  let c = func1 b\n  func2 c\n</code></pre>\n\n<p>Summing up: check the type of your functions.</p>\n"}], "owner": {"reputation": 133, "user_id": 3230613, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2cb3afa0383ae896d06e3580ce74c778?s=128&d=identicon&r=PG&f=1", "display_name": "user3230613", "link": "https://stackoverflow.com/users/3230613/user3230613"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1456047439, "creation_date": 1456037368, "last_edit_date": 1456039784, "question_id": 35533179, "link": "https://stackoverflow.com/questions/35533179/haskell-how-to-use-previous-assigned-variable", "title": "haskell how to use previous assigned variable", "body": "<pre><code>  x = do\n    first &lt;- \"mfwew\"\n    let q = first\n    a &lt;- q\n    let b = a\n    putStrLn (b)\n    return b\n</code></pre>\n\n<p>how to use the assigned variable \"first\" to a &lt;- q?</p>\n\n<p>thank you</p>\n\n<p>I want to do something like this</p>\n\n<pre><code>    do\n      b &lt;- func a\n      c &lt;- func1 b\n      func2 c\n</code></pre>\n\n<p>but this won't work.  I know its because the IO type doesn't match, but is there other way to do it?\nSpecifically, i want to use b again in x &lt;- xxx b.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1456036100, "post_id": 35532997, "comment_id": 58755140, "body": "It&#39;s not a non-exhaustive pattern matching &quot;in guards&quot;. You have a pattern matching for empty list <code>[]</code> and another for lists with at least three elements, i.e. two cases uncovered."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1456036611, "post_id": 35532997, "comment_id": 58755233, "body": "Ah I see. how do i pattern match a list of only two elements?"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1456036698, "post_id": 35532997, "comment_id": 58755249, "body": "<code>(x:y:[])</code> will do the trick"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1456044588, "post_id": 35532997, "comment_id": 58756970, "body": "@Code-Apprentice <code>[x,y]</code> is arguably more readable."}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "edited": false, "score": 0, "creation_date": 1456111393, "post_id": 35532997, "comment_id": 58779262, "body": "<code>[x,y]</code> throws the same error"}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 0, "last_activity_date": 1456040084, "creation_date": 1456040084, "answer_id": 35533509, "question_id": 35532997, "link": "https://stackoverflow.com/questions/35532997/non-exhaustive-pattern-matching-for-list-with-minimum-3-elements/35533509#35533509", "title": "Non exhaustive pattern matching for list with minimum 3 elements", "body": "<p>What about those cases?</p>\n\n<pre><code>heathrow [x]\nheathrow [x, y]\n</code></pre>\n\n<p>Those aren't matched by neither <code>[]</code> nor <code>(x : y : z : xs)</code>. You have to match those too:</p>\n\n<pre><code>heathrow :: [Int] -&gt; [Int]\nheathrow []     = []\nheathrow [_]    = []\nheathrow [_, _] = []\nheathrow (x : y : z : zs)\n    | x &lt; y + z = heathrow (x : zs)\n    | otherwise = heathrow (z : y : zs)\n</code></pre>\n\n<p>Alternatively, you can either use guards:</p>\n\n<pre><code>heathrow xs | null (drop 2 xs) = []\nheathrow (x : y : z : zs)\n      ...\n</code></pre>\n\n<p>or move your matches:</p>\n\n<pre><code>heathrow :: [Int] -&gt; [Int]\nheathrow (x : y : z : zs)\n    | x &lt; y + z = heathrow (x : zs)\n    | otherwise = heathrow (z : y : zs)\nheathrow _ = []\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1456046919, "creation_date": 1456046919, "answer_id": 35534432, "question_id": 35532997, "link": "https://stackoverflow.com/questions/35532997/non-exhaustive-pattern-matching-for-list-with-minimum-3-elements/35534432#35534432", "title": "Non exhaustive pattern matching for list with minimum 3 elements", "body": "<p>This question can be answered by asking GHC: just enable warnings (the <code>-Wall</code> flag is enough).</p>\n\n<pre><code>Prelude&gt; :load \"ExhaustivePattern2.hs\"\n[1 of 1] Compiling ExhaustivePattern2 ( ExhaustivePattern2.hs, interpreted )\n\nExhaustivePattern2.hs:6:1: Warning:\n    Pattern match(es) are non-exhaustive\n    In an equation for \u2018heathrow\u2019:\n        Patterns not matched:\n            [_]\n            [_, _]\n</code></pre>\n\n<p>The last two lines show what shape of list we are not considering in our cases, namely the lists with exactly one or two elements.</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456046919, "creation_date": 1456035722, "last_edit_date": 1456036628, "question_id": 35532997, "link": "https://stackoverflow.com/questions/35532997/non-exhaustive-pattern-matching-for-list-with-minimum-3-elements", "title": "Non exhaustive pattern matching for list with minimum 3 elements", "body": "<p>I'm trying to solve the Heathrow-London problem <a href=\"http://learnyouahaskell.com/functionally-solving-problems\" rel=\"nofollow\">here</a>. The code compiles but when I call the function <code>heathrow</code> I get an error telling me I have <code>Non-exhaustive pattern matching</code>:</p>\n\n<pre><code>heathrow :: [Int] -&gt; [Int]\nheathrow [] = []\nheathrow (x : y : z : zs)\n    | x &lt; y + z = heathrow (x : zs)\n    | otherwise = heathrow (z : y : zs)\n</code></pre>\n\n<p>What am I doing wrong? It looks like every case is being covered.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 1, "last_activity_date": 1456035536, "last_edit_date": 1456035536, "creation_date": 1456035002, "answer_id": 35532919, "question_id": 35532807, "link": "https://stackoverflow.com/questions/35532807/how-can-i-do-tojson-for-maybe/35532919#35532919", "title": "How can I do ToJSON for Maybe?", "body": "<p>You can reuse the <code>ToJSON</code> instance of <code>Maybe a</code>.</p>\n\n<pre><code>data MyData = MyData {\n  id        :: Int,\n  something :: Maybe String\n}\n\ninstance ToJSON MyData where\n  toJSON (MyData id something) =\n    object [\"id\" .= id\n      , \"something\" .= toJSON something\n    ]\n</code></pre>\n\n<p>And as <a href=\"http://hackage.haskell.org/package/aeson-0.11.0.0/docs/Data-Aeson.html\" rel=\"nofollow\">the documentation</a> suggests, you can let the compiler derive an instance for you. The derived instance is exactly the same as the one above.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n\nimport GHC.Generics\nimport Data.Aeson\nimport Data.Aeson.TH\n\ndata MyData = MyData {\n  id        :: Int,\n  something :: Maybe String\n} deriving (Generic, Show)\n\ninstance ToJSON MyData where\n  toJSON = genericToJSON defaultOptions\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 35532919, "answer_count": 1, "score": 0, "last_activity_date": 1456035536, "creation_date": 1456033988, "question_id": 35532807, "link": "https://stackoverflow.com/questions/35532807/how-can-i-do-tojson-for-maybe", "title": "How can I do ToJSON for Maybe?", "body": "<p>How can I do ToJSON for Maybe?</p>\n\n<pre><code>data MyData = MyData {\n  id :: Int,\n  something :: Maybe String\n}\n\ninstance ToJSON MyData where\n  toJSON (MyData id something) =\n    object [\"id\" .= id\n      , \"something\" .= ???\n    ]\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "chinese-remainder-theorem"], "answers": [{"comments": [{"owner": {"reputation": 729, "user_id": 4296407, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5b6394226433412b0d1ad46bb0318b28?s=128&d=identicon&r=PG&f=1", "display_name": "JMV12", "link": "https://stackoverflow.com/users/4296407/jmv12"}, "edited": false, "score": 0, "creation_date": 1456004730, "post_id": 35529381, "comment_id": 58748345, "body": "I need to create a function with crt :: [(Integer, Integer)] -&gt; (Integer, Integer) and I cannot import any outside data."}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 5, "last_activity_date": 1456004388, "creation_date": 1456004388, "answer_id": 35529381, "question_id": 35529211, "link": "https://stackoverflow.com/questions/35529211/chinese-remainder-theorem-haskell/35529381#35529381", "title": "Chinese Remainder Theorem Haskell", "body": "<p>Chinese remainder theorem has an <a href=\"https://en.wikipedia.org/wiki/Chinese_remainder_theorem#An_algebraic_approach\" rel=\"noreferrer\"><strong>algebraic solution</strong></a>, based on the fact that <code>x = r1 % m1</code> and <code>x = r2 % m2</code> can be reduced to one modular equation if <code>m1</code> and <code>m2</code> are <a href=\"https://en.wikipedia.org/wiki/Coprime_integers\" rel=\"noreferrer\"><strong>coprime</strong></a>.</p>\n\n<p>To do so you need to know what <a href=\"https://en.wikipedia.org/wiki/Modular_multiplicative_inverse\" rel=\"noreferrer\"><strong>modular inverse</strong></a> is and how it can efficiently be calculated using <a href=\"https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm\" rel=\"noreferrer\"><strong>extended Euclidean algorithm</strong></a>.</p>\n\n<p>If you put these pieces together, you can solve Chinese remainder theorem with a <a href=\"https://wiki.haskell.org/Fold\" rel=\"noreferrer\"><strong>right fold</strong></a>:</p>\n\n<pre><code>crt :: (Integral a, Foldable t) =&gt; t (a, a) -&gt; (a, a)\ncrt = foldr go (0, 1)\n    where\n    go (r1, m1) (r2, m2) = (r `mod` m, m)\n        where\n        r = r2 + m2 * (r1 - r2) * (m2 `inv` m1)\n        m = m2 * m1\n\n    -- Modular Inverse\n    a `inv` m = let (_, i, _) = gcd a m in i `mod` m\n\n    -- Extended Euclidean Algorithm\n    gcd 0 b = (b, 0, 1)\n    gcd a b = (g, t - (b `div` a) * s, s)\n        where (g, s, t) = gcd (b `mod` a) a\n</code></pre>\n\n<p>then:</p>\n\n<pre><code>\\&gt; crt [(2,7), (0,3), (1,5)]\n(51,105)\n\\&gt; crt [(2,3), (3,4), (1,5)]  -- wiki example\n(11,60)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 729, "user_id": 4296407, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5b6394226433412b0d1ad46bb0318b28?s=128&d=identicon&r=PG&f=1", "display_name": "JMV12", "link": "https://stackoverflow.com/users/4296407/jmv12"}, "edited": false, "score": 0, "creation_date": 1456006069, "post_id": 35529657, "comment_id": 58748865, "body": "Yes, this is what I need to do, I&#39;m just stuck on how I execute this."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 729, "user_id": 4296407, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5b6394226433412b0d1ad46bb0318b28?s=128&d=identicon&r=PG&f=1", "display_name": "JMV12", "link": "https://stackoverflow.com/users/4296407/jmv12"}, "edited": false, "score": 1, "creation_date": 1456006308, "post_id": 35529657, "comment_id": 58748943, "body": "In order to solve, first you have to understand the problem.  I would suggest do this manually for a two elements first, perhaps three and then open <code>ghci</code> and interactively implement the steps either I suggested or any other way you come up with.  After then, try to implement the general case..."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1456079308, "last_edit_date": 1456079308, "creation_date": 1456005980, "answer_id": 35529657, "question_id": 35529211, "link": "https://stackoverflow.com/questions/35529211/chinese-remainder-theorem-haskell/35529657#35529657", "title": "Chinese Remainder Theorem Haskell", "body": "<p>Without going into algebra, you can also solve this with brute force.  Perhaps that's what you've been asked to do.  </p>\n\n<p>For your example, create a list for each mod independent of the other two (upper bound will be least common multiple of the mod, assuming they are co-prime as a precondition, product, i.e. 105).  These three list should have one common element which will satisfy all constraints.</p>\n\n<pre><code>m3 = [3,6,9,12,15,...,105]\nm5 = [6,11,16,21,...,101]\nm7 = [9,16,23,30,...,100]\n</code></pre>\n\n<p>you can use <code>Data.Set</code> to find the intersection of these lists.  Now, extend this logic to n number of terms using recursion or fold.</p>\n\n<p><strong>Update</strong>\nPerhaps an easier approach is defining a filter to create a sequence with a fixed remainder for a modulus and repeatedly apply for the given pairs</p>\n\n<pre><code>Prelude&gt; let rm (r,m) = filter (\\x -&gt; x `mod` m == r)       \n</code></pre>\n\n<p>verify that it works,</p>\n\n<pre><code>Prelude&gt; take 10 $ rm (1,5) [1..]                                               \n[1,6,11,16,21,26,31,36,41,46]\n</code></pre>\n\n<p>now, for the given example use it repeatedly,</p>\n\n<pre><code>Prelude&gt; take 3 $ rm (1,5) $ rm (0,3) $ rm (2,7) [1..]        \n[51,156,261]\n</code></pre>\n\n<p>of course we just need the first element, change to head instead</p>\n\n<pre><code>Prelude&gt; head $ rm (1,5) $ rm (0,3) $ rm (2,7) [1..]       \n51\n</code></pre>\n\n<p>which we can generalize with fold</p>\n\n<pre><code>Prelude&gt; head $ foldr rm [1..] [(1,5),(0,3),(2,7)]                            \n51\n</code></pre>\n"}], "owner": {"reputation": 729, "user_id": 4296407, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5b6394226433412b0d1ad46bb0318b28?s=128&d=identicon&r=PG&f=1", "display_name": "JMV12", "link": "https://stackoverflow.com/users/4296407/jmv12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1456079308, "creation_date": 1456003334, "question_id": 35529211, "link": "https://stackoverflow.com/questions/35529211/chinese-remainder-theorem-haskell", "title": "Chinese Remainder Theorem Haskell", "body": "<p>I need to write a function or functions in Haskell that can solve the Chinese Remainder Theorem. It needs to be created with the following definition:</p>\n\n<pre><code>crt :: [(Integer, Integer)] -&gt; (Integer, Integer)\n</code></pre>\n\n<p>That the answer looks like</p>\n\n<pre><code>&gt;crt [(2,7), (0,3), (1,5)]\n(51, 105)\n</code></pre>\n\n<p>I think I have the overall idea, I just don't have the knowledge to write it. I know that the crt function must be recursive. I have created a helper function to split the list of tuples into a tuple of two lists:</p>\n\n<pre><code>crtSplit xs = (map fst xs, product(map snd xs))\n</code></pre>\n\n<p>Which, in this example, gives me:</p>\n\n<pre><code>([2,0,1],105)\n</code></pre>\n\n<p>I think what I need to do know is create a list for each of the elements in the first list. How would I begin to do this?</p>\n"}, {"tags": ["haskell", "algebraic-data-types", "gadt"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1456002942, "post_id": 35529015, "comment_id": 58747742, "body": "check <a href=\"http://hackage.haskell.org/package/HDBC-2.4.0.1/docs/src/Database-HDBC-SqlValue.html#line-201\" rel=\"nofollow noreferrer\"><code>sqlValue</code></a> from <code>DataBase.HDBC</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1492, "user_id": 1091396, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YtJY5.gif?s=128&g=1", "display_name": "ymg", "link": "https://stackoverflow.com/users/1091396/ymg"}, "edited": false, "score": 0, "creation_date": 1456003843, "post_id": 35529269, "comment_id": 58748050, "body": "Thanks, I get it now. Indeed what I wanted to do is form a type that would handle one of the certain primitive types. Again thanks for the detailed answer."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1456003626, "creation_date": 1456003626, "answer_id": 35529269, "question_id": 35529015, "link": "https://stackoverflow.com/questions/35529015/data-type-without-input-value-and-multiple-primitive-types/35529269#35529269", "title": "Data type without input value and multiple primitive types", "body": "<p>Actually, your type <em>does</em> have value constructors -- three of them, in fact, named <code>Nothing</code>, <code>Int</code>, and <code>Float</code>. So, one could write, for example</p>\n\n<pre><code>main = putStrLn (jaykay Int)\n</code></pre>\n\n<p>and running the program would print out <code>This is an int</code>. However, I suspect that you wanted your constructors to accept arguments of the related types; so you <em>probably</em> wanted to write something like</p>\n\n<pre><code>data TestType = Nothing | Int Int | Float Float\n</code></pre>\n\n<p>so that values of type <code>TestType</code> constructed with the <code>Int</code> constructor would contain an additional value of type <code>Int</code>; and likewise those constructed with the <code>Float</code> constructor would contain a value of type <code>Float</code>. (N.B. there are two separate namespaces here! There is a type-level name <code>Int</code> which comes from the <code>Prelude</code> and you have now also defined a value-level <code>Int</code> whose type is <code>Int -&gt; TestType</code>.)</p>\n\n<p>An example of using this more exciting new data type would be this:</p>\n\n<pre><code>jaykay (Int i) = \"got the Int \" ++ show i\njaykay (Float f) = \"got the Float \" ++ show f\njaykay a = \"dunno lol\"\n\nmain = putStrLn (jaykay (Int 3))\n</code></pre>\n\n<p>Running this program would print out <code>got the Int 3</code>.</p>\n"}], "owner": {"reputation": 1492, "user_id": 1091396, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YtJY5.gif?s=128&g=1", "display_name": "ymg", "link": "https://stackoverflow.com/users/1091396/ymg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 35529269, "answer_count": 1, "score": 0, "last_activity_date": 1456003626, "creation_date": 1456002362, "question_id": 35529015, "link": "https://stackoverflow.com/questions/35529015/data-type-without-input-value-and-multiple-primitive-types", "title": "Data type without input value and multiple primitive types", "body": "<p>Firstly, I'd like to apologize if I'm repeating this but I searched everywhere without finding an answer to my question.</p>\n\n<p>Suppose I have the following code:</p>\n\n<pre><code>data TestType = Nothing | Int | Float deriving (Show)\n\njaykay :: TestType -&gt; [Char]\njaykay Int = \"This is an int\"\njaykay Float = \"This is float!\"\njaykay a = \"Nothing matched..\"\n\nmain :: IO()\nmain = do\n  jaykay [PLACE HOLDER]\n</code></pre>\n\n<p>Clearly this type does not have any value constructor(s). So what I thought I could do here is create a type from primitive types that would normally hold any values of the specified ones in the definition right? My question is about how would I construct an instance of this type and also if this definition isn't correct how would I achieve what I described earlier?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 5446, "user_id": 196429, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0df62a310a2cf98d043c3f21e1889cee?s=128&d=identicon&r=PG", "display_name": "sircolinton", "link": "https://stackoverflow.com/users/196429/sircolinton"}, "edited": false, "score": 0, "creation_date": 1456007931, "post_id": 35529208, "comment_id": 58749416, "body": "Thanks! This is what I was looking for. I had previously encountered <code>forAll</code>, but hadn&#39;t properly appreciated it. My efforts were mostly misdirected towards a <code>coarbitrary</code> solution."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 4, "last_activity_date": 1456003325, "creation_date": 1456003325, "answer_id": 35529208, "question_id": 35528777, "link": "https://stackoverflow.com/questions/35528777/quickcheck-produce-arbitrary-elements-of-an-arbitrary-set/35529208#35529208", "title": "Quickcheck: produce arbitrary elements of an arbitrary set", "body": "<p>It depends on what generators you have available. For example, if you already have <code>setOf1</code> (generates a <code>Set</code> with at least one element) and <code>setElements</code> (takes elements from a <code>Set</code>), it can be written with <code>forAll</code>:</p>\n\n<pre><code>-- example implementations of both combinators\nsetOf1 :: (Arbitrary a, Ord a) =&gt; Gen a -&gt; Gen (Set a)\nsetOf1 = fmap fromList . listOf1\n\nsetElements :: Set a -&gt; Gen a\nsetElements = elements . toList\n\nprop_delete =\n  forAll (setOf1 arbitrary)   $ \\theSet -&gt;\n  forAll (setElements theSet) $ \\x -&gt;\n    not (member (x :: Int) (delete x theSet))\n</code></pre>\n\n<p>This is mostly the same as <code>SetAndElement</code>, but instead of a fixed <code>data</code> type, we're using re-usable functions that can be used for further tests:</p>\n\n<pre><code>prop_null =  forAll (setOf1 (arbitrary :: Gen Integer)) $ not . null\n</code></pre>\n\n<p>However, even if you don't write <code>setOf1</code> or <code>setElements</code>, <code>forAll</code> can be rather succinct for simple tests:</p>\n\n<pre><code>prop_delete :: (Arbitrary a, Ord a) =&gt; (NonEmptyList a) -&gt; Property\nprop_delete (NonEmpty xs) =\n  let theSet = fromList xs\n  in forAll (elements xs) $ \\x -&gt;\n      not (member x (delete x theSet))\n</code></pre>\n\n<p>If you provide <code>setElements</code> and <code>NonEmptySet</code>, this can be written as</p>\n\n<pre><code>newtype NonEmptySet x = NonEmptySet {getNonEmptySet :: Set a}\n\ninstance (Ord a, Arbitray a) =&gt; Arbitrary (NonEmptySet a) where\n  arbitrary = fmap NonEmptySet . setOf1 $ arbitrary\n\nprop_delete :: (Arbitrary a, Ord a) =&gt; (NonEmptySet a) -&gt; Property\nprop_delete (NonEmptySet theSet) =\n  forAll (setElements theSet) $ \\x -&gt;\n    not (member x (delete x theSet))\n</code></pre>\n\n<p>That way you can use <code>NonEmptySet</code> for tests that require a non-empty set, and <code>setElements</code> only for those where you actually need to choose an element at random.</p>\n"}], "owner": {"reputation": 5446, "user_id": 196429, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0df62a310a2cf98d043c3f21e1889cee?s=128&d=identicon&r=PG", "display_name": "sircolinton", "link": "https://stackoverflow.com/users/196429/sircolinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 35529208, "answer_count": 1, "score": 4, "last_activity_date": 1456003325, "creation_date": 1456001041, "question_id": 35528777, "link": "https://stackoverflow.com/questions/35528777/quickcheck-produce-arbitrary-elements-of-an-arbitrary-set", "title": "Quickcheck: produce arbitrary elements of an arbitrary set", "body": "<p>Suppose that I am writing tests for <code>Data.Set</code>. I would like to check that deleting elements from the set works, and so I might write something like this:</p>\n\n<pre><code>prop_deleteA it x = member x it ==&gt; not (member x (delete x it))\n</code></pre>\n\n<p>assuming that <code>it</code> has a suitable <code>Arbitrary</code> instance. However, this relies on quickcheck generating values of <code>x</code> that happen to exist within the set, which is not in general guaranteed. It would be much better if <code>x</code> could be made to depend on <code>it</code> so as to guarantee that <code>x</code> is already a member of <code>it</code>. How might I do this?</p>\n\n<p>I had the thought that I could write</p>\n\n<pre><code>prop_deleteB it f = let x = f it\n                   in not (member x (delete x it))\n</code></pre>\n\n<p>where <code>f :: Set a -&gt; a</code> is suitably defined by means of coarbitrary. However, coarbitrary would only allow us to define <code>f :: Set a -&gt; b</code>, which unfortunately isn't what we want. My best thought so far has been to define a new type</p>\n\n<pre><code>data SetAndElement a = SetAndElement (Set a) a\n</code></pre>\n\n<p>which allows us to write a suitable <code>Arbitrary</code> instance</p>\n\n<pre><code>instance (Ord a, Arbitrary a) =&gt; Arbitrary (SetAndElement a) where\n    arbitrary = do it &lt;- suchThat arbitrary (not . Set.null)\n                   x  &lt;- elements (elems it)\n                   return (SetAndElement it x)\n</code></pre>\n\n<p>allowing <code>prop_delete</code> to be written as</p>\n\n<pre><code>prop_deleteC (SetAndElement it x) = not (member x (delete x it))\n</code></pre>\n\n<p>This works, but seems a little involved; are there any better options? (If not, I'll modify the question and put this as an answer.) The actual <code>Data.Set</code> implementation (containers package) tests deletion by checking that <code>(delete x) . (insert x) == id</code> if <code>x</code> was not already a member of the given set.</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 1, "creation_date": 1455997053, "post_id": 35527483, "comment_id": 58745480, "body": "This looks very reminiscent of extensible effects. <a href=\"https://hackage.haskell.org/package/free-vl\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/free-vl</a> has an implementation and references to papers that explain it."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 5, "creation_date": 1456005962, "post_id": 35527483, "comment_id": 58748828, "body": "&quot;so we need n^2 instance declarations&quot; this is a well known problem with the mtl style of monad transformers. If you write your type as <code>ReaderT String m r</code> instead, you can use generalized newtype deriving to derive those instances which are identical to the ones for reader (which seems like most of them here). You can replace most of the instances with <code>MonadTrans t, HasUserTable m =&gt; HasUserTable (t m)</code> but this sort of kills type inference, and requires several extensions."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1456073423, "post_id": 35527483, "comment_id": 58766478, "body": "@user2407038 the problem with using a generalized <code>MonadTrans t, HasUserTable m=&gt;HasUserTable (t m)</code> was that it applied to UserTableT also, conflicting with the proper instance that I needed to write.  I suspect that this is why the n^2 problem exists at all (otherwise they would have just done this for all monad transformers).  I think your comment on the n^2 problem might be the answer to my question, although not a happy one....  You can&#39;t do anything better with monad transformers, and perhaps even Haskell.  I you have a reference discussing this problem, I&#39;d accept that as the answer."}], "answers": [{"comments": [{"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 1, "creation_date": 1456107502, "post_id": 35541483, "comment_id": 58778268, "body": "Thanks for the clarification and pointer to extensible-effects.  I&#39;ll definitely have a look at extensible-effects, although I now consider this question solved, since multiple people have pointed out that the n^2 problem is real, and an ongoing research problem in the Haskell community.  FWIW, in my opinion this is a very important problem to solve (unless extensible-effect has already solved it), probably one of the only big issues that I have come across in Haskell."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 1, "creation_date": 1456125716, "post_id": 35541483, "comment_id": 58784052, "body": "Well, as always, it&#39;s a trade-off. Monad transformers are certainly simpler than <code>extensible-effects</code> (and simpler still is rolling-your-own), and in practice the price you pay in flexibility is actually not that steep, as I alluded to in my answer. And effect typing is optional to start with - most languages conveniently don&#39;t force it on you like Haskell does, and we&#39;ve been surprisingly productive as an industry for 50 years without it!"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 12, "last_activity_date": 1456138609, "last_edit_date": 1456138609, "creation_date": 1456085801, "answer_id": 35541483, "question_id": 35527483, "link": "https://stackoverflow.com/questions/35527483/writing-a-monad-transformer-does-it-really-need-so-many-hardcoded-instances/35541483#35541483", "title": "Writing a Monad Transformer, does it really need so many hardcoded instances", "body": "<p>Yep, that's one of the problems with monad transformers: when you add a new transformer, you have to write an ever-increasing number of boilerplate instances. It's <em>n</em> instances each time, for a total of <em>O(n^2)</em> instances. You can observe this scaling issue <a href=\"https://github.com/ekmett/mtl/blob/master/Control/Monad/Reader/Class.hs#L127-L175\" rel=\"noreferrer\">in the <code>mtl</code> source code</a>, for example. Monad transformers are not readily extensible.</p>\n\n<p>Now, a good percentage of the monads we use on a daily basis can be expressed as some combination of the transformers provided by <code>mtl</code>, which means that someone else has already done the work of writing all of those boring instances. But those transformers certainly don't cover <em>every</em> monad, and you'll get bitten whenever you need to write your own.</p>\n\n<p>That's why there's ongoing effort being put into devising new approaches to effect typing. A good example in Haskell is Kiselyov et al's <a href=\"https://hackage.haskell.org/package/extensible-effects\" rel=\"noreferrer\"><code>extensible-effects</code> library</a>, which takes an algebraic approach to effect typing, based on <em>free monads</em>. The design of this library is described in two articles: <a href=\"https://www.cs.indiana.edu/~sabry/papers/exteff.pdf\" rel=\"noreferrer\"><em>An Alternative to Monad Transformers</em></a>, which spends some time describing problems with the <code>mtl</code> approach, and <a href=\"http://okmij.org/ftp/Haskell/extensible/more.pdf\" rel=\"noreferrer\"><em>More Extensible Effects</em></a>, describing an updated and optimised implementation of the library.</p>\n\n<p>If you want to see how far safe and extensible effect typing can be taken, see Edwin Brady's <a href=\"http://www.idris-lang.org/documentation/effects/\" rel=\"noreferrer\"><code>effects</code> library</a> for the Idris language. There exist quite a lot of resources explaining <code>effects</code>: a <a href=\"https://eb.host.cs.st-andrews.ac.uk/drafts/eff-tutorial.pdf\" rel=\"noreferrer\">tutorial</a>, the original <a href=\"https://eb.host.cs.st-andrews.ac.uk/drafts/effects.pdf\" rel=\"noreferrer\"><em>Programming and Reasoning with Algebraic Effects</em></a> article, and <a href=\"https://eb.host.cs.st-andrews.ac.uk/drafts/dep-eff.pdf\" rel=\"noreferrer\"><em>Resource-dependent Algebraic Effects</em></a> describing some newer features of <code>effects</code>. There's probably some more resources that I've forgotten in this list.</p>\n"}], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 974, "favorite_count": 3, "accepted_answer_id": 35541483, "answer_count": 1, "score": 12, "last_activity_date": 1456138609, "creation_date": 1455993939, "last_edit_date": 1456086614, "question_id": 35527483, "link": "https://stackoverflow.com/questions/35527483/writing-a-monad-transformer-does-it-really-need-so-many-hardcoded-instances", "title": "Writing a Monad Transformer, does it really need so many hardcoded instances", "body": "<p>I am a long time monad transformer user, first time monad transformer writer....  And I feel like I've done something unnecessary.</p>\n\n<p>We are working on a project that has multiple DB tables, and hardcoding the set into different monad stacks was becoming unwieldy, so we decided to break it into different pluggable monad transformers, allowing us to pick and choose at the function type level, like this</p>\n\n<pre><code>doSomething::(HasUserTable m, HasProductTable m)=&gt;Int-&gt;m String\n</code></pre>\n\n<p>(HasXTable is the class, XTableT is the concrete monad transformer).  These separate monad transformers could be inserted or removed in a fully modular fashion, and would store the DB handles, require ResourceT, etc....</p>\n\n<p>My first attempt was to just wrap around ReaderT, which would be used to hold the DB handle.  It became immediately apparent that this would not work, as ReaderT (and StateT, etc) can not be stacked without using chains of hardcoded \"lift\"s, thus breaking the pluggable modularity of the stack elements.</p>\n\n<p>The only solution seemed to be to write completely separate copies of the ReaderT monad, each allowing access to the others at a lower level.  This works, but the solution is filled with boilerplate code, something like this</p>\n\n<pre><code>class HasUserTable m where\n    getUser::String-&gt;m User\n\nnewtype UserTableT m r = UserTableT{runUserTableT::String-&gt;m r}\n\n--Standard monad instance stuff, biolerplate copy of ReaderT\ninstance Functor m=&gt;Functor (UserTableT m) where....\ninstance Applicative m=&gt;Applicative (UserTableT m) where....\ninstance Monad m=&gt;Monad (UserTableT m) where....\ninstance Monad m=&gt;HasUserTable (UserTableT m) where....\n\n--Gotta hardcode passthrough rules to every other monad transformer\n--in the world, mostly using \"lift\"....\ninstance MonadTrans BlockCacheT where....\ninstance (HasUserTable m, Monad m)=&gt;HasUserTable (StateT a m)....\ninstance (HasUserTable m, Monad m)=&gt;HasUserTable (ResourceT m)....\n.... etc for all other monad transformers\n\n--Similarly, need to hardcode passthrough rules for all other monads\n--through the newly created one\ninstance MonadResource m=&gt;MonadResource (UserTableT m) where....\ninstance MonadState a m=&gt;MonadState a (UserTableT m) where....\ninstance (MonadBaseControl IO m) =&gt; MonadBaseControl IO (UserTableT m)....\n.... etc for all other monad transformers\n</code></pre>\n\n<p>What makes this even worse is that we need to add even more passthrough rules for each new monad transformer we add (ie- each new table we add needs to passthrough all the other table monad transformers, so we need n^2 instance declarations!)</p>\n\n<p>Is there a cleaner way to do this?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1455985763, "post_id": 35525799, "comment_id": 58741105, "body": "well you read the arguments in <code>main</code> with <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/System-Environment.html#v:getArgs\" rel=\"nofollow noreferrer\"><code>getArgs</code></a> and pass them around - if you want to get fancy you can use Read/StateMonad(Transformers) etc. - what you cannot do of course is to use constant values in your module - for anything more you have to be more specific as this question is really to broad"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456000320, "post_id": 35525799, "comment_id": 58746741, "body": "Some functional languages (but not Haskell) offer first-class modules that can be initialized with dynamic bindings."}, {"owner": {"reputation": 1, "user_id": 5955880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa53849c25b9fddbce58697a514c44e1?s=128&d=identicon&r=PG&f=1", "display_name": "olp", "link": "https://stackoverflow.com/users/5955880/olp"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1456000675, "post_id": 35525799, "comment_id": 58746865, "body": "@Carsten You were right, I edited my post to have more specific questioning."}, {"owner": {"reputation": 1, "user_id": 5955880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa53849c25b9fddbce58697a514c44e1?s=128&d=identicon&r=PG&f=1", "display_name": "olp", "link": "https://stackoverflow.com/users/5955880/olp"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456000799, "post_id": 35525799, "comment_id": 58746907, "body": "@dfeuer Can you please give an example, I would really like to take a look at these language."}, {"owner": {"reputation": 1, "user_id": 5955880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa53849c25b9fddbce58697a514c44e1?s=128&d=identicon&r=PG&f=1", "display_name": "olp", "link": "https://stackoverflow.com/users/5955880/olp"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456002366, "post_id": 35525799, "comment_id": 58747532, "body": "@dfeuer Ok, I take a look at OCaml, thanks to make me discover this feature."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1456010771, "post_id": 35525799, "comment_id": 58750209, "body": "I first saw the feature in Moscow ML. I think it may also show up in Agda and possibly Racket, but I&#39;m not sure."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5955880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa53849c25b9fddbce58697a514c44e1?s=128&d=identicon&r=PG&f=1", "display_name": "olp", "link": "https://stackoverflow.com/users/5955880/olp"}, "edited": false, "score": 0, "creation_date": 1456000572, "post_id": 35526688, "comment_id": 58746823, "body": "Thanks for your answer. As you say, there is no way to make options global late initialized constant ? The problem with the monad Reader is that I don&#39;t really understand it very well, but the signature is even though longer, because it has to be in the returned type. And what about location of data in memory ? (I edited my post to be more accurate)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1, "user_id": 5955880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa53849c25b9fddbce58697a514c44e1?s=128&d=identicon&r=PG&f=1", "display_name": "olp", "link": "https://stackoverflow.com/users/5955880/olp"}, "edited": false, "score": 0, "creation_date": 1456000804, "post_id": 35526688, "comment_id": 58746910, "body": "@olp I&#39;m sorry, but even after you ask the same question with different words, the answer is the same."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1455989793, "creation_date": 1455989793, "answer_id": 35526688, "question_id": 35525799, "link": "https://stackoverflow.com/questions/35525799/module-initialization-in-functional-programing/35526688#35526688", "title": "Module initialization in functional programing", "body": "<p>If the behavior of your program depends on the arguments used on the command line, there is simply no way to hide that fact -- it will have to appear in the types of your program's components. The simplest way is to write</p>\n\n<pre><code>data Options = {- ... -}\n\ndoMyProgram :: Options -&gt; IO ()\nmyModule'sConstantA :: Options -&gt; A\nmyModule'sConstantB :: Options -&gt; B\n</code></pre>\n\n<p>giving <code>Options</code> as an argument to any operation or value which depends on it. Fancy designs often also define a custom monad <code>M</code> for the program that includes a <code>MonadReader Options M</code> instance to reduce the size of type signatures.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5617054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d24a4100b3eab34d8ce3059d789c543?s=128&d=identicon&r=PG", "display_name": "Sandy Maguire", "link": "https://stackoverflow.com/users/5617054/sandy-maguire"}, "is_accepted": false, "score": 0, "last_activity_date": 1456035478, "creation_date": 1456035478, "answer_id": 35532968, "question_id": 35525799, "link": "https://stackoverflow.com/questions/35525799/module-initialization-in-functional-programing/35532968#35532968", "title": "Module initialization in functional programing", "body": "<p>Strictly speaking, it's not <em>impossible</em> so much as <em>probably shouldn't be done</em>. </p>\n\n<pre><code>import System.Environment\nimport System.IO.Unsafe\n\nfirstArg :: String\nfirstArg = head $ unsafePerformIO getArgs\n{-# NOINLINE firstArg #-}\n\nmain = putStrLn firstArg\n</code></pre>\n\n<p>Please note how many times the word \"unsafe\" appears in that six line snippet.</p>\n\n<p>It's dirty and gross, but IMO, there are a few valid uses cases of this paradigm, and global constant initialization is one of them. I use it to load level files in my games, for example.</p>\n"}], "owner": {"reputation": 1, "user_id": 5955880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa53849c25b9fddbce58697a514c44e1?s=128&d=identicon&r=PG&f=1", "display_name": "olp", "link": "https://stackoverflow.com/users/5955880/olp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1456035478, "creation_date": 1455985367, "last_edit_date": 1455999990, "question_id": 35525799, "link": "https://stackoverflow.com/questions/35525799/module-initialization-in-functional-programing", "title": "Module initialization in functional programing", "body": "<p>In a project, I use a module containing global (constant once initialized) stuffs that I use in the rest of the project. I choose to put them into a module to avoid a lot of arguments passing. The problem is that this module have to be initialized at run-time with the argument of the program execution.</p>\n\n<p>How could this be done in a functional paradigm, in a langage like Haskell for example ? </p>\n\n<p>Edit:</p>\n\n<p>To be more precise, I code my project in an imperative language (Ada), that's why I can use a module containing variables initialized at run-time, and then used as global constants (with inlined getter). However, being interested in functional programming, I wonder how to obtain the same result in this paradigm; I mean to have light signatures all over the rest of the code (using global constant), module data localized in the data section of memory, even be able to initialize different \"constants\" of the module separately, etc.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 548, "user_id": 5069373, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/684f313653e6ae98c35615feb7e4e05d?s=128&d=identicon&r=PG&f=1", "display_name": "dijam", "link": "https://stackoverflow.com/users/5069373/dijam"}, "edited": false, "score": 0, "creation_date": 1455980528, "post_id": 35524907, "comment_id": 58739278, "body": "Doesn&#39;t mention adding lists using cons so [x] : []"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1455980734, "post_id": 35524907, "comment_id": 58739347, "body": "The type of <code>:</code> is <code>a -&gt; [a] -&gt; [a]</code>. So you cannot pass a list in front of it. Something like this will work <code>x:[]</code>. If you really want to add two lists, then <code>++</code> is the operator you are looking for."}, {"owner": {"reputation": 548, "user_id": 5069373, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/684f313653e6ae98c35615feb7e4e05d?s=128&d=identicon&r=PG&f=1", "display_name": "dijam", "link": "https://stackoverflow.com/users/5069373/dijam"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1455981020, "post_id": 35524907, "comment_id": 58739453, "body": "Compile the code I have supplied it compiles perfectly however I am confused why [x]:foo xs works?"}, {"owner": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "edited": false, "score": 0, "creation_date": 1455981314, "post_id": 35524907, "comment_id": 58739560, "body": "Its just a list of lists isn&#39;t it? It even says so in the type declaration. So what happens is if you in put [1, 2, 3] into foo you get [1] : [2] : [3] : [] which is perfectly fine. Imagine [a] being the element and &quot;[[a]]&quot; being your list."}, {"owner": {"reputation": 548, "user_id": 5069373, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/684f313653e6ae98c35615feb7e4e05d?s=128&d=identicon&r=PG&f=1", "display_name": "dijam", "link": "https://stackoverflow.com/users/5069373/dijam"}, "edited": false, "score": 0, "creation_date": 1455981412, "post_id": 35524907, "comment_id": 58739605, "body": "So why cant you do [1] : [1,2,3]"}, {"owner": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "edited": false, "score": 2, "creation_date": 1455981480, "post_id": 35524907, "comment_id": 58739637, "body": "because [1] is different from 1. [[1], 1, 2, 3] or does that look like the elements of the list have the same type? what your trying to do is list concatenation with (++)"}, {"owner": {"reputation": 548, "user_id": 5069373, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/684f313653e6ae98c35615feb7e4e05d?s=128&d=identicon&r=PG&f=1", "display_name": "dijam", "link": "https://stackoverflow.com/users/5069373/dijam"}, "edited": false, "score": 0, "creation_date": 1455981544, "post_id": 35524907, "comment_id": 58739660, "body": "Great thanks I wanted to understand : operator?"}, {"owner": {"reputation": 1579, "user_id": 3979919, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/H11F1.jpg?s=128&g=1", "display_name": "Nima Mousavi", "link": "https://stackoverflow.com/users/3979919/nima-mousavi"}, "edited": false, "score": 0, "creation_date": 1455981618, "post_id": 35524907, "comment_id": 58739681, "body": "<a href=\"https://en.wikipedia.org/wiki/Persistent_data_structure\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Persistent_data_structure</a> maybe you should read through this. Combined with the knowledge that haskell is strongly and statically typed it explains a lot."}], "owner": {"reputation": 548, "user_id": 5069373, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/684f313653e6ae98c35615feb7e4e05d?s=128&d=identicon&r=PG&f=1", "display_name": "dijam", "link": "https://stackoverflow.com/users/5069373/dijam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "closed_date": 1455980352, "answer_count": 0, "score": 2, "last_activity_date": 1455981247, "creation_date": 1455980203, "last_edit_date": 1455981247, "question_id": 35524907, "link": "https://stackoverflow.com/questions/35524907/cons-operator-adding-list-to-empty-list-xfoo-xs", "closed_reason": "Duplicate", "title": "Cons operator (:) adding list to empty list - [x]:foo xs", "body": "<p>The cons operator is used to add elements to a list so <code>1:2:[]</code> would equal <code>[1,2]</code> however why does the following code work then;</p>\n\n<pre><code>foo :: [a] -&gt; [[a]]\nfoo [] = []\nfoo (x:xs) = [x]:foo xs\n</code></pre>\n\n<p>Here we are adding <code>[x]</code> to foo xs which will evaluate to <code>[]</code> so essentially in the end it would be <code>[x]:[]</code> which is allowed in Haskell. But [x]:[1,2,3] isn't allowed why is this?</p>\n"}, {"tags": ["haskell", "functor"], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1455979072, "last_edit_date": 1455979072, "creation_date": 1455978163, "answer_id": 35524543, "question_id": 35524320, "link": "https://stackoverflow.com/questions/35524320/functorial-structure-of-functions/35524543#35524543", "title": "Functorial structure of functions", "body": "<p>Your reasoning is absolutely right - now you just have to think what this means for your functor instance.</p>\n\n<p>Usually your <em>functor</em>s <code>f</code> <code>fmap</code> type is like this:</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; (f a -&gt; f b)\n</code></pre>\n\n<p>but now you have <code>(-&gt;) r</code> (you can think of this as <code>r -&gt; *</code>) instead of <code>f</code></p>\n\n<p>so if you just fill this in you get:</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; ((r -&gt; a) -&gt; (r -&gt; b))\n</code></pre>\n\n<p>and if you read this carefully this means that given a function <code>g :: a -&gt; b</code> <code>fmap g</code> will be able to <em>transform</em> a function <code>f :: r -&gt; a</code> into a function <code>fmap g f :: r -&gt; b</code></p>\n\n<hr>\n\n<p>The functor instance for <code>(-&gt;) r</code> looks like this:</p>\n\n<pre><code>instance Functor ((-&gt;) r) where\n   fmap g f = \\ r -&gt; g (f r) -- = g . f\n</code></pre>\n\n<p>it's a bit strange when you see it the first time but it's basically just function composition (or if you like the source-type is constant and you fmap the result of applying your function)</p>\n\n<p>so in the example you get:</p>\n\n<pre><code>fmap (+1) (+1)\n{ def. (+1) }\n= fmap (+1) (\\r -&gt; r+1)\n{ fmap here }\n= \\r -&gt; (+1) (r+1)\n{ definition (+1) }\n= \\r -&gt; (\\a -&gt; a+1) (r+1)\n{ lambda application }\n= \\r -&gt; (r+1) + 1\n= (+1) . (+1) -- if you like\n{ which is the same as }\n= \\r -&gt; r+2\n= (+2) -- if you like\n</code></pre>\n\n<p>so you get a function that adds 2 to the result.</p>\n\n<p>But you will probably see more if you look at </p>\n\n<pre><code>fmap (*2) (+1)\n{ def. (+1) }\n= fmap (*2) (\\r -&gt; r+1)\n{ fmap here }\n= \\r -&gt; (*2) (r+1)\n{ definition (*2) }\n= \\r -&gt; (\\a -&gt; a*2) (r+1)\n{ lambda application }\n= \\r -&gt; (r+1) * 2\n= \\r -&gt; r*2+2\n= (*2) . (+1) -- if you like\n</code></pre>\n\n<p>so you see</p>\n\n<pre><code>fmap g f = g . f\n</code></pre>\n\n<hr>\n\n<p>by the way you can have a look at the <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/src/GHC.Base.html#line-614\" rel=\"nofollow\">Implementation</a> itself if you click on the <strong>source</strong> link in the <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#t:Functor\" rel=\"nofollow\">hackage doc</a></p>\n\n<p>there it's just</p>\n\n<pre><code>instance Functor ((-&gt;) r) where\n    fmap = (.)\n</code></pre>\n"}], "owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 35524543, "answer_count": 1, "score": 3, "last_activity_date": 1455979072, "creation_date": 1455976905, "question_id": 35524320, "link": "https://stackoverflow.com/questions/35524320/functorial-structure-of-functions", "title": "Functorial structure of functions", "body": "<p>I'm having difficulties understanding the functorial structure of functions.</p>\n\n<p>I think I have a clue with ghci:</p>\n\n<pre><code>Prelude&gt; :t (-&gt;)\n(-&gt;) :: * -&gt; * -&gt; *\n</code></pre>\n\n<p>So if feeded a type, applying on it (->) will have desired kind * -> *, which is ok for Functor definition.</p>\n\n<p>However I cannot find the reason why we can write:</p>\n\n<pre><code>Prelude&gt; let test = fmap (+1) (+1)\nPrelude&gt; :t test\ntest :: Integer -&gt; Integer\n</code></pre>\n\n<p>What is the functor instance used when dealing with (->) ? What does it look like ?</p>\n\n<p>What does it do ? I mean I don't understand the effect of the first (+1) onto the second function (+1)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1455970673, "post_id": 35523067, "comment_id": 58735919, "body": "why you are not using <a href=\"http://hackage.haskell.org/package/bytestring-0.10.6.0/docs/Data-ByteString-Char8.html#v:hGetContents\" rel=\"nofollow noreferrer\"><code>hGetContents</code></a>? if you want to read the <i>entire</i> file (<code>hFileSize handle</code>) and then close the handle (<code>hClose handle</code>) why are you using <code>ByteString.Lazy</code>?"}, {"owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1455971021, "post_id": 35523067, "comment_id": 58736025, "body": "@behzad.nouri In my actual code, I also write to the file. Also, <code>Binary</code> only works with lazy bytestrings."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1455981681, "post_id": 35523067, "comment_id": 58739701, "body": "It seems like you already have the answer in your question - eliminate excess laziness by using strict functions and datatypes, like <code>foldl1&#39;</code> instead of <code>foldl1</code>. This has very little to do with copying, most likely, more with excess laziness. If you want to make sure some value is evaluated at most once, for example <code>map (T.foldl1 max) msgs</code>, you should assign it to a variable - the compiler doesn&#39;t, in general, perform such optimizations by itself. The value will be evaluated the first time it is used, and never again."}], "owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455970279, "creation_date": 1455970279, "question_id": 35523067, "link": "https://stackoverflow.com/questions/35523067/large-memory-overhead-of-decoding-text-objects", "title": "Large memory overhead of decoding Text objects", "body": "<p>I'm doing some <code>Binary</code> serializing and deserializing of <code>Text</code> objects, and I noticed that an un-decoded thunk uses <strong>much</strong> more memory than the actual length of the data. I've created a toy program that reproduces the problem (see <a href=\"https://gist.github.com/danielkeller/c19a740fc2b0df861343\" rel=\"nofollow\">this gist</a> for the complete setup):</p>\n\n<pre><code>import qualified Data.ByteString.Lazy as B\nimport qualified Data.Text as T\n\nmain = do\n    handle &lt;- openBinaryFile \"testfile\" ReadMode\n    initSize &lt;- hFileSize handle\n    str &lt;- B.hGet handle (fromInteger initSize)\n    hClose handle\n    --msgs :: [T.Text]\n    let (_, msgs) = decodeMany str\n    --here we fool the GC into retaining the thunks in msgs\n    chr &lt;- readLn\n    print $ map (max chr) $ map (T.foldl1 max) msgs\n    --now we let it collect them\n    num1 &lt;- readLn\n    print (num1 + 1)\n</code></pre>\n\n<p>and when I run it:</p>\n\n<pre><code>$ ./Test2 +RTS -S\n    Alloc    Copied     Live    GC    GC     TOT     TOT  Page Flts\n    bytes     bytes     bytes  user  elap    user    elap\n   108112      6936     82320  0.00  0.01    0.01    0.33    0    0  (Gen:  1)\n     1720      6152     73400  0.00  0.00    0.02    0.66    0    0  (Gen:  1)\n't'\n   874672     28544    408856  0.00  0.00    0.02    4.14    0    0  (Gen:  0) **\n   519864     33200    434680  0.00  0.00    0.02    4.14    0    0  (Gen:  0) **\n\"vxvxvvvxvxvvvxvxvvvxvxvvvxvxvvvxvxvvx\"\n    95504      8424     83680  0.00  0.00    0.02    4.45    0    0  (Gen:  1)\n8\n9\n    30992      6984     65824  0.00  0.00    0.02    6.48    0    0  (Gen:  1)\n</code></pre>\n\n<p>So it takes over 300k (see <code>**</code> marked lines) to store 18k of text. (I've checked the heap profile, and they're mostly <code>ARR_WORDS</code>.)</p>\n\n<p>On the other hand, if I replace <code>T.foldl1</code> with <code>T.foldl1'</code>, the garbage collector is able to reclaim the thunks, and the marked lines become</p>\n\n<pre><code>   781336      8432     83680  0.00  0.00    0.02    6.48    0    0  (Gen:  1)\n</code></pre>\n\n<p>So it allocates about as much, but reclaims it once the <code>Text</code> objects have been forced. I imagine some combination of the way I do i/o and the types I use causes it to make a full copy of the file for every decoded string (since 37 strings * 18k = 666k).</p>\n\n<p><strong>How do I keep the decoding process from allocating and retaining so much memory?</strong></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1455958551, "post_id": 35520919, "comment_id": 58732176, "body": "You are almost there. The only problem is you want to compute <code>z &lt;- x</code> and <code>i &lt;- [1..length x]</code> not in nested way but in parallel / side by side,  which is not supported by list comprehension on default. You may enable the language pragma <code>ParallelListComp</code> and try <code>addindex x = [(i,z) | z &lt;- x | i &lt;-[1..length x]]</code>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1455966498, "post_id": 35520919, "comment_id": 58734626, "body": "Note that you can just write <code>zip myList [0..]</code> because <code>zip</code> will automatically truncate the list to the shorter length."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 5, "last_activity_date": 1455958724, "last_edit_date": 1455958724, "creation_date": 1455957815, "answer_id": 35520957, "question_id": 35520919, "link": "https://stackoverflow.com/questions/35520919/add-index-to-tuples/35520957#35520957", "title": "Add index to tuples", "body": "<p>so your question is how to implement <code>zip</code>?</p>\n\n<p>Depending on the way you want to deal with different length lists (Haskell just ignores if one is longer and stops at the shorters length) it's all about finding the right pattern match:</p>\n\n<pre><code>myZip _  []         = []\nmyZip [] _          = []\nmyZip (x:xs) (x:ys) = (x,y) : myZip xs ys\n</code></pre>\n\n<p>(try to implement this if you will)</p>\n\n<p>now you can easily bring this do what you wanted (by using <code>[1..]</code> as one of the lists - you don't need the <code>length</code> the way this is working here and in the prelude)</p>\n\n<hr>\n\n<p><strong>btw</strong>: I would have be surprised if you manage to get this working with a list comprehension (at least without zip itself in there in some form)</p>\n\n<hr>\n\n<h3>remark</h3>\n\n<p>while this is a good exercise to learn about pattern-matching and recursion you will not really do this in your real-life code</p>\n\n<p>you would use just what you started with</p>\n\n<pre><code>addIndexs xs = zip [1..] xs\n</code></pre>\n\n<p>instead - note that you don't need the first case you added - it's included ;)</p>\n"}, {"tags": [], "owner": {"reputation": 548, "user_id": 5069373, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/684f313653e6ae98c35615feb7e4e05d?s=128&d=identicon&r=PG&f=1", "display_name": "dijam", "link": "https://stackoverflow.com/users/5069373/dijam"}, "is_accepted": false, "score": 3, "last_activity_date": 1455958844, "last_edit_date": 1455958844, "creation_date": 1455958748, "answer_id": 35521106, "question_id": 35520919, "link": "https://stackoverflow.com/questions/35520919/add-index-to-tuples/35521106#35521106", "title": "Add index to tuples", "body": "<pre><code>addIndexs :: [Int] -&gt; [(Int,Int)]\naddIndexs [] = []\naddIndexs x = myZip x [1..]\n\nmyZip :: [a] -&gt; [a] -&gt; [(a,a)]\nmyZip xs []         = []\nmyZip [] ys         = []\nmyZip (x:xs) (y:ys) = (x,y) : myZip xs ys\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1456075571, "last_edit_date": 1456075571, "creation_date": 1456032898, "answer_id": 35532707, "question_id": 35520919, "link": "https://stackoverflow.com/questions/35520919/add-index-to-tuples/35532707#35532707", "title": "Add index to tuples", "body": "<p>I would suggest you use the following:</p>\n\n<pre><code>mapWithIndex :: (Int -&gt; a -&gt; b) -&gt; [a] -&gt; [b]\nmapWithIndex = go 0 where\n  go i f [] = ?\n  go i f (x : xs) = ?\n</code></pre>\n\n<p>Now if you'd like to make this work well with GHC's list fusion optimizations, you'll need to rewrite it using <code>foldr</code> and <code>build</code>. While some aspects would have to be modified (rewrite to/from), the gist is</p>\n\n<pre><code>mapWithIndex f xs = build mi where\n  mi c n = foldr (\\x r !i -&gt; f i x `c` r (i + 1)) n xs 0\n{-# INLINE mapWithIndex #-}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57, "user_id": 4025777, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ddff241d0e00e4b7d9e503f0813a84ec?s=128&d=identicon&r=PG", "display_name": "Superdids", "link": "https://stackoverflow.com/users/4025777/superdids"}, "is_accepted": false, "score": 0, "last_activity_date": 1456071233, "creation_date": 1456071233, "answer_id": 35538478, "question_id": 35520919, "link": "https://stackoverflow.com/questions/35520919/add-index-to-tuples/35538478#35538478", "title": "Add index to tuples", "body": "<p>Simple example without using the zip-function:</p>\n\n<pre><code>addIndexs :: [Int] -&gt; [(Int,Int)]\naddIndexs [] = []\naddIndexs xs = pairs 0 xs --first element will be indexed with 0.\n\npairs :: Int -&gt; [Int] -&gt; [(Int,Int)]\npairs n [x] = [(n,x)]\npairs n (x:xs) = (n,x):pairs (n+1) xs\n</code></pre>\n\n<p>Examples of usage:</p>\n\n<pre><code>&gt; addIndexes [1] \n[(0,1)]\n&gt; addIndexes [8,9,10,1]\n[(0,8),(1,9),(2,10),(3,1)]\n</code></pre>\n\n<p>In most cases, I would recommend you to use existing functions as long as you understand them. It is, however, a very good practice to implement existing functions on your own! </p>\n\n<p>-Superdids</p>\n"}], "owner": {"reputation": 548, "user_id": 5069373, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/684f313653e6ae98c35615feb7e4e05d?s=128&d=identicon&r=PG&f=1", "display_name": "dijam", "link": "https://stackoverflow.com/users/5069373/dijam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 1, "answer_count": 4, "score": 1, "last_activity_date": 1456075571, "creation_date": 1455957507, "question_id": 35520919, "link": "https://stackoverflow.com/questions/35520919/add-index-to-tuples", "title": "Add index to tuples", "body": "<p>I have a function <code>addIndex [1,2,3] = [(0,1),(1,2),(2,3)]</code> which should add an index to each pair I am having trouble implementing this. Here what I have done;</p>\n\n<pre><code>addIndexs :: [Int] -&gt; [(Int,Int)]\naddIndexs [] = []\naddIndexs x = zip x [1..length x]\n</code></pre>\n\n<p>I am able to implement it using zip put I feel its cheating, I want to be able to implement it without using any pre build functions.</p>\n\n<p>The closest I have got without using pre build function is </p>\n\n<pre><code>addindex x = [(i,z) | z &lt;- x, i &lt;-[1..length x]]\n</code></pre>\n\n<p>however this add all index to each tuples so </p>\n\n<pre><code>addIndex [1,2,3] = [(0,1),(1,1),(2,1),(0,2),(1,2),(2,2)...]\n</code></pre>\n\n<p>I am just a beginner.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1456173420, "post_id": 35519762, "comment_id": 58814814, "body": "<a href=\"https://hackage.haskell.org/package/checkers\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/checkers</a>"}], "answers": [{"comments": [{"owner": {"reputation": 16267, "user_id": 1346276, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Tu8Re.jpg?s=128&g=1", "display_name": "phipsgabler", "link": "https://stackoverflow.com/users/1346276/phipsgabler"}, "edited": false, "score": 0, "creation_date": 1456132538, "post_id": 35520220, "comment_id": 58787732, "body": "Maybe <a href=\"https://github.com/ucsd-progsys/liquidhaskell/blob/61b4ab6d27b33c9579d58afaf815e34b92cc10b7/tests/equationalproofs/todo/MonadicLaws.hs\" rel=\"nofollow noreferrer\">liquidhaskell</a> will be able to do that, too -- but I can&#39;t judge how far they are yet."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 3, "last_activity_date": 1455951742, "creation_date": 1455951742, "answer_id": 35520220, "question_id": 35519762, "link": "https://stackoverflow.com/questions/35519762/tools-for-testing-functors-applicatives-and-monads/35520220#35520220", "title": "Tools for testing Functors, Applicatives and Monads?", "body": "<blockquote>\n  <p>But upon trying to do this manually, it turned into a daunting and quite difficult task.</p>\n</blockquote>\n\n<p>One way is to state your laws in a language like Coq and formally prove them. For example, John Wiegley proved <a href=\"https://github.com/jwiegley/coq-pipes\" rel=\"nofollow\">pipes law</a> in Coq.</p>\n\n<blockquote>\n  <p>How can I automatically test that the laws of each class are properly implemented?</p>\n</blockquote>\n\n<p>You cannot get a strong guarantee unless you prove them. Maybe you can check their property using a library like <a href=\"https://hackage.haskell.org/package/QuickCheck\" rel=\"nofollow\">Quickcheck</a>.</p>\n"}], "owner": {"reputation": 1995, "user_id": 713861, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1ed73350b722bb9ea9d5a8720a1af4f3?s=128&d=identicon&r=PG", "display_name": "GreenSaguaro", "link": "https://stackoverflow.com/users/713861/greensaguaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 35520220, "answer_count": 1, "score": 1, "last_activity_date": 1455951742, "creation_date": 1455947894, "last_edit_date": 1455948989, "question_id": 35519762, "link": "https://stackoverflow.com/questions/35519762/tools-for-testing-functors-applicatives-and-monads", "title": "Tools for testing Functors, Applicatives and Monads?", "body": "<p>I have created a type which implements Functor, Applicative and Monad. I wanted to verify that they follow the laws of each. But upon trying to do this manually, it turned into a daunting and quite difficult task.</p>\n\n<p>So, what I am wondering is:</p>\n\n<p>How can I automatically test that the laws of each class are properly implemented?</p>\n"}, {"tags": ["haskell", "proof", "proof-of-correctness"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1455964537, "post_id": 35519761, "comment_id": 58733988, "body": "I&#39;m not an expert but I don&#39;t think what you are trying to do is actually a good idea. I mean: sure do use the type system to provide some guarantees and avoid most errors, but since the logics is unsound you cannot achieve what you actually want. If you are looking for formally correct code you could use (e.g.) Coq and then extract programs from it."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 3, "creation_date": 1455964594, "post_id": 35519761, "comment_id": 58734016, "body": "In any case questions asking about finding a tool/resource ecc. are <i>off topic</i> for stackoverflow. You should probably ask this on some mailing list/subreddit or stuff like that."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1455985264, "post_id": 35519761, "comment_id": 58740915, "body": "Andy Gill had a student working in this and Levent had recently released a tool that does something similar."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1456000434, "post_id": 35519761, "comment_id": 58746781, "body": "Also, you might be interested in Liquid Haskell."}, {"owner": {"reputation": 11, "user_id": 5954252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a36639a9c957d597c3bb6a2bb5451249?s=128&d=identicon&r=PG&f=1", "display_name": "\u0410\u0445\u043c\u0435\u0434 \u041a\u0440\u043e\u043d\u0448\u0442\u0435\u0439\u043d", "link": "https://stackoverflow.com/users/5954252/%d0%90%d1%85%d0%bc%d0%b5%d0%b4-%d0%9a%d1%80%d0%be%d0%bd%d1%88%d1%82%d0%b5%d0%b9%d0%bd"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1456099555, "post_id": 35519761, "comment_id": 58776383, "body": "@Bakuriu sorry this post is off topic. Should i delete it?"}, {"owner": {"reputation": 11, "user_id": 5954252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a36639a9c957d597c3bb6a2bb5451249?s=128&d=identicon&r=PG&f=1", "display_name": "\u0410\u0445\u043c\u0435\u0434 \u041a\u0440\u043e\u043d\u0448\u0442\u0435\u0439\u043d", "link": "https://stackoverflow.com/users/5954252/%d0%90%d1%85%d0%bc%d0%b5%d0%b4-%d0%9a%d1%80%d0%be%d0%bd%d1%88%d1%82%d0%b5%d0%b9%d0%bd"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1456099789, "post_id": 35519761, "comment_id": 58776436, "body": "@ThomasM.DuBuisson Thanks, that tool by Levent seems like what i want."}], "owner": {"reputation": 11, "user_id": 5954252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a36639a9c957d597c3bb6a2bb5451249?s=128&d=identicon&r=PG&f=1", "display_name": "\u0410\u0445\u043c\u0435\u0434 \u041a\u0440\u043e\u043d\u0448\u0442\u0435\u0439\u043d", "link": "https://stackoverflow.com/users/5954252/%d0%90%d1%85%d0%bc%d0%b5%d0%b4-%d0%9a%d1%80%d0%be%d0%bd%d1%88%d1%82%d0%b5%d0%b9%d0%bd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455947882, "creation_date": 1455947882, "question_id": 35519761, "link": "https://stackoverflow.com/questions/35519761/is-there-a-tool-to-check-proofs-of-haskell-code-properties", "title": "Is there a tool to check proofs of haskell code properties?", "body": "<p>There are ways (for example, <a href=\"https://jeltsch.wordpress.com/2012/04/30/dependently-typed-programming-and-theorem-proving-in-haskell/\" rel=\"nofollow\">https://jeltsch.wordpress.com/2012/04/30/dependently-typed-programming-and-theorem-proving-in-haskell/</a>, PromotedDataKinds extension) to fake dependent types in haskell, and this makes it possible to prove some code properties in haskell itself.</p>\n\n<p>Examples of properties I may want proved include totality of some function or monad laws for somr Monad typeclass instance.</p>\n\n<p>Such a proof would be a value (a::T) where T represents the statement we've proved. Unfortunately, in haskell we can write terms of false type, e. g. (fix id::forall a.a), so we can actually prove everything. Is there  a tool to check proof correctness or monad laws satisfaction in haskell? \nDoes anybody include proofs in source code? </p>\n"}, {"tags": ["haskell", "dependent-type", "idris"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455945220, "post_id": 35519299, "comment_id": 58729045, "body": "I&#39;m not too familiar with Idris but it is certainly possible. I took a quick glance at the <a href=\"https://github.com/idris-lang/Idris-dev/tree/master/libs/prelude/Prelude\" rel=\"nofollow noreferrer\">stdlib</a> - the first would be something like <code>f : (n m : Nat) -&gt; { isLT : Prelude.Nat.LT n m } -&gt; X</code> and the second <code>g : (x : String) (xs : List String) -&gt; { in : Prelude.List.elem x xs = True } -&gt; Y</code>. (where the <code>=</code> is propositional equality, not sure the symbol Idris uses for this?) There are perhaps other, better encodings, but these ones work with just the stdlib."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455949621, "post_id": 35519299, "comment_id": 58730067, "body": "@user2407038, <a href=\"http://docs.idris-lang.org/en/latest/tutorial/miscellany.html\" rel=\"nofollow noreferrer\">it&#39;s</a> <code>{auto isLT : Prelude.Nat.LT n m}</code> and <code>{auto in : Prelude.List.elem x xs = True}</code>."}, {"owner": {"reputation": 385, "user_id": 5725848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1086e1b40cdecc9467217bd45406c126?s=128&d=identicon&r=PG&f=1", "display_name": "44701", "link": "https://stackoverflow.com/users/5725848/44701"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455950758, "post_id": 35519299, "comment_id": 58730311, "body": "This is great @user2407038 I notice that when I do <code>f 50 100</code> everything is fine. But when I do <code>f 500 1000</code> it states that it cannot find a solution. I assume that is because it is brute forcing something? Is there a way to have the same result I want that works for larger numbers?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455952530, "post_id": 35519299, "comment_id": 58730766, "body": "@HarpoRoeder When you write <code>{auto ...}</code> - according to the very useful link provided by another commenter - &quot;If they have arguments, it will search recursively up to a maximum depth of 100.&quot;. You can simply supply the proof yourself, instead of relying on <code>auto</code>. <code>auto</code> will aso try &quot;Any function with the appropriate return type which is marked with the %hint annotation.&quot; so you could try that (still have to write the proof yourself). Again, not too familiar with idris - especially such details."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1455953801, "post_id": 35519299, "comment_id": 58731072, "body": "@Harpo Roeder, try something like <code>{auto isLT : So (n &lt; m)}</code>. More on <code>So</code> <a href=\"http://stackoverflow.com/questions/33270639/so-whats-the-point\">here</a>."}, {"owner": {"reputation": 385, "user_id": 5725848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1086e1b40cdecc9467217bd45406c126?s=128&d=identicon&r=PG&f=1", "display_name": "44701", "link": "https://stackoverflow.com/users/5725848/44701"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1455954381, "post_id": 35519299, "comment_id": 58731197, "body": "@user3237465 this one seems to work for larger numbers than the other ones. It takes a while to solve though. I am not familiar with how to write a hint, and the doc does not seem to say much. How would I go about writing a hint so that this is works for more general cases?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1455955041, "post_id": 35519299, "comment_id": 58731355, "body": "@Harpo Roeder, I don&#39;t know about <code>%hint</code> stuff. More generally, you can write a predicate <code>p : SomeType1 -&gt; SomeType2 -&gt; ... -&gt; SomeTypen -&gt; Bool</code> and use it like this: <code>{auto satisfies : So (p someValue1 someValue2 ... someValuen)}</code>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455999442, "post_id": 35523295, "comment_id": 58746447, "body": "Whoops! Sorry! I didn&#39;t realize."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 14, "last_activity_date": 1456250015, "last_edit_date": 1495539973, "creation_date": 1455971533, "answer_id": 35523295, "question_id": 35519299, "link": "https://stackoverflow.com/questions/35519299/limits-of-dependent-typing-in-idris/35523295#35523295", "title": "Limits of dependent typing in Idris", "body": "<p><a href=\"https://stackoverflow.com/questions/33270639/so-whats-the-point\">I'm not especially fond of <code>So</code></a>, or indeed of having avoidable proof-terms running around in programs at all. It's more satisfying to weave your expectations into the fabric of the data itself. I'm going to write down a type for \"natural numbers smaller than <code>n</code>\".</p>\n\n<pre><code>data Fin : Nat -&gt; Set where\n  FZ : Fin (S n)\n  FS : Fin n -&gt; Fin (S n)\n</code></pre>\n\n<p><code>Fin</code> is a number-like data type - compare the shape of <code>FS (FS FZ)</code> with that of the natural number <code>S (S Z)</code> - but with some additional type-level structure. Why's it called <code>Fin</code>? There are precisely <code>n</code> unique members of the type <code>Fin n</code>; <code>Fin</code> is thus the family of <em>finite sets</em>.</p>\n\n<p>I mean it: <code>Fin</code> really is a sort of number.</p>\n\n<pre><code>natToFin : (n : Nat) -&gt; Fin (S n)\nnatToFin Z = FZ\nnatToFin (S k) = FS (natToFin k)\n\nfinToNat : Fin n -&gt; Nat\nfinToNat FZ = Z\nfinToNat (FS i) = S (finToNat i)\n</code></pre>\n\n<p>Here's the point: a <code>Fin n</code> value must be smaller than its <code>n</code>.</p>\n\n<pre><code>two : Fin 3\ntwo = FS (FS FZ)\ntwo' : Fin 4\ntwo' = FS (FS FZ)\nbadTwo : Fin 2\nbadTwo = FS (FS FZ)  -- Type mismatch between Fin (S n) (Type of FZ) and Fin 0 (Expected type)\n</code></pre>\n\n<p>While we're at it, there aren't any numbers less than zero. That is to say, <code>Fin Z</code>, a set with a cardinality of 0, is an empty set.</p>\n\n<pre><code>Uninhabited (Fin Z) where\n  uninhabited FZ impossible\n  uninhabited (FS _) impossible\n</code></pre>\n\n<p>If you have a number that's less than <code>n</code>, then it's certainly less than <code>S n</code>. We thus have a way of loosening the upper bound on a <code>Fin</code>:</p>\n\n<pre><code>weaken : Fin n -&gt; Fin (S n)\nweaken FZ = FZ\nweaken (FS x) = FS (weaken x)\n</code></pre>\n\n<p>We can also go the other way, using the type checker to automatically find the tightest possible bound on a given <code>Fin</code>.</p>\n\n<pre><code>strengthen : (i : Fin n) -&gt; Fin (S (finToNat i))\nstrengthen FZ = FZ\nstrengthen (FS x) = FS (strengthen x)\n</code></pre>\n\n<p>One can safely define subtraction of <code>Fin</code> numbers from <code>Nat</code> numbers that are larger. We can also express the fact that the result won't be any bigger than the input.</p>\n\n<pre><code>(-) : (n : Nat) -&gt; Fin (S n) -&gt; Fin (S n)\nn - FZ = natToFin n\n(S n) - (FS m) = weaken (n - m)\n</code></pre>\n\n<hr>\n\n<p>That all works, but there's a problem: <code>weaken</code> works by rebuilding its argument in O(n) time, and we're applying it at every recursive call of <code>-</code>, yielding an O(n^2) algorithm for subtraction. How embarrassing! <code>weaken</code> is only really there to help type-checking, but it has a drastic effect on the asymptotic time complexity of the code. Can we get away without weakening the result of the recursive call?</p>\n\n<p>Well, we had to call <code>weaken</code> because every time we encounter an <code>S</code>, the difference between the result and the bound grows. Instead of forcefully yanking the value up to the correct type, we can close the gap by gently pulling the type down to meet it.</p>\n\n<pre><code>(-) : (n : Nat) -&gt; (i : Fin (S n)) -&gt; Fin (S (n `sub` finToNat i))\nn - FZ = natToFin n\n(S n) - (FS i) = n - i\n</code></pre>\n\n<p>This type is inspired by our success in tightening a <code>Fin</code>'s bound with <code>strengthen</code>. The bound on the result of <code>-</code> is exactly as tight as it needs to be.</p>\n\n<p><code>sub</code>, which I used in the type, is subtraction of natural numbers. The fact that it truncates at zero needn't trouble us, because the type of <code>-</code> ensures that it'll never actually happen. (This function can be found in the <code>Prelude</code> under the name of <code>minus</code>.)</p>\n\n<pre><code>sub : Nat -&gt; Nat -&gt; Nat\nsub n Z = n\nsub Z m = Z\nsub (S n) (S m) = sub n m\n</code></pre>\n\n<p>The lesson to be learned here is this. At first, building some correctness properties into our data caused an asymptotic slowdown. We could've given up on making promises about the return value and gone back to an untyped version, but in fact <a href=\"https://allisonmaruska.files.wordpress.com/2015/10/we-need-to-go-deeper.jpg\" rel=\"nofollow noreferrer\">giving the type checker <em>more</em> information</a> allowed us to get where we were going without making sacrifices.</p>\n"}, {"tags": [], "owner": {"reputation": 1635, "user_id": 2254489, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b9c417017130602fd4561958e6840a2c?s=128&d=identicon&r=PG", "display_name": "Sventimir", "link": "https://stackoverflow.com/users/2254489/sventimir"}, "is_accepted": false, "score": 0, "last_activity_date": 1562406596, "creation_date": 1562406596, "answer_id": 56912967, "question_id": 35519299, "link": "https://stackoverflow.com/questions/35519299/limits-of-dependent-typing-in-idris/56912967#56912967", "title": "Limits of dependent typing in Idris", "body": "<p><code>So</code> is a very general thing, that allows you to \"lift\" any boolean condition to the type level. This generality has its price though, which is that such proofs are (at least in my experience) harder to construct and more expensive to compute.</p>\n\n<p>Instead it's usually better to create yourself a specialised proof type, which allows you to express only a certain type of condition, but in a simpler manner, yielding proofs that are cleaner and easier to construct. Idris standard library is full of such specialized proof types (or rather type families). Sure enough, it already contains those that you're concerned about here.</p>\n\n<pre><code>||| Proofs that `n` is less than or equal to `m`\n||| @ n the smaller number\n||| @ m the larger number\ndata LTE  : (n, m : Nat) -&gt; Type where\n  ||| Zero is the smallest Nat\n  LTEZero : LTE Z    right\n  ||| If n &lt;= m, then n + 1 &lt;= m + 1\n  LTESucc : LTE left right -&gt; LTE (S left) (S right)\n</code></pre>\n\n<p>(from <code>Prelude.Nat</code>)</p>\n\n<p>A term of type <code>LTE x y</code> represents a proof that <code>x</code> is not larger than <code>y</code> (note that it works only for <code>Nat</code>s, because it relies on the very internal structure of that type). <code>LTEZero</code> does not require any arguments since <code>Z</code> is never larger than any <code>Nat</code> (including <code>Z</code> itself). You are free to construct such proofs at will. For other numbers you can prove the <code>LTE</code> relation by induction (given the rule that <code>LTE x y</code> implies <code>LTE (S x) (S y)</code>). By deconstructing your arguments, you'll finally arrive at a moment when one of them is <code>Z</code>. If it's the left one, then you're done by stating that <code>Z</code> is less than or equal anything, if it's the right one, sorry, your assumption was false and therefore you won't be able to construct your proof.</p>\n\n<pre><code>maybeLTE : (n, m : Nat) -&gt; Maybe (LTE n m)\nmaybeLTE Z _ = Just LTEZero\nmaybeLTE _ Z = Nothing\nmaybeLTE (S n) (S m) = map LTESucc $ maybeLTE n m\n</code></pre>\n\n<p>Note how this construction does not rely on any external notion of ordering. Instead, this very type <em>defines</em> what does it mean for a <code>Nat</code> to be less than or equal to another <code>Nat</code>. The two constructors (along with the type <code>Nat</code> itself) can be thought of as axioms of a theory, from which you can derive your proofs. Let's look at the types of these constructors again:</p>\n\n<p><code>LTEZero : LTE Z right</code> states that <code>Z</code> is less than or equal to <code>right</code> <em>for all</em> <code>right</code>s.</p>\n\n<p><code>LTESucc : LTE left right -&gt; LTE (S left) (S right)</code> represents an implication: if <code>left</code> is less than or equal to <code>right</code> then <code>S left</code> is less than or equal to <code>S right</code>.</p>\n\n<p>This is Curry-Howard Isomorphism in full glory.</p>\n"}], "owner": {"reputation": 385, "user_id": 5725848, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1086e1b40cdecc9467217bd45406c126?s=128&d=identicon&r=PG&f=1", "display_name": "44701", "link": "https://stackoverflow.com/users/5725848/44701"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1036, "favorite_count": 5, "accepted_answer_id": 35523295, "answer_count": 2, "score": 7, "last_activity_date": 1562406596, "creation_date": 1455944237, "last_edit_date": 1455955860, "question_id": 35519299, "link": "https://stackoverflow.com/questions/35519299/limits-of-dependent-typing-in-idris", "title": "Limits of dependent typing in Idris", "body": "<p>I have been writing Haskell for a while now but wanted to try some experiments with the Idris language, and dependent typing. I have played around a bit, and read the basic doc, however I want to express a certain style of function, and do not know how / if it is possible.</p>\n\n<p>Here are a couple of examples of what I wish to know whether or not can be expressed:</p>\n\n<p>first: a function that takes two natural numbers but only type checks if the first is smaller than the other. So <code>f : Nat -&gt; Nat -&gt; whatever</code> where nat1 is smaller than nat2. The idea is that if a called like <code>f 5 10</code> it would work, but if I called it like <code>f 10 5</code> it would fail to type check.</p>\n\n<p>second: a function that takes a string and a list of strings that only type checks if the first string is in the list of strings.</p>\n\n<p>Are functions like this possible in Idris? If so how would you implement one of the simple examples noted? Thanks!</p>\n\n<p>EDIT:</p>\n\n<p>With the help of several users the following solution functions have been written:</p>\n\n<pre><code>module Main\n\nimport Data.So\n\nf : (n : Nat) -&gt; (m : Nat) -&gt; {auto isLT : So (n &lt; m)} -&gt; Int\nf _ _ = 50\n\ng : (x : String) -&gt; (xs : List String) -&gt; {auto inIt : So (elem x xs)} -&gt; Int\ng x xs = 52\n\nmain : IO ()\nmain = putStrLn $ show $ g \"hai\" [\"test\", \"yo\", \"ban\", \"hai\", \"dog\"]\n</code></pre>\n\n<p>These current solutions do not work for large cases. For example if you run f with numbers above a few thousand it takes forever (not literally). I think this is because the type checking is currently search based. One user commented that it is possible to provide a <em>hint</em> to auto by writing the proof yourself. Assuming this is what is needed how would one write such a proof for either of these simple cases? </p>\n"}, {"tags": ["haskell", "conduit"], "answers": [{"comments": [{"owner": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "edited": false, "score": 0, "creation_date": 1455941469, "post_id": 35518946, "comment_id": 58728287, "body": "But is it possible to return <code>Nothing</code> if there is no value <i>right now</i>? So the subsequent call could return <code>Just</code> again when the value is ready?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "reply_to_user": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "edited": false, "score": 1, "creation_date": 1455941833, "post_id": 35518946, "comment_id": 58728351, "body": "@AlexeyRaga Fundamentally, no it&#39;s not possible. Behind the scene Conduits works backwards: you ask a value from the final sink, the sink asks a value from the upstream conduit / source and so on. They will wait for one another. When there is no value left, the upstream will in fact pass a speical &quot;No value&quot; indicator to the downstream, so they will know they don&#39;t have to wait anymore."}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 4, "last_activity_date": 1455942023, "last_edit_date": 1455942023, "creation_date": 1455940783, "answer_id": 35518946, "question_id": 35518881, "link": "https://stackoverflow.com/questions/35518881/conduits-await-receives-maybe-why-and-how-to/35518946#35518946", "title": "Conduit&#39;s &quot;await&quot; receives Maybe. Why? And how to?", "body": "<p>Once the upstream source was exhausted, the <code>await</code> conduit will start returning <code>Nothing</code> as the result and will not return anything but <code>Nothing</code> from now on. It indicates the termination of the upstream conduit so you can do some finalization job.</p>\n\n<p>At the other end <code>yieldOr</code> indicates the termination of the downstream sink / conduit. The simple <code>yield</code> is implemented as <code>\\o -&gt; yieldOr o (return ())</code> where you can replace <code>return ()</code> with your finalization code.</p>\n\n<p>If you have no finalization job to do in this conduit then you can use <a href=\"http://hackage.haskell.org/package/conduit-1.2.6.2/docs/Data-Conduit.html#v:awaitForever\" rel=\"nofollow\"><code>awaitForever</code></a> instead.</p>\n\n<p>Quite all of the questions you may have are concluded in a tutorial written by the author of conduit package, I recommand read that first: <a href=\"https://www.schoolofhaskell.com/user/snoyberg/library-documentation/conduit-overview\" rel=\"nofollow\">Conduit Overview</a></p>\n"}], "owner": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 35518946, "answer_count": 1, "score": 0, "last_activity_date": 1455942023, "creation_date": 1455940071, "question_id": 35518881, "link": "https://stackoverflow.com/questions/35518881/conduits-await-receives-maybe-why-and-how-to", "title": "Conduit&#39;s &quot;await&quot; receives Maybe. Why? And how to?", "body": "<p>I am interested in Conduit's <code>await :: Monad m =&gt; ConduitM i o m (Maybe i)</code>.</p>\n\n<p>Can anyone explain why it happens and, in particular, how do I <code>yield</code> such an optional value or how do I write a producer/source that can do it?</p>\n"}, {"tags": ["haskell", "lazy-evaluation"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1455944438, "post_id": 35518795, "comment_id": 58728864, "body": "In short, always reduce the outermost expression, which is reducible: <code>head (repeat 3)</code> -&gt; <code>head (3:repeat 3)</code> -&gt; <code>3</code>. In the first case, <code>head</code> is not reducible because it must pattern match on its argument, but its argument is <i>not</i> a constructor. However, <code>repeat</code> does no pattern matching, so it can always be reduced. After the first reduction, <code>head</code> can now be reduced, because there is a constructor (the <code>:</code>)."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1455973848, "post_id": 35518795, "comment_id": 58737008, "body": "&quot;When the code be executed which stage it difference with call-by-value? &quot; erm... what?   Are you asking something like: <i>Assuming that instead of call-by-name we used call-by-value as strategy for passing function parameters, would this make a difference?</i> I believe that for call-by-value you actually mean eager reduction, in which case <code>repeat 3</code> is simply <code>undefined</code> and so <code>take 5 undefined = undefined</code> and the program would get stuck forever."}, {"owner": {"reputation": 2051, "user_id": 4887726, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/381a9c57be405fa215c388f62ed7ddf7?s=128&d=identicon&r=PG&f=1", "display_name": "LoranceChen", "link": "https://stackoverflow.com/users/4887726/lorancechen"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1455983915, "post_id": 35518795, "comment_id": 58740458, "body": "@Bakuriu,you can consider call-by-name as lazy evaluation(it will be better to comprehension).call-by-value will be used when expression could be evaluation as long as complier can, of course, Haskell not use call-by-value.  I don&#39;t understand  you said <b>repeat 3 is simply undefined</b> and  which point it will be evaluated.most of other language (such as c/c++)use call-by-value, I want to know how does Haskell deal with <code>undefined</code>(repeat 3)? thanks"}], "answers": [{"comments": [{"owner": {"reputation": 2051, "user_id": 4887726, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/381a9c57be405fa215c388f62ed7ddf7?s=128&d=identicon&r=PG&f=1", "display_name": "LoranceChen", "link": "https://stackoverflow.com/users/4887726/lorancechen"}, "edited": false, "score": 0, "creation_date": 1455985260, "post_id": 35525366, "comment_id": 58740912, "body": "Do you mean to say <code>take</code> treated 3s as empty list at the beginning?but when <code>take</code> try access <code>repeat 3</code>,the expression wouldn&#39;t be evaluation?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 2051, "user_id": 4887726, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/381a9c57be405fa215c388f62ed7ddf7?s=128&d=identicon&r=PG&f=1", "display_name": "LoranceChen", "link": "https://stackoverflow.com/users/4887726/lorancechen"}, "edited": false, "score": 0, "creation_date": 1455986301, "post_id": 35525366, "comment_id": 58741304, "body": "It never treats <code>(repeat&#39; 3)</code> as an empty list; rather, it never looks at anything other than the head at any point in time. The unevaluated tail is passed to the recursive calls."}, {"owner": {"reputation": 2051, "user_id": 4887726, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/381a9c57be405fa215c388f62ed7ddf7?s=128&d=identicon&r=PG&f=1", "display_name": "LoranceChen", "link": "https://stackoverflow.com/users/4887726/lorancechen"}, "edited": false, "score": 0, "creation_date": 1456013714, "post_id": 35525366, "comment_id": 58750923, "body": "Furthermore,Which point the unevaluated tail be evaluated inner <code>take</code>?"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 2, "last_activity_date": 1456061572, "last_edit_date": 1456061572, "creation_date": 1455982818, "answer_id": 35525366, "question_id": 35518795, "link": "https://stackoverflow.com/questions/35518795/which-stage-make-difference-between-call-by-name-and-call-by-value/35525366#35525366", "title": "Which stage make difference between call-by-name and call-by-value?", "body": "<p>You get an unlimited list of 3s because typing <code>repeat' 3</code> in an interactive session essentially calls <code>show (repeat' 3)</code>, and <code>show</code> tries to iterate over the entire return value of <code>repeat' 3</code>. <code>take</code>, on the other hand, only tries to get a finite number of elements from the list. Here's a definition from the Prelude:</p>\n\n<pre><code>take n _      | n &lt;= 0 =  []\ntake _ []              =  []\ntake n (x:xs)          =  x : take (n-1) xs\n</code></pre>\n\n<p>Compare the definition of <code>repeat'</code>, <code>repeat' x = x:repeat' x</code> with the pattern matched by take. When you call <code>take 5 (repeat' 3)</code>, the last pattern applies, so it becomes <code>take 5 (3:repeat' 3) = 3 : take 4 (repeat' 3)</code>. Due to lazy evaluation, <code>repeat'</code> is only evaluated as much as necessary at any given step, which in this case means extracting the first element to match the pattern <code>x:xs</code>. Thus, <code>take</code> builds up a list of 5 3's, terminating when <code>take 0 (repeat' 3)</code> matches and the recursion terminates, ignoring the unevaluated call to <code>repeat'</code> to return an empty list.</p>\n"}], "owner": {"reputation": 2051, "user_id": 4887726, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/381a9c57be405fa215c388f62ed7ddf7?s=128&d=identicon&r=PG&f=1", "display_name": "LoranceChen", "link": "https://stackoverflow.com/users/4887726/lorancechen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 35525366, "answer_count": 1, "score": 1, "last_activity_date": 1456061572, "creation_date": 1455939188, "last_edit_date": 1455984900, "question_id": 35518795, "link": "https://stackoverflow.com/questions/35518795/which-stage-make-difference-between-call-by-name-and-call-by-value", "title": "Which stage make difference between call-by-name and call-by-value?", "body": "<p>Most of other language use call-by-value. Haskell use call-by-name (lazy evaluation), I'm wonder how does it runs and I think it will be better compare with call-by-value.  </p>\n\n<p>Take a example with the question,<br>\nthe repeat' function defined as this:</p>\n\n<pre><code>repeat' :: a -&gt; [a]   \nrepeat' x = x:repeat' x\n</code></pre>\n\n<p>use <code>repeat' 3</code> will get a unlimited list of 3,<br>\n<code>ghci&gt; repeat' 3</code> will generate 3 continuous,<br>\n but <code>take 5 (repeat' 3)</code> will just get <code>[3,3,3,3,3]</code>.<br>\nhow does the haskell know end with fifth recursion inner <code>repeat'</code> function? Besides, I don't think it's a matter of <code>take</code>.  </p>\n\n<p>When the code be executed which stage it difference with call-by-value?  </p>\n\n<p>thanks</p>\n"}, {"tags": ["haskell", "recursion", "pattern-matching", "operators"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1455924181, "post_id": 35516840, "comment_id": 58724364, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/26407535/haskell-confusing-syntax\">Haskell Confusing Syntax</a>"}], "answers": [{"tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": true, "score": 3, "last_activity_date": 1455924694, "creation_date": 1455924694, "answer_id": 35517013, "question_id": 35516840, "link": "https://stackoverflow.com/questions/35516840/what-does-the-use-of-a-colon-between-symbols-in-a-parameter-in-a-haskell-functio/35517013#35517013", "title": "What does the use of a colon between symbols in a parameter in a Haskell function definition do?", "body": "<p><code>lastButOne (x:xs)...</code> has only <strong>one</strong> parameter, as you can see from the function's type. The <code>(x:xs)</code> is a pattern which matches a list with at least one element. The first element is named <code>x</code> and the rest of the list is named <code>xs</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 431, "user_id": 5186934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aEulW.jpg?s=128&g=1", "display_name": "HandsomeGorilla", "link": "https://stackoverflow.com/users/5186934/handsomegorilla"}, "is_accepted": false, "score": 0, "last_activity_date": 1456240905, "creation_date": 1456240905, "answer_id": 35581369, "question_id": 35516840, "link": "https://stackoverflow.com/questions/35516840/what-does-the-use-of-a-colon-between-symbols-in-a-parameter-in-a-haskell-functio/35581369#35581369", "title": "What does the use of a colon between symbols in a parameter in a Haskell function definition do?", "body": "<p><strong>LIGHTBULB.</strong></p>\n\n<pre><code>lastButOne :: [a] -&gt; a\nlastButOne (x1:[x2]) = x1\nlastButOne (x:xs) = lastButOne xs\n</code></pre>\n\n<p>This code works like so:  Haskell checks the pattern <code>(x1:[x2])</code> against the object passed to <code>lastButOne</code>.  <code>(x1:[x2])</code> is a pattern matching a singleton list prepended by an item of the same type as <code>x2</code>.  A list like this <code>[1,2]</code> fits this pattern and could be written as <code>1:[2]</code>, while a list like this <code>[1,2,3]</code> does <em>not</em> fit the pattern.  Since the first pattern match fails, Haskell falls through to the 'catch-all' pattern, <code>x:xs</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 788, "user_id": 559103, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/861480630ebcb6626912c9f4818d7d5b?s=128&d=identicon&r=PG", "display_name": "j.i.h.", "link": "https://stackoverflow.com/users/559103/j-i-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1456243672, "creation_date": 1456243672, "answer_id": 35582428, "question_id": 35516840, "link": "https://stackoverflow.com/questions/35516840/what-does-the-use-of-a-colon-between-symbols-in-a-parameter-in-a-haskell-functio/35582428#35582428", "title": "What does the use of a colon between symbols in a parameter in a Haskell function definition do?", "body": "<p>The <code>:</code> operator is commonly referred to as <code>cons</code> (adopted from Lisp parlance).  <code>(x:xs)</code> is a common Haskell pattern match, where <code>(x:xs)</code> is an <code>[a]</code>, <code>x</code> is the head / first element of the list (an <code>a</code>), and <code>xs</code> is the tail / rest of the list (an <code>[a]</code> or list of <code>a</code>s).</p>\n\n<pre><code>Prelude&gt; let a = (1:2:3:[])\nPrelude&gt; let b = (1:[2,3])\nPrelude&gt; a\n[1,2,3]\nPrelude&gt; b\n[1,2,3]\n</code></pre>\n"}], "owner": {"reputation": 431, "user_id": 5186934, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aEulW.jpg?s=128&g=1", "display_name": "HandsomeGorilla", "link": "https://stackoverflow.com/users/5186934/handsomegorilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 0, "accepted_answer_id": 35517013, "answer_count": 3, "score": 1, "last_activity_date": 1456243672, "creation_date": 1455923831, "last_edit_date": 1455930454, "question_id": 35516840, "link": "https://stackoverflow.com/questions/35516840/what-does-the-use-of-a-colon-between-symbols-in-a-parameter-in-a-haskell-functio", "title": "What does the use of a colon between symbols in a parameter in a Haskell function definition do?", "body": "<p>I've been reading through <a href=\"http://book.realworldhaskell.org/read/\" rel=\"nofollow\">Real World Haskell</a> and I've come across an interesting solution to an exercise in chapter 2.</p>\n\n<p>The exercise asks the reader to construct a function that behaves similarly to Haskell's <code>drop</code>.  One <a href=\"http://haskell.elkstein.org/2009/04/solutions-for-chapter-2.html\" rel=\"nofollow\">solution</a> looks like this:</p>\n\n<pre><code>lastButOne :: [a] -&gt; a\nlastButOne (x:xs) = if length xs == 1\n                    then x\n                    else lastButOne xs\n</code></pre>\n\n<p>With an improved version looking like this:</p>\n\n<pre><code>lastButOne :: [a] -&gt; a\nlastButOne (x1:[x2]) = x1\nlastButOne (x:xs) = lastButOne xs\n</code></pre>\n\n<p>I'm having quite a bit of trouble understanding what the infix colon is doing here.  Can somebody give me an idea of how I should be reading this?</p>\n\n<p>From what I understand, <code>elem:[b]</code> tells Haskell to prepend <code>elem</code> to <code>[b]</code>.  </p>\n\n<p><strong>But</strong> let's suppose I define a function like <code>lastButOne (x:xs)</code>.  Then let's suppose I have a list <code>testCase = [p,q..r]</code>.  Would I be right in presuming that <code>lastButOne</code> would treat <code>testCase</code> as two separate objects, i.e. <code>[p]</code> and <code>[q..r]</code>?</p>\n\n<p><strong>If</strong> that's the case, the reading the first iteration of <code>lastButOne</code> feels totally intuitive.  But then I <em>still</em> don't understand how the second iteration of <code>lastButOne</code> works.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1455936630, "post_id": 35515549, "comment_id": 58727427, "body": "You wouldn&#39;t even need the type definition; it defaults to exactly what you wrote."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1455937555, "post_id": 35515549, "comment_id": 58727624, "body": "My guess: they forgot to add the instance."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1455969208, "post_id": 35515549, "comment_id": 58735437, "body": "It&#39;s intended and <a href=\"https://github.com/goldfirere/singletons/issues/106\" rel=\"nofollow noreferrer\">here&#39;s</a> the explanation. It&#39;s clear from the extended discussion that a poly-kinded <code>==</code> is bad, but it&#39;s still not quite clear to me why the <code>*</code> instance isn&#39;t included by default."}, {"owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1455977236, "post_id": 35515549, "comment_id": 58738188, "body": "@Andr&#225;sKov&#225;cs Thanks for pointed that out. But the reason is unclear to me too. If I understand correct, user&#39;s instance for <code>*</code> could be implemented for requried set of types, not for all <code>*</code>-types. Probably with better performance? Is it really important here?"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1457038452, "post_id": 35515549, "comment_id": 59236969, "body": "@DmitryOlshansky since you found the answer, you should post it and accept it so this question doesn&#39;t remain unanswered."}], "answers": [{"tags": [], "owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "is_accepted": true, "score": 0, "last_activity_date": 1457092916, "creation_date": 1457092916, "answer_id": 35795539, "question_id": 35515549, "link": "https://stackoverflow.com/questions/35515549/equality-in-singletons-for-star-kind/35795539#35795539", "title": "Equality in singletons for star kind", "body": "<p>It seems that a reason for not including instance for <code>PEq</code> for kind <code>*</code> in <code>singletons</code> are similar to not including poly-kinded instances for <code>Eq</code> in <code>base</code>. It is described <a href=\"https://github.com/ghc/ghc/blob/ad4428ddd33f80a883a268dc31f5a2ef68330161/libraries/base/Data/Type/Equality.hs#L157\" rel=\"nofollow\">here</a>. Such instance too common and if it exists we can't describe e.g. equalities of type arguments by result of type functions. For example:</p>\n\n<pre><code>Succ n == Succ m = n == m\n</code></pre>\n\n<p>For workaround in case of <code>singletons</code> one can define it:</p>\n\n<pre><code>instance PEq ('KProxy :: KProxy *)\n</code></pre>\n\n<p>Or just use it:</p>\n\n<pre><code>import Data.Singletons.TypeRepStar()\n</code></pre>\n"}], "owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 35795539, "answer_count": 1, "score": 3, "last_activity_date": 1457092916, "creation_date": 1455917946, "last_edit_date": 1495542224, "question_id": 35515549, "link": "https://stackoverflow.com/questions/35515549/equality-in-singletons-for-star-kind", "title": "Equality in singletons for star kind", "body": "<p>I did in ghci:</p>\n\n<pre><code>&gt; :set -XTypeOperators\n\n&gt; import Data.Proxy\n&gt; import Data.Type.Equality\n&gt; import Data.Singletons.Prelude\n\n&gt; :let p1 = Proxy :: Proxy (Int == Int)\n&gt; :let p2 = Proxy :: Proxy (Int :== Int)\n\n&gt; :t p1\np1 :: Proxy 'True\n&gt; :t p2\np2 :: Proxy (Int :== Int)\n</code></pre>\n\n<p>Why in the second case type is not calculated? Can I workaround it somehow? Can I make an instance for class <code>PEq</code> (where <code>:==</code> is defined)?</p>\n\n<p>(ghc 7.10.3)</p>\n\n<p>Update:\nI found how to make an instance. Are there some reasons why it is not included?</p>\n\n<pre><code>&gt; instance PEq ('KProxy :: KProxy *) where { type (:==) x y = x == y }\n</code></pre>\n\n<p>or simple (as pointed by <a href=\"https://stackoverflow.com/users/1477667/dfeuer\">dfeuer</a> in comments)</p>\n\n<pre><code>&gt; instance PEq ('KProxy :: KProxy *)\n</code></pre>\n\n<p>or import this instance from TypeRepStar:</p>\n\n<pre><code>&gt; import Data.Singletons.TypeRepStar()\n</code></pre>\n"}, {"tags": ["haskell", "odbc", "yesod"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1455909959, "post_id": 35513307, "comment_id": 58717418, "body": "See the example here: <a href=\"https://github.com/gbwey/persistent-odbc/blob/master/examples/TestODBC.hs\" rel=\"nofollow noreferrer\">github.com/gbwey/persistent-odbc/blob/master/examples/&hellip;</a> . But try avoiding ODBC if you have better interfaces."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1455910652, "post_id": 35513307, "comment_id": 58717787, "body": "@Sibi I am trying to use <code>mysql + Yesod + Windows</code>, and the only way I got was through ODBC... Why should I avoid it at all?"}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1455910748, "post_id": 35513307, "comment_id": 58717842, "body": "@Sibi By the way, I have already seen the examples, but I didn&#39;t see an integration with Yesod there, for instance, implementing YesodPersist"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1455914558, "post_id": 35513307, "comment_id": 58719865, "body": "It&#39;s just a library. There is no need for special integration needed with Yesod. You can simply plug-in and use it. I feel that <code>persistent-sqlite</code> is much better maintained by the community that the ODBC interface."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1455918937, "post_id": 35513307, "comment_id": 58722124, "body": "@Sibi I would like to see an example"}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1456003642, "post_id": 35513307, "comment_id": 58747977, "body": "I don&#39;t use ODBC or Windows, but I don&#39;t see why you couldn&#39;t just use <code>persistent-mysql</code>."}, {"owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "reply_to_user": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1456059858, "post_id": 35513307, "comment_id": 58761500, "body": "@MaxGabriel Because on windows 8+ it doesn&#39;t compile. I don&#39;t use windows at all, but unfortunally I will need to instal the server on Windows."}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1456086172, "post_id": 35513307, "comment_id": 58771672, "body": "Hm, maybe file an issue about persistent-MySQL not compiling?"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 184, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1455909697, "creation_date": 1455909697, "question_id": 35513307, "link": "https://stackoverflow.com/questions/35513307/yesod-database-persist-odbc-integration", "title": "Yesod Database.Persist.ODBC integration", "body": "<p>How can we use <code>Yesod</code> with <code>persistent-odbc</code>? For instance the <a href=\"http://www.yesodweb.com/book/persistent\" rel=\"nofollow\">following code</a> is for using Yesod with Sqlite:</p>\n\n<pre><code>{-# LANGUAGE EmptyDataDecls             #-}\n{-# LANGUAGE FlexibleContexts           #-}\n{-# LANGUAGE GADTs                      #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE MultiParamTypeClasses      #-}\n{-# LANGUAGE OverloadedStrings          #-}\n{-# LANGUAGE QuasiQuotes                #-}\n{-# LANGUAGE TemplateHaskell            #-}\n{-# LANGUAGE TypeFamilies               #-}\n{-# LANGUAGE ViewPatterns               #-}\nimport Yesod\nimport Database.Persist.Sqlite\nimport Control.Monad.Trans.Resource (runResourceT)\nimport Control.Monad.Logger (runStderrLoggingT)\n\n-- Define our entities as usual\nshare [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nPerson\n    firstName String\n    lastName String\n    age Int\n    deriving Show\n|]\n\n-- We keep our connection pool in the foundation. At program initialization, we\n-- create our initial pool, and each time we need to perform an action we check\n-- out a single connection from the pool.\ndata PersistTest = PersistTest ConnectionPool\n\n-- We'll create a single route, to access a person. It's a very common\n-- occurrence to use an Id type in routes.\nmkYesod \"PersistTest\" [parseRoutes|\n/ HomeR GET\n/person/#PersonId PersonR GET\n|]\n\n-- Nothing special here\ninstance Yesod PersistTest\n\n-- Now we need to define a YesodPersist instance, which will keep track of\n-- which backend we're using and how to run an action.\ninstance YesodPersist PersistTest where\n    type YesodPersistBackend PersistTest = SqlBackend\n\n    runDB action = do\n        PersistTest pool &lt;- getYesod\n        runSqlPool action pool\n\n-- List all people in the database\ngetHomeR :: Handler Html\ngetHomeR = do\n    people &lt;- runDB $ selectList [] [Asc PersonAge]\n    defaultLayout\n        [whamlet|\n            &lt;ul&gt;\n                $forall Entity personid person &lt;- people\n                    &lt;li&gt;\n                        &lt;a href=@{PersonR personid}&gt;#{personFirstName person}\n        |]\n\n-- We'll just return the show value of a person, or a 404 if the Person doesn't\n-- exist.\ngetPersonR :: PersonId -&gt; Handler String\ngetPersonR personId = do\n    person &lt;- runDB $ get404 personId\n    return $ show person\n\nopenConnectionCount :: Int\nopenConnectionCount = 10\n\nmain :: IO ()\nmain = runStderrLoggingT $ withSqlitePool \"test.db3\" openConnectionCount $ \\pool -&gt; liftIO $ do\n    runResourceT $ flip runSqlPool pool $ do\n        runMigration migrateAll\n        insert $ Person \"Michael\" \"Snoyman\" 26\n    warp 3000 $ PersistTest pool\n</code></pre>\n\n<p>How would it be like if instead of <code>Database.Persist.Sqlite</code> we used <code>Database.Persist.ODBC</code>?</p>\n"}, {"tags": ["haskell", "virtual-machine", "dependency-management", "cabal"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1455909275, "post_id": 35512551, "comment_id": 58717029, "body": "By all means do build in a sandbox. Also, don&#39;t use the Haskell platform. Install just the compiler and cabal. You may also want to try <a href=\"https://www.stackage.org/\" rel=\"nofollow noreferrer\">stack</a>."}], "answers": [{"comments": [{"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1457062081, "post_id": 35517577, "comment_id": 59245826, "body": "The &quot;one more thing differently&quot; is probably what did it. By installing all the dependencies at once, the solver was able to look for a solution that satisfied them simultaneously, instead of conflicting &quot;local optima&quot; that were incompatible with other things in your set."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1457062246, "post_id": 35517577, "comment_id": 59245870, "body": "Also note that the ubuntu haskell platform is quite out of date compared to the development of the Haskell ecosystem as a whole...  If its working fine for you so far thats good, but the last HP release with the 7.6 series was in 2013. So generally given an older base, you&#39;re more likely to run into other dep issues as libraries move it out of their window of support..."}], "tags": [], "owner": {"reputation": 222, "user_id": 3438721, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/hc759.jpg?s=128&g=1", "display_name": "dacDave", "link": "https://stackoverflow.com/users/3438721/dacdave"}, "is_accepted": false, "score": 1, "last_activity_date": 1455928464, "creation_date": 1455928464, "answer_id": 35517577, "question_id": 35512551, "link": "https://stackoverflow.com/questions/35512551/mime-mail-and-xmlhtml-have-conflicting-dependencies/35517577#35517577", "title": "mime-mail and xmlhtml have conflicting dependencies", "body": "<p>On the advice of n.m., I created a new VM and installed only GHC and cabal, i.e. not the full haskell-platform package. I was not able, in this environment to create a sandbox. The command <code>cabal sandbox init</code> failed with an error about not recognizing the sandbox command.</p>\n\n<p>However, after installing libpq-dev to fix the problem with installing the haskell library for client PostgreSQL, I am able to build my application without error. </p>\n\n<p>I did do one more thing differently. Instead of doing a <code>cabal configure</code> and then installing all of the missing dependencies myself, I did a <code>cabal install --only-dependencies</code> and let cabal decide which dependencies to install in which order.</p>\n\n<p>So I now have a working development environment for this application, but I am left with one question.</p>\n\n<p>What did the Haskell platform install do that caused this problem and why was it better to install just the compiler and cabal? OK, two questions. When might I want to install the entire Haskell platform package?</p>\n\n<p>Thanks for the help!</p>\n\n<p>Dave</p>\n"}], "owner": {"reputation": 222, "user_id": 3438721, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/hc759.jpg?s=128&g=1", "display_name": "dacDave", "link": "https://stackoverflow.com/users/3438721/dacdave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1455928464, "creation_date": 1455907128, "question_id": 35512551, "link": "https://stackoverflow.com/questions/35512551/mime-mail-and-xmlhtml-have-conflicting-dependencies", "title": "mime-mail and xmlhtml have conflicting dependencies", "body": "<p>I believe am running the latest Haskell platform, as of this writing. GHC version is 7.6.3. Cabal-install version is 1.16.0.2 and cabal version is 1.16.0. This is running on a virtualbox machine running Ubuntu 14.04.2.</p>\n\n<p>Here is my problem. I have an application that has dependencies on both mime-mail and xmlhtml. Both of these packages have a dependency on blaze-builder. When I install these two packages, in either order, installing the second one complains that it might break the other one, and it does. Running cabal configure complains that blaze-builder is missing and is required by whichever package (mime-mail or xmlhtml) that I installed later.</p>\n\n<p>Now here is the weird part. This builds fine, with some warnings, on a physical server running the same versions of GHC and cabal. It is also running the same version of Ubuntu. The only difference that I can see is that the one that works is a physical machine and the one that doesn't is a virtualbox machine.</p>\n\n<p>No, I am not building in a sandbox. I have been reading about sandboxes, but I don't think it will be of help here since the conflicting dependent packages are in the same application.</p>\n\n<p>My problem is compounded by the fact that this physical machine is going away. Therefore, I need to get this development environment running on my local VM.</p>\n\n<p>Any suggestions of where to look next?</p>\n\n<p>Dave Smith</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1455907729, "post_id": 35512516, "comment_id": 58716176, "body": "My ghci thinks it&#39;s the other way around..."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1455908621, "post_id": 35512516, "comment_id": 58716669, "body": "Informal informed guess: Since <code>xs</code> is shared between the two terms any evaluated part of <code>xs</code> will be retained.  If <code>+</code> evaluates the first argument first then either 1 cons cell (first case) or all N cells in the list (second case) will need to be allocated."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 9, "creation_date": 1455910015, "post_id": 35512516, "comment_id": 58717447, "body": "This is <i>very</i> implementation-dependent. For example, compiling with <code>ghc -O2</code>, I find both run in O(1) space; whereas when interpreting or compiling without optimizations last+head is O(1) but head+last is O(n). I wouldn&#39;t be surprised if using a different compiler gave yet a third result."}], "answers": [{"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 2, "last_activity_date": 1455932752, "creation_date": 1455932752, "answer_id": 35518164, "question_id": 35512516, "link": "https://stackoverflow.com/questions/35512516/space-complexity-of-the-following-two-lambda-functions/35518164#35518164", "title": "Space complexity of the following two lambda functions", "body": "<p>One way to do this is to evaluate the expressions by hand and observe how the maximum length of the intermediate expressions grows as a function of <code>n</code>.  This is trickier to do than it sounds, because of the sharing of <code>xs</code> inside the definition of your lambas, but I'll do it and hopefully it'll be helpful.  </p>\n\n<p>First, let's write definitions for <code>head</code> and <code>last</code>:</p>\n\n<pre><code>head :: [a] -&gt; a\nhead (a:_) = a\n\nlast :: [a] -&gt; a\nlast (a:[]) = a\nlast (_:as) = last as\n</code></pre>\n\n<p>Now, armed with this, let's do the first one:</p>\n\n<pre><code>(\\xs -&gt; head xs + last xs) [1..n]\n  =&gt; let xs = [1..n] in head xs + last xs\n  =&gt; let xs = 1:[2..n] in head xs + last xs\n  =&gt; let xs = 1:[2..n] in 1 + last xs\n  =&gt; 1 + last [2..n]\n  =&gt; 1 + last (2:[3..n])\n  =&gt; 1 + last [3..n]\n  =&gt; 1 + last (3:[4..n])\n  .\n  .\n  .\n  =&gt; 1 + last (n:[])\n  =&gt; 1 + n\n</code></pre>\n\n<p>As you can see, the expressions in the intermediate steps have some constant upper bound on their size, and the value of <code>n</code> doesn't matter.  Now let's try your second example.  I've chosen to illustrate the structure sharing and the forcing by making the list of bindings in the <code>let</code> grow:</p>\n\n<pre><code>(\\xs -&gt; last xs + head xs) [1..n]\n  =&gt; let xs = [1..n] in last xs + head xs\n  =&gt; let xs = 1:[2..n] in last xs + head xs\n  =&gt; let xs  = 1:xs2\n         xs2 = 2:[3..]\n     in last xs2 + head xs\n  =&gt; let xs  = 1:xs2\n         xs2 = 2:xs3\n         xs3 = 3:[4..]\n     in last xs3 + head xs\n  .\n  .\n  .\n  =&gt; let xs  = 1:xs2\n         xs2 = 2:xs3\n         xs3 = 3:xs4\n             .\n             .\n             .\n         xsn = n:[]\n     in last xsn + head xs\n  =&gt; let xs  = 1:xs2\n         xs2 = 2:xs3\n         xs3 = 3:xs4\n             .\n             .\n             .\n         xsn = n:[]\n     in n + head xs\n  =&gt; n + 1\n</code></pre>\n\n<p>As you can see, the size of the largest expression is going to be proportional to <code>n</code>.  This means that the evaluation uses O(n) space.</p>\n\n<p>The difference between the two examples is an artifact of the fact that the <code>+</code> function is forcing its first argument before forcing the second one.  As a general rule, when you have a function with multiple arguments one of them must be forced before the others, and the order in which it happens can have subtle effects like these.</p>\n"}], "owner": {"reputation": 1176, "user_id": 2415118, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f71ca7d457d223d598b1f439ff171ecd?s=128&d=identicon&r=PG", "display_name": "abden003", "link": "https://stackoverflow.com/users/2415118/abden003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 35518164, "answer_count": 1, "score": 2, "last_activity_date": 1455936323, "creation_date": 1455907014, "last_edit_date": 1455936323, "question_id": 35512516, "link": "https://stackoverflow.com/questions/35512516/space-complexity-of-the-following-two-lambda-functions", "title": "Space complexity of the following two lambda functions", "body": "<p>I was reading the following: <a href=\"https://en.wikibooks.org/wiki/Haskell/Graph_reduction\" rel=\"nofollow\">https://en.wikibooks.org/wiki/Haskell/Graph_reduction</a>, and it had the following written:</p>\n\n<blockquote>\n  <p>Tricky space leak example:</p>\n\n<pre><code>(\\xs -&gt; head xs + last xs) [1..n]\n(\\xs -&gt; last xs + head xs) [1..n]\n</code></pre>\n  \n  <p>The first version runs on <em>O(1)</em> space. The second in <em>O(n)</em>.</p>\n</blockquote>\n\n<p>Is this statement correct?  I'm unable to see how they are different.  Once executed they both seem to take the same amount of time and space, and before executing you can lazily determine that their types are compatible.</p>\n"}, {"tags": ["haskell", "conditional"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1455917126, "post_id": 35512414, "comment_id": 58721187, "body": "Also note that if the inner condition is not exhaustive (e.g. does not end with <code>otherwise</code> or equivalent) then the program may crash without returning control to the outer conditions, as one might expect."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 1, "last_activity_date": 1455907558, "last_edit_date": 1455907558, "creation_date": 1455906703, "answer_id": 35512414, "question_id": 35512151, "link": "https://stackoverflow.com/questions/35512151/haskell-nested-conditions/35512414#35512414", "title": "Haskell nested conditions", "body": "<p>You can't nest guards that way, but it might be cleaner to separate it into two functions like so:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>someFunc s n r c e i\n    | (i &lt; s) = innerCondition s n r c e i\n    | otherwise = n\n\ninnerCondition s n r c e i\n    | (e &lt; s) = someFunc (changes go here conditions are met)\n    | otherwise = createList (different set of conditions go here)\n</code></pre>\n\n<p>Alternatively, you could keep it nested within the same function with an <code>if</code> statement:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>someFunc s n r c e i\n    | (i &lt; s) =\n        if (e &lt; s) then\n            someFunc (changes go here conditions are met)\n        else\n            createList (different set of conditions go here)\n    | otherwise = n\n</code></pre>\n\n<p>But I think the first example with separate guarded functions is cleaner.</p>\n"}], "owner": {"reputation": 53, "user_id": 5927617, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/415b65efd5744b4b4395b69ea79d2c87?s=128&d=identicon&r=PG&f=1", "display_name": "Minmater", "link": "https://stackoverflow.com/users/5927617/minmater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 2, "closed_date": 1455917280, "accepted_answer_id": 35512414, "answer_count": 1, "score": 0, "last_activity_date": 1455907558, "creation_date": 1455905883, "question_id": 35512151, "link": "https://stackoverflow.com/questions/35512151/haskell-nested-conditions", "closed_reason": "Duplicate", "title": "Haskell nested conditions", "body": "<p>I'm having an issue with a conditions where I have nested them. I'm new to Haskell and can't seem to find anything similar in my book or online. Here is an example of what I have:</p>\n\n<pre><code>someFunc s n r c e i\n    | (i &lt; s) \n    &gt;&gt;&gt; | (e &lt; s) = someFunc (changes go here conditions are met)\n        | otherwise = createList (different set of conditions go here)\n    | otherwise = n\n</code></pre>\n\n<p>The error being given is: \"parse error on input `|'\" at the point denoted in the code. How what is the best method of solving this?</p>\n\n<p>Thanks and sorry for English.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455905584, "post_id": 35510790, "comment_id": 58714876, "body": "The thing <code>Show a =&gt; a -&gt; a</code> is called a type. So is the thing <code>a -&gt; a</code>. Traditionally, the word &quot;type&quot; refers to things of kind <code>*</code> - the kind of types. For example, <code>Maybe</code> is not a type, it&#39;s a type constructor (it&#39;s kind is <code>* -&gt; *</code>). Neither is <code>Show a</code> for example (whose kind is <code>Constraint</code>, the kind of class constraints). However, depending on the situation, it is perfectly valid to use &quot;type&quot; to refer to things of <i>any</i> kind - (i.e. types of kind <code>*</code>, types of kind <code>Constraint</code>, etc). If you need to be explicit, <code>Show a</code> is a &#39;constraint&#39; or &#39;context&#39;, <code>a -&gt; a</code> is a &#39;type&#39;."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455905682, "post_id": 35510790, "comment_id": 58714939, "body": "And <code>forall a . Show a =&gt; a -&gt; a</code> is a polytype (ran out of room). This language is not universal, but appears in many places, for example the formal specification of the type system."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1455906523, "post_id": 35510790, "comment_id": 58715452, "body": "There might be no widely used term for that. E.g., the Haskell report says &quot;In general, we use cx to denote a context and we write cx =&gt; t to indicate the type t restricted by the context cx.&quot; using the very generic term &quot;type&quot;. <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-630004.1\" rel=\"nofollow noreferrer\">haskell.org/onlinereport/haskell2010/&hellip;</a>"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1455935807, "post_id": 35510790, "comment_id": 58727281, "body": "This is idiosyncratic GHC nomenclature, but in the type <code>forall a. (Show b, Read c) =&gt; d</code>, the full thing is called a sigma type, <code>(Show b, Read c) =&gt; d</code> is a rho type, <code>(Show b, Read c)</code> is a theta type and <code>d</code> is a tau type."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1455905085, "post_id": 35511275, "comment_id": 58714565, "body": "Actually, this does not answer the question."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1455905264, "post_id": 35511275, "comment_id": 58714688, "body": "I think it answers the question. He asked what the &quot;C&quot; portion is. Care to suggest an improvement?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1455905515, "post_id": 35511275, "comment_id": 58714843, "body": "The <code>C</code> in your example would be the part <code>a -&gt; a -&gt; a</code> in the larger type <code>(a ~ Int) =&gt; a -&gt; a -&gt; a</code>, and not the part <code>(a ~ Int)</code>. The OP is using <code>C</code> for the <i>right</i> hand side of <code>=&gt;</code> in types, while the letter <code>C</code> is commonly used for the <i>left</i> part."}, {"owner": {"reputation": 956, "user_id": 4118718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6fa341e7e75896fe4d325114672345?s=128&d=identicon&r=PG&f=1", "display_name": "alev", "link": "https://stackoverflow.com/users/4118718/alev"}, "edited": false, "score": 0, "creation_date": 1455905811, "post_id": 35511275, "comment_id": 58715007, "body": "&quot;Head&quot; is already quite overloaded... To disambiguate this, would you say something like &quot;the head of a type signature&quot;?  Also, could you provide any links that show &quot;head&quot; being used in the way you suggest?  Searching for &quot;Haskell head of type signature&quot; doesn&#39;t seem to produce many relevant results."}, {"owner": {"reputation": 956, "user_id": 4118718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6fa341e7e75896fe4d325114672345?s=128&d=identicon&r=PG&f=1", "display_name": "alev", "link": "https://stackoverflow.com/users/4118718/alev"}, "edited": false, "score": 0, "creation_date": 1455906527, "post_id": 35511275, "comment_id": 58715453, "body": "Just in case there was any confusion, I&#39;ve tried to update the question to more precisely identify the part of the signature that I&#39;m talking about.  I&#39;ve also changed &quot;class constraints&quot; to &quot;constraints&quot;, since as Eric pointed out, there can be other types of constraints."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1455907854, "post_id": 35511275, "comment_id": 58716243, "body": "@chi I completely agree with your assessment of the OP; I&#39;m did try to say that the RHS (the &quot;C&quot; part) is called the head. Perhaps I can be clearer..."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "reply_to_user": {"reputation": 956, "user_id": 4118718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6fa341e7e75896fe4d325114672345?s=128&d=identicon&r=PG&f=1", "display_name": "alev", "link": "https://stackoverflow.com/users/4118718/alev"}, "edited": false, "score": 0, "creation_date": 1455908101, "post_id": 35511275, "comment_id": 58716363, "body": "@alev Updated the answer."}, {"owner": {"reputation": 956, "user_id": 4118718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6fa341e7e75896fe4d325114672345?s=128&d=identicon&r=PG&f=1", "display_name": "alev", "link": "https://stackoverflow.com/users/4118718/alev"}, "edited": false, "score": 1, "creation_date": 1455910340, "post_id": 35511275, "comment_id": 58717611, "body": "@Eric Thanks for the update.  It looks like that term is specific to the RHS of a constrained instance declaration, where the semantics are significantly different.  (In my understanding, the RHS of a constrained instance declaration is a type class followed by one or more types, whereas the RHS of a constrained type signature is just a bare/unconstrained type.)  Because of this, and because I haven&#39;t found any examples of &quot;head&quot; being used for a type signature the same way it is used for instance declarations, I would be wary of using this term.  But it&#39;s good to know it exists."}], "tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": false, "score": 1, "last_activity_date": 1455907875, "last_edit_date": 1455907875, "creation_date": 1455902997, "answer_id": 35511275, "question_id": 35510790, "link": "https://stackoverflow.com/questions/35510790/haskell-terminology-part-of-type-signature-following-constraints/35511275#35511275", "title": "Haskell Terminology: Part of type signature following constraints", "body": "<p>When I think of \"class constraints\", I think of \"superclass constraints\" that appear on the left hand side of a class definition:</p>\n\n<pre><code>class (Functor a) =&gt; Applicative a\n</code></pre>\n\n<p>I call constraints on a <em>function</em> just \"constraints\". In both cases, the constraints don't actually need to arise from a class. For example, we can have equality constraints:</p>\n\n<pre><code>f :: (a ~ Int) =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>The \"C\" portion you refer to (in the example above, <code>a -&gt; a -&gt; a</code>) is called the \"head\" (as in <a href=\"https://downloads.haskell.org/~ghc/6.4-latest/docs/html/users_guide/type-extensions.html#id3144883\" rel=\"nofollow\">\"instance head\"</a>).</p>\n"}], "owner": {"reputation": 956, "user_id": 4118718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc6fa341e7e75896fe4d325114672345?s=128&d=identicon&r=PG&f=1", "display_name": "alev", "link": "https://stackoverflow.com/users/4118718/alev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1455907875, "creation_date": 1455901482, "last_edit_date": 1455906429, "question_id": 35510790, "link": "https://stackoverflow.com/questions/35510790/haskell-terminology-part-of-type-signature-following-constraints", "title": "Haskell Terminology: Part of type signature following constraints", "body": "<p>Many type signatures in Haskell are of the following form:</p>\n\n<pre><code>a :: (B) =&gt; C\n</code></pre>\n\n<p>As I understand it, the term \"type signature\" refers to the entire construct <code>a :: (B) =&gt; C</code>, and <code>B</code> (if present) is called a \"constraint\".  However, I'm not sure how to unambiguously refer to the remainder of the type signature, <code>C</code>.</p>\n\n<p><strong>Is there any standard name for the part of the type signature located to the right of any constraints?</strong></p>\n\n<p>A few naive searches came up with nothing.  So far, here are my best attempts, but it would be nice to have a term that is both concise and unambiguous:</p>\n\n<ul>\n<li>\"The part of the type signature after any constraints\"</li>\n<li>\"The constraint-free part of the type signature\"</li>\n<li>In some cases, it might be clear from the context to say \"the remainder of the type signature\"</li>\n</ul>\n\n<p>To make this more concrete, here's an example from the Prelude:</p>\n\n<pre><code>mapM :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]\n</code></pre>\n\n<p>Relative to the notation used above, the identifier <code>mapM</code> corresponds to <code>a</code>, the constraint <code>Monad m</code> corresponds to <code>B</code>, and <code>(a -&gt; m b) -&gt; [a] -&gt; m [b]</code> corresponds to <code>C</code>.  I'm looking for a word/phrase that unambiguously would refer to the part of the type signature following the <code>=&gt;</code>, namely <code>(a -&gt; m b) -&gt; [a] -&gt; m [b]</code>.</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1455900751, "post_id": 35509948, "comment_id": 58712011, "body": "can you please show some of your tables definition and the <code>models</code> file? I have a hard time trying to figure out what you are asking here"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1455905226, "post_id": 35509948, "comment_id": 58714660, "body": "As Carsten told, without the models file, it would be hard to help you. If you don&#39;t want to do migration, just remove the <code>runMigration migrateAll</code> code."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1455911664, "post_id": 35509948, "comment_id": 58718360, "body": "there is a nice <a href=\"https://www.schoolofhaskell.com/school/advanced-haskell/persistent-in-detail/existing-database\" rel=\"nofollow noreferrer\">tutorial</a> on how to do this (remap column-names) - you basically write <code>myColumn int sql=myColumn2</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "is_accepted": false, "score": 1, "last_activity_date": 1455906542, "creation_date": 1455906542, "answer_id": 35512348, "question_id": 35509948, "link": "https://stackoverflow.com/questions/35509948/haskell-yesod-how-to-controll-how-persistent-will-access-the-db-columns/35512348#35512348", "title": "Haskell Yesod how to controll how Persistent will access the DB columns", "body": "<p>Look at this page in the docs: <a href=\"https://hackage.haskell.org/package/persistent-2.2.2/docs/Database-Persist-Quasi.html\" rel=\"nofollow\">https://hackage.haskell.org/package/persistent-2.2.2/docs/Database-Persist-Quasi.html</a></p>\n\n<p>The field named psToDBName can be set to give you the behavior you are looking for. I'm on a phone right now, but I'll try to give an example later when I get back to a computer.</p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1455910408, "creation_date": 1455898877, "last_edit_date": 1455910408, "question_id": 35509948, "link": "https://stackoverflow.com/questions/35509948/haskell-yesod-how-to-controll-how-persistent-will-access-the-db-columns", "title": "Haskell Yesod how to controll how Persistent will access the DB columns", "body": "<p>I have a database which is already quite big, and I need to access the tables and the columns the way they have been written THERE (camelCase). Can I change the following code to make it possible to access camelCase, or at least a way to define a String as it is in my database, for each table and column?</p>\n\n<pre><code>share [mkPersist sqlSettings, mkMigrate \"migrateAll\"]\n  $(persistFileWith lowerCaseSettings \"config/models\")\n</code></pre>\n\n<p>Another thing: I don't want to do any migration, I want just to do the CRUD</p>\n\n<p><strong>Example</strong></p>\n\n<p>Model:</p>\n\n<pre><code>MyTest\n  firstName Text\n</code></pre>\n\n<p>Table:</p>\n\n<pre><code>create table MyTest ( \n  id int unsigned AUTO_INCREMENT,\n  firstName varchar (255) not null, \n  primary key(id)\n)\n</code></pre>\n\n<p>Another thing: What if I have a column called myColumn2 and I want it to be myColumn in the definition? How could I define a custom name to be used while talking to the DB?</p>\n"}, {"tags": ["haskell", "gloss"], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 3296768, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f31f7a7524e7628dd45c356a788ac98?s=128&d=identicon&r=PG&f=1", "display_name": "darrrrUC", "link": "https://stackoverflow.com/users/3296768/darrrruc"}, "edited": false, "score": 0, "creation_date": 1455977242, "post_id": 35509200, "comment_id": 58738191, "body": "Made an edit to my post after doing code in the direction you pointed me towards, now im just not sure how to update the board once i click :/"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "reply_to_user": {"reputation": 311, "user_id": 3296768, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f31f7a7524e7628dd45c356a788ac98?s=128&d=identicon&r=PG&f=1", "display_name": "darrrrUC", "link": "https://stackoverflow.com/users/3296768/darrrruc"}, "edited": false, "score": 0, "creation_date": 1455982467, "post_id": 35509200, "comment_id": 58739962, "body": "@darrrrUC Made an edit myself with a lot of code. Hope that helps you. ;)"}, {"owner": {"reputation": 311, "user_id": 3296768, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f31f7a7524e7628dd45c356a788ac98?s=128&d=identicon&r=PG&f=1", "display_name": "darrrrUC", "link": "https://stackoverflow.com/users/3296768/darrrruc"}, "edited": false, "score": 0, "creation_date": 1455984441, "post_id": 35509200, "comment_id": 58740624, "body": "wow, will have a long and close look at this, thanks a billion!"}], "tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 6, "last_activity_date": 1455982448, "last_edit_date": 1455982448, "creation_date": 1455896621, "answer_id": 35509200, "question_id": 35507997, "link": "https://stackoverflow.com/questions/35507997/reading-user-mouseclick-position-in-haskells-gloss/35509200#35509200", "title": "Reading user mouseclick position in haskells gloss", "body": "<p>You want to use <a href=\"https://hackage.haskell.org/package/gloss-1.9.4.1/docs/Graphics-Gloss.html#v:play\" rel=\"nofollow\"><code>play</code></a> instead of <code>display</code>.</p>\n\n<p>It explicitly takes an argument of type <code>Event -&gt; world -&gt; world</code> (<code>world</code> would be <code>Board</code> in your case) describing how to react to <code>Event</code>s.</p>\n\n<p>Edit: Ok, I have implemented a toy example to show you how I'd structure my code. You can find it in a <a href=\"https://gist.github.com/gallais/0d61677fe97aa01a12d5\" rel=\"nofollow\">self-contained gist</a> with the appropriate imports.</p>\n\n<h1>What is the state of the system? How does it evolve?</h1>\n\n<p>The first thing you need to figure out is how to represent the state of the board. In a game of Tic-tac-toe, you have a bunch of <em>noughts</em> and a bunch of <em>crosses</em> at given <em>coordinates</em> (a pair of <code>Int</code>s equal to either -1, 0 or 1) on the board. You also have a current <em>player</em> (which will change after the next move). So let's start with that:</p>\n\n<pre><code>type Coordinates = (Int, Int)\ndata Player = Nought | Cross\n\ndata Board = Board\n  { noughts :: [Coordinates]\n  , crosses :: [Coordinates]\n  , player  :: Player\n  }\n</code></pre>\n\n<p>You can then describe various simple things. What should the <em>empty</em> board look like when you're beginning a match? What does a player's move (putting a new <em>token</em> on the board) do to the state of the system (it inserts the token in the list of the current player and then changes the current player to the adversary):</p>\n\n<pre><code>emptyBoard :: Board\nemptyBoard = Board [] [] Nought\n\npushToken:: Coordinates -&gt; Board -&gt; Board\npushToken c b = case player b of\n  Nought -&gt; b { noughts = c : noughts b, player = Cross  }\n  Cross  -&gt; b { crosses = c : crosses b, player = Nought }\n</code></pre>\n\n<h1>How do we display the state to the user?</h1>\n\n<p>Next comes the problem of drawing a <code>Picture</code> corresponding to the current state. Here, I assume that the picture will be centered in <code>(0, 0)</code> which means that changing its size can be done by simply multiplying all the coordinates by a given constant. I will parameterise all my functions with a <code>Size</code> argument allowing me to tweak the size of the displayed board without any hassle.</p>\n\n<pre><code>type Size = Float\n\nresize :: Size -&gt; Path -&gt; Path\nresize k = fmap (\\ (x, y) -&gt; (x * k, y * k))\n</code></pre>\n\n<p>Noughts are easy to display: we can simply use a <code>thickCircle</code> of the right size and then translate them to their coordinate! Crosses are a bit harder to deal with because you have to combine 2 rectangles to draw them.</p>\n\n<pre><code>drawNought :: Size -&gt; Coordinates -&gt; Picture\ndrawNought k (x, y) =\n  let x' = k * fromIntegral x\n      y' = k * fromIntegral y\n  in color green $ translate x' y' $ thickCircle (0.1 * k) (0.3 * k)\n\ndrawCross :: Size -&gt; Coordinates -&gt; Picture\ndrawCross k (x, y) =\n  let x' = k * fromIntegral x\n      y' = k * fromIntegral y\n  in color red $ translate x' y' $ Pictures\n     $ fmap (polygon . resize k)\n     [ [ (-0.35, -0.25), (-0.25, -0.35), (0.35,0.25), (0.25, 0.35) ]\n     , [ (0.35, -0.25), (0.25, -0.35), (-0.35,0.25), (-0.25, 0.35) ]\n     ]\n</code></pre>\n\n<p>In order to draw the board, we draw a black grid and then populate it with the noughts and crosses:</p>\n\n<pre><code>drawBoard :: Size -&gt; Board -&gt; Picture\ndrawBoard k b = Pictures $ grid : ns ++ cs where\n\n  ns = fmap (drawNought k) $ noughts b\n  cs = fmap (drawCross k)  $ crosses b\n\n  grid :: Picture\n  grid = color black $ Pictures $ fmap (line . resize k)\n       [ [(-1.5, -0.5), (1.5 , -0.5)]\n       , [(-1.5, 0.5) , (1.5 , 0.5)]\n       , [(-0.5, -1.5), (-0.5, 1.5)]\n       , [(0.5 , -1.5), (0.5 , 1.5)]\n       ]\n</code></pre>\n\n<h1>How do we react to inputs?</h1>\n\n<p>Now that we have a board and that we can display it, we just have to be able to grab user inputs and respond to them so that we have a working game.</p>\n\n<p>Mouse clicks are received as a pair of floats corresponding to the position of the mouse in the drawing. We need to translate this position into appropriate coordinates. This is what <code>checkCoordinate</code> does: it divides a <code>Float</code> by the size we have picked for the drawing and checks which subdivision of the board that position corresponds to.</p>\n\n<p>Here I use <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:guard\" rel=\"nofollow\"><code>guard</code></a>, <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Functor.html#v:-60--36-\" rel=\"nofollow\"><code>(&lt;$)</code></a> and <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Applicative.html#v:-60--124--62-\" rel=\"nofollow\">(&lt;|>)</a> to have a declarative presentation of the various cases but you could use <code>if ... then ... else ...</code> if you wanted to.</p>\n\n<pre><code>checkCoordinate :: Size -&gt; Float -&gt; Maybe Int\ncheckCoordinate k f' =\n  let f = f' / k\n  in  (-1) &lt;$ guard (-1.5 &lt; f &amp;&amp; f &lt; -0.5)\n  &lt;|&gt; 0    &lt;$ guard (-0.5 &lt; f &amp;&amp; f &lt; 0.5)\n  &lt;|&gt; 1    &lt;$ guard (0.5  &lt; f &amp;&amp; f &lt; 1.5)\n</code></pre>\n\n<p>Finally, <code>handleKeys</code> can detect mouse clicks, check that they correspond to a position in the board and react appropriately by calling <code>pushToken</code>:</p>\n\n<pre><code>handleKeys :: Size -&gt; Event -&gt; Board -&gt; Board\nhandleKeys k (EventKey (MouseButton LeftButton) Down _ (x', y')) b =\n  fromMaybe b $ do\n    x &lt;- checkCoordinate k x'\n    y &lt;- checkCoordinate k y'\n    return $ pushToken (x, y) b\nhandleKeys k _ b = b\n</code></pre>\n\n<h1>Putting it all together</h1>\n\n<p>We can then declare a <code>main</code> function creating the window, starting the game with an <code>emptyBoard</code>, displaying it using <code>drawBoard</code> and handling user inputs with <code>handleKeys</code>.</p>\n\n<pre><code>main :: IO ()\nmain =\n  let window = InWindow \"Tic Tac Toe\" (300, 300) (10, 10)\n      size   = 100.0\n  in play window yellow 1 emptyBoard (drawBoard size) (handleKeys size) (flip const)\n</code></pre>\n\n<h1>What is there left to do?</h1>\n\n<p>I haven't enforced any of the game logic:</p>\n\n<ul>\n<li><p>player can put a token in a subdivision of the grid that's already occupied,</p></li>\n<li><p>the game does not detect when there is a winner</p></li>\n<li><p>there is no way to play multiple games in a row</p></li>\n</ul>\n"}], "owner": {"reputation": 311, "user_id": 3296768, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1f31f7a7524e7628dd45c356a788ac98?s=128&d=identicon&r=PG&f=1", "display_name": "darrrrUC", "link": "https://stackoverflow.com/users/3296768/darrrruc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1306, "favorite_count": 0, "accepted_answer_id": 35509200, "answer_count": 1, "score": 1, "last_activity_date": 1455982448, "creation_date": 1455893169, "last_edit_date": 1455977181, "question_id": 35507997, "link": "https://stackoverflow.com/questions/35507997/reading-user-mouseclick-position-in-haskells-gloss", "title": "Reading user mouseclick position in haskells gloss", "body": "<p>Edit:\nSo i followed your pointers and got to this point: (following the rules of play) </p>\n\n<p><a href=\"https://hackage.haskell.org/package/gloss-1.9.4.1/docs/Graphics-Gloss-Interface-Pure-Game.html\" rel=\"nofollow\">https://hackage.haskell.org/package/gloss-1.9.4.1/docs/Graphics-Gloss-Interface-Pure-Game.html</a></p>\n\n<pre><code>drawBoard :: IO ()\ndrawBoard = play (InWindow \"Tic Tac Toe\" (300,300)(10,10)) yellow 10 board (testBoard) (handleKeys) (iteration)\n\ntestBoard :: Board -&gt; Picture\ntestBoard board = grid\n    where\n        grid =\n            color black (line [ (-100, -300), (-100,  300) ])\n\niteration :: Float -&gt; Board -&gt; Board\niteration _ board = board \n\nhandleKeys :: Event -&gt; Board -&gt; Board\nhandleKeys (EventKey (MouseButton LeftButton) Up _ (x, y)) board = board\nhandleKeys _ _ = board\n\nboard = []\n</code></pre>\n\n<p>And it correctly opens the window and draws a black line accoarding to my <code>testBoard</code> function.</p>\n\n<p>What im not sure about now is how to pass a new board when I click a button. Do I create another function to draw the new board or how would I go on about drawing a new board when clicking?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 2, "creation_date": 1455887124, "post_id": 35505887, "comment_id": 58703056, "body": "Add another <code>Bool</code> where ?"}, {"owner": {"reputation": 725, "user_id": 1117884, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/uoBrU.png?s=128&g=1", "display_name": "yokto", "link": "https://stackoverflow.com/users/1117884/yokto"}, "edited": false, "score": 3, "creation_date": 1455887131, "post_id": 35505887, "comment_id": 58703063, "body": "(&lt;10) is a function and has type (a -&gt; Bool). [1,2,3] is a list and has type [a]. The filter function takes this function and a list and returns another list."}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 8, "last_activity_date": 1455887593, "creation_date": 1455887593, "answer_id": 35506206, "question_id": 35505887, "link": "https://stackoverflow.com/questions/35505887/understanding-haskell-type/35506206#35506206", "title": "Understanding Haskell Type", "body": "<p>The type of your <code>filter'</code> function is only so constrained because you've declared that it is. If you don't declare the type, the compiler will infer a more tolerant type: <code>(a -&gt; Bool) -&gt; [a] -&gt; [a]</code>. This is the same type as the built-in <code>filter</code> function:</p>\n\n<pre><code>Prelude&gt; :type filter\nfilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>The expression <code>(&lt; 10)</code> is a so-called <em>section</em>. It's a partially applied function.</p>\n\n<p>The operator <code>&lt;</code> is itself a function:</p>\n\n<pre><code>Prelude&gt; :type (&lt;)\n(&lt;) :: Ord a =&gt; a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>You can read this as: <code>&lt;</code> is a function that takes two arguments, both of the generic type <code>a</code>. The type <code>a</code> must belong to the typeclass <code>Ord</code>. When you call <code>&lt;</code> with such two values, a <code>Bool</code> value is returned.</p>\n\n<p>Since Haskell functions are <em>curried</em>, you can call a function with only some of the arguments. The return value is a new function that 'waits for the remaining arguments':</p>\n\n<pre><code>Prelude&gt; :type (&lt; 10)\n(&lt; 10) :: (Num a, Ord a) =&gt; a -&gt; Bool\n</code></pre>\n\n<p>This type is a little more constrained, because the literal <code>10</code> is inferred to belong to the <code>Num</code> typeclass. Since <code>&lt;</code> is in use, the original constraint for that (<code>Ord</code>) is still in effect as well.</p>\n\n<p>The expression <code>[1,2,3]</code> is is by the compiler inferred as:</p>\n\n<pre><code>Prelude&gt; :type [1,2,3]\n[1,2,3] :: Num t =&gt; [t]\n</code></pre>\n\n<p>The values all belong to the <code>Num</code> typeclass. When you use all of these types together, you get the union of all the inferred types:</p>\n\n<pre><code>Prelude&gt; :type filter (&lt; 10) [1,2,3]\nfilter (&lt; 10) [1,2,3] :: (Num a, Ord a) =&gt; [a]\n</code></pre>\n\n<p>The <code>Num</code> typeclass is inferred because of the use of literals, and the <code>Ord</code> typeclass is inferred because of the use of the <code>&lt;</code> operator.</p>\n"}], "owner": {"reputation": 548, "user_id": 5069373, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/684f313653e6ae98c35615feb7e4e05d?s=128&d=identicon&r=PG&f=1", "display_name": "dijam", "link": "https://stackoverflow.com/users/5069373/dijam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1455887593, "creation_date": 1455886549, "last_edit_date": 1455887485, "question_id": 35505887, "link": "https://stackoverflow.com/questions/35505887/understanding-haskell-type", "title": "Understanding Haskell Type", "body": "<p>I have managed to implement a mock filter functions (after lots of attempts)</p>\n\n<pre><code>filter' :: (Num a, Eq a) =&gt; (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' a [] = []\nfilter' a (x:xs) = if a x\n  then x : filter' a xs\n  else filter' a xs\n</code></pre>\n\n<p>What I don't clearly understand is the type declaration </p>\n\n<pre><code>filter' :: (Num a, Eq a) =&gt; (a -&gt; Bool) -&gt; [a] -&gt; [a]\n-- filter' (&lt;10) [1,2,3] \n-- output = []\n</code></pre>\n\n<p>We pass in <code>(&lt;10) [1,2,3]</code>. However in the type declaration <code>(a -&gt; Bool)</code> we pass in a which comes from the list recursively and the output is either true or false. However what about the expressing the test <code>(&lt;10)?</code> Why don't we add another Bool?</p>\n"}, {"tags": ["winapi", "haskell", "gcc", "com", "cabal"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1455886173, "post_id": 35505329, "comment_id": 58702529, "body": "seems like the <code>comPrim.h</code> has syntax errors in it - if you know C/C++ you can try to download the source and fix it yourself - if not you should probably let the author know"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 1, "creation_date": 1456389105, "post_id": 35505329, "comment_id": 58926218, "body": "The second half of the question I can answer -- cabal checks for lots of things that people may wish to use, even if they aren&#39;t asked for. -v3 is very verbose and shows that. So you can disregard that as far as I know, in terms of diagnosing the proximate errors :-)"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1456389267, "post_id": 35505329, "comment_id": 58926324, "body": "On the first half, you need to make sure you&#39;re using the <i>right</i> c compiler -- ideally the one tied to the mingw install that comes with ghc. You can pass that into cabal as an option, or just make sure your paths are all configured right..."}], "answers": [{"comments": [{"owner": {"reputation": 945, "user_id": 2899420, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33ce7901ec7cd1195561a930201ae56b?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid", "link": "https://stackoverflow.com/users/2899420/leonid"}, "edited": false, "score": 0, "creation_date": 1456478053, "post_id": 35637514, "comment_id": 58975604, "body": "Does it mean that the library can be built only for 32 bit platform?"}, {"owner": {"reputation": 945, "user_id": 2899420, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33ce7901ec7cd1195561a930201ae56b?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid", "link": "https://stackoverflow.com/users/2899420/leonid"}, "edited": false, "score": 0, "creation_date": 1456484468, "post_id": 35637514, "comment_id": 58980068, "body": "I added <code>gcc -v</code> output to the question. And I had no another GCC version preinstalled. The only one is that comes with Haskell Platform"}, {"owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "reply_to_user": {"reputation": 945, "user_id": 2899420, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33ce7901ec7cd1195561a930201ae56b?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid", "link": "https://stackoverflow.com/users/2899420/leonid"}, "edited": false, "score": 0, "creation_date": 1456487405, "post_id": 35637514, "comment_id": 58982048, "body": "@Leonidas See revised answer."}], "tags": [], "owner": {"reputation": 45838, "user_id": 1362568, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/EAFi0.jpg?s=128&g=1", "display_name": "Mike Kinghan", "link": "https://stackoverflow.com/users/1362568/mike-kinghan"}, "is_accepted": true, "score": 0, "last_activity_date": 1456487341, "last_edit_date": 1456487341, "creation_date": 1456431623, "answer_id": 35637514, "question_id": 35505329, "link": "https://stackoverflow.com/questions/35505329/failed-to-install-system-win32-com/35637514#35637514", "title": "Failed to install System.Win32.Com", "body": "<p>You are building with an incompatible C compiler, e.g the <code>x86_64-w64-mingw32</code> toolchain\nthat is installed with <a href=\"https://www.haskell.org/downloads/windows\" rel=\"nofollow\">MinGHC installer for GHC 7.10.2 (64-bit)</a>.\nIt will produce the errors you are seeing. The <code>mingw32</code> that is installed with <a href=\"https://www.haskell.org/downloads/windows\" rel=\"nofollow\">MinGHC installer for GHC 7.10.2 (32-bit)</a>\nwill not produce them.</p>\n\n<p>Building the package with 32-bit GCC will mean that you can build it on 64 or 32 bit Windows and\nit will execute on 64 or 32 bit Windows, but you cannot link 32-bit with 64-bit package libraries together.</p>\n\n<p>That may be academic, however, as building this package (<code>cabal install com</code>) using the 32-bit\ncompiler just gets you as far as a later ghc compilation error:</p>\n\n<pre><code>[ 2 of 21] Compiling System.Win32.Com.HDirect.Pointer ( System\\Win32\\Com\\HDirect\\Pointer.hs, dist\\build\\System\\Win32\\Com\\HDirect\\Pointer.o )\n*** Parser:\n*** Renamer/typechecker:\n\nSystem\\Win32\\Com\\HDirect\\Pointer.hs:102:20: Not in scope: `catch'\n</code></pre>\n\n<p>This after a variety of warnings for deprecated commandline options e.g.</p>\n\n<pre><code>on the commandline: Warning:\n    -fglasgow-exts is deprecated: Use individual extensions instead\n\non the commandline: Warning:\n    The -fvia-C flag does nothing; it will be removed in a future GHC release\n</code></pre>\n\n<p>and preprocessor directives, e.g.</p>\n\n<pre><code>System\\Win32\\Com.hs:1:12: Warning:\n    -#include and INCLUDE pragmas are deprecated: They no longer have any effect\n</code></pre>\n\n<p>This package appears to have been ill-maintained.</p>\n"}], "owner": {"reputation": 945, "user_id": 2899420, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/33ce7901ec7cd1195561a930201ae56b?s=128&d=identicon&r=PG&f=1", "display_name": "Leonid", "link": "https://stackoverflow.com/users/2899420/leonid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 35637514, "answer_count": 1, "score": 1, "last_activity_date": 1456487341, "creation_date": 1455884690, "last_edit_date": 1456484297, "question_id": 35505329, "link": "https://stackoverflow.com/questions/35505329/failed-to-install-system-win32-com", "title": "Failed to install System.Win32.Com", "body": "<p>I run virualized Windows 7 x64. Installation of <a href=\"https://hackage.haskell.org/package/com\" rel=\"nofollow\">System.Win32.Com</a> package fails. How to cope the problem?</p>\n\n<pre><code>&gt; cabal install com\nResolving dependencies...\nConfiguring com-1.2.3.1...\ncabal: Bad header file: include/comPrim.h\nThe header file contains a compile error. You can re-run configure with the\nverbosity flag -v3 to see the error messages from the C compiler.\nFailed to install com-1.2.3.1\ncabal: Error: some packages failed to install:\ncom-1.2.3.1 failed during the configure step. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>Running with <code>-v3</code> option gives errors like these:</p>\n\n<pre><code>In file included from C:\\Users\\Leo\\AppData\\Local\\Temp\\282536868.c:3:0:\n./include/comPrim.h:123:1: error: expected '=', ',', ';', 'asm' or\n'__attribute__' before 'OleInitialize'\nOleInitialize ( void* pvReserved );\n^\n./include/comPrim.h:128:1: error: expected '=', ',', ';', 'asm' or\n'__attribute__' before 'OleUninitialize'\nOleUninitialize ();\n^\n...\n</code></pre>\n\n<p>Moreover <code>-v3</code> option says that some packages cannot be found. Could it be the reason? I list only several of them. </p>\n\n<pre><code>Searching for ghcjs-pkg in path.\nCannot find ghcjs-pkg on the path\nSearching for greencard in path.\nCannot find greencard on the path\n</code></pre>\n\n<p><code>cabal</code> even doesn't know about some of them (for example <code>hmake</code>).</p>\n\n<p><strong>Update on compiler</strong>\nGCC version output:</p>\n\n<pre><code>&gt; gcc -v\nUsing built-in specs.\nCOLLECT_GCC=C:\\Program Files\\Haskell Platform\\7.10.3\\mingw\\bin/realgcc.exe\nCOLLECT_LTO_WRAPPER=C:/Program\\ Files/Haskell\\ Platform/7.10.3/mingw/bin/../lib/gcc/x86_64-w64-mingw32/5.2.0/lto-wrapper.exe\nTarget: x86_64-w64-mingw32\nConfigured with: ../gcc-5.2.0/configure --prefix=/mingw64 --with-local-prefix=/mingw64/local --build=x86_64-w64-mingw32 --host=x86_64-w64-mingw32 --target=x86_64-w64-mingw32 --with-native-system-header-dir=/mingw64/x86_64-w64-mingw32/include --libexecdir=/mingw64/lib --with-gxx-include-dir=/mingw64/include/c++/5.2.0 --enable-bootstrap --with-arch=x86-64 --with-tune=generic --enable-languages=c,lto,c++,objc,obj-c++,fortran,ada --enable-shared --enable-static --enable-libatomic --enable-threads=posix --enable-graphite --enable-fully-dynamic-string --enable-libstdcxx-time=yes --disable-libstdcxx-pch --disable-libstdcxx-debug --enable-version-specific-runtime-libs --disable-isl-version-check --enable-lto --enable-libgomp --disable-multilib --enable-checking=release --disable-rpath --disable-win32-registry --disable-nls --disable-werror --disable-symvers --with-libiconv --with-system-zlib --with-gmp=/mingw64 --with-mpfr=/mingw64 --with-mpc=/mingw64 --with-isl=/mingw64 --with-pkgversion='Rev3, Built by MSYS2 project' --with-bugurl=http://sourceforge.net/projects/msys2 --with-gnu-as --with-gnu-ld\nThread model: posix\ngcc version 5.2.0 (Rev3, Built by MSYS2 project)\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "lambda", "fixpoint-combinators"], "answers": [{"tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": false, "score": 12, "last_activity_date": 1455875614, "creation_date": 1455875614, "answer_id": 35502274, "question_id": 35502185, "link": "https://stackoverflow.com/questions/35502185/haskell-fix-keyword-failed-on-declaring-a-recursive-lambda-function/35502274#35502274", "title": "Haskell &quot;fix&quot; keyword failed on declaring a recursive lambda function", "body": "<p><code>fix</code> is not a keyword, it is a function defined in the <code>Data.Function</code> module. Therefore, to use it, you must import that module.</p>\n\n<pre><code>import Data.Function\n</code></pre>\n\n<p>or in GHCi:</p>\n\n<pre><code>:m Data.Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 2, "last_activity_date": 1455891950, "creation_date": 1455891950, "answer_id": 35507611, "question_id": 35502185, "link": "https://stackoverflow.com/questions/35502185/haskell-fix-keyword-failed-on-declaring-a-recursive-lambda-function/35507611#35507611", "title": "Haskell &quot;fix&quot; keyword failed on declaring a recursive lambda function", "body": "<p><code>fix</code> is defined as:</p>\n\n<pre><code>fix :: (a -&gt; a) -&gt; a\nfix f = let x = f x in x\n</code></pre>\n\n<p>so it expands into <code>f (f (f (f ...)))</code> i.e. an infinite sequence of nested applications of the input function <code>f</code> to some parameter <code>x</code>.</p>\n\n<p>You can give your lambda function a top-level definition e.g.</p>\n\n<pre><code>factF f n = if n == 0 then 1 else n * f (n - 1)\n</code></pre>\n\n<p>or equivalently:</p>\n\n<pre><code>factF :: (Int -&gt; Int) -&gt; (Int -&gt; Int)\nfactF f = \\n -&gt; if n == 0 then 1 else n * f (n - 1)\n</code></pre>\n\n<p>you can provide this function to <code>fix</code> to obtain a function <code>(Int -&gt; Int)</code> i.e.</p>\n\n<pre><code>fact :: (Int -&gt; Int)\nfact = fix factF\n</code></pre>\n\n<p>if you expand this definition you get</p>\n\n<pre><code>factF (factF (factF (factF ...)))\n=&gt; \\n -&gt; if n == 0 then 1 else (factF (factF (factF ...)))\n</code></pre>\n\n<p>due to laziness, the repeated applications of <code>factF</code> are only evaluated if <code>n /= 0</code> so the above function applied to <code>0</code> will evaluate immediately to 1.</p>\n\n<p>You can see in this expansion that <code>factF</code> is being provided as an argument to itself which it then applies to smaller version of <code>n</code>. Since <code>factN</code> is the same as your lambda function, the same thing is happening there - the parameter <code>f</code> inside the lambda is the lambda itself which it can then call recursively.</p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 1, "accepted_answer_id": 35507611, "answer_count": 2, "score": 1, "last_activity_date": 1563169670, "creation_date": 1455875371, "last_edit_date": 1563169670, "question_id": 35502185, "link": "https://stackoverflow.com/questions/35502185/haskell-fix-keyword-failed-on-declaring-a-recursive-lambda-function", "title": "Haskell &quot;fix&quot; keyword failed on declaring a recursive lambda function", "body": "<p>Seems a function should have a name to be recursive(in order to call itself), so how does a lambda function be recursive? </p>\n\n<p>I searched wikipedia and it says this could be done by a \"Y-combinator\". I don't have much math theory backgroup, it just tell me that \"Y-combinator\" is discovered by Haskell himself. Called \"fix\" keyword in Haskell language, I tried:</p>\n\n<pre><code>Prelude&gt; let fact = fix (\\f n -&gt; if n == 0 then 1 else n * (f (n-1)))\n\n&lt;interactive&gt;:17:12: Not in scope: \u2018fix\u2019\n</code></pre>\n\n<p>Seems failed, but how to use \"fix\" keyword to do what I expected?</p>\n"}, {"tags": ["haskell", "import"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1455869771, "post_id": 35500358, "comment_id": 58692280, "body": "<a href=\"https://github.com/tibbe/haskell-style-guide/blob/master/haskell-style.md\" rel=\"nofollow noreferrer\">Johann Tibell recommends</a> to &quot;[a]lways use explicit import lists or qualified imports for standard and third party libraries&quot;."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1455870185, "post_id": 35500358, "comment_id": 58692505, "body": "Do all-encompassing standard libraries, like Prelude or System.IO, really lend themselves to the explicit import list approach?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1455870312, "post_id": 35500358, "comment_id": 58692565, "body": "@AlexeyOrlov IMO not for prelude - but for <code>System.IO</code> etc. it&#39;s even a nice documentation - your user can see where some function he/she might not know is imported from"}], "answers": [{"comments": [{"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1455870421, "post_id": 35500485, "comment_id": 58692624, "body": "It does not look like &#39;minor inconvenience&#39;. It looks like impossibility, as there&#39;s no explicit references to stdout in my source code."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1455870497, "post_id": 35500485, "comment_id": 58692659, "body": "err ... if you don&#39;t need it then just use <code>import Turtle hiding (stdout)</code> Problem solved ... of course this raises the question why you tried <code>import System.IO hiding (stdout)</code> because obviously you did use <code>Turtle.stdout</code> in this case"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1455870532, "post_id": 35500485, "comment_id": 58692673, "body": "the <i>inconvenience</i> is prepending <code>T.</code> which seems not to much burden on the programmer IMO"}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1455873761, "post_id": 35500485, "comment_id": 58694457, "body": "In my case Turtle stdout is working: <code>echo (format (&quot;verbose: &quot;%w) verbose)</code> is my only output, and that&#39;s Turtle through and through. I have to get rid of the standard stdio."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1455870228, "last_edit_date": 1455870228, "creation_date": 1455869916, "answer_id": 35500485, "question_id": 35500358, "link": "https://stackoverflow.com/questions/35500358/haskell-dealing-with-ambiguous-imports/35500485#35500485", "title": "Haskell: dealing with ambiguous imports", "body": "<p>Well you could edit your <code>.ghci</code> file and include</p>\n\n<pre><code>:m - Prelude\n</code></pre>\n\n<p>this way GHCi should not preload the <code>Prelude</code> but like Jubobs I would suggest that you don't reuse those names in the first place or that you import (qualified) with some combination of</p>\n\n<pre><code>import Turtle hiding (stdout)\nimport qualified Turtle as T\nimport Turtle ( noOverlappingFunc, NonOverlappingType )\n</code></pre>\n\n<p>it's just the minor inconvenience of writing</p>\n\n<pre><code>T.stdout\n</code></pre>\n\n<p>instead.</p>\n\n<p><em>IMHO</em> it's not a good idea to hide stuff from the <code>Prelude</code> to much - aside from the problems you saw there is always the problem of <em>peaple</em> reading your code and their <em>expectations</em></p>\n"}], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1455870228, "creation_date": 1455869399, "question_id": 35500358, "link": "https://stackoverflow.com/questions/35500358/haskell-dealing-with-ambiguous-imports", "title": "Haskell: dealing with ambiguous imports", "body": "<p>I'm getting ambiguity warnings, sometimes errors, all the time. This is just a clear cut example. I'm using doctest:</p>\n\n<pre><code>$ stack exec doctest -- src/Main.hs\n\n&lt;interactive&gt;:6:14:\n    Ambiguous occurrence \u2018stdout\u2019\n    It could refer to either \u2018Turtle.stdout\u2019,\n                         imported from \u2018Turtle\u2019 at src/Main.hs:6:1-13\n                         (and originally defined in \u2018Turtle.Prelude\u2019)\n                      or \u2018System.IO.stdout\u2019,\n                         imported from \u2018System.IO\u2019\n                         (and originally defined in \u2018GHC.IO.Handle.FD\u2019)\n...\nExamples: 2  Tried: 2  Errors: 0  Failures: 0\n</code></pre>\n\n<p>It obviously works, at least for the time being, but these warnings are voluminous, annoying, and probably dangerous.</p>\n\n<p>I tried to cope with hiding, like this (Main.hs, all the imports):</p>\n\n<pre><code>import Turtle\nimport Prelude hiding (FilePath)\nimport System.IO hiding (FilePath, stdout, stderr) -- trying to hide std...\nimport Text.Regex.TDFA\n</code></pre>\n\n<p>but it makes no difference.</p>\n\n<p>Is there a correct general approach?</p>\n"}, {"tags": ["haskell", "operators"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1455868805, "creation_date": 1455868805, "answer_id": 35500219, "question_id": 35499942, "link": "https://stackoverflow.com/questions/35499942/how-to-use-infix/35500219#35500219", "title": "How to use ((.).(.)) infix?", "body": "<p>No, you can't. An infix operator can only be either</p>\n\n<ul>\n<li><p>An actual named infix. Indeed it's common to define</p>\n\n<pre><code>(.:) :: (c-&gt;d) -&gt; (a-&gt;b-&gt;c) -&gt; a-&gt;b-&gt;d\n(.:) = (.).(.)\n</code></pre>\n\n<p>locally.</p></li>\n<li><p>A named function in backticks.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1455869879, "post_id": 35500354, "comment_id": 58692343, "body": "What&#39;s interesting is this:  <code>:t ((.).(.)) undefined undefined</code> yields  <code>((.).(.)) undefined undefined :: a -&gt; a1 -&gt; c</code> and <code>:t undefined (.).(.) undefined</code> yields <code>undefined (.).(.) undefined :: (a -&gt; b) -&gt; c</code> in GHCI."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "reply_to_user": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 1, "creation_date": 1455870499, "post_id": 35500354, "comment_id": 58692660, "body": "@Ana This one is even more complicated. An operator in <code>()</code> are treated as a normal named function, also function application (white space) has higher precedence than function composition <code>.</code>, so <code>undefined (.) . (.) undefined</code> is actually <code>(undefined (.)) . ((.) undefined)</code>."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "reply_to_user": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1455871554, "post_id": 35500354, "comment_id": 58693196, "body": "In <code>undefined (.)</code>, <code>undefined</code> is expanded to <code>((b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)) -&gt; v&#39;</code> where <code>v&#39;</code> is free, so <code>undefind (.)</code> has type <code>v&#39;</code> just like <code>undefined</code> itself. In <code>(.) undefined</code>, <code>undefined</code> is expanded to <code>b&#39; -&gt; c&#39;</code> so <code>(.) undefined</code> is resolved to type <code>(a&#39; -&gt; b&#39;) -&gt; (a&#39; -&gt; c&#39;)</code>, by applying the middle <code>.</code> <code>v&#39;</code> expended to <code>(a&#39; -&gt; c&#39;) -&gt; r&#39;</code>, so the result type is in form <code>(a&#39; -&gt; b&#39;) -&gt; r&#39;</code>."}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 4, "last_activity_date": 1455938114, "last_edit_date": 1495540232, "creation_date": 1455869377, "answer_id": 35500354, "question_id": 35499942, "link": "https://stackoverflow.com/questions/35499942/how-to-use-infix/35500354#35500354", "title": "How to use ((.).(.)) infix?", "body": "<p>No you can't.</p>\n\n<p>Only two kinds of infix operator exist in haskell:</p>\n\n<ol>\n<li>A single token that is one or more operator symbols. For all the operator symbols please read <a href=\"https://stackoverflow.com/questions/10548170/what-characters-are-permitted-for-haskell-operators\">What characters are permitted for haskell operators?</a></li>\n<li>A single identifier between two backticks. An identifier is a token that satisfies certain conditions: please read <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-180002.4\" rel=\"nofollow noreferrer\">https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-180002.4</a></li>\n</ol>\n\n<p>So <code>&lt;$&gt;</code> is a legal infix operator, and <code>`f`</code>, but not <code>`f x`</code>. To test if something is a single token try <code>lex \"YOUR_TOKEN\"</code>. It's a good test with three exceptions (reference from <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:lex\" rel=\"nofollow noreferrer\">the documentation of <code>Prelude</code></a>):</p>\n\n<ul>\n<li>Qualified names are not handled properly</li>\n<li>Octal and hexadecimal numerics are not recognized as a single token</li>\n<li>Comments are not treated properly</li>\n</ul>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 2, "accepted_answer_id": 35500354, "answer_count": 2, "score": 2, "last_activity_date": 1455938114, "creation_date": 1455867723, "question_id": 35499942, "link": "https://stackoverflow.com/questions/35499942/how-to-use-infix", "title": "How to use ((.).(.)) infix?", "body": "<p>As is known:</p>\n\n<pre><code>((.).(.)) :: (b -&gt; c) -&gt; (a -&gt; a1 -&gt; b) -&gt; a -&gt; a1 -&gt; c\n</code></pre>\n\n<p>I can use this compound operator prefix-style like this:</p>\n\n<pre><code>((.).(.)) f g\n</code></pre>\n\n<p>But it appears I cannot use it infix like this:</p>\n\n<pre><code>f ((.).(.)) g\n</code></pre>\n\n<p>Is there a way to use this infix style without defining another operator or using a predefined one in a package?</p>\n"}, {"tags": ["list", "haskell", "infinite", "fold"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 2, "creation_date": 1455861548, "post_id": 35498266, "comment_id": 58688524, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/7396978/left-and-right-folding-over-an-infinite-list\">Left and Right Folding over an Infinite list</a>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1455861708, "post_id": 35498266, "comment_id": 58688589, "body": "Or this one: <a href=\"https://stackoverflow.com/questions/833186/why-does-this-haskell-code-work-successfully-with-infinite-lists?rq=1\" title=\"why does this haskell code work successfully with infinite lists\">stackoverflow.com/questions/833186/&hellip;</a>. Either way, <b><i>one question per post</i></b>. Your first one is different from your second and third. The second and third are duplicates of others. Also, <code>foldr</code> does not start from the right; it associates to the right: <code>f a (f b (f c( ... ))))</code>. Clean up your question."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1455861815, "post_id": 35498266, "comment_id": 58688625, "body": "Could you elaborate on your first question?"}], "answers": [{"comments": [{"owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 0, "creation_date": 1455869720, "post_id": 35499291, "comment_id": 58692248, "body": "Shouldn&#39;t &quot;foldr f z [] = z&quot; be &quot;foldr f z [] = f z&quot;? I suppose f should be applied?"}, {"owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 0, "creation_date": 1455869769, "post_id": 35499291, "comment_id": 58692277, "body": "And what does <code>f</code> mean?"}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "reply_to_user": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "edited": false, "score": 0, "creation_date": 1455875213, "post_id": 35499291, "comment_id": 58695404, "body": "Infix application of <b>f</b> (you should really go at least through LYAH, as it is near impossible to discuss things when most basic syntax is not known). This also means that f is a function with two arguments, so no, it would not make sense to apply it to z in the first equation."}], "tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 2, "last_activity_date": 1455865441, "creation_date": 1455865441, "answer_id": 35499291, "question_id": 35498266, "link": "https://stackoverflow.com/questions/35498266/why-right-folding-can-process-infinite-list-in-haskell/35499291#35499291", "title": "Why right folding can process infinite list in Haskell?", "body": "<p>You need to familiarize with the syntax a bit.\nIn Haskell, a function definition goes like this:</p>\n\n<pre><code> this   =   that\n</code></pre>\n\n<p>and, basically, it means: When you see <em>this</em> it means <em>that</em>. In fact</p>\n\n<pre><code>True &amp;&amp; x \n</code></pre>\n\n<p>is the same as <code>x</code>, and </p>\n\n<pre><code>False &amp;&amp; x \n</code></pre>\n\n<p>is <code>False</code>, that is why we can write the definitions as in your example.</p>\n\n<p>For your second question: it is not the case that <code>foldr</code> \"stops\". It is the <code>&amp;&amp;</code> operator who does not evaluate its right operand, when the left one is <code>False</code>.</p>\n\n<p>For your 3rd question: no, <code>foldr</code> does not start from the last element of a list. Please have a look at the definition of foldr:</p>\n\n<pre><code>foldr f z [] = z\nfoldr f z (x:xs) = x `f`  foldr f z xs\n</code></pre>\n\n<p>Now suppose</p>\n\n<pre><code>foldr (&amp;&amp;) True (False:xs)\n</code></pre>\n\n<p>it evaluates to</p>\n\n<pre><code>False &amp;&amp; foldr (&amp;&amp;) True xs\n</code></pre>\n\n<p>And since</p>\n\n<pre><code>False &amp;&amp; _\n</code></pre>\n\n<p>is <code>False</code>, the result is <code>False</code></p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 1, "last_activity_date": 1455928155, "last_edit_date": 1455928155, "creation_date": 1455910887, "answer_id": 35513624, "question_id": 35498266, "link": "https://stackoverflow.com/questions/35498266/why-right-folding-can-process-infinite-list-in-haskell/35513624#35513624", "title": "Why right folding can process infinite list in Haskell?", "body": "<p>Let's repeat your definitions and add a couple more:</p>\n\n<pre><code>(&amp;&amp;)::Bool-&gt;Bool-&gt;Bool\nTrue &amp;&amp; x = x\nFalse &amp;&amp; _ = False\n\nand :: [Bool]-&gt;Bool\nand xs = foldr (&amp;&amp;) True xs\n\nrepeat :: a -&gt; [a]\nrepeat a = a : repeat a\n\nfoldr :: (a -&gt; r -&gt; r) -&gt; r -&gt; [a] -&gt; r\nfoldr _ z [] = z\nfoldr f z (a:as) = f a (foldr f z as)\n</code></pre>\n\n<p>Now, we can prove this by evaluating it manually, taking care to do it \"lazily\" (outermost applications first, and evaluating only enough to resolve the outermost data constructors):</p>\n\n<pre><code>and (repeat False)\n  = foldr (&amp;&amp;) True (repeat False)           -- definition of `and`\n  = foldr (&amp;&amp;) True (False : repeat False)   -- definition of `repeat`\n  = False &amp;&amp; foldr (&amp;&amp;) True (repeat False)  -- `foldr`, second equation\n  = False                                    -- `&amp;&amp;`, second equation\n</code></pre>\n\n<p>The key is that the second equation of the definition of <code>&amp;&amp;</code> discards its second argument:</p>\n\n<pre><code>False &amp;&amp; _ = False\n</code></pre>\n\n<p>This means, in runtime terms, that we never force <code>foldr</code>'s recursive call at a step where we encounter <code>False</code>.</p>\n\n<p>Another way to look at it is to contemplate <code>foldr</code>'s second equation, and what it means when we have lazy evaluation:</p>\n\n<pre><code>foldr f z (a:as) = f a (foldr f z as)\n</code></pre>\n\n<p>Since the recursive call to <code>foldr</code> happens as an argument to <code>f</code>, this means that, at runtime, the function <code>f</code> decides whether the value of its second argument is necessary or not, and so chooses at each step of the fold whether to recurse down the list or not.  And this \"decision\" process proceeds from left to right.</p>\n\n<hr>\n\n<blockquote>\n  <p>In my understanding foldr will loop through the list from tail till head. Is there any internal \"break\" mechanism?</p>\n</blockquote>\n\n<p>Strictly speaking, in a pure functional language there is no intrinsic notion of evaluation order.  Expressions may be evaluated in any order that's consistent with their data dependencies.  </p>\n\n<p>What you've said here is a common misunderstanding that people who've learned <code>foldr</code> from impure, eager languages carry over to Haskell.  In an eager language that's a useful rule of thumb, but in Haskell, with purity lazy evaluation, that rule will only confuse you.  Often the <em>opposite</em> rule of thumb is useful when programming Haskell: <code>foldr</code> will visit the list elements from left to right, and at each step its <code>f</code> argument function gets to decide whether the rest of the list is necessary.</p>\n\n<p>The extreme example of this is to implement a function to get the head of a list using <code>foldr</code>:</p>\n\n<pre><code>-- | Return `Just` the first element of the list, or `Nothing` if the\n-- list is empty.\nsafeHead :: [a] -&gt; Maybe a\nsafeHead = foldr (\\a _ -&gt; Just a) Nothing\n</code></pre>\n\n<p>So for example:</p>\n\n<pre><code>safeHead [1..]\n  = foldr (\\a _ -&gt; Just a) Nothing [1..]\n  = foldr (\\a _ -&gt; Just a) Nothing (1:[2..])\n  = (\\a _ -&gt; Just a) 1 (foldr (\\a _ -&gt; Just a) Nothing [2..])\n  = Just 1\n</code></pre>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 1, "accepted_answer_id": 35513624, "answer_count": 2, "score": 2, "last_activity_date": 1455928155, "creation_date": 1455861253, "last_edit_date": 1455871387, "question_id": 35498266, "link": "https://stackoverflow.com/questions/35498266/why-right-folding-can-process-infinite-list-in-haskell", "title": "Why right folding can process infinite list in Haskell?", "body": "<p>For an infinite list, there's no \"last\" element of it. So how could <code>foldr</code> work with it?</p>\n\n<p>I've this code snippet from the Haskell book:</p>\n\n<pre><code>(&amp;&amp;)::Bool-&gt;Bool-&gt;Bool\nTrue &amp;&amp; x = x\nFalse &amp;&amp; _ = False\n\nand' :: [Bool]-&gt;Bool\nand' xs=foldr (Main.&amp;&amp;) True xs\n</code></pre>\n\n<p>Then in Prelude load this hs file and run:</p>\n\n<pre><code>*Main&gt; and' (repeat False)\nFalse\n</code></pre>\n\n<p>It works as expected, but I don't understand:</p>\n\n<ol>\n<li>The definition of the <code>(&amp;&amp;)</code> receives boolean on the left of it,\n   but we apply <code>True &amp;&amp; x = x</code> while the variable <code>x</code> is in its right side. \n   Isn't it strange?</li>\n<li>Why <code>foldr</code> stops when <code>(&amp;&amp;)</code> returns <code>False</code>?\n   In my understanding <code>foldr</code> will loop through the list from tail till head.\n   Is there any internal \"break\" mechanism?</li>\n<li><code>foldr</code> starts from the last element of a list, but infinite list has no end. \n   How does <code>foldr</code> begin to work?</li>\n</ol>\n"}, {"tags": ["haskell", "repa"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1455860460, "post_id": 35498011, "comment_id": 58688075, "body": "There&#39;s <code>iterateUntilM_</code> in the same package."}, {"owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1455875902, "post_id": 35498011, "comment_id": 58695875, "body": "I guess this works, it requires the evolving function to have a wrapper to keep track of the counter. Do you know of a more elegant way?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 2, "creation_date": 1455877766, "post_id": 35498011, "comment_id": 58697116, "body": "If your evolving function will work on delayed repa arrays then you can repeat and compose your function, apply it to the array once instead of make a whole concrete intermediate array every step in IO monad. I believe repa is more optimized than monad-loops that way."}, {"owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1455892568, "post_id": 35498011, "comment_id": 58706470, "body": "This seems like a good method, but does it provide a convenient way to save the intermediate results?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1455894680, "post_id": 35498011, "comment_id": 58708054, "body": "If you want all the intermediate results then <code>iterateNM</code> in <a href=\"http://hackage.haskell.org/package/vector-0.11.0.0/docs/Data-Vector-Fusion-Stream-Monadic.html#v:iterateNM\" rel=\"nofollow noreferrer\">vector</a> package will iterate exactly n times and restore all the results in a lazy stream."}, {"owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1456188294, "post_id": 35498011, "comment_id": 58821638, "body": "As follow up, <code>iterateUntilM_</code> worked for me. I wrapped the function with a counter. If you want you can submit that as the answer and I can mark it as correct."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1456228720, "post_id": 35498011, "comment_id": 58840363, "body": "It&#39;s very kind of you, but as I almost got no details from your question, what I made so far are effectively suggestions, not answers. BTW It will be great if you can conclude your (simplified) code as an answer and show the reason of your decision, for someone it may save the day one day."}], "owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1455861908, "creation_date": 1455860119, "last_edit_date": 1455861908, "question_id": 35498011, "link": "https://stackoverflow.com/questions/35498011/run-iteratem-a-specific-number-of-times-haskellrepa", "title": "Run iterateM_ a specific number of times (Haskell)(Repa)", "body": "<p>I have a simulation where the result of each step is the input for the next step.\nThe simulation itself uses the IO Monad (Repa:ComputeP) and I would like to write the result of each step to a file as it is running.</p>\n\n<p>The closest I can think of using is the <code>iterateM_</code> action on my simulation step, but this will run forever. Is there a way to only call the <code>iterateM_</code> a specific number of times?</p>\n\n<p>Relevant code:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  us &lt;- iterateM_ (\\u -&gt; (computeP (simulStep u) :: IO (Array U DIM2 Double))) u0\n  zipWithM_ writeMatrixToTextFile (map show [1..]) us\n</code></pre>\n\n<p>(Or is there a better alternative for what I would like to do)</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 4, "creation_date": 1455859251, "post_id": 35497534, "comment_id": 58687634, "body": "Your title indicates <code>Traversable</code>, your <code>sequenceMonoid</code> only <code>Foldable</code>. Which one do you want? Also, <code>sequenceMonoid</code> is <code>foldr (liftA2 mappend) (return mempty)</code>."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 4, "creation_date": 1455864425, "post_id": 35497534, "comment_id": 58689672, "body": "<code>foldMap id</code> is the generialized version of <code>mconcat</code> that works on all <code>Foldable</code>s. Your function can be defined as <code>\\t -&gt; foldMap id &lt;$&gt; sequence t</code>."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 2, "last_activity_date": 1457038140, "creation_date": 1457038140, "answer_id": 35782743, "question_id": 35497534, "link": "https://stackoverflow.com/questions/35497534/an-instance-of-sequence-for-monad-m-monoid-a-foldable-t-t-m-a/35782743#35782743", "title": "An instance of sequence for (Monad m, Monoid a, Foldable t) =&gt; t (m a)?", "body": "<p>This appears to be the most succinct way to write what you want (and also indicates why, as a trivial composition, it isn't included directly in the libs).</p>\n\n<pre><code>&gt; :t fmap fold . sequence\nfmap fold . sequence :: (Monad f, Traversable t, Monoid b) =&gt; t (f b) -&gt; f b\n</code></pre>\n\n<p>You can generalize <code>sequence</code> to <code>sequenceA</code> to get something even slightly more general.</p>\n\n<pre><code>&gt; :t fmap fold . sequenceA\nfmap fold . sequenceA :: (Applicative f, Traversable t, Monoid b) =&gt; t (f b) -&gt; f b\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 978437, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/465985b0882efcb522ecc9efc6d5f98b?s=128&d=identicon&r=PG", "display_name": "NerdGGuy", "link": "https://stackoverflow.com/users/978437/nerdgguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "accepted_answer_id": 35782743, "answer_count": 1, "score": 2, "last_activity_date": 1457038140, "creation_date": 1455857384, "last_edit_date": 1455874001, "question_id": 35497534, "link": "https://stackoverflow.com/questions/35497534/an-instance-of-sequence-for-monad-m-monoid-a-foldable-t-t-m-a", "title": "An instance of sequence for (Monad m, Monoid a, Foldable t) =&gt; t (m a)?", "body": "<p>Given:</p>\n\n<pre><code>sequence :: (Monad m, Traversable t) =&gt; t (m a) -&gt; m (t a)\nsequence_ :: (Monad m, Foldable t) =&gt; t (m a) -&gt; m ()\n</code></pre>\n\n<p>Want:</p>\n\n<pre><code>sequenceMonoid :: (Monad m, Foldable t, Monoid t1) =&gt; t (m t1) -&gt; m t1\nsequenceMonoid = foldr (\\m m' -&gt; do { x &lt;- m; xs &lt;- m'; return (x `mappend` xs) }) (return mempty)\n</code></pre>\n\n<p>To be clear a list only version should be definable as:</p>\n\n<pre><code>sequenceMonoid :: (Monad m, Monoid t1) =&gt; [m t1] -&gt; m t1\nsequenceMonoid x = mconcat &lt;$&gt; (sequence x)\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>sequenceMonoid [Just [1,2],Just [3,4]]\nJust [1,2,3,4]\n</code></pre>\n\n<p>Would this definition be correct? If it is I would have expected this to be a common pattern that already existed somewhere in the existing Monoid libraries?</p>\n"}, {"tags": ["haskell", "data-structures"], "comments": [{"owner": {"reputation": 2342, "user_id": 1683460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2535857ac59d18baeda7b081c645f901?s=128&d=identicon&r=PG", "display_name": "Twan van Laarhoven", "link": "https://stackoverflow.com/users/1683460/twan-van-laarhoven"}, "edited": false, "score": 0, "creation_date": 1455880897, "post_id": 35496975, "comment_id": 58699189, "body": "What properties of trees do you need besides this <code>difference</code> function? Do you also need fast insertion? membership tests? And what are the types of elements? Are these from an arbitrary type, or an opaque key type that is unique to the tree?"}, {"owner": {"reputation": 121, "user_id": 5327218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec9913c411058f1730f9c80e10cf91f?s=128&d=identicon&r=PG", "display_name": "Joel Dice", "link": "https://stackoverflow.com/users/5327218/joel-dice"}, "reply_to_user": {"reputation": 2342, "user_id": 1683460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2535857ac59d18baeda7b081c645f901?s=128&d=identicon&r=PG", "display_name": "Twan van Laarhoven", "link": "https://stackoverflow.com/users/1683460/twan-van-laarhoven"}, "edited": false, "score": 0, "creation_date": 1455891784, "post_id": 35496975, "comment_id": 58705881, "body": "Yes, I need fast insertion, deletion, and lookup (e.g. O(log n)).  The element types in my case are application-specific record types keyed with <code>ByteString</code>s (i.e. I&#39;d be using it as a <code>Map</code>, not just as a <code>Set</code>), but ideally this would work for any key type that&#39;s an instance of <code>Ord</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1456098698, "post_id": 35496975, "comment_id": 58776166, "body": "General <code>Ord</code> keys can kill efficiency, in comparison with more structured keys. That is especially true in your case because two equivalent trees may be balanced differently. I imagine tries, PATRICIA trees, etc., could offer much better diff performance."}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 5327218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec9913c411058f1730f9c80e10cf91f?s=128&d=identicon&r=PG", "display_name": "Joel Dice", "link": "https://stackoverflow.com/users/5327218/joel-dice"}, "edited": false, "score": 0, "creation_date": 1455893754, "post_id": 35507974, "comment_id": 58707369, "body": "Thanks, Twan.  That works well for the example I gave, but maybe I should have provided more context in my question.  The scenario I have is similar to a version control system where each new version is derived from the previous one, and I might need to find the differences between any two versions.  So there isn&#39;t just one single large tree <code>x</code> I need to compare against, but many.  I&#39;ll update the question to clarify."}], "tags": [], "owner": {"reputation": 2342, "user_id": 1683460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2535857ac59d18baeda7b081c645f901?s=128&d=identicon&r=PG", "display_name": "Twan van Laarhoven", "link": "https://stackoverflow.com/users/1683460/twan-van-laarhoven"}, "is_accepted": false, "score": 1, "last_activity_date": 1455893108, "creation_date": 1455893108, "answer_id": 35507974, "question_id": 35496975, "link": "https://stackoverflow.com/questions/35496975/search-tree-with-efficient-diff-for-derived-trees/35507974#35507974", "title": "Search tree with efficient diff for derived trees", "body": "<p>If there is a single large tree <code>x</code> that you want to know the difference to, then\ninstead of computing the difference, you could track the changes explicitly:</p>\n\n<pre><code>-- extend a map with some insertions and deletions\ndata ExtMap k v = ExtMap { baseMap :: Map k v, changes :: Map k (Maybe v) }\n\nfromMap :: Map k v -&gt; ExtMap k v\nfromMap x = ExtMap x Map.empty\n\ntoMap :: Ord k =&gt; ExtMap k v -&gt; Map k v\ntoMap (ExtMap x y) = Map.mergeWithKey (\\_ _ u -&gt; u) id id x y\n\nlookup :: Ord k =&gt; k -&gt; ExtMap k v -&gt; Maybe v\nlookup k (ExtMap x y) = case Map.lookup k y of\n  Just mv -&gt; mv             -- if there is a change for this key, return that\n  Nothing -&gt; Map.lookup k x -- otherwise look in the base map\n\ninsert :: Ord k =&gt; k -&gt; v -&gt; ExtMap k v -&gt; ExtMap k v\ninsert k v (ExtMap x y) = ExtMap x (Map.insert k (Just v) y)\n\ndelete :: Ord k =&gt; k -&gt; ExtMap k v -&gt; ExtMap k v\ndelete k (ExtMap x y) = ExtMap x (Map.insert k Nothing y)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 5327218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec9913c411058f1730f9c80e10cf91f?s=128&d=identicon&r=PG", "display_name": "Joel Dice", "link": "https://stackoverflow.com/users/5327218/joel-dice"}, "is_accepted": false, "score": 1, "last_activity_date": 1456095761, "last_edit_date": 1456095761, "creation_date": 1456083575, "answer_id": 35541023, "question_id": 35496975, "link": "https://stackoverflow.com/questions/35496975/search-tree-with-efficient-diff-for-derived-trees/35541023#35541023", "title": "Search tree with efficient diff for derived trees", "body": "<p>I went ahead and <a href=\"https://github.com/wuxb45/Haskell-RBTree/compare/master...dicej:master?w=0\" rel=\"nofollow\">implemented this</a> myself, modifying Wu Xingbo's RBTree to support values annotated with version information which can then be used to calculate a difference efficiently using <code>diffVersion</code>.</p>\n"}], "owner": {"reputation": 121, "user_id": 5327218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec9913c411058f1730f9c80e10cf91f?s=128&d=identicon&r=PG", "display_name": "Joel Dice", "link": "https://stackoverflow.com/users/5327218/joel-dice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1456095761, "creation_date": 1455853818, "last_edit_date": 1455894170, "question_id": 35496975, "link": "https://stackoverflow.com/questions/35496975/search-tree-with-efficient-diff-for-derived-trees", "title": "Search tree with efficient diff for derived trees", "body": "<p>I'm looking for a search tree implementation in Haskell which provides an efficient difference function for trees which share structure.  For example, if I have a large tree <code>x</code> (e.g. with millions of elements) and I insert three new elements into it to produce <code>x'</code>, I'd like to be able to invoke <code>difference x x'</code> to get those elements back, where <code>difference</code> is implemented such that the elements of interest are found by only visiting the nodes not shared between the two trees.</p>\n\n<p>The scenario I have in mind is like that of a version control system, where each new version is derived from the previous one, and we may need to find the difference between any two versions.</p>\n\n<p>The data structure should support efficient insertion, deletion, and lookup operations (e.g. O(log n)) as well.</p>\n\n<p>Such an implementation would rely on something like System.Mem.StableName or Data.Unique.Id to label each node in the tree uniquely, allowing the <code>difference</code> function to efficiently recognize shared structure and avoid descending into it.</p>\n\n<p>Does something like this exist already?  If not, what's a good strategy for implementing it?  I was thinking of modifying something like Wu Xingbo's RBTree implementation to add unique labels to each node, but I'm open to other options.</p>\n"}, {"tags": ["parsing", "haskell", "overloading", "operator-keyword"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 4, "creation_date": 1455852696, "post_id": 35496786, "comment_id": 58685769, "body": "The type of <code>xs</code> should be <code>[Bool]</code> but not <code>(Bool)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 5, "last_activity_date": 1455854695, "creation_date": 1455854695, "answer_id": 35497096, "question_id": 35496786, "link": "https://stackoverflow.com/questions/35496786/overloading-global-operator-in-haskell-fails-to-compile/35497096#35497096", "title": "Overloading global &amp;&amp; operator in Haskell fails to compile", "body": "<p>As @zakyggaps said in his comment, <code>(Bool)</code> is the same as <code>Bool</code>.  You clearly mean <code>[Bool]</code>.  Also, you aren't really \"overloading\" this function so much as defining a similarly named one in a different module.  \"Shadowing\" at best, but not even that really.</p>\n"}, {"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 3, "last_activity_date": 1455859906, "creation_date": 1455859906, "answer_id": 35497971, "question_id": 35496786, "link": "https://stackoverflow.com/questions/35496786/overloading-global-operator-in-haskell-fails-to-compile/35497971#35497971", "title": "Overloading global &amp;&amp; operator in Haskell fails to compile", "body": "<p>There is no overloading in Haskell. Identifiers can be shared using typeclasses, but <code>&amp;&amp;</code> is not a member of a typeclass and thus cannot be shared. When you define your own <code>&amp;&amp;</code> operator, it conflicts with the one automatically imported in the Prelude. To use your <code>&amp;&amp;</code> without qualification, you must hide <code>Prelude.&amp;&amp;</code> as follows:</p>\n\n<pre><code>import Prelude hiding ((&amp;&amp;))\n\n(&amp;&amp;) :: Bool -&gt; Bool -&gt; Bool\nTrue &amp;&amp; b = b\nFalse &amp;&amp; _ = False\n</code></pre>\n\n<p>The second error is a mistake or typo in the type of <code>and'</code>, which should be <code>and' :: [Bool] -&gt; Bool</code> rather than <code>and' :: (Bool) -&gt; Bool</code>. </p>\n"}], "owner": {"reputation": 2435, "user_id": 4927124, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/a2c38fe9dba3e504a51d5b74973e431e?s=128&d=identicon&r=PG&f=1", "display_name": "vik santata", "link": "https://stackoverflow.com/users/4927124/vik-santata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 35497971, "answer_count": 2, "score": 0, "last_activity_date": 1455859906, "creation_date": 1455852428, "question_id": 35496786, "link": "https://stackoverflow.com/questions/35496786/overloading-global-operator-in-haskell-fails-to-compile", "title": "Overloading global &amp;&amp; operator in Haskell fails to compile", "body": "<p>I've got a hs file, trying to overload &amp;&amp; operator</p>\n\n<pre><code>(&amp;&amp;)::Bool-&gt;Bool-&gt;Bool\nTrue &amp;&amp; x = x\nFalse &amp;&amp; _ = False\n\nand' :: (Bool)-&gt;Bool\nand' xs=foldr (&amp;&amp;) True xs\n</code></pre>\n\n<p>When imported in Prelude, there's error:</p>\n\n<pre><code>Ambiguous occurrence \u2018&amp;&amp;\u2019\nIt could refer to either \u2018Main.&amp;&amp;\u2019, defined at D:\\baby.hs:2:6\n                      or \u2018Prelude.&amp;&amp;\u2019,\n                         imported from \u2018Prelude\u2019 at D:\\baby.hs:1:1\n                         (and originally defined in \u2018GHC.Classes\u2019)\n</code></pre>\n\n<p>So I changed the last line to be</p>\n\n<pre><code>and' xs=foldr (Main.&amp;&amp;) True xs\n</code></pre>\n\n<p>Now it prints new error message:</p>\n\n<pre><code>Couldn't match expected type \u2018t0 Bool\u2019 with actual type \u2018Bool\u2019\nIn the third argument of \u2018foldr\u2019, namely \u2018xs\u2019\nIn the expression: foldr (Main.&amp;&amp;) True xs\n</code></pre>\n\n<p>How can I resolve this issue? Thanks.</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1455843473, "post_id": 35494202, "comment_id": 58683299, "body": "You may like the <code>errors</code> package, which offers, among other things, <a href=\"http://hackage.haskell.org/package/errors-2.1.2/docs/Control-Error-Util.html#v:note\" rel=\"nofollow noreferrer\"><code>note :: a -&gt; Maybe b -&gt; Either a b</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455846144, "post_id": 35494722, "comment_id": 58684030, "body": "Idiomatic as it is, I can&#39;t stand <code>zip [n..]</code>. If <code>lens</code> is about, I&#39;d use <code>itraverse</code>. Otherwise, I&#39;d write my own <code>traverseWithIndex</code> for lists."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455871769, "post_id": 35494722, "comment_id": 58693296, "body": "@dfeuer What don&#39;t you like about it?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455905600, "post_id": 35494722, "comment_id": 58714891, "body": "It doesn&#39;t really express the idea directly, and it&#39;s not so good for list fusion (only one of the lists can fuse away, and in recent GHC only the first)."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1455906465, "post_id": 35494722, "comment_id": 58715414, "body": "@dfeuer I think you&#39;re right in this instance: incorporating the logic to template the error message into <code>enrichMaybes</code> was distracting from the point which was to illustrate <code>traverse</code>. I&#39;ve adjusted the answer accordingly. (In general I do think <code>zip [1..] xs</code> is quite a clean way of saying it.) I&#39;ve Googled a bit and I can&#39;t find any discussion as to <i>why</i> <code>zip</code> only fuses one of its arguments, could you point me in the right direction?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1455909939, "post_id": 35494722, "comment_id": 58717410, "body": "I believe the reason only one can fuse is discussed in the original &quot;a short cut to deforestation&quot; paper. I successfully lobbied to stop attempting to fuse the second argument (trying only the first) because trying to fuse the second can potentially introduce bottoms (which is always bad) and in a fragile manner (which is especially bad)."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 6, "last_activity_date": 1456139327, "last_edit_date": 1456139327, "creation_date": 1455839025, "answer_id": 35494722, "question_id": 35494202, "link": "https://stackoverflow.com/questions/35494202/is-it-possible-to-leverage-monadic-structure-if-multiple-monads-are-mixed/35494722#35494722", "title": "Is it possible to leverage monadic structure if multiple monads are &quot;mixed&quot;?", "body": "<p>It seems that you want to enrich a sequence of <code>Maybe</code> actions with information pertaining to <em>which one failed</em>, if any. Why not implement <em>enriching</em> as a simple function?</p>\n\n<pre><code>enrich :: MonadError e m =&gt; e -&gt; Maybe a -&gt; m a\nenrich e Nothing = throwError e\nenrich e (Just x) = return x\n</code></pre>\n\n<p>I'm using <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Except.html#t:MonadError\" rel=\"nofollow\"><code>MonadError</code></a> - the class of monads <code>m</code> which can throw errors of type <code>e</code> - to generalise the type of <code>enrich</code>. For example, we can use it as if it had the type <code>e -&gt; Maybe a -&gt; Except e a</code> or <code>e -&gt; Maybe a -&gt; Either e a</code>, because <code>Except</code> and <code>Either</code> are both instances of <code>MonadError</code>.</p>\n\n<p>Now you just need to use <code>enrich</code> to lift your <code>Maybe</code> values into the richer monadic context one at a time.</p>\n\n<pre><code>action = do\n    x &lt;- enrich \"escape 1\" maybe1  -- look mum, no staircasing!\n    y &lt;- enrich \"escape 2\" maybe2\n    z &lt;- enrich \"escape 3\" maybe3\n    return [x, y, z]\n</code></pre>\n\n<hr>\n\n<p>If you're using your monad <em>applicatively</em> - that is, you're not using earlier results to determine later computations - there's an idiomatic way to generalise this function to work over an arbitrary number of <code>Maybe</code>s. We're going to shove the <code>Maybes</code> into a list, along with the extra data we need to enrich it - in this case, the error message. Then we can <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Traversable.html#v:traverse\" rel=\"nofollow\"><code>traverse</code></a> (n\u00e9e <a href=\"http://hackage.haskell.org/package/base-4.7.0.0/docs/Prelude.html#v:mapM\" rel=\"nofollow\"><code>mapM</code></a>) the list to enrich each <code>Maybe</code> inside it and join them up into a bigger monadic action.</p>\n\n<pre><code>enrichMaybes :: (Traversable t, MonadError e m) =&gt; t (e, Maybe a) -&gt; m (t a)\nenrichMaybes = traverse (uncurry enrich)\n\naction = enrichMaybes [(\"escape 1\", maybe1), (\"escape 2\", maybe2), (\"escape 3\", maybe3)]\n</code></pre>\n\n<p>The ability to treat effects as first-class citizens like this is why functional programming is a Good Thing.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 1, "accepted_answer_id": 35494722, "answer_count": 1, "score": 3, "last_activity_date": 1456139327, "creation_date": 1455836427, "last_edit_date": 1455874642, "question_id": 35494202, "link": "https://stackoverflow.com/questions/35494202/is-it-possible-to-leverage-monadic-structure-if-multiple-monads-are-mixed", "title": "Is it possible to leverage monadic structure if multiple monads are &quot;mixed&quot;?", "body": "<p>Consider the following code:</p>\n\n<pre><code>run = runExcept $ do\n  case Just 1 of\n    Nothing -&gt; throwE \"escape 1\"\n    Just x -&gt; do\n      case Just 2 of\n        Nothing -&gt; throwE \"escape 2\"\n        Just y -&gt; do\n          case Just 3 of\n            Nothing -&gt; throwE \"escape 3\"\n            Just z -&gt; return z\n</code></pre>\n\n<p>Pretend the <code>Just 1</code>, <code>Just 2</code>, <code>Just 3</code> are function calls that return <code>Maybe Int</code>. </p>\n\n<p>This whole function is inside an <code>ExceptT</code> because I want to throw exceptions. But inside is really just a lot of <code>Maybe</code> values being manipulated.</p>\n\n<p>So, is it possible for me to leverage the behaviour of a <code>Maybe</code> monad to avoid the stair-casing while still being able to throw exceptions?</p>\n"}, {"tags": ["macos", "haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1455846342, "post_id": 35493591, "comment_id": 58684090, "body": "I don&#39;t have access to a computer with OS X, but on both windows and linux <code>&quot;fileName&quot;</code> and <code>&quot;.&#47;fileName&quot;</code> work, it is probably the case that OS X is starting your executable in a different directory than you think. If you are just trying to do this &quot;for debugging&quot; then it is probably best to abandon it, as such platform-independence is just going to be a big headache... if you actually needed to do this portably, you should use cabals <code>data-dir</code> section, instead of relying on things like &quot;the current directory&quot;."}, {"owner": {"reputation": 30926, "user_id": 767890, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e169a8a6d170a77b83dd8244df5f6890?s=128&d=identicon&r=PG", "display_name": "InBetween", "link": "https://stackoverflow.com/users/767890/inbetween"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455879797, "post_id": 35493591, "comment_id": 58698509, "body": "@user2407038 I normally execute a scrip file located in the source directoy that deletes *.o files and such and launches the executable. Even if I manually run the executable by double clicking on it,I get the same error. I know very little about OS X but I can&#39;t quite figure out how the executable can be starting in a different directory in such circumstances. You are right thought about making this platform independent and will look into <code>System.Directory</code>"}], "owner": {"reputation": 30926, "user_id": 767890, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e169a8a6d170a77b83dd8244df5f6890?s=128&d=identicon&r=PG", "display_name": "InBetween", "link": "https://stackoverflow.com/users/767890/inbetween"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1456899098, "answer_count": 0, "score": 0, "last_activity_date": 1455833981, "creation_date": 1455833981, "question_id": 35493591, "link": "https://stackoverflow.com/questions/35493591/coding-a-relative-path-to-file-in-os-x", "closed_reason": "Duplicate", "title": "Coding a relative path to file in OS X", "body": "<p>In a Haskell project I'm working on I normally use a windows environment. For debugging purposes I'm loading up a file located in the same folder as my source code. </p>\n\n<p>In windows, this works: </p>\n\n<pre><code>main = do\n    foo &lt;- ByteString.readFile \"fileName.foo\";\n    -- whatever\n</code></pre>\n\n<p>However when I build this project in OS X and run it, I get a file not found error. How exactly do I specify the path to a file that is located in the executable's folder?</p>\n"}, {"tags": ["haskell", "pandoc"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455847205, "post_id": 35491660, "comment_id": 58684328, "body": "It seems to work on my machine, i.e. if I build pandoc with <code>emded_data_files</code> there is no longer a dependence on the data files on disk. But I am not using stack or debian. What precisely did you do (or did stack do) after you changed the flag? Pandoc needs to be rebuilt. Also, is <code>&#47;home&#47;Zeta&#47;.stack&#47;snapshots&#47;...&#47;pandoc-1.16.0.2&#47;data&#47;templat&zwnj;&#8203;es&#47;default.latex</code> precisely the path it prints or have you shortened it for readers of your question? Because <code>&#47;...&#47;</code> doesn&#39;t seem right.. could be pandoc is mangling your path?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455856710, "post_id": 35491660, "comment_id": 58686822, "body": "@user2407038: The path is shortened, since <code>...</code> contains resolver specific information, which aren&#39;t interesting. And yes, I rebuilt pandoc: I removed the snapshot (to test whether it was platform independent), changed the flag, and then rebuilt the application and its dependencies. That being said, I&#39;m actually using Windows and just unixified the paths for better understanding."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1455859091, "last_edit_date": 1455859091, "creation_date": 1455858781, "answer_id": 35497776, "question_id": 35491660, "link": "https://stackoverflow.com/questions/35491660/can-i-automatically-embed-pandocs-default-templates-in-my-application/35497776#35497776", "title": "Can I automatically embed pandoc&#39;s default templates in my application?", "body": "<p>It turns out that <code>pandoc</code> injects its data files during its build via <code>hsb2hs</code>. Somehow that step failed during <code>stack build</code> I missed the error message. </p>\n\n<p>Neither <code>hsb2hs</code> nor its main dependency <code>processing-tools</code> are part of stack's LTS, they're only in the nightly stackage versions. The following additions to <code>stack.yaml</code> fixed the problem:</p>\n\n<pre><code># part of stack.yaml:\nextra-deps:\n- preprocessor-tools-1.0.1\n- hsb2hs-0.3.1\n- pandoc-1.16\n\nflags:\n  pandoc:\n    embed_data_files: true\n</code></pre>\n\n<p>For those using Cabal, this is somewhat equal to</p>\n\n<pre><code>cabal sandbox init\ncabal update\ncabal install hsb2hs-0.3.1 &amp;&amp; cabal install pandoc-1.16 -f embed_data_files\ncabal install --dependencies-only\ncabal build\n</code></pre>\n\n<p>Here's how I verified that the templates are actually included:</p>\n\n<pre><code>$ stack build\n$ grep \"usepackage\\{hyperref\\}\" .stack-work/install/*/bin/example -a\n\\usepackage[$for(geometry)$$geometry$$sep$,$endfor$]{geometry}\n$endif$\n\\usepackage{hyperref}\n$if(colorlinks)$\n\\PassOptionsToPackage{usenames,dvipsnames}{color} % color is loaded by hyperref\n</code></pre>\n\n<p>That snippet is part of <code>default.latex</code>, so it's really included in the binary.</p>\n"}], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 35497776, "answer_count": 1, "score": 3, "last_activity_date": 1455859091, "creation_date": 1455826851, "question_id": 35491660, "link": "https://stackoverflow.com/questions/35491660/can-i-automatically-embed-pandocs-default-templates-in-my-application", "title": "Can I automatically embed pandoc&#39;s default templates in my application?", "body": "<p>Pandoc comes with several <a href=\"https://github.com/jgm/pandoc-templates\" rel=\"nofollow\">default templates</a>, which are distributed with the <code>pandoc</code> package. However, if I write an application that uses <code>pandoc</code> as a library, those default templates don't get included in the binary. I can still use them on my machine:</p>\n\n<pre><code>module Main where\nimport Text.Pandoc (getDefaultTemplate)\n\nmain = getDefaultTemplate Nothing \"latex\" &gt;&gt;= print\n</code></pre>\n\n<p>This will print the <code>default.latex</code> template. However, it's not portable, since it really refers to a file somewhere on my system:</p>\n\n<pre><code>$ cd path/to/example/project\n$ stack build\n$ scp path/to/binary remote:remote/path\n$ ssh remote:remote/path/binary\nexample: Could not find data file /home/Zeta/.stack/snapshots/.../pandoc-1.16.0.2/data/templates/default.latex\n</code></pre>\n\n<p>Since <a href=\"https://github.com/jgm/pandoc/releases/tag/1.16.0.2\" rel=\"nofollow\">pandoc's debian package</a> does not include those files, it's somehow able to embed them. And indeed, there is a flag <code>-f embed_data_files</code>. I've tried to enable it in the local <code>stack.yaml</code>:</p>\n\n<pre><code>extra-deps: [pandoc-1.16]\nflags: \n  pandoc:\n    embed_data_files: true\n</code></pre>\n\n<p>But that didn't change anything, the compiled binary still complains about missing data files.</p>\n\n<p>So, is there any way to automatically include pandoc's template files?</p>\n"}, {"tags": ["regex", "haskell"], "comments": [{"owner": {"reputation": 27179, "user_id": 710099, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0413774874b9baeccef7a5ba0344fec7?s=128&d=identicon&r=PG", "display_name": "Federico Piazza", "link": "https://stackoverflow.com/users/710099/federico-piazza"}, "edited": false, "score": 0, "creation_date": 1455821722, "post_id": 35490029, "comment_id": 58673024, "body": "Did you try <code>[0-9]+</code>?"}, {"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1455822007, "post_id": 35490029, "comment_id": 58673208, "body": "Try with <code>:: [[String]]</code> instead of <code>:: [String]</code> (depends on the regex library version apparently)."}, {"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1455822027, "post_id": 35490029, "comment_id": 58673217, "body": "Related: <a href=\"http://stackoverflow.com/questions/9049705/all-matches-of-regex-in-haskell\"><i>All matches of regex in Haskell</i></a>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1455823562, "post_id": 35490029, "comment_id": 58674059, "body": "Which regex library do you use?"}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1455824847, "post_id": 35490029, "comment_id": 58674754, "body": "<code>*Main Text.Regex.TDFA Text.Regex.Base&gt;</code>. <code>:: [[String]]</code> does not produce any error, but I&#39;m getting <code>[]</code> for a result. Close, but no cigar."}], "answers": [{"comments": [{"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1455859989, "post_id": 35491995, "comment_id": 58687897, "body": "Thanks! Fantastic. Why this is so different from any other language? <code>\\d+</code> used to work in Python, NodeJS, PHP, Go, without particular regard to Posix or whatever."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1455860545, "post_id": 35491995, "comment_id": 58688106, "body": "@AlexeyOrlov Because there is no regex support in the standard library, and the <b>arbitrary</b> package you&#39;ve used has some quirks. Given it&#39;s quirky return type, regex is not used that often."}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1455862563, "post_id": 35491995, "comment_id": 58688906, "body": "Worse than that, while your suggestion works interactively, it won&#39;t compile with errors like  <code>No instance for (RegexMaker Regex CompOption ExecOption source0)       arising from a use of \u2018=~\u2019     The type variable \u2018source0\u2019 is ambiguous     Note: there are several potential instances:       instance RegexMaker                  Regex                  CompOption                  ExecOption ...</code>"}, {"owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1455863898, "post_id": 35491995, "comment_id": 58689435, "body": "I have to put something like this <code>let m = s =~ (&quot;[0-9]+&quot; :: String) :: [[String]]</code> inside a function of my module, to get rid of fatal errors. What is it?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "edited": false, "score": 0, "creation_date": 1455864074, "post_id": 35491995, "comment_id": 58689519, "body": "@AlexeyOrlov, yeah, a general version of <code>(?=~)</code> needs several extensions, and I don&#39;t have enough insight of <code>regex-tdfa</code> to find all sources of this issue. The simpler variant should work though."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 2, "last_activity_date": 1455864030, "last_edit_date": 1455864030, "creation_date": 1455828044, "answer_id": 35491995, "question_id": 35490029, "link": "https://stackoverflow.com/questions/35490029/haskell-regex-reduce-a-string-to-a-list-of-matches/35491995#35491995", "title": "Haskell, Regex: reduce a string to a list of matches", "body": "<p>You want to use <code>instance RegexLike a b =&gt; RegexContext a b [[b]]</code>:</p>\n\n<pre><code>&gt; \"aa2gg3tt41u\" =~ \"[0-9]+\" :: [[String]]\n[[\"2\"],[\"3\"],[\"41\"]]\n</code></pre>\n\n<p>I hear you say, <em>\"why the <code>[[String]]</code>?\"</em> Well, keep in mind that regexes support grouping:</p>\n\n<pre><code>&gt; \"aa2gg3tt41u\" =~ \"([a-z]+)[0-9]\" :: [[String]]\n[[\"aa2\",\"aa\"],[\"gg3\",\"gg\"],[\"tt4\",\"tt\"]]\n</code></pre>\n\n<p>The first element in a list will always be the complete match, followed by the sub-matches. If you're just interested in the complete match, use <code>map head</code> or provide your own operator:</p>\n\n<pre><code>(?=~) :: String -&gt; String -&gt; [String]\nstr ?=~ re = map head (str =~ re)\n</code></pre>\n"}], "owner": {"reputation": 1584, "user_id": 1134071, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/DicCu.jpg?s=128&g=1", "display_name": "Alexey Orlov", "link": "https://stackoverflow.com/users/1134071/alexey-orlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 35491995, "answer_count": 1, "score": 0, "last_activity_date": 1455864030, "creation_date": 1455821558, "question_id": 35490029, "link": "https://stackoverflow.com/questions/35490029/haskell-regex-reduce-a-string-to-a-list-of-matches", "title": "Haskell, Regex: reduce a string to a list of matches", "body": "<p>How am I supposed, say, to create a list of matches:</p>\n\n<pre><code>&gt; \"aa2gg3tt41u\" =~ \"\\\\d+\" :: [String]\n</code></pre>\n\n<p>produces an error no matter how I fool with the type annotation. I expect something like <code>[\"2\",\"3\",\"41\"]</code>.</p>\n"}, {"tags": ["haskell", "windows-7", "cabal", "frege", "ghc-mod"], "comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1455825402, "post_id": 35489688, "comment_id": 58675070, "body": "Had you choosen to use the eclipse plugin instead, you could already be productive. The IDEA plugin for Frege doesn&#39;t really have IDE like features to offer, AFAIK."}, {"owner": {"reputation": 366, "user_id": 1748144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6507115f4814c24771466038ae46473c?s=128&d=identicon&r=PG", "display_name": "Lech G\u0142owiak", "link": "https://stackoverflow.com/users/1748144/lech-g%c5%82owiak"}, "edited": false, "score": 0, "creation_date": 1455825818, "post_id": 35489688, "comment_id": 58675330, "body": "I agree with Ingo. You can also try Atom with Haskell syntax highlighting. You won&#39;t get more from IntelliJ Idea anyway."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1455830897, "post_id": 35489688, "comment_id": 58678124, "body": "You have better chances to get an answer if you add the Haskell tag, as the question is really about installing ghc-mod."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1455844657, "post_id": 35489688, "comment_id": 58683619, "body": "<code>cabal</code> does some work itself, but mainly it calls other things. Run <code>cabal install ghc-mod -v3</code> to see exactly what it&#39;s doing, and exactly what hangs. There is no evidence that any of this is related to frege or your IDE - seems to be an issue with cabal and this particular package (as evidently, it&#39;s able to install other packages) or with some linking issues (which are horribly common on windows) but usually that is an &quot;error&quot; not a hang."}, {"owner": {"reputation": 189, "user_id": 2039784, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e0af31c5d2f36159dccdf460bf98bf3?s=128&d=identicon&r=PG", "display_name": "user2039784", "link": "https://stackoverflow.com/users/2039784/user2039784"}, "edited": false, "score": 0, "creation_date": 1455910177, "post_id": 35489688, "comment_id": 58717531, "body": "I found out that the parameter -j1 needs to be added, so that the command looks like this:  &quot;cabal.exe install -j1 cabal-install -v3&quot;.  Then at the end of the console print stays:  configure: WARNING: unrecognized options: --with-compiler, --with-gcc checking build system type... x86_64-pc-mingw64 checking host system type... x86_64-pc-mingw64 checking for gcc... gcc checking whether the C compiler works... yes checking for C compiler default output file name... a.exe checking for suffix of executables... .exe checking whether we are cross compiling...  After this, it hangs again."}], "owner": {"reputation": 189, "user_id": 2039784, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0e0af31c5d2f36159dccdf460bf98bf3?s=128&d=identicon&r=PG", "display_name": "user2039784", "link": "https://stackoverflow.com/users/2039784/user2039784"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 308, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1455831731, "creation_date": 1455820467, "last_edit_date": 1455831731, "question_id": 35489688, "link": "https://stackoverflow.com/questions/35489688/installing-ghc-mod-on-windows-7-freezes-forever", "title": "Installing ghc-mod on Windows 7 freezes forever", "body": "<p>I want to enable Frege, basically Haskell on JVM (<a href=\"https://github.com/Frege\" rel=\"nofollow\">https://github.com/Frege</a>) in IntelliJ IDEA. It requires path to </p>\n\n<blockquote>\n  <p>ghc-mod</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>ghc-modi.</p>\n</blockquote>\n\n<p>Therefore, I installed Haskell Platform for Windows 64 bit. Since Cabal is already part of the Platform, I tried</p>\n\n<blockquote>\n  <p>\"cabal install ghc-mod\"</p>\n</blockquote>\n\n<p>which should have installed the package into</p>\n\n<blockquote>\n  <p>\"c:\\Users\\%Username%\\AppData\\Roaming\\cabal\\bin\"</p>\n</blockquote>\n\n<p>Cabal printed into the console</p>\n\n<pre><code>\"Resolving dependencies...\", then\n\"Downloading x\"..., and\n\"Configuring x\",\n</code></pre>\n\n<p>where x is the name of some package.</p>\n\n<p>This happened for couple of packages and then Cabal froze forever.\nWhat I did then was repeating the process with Haskell Platform 32bit, nevertheless, the result was the same.</p>\n\n<p>Based on this experience, I decided to follow a tutorial on how to install haskell parts separately (<a href=\"http://blog.nikosbaxevanis.com/2015/04/15/setting-up-haskell-on-windows/\" rel=\"nofollow\">http://blog.nikosbaxevanis.com/2015/04/15/setting-up-haskell-on-windows/</a>). I managed to download GHC for Windows, I adjusted PATH, downloaded Cabal for Windows, run</p>\n\n<blockquote>\n  <p>\"cabal.exe install\"</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>\"cabal.exe update\"</p>\n</blockquote>\n\n<p>and in a bash shell run</p>\n\n<blockquote>\n  <p>\"cabal.exe install cabal-install\"</p>\n</blockquote>\n\n<p>As in the previous case, cabal froze, I kept run it over the night, but nothing happened at all. This is just an example of what happened in the bash:</p>\n\n<pre><code>$ ./cabal-1.22.0.0-i386-unknown-mingw32.exe install cabal-install\nResolving dependencies...\nDownloading mtl-2.2.1...\nDownloading network-2.6.2.1...\nDownloading random-1.1...\nConfiguring mtl-2.2.1...\nDownloading stm-2.4.4.1...\nConfiguring network-2.6.2.1...\nDownloading text-1.2.2.0...\nConfiguring random-1.1...\nDownloading zlib-0.6.1.1...\nConfiguring stm-2.4.4.1...\n</code></pre>\n\n<p>I'm starting to feel desperate. Haskell itself run correctly when using the Platform, the only reason why I need to interact with Cabal is the ghc-mod package, just because of the IDE. At the same time, I consider having the IDE as substantial.</p>\n\n<p>Any suggestion or comment is welcome. Thanks.</p>\n"}]