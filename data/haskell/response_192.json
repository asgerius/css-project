[{"tags": ["haskell", "cabal-install", "nix", "reflex-dom"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1536791725, "post_id": 52304037, "comment_id": 91556251, "body": "Does your project require nix? If not, have you considered just using stack?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1536794313, "post_id": 52304037, "comment_id": 91556797, "body": "@MichaelLitchard The typically recommended workflows for Reflex projects involve Nix and cabal-install, rather than Stack."}, {"owner": {"reputation": 663, "user_id": 659685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b48936f512ad14a013bd1caf5640aa5e?s=128&d=identicon&r=PG", "display_name": "RecencyEffect", "link": "https://stackoverflow.com/users/659685/recencyeffect"}, "edited": false, "score": 0, "creation_date": 1536865602, "post_id": 52304037, "comment_id": 91587917, "body": "I was trying to use stack initially, in fact, but that had more problems than the current workflow. At least it was all building fine until I included snaplet-acid-state"}], "answers": [{"comments": [{"owner": {"reputation": 663, "user_id": 659685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b48936f512ad14a013bd1caf5640aa5e?s=128&d=identicon&r=PG", "display_name": "RecencyEffect", "link": "https://stackoverflow.com/users/659685/recencyeffect"}, "edited": false, "score": 1, "creation_date": 1536963921, "post_id": 52309006, "comment_id": 91626936, "body": "Jailbreaking snaplet-acid-state and heist fixed it! Apparently the former package hasn&#39;t been maintained in a while... perhaps there is a better solution for snap persistence."}], "tags": [], "owner": {"reputation": 4232, "user_id": 428586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHNYS.jpg?s=128&g=1", "display_name": "Robert Hensing", "link": "https://stackoverflow.com/users/428586/robert-hensing"}, "is_accepted": true, "score": 4, "last_activity_date": 1536826688, "last_edit_date": 1536826688, "creation_date": 1536825067, "answer_id": 52309006, "question_id": 52304037, "link": "https://stackoverflow.com/questions/52304037/workarounds-for-haskell-cabal-packages-with-constraints-with-nix-and-cabal/52309006#52309006", "title": "Workarounds for Haskell / cabal packages with constraints with Nix and Cabal?", "body": "<p>What happens with this <code>cabal2nix</code> workflow is that basically the dependency solver is forced to only consider the packages that have been provided by Nixpkgs, or in this case reflex-platform + Nixpkgs. By taking away the freedom to pick one of multiple versions, the Cabal dependency solver is reduced to a dependency <em>checker</em>.</p>\n\n<p>Now, if the version bound is too strict, you can consider what is called 'jailbreaking' in Nixpkgs: removing all version bounds from the cabal file. The other option is to change package versions.</p>\n\n<p>Gabriel Gonzalez has written <a href=\"https://github.com/Gabriel439/haskell-nix/blob/master/project4/README.md\" rel=\"nofollow noreferrer\">a good explanation of version management with Nixpkgs' Haskell infrastructure</a>. You may also check out <a href=\"https://github.com/Gabriel439/haskell-nix/issues/6\" rel=\"nofollow noreferrer\">this thread</a>. It's a bit verbose, but it discusses the <code>callHackage</code> and <code>callCabal2nix</code> functions that are quite helpful.</p>\n"}], "owner": {"reputation": 663, "user_id": 659685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b48936f512ad14a013bd1caf5640aa5e?s=128&d=identicon&r=PG", "display_name": "RecencyEffect", "link": "https://stackoverflow.com/users/659685/recencyeffect"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 52309006, "answer_count": 1, "score": 2, "last_activity_date": 1565430565, "creation_date": 1536789418, "last_edit_date": 1565430565, "question_id": 52304037, "link": "https://stackoverflow.com/questions/52304037/workarounds-for-haskell-cabal-packages-with-constraints-with-nix-and-cabal", "title": "Workarounds for Haskell / cabal packages with constraints with Nix and Cabal?", "body": "<p>I recently got into developing with <a href=\"https://github.com/reflex-frp/reflex-platform\" rel=\"nofollow noreferrer\" title=\"reflex-platform\">reflex-platform</a>, with some extra configuration similar to what is described in the excellent <a href=\"https://github.com/ElvishJerricco/reflex-project-skeleton\" rel=\"nofollow noreferrer\" title=\"reflex-project-skeleton\">reflex-project-skeleton</a>.</p>\n\n<p>Now I am having a package conflict that I am unable to resolve.\nI use the same cabal script as <code>reflex-project-skeleton</code>, which invokes <code>nix-shell</code> in non-interactive mode with a cabal command.</p>\n\n<p>If I try</p>\n\n<pre><code>./cabal new-build --allow-newer all\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>these derivations will be built:\n  /nix/store/d6ji516i7pry5l6gv18y6hpj9k1bvgg5-heist-1.0.1.0.drv\n  /nix/store/zj1clks7mzq8gn91ahhwa3nvpi5rwra9-snap-1.0.0.2.drv\n  /nix/store/mx861972jnjabn7yxyr3y3q1yhf25jfq-snaplet-acid-state-0.2.7.drv\n  /nix/store/grhp4dhavmpi6bgns5a6vdzg8ny2bsf8-hoogle-local-0.1.drv\n  /nix/store/y3sszsj58f6ad3r06540w0mlr1pncd59-ghc-8.0.2-with-packages.drv\n\n...\n\nConfiguring heist-1.0.1.0...\nSetup: Encountered missing dependencies:\naeson &gt;=0.6 &amp;&amp; &lt;1.2\n\nbuilder for '/nix/store/d6ji516i7pry5l6gv18y6hpj9k1bvgg5-heist-1.0.1.0.drv' failed with exit code 1\ncannot build derivation '/nix/store/y3sszsj58f6ad3r06540w0mlr1pncd59-ghc-8.0.2-with-packages.drv': 1 dependencies couldn't be built\n</code></pre>\n\n<p>The offending package appears to be <code>snaplet-acid-state</code>, so I tried installing it from inside the nix-shell:</p>\n\n<pre><code>cabal install snaplet-acid-state\nResolving dependencies...\ncabal: Could not resolve dependencies:\ntrying: snaplet-acid-state-0.2.7 (user goal)\ntrying: base-4.9.1.0/installed-4.9... (dependency of snaplet-acid-state-0.2.7)\nnext goal: mtl (dependency of snaplet-acid-state-0.2.7)\nrejecting: mtl-2.2.1/installed-BLK... (conflict: mtl =&gt;\ntransformers==0.5.2.0/installed-0.5..., snaplet-acid-state =&gt;\ntransformers&gt;=0.3.0.0 &amp;&amp; &lt;0.5)\ntrying: mtl-2.2.2\nnext goal: transformers (dependency of snaplet-acid-state-0.2.7)\nrejecting: transformers-0.5.2.0/installed-0.5..., transformers-0.5.5.0,\ntransformers-0.5.4.0, transformers-0.5.2.0, transformers-0.5.1.0,\ntransformers-0.5.0.1, transformers-0.5.0.0 (conflict: snaplet-acid-state =&gt;\ntransformers&gt;=0.3.0.0 &amp;&amp; &lt;0.5)\nrejecting: transformers-0.4.3.0, transformers-0.4.2.0 (conflict:\nbase==4.9.1.0/installed-4.9..., transformers =&gt; base&gt;=2 &amp;&amp; &lt;4.9)\nrejecting: transformers-0.4.1.0 (conflict: base==4.9.1.0/installed-4.9...,\ntransformers =&gt; base&gt;=2 &amp;&amp; &lt;4.8 || &gt;=1.0 &amp;&amp; &lt;2)\nrejecting: transformers-0.3.0.0 (conflict: mtl =&gt; transformers&gt;=0.4 &amp;&amp; &lt;0.6)\nrejecting: transformers-0.2.2.1, transformers-0.2.1.0, transformers-0.2.0.0,\ntransformers-0.1.4.0, transformers-0.1.3.0, transformers-0.1.1.0,\ntransformers-0.1.0.1, transformers-0.0.1.0, transformers-0.0.0.0,\ntransformers-0.5.3.1, transformers-0.5.3.0, transformers-0.5.0.2 (conflict:\nsnaplet-acid-state =&gt; transformers&gt;=0.3.0.0 &amp;&amp; &lt;0.5)\nrejecting: transformers-0.4.0.0 (conflict: base==4.9.1.0/installed-4.9...,\ntransformers =&gt; base&gt;=2 &amp;&amp; &lt;4.8 || &gt;=1.0 &amp;&amp; &lt;2)\nrejecting: transformers-0.2.2.0, transformers-0.1.0.0 (conflict:\nsnaplet-acid-state =&gt; transformers&gt;=0.3.0.0 &amp;&amp; &lt;0.5)\nAfter searching the rest of the dependency tree exhaustively, these were the\ngoals I've had most trouble fulfilling: transformers, snap, base,\nsnaplet-acid-state, mtl\n</code></pre>\n\n<p>Tried specifying a version constraint in the cabal file, among other things, but to no effect.</p>\n\n<p>Any clues? I'm not even sure what the exact issue is. Why is aeson failing to install in the first instance, and there is a conflict between snaplet-acid-state and mtl in the second?</p>\n"}, {"tags": ["haskell", "key-bindings", "xmonad"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 10355476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcab8e58ac79dd762f0a8ea351280b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Ignis-fatuus", "link": "https://stackoverflow.com/users/10355476/ignis-fatuus"}, "is_accepted": false, "score": 1, "last_activity_date": 1536810670, "last_edit_date": 1536810670, "creation_date": 1536800985, "answer_id": 52305313, "question_id": 52303734, "link": "https://stackoverflow.com/questions/52303734/xmonad-key-binding-to-bring-a-window-from-a-another-workspace-to-your-current-w/52305313#52305313", "title": "Xmonad: key binding to bring a window from a another workspace to your current workspace", "body": "<p>Going over the contrib docs it seems that I am trying to reinvent the wheel as I can just easily use scratchpad. That should do the trick. </p>\n\n<p>But...if anyone has any ideas regarding the question above, i.e. using ifWindows to pull another window from one workspace to another I would love to know how you went about it.</p>\n\n<p>Added the following myKeys:</p>\n\n<pre><code>, (\"M-`\", scratchpadSpawnActionTerminal myScratchTerm)\n</code></pre>\n\n<p>Defined the ManageHook:</p>\n\n<pre><code>myScratchPadHook :: ManageHook\nmyScratchPadHook =\nscratchpadManageHook (W.RationalRect fLeft fTop tRight fBottom)   \n where\n  fLeft = 0.0\n  fTop = 0.75\n  tRight = 1.0\n  fBottom = 0.25\n</code></pre>\n\n<p>and added</p>\n\n<pre><code>&lt;+&gt; myScratchPadHook\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10355476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dcab8e58ac79dd762f0a8ea351280b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Ignis-fatuus", "link": "https://stackoverflow.com/users/10355476/ignis-fatuus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536810670, "creation_date": 1536787760, "last_edit_date": 1536788263, "question_id": 52303734, "link": "https://stackoverflow.com/questions/52303734/xmonad-key-binding-to-bring-a-window-from-a-another-workspace-to-your-current-w", "title": "Xmonad: key binding to bring a window from a another workspace to your current workspace", "body": "<p>I am hoping that you folks can help me as I am new to Haskell and Haskell-fu is rather weak.</p>\n\n<p>I am trying to create a quake-like terminal that drops down when called upon. For the most part I figured that storing a named urxvt terminal in layout managed by a <code>simpleDrawer</code> (<code>XMonad.Layout.Drawer</code>) works well for this. What I am having a problem with is binding a key to it so that it will pop up on whatever workspace I happen to be in. </p>\n\n<p>The <code>bringSelected</code> option doesn't work for me as I do not want to have to deal with the grid menu. What I have tried that has gotten me the closest is:</p>\n\n<pre><code>raiseMaybe (spawnHere \"urxvt -name drawer\") (resource =? \"drawer\")\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>ifWindows (resource =? \"drawer\") (mapM_ focus) (spawn \"urxvt -name drawer\")\n</code></pre>\n\n<p>The problem is that both essentially do the same thing in that instead of bringing said window (with <code>resource =? \"drawer\"</code>) to my current workspace, it shifts me away from my current workspace to wherever it was last invoked. </p>\n\n<p>Ideally I am looking for something along the lines of:</p>\n\n<pre><code>ifWindows (resource =? \"drawer\") ({- bring window to current workspace -})  \n    (spawnHere \"urxvt -name drawer\")\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536787344, "post_id": 52303645, "comment_id": 91554931, "body": "Why do you think the <code>myintersect</code> works?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1536787502, "post_id": 52303645, "comment_id": 91554989, "body": "Furthermore please explain the <i>reasoning</i> behind your functions."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1536787588, "post_id": 52303645, "comment_id": 91555031, "body": "I&#39;m no Haskell expert (just learning it myself), but assuming (from the name) this is supposed to implement some sort of intersection of 2 lists, your base case is wrong in <code>myintersect</code> - the intersection of an empty list with any other should be the empty list."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "edited": false, "score": 0, "creation_date": 1536787657, "post_id": 52303645, "comment_id": 91555057, "body": "myintersect doesnt work. what i said is that myintersectaux works because i tested but the main one, myintersect doesnt work. unless the second inserted list is just an element it will always return []. but thanks for the answer"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "edited": false, "score": 0, "creation_date": 1536787864, "post_id": 52303645, "comment_id": 91555119, "body": "you re right Robin. still doesnt work tho..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "edited": false, "score": 0, "creation_date": 1536787874, "post_id": 52303645, "comment_id": 91555129, "body": "myintersect ::  Eq a =&gt; [a] -&gt; [a] -&gt; [a]     myintersect [] _ = []     myintersect l (h1:t1) = (myintersect (intersectaux h1 l) t1)      intersectaux :: Eq a =&gt; a -&gt; [a] -&gt; [a]     intersectaux _ [] = []      intersectaux a (h:t) = if a==h then h:intersectaux a t else intersectaux a t"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536787896, "post_id": 52303645, "comment_id": 91555141, "body": "@PedroNovais: can you specify how you &quot;constructed&quot; these functions? What reasoning did you apply to write these?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1536788129, "post_id": 52303645, "comment_id": 91555239, "body": "the auxiliar is a function that when you give an element and a list it will return the elements from the list that are equal to the first element. thse main one is a fucntion that when you give two lists ,one with just aleatory elements and the other with the elements that you want to intersect. the result is the same as the auxiliar but intersecting a list with another list of elements instead intersecting a list with one element @WillemVanOnsem"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1536789449, "post_id": 52303645, "comment_id": 91555643, "body": "Welcome to Stack Overflow. When other members ask for additional information, it is usually best to <a href=\"https://stackoverflow.com/posts/52303645/edit\">edit</a> your question to include it."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "edited": false, "score": 0, "creation_date": 1536788946, "post_id": 52303884, "comment_id": 91555509, "body": "i understood all that you said and i know how to make this function the way you did. i just want to know why my way doesnt work... but thank you"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1536789254, "last_edit_date": 1536789254, "creation_date": 1536788535, "answer_id": 52303884, "question_id": 52303645, "link": "https://stackoverflow.com/questions/52303645/intersect-function-in-haskell/52303884#52303884", "title": "intersect function in Haskell", "body": "<h1>Problems with the current approach:</h1>\n\n<p>in your approach, the <code>intersectaux</code> aims to <em>filter</em> the list, such that only the elements that are equal to <code>a</code> remain. So that means that for <code>intersectaux 4 [1,4,2,5]</code>, it will return <code>[4]</code>. So it means that after this \"round\", the list will only contain elements that are all the same: elements equal to <code>a</code>.</p>\n\n<p>In a next \"round\" we filter with a (potentially) different element. If we filter with an element equal to the previous <code>a</code>, then the result will be equal to the given list: a list that still contains only elements equal to <code>a</code>. If the element is however different, then it will remove all the elements from the list, since <code>a2 /= a1</code> (<code>a1</code> being the \"old\" <code>a</code>, and <code>a2</code> the \"new\" <code>a</code>) so the result will be empty.</p>\n\n<p>After all \"rounds\" are finished, we return the result that will, based on the above, contain only elements that are equal, or an empty list.</p>\n\n<h1>A solution using <code>elem</code></h1>\n\n<p>The intersection of two lists can be defined as:</p>\n\n<blockquote>\n  <p>A list that contains all the elements that occur in the <em>first</em> list, and the <em>second</em> list.</p>\n</blockquote>\n\n<p>In Haskell lists can have an infinite length, making it hard to solve the problem. But in this answer, I will ignore that: we make the <em>assumption</em> that the second list has a finite length. More advanced strategies (like for example each time taking a limited number of elements in the two lists, and calculating the intersection of these finite collections).</p>\n\n<p>In order to calculate the intersection, we can enumerate over the first list, and for every element in that list, check if that element occurs in the second list as well. We can check if a list <code>l</code> contains an element <code>x</code> with <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:elem\" rel=\"nofollow noreferrer\"><strong><code>elem :: Eq a =&gt; a -&gt; [a] -&gt; Bool</code></strong></a>: by checking <code>elem x l</code>.</p>\n\n<p>For the intersection, we then have three cases:</p>\n\n<ol>\n<li>the first list is exhausted (empty), in which case the result is an empty list;</li>\n<li>the first list is not empty, and the first element of that list is an element of the second list, in that case we <em>yield</em> that element, and recurse on the tail of the list; and</li>\n<li>the first list is not empty, the first element does <em>not</em> occur in the second list, we then recurse on the tail of the list.</li>\n</ol>\n\n<p>For example:</p>\n\n<pre><code>intersect :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]\nintersect [] _ = []\nintersect (x:xs) l | elem x l = x : intersect xs l\n                   | otherwise = intersect xs l\n</code></pre>\n\n<p>The above will yield elements multiple times if they occur <em>multiple</em> times in the first list (if these occur multiple times in the second list, then this will <em>not</em> act as a \"multiplier\").</p>\n\n<p>The above is not very efficient if the elements can be <code>Ord</code>ered, or if these are <code>Hashable</code>. So the above can still be improved (significantly).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10355472"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2863, "favorite_count": 0, "accepted_answer_id": 52303884, "answer_count": 1, "score": 1, "last_activity_date": 1536789254, "creation_date": 1536787277, "last_edit_date": 1536787313, "question_id": 52303645, "link": "https://stackoverflow.com/questions/52303645/intersect-function-in-haskell", "title": "intersect function in Haskell", "body": "<p>i did this function for intersect in haskell and it just doesnt work. i know that the aux works but the main one no. Help pleas</p>\n\n<pre><code>myintersect ::  Eq a =&gt; [a] -&gt; [a] -&gt; [a]\nmyintersect a [] = a\nmyintersect l (h1:t1) = (myintersect (intersectaux h1 l) t1)\n\nintersectaux :: Eq a =&gt; a -&gt; [a] -&gt; [a]\nintersectaux _ [] = []\nintersectaux a (h:t) = if a==h then h:intersectaux a t else intersectaux a t\n</code></pre>\n"}, {"tags": ["list", "haskell", "filter"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1536785337, "post_id": 52303239, "comment_id": 91554187, "body": "Hint: use <code>elem</code>."}, {"owner": {"reputation": 71, "user_id": 10355311, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I0p_PzGxhL4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOHKjJTi1qmaRsB59zXfWXeexfIJw/mo/photo.jpg?sz=128", "display_name": "Cem Atalay", "link": "https://stackoverflow.com/users/10355311/cem-atalay"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536785698, "post_id": 52303239, "comment_id": 91554345, "body": "im stupid... thank you @WillemVanOnsem"}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 10355311, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I0p_PzGxhL4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOHKjJTi1qmaRsB59zXfWXeexfIJw/mo/photo.jpg?sz=128", "display_name": "Cem Atalay", "link": "https://stackoverflow.com/users/10355311/cem-atalay"}, "is_accepted": true, "score": 5, "last_activity_date": 1536785858, "creation_date": 1536785858, "answer_id": 52303379, "question_id": 52303239, "link": "https://stackoverflow.com/questions/52303239/a-haskell-function-that-takes-two-strings-and-filters-the-second-according-to-th/52303379#52303379", "title": "A Haskell function that takes two strings and filters the second according to the first", "body": "<pre><code>remove xs ys = foldr (\\x acc -&gt; if elem x xs then acc else x : acc) [] ys\n</code></pre>\n\n<p>yep.</p>\n"}, {"tags": [], "owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "is_accepted": false, "score": 1, "last_activity_date": 1536816929, "last_edit_date": 1536816929, "creation_date": 1536815792, "answer_id": 52307059, "question_id": 52303239, "link": "https://stackoverflow.com/questions/52303239/a-haskell-function-that-takes-two-strings-and-filters-the-second-according-to-th/52307059#52307059", "title": "A Haskell function that takes two strings and filters the second according to the first", "body": "<pre><code>remove :: String -&gt; String -&gt; String                       \nremove xs ys = foldr (condCons) \"\" ys\n  where\n    condCons l rs | l `notElem` xs = l : rs\n                  | otherwise = rs\n</code></pre>\n\n<p>It is also allowed to discard the 'ys' paramenter:</p>\n\n<pre><code>remove :: String -&gt; String -&gt; String                       \nremove xs = foldr (condCons) \"\"\n  where\n    condCons l rs | l `notElem` xs = l : rs\n                  | otherwise = rs\n</code></pre>\n\n<p>Basically, condCons takes a character L and a string Rs. If L is not an element of xs, then it cons to Rs, otherwise leave Rs unchanged. foldr takes the condCons, the intial string \"\", and the second argument ys. L takes on each character of the string ys from right to left, building a new string from \"\" using the condCons binary operator.</p>\n"}], "owner": {"reputation": 71, "user_id": 10355311, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I0p_PzGxhL4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOHKjJTi1qmaRsB59zXfWXeexfIJw/mo/photo.jpg?sz=128", "display_name": "Cem Atalay", "link": "https://stackoverflow.com/users/10355311/cem-atalay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 52303379, "answer_count": 2, "score": 2, "last_activity_date": 1536816929, "creation_date": 1536785181, "last_edit_date": 1536787576, "question_id": 52303239, "link": "https://stackoverflow.com/questions/52303239/a-haskell-function-that-takes-two-strings-and-filters-the-second-according-to-th", "title": "A Haskell function that takes two strings and filters the second according to the first", "body": "<p>The objective is: Using <code>foldr</code>, define a function <em>remove</em> which takes two strings as its arguments and removes every letter from the second list that occurs in the first list. For example, <code>remove \"first\" \"second\" = \"econd\"</code>.</p>\n\n<p>If this function took a single character and a string, I would do:</p>\n\n<pre><code>remove a xs = foldr (\\x acc -&gt; if x /= a then x : acc else acc) [] xs\n</code></pre>\n\n<p>But I can't figure out how I am supposed to do this with two strings. Thank you!</p>\n"}, {"tags": ["haskell", "haskell-sdl"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1536784021, "post_id": 52302936, "comment_id": 91553656, "body": "What&#39;s the error say? I&#39;d rather not try to get SDL installed to check, but I bet you just want to change your import to <code>RendererConfig(RendererConfig)</code> or <code>RendererConfig(..)</code>."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1536784272, "post_id": 52302936, "comment_id": 91553757, "body": "@DanielWagner right, thanks! updated"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1536866629, "post_id": 52305255, "comment_id": 91588379, "body": "Your link shows four exported constructors, which contradicts your claim that no constructors are exported. It&#39;s also for <code>RendererType</code>, not <code>RendererConfig</code>. Both types export all their constructors. The problem is your <i>import</i> list, not the exports: <code>import Foo (Bar)</code> imports the type constructor <code>Bar</code>, but does not import any of the data constructors for <code>Bar</code>. You need <code>import Foo (Bar(Baz))</code> to import data constructor <code>Baz</code> of type constructor <code>Bar</code> or <code>import Foo (Bar(..))</code> to import all data constructors for type constructor <code>Bar</code>."}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1537049999, "post_id": 52305255, "comment_id": 91643911, "body": "Not sure how I missed that, but your comment makes sense. Thanks!"}], "tags": [], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "is_accepted": false, "score": 0, "last_activity_date": 1536800347, "creation_date": 1536800347, "answer_id": 52305255, "question_id": 52302936, "link": "https://stackoverflow.com/questions/52302936/how-can-one-extract-values-from-renderconfig-in-haskells-sdl-bindings/52305255#52305255", "title": "How can one extract values from RenderConfig in Haskell&#39;s SDL bindings", "body": "<p>It was pointed out to me that <code>RendererConfig</code> <a href=\"http://hackage.haskell.org/package/sdl2-2.4.1.0/docs/SDL-Video-Renderer.html#t:RendererType\" rel=\"nofollow noreferrer\">has no constructors exported</a>. However, since it does derive <code>Show</code>, I can, after the proper import, still get what I want, and much more simply: <code>rendererType(defaultRenderer)</code>. </p>\n"}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536800347, "creation_date": 1536783883, "last_edit_date": 1536784256, "question_id": 52302936, "link": "https://stackoverflow.com/questions/52302936/how-can-one-extract-values-from-renderconfig-in-haskells-sdl-bindings", "title": "How can one extract values from RenderConfig in Haskell&#39;s SDL bindings", "body": "<p>This is probably a beginner mistake, as it is my first \"real\" attempt at using Haskell.</p>\n\n<p>My relevant code snippets look like:</p>\n\n<pre><code>import           SDL            (RendererConfig, RendererType(SoftwareRenderer), defaultRenderer)\n\ndefaultRendererType :: RendererType\ndefaultRendererType = case defaultRenderer of\n  RendererConfig rt  _ -&gt; rt\n</code></pre>\n\n<p>Notably, ghc doesn't complain about the import of <code>RendererConfig</code>, which makes me thing I'm using it wrong.</p>\n\n<p>The source of <code>RendererConfig</code> looks like it only has two arguments, so I'm not sure why the match isn't working in the case expression.</p>\n\n<pre><code>data RendererConfig = RendererConfig\n  { rendererType  :: RendererType\n    -- ^ The renderer's acceleration mode\n  , rendererTargetTexture :: Bool\n    -- ^ The renderer supports rendering to texture\n} deriving (Data, Eq, Generic, Ord, Read, Show, Typeable)\n</code></pre>\n\n<p><strong>Edit</strong></p>\n\n<p>The error message I get:</p>\n\n<pre><code>Main.hs:47:3: error:                                                                                   \n    Not in scope: data constructor `RendererConfig'                                                                                     \n    Perhaps you want to add `RendererConfig' to the import list                                                                         \n    in the import of `SDL' (app/Main.hs:10:1-97).                                                                                       \n   |                                                                                                                                    \n47 |   RendererConfig rt  _ -&gt; rt                                                                                                       \n   |   ^^^^^^^^^^^^^^     \n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1536775022, "post_id": 52300078, "comment_id": 91549641, "body": "You might also like <a href=\"https://stackoverflow.com/q/24103108/791604\">Where is the data constructor for <code>State</code>?</a>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1536775134, "post_id": 52300078, "comment_id": 91549687, "body": "The <code>State</code> in that question is not the type from the standard library, it&#39;s a custom type defined right there in the question. In particular, it is restricted to state values of type <code>Int</code>, which is why you can write a <code>Show</code> instance for it by sampling a bunch of numbers. This does not work for the real <code>State</code> type."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1536776796, "post_id": 52300078, "comment_id": 91550478, "body": "That said, you could do something similar for the real state type with an auxiliary <code>class SampleDomain a :: sampleDomain :: [a]</code> ; then <code>instance (SampleDomain s, Show s, Show a) =&gt; Show (State s a)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1536774606, "creation_date": 1536774606, "answer_id": 52300896, "question_id": 52300078, "link": "https://stackoverflow.com/questions/52300078/implementing-show-for-state/52300896#52300896", "title": "Implementing Show for State", "body": "<p>I have built the <a href=\"http://hackage.haskell.org/package/universe\" rel=\"nofollow noreferrer\">universe</a> package for the purpose of showing functions on small domains (among other things). You can use it to create a <code>Show</code> instance for <code>State</code> this way:</p>\n\n<pre><code>{-# LANGUAGE StandaloneDeriving #-}\n{-# LANGUAGE UndecidableInstances #-}\n\nimport Control.Monad.State\nimport Data.Universe\nimport Data.Universe.Instances.Reverse\n\nderiving instance (Finite s, Show s, Show (m (a,s))) =&gt; Show (StateT s m a)\n</code></pre>\n\n<p>Try it out:</p>\n\n<pre><code>&gt; modify not :: State Bool ()\nStateT {runStateT = [(False,Identity ((),True)),(True,Identity ((),False))]}\n</code></pre>\n\n<p>It might be interesting to include something like this (and similar for <code>ReaderT</code>, etc.) in the <code>universe-reverse-instances</code> package. I'll have to think about a sane way to do that.</p>\n\n<p>Explaining <code>State</code> and <code>StateT</code> from the ground up is probably a slightly larger task than would sensibly fit in an SO answer, but there are many tutorials floating around the web for this type.</p>\n"}], "owner": {"reputation": 303, "user_id": 2679998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/863e98f76b3407a428187edaffe8310f?s=128&d=identicon&r=PG&f=1", "display_name": "Aleksandarf", "link": "https://stackoverflow.com/users/2679998/aleksandarf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536774606, "creation_date": 1536771023, "last_edit_date": 1536771949, "question_id": 52300078, "link": "https://stackoverflow.com/questions/52300078/implementing-show-for-state", "title": "Implementing Show for State", "body": "<p>Well this topic has been discusses before so I'm linking to it.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/7966956/instance-show-state-where-doesnt-compile\">Previous stackoverflow question</a></p>\n\n<p>So I'm sure it worked at the time, but time has changed :)</p>\n\n<p>As a Haskell newbie making small steps this would take me one step further.\nI've tried various solutions with various issues.</p>\n\n<p>suggested solution </p>\n\n<pre><code>instance Show a =&gt; Show (State a) where\n  show (State f) = show [show i ++ \" =&gt; \" ++ show (f i) | i &lt;- [0..3]]\n</code></pre>\n\n<p>compiler reports.</p>\n\n<pre><code> myfuncs.hs:31:11: error:\n     Not in scope: data constructor \u2018State\u2019\n     Perhaps you meant one of these:\n       \u2018StateT\u2019 (imported from Control.Monad.State),\n       variable \u2018state\u2019 (imported from Control.Monad.State)\n    |\n 31 |     show (State f) = show [show i ++ \" =&gt; \" ++ show (f i) | i &lt;- [0..3]]\n    |\n</code></pre>\n\n<p>I would appreciate an explantion of State state and StateT \nalso understanding how :info State is to be interpreted.</p>\n\n<pre><code>type State s = StateT s Data.Functor.Identity.Identity :: * -&gt; *\n       -- Defined in \u2018Control.Monad.Trans.State.Lazy\u2019\n</code></pre>\n\n<p>same question goes for info: state</p>\n\n<pre><code>class Monad m =&gt; MonadState s (m :: * -&gt; *) | m -&gt; s where\n ...\n state :: (s -&gt; (a, s)) -&gt; m a\n       -- Defined in \u2018Control.Monad.State.Class\u2019\n</code></pre>\n\n<p>Not sure I will understand the answer, however all help is appreciated.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1536771169, "post_id": 52300022, "comment_id": 91547831, "body": "The <code>f</code> should have a constraint: <code>Monad f</code>. Here it is an &quot;arrow&quot;, so <code>f ~ (-&gt;) b</code>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 4, "creation_date": 1536777170, "post_id": 52300022, "comment_id": 91550660, "body": "Your title asks about context, but your question content says otherwise. What&#39;s your actual question?"}, {"owner": {"reputation": 269, "user_id": 7272130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4f731e81d96903d3a06439adf360512d?s=128&d=identicon&r=PG&f=1", "display_name": "Felix Ha", "link": "https://stackoverflow.com/users/7272130/felix-ha"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1536783844, "post_id": 52300022, "comment_id": 91553580, "body": "@AJFarmar  What is the  &quot;value&quot; of y ?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1537537373, "post_id": 52300022, "comment_id": 91832814, "body": "@AJFarmar I think they meant the &quot;value in context&quot; metaphor of functorial values."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 2, "last_activity_date": 1537538351, "last_edit_date": 1537538351, "creation_date": 1536786173, "answer_id": 52303457, "question_id": 52300022, "link": "https://stackoverflow.com/questions/52300022/what-is-the-context-in-a-function/52303457#52303457", "title": "What is the &quot;context&quot; in a function", "body": "<p>The type of <code>sequenceA</code> is:</p>\n\n<pre><code>sequenceA :: (Traversable t, Applicative f) =&gt; t (f a) -&gt; f (t a)\n</code></pre>\n\n<p>(I'm using <code>sequenceA</code> because it is the more general version -- <code>sequence</code> has a more restrictive <code>Monad</code> constraint instead of the <code>Applicative</code> one -- but as far as this answer is concerned it doesn't matter much.)</p>\n\n<p>Let's say your <code>list</code> has type <code>[Integer -&gt; Integer]</code> (I'm specialising the numbers for the sake of clarity). Then <code>sequenceA</code> in <code>sequenceA list</code> specialises to:</p>\n\n<pre><code>[Integer -&gt; Integer] -&gt; (Integer -&gt; [Integer])\n</code></pre>\n\n<p>The correspondence is easier to see if we write the interesting (for us here) type constructors in <em>prefix style</em>:</p>\n\n<pre><code>-- t (           f       a) -&gt;             f ( t       a)\n  [] ((-&gt;) Integer Integer) -&gt; ((-&gt;) Integer ([] Integer))\n</code></pre>\n\n<p>The list functor, <code>[]</code>, is the traversable functor (the <code>t</code> in the signature of <code>sequenceA</code>), while <code>(-&gt;) Integer</code>, the <em>functions-from-<code>Integer</code></em> functor, is the relevant applicative functor (the <code>f</code> in the signature), or, to use the language of your title, the relevant applicative context. For instance, in the <code>Integer -&gt; [Integer]</code> result type, instead of having plain list of integers, you have a function from <code>Integer</code>s which produces such list.</p>\n"}], "owner": {"reputation": 269, "user_id": 7272130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4f731e81d96903d3a06439adf360512d?s=128&d=identicon&r=PG&f=1", "display_name": "Felix Ha", "link": "https://stackoverflow.com/users/7272130/felix-ha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1537538351, "creation_date": 1536770846, "last_edit_date": 1537538346, "question_id": 52300022, "link": "https://stackoverflow.com/questions/52300022/what-is-the-context-in-a-function", "title": "What is the &quot;context&quot; in a function", "body": "<p>I  am trying to get more familiar with Haskell(Functor,Monad). So i am trying to understand what's happening in the below example</p>\n\n<pre><code> sequence:: [f a] -&gt; f [a]\n let list =  [(+2), (*6)]\n let y =  sequence  list\n</code></pre>\n\n<p>What is the \"f\" in (+2) and the \"value\" of y ?</p>\n"}, {"tags": ["haskell", "data-kinds", "phantom-types"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1536808841, "post_id": 52299478, "comment_id": 91559594, "body": "You can check <a href=\"http://hackage.haskell.org/package/safe-money\" rel=\"nofollow noreferrer\"><code>safe-money</code></a> package where this hole system is implemented and described in this blog post: <a href=\"https://ren.zone/articles/safe-money\" rel=\"nofollow noreferrer\">ren.zone/articles/safe-money</a>"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1536777069, "last_edit_date": 1536777069, "creation_date": 1536770312, "answer_id": 52299897, "question_id": 52299478, "link": "https://stackoverflow.com/questions/52299478/pattern-match-phantom-type/52299897#52299897", "title": "Pattern match phantom type", "body": "<p>You can't use a phantom for this. Phantom types disappear at runtime, and you need some runtime information for your <code>inUsd</code> function.</p>\n\n<p>The usual approach is to use GADTs and singleton types.</p>\n\n<pre><code>-- the \"index\" type\ndata Currency = Usd | Eur | Gbp\n\n-- the \"singleton\" type\n-- If you want to autogenerate this, check out the singletons\n-- package on Hackage\ndata SCurrency (a :: Currency) where\n   SUsd :: Scurrency Usd\n   SEur :: Scurrency Eur\n   SGbp :: Scurrency Gbp\n\n-- the \"indexed\" type\ndata CurrencyQty (a :: Currency) where\n  CurrencyQty :: SCurrency a -&gt; Double -&gt; CurrencyQty a\n\ninstance Num (CurrencyQty a) where\n   ... -- you have to manually write this, I guess?\n\ninUsd :: CurrencyQty a -&gt; IO (CurrencyQty Usd)\ninUsd (CurrencyQty SUsd x) = return x\ninUsd (CurrencyQty SEur x) = fmap (*x) $ currentExchangeRate Usd Eur\ninUsd (CurrencyQty SGbp x) = fmap (*x) $ currentExchangeRate Usd Gbp\n</code></pre>\n\n<p>Let me add that your code is OK. If Haskell had full dependent types, it would be possible to use your code with minor adjustments, and avoiding the additional singleton type. At the present time, however, Haskell can not avoid that, and some more effort is needed.</p>\n"}], "owner": {"reputation": 73, "user_id": 10354200, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-lp4YOdPuW1M/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNoLpaURki1HEQjJbBTyoiJbWI5hg/mo/photo.jpg?sz=128", "display_name": "Eddie Wang", "link": "https://stackoverflow.com/users/10354200/eddie-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 52299897, "answer_count": 1, "score": 7, "last_activity_date": 1536777069, "creation_date": 1536768670, "question_id": 52299478, "link": "https://stackoverflow.com/questions/52299478/pattern-match-phantom-type", "title": "Pattern match phantom type", "body": "<p>I'm trying to implement a CurrencyQty type that acts like a number tagged at compile time:</p>\n\n<pre><code>data Currency = Usd | Eur | Gbp\n\ndata CurrencyQty (a :: Currency) = CurrencyQty Double deriving (Num)\n</code></pre>\n\n<p>And now I want to implement a generic conversion function that looks up exchange rates dynamically. Suppose I have some function</p>\n\n<pre><code>currentExchangeRate :: Currency -&gt; Currency -&gt; IO Double\n</code></pre>\n\n<p>I want to write</p>\n\n<pre><code>inUsd :: CurrencyQty a -&gt; IO (CurrencyQty Usd)\ninUsd (CurrencyQty Usd x) = return x\ninUsd (CurrencyQty Eur x) = fmap (*x) $ currentExchangeRate Usd Eur\ninUsd (CurrencyQty Gbp x) = fmap (*x) $ currentExchangeRate Usd Gbp\n</code></pre>\n\n<p>Or maybe somehow</p>\n\n<pre><code>inUsd :: CurrencyQty a -&gt; IO (CurrencyQty Usd)\ninUsd (CurrencyQty a x) = fmap (*x) $ currentExchangeRate Usd a\n</code></pre>\n\n<p>The syntax I'm using obviously isn't valid haskell... is there a way to accomplish this?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 1756, "user_id": 2359523, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d65320cd476b9df7a4b33137dae344a7?s=128&d=identicon&r=PG", "display_name": "Anonymous coward", "link": "https://stackoverflow.com/users/2359523/anonymous-coward"}, "edited": false, "score": 0, "creation_date": 1536766634, "post_id": 52298627, "comment_id": 91545487, "body": "Welcome to StackOverflow. What kind of run time error do you encounter?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1536767885, "post_id": 52298627, "comment_id": 91546202, "body": "<code>assert</code> is a runtime check. We can not always make it at compile time -- indeed, what if we call <code>hanoiDisk</code> with some data which is only available at runtime? There some techniques that might help here in certain cases (TH, GADTs, dependent types (outside Haskell)) but they are much more advanced. If you are a beginner, I&#39;d recommend to learn the basics of Haskell first."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10354068, "user_type": "registered", "profile_image": "https://graph.facebook.com/507184540/picture?type=large", "display_name": "Brad Phillips", "link": "https://stackoverflow.com/users/10354068/brad-phillips"}, "edited": false, "score": 0, "creation_date": 1536822379, "post_id": 52304196, "comment_id": 91563699, "body": "Ideally, i&#39;d like to find a way to have a compile time exception For example, if i have ` data MyString = MyString String let t = MyString &quot;This is my String&quot; &lt;-- ok let t = MyString 12321 &lt;-- should raise a compile-time exception `  There must be <i>some way</i> to have a compile-time exception if someone tries hanoiDisk -1 or hanoiDisk 0  Alternatively, i could try a discriminated union of  ` HanoiDisk = HanoiDisk&#39; SizeOne | SizeTwo | SizeThree ... SizeTen ` But i&#39;d like to find an &#39;unbounded&#39; general solution without the error or maybe monad."}, {"owner": {"reputation": 493, "user_id": 6889286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d9b8a4d03d0de0a49eac62a5569c9e?s=128&d=identicon&r=PG&f=1", "display_name": "Kartik Sabharwal", "link": "https://stackoverflow.com/users/6889286/kartik-sabharwal"}, "reply_to_user": {"reputation": 33, "user_id": 10354068, "user_type": "registered", "profile_image": "https://graph.facebook.com/507184540/picture?type=large", "display_name": "Brad Phillips", "link": "https://stackoverflow.com/users/10354068/brad-phillips"}, "edited": false, "score": 0, "creation_date": 1536827433, "post_id": 52304196, "comment_id": 91566300, "body": "After some digging I found <a href=\"https://stackoverflow.com/questions/11910143/positive-integer-type\">a similar question with a better answer</a>. The accepted answerer mentions smart constructors, which is what your <code>HanoiDisk</code> function is. It also suggests using <code>Data.Word</code> which has unsigned integer data types but introduces the problem that <code>(fromIntegral :: Int -&gt; Word) (-1)</code> is the same as <code>maxBound :: Word</code>. Also, the <i>exact representations</i> method mentioned in the answer i.e. <code>data NonNegative = One | S NonNegative</code> is kind-of an &#39;unbounded&#39; general solution."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1536851973, "post_id": 52304196, "comment_id": 91581131, "body": "a. <code>_0</code>,` _1<code>, ..., </code>_9` can also be used as the names of digit values. b. <code>[_0 - _1]</code> is a valid value under our scheme."}, {"owner": {"reputation": 493, "user_id": 6889286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d9b8a4d03d0de0a49eac62a5569c9e?s=128&d=identicon&r=PG&f=1", "display_name": "Kartik Sabharwal", "link": "https://stackoverflow.com/users/6889286/kartik-sabharwal"}, "edited": false, "score": 0, "creation_date": 1536855673, "post_id": 52304196, "comment_id": 91583115, "body": "a. Ah yes I&#39;ve been extremely silly in that regard, I&#39;ll fix that in the answer and credit you. b. Good catch! Implementing <code>Num Natural</code> puts us in a fix, doesn&#39;t it? Can we only implement <code>Enum Natural</code> and then forego having to define <code>(+)</code> and <code>negate</code> in favor of <code>fromEnum</code>?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1536860011, "post_id": 52304196, "comment_id": 91585260, "body": "I had some typos there, haven&#39;t I. :) (it was suppose to be &quot;... under <i>your</i> scheme&quot;). The usual thing to do is to define <code>Nat</code> as I&#39;ve shown in the answer. It just can&#39;t be negative.  The OP is mainly concerned about the negative arguments, so that would be taken care of automatically. The unary representation is of course inefficient, but we can&#39;t have too many of those disks anyway. :)"}, {"owner": {"reputation": 493, "user_id": 6889286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d9b8a4d03d0de0a49eac62a5569c9e?s=128&d=identicon&r=PG&f=1", "display_name": "Kartik Sabharwal", "link": "https://stackoverflow.com/users/6889286/kartik-sabharwal"}, "edited": false, "score": 0, "creation_date": 1536860570, "post_id": 52304196, "comment_id": 91585577, "body": "I agree that the usual way to do it is according to your answer, but I wanted to sort-of show that the asker&#39;s expectations of the language were not in line with the way the language &quot;understands&quot; symbols like 1,2,3... if that makes sense. I would love to be corrected if I have the wrong idea of what the compiler is supposed to do."}, {"owner": {"reputation": 33, "user_id": 10354068, "user_type": "registered", "profile_image": "https://graph.facebook.com/507184540/picture?type=large", "display_name": "Brad Phillips", "link": "https://stackoverflow.com/users/10354068/brad-phillips"}, "edited": false, "score": 0, "creation_date": 1536929347, "post_id": 52304196, "comment_id": 91611357, "body": "Thanks for the awesome answer, I knew of the option using an either or maybe monad to fail nicely, but I get distracted by these sorts of questions. I like your suggestion to alias each of the digits to build our own un-bounded representation. Another solution a friend suggested was to have lists of null which i quite liked. Thanks for taking the time to write an answer! :)"}, {"owner": {"reputation": 33, "user_id": 10354068, "user_type": "registered", "profile_image": "https://graph.facebook.com/507184540/picture?type=large", "display_name": "Brad Phillips", "link": "https://stackoverflow.com/users/10354068/brad-phillips"}, "edited": false, "score": 0, "creation_date": 1537098188, "post_id": 52304196, "comment_id": 91652246, "body": "i went with: <code>module HanoiDisk(HanoiDisk, hanoiDisk) where</code> <code>data HanoiDisk = HanoiDisk&#39; Fractional deriving (Show)</code> <code>hanoiDisk :: Fractional -&gt; Maybe HanoiDisk</code> <code>hanoiDisk n </code> `  | n &lt;= 0 = Nothing` `  | otherwise = hanoiDisk&#39; n` I figure it makes sense to consider that a disk has a radius of &gt;0mm Thanks for your help!"}], "tags": [], "owner": {"reputation": 493, "user_id": 6889286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d9b8a4d03d0de0a49eac62a5569c9e?s=128&d=identicon&r=PG&f=1", "display_name": "Kartik Sabharwal", "link": "https://stackoverflow.com/users/6889286/kartik-sabharwal"}, "is_accepted": true, "score": 3, "last_activity_date": 1536836935, "last_edit_date": 1536836935, "creation_date": 1536790503, "answer_id": 52304196, "question_id": 52298627, "link": "https://stackoverflow.com/questions/52298627/haskell-compile-time-checking-of-smart-constructors/52304196#52304196", "title": "Haskell compile time checking of smart constructors", "body": "<p>From what I understand, you want a way to \"fail nicely\" when someone applies the function <code>hanoiDisk</code> to an argument that's less than 1.</p>\n\n<p>As a commenter stated, doing that at compile time is outside the scope of basic Haskell and you shouldn't need it in your day-to-day code!</p>\n\n<p>You can definitely \"fail nicely\" by using the <code>Either a b</code> datatype.  </p>\n\n<p>The idea is that if you have a function <code>hanoiDisk :: Integer -&gt; HanoiDisk</code> that takes an <code>Integer</code> and is supposed to return a <code>HanoiDisk</code> value if the input is \"good\" and an error value of some sort when the input is \"bad\", you can encode that using alternate constructors.</p>\n\n<p>The constructors for the <code>Either a b</code> datatype are <code>Left a</code> and <code>Right b</code> where\nan error output would be of the form <code>Left a</code> and a good output would be of the form <code>Right b</code>. Let's rewrite your function using this.</p>\n\n<pre><code>hanoiDisk :: Integer -&gt; Either String HanoiDisk \nhanoiDisk n = if n &gt;= 1 \n              then Right (HanoiDisk' n)\n              else Left \"a hanoi disk must be least 1\"\n</code></pre>\n\n<h1>(Probably) More Appropriate Answer</h1>\n\n<p>Let's discuss the simpler problem of constructing numbers that must be nonnegative (as opposed to positive) in a way that's acceptable to the compiler.</p>\n\n<p>I think the problem is tied to the way numbers are parsed by the compiler. Any time you use the symbols '0', '1', '2', '3', '4', ..., '9' to represent digits in your program the language parser expects the end result to conform to a type like Int, Double, etc. and so when you use these symbols you open yourself up to the possibility that <em>someone</em> might prepend a '-' to the sequence of digits and turn your nonnegative number into a negative one.</p>\n\n<p>Let's make a new module called <strong>Natural</strong> which will allow us to create positive numbers. In it, we define \"aliases\" for the symbols '0',...,'1' using the first two letters of each symbol's name (eg. <code>tw</code> for '2'). Since humans write natural numbers using the decimal system, we create a data type called Natural that takes two arguments - the first digit of the number we're representing and then a list of subsequent digits. Finally, we selectively export functions from the module to prohibit \"misuse\" by users.</p>\n\n<pre><code>module Natural (ze,on,tw,th,fo,fi,si,se,ei,ni,Natural(..)) where\n\nnewtype Digit = Digit Int\n\nze = Digit 0\non = Digit 1\ntw = Digit 2\nth = Digit 3\nfo = Digit 4\nfi = Digit 5\nsi = Digit 6\nse = Digit 7\nei = Digit 8\nni = Digit 9\n\ndata Natural = Nat Digit [Digit]\n</code></pre>\n\n<p>As an example, the natural number 312 would be represented as <code>Nat th [on,tw]</code>.</p>\n\n<p>Any module importing <strong>Natural</strong> would only have access to the functions that we export, so attempts to use anything else to define a value of type <code>Natural</code> would result in compile errors. Furthermore, since we didn't export the <code>Digit</code> constructor there's no way for importers to define their own values for the <code>Digit</code> type.</p>\n\n<p>I'm leaving out definitions of the instances for <code>Num</code>, <code>Integral</code>, <code>Eq</code>, <code>Ord</code>, etc. because I don't think they would add more to my explanation.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 3, "last_activity_date": 1536823287, "creation_date": 1536823287, "answer_id": 52308518, "question_id": 52298627, "link": "https://stackoverflow.com/questions/52298627/haskell-compile-time-checking-of-smart-constructors/52308518#52308518", "title": "Haskell compile time checking of smart constructors", "body": "<p>Haskell checks <em>types</em> when compiling a code, not values. To make types depend on values is the job of \"dependent types\". It is an advanced topic. </p>\n\n<p>The other way to achieve this is to make your <code>hanoiDisk</code> work <em>not</em> with <code>Integer</code>s, but with some \"<code>PositiveInteger</code>\" type which can not possibly be negative (or 0 as well..?). It is a more basic approach. </p>\n\n<p>There will be nothing to assert -- it should be impossible for you to even write down a negative value with this type. You'll have to make this type an instance of <code>Num</code>, <code>Eq</code>, <code>Ord</code>, and <code>Show</code> (maybe <code>Enum</code> as well).</p>\n\n<p>The usual way is to define</p>\n\n<pre><code>data Nat = Z | S Nat \n           deriving (Eq, Show)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10354068, "user_type": "registered", "profile_image": "https://graph.facebook.com/507184540/picture?type=large", "display_name": "Brad Phillips", "link": "https://stackoverflow.com/users/10354068/brad-phillips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 52304196, "answer_count": 2, "score": 1, "last_activity_date": 1536836935, "creation_date": 1536765710, "question_id": 52298627, "link": "https://stackoverflow.com/questions/52298627/haskell-compile-time-checking-of-smart-constructors", "title": "Haskell compile time checking of smart constructors", "body": "<p>I'm learning Haskell, running through the lectures:\n<a href=\"http://www.cis.upenn.edu/~cis194/spring13/\" rel=\"nofollow noreferrer\">http://www.cis.upenn.edu/~cis194/spring13/</a></p>\n\n<p>I've got:</p>\n\n<pre><code>module HanoiDisk(HanoiDisk, hanoiDisk) where\nimport Control.Exception\ndata HanoiDisk = HanoiDisk' Integer deriving (Show)\nhanoiDisk :: Integer -&gt; HanoiDisk \nhanoiDisk n = assert (n &gt;= 1) $ HanoiDisk' n\n</code></pre>\n\n<p>This works, but if i have:</p>\n\n<pre><code>main = do \n  print(show (hanoiDisk (-3))\n</code></pre>\n\n<p>I only get an error during run-time and not at compile-time.</p>\n\n<p>I'm pretty keen to understand how to eliminate run-time exceptions entirely.</p>\n\n<p>Can anyone provide an alternative approach?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "algebraic-data-types"], "answers": [{"tags": [], "owner": {"reputation": 13520, "user_id": 2315602, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8rKPi.jpg?s=128&g=1", "display_name": "lisyarus", "link": "https://stackoverflow.com/users/2315602/lisyarus"}, "is_accepted": false, "score": 4, "last_activity_date": 1536765058, "creation_date": 1536765058, "answer_id": 52298405, "question_id": 52298333, "link": "https://stackoverflow.com/questions/52298333/traversable-in-haskell/52298405#52298405", "title": "Traversable in Haskell", "body": "<p><code>Leaf</code> is a constructor, thus a function. In this case it has type <code>a -&gt; Tree a</code>. See <a href=\"https://wiki.haskell.org/Constructor#Data_constructors_as_first_class_values\" rel=\"nofollow noreferrer\">haskell wiki</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 6, "last_activity_date": 1536765196, "creation_date": 1536765196, "answer_id": 52298454, "question_id": 52298333, "link": "https://stackoverflow.com/questions/52298333/traversable-in-haskell/52298454#52298454", "title": "Traversable in Haskell", "body": "<p>Leaf is a function.</p>\n\n<p>If you use GADT syntax this becomes immediately apparent:</p>\n\n<pre><code>data Tree a where\n    Empty :: Tree a\n    Leaf  :: a -&gt; Tree a\n    Node  :: Tree a -&gt; a -&gt; Tree a -&gt; Tree a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "is_accepted": false, "score": 4, "last_activity_date": 1536765361, "creation_date": 1536765361, "answer_id": 52298510, "question_id": 52298333, "link": "https://stackoverflow.com/questions/52298333/traversable-in-haskell/52298510#52298510", "title": "Traversable in Haskell", "body": "<p>It helps to write <code>Tree</code> it in <a href=\"https://downloads.haskell.org/~ghc/master/users-guide/glasgow_exts.html#extension-GADTs\" rel=\"nofollow noreferrer\"><code>GADT</code></a><a href=\"https://downloads.haskell.org/~ghc/master/users-guide/glasgow_exts.html#extension-GADTSyntax\" rel=\"nofollow noreferrer\"><code>Syntax</code></a>:</p>\n\n<pre><code>{-# Language GADTs #-}\n\ndata Tree a where\n  Empty :: Tree a\n  Leaf  :: a -&gt; Tree a\n  Node  :: Tree a -&gt; a -&gt; Tree a -&gt; Tree a\n</code></pre>\n\n<p>which makes it clear that <code>Leaf :: a -&gt; Tree a</code> is a function. We can be explicit about the kind of <code>Tree</code>,</p>\n\n<pre><code>import Data.Kind\n\ndata Tree :: Type -&gt; Type where\n  ..\n</code></pre>\n"}], "owner": {"reputation": 269, "user_id": 7272130, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4f731e81d96903d3a06439adf360512d?s=128&d=identicon&r=PG&f=1", "display_name": "Felix Ha", "link": "https://stackoverflow.com/users/7272130/felix-ha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 52298454, "answer_count": 3, "score": 2, "last_activity_date": 1536768419, "creation_date": 1536764845, "last_edit_date": 1536768419, "question_id": 52298333, "link": "https://stackoverflow.com/questions/52298333/traversable-in-haskell", "title": "Traversable in Haskell", "body": "<p>I'm trying to understand  the example from the <code>Data.Traversable</code> documentation.</p>\n\n<pre><code> data Tree a = Empty | Leaf a | Node (Tree a) a (Tree a)\n\ninstance Traversable Tree where\n    traverse f Empty        = pure Empty\n    traverse f (Leaf x)     = Leaf &lt;$&gt; f x -- confusion\n</code></pre>\n\n<p>How it is possible to apply <code>Leaf &lt;$&gt; f x</code>. <code>Leaf</code> is not a function and it is still possible to use it.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "edited": false, "score": 1, "creation_date": 1536761848, "post_id": 52297199, "comment_id": 91542503, "body": "Please, don&#39;t downvote if you DONT KNOW how to escape character in Haskell. As I see, no way to do it without to reinvent the wheel with serial replace&#39;s. Am I right?"}, {"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 2, "creation_date": 1536761911, "post_id": 52297199, "comment_id": 91542545, "body": "There&#39;s more than one style of escaping - what will be consuming your escaped strings?  (If you want the escaping style that Haskell source code uses, just using <code>show</code> on the string would work.)"}, {"owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "reply_to_user": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1536762279, "post_id": 52297199, "comment_id": 91542846, "body": "and resulting string must be stripped from quote-symbols"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536763707, "post_id": 52297199, "comment_id": 91543723, "body": "You have to define &quot;special characters&quot; (everybody has a different idea about what&#39;s special), and then define how you want to escape what (is <code>\\e</code> a valid escape for the ASCII escape character?) And no, yoy are not right about serial replaces. That&#39;s neither the fastest method nor the easiest to implement."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1536765162, "post_id": 52297199, "comment_id": 91544617, "body": "There are several possible escape methods. Do you need any one of them in particular, or is any one fine, as long as it produces printable chars? <code>show</code>, as already suggested, could be enough (and you can strip the outermost quotes, if you do not want them)."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1536762764, "creation_date": 1536762764, "answer_id": 52297655, "question_id": 52297199, "link": "https://stackoverflow.com/questions/52297199/escaping-special-chars-in-haskell/52297655#52297655", "title": "Escaping special chars in Haskell", "body": "<p><code>show</code> will take an arbitrary <code>String</code> and serialize it to only printable 7-bit-safe characters.</p>\n\n<pre><code>&gt; show \"aaa\\nbbb\\r\"\n\"\\\"aaa\\\\nbbb\\\\r\\\"\"\n</code></pre>\n\n<p>The first and last characters will always be quotation marks, so you can safely drop the first and last characters if you prefer not to have this part of the standard serialization for some reason.</p>\n"}], "owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1210, "favorite_count": 1, "accepted_answer_id": 52297655, "answer_count": 1, "score": -1, "last_activity_date": 1536762764, "creation_date": 1536761365, "question_id": 52297199, "link": "https://stackoverflow.com/questions/52297199/escaping-special-chars-in-haskell", "title": "Escaping special chars in Haskell", "body": "<p>How to escape special characters in String / Text with Haskell? Preferred approach is to use standard solutions (\"standard\" functions, libraries). So,</p>\n\n<pre><code>\"aaa\\nbbb\\r\" must be transformed to \"aaa\\\\nbbb\\\\r\"\n</code></pre>\n\n<p>I found only JSONb library which is totally outdated and depends on old ByteString, so I can't build it. Also there is MissingH but it's collection of anything-anything. Is any standard solution for it, it looks very useful?</p>\n"}, {"tags": ["haskell", "copy", "file-permissions", "file-attributes"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1536756243, "post_id": 52295436, "comment_id": 91538543, "body": "<a href=\"https://hackage.haskell.org/package/directory-1.3.3.1/docs/System-Directory.html#v:copyFileWithMetadata\" rel=\"nofollow noreferrer\">copyFileWithMetadata</a>, perhaps?"}], "owner": {"reputation": 21, "user_id": 4407541, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J41Psx0t-XY/AAAAAAAAAAI/AAAAAAAABSI/i6HqNHPES2k/photo.jpg?sz=128", "display_name": "Martin Veverka", "link": "https://stackoverflow.com/users/4407541/martin-veverka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1536756035, "creation_date": 1536756035, "question_id": 52295436, "link": "https://stackoverflow.com/questions/52295436/how-to-copy-file-in-haskell-to-directory-with-append-only-permission-and-with", "title": "How to copy file in haskell to directory with &quot;append only&quot; permission and with preserving modification time", "body": "<p>I have destination directory on windows with \"append only\" permission. I want to copy file to it and I want to preserve modification time. Next code makes copy but than crashes:</p>\n\n<pre><code>import qualified Data.ByteString.Lazy  as BS\nwithBinaryFile destPath WriteMode (\\h -&gt; do\n     hSetBinaryMode h True\n     BS.readFile sourcePath &gt;&gt;= BS.hPut h\n   )\n-- next line crashes due to permission\ngetModificationTime sourcePath &gt;&gt;= setModificationTime destPath\n</code></pre>\n\n<p>The next code would be better, but the function hSetModificationTime does not exists</p>\n\n<pre><code>import qualified Data.ByteString.Lazy  as BS\nwithBinaryFile destPath WriteMode (\\h -&gt; do\n     hSetBinaryMode h True\n     BS.readFile sourcePath &gt;&gt;= BS.hPut h\n                                        -- not existing function \n     getModificationTime sourcePath &gt;&gt;= hSetModificationTime h\n\n   )\n</code></pre>\n"}, {"tags": ["haskell", "type-families", "associated-types"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1536756016, "post_id": 52295362, "comment_id": 91538391, "body": "This isn&#39;t standard Haskll 2010; it&#39;s one of GHC&#39;s more exotic language extensions. (Associated Types, I think...)"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1536756471, "post_id": 52295362, "comment_id": 91538699, "body": "ho yeah that is the name..... and this is the extension ... {-# LANGUAGE TypeFamilies   #-}"}], "answers": [{"tags": [], "owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "is_accepted": true, "score": 4, "last_activity_date": 1536768376, "creation_date": 1536768376, "answer_id": 52299399, "question_id": 52295362, "link": "https://stackoverflow.com/questions/52295362/meaning-of-type-declaration-in-a-typeclass-declaration/52299399#52299399", "title": "meaning of &quot;type&quot; declaration in a typeclass declaration", "body": "<p><code>Loc a</code> is an associated type, which is a way of declaring a type family instance associated with a class instance. The type represented by <code>Loc a</code> is determined by the type of <code>a</code>, and is specified in the instance: e.g.</p>\n\n<pre><code>instance Slice Foo where\n    type Loc Foo = Bar\n    ...\n</code></pre>\n\n<p>Wherever <code>Loc a</code> appears in the class declaration, it would be replaced with the corresponding type in the instance - so the instance functions for <code>Foo</code> would look like</p>\n\n<pre><code>sliceEvents :: Foo -&gt; [ResolvedEvent]\n...\nsliceFrom :: Foo -&gt; Bar\n...\n</code></pre>\n\n<p>The associated type can also be used in other functions outside the class declaration by giving a class constraint: e.g.</p>\n\n<pre><code>myFunction :: (Slice a) =&gt; a -&gt; Loc a\n</code></pre>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 52299399, "answer_count": 1, "score": 3, "last_activity_date": 1536784814, "creation_date": 1536755800, "last_edit_date": 1536784814, "question_id": 52295362, "link": "https://stackoverflow.com/questions/52295362/meaning-of-type-declaration-in-a-typeclass-declaration", "title": "meaning of &quot;type&quot; declaration in a typeclass declaration", "body": "<p>I've just fallen on that piece of code :</p>\n\n<pre><code>-- | Gathers common slice operations.\nclass Slice a where\n    type Loc a\n\n    sliceEvents :: a -&gt; [ResolvedEvent]\n    -- ^ Gets slice's 'ResolvedEvent's.\n    sliceDirection :: a -&gt; ReadDirection\n    -- ^ Gets slice's reading direction.\n    sliceEOS :: a -&gt; Bool\n    -- ^ If the slice reaches the end of the stream.\n    sliceFrom :: a -&gt; Loc a\n    -- ^ Gets the starting location of this slice.\n    sliceNext :: a -&gt; Loc a\n    -- ^ Gets the next location of this slice.\n    toSlice :: a -&gt; SomeSlice\n    -- ^ Returns a common view of a slice.\n</code></pre>\n\n<p>I don't understand what <code>type Loc a</code> is doing...</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1536752414, "post_id": 52294139, "comment_id": 91536151, "body": "I think it&#39;s not possible, but it could be quite useful!"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1536756129, "post_id": 52294139, "comment_id": 91538467, "body": "I believe <i>all</i> the files you&#39;re linking together have to be built in profiling mode. However, that says nothing about whether you can define the cost centers the way you want or not..."}, {"owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "edited": false, "score": 0, "creation_date": 1536757899, "post_id": 52294139, "comment_id": 91539811, "body": "Maybe my question is inaccurate. In my profiling output I see output from some packages (e.g. from <code>vector</code>) but I can&#39;t see any cost centers from e.g. <code>containers</code>."}], "owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1536751922, "creation_date": 1536751922, "question_id": 52294139, "link": "https://stackoverflow.com/questions/52294139/is-it-possible-to-profile-only-certain-packages-using-ghcs-profiler", "title": "Is it possible to profile only certain packages using GHC&#39;s profiler?", "body": "<p>Is it possible to only generate cost-centres for functions defined in certain packages? I'm not sure if this question actually makes sense from a technical viewpoint, in that case please enlighten me. What I'm interested in, essentially, is to get profiler output that only shows cost-centres for bindings in my own packages. Is this possible?</p>\n\n<p>Alternatively I'd like to be able exclude cost-centres from some packages. Is this possible?</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1536748876, "post_id": 52292843, "comment_id": 91534224, "body": "I understand that you can obtain what i want inside a <code>do</code> block but, i thought that  if you have a <code>type</code> with many fields that need extracting from <code>actions</code>  there has to be a quick way to write :  <code>data K=K Int Int Int</code> something like <code>a=K (action0&gt;&gt;=) (action1&gt;&gt;=) ...etc</code>. I thought  that everything that you can accomplish using <code>do</code> you can without it too."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1536750244, "post_id": 52292843, "comment_id": 91534966, "body": "Do you need any import for using the applicative because i get error when trying to use it like this in ghci: <code>data M=M Int Int ;  f = return 3; a= M &lt;$&gt; f  &lt;*&gt; f</code>"}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1536752262, "post_id": 52292843, "comment_id": 91536075, "body": "@BercoviciAdrian you shouldn&#39;t. (&lt;*&gt;) and (&lt;$&gt;) are exported by Prelude on modern GHC versions. which GHC version do you use? You should also make this a separate question."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1536753186, "post_id": 52292843, "comment_id": 91536586, "body": "I am using <code>version 8.0.2</code>"}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 1, "creation_date": 1536753992, "post_id": 52292843, "comment_id": 91537124, "body": "So it should work. You should make it a separate question and don&#39;t forget to include the error message."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1536749557, "last_edit_date": 1536749557, "creation_date": 1536747526, "answer_id": 52292843, "question_id": 52292727, "link": "https://stackoverflow.com/questions/52292727/how-to-use-monadic-binding-operator-on-adt-or-record-syntax/52292843#52292843", "title": "How to use Monadic binding operator on ADT or record syntax", "body": "<p>The field has type <code>Int</code>, so you can't bind it to anything of a different type, like <code>IO Int</code>.</p>\n\n<p>You can however, run the <code>IO Int</code> action, get an <code>Int</code> back, and use that.</p>\n\n<pre><code>foo :: IO Something\nfoo = do\n  i &lt;- return 3  -- run your (IO Int) action\n  let a = M { myfield = i }\n  ...\n  -- at the end, you have to use an (IO Something) action\n</code></pre>\n\n<p>Instead you can convert <code>N</code> to <code>M</code> as follows</p>\n\n<pre><code>convertNtoM :: N -&gt; M\nconvertNtoM (N i) = M { myfield = i }\n</code></pre>\n\n<p>This, again, does not bind a <code>N</code> value to <code>myfield</code>, but binds the integer \"inside\" the <code>N</code> value.</p>\n\n<hr>\n\n<p>In the case one has several actions to run, and many fields to fill, one can use the \"applicative style\".</p>\n\n<pre><code>data K = K Int Int Int Int\n\naction :: IO Int\naction = return 3\n\nfoo :: IO K\nfoo = K &lt;$&gt; action &lt;*&gt; action &lt;*&gt; action &lt;*&gt; action\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 52292843, "answer_count": 1, "score": 3, "last_activity_date": 1536771381, "creation_date": 1536747127, "last_edit_date": 1536771381, "question_id": 52292727, "link": "https://stackoverflow.com/questions/52292727/how-to-use-monadic-binding-operator-on-adt-or-record-syntax", "title": "How to use Monadic binding operator on ADT or record syntax", "body": "<p>Hello can someone please explain me how can you use the monadic binding operator  on a field of an Algebraic Data Type or record syntax?</p>\n\n<h3>E.g.</h3>\n\n<pre><code>data M = M {myfield :: Int}\ndata N = N Int\n</code></pre>\n\n<p>So for <code>M</code> if i want to extract the value from an <code>IO Int</code> action into <code>myfield</code>  it seems i can't say:</p>\n\n<pre><code>a = M { return 3 &gt;&gt;= value }\n</code></pre>\n\n<p>Also how can I bind for an <code>N</code> type?</p>\n"}, {"tags": ["haskell", "types", "io"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1536742863, "post_id": 52290934, "comment_id": 91530457, "body": "The fix depends on what you&#39;re trying to achieve. What is this code supposed to do?"}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1536743072, "post_id": 52290934, "comment_id": 91530604, "body": "outputting (writeFile) html created by using <code>mapM_</code> over list <code>setHTML</code>. The setDoc, setTitle etc are just placeholders"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1536743764, "post_id": 52290934, "comment_id": 91531032, "body": "What are you using <code>mapM_</code> for?"}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1536745628, "post_id": 52290934, "comment_id": 91532210, "body": "Because eventually the values in the list will be IO intake"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1536748358, "post_id": 52290934, "comment_id": 91533889, "body": "just to make sure - if you&#39;re using this for production make sure you either control the input or do some escaping to avoid JS-injections"}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1536762264, "post_id": 52290934, "comment_id": 91542833, "body": "@epsilonhalbe: I am a beginner in Haskell, but starting on pre-production code will help me use the info from all the books (LYAH, RWH, Graham Hutton etc). I plan on making it way more flexible and use HTML5/JS templating and Haskell to insert code, so you comment is very valuable to me. Thank you!"}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1536762651, "post_id": 52290934, "comment_id": 91543088, "body": "@chi: thanks for pitching in. I read it, but to me that is not directly related. I am aware of readFile/writeFile and how to operate. Jon Purdy came with a perfect answer with merely using &#39;unlines&#39;, rather than run it through a monadic function."}], "answers": [{"comments": [{"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "edited": false, "score": 0, "creation_date": 1536745686, "post_id": 52291777, "comment_id": 91532250, "body": "Super! This is a very elaborate answer, thank you for that. Thanks also for pointing out the options. Really appreciate this."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 5, "last_activity_date": 1536744215, "creation_date": 1536744215, "answer_id": 52291777, "question_id": 52290934, "link": "https://stackoverflow.com/questions/52290934/haskell-writefile/52291777#52291777", "title": "Haskell writeFile", "body": "<p><code>mapM_ putStrLn setHTML</code> is an action of type <code>IO ()</code>, which you\u2019re assigning to a name <code>content</code> with a <code>let</code> statement. When executed, this action would <em>print</em> each line of <code>setHTML</code>, returning nothing. You could execute this action by writing something like this:</p>\n\n<pre><code>main = do\n  let content = mapM_ putStrLn setHTML\n  content\n</code></pre>\n\n<p>Without the variable, this is just:</p>\n\n<pre><code>main = mapM_ putStrLn setHTML\n</code></pre>\n\n<p>But <code>content</code> is an opaque value\u2014the only things you can do with it are <em>execute</em> it from <code>main</code>, join it up to other <code>IO</code> actions with <code>&gt;&gt;=</code> (or <code>do</code> notation), and store it in a data structure (which isn\u2019t necessary here). In particular, it doesn\u2019t \u201cstore\u201d the content of the page, it merely describes to the runtime how it should print that content. And anyway there\u2019s the type mismatch you noticed: <code>writeFile</code> accepts a <code>String</code>, a.k.a. <code>[Char]</code>, which is obviously not an <code>IO ()</code>.</p>\n\n<p>But since you apparently want to use <code>writeFile</code> to write each line of <code>setHTML</code> to a file, instead of standard output, you don\u2019t want an action that will print the lines\u2014you want the lines themselves, joined together with newlines. There are a few possible ways to do that, depending on how you\u2019d like to extend this code.</p>\n\n<p>One way is to use the <code>unlines :: [String] -&gt; String</code> function to concatenate the lines together with newlines, then use <code>writeFile</code> to write the resulting <code>String</code> to <code>\"index.html\"</code>:</p>\n\n<pre><code>main = writeFile \"index.html\" (unlines setHTML)\n</code></pre>\n\n<p>If you want to place the concatenated content in a variable, you can of course do that:</p>\n\n<pre><code>main = do\n  let content = unlines setHTML\n  writeFile \"index.html\" content\n</code></pre>\n\n<p>(Indeed you might move the <code>unlines</code> call into the definition of <code>setHTML</code> if you don\u2019t need <code>setHTML</code> to be a <code>[String]</code>.)</p>\n\n<p>Now <code>writeFile</code> will accept <code>content</code> because it\u2019s a <code>String</code> value, not an <code>IO ()</code> action. This is a nice approach because it keeps the logic of <em>building</em> the page pure, and only uses <code>IO</code> as needed to actually <em>write</em> the page.</p>\n\n<p>Alternatively, you can take a more imperative approach, staying in <code>IO</code>. Then a good function to use is <code>withFile</code> (from <code>System.IO</code>), which has the following type:</p>\n\n<pre><code>FilePath -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r\n</code></pre>\n\n<p>It takes a <code>FilePath</code> to open, an <code>IOMode</code> (e.g. <code>ReadMode</code> or <code>WriteMode</code>) to indicate whether you\u2019ll be reading from or writing to the handle, and a <em>function</em> that accepts the handle and does some <code>IO</code> and returns a result of some type <code>r</code>; it returns an <code>IO</code> action that opens the file, runs your function, automatically ensures the file is closed (even if an exception was thrown), and returns the result.</p>\n\n<p>Then you would use <code>mapM_</code> in a similar way to how you already have, to print each line to that handle\u2014for that, there\u2019s <code>hPutStrLn :: Handle -&gt; String -&gt; IO ()</code> which writes to a particular handle, instead of <code>putStrLn</code> which writes to standard output. A compact version:</p>\n\n<pre><code>main = withFile \"index.html\" WriteMode $ \\file -&gt; do\n  mapM_ (hPutStrLn file) setHTML\n</code></pre>\n\n<p>Or a more verbose version if you don\u2019t like the look of the lambda:</p>\n\n<pre><code>main = withFile \"index.html\" WriteMode writeContents\n  where writeContents file = mapM_ (hPutStrLn file) setHTML\n</code></pre>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 905, "favorite_count": 1, "accepted_answer_id": 52291777, "answer_count": 1, "score": 3, "last_activity_date": 1536744215, "creation_date": 1536741526, "last_edit_date": 1536742816, "question_id": 52290934, "link": "https://stackoverflow.com/questions/52290934/haskell-writefile", "title": "Haskell writeFile", "body": "<p>Beginner. Got a module called HHtml outputting this: </p>\n\n<pre><code>  setDoc = \"&lt;!DOCTYPE = &lt;html&gt;&lt;head&gt;\"\n  setTitle = \"&lt;title&gt;\" ++ htmlTitle generator ++ \"&lt;/title&gt;\"\n  setHeader = \"&lt;header&gt;\" ++ htmlHeader generator ++ \"&lt;/header&gt;\"\n  setMeta = \"&lt;meta&gt;\" ++ htmlMeta generator ++ \"&lt;/meta&gt;&lt;/head&gt;\"\n  setBody = \"&lt;body&gt;\" ++ htmlBody generator ++ \"&lt;/body&gt;\"\n  setFooter = \"&lt;footer&gt;\" ++ htmlFooter generator ++ \"&lt;/footer&gt;\"\n  setEOF = \"&lt;/html&gt;\"\n\n  setHTML = [setDoc, setTitle, setHeader, setMeta, setBody, setFooter, setEOF]\n</code></pre>\n\n<p>main file:</p>\n\n<pre><code>import HHtml\nimport System.IO\n\nmain = do\n  let content = mapM_ putStrLn setHTML\n  writeFile \"index.html\" content\n</code></pre>\n\n<p>Now however I look at it I keep getting the <code>Couldn't match type IO() with [Char]</code> or any variant for that matter. I understand the error message, but I am getting so confused about fixing it. Thanks for the pointers!</p>\n"}, {"tags": ["performance", "haskell", "lazy-evaluation", "algebraic-data-types"], "answers": [{"comments": [{"owner": {"reputation": 1059, "user_id": 905132, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b45fbd1f6bf7a31e9dcb98d7811efc71?s=128&d=identicon&r=PG", "display_name": "fread2281", "link": "https://stackoverflow.com/users/905132/fread2281"}, "edited": false, "score": 2, "creation_date": 1553383200, "post_id": 52291058, "comment_id": 97365488, "body": "Currently (ghc 8.6.4), UNPACKing sums doesn&#39;t do anything."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1573350266, "post_id": 52291058, "comment_id": 103853367, "body": "GHC definitely doesn&#39;t use worker-wrapper for sums yet."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1611334163, "post_id": 52291058, "comment_id": 116426850, "body": "There is movement on unpacking sum types here: <a href=\"https://gitlab.haskell.org/ghc/ghc/-/merge_requests/4140\" rel=\"nofollow noreferrer\">gitlab.haskell.org/ghc/ghc/-/merge_requests/4140</a>"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1611334421, "post_id": 52291058, "comment_id": 116426956, "body": "Additional info to follow development:  <a href=\"https://gitlab.haskell.org/ghc/ghc/-/issues?label_name=UnboxedSums\" rel=\"nofollow noreferrer\">gitlab.haskell.org/ghc/ghc/-/issues?label_name=UnboxedSums</a> <a href=\"https://gitlab.haskell.org/ghc/ghc/-/wikis/unpacked-sum-types\" rel=\"nofollow noreferrer\">gitlab.haskell.org/ghc/ghc/-/wikis/unpacked-sum-types</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1611409450, "post_id": 52291058, "comment_id": 116444671, "body": "I wouldn&#39;t go so far as &quot;don&#39;t bother&quot;. Even for products, GHC&#39;s worker-wrapper doesn&#39;t apply to (non-inlined) higher-order functions. So some manual unboxing will still be required even after support for sums is added."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 6, "last_activity_date": 1611334372, "last_edit_date": 1611334372, "creation_date": 1536741948, "answer_id": 52291058, "question_id": 52290702, "link": "https://stackoverflow.com/questions/52290702/are-sum-types-defined-with-unboxedsums-more-efficient-than-plain-enum/52291058#52291058", "title": "Are sum types defined with UnboxedSums more efficient than plain enum?", "body": "<h2>Semantics and Representation</h2>\n<p>The two types cannot be used interchangeable.</p>\n<p>The type</p>\n<pre><code>data Bool = False | True\n</code></pre>\n<p>is a lifted type. This means that a variable <code>x :: Bool</code> can still be unevaluated (e.g. a thunk). It will therefore be represented as a pointer.</p>\n<p>In contrast</p>\n<pre><code>(# (# #) | (# #) #)\n</code></pre>\n<p>is unlifted, and really can only have the two values, and will be represented as just a machine integer.</p>\n<h2>Space efficiency</h2>\n<p>This does, however <em>not</em> mean that the latter is more space efficient: Because <code>True</code> and <code>False</code> are nullary constructors (they take no arguments), they exist once and for all in the static code of your program, and the pointers just point to them. So the cost is one machine word in all cases.</p>\n<h2>Run time efficiency</h2>\n<p>The unboxed variant may be slightly more efficient than <code>Bool</code>:</p>\n<ul>\n<li><p>For <code>Bool</code>, the code first has to check <em>is this already evaluated?</em>, and then it can branch on which constructor it is.</p>\n<p>The branching is pretty efficient: The code does not have to follow the pointer for that: The \u201cpointer tag\u201d in the low few bits of the pointer address will indicate which constructor it is. There is a slight cost for masking the other bits, though.</p>\n</li>\n<li><p>In the unboxed variant, well, it's just <code>0</code> or <code>1</code>, and no thunk check is needed.</p>\n</li>\n</ul>\n<h1>Things that might be true one day</h1>\n<p><strong>jberryman says</strong>: as of Jan 2021 the following don't appear to be implemented yet, but this is how things might one day work.</p>\n<h2>Unboxing in data types</h2>\n<p>If you define a data type like this</p>\n<pre><code>data Foo = Foo {-# UNPACK #-} !Bool\n</code></pre>\n<p>you should get exactly the same result as if you\u2019d write</p>\n<pre><code>data Foo = Foo (# (# #) | (# #) #)\n</code></pre>\n<p>as that was the main purpose of the unboxed sum extension.</p>\n<h2>Unboxing in functions</h2>\n<p>If you define a function that is strict in a <code>Bool</code> argument, e.g.</p>\n<pre><code>foo True = &quot;Hello&quot;\nfoo False = &quot;World!&quot;\n</code></pre>\n<p>then I could imagine (but did not check) that the compiler optimizes that into a <em>worker</em> that takes a <code>(# (# #) | (# #) #)</code> and a <em>wrapper</em> that takes care of the thunk-check. The wrapper might then inline in use-sites where <code>foo</code> is used, and everything might end up in terms of <code>(# (# #) | (# #) #)</code>.</p>\n<h2>Conclusion</h2>\n<p>Don\u2019t bother.</p>\n"}], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 1, "accepted_answer_id": 52291058, "answer_count": 1, "score": 5, "last_activity_date": 1611334372, "creation_date": 1536740731, "last_edit_date": 1536741959, "question_id": 52290702, "link": "https://stackoverflow.com/questions/52290702/are-sum-types-defined-with-unboxedsums-more-efficient-than-plain-enum", "title": "Are sum types defined with UnboxedSums more efficient than plain enum?", "body": "<p>For example, here is simple Haskell enum data type:</p>\n\n<pre><code>data Bool = False | True\n</code></pre>\n\n<p>There's <code>-XUnboxedSums</code> extension since GHC-8.2.1 that allows to define sum types in more memory-efficient way. Here is a quote from documentation:</p>\n\n<blockquote>\n  <p>In the degenerate case where all the alternatives have zero width, such as the <code>Bool</code>-like <code>(# (# #) | (# #) #)</code>, the unboxed sum layout only has an Int32 tag field (i.e., the whole thing is represented by an integer).</p>\n</blockquote>\n\n<p>I wonder, whether this representation is more efficient than using simple plain Haskell enum data type?</p>\n\n<p>And here is the full documentation:</p>\n\n<ul>\n<li><a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#unboxed-sums\" rel=\"noreferrer\">https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#unboxed-sums</a></li>\n</ul>\n"}, {"tags": ["function", "haskell", "parameters"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 7, "creation_date": 1536734066, "post_id": 52288773, "comment_id": 91525404, "body": "You can&#39;t &#39;catch&#39; compiler errors. When a compiled language fails to compile, there&#39;s nothing that will run, so no exceptions to catch. You must address compiler errors by writing the code in such a way that the errors disappear."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1536734173, "post_id": 52288773, "comment_id": 91525458, "body": "That is a very clear answer, so back to the code then. Thanks!"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 2, "creation_date": 1536738960, "post_id": 52288773, "comment_id": 91528114, "body": "As a side note, this definition would be better written as <code>putHtml (&quot;setTitle&quot;, input) = setTitle input</code>"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536733736, "creation_date": 1536733736, "question_id": 52288773, "link": "https://stackoverflow.com/questions/52288773/haskell-catch-function-without-parameters", "title": "Haskell catch function without parameters", "body": "<p>As an exercise working on own module for generating HTML, JS etc. If I got:</p>\n\n<pre><code>putHtml (attrib, input) | attrib == \"setTitle\" = setTitle input\n</code></pre>\n\n<p>and I were to call this without params like: <code>putHtml</code> the compiler will obviously complain. Since I am a beginner and Haskell has proven to be overwhelming a little, I am confused about how to catch functions with omitted params.</p>\n"}, {"tags": ["haskell", "haskell-wai"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1536895090, "post_id": 52284046, "comment_id": 91596043, "body": "Did you look on WAI&#39;s vault: <a href=\"https://www.yesodweb.com/blog/2015/10/using-wais-vault\" rel=\"nofollow noreferrer\">yesodweb.com/blog/2015/10/using-wais-vault</a> ?"}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1536920601, "post_id": 52284046, "comment_id": 91606597, "body": "I did. But I\u2019m not sure if each request shares the same vault or different. If it\u2019s the same vault, then it doesn\u2019t work for me. My understanding is that the examples in that blog post generate a global random key to store a single random data. If a new request comes, the data stored under that global key will be overwritten, this is not I wanted. The data stored in vault has the same lifecycle as the application, whereas what I wanted is to let the data have the same lifecycle as the Request so that I don\u2019t need to remember to delete them at he end of each request."}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1537312877, "post_id": 52284046, "comment_id": 91736621, "body": "Hi @michael-snoyman, Can I get some advice from you?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1537323208, "post_id": 52284046, "comment_id": 91738657, "body": "Just thinking out loudly: Can&#39;t you add that data in the header in one of the middleware and then retrieve them in the Yesod handlers and discard them ?"}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1537323843, "post_id": 52284046, "comment_id": 91738806, "body": "Thanks @Sibi. It works for the Request Id which is ByteString. But doesn\u2019t work for User, which is my own data type. Header value only supports Bytestring"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1537324434, "post_id": 52284046, "comment_id": 91738929, "body": "Can&#39;t you serialize User into ByteString ?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1537324491, "post_id": 52284046, "comment_id": 91738944, "body": "Since User likely has a <code>Show</code> instance, convert into <code>String</code> and then into <code>ByteString</code>. You also need to deserialize it properly."}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1537331831, "post_id": 52284046, "comment_id": 91740447, "body": "Yeah, that\u2019s a workaround if User is has a Show and Read instance. Thanks for giving the idea. I wonder if possible to achieve without this serialization and deserialization overhead."}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1536699088, "creation_date": 1536699088, "question_id": 52284046, "link": "https://stackoverflow.com/questions/52284046/how-to-store-values-generated-from-middleware-and-retrieve-them-from-routes", "title": "How to store values generated from middleware and retrieve them from routes", "body": "<p>I have a wai middleware that produces two values:</p>\n\n<ol>\n<li>A request id generated randomly for each request</li>\n<li>A User from a request to another service. </li>\n</ol>\n\n<p>Here is the code:</p>\n\n<pre><code>addRequestIdToRequestHeader' :: Application -&gt; Application\naddRequestIdToRequestHeader' app req respond = do\n  rid &lt;- nextRequestId :: IO ByteString\n  user &lt;- fetchUserByReq req :: IO User\n  req' &lt;- attachUserAndRequestIdToRequest user rid\n  app req' respond\n</code></pre>\n\n<p>Now I have a route <code>GET /user</code>. Inside of this route, I\u2019d like to have access to the request id and the User. As an example, I might just print them in the log.</p>\n\n<pre><code>main :: IO ()\nmain =\n  scotty 8080 $ do\n    get \"/user\" $ do\n      req &lt;- request\n      rid &lt;- liftAndCatchIO $ getRequestIdFromRequest req\n      user &lt;- liftAndCatchIO $ getUserFromRequest req\n      liftAndCatchIO $ print rid\n      liftAndCatchIO $ print user\n      text $ username user\n</code></pre>\n\n<p>The question is since the request id and the User are generated from the middleware, how to access them from the route? Basically how to implement the following functions used in the above code:</p>\n\n<pre><code>attachUserAndRequestIdToRequest :: User -&gt; ByteString -&gt; Request -&gt; IO Request\n\ngetRequestIdFromRequest :: Request -&gt; IO ByteString\n\ngetUserFromRequest :: Request -&gt; IO User\n</code></pre>\n\n<p>The scenario is the middleware is an Auth middleware, which forwards the request to another service for authentication and gets back the user value, which will be needed in the routes. </p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 51, "user_id": 10349071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98f104959145695a3437d41b573abb5?s=128&d=identicon&r=PG&f=1", "display_name": "junibug", "link": "https://stackoverflow.com/users/10349071/junibug"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1536692405, "post_id": 52282162, "comment_id": 91513288, "body": "@MichaelLitchard sorry I&#39;m new to Haskell and using the command line and I can&#39;t find a good explanation online. Can you explain what I&#39;m doing wrong?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1536693984, "post_id": 52282162, "comment_id": 91513987, "body": "Haskell files use <code>.hs</code> extensions, not <code>.txt</code> extensions. I strongly recommend reading <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">LYAH</a> before diving into SO questions. This is minimum effort research."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1536694963, "post_id": 52282162, "comment_id": 91514424, "body": "You should name your module files as in <code>Module.hs</code> (e.g. <code>Baby.hs</code>) with the <code>hs</code> extension and uppercase initial."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1536706442, "post_id": 52282162, "comment_id": 91518635, "body": "@AJFarmar The OP is presumably reading LYAH, as this example <a href=\"http://learnyouahaskell.com/starting-out#babys-first-functions\" rel=\"nofollow noreferrer\">comes from there</a>. That said, LYAH does suggest readers to save the file as <code>baby.hs</code> (that is, with the appropriate <code>hs</code> extension)."}], "answers": [{"tags": [], "owner": {"reputation": 558, "user_id": 5423827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l9wEa.jpg?s=128&g=1", "display_name": "suhao399", "link": "https://stackoverflow.com/users/5423827/suhao399"}, "is_accepted": false, "score": 11, "last_activity_date": 1536729704, "creation_date": 1536729704, "answer_id": 52287969, "question_id": 52282162, "link": "https://stackoverflow.com/questions/52282162/how-to-load-files-into-ghci/52287969#52287969", "title": "How to load files into ghci", "body": "<p>You should name the file with .hs extension.  and loading it using command  :l in ghci</p>\n\n<pre><code>Prelude&gt; :l baby.hs\n[1 of 1] Compiling Main             ( baby.hs, interpreted )\nOk, one module loaded.\n*Main&gt;\n*Main&gt;\n*Main&gt;\n*Main&gt; :t doubleme\ndoubleme :: Num a =&gt; a -&gt; a\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10349071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f98f104959145695a3437d41b573abb5?s=128&d=identicon&r=PG&f=1", "display_name": "junibug", "link": "https://stackoverflow.com/users/10349071/junibug"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5384, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1536729978, "creation_date": 1536690703, "last_edit_date": 1536729978, "question_id": 52282162, "link": "https://stackoverflow.com/questions/52282162/how-to-load-files-into-ghci", "title": "How to load files into ghci", "body": "<p>I'm trying to build a function in Haskell. I created a plain text file with the following function:</p>\n\n<pre><code>doubleme x = x + x\n</code></pre>\n\n<p>I saved it under baby.txt.</p>\n\n<p>I navigated to the file from the command line, then I did the following from the command line:</p>\n\n<pre><code>ghci\nPrelude&gt; :l baby\n</code></pre>\n\n<p>it returned:</p>\n\n<pre><code>target \u2018baby\u2019 is not a module name or a source file\n</code></pre>\n\n<p>I was wondering what I'm doing wrong and how to make the function compile?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 6, "creation_date": 1536677214, "post_id": 52278564, "comment_id": 91505147, "body": "In GHCi, you can type <code>:t foldr map</code> to derive the type, it then generates: <code>foldr map :: Foldable t =&gt; [a] -&gt; t (a -&gt; a) -&gt; [a]</code>."}, {"owner": {"reputation": 175, "user_id": 8843385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36b066e6fbd3997a82d7ea39d665603?s=128&d=identicon&r=PG&f=1", "display_name": "ramon abacherli", "link": "https://stackoverflow.com/users/8843385/ramon-abacherli"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536677352, "post_id": 52278564, "comment_id": 91505240, "body": "I know that, I wanna solve it without the compiler"}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 8843385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36b066e6fbd3997a82d7ea39d665603?s=128&d=identicon&r=PG&f=1", "display_name": "ramon abacherli", "link": "https://stackoverflow.com/users/8843385/ramon-abacherli"}, "edited": false, "score": 0, "creation_date": 1536678796, "post_id": 52278821, "comment_id": 91506153, "body": "Thank you very much! Why is the type of foldr map the return type of foldr?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 175, "user_id": 8843385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36b066e6fbd3997a82d7ea39d665603?s=128&d=identicon&r=PG&f=1", "display_name": "ramon abacherli", "link": "https://stackoverflow.com/users/8843385/ramon-abacherli"}, "edited": false, "score": 3, "creation_date": 1536679604, "post_id": 52278821, "comment_id": 91506680, "body": "@ramonabacherli If <code>f :: A -&gt; B</code> and <code>a :: A</code> then <code>f a :: B</code>."}, {"owner": {"reputation": 175, "user_id": 8843385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36b066e6fbd3997a82d7ea39d665603?s=128&d=identicon&r=PG&f=1", "display_name": "ramon abacherli", "link": "https://stackoverflow.com/users/8843385/ramon-abacherli"}, "edited": false, "score": 0, "creation_date": 1536679931, "post_id": 52278821, "comment_id": 91506904, "body": "oh that rule, I understand now"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1536678274, "last_edit_date": 1536678274, "creation_date": 1536677822, "answer_id": 52278821, "question_id": 52278564, "link": "https://stackoverflow.com/questions/52278564/what-is-the-type-of-foldr-map-in-haskell/52278821#52278821", "title": "What is the type of foldr map in haskell?", "body": "<p>As ingredients we have <code>foldr</code> and <code>map</code>. To avoid confusion, let us rename the <code>a</code> and <code>b</code> of <code>map</code> to <code>c</code> and <code>d</code>, since those are (possibly) different types. So we take as functions:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nmap   :: (c -&gt; d) -&gt; [c] -&gt; [d]\n</code></pre>\n\n<p>or more verbose:</p>\n\n<pre><code>foldr :: (a -&gt; (b -&gt; b)) -&gt; (b -&gt; ([a] -&gt; b))\nmap   :: (c -&gt; d) -&gt; ([c] -&gt; [d])\n</code></pre>\n\n<p>Since <code>map</code> is the parameter of a function application with <code>foldr</code> as function, this means that the type of <code>map</code> should be the same as the type of the <em>parameter</em> of <code>foldr</code>, hence:</p>\n\n<pre><code>  a        -&gt; (b   -&gt; b)\n~ (c -&gt; d) -&gt; ([c] -&gt; [d])\n----------------------------------\na ~ (c -&gt; d), b ~ [c] ~ [d], c ~ d\n</code></pre>\n\n<p>So we have derived that <code>a</code> is the same type as <code>c -&gt; d</code>, and that <code>b</code> is the same type as <code>[c]</code> and <code>[d]</code>. Therefore we also know that <code>c ~ d</code> (<code>c</code> is the same type as <code>d</code>).</p>\n\n<p>The type of <code>foldr map</code> is the <em>return</em> type of the <code>foldr</code> function, but specialized with the equality relations we have derived, so:</p>\n\n<pre><code>foldr map :: b -&gt; ([a] -&gt; b)\n</code></pre>\n\n<p>so we replace <code>a</code> with <code>c -&gt; c</code>, and <code>b</code> with <code>[c]</code>, hence the type:</p>\n\n<pre><code>foldr map :: [c] -&gt; ([c -&gt; c] -&gt; [c])\n</code></pre>\n\n<p>or in a less verbose form:</p>\n\n<pre><code>foldr map :: [c] -&gt; [c -&gt; c] -&gt; [c]\n</code></pre>\n\n<blockquote>\n  <p><strong>Note</strong>: the signature of <code>foldr</code> has been generalized to <code>foldr :: Foldable f =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; f a -&gt; b</code>, but deriving the type is similar.</p>\n</blockquote>\n"}], "owner": {"reputation": 175, "user_id": 8843385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36b066e6fbd3997a82d7ea39d665603?s=128&d=identicon&r=PG&f=1", "display_name": "ramon abacherli", "link": "https://stackoverflow.com/users/8843385/ramon-abacherli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 52278821, "answer_count": 1, "score": 4, "last_activity_date": 1536678274, "creation_date": 1536677045, "question_id": 52278564, "link": "https://stackoverflow.com/questions/52278564/what-is-the-type-of-foldr-map-in-haskell", "title": "What is the type of foldr map in haskell?", "body": "<p>I am trying to find out what the type of foldr map is, and how you should be solving something like this.</p>\n\n<p>I know what the individual types are:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nmap :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>I know how the individual functions work, but finding out the type is something I just can't seem to solve.</p>\n\n<p>foldr would take a function as first parameter, which would be the whole of map right?</p>\n\n<p>All tips are welcome, I am new to Haskell and trying to learn puzzles like these.</p>\n"}, {"tags": ["haskell", "haskell-stack", "haddock"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1536699043, "post_id": 52278428, "comment_id": 91516227, "body": "This is definitely entirely a <code>stack</code> issue. Haddock isn&#39;t supposed to know anything about your project structure (or which modules are test vs. library)."}], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1537602026, "post_id": 52449958, "comment_id": 91851754, "body": "Thanks David. I have the same versions of <code>stack</code> and <code>haddock</code> but the solution you proposed didn&#39;t work in my case. I get errors about packages not being available, and not finding link destinations for <code>IO</code>, <code>String</code>, <code>Int</code>, etc. Running haddock in this way (without being aware of the project structure) is likely to generate some crippled documentation. However I could try with <code>cabal</code> so thanks for the tip!"}, {"owner": {"reputation": 126, "user_id": 4129231, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S2wRYUYqhp8/AAAAAAAAAAI/AAAAAAAAAIE/KEqsaIbsJ34/photo.jpg?sz=128", "display_name": "David Baynard", "link": "https://stackoverflow.com/users/4129231/david-baynard"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1537652468, "post_id": 52449958, "comment_id": 91864228, "body": "Unfortunately you do have to supply the interface files if you want the links to work.  It&#39;s odd that packages aren&#39;t available, though. Do the tests build?"}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1537776252, "post_id": 52449958, "comment_id": 91891424, "body": "I see that the docs are placed in the <code>docs</code> folder despite of the errors. Even the current state of affairs regarding stack and haddock interaction is fair from optimal when it comes to test packages, the solution you provided can be used as a workaround."}, {"owner": {"reputation": 126, "user_id": 4129231, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S2wRYUYqhp8/AAAAAAAAAAI/AAAAAAAAAIE/KEqsaIbsJ34/photo.jpg?sz=128", "display_name": "David Baynard", "link": "https://stackoverflow.com/users/4129231/david-baynard"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 1, "creation_date": 1537808003, "post_id": 52449958, "comment_id": 91909441, "body": "<a href=\"https://github.com/commercialhaskell/stack/issues/729\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/729</a> is tracking this issue. There&#39;s another solution there, too involving cabal and stack together, though it may not still work."}], "tags": [], "owner": {"reputation": 126, "user_id": 4129231, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-S2wRYUYqhp8/AAAAAAAAAAI/AAAAAAAAAIE/KEqsaIbsJ34/photo.jpg?sz=128", "display_name": "David Baynard", "link": "https://stackoverflow.com/users/4129231/david-baynard"}, "is_accepted": true, "score": 2, "last_activity_date": 1537808120, "last_edit_date": 1537808120, "creation_date": 1537557729, "answer_id": 52449958, "question_id": 52278428, "link": "https://stackoverflow.com/questions/52278428/generating-haddock-for-test-modules-with-stack/52449958#52449958", "title": "Generating haddock for test modules with stack", "body": "<p><code>stack exec -- haddock test/**/*.hs -odocs -h</code></p>\n\n<p>I tested with stack 1.7.1 and haddock 2.20.0.</p>\n\n<p>It's not clear what platform you are on; that will work on zsh on linux. The principle should work on other platforms. It runs haddock on all the <code>.hs</code> files in the <code>test</code> directory and puts the html output (<code>-h</code>) in the <code>docs</code> directory (which it creates, if necessary). It seems to overwrite whatever is in there.</p>\n\n<p><s>You may wish to raise a feature request on the <a href=\"https://github.com/commercialhaskell/stack/issues/\" rel=\"nofollow noreferrer\">stack issue tracker</a>, too.</s> It's a good suggestion! And the resulting command would include the correct dependency links, without you having to supply them yourself.</p>\n\n<p>Finally, <a href=\"https://www.haskell.org/cabal/users-guide/nix-local-build.html#cfg-field-haddock-tests\" rel=\"nofollow noreferrer\">Cabal</a>, with its <code>new-build</code> options, can apparently do this (I haven't tested it). The <code>haddock-tests: True</code> option would go in the <code>cabal.project</code> file.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 1, "accepted_answer_id": 52449958, "answer_count": 1, "score": 2, "last_activity_date": 1537808120, "creation_date": 1536676685, "question_id": 52278428, "link": "https://stackoverflow.com/questions/52278428/generating-haddock-for-test-modules-with-stack", "title": "Generating haddock for test modules with stack", "body": "<p>Is there any way (using <code>stack</code>) to generate Haddock documentation for the test modules?</p>\n\n<p>The command:</p>\n\n<pre><code>stack haddock\n</code></pre>\n\n<p>will generate documentation for the library modules. I've tried to change some <a href=\"https://www.haskell.org/haddock/doc/html/invoking.html\" rel=\"nofollow noreferrer\">command line options</a> using <code>haddock-arguments</code> without any success.</p>\n\n<p>Even if <code>stack</code> doesn't support this, I'm open to other options.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1536673563, "post_id": 52277412, "comment_id": 91502653, "body": "What is the type of the input? A string? A list of <code>NucleoBasis</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 677, "user_id": 3536806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5321e2babfa1c70186599163a3c188?s=128&d=identicon&r=PG&f=1", "display_name": "Dominik Schrempf", "link": "https://stackoverflow.com/users/3536806/dominik-schrempf"}, "edited": false, "score": 0, "creation_date": 1536678758, "post_id": 52277553, "comment_id": 91506128, "body": "What about using a recursive function? Such as <code>hD&#39; :: Eq a =&gt; Int -&gt; [a] -&gt; [a] -&gt; Int</code> <code>hD&#39; n [] _ = n</code> <code>hD&#39; n _ [] = n</code> <code>hD&#39; n (x:xs) (y:ys) | x == y = hd&#39; (n+1) xs ys</code>                              <code>| otherwise = hd&#39; n xs ys</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 677, "user_id": 3536806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5321e2babfa1c70186599163a3c188?s=128&d=identicon&r=PG&f=1", "display_name": "Dominik Schrempf", "link": "https://stackoverflow.com/users/3536806/dominik-schrempf"}, "edited": false, "score": 1, "creation_date": 1536685237, "post_id": 52277553, "comment_id": 91509680, "body": "@DominikSchrempf: you probably should replace <code>x == y</code> for <code>x &#47;= y</code>, but this will indeed do the trick :)"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1536745355, "post_id": 52277553, "comment_id": 91532041, "body": "Another idiom I\u2019ve seen for counting things that match a condition, instead of <code>length</code>+<code>filter</code>, is <code>sum [1 | (a, b) &lt;- zip la lb, a &#47;= b]</code>, which is a pretty nice literal transcription of the problem: add 1 to the distance for each pair of characters in the two strings that differ at the same position. Also worth noting that Hamming distance is only defined for strings of equal length, so including a length check and calling <code>error</code> or returning <code>Maybe</code> would be better\u2014the advantage of the direct recursive solution is that this check can be included in the same traversal as the calculation."}, {"owner": {"reputation": 677, "user_id": 3536806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5321e2babfa1c70186599163a3c188?s=128&d=identicon&r=PG&f=1", "display_name": "Dominik Schrempf", "link": "https://stackoverflow.com/users/3536806/dominik-schrempf"}, "edited": false, "score": 1, "creation_date": 1536825757, "post_id": 52277553, "comment_id": 91565358, "body": "@WillemVanOnsem :), thanks! Because it interested me, I checked runtimes of the three possibilities (I did not use the Maybe type so that the comparison is more fair) on a ~1500 bp sequence with Criterion. The function using <code>filter</code> is slightly slower, than the other two, which have about the same speed. If the question is reopened, I can post my results (or I can edit your answer)."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1536750397, "last_edit_date": 1536750397, "creation_date": 1536673888, "answer_id": 52277553, "question_id": 52277412, "link": "https://stackoverflow.com/questions/52277412/fast-way-of-calculating-hamming-distance-in-haskell/52277553#52277553", "title": "Fast way of calculating hamming distance in haskell", "body": "<p>We can calculate the Hamming distance for two lists (with equal length) with the same type, given the type is an instance of the <code>Eq</code> type class, with:</p>\n\n<pre><code>hammingDistance :: Eq a =&gt; [a] -&gt; [a] -&gt; Int\nhammingDistance = (sum .) . zipWith ((fromEnum .) . (/=))\n</code></pre>\n\n<p>or an alternative:</p>\n\n<pre><code>hammingDistance :: Eq a =&gt; [a] -&gt; [a] -&gt; Int\nhammingDistance la lb = length (filter id (zipWith (/=) la lb))\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>Prelude&gt; hammingDistance \"GGGCCGTTGGT\" \"GGACCGTTGAC\"\n3\n</code></pre>\n\n<p>Both functions work more or less in a similar way: we enumerate over the two lists concurrently, and for the two elements we check if the two are not equal. We then count the number of elements that are not equal.</p>\n\n<h1>Making it more <em>safe</em></h1>\n\n<p>Since it is possible to call the above function with two lists with a different length, it might be better - like @JonPurdy suggests - to change the function, and add some checks. We can for example implement a function with signature:</p>\n\n<pre><code>hammingDistance :: Eq a =&gt; [a] -&gt; [a] -&gt; <b>Maybe</b> Int</code></pre>\n\n<p>Here we return <code>Nothing</code> in case the two lists have a different length, or <code>Just x</code> (with <code>x</code> the hamming distance of the two lists). We can for example write this with recursion:</p>\n\n<pre><code>hammingDistance :: Eq a =&gt; [a] -&gt; [a] -&gt; Int\nhammingDistance (x:xs) (y:ys) | x /= y = fmap (+1) tl\n                              | otherwise = tl\n    where tl = hammingDistance xs ys\nhammingDistance [] [] = Just 0\nhammingDistance _ _ = Nothing\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10347763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ecd1dd294b69ae2be2828b680253dd3?s=128&d=identicon&r=PG&f=1", "display_name": "maggibaggi", "link": "https://stackoverflow.com/users/10347763/maggibaggi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "closed_date": 1536696518, "accepted_answer_id": 52277553, "answer_count": 1, "score": -2, "last_activity_date": 1536750397, "creation_date": 1536673494, "last_edit_date": 1536676851, "question_id": 52277412, "link": "https://stackoverflow.com/questions/52277412/fast-way-of-calculating-hamming-distance-in-haskell", "closed_reason": "Needs more focus", "title": "Fast way of calculating hamming distance in haskell", "body": "<p>What is a fast way of calculating hamming distance in haskell, given two strings. </p>\n\n<p>For example, sample input:</p>\n\n<p><code>GGGCCGTTGGT</code> and <code>GGACCGTTGAC</code></p>\n\n<p>Output: </p>\n\n<pre><code>3\n</code></pre>\n"}, {"tags": ["haskell", "pointfree"], "answers": [{"comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1536681616, "post_id": 52276426, "comment_id": 91507880, "body": "FWIW I&#39;m not a fan of this extension, so at least one person disagrees this is &quot;The best way...&quot; ;)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1536682813, "post_id": 52276426, "comment_id": 91508533, "body": "You wouldn&#39;t care to explain why you don&#39;t like it?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1536700453, "post_id": 52276426, "comment_id": 91516799, "body": "sure,  sorry: 1) suddenly class constraints stop being a set (the ordering matters; do I now have to worry about re-ordering constraints in my own libraries (imagine my editor automatically alphabetizes them) to stop breakage for users who choose to use type application? Might it even cause bugs that pass the typechecker? I&#39;m honestly not sure).  2) Reuse of <code>@</code> for some totally unrelated meaning  3) applying a function to a type doesn&#39;t really make sense (I think this is a GHC internal implementation detail (dictionary passing) leaking upwards).  It might be I have wrong ideas about it though"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1536703190, "post_id": 52276426, "comment_id": 91517737, "body": "With 1) you definitely have a point. 2) and 3) don&#39;t seem that critical to me."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1536746000, "post_id": 52276426, "comment_id": 91532458, "body": "@jberryman: #1 is at least no worse than other languages like C++ where you always write explicit quantifiers and their order matters. Order will be important for Dependent Haskell too, since you can\u2019t freely move pi types around like <code>forall</code>s. Explicit quantifiers also have the advantage of enabling <code>ScopedTypeVariables</code> without changing a signature. Honestly, it seems a bit silly in retrospect that Haskell imposed lexical restrictions to differentiate type constructors &amp; variables just to avoid <code>forall</code> (or sigils like OCaml\u2019s <code>&#39;</code>)\u2014<code>@</code> would\u2019ve been a perfect ASCII substitute for <code>\u2200</code>, too!"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1536748983, "post_id": 52276426, "comment_id": 91534295, "body": "@JonPurdy I&#39;m not sure we&#39;d settle for \u201cat least no worse than C++\u201d in Haskell... I tend to agree, it would have been fine if we&#39;d always had mandatory explicit quantors, but I also agree with Brandon that it was nice that <i>order</i> of quantors used to not matter. But don&#39;t know if it would even be possible to retain that in Dependent Haskell."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1536784197, "post_id": 52276426, "comment_id": 91553731, "body": "@leftaroundabout: Haha, fair, I only used C++ as an example since it\u2019s the only one off the top of my head where you regularly partially apply type arguments. Explicit quantifiers are the norm in every imperative language with generics."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 11, "last_activity_date": 1536670320, "creation_date": 1536670320, "answer_id": 52276426, "question_id": 52275817, "link": "https://stackoverflow.com/questions/52275817/how-to-enforce-type-when-using-point-free-notation/52276426#52276426", "title": "How to enforce type when using point free notation", "body": "<p>The best way in modern Haskell is with a <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#visible-type-application\" rel=\"noreferrer\">type application</a>.</p>\n\n<pre><code>Prelude&gt; :set -XTypeApplications \nPrelude&gt; map (read @Double) [\"1.22\",\"3.33\",\"5.55\"]\n[1.22,3.33,5.55]\nPrelude&gt; map (read @Int) [\"1.22\",\"3.33\",\"5.55\"]\n[*** Exception: Prelude.read: no parse\n</code></pre>\n\n<p>This works because <code>read</code> has the signature</p>\n\n<pre><code>read :: \u2200 a . Read a =&gt; String -&gt; a\n</code></pre>\n\n<p>and therefore <code>read @Double</code> specialises <code>a ~ Double</code> and thus</p>\n\n<pre><code>read @Double :: String -&gt; Double\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1536682682, "post_id": 52277920, "comment_id": 91508466, "body": "So if i have a chain of composed methods <code>map ( f1 . read . f2 ) a</code> i could say :        <code>map ( f2 . read::t0-&gt;t1 . f0 ) a </code> where <code>f0::t0</code> and <code>read::t1</code> ?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1536683123, "post_id": 52277920, "comment_id": 91508670, "body": "Probably not, because <code>read . f0</code> doesn&#39;t really make sense if <code>f0</code> isn&#39;t a function that returns a <code>String</code>. You can&#39;t make wholesale changes to the type of <code>read</code>; you can only specialize its type."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1536690401, "post_id": 52277920, "comment_id": 91512209, "body": "@BercoviciAdrian With appropriate parentheses, that is syntactically correct: <code>map (f2 . (read :: t0 -&gt; t1) . f0) a</code>. That&#39;s likely to be a type error except in some very special circumstances where the context constrains <code>t0</code> and <code>t1</code> a lot, though."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1536675092, "creation_date": 1536675092, "answer_id": 52277920, "question_id": 52275817, "link": "https://stackoverflow.com/questions/52275817/how-to-enforce-type-when-using-point-free-notation/52277920#52277920", "title": "How to enforce type when using point free notation", "body": "<p><code>read</code> has type <code>String -&gt; a</code>, so <code>read x</code> has type <code>a</code>. Just like forcing <code>read x</code> to have type <code>Double</code> instead of <code>a</code> with <code>read x :: Double</code>, you can force <code>read</code> to have type <code>String -&gt; Double</code> instead:</p>\n\n<pre><code>b = map (read :: String -&gt; Double) a\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 52276426, "answer_count": 2, "score": 8, "last_activity_date": 1536675092, "creation_date": 1536668452, "question_id": 52275817, "link": "https://stackoverflow.com/questions/52275817/how-to-enforce-type-when-using-point-free-notation", "title": "How to enforce type when using point free notation", "body": "<p>Hello how can you enforce <code>GHC</code>  type for functions such as <code>Data.Text.read</code> or the <code>=~</code> operator from <code>Text.Regex.Posix</code> when composing methods?</p>\n\n<p>example:<br>\n<code>a=[\"1.22\",\"3.33\",\"5.55\"]</code><br></p>\n\n<p>Without point free:<br>\n<code>b= map (\\x-&gt; read x ::Double) a</code><br></p>\n\n<p>How to enforce a type for <code>read</code> with point free notation ?</p>\n\n<p><code>b=map read::Double a</code>  or <br>\n <code>b= map (read . f1 .f2 .f3... . fn )::Double  a</code>  (when composing methods) <br> where <code>f1 , f2 ...fn</code> are methods </p>\n\n<p>Or better how do you specify the <code>read</code> type when it belongs in a chain of methods ,<strong>BUT</strong> not at the end of the chain !  :\n<br>\n<code>b=map (f2 . read . f1 ) a</code></p>\n"}, {"tags": ["c++", "windows", "haskell", "haskell-stack", "lib"], "comments": [{"owner": {"reputation": 8857, "user_id": 3414900, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/KlvbC.jpg?s=128&g=1", "display_name": "bartop", "link": "https://stackoverflow.com/users/3414900/bartop"}, "edited": false, "score": 0, "creation_date": 1536671602, "post_id": 52275371, "comment_id": 91501260, "body": "I would start with <code>extern &quot;C&quot;</code> around the function that is exported. Name mangling may be the root of the problem"}], "answers": [{"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 1, "last_activity_date": 1536681287, "creation_date": 1536681287, "answer_id": 52279866, "question_id": 52275371, "link": "https://stackoverflow.com/questions/52275371/writing-a-static-cpp-library-for-a-haskell-stack-project/52279866#52279866", "title": "Writing a static cpp library for a haskell stack project", "body": "<p>Just use <code>c-sources:</code> in your <code>.cabal</code> file to make your \"library\" statically compile into the Haskell executable. Here is the example: <a href=\"https://github.com/commercialhaskell/stack/pull/4238/files\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/pull/4238/files</a></p>\n"}], "owner": {"reputation": 320, "user_id": 7255965, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/201ab93839e2c4184b8b6930fb434e58?s=128&d=identicon&r=PG&f=1", "display_name": "Yotam Ohad", "link": "https://stackoverflow.com/users/7255965/yotam-ohad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 52279866, "answer_count": 1, "score": 0, "last_activity_date": 1536681287, "creation_date": 1536667017, "question_id": 52275371, "link": "https://stackoverflow.com/questions/52275371/writing-a-static-cpp-library-for-a-haskell-stack-project", "title": "Writing a static cpp library for a haskell stack project", "body": "<p>I'm trying to write a debugger for windows with haskell stack. Because there is no other way to pass the right flags to <code>CreateProcess</code> using haskell packages I've decided to write a wrapper for it. Here is what I've done:</p>\n\n<pre><code>// process.h\n#pragma once\n\n// Headers\n#include &lt;Windows.h&gt;\n\n// Functions\nHANDLE CreateDebuggedProcess(LPCSTR lpApplicationName);\n</code></pre>\n\n<p>And</p>\n\n<pre><code>//process.cpp\n\n#include &lt;Windows.h&gt;\n\n#include \"process.h\"\n\nHANDLE CreateDebuggedProcess(LPCSTR lpApplicationName)\n{\n    STARTUPINFO startup_info = { 0 };\n    PROCESS_INFORMATION process_information = { 0 };\n\n    startup_info.cb = sizeof(startup_info);\n\n    if (!CreateProcessA(\n        lpApplicationName,\n        NULL,\n        NULL,\n        NULL,\n        FALSE,\n        DEBUG_ONLY_THIS_PROCESS,\n        NULL,\n        NULL,\n        &amp;startup_info,\n        &amp;process_information\n    ))\n    {\n        return INVALID_HANDLE_VALUE;\n    }\n\n    return process_information.hProcess;\n}\n</code></pre>\n\n<p>which I compiled to <code>DebuggedProcess.lib</code>\nOn the Haskell project I have:</p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\n\nmodule Main where\n\nimport System.Win32.Types\nimport Foreign.C.String\n\nmain :: IO ()\nmain = do\n    withCString \"cmd.exe\" c_CreateDebuggedProcess\n    putStrLn \"created process\"\n\nforeign import ccall \"DebuggedProcess.lib CreateDebuggedProcess\"\n    c_CreateDebuggedProcess :: LPCSTR -&gt; IO HANDLE\n</code></pre>\n\n<p>I've added the <code>.lib</code> file to the stack path (validated with <code>stack path --extra-include-dirs</code>) and added <code>extra-libraries: [DebuggedProcess]</code>.</p>\n\n<p>Yet I get the following error:</p>\n\n<pre><code>&gt;stack build\nBuilding all executables for `tape' once. After a successful build of all of them, only specified executables will be rebuilt.\ntape-0.1.0.0: configure (lib + exe)\nConfiguring tape-0.1.0.0...\nCabal-simple_Z6RU0evB_2.2.0.1_ghc-8.4.3.exe: Missing dependencies on foreign\nlibraries:\n* Missing (or bad) C libraries: DebuggedProcess, DebuggedProcess,\nDebuggedProcess\nThis problem can usually be solved by installing the system packages that\nprovide these libraries (you may need the \"-dev\" versions). If the libraries\nare already installed but in a non-standard location then you can use the\nflags --extra-include-dirs= and --extra-lib-dirs= to specify where they are.If\nthe library files do exist, it may contain errors that are caught by the C\ncompiler at the preprocessing stage. In this case you can re-run configure\nwith the verbosity flag -v3 to see the error messages.\n\n\n--  While building custom Setup.hs for package tape-0.1.0.0 using:\n    C:\\sr\\setup-exe-cache\\x86_64-windows\\Cabal-simple_Z6RU0evB_2.2.0.1_ghc-8.4.3.exe --builddir=.stack-work\\dist\\7d103d30 configure --with-ghc=C:\\Users\\yotam\\AppData\\Local\\Programs\\stack\\x86_64-windows\\ghc-8.4.3\\bin\\ghc.EXE --with-ghc-pkg=C:\\Users\\yotam\\AppData\\Local\\Programs\\stack\\x86_64-windows\\ghc-8.4.3\\bin\\ghc-pkg.EXE --user --package-db=clear --package-db=global --package-db=C:\\sr\\snapshots\\68fc3218\\pkgdb --package-db=D:\\tape\\.stack-work\\install\\db7ce97c\\pkgdb --libdir=D:\\tape\\.stack-work\\install\\db7ce97c\\lib --bindir=D:\\tape\\.stack-work\\install\\db7ce97c\\bin --datadir=D:\\tape\\.stack-work\\install\\db7ce97c\\share --libexecdir=D:\\tape\\.stack-work\\install\\db7ce97c\\libexec --sysconfdir=D:\\tape\\.stack-work\\install\\db7ce97c\\etc --docdir=D:\\tape\\.stack-work\\install\\db7ce97c\\doc\\tape-0.1.0.0 --htmldir=D:\\tape\\.stack-work\\install\\db7ce97c\\doc\\tape-0.1.0.0 --haddockdir=D:\\tape\\.stack-work\\install\\db7ce97c\\doc\\tape-0.1.0.0 --dependency=Win32=Win32-2.6.1.0 --dependency=base=base-4.11.1.0 --extra-include-dirs=C:\\Users\\yotam\\AppData\\Local\\Programs\\stack\\x86_64-windows\\msys2-20180531\\mingw64\\include --extra-include-dirs=D:\\tape\\lib --extra-lib-dirs=C:\\Users\\yotam\\AppData\\Local\\Programs\\stack\\x86_64-windows\\msys2-20180531\\mingw64\\bin --extra-lib-dirs=C:\\Users\\yotam\\AppData\\Local\\Programs\\stack\\x86_64-windows\\msys2-20180531\\mingw64\\lib --enable-tests --enable-benchmarks\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p>I am clueless on how to fix this. Any help would be apreciated</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 5, "creation_date": 1536662926, "post_id": 52274202, "comment_id": 91495622, "body": "Um, by implementing the function, as demanded by the task\u203d (If you want to implement it later but first complete other stuff in the module, you can for the time being make it <code>undefined</code>.)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1536663131, "post_id": 52274202, "comment_id": 91495740, "body": "Well as the error says, you did not provide an <i>implementation</i>, only a <i>signature</i>."}, {"owner": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "edited": false, "score": 0, "creation_date": 1536663391, "post_id": 52274202, "comment_id": 91495878, "body": "Sorry, Im a complete noob. Can you give me an example of an implementation? Like: repliNow :: n ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1536663659, "post_id": 52274202, "comment_id": 91496012, "body": "An implementation is one or more <code>=</code> clauses. I.e. <code>repliNow = undefined</code> or <code>repliNow n str = &quot;Sorry, today I don&#39;t feel like replicating the word &quot;++str++&quot; &quot;++show n++&quot; times.&quot;</code>."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 1, "last_activity_date": 1536663931, "creation_date": 1536663931, "answer_id": 52274471, "question_id": 52274202, "link": "https://stackoverflow.com/questions/52274202/haskell-the-type-signature-lacks-an-accompanying-binding/52274471#52274471", "title": "Haskell - The type signature lacks an accompanying binding", "body": "<p>You have not defined the function, but you have given a type signature. Hence, the compiler is telling you that you have not defined the function.</p>\n\n<p>If you read the error, it tells you this explicitly, if you know that 'binding' means 'definition':</p>\n\n<blockquote>\n  <p>The type signature for <code>\u2018repliNow\u2019</code> lacks an accompanying binding.</p>\n</blockquote>\n\n<p>This is essentially the compiler asking \"Ok, <code>repliNow</code> is this type, but what is it actually?\" A bit like if someone said \"<code>a</code> is a number,\" you'd be inclined to ask \"Ok, but what value does it have?\"</p>\n\n<p>Define the function, and this error will go away. This is something of the form:</p>\n\n<pre><code>repliNow int str = -- your implementation here.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "is_accepted": true, "score": 1, "last_activity_date": 1536947559, "creation_date": 1536947559, "answer_id": 52337032, "question_id": 52274202, "link": "https://stackoverflow.com/questions/52274202/haskell-the-type-signature-lacks-an-accompanying-binding/52337032#52337032", "title": "Haskell - The type signature lacks an accompanying binding", "body": "<p>I think I understand what you're getting at... I often read the :: symbol as \"is defined as\" which is a good way to read the function. So yes, you correctly DEFINED the function. repliNow :: Integer -> String -> String could be read as: \"repliNow IS DEFINED AS a function that takes an Integer and a String as input and then outputs a String\". But if you just put that into a haskell source code file and try to run it then GHC will complain because, as the other answer stated, you have merely given a signature not an implementation. So you've already fought half the battle with the signature definition and for an implementation there are many paths to success, for instance using recursion:</p>\n\n<pre><code>repliNow :: Integer -&gt; String -&gt; String\nrepliNow 0 _   = \"\"\nrepliNow n str = str ++ repliNow (n-1) str\n</code></pre>\n\n<p>Or perhaps ya wanna get fancy wif functions:</p>\n\n<pre><code>repliNow :: Integer -&gt; String -&gt; String\nrepliNow n str = concat $ replicate (fromIntegral n) str\n</code></pre>\n\n<p>I would recommend checking out these resources to further your Haskell know-how:</p>\n\n<p><a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch20.html#x28-23300020.4\" rel=\"nofollow noreferrer\">replicate and concat</a>,\n<a href=\"http://learnyouahaskell.com/recursion#hello-recursion\" rel=\"nofollow noreferrer\">recursion</a>,\n<a href=\"http://learnyouahaskell.com/starting-out#an-intro-to-lists\" rel=\"nofollow noreferrer\">lists</a>,\n<a href=\"https://stackoverflow.com/questions/31855909/haskell-fromintegral-type-confusion\">fromIntegral</a></p>\n\n<p>As a final note: function SIGNATURES/DEFINITIONS are a great way to quickly look and understand what a snippet of code SHOULD do, but only the IMPLEMENTATION will show what it ACTUALLY does.</p>\n"}], "owner": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3105, "favorite_count": 0, "accepted_answer_id": 52337032, "answer_count": 2, "score": -2, "last_activity_date": 1536947559, "creation_date": 1536662869, "question_id": 52274202, "link": "https://stackoverflow.com/questions/52274202/haskell-the-type-signature-lacks-an-accompanying-binding", "title": "Haskell - The type signature lacks an accompanying binding", "body": "<p><strong>My task:</strong> Define a function that replicates a given word n times</p>\n\n<pre><code>repliNow :: Integer -&gt; String -&gt; String\n</code></pre>\n\n<p>Which gives me </p>\n\n<blockquote>\n  <p>beginner.hs:1:1: error:\n      The type signature for \u2018repliNow\u2019 lacks an accompanying binding\n    |\n  1 | repliNow :: Integer -> String -> String\n    | ^^^^^^^^</p>\n</blockquote>\n\n<p>How do I solve this? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1536675523, "post_id": 52272650, "comment_id": 91504053, "body": "Why not just leave off the type signature?"}, {"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1536686738, "post_id": 52272650, "comment_id": 91510374, "body": "@melpomene not clear how that would help."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1536696571, "post_id": 52272650, "comment_id": 91515190, "body": "Probably no way short of TH. They really should have exposed type synonyms instead of (or in addition to) proxies throughout the whole library."}], "answers": [{"tags": [], "owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "is_accepted": false, "score": 0, "last_activity_date": 1536771320, "creation_date": 1536771320, "answer_id": 52300139, "question_id": 52272650, "link": "https://stackoverflow.com/questions/52272650/how-to-get-proxy-values-back-to-type-level/52300139#52300139", "title": "How to get Proxy values back to type-level?", "body": "<p>As far as I know, this is not possible - you can't access the type of a declared value in the way you want.</p>\n\n<p>As @Daniel Wagner commented, the libraries should export type synonyms - you could make a pull request to <a href=\"https://github.com/brendanhay/gogol\" rel=\"nofollow noreferrer\">the repository</a>, but this style is used across all the various libraries, so it might be a bit of work.</p>\n\n<p>An alternative, if you don't mind having a copy of the types locally, would be to do some type-level programming to avoid the repetition:</p>\n\n<pre><code>{-# LANGUAGE DataKinds, TypeFamilies, TypeOperators, TypeApplications #-}\n\n...\nimport Network.Gogol.Auth.Scope (Nub, (++))\n\n-- Type-level append, used by !\ntype family a !! b where\n    xs !! ys = Nub (xs ++ ys)\n\nmyEnv :: (MonadIO m, MonadCatch m) =&gt; Env (DriveScope !! SpreadsheetScope)\n-- Here, @ just lets you pass in type parameters that don't appear in the body\nmEnv = Network.Google.allow (Proxy @(DriveScope !! SpreadsheetScope)) newEnv\n\ntype DriveScope = '[...]\ntype SpreadsheetScope = '[...]\n</code></pre>\n\n<p>But that still does mean repeating them yourself.</p>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1536771320, "creation_date": 1536657450, "last_edit_date": 1536675338, "question_id": 52272650, "link": "https://stackoverflow.com/questions/52272650/how-to-get-proxy-values-back-to-type-level", "title": "How to get Proxy values back to type-level?", "body": "<p>It's hard to ask this question because I don't know the exact terminology to be used in this situation. I'll to try express myself through the exact problem I'm facing:</p>\n\n<p>The <code>gogol</code> set of libraries have a bunch of permissions exposed at the type-level through the use of <a href=\"http://hackage.haskell.org/package/gogol-sheets-0.3.0/docs/Network-Google-Sheets-Types.html#g:2\" rel=\"nofollow noreferrer\"><code>Proxy</code></a>\n- A number of functions in <code>gogol</code> are polymorphic over this \"permission list\", for example, <a href=\"http://hackage.haskell.org/package/gogol-0.3.0/docs/Network-Google-Env.html#v:newEnv\" rel=\"nofollow noreferrer\"><code>newEnv</code></a>, who's function signature looks like the following, where <code>s</code> is supposed to be a list of these proxies.</p>\n\n<pre><code>newEnv :: (MonadIO m, MonadCatch m, AllowScopes s) =&gt; m (Env s)\n</code></pre>\n\n<p>Now, here's how one is supposed to provide this <code>s</code> type-level parameter:</p>\n\n<pre><code>import Network.Google (allow, (!), newEnv, Env)\nimport Network.Google.Sheets (driveScope, spreadsheetsScope)\n\n\ntype MyScopes = '[ \"https://www.googleapis.com/auth/drive\"\n                 , \"https://www.googleapis.com/auth/spreadsheets\"\n                 ]\n\nmyEnv :: (MonadIO m, MonadCatch m) =&gt; Env MyScopes\nmEnv = Network.Google.allow (driveScope ! spreadsheetScope) newEnv\n\n-- or --\n\nmyEnv :: (MonadIO m, MonadCatch m) =&gt; Env MyScopes\nmEnv = Network.Google.allow (Proxy :: Proxy MyScopes) newEnv\n</code></pre>\n\n<p>Notice the duplication in that code snippet above? Even though the <code>gogol</code> library provides <code>driveScope</code> and <code>spreadsheetsScope</code>, I am being forced to type them out again. Is there any way to do the conceptual equivalent of the following:</p>\n\n<pre><code>myEnv :: (MonadIO m, MonadCatch m) =&gt; Env (driveScope ! spreadsheetScope)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1536657828, "creation_date": 1536657828, "answer_id": 52272760, "question_id": 52272608, "link": "https://stackoverflow.com/questions/52272608/haskell-coding-maximum-without-actually-using-the-function-beginner/52272760#52272760", "title": "Haskell - Coding &#39;maximum&#39; without actually using the function [beginner]", "body": "<p>You can test the function by <em>calling</em> it (yourself or with a test library, like <code>QuickCheck</code>). We can for example store the source code in a file (named <code>test.hs</code>):</p>\n\n<pre><code>-- test.hs\n\nmaxi :: Integer -&gt; Integer -&gt; Integer\nmaxi x y\n |x &gt; y = x\n |y &gt; x = y \n</code></pre>\n\n<p>Then we can for example start a GHC interactive session, by using the <code>ghci</code> command and load the file passing the file name as a parameter. We can then call it:</p>\n\n<pre><code>$ ghci test.hs\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( test.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; maxi 2 9\n9\n*Main&gt; maxi 3 5\n5\n*Main&gt; maxi 7 2\n7 \n</code></pre>\n\n<p>Is it correct? <strong>no</strong>. There is a case here that is not covered: in case <code>x</code> and <code>y</code> are the same, then it will raise an error:</p>\n\n<pre><code>*Main&gt; maxi 7 7\n*** Exception: test.hs:(4,1)-(6,13): Non-exhaustive patterns in function maxi\n</code></pre>\n\n<p>We can fix it by using <code>otherwise</code> as last check, which will always be <code>True</code> (in fact it is an alias for <code>True</code>). You can see <code>otherwise</code> as an <code>else</code>:</p>\n\n<pre><code>-- test.hs\n\nmaxi :: Integer -&gt; Integer -&gt; Integer\nmaxi x y\n | x &gt; y = x\n | otherwise = y \n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 52272760, "answer_count": 1, "score": 1, "last_activity_date": 1536657828, "creation_date": 1536657321, "question_id": 52272608, "link": "https://stackoverflow.com/questions/52272608/haskell-coding-maximum-without-actually-using-the-function-beginner", "title": "Haskell - Coding &#39;maximum&#39; without actually using the function [beginner]", "body": "<p>Complete the following function definition:</p>\n\n<pre><code>    -- maxi x y returns the maximum of x and y\n</code></pre>\n\n<p>I'm supposed to complete this task <em>without</em> using the 'maximum' function in Haskell. </p>\n\n<pre><code>maxi :: Integer -&gt; Integer -&gt; Integer\nmaxi x y\n |x &gt; y = x\n |y &gt; x = y \n</code></pre>\n\n<p>Then I don't understand how to proceed. How do I test if the code is valid? And does it look somewhat correct?</p>\n"}, {"tags": ["haskell", "ghc", "typeclass", "deriving"], "comments": [{"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "edited": false, "score": 1, "creation_date": 1536658848, "post_id": 52272578, "comment_id": 91493235, "body": "What is the difference between a TemplateHaskell script and a &quot;source plugin&quot;?"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "edited": false, "score": 0, "creation_date": 1536666496, "post_id": 52272578, "comment_id": 91497806, "body": "@DominiqueDevriese Syntax sugar. I would to write <code>data MyType = ... deriving (Eq, Ord, MyClass)</code> instead of <code>data MyType = ... deriving (Eq, Ord); deriveMyClass &#39;&#39;MyType</code>."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1536685556, "post_id": 52272578, "comment_id": 91509824, "body": "Why not use <code>Generic</code>? If you implement a default <code>Generic</code> interface you can use the <code>DeriveAnyClass</code> extension to get the syntax you want."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1536717654, "post_id": 52272578, "comment_id": 91520950, "body": "<code>Generic</code> introduces performance overhead. Because you first convert to <code>Generic</code> representation and only then you work on that <code>Generic</code>. This is the reason why people use <code>TemplateHaskell</code> to derive <code>ToJSON&#47;FromJSON</code> instances instead of using <code>DeriveAnyClass</code>."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1537152448, "post_id": 52272578, "comment_id": 91664679, "body": "@K.A.Buhr Sorry, I don&#39;t see why it&#39;s preposterous. Could you, please, elaborate more on the cons of this approach? GHC doesn&#39;t know how to generate efficient instances for my typeclass if I write <code>deriving (MyClass)</code>. So there should be a way to teach GHC how to do so. Of course, I can fork GHC and add my logic there (in theory), but it&#39;s much better if this functionality can be added externally to the compiler in the opt-in way via some plugin for example. Writing this a compiler plugin allows to work with GHC AST directly instead of using <code>TemplateHaskell</code>."}], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1537246689, "creation_date": 1536657234, "last_edit_date": 1537246689, "question_id": 52272578, "link": "https://stackoverflow.com/questions/52272578/easiest-way-to-extend-ghc-with-new-deriving-capabilities", "title": "Easiest way to extend GHC with new deriving capabilities?", "body": "<p>I would like to teach GHC to derive new typeclasses. Is it possible to do this externally without using <code>Generic</code> or TemplateHaskell? Like, with source plugins or something similar. So I can write:</p>\n\n<pre><code>data MyType = ...\n    deriving MyTypeClass\n</code></pre>\n\n<p><strong>UPDATE:</strong> Relevant GHC ticket with discussion:</p>\n\n<ul>\n<li><a href=\"https://ghc.haskell.org/trac/ghc/ticket/15650\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/ticket/15650</a></li>\n</ul>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1536654631, "post_id": 52271795, "comment_id": 91490699, "body": "You don&#39;t need the outer parens."}], "tags": [], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "is_accepted": false, "score": 1, "last_activity_date": 1536654573, "creation_date": 1536654573, "answer_id": 52271795, "question_id": 52271601, "link": "https://stackoverflow.com/questions/52271601/pattern-matching-fields-but-also-have-a-variable-that-represents-the-entire-data/52271795#52271795", "title": "Pattern Matching fields but also have a variable that represents the entire datatype", "body": "<p>It was an issue with parentheses ! </p>\n\n<pre><code>instance ToJSON CommandRequest where\n   toJSON (command @ (CreateWorkspace commandId workspaceId)) = object [\n          \"commandId\" .= commandId,\n          \"workspaceId\" .= workspaceId,\n          \"commandName\" .= pack \"createWorkspace\"]\n   toJSON (command @ (IntroduceIdea commandId workspaceId ideaContent)) = object [\n             \"commandId\" .= commandId,\n             \"workspaceId\" .= workspaceId,\n             \"commandName\" .= getCommandName command,\n             \"ideaContent\" .= ideaContent\n             ]\n</code></pre>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1536654573, "creation_date": 1536653831, "question_id": 52271601, "link": "https://stackoverflow.com/questions/52271601/pattern-matching-fields-but-also-have-a-variable-that-represents-the-entire-data", "title": "Pattern Matching fields but also have a variable that represents the entire datatype", "body": "<p>I would like to pattern match on a function with the following sum type :</p>\n\n<pre><code>data CommandRequest  = CreateWorkspace {commandId :: UUID , workspaceId ::UUID }\n                 | IntroduceIdea {commandId :: UUID , workspaceId ::UUID , ideaContent :: String}\n</code></pre>\n\n<p>So I know how to bind variables on the fields :</p>\n\n<pre><code>instance ToJSON CommandRequest where\n   toJSON (CreateWorkspace commandId workspaceId) = object [\n          \"commandId\" .= commandId,\n          \"workspaceId\" .= workspaceId,\n          \"commandName\" .= pack \"createWorkspace\"]\n   toJSON (IntroduceIdea commandId workspaceId ideaContent) = object [\n             \"commandId\" .= commandId,\n             \"workspaceId\" .= workspaceId,\n             \"commandName\" .= pack \"introduceIdea\",\n             \"ideaContent\" .= ideaContent\n             ]\n</code></pre>\n\n<p>I would like to bind the entire data type at the same time like we can do in scala :</p>\n\n<pre><code>toJSON ( myDataType  @ CreateWorkspace commandId workspaceId) = ...\n</code></pre>\n\n<p>Do you know how to do it in haskell ?</p>\n"}, {"tags": ["parsing", "haskell", "megaparsec"], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 4, "last_activity_date": 1537142123, "last_edit_date": 1537142123, "creation_date": 1536658402, "answer_id": 52272920, "question_id": 52270370, "link": "https://stackoverflow.com/questions/52270370/left-and-right-recursive-parser/52272920#52272920", "title": "Left and right recursive parser", "body": "<p>To factor out the left recursion in this:</p>\n\n<pre><code>foo ::= alphanum\n    | foo \".\" alphanum\n    | alphanum \"(\" foo \")\"\n</code></pre>\n\n<p>You can start by rewriting it to this:</p>\n\n<pre><code>foo ::= alphanum (\"(\" foo \")\")?\n      | foo \".\" alphanum\n</code></pre>\n\n<p>Then you can factor out the left recursion using the standard trick of replacing:</p>\n\n<pre><code>x ::= x y | z\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>x ::= z x'\n\nx' ::= y x' | \u2205\n</code></pre>\n\n<p>In other words:</p>\n\n<pre><code>x ::= z y*\n</code></pre>\n\n<p>With <code>x</code> = <code>foo</code>, <code>y</code> = <code>\".\" alphanum</code>, and <code>z</code> = <code>alphanum (\"(\" foo \")\")?</code>, that becomes:</p>\n\n<pre><code>foo ::= alphanum (\"(\" foo \")\")? (\".\" alphanum)*\n</code></pre>\n\n<p>Then I believe your parser can just be something like this, since <code>?</code> ~ zero or one ~ <code>Maybe</code> ~ <code>optional</code> and <code>*</code> ~ zero or more ~ <code>[]</code> ~ <code>many</code>:</p>\n\n<pre><code>parser = do\n  prefix &lt;- Simple &lt;$&gt; alphanum\n  maybeParens &lt;- optional (constant \"(\" *&gt; parser &lt;* constant \")\")\n  suffixes &lt;- many (constant \".\" *&gt; alphanum)\n  let\n    prefix' = case maybeParens of\n      Just content -&gt; Paren prefix content\n      Nothing -&gt; prefix\n  pure $ foldl' Dotted prefix' suffixes\n</code></pre>\n"}], "owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 2, "accepted_answer_id": 52272920, "answer_count": 1, "score": 5, "last_activity_date": 1537142123, "creation_date": 1536649284, "question_id": 52270370, "link": "https://stackoverflow.com/questions/52270370/left-and-right-recursive-parser", "title": "Left and right recursive parser", "body": "<p>This is an evolution of <a href=\"https://stackoverflow.com/questions/52198620/recursive-parser\">this question</a>.</p>\n\n<p>I need to parse with megaparsec a data structure like</p>\n\n<pre><code>data Foo =\n    Simple String\n    Dotted Foo String\n    Paren String Foo\n</code></pre>\n\n<p>and I would like to parse to it strings like</p>\n\n<pre><code>foo ::= alphanum\n    | foo \".\" alphanum\n    | alphanum \"(\" foo \")\"\n</code></pre>\n\n<p>For example a the string <code>\"a(b.c).d\"</code> should be parsed to <code>Dotted (Paren \"a\" (Dotted (Simple \"b\") \"c\")) \"d\"</code>.</p>\n\n<p>The problem I have is that this is at the same time left and right recursive.</p>\n\n<p>I have no problems writing the parsers for the first and the third case:</p>\n\n<pre><code>parser :: Parser Foo\nparser \n    = try (do\n        prefix &lt;- alphanum\n        constant \"(\"\n        content &lt;- parser\n        constant \")\"\n        pure $ Paren prefix content\n        )\n    &lt;|&gt; Simple alphanum\n</code></pre>\n\n<p>but I'm not able to put together also the parser for the second case. I tried to approach it with <code>sepBy1</code> or with <code>makeExprParser</code> but I couldn't get it right</p>\n"}, {"tags": ["haskell", "type-families", "polykinds"], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 2, "last_activity_date": 1536650111, "last_edit_date": 1536650111, "creation_date": 1536647232, "answer_id": 52269855, "question_id": 52268911, "link": "https://stackoverflow.com/questions/52268911/is-it-possible-to-define-variadic-kinded-data-types/52269855#52269855", "title": "Is it possible to define variadic-kinded data types?", "body": "<p>The \"axiomatic\" approach does actually work, I had just used the equality wrong:</p>\n\n<pre><code>fstP :: forall (a :: j -&gt; k) (b :: j -&gt; k) (x :: j). (a :*: b) x -&gt; a x\nfstP = castWith (Refl ~% promote2_law @(:*:) @a @b @x ~% Refl) fst\n    where\n    infixl 9 ~%\n    (~%) = Data.Type.Equality.apply\n</code></pre>\n\n<p>Using <code>Equality.apply</code> is essential to inform the type checker of where to apply the axiom.  I made <a href=\"https://gist.github.com/luqui/be7ab32f200ba9aece5092ca7a481b4b\" rel=\"nofollow noreferrer\">a full development</a> of higher-kinded products here for reference.</p>\n\n<p>Be warned, as I was playing with this did I get a GHC panic once.  So the nasty tricks might be nasty.  Still interested in other approaches.</p>\n"}], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52269855, "answer_count": 1, "score": 1, "last_activity_date": 1536734530, "creation_date": 1536641833, "last_edit_date": 1536734530, "question_id": 52268911, "link": "https://stackoverflow.com/questions/52268911/is-it-possible-to-define-variadic-kinded-data-types", "title": "Is it possible to define variadic-kinded data types?", "body": "<p>I can define a polykinded natural transformation like so:</p>\n\n<pre><code>type family (~&gt;) :: k -&gt; k -&gt; *\ntype instance (~&gt;) = (-&gt;)\n\nnewtype NT a b = NT { apply :: forall x. a x ~&gt; b x }\ntype instance (~&gt;) = NT\n</code></pre>\n\n<p>Which works at all kinds, so I can define e.g.</p>\n\n<pre><code>left :: Either ~&gt; (,)\nleft = NT (NT (Left . fst))\n</code></pre>\n\n<p>This is cool and inspiring.  But no matter how many tricks I play, I can't seem to get something variadic in the <em>return</em> type.  E.g. I would like</p>\n\n<pre><code>type family (:*:) :: k -&gt; k -&gt; k\ntype instance (:*:) = (,)\ntype instance (:*:) = ???\n</code></pre>\n\n<p>It seems like this is impossible, since type families need to be fully saturated, and you can only introduce type constructors in <code>*</code>.  </p>\n\n<p>I've even tried some rather nasty tricks</p>\n\n<pre><code>type instance (:*:) = Promote2 (:*:)\n\ntype family Promote2 :: (j -&gt; k -&gt; l) -&gt; (a -&gt; j) -&gt; (a -&gt; k) -&gt; (a -&gt; l) where\n\npromote2_law :: Promote2 f x y z :~: f (x z) (y z)\npromote2_law = unsafeCoerce Refl\n\nfstP :: forall (a :: k -&gt; *) (b :: k -&gt; *) (c :: k). (a :*: b) c -&gt; a c\nfstP = case promote2_law @(:~:) @a @b @c of Refl -&gt; NT (\\(a,b) -&gt; a)\n</code></pre>\n\n<p>And I don't know if that even has any hope of working, since I haven't thought through how higher kinded things are \"represented\".  But GHC knows I'm lying anyway</p>\n\n<pre><code>\u2022 Couldn't match type \u2018(,)\u2019 with \u2018Promote2 (,) a\u2019\n  Inaccessible code in\n    a pattern with constructor: Refl :: forall k (a :: k). a :~: a,\n</code></pre>\n\n<p>Are there any other tricks for this?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1536638820, "post_id": 52268413, "comment_id": 91484494, "body": "<code>(fmap . fmap) read $ getArgs :: IO [Int]</code>"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1536639001, "post_id": 52268413, "comment_id": 91484525, "body": "(note that <code>print</code> is <code>putStrLn . show</code>)"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1536640587, "post_id": 52268413, "comment_id": 91484866, "body": "It&#39;s not actually the function that gets Int arguments you want, but you&#39;d like arguments and you&#39;d like to interpret them as ints, right?  Does considering it as two separate steps help you?  Get args, convert strings to ints."}], "answers": [{"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 2, "last_activity_date": 1536641075, "last_edit_date": 1536641075, "creation_date": 1536640661, "answer_id": 52268753, "question_id": 52268413, "link": "https://stackoverflow.com/questions/52268413/transform-getargs-from-io-string-to-io-int/52268753#52268753", "title": "Transform getArgs from IO [String] to IO [Int]", "body": "<p>Unwrap it in your head first. You need a function that goes from <code>IO [String] -&gt; IO [Int]</code>. First consider a function that goes from <code>f a -&gt; f b</code> -- well that's <code>fmap</code>!</p>\n\n<p>Then we just have to find a function that goes from <code>a -&gt; b</code>. In this case <code>a ~ [String]</code> and <code>b ~ [Int]</code>. Now we see another functor wrapping our concrete types -- <code>fmap</code> works again, this time abstracting away the <code>[]</code> instead of <code>IO</code>.</p>\n\n<p>Now we need a function that goes <code>String -&gt; Int</code>. This is <code>read</code>.</p>\n\n<pre><code>getIntArgs = fmap (fmap read) getArgs\n</code></pre>\n\n<p>since <code>f (g x) = (f . g) x</code>, we can write (and should prefer, it's Haskelly-er): <code>(fmap . fmap) read $ getArgs</code>.</p>\n\n<p>In fact your whole function is just:</p>\n\n<pre><code>main :: IO ()\nmain = (fmap (sum . fmap read) getArgs) &gt;&gt;= print\n-- assuming you're okay replacing `(+)` with `sum`\n\n-- if not:\nmain = (fmap (uncurry (+) . listToTuple . fmap read) getArgs) &gt;&gt;= print\n  where\n  listToTuple [a, b] = (a, b)\n</code></pre>\n"}], "owner": {"reputation": 3960, "user_id": 1556475, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/dbf54fca536242c214a1f99a6b9b8931?s=128&d=identicon&r=PG", "display_name": "Cameron Ball", "link": "https://stackoverflow.com/users/1556475/cameron-ball"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "accepted_answer_id": 52268753, "answer_count": 1, "score": 2, "last_activity_date": 1536641075, "creation_date": 1536638093, "question_id": 52268413, "link": "https://stackoverflow.com/questions/52268413/transform-getargs-from-io-string-to-io-int", "title": "Transform getArgs from IO [String] to IO [Int]", "body": "<p>I'd like to write a program like the following:</p>\n\n<pre><code>add :: Int -&gt; Int -&gt; Int\nadd a b = a + b\n\nmain :: IO ()\nmain = do\n    args &lt;- getIntArgs\n    case args of\n        [a,b] -&gt; putStrLn $ show $ add a b\n</code></pre>\n\n<p>Is there a way I can write the function <code>getIntArgs</code> in terms of <code>getArgs</code> (from <code>System.Environment</code>)?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1536627115, "post_id": 52267261, "comment_id": 91482288, "body": "<code>Expecting one more argument to \u2018Operand\u2019   Expected a type, but \u2018Operand\u2019 has kind \u2018* -&gt; Constraint\u2019</code>"}, {"owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1536627394, "post_id": 52267261, "comment_id": 91482337, "body": "Please see the edits"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1536650728, "post_id": 52267261, "comment_id": 91488638, "body": "Weakly realted: you defined a typeclass <code>Operand</code>. Do you expect to have at least two instances <code>instance Operand T1</code> and <code>instance Operand T2</code> for two distinct types <code>T1,T2</code>? If you think you will only use <code>Operand Expr</code>, this is a sign that you should not be using a typeclass, but simply define <code>combine :: Expr -&gt; Expr</code>. What are you trying to achieve?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 3, "creation_date": 1536655378, "post_id": 52267261, "comment_id": 91491116, "body": "I suspect that you&#39;re thinking in terms of object-oriented programming, with <code>combine</code> as a member function of the base class <code>Operand</code> and <code>Expr</code> inheriting from <code>Operand</code>. Type classes are not like OO classes \u2013 in particular, they&#39;re not types."}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 7, "last_activity_date": 1536673166, "last_edit_date": 1536673166, "creation_date": 1536627750, "answer_id": 52267346, "question_id": 52267261, "link": "https://stackoverflow.com/questions/52267261/expected-a-type-but-has-kind-constraint/52267346#52267346", "title": "Expected a type, but has kind \u2018* -&gt; Constraint\u2019", "body": "<p>In your code <code>Operand</code> is not a type, but <em>class</em> of types. There can be no values of type <code>Operand</code>, because it's not a data type. Therefore, you can't use it as part of the definition of <code>Expr</code>. </p>\n\n<p>The cryptic notation <code>* -&gt; Constraint</code> means that the identifier <code>Operand</code>, if applied to a type (denoted <code>*</code>), will give you a <code>Constraint</code>. The compiler says that it expected a type in that context (such as <code>Int</code> or <code>String</code> or <code>Maybe Float</code>, etc.), but you gave it <code>Operand</code>, which has kind <code>* -&gt; Constraint</code>.</p>\n\n<p>From your code, I'm guessing what you actually meant to do was to construct <code>Expr</code> in such a way that it can contain values of <em>any</em> types, as long as those types have an instance of <code>Operand</code>. Would that be a correct assumption?</p>\n\n<p>If so, then the way to do that is to wrap those values in an existential type:</p>\n\n<pre><code>data SomeOperand = forall a. Operand a =&gt; SomeOperand a\n</code></pre>\n\n<p>Or same thing in GADT notation:</p>\n\n<pre><code>data SomeOperand where\n    SomeOperand :: forall a. Operand a =&gt; a -&gt; SomeOperand\n</code></pre>\n\n<p>These notations literally say that type <code>SomeOperand</code> wraps exactly one value <code>a</code>, which must have an instance of <code>Operand</code>.</p>\n\n<p>Now you can use <code>SomeOperand</code> in the definition of <code>Expr</code>:</p>\n\n<pre><code>data Expr = Node Operator SomeOperand SomeOperand | Value Integer\n</code></pre>\n\n<p>Now, when matching on <code>Expr</code>, you'll get a value that has an instance of <code>Operand</code>, and so you'll be able to apply <code>combine</code> to it:</p>\n\n<pre><code>f :: Expr -&gt; Expr\nf (Node op (SomeOperand a) (SomeOperand b)) = Expr op (combine a) (combine b)\nf (Value i) = Value i\n</code></pre>\n\n<p>Notice that you can't really do anything with such operands except convert them to other values of the same type, which again leaves you nowhere. In order for this to be useful in any way, the class <code>Operand</code> must have some methods for converting to something other than the type itself, for example:</p>\n\n<pre><code>class Operand a where\n    combine :: a -&gt; a\n    showOperand :: a -&gt; String\n</code></pre>\n\n<p>Now I can use <code>showOperand</code> to a useful end:</p>\n\n<pre><code>showExpr :: Expr -&gt; Expr\nshowExpr (Node op (SomeOperand a) (SomeOperand b)) = showOperand a ++ show op ++ showOperand b\nshowExpr (Value i) = show i\n</code></pre>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3903, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1536673166, "creation_date": 1536627009, "last_edit_date": 1536627389, "question_id": 52267261, "link": "https://stackoverflow.com/questions/52267261/expected-a-type-but-has-kind-constraint", "title": "Expected a type, but has kind \u2018* -&gt; Constraint\u2019", "body": "<p>I'm writing a calculator to add and subtract numbers. I have two abstractions here, an <code>Expr</code>, which is modeled as a tree, and a typeclass <code>Operand</code>, which comprise the left and right nodes of the tree. Operands have a function <code>combine</code> that apply a function to the left and right nodes:</p>\n\n<pre><code>module Data.Calculator where\n\nclass Operand a where\n    combine :: a -&gt; a\n\ndata Operator = Plus | Minus\ndata Expr = Node Operator Operand Operand | Value Integer\n\ninstance Operand Expr where\n    combine (Node op left right) =\n        case op of \n            Plus -&gt; (combine left) + (combine right)\n            Minus -&gt; (combine left) - (combine right)\n    combine (Value a) = (Value a)\n\ninstance Num Expr where\n    (+) (Value left) (Value right) = Value (left + right)\n    (*) (Value left) (Value right) = Value (left * right)\n    abs (Value a) = Value (abs a)\n    fromInteger i = Value i\n    negate (Value a) = Value (negate a)\n</code></pre>\n\n<p>When I try to compile this, I get the error</p>\n\n<pre><code>calculator/src/Data/Calculator.hs:7:35: error:\n\n    \u2022 Expecting one more argument to \u2018Operand\u2019\n      Expected a type, but \u2018Operand\u2019 has kind \u2018* -&gt; Constraint\u2019\n    \u2022 In the type \u2018Operand\u2019\n      In the definition of data constructor \u2018Node\u2019\n      In the data declaration for \u2018Expr\u2019\n  |\n  | data Expr = Node Operator Operand Operand | Value Integer\n</code></pre>\n\n<p>What does this mean? I'm aware that this problem can be solved without defining Operand as a typeclass, but I'd like to use the <code>Operand</code> typeclass, since that is a subject I'm learning about now. What am I doing wrong?</p>\n"}, {"tags": ["haskell", "polymorphism", "typeclass", "parametric-polymorphism"], "answers": [{"comments": [{"owner": {"reputation": 287, "user_id": 3226641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/08464e5b46111091f47687f4aad09c13?s=128&d=identicon&r=PG&f=1", "display_name": "yhylord", "link": "https://stackoverflow.com/users/3226641/yhylord"}, "edited": false, "score": 0, "creation_date": 1536627620, "post_id": 52266979, "comment_id": 91482401, "body": "Can you explain a bit on what FlexibleContexts mean and how it relates to the error here?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 287, "user_id": 3226641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/08464e5b46111091f47687f4aad09c13?s=128&d=identicon&r=PG&f=1", "display_name": "yhylord", "link": "https://stackoverflow.com/users/3226641/yhylord"}, "edited": false, "score": 3, "creation_date": 1536631751, "post_id": 52266979, "comment_id": 91483095, "body": "@yhylord There&#39;s not much to say. The Report says that in contexts (including <code>instance</code> contexts), classes may only be applied to (type) variables. Since <code>Validation a b</code> is not a variable, <code>Arbitrary (Validation a b)</code> is not allowed in instance contexts -- but since <code>a</code> is a variable and <code>b</code> is a variable, <code>Arbitrary a</code> and <code>Arbitrary b</code> are both fine. The <code>FlexibleContexts</code> extension does nothing more than lift this restriction."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1536624339, "creation_date": 1536624339, "answer_id": 52266979, "question_id": 52266944, "link": "https://stackoverflow.com/questions/52266944/non-type-variable-argument-in-the-constraint-for-arbitrary-typeclass/52266979#52266979", "title": "Non type-variable argument in the constraint for Arbitrary typeclass", "body": "<p>It's a silly restriction that was put in place before it was understood how difficult typeclasses would be to implement. Turns out it's easy enough to support, so there's a language extension -- mentioned in the error -- that lets you say that. You can turn it on by adding</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n</code></pre>\n\n<p>to the top of your file, and as extensions go this one is considered completely benign. However, in this case, you should not turn it on, and instead should just write</p>\n\n<pre><code>instance (Arbitrary a, Arbitrary b) =&gt; Arbitrary (AccumulateRight a b)\n</code></pre>\n\n<p>-- after all, <code>(Arbitrary a, Arbitrary b)</code> are exactly the conditions under which <code>Arbitrary (Validation a b)</code> holds.</p>\n"}], "owner": {"reputation": 287, "user_id": 3226641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/08464e5b46111091f47687f4aad09c13?s=128&d=identicon&r=PG&f=1", "display_name": "yhylord", "link": "https://stackoverflow.com/users/3226641/yhylord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 52266979, "answer_count": 1, "score": 0, "last_activity_date": 1536624339, "creation_date": 1536623939, "question_id": 52266944, "link": "https://stackoverflow.com/questions/52266944/non-type-variable-argument-in-the-constraint-for-arbitrary-typeclass", "title": "Non type-variable argument in the constraint for Arbitrary typeclass", "body": "<p>For an exercise in Chapter 15 of <em>Haskell Programming From First Principles</em>, I'm trying to write an <code>Arbitrary</code> instance based on another <code>Arbitrary</code> instance:</p>\n\n<pre><code>module AccumulateRight where\n\nimport Data.Semigroup\nimport Test.QuickCheck\n\ndata Validation a b = Fail a | Pass b deriving (Eq, Show)\n\nnewtype AccumulateRight a b =\n    AccumulateRight (Validation a b) deriving (Eq, Show)\n\ntype TestType = AccumulateRight String [Int]\n\ninstance Semigroup b =&gt; Semigroup (AccumulateRight a b) where\n    _ &lt;&gt; (AccumulateRight (Fail x)) = Fail x\n    (AccumulateRight (Fail x)) &lt;&gt; _ = Fail x\n    (AccumulateRight (Success a)) &lt;&gt; (AccumulateRight (Success b)) =\n        AccumulateRight . Success $ a &lt;&gt; b\n\ninstance (Arbitrary a, Arbitrary b) =&gt; Arbitrary (Validation a b) where\n    arbitrary = oneof [Fail &lt;$&gt; arbitrary, Pass &lt;$&gt; arbitrary]\n\ninstance Arbitrary (Validation a b) =&gt; Arbitrary (AccumulateRight a b) where\n    arbitrary = AccumulateRight &lt;$&gt; arbitrary\n\nsemigroupAssoc :: (Eq m, Semigroup m) =&gt; m -&gt; m -&gt; m -&gt; Bool\nsemigroupAssoc a b c = (a &lt;&gt; (b &lt;&gt; c)) == ((a &lt;&gt; b) &lt;&gt; c)\n\ntype Assoc = TestType -&gt; TestType -&gt; TestType -&gt; Bool\n\nmain :: IO ()\nmain = quickCheck (semigroupAssoc :: Assoc)\n</code></pre>\n\n<p>but the following error occurs:</p>\n\n<pre><code>    \u2022 Non type-variable argument\n        in the constraint: Arbitrary (Validation a b)\n      (Use FlexibleContexts to permit this)\n    \u2022 In the context: Arbitrary (Validation a b)\n      While checking an instance declaration\n      In the instance declaration for \u2018Arbitrary (AccumulateRight a b)\u2019\n   |\n22 | instance Arbitrary (Validation a b) =&gt; Arbitrary (AccumulateRight a b) where\n   |          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFailed, no modules loaded.\n</code></pre>\n\n<p>So am I doing anything wrong here? Why can't I use the typeclass of an existing data as the constraint here?</p>\n"}, {"tags": ["performance", "haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1536602544, "post_id": 52263163, "comment_id": 91474090, "body": "Please narrow this question down to something that can be fully explained in a couple of sentences, without requiring a link to something like HackerRank. As it stands, it&#39;s too open-ended. Also, why don&#39;t you show your C++ code and what exactly works faster in that version?"}, {"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 1, "creation_date": 1536602596, "post_id": 52263163, "comment_id": 91474109, "body": "You might want to split this up into a several different questions."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1536604349, "post_id": 52263163, "comment_id": 91474957, "body": "Isn&#39;t this simply even numbered of letters counts plus one (if there are odd numbered letters)?  <code>week -&gt; e:2 w:1 k:1 -&gt; 2+1=3</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1536608636, "post_id": 52263163, "comment_id": 91476906, "body": "@karafka No; e.g. for <code>week</code> there&#39;s only two palindromes of maximum length, namely <code>ewe</code> and <code>eke</code>. And no, it&#39;s not the number of <i>odd</i> letter counts either. Think of e.g. <code>bookmark</code>, where long palindromes begin <code>ok</code> or <code>ko</code>, then are followed by <code>b</code>, <code>m</code>, <code>a</code>, or <code>r</code>, so there are 2*4=8 maximum-length palindromes."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1536685069, "post_id": 52263163, "comment_id": 91509616, "body": "Oh, the number of maximum length palindromes.  Not the maximum length!"}], "answers": [{"comments": [{"owner": {"reputation": 1498, "user_id": 960404, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fp5n0.jpg?s=128&g=1", "display_name": "bmk", "link": "https://stackoverflow.com/users/960404/bmk"}, "edited": false, "score": 0, "creation_date": 1536653611, "post_id": 52266145, "comment_id": 91490154, "body": "Thank you so much for your detailed answer! As I suspected (and your answer confirmed it), my main problem was that I used <code>IntMap</code> for the memoization... I replaced in my code <code>IntMap</code> with <code>Array</code> and voila, now it has similar performance to your solution. And my frequency map is sure not as compact as your transposed version but in my opinion it doesn&#39;t make big difference especially for large test instances. The main lesson I learned is, that <code>Array</code> is in this case much better choice than <code>IntMap</code> for memoization."}, {"owner": {"reputation": 1498, "user_id": 960404, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fp5n0.jpg?s=128&g=1", "display_name": "bmk", "link": "https://stackoverflow.com/users/960404/bmk"}, "edited": false, "score": 0, "creation_date": 1536654492, "post_id": 52266145, "comment_id": 91490620, "body": "But still, our Haskell solutions perform about 10x worse than the equivalent C++ solution. As you suspect in your last paragraph, maybe the IO is here the culprit... Do you think we can optimize it further to reach C++&#39;s performance without making the code &quot;too ugly&quot;?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1498, "user_id": 960404, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fp5n0.jpg?s=128&g=1", "display_name": "bmk", "link": "https://stackoverflow.com/users/960404/bmk"}, "edited": false, "score": 0, "creation_date": 1536672746, "post_id": 52266145, "comment_id": 91502062, "body": "@bmk It is usually possible to come within a factor of 2-3x of C and C++ solutions without becoming ugly, and to be comparable if you&#39;re willing to deal with a few scattered eyesores. If you want to go faster, it is probably time to start profiling."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1536739173, "post_id": 52266145, "comment_id": 91528244, "body": "Is the <code>instance Integral</code> correct? The <code>5</code> looks like a typo."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1536744905, "post_id": 52266145, "comment_id": 91531773, "body": "@BartekBanachewicz It is correct. Try it yourself and see: try <code>(x `div` y) * y</code> for a couple different choices of <code>x</code> and <code>y</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1536619152, "last_edit_date": 1536619152, "creation_date": 1536617287, "answer_id": 52266145, "question_id": 52263163, "link": "https://stackoverflow.com/questions/52263163/competitive-programming-using-haskell/52266145#52266145", "title": "Competitive programming using Haskell", "body": "<p>I think you've shot yourself in the foot by trying to be too clever. Below I'll show a straightforward implementation of a slightly different algorithm that is about 5x faster than your Haskell code.</p>\n\n<p>Here's the core combinatoric computation. Given a character frequency count for a substring, we can compute the number of maximum-length palindromes this way:</p>\n\n<ul>\n<li>Divide all the frequencies by two, rounding down; call this the div2-frequencies. We'll also want the mod2-frequencies, which is the set of letters for which we had to round down.</li>\n<li>Sum the div2-frequencies to get the total length of the palindrome prefix; its factorial gives an overcount of the number of possible prefixes for the palindrome.</li>\n<li>Take the product of the factorials of the div2-frequencies. This tells the factor by which we overcounted above.</li>\n<li>Take the size of the mod2-frequencies, or choose 1 if there are none. We can extend any of the palindrome prefixes by one of the values in this set, if there are any, so we have to multiply by this size.</li>\n</ul>\n\n<p>For the overcounting step, it's not super obvious to me whether it would be faster to store precomputed inverses for factorials, and take their product, or whether it's faster to just take the product of all the factorials and do one inverse operation at the very end. I'll do the latter, because it just intuitively seems faster to do one inversion per query than one lookup per repeated letter, but what do I know? Should be easy to test if you want to try to adapt the code yourself.</p>\n\n<p>There's only one other quick insight I had vs. your code, which is that we can cache the frequency counts for prefixes of the input; then computing the frequency count for a substring is just pointwise subtraction of two cached counts. Your precomputation on the input I find to be a bit excessive in comparison.</p>\n\n<p>Without further ado, let's see some code. As usual there's some preamble.</p>\n\n<pre><code>module Main where\n\nimport           Control.Monad\nimport           Data.Array (Array)\nimport qualified Data.Array as A\nimport           Data.Map.Strict (Map)\nimport qualified Data.Map.Strict as M\nimport           Data.Monoid\n</code></pre>\n\n<p>Like you, I want to do all my computations on cheap <code>Int</code>s and bake in the modular operations where possible. I'll make a <code>newtype</code> to make sure this happens for me.</p>\n\n<pre><code>newtype Mod1000000007 = Mod Int deriving (Eq, Ord)\n\ninstance Num Mod1000000007 where\n    fromInteger = Mod . (`mod` 1000000007) . fromInteger\n    Mod l + Mod r = Mod ((l+r) `rem` 1000000007)\n    Mod l * Mod r = Mod ((l*r) `rem` 1000000007)\n    negate (Mod v) = Mod ((1000000007 - v) `rem` 1000000007)\n    abs = id\n    signum = id\n\ninstance Integral Mod1000000007 where\n    toInteger (Mod n) = toInteger n\n    quotRem a b = (a * b^1000000005, 0)\n</code></pre>\n\n<p>I baked in the base of <code>1000000007</code> in several places, but it's easy to generalize by giving <code>Mod</code> a phantom parameter and making a <code>HasBase</code> class to pick the base. Ask a fresh question if you're not sure how and are interested; I'll be happy to do a more thorough writeup. There's a few more instances for <code>Mod</code> that are basically uninteresting and primarily needed because of Haskell's wacko numeric class hierarchy:</p>\n\n<pre><code>instance Show Mod1000000007 where show (Mod n) = show n\ninstance Real Mod1000000007 where toRational (Mod n) = toRational n\ninstance Enum Mod1000000007 where\n    toEnum = Mod . (`mod` 1000000007)\n    fromEnum (Mod n) = n\n</code></pre>\n\n<p>Here's the precomputation we want to do for factorials...</p>\n\n<pre><code>type FactMap = Array Int Mod1000000007\n\nfactMap :: Int -&gt; FactMap\nfactMap n = A.listArray (0,n) (scanl (*) 1 [1..])\n</code></pre>\n\n<p>...and for precomputing frequency maps for each prefix, plus getting a frequency map given a start and end point.</p>\n\n<pre><code>type FreqMap = Map Char Int\n\nfreqMaps :: String -&gt; Array Int FreqMap\nfreqMaps s = go where\n    go = A.listArray (0, length s)\n        (M.empty : [M.insertWith (+) c 1 (go A.! i) | (i, c) &lt;- zip [0..] s])\n\nsubstringFreqMap :: Array Int FreqMap -&gt; Int -&gt; Int -&gt; FreqMap\nsubstringFreqMap maps l r = M.unionWith (-) (maps A.! r) (maps A.! (l-1))\n</code></pre>\n\n<p>Implementing the core computation described above is just a few lines of code, now that we have suitable <code>Num</code> and <code>Integral</code> instances for <code>Mod1000000007</code>:</p>\n\n<pre><code>palindromeCount :: FactMap -&gt; FreqMap -&gt; Mod1000000007\npalindromeCount facts freqs\n    =     toEnum (max 1 mod2Freqs)\n    *     (facts A.! sum div2Freqs)\n    `div` product (map (facts A.!) div2Freqs)\n    where\n    (div2Freqs, Sum mod2Freqs) = foldMap (\\n -&gt; ([n `quot` 2], Sum (n `rem` 2))) freqs\n</code></pre>\n\n<p>Now we just need a short driver to read stuff and pass it around to the appropriate functions.</p>\n\n<pre><code>main :: IO ()\nmain = do\n    inp &lt;- getLine\n    q   &lt;- readLn\n\n    let freqs = freqMaps inp\n        facts = factMap (length inp)\n\n    replicateM_ q $ do\n        [l,r] &lt;- map read . words &lt;$&gt; getLine\n        print . palindromeCount facts $ substringFreqMap freqs l r\n</code></pre>\n\n<p>That's it. Notably I made no attempt to be fancy about bitwise operations and didn't do anything fancy with accumulators; everything is in what I would consider idiomatic purely-functional style. The final count is about half as much code that runs about 5x faster.</p>\n\n<p>P.S. Just for fun, I replaced the last line with <code>print (l+r :: Int)</code>... and discovered that about half the time is spent in <code>read</code>. Ouch! Seems there's still plenty of low-hanging fruit if this isn't fast enough yet.</p>\n"}], "owner": {"reputation": 1498, "user_id": 960404, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/fp5n0.jpg?s=128&g=1", "display_name": "bmk", "link": "https://stackoverflow.com/users/960404/bmk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 980, "favorite_count": 0, "accepted_answer_id": 52266145, "answer_count": 1, "score": 7, "last_activity_date": 1536654342, "creation_date": 1536602437, "last_edit_date": 1536654342, "question_id": 52263163, "link": "https://stackoverflow.com/questions/52263163/competitive-programming-using-haskell", "title": "Competitive programming using Haskell", "body": "<p>I am currently trying to refresh my Haskell knowledge by solving some Hackerrank problems.</p>\n\n<p>For example:</p>\n\n<p><a href=\"https://www.hackerrank.com/challenges/maximum-palindromes/problem\" rel=\"nofollow noreferrer\">https://www.hackerrank.com/challenges/maximum-palindromes/problem</a></p>\n\n<p>I've already implemented an imperative solution in C++ which got accepted for all test cases. Now I am trying to come up with a pure functional solution in (reasonably idiomatic) Haskell.</p>\n\n<p>My current code is</p>\n\n<pre><code>module Main where\n\nimport           Control.Monad\nimport qualified Data.ByteString.Char8 as C\nimport           Data.Bits\nimport           Data.List\nimport qualified Data.Map.Strict       as Map\nimport qualified Data.IntMap.Strict    as IntMap\nimport           Debug.Trace\n\n-- precompute factorials\ncompFactorials :: Int -&gt; Int -&gt; IntMap.IntMap Int\ncompFactorials n m = go 0 1 IntMap.empty\n  where\n    go a acc map\n      | a &lt; 0     = map\n      | a &lt; n     = go a' acc' map'\n      | otherwise = map'\n      where\n        map' = IntMap.insert a acc map\n        a'   = a + 1\n        acc' = (acc * a') `mod` m\n\n-- precompute invs\ncompInvs :: Int -&gt; Int -&gt; IntMap.IntMap Int -&gt; IntMap.IntMap Int\ncompInvs n m facts = go 0 IntMap.empty\n  where\n    go a map\n      | a &lt; 0     = map\n      | a &lt; n     = go a' map'\n      | otherwise = map'\n      where\n        map' = IntMap.insert a v map\n        a' = a + 1\n        v = (modExp b (m-2) m) `mod` m\n        b = (IntMap.!) facts a\n\n\nmodExp :: Int -&gt; Int -&gt; Int -&gt; Int\nmodExp b e m = go b e 1\n  where\n    go b e r\n      | (.&amp;.) e 1 == 1 = go b' e' r'\n      | e &gt; 0 = go b' e' r\n      | otherwise = r\n        where\n          r' = (r * b) `mod` m\n          b' = (b * b) `mod` m\n          e' = shift e (-1)\n\n-- precompute frequency table\ninitFreqMap :: C.ByteString -&gt; Map.Map Char (IntMap.IntMap Int)\ninitFreqMap inp = go 1 map1 map2 inp\n  where\n    map1 = Map.fromList $ zip ['a'..'z'] $ repeat 0\n    map2 = Map.fromList $ zip ['a'..'z'] $ repeat IntMap.empty\n\n    go idx m1 m2 inp\n      | C.null inp = m2\n      | otherwise  = go (idx+1) m1' m2' $ C.tail inp\n      where\n        m1' = Map.update (\\v -&gt; Just $ v+1) (C.head inp) m1\n        m2' = foldl' (\\m w -&gt; Map.update (\\v -&gt; liftM (\\c -&gt; IntMap.insert idx c v) $ Map.lookup w m1') w m)\n              m2 ['a'..'z']\n\n\nquery :: Int -&gt; Int -&gt; Int -&gt; Map.Map Char (IntMap.IntMap Int)\n         -&gt; IntMap.IntMap Int -&gt; IntMap.IntMap Int -&gt; Int\nquery l r m freqMap facts invs\n  | x &gt; 1     = (x * y) `mod` m\n  | otherwise = y\n  where\n    calcCnt cs = cr - cl\n      where\n         cl = IntMap.findWithDefault 0 (l-1) cs\n         cr = IntMap.findWithDefault 0 r cs\n\n    f1 acc cs\n      | even cnt = acc\n      | otherwise = acc + 1\n      where\n        cnt = calcCnt cs\n\n    f2 (acc1,acc2) cs\n      | cnt &lt; 2   = (acc1 ,acc2)\n      | otherwise = (acc1',acc2')\n      where\n        cnt = calcCnt cs\n\n        n = cnt `div` 2\n\n        acc1' = acc1 + n\n        r = choose acc1' n\n        acc2' = (acc2 * r) `mod` m\n\n\n    -- calc binomial coefficient using Fermat's little theorem\n    choose n k\n      | n &lt; k = 0\n      | otherwise = (f1 * t) `mod` m\n      where\n        f1 = (IntMap.!) facts n\n        i1 = (IntMap.!) invs k\n        i2 = (IntMap.!) invs (n-k)\n\n        t = (i1 * i2) `mod` m\n\n\n    x = Map.foldl' f1 0 freqMap\n    y = snd $ Map.foldl' f2 (0,1) freqMap\n\n\nmain :: IO()\nmain = do\n    inp &lt;- C.getLine\n    q   &lt;- readLn :: IO Int\n\n    let modulo  = 1000000007\n    let facts   = compFactorials (C.length inp) modulo\n    let invs    = compInvs (C.length inp) modulo facts\n    let freqMap = initFreqMap inp\n\n    forM_ [1..q] $ \\_ -&gt; do\n\n      line &lt;- getLine\n\n      let [s1, s2] = words line\n      let l = (read s1) :: Int\n      let r = (read s2) :: Int\n\n      let result = query l r modulo freqMap facts invs\n\n      putStrLn $ show result\n</code></pre>\n\n<p>It passes all small and medium test cases but I am getting timeout with large test cases.\nThe key to solve this problem is to precompute some stuff once at the beginning and use them to answer the individual queries efficiently.</p>\n\n<p>Now, my main problem where I need help is:</p>\n\n<p>The initital profiling shows that the <code>lookup</code> operation of the <code>IntMap</code> seems to be the main bottleneck. Is there better alternative to <code>IntMap</code> for memoization? Or should I look at <code>Vector</code> or <code>Array</code>, which I believe will lead to more \"ugly\" code.\nEven in current state, the code doesn't look nice (by functional standards) and as verbose as my C++ solution. Any tips to make it more idiomatic? Other than <code>IntMap</code> usage for memoization, do you spot any other obvious problems which can lead to performance problems?</p>\n\n<p>And is there any good sources, where I can learn how to use Haskell more effectively for competitive programming?</p>\n\n<p>A sample large testcase, where the current code gets timeout:</p>\n\n<p><a href=\"https://gist.github.com/bmktuwien/1e7dffa067b6f1a17bd9f1c0f665d063\" rel=\"nofollow noreferrer\">input.txt</a>\n<a href=\"https://gist.github.com/bmktuwien/e58177b4d2ac499d5eb14c8e9f8100c9\" rel=\"nofollow noreferrer\">output.txt</a></p>\n\n<p>For comparison my C++ solution:</p>\n\n<pre><code>#include &lt;vector&gt;\n#include &lt;iostream&gt;\n\n#define MOD 1000000007L\n\nlong mod_exp(long b, long e) {\n    long r = 1;\n\n    while (e &gt; 0) {\n        if ((e &amp; 1) == 1) {\n            r = (r * b) % MOD;\n        }\n\n        b = (b * b) % MOD;\n        e &gt;&gt;= 1;\n    }\n\n    return r;\n}\n\nlong n_choose_k(int n, int k, const std::vector&lt;long&gt; &amp;fact_map, const std::vector&lt;long&gt; &amp;inv_map) {\n    if (n &lt; k) {\n        return 0;\n    }\n\n    long l1 = fact_map[n];\n    long l2 = (inv_map[k] * inv_map[n-k]) % MOD;\n\n    return (l1 * l2) % MOD;\n}\n\nint main() {\n    std::string s;\n    int q;\n\n    std::cin &gt;&gt; s &gt;&gt; q;\n\n    std::vector&lt;std::vector&lt;long&gt;&gt; freq_map;\n    std::vector&lt;long&gt; fact_map(s.size()+1);\n    std::vector&lt;long&gt; inv_map(s.size()+1);\n\n    for (int i = 0; i &lt; 26; i++) {\n        freq_map.emplace_back(std::vector&lt;long&gt;(s.size(), 0));\n    }\n\n    std::vector&lt;long&gt; acc_map(26, 0);\n    for (int i = 0; i &lt; s.size(); i++) {\n        acc_map[s[i]-'a']++;\n\n        for (int j = 0; j &lt; 26; j++) {\n            freq_map[j][i] = acc_map[j];\n        }\n    }\n\n    fact_map[0] = 1;\n    inv_map[0] = 1;\n    for (int i = 1; i &lt;= s.size(); i++) {\n        fact_map[i] = (i * fact_map[i-1]) % MOD;\n        inv_map[i] = mod_exp(fact_map[i], MOD-2) % MOD;\n    }\n\n    while (q--) {\n        int l, r;\n\n        std::cin &gt;&gt; l &gt;&gt; r;\n        std::vector&lt;long&gt; x(26, 0);\n\n        long t = 0;\n        long acc = 0;\n        long result = 1;\n\n        for (int i = 0; i &lt; 26; i++) {\n            auto cnt = freq_map[i][r-1] - (l &gt; 1 ? freq_map[i][l-2] : 0);\n\n            if (cnt % 2 != 0) {\n                t++;\n            }\n\n            long n = cnt / 2;\n\n            if (n &gt; 0) {\n                acc += n;\n                result *= n_choose_k(acc, n, fact_map, inv_map);\n                result = result % MOD;\n            }\n        }\n\n        if (t &gt; 0) {\n            result *= t;\n            result = result % MOD;\n        }\n\n        std::cout &lt;&lt; result &lt;&lt; std::endl;\n    }\n}\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>DanielWagner's answer has confirmed my suspicion that the main problem in my code was the usage of <code>IntMap</code> for memoization. Replacing <code>IntMap</code> with <code>Array</code> made my code perform similar to DanielWagner's solution.</p>\n\n<pre><code>module Main where\n\nimport           Control.Monad\nimport           Data.Array            (Array)\nimport qualified Data.Array            as A\nimport qualified Data.ByteString.Char8 as C\nimport           Data.Bits\nimport           Data.List\nimport           Debug.Trace\n\n\n-- precompute factorials\ncompFactorials :: Int -&gt; Int -&gt; Array Int Int\ncompFactorials n m = A.listArray (0,n) $ scanl' f 1 [1..n]\n  where\n    f acc a = (acc * a) `mod` m\n\n-- precompute invs\ncompInvs :: Int -&gt; Int -&gt; Array Int Int -&gt; Array Int Int\ncompInvs n m facts = A.listArray (0,n) $ map f [0..n]\n  where\n    f a = (modExp ((A.!) facts a) (m-2) m) `mod` m\n\nmodExp :: Int -&gt; Int -&gt; Int -&gt; Int\nmodExp b e m = go b e 1\n  where\n    go b e r\n      | (.&amp;.) e 1 == 1 = go b' e' r'\n      | e &gt; 0 = go b' e' r\n      | otherwise = r\n        where\n          r' = (r * b) `mod` m\n          b' = (b * b) `mod` m\n          e' = shift e (-1)\n\n-- precompute frequency table\ninitFreqMap :: C.ByteString -&gt; Map.Map Char (Array Int Int)\ninitFreqMap inp = Map.fromList $ map f ['a'..'z']\n  where\n    n = C.length inp\n    f c = (c, A.listArray (0,n) $ scanl' g 0 [0..n-1])\n      where\n        g x j\n          | C.index inp j == c = x+1\n          | otherwise = x\n\nquery :: Int -&gt; Int -&gt; Int -&gt; Map.Map Char (Array Int Int)\n         -&gt; Array Int Int -&gt; Array Int Int -&gt; Int\nquery l r m freqMap facts invs\n  | x &gt; 1     = (x * y) `mod` m\n  | otherwise = y\n  where\n    calcCnt freqMap = cr - cl\n      where\n         cl = (A.!) freqMap (l-1)\n         cr = (A.!) freqMap r\n\n    f1 acc cs\n      | even cnt = acc\n      | otherwise = acc + 1\n      where\n        cnt = calcCnt cs\n\n    f2 (acc1,acc2) cs\n      | cnt &lt; 2   = (acc1 ,acc2)\n      | otherwise = (acc1',acc2')\n      where\n        cnt = calcCnt cs\n\n        n = cnt `div` 2\n\n        acc1' = acc1 + n\n        r = choose acc1' n\n        acc2' = (acc2 * r) `mod` m\n\n\n    -- calc binomial coefficient using Fermat's little theorem\n    choose n k\n      | n &lt; k = 0\n      | otherwise = (f1 * t) `mod` m\n      where\n        f1 = (A.!) facts n\n        i1 = (A.!) invs k\n        i2 = (A.!) invs (n-k)\n\n        t = (i1 * i2) `mod` m\n\n\n    x = Map.foldl' f1 0 freqMap\n    y = snd $ Map.foldl' f2 (0,1) freqMap\n\n\nmain :: IO()\nmain = do\n    inp &lt;- C.getLine\n    q   &lt;- readLn :: IO Int\n\n    let modulo  = 1000000007\n    let facts   = compFactorials (C.length inp) modulo\n    let invs    = compInvs (C.length inp) modulo facts\n    let freqMap = initFreqMap inp\n\n    replicateM_ q $ do\n\n      line &lt;- getLine\n\n      let [s1, s2] = words line\n      let l = (read s1) :: Int\n      let r = (read s2) :: Int\n\n      let result = query l r modulo freqMap facts invs\n\n      putStrLn $ show result\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1536592281, "creation_date": 1536592281, "answer_id": 52260792, "question_id": 52260416, "link": "https://stackoverflow.com/questions/52260416/decode-json-based-on-the-value-of-a-field-with-data-aeson/52260792#52260792", "title": "decode json based on the value of a field with Data.Aeson", "body": "<p>Just take a peek at the <code>commandName</code> with <code>(.:)</code> and decide what to do. So:</p>\n\n<pre><code>instance FromJSON CommandRequest  where\n    parseJSON (Object o) = do\n        commandName &lt;- o .: \"commandName\"\n        case commandName :: String of\n            \"createWorkspace\" -&gt; liftA2 CreateWorkspace (o .: \"commandId\") (o .: \"workspaceId\")\n            \"introduceIdea\" -&gt; liftA3 IntroduceIdea (o .: \"commandId\") (o .: \"workspaceId\") (o .: \"ideaContent\")\n            _ -&gt; typeMismatch \"wrongo\" (Object o)\n    parseJSON v = typeMismatch \"double wrongo\" v\n</code></pre>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 1, "accepted_answer_id": 52260792, "answer_count": 1, "score": 0, "last_activity_date": 1536653024, "creation_date": 1536591031, "last_edit_date": 1536653024, "question_id": 52260416, "link": "https://stackoverflow.com/questions/52260416/decode-json-based-on-the-value-of-a-field-with-data-aeson", "title": "decode json based on the value of a field with Data.Aeson", "body": "<p>How would you implement the FromJson of this Sum Type ?</p>\n\n<pre><code>data CommandRequest = CreateWorkspace {commandId :: UUID , workspaceId ::UUID }\n                 | IntroduceIdea {commandId :: UUID , workspaceId ::UUID , ideaContent :: String}\n\ninstance ToJSON CommandRequest where\n   toJSON (CreateWorkspace commandId workspaceId) = object [\n          \"commandId\" .= commandId,\n          \"workspaceId\" .= workspaceId,\n          \"commandName\" .= pack \"createWorkspace\"]\n   toJSON (IntroduceIdea commandId workspaceId ideaContent) = object [\n             \"commandId\" .= commandId,\n             \"workspaceId\" .= workspaceId,\n             \"commandName\" .= pack \"introduceIdea\",\n             \"ideaContent\" .= ideaContent\n             ]\n\ninstance FromJSON CommandRequest  where ... ?\n</code></pre>\n\n<p>so based on the commandName field commandName, I would to be able to re-construct the commands.</p>\n\n<p>Update : with the help of you guys, here is the result :</p>\n\n<pre><code>instance FromJSON CommandRequest  where\n\nparseJSON (Object jsonObject) = do\n         commandName &lt;- jsonObject .: \"commandName\"\n         case commandName of\n              Just (String \"createWorkspace\") -&gt; CreateWorkspace\n                  &lt;$&gt; jsonObject .: \"commandId\"\n                  &lt;*&gt; jsonObject .: \"workspaceId\"\n              Just (String \"introduceIdea\") -&gt; IntroduceIdea\n                  &lt;$&gt; jsonObject .: \"commandId\"\n                  &lt;*&gt; jsonObject .: \"workspaceId\"\n                  &lt;*&gt; jsonObject .: \"ideaContent\"\n              Just (String unknownCommandName) -&gt; error $ \"Command unknown : \" ++ unpack unknownCommandName\n              Nothing -&gt; error $ \"Command name not provided\"\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1536580317, "post_id": 52257090, "comment_id": 91461449, "body": "The <code>\u2200 a .</code> is optional above -- <code>a</code> is in scope anyway according to GHC. Perhaps it&#39;s a good style to include it anyway, as we have to do elsewhere to bring <code>a</code> in scope. (To be honest, I never used that, and did not know that one can use <code>forall</code> in instances)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1536579939, "creation_date": 1536579939, "answer_id": 52257090, "question_id": 52257056, "link": "https://stackoverflow.com/questions/52257056/why-can-i-not-use-type-variables-in-this-instance-declaration/52257090#52257090", "title": "Why can I not use type variables in this instance declaration?", "body": "<p>A type variable can be used in an instance declaration, but only if it's <em>scoped</em>:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, UndecidableInstances #-}\n{-# LANGUAGE TypeApplications, AllowAmbiguousTypes   #-}\n{-# LANGUAGE ScopedTypeVariables, UnicodeSyntax      #-}\n\nclass Foo a where foo :: String\n\nclass Bar b where bar :: String\n\ninstance \u2200 a . Foo a =&gt; Bar a where\n  bar = foo @a\n</code></pre>\n\n<p>As always, <code>\u2200</code> can also be written <code>forall</code> if you prefer ASCII.</p>\n"}], "owner": {"reputation": 86, "user_id": 10341830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2414cc3f9f4068e46d7a1c5ff50bea7?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Kerber", "link": "https://stackoverflow.com/users/10341830/thomas-kerber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 52257090, "answer_count": 1, "score": 3, "last_activity_date": 1536579939, "creation_date": 1536579813, "question_id": 52257056, "link": "https://stackoverflow.com/questions/52257056/why-can-i-not-use-type-variables-in-this-instance-declaration", "title": "Why can I not use type variables in this instance declaration?", "body": "<p>I'm trying to use <code>TypeApplications</code> to disambiguate between which instance of a type class I am calling. Unfortunately, it seems that an instance declaration's type parameters cannot be used in the instance body. Specifically, in this toy example:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances    #-}\n{-# LANGUAGE TypeApplications     #-}\n{-# LANGUAGE UndecidableInstances #-}\n\nclass Foo a where\n    foo :: String\n\ninstance Foo () where\n    foo = \"()\"\n\ninstance Foo Int where\n    foo = \"Int\"\n\nclass Bar b where\n    bar :: String\n\ninstance Foo a =&gt; Bar a where\n    bar = foo @a\n</code></pre>\n\n<p>will error with <code>Not in scope: type variable 'a'</code> at the last line. If I remove the type application, instead the error <code>Could not deduce (Foo a0) from the context Foo a</code> is given, which is reasonable, ass <code>foo</code> by itself  is ambiguous.</p>\n\n<p>Is there some way for me to access the type parameter, or otherwise coerce the compiler into recognising this?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1536568688, "post_id": 52253857, "comment_id": 91455386, "body": "it works only for a specific instance in this case (for the logger instance &quot;MyApp.BuggyComponent&quot;), but  I wanted to have it for all the instances you could create along the process flow..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1536568865, "post_id": 52253857, "comment_id": 91455478, "body": "@NicolasHenin What about using <code>getRootLogger</code>, then <code>setLevel</code>, then <code>saveGlobalLogger</code> ? Just guessing here... Or even <code>updateGlobalLogger rootLoggerName (setLevel INFO)</code>?"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1536568333, "creation_date": 1536568333, "answer_id": 52253857, "question_id": 52253759, "link": "https://stackoverflow.com/questions/52253759/hs-logger-set-default-log-level-for-new-logger-instances-to-info-instead-if-warn/52253857#52253857", "title": "hs.logger set Default log level for new logger instances to INFO instead if Warning", "body": "<p>I have no experience with hslogger, but this part from the <a href=\"https://hackage.haskell.org/package/hslogger-1.2.10/docs/System-Log-Logger.html\" rel=\"nofollow noreferrer\">docs</a> seems relevant:</p>\n\n<pre><code>   -- Now we'd like to see everything from BuggyComponent\n   -- at DEBUG or higher go to syslog and stderr.\n   -- Also, we'd like to still ignore things less than\n   -- WARNING in other areas.\n   -- \n   -- So, we adjust the Logger for MyApp.BuggyComponent.\n\n   updateGlobalLogger \"MyApp.BuggyComponent\"\n                      (setLevel DEBUG)\n\n   -- This message will go to syslog and stderr\n   debugM \"MyApp.BuggyComponent\" \"This buggy component is buggy\"\n</code></pre>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536568333, "creation_date": 1536567835, "question_id": 52253759, "link": "https://stackoverflow.com/questions/52253759/hs-logger-set-default-log-level-for-new-logger-instances-to-info-instead-if-warn", "title": "hs.logger set Default log level for new logger instances to INFO instead if Warning", "body": "<p>I'm using hs.logger and the default behaviour is to display only the WARNING Level by default.I would like to set it to DEBUG or INFO when I'm developping locally... I found this function <code>hs.logger.defaultLogLevel</code> on the documentation (<a href=\"http://www.hammerspoon.org/docs/hs.logger.html#defaultLogLevel\" rel=\"nofollow noreferrer\">http://www.hammerspoon.org/docs/hs.logger.html#defaultLogLevel</a>) but I'm not able to find this function in the Library ! If you think there is a better Library to use in haskell, please say it to me as well :-)  </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 2, "creation_date": 1536560053, "post_id": 52250082, "comment_id": 91451399, "body": "If <code>evaluate</code> has type <code>Expr -&gt; Int</code>, then I think <code>apply</code> should be <code>\\x y -&gt; evaluate (Plus x y)</code> rather than just <code>evaluate</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1536568716, "post_id": 52250082, "comment_id": 91455402, "body": "I&#39;d argue that using a typeclass is a bad idea here. A typeclass may be useful when there are many types involved -- here there&#39;s only one."}, {"owner": {"reputation": 173, "user_id": 9844521, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OFDNaLPpqbQ/AAAAAAAAAAI/AAAAAAAACDk/Lj6H26rxf7k/photo.jpg?sz=128", "display_name": "Jolanda", "link": "https://stackoverflow.com/users/9844521/jolanda"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1536570009, "post_id": 52250082, "comment_id": 91456031, "body": "@AlexisKing Yes you&#39;re absolutely right thanks for catching that!"}], "tags": [], "owner": {"reputation": 173, "user_id": 9844521, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OFDNaLPpqbQ/AAAAAAAAAAI/AAAAAAAACDk/Lj6H26rxf7k/photo.jpg?sz=128", "display_name": "Jolanda", "link": "https://stackoverflow.com/users/9844521/jolanda"}, "is_accepted": false, "score": 4, "last_activity_date": 1536569976, "last_edit_date": 1536569976, "creation_date": 1536544225, "answer_id": 52250082, "question_id": 52249997, "link": "https://stackoverflow.com/questions/52249997/how-to-define-a-typeclass-for-a-binary-operator/52250082#52250082", "title": "How to define a typeclass for a binary operator?", "body": "<p>Your <code>evaluate</code> function can be just </p>\n\n<pre><code>evaluate :: Expr -&gt; Int\nevaluate (Value x) = x\nevaluate (Plus x y) = evaluate x + evaluate y\n</code></pre>\n\n<p>as all cases are accounted for. </p>\n\n<p>For per the typeclass, you cannot create an instance for <code>Plus</code> since that's a constructor and you need to specify instances for types (in this case <code>Expr</code> is the type, while <code>Plus</code> and <code>Value</code> are the constructors). If you wanted a typeclass that takes two elements of a certain type and produces an <code>Int</code>, you could write something like this:</p>\n\n<pre><code>data Expr = Plus Expr Expr | Value Int\n\nclass BinaryOp a where\n    apply :: a -&gt; a -&gt; Int\n\ninstance BinaryOp Expr where\n    apply x y = evaluate $ Plus x y\n</code></pre>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1536569976, "creation_date": 1536543236, "question_id": 52249997, "link": "https://stackoverflow.com/questions/52249997/how-to-define-a-typeclass-for-a-binary-operator", "title": "How to define a typeclass for a binary operator?", "body": "<p>This is a calculator that only sums numbers:</p>\n\n<pre><code>module Data.Calculator where\n\ndata Expr = Plus Expr Expr | Value Int\n\nevaluate :: Expr -&gt; Int\nevaluate (Value a) = a\nevaluate (Plus (Value a) (Value b)) = a + b\nevaluate (Plus (Plus left right) (Value b)) = (evaluate left) + (evaluate right) + b\nevaluate (Plus (Value a) (Plus left right)) = a + (evaluate left) + (evaluate right)\nevaluate (Plus a@(Plus left right) b@(Plus left' right')) = (evaluate a) + (evaluate b)\n</code></pre>\n\n<p>The <code>evaluate</code> function seems way to verbose. Ideally I'd like to define a typeclass both operators and then define <code>Plus</code> as an instance of an operator, something like this:</p>\n\n<pre><code>class BinaryOp a where\n    apply :: a -&gt; a -&gt; Expr\n\ninstance BinaryOp Plus where\n    apply x y = x + y\n</code></pre>\n\n<p>But this obviously does not work because the type <code>a</code> that <code>BinaryOp</code> is defined with is an operator and not an operand.</p>\n\n<p>How do I do this?</p>\n"}, {"tags": ["haskell", "cabal", "cabal-install", "nix"], "answers": [{"tags": [], "owner": {"reputation": 4232, "user_id": 428586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHNYS.jpg?s=128&g=1", "display_name": "Robert Hensing", "link": "https://stackoverflow.com/users/428586/robert-hensing"}, "is_accepted": true, "score": 5, "last_activity_date": 1536567366, "creation_date": 1536567366, "answer_id": 52253653, "question_id": 52249028, "link": "https://stackoverflow.com/questions/52249028/can-i-replicate-what-nix-build-does-with-nix-shell-and-cabal-build/52253653#52253653", "title": "Can I replicate what nix-build does with nix-shell and cabal build?", "body": "<p>In general, you are not guaranteed that the output of <code>nix-build</code> and the same steps in a <code>nix-shell</code> will equivalent. Some causes of differences:</p>\n\n<ul>\n<li><code>nix-build</code> can run the build in a sandbox, whereas <code>nix-shell</code> will not.</li>\n<li><code>nix-shell</code> can be invoked without the <code>--pure</code> flag, so that many more environment variables will be set (this lets you use GUI applications for example)</li>\n<li>Although <code>nix-shell</code> sets the <code>$out</code> environment variable, it is not writable</li>\n<li>A process in <code>nix-shell</code> runs as your user, whereas <code>nix-build</code> with the daemon enabled will typically run it as <code>nixbld&lt;n&gt;</code>, even with sandboxing disabled</li>\n</ul>\n\n<p>And there's probably more I didn't think of right now.</p>\n\n<p>For cabal-install and plain <code>ghc</code> in particular, a consequence of running without the sandbox is that it can access your user package db. This requires some care when using these tools in a <code>nix-shell</code>; <a href=\"https://stackoverflow.com/questions/52108291/acid-state-example-compiled-error-no-no-instance-for-control-monad-reader-clas/52111765#52111765\">see this answer.</a></p>\n"}], "owner": {"reputation": 115, "user_id": 8925788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c32a104e80abe1c8aeceb1a7f5553fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Jamie Ballingall", "link": "https://stackoverflow.com/users/8925788/jamie-ballingall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 52253653, "answer_count": 1, "score": 2, "last_activity_date": 1536567366, "creation_date": 1536531228, "last_edit_date": 1536547519, "question_id": 52249028, "link": "https://stackoverflow.com/questions/52249028/can-i-replicate-what-nix-build-does-with-nix-shell-and-cabal-build", "title": "Can I replicate what nix-build does with nix-shell and cabal build?", "body": "<p>I'm using the splendid Haskell library <a href=\"https://github.com/dmjio/miso\" rel=\"nofollow noreferrer\">Miso</a>, which recommends using Nix. The README walks us through a simple project which can be built with <code>nix-build</code>. The documentation for Miso hints that I can do:</p>\n\n<pre><code>nix-shell -A env\ncabal configure --ghcjs\ncabal build\n</code></pre>\n\n<p>which also builds the project, although it places the result in a different place.</p>\n\n<p>Are <code>nix-build</code> and <code>cabal build</code> within nix-shell guaranteed to produce the same output? More generally, given a <code>.nix</code> expression how would I workout what steps (such as cabal configure) are required to replicate it's behavior? </p>\n"}, {"tags": ["haskell", "ghc", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 632, "user_id": 2204326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TyLFa.jpg?s=128&g=1", "display_name": "ratijas", "link": "https://stackoverflow.com/users/2204326/ratijas"}, "edited": false, "score": 1, "creation_date": 1536529836, "post_id": 52248860, "comment_id": 91445879, "body": "It most likely has something to do with <code>ncurses</code> and <code>libtinfo.so.6</code>, but why in place of OS in triple for Haskell build?"}, {"owner": {"reputation": 632, "user_id": 2204326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TyLFa.jpg?s=128&g=1", "display_name": "ratijas", "link": "https://stackoverflow.com/users/2204326/ratijas"}, "edited": false, "score": 0, "creation_date": 1536531358, "post_id": 52248860, "comment_id": 91446198, "body": "<a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#ghc-build\" rel=\"nofollow noreferrer\">Here</a> are some clues:  &gt; <b>ghc-build</b> Specify a specialized architecture bindist to use. Normally this is determined automatically, but you can override the autodetected value here. Possible arguments include <code>standard</code>, <code>gmp4</code>, <code>tinfo6</code>, and <code>nopie</code>."}], "answers": [{"comments": [{"owner": {"reputation": 632, "user_id": 2204326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TyLFa.jpg?s=128&g=1", "display_name": "ratijas", "link": "https://stackoverflow.com/users/2204326/ratijas"}, "edited": false, "score": 0, "creation_date": 1536532138, "post_id": 52249044, "comment_id": 91446349, "body": "Cool fact, I appreciate that. You are correct: it&#39;s an ABI, not as OS (shame on me for confusing them)."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "reply_to_user": {"reputation": 632, "user_id": 2204326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TyLFa.jpg?s=128&g=1", "display_name": "ratijas", "link": "https://stackoverflow.com/users/2204326/ratijas"}, "edited": false, "score": 0, "creation_date": 1536532230, "post_id": 52249044, "comment_id": 91446369, "body": "Well, in GNU Autoconf triplets, the third element is OS (arch-vendor-os(-kernel)), so it&#39;s easy to confuse."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 5, "last_activity_date": 1536531395, "creation_date": 1536531395, "answer_id": 52249044, "question_id": 52248860, "link": "https://stackoverflow.com/questions/52248860/what-does-tinfo6-stands-for/52249044#52249044", "title": "What does tinfo6 stands for?", "body": "<blockquote>\n  <p>it appears in arch-vendor-os triple <code>x86_64-linux-tinfo6</code></p>\n</blockquote>\n\n<p>I think you are confusing GNU target triplets with GHC target triplets. A GHC target triplet is <code>&lt;architecture&gt;-&lt;operating system&gt;-&lt;ABI&gt;</code>.</p>\n\n<p>So, <code>tinfo6</code> is the ABI. I don't know much about GHC, but I <em>do</em> remember that it has a calling convention that is not the C calling convention.</p>\n\n<p>Fun fact: this calling convention can actually not be expressed in C, therefore the C backend of GHC actually calls GCC to generate assembly, then a <em>Perl</em>(!!!) script that is part of the GHC compiler searches for calls in the assembly code and re-writes them to the GHC calling convention; after that, the compiler will call GCC (or rather GAS) again, to assemble the object file. (This rather clever but somewhat crazy hack is one of the reasons for the push to native and LLVM backends.)</p>\n\n<p>So, unfortunately, I don't know what <code>tinfo6</code> means but I am pretty sure it is the name of the GHC calling convention or ABI.</p>\n"}], "owner": {"reputation": 632, "user_id": 2204326, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TyLFa.jpg?s=128&g=1", "display_name": "ratijas", "link": "https://stackoverflow.com/users/2204326/ratijas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1536531395, "creation_date": 1536529119, "question_id": 52248860, "link": "https://stackoverflow.com/questions/52248860/what-does-tinfo6-stands-for", "title": "What does tinfo6 stands for?", "body": "<p>Working with Haskell and particularly GHC I can see <strong>tinfo6</strong> word quite often. Mostly it appears in arch-vendor-os triple <code>x86_64-linux-tinfo6</code> like if it was some sort of OS. But what really does <strong>tinfo6</strong> mean?</p>\n"}, {"tags": ["haskell", "fold", "accumulator"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1536521285, "post_id": 52247933, "comment_id": 91443701, "body": "Since you use <code>(head y)</code>, that means that <code>y</code> should be a list, but in other parts of the function body, you use <code>y</code> as a number (to perform calculations on). The result is that Haskell thinks that the list should be a number, hende the error."}, {"owner": {"reputation": 1466, "user_id": 5320300, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ktwDF.jpg?s=128&g=1", "display_name": "Simon Baars", "link": "https://stackoverflow.com/users/5320300/simon-baars"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536521567, "post_id": 52247933, "comment_id": 91443777, "body": "@WillemVanOnsem Thanks for the response. I tried that, but that results in another error I do not understand and I cannot find information on Google about (I appended it to my question)."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1536521829, "post_id": 52247933, "comment_id": 91443859, "body": "Well I think you should add a <code>head</code> in the first clause instead, as well a a <code>read</code>. But that being said. This looks very &quot;chaotic&quot;. Even if it later &quot;produces an answer&quot;, it is hard to &quot;convince&quot; a peer that the algorithm works correctly. So I think it might be be better to implement a <i>cleaner</i> solution."}, {"owner": {"reputation": 1466, "user_id": 5320300, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ktwDF.jpg?s=128&g=1", "display_name": "Simon Baars", "link": "https://stackoverflow.com/users/5320300/simon-baars"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536522384, "post_id": 52247933, "comment_id": 91444016, "body": "@WillemVanOnsem This actuallly helped me solve it. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 1466, "user_id": 5320300, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ktwDF.jpg?s=128&g=1", "display_name": "Simon Baars", "link": "https://stackoverflow.com/users/5320300/simon-baars"}, "is_accepted": true, "score": 3, "last_activity_date": 1536522365, "creation_date": 1536522365, "answer_id": 52248121, "question_id": 52247933, "link": "https://stackoverflow.com/questions/52247933/getting-the-error-non-type-variable-argument-in-the-constraint-integral-a2/52248121#52248121", "title": "Getting the error &quot;Non type-variable argument in the constraint: Integral [a2]&quot;", "body": "<p>There where multiple things wrong with my solution, but finally the following code works!</p>\n\n<pre><code>luhn :: Int -&gt; Bool\nluhn x = (tail $ show (foldl (\\acc x -&gt; acc + (digitToInt x)) 0 (foldr doEncrypt [] $ zip [0..] (show x)))) == \"0\"\n    where\n        doEncrypt (i,y) acc = if not(even i)\n            then (head $ show(((uncurry (+) . (`divMod` 10) . (*2)) (digitToInt y)))) : acc\n            else y : acc\n</code></pre>\n\n<p>Thanks a lot to @WillemVanOnsem for your pointers, without I probably wouldn't have solved this!</p>\n"}], "owner": {"reputation": 1466, "user_id": 5320300, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/ktwDF.jpg?s=128&g=1", "display_name": "Simon Baars", "link": "https://stackoverflow.com/users/5320300/simon-baars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 52248121, "answer_count": 1, "score": 0, "last_activity_date": 1536522365, "creation_date": 1536521120, "last_edit_date": 1536521519, "question_id": 52247933, "link": "https://stackoverflow.com/questions/52247933/getting-the-error-non-type-variable-argument-in-the-constraint-integral-a2", "title": "Getting the error &quot;Non type-variable argument in the constraint: Integral [a2]&quot;", "body": "<p>I'm trying to implement the luhn algorithm using the following code:</p>\n\n<pre><code>luhn :: Int -&gt; Bool\nluhn x = (tail $ show (foldl (\\acc x -&gt; acc + (read x :: Int)) 0 (foldr doEncrypt [] $ zip [0..] (show x)))) == \"0\"\n    where\n        doEncrypt (i,y) acc = if not(even i)\n            then head(((uncurry (+) . (`divMod` 10) . (*2)) y)) : acc\n            else (head y) : acc\n</code></pre>\n\n<p>I now got stuck with the following error:</p>\n\n<pre><code>\u2022 Non type-variable argument in the constraint: Integral [a2]\n  (Use FlexibleContexts to permit this)\n\u2022 When checking the inferred type\n    doEncrypt :: forall a1 a2.\n                 (Integral a1, Integral [a2]) =&gt;\n                 (a1, [a2]) -&gt; [a2] -&gt; [a2]\n  In an equation for \u2018luhn\u2019:\n      luhn x\n        = (tail\n             $ show\n                 (foldl\n                    (\\ acc x -&gt; acc + (read x :: Int))\n                    0\n                    (foldr doEncrypt [] $ zip [0 .. ] (show x))))\n            == \"0\"\n        where\n            doEncrypt (i, y) acc\n              = if not (even i) then\n                    head (((uncurry (+) . (`divMod` 10) . (* 2)) y)) : acc\n                else\n                    (head y) : acc\n</code></pre>\n\n<p>I see that the error suggests that the second part of the tuple (<code>a2</code>) is a \"Non type-variable argument\". However, Haskell seems to identify this <code>a2</code> argument as an <code>Integral</code> while in fact it is a <code>Char</code>. How can I tell Haskell that this is a <code>Char</code> and that Haskell shouldn't worry any further about this variable's type? Or is there something else I'm not understanding which causes this error?</p>\n\n<p>Edit:\nWhen I remove the <code>(head y)</code> and replace it by <code>y</code> I get instead the following error:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018Char\u2019 with \u2018[Char]\u2019\n  Expected type: [String]\n    Actual type: [Char]\n\u2022 In the third argument of \u2018foldl\u2019, namely\n    \u2018(foldr doEncrypt [] $ zip [0 .. ] (show x))\u2019\n  In the first argument of \u2018show\u2019, namely\n    \u2018(foldl\n        (\\ acc x -&gt; acc + (read x :: Int))\n        0\n        (foldr doEncrypt [] $ zip [0 .. ] (show x)))\u2019\n  In the second argument of \u2018($)\u2019, namely\n    \u2018show\n       (foldl\n          (\\ acc x -&gt; acc + (read x :: Int))\n          0\n          (foldr doEncrypt [] $ zip [0 .. ] (show x)))\u2019\n</code></pre>\n"}, {"tags": ["database", "haskell", "model", "haskell-persistent"], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 774228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d85066d4024c48c64b05f6d149833f?s=128&d=identicon&r=PG", "display_name": "unclechu", "link": "https://stackoverflow.com/users/774228/unclechu"}, "edited": false, "score": 0, "creation_date": 1536518633, "post_id": 52247405, "comment_id": 91443027, "body": "I&#39;m actually faced this issue using <b>Vector</b>, for some reason I have thought this syntax is only for <b>Maybe</b>, like just for nullable fields. But I realized now that this is general syntax for any wrapper in reverse order. So it could be even <code>barModel BarId Vector Maybe</code> for <code>barModel :: Maybe (Vector (BarId))</code>. Thanks!"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 711, "user_id": 774228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d85066d4024c48c64b05f6d149833f?s=128&d=identicon&r=PG", "display_name": "unclechu", "link": "https://stackoverflow.com/users/774228/unclechu"}, "edited": false, "score": 0, "creation_date": 1536518717, "post_id": 52247405, "comment_id": 91443045, "body": "@unclechu I&#39;m not sure something like that will work out. Test that out and let us know."}, {"owner": {"reputation": 711, "user_id": 774228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d85066d4024c48c64b05f6d149833f?s=128&d=identicon&r=PG", "display_name": "unclechu", "link": "https://stackoverflow.com/users/774228/unclechu"}, "edited": false, "score": 0, "creation_date": 1543535300, "post_id": 52247405, "comment_id": 93965082, "body": "I was wrong, this doesn&#39;t work like that, <code>Maybe</code> is just a special case."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 2, "last_activity_date": 1536517418, "creation_date": 1536517418, "answer_id": 52247405, "question_id": 52247307, "link": "https://stackoverflow.com/questions/52247307/haskell-persistent-model-how-to-correctly-define-cross-reference/52247405#52247405", "title": "Haskell &quot;persistent&quot; model: How to correctly define cross-reference?", "body": "<p>The syntax you are using for the <code>Bar</code> model isn't right. Something like this should work:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack script --resolver lts-12.7\n\n{-# LANGUAGE GADTs, GeneralizedNewtypeDeriving, QuasiQuotes, TemplateHaskell #-}\n{-# LANGUAGE TypeFamilies, MultiParamTypeClasses #-}\n\nimport Database.Persist.TH\n\nmkPersist sqlSettings [persistLowerCase|\nFoo\n  barModel BarId Maybe\n  fooField Int\n\nBar\n  fooModel FooId\n  barField Int\n|]\n\nmain = pure ()\n</code></pre>\n\n<p>See the <a href=\"https://github.com/yesodweb/persistent/blob/master/docs/Persistent-entity-syntax.md\" rel=\"nofollow noreferrer\">official docs</a> for reference.</p>\n"}], "owner": {"reputation": 711, "user_id": 774228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60d85066d4024c48c64b05f6d149833f?s=128&d=identicon&r=PG", "display_name": "unclechu", "link": "https://stackoverflow.com/users/774228/unclechu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 52247405, "answer_count": 1, "score": 2, "last_activity_date": 1547039388, "creation_date": 1536516570, "last_edit_date": 1547039388, "question_id": 52247307, "link": "https://stackoverflow.com/questions/52247307/haskell-persistent-model-how-to-correctly-define-cross-reference", "title": "Haskell &quot;persistent&quot; model: How to correctly define cross-reference?", "body": "<p>Imagine you have two models (<strong>Foo</strong> and <strong>Bar</strong>) and they are both have references to each other (<strong>Foo</strong> have <strong>barRef</strong> with type <strong>BarId</strong> and <strong>Bar</strong> have <strong>fooRef</strong> with type <strong>FooId</strong>). Everything goes okay:</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack script --resolver=lts-9.21 --package=persistent-template -}\n{-# LANGUAGE GADTs, GeneralizedNewtypeDeriving, QuasiQuotes, TemplateHaskell #-}\n{-# LANGUAGE TypeFamilies, MultiParamTypeClasses #-}\n\nimport Database.Persist.TH\n\nmkPersist sqlSettings [persistLowerCase|\nFoo\n  barModel BarId\n  fooField Int\n\nBar\n  fooModel FooId\n  barField Int\n|]\n\nmain = pure ()\n</code></pre>\n\n<p>But if I wrap reference type to <strong>Maybe</strong> (just an example, it could <strong>Vector</strong> or anything else):</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack script --resolver=lts-9.21 --package=persistent-template -}\n{-# LANGUAGE GADTs, GeneralizedNewtypeDeriving, QuasiQuotes, TemplateHaskell #-}\n{-# LANGUAGE TypeFamilies, MultiParamTypeClasses #-}\n\nimport Database.Persist.TH\n\nmkPersist sqlSettings [persistLowerCase|\nFoo\n  barModel (Maybe BarId)\n  fooField Int\n\nBar\n  fooModel FooId\n  barField Int\n|]\n\nmain = pure ()\n</code></pre>\n\n<p>It fails with this error:</p>\n\n<pre><code>Not in scope: type constructor or class \u2018BarId\u2019\n</code></pre>\n\n<p>How I am supposed to solve this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1536515268, "post_id": 52247124, "comment_id": 91442217, "body": "You copied that code from somewhere? Type quotes by hand."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1536515286, "post_id": 52247124, "comment_id": 91442220, "body": "You need to use the regular quotes &quot;, not any fancy version of them."}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 2, "creation_date": 1536516806, "post_id": 52247124, "comment_id": 91442590, "body": "What are you writing your programs with? You should use a programmer&#39;s editor or IDE, not something that replaces \u201dstraight quotes\u201d (inches) with \u201dcurly quotes\u201d in order to \u201dfix\u201d them for you."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1536558217, "post_id": 52248718, "comment_id": 91450847, "body": "From the look of it, it\u2019s supposed to be part of a list comprehension like <code>[if x &lt; 10 then &quot;BOOM!&quot; else &quot;BANG!&quot; | x &lt;- xs]</code>"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 3, "last_activity_date": 1536569645, "last_edit_date": 1536569645, "creation_date": 1536527798, "answer_id": 52248718, "question_id": 52247124, "link": "https://stackoverflow.com/questions/52247124/lexical-fault-when-using-boom/52248718#52248718", "title": "Lexical fault when using &#39;&#39;BOOM!&#39;&#39;", "body": "<p>There are two problems here.</p>\n\n<p>The first is, you're not using plain ASCII quotation marks (U+0022) <code>\"</code>. You're using right quotation marks (U+201D) <code>\u201d</code>. There's probably a keyboard setting you're using that's causing this, and using certain text editing programs can also prevent this.</p>\n\n<p>Secondly, you seem to be either missing a right bracket. As pointed out, this is probably meant to be part of a list comprehension. You need to write <em>all</em> of the list comprehension for it to work.</p>\n\n<p>The corrected code is:</p>\n\n<pre><code>boombang xs = [if x &lt; 10 then \"BOOM!\" else \"BANG!\" | x &lt;- xs]\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "closed_date": 1536530104, "answer_count": 1, "score": -1, "last_activity_date": 1536569645, "creation_date": 1536515182, "question_id": 52247124, "link": "https://stackoverflow.com/questions/52247124/lexical-fault-when-using-boom", "closed_reason": "Not suitable for this site", "title": "Lexical fault when using &#39;&#39;BOOM!&#39;&#39;", "body": "<p>I type this into my texteditor:</p>\n\n<pre><code>boombang xs = [ if x &lt; 10 then \u201dBOOM!\u201d else \u201dBANG!\u201d\n</code></pre>\n\n<p>But when trying to load it, my terminal denies it and and says: </p>\n\n<p><a href=\"https://i.stack.imgur.com/2CieI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2CieI.png\" alt=\"Says there&#39;s something wrong with my quotation marks\"></a></p>\n\n<p>Probably some dumb rookie mistake, but I can't seem to find the solution...:/</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1536511872, "post_id": 52246426, "comment_id": 91441405, "body": "It looks like Haddock always typesets abstract datatypes (that is, datatypes exported without their constructors) using <code>data</code>. Whether this is a bug or a feature I cannot say."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1536512954, "creation_date": 1536512954, "answer_id": 52246831, "question_id": 52246426, "link": "https://stackoverflow.com/questions/52246426/why-is-th-newtype-q-documented-as-data-q-on-hackage/52246831#52246831", "title": "Why is TH `newtype Q` documented as `data Q` on Hackage?", "body": "<p>It is not a bug. Haddock prints all abstract types as <code>data</code>. The thought is this: the type is being held abstract so that the library author can change the internal representation without the users knowing (or needing to). Since the library author might change between <code>newtype</code> and <code>data</code>, and the users are not supposed to know about this, both ways of creating a new type must be presented the same way in the haddocks.</p>\n\n<p>Given that, the choice between using <code>newtype</code> for both or <code>data</code> for both seems clear to me: <code>data</code> is much more frequently used and more easily understood for beginners.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 52246831, "answer_count": 1, "score": 4, "last_activity_date": 1536512954, "creation_date": 1536510107, "question_id": 52246426, "link": "https://stackoverflow.com/questions/52246426/why-is-th-newtype-q-documented-as-data-q-on-hackage", "title": "Why is TH `newtype Q` documented as `data Q` on Hackage?", "body": "<p>Is <a href=\"https://hackage.haskell.org/package/template-haskell-2.13.0.0/docs/src/Language.Haskell.TH.Syntax.html#Q\" rel=\"nofollow noreferrer\">this</a> a documentation bug or something else?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1536507436, "post_id": 52246049, "comment_id": 91440185, "body": "Please inline the code fragment (as text, <i>not</i> as image), etc. If later the link dies, the content is still available."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536507624, "post_id": 52246049, "comment_id": 91440241, "body": "Furthermore the two screenshots seem not related at all."}, {"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 2, "creation_date": 1536508022, "post_id": 52246049, "comment_id": 91440341, "body": "The title <i>Haskell; extreme beginner questions</i> is unfortunately not very informative. Please change it to reflect what you actually ask."}, {"owner": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "edited": false, "score": 0, "creation_date": 1536509428, "post_id": 52246049, "comment_id": 91440738, "body": "Thanks for your input. I&#39;ll follow your advices the next time I ask a question!"}, {"owner": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "edited": false, "score": 0, "creation_date": 1536509481, "post_id": 52246049, "comment_id": 91440753, "body": "In my defense; I barely understand the connection between the editor and the terminal. That&#39;s why I also showed the texteditor (in case I had to add something there)"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1536525165, "post_id": 52246049, "comment_id": 91444793, "body": "@TobiasBernhardt Please make sure to check out the <a href=\"https://stackoverflow.com/tour\">stackoverflow tour</a> and <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>. Stackoverflow works on principles that are quite different from other types of websites you might be familiar with."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "edited": false, "score": 0, "creation_date": 1536507693, "post_id": 52246074, "comment_id": 91440260, "body": "God damn I&#39;m an idiot. Apparently my mac doesn&#39;t even have these quotes... So I guess I must copy paste them in the future. Thanks a lot for the help! :)"}, {"owner": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "edited": false, "score": 0, "creation_date": 1536507786, "post_id": 52246074, "comment_id": 91440279, "body": "Is it okey to use this thread in the upcoming days to ask even more basic questions, or should I create a new thread every time I ask a bunch of questions? I couldn&#39;t find a existing thread for &#39;Haskell beginning questions&#39;"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "edited": false, "score": 0, "creation_date": 1536507818, "post_id": 52246074, "comment_id": 91440286, "body": "@TobiasBernhardt: isn&#39;t this Shift+single quote key?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "edited": false, "score": 0, "creation_date": 1536507897, "post_id": 52246074, "comment_id": 91440310, "body": "@TobiasBernhardt: I think the policy is to ask one question per, well, question. Since otherwise the question becomes a &quot;package&quot; of questions, and a user that later searches, will get all kinds of &quot;<i>noise</i>&quot; that is not relevant."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "reply_to_user": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "edited": false, "score": 6, "creation_date": 1536507918, "post_id": 52246074, "comment_id": 91440316, "body": "@TobiasBernhardt Stack Overflow is not a forum\u2014it has no \u201cthreads\u201d, and <a href=\"https://meta.stackexchange.com/questions/222735/can-i-ask-only-one-question-per-post\">each question should be its own question</a>. In fact, this question should actually have been two questions."}, {"owner": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "edited": false, "score": 0, "creation_date": 1536507974, "post_id": 52246074, "comment_id": 91440331, "body": "Ok, just wanted to be sure, so I don&#39;t accidentally spam the forum"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "edited": false, "score": 5, "creation_date": 1536509810, "post_id": 52246074, "comment_id": 91440831, "body": "@TobiasBernhardt pretty hard to imagine that you can&#39;t type double quotes on your keyboard.  What country are you from?  It&#39;s probably shift+single quote like William says.  (Just making sure you heard him)"}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1536512879, "post_id": 52246074, "comment_id": 91441651, "body": "If your computer is set to UK English qwerty keyboard layout, then double quotes would be <code>Shift</code>+<code>2</code>"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "edited": false, "score": 0, "creation_date": 1536513570, "post_id": 52246074, "comment_id": 91441819, "body": "@TobiasBernhardt be sure to mark the question as answered (by clicking the check mark), also check out the <a href=\"https://stackoverflow.com/tags/haskell/info\">haskell tag info page</a> for useful stuff and FAQs. Have fun learning haskell!"}, {"owner": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "edited": false, "score": 0, "creation_date": 1536515751, "post_id": 52246074, "comment_id": 91442332, "body": "Thanks for all the help once again! :) I&#39;ll mark it as answered"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 10, "last_activity_date": 1536513687, "last_edit_date": 1536513687, "creation_date": 1536507508, "answer_id": 52246074, "question_id": 52246049, "link": "https://stackoverflow.com/questions/52246049/hello-world-doesnt-work-in-haskell/52246074#52246074", "title": "&#39;&#39;hello&#39;&#39; ++ &#39;&#39;world&#39;&#39; doesn&#39;t work in Haskell", "body": "<p>Strings are surrounded by <strong>double quotes</strong> (like <code>\"..\"</code>), not <em>two</em> single quotes (as in <code>''..''</code>). You thus should use <code>\"</code> instead of <code>'</code>.</p>\n\n<p>For example:</p>\n\n<pre><code>$ ghci\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; \"hello\" ++ \"world\"\n\"helloworld\"\nPrelude&gt; \"hello\" ++ \" \" ++ \"world\"\n\"hello world\"\n</code></pre>\n\n<p>This is specified in the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-200002.6\" rel=\"noreferrer\"><em>Haskell report 2010 section on 'Character and String Literals'</em></a>:</p>\n\n<blockquote>\n  <p>Character literals are written between single quotes, as in <code>'a'</code>, and <strong>strings between double quotes, as in <code>\"Hello\"</code></strong>.</p>\n</blockquote>\n\n<p>Based on <a href=\"https://chrisbracco.com/curly-quotes/\" rel=\"noreferrer\">this article</a>, one can write <em>straight double quotes</em> on a Mac keyboard with <kbd>Shift</kbd> + <kbd>'</kbd>, which is the way it is organized on a \"standard\" querty keyboard:</p>\n\n<blockquote>\n  <p>On any typical keyboard, simply press <kbd>'</kbd> for a straight single mark (<code>'</code>) and <kbd>Shift</kbd> + <kbd>'</kbd> for a straight double mark (<code>\"</code>).</p>\n</blockquote>\n\n<p>Based on <a href=\"https://stackoverflow.com/questions/52246049/hello-world-doesnt-work-in-haskell/52246074?noredirect=1#comment91441651_52246074\">@M.Aroosi's comment</a>, for a UK querty keyboard, the <code>\"</code> is <kbd>Shift</kbd>+<kbd>2</kbd></p>\n"}], "owner": {"reputation": 101, "user_id": 10338282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8045145181da08fe82ae57c4dade02a?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Bernhardt", "link": "https://stackoverflow.com/users/10338282/tobias-bernhardt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 52246074, "answer_count": 1, "score": 1, "last_activity_date": 1536513687, "creation_date": 1536507402, "last_edit_date": 1536510062, "question_id": 52246049, "link": "https://stackoverflow.com/questions/52246049/hello-world-doesnt-work-in-haskell", "title": "&#39;&#39;hello&#39;&#39; ++ &#39;&#39;world&#39;&#39; doesn&#39;t work in Haskell", "body": "<p>Just want to clarify that it's my first day programming, and I realise how dumb this question is :D</p>\n\n<p>1) Why doesn't it work?</p>\n\n<pre><code>ghci&gt;''hello'' ++ ''world''\n\n&lt;interactive&gt;:40:1: error\n    * Syntax error on ''hello''\n      Perhaps you intended to use TemplateHaskell or TemplateHaskellQuotes\n    * In the Template Haskell quotation ''hello''\n\nghci&gt;''hello'' ++ '' '' ++ ''world''\n\n&lt;interactive&gt;:41:17: error: parse error on input '''\n</code></pre>\n\n<p>Should I add something in the texteditor to make it work? Or did I just do some rookie mistake? </p>\n\n<p>2) </p>\n\n<pre><code>ghci&gt; ''Steve'' !! 2\n\n&lt;interactive&gt;:42:2: error\n    * Syntax error on ''Steve''\n      Perhaps you intended to use TemplateHaskell or TemplateHaskellQuotes\n    * In the Template Haskell quotation ''Steve''\nghci&gt;[1,2,3,5,8] !! 2\n3\n</code></pre>\n\n<p>When I do these commands with numbers it works, but not with characters. I must be doing something wrong, but I'm not sure what :/</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["haskell", "cabal"], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1536503990, "creation_date": 1536503990, "question_id": 52245576, "link": "https://stackoverflow.com/questions/52245576/conditional-cabal-build-flag-failing", "title": "Conditional Cabal Build Flag Failing", "body": "<p>I have set the following structure in my project's cabal file:</p>\n\n<pre><code>library\n  if flag(no-tracking)\n    hs-source-dirs: src, no-telemetry\n  else\n    hs-source-dirs: src, telemetry\n</code></pre>\n\n<p>But I get \"can't find source for \" errors. I have verified that both <code>hs-source-dirs: src, telemetry</code> and <code>hs-source-dirs: src, no-telemetry</code> work without the conditional structure. It case it matters I am building with stack.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 8913528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543d32ab8a13de3822308785d6803d46?s=128&d=identicon&r=PG&f=1", "display_name": "Th&#233;ophile Choutri", "link": "https://stackoverflow.com/users/8913528/th%c3%a9ophile-choutri"}, "edited": false, "score": 0, "creation_date": 1536647145, "post_id": 52246427, "comment_id": 91486945, "body": "Hi! I think that&#39;s because I use Relude, which is an alternative prelude that works over <code>NonEmpty a</code> instead of <code>[a]</code>.  Furthermore, is there any library you&#39;d have installed on your system that may help symbol resolution? After running your code, I get  <code>starting!&#39;polynot: &#47;home&#47;tchoutri&#47;.local&#47;lib&#47;polynot&#47;Polynot&#47;Plugin&#47;Twitter.o: unknown symbol &#39;ghczmprim_GHCziCString_unpackCStringzh_info&#39; polynot: user error (Unable to resolve functions!)</code>"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 116, "user_id": 8913528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543d32ab8a13de3822308785d6803d46?s=128&d=identicon&r=PG&f=1", "display_name": "Th&#233;ophile Choutri", "link": "https://stackoverflow.com/users/8913528/th%c3%a9ophile-choutri"}, "edited": false, "score": 1, "creation_date": 1536679718, "post_id": 52246427, "comment_id": 91506760, "body": "I was able to resolve a similar issue by compiling the main program (i.e., the one doing the load) with <code>-dynamic</code> as well.  More generally, you might need to do some <code>addDLL</code> calls to get symbols properly resolved."}, {"owner": {"reputation": 116, "user_id": 8913528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543d32ab8a13de3822308785d6803d46?s=128&d=identicon&r=PG&f=1", "display_name": "Th&#233;ophile Choutri", "link": "https://stackoverflow.com/users/8913528/th%c3%a9ophile-choutri"}, "edited": false, "score": 0, "creation_date": 1536684074, "post_id": 52246427, "comment_id": 91509116, "body": "Thank you so much! Are you talking about the <code>addDLL &quot;&#47;home&#47;tchoutri&#47;.stack&#47;programs&#47;x86_64-linux&#47;ghc-tinfo6-8.4.&zwnj;&#8203;3&#47;lib&#47;ghc-8.4.3&#47;base&zwnj;&#8203;-4.11.1.0&#47;libHSbase-&zwnj;&#8203;4.11.1.0-ghc8.4.3.so&zwnj;&#8203;&quot;</code> call in particular or do you have others in mind?"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 1, "last_activity_date": 1536510108, "creation_date": 1536510108, "answer_id": 52246427, "question_id": 52245535, "link": "https://stackoverflow.com/questions/52245535/error-with-function-resolution-while-dynamically-loading-a-o-object-from-haskel/52246427#52246427", "title": "Error with function resolution while dynamically loading a .o object from Haskell", "body": "<p>I wasn't able to duplicate your error.  I get a <code>Prelude.head: empty list</code> exception instead.</p>\n\n<p>However, my guess is that it has to do with the functions in <code>dynamic-loader</code> expecting to load modules from a hierarchical directory structure that matches the module hierarchy.</p>\n\n<p>In a nutshell, if I store the plugin in:</p>\n\n<pre><code>~/.local/lib/polynot/Polynot/Plugin/Twitter.o\n</code></pre>\n\n<p>and use <code>loadModule</code> like so:</p>\n\n<pre><code>loadModule \"Polynot.Plugin.Twitter\" \n           (Just \"/home/buhr/.local/lib/polynot\") (Just \"o\")\n</code></pre>\n\n<p>then it works okay for me.</p>\n\n<p>The <code>Main.hs</code> I used was the following:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport           Control.Monad                (forM_)\nimport           Data.Monoid                  ((&lt;&gt;))\nimport           Data.Text                    (pack, unpack, Text)\nimport           System.Directory             (getHomeDirectory)\nimport           System.Plugins.DynamicLoader\n\nloadPlugins :: [Text] -&gt; IO ()\nloadPlugins plugins = do\n  home &lt;- getHomeDirectory\n  let basedir = (pack home) &lt;&gt; \"/.local/lib/polynot\"\n  forM_ plugins (load basedir)\n where\n    load dir plugin = do\n      m &lt;- loadModule (unpack plugin) (Just $ unpack dir) (Just \"o\")\n      resolveFunctions\n      entry &lt;- loadFunction m \"runPlugin\"\n      entry\n\nmain = do\n  putStrLn \"starting!\"\n  loadPlugins [\"Polynot.Plugin.Twitter\"]\n  putStrLn \"done!\"\n</code></pre>\n"}], "owner": {"reputation": 116, "user_id": 8913528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543d32ab8a13de3822308785d6803d46?s=128&d=identicon&r=PG&f=1", "display_name": "Th&#233;ophile Choutri", "link": "https://stackoverflow.com/users/8913528/th%c3%a9ophile-choutri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1536510108, "creation_date": 1536503694, "question_id": 52245535, "link": "https://stackoverflow.com/questions/52245535/error-with-function-resolution-while-dynamically-loading-a-o-object-from-haskel", "title": "Error with function resolution while dynamically loading a .o object from Haskell", "body": "<p>I am writing a tool for which I want a modular architecture. By that I mean that the users would be able to write down a list of the modules they want to be loaded at start-up and my tool would be loading the corresponding <code>.o</code> for me.</p>\n\n<p>Here is the code I managed to write up until now:</p>\n\n<pre><code>module Core where\n\nimport           Data.Monoid                  ((&lt;&gt;))\nimport           Data.Text                    (pack, unpack)\nimport           System.Directory             (getHomeDirectory)\nimport           System.Plugins.DynamicLoader\n\nloadPlugins :: [Text] -&gt; IO ()\nloadPlugins plugins = do\n  home &lt;- getHomeDirectory\n  -- addDLL \"/home/tchoutri/.stack/programs/x86_64-linux/ghc-tinfo6-8.4.3/lib/ghc-8.4.3/base-4.11.1.0/libHSbase-4.11.1.0-ghc8.4.3.so\"\n  let paths = fmap (\\x -&gt; (pack home) &lt;&gt; \"/.local/lib/polynot/polynot-\" &lt;&gt; x &lt;&gt; \".o\") plugins\n  forM_ paths $ \\path -&gt; load path\n where\n    load path = do\n      m &lt;- loadModuleFromPath (unpack path) (Just $ unpack path)\n      resolveFunctions\n      loadFunction m \"runPlugin\"\n</code></pre>\n\n<p>The plugin I'm trying to load at this moment is very simple:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Polynot.Plugin.Twitter where\n\nrunPlugin :: IO ()\nrunPlugin = putStrLn \"[Twitter] 'sup\"\n</code></pre>\n\n<p>It is compiled with <code>stack ghc -- --make -dynamic -fPIC -O3 twitter.hs</code>. It is then renamed <code>polynot-twitter.o</code>, in <code>~/.local/lib/polynot/</code>.</p>\n\n<p>The compilation goes well, and when I run <code>stack exec -- polynot</code>, I get this error:</p>\n\n<p><code>polynot: user error (Unable to get qualified name from: /home/tchoutri/.local/lib/polynot/polynot-twitter.o)</code></p>\n\n<p>A quick google search showed me that the only instances of this error appear in the source code. :/</p>\n\n<p>Moreover, I use the git version of dynamic-loader.</p>\n\n<p>(I may be mistaken about my choice for a modular architecture, I totally accept that. If you have a better approach I could use, you can totally comment on it :)</p>\n"}, {"tags": ["haskell", "readfile", "io-monad"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1536493064, "post_id": 52244116, "comment_id": 91436547, "body": "Do you run it in the same directory? The location of the executable is irrelevant: it takes the <code>pwd</code> and adds the filename to it."}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1536494641, "post_id": 52244116, "comment_id": 91436960, "body": "In addition to Willem&#39;s comment- If you are on Windows: If on PowerShell <code>pwd</code> is predefined as an alias for <code>Get-Location</code> which returns the current location. On CMD <code>pwd</code> is not available, to get the current directory run <code>cd</code> (without any arguments)."}, {"owner": {"reputation": 51, "user_id": 1254680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BhrlM.jpg?s=128&g=1", "display_name": "yungtrizzle", "link": "https://stackoverflow.com/users/1254680/yungtrizzle"}, "edited": false, "score": 0, "creation_date": 1536496322, "post_id": 52244116, "comment_id": 91437468, "body": "I&#39;m on Ubuntu and I do run in the same directory. I even copied to new directory to check for permissions."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 1254680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BhrlM.jpg?s=128&g=1", "display_name": "yungtrizzle", "link": "https://stackoverflow.com/users/1254680/yungtrizzle"}, "edited": false, "score": 0, "creation_date": 1536584931, "post_id": 52245578, "comment_id": 91464323, "body": "Many thanks!! Feels like a total noob job that I missed that."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1536503998, "creation_date": 1536503998, "answer_id": 52245578, "question_id": 52244116, "link": "https://stackoverflow.com/questions/52244116/haskell-readfile-fails-for-existing-files/52245578#52245578", "title": "Haskell ReadFile fails for existing files", "body": "<p>I believe the problem is that, in processing an import command like:</p>\n\n<pre><code>import fact.fn\n</code></pre>\n\n<p>you are not stripping the space from the beginning of the filename, so your program is actually trying to import the file <code>\" fact.fn\"</code> and not <code>\"fact.fn\"</code>.  You can verify that this is the case if you study the error message carefully.  If the error is:</p>\n\n<pre><code>*** Exception:  fact.fn: openFile: does not exist (No such file or directory)\n</code></pre>\n\n<p>with two spaces instead of one between <code>Exception:</code> and <code>fact.fn</code>, then there's an extra space at the beginning of the filename.</p>\n\n<p>I have absolutely no idea how you were able to run it successfully in the interpreter.</p>\n"}], "owner": {"reputation": 51, "user_id": 1254680, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BhrlM.jpg?s=128&g=1", "display_name": "yungtrizzle", "link": "https://stackoverflow.com/users/1254680/yungtrizzle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 52245578, "answer_count": 1, "score": 0, "last_activity_date": 1536503998, "creation_date": 1536492910, "question_id": 52244116, "link": "https://stackoverflow.com/questions/52244116/haskell-readfile-fails-for-existing-files", "title": "Haskell ReadFile fails for existing files", "body": "<p>I'm writing a function in Haskell as part of a compiler to open a file, read a set of file names from it and concatenate them into a string. The code runs fine in ghci but fails when compiled with the following:</p>\n\n<blockquote>\n  <p>fact.fn: openFile: does not exist (No such file or directory)</p>\n</blockquote>\n\n<p>I am completely sure fact.fn exists and it's in the same directory as the executable. </p>\n\n<p>Relevant code:</p>\n\n<pre><code>compile [fileName] = do  \n             (ilude, contents) &lt;- imports fileName\n             let lude = \"prelude.fn\" : ilude\n             prld &lt;- fmap fullPrelude (mapM readFile lude) --seems to fail here, \n--but works fine in the interpreter\n             let newPrld = unlines [prld, \"\\nend\"]\n             runEvalWith HappyParser.parseExpr fileName contents newPrld\n\n\nimports :: String -&gt; IO ([String], String)\nimports fileName = do \n    contents &lt;- readFile fileName\n    let ls = lines contents\n    let ifile = filter (isPrefixOf \"import\") ls {-find import string here-}\n    let contentList = filter (\\w -&gt; w `notElem` ifile) ls\n    let impts = mapMaybe (stripPrefix \"import\") ifile\n    return (impts, (unlines contentList) )\n\n\nfullPrelude :: [String] -&gt; String\nfullPrelude [] = \"\"\nfullPrelude xs = unlines( map (procPrelude) xs)\n\nprocPrelude :: String -&gt; String\nprocPrelude pld = unlines(init(words pld))\n</code></pre>\n"}, {"tags": ["haskell", "visual-studio-code", "ide", "code-completion"], "comments": [{"owner": {"reputation": 5755, "user_id": 394253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985ef765f821b00d3b41ac5ca8aef6a0?s=128&d=identicon&r=PG", "display_name": "Ed&#39;ka", "link": "https://stackoverflow.com/users/394253/edka"}, "edited": false, "score": 1, "creation_date": 1536494297, "post_id": 52243851, "comment_id": 91436855, "body": "I have had better experience with <a href=\"https://marketplace.visualstudio.com/items?itemName=Vans.haskero\" rel=\"nofollow noreferrer\">Haskero</a> extension: both &quot;type of hover&quot; and autocomplete work out of the box. It also depends on Intero (where it gets types and autocompletes) but seems to work better."}, {"owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "reply_to_user": {"reputation": 5755, "user_id": 394253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985ef765f821b00d3b41ac5ca8aef6a0?s=128&d=identicon&r=PG", "display_name": "Ed&#39;ka", "link": "https://stackoverflow.com/users/394253/edka"}, "edited": false, "score": 0, "creation_date": 1536573161, "post_id": 52243851, "comment_id": 91457649, "body": "OK - I&#39;ve made a few steps forward, but hit another wall. Content updated."}, {"owner": {"reputation": 5755, "user_id": 394253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985ef765f821b00d3b41ac5ca8aef6a0?s=128&d=identicon&r=PG", "display_name": "Ed&#39;ka", "link": "https://stackoverflow.com/users/394253/edka"}, "edited": false, "score": 2, "creation_date": 1536635422, "post_id": 52243851, "comment_id": 91483811, "body": "Both extensions work only with project built with Stack. <a href=\"https://gitlab.com/vannnns/haskero/blob/master/client/doc/installation.md\" rel=\"nofollow noreferrer\">Installation instruction for Haskero</a>. Make sure <code>stack build</code> works and also install Intero with <code>stack build intero</code>. Should work after that. Do not use cabal."}, {"owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "reply_to_user": {"reputation": 5755, "user_id": 394253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985ef765f821b00d3b41ac5ca8aef6a0?s=128&d=identicon&r=PG", "display_name": "Ed&#39;ka", "link": "https://stackoverflow.com/users/394253/edka"}, "edited": false, "score": 0, "creation_date": 1536649151, "post_id": 52243851, "comment_id": 91487882, "body": "Ok, I think there&#39;s still one thing I don&#39;t get. Shall I install intero in every project I work with or maybe there&#39;s a way to install it once &quot;globally&quot; ?"}, {"owner": {"reputation": 5755, "user_id": 394253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985ef765f821b00d3b41ac5ca8aef6a0?s=128&d=identicon&r=PG", "display_name": "Ed&#39;ka", "link": "https://stackoverflow.com/users/394253/edka"}, "edited": false, "score": 1, "creation_date": 1536653419, "post_id": 52243851, "comment_id": 91490048, "body": "As per <a href=\"https://marketplace.visualstudio.com/items?itemName=UCL.haskelly#user-content-installation\" rel=\"nofollow noreferrer\">Haskelly documentation</a> intero can be installed either locally with <code>stack build intero</code> command or globally via <code>stack install intero</code>"}, {"owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "reply_to_user": {"reputation": 5755, "user_id": 394253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985ef765f821b00d3b41ac5ca8aef6a0?s=128&d=identicon&r=PG", "display_name": "Ed&#39;ka", "link": "https://stackoverflow.com/users/394253/edka"}, "edited": false, "score": 0, "creation_date": 1536654245, "post_id": 52243851, "comment_id": 91490494, "body": "Ok, I&#39;ll give it another go in the evening, once I&#39;m back home. Thanks."}, {"owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "reply_to_user": {"reputation": 5755, "user_id": 394253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/985ef765f821b00d3b41ac5ca8aef6a0?s=128&d=identicon&r=PG", "display_name": "Ed&#39;ka", "link": "https://stackoverflow.com/users/394253/edka"}, "edited": false, "score": 0, "creation_date": 1536787022, "post_id": 52243851, "comment_id": 91554813, "body": "Nope - still no good. Content updated."}], "answers": [{"comments": [{"owner": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "edited": false, "score": 0, "creation_date": 1552635610, "post_id": 52330443, "comment_id": 97093333, "body": "could you give details what you installed on atom (cabal or stack, version of ghc etc.). I tried the same and had no luck (but have HIE in VS code running - mostly). Needs better documentation on &#39;how to start&#39;."}, {"owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "reply_to_user": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "edited": false, "score": 0, "creation_date": 1553007186, "post_id": 52330443, "comment_id": 97220686, "body": "I&#39;ve tried again recently but had no luck this time. Looks like things with HIE keep changing very rapidly. I find it sad that such a great language is missing a beginner-friendly way to start."}, {"owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "reply_to_user": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "edited": false, "score": 0, "creation_date": 1572343187, "post_id": 52330443, "comment_id": 103521247, "body": "Quick update: I installed only hie-8.6.5 using stack. There&#39;s was a little bit of hassle making sure all the required binaries are available in PATH, but eventually I did it. HOWEVER, it worked only for simple cases for me and tended to crash out while working with more real-life apps. At first I tried to read error messages from VSCode Extensions, but then resigned and started just coding without any IDE-like support (see more details in the post below)."}], "tags": [], "owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "is_accepted": false, "score": 2, "last_activity_date": 1536929331, "last_edit_date": 1536929331, "creation_date": 1536922194, "answer_id": 52330443, "question_id": 52243851, "link": "https://stackoverflow.com/questions/52243851/using-haskell-with-vs-code/52330443#52330443", "title": "Using Haskell with VS Code", "body": "<p>As the quickest solution, I decided to install Haskell IDE Engine (HIE: <a href=\"https://github.com/haskell/haskell-ide-engine\" rel=\"nofollow noreferrer\">https://github.com/haskell/haskell-ide-engine</a>) and use it with Atom. Didn't manage to configure it with VS code, though, but that's ok for now.</p>\n"}, {"tags": [], "owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "is_accepted": true, "score": 1, "last_activity_date": 1610449577, "last_edit_date": 1610449577, "creation_date": 1572343040, "answer_id": 58605060, "question_id": 52243851, "link": "https://stackoverflow.com/questions/52243851/using-haskell-with-vs-code/58605060#58605060", "title": "Using Haskell with VS Code", "body": "<p>I know it's been a long time, but I'd like to share my past experience. Maybe someone takes the advantage of it and won't need to go through the same list of problems.</p>\n<p>After spending hours reading articles and talking to various people I came up with the conclusion that the best way to get started with Haskell is... just to get started with Haskell. I installed ghc platform and cabal, use the cabal new-style commands and that seems to be enough. At least for now. Also, I decided to use VSCode with just a simple syntax-highlighting extension.</p>\n<p>I found out that any attempt to introduce more IDE-like features are unlikely to succeed, as Haskell is a very complex language. &quot;hie&quot; is a nice little idea, but it's missing stability and reliability to me - over the time I learnt how to install it, but for me it works only for simple cases and crashes with more real-life applications.</p>\n<p>Recently I've been trying to create a very simple DB + Web API App now and I've been having hard times in making the two monads talk to each other properly. I think there's no IDE that could do this for me anyway. When I find it difficult to write down the correct type of a function, then I use &quot;cabal new-repl&quot;, load my module, check the desired type with &quot;:t&quot; and make an attempt to decypher the output. Not a perfect solution, but again - good enough.</p>\n<h3>EDIT 12-Jan-2021</h3>\n<p>I've spent even more time with Haskell and my understanding increased. I moved to NixOS which seems to handle everything nicely.</p>\n<p>Here's a link to a repo with my NixOS config files:\n<a href=\"https://github.com/bratfizyk/dotFiles/tree/master/nixos\" rel=\"nofollow noreferrer\">https://github.com/bratfizyk/dotFiles/tree/master/nixos</a></p>\n<p>Using it &quot;as it is&quot; installs VS Code with HIE support enabled. Youi might only need to install the VS Code extension itself, as I found this feature problematic in nix, but it's a straightforward process.</p>\n<p>Obviously, change a user name :). Otherwise you'll keep on using mine.</p>\n<p>I'm going to update the repo over time.</p>\n"}], "owner": {"reputation": 1502, "user_id": 2545980, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/FaKkG.jpg?s=128&g=1", "display_name": "Alojzy Leszcz", "link": "https://stackoverflow.com/users/2545980/alojzy-leszcz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1989, "favorite_count": 0, "accepted_answer_id": 58605060, "answer_count": 2, "score": 2, "last_activity_date": 1610449626, "creation_date": 1536491076, "last_edit_date": 1610449626, "question_id": 52243851, "link": "https://stackoverflow.com/questions/52243851/using-haskell-with-vs-code", "title": "Using Haskell with VS Code", "body": "<p>I can't get my VS Code to show Haskell type hovers. Also, there's no autocompletion. All I see is just a small, empty box just above the element I hover with my mouse (see the small box right about \"getArgs\" function).</p>\n\n<p><a href=\"https://i.stack.imgur.com/PxmGN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PxmGN.png\" alt=\"my VS Code with &quot;Hakelly&quot; installed\"></a>\nThe extension I use is \"Haskelly\", though I've tried extensions for Atom editor as well and the result was similar.</p>\n\n<p>Has anyone had a similar issue before ?\nI use:</p>\n\n<ul>\n<li>VS Code: 1.27.1</li>\n<li>ghc: 8.0.2</li>\n<li>ghc-mod: 5.8.0.0</li>\n<li>haskelly: 0.5.4</li>\n<li>Intero: 0.1.32</li>\n<li>OS: Linux Mint 19</li>\n</ul>\n\n<p>Disclaimer: I'm quite new to Haskell, so it might be the case that I'm doing something terribly wrong here. Sorry, still learning ;).</p>\n\n<p>EDIT:</p>\n\n<p>As suggested in a comment I've switched to Haskero and managed to make a small progress. There is a type hover, but it contains some garbage.</p>\n\n<p><a href=\"https://i.stack.imgur.com/V4boV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V4boV.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>One thing that might matter: I'm following this tutorial: <a href=\"https://www.youtube.com/watch?v=a7R-2vtPLDM\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=a7R-2vtPLDM</a>, so I use cabal, not stack. Does it matter at all ?</p>\n\n<p>EDIT 2:</p>\n\n<p>I've tried using stack, but the result was even worse. The VS Code extension crashed with the following code:</p>\n\n<pre><code>The following GHC options are incompatible with GHCi and have not been passed to it: -threaded\nConfiguring GHCi with the following packages: MyProject\n\nWarning: Didn't find expected autogen file:\n         &lt;path_to_project&gt;/MyProject/.stack-work/dist/x86_64-linux/Cabal-2.2.0.1/build/autogen/cabal_macros.h\n\nWarning: Didn't find expected autogen file:\n         &lt;path_to_project&gt;/MyProject/.stack-work/dist/x86_64-linux/Cabal-2.2.0.1/build/MyProject-exe/autogen/cabal_macros.h\n&lt;home&gt;/.stack/programs/x86_64-linux/ghc-8.4.3/lib/ghc-8.4.3/package.conf.d/package.cache: GHC.PackageDb.readPackageDb: inappropriate type (Not a valid Unicode code point!)\n\n\n  Code: -32603 \n</code></pre>\n\n<p>EDIT 3:</p>\n\n<p>Still no good, but a bit closer. For built-in values and within the same package I can see pretty type hovers. However, I see errors for values from my modules when referenced in the other modules (even though they live next to each other and everything compiles just fine):</p>\n\n<p><a href=\"https://i.stack.imgur.com/L41Pw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/L41Pw.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Any ideas how to help with this ?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1536490818, "post_id": 52243534, "comment_id": 91435984, "body": "Is <code>:r</code> what you want, perhaps?"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1536495504, "creation_date": 1536495504, "answer_id": 52244470, "question_id": 52243534, "link": "https://stackoverflow.com/questions/52243534/how-to-repeat-the-last-load-command-in-ghci/52244470#52244470", "title": "How to repeat the last :load command in GHCi?", "body": "<p>At a guess: <code>:</code> repeats the <code>:l</code> part, but not the <code>:l myfile</code> part. That's probably an oversight or bug.</p>\n\n<p>In the meantime, <code>:r</code>, short for <code>:reload</code>, will load your file again.</p>\n"}], "owner": {"reputation": 6181, "user_id": 1025555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GBIIj.png?s=128&g=1", "display_name": "Good Night Nerd Pride", "link": "https://stackoverflow.com/users/1025555/good-night-nerd-pride"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 52244470, "answer_count": 1, "score": 1, "last_activity_date": 1536495504, "creation_date": 1536488541, "question_id": 52243534, "link": "https://stackoverflow.com/questions/52243534/how-to-repeat-the-last-load-command-in-ghci", "title": "How to repeat the last :load command in GHCi?", "body": "<p>The GHCi help page tells me that I can enter a single <code>:</code> to repeat the previous command.</p>\n\n<p>But this does not seem to work with all commands. For instance, when I call up the help page with <code>:?</code>, I can show it again by just entering <code>:</code>. But when I load a file with <code>:l myfile</code> a later input of just <code>:</code> will actually unload my file.</p>\n\n<p>Am I doing something wrong or did I misunderstand the help page?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "edited": false, "score": 0, "creation_date": 1536462461, "post_id": 52240970, "comment_id": 91430605, "body": "&quot;its totally possible that <code>lit</code> wouldve been passed an <code>Integral</code> type that did not have a function declared&quot; - what do you mean? Which function might not have been declared on the type with a <code>Integral</code> instance?"}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 1, "creation_date": 1536462793, "post_id": 52240970, "comment_id": 91430658, "body": "Adding to Isaac&#39;s point about all <code>Integral</code>s having <code>mod</code>; note that <code>class Expr a where lit :: Integer -&gt; a</code> specifies that <code>lit</code> takes an <code>Integer</code>, hence <code>x</code> is an <code>Integer</code>."}], "answers": [{"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 8, "last_activity_date": 1536464560, "creation_date": 1536464560, "answer_id": 52241148, "question_id": 52240970, "link": "https://stackoverflow.com/questions/52240970/how-does-haskell-infer-type-during-an-instance-declaration/52241148#52241148", "title": "How does Haskell infer type during an instance declaration?", "body": "<p>Type inference in instance declarations works the same as in any other context. In this case there are two lines of reasoning that establish that <code>x</code> is an <code>Integer</code>.</p>\n\n<ol>\n<li><p><code>x</code> appears in the expression <code>Mod7 (x `mod` 7)</code>. Since the <code>Mod7</code> constructor is declared to take an <code>Integer</code> argument, <code>x `mod` 7</code> must be an <code>Integer</code>. Since <code>mod</code> is of type <code>Integral a =&gt; a -&gt; a -&gt; a</code>, if the result of <code>x `mod` 7</code> is an <code>Integer</code>, then both <code>x</code> and <code>7</code> must also be <code>Integer</code> (this only works if <code>Integral Integer</code> holds, but it does so that's fine).</p></li>\n<li><p><code>lit</code> has been declared to have type <code>Expr a =&gt; Integer -&gt; a</code> (in the class definition for <code>Expr a</code>). <code>x</code> was bound as the argument in a definition of <code>lit</code>, so it must be of type <code>Integer</code>.</p></li>\n</ol>\n\n<p>The only thing that's specific to instance declarations is that the type checker can instantiate the type of the functions declared in the class with the type(s) for this specific instance. So it actually knows that (because this is in <code>instance Expr Mod7</code>, that the <code>lit</code> definition is for <code>lit :: Integer -&gt; Mod7</code>. However that wasn't even necessary to establish <code>x :: Integer</code>, since the argument type of <code>lit</code> is the same in every instance for <code>Expr</code> (this instance-specific knowledge is used to establish that calling the <code>Mod7</code> constructor is the correct way to build the return value, but isn't relevant to inferring the type of <code>x</code>).</p>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536464560, "creation_date": 1536462001, "question_id": 52240970, "link": "https://stackoverflow.com/questions/52240970/how-does-haskell-infer-type-during-an-instance-declaration", "title": "How does Haskell infer type during an instance declaration?", "body": "<p>I have this data type and instance declaration:</p>\n\n<pre><code>class Expr a where\n  lit :: Integer -&gt; a\n\ndata Mod7 = Mod7 Integer deriving (Eq, Show)\n\ninstance Expr Mod7 where\n  lit x = Mod7 (x `mod` 7)\n</code></pre>\n\n<p>This compiles just fine. I assume that's because this line</p>\n\n<pre><code>lit x = Mod7 (x `mod` 7)\n</code></pre>\n\n<p>infers that <code>x</code> is a type that can be passed to <code>mod</code>. How can this inference happen without some explicit declaration?</p>\n\n<p>The definition of mod is </p>\n\n<pre><code>mod :: Integral a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>So given the above declarations, its totally possible that <code>lit</code> wouldve been passed an <code>Integral</code> type that did not have a function declared. How did GHC know what type to assign to <code>x</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1536496366, "post_id": 52240874, "comment_id": 91437484, "body": "Two comments to add: use <code>readIO</code> instead of <code>read</code> to force a crash immediately on malformed input, instead of some tricky-to-pinpoint later time when the <code>port</code> is first actually used; and you can always just move the type signature to the other side, as in <code>let port = read portStr :: Int</code> (or <code>port &lt;- readIO portStr :: IO Int</code>)."}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1536505889, "post_id": 52240874, "comment_id": 91439774, "body": "Thanks @DanielWagner. The thing is in some case my Monad was a type class rather than a concreate type, I can put the type signature in the other side. For example, if I was using MonadIO or ReaderT where I only know the Monad will return me a String, but I won\u2019t know what exactly the Monad it is."}], "answers": [{"comments": [{"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1536493280, "post_id": 52241384, "comment_id": 91436610, "body": "One more thing to add, you can specify the type of, for instance <code>portStr</code> in <code>portStr &lt;- getEnv &quot;PORT&quot;</code> indirectly by specifying the type of the whole expression, that is <code>postStr &lt;- getEnv &quot;PORT&quot; :: IO String</code> (and replace IO with the appropriate monad of the the <code>do</code> block for other cases, you might still need <code>ScopeTypeVariables</code> if the <code>do</code> block is polymorphic in the monad type). This is useful for example in expressions like <code>x &lt;- readLn</code> where the type of <code>x</code> may remain ambiguous without a type declaration (somewhere), to fix that we can add <code>x &lt;- readLn :: IO Integer</code>, for example."}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1536494046, "post_id": 52241384, "comment_id": 91436785, "body": "Note: The ambiguity in the last example of my comment above can also be resolved with <code>TypeApplications</code>, that is <code>x &lt;- readLn @Integer</code>. However <code>TypeApplications</code> aren&#39;t always applicable."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 5, "last_activity_date": 1536486220, "last_edit_date": 1536486220, "creation_date": 1536467900, "answer_id": 52241384, "question_id": 52240874, "link": "https://stackoverflow.com/questions/52240874/how-to-specify-types-for-intermediate-variables-explicitly/52241384#52241384", "title": "How to specify types for intermediate variables explicitly?", "body": "<p>Without <code>ScopedTypeVariables</code> you <em>can</em> add type signatures for variables introduced in blocks of declarations, like <code>let</code> statements in do-blocks, <code>let ... in ...</code> expressions, and <code>where</code> clauses. The syntax you guessed in your example isn't quite right though, you need to add a separate type declaration outisde the definition of the variable (exactly the same as the way you wrote <code>readConfigFromEnv :: IO (Int, String)</code> on a separate line from its definition, rather than writing both at once as <code>readConfigFromEnv :: IO (Int, String) = do</code>). So you can, for example, write:</p>\n\n<pre><code>readConfigFromEnv :: IO (Int, String)\nreadConfigFromEnv = do\n  portStr &lt;- getEnv \"PORT\"\n  let port :: Int\n      port = read portStr\n  secret &lt;- getEnv \"SECRET\"\n  return (port, secret)\n</code></pre>\n\n<p><code>ScopedTypeVariables</code> allows you to add type annotations in contexts where you otherwise couldn't, which helps you declare the type of variables introduced in other ways than these \"declaration blocks\", such as <code>&lt;-</code> bindings in do blocks, lambda-bound variables, and variables introduced in <code>case</code> patterns.</p>\n\n<p>However the primary purpose of <code>ScopedTypeVariables</code> is to allow type variables to have scopes over multiple type annotations; normally variables in two different type annotations are assumed to be different variables even if they have the same name, and so there are a lot of types that are impossible to write without it. Basically with <code>ScopedTypeVariables</code> on any variable introduced with an explicit <code>forall</code> becomes a definition of a variable, so any use of that type variable name within its scope is actually a reference to this outer-scope variable rather than a new variable. For example, consider this code:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nreadTwoThings :: forall a. Read a =&gt; IO (a, a)\nreadTwoThings = do\n  sx &lt;- readLn\n  sy &lt;- readLn\n  let x, y :: a\n      x = read sx\n      y = read sy\n  pure (x, y)\n</code></pre>\n\n<p>Here, the type expression <code>x, y :: a</code> says that <code>x</code> and <code>y</code> are of <em>the</em> type <code>a</code> that appears in the type signature for <code>readTwoThings</code>.</p>\n\n<p>Compare what happens when you remove the <code>forall a.</code>, and/or swap out <code>ScopedTypeVariables</code> for <code>ExplicitForAll</code>. In that case you get an error because the <code>a</code> that is the type of <code>x</code> and <code>y</code> is a different variable to the <code>a</code> in the type of <code>readTwoThings</code>.</p>\n\n<p>In practice I find that the <code>ScopedTypeVariables</code> behaviour is usually what you actually want to happen, but because you can find examples like this where the same code means two different things depending on whether <code>ScopedTypeVariables</code> is enabled (you might even be able to construct examples where the code compiles either way and does different things!), you can't just blindly turn it on without understanding how it affects type signatures.</p>\n\n<hr>\n\n<p>Now, with all of that background established, here's my explicit answers to your list of questions:</p>\n\n<ol>\n<li><p>Yes if you want to declare the type of <em>every</em> local variable where it is declared, you'll need <code>ScopedTypeVariables</code>.</p></li>\n<li><p>Explicitly specifying the types of every top level definition is a very common recommendation, I'd say it's nearly consensus among the Haskell community. I also find it helpful to add type declarations to <code>let</code> and <code>where</code> bound variables if they're at all complicated, but that practice is less widespread. Adding types to things like <code>portStr &lt;- getEnv \"PORT\"</code> isn't common at all, but it's a matter of taste really. I am pretty sure I would find the extra effort to write the code and hindrance changing it to be more annoying than the benefit.</p>\n\n<p>I can see why you would want to do this in really large function definitions (especially very long do blocks), but I would generally try to split those up into smaller pieces (either top-level or with <code>where</code> clauses), and the pieces would have type declarations.</p>\n\n<p>So my vote would be no it isn't good practice, but this is a subjective opinion, not an objective fact. Don't let it stop you trying it if it seems like it would be helpful to you.</p></li>\n<li><p>See all of the discussion above. <code>ScopedTypeVaribles</code> is a great extension; a lot of people would be perfectly comfortable switching it on by default, and many would even like it to be part of the base language one day. There is absolutely no drawback about turning it on, apart from confusion if you don't know what it actually does.</p></li>\n</ol>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536495676, "creation_date": 1536460435, "last_edit_date": 1536495676, "question_id": 52240874, "link": "https://stackoverflow.com/questions/52240874/how-to-specify-types-for-intermediate-variables-explicitly", "title": "How to specify types for intermediate variables explicitly?", "body": "<p>I have a function <code>readConfigFromEnv</code> that reads some env var from the environment variable. </p>\n\n<pre><code>readConfigFromEnv :: IO (Int, String)\nreadConfigFromEnv = do\n  portStr &lt;- getEnv \"PORT\"\n  let port = read portStr\n  secret &lt;- getEnv \"SECRET\"\n  return (port, secret)\n</code></pre>\n\n<p>Even though Haskell has awesome type inference system, I still want to explicitly specify the types that I expected, and let the compiler tell me if there is anything doesn't make sense:</p>\n\n<pre><code>readConfigFromEnv :: IO (Int, String)\nreadConfigFromEnv = do\n  portStr :: String &lt;- getEnv \"PORT\"\n  let port :: Int = read portStr\n  secret :: String &lt;- getEnv \"SECRET\"\n  return (port, secret)\n</code></pre>\n\n<p>But this code doesn't compile. However, the compiler hints that I should add the language extension <code>ScopedTypeVariables</code>. I tried it works. </p>\n\n<p>So my questions are:</p>\n\n<ol>\n<li><p>Is adding <code>ScopedTypeVariables</code> the right way to explicitly specify types for intermediate values?</p></li>\n<li><p>Is explicitly specifying types a good practice?</p></li>\n<li><p>Is there any side effect of using <code>ScopedTypeVariables</code>, should I add this to my default language extension list?</p></li>\n</ol>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "module"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1536438850, "post_id": 52238652, "comment_id": 91426954, "body": "Is your question actually about how to pipe the output of <code>:browse</code> to a file? You know about haddocks, hoogle, <code>:browse</code>, etc. so it&#39;s not clear to me what kind of answer you&#39;re looking for. Maybe you want editor/IDE integration?"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1536439615, "post_id": 52238652, "comment_id": 91427116, "body": "Well  i am a beginner in haskell and i wanted to know how can i easily check a module&#39;s interface..and see what methods it exposes , and their signatures.So yes one question would be how can i pipe the output of an <code>ghci</code> command like <code>browse</code> to a file."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1536441093, "post_id": 52238652, "comment_id": 91427444, "body": "<code>stack haddock --open</code>?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1536441166, "post_id": 52238652, "comment_id": 91427462, "body": "Usually when you &quot;<i>browse through a module</i>&quot; you already browse through its documentation, not through its code, so I&#39;m not quite sure what you are asking for."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1536441364, "post_id": 52238652, "comment_id": 91427520, "body": "I want to know if there is anywhere where i can find the module with only its declared methods and definitions (like a header if you will).Something like lets say for <code>System.IO</code>  i would see <code>readFile::FilePath-&gt;IO String  ; writeFile::FilePath-&gt;String-&gt;IO() ...</code>etc"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 4, "last_activity_date": 1536440696, "creation_date": 1536440696, "answer_id": 52239392, "question_id": 52238652, "link": "https://stackoverflow.com/questions/52238652/how-does-one-browse-a-modules-functions-and-their-types/52239392#52239392", "title": "How does one browse a module&#39;s functions and their types?", "body": "<p>How about a simple command line option and shell redirect?</p>\n\n<pre><code>ghci -e ':browse Prelude' &gt; file.txt\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": false, "score": 3, "last_activity_date": 1536482139, "creation_date": 1536482139, "answer_id": 52242750, "question_id": 52238652, "link": "https://stackoverflow.com/questions/52238652/how-does-one-browse-a-modules-functions-and-their-types/52242750#52242750", "title": "How does one browse a module&#39;s functions and their types?", "body": "<p>My usual approach to this is finding the  package on Hackage and browsing the docs on there - which have the methods and signatures (types).</p>\n\n<p>For example for <code>Data.List</code>: <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-List.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-List.html</a></p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 52239392, "answer_count": 2, "score": 0, "last_activity_date": 1536516580, "creation_date": 1536434584, "last_edit_date": 1536516580, "question_id": 52238652, "link": "https://stackoverflow.com/questions/52238652/how-does-one-browse-a-modules-functions-and-their-types", "title": "How does one browse a module&#39;s functions and their types?", "body": "<p>How do Haskell programmers browse through a module to see the available methods and data types?</p>\n\n<p>I am asking because i think that there is a faster and easier way then to always enter hoogle and look them up (as i am currently doing). I just want to see the methods and signatures.</p>\n\n<p><strong>P.S</strong> I discovered <code>GHCI</code> provides a <code>browse</code> method but is there any way to pipe the result in a file ? Redirecting ghci output to file ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1536475097, "post_id": 52237895, "comment_id": 91432463, "body": "<code>mappend a mempty</code> can be simplified to just <code>a</code>, according to the monoid laws."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 1256139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec5bb8d625f91ecdd36fa1da6b171ddd?s=128&d=identicon&r=PG", "display_name": "jarvin", "link": "https://stackoverflow.com/users/1256139/jarvin"}, "edited": false, "score": 3, "creation_date": 1536432930, "post_id": 52238024, "comment_id": 91425421, "body": "Is there a way to create a monoid instance without creating a dummy semigroup instance of Optional a?"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 153, "user_id": 1256139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec5bb8d625f91ecdd36fa1da6b171ddd?s=128&d=identicon&r=PG", "display_name": "jarvin", "link": "https://stackoverflow.com/users/1256139/jarvin"}, "edited": false, "score": 10, "creation_date": 1536441408, "post_id": 52238024, "comment_id": 91427526, "body": "@jarvin: In other words, you should define <code>&lt;&gt;</code> in a <code>Semigroup</code> instance using the definition you currently have for <code>mappend</code>, and define <code>mempty</code> in a <code>Monoid</code> instance. You can just ignore <code>mappend</code> since it\u2019s only around for compatibility reasons now, and its default implementation is <code>mappend = (&lt;&gt;)</code>."}], "tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": true, "score": 15, "last_activity_date": 1536429880, "creation_date": 1536429880, "answer_id": 52238024, "question_id": 52237895, "link": "https://stackoverflow.com/questions/52237895/could-not-deduce-semigroup-optional-a-arising-from-the-superclasses-of-an-in/52238024#52238024", "title": "Could not deduce (Semigroup (Optional a)) arising from the superclasses of an instance declaration", "body": "<p>\"<a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Monoid.html\" rel=\"noreferrer\">NOTE: Semigroup is a superclass of Monoid since base-4.11.0.0.</a>\"</p>\n\n<p>The list of superclasses in has been evolving slowly.  As new useful classes are proposed, the API for older classes is updated to reflect their relationships.  This has the unfortunate effect of breaking older code.  Base 4.11.1.0 was released in April of 2018 with this breaking change to Monoid.</p>\n"}, {"comments": [{"owner": {"reputation": 1357, "user_id": 1863487, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0bd8edac9a69fa34715d440cee0ab22d?s=128&d=identicon&r=PG", "display_name": "Fjarlaegur", "link": "https://stackoverflow.com/users/1863487/fjarlaegur"}, "edited": false, "score": 2, "creation_date": 1544955142, "post_id": 53800966, "comment_id": 94451138, "body": "I have no real understanding of Haskell, but can you elaborate your solution? Point to the lines which will solve the problem? Or which lines didn&#39;t work. It is easier to grasp for people trying to understand the problem instead of just copy pasting your answer in their code."}, {"owner": {"reputation": 467, "user_id": 2555516, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/KDZBP.png?s=128&g=1", "display_name": "Jason Fry", "link": "https://stackoverflow.com/users/2555516/jason-fry"}, "reply_to_user": {"reputation": 1357, "user_id": 1863487, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/0bd8edac9a69fa34715d440cee0ab22d?s=128&d=identicon&r=PG", "display_name": "Fjarlaegur", "link": "https://stackoverflow.com/users/1863487/fjarlaegur"}, "edited": false, "score": 1, "creation_date": 1556895151, "post_id": 53800966, "comment_id": 98595328, "body": "@Fjarlaegur the part that solves the issue is <code>instance Semigroup</code>. In the OP&#39;s code, he has an instance of Monoid, just like Chandan&#39;s answer here. The difference is that Chandan has also added the instance of Semigroup. As John F. Miller answered, having an instance of Monoid used to be enough, but now things have changed and you also need an instance of Semigroup.  However, the logic in the OP&#39;s instance of Monoid is the same as the logic in Chandan&#39;s instance of Semigroup (don&#39;t be confused by <code>mappend</code> vs <code>&lt;&gt;</code>, they are the same thing)."}], "tags": [], "owner": {"reputation": 51, "user_id": 10671142, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/248eeb6b72b45829f2d77d73068f4696?s=128&d=identicon&r=PG&f=1", "display_name": "Chandan", "link": "https://stackoverflow.com/users/10671142/chandan"}, "is_accepted": false, "score": 5, "last_activity_date": 1544952794, "creation_date": 1544952794, "answer_id": 53800966, "question_id": 52237895, "link": "https://stackoverflow.com/questions/52237895/could-not-deduce-semigroup-optional-a-arising-from-the-superclasses-of-an-in/53800966#53800966", "title": "Could not deduce (Semigroup (Optional a)) arising from the superclasses of an instance declaration", "body": "<p>Here is the solution:</p>\n\n<pre><code>import Data.Monoid\n\ndata Optional a = Nada | Only a deriving (Eq, Show)\n\ninstance Monoid a =&gt; Monoid (Optional a) where\n   mempty = Nada\n\ninstance Semigroup a =&gt; Semigroup (Optional a) where\n  Nada &lt;&gt; (Only a) = Only a\n  (Only a) &lt;&gt; Nada = Only a\n  (Only a) &lt;&gt; (Only a') = Only (a &lt;&gt; a')\n  Nada &lt;&gt; Nada = Nada\n\nmain :: IO ()\nmain = do\n  print $ Only (Sum 1) `mappend` Only (Sum 1)\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 1256139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec5bb8d625f91ecdd36fa1da6b171ddd?s=128&d=identicon&r=PG", "display_name": "jarvin", "link": "https://stackoverflow.com/users/1256139/jarvin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2039, "favorite_count": 0, "accepted_answer_id": 52238024, "answer_count": 2, "score": 15, "last_activity_date": 1544952794, "creation_date": 1536429086, "question_id": 52237895, "link": "https://stackoverflow.com/questions/52237895/could-not-deduce-semigroup-optional-a-arising-from-the-superclasses-of-an-in", "title": "Could not deduce (Semigroup (Optional a)) arising from the superclasses of an instance declaration", "body": "<p>The following code from \"Haskell Programming: From first principles\" fails to compile:</p>\n\n<pre><code>module Learn where\nimport Data.Semigroup\nimport Data.Monoid\n\n-- Exercise: Optional Monoid\ndata Optional a = Nada\n                | Only a\n                deriving (Eq, Show)\n\ninstance Monoid a =&gt; Monoid (Optional a) where\n mempty = Nada\n mappend Nada Nada = Nada\n mappend (Only a) Nada = Only $ mappend a mempty\n mappend Nada (Only a) = Only $ mappend mempty a\n mappend (Only a) (Only b) = Only $ mappend a b\n</code></pre>\n\n<p>It gives the following error:</p>\n\n<pre><code>intermission.hs:11:10: error:\n    \u2022 Could not deduce (Semigroup (Optional a))\n        arising from the superclasses of an instance declaration\n      from the context: Monoid a\n        bound by the instance declaration at intermission.hs:11:10-40\n    \u2022 In the instance declaration for \u2018Monoid (Optional a)\u2019\n   |\n11 | instance Monoid a =&gt; Monoid (Optional a) where\n   |   \n</code></pre>\n\n<p>In order to stop ghc from complaining, I had to create a semigroup instance of Optional a and define \"&lt;>\". This doesn't quite make sense to me and was wondering if there was something I was overlooking.</p>\n"}, {"tags": ["performance", "sorting", "haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 5, "creation_date": 1536427745, "post_id": 52237695, "comment_id": 91424009, "body": "How did you implement quicksort on singly-linked lists?"}, {"owner": {"reputation": 877, "user_id": 6670539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc5d9e22b9198266e1f5bff83f7e034?s=128&d=identicon&r=PG&f=1", "display_name": "Robert D-B", "link": "https://stackoverflow.com/users/6670539/robert-d-b"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1536428128, "post_id": 52237695, "comment_id": 91424130, "body": "It involved some folding and creation of new lists. (Which I suspect is why it&#39;s a bad idea.) I&#39;ll edit my question to include the implementation."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 6, "creation_date": 1536429067, "post_id": 52237695, "comment_id": 91424377, "body": "merge sort can be optimized by splitting the list at even/odd index, which can be done in a single pass with direct recursion, avoiding the two-pass approach above (<code>length, splitAt</code>). Anyway, I guess performance here drove the choice of algorithm. Quicksort is fast because it can be made in-place (with arrays). On lists, it&#39;s slower. Some people argue that it should not be called &quot;quicksort&quot; unless it&#39;s in-place. Perhaps you can run a few benchmarks yourself."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1536430537, "post_id": 52237695, "comment_id": 91424800, "body": "I suggest you benchmark your <code>quicksort</code> against <code>Data.List.sort</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1536445994, "post_id": 52237695, "comment_id": 91428519, "body": "One place where a QuickSort-like algorithm is rather interesting is <code>Data.Sequence</code>. It&#39;s possible to write an <i>incremental</i> QuickSort for sequences that reveals the first few and last few elements in O(n) time, then takes successively longer times to reveal elements further from the ends. Unfortunately, I never had the time to really optimize it, and getting randomness is a pain."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 2, "creation_date": 1536456042, "post_id": 52237695, "comment_id": 91429869, "body": "The sort important implementation was not switched from quicksort to mergesort without benchmarking. :)  Also, a nice property of the current implementation is that it has O(n) complexity for (nearly) sorted inputs."}, {"owner": {"reputation": 619, "user_id": 8514005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/318a3ae487b2140f9d08079450b6903d?s=128&d=identicon&r=PG&f=1", "display_name": "JohEker", "link": "https://stackoverflow.com/users/8514005/joheker"}, "edited": false, "score": 2, "creation_date": 1536504116, "post_id": 52237695, "comment_id": 91439341, "body": "The Ghc&#39;s implementation of mergesort also uses an algorithm to detect sequences. Making it very efficient sorting almost sorted lists."}, {"owner": {"reputation": 68611, "user_id": 53897, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2e71c1745ebc5401c8c8dfbf7c9a5d30?s=128&d=identicon&r=PG", "display_name": "Thorbj&#248;rn Ravn Andersen", "link": "https://stackoverflow.com/users/53897/thorbj%c3%b8rn-ravn-andersen"}, "edited": false, "score": 0, "creation_date": 1536519719, "post_id": 52237695, "comment_id": 91443293, "body": "How does your algorithms compare to the built in sort?"}, {"owner": {"reputation": 877, "user_id": 6670539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc5d9e22b9198266e1f5bff83f7e034?s=128&d=identicon&r=PG&f=1", "display_name": "Robert D-B", "link": "https://stackoverflow.com/users/6670539/robert-d-b"}, "reply_to_user": {"reputation": 68611, "user_id": 53897, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2e71c1745ebc5401c8c8dfbf7c9a5d30?s=128&d=identicon&r=PG", "display_name": "Thorbj&#248;rn Ravn Andersen", "link": "https://stackoverflow.com/users/53897/thorbj%c3%b8rn-ravn-andersen"}, "edited": false, "score": 0, "creation_date": 1536520809, "post_id": 52237695, "comment_id": 91443596, "body": "@Thorbj&#248;rnRavnAndersen I edited my question to include profiling results. In a word: poorly!"}, {"owner": {"reputation": 68611, "user_id": 53897, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/2e71c1745ebc5401c8c8dfbf7c9a5d30?s=128&d=identicon&r=PG", "display_name": "Thorbj&#248;rn Ravn Andersen", "link": "https://stackoverflow.com/users/53897/thorbj%c3%b8rn-ravn-andersen"}, "edited": false, "score": 0, "creation_date": 1536566774, "post_id": 52237695, "comment_id": 91454374, "body": "Then the fun starts in understanding <i>why</i> :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1536568685, "post_id": 52237695, "comment_id": 91455385, "body": "Data.List.sort is compiled, and your mergesort isn&#39;t, isn&#39;t it? for timings, the least thing is to compile with -O2 as a standalone executable, then run it in a shell as <code>test +RTS -s</code>. Another thing is CAF memoization. Is your <code>testList :: [Integer]</code>, or <code>Num a =&gt; [a]</code>? In the first case, it is built during the first test, and reused by the subsequent tests, giving them an unfair advantage."}, {"owner": {"reputation": 877, "user_id": 6670539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc5d9e22b9198266e1f5bff83f7e034?s=128&d=identicon&r=PG&f=1", "display_name": "Robert D-B", "link": "https://stackoverflow.com/users/6670539/robert-d-b"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1536595205, "post_id": 52237695, "comment_id": 91470745, "body": "@WillNess Thanks for your insight. I assumed that ghci was compiling on imports, but I suppose the situation is a little different from that. I updated my question with more accurate profiling."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1536603636, "post_id": 52237695, "comment_id": 91474581, "body": "interesting how your mergesort was 2.5x faster than your quicksort when interpreted, but when compiled it&#39;s only 5% faster. you could also try comparing yours with the one-pass three-way code(s) in my answer on the linked question, to see if there&#39;s any difference."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541975381, "post_id": 52237695, "comment_id": 93392313, "body": "@WillNess Is <code>Data.List.sort</code> really Mergesort? To me it seems more like kind of Timsort. Looking at that poetic code i think best case (for already sorted ascending or descending inputs) of <code>Data.List.sort</code> is O(n). The <code>sequences</code> function is linear and simply <code>mergeAll [x] = x</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1542012101, "post_id": 52237695, "comment_id": 93401407, "body": "@Redu <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/Data.OldList.html#sort\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/src/&hellip;</a> is bottom-up merge sort par excellence. sequences are discovered before the repeated merging."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1542013864, "post_id": 52237695, "comment_id": 93402286, "body": "@WillNess Yes i know the code.. My point was, standard Mergesort doesn&#39;t have the notion of discovering sequences AFAIK. And this beauty not only find the sequences (already ordered chunks like you did <a href=\"https://stackoverflow.com/a/52843783/4543207\">here</a>) but also put them in the required order while generating them, to be merged later. Not exactly, but sort of like Timsort <a href=\"https://dev.to/s_awdesh/timsort-fastest-sorting-algorithm-for-real-world-problems--2jhd\" rel=\"nofollow noreferrer\"><b>run</b>s</a>. Is it not O(n) for already sorted lists..?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1542015318, "post_id": 52237695, "comment_id": 93403008, "body": "well, the runs technique is attributed to O&#39;Keefe mergesort code from the 1980s, so it&#39;s certainly independent of timsort. yes of course it&#39;s O(n) for the sorted lists. I could find the paper &quot;Simple and Efficient Mergesort&quot; by Olin Shivers which shows such code, though only discovering the ascending runs. If timsort uses this technique, good for it; but it was  known well before it."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 22, "creation_date": 1536431559, "post_id": 52238049, "comment_id": 91425051, "body": "Another note: You can implement mergesort in such a way that <code>head (sort xs)</code> is O(n) in a lazy language."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1536433206, "post_id": 52238049, "comment_id": 91425502, "body": "what do you mean by &quot;naturally&quot; stable? it is very easy to do the initial split wrong, like e.g. &quot;splitting the list at even/odd index&quot;."}, {"owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "edited": false, "score": 2, "creation_date": 1536433901, "post_id": 52238049, "comment_id": 91425681, "body": "Yes, but if you do the implementation right, you <i>can</i> get your stability &quot;for free&quot;.  With Quicksort (and other unstable sorts like Heapsort), you must explicitly track the original index to stabilize the sort.  This dings the performance enough that, if you need the stability, you might as well use Mergesort."}, {"owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "edited": false, "score": 2, "creation_date": 1536438310, "post_id": 52238049, "comment_id": 91426832, "body": "Actually, the not-in-place version of Quicksort above <i>is</i> (or can be made) stable, unlike the usual in-place Quicksort!  I was alerted to this from following the link from K. A. Buhr&#39;s answer to the old Haskell implementation, which notes that its <code>qsort</code> (similar to the question&#39;s <code>quicksort</code>) is stable."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1536457555, "post_id": 52238049, "comment_id": 91430061, "body": "yeah, I wasn&#39;t arguing against it. the runs discovery and bottom-up merging is specifically named &quot;natural&quot; in the <a href=\"https://www.cs.tufts.edu/~nr/cs257/archive/olin-shivers/msort.ps\" rel=\"nofollow noreferrer\">cs.tufts.edu/~nr/cs257/archive/olin-shivers/msort.ps</a> paper, even quoting the 1982 O&#39;Keefe implementation mentioned in the docs (which is how I found that paper). for the simple list-based quicksort (which is <a href=\"https://stackoverflow.com/a/11357450/849891\">a deforested tree sort</a> really), all we have to do is use <code>&lt;</code> and <code>&gt;=</code> (and not <code>&lt;=</code> and <code>&gt;</code>) <a href=\"https://stackoverflow.com/questions/11355621/pseudo-quicksort-time-complexity\">in the partitioning</a>."}], "tags": [], "owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "is_accepted": true, "score": 72, "last_activity_date": 1536432595, "last_edit_date": 1536432595, "creation_date": 1536429997, "answer_id": 52238049, "question_id": 52237695, "link": "https://stackoverflow.com/questions/52237695/why-does-haskell-use-mergesort-instead-of-quicksort/52238049#52238049", "title": "Why does Haskell use mergesort instead of quicksort?", "body": "<p>In imperative languages, Quicksort is performed in-place by mutating an array.  As you demonstrate in your code sample, you can adapt Quicksort to a pure functional language like Haskell by building singly-linked lists instead, but this is not as fast.</p>\n\n<p>On the other hand, Mergesort is not an in-place algorithm:  a straightforward imperative implementation copies the merged data to a different allocation.  This is a better fit for Haskell, which by its nature must copy the data anyway.</p>\n\n<p>Let's step back a bit:  Quicksort's performance edge is \"lore\" -- a reputation built up decades ago on machines much different from the ones we use today.  Even if you use the same language, this kind of lore needs rechecking from time to time, as the facts on the ground can change.  The last benchmarking paper I read on this topic had Quicksort still on top, but its lead over Mergesort was slim, even in C/C++.</p>\n\n<p>Mergesort has other advantages:  it doesn't need to be tweaked to avoid Quicksort's O(n^2) worst case, and it is naturally stable.  So, if you lose the narrow performance difference due to other factors, Mergesort is an obvious choice.</p>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 28, "last_activity_date": 1536432004, "creation_date": 1536432004, "answer_id": 52238320, "question_id": 52237695, "link": "https://stackoverflow.com/questions/52237695/why-does-haskell-use-mergesort-instead-of-quicksort/52238320#52238320", "title": "Why does Haskell use mergesort instead of quicksort?", "body": "<p>I think @comingstorm's answer is pretty much on the nose, but here's some more info on the history of GHC's sort function.</p>\n\n<p>In the source code for <code>Data.OldList</code>, you can find the <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/src/Data.OldList.html#sort\" rel=\"noreferrer\">implementation</a> of <code>sort</code> and verify for yourself that it's a merge sort.  Just below the definition in that file is the following comment:</p>\n\n<pre><code>Quicksort replaced by mergesort, 14/5/2002.\n\nFrom: Ian Lynagh &lt;igloo@earth.li&gt;\n\nI am curious as to why the List.sort implementation in GHC is a\nquicksort algorithm rather than an algorithm that guarantees n log n\ntime in the worst case? I have attached a mergesort implementation along\nwith a few scripts to time it's performance...\n</code></pre>\n\n<p>So, originally a functional quicksort was used (and the function <code>qsort</code> is still there, but commented out).  Ian's benchmarks showed that his mergesort was competitive with quicksort in the \"random list\" case and massively outperformed it in the case of already sorted data.  Later, Ian's version was replaced by another implementation that was about twice as fast, according to additional comments in that file.</p>\n\n<p>The main issue with the original <code>qsort</code> was that it didn't use a random pivot.  Instead it pivoted on the first value in the list.  This is obviously pretty bad because it implies performance will be worst case (or close) for sorted (or nearly sorted) input.  Unfortunately, there are a couple of challenges in switching from \"pivot on first\" to an alternative (either random, or -- as in your implementation -- somewhere in \"the middle\").  In a functional language without side effects, managing a pseudorandom input is a bit of a problem, but let's say you solve that (maybe by building a random number generator into your sort function).  You still have the problem that, when sorting an immutable linked list, locating an arbitrary pivot and then partitioning based on it will involve multiple list traversals and sublist copies.</p>\n\n<p>I think the only way to realize the supposed benefits of quicksort would be to write the list out to a vector, sort it in place (and sacrifice sort stability), and write it back out to a list.  I don't see that that could ever be an overall win.  On the other hand, if you already have data in a vector, then an in-place quicksort would definitely be a reasonable option.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10339366"}, "is_accepted": false, "score": 5, "last_activity_date": 1536532366, "creation_date": 1536532366, "answer_id": 52249125, "question_id": 52237695, "link": "https://stackoverflow.com/questions/52237695/why-does-haskell-use-mergesort-instead-of-quicksort/52249125#52249125", "title": "Why does Haskell use mergesort instead of quicksort?", "body": "<p>On a singly-linked list, mergesort can be done in place.  What's more, naive implementations scan over half the list in order to get the start of the second sublist, but the start of the second sublist falls out as a side effect of sorting the first sublist and does not need extra scanning.  The one thing quicksort has going over mergesort is cache coherency.  Quicksort works with elements close to each other in memory.  As soon as an element of indirection enters into it, like when you are sorting pointer arrays instead of the data itself, that advantage becomes less.</p>\n\n<p>Mergesort has hard guarantees for worst-case behavior, and it's easy to do stable sorting with it.</p>\n"}, {"tags": [], "owner": {"reputation": 48421, "user_id": 1196549, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/fa597bf0dc47449a25e1f7f5b57e3ef1?s=128&d=identicon&r=PG", "display_name": "Yves Daoust", "link": "https://stackoverflow.com/users/1196549/yves-daoust"}, "is_accepted": false, "score": 3, "last_activity_date": 1536693818, "creation_date": 1536693818, "answer_id": 52282899, "question_id": 52237695, "link": "https://stackoverflow.com/questions/52237695/why-does-haskell-use-mergesort-instead-of-quicksort/52282899#52282899", "title": "Why does Haskell use mergesort instead of quicksort?", "body": "<p><strong>Short answer:</strong></p>\n\n<p>Quicksort is advantageous for arrays (in-place, fast, but not worst-case optimal). Mergesort for linked lists (fast, worst-case optimal, stable, simple).</p>\n\n<p>Quicksort is slow for lists, Mergesort is not in-place for arrays.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1542140309, "post_id": 53288666, "comment_id": 93459675, "body": "I&#39;m afraid lots of algorithms <i>do</i> beat it, as far as empirical runtime performance on a real machine is concerned. Not in terms of complexity, but certainly in terms of overhead."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1542140507, "post_id": 53288666, "comment_id": 93459739, "body": "@leftaroundabout You may be right but i wasn&#39;t language agnostic. May be I should add <i>in Haskell only</i>."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1546864751, "last_edit_date": 1546864751, "creation_date": 1542139424, "answer_id": 53288666, "question_id": 52237695, "link": "https://stackoverflow.com/questions/52237695/why-does-haskell-use-mergesort-instead-of-quicksort/53288666#53288666", "title": "Why does Haskell use mergesort instead of quicksort?", "body": "<p>I am not sure, but looking at the code i don't think <code>Data.List.sort</code> is Mergesort as we know it. It just makes a single pass starting with the <code>sequences</code> function in a beautiful triangular mutual recursive fashion with <code>ascending</code> and <code>descending</code> functions to result in a list of already ascending or descending ordered chunks in the required order. Only then it starts merging.</p>\n\n<p>It's a manifestation of poetry in coding. Unlike Quicksort, its worst case (total random input) has O(nlogn) time complexity, and best case (already sorted ascending or descending) is O(n).</p>\n\n<p>I don't think any other sorting algorithm can beat it.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1546864445, "post_id": 54067493, "comment_id": 94981829, "body": "FYI <a href=\"https://stackoverflow.com/a/11373542/849891\">here</a> (at the bottom of the answer) you can find a <i>stable</i> three-way quicksort in Haskell. ---- I assume you meant <i><code>Data.List.partition</code></i> in your last sentence? Also, in your 2nd sentence, in &quot;it is not true&quot;, to what is &quot;it&quot; referring? I think there&#39;s a missing sentence there. (?)"}, {"owner": {"reputation": 321, "user_id": 5390900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9da89cedd78fa0c6eb56ee0e94a1f4c2?s=128&d=identicon&r=PG&f=1", "display_name": "L.-T. Chen", "link": "https://stackoverflow.com/users/5390900/l-t-chen"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1546865660, "post_id": 54067493, "comment_id": 94982462, "body": "Right... thanks for pointing it out. I have changed my comment."}, {"owner": {"reputation": 321, "user_id": 5390900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9da89cedd78fa0c6eb56ee0e94a1f4c2?s=128&d=identicon&r=PG&f=1", "display_name": "L.-T. Chen", "link": "https://stackoverflow.com/users/5390900/l-t-chen"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1546865851, "post_id": 54067493, "comment_id": 94982555, "body": "Regarding your stable 3-way Quicksort, I quickly benchmark the random case (10^4 Ints between 0 and 10^3). Its performance is almost as the same as <code>tqsort</code> above."}, {"owner": {"reputation": 321, "user_id": 5390900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9da89cedd78fa0c6eb56ee0e94a1f4c2?s=128&d=identicon&r=PG&f=1", "display_name": "L.-T. Chen", "link": "https://stackoverflow.com/users/5390900/l-t-chen"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1546968048, "post_id": 54067493, "comment_id": 95026031, "body": "@Will Ness, Just let you know ... I change my implementation to adopt accumulator to store the part bigger than the pivot, (or say, to use eliminated join-list structure), so that list append is always linear. The only difference now is the use of difference list to maintain stability which actually costs a bit (about 10-20% slower than mine)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1546968290, "post_id": 54067493, "comment_id": 95026154, "body": "thanks. it&#39;s a first time I hear about &quot;eliminated join-list structure&quot;. :) if you have it posted somewhere, maybe you could include a link, or update this answer?"}, {"owner": {"reputation": 321, "user_id": 5390900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9da89cedd78fa0c6eb56ee0e94a1f4c2?s=128&d=identicon&r=PG&f=1", "display_name": "L.-T. Chen", "link": "https://stackoverflow.com/users/5390900/l-t-chen"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1546968985, "post_id": 54067493, "comment_id": 95026495, "body": "On, I was inspired by the JoinList in the Edison package.   <a href=\"http://hackage.haskell.org/package/EdisonCore-1.3.2.1/docs/Data-Edison-Seq-JoinList.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/EdisonCore-1.3.2.1/docs/&hellip;</a> An expression of list appends can be considered as a join-list structure , and if you have a function generating this structure and consume it in the end you could probably eliminate this intermediate structure completely. I will perhaps write a proper article about this soon or later, although in the end it is perhaps just difference list .."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1546969139, "post_id": 54067493, "comment_id": 95026554, "body": "thanks, will look into it. funny, I once answered with something very similar, if I&#39;m getting it right that is, with <code>data List a = Nil | Append [a]</code>. is that it? (will add a link here shortly...) here it is: <a href=\"https://stackoverflow.com/a/43945275/849891\">Explicit Purely-Functional Data-Structure For Difference Lists</a>. it&#39;s a bit different than I remembered: <code>data Dlist a = List [a] | Append (Dlist a) (Dlist a)</code>. whatever it is, there&#39;s bound to be a package already written for it, huh! :) :)"}], "tags": [], "owner": {"reputation": 321, "user_id": 5390900, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9da89cedd78fa0c6eb56ee0e94a1f4c2?s=128&d=identicon&r=PG&f=1", "display_name": "L.-T. Chen", "link": "https://stackoverflow.com/users/5390900/l-t-chen"}, "is_accepted": false, "score": 2, "last_activity_date": 1546867521, "last_edit_date": 1546867521, "creation_date": 1546823727, "answer_id": 54067493, "question_id": 52237695, "link": "https://stackoverflow.com/questions/52237695/why-does-haskell-use-mergesort-instead-of-quicksort/54067493#54067493", "title": "Why does Haskell use mergesort instead of quicksort?", "body": "<p>Many arguments on why Quicksort is not used in Haskell seem plausible. However, at least Quicksort is not slower than Mergesort for the random case. Based on the implementation given in Richard Bird's book, <em>Thinking Functionally in Haskell</em>, I made a 3-way Quicksort:</p>\n\n<pre><code>tqsort [] = []\ntqsort (x:xs) = sortp xs [] [x] [] \n  where\n    sortp [] us ws vs     = tqsort us ++ ws ++ tqsort vs\n    sortp (y:ys) us ws vs =\n      case compare y x of \n        LT -&gt; sortp ys (y:us) ws vs \n        GT -&gt; sortp ys us ws (y:vs)\n        _  -&gt; sortp ys us (y:ws) vs\n</code></pre>\n\n<p>I benchmarked a few cases, e.g., lists of size 10^4 containing Int between 0 and 10^3 or 10^4, and so on. The result is the 3-way Quicksort or even Bird's version are better than GHC's Mergesort, something like 1.x~3.x faster than ghc's Mergesort, depending on the type of data (many repetitions? very sparse?). The following stats is generated by <a href=\"http://hackage.haskell.org/package/criterion-1.5.3.0\" rel=\"nofollow noreferrer\">criterion</a>:</p>\n\n<pre><code>benchmarking Data.List.sort/Diverse/10^5\ntime                 223.0 ms   (217.0 ms .. 228.8 ms)\n                     1.000 R\u00b2   (1.000 R\u00b2 .. 1.000 R\u00b2)\nmean                 226.4 ms   (224.5 ms .. 228.3 ms)\nstd dev              2.591 ms   (1.824 ms .. 3.354 ms)\nvariance introduced by outliers: 14% (moderately inflated)\n\nbenchmarking 3-way Quicksort/Diverse/10^5\ntime                 91.45 ms   (86.13 ms .. 98.14 ms)\n                     0.996 R\u00b2   (0.993 R\u00b2 .. 0.999 R\u00b2)\nmean                 96.65 ms   (94.48 ms .. 98.91 ms)\nstd dev              3.665 ms   (2.775 ms .. 4.554 ms)\n</code></pre>\n\n<p>However, there is another requirement of <code>sort</code> stated in Haskell <a href=\"https://www.haskell.org/onlinereport/list.html\" rel=\"nofollow noreferrer\">98</a>/<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch20.html#x28-22800020\" rel=\"nofollow noreferrer\">2010</a>: it needs to be <em>stable</em>. The typical Quicksort implementation using <code>Data.List.partition</code> is <em>stable</em>, but the above one isn't. </p>\n\n<hr>\n\n<p><strong>Later addition</strong>: A stable 3-way Quicksort mentioned in the comment seems as fast as <code>tqsort</code> here. </p>\n"}], "owner": {"reputation": 877, "user_id": 6670539, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fc5d9e22b9198266e1f5bff83f7e034?s=128&d=identicon&r=PG&f=1", "display_name": "Robert D-B", "link": "https://stackoverflow.com/users/6670539/robert-d-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4657, "favorite_count": 12, "accepted_answer_id": 52238049, "answer_count": 6, "score": 65, "last_activity_date": 1546867521, "creation_date": 1536427555, "last_edit_date": 1536595139, "question_id": 52237695, "link": "https://stackoverflow.com/questions/52237695/why-does-haskell-use-mergesort-instead-of-quicksort", "title": "Why does Haskell use mergesort instead of quicksort?", "body": "<p>In <a href=\"https://en.wikibooks.org/wiki/Haskell\" rel=\"noreferrer\">Wikibooks' <em>Haskell</em></a>, there is <a href=\"https://en.wikibooks.org/wiki/Haskell/Higher-order_functions\" rel=\"noreferrer\">the following claim</a>:</p>\n\n<blockquote>\n  <p>Data.List offers a sort function for sorting lists. It does not use quicksort; rather, it uses an efficient implementation of an algorithm called mergesort.</p>\n</blockquote>\n\n<p><strong>What is the underlying reason in Haskell to use mergesort over quicksort?</strong> Quicksort usually has better practical performance, but maybe not in this case. I gather that the in-place benefits of quicksort are hard (impossible?) to do with Haskell lists.</p>\n\n<p>There was <a href=\"https://softwareengineering.stackexchange.com/questions/180417/fastest-haskell-library-sort-implementation\">a related question on softwareengineering.SE</a>, but it wasn't really about <em>why</em> mergesort is used.</p>\n\n<p>I implemented the two sorts myself for profiling. Mergesort was superior (around twice as fast for a list of 2^20 elements), but I'm not sure that my implementation of quicksort was optimal.</p>\n\n<p><strong>Edit:</strong> Here are my implementations of mergesort and quicksort:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>mergesort :: Ord a =&gt; [a] -&gt; [a]\nmergesort [] = []\nmergesort [x] = [x]\nmergesort l = merge (mergesort left) (mergesort right)\n    where size = div (length l) 2\n          (left, right) = splitAt size l\n\nmerge :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nmerge ls [] = ls\nmerge [] vs = vs\nmerge first@(l:ls) second@(v:vs)\n    | l &lt; v = l : merge ls second\n    | otherwise = v : merge first vs\n\nquicksort :: Ord a =&gt; [a] -&gt; [a]\nquicksort [] = []\nquicksort [x] = [x]\nquicksort l = quicksort less ++ pivot:(quicksort greater)\n    where pivotIndex = div (length l) 2\n          pivot = l !! pivotIndex\n          [less, greater] = foldl addElem [[], []] $ enumerate l\n          addElem [less, greater] (index, elem)\n            | index == pivotIndex = [less, greater]\n            | elem &lt; pivot = [elem:less, greater]\n            | otherwise = [less, elem:greater]\n\nenumerate :: [a] -&gt; [(Int, a)]\nenumerate = zip [0..]\n</code></pre>\n\n<p><strong>Edit <s>2</s> 3:</strong> I was asked to provide timings for my implementations versus the sort in <code>Data.List</code>. Following @Will Ness' suggestions, I compiled <a href=\"https://gist.github.com/rwbogl/a7e4fb66c4b606da2f084242111ebe55\" rel=\"noreferrer\">this gist</a> with the <code>-O2</code> flag, changing the supplied sort in <code>main</code> each time, and executed it with <code>+RTS -s</code>. The sorted list was a cheaply-created, pseudorandom <code>[Int]</code> list with 2^20 elements. The results were as follows:</p>\n\n<ul>\n<li><code>Data.List.sort</code>: 0.171s</li>\n<li><code>mergesort</code>: 1.092s (~6x slower than <code>Data.List.sort</code>)</li>\n<li><code>quicksort</code>: 1.152s (~7x slower than <code>Data.List.sort</code>)</li>\n</ul>\n"}, {"tags": ["class", "haskell", "instance", "show"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 1, "creation_date": 1536425668, "post_id": 52237378, "comment_id": 91423372, "body": "What error do you get? Please <a href=\"https://stackoverflow.com/posts/52237378/edit\">edit</a> your question to include this important detail."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 10219840, "user_type": "registered", "profile_image": "https://graph.facebook.com/2049708948383738/picture?type=large", "display_name": "Omar Kahol", "link": "https://stackoverflow.com/users/10219840/omar-kahol"}, "edited": false, "score": 0, "creation_date": 1536427059, "post_id": 52237414, "comment_id": 91423800, "body": "Thank you! So why isn&#39;t LinkedList a type?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 53, "user_id": 10219840, "user_type": "registered", "profile_image": "https://graph.facebook.com/2049708948383738/picture?type=large", "display_name": "Omar Kahol", "link": "https://stackoverflow.com/users/10219840/omar-kahol"}, "edited": false, "score": 1, "creation_date": 1536428721, "post_id": 52237414, "comment_id": 91424282, "body": "@OmarKahol Beacuse it lacks an argument. It is a constructor of kind <code>* -&gt; *</code>, i.e. (roughly) a function from types to types, and we need to pass it an argument to get a type."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 53, "user_id": 10219840, "user_type": "registered", "profile_image": "https://graph.facebook.com/2049708948383738/picture?type=large", "display_name": "Omar Kahol", "link": "https://stackoverflow.com/users/10219840/omar-kahol"}, "edited": false, "score": 1, "creation_date": 1536437933, "post_id": 52237414, "comment_id": 91426732, "body": "@OmarKahol LinkedList is a &quot;type-level function&quot; which produces types. It&#39;s not a type in the same way that <code>(* 5)</code> isn&#39;t a number, but if you pass it a number you get a number back."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 53, "user_id": 10219840, "user_type": "registered", "profile_image": "https://graph.facebook.com/2049708948383738/picture?type=large", "display_name": "Omar Kahol", "link": "https://stackoverflow.com/users/10219840/omar-kahol"}, "edited": false, "score": 1, "creation_date": 1536446567, "post_id": 52237414, "comment_id": 91428616, "body": "@OmarKahol: You can learn more about kinds with the <code>:kind</code> command in GHCi. <code>:kind Show</code> gives <code>* -&gt; Constraint</code> because <code>Show</code> is a typeclass that takes a type of kind <code>*</code> (a \u201cbase type\u201d, one that contains values) and returns a constraint; <code>:kind LinkedList</code> gives <code>* -&gt; *</code> because <code>LinkedList</code> is a <i>type constructor</i> that takes a type of kind <code>*</code> and produces a type, also of kind <code>*</code>. So you can\u2019t write <code>Show LinkedList</code> because <code>*</code> and <code>* -&gt; *</code> don\u2019t match\u2014it\u2019s a kind error, which is like a type error at the type level. <code>*</code> can also be written as <code>Type</code> (imported from <code>GHC.Types</code>)."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1536425605, "creation_date": 1536425605, "answer_id": 52237414, "question_id": 52237378, "link": "https://stackoverflow.com/questions/52237378/haskell-declaring-an-instance-of-show-class/52237414#52237414", "title": "Haskell declaring an instance of Show class", "body": "<pre><code>instance Show LinkedList where\n</code></pre>\n\n<p><code>LinkedList</code> is not a type, <code>LinkedList a</code> is a type. Correcting that, we get</p>\n\n<pre><code>instance Show (LinkedList a) where\n</code></pre>\n\n<p>Then , we get another error because we call <code>show</code> on values of type <code>a</code>. We need to require that <code>a</code> belongs to class <code>Show</code>, too.</p>\n\n<pre><code>instance Show a =&gt; Show (LinkedList a) where\n</code></pre>\n\n<p>This should now work.</p>\n"}], "owner": {"reputation": 53, "user_id": 10219840, "user_type": "registered", "profile_image": "https://graph.facebook.com/2049708948383738/picture?type=large", "display_name": "Omar Kahol", "link": "https://stackoverflow.com/users/10219840/omar-kahol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "accepted_answer_id": 52237414, "answer_count": 1, "score": 1, "last_activity_date": 1536425605, "creation_date": 1536425268, "question_id": 52237378, "link": "https://stackoverflow.com/questions/52237378/haskell-declaring-an-instance-of-show-class", "title": "Haskell declaring an instance of Show class", "body": "<p>I am trying to wrap my mind around classes and data structures in Haskell, specifically declaring a type instance of it. I can get it to work with some classes and data types but not all of them so I must be missing something. Specifically I have the following data declaration:</p>\n\n<pre><code>data LinkedList a = End | Link a (LinkedList a)\n</code></pre>\n\n<p>I want to declare an instance of Show for that type so that the output looks something close to \"el1, el2, el3, el4, ...\"</p>\n\n<pre><code>instance Show LinkedList where\n    show (End) = \".\"\n    show (Link a b) = show a ++ \",\" ++ show b\n</code></pre>\n\n<p>As expected this doesn't work... Any idea why? I think I understand what \"data\" and \"type\" mean but I am not sure whether I am comfortable with classes and instances. Thank you</p>\n"}, {"tags": ["haskell", "quickcheck", "hspec"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 10334012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7b1b09487e868febf55aaed13887251?s=128&d=identicon&r=PG&f=1", "display_name": "Any3nymous user", "link": "https://stackoverflow.com/users/10334012/any3nymous-user"}, "edited": false, "score": 0, "creation_date": 1536401389, "post_id": 52234216, "comment_id": 91417186, "body": "Ah, Thanks :) that explains it"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 4, "last_activity_date": 1536401776, "last_edit_date": 1536401776, "creation_date": 1536401291, "answer_id": 52234216, "question_id": 52233821, "link": "https://stackoverflow.com/questions/52233821/how-to-select-a-value-in-a-range-with-quickcheck/52234216#52234216", "title": "How to select a value in a range with QuickCheck?", "body": "<p>You can use QuickCheck's <code>choose</code> function to select a value in an inclusive range. The easiest approach is probably to write <code>prop_check</code> with <code>do</code> notation:</p>\n\n<pre><code>prop_check :: Gen Bool\nprop_check = do\n  x &lt;- choose (5, 99999) :: Gen Integer\n  return $ solution x == ref_sol x\n</code></pre>\n\n<p>Here, <code>x</code> is an <code>Integer</code> value between <code>5</code> and <code>99999</code>.</p>\n\n<p>Depending on the types of <code>solution</code> and <code>ref_sol</code>, you may not need the <code>Gen Integer</code> type annotation on the first line. Since I didn't know the types of those functions, though, I had to add the annotation.</p>\n"}], "owner": {"reputation": 123, "user_id": 10334012, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7b1b09487e868febf55aaed13887251?s=128&d=identicon&r=PG&f=1", "display_name": "Any3nymous user", "link": "https://stackoverflow.com/users/10334012/any3nymous-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 685, "favorite_count": 0, "accepted_answer_id": 52234216, "answer_count": 1, "score": 2, "last_activity_date": 1536401776, "creation_date": 1536398321, "last_edit_date": 1536401363, "question_id": 52233821, "link": "https://stackoverflow.com/questions/52233821/how-to-select-a-value-in-a-range-with-quickcheck", "title": "How to select a value in a range with QuickCheck?", "body": "<p>I have the following code I am using for creating a challenge on the following site : <a href=\"https://www.codewars.com/\" rel=\"nofollow noreferrer\">codewars</a></p>\n\n<pre><code>describe \"Random cases\" $ do\n    it \"It should handle random test cases\" $ \n        property $ prop_check where \n            prop_check  (Positive x) = solution x == ref_sol x\n            --- ref_sol function\n</code></pre>\n\n<p>I would like to set the value of <code>x</code> in prop_check to be a positive int greater than 4 and at max a five-digit number (no more than five digits, i.e : max value = 99999). </p>\n\n<p>How would I go about approaching it ?</p>\n"}, {"tags": ["haskell", "type-level-computation", "clash"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1536383462, "post_id": 52232195, "comment_id": 91413704, "body": "I also don&#39;t see a good way of expressing it as &quot;the difference is less than one ps&quot; unless there&#39;s some absolute difference operator (since using just <code>Nat</code> subtraction won&#39;t reduce for the <i>smaller</i> - <i>larger</i> case)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1536384125, "post_id": 52232195, "comment_id": 91413798, "body": "That <code>div</code> is a type variable. I think we might actually have type-level division though..."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1536384223, "post_id": 52232195, "comment_id": 91413810, "body": "@dfeuer oh crap, you&#39;re absolutely right... that&#39;s what I get for hacking on Haskell, Idris and Agda in quick succession..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1536384340, "post_id": 52232195, "comment_id": 91413830, "body": "Heh. Yeah, that&#39;s an easy one to mix up. I&#39;ve always liked Haskell&#39;s case sensitivity, but a few days ago Ed Kmett mentioned that there are no Chinese characters recognized as &quot;upper case&quot;, which really throws a wrench into the system."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1536384513, "post_id": 52232195, "comment_id": 91413853, "body": "@dfeuer: That sounds more like a feature... the last thing the programming world needs is fragmentation along NATURAL languages."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1536384235, "post_id": 52232270, "comment_id": 91413813, "body": "By the way, <code>GHC.TypeLits</code> indeed offers <code>Div</code> and <code>Mod</code>."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 5, "last_activity_date": 1536384085, "creation_date": 1536384085, "answer_id": 52232270, "question_id": 52232195, "link": "https://stackoverflow.com/questions/52232195/type-level-conversion-between-period-length-and-frequency/52232270#52232270", "title": "Type-level conversion between period length and frequency", "body": "<p>Turns out <a href=\"https://hackage.haskell.org/package/ghc-typelits-extra\" rel=\"noreferrer\">the <code>ghc-typelits-extra</code> package</a>  has division which reduces; this allowed me to write</p>\n\n<pre><code>connect :: (ps ~ (1000000000000 `Div` rate)) =&gt; Rate rate -&gt; Period ps -&gt; ()\n\ntest = connect rate period\n</code></pre>\n\n<p>and it typechecks OK.</p>\n"}], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 52232270, "answer_count": 1, "score": 2, "last_activity_date": 1536384085, "creation_date": 1536383184, "question_id": 52232195, "link": "https://stackoverflow.com/questions/52232195/type-level-conversion-between-period-length-and-frequency", "title": "Type-level conversion between period length and frequency", "body": "<p>For ease of reading, I'd like to use clock frequency values as my type indices. However, I'll need to then check these for compatibility with clock domains, which represent their speed as period lengths.</p>\n\n<p>To make this a bit more concrete, suppose I have the following datatype which, for readability purposes, uses the clock rate (in Hz) in its type; in a real program, this could be e.g. VGA timings:</p>\n\n<pre><code>data Rate (rate :: Nat) = MkRate\n\nrate :: Rate 25175000\nrate = MkRate\n</code></pre>\n\n<p>However, I need to use it together with types that represent the clock period (in picoseconds); in a real CLaSH program, that would be the clock domain itself.</p>\n\n<pre><code>data Period (ps :: Nat) = MkPeriod\n\nperiod :: Period 39721\nperiod = MkPeriod\n</code></pre>\n\n<p>And now the problems start, since one period at 25.175 MHz is not an integer number of picoseconds. First, let's try using multiplication:</p>\n\n<pre><code>connect1 :: ((rate * ps) ~ 1000000000000) =&gt; Rate rate -&gt; Period ps -&gt; ()\nconnect1 _ _ = ()\n\ntest1 :: ()\ntest1 = connect1 rate period\n</code></pre>\n\n<p>This fails in the expected way:</p>\n\n<pre><code>../clash-sandbox/lib/src-clash/Cactus/Clash/VGA.hs:79:9: error:\n    \u2022 Couldn't match type \u2018999976175000\u2019 with \u20181000000000000\u2019\n        arising from a use of \u2018connect1\u2019\n    \u2022 In the expression: connect1 rate period\n      In an equation for \u2018test1\u2019: test1 = connect1 rate period\n   |\n79 | test1 = connect1 rate period\n   |         ^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Another thing we could try is type-level division:</p>\n\n<pre><code>connect2 :: (ps ~ (1000000000000 `div` rate)) =&gt; Rate rate -&gt; Period ps -&gt; ()\nconnect2 _ _ = ()\n\ntest2 :: ()\ntest2 = connect2 rate period\n</code></pre>\n\n<p>but that doesn't seem to reduce:</p>\n\n<pre><code>../clash-sandbox/lib/src-clash/Cactus/Clash/VGA.hs:85:9: error:\n    \u2022 Couldn't match type \u201839721\u2019 with \u2018div0 1000000000000 25175000\u2019\n        arising from a use of \u2018connect2\u2019\n    \u2022 In the expression: connect2 rate period\n      In an equation for \u2018test2\u2019: test2 = connect2 rate period\n</code></pre>\n"}, {"tags": ["macos", "haskell", "haskell-snap-framework"], "answers": [{"comments": [{"owner": {"reputation": 1141, "user_id": 1367497, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1ab83696683e53a9940cd2a8c480894?s=128&d=identicon&r=PG", "display_name": "peeyush singh", "link": "https://stackoverflow.com/users/1367497/peeyush-singh"}, "edited": false, "score": 0, "creation_date": 1536388797, "post_id": 52232231, "comment_id": 91414600, "body": "I have already tried the options given in the link, also have created a .bash_profile file with the path in my etc directory, but it still does not work. As I mentioned I cannot see the binaries in the ~/.cabal/bin path."}], "tags": [], "owner": {"reputation": 7154, "user_id": 527460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0cece5abd2f9ad9056f5ac3830ac0bfe?s=128&d=identicon&r=PG", "display_name": "mightybyte", "link": "https://stackoverflow.com/users/527460/mightybyte"}, "is_accepted": false, "score": 1, "last_activity_date": 1536383689, "creation_date": 1536383689, "answer_id": 52232231, "question_id": 52232040, "link": "https://stackoverflow.com/questions/52232040/where-is-snap-web-framework-haskell-on-mac-osx-installed/52232231#52232231", "title": "Where is snap web framework (Haskell) on Mac OSX installed", "body": "<p>It puts binaries in <code>~/.cabal/bin</code>.  As <a href=\"http://snapframework.com/faq#why-cant-i-install-snap\" rel=\"nofollow noreferrer\">mentioned here</a>, make sure you have that at the beginning of your PATH.</p>\n"}, {"tags": [], "owner": {"reputation": 1141, "user_id": 1367497, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1ab83696683e53a9940cd2a8c480894?s=128&d=identicon&r=PG", "display_name": "peeyush singh", "link": "https://stackoverflow.com/users/1367497/peeyush-singh"}, "is_accepted": true, "score": 0, "last_activity_date": 1536390192, "creation_date": 1536390192, "answer_id": 52232859, "question_id": 52232040, "link": "https://stackoverflow.com/questions/52232040/where-is-snap-web-framework-haskell-on-mac-osx-installed/52232859#52232859", "title": "Where is snap web framework (Haskell) on Mac OSX installed", "body": "<p>I was able to my snap installed at the location: /users/admin/library/haskell/bin</p>\n\n<p>I am a new user of Mac and was confused as I was trying to find snap in /library/haskell/bin, where it was not present. On using the find command: <code>find / -name \"*snap*\"</code> I was able to find the correct path. At least am able to do now use snap, by referring it using the complete path. Still trying to figure out the correct file to put the path in though.</p>\n"}], "owner": {"reputation": 1141, "user_id": 1367497, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1ab83696683e53a9940cd2a8c480894?s=128&d=identicon&r=PG", "display_name": "peeyush singh", "link": "https://stackoverflow.com/users/1367497/peeyush-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 52232859, "answer_count": 2, "score": -1, "last_activity_date": 1536390192, "creation_date": 1536381219, "question_id": 52232040, "link": "https://stackoverflow.com/questions/52232040/where-is-snap-web-framework-haskell-on-mac-osx-installed", "title": "Where is snap web framework (Haskell) on Mac OSX installed", "body": "<p>I am trying to install snap on my MAC OSX, the <code>cabal install snap snap-templates</code> command worked, but after that when I try <code>snap init</code>  I get the error that snap command does not exist.</p>\n\n<p>I have already checked the question:  <a href=\"https://stackoverflow.com/questions/11748148/snap-web-framework-and-osx-path\">Snap web framework and OSX Path</a> and it does not help me. </p>\n\n<p>I checked the Haskell/bin and .cabal/bin path and cannot see any snap file there. So where is the file installed?</p>\n"}, {"tags": ["haskell", "type-level-computation", "singleton-type", "clash"], "comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 1, "creation_date": 1536416842, "post_id": 52231780, "comment_id": 91420979, "body": "Do you have a self-contained minimal example that generates the exception?  Otherwise, it&#39;s hard to know if a potential solution will be any better than what you&#39;ve already tried."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1536463083, "post_id": 52231780, "comment_id": 91430697, "body": "@K.A.Buhr: I don&#39;t have a minimal example yet; the real-life self-contained example would be the one at <a href=\"https://github.com/gergoerdi/chip8-clash\" rel=\"nofollow noreferrer\">github.com/gergoerdi/chip8-clash</a>. However, I think there is something fundamentally broken about the <code>Clock</code> argument you can access via <code>hideClock</code>: <a href=\"https://github.com/clash-lang/clash-compiler/issues/348#issuecomment-419611322\" rel=\"nofollow noreferrer\">github.com/clash-lang/clash-compiler/issues/&hellip;</a>"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1536672233, "post_id": 52231780, "comment_id": 91501724, "body": "@K.A.Buhr I&#39;ve edited my question to contain a minimal example."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 1, "last_activity_date": 1537651813, "creation_date": 1537651813, "answer_id": 52461048, "question_id": 52231780, "link": "https://stackoverflow.com/questions/52231780/term-level-access-to-clock-rate/52461048#52461048", "title": "Term-level access to clock rate", "body": "<p>It looks like this has been acknowledged by the Clash primary developer Christiaan Baaij as a Clash compiler bug in <a href=\"https://github.com/clash-lang/clash-compiler/issues/348#issuecomment-419611322\" rel=\"nofollow noreferrer\">Issue #348</a>.  To quote from his comment in that issue report:</p>\n\n<blockquote>\n  <p>So the issue is that the Core we're getting is pattern-matching on something of type <code>Integer</code> and exposing the internals of its representation; something the compiler obviously doesn't handle. I'll create a work-around/hack to always pick the branch where the <code>Integer</code> fits inside the [-2^63 .. 2^63-1] range, since Clash currently \"erroneously\" translates <code>Integer</code> to 64-bit numbers anyways.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 0, "last_activity_date": 1572348306, "creation_date": 1572348306, "answer_id": 58606523, "question_id": 52231780, "link": "https://stackoverflow.com/questions/52231780/term-level-access-to-clock-rate/58606523#58606523", "title": "Term-level access to clock rate", "body": "<p>With Clash 1.0.0, this can be done without the creeping <code>KnownNat</code> constraints OR without importing any <code>Internal</code> module. The trick is to use <code>knownDomain</code> to get the <code>SDomainConfiguration</code> for a given clock domain, which will contain an <code>SNat period</code> for the length of a single clock cycle (in picoseconds). By pattern matching on the <code>SNat</code> constructor, the <code>KnownNat</code> witness is brought in scope.</p>\n\n<pre><code>clkPeriod :: forall dom. (KnownDomain dom) =&gt; Clock dom -&gt; Integer\nclkPeriod clk = case knownDomain @dom of\n    SDomainConfiguration _ rate@SNat{} _ _ _ _ -&gt; natVal rate\n\nclkRate :: (KnownDomain dom) =&gt; Clock dom -&gt; Integer\nclkRate clk = 1_000_000_000_000 `div` clkPeriod clk\n</code></pre>\n\n<p>Here's the updated toplevel definition:</p>\n\n<pre><code>{-# LANGUAGE NumericUnderscores #-}\nmodule Test where\n\nimport Clash.Prelude hiding (clkPeriod)\nimport Data.Word\n\ncreateDomain vSystem{vName=\"Dom25\", vPeriod = hzToPeriod 25_000_000}\n\ntopEntity\n    :: Clock Dom25\n    -&gt; Reset Dom25\n    -&gt; Enable Dom25\n    -&gt; Signal Dom25 Bit\ntopEntity = exposeClockResetEnable board\n  where\n    board = boolToBit &lt;$&gt; r\n\n    r = regEn False (counter .==. 0) (not &lt;$&gt; r)\n    counter = register clkrt $ mux (counter .==. 0) (pure clkrt) (pred &lt;$&gt; counter)\n    clkrt = fromInteger @Word32 $ hideClock clkRate\n</code></pre>\n\n<p>I've tested that this works with synthesis, and the division to convert period length to clock rate is done at compile time.</p>\n"}], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 58606523, "answer_count": 2, "score": 3, "last_activity_date": 1572348306, "creation_date": 1536378169, "last_edit_date": 1536672207, "question_id": 52231780, "link": "https://stackoverflow.com/questions/52231780/term-level-access-to-clock-rate", "title": "Term-level access to clock rate", "body": "<p>I'd like to access the clock rate (in Hz) as a term-level value, so that I can use it in counters.</p>\n\n<p>One way I've been able to come up with so far involves unpacking the type-level <code>Dom</code>ain into its clock period (in ps), and then converting it into a clock rate. However, this requires an extra <code>KnownNat ps</code> constraint that will then infest everything that tries to use it, all the way up to <code>topLevel</code>:</p>\n\n<pre><code>clkPeriod :: forall dom gated name ps. (dom ~ Dom name ps, KnownNat ps) =&gt; Clock dom gated -&gt; Integer\nclkPeriod clk = natVal (Proxy :: Proxy ps)\n\nclkRate :: (dom ~ Dom name ps, KnownNat ps) =&gt; Clock dom gated -&gt; Integer\nclkRate clk = 10^12 `div` clkPeriod clk\n</code></pre>\n\n<p>Another way, that avoids introducing the extra <code>KnownNat</code> constraint, is to import <code>Clash.Signal.Internal</code> and pattern-match on the <code>Clock</code>, since it contains an <code>SNat</code> witness of the period:</p>\n\n<pre><code>import Clash.Signal.Internal (Clock(..))\n\nclkPeriod :: Clock dom gated -&gt; Integer\nclkPeriod (Clock _ period) = snatToInteger period\nclkPeriod (GatedClock _ period _) = snatToInteger period\n\nclkRate :: Clock dom gated -&gt; Integer\nclkRate clk = 10^12 `div` clkPeriod clk\n</code></pre>\n\n<p>but this crashes the synthesizer\n(guess I shouldn't be importing <code>Clash.Signal.Internal</code>):</p>\n\n<pre><code>*** Exception: Clash.Rewrite.Util(566): \nCan't create selector (\"Clash.Normalize.Transformations(1136):doPatBndr\",1,0) for:\n($dKnownNat23000 :: GHC.Natural.Natural)\n\nAdditional info: TyCon has no DataCons: \nName {nameSort = User, nameOcc = GHC.Natural.Natural3674937295934324782, nameLoc = UnhelpfulSpan \"&lt;no location info&gt;\"} GHC.Natural.Natural3674937295934324782\n</code></pre>\n\n<p>Here is a full module exhibiting this problem (I tried synthesizing it with <code>:vhdl</code> to get the above error):</p>\n\n<pre><code>module Test where\n\nimport Clash.Prelude hiding (clkPeriod)\nimport Data.Word\nimport Clash.Signal.Internal (Clock(..))\n\ntype FromHz rate = 1000000000000 `Div` rate\ntype Dom25 = Dom \"CLK_25MHZ\" (FromHz 25175000)\n\ntopEntity\n    :: Clock Dom25 Source\n    -&gt; Reset Dom25 Asynchronous\n    -&gt; Signal Dom25 Bit\ntopEntity = exposeClockReset board\n  where\n    board = boolToBit &lt;$&gt; r\n\n    r = regEn False (counter .==. 0) (not &lt;$&gt; r)\n    counter = register clkrt $ mux (counter .==. 0) (pure clkrt) (pred &lt;$&gt; counter)\n    clkrt = fromIntegral $ hideClock clkRate\n\nclkPeriod :: Clock dom gated -&gt; Integer\nclkPeriod (Clock _ period) = snatToInteger period\nclkPeriod (GatedClock _ period _) = snatToInteger period\n\nclkRate :: Clock dom gated -&gt; Integer\nclkRate clk = 10^12 `div` clkPeriod clk\n</code></pre>\n\n<p>My question is, is there a way to reify <code>clkRate</code> in the term level without introducing any extra <code>KnownNat</code> constraints, or importing any <code>Internal</code> modules?</p>\n"}, {"tags": ["haskell", "encoding", "bytestring"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 6, "creation_date": 1536349493, "post_id": 52228705, "comment_id": 91407104, "body": "You don&#39;t normally need <code>Data.ByteString.Char8</code> at all. You want <code>Data.Text</code> when dealing with text and <code>Data.ByteString</code> when dealing with binary data of some sort or another. Also, converting <code>String</code> to <code>ByteString</code> &quot;for efficient writing&quot; doesn&#39;t really make a whole lot of sense; Just keep your data in a <code>ByteString</code> in the first place if that&#39;s a reasonable representation."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1536355561, "post_id": 52228705, "comment_id": 91409246, "body": "There are two <code>ByteString</code> types, lazy and strict. They store raw bytes, not characters. The <code>Char8</code> variants are not separate types; they&#39;re just modules that expose a slightly different interface (effectively treating <code>ByteString</code> as Latin-1 text). <code>String</code> and <code>Text</code> store Unicode characters (i.e. text)."}], "answers": [{"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1536391849, "post_id": 52230126, "comment_id": 91415166, "body": "But how do you convert from<code>ByteString</code> to <code>Text</code> and vice versa ?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1536414247, "post_id": 52230126, "comment_id": 91420295, "body": "I&#39;ve updated the end of the <code>Reading and Writing Files</code> section to make it clearer.  The answer is that the conversion functions used depend on the encoding, but <i>IF</i> the <code>ByteString</code> is a UTF-8 encoded version of the text, then <code>encodeUtf8</code> and <code>decodeUtf8</code> from <code>Data.Text.Encoding</code> are the conversion functions you want."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 5, "last_activity_date": 1536414174, "last_edit_date": 1536414174, "creation_date": 1536357778, "answer_id": 52230126, "question_id": 52228705, "link": "https://stackoverflow.com/questions/52228705/encoding-and-efficient-io-in-haskell/52230126#52230126", "title": "Encoding and efficient IO in Haskell", "body": "<p>Here's a shot at a roadmap.</p>\n\n<h2>Strings and Text</h2>\n\n<p>As you are probably aware, the Haskell <code>String</code> type is just a type synonym for <code>[Char]</code>, where <code>Char</code> is a data type that can represent a single Unicode code point.  This makes <code>String</code> the perfect data type to represent textual data, except for the minor issue that -- as a linked list of boxed <code>Char</code> values -- it has the potential to be extremely inefficient.</p>\n\n<p>The <code>Text</code> data type from the <code>text</code> package addresses this issue.  <code>Text</code> is also, like <code>String</code>, a representation of a list of <code>Char</code> values, but instead of using an actual Haskell list, it uses a time and space-efficient representation.  It should be your go-to replacement for <code>String</code> whenever you need to work efficiently with textual (Unicode) data.</p>\n\n<p>Like many other data types in the standard Haskell libraries, it comes in lazy and strict variants.  Both variants have the same name <code>Text</code>, but they are contained in separate modules, so you might do:</p>\n\n<pre><code>import qualified Data.Text as TS\nimport qualified Data.Text.Lazy as TL\n</code></pre>\n\n<p>if you needed to use both <code>TS.Text</code> and <code>TL.Text</code> variants in the same program.</p>\n\n<p>The exact difference between variants is described in the <a href=\"https://hackage.haskell.org/package/text-1.2.3.0/docs/Data-Text.html\" rel=\"nofollow noreferrer\">documentation for Data.Text</a>.  In a nutshell, you should default to using the strict version.  You only use the lazy version in two cases.  First, if you're planning to work on a large <code>Text</code> value a little bit at a time, treating it more like a text \"stream\" than a \"string\", then the lazy version is a good choice.  (For example, a program to read a huge CSV file of numbers might read the file as a long lazy <code>Text</code> stream and store the results in an efficient numeric type like a <code>Vector</code> of unboxed <code>Double</code> values to avoid keeping the whole input text in memory.)  Second, if you're building a large <code>Text</code> string up from lots of little pieces, then you don't want to use the strict versions, because their immutability means they need to be copied whenever you add something.  Instead, you'd want to use the lazy variant with functions from <code>Data.Text.Lazy.Builder</code>.</p>\n\n<h2>ByteStrings</h2>\n\n<p>The <code>ByteString</code> data type from the <code>bytestring</code> package, on the other hand, is an efficient representation of a list of bytes.  Just like <code>Text</code> is an efficient version of <code>[Char]</code>, you should think of <code>ByteString</code> as an efficient version of <code>[Word8]</code>, where <code>Word8</code> is the Haskell type representing a single unsigned byte of data with value 0-255.  Equivalently, you can think of a <code>ByteString</code> as representing a chunk of memory or a chunk of data to be read from or written to a file, precisely as-is byte for byte.  It also comes in lazy and strict flavors:</p>\n\n<pre><code>import qualified Data.ByteString as BS\nimport qualified Data.ByteString.Lazy as BL\n</code></pre>\n\n<p>and the considerations for using the variants are similar to those for <code>Text</code>.</p>\n\n<h2>Reading and Writing to Files</h2>\n\n<p>In a Haskell program, it's usual to represent Unicode strings internally as either <code>String</code> or <code>Text</code> values.  However, to read them in from or write them out to files, they need to be encoded into and decoded from sequences of bytes.</p>\n\n<p>The simplest way of dealing with this is to use Haskell functions that handle the encoding and decoding automatically.  As you are probably aware, there are already two functions in the <code>Prelude</code> that read and write strings directly:</p>\n\n<pre><code>readFile :: FilePath -&gt; IO String\nwriteFile :: FilePath -&gt; String -&gt; IO ()\n</code></pre>\n\n<p>In addition, there are <code>readFile</code> and <code>writeFile</code> functions in <code>text</code> that do this.  You can find versions in both <code>Data.Text.IO</code> and <code>Data.Text.Lazy.IO</code>.  They appear to have the same signatures, but one is operating on the strict <code>Text</code> type and the other is operating on the lazy <code>Text</code> type:</p>\n\n<pre><code>readFile :: FilePath -&gt; IO Text\nwriteFile :: FilePath -&gt; Text -&gt; IO ()\n</code></pre>\n\n<p>You can tell these functions are doing the encoding and decoding automatically because they return and accept <code>Text</code> values, not <code>ByteString</code> values.  The default encoding used will depend on the operating system and its configuration.  On a typical modern Linux distribution, it'll be UTF-8.</p>\n\n<p>Alternatively, you can read or write the raw bytes from the file using functions from the <code>bytestring</code> package (again, either lazy or strict versions, depending on the module):</p>\n\n<pre><code>readFile :: FilePath -&gt; IO ByteString\nwriteFile :: FilePath -&gt; ByteString -&gt; IO ()\n</code></pre>\n\n<p>These have the same names as the <code>text</code> versions, but you can see they are dealing with raw bytes because they return and accept <code>ByteString</code> arguments.  In this case, if you want to use these <code>ByteString</code>s as text data, you'll need to decode or encode them yourself.  If the <code>ByteString</code> represents a UTF-8 encoded version of the text for example, then these functions from <code>Data.Text.Encoding</code> (for strict versions) or <code>Data.Text.Lazy.Encoding</code> (for lazy versions) are what you're looking for:</p>\n\n<pre><code>decodeUtf8 :: ByteString -&gt; Text\nencodeUtf8 :: Text -&gt; ByteString\n</code></pre>\n\n<h2>The Char8 Modules</h2>\n\n<p>Now, the modules in <code>Data.ByteString.Char8</code> and <code>Data.ByteString.Lazy.Char8</code> are a special case.  When plain ASCII text has been encoded using one of several \"ASCII-preserving\" encoding schemes (including ASCII itself, Latin-1 and other Latin-x encodings, and UTF-8), it turns out that the encoded <code>ByteString</code> is just a simple one-byte-per-character encoding of Unicode code points 0 to 127.  Slightly more generally, when text has been encoded in Latin-1, then the encoded <code>ByteString</code> is just a simple one-byte-per-character encoding of Unicode code points 0 to 255.  In these cases, and in these cases only, the functions in these modules can be safely used to bypass the explicit encoding and decoding steps and just treat the byte string as ASCII and/or Latin-1 text directly by automaticaly converting single bytes to unicode <code>Char</code> values and back.</p>\n\n<p>Because these functions only work in that special case, you should generally avoid using them except in specialized applications.</p>\n\n<p>Also, as was mentioned in a comment, the <code>ByteString</code> variants in these <code>Char8</code> modules are not any different than the plain strict and lazy <code>ByteString</code> variants; the are just treated as if they are strings of <code>Char</code> values instead of <code>Word8</code> values by the <em>functions</em> in those modules -- the data types are the same, just the function interface is different.</p>\n\n<h2>General Strategy</h2>\n\n<p>So, if you're working with plain text and your operating system's default coding, just use the strict <code>Text</code> data type from <code>Data.Text</code> and the (highly efficient) IO functions from <code>Data.Text.IO</code>.  You can use the lazy variants for stream processing or building big strings from tiny pieces, and you can use <code>Data.Text.Read</code> for some simple parsing.</p>\n\n<p>You should be able to avoid using <code>String</code> at all in most situations, but if you find you need to convert back and forth, then these conversion functions in <code>Data.Text</code> (or <code>Data.Text.Lazy</code>) will be useful:</p>\n\n<pre><code>pack :: String -&gt; Text\nunpack :: Text -&gt; String\n</code></pre>\n\n<p>If you need more control over the encoding, you <em>still</em> want to use <code>Text</code> throughout your program, except at the \"edges\" where you're reading or writing files.  At those edges, use the I/O functions from <code>Data.ByteString</code> (or <code>Data.ByteString.Lazy</code>), and the encoding/decoding functions from <code>Data.Text.Encoding</code> or <code>Data.Text.Lazy.Encoding</code>.</p>\n\n<p>If you find you need to mix strict and lazy variants, note that <code>Data.Text.Lazy</code> contains:</p>\n\n<pre><code>toStrict :: TL.Text -&gt; TS.Text     -- convert lazy to strict\nfromStrict :: TS.Text -&gt; TL.Text   -- vice versa\n</code></pre>\n\n<p>and <code>Data.ByteString.Lazy</code> contains the corresponding functions for <code>ByteString</code> values:</p>\n\n<pre><code>toStrict :: BL.ByteString -&gt; BS.ByteString\nfromStrict :: BS.ByteString -&gt; BL.ByteString\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 3511511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f695d53cc3acd300a9e119b40c9d7ac?s=128&d=identicon&r=PG", "display_name": "user12457", "link": "https://stackoverflow.com/users/3511511/user12457"}, "is_accepted": false, "score": 3, "last_activity_date": 1536361100, "creation_date": 1536361100, "answer_id": 52230521, "question_id": 52228705, "link": "https://stackoverflow.com/questions/52228705/encoding-and-efficient-io-in-haskell/52230521#52230521", "title": "Encoding and efficient IO in Haskell", "body": "<p>It depends on the kind of data you're dealing with and how you plan to hand that data.</p>\n\n<p>If you're dealing with Unicode strings, use <code>Text</code> from Text package.</p>\n\n<p>If you don't need to read all data into memory at once, use the <code>Lazy</code> version of that module. Otherwise, the entire data will be loaded in a single data structure.</p>\n\n<p>When to use <code>Data.ByteString</code> or <code>Data.ByteString.Char8</code> depends on what you want that bytestring to represent: a sequence of bytes or sequence of 8-bit characters. A <code>ByteString</code> is a data structure you can use to store either a sequence of bytes, each of type: <code>Word8</code> or a sequence of 8-bit characters, each of type: <code>Char</code>. There is only one <code>ByteString</code> type. </p>\n\n<p>Because often we may deal with binary data mixed with character-based data, it would be convenient if we keep operations for bytes and characters separately in different modules; that way when we need to handle character based data, just use operations from the Char8 modules.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 1, "accepted_answer_id": 52230126, "answer_count": 2, "score": 0, "last_activity_date": 1536414174, "creation_date": 1536349203, "question_id": 52228705, "link": "https://stackoverflow.com/questions/52228705/encoding-and-efficient-io-in-haskell", "title": "Encoding and efficient IO in Haskell", "body": "<p>Hello i am a bit confused about all the Haskell modules needed for encoding data from <code>String</code> to <code>ByteString</code> for efficient writing.</p>\n\n<p>I do not understand how you convert a <code>Data.ByteString.Lazy</code> to a <code>Data.ByteString.Char8</code> and vice versa.</p>\n\n<p>What do i need to know ? Because i can't get all these possible combinations of usages ....\n<code>Data.ByteString</code>,<code>Data.ByteString.Lazy</code>,<code>Data.ByteString.Char8</code> , then there's <code>Data.Text</code>.....what do i need in order to write strings to files easily and efficiently and vice -versa? (with proper encoding)</p>\n\n<p><strong>P.S</strong> Currently reading Real World Haskell and i got pretty confused on all these modules.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1536342056, "creation_date": 1536342056, "answer_id": 52227296, "question_id": 52227157, "link": "https://stackoverflow.com/questions/52227157/how-is-assert-used/52227296#52227296", "title": "How is assert used?", "body": "<p>Think of <code>assert</code> as a conditional identity function. If the first argument is false, an exception is raised. Otherwise, the second argument is returned. An implementation might look something like</p>\n\n<pre><code>assert :: Bool -&gt; a -&gt; a\nassert True = id\nassert False = \\_ -&gt; error \"Assertion Failed\"  -- const (error \"Assertion Failed\")\n</code></pre>\n\n<p>(I'm not sure what example of its use to give that wouldn't effectively give away how to write <code>power</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1536344903, "post_id": 52227425, "comment_id": 91405249, "body": "If you don&#39;t want to modify the body of <code>power</code>, you can add the equation <code>power _ n | assert (n &gt;= 0) False = undefined</code> before it (this trick is due to Oleg: <a href=\"http://okmij.org/ftp/Haskell/#making-function-strict\" rel=\"nofollow noreferrer\">okmij.org/ftp/Haskell/#making-function-strict</a>)."}, {"owner": {"reputation": 161, "user_id": 7265671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e4d4bc138d72a1ee48c3b365dbd1b1?s=128&d=identicon&r=PG&f=1", "display_name": "HayashiEsme", "link": "https://stackoverflow.com/users/7265671/hayashiesme"}, "edited": false, "score": 0, "creation_date": 1536347927, "post_id": 52227425, "comment_id": 91406471, "body": "Yeah, I realise it might&#39;ve been difficult to explain this without that example, so thanks!"}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": true, "score": 11, "last_activity_date": 1536342660, "creation_date": 1536342660, "answer_id": 52227425, "question_id": 52227157, "link": "https://stackoverflow.com/questions/52227157/how-is-assert-used/52227425#52227425", "title": "How is assert used?", "body": "<p>The <code>assert</code> exported from that library (which I haven't used) is actually defined in <code>base</code> <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Control-Exception.html#v:assert\" rel=\"noreferrer\">here</a>. You <em>could</em> use it like this:</p>\n\n<pre><code>power :: Int -&gt; Int -&gt; Int\npower x n = assert (n &gt;= 0) $\n  if n == 0 then\n    1\n  else\n    x * power x (n - 1)\n</code></pre>\n\n<p>But this isn't really what the function is meant for. It would be better in the case above to either raise your own error with a friendly message, or (better yet), return a <code>Maybe Int</code>.</p>\n\n<p><code>assert</code> is intended for checking internal invariants in your functions, where a violation indicates a bug. It can be really useful to use assertions in tandem with tests (tests excercise invariants which are checked by internal <code>assert</code> calls). </p>\n\n<p>You have to make sure to compile either without optimizations or with <code>-fno-ignore-asserts</code> though, as assertions are optimized away when compiling with optimizations (another great feature of <code>assert</code>).</p>\n\n<p>I've taken to including the following <em>in the library code</em> in order to have a test that assertions are on in my testsuite (very important, and an issue I've run into before):</p>\n\n<pre><code>assertionCanary :: IO Bool\nassertionCanary = do\n    assertionsWorking &lt;- try $ assert False $ return ()\n    return $\n      case assertionsWorking of\n           Left (AssertionFailed _) -&gt; True\n           _                        -&gt; False\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 7265671, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42e4d4bc138d72a1ee48c3b365dbd1b1?s=128&d=identicon&r=PG&f=1", "display_name": "HayashiEsme", "link": "https://stackoverflow.com/users/7265671/hayashiesme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1557, "favorite_count": 0, "accepted_answer_id": 52227425, "answer_count": 2, "score": 4, "last_activity_date": 1536342660, "creation_date": 1536341310, "question_id": 52227157, "link": "https://stackoverflow.com/questions/52227157/how-is-assert-used", "title": "How is assert used?", "body": "<p>I'm having trouble understanding how to use the assert function (Control.Exception.Assert) </p>\n\n<p>I did read the documentation (<a href=\"http://hackage.haskell.org/package/assert-0.0.1.2/docs/Control-Exception-Assert.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/assert-0.0.1.2/docs/Control-Exception-Assert.html</a>) but I still don't seem to understand how it's used. The currying really doesn't help in this case because of how unexplicit it is. Examples and explanation of what it's for would be lovely.</p>\n\n<p>(For context, I am trying to figure out how to use assert in this code to make sure n is always non-negative) [No answers please, I'd like to figure it out on my own]</p>\n\n<pre><code>power :: Int -&gt; Int -&gt; Int\npower x n =\n  if n == 0 then\n    1\n  else\n    x * power x (n - 1)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 7, "last_activity_date": 1536341198, "creation_date": 1536341198, "answer_id": 52227140, "question_id": 52226765, "link": "https://stackoverflow.com/questions/52226765/haskell-illegal-deriving-item-generic/52227140#52227140", "title": "Haskell Illegal deriving item Generic", "body": "<p>You want to import <code>GHC.Generics</code> not <code>Data.Generics</code>.  What you have imported does have a type <code>Generic</code> but it isn't a class:</p>\n\n<pre><code>type Generic c = forall a. Data a =&gt; a -&gt; c a\n</code></pre>\n\n<p>Certainly that can't be part of a \"deriving\" clause.</p>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 0, "accepted_answer_id": 52227140, "answer_count": 1, "score": 2, "last_activity_date": 1536341198, "creation_date": 1536339327, "last_edit_date": 1536339704, "question_id": 52226765, "link": "https://stackoverflow.com/questions/52226765/haskell-illegal-deriving-item-generic", "title": "Haskell Illegal deriving item Generic", "body": "<pre><code>{-# LANGUAGE DataKinds         #-}\n{-# LANGUAGE DeriveGeneric     #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE TypeOperators     #-}\n\nimport qualified Data.ByteString.Lazy    as BL\nimport           Data.Csv                (DefaultOrdered, FromRecord,\n                                          ToNamedRecord, ToRecord)\nimport           Data.Generics\nimport           Data.Proxy\nimport qualified Data.Text               as T\nimport           Network.HTTP.Client     (newManager)\nimport           Network.HTTP.Client.TLS (tlsManagerSettings)\nimport           Servant.API\nimport           Servant.Client\nimport           Servant.CSV.Cassava\nimport           System.Environment\n\ndata Cata = Cata\n  {\n    csvDate       :: String,\n    csvOpen       :: String,\n    csvHigh       :: String,\n    csvLow        :: String,\n    csvClose      :: String,\n    csvVolume     :: String,\n    csvExDividend :: String,\n    csvSplitRatio :: String,\n    csvAdjOpen    :: String,\n    csvAdjHigh    :: String,\n    csvAdjLow     :: String,\n    csvAdjClose   :: String,\n    csvAdjVolume  :: String\n  } deriving (Show, Generic)\n\ninstance DefaultOrdered Cata\ninstance FromRecord Cata\ninstance ToNamedRecord Cata\ninstance ToRecord Cata\n</code></pre>\n\n<p>I compile the above code and get the following error: why?</p>\n\n<pre><code>$ stack ghc servantcsv.hs\n[1 of 1] Compiling Main             ( servantcsv.hs, servantcsv.o )\n\nservantcsv.hs:34:21: error:\n    \u2022 Illegal deriving item \u2018Generic\u2019\n    \u2022 In the data declaration for \u2018Cata\u2019\n   |\n34 |   } deriving (Show, Generic)\n   |                     ^^^^^^^\n</code></pre>\n\n<p>GHC Version: <code>ghc-8.4.3</code></p>\n"}, {"tags": ["haskell", "functional-programming", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 4219724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/PQgDC.png?s=128&g=1", "display_name": "&#216;ystein Kolsrud", "link": "https://stackoverflow.com/users/4219724/%c3%98ystein-kolsrud"}, "edited": false, "score": 0, "creation_date": 1536323417, "post_id": 52222272, "comment_id": 91393880, "body": "Yes, that&#39;s the approach I&#39;ve been using. But the Arbitrary class is a very convenient convenience :-) Especially as it gives out-of-the-box generators for standard container types like Maybe, tuples and lists. I was hoping there was some nice trick one could use to add the context to the Gen-monad or something. But I guess I&#39;ll continue on my current path."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 327, "user_id": 4219724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/PQgDC.png?s=128&g=1", "display_name": "&#216;ystein Kolsrud", "link": "https://stackoverflow.com/users/4219724/%c3%98ystein-kolsrud"}, "edited": false, "score": 0, "creation_date": 1536331129, "post_id": 52222272, "comment_id": 91398668, "body": "@&#216;ysteinKolsrud Well, you could use monad transformers: define <code>type MyGen = ReaderT MyConfig Gen</code> and then you can define a <code>MyArbitrary</code> class, and make any instance of <code>Arbitrary</code> an instance of <code>MyArbitrary</code> using <code>myArbitrary = lift arbitrary</code> as the implementation."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 2, "last_activity_date": 1536322185, "creation_date": 1536322185, "answer_id": 52222272, "question_id": 52221866, "link": "https://stackoverflow.com/questions/52221866/quickcheck-with-dynamic-element-sets/52222272#52222272", "title": "QuickCheck with Dynamic Element Sets", "body": "<p><code>Arbitrary</code> is really only a convenience when the generator does not require any context. If you need to parameterize your generators, you can define them as regular functions, and QuickCheck has combinators to use such explicit generators instead of <code>Arbitrary</code> instances.</p>\n\n<pre><code>genExpr :: [String] -&gt; Gen Expr\ngenExpr varNames =\n    oneof [ fmap Num arbitrary\n          , arbitraryBinOp\n          , fmap Var (elements varNames)\n          ]\n\nmain :: IO ()\nmain = do\n    args &lt;- getArgs\n    tests &lt;- generate $ vectorOf 10 (genExpr args)\n    {- do stuff -}\n    return ()\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 4219724, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/PQgDC.png?s=128&g=1", "display_name": "&#216;ystein Kolsrud", "link": "https://stackoverflow.com/users/4219724/%c3%98ystein-kolsrud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 52222272, "answer_count": 1, "score": 2, "last_activity_date": 1536322185, "creation_date": 1536320591, "question_id": 52221866, "link": "https://stackoverflow.com/questions/52221866/quickcheck-with-dynamic-element-sets", "title": "QuickCheck with Dynamic Element Sets", "body": "<p>Is there a way to control programmatically the set of values to use in an elements call within an arbitrary definition? I want to be able to generate an arbitrary variable reference as part of a random expression, but the set of variables identifiers to choose from should be configurable.</p>\n\n<p>As example, imagine the following data type:</p>\n\n<pre><code>data Expr = Num   Int\n          | Var   String\n          | BinOp Op Expr Expr\n\ndata Op = Add | Sub | Mul | Div deriving (Eq, Ord, Enum)\n</code></pre>\n\n<p>And then I want to define an arbitrary instance for this type that would look something like this:</p>\n\n<pre><code>instance Arbitrary Op where\n  arbitrary = elements [Add .. ]\n\ninstance Arbitrary Expr where\n  arbitrary = oneof [ fmap Num arbitrary\n                    , arbitraryBinOp\n                    , fmap Var (elements varNames)\n                    ]\n\narbitraryBinOp = do (op, e0, e1) &lt;- arbitrary\n                    return (BinOp op e0 e1)\n</code></pre>\n\n<p>Now the tricky thing is the \"varNames\" part. Conceptually I would like to be able to do something like this:</p>\n\n<pre><code>do args  &lt;- getArgs\n   tests &lt;- generate $ vectorOf 10 ((arbitrary args)::Gen Expr)\n</code></pre>\n\n<p>But obviously I can't propagate that args-vector down through the arbitrary calls as \"arbitrary\" does not take such an argument...</p>\n"}, {"tags": ["haskell", "applicative", "category-theory"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536316724, "post_id": 52220060, "comment_id": 91389957, "body": "Wrong nlab page. See this <a href=\"https://ncatlab.org/nlab/show/monoidal+functor\" rel=\"nofollow noreferrer\">ncatlab.org/nlab/show/monoidal+functor</a>"}, {"owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 0, "creation_date": 1573663341, "post_id": 52220060, "comment_id": 103957591, "body": "&quot;Lax&quot; as in &quot;Relax&quot; over the constraint of having isomorphic mempty &amp; mappend."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1536320193, "post_id": 52220602, "comment_id": 91391967, "body": "I&#39;m not sure I see how <code>unit</code> and <code>mult</code>, given here, could be isomorphisms, as it&#39;s not clear how <code>unit</code> and <code>mult</code> can compose, let alone have <code>unit . mult == mult . unit == id</code>."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 8, "creation_date": 1536322722, "post_id": 52220602, "comment_id": 91393463, "body": "I don&#39;t mean that they are a pair of mutual inverses: I mean that they each have inverses."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 23, "last_activity_date": 1536316184, "creation_date": 1536316184, "answer_id": 52220602, "question_id": 52220060, "link": "https://stackoverflow.com/questions/52220060/what-does-lax-mean-in-lax-monoidal-functor/52220602#52220602", "title": "What does &quot;lax&quot; mean in &quot;lax monoidal functor&quot;?", "body": "<p>Let's switch to the monoidal view of <code>Applicative</code>:</p>\n\n<pre><code>unit ::     ()     -&gt; f   ()\nmult :: (f s, f t) -&gt; f (s, t)\n\npure :: x -&gt; f x\npure x = fmap (const x) (unit ())\n(&lt;*&gt;) :: f (s -&gt; t) -&gt; f s -&gt; f t\nff &lt;*&gt; fs = fmap (uncurry ($)) (mult (ff, fs))\n</code></pre>\n\n<p>For a <em>strict</em> monoidal functor, <code>unit</code> and <code>mult</code> must be <em>isomorphisms</em>. The impact of \"lax\" is to drop that requirement.</p>\n\n<p>E.g., (up to the usual naivete) <code>(-&gt;) a</code> is strict-monoidal, but <code>[]</code> is only lax-monoidal.</p>\n"}], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 2, "accepted_answer_id": 52220602, "answer_count": 1, "score": 19, "last_activity_date": 1536441796, "creation_date": 1536314241, "last_edit_date": 1536441796, "question_id": 52220060, "link": "https://stackoverflow.com/questions/52220060/what-does-lax-mean-in-lax-monoidal-functor", "title": "What does &quot;lax&quot; mean in &quot;lax monoidal functor&quot;?", "body": "<p>I know that the <code>Applicative</code> class is described in category theory as a \"lax monoidal functor\" but I've never heard the term \"lax\" before, and <a href=\"https://ncatlab.org/nlab/show/lax+functor\" rel=\"noreferrer\">the <code>nlab</code> page on lax functor</a> a bunch of stuff I don't recognize at all, re: bicategories and things that I didn't know we cared about in Haskell.  If it is actually about bicategories, can someone give me a plebian view of what that means?  Otherwise, what is \"lax\" doing in this name?</p>\n"}, {"tags": ["haskell", "typeclass", "functor", "applicative", "category-theory"], "comments": [{"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 10, "creation_date": 1536313374, "post_id": 52219614, "comment_id": 91387957, "body": "I&#39;m sad to say that the thing that you say you are not prepared to accept is the truth. The objects of the &quot;category&quot; are <i>types</i>, not values in those types; the arrows are functions between those types. So the action on objects maps types to types, and the action on morphisms maps functions to functions."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1536313566, "post_id": 52219614, "comment_id": 91388080, "body": "@pigworker Why then we require the definition of <code>fmap</code>, and not a <i>(hypothetical)</i> type level function,  such as <code>type F (a -&gt; b) = F a -&gt; F b</code>?"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1536314128, "post_id": 52219614, "comment_id": 91388470, "body": "The constraint <code>Functor f</code> indicates that <code>f</code> is an action on objects (a function from types to types) which can be extended to a functor by giving a suitable map on arrows (taking and function in some <code>(a -&gt; b)</code> to a function in <code>(f a -&gt; f b)</code>. There is no need for <i>another</i> function from types to types to complete the requirements of the definition. If <code>x</code> is a type, then so is <code>f x</code>, and it is because <code>f</code> is the action on objects that the type of <code>fmap</code> uses <code>f</code>."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1536314486, "post_id": 52219614, "comment_id": 91388707, "body": "@pigworker So, what you are saying is that, in <b>Hask</b>, objects are <i>denotations for types</i> <i>(say, <code>A :: Type</code> and <code>B :: Type</code>)</i>, while arrows are <i>terms</i>, particularly functions that map <i>terms</i> of type <code>A</code> to <i>terms</i> of type <code>B</code>. Right? Then, the object function for a functor would operate on type level, while the arrow function \u2014 on term level."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1536315066, "post_id": 52219614, "comment_id": 91389069, "body": "Yes. And I wouldn&#39;t introduce the indirection of &quot;denotations for&quot;. The objects are things that inhabit <code>Type</code>, and as <code>A -&gt; B :: Type</code> when <code>A :: Type</code> and <code>B :: Type</code>, it is reasonable to take the values in <code>A -&gt; B</code> as arrows (given that we have identity and composition for functions). It is also reasonable to play the same game one level up, taking the objects to be kinds and the arrows to be type-level functions. There are many categories in Haskell, not just types-and-functions-on-their-values."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1536316323, "post_id": 52219614, "comment_id": 91389731, "body": "@pigworker Could there among these many categories be one that has sets of values as objects, and functions that connect such sets as arrows, where some polymorphic functions <code>omap :: a -&gt; b</code> <i>(on a</i> set of <i>sets of values)</i> and <code>fmap :: (a -&gt; a&#39;) -&gt; (b -&gt; b&#39;)</code> <i>(on a set of sets as well)</i> could be defined and constitute an endofunctor?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536318728, "post_id": 52219614, "comment_id": 91391081, "body": "The type constructor <i>is</i> the &quot;type-level function&quot; you are looking for."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536318940, "post_id": 52219614, "comment_id": 91391209, "body": "@n.m. I am unhappy with that answer. Are you certain it is the only answer possible?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536319047, "post_id": 52219614, "comment_id": 91391267, "body": "&quot;or in the common knowledge spread around the Haskell community.&quot; Of the two possibilities you have entertained, this would be the rather less likely one."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536319275, "post_id": 52219614, "comment_id": 91391391, "body": "@n.m. If that is your answer to my question, then it would appear to me as though you were being dogmatic."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536319430, "post_id": 52219614, "comment_id": 91391480, "body": "There are many possible answers, up to and including &quot;Hask is <a href=\"http://math.andrej.com/2016/08/06/hask-is-not-a-category/\" rel=\"nofollow noreferrer\">not a category</a>&quot;. But in categories morally equivalent to Hask, the type-level function is absolutely definitely 100% sure the copy constructor, by definition."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536319666, "post_id": 52219614, "comment_id": 91391634, "body": "&quot;it would appear to me as though you were being dogmatic&quot;.  Either that, or you are being hopelessly confused. Must be either one or the other, for sure."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536320471, "post_id": 52219614, "comment_id": 91392121, "body": "@n.m. I think my confusions concerning objects of <b>Hask</b> were happily waved away by pigworker, even in the comments above, to which I made an edit to my question. And then I am still unhappy, both with the answers that are striking me as lacking, and with what seems to be an imposition of a dogma via appeals to authority and to my simple-mindedness. You are talking of me and of the Haskell community, with some irony as I would perceive, but you are not adding to my understanding as relates to the question; I do not see a logical argument in your comments."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536322440, "post_id": 52219614, "comment_id": 91393265, "body": "I&#39;m not quite sure what exactly you are uncertain about, but it must be something pretty fundamental. I will post some sentences in the following comments that are absolute 100% self-evident truths. If you doubt any one them one tiny little bit, you should ask separate questions about them until either you or the rest of the world gain enlightenment."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1536322758, "post_id": 52219614, "comment_id": 91393485, "body": "(1) A category consists of <i>objects</i> and <i>arrows</i>, with some laws that govern their composition. (2) The category <b>Hask</b> has Haskell <i>types</i> as objects, and Haskell <i>functions</i> as arrows. (3) A type constructor of kind <code>*-&gt;*</code> is a function that sends Hask objects to Hask objects. (Not every function that sends Hask objects to Hask objects can be expressed as a Haskell type constructor). (4) A functor in Hask is a function that sends Hask objects to Hask objects, together with a function that sends Hask arrows to Hask arrows, with some laws that govern their interaction."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536323003, "post_id": 52219614, "comment_id": 91393644, "body": "(5) Since Haskell type constructors are functions that send Haskell types to Haskell types, that is, Hask objects to Hask objects, they are good candidates to serve as the object half of Hask functors. (6) The arrow half can be realised as an ordinary Haskell higher-order polymorphic function."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536323706, "post_id": 52219614, "comment_id": 91394062, "body": "@n.m. @n.m. Thank you, this explanation is quite vivid. My point is that, perhaps, some other choice of category may offer a way to think of another definition of functor, for which the definition of arrow function coincides with the usual <code>fmap</code>, but the definition of object function involves terms, rather than types. You are right in that another question should be asked about that, since this one went in a very unfortunate direction right from the start and, apparently, no edit could make the observer realize what I am actually trying to understand."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536324100, "post_id": 52219614, "comment_id": 91394298, "body": "There are many categories related to Haskell that we can talk about. Hask is one of them. The above sentences apply to Hask only. The categorical type-classes like Functor are thought to be working in Hask only. I&#39;m not quite sure what you mean by &quot;the definition of object function involves terms, rather than types&quot;. Where do you get this definition from? The object function, in any category, involves <b>objects</b>. Terms are not a basic notion of the category theory."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536324794, "post_id": 52219614, "comment_id": 91394755, "body": "@n.m. Yes, to get such a definition, we need first to define a category such that objects in it are given via Haskell terms, rather than types. My confusion was that I thought in <b>Hask</b> sets of terms are objects, while it is actually <i>types</i> as observed in type annotations. Happily, <i>pigworker</i> explained the actual situation to me, and now my question becomes: why exactly <b>Hask</b> was chosen as <i>the</i> de facto Haskell category and what happens if we consider functors in some other category that Haskell may represent. Perhaps <code>pure</code> would be an <code>omap</code> of such functors."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1536325239, "post_id": 52219614, "comment_id": 91395054, "body": "We are not doing category theory in Haskell for the sake of doing category theory. We are doing it because <i>the category of types and functions is an extremely useful framework to reason about programming</i>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536325390, "post_id": 52219614, "comment_id": 91395136, "body": "<i>in Hask sets of terms are objects</i> This is not far from the truth, as types can be seen as sets of values that inhabit them (probably not terms though). That is. <code>Integer</code> is the set of all integers etc."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1536327662, "post_id": 52219614, "comment_id": 91396646, "body": "(1) As far as <b>Hask</b> is concerned, <code>pure</code> amounts to a natural transformation from the identity functor to some other <b>Hask</b> (endo)functor. (2) Values not being a primitive notion in this setting (cf. n.m.&#39;s comments) is not really an obstacle. One way of handling them in terms of <b>Hask</b> objects and morphisms alone is working with functions from the terminal object, <code>()</code> (e.g. each <code>() -&gt; Integer</code> function amounts to an <code>Integer</code> value)."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536328130, "post_id": 52219614, "comment_id": 91396951, "body": "@n.m. Yes, and now if there is a set of values <code>A</code> and a set of values <code>F A</code>, is it not natural to imagine there to be a function <code>omap :: A -&gt; F A</code>? Clearly a type level function, such as <code>Maybe</code>, does not have anything to do with <i>sets of values</i>. Now I hope you can see exactly in what way I was confused. Concerning your promotion of <b>Hask</b> as an unquestionably distinguished category for dealing with Haskell, I would again say that I feel you are being dogmatic and needlessly restrictive."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536329054, "post_id": 52219614, "comment_id": 91397476, "body": "<i>is it not natural to imagine there to be a function omap :: A -&gt; F A?</i> No, it is not. The definition of functor doesn&#39;t require that such a function exists. There are more advanced concepts, such as applicative functors, that do require such a function. It&#39;s called &quot;pure&quot; in this case. It has nothing to do with the object function of the functor, <b>which is <code>F</code></b>. But a general functor doesn&#39;t have anything like <code>omap</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536329448, "post_id": 52219614, "comment_id": 91397663, "body": "To be a bit more specific, try to provide <code>omap</code> for the functor <code>(,) a</code>. You can find a definition <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/src/GHC.Base.html#line-808\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536329802, "post_id": 52219614, "comment_id": 91397863, "body": "@n.m. Let us go back a step. Suppose we regard sets of values as objects in a category <b>Hask&#39;</b>, which is not far from the truth, as you noted above. Now, clearly a functor should offer an object function that has as its domain these sets of values. A type function does not have anything to do with sets of values, but a term level polymorphic function seems like it might. For your instance, <code>omap x = (mempty, x)</code> or <code>obimap x y = (x, y)</code> seem useful, but this is actually what my question is about; I do not know if such a functor is possible, but it is appealing to consider!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536330766, "post_id": 52219614, "comment_id": 91398444, "body": "A functor acts <b>on the entire category</b>. The domain of its object part is the set, or a class, or whatever collection it has of <b>objects</b> (types, in our case). A collection of <b>values</b> that belong to a single type has nothing to do with it. Your definition of <code>omap</code> doesn&#39;t work, try to compile it. You can&#39;t just guess what <code>mempty</code> means, it doesn&#39;t do what you think it does. And <code>obimap</code> is not <code>omap</code>. You seem mightily confused. Consider getting a Haskell book."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536331196, "post_id": 52219614, "comment_id": 91398708, "body": "&quot;Now, clearly a functor should offer an object function that has as its domain these sets of values&quot;. Clearly? Not by a long shot. This is a rather strange idea. Functors are not concerned with values at all. They deal with <b>objects</b> and <b>arrows</b>, period. A general category doesn&#39;t need to have any concept of a value, but functors are useful for these categories nevertheless; it follows that the notion of functor, if we want it to be generic, should not involve values."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536332054, "post_id": 52219614, "comment_id": 91399249, "body": "@n.m. As I said: Let us go back a step. Suppose we regard sets of values as objects in a category <b>Hask&#39;</b>. Now, clearly a functor <i>in this category</i> should offer an object function that has as its domain these sets of values. Then again, there is no need to be condescending. There are some problems with my idea of a functor in <b>Hask&#39;</b> \u2014 perhaps some usual functors could not be defined, perhaps there are even more serious flaws. Does not mean we should not try. Certainly does not mean your Haskell book contains the complete knowledge of what Haskell is or could ever be."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1536332322, "post_id": 52219614, "comment_id": 91399416, "body": "&quot;Clearly a type level function, such as <code>Maybe</code>, does not have anything to do with sets of values&quot; -- Doesn&#39;t it? It takes us from a set of values (the inhabitants of, say, <code>Integer</code>) to a different set of values (the inhabitants of <code>Maybe Integer</code>)."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1536333078, "post_id": 52219614, "comment_id": 91399868, "body": "@duplode I am not ready to agree with you about this. I can see how <code>f :: A -&gt; B</code> takes us from a set of values of type <code>A</code> to a set of values of type <code>B</code>. For instance, <code>Just</code> tangibly takes us from one set of terms to another. <code>Maybe</code> merely takes us from a type tag to another type tag. Even though the two often coincide, I am not sure we should conflate one with the other right from the start."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536333342, "post_id": 52219614, "comment_id": 91400056, "body": "&quot;clearly a functor in this category should offer an object function that has as its domain these sets of values.&#39; A functor should do what a functor should do according to the definition of functor. Send objects to objects, and arrows to arrows, and nothing more. If you want more than that, you need something other than a functor, and you should be prepared to define what you want exactly. Anyway I don&#39;t think this discussion is productive. If you have a question, hit the question button. It looks like your question really is &quot;why not all functors are applicatives&quot;, or something like that."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536333742, "post_id": 52219614, "comment_id": 91400328, "body": "<code>Maybe</code> is an applicative functor, and <code>Just</code> is its <code>pure</code>. It looks like your question <i>really</i> is &quot;why not all functors have <code>pure</code>&quot; (which you seem to be calling <code>omap</code> for some reason), and this is a legitimate question. I tried to explain why not with the <code>(,)a</code> example but the space is limited. You may want to ask this question in an orderly manner."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536334332, "post_id": 52219614, "comment_id": 91400639, "body": "@n.m. No, my question is not about that. I agree that we are not making progress here, and one reason for that, I think, is that you are trying to nudge me towards the thinking outlined in your <i>(metaphorically)</i> Haskell book, while I am trying to look at things from a different <i>(and that may well be inconsistent, sure)</i> perspective. If you start with the idea that something else than <i>types</i> <i>(an abstract, intangible notion by itself)</i> could be considered as objects for a category with the usual Haskell functions as arrows, I am sure you will understand the subject of my curiosity easily."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1536334509, "post_id": 52219614, "comment_id": 91400746, "body": "&quot;I am not ready to agree with you about this&quot; -- Let&#39;s put it like this: <code>f :: A -&gt; B</code> takes each value in the set <code>A</code> to a value in <code>B</code>. <code>Maybe :: Type -&gt; Type</code> takes each <i>set</i> (<code>A</code>, <code>B</code>, <code>Integer</code>, etc.) to a different set (<code>Maybe A</code>, <code>Maybe B</code>, <code>Maybe Integer</code>, etc.). Looking at it like this, <code>Maybe</code> is a function taking sets to sets; the elements of those sets don&#39;t really come into play."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1536335638, "post_id": 52219614, "comment_id": 91401306, "body": "As for the other side of your question: if you want <code>pure</code> to be the object mapping of a functor, you have to (a) specify what the source category of the functor should be -- it&#39;s objects, morphisms, identities and composition, and ensure they follow the category laws; (b) do the same for the target category, if it isn&#39;t the same as the source one; and (c) specify the morphism mapping of the functor, while ensuring it follows the functor laws."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536336324, "post_id": 52219614, "comment_id": 91401669, "body": "It seems to me that you are trying to look at things from a different perspective without fully understanding the standard perspective. I don&#39;t think the idea to look for categories with functions as arrows and something other than types as objects is a particularly productive one. I can&#39;t think of such category off the top of my head, and I have no idea what it could be useful for. You may give it a try if you want but I won&#39;t hold my breath. It is also not very useful to talh about Haskell type classes from such category perspective, because Haskell type classes are designed to work in Hask."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1536339550, "post_id": 52219614, "comment_id": 91403028, "body": "@duplode I understand that this abstraction can go some way. But surely there are sorts of sets it does not describe \u2014 say, even numbers. I can think of a total function <code>(&#47;2) :: Even -&gt; Integer</code>, for example, but it is outside of the Haskell type system. We do not have union, intersection, inclusion, negation. This is why it is hard for me to accept that the usual Haskell types are the only way to define objects in a category of Haskell functions, and hence that functors can only be defined via type level functions, though I agree that the usual functions are not very suitable for that too."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1536378692, "post_id": 52219614, "comment_id": 91413039, "body": "I&#39;d say that isn&#39;t really a problem. As far as the issue we are discussing here is concerned goes, things remain the same if we switch to a different type system with dependent types, or subtype polymorphism, etc. (And FWIW you can have an <code>Even</code> type in Haskell, even though the encoding won&#39;t be as neat aw what you might have with dependent types.)"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 1, "closed_date": 1536318255, "answer_count": 0, "score": 0, "last_activity_date": 1536320692, "creation_date": 1536312776, "last_edit_date": 1536320692, "question_id": 52219614, "link": "https://stackoverflow.com/questions/52219614/why-does-the-functor-class-in-haskell-not-include-a-function-on-objects-is-pur", "closed_reason": "Duplicate", "title": "Why does the Functor class in Haskell not include a function on objects? Is `pure` that function?", "body": "<p>In Category theory, it is very conspicuous that a definition of a functor should include two functions: on objects and on arrows. However, the usual Haskell <code>Prelude.Functor</code> does not make any mention of the former. Why is that? Would <code>pure</code> be that function on objects?</p>\n\n<p>Specifically, for <code>data F a</code> to be an endofunctor in <strong>Hask</strong>, there should be given:</p>\n\n<pre><code>-- A function on objects:\nomap ::     a     -&gt;      F a\n\n-- A function on arrows:\nfmap :: (a -&gt; a') -&gt; (F a -&gt; F a')\n</code></pre>\n\n<p>For a <em>\"small\"</em> type function, such as <code>Maybe</code>, it seems safe to name a suitable data constructor, such as <code>Just</code>, as the function on objects. For a type function with more variety \u2014 possibly infinite, like <code>[\u22c5]</code>, \u2014 I am not so sure. Does it make difference whether I choose <code>\\x -&gt; [ ]</code> <em>(a trivial functor)</em>, <code>\\x -&gt; [x]</code>, <code>\\x -&gt; [x, x]</code>, ..., or <code>\\x -&gt; [x, x..]</code>? Or would these be equally rightful, though distinct, instantiations of the <em>\"classical\"</em> categorial functor?</p>\n\n<p>If so, would it be correct to propose that <code>Prelude.Functor</code> actually defines a whole family of functors at once?</p>\n\n<hr>\n\n<p>The suggestion, <a href=\"https://stackoverflow.com/q/14820139\">offered in the answers to a question nearby</a>, that the type constructor itself is the function on objects, I am not prepared to accept. We do require that a <code>Functor</code> instance gives lawful evidence to the existence of <code>fmap</code>. In the same way, we should be requiring that a term level function <code>omap</code> on objects is given, should we not? There must be some confusion about the type / term distinction in <strong>Hask</strong> here, either on my side alone, or in the common knowledge spread around the Haskell community.</p>\n\n<p>To be specific, I may suggest that there are actually two distinct categories we may be talking about:</p>\n\n<ul>\n<li><strong>Hask</strong> \u2014 a category which objects are the sets of term level values of particular Haskell types, and arrows are the sets of term level functions.</li>\n<li><strong>Type</strong> \u2014 a category which objects are sets of types of a particular kind, and arrows are sets of type level functions, that is, types of a kind that has an arrow at the top level of its syntax tree.</li>\n</ul>\n\n<p>Then, <code>fmap</code> is an arrow function for an endofunctor on <strong>Hask</strong>, while a type constructor is an arrow function for an endofunctor on <strong>Type</strong>, as it operates on sets of types, rather than values.</p>\n\n<p><strong>P.S.</strong> As @pigworker kindly explained in comments, my understanding of <strong>Hask</strong> is all wrong. However, I wonder if any of the above applies if a different category <strong>Term</strong> is considered, in which an object is a set of values <em>(conceivably, all possible values of some chosen type)</em>, and an arrow is a <em>(monomorphic)</em> function between such sets. Since a <strong>hom</strong> set would also be an object, both <code>fmap</code> and <code>omap</code> <em>(polymorphic functions \u2014 actually, bundles of arrows)</em> would operate on terms. At the same time, my idea is that a subcategory of <strong>Term</strong> <em>(in which only those sets of values that correspond to actual Haskell types are considered)</em> may be made isomorphic to <strong>Hask</strong> with an appropriately chosen functor that takes class methods, newtypes and such into account. Are there some obvious problems with a construction along these lines?</p>\n\n<hr>\n\n<p>Concerning the <a href=\"https://stackoverflow.com/questions/21647659/\">supposed duplicate question</a>, the answers given there do not satisfy my curiosity, for the reasons outlined above. If <strong>Hask</strong> is not the appropriate category for my inquiry, than perhaps some other choice of category could be considered. So, I think an answer should necessarily include an argument as to why a certain category is chosen to work with, in the first place.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1536311668, "post_id": 52219039, "comment_id": 91386891, "body": "have you tried to use <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#ghci-debugger\" rel=\"nofollow noreferrer\">ghci debugging</a> instead of printf-debugging, or even better written small test cases to catch the errors in your program logic?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1536312879, "post_id": 52219039, "comment_id": 91387650, "body": "GHC keeps no type information at runtime: types are erased during compilation. A parameter of generic type <code>a</code> is roughly passed as an untyped pointer. There&#39;s no way to use that argument in any way except passing it around / returning it, since to access the pointed data one needs to know its type, so to know how many bytes to read, and how to interpret them."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1536318735, "post_id": 52219039, "comment_id": 91391085, "body": "If you know the runtime type, and that is a <code>Show</code> type, you can use unsafe coercions to &quot;cast&quot; that value to the runtime type, after which you can use <code>Show</code>. This is a big &quot;if&quot;, however."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1536330819, "post_id": 52222131, "comment_id": 91398473, "body": "Your <code>d</code> has monomorphic type, but the question asks about writing a function with polymorphic type."}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1536331766, "post_id": 52222131, "comment_id": 91399075, "body": "Right. It won&#39;t actually generate you a <code>Show</code> instance for an unconstrained arbitrary type <code>a</code>."}], "tags": [], "owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "is_accepted": false, "score": 0, "last_activity_date": 1536321616, "creation_date": 1536321616, "answer_id": 52222131, "question_id": 52219039, "link": "https://stackoverflow.com/questions/52219039/can-i-coercion-be-used-to-generate-constraints/52222131#52222131", "title": "Can I coercion be used to generate constraints?", "body": "<p>In case you're bold enough to ignore the comments, here's quite literally what you want to do, with a demonstration of how to crash GHCI with it.</p>\n\n<pre><code>$ stack install constraints\n$ stack ghci\n...\n&gt; :set -XTypeApplications\n&gt; import Data.Constraint\n&gt; import Unsafe.Coerce\n&gt; d = unsafeCoerce @(Dict (Show Int)) @(Dict (Show (Int -&gt; Int))) Dict\n&gt; withDict d $ if False then show (\\n -&gt; n + 1 :: Int) else \"Success! The Show constraint wasn't needed\"\n\"Success! The Show constraint wasn't needed\"\n&gt; withDict d $ show (\\n -&gt; n + 1 :: Int)\n\"&lt;interactive&gt;: internal error: PAP object entered!\n    (GHC version 8.4.3 for x86_64_unknown_linux)\n    Please report this as a GHC bug:  http://www.haskell.org/ghc/reportabug\n$ # back to shell\n</code></pre>\n\n<p>Disclaimer: Don't do this. Even if you define your own <code>Show (Int -&gt; Int)</code> instance at the top-level, GHC is free to ignore it and crash anyway.</p>\n"}, {"comments": [{"owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "edited": false, "score": 0, "creation_date": 1536417631, "post_id": 52224779, "comment_id": 91421188, "body": "I&#39;m curious if there&#39;s a good -- technical or otherwise -- reason for this. It seems to me that it would be quite helpful."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "edited": false, "score": 1, "creation_date": 1536438255, "post_id": 52224779, "comment_id": 91426823, "body": "@fredefox Yes, the reason was described well by chi in the comments. For efficiency, the runtime representation of values does not store information about the type. <code>False :: Bool</code> and <code>LT :: Ordering</code> look the same in memory. Therefore it is not possible to &quot;wish up&quot; a <code>Show</code> instance -- it&#39;s not even possible to &quot;wish up&quot; a representation of the right type, let alone take the next step of finding a <code>Show</code> dictionary for that type."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1536330951, "creation_date": 1536330951, "answer_id": 52224779, "question_id": 52219039, "link": "https://stackoverflow.com/questions/52219039/can-i-coercion-be-used-to-generate-constraints/52224779#52224779", "title": "Can I coercion be used to generate constraints?", "body": "<p>No, it is not possible to implement <code>coerceTraceId</code> with the type and behavior you request.</p>\n"}], "owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1536330951, "creation_date": 1536310879, "question_id": 52219039, "link": "https://stackoverflow.com/questions/52219039/can-i-coercion-be-used-to-generate-constraints", "title": "Can I coercion be used to generate constraints?", "body": "<p>For debugging purposes I'd like to <code>show</code> some values nested in various parts of my program logic. It's not always the case, however, that what I'm trying to <code>show</code> has a <code>Show</code> instance. Is it possible to somehow assume that it does have a valid instance and defer the occurring from a potentially missing dictionary to run-time? I know I can add the constraint to the context of the function where I want to do the <code>show</code>ing, the caveat of this is that I may need to change many signatures throughout my program. I'm looking for functions like e.g.:</p>\n\n<pre><code>coerceTrace   :: forall a b . a -&gt; b -&gt; b\ncoerceTraceId :: forall a   . a -&gt; a\n</code></pre>\n\n<p>That internally conjures up a <code>Show a</code> to be used with the <code>Debug.Trace</code> family of functions.</p>\n\n<p>I know that we have <code>unsafeCoerce</code>, but it's not obvious to me if this can be used to generate constraints.</p>\n"}, {"tags": ["json", "haskell", "aeson"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1536311270, "post_id": 52218662, "comment_id": 91386679, "body": "The problem here is more the fact that you use <code>null</code> instead of an empty list. Furthermore why do you create a constructor <code>Nothing</code> here? Without the <code>null</code> case, this is actually <i>completely</i> the same as non-flat data."}, {"owner": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536312279, "post_id": 52218662, "comment_id": 91387275, "body": "You are right. It is really simple if you just use empty lists to represent no children!"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1536338763, "post_id": 52218662, "comment_id": 91402688, "body": "So... problem solved?"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1536342668, "post_id": 52218662, "comment_id": 91404266, "body": "@lsund It should be quite straightforward to <a href=\"http://hackage.haskell.org/package/aeson-1.4.0.0/docs/Data-Aeson.html#g:2\" rel=\"nofollow noreferrer\">define custom</a> <code>FromJSON</code>/<code>ToJSON</code> instances manually. Do you need help with that? (If no, you can also answer your own question, and this is encouraged!)"}, {"owner": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "edited": false, "score": 0, "creation_date": 1536575394, "post_id": 52218662, "comment_id": 91458789, "body": "I answered my own question. Thank you all"}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "is_accepted": true, "score": 0, "last_activity_date": 1536575372, "creation_date": 1536575372, "answer_id": 52255825, "question_id": 52218662, "link": "https://stackoverflow.com/questions/52218662/parse-json-rose-tree-with-haskell-aeson/52255825#52255825", "title": "Parse Json Rose Tree with Haskell Aeson", "body": "<p>As Willem von Onsem suggested, this is much simpler if you define the data like this:</p>\n\n<p><code>data Tree = Node { value :: Text, children :: [Tree]}</code>, just using an empty list for representing (also in the json) empty subtrees. Then, you just parse the json directly by just deriving <code>fromJSON</code> of the datatype. </p>\n\n<p>Another idea is to use <code>Data.Tree</code> which already has a derived instance of <code>fromJSON</code>. For Data.Tree, the JSON has to be structured something like like this:</p>\n\n<pre><code>[\"a\",[\"b\",[]]]\n</code></pre>\n"}], "owner": {"reputation": 716, "user_id": 2315551, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/8a4c0668c9eab3ecb855d3f6fd879ad7?s=128&d=identicon&r=PG&f=1", "display_name": "lsund", "link": "https://stackoverflow.com/users/2315551/lsund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 52255825, "answer_count": 1, "score": 0, "last_activity_date": 1536575372, "creation_date": 1536309603, "question_id": 52218662, "link": "https://stackoverflow.com/questions/52218662/parse-json-rose-tree-with-haskell-aeson", "title": "Parse Json Rose Tree with Haskell Aeson", "body": "<p>I'm trying to parse recursive JSON data, something like this:</p>\n\n<pre><code>{\n    \"node\": \"a\",\n    \"children\": [\n        {\n            \"node\": \"b\",\n            \"children\": [\n                {\n                    \"node\": \"c\",\n                    \"children\": null\n                }\n            ]\n        },\n        {\n            \"node\": \"d\",\n            \"children\": null\n        }\n    ]\n}\n</code></pre>\n\n<p>Now I want to implement an instance of FromJSON, so that I can decode it into a data structure like this:\nthe following data structure</p>\n\n<pre><code>data Tree = Node { value :: Text, children :: [Tree]} | Nothing\n</code></pre>\n\n<p>I have no clue how to do this. I have only seen examples on how to derive instances for flat (non-recursive) JSON structures using Aeson.</p>\n"}, {"tags": ["haskell", "lambda", "ocaml", "lazy-evaluation", "ml"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1536283679, "post_id": 52213849, "comment_id": 91377542, "body": "Ocaml and SML kind of have no choice in this matter. It&#39;s an inevitable consequence of applicative order of evaluation. In Haskell, the Strict pragma only applies to bindings and data types, expressions are still lazy."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1536350449, "post_id": 52213849, "comment_id": 91407468, "body": "@FyodorSoikin, &quot;It&#39;s an inevitable consequence of applicative order of evaluation&quot; -- my questions are exactly about what happens if you rebel and break the order in this particular regard. Automatic eta-expansion to the proletariat! &quot;In Haskell, the Strict pragma only applies to bindings and data types&quot; -- thanks, I see."}], "answers": [{"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1536350137, "post_id": 52227336, "comment_id": 91407343, "body": "While this is interesting, it does not touch my practical concerns. What would happen if we automatically eta-expand all functions in a strict language? Would that break something? Would that made something deeply counter-intuitive? I just do not understand why I should do this manually when a language can do this for me and save me some headache."}, {"owner": {"reputation": 31189, "user_id": 1097780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8f01ad795c29c3d05ad26ee47ea6069?s=128&d=identicon&r=PG", "display_name": "Andreas Rossberg", "link": "https://stackoverflow.com/users/1097780/andreas-rossberg"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1536387124, "post_id": 52227336, "comment_id": 91414270, "body": "Implicit eta-expansion would definitely be a terrible idea, in both eager and lazy languages. See my edit."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1536430721, "post_id": 52227336, "comment_id": 91424845, "body": "Sorry, but I do not understand your examples. I do not see the difference between <code>\\s -&gt; run fsm s</code> and <code>run fsm</code> in your Haskell example and besides even if you bind that <code>s</code> directly in <code>match</code>, that wouldn&#39;t change anything due to <code>full-laziness</code>. I see what your ML snippet does, but do not understand how eta-conversion can affect that. Could you please elaborate?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1536446347, "post_id": 52227336, "comment_id": 91428582, "body": "Actually, I think I understand now. With effects it&#39;s at the very least not clear whether to expand before a <code>let</code> or after. Both approaches have their advantages, but both are rather arbitrary and silently affect semantics of an expression in a non-trivial way. Yeah, perfect example, thank you."}, {"owner": {"reputation": 31189, "user_id": 1097780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8f01ad795c29c3d05ad26ee47ea6069?s=128&d=identicon&r=PG", "display_name": "Andreas Rossberg", "link": "https://stackoverflow.com/users/1097780/andreas-rossberg"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1536458333, "post_id": 52227336, "comment_id": 91430159, "body": "Not sure what you think is arbitrary about interpreting a program exactly as it is written. Inserting unrequested eta expansions would indeed be very arbitrary."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1536483842, "post_id": 52227336, "comment_id": 91434165, "body": "I meant that whether you insert a lambda before or after <code>let</code>, it is arbitrary in any case."}, {"owner": {"reputation": 31189, "user_id": 1097780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8f01ad795c29c3d05ad26ee47ea6069?s=128&d=identicon&r=PG", "display_name": "Andreas Rossberg", "link": "https://stackoverflow.com/users/1097780/andreas-rossberg"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1536496861, "post_id": 52227336, "comment_id": 91437593, "body": "I don&#39;t understand this statement. No lambda is inserted. When &quot;partially&quot; applying a curried function you are simply calling a function that returns a value that also happens to be a function. There is nothing special about returning a function."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1536518573, "post_id": 52227336, "comment_id": 91443012, "body": "&quot;No lambda is inserted.&quot; -- yes. Sorry I must be really unclear. I mean that if you do what I proposed, i.e. insert a lambda, you&#39;re forced to do an arbitrary choice which is silly."}, {"owner": {"reputation": 31189, "user_id": 1097780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8f01ad795c29c3d05ad26ee47ea6069?s=128&d=identicon&r=PG", "display_name": "Andreas Rossberg", "link": "https://stackoverflow.com/users/1097780/andreas-rossberg"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1536519294, "post_id": 52227336, "comment_id": 91443203, "body": "Ah, okay, now I get what you were saying. Thanks for the clarification."}], "tags": [], "owner": {"reputation": 31189, "user_id": 1097780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8f01ad795c29c3d05ad26ee47ea6069?s=128&d=identicon&r=PG", "display_name": "Andreas Rossberg", "link": "https://stackoverflow.com/users/1097780/andreas-rossberg"}, "is_accepted": true, "score": 3, "last_activity_date": 1536387075, "last_edit_date": 1536387075, "creation_date": 1536342242, "answer_id": 52227336, "question_id": 52213849, "link": "https://stackoverflow.com/questions/52213849/eta-conversion-changes-semantics-in-a-strict-language/52227336#52227336", "title": "Eta-conversion changes semantics in a strict language", "body": "<p>To address the technical part of your question, eta-conversion also changes the meaning of expressions in lazy languages, you just need to consider the eta-rule of a different type constructor, e.g., + instead of ->.</p>\n\n<p>This is the eta-rule for binary sums:</p>\n\n<pre><code>(case e of Lft y -&gt; f (Lft y) | Rgt y -&gt; f (Rgt y))  =  f e    (eta-+)\n</code></pre>\n\n<p>This equation holds under eager evaluation, because <code>e</code> will always be reduced on both sides. Under lazy evaluation, however, the r.h.s. only reduces <code>e</code> if <code>f</code> also forces it. That might make the l.h.s. diverge where the r.h.s. would not. So the equation does not hold in a lazy language.</p>\n\n<p>To make it concrete in Haskell:</p>\n\n<pre><code>f x = 0\nlhs = case undefined of Left y -&gt; f (Left y); Right y -&gt; f (Right y)\nrhs = f undefined\n</code></pre>\n\n<p>Here, trying to print <code>lhs</code> will diverge, whereas <code>rhs</code> yields <code>0</code>.</p>\n\n<p>There is more that could be said about this, but the essence is that the equational theories of both evaluation regimes are sort of dual.</p>\n\n<p>The underlying problem is that under a lazy regime, every type is inhabited by <code>_|_</code> (non-termination), whereas under eager it is not. That has severe semantic consequences. In particular, there are no inductive types in Haskell, and you cannot prove termination of a structural recursive function, e.g., a list traversal.</p>\n\n<p>There is a line of research in type theory distinguishing data types (strict) from codata types (non-strict) and providing both in a dual manner, thus giving the best of both worlds.</p>\n\n<p><em>Edit:</em> As for the question why a compiler should not eta-expand functions: that would utterly break every language. In a strict language with effects that's most obvious, because the ability to <em>stage</em> effects via multiple function abstractions is a feature. The simplest example perhaps is this:</p>\n\n<pre><code>let make_counter () =\n  let x = ref 0 in\n  fun () -&gt; x := !x + 1; !x\n\nlet tick = make_counter ()\nlet n1 = tick ()\nlet n2 = tick ()\nlet n3 = tick ()\n</code></pre>\n\n<p>But effects are not the only reason. Eta-expansion can also drastically change the performance of a program! In the same way you sometimes want to stage effects you sometimes also want to stage <em>work</em>:</p>\n\n<pre><code>match :: String -&gt; String -&gt; Bool\nmatch regex = \\s -&gt; run fsm s\n  where fsm = ...expensive transformation of regex...\n\nmatchFloat = match \"[0-9]+(\\.[0-9]*)?((e|E)(+|-)?[0-9]+)?\"\n</code></pre>\n\n<p>Note that I used Haskell here, because this example shows that implicit eta-expansion is not desirable in either eager or lazy languages!</p>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1536430879, "post_id": 52237807, "comment_id": 91424883, "body": "Yeah, I got from the Fyodor Soikin&#39;s comment that I just didn&#39;t understand how <code>Strict</code> really works in Haskell. The &quot;subtle issue&quot; point is helpful, thanks."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 1, "last_activity_date": 1536428410, "creation_date": 1536428410, "answer_id": 52237807, "question_id": 52213849, "link": "https://stackoverflow.com/questions/52213849/eta-conversion-changes-semantics-in-a-strict-language/52237807#52237807", "title": "Eta-conversion changes semantics in a strict language", "body": "<p>With respect to your final question (why does Haskell do this), the reason \"Strict Haskell\" behaves differently from a truly strict language is that the <code>Strict</code> extension doesn't really change the evaluation model from lazy to strict.  It just makes a subset of bindings into \"strict\" bindings by default, and only in the <strong>limited Haskell sense</strong> of forcing evaluation to weak head normal form.  Also, it only affects bindings made in the module with the extension turned on; it doesn't retroactively affect bindings made elsewhere.  (Moreover, as described below, the strictness doesn't take effect in partial function application.  The function needs to be fully applied before any arguments are forced.)</p>\n\n<p>In your particular Haskell example, I believe the only effect of the <code>Strict</code> extension is as if you had explicitly written the following bang patterns in the definition of <code>silly</code>:</p>\n\n<pre><code>silly !g !f = g (f (trace \"evaluated\" 0))\n</code></pre>\n\n<p>It has no other effect.  In particular, it doesn't make <code>const</code> or <code>(+)</code> strict in their arguments, nor does it generally change the semantics of function applications to make them eager.</p>\n\n<p>So, when the term <code>silly (const 0) (+)</code> is forced by <code>print</code>, the only effect is to evaluate its arguments to WHNF as part of the function application of <code>silly</code>.  The effect is similar to writing (in non-<code>Strict</code> Haskell):</p>\n\n<pre><code>let { g = const 0; f = (+) } in g `seq` f `seq` silly g f\n</code></pre>\n\n<p>Obviously, forcing <code>g</code> and <code>f</code> to their WHNFs (which are lambdas) isn't going to have any side effect, and when <code>silly</code> is applied, <code>const 0</code> is still lazy in its remaining argument, so the resulting term is something like:</p>\n\n<pre><code>(\\x -&gt; 0) ((\\x y -&gt; &lt;defn of plus&gt;) (trace \"evaluated\" 0))\n</code></pre>\n\n<p>(which should be interpreted without the <code>Strict</code> extension -- these are all lazy bindings here), and there's nothing here that will force the side effect.</p>\n\n<p>As noted above, there's another subtle issue that this example glosses over.  Even if you had made everything in sight strict:</p>\n\n<pre><code>{-# LANGUAGE Strict #-}\n\nimport Debug.Trace\n\nmyConst :: a -&gt; b -&gt; a\nmyConst x y = x\n\nmyPlus :: Int -&gt; Int -&gt; Int\nmyPlus x y = x + y\n\nsilly :: ((Int -&gt; Int) -&gt; Int) -&gt; (Int -&gt; Int -&gt; Int) -&gt; Int\nsilly g f = g (f (trace \"evaluated\" 0))\n\nmain = print $ silly (myConst 0) myPlus\n</code></pre>\n\n<p>this still wouldn't have printed \"evaluated\".  This is because, in the evaluation of <code>silly</code> when the strict version of <code>myConst</code> forces its second argument, that argument is a partial application of the strict version of <code>myPlus</code>, and <code>myPlus</code> won't force any of its arguments until it's been fully applied.</p>\n\n<p>This also means that if you change the definition of <code>myPlus</code> to:</p>\n\n<pre><code>myPlus x = \\y -&gt; x + y   -- now it will print \"evaluated\"\n</code></pre>\n\n<p>then you'll be able to largely reproduce the ML behavior.  Because <code>myPlus</code> is now fully applied, it will force its argument, and this will print \"evaluated\".  You can suppress it again eta-expanding <code>f</code> in the definition of <code>silly</code>:</p>\n\n<pre><code>silly g f = g (\\x -&gt; f (trace \"evaluated\" 0) x)  -- now it won't\n</code></pre>\n\n<p>because now when <code>myConst</code> forces its second argument, that argument is already in WHNF (because it's a lambda), and we never get to the application of <code>f</code>, full or not.</p>\n\n<p>In the end, I guess I wouldn't take \"Haskell plus the <code>Strict</code> extension and unsafe side effects like <code>trace</code>\" too seriously as a good point in the design space.  Its semantics may be (barely) coherent, but they sure are weird.  I think the only serious use case is when you have some code whose semantics \"obviously\" don't depend on lazy versus strict evaluation but where performance would be improved by a lot of forcing.  Then, you can just turn on <code>Strict</code> for a performance boost without having to think too hard.</p>\n"}], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 52227336, "answer_count": 2, "score": 1, "last_activity_date": 1536428410, "creation_date": 1536281382, "last_edit_date": 1536294116, "question_id": 52213849, "link": "https://stackoverflow.com/questions/52213849/eta-conversion-changes-semantics-in-a-strict-language", "title": "Eta-conversion changes semantics in a strict language", "body": "\n\n<p>Take this OCaml code:</p>\n\n<pre class=\"lang-ml prettyprint-override\"><code>let silly (g : (int -&gt; int) -&gt; int) (f : int -&gt; int -&gt; int) =\n        g (f (print_endline \"evaluated\"; 0))\n\nsilly (fun _ -&gt; 0) (fun x -&gt; fun y -&gt; x + y)\n</code></pre>\n\n<p>It prints <code>evaluated</code> and returns <code>0</code>. But if I eta-expand <code>f</code> to get <code>g (fun x -&gt; f (print_endline \"evaluated\"; 0) x)</code>, <code>evaluated</code> is no longer printed.</p>\n\n<p>Same holds for this SML code:</p>\n\n<pre class=\"lang-ml prettyprint-override\"><code>fun silly (g : (int -&gt; int) -&gt; int, f : int -&gt; int -&gt; int) : int =\n        g (f (print \"evaluated\" ; 0));\n\nsilly ((fn _ =&gt; 0), fn x =&gt; fn y =&gt; x + y);\n</code></pre>\n\n<p>On the other hand, this Haskell code doesn't print <code>evaluated</code> even with the strict pragma:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE Strict #-}\n\nimport Debug.Trace\n\nsilly :: ((Int -&gt; Int) -&gt; Int) -&gt; (Int -&gt; Int -&gt; Int) -&gt; Int\nsilly g f = g (f (trace \"evaluated\" 0))\n\nmain = print $ silly (const 0) (+)\n</code></pre>\n\n<p>(I can make it, though, by using <code>seq</code>, which makes perfect sense for me)</p>\n\n<p>While I understand that OCaml and SML do the right thing theoretically, are there any practical reason to prefer this behaviour to the \"lazier\" one? Eta-contraction is a common refactoring tool and I'm totally scared of using it in a strict language. I feel like I should paranoically eta-expand everything, just because otherwise arguments to partially applied functions can be evaluated when they're not supposed to. When is the \"strict\" behaviour useful?</p>\n\n<p>Why and how does Haskell behave differently under the <code>Strict</code> pragma? Are there any references I can familiarize myself with to better understand the design space and pros and cons of the existing approaches?</p>\n"}, {"tags": ["haskell", "haskell-platform"], "comments": [{"owner": {"reputation": 6908, "user_id": 5366641, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71e9ba6e3cdac2461999d9c32ad9d507?s=128&d=identicon&r=PG", "display_name": "scopchanov", "link": "https://stackoverflow.com/users/5366641/scopchanov"}, "edited": false, "score": 1, "creation_date": 1536281238, "post_id": 52213755, "comment_id": 91377083, "body": "Do not worry about super user, as your question <i>directly involves tools used primarily for programming</i>. That is why I have edited that part out of your post."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1536303764, "post_id": 52213755, "comment_id": 91382624, "body": "Typically you can perform a &quot;virtual environment&quot; (like in Python), etc. with <code>haskell-stack</code>."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10328094"}, "is_accepted": false, "score": 1, "last_activity_date": 1536442334, "creation_date": 1536442334, "answer_id": 52239567, "question_id": 52213755, "link": "https://stackoverflow.com/questions/52213755/how-to-manage-multiple-haskell-installations-on-macos/52239567#52239567", "title": "How to manage multiple haskell installations on macOS?", "body": "<p>I think I have come up with a solution and I'll answer the latter question first:</p>\n\n<ul>\n<li><p>All the details I was looking for (what effectively is installed after launching the <a href=\"https://www.haskell.org/downloads#minimal\" rel=\"nofollow noreferrer\">minimal</a> / \"<a href=\"https://www.haskell.org/downloads#platform\" rel=\"nofollow noreferrer\">Platform</a>\" installer, and, most importantly, <strong>where</strong> these guys were placed) can be found in the documentation welcome file at <code>/Library/Haskell/Doc/Start.html</code>. More precisely: </p>\n\n<blockquote>\n  <p>On Mac OS X, the Haskell Platform is installed in two major pieces: GHC and Haskell Platform. They are installed respectively in: <code>/Library/Frameworks/GHC.framework</code> and <code>/Library/Haskell</code>. Executables are symlinked in <code>/usr/local/bin</code> [...].</p>\n</blockquote>\n\n<p>There are also another two or three directories in the home folder, namely <code>~/.ghc</code> and <code>~/.stack</code>.</p></li>\n<li><p>As said in the OP, the script <code>uninstall-hs</code> done its work, showing a (at least I hope so) comprehensive list of all the files that constitutes the Haskell \"sdk\" actually installed.</p></li>\n</ul>\n\n<p>Feel free to post your answers, I hope this post will be useful to the community.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10328094"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1536442334, "creation_date": 1536280458, "last_edit_date": 1536319533, "question_id": 52213755, "link": "https://stackoverflow.com/questions/52213755/how-to-manage-multiple-haskell-installations-on-macos", "title": "How to manage multiple haskell installations on macOS?", "body": "<p>I have on my computer (macOS High Sierra) multiple installations of the standard (Glasgow) Haskell compiler. The oldest one (as far as I can remember) is a <a href=\"https://www.haskell.org/downloads#minimal\" rel=\"nofollow noreferrer\">minimal installation</a>, while I obtained the most recent version form the \"<a href=\"https://www.haskell.org/downloads#platform\" rel=\"nofollow noreferrer\">Platform</a>\" installer, something like five or six months ago. I'm trying to get rid of the whole ecosystem (ghc, stack, cabal, and friends), mostly because I don't know what tools I will be using in the case I'll plan to get back using the language.</p>\n\n<p>So my questions are:</p>\n\n<ol>\n<li><p><strong>Where</strong> does the minimal/\"Platform\" installer installs Haskell and all related stuff?</p></li>\n<li><p><strong>How</strong> can one remove the whole Haskell language and all its components mentioned above (in the case of a \"Platform\" install, and even in the case of a minimal installation)?</p></li>\n</ol>\n\n<p>EDIT: I've just remembered of the <code>uninstall-hs</code> command (see also <a href=\"https://stackoverflow.com/questions/37034915/how-do-i-uninstall-older-versions-of-ghc\">here</a>), should I run this instead of removing files manually?</p>\n"}, {"tags": ["haskell", "linked-list", "monads", "do-notation"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1536266328, "post_id": 52211831, "comment_id": 91373000, "body": "All do notation can be rewritten with <code>&gt;&gt;=</code> and <code>return</code>, for this, there is even a special use function."}, {"owner": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536266656, "post_id": 52211831, "comment_id": 91373133, "body": "Right, you are technically correct. What I actually meant, was if I can rewrite it in some natural way using functions from <code>Control.Applicative</code> or <code>Control.Monad</code> and no lambdas. Rewriting by <code>&gt;&gt;=</code> usually requires many lambdas."}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 1, "creation_date": 1536267007, "post_id": 52211831, "comment_id": 91373275, "body": "&quot;was thinking about something like liftA2 but that won&#39;t work.&quot; Why not?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 2, "creation_date": 1536267121, "post_id": 52211831, "comment_id": 91373315, "body": "@M.Aroosi: mind that <code>bar</code> is a monadic type here, it is <i>not</i> <code>return (bar x y)</code>, but simply <code>bar x y</code>."}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 1, "creation_date": 1536267152, "post_id": 52211831, "comment_id": 91373324, "body": "right, you could use <code>liftA2</code> and <code>join</code> tho."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1536268266, "post_id": 52211831, "comment_id": 91373783, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52147265/replacing-do-by-for-a-scotty-post\">Replacing do by &gt;&gt;= for a scotty post</a>"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1536273409, "post_id": 52211831, "comment_id": 91375406, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8019670/desugaring-do-notation-for-monads\">Desugaring do-notation for Monads</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1536290405, "post_id": 52211831, "comment_id": 91378716, "body": "For this function, <code>foo xs = bar &lt;$&gt; xs &lt;*&gt; xs</code> would appear to suffice, since <code>x</code> and <code>y</code> are independent of each other. This is what you would get with the <code>ApplicativeDo</code> extension."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1536267305, "last_edit_date": 1536267305, "creation_date": 1536266992, "answer_id": 52211977, "question_id": 52211831, "link": "https://stackoverflow.com/questions/52211831/is-it-possible-write-this-code-without-using-do-notation/52211977#52211977", "title": "Is it possible write this code without using do notation?", "body": "<p>we can use the algorithmic conversion from do-blocks, as described in the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-470003.14\" rel=\"noreferrer\">Haskell report</a>:</p>\n\n<pre><code>foo :: [MType] -&gt; [MType]\nfoo xs = xs &gt;&gt;= \\x -&gt; xs &gt;&gt;= \\y -&gt; bar x y\n</code></pre>\n\n<p>But we can reduce the amount of lambda-expressions, by omitting the <code>y</code> variable:</p>\n\n<pre><code>foo :: [MType] -&gt; [MType]\nfoo xs = xs &gt;&gt;= \\x -&gt; xs &gt;&gt;= bar x\n</code></pre>\n\n<p>and we can omit the <code>x</code> variable as well, by writing <code>\\x -&gt; xs &gt;&gt;= bar x</code> as <code>(xs &gt;&gt;=) . bar</code></p>\n\n<pre><code>foo :: [MType] -&gt; [MType]\nfoo xs = xs &gt;&gt;= ((xs &gt;&gt;=) . bar)\n</code></pre>\n\n<p>Or like <a href=\"https://stackoverflow.com/questions/52211831/is-it-possible-write-this-code-without-using-do-notation/52211977#comment91373324_52211831\">@M.Aroosi</a> says, we can use a combination of <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Control-Monad.html#v:join\" rel=\"noreferrer\"><strong><code>join :: Monad m =&gt; m (m a) -&gt; m a</code></strong></a> and <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Control-Applicative.html#v:liftA2\" rel=\"noreferrer\"><strong><code>liftA2 :: Applicative f =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c</code></strong></a>:</p>\n\n<pre><code>foo :: [MType] -&gt; [MType]\nfoo xs = join (liftA2 bar xs xs)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 3933810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e5d2d64435fc63c6483fcc84a3aeec34?s=128&d=identicon&r=PG&f=1", "display_name": "Camsbury", "link": "https://stackoverflow.com/users/3933810/camsbury"}, "is_accepted": false, "score": 2, "last_activity_date": 1536320772, "creation_date": 1536320772, "answer_id": 52221908, "question_id": 52211831, "link": "https://stackoverflow.com/questions/52211831/is-it-possible-write-this-code-without-using-do-notation/52221908#52221908", "title": "Is it possible write this code without using do notation?", "body": "<p>You may also use the following pattern for varying arities for <code>bar</code>:</p>\n\n<p>Arity 2</p>\n\n<pre><code>-- bar :: [MType] -&gt; [MType]\nfoo :: [MType] -&gt; [MType]\nfoo xs = join $ bar &lt;$&gt; xs &lt;*&gt; xs\n</code></pre>\n\n<p>Arity 3</p>\n\n<pre><code>-- bar :: [MType] -&gt; [MType] -&gt; [MType]\nfoo :: [MType] -&gt; [MType]\nfoo xs = join $ bar &lt;$&gt; xs &lt;*&gt; xs &lt;*&gt; xs\n</code></pre>\n\n<p>and so on.</p>\n\n<p>I like this as it is easier to extend than the hardcoded <code>liftA2</code>.</p>\n"}], "owner": {"reputation": 1972, "user_id": 1747134, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/696bad3bd2c5e16ded04f3cdf436623f?s=128&d=identicon&r=PG", "display_name": "user1747134", "link": "https://stackoverflow.com/users/1747134/user1747134"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 52211977, "answer_count": 2, "score": 0, "last_activity_date": 1536320772, "creation_date": 1536266215, "question_id": 52211831, "link": "https://stackoverflow.com/questions/52211831/is-it-possible-write-this-code-without-using-do-notation", "title": "Is it possible write this code without using do notation?", "body": "<p>I have some function</p>\n\n<pre><code>bar :: MyType -&gt; MyType -&gt; [MyType]\n</code></pre>\n\n<p>I would like to have another function:</p>\n\n<pre><code>foo :: [MyType] -&gt; [MyType]\nfoo xs = do x &lt;- xs\n            y &lt;- xs\n            bar x y\n</code></pre>\n\n<p>Is it possible to write <code>foo</code> without using the <code>do</code> notation? I was thinking about something like <code>liftA2</code> but that won't work.</p>\n"}, {"tags": ["haskell", "alias", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 10928, "user_id": 1358308, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d9448dee25fd2278def77cb7f0353574?s=128&d=identicon&r=PG", "display_name": "Sam Mason", "link": "https://stackoverflow.com/users/1358308/sam-mason"}, "edited": false, "score": 0, "creation_date": 1536246425, "post_id": 52205666, "comment_id": 91363448, "body": "if you want to get it even shorter you could then enter <code>rLBS = LBS.readFile</code> or whatever &quot;alias&quot; you prefer"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1536246851, "post_id": 52205666, "comment_id": 91363725, "body": "Note (not necessarily obvious) if you import multiple modules with the same <code>as</code> name their namespaces basically get merged."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1536248146, "post_id": 52205666, "comment_id": 91364530, "body": "@Cubic Thanks for the suggestion. I&#39;ve put a link to some further discussion of imports."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1536248125, "last_edit_date": 1536248125, "creation_date": 1536241944, "answer_id": 52205666, "question_id": 52205585, "link": "https://stackoverflow.com/questions/52205585/how-to-use-alias-in-ghci/52205666#52205666", "title": "How to use alias in GHCI", "body": "<p>Modern ghci supports the full <code>import</code> syntax, so you could e.g.</p>\n\n<pre><code>&gt; import qualified Data.ByteString.Lazy as LBS\nLBS&gt; LBS.writeFile \"foo\" (LBS.pack [104,105,10])\nLBS&gt; LBS.readFile \"foo\"\n\"hi\\n\"\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/a/8331995/791604\">another answer of mine</a> for an in-depth discussion of the things you can do with <code>import</code> syntax.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 52205666, "answer_count": 1, "score": 0, "last_activity_date": 1536248125, "creation_date": 1536241693, "question_id": 52205585, "link": "https://stackoverflow.com/questions/52205585/how-to-use-alias-in-ghci", "title": "How to use alias in GHCI", "body": "<p>Hello i am confronted with the following problem:</p>\n\n<p>I want to test Haskell libraries like <code>Data.ByteString.Lazy</code> in the <code>Ghci</code>.Do i have to always write the whole name ? \nAre there any aliases available for using in <code>GHCI</code>, because i find it very cumbersome to everytime specify if for e.g <code>readFile</code> is <code>putStrLn</code> is from <code>Prelude</code> or  <code>Data.ByteString.Lazy</code></p>\n\n<p>How does one add modules with aliases in GHCI?</p>\n"}, {"tags": ["haskell", "monads", "state-monad"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1536248442, "post_id": 52205421, "comment_id": 91364729, "body": "Your <code>Maybe&#39;</code> type is identical to the standard <code>Maybe</code>; its presence is just making it harder to focus on your real problem."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1536249025, "post_id": 52205421, "comment_id": 91365118, "body": "Start with the right type: <code>stBind&#39;&#39; :: ST a -&gt; (a -&gt; ST b) -&gt; ST b</code>."}, {"owner": {"reputation": 19024, "user_id": 286335, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6882f075e155c96b4ff0fe3bcab951f3?s=128&d=identicon&r=PG&f=1", "display_name": "cibercitizen1", "link": "https://stackoverflow.com/users/286335/cibercitizen1"}, "edited": false, "score": 0, "creation_date": 1537377434, "post_id": 52205421, "comment_id": 91765855, "body": "Maybe this could help you <a href=\"https://stackoverflow.com/questions/52379685/how-to-derive-a-state-monad-from-first-principles/52408388#52408388\" title=\"how to derive a state monad from first principles\">stackoverflow.com/questions/52379685/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1536253625, "creation_date": 1536253625, "answer_id": 52209090, "question_id": 52205421, "link": "https://stackoverflow.com/questions/52205421/haskell-unable-to-define-a-state-monad-like-function-using-a-monad-like-defini/52209090#52209090", "title": "Haskell - Unable to define a State monad like function using a Monad like definition", "body": "<p>At the risk of spoilers, it might be interesting to peak at the definition of the <code>State</code> monad as it existed before everything became transformer-ified:</p>\n\n<pre><code>newtype State s a = State { runState :: s -&gt; (a, s) }\n</code></pre>\n\n<p>That is: a stateful action with state <code>s</code> that produces a value of type <code>a</code> is a function from the old state <code>s</code> to a value and a new state, <code>(a, s)</code>.</p>\n\n<p>Starting from the correct definition for <code>State</code> should make the remainder of your development easier to puzzle through.</p>\n"}], "owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 52209090, "answer_count": 1, "score": 0, "last_activity_date": 1536253625, "creation_date": 1536241246, "last_edit_date": 1536242484, "question_id": 52205421, "link": "https://stackoverflow.com/questions/52205421/haskell-unable-to-define-a-state-monad-like-function-using-a-monad-like-defini", "title": "Haskell - Unable to define a State monad like function using a Monad like definition", "body": "<p>I am trying to understand the concept of Monad by attempting to write generic version of functions that might be then include side effects to log, change state.</p>\n\n<p>Here is what I came up with: (The code is bit long, but it is there to show how I approached understanding monad - and this approach may not be correct)</p>\n\n<pre><code>data Maybe' a = Nothing' | Just' a deriving Show\n\nsqrt' :: (Floating a, Ord a) =&gt; a -&gt; Maybe' a\nsqrt' x = if x &lt; 0 then Nothing' else Just' (sqrt x)\n\n\ninv' :: (Floating a, Ord a) =&gt; a -&gt; Maybe' a\ninv' x = if x == 0 then Nothing' else Just' (1/x)\n\nlog' :: (Floating a, Ord a) =&gt; a -&gt; Maybe' a\nlog' x = if x == 0 then Nothing' else Just' (log x)\n\n\nsqrtInvLog' :: (Floating a, Ord a) =&gt; a -&gt; Maybe' a\nsqrtInvLog' x = case (sqrt' x) of\n                 Nothing' -&gt; Nothing'\n                 (Just' y) -&gt; case (inv' y) of\n                               Nothing' -&gt; Nothing'\n                               (Just' z) -&gt; log' z\n\n-- Now attempt to simplify the nested case:\nfMaybe' :: (Maybe' a) -&gt; (a -&gt; Maybe' b) -&gt; Maybe' b\nfMaybe' Nothing' _ = Nothing'\nfMaybe' (Just' x) f = f x\n\n-- using fMaybe':\nsqrtInvLog'' :: (Floating a, Ord a) =&gt; a -&gt; Maybe' a\nsqrtInvLog'' x = (sqrt' x) `fMaybe'` (inv') `fMaybe'` (log')\n\n-- now we can generalize the concept to any type, instead of just Maybe' by defining a Monad =&gt;\nclass Monad' m where\n bind' :: m a -&gt; (a -&gt; m b) -&gt; m b\n return' :: a -&gt; m a\n\ninstance Monad' Maybe' where\n bind' Nothing' _ = Nothing'\n bind' (Just' x) f = f x\n return' x = Just' x\n\n-- using Monad sqrtInvLog'' can be written as:\nsqrtInvLog''' :: (Floating a, Ord a) =&gt; a -&gt; Maybe' a\nsqrtInvLog''' x = (sqrt' x) `bind'` (inv') `bind'` (log')\n\n-- Further lets attempt to use this for state maintenence and logging, logging:\n-- first attempt the specific version:\ndata ST a = ST (a, Maybe' a) deriving Show\n\nsqrtSt :: (Floating a, Ord a)=&gt; a -&gt; a -&gt; ST a\nsqrtSt st x = let r = sqrt' x in case r of\n                                  Nothing' -&gt; ST (st, Nothing')\n                                  (Just' y) -&gt; ST (st+y, (Just' y))\n\n\ninvSt :: (Floating a, Ord a)=&gt; a -&gt; a -&gt; ST a\ninvSt st x = let r = inv' x in case r of\n                                  Nothing' -&gt; ST (st, Nothing')\n                                  (Just' y) -&gt; ST (st+y, (Just' y))\n\n\nlogSt :: (Floating a, Ord a)=&gt; a -&gt; a -&gt; ST a\nlogSt st x = let r = log' x in case r of\n                                  Nothing' -&gt; ST (st, Nothing')\n                                  (Just' y) -&gt; ST (st+y, (Just' y))\n\n-- let us first define function which is similar to bind and manipulates the state and invokes the given function:\nstBind :: (Floating a, Ord a) =&gt; ST a -&gt; (a-&gt;a-&gt;ST a) -&gt; ST a\nstBind (ST (a, Nothing')) _ = ST (a, Nothing')\nstBind (ST (s, (Just' y))) f = f s y\n\nsqrtInvLogSt :: (Floating a, Ord a) =&gt; a -&gt; a -&gt; ST a\nsqrtInvLogSt st x = (sqrtSt st x) `stBind` (invSt) `stBind` (logSt)\n\n-- stBind does not fit the pattern of bind\n\n-- Another version:\n\nsqrtSt' :: (Floating a, Ord a)=&gt; ST a -&gt; ST a\nsqrtSt' (ST (st, Nothing')) = ST (st, Nothing')\nsqrtSt' (ST (st, (Just' x))) = let r = sqrt' x in case r of\n                                                  Nothing' -&gt; ST (st, Nothing')\n                                                  (Just' y) -&gt; ST (st+y, (Just' y))\n\n\n\ninvSt' :: (Floating a, Ord a)=&gt; ST a -&gt; ST a\ninvSt' (ST (st, Nothing')) = ST (st, Nothing')\ninvSt' (ST (st, (Just' x))) = let r = inv' x in case r of\n                                                  Nothing' -&gt; ST (st, Nothing')\n                                                  (Just' y) -&gt; ST (st+y, (Just' y))\n\n\nlogSt' :: (Floating a, Ord a)=&gt; ST a -&gt; ST a\nlogSt' (ST (st, Nothing')) = ST (st, Nothing')\nlogSt' (ST (st, (Just' x))) = let r = log' x in case r of\n                                                  Nothing' -&gt; ST (st, Nothing')\n                                                  (Just' y) -&gt; ST (st+y, (Just' y))\n\n-- define stBind' here\nstBind' :: (Floating a, Ord a) =&gt; ST a -&gt; (ST a-&gt;ST a) -&gt; ST a\nstBind' (ST (a, Nothing')) _ = ST (a, Nothing')\nstBind' stx f = f stx\n\nsqrtInvLogSt' :: (Floating a, Ord a) =&gt; ST a-&gt;ST a\nsqrtInvLogSt' stx = (sqrtSt' stx) `stBind'` (invSt') `stBind'` (logSt')\n\n-- Even this does not fit the pattern of bind,\n</code></pre>\n\n<p>The function stBind' defined in the end does not fit the pattern of bind'. \nHow can I come up with an implementation in this situation to match the bind operator signature?</p>\n"}, {"tags": ["haskell", "lambda"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536236771, "post_id": 52204053, "comment_id": 91357203, "body": "Why do you here use <code>aRboto (..)</code>? in `printRobot?"}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536236925, "post_id": 52204053, "comment_id": 91357294, "body": "So I can choose which robot to print? aRobot is just a variable?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536236989, "post_id": 52204053, "comment_id": 91357334, "body": "Well you make it rather hard to understand by not using a <code>data</code>type, but representing a fobot essentially as a function that maps a function that maps 3-tuple to something, to that something. Although that is essentially how one &quot;stores&quot; data in lambda calculus, it here makes things a lot more complicated."}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536237083, "post_id": 52204053, "comment_id": 91357383, "body": "ah, yeah I can understand that.. this is my second attempt to learn and understand haskell and the book hasn&#39;t come to datatypes yet so I just stay out of it until it says otherwise."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1536262856, "post_id": 52204053, "comment_id": 91371610, "body": "What book is this?"}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "edited": false, "score": 0, "creation_date": 1536491868, "post_id": 52204053, "comment_id": 91436236, "body": "&quot;Get programming with haskell&quot;, but I have to say that Datatypes started right after this chapter."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "edited": false, "score": 0, "creation_date": 1536237418, "post_id": 52204181, "comment_id": 91357585, "body": "Oh, that makes total sense but the first line you gave me I have already tried before. It doesn&#39;t work. I get this &quot;Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018printRobot\u2019&quot; when I do that. And the second line I can&#39;t do because I&#39;m working with lambdas and trying to understand what the book means by overwriting variables with nested lambdas :/. Either way your explanation helped me understand a little bit better."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "edited": false, "score": 0, "creation_date": 1536238180, "post_id": 52204181, "comment_id": 91358062, "body": "@ruubel Ambiguous type variables arise when your code does not clearly specify which types to use. I&#39;d recommend to annotate your source code, adding an explicit type signature to all the top-level functions (or at least enough of them). Often, that fixes many issues."}, {"owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "edited": false, "score": 0, "creation_date": 1536238656, "post_id": 52204181, "comment_id": 91358365, "body": "Yeah, I totally agree. I think it&#39;s weird that the book hasn&#39;t covered that yet. It just told me to do these exercises without them. Thank you for your help."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 7, "last_activity_date": 1536237078, "creation_date": 1536237078, "answer_id": 52204181, "question_id": 52204053, "link": "https://stackoverflow.com/questions/52204053/no-instance-for-show-in-lambda-function/52204181#52204181", "title": "No instance for show, in Lambda function?", "body": "<p>The line</p>\n\n<pre><code>threeRoundFight a b = (\\a b -&gt; printRobot (fight a b))\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>threeRoundFight x y = (\\a b -&gt; printRobot (fight a b))\n             -- ^^^ unused variables\n</code></pre>\n\n<p>(If you enable warnings, GHC helps you in detecting this error) </p>\n\n<p>This is not what you want. You likely want</p>\n\n<pre><code>threeRoundFight = (\\a b -&gt; printRobot (fight a b))\n-- or\nthreeRoundFight a b = printRobot (fight a b)\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 7618600, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e78a3aacdad2310fbe5f263f1f754b3?s=128&d=identicon&r=PG&f=1", "display_name": "ruubel", "link": "https://stackoverflow.com/users/7618600/ruubel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1536237078, "creation_date": 1536236593, "question_id": 52204053, "link": "https://stackoverflow.com/questions/52204053/no-instance-for-show-in-lambda-function", "title": "No instance for show, in Lambda function?", "body": "<p>This works fine in ghci:</p>\n\n<pre><code>printRobot (fight killerRobot gentleGiant)\n</code></pre>\n\n<p><strong>But this throws me a \"No instance for show\" error, and I can't seem to see why.</strong></p>\n\n<pre><code>threeRoundFight a b = \n(\\a b -&gt; printRobot (fight a b))\n</code></pre>\n\n<p>This is the error:</p>\n\n<pre><code>\u2022 No instance for (Show\n                     ((((t40, t50, t50) -&gt; t50) -&gt; t60)\n                      -&gt; (((t20, t10, t60) -&gt; ((t20, t10, t60) -&gt; t0) -&gt; t0)\n                          -&gt; (([Char], a10, a0) -&gt; [Char]) -&gt; t30)\n                      -&gt; t30))\n    arising from a use of \u2018print\u2019\n    (maybe you haven't applied a function to enough arguments?)\n\u2022 In the first argument of \u2018print\u2019, namely \u2018it\u2019\n  In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>Here is the necessary functions to consider:</p>\n\n<pre><code>fight aRobot defender = damage defender attack\nwhere attack = if getHP aRobot &gt; 10\n            then getAttack aRobot\n            else 0\n\nprintRobot aRobot = aRobot(\\(n,a,h)-&gt;n ++ \" attack:\" ++ (show a) ++ \" hp: \" ++ (show h))\n\nrobot (name,attack,hp) = \\message -&gt; message (name,attack,hp)\n</code></pre>\n\n<p>Here are the Robots(what I put in as parameters, namely killerRobot and gentleGiant):</p>\n\n<pre><code>killerRobot = robot (\"killer\",25,200)\ngentleGiant = robot (\"Mr.Friendly\", 10, 300)\n</code></pre>\n\n<p>Also as you can see I'm trying to make this a <strong>threeRound</strong>Fight, with the help of overwriting the robots with nested lambdas. But I can't seem to understand how to continue on from the first fight if I get it working.</p>\n"}, {"tags": ["haskell", "ghc", "ghci", "haskell-platform", "winghci"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1536234008, "post_id": 52202854, "comment_id": 91355434, "body": "If the module is named <code>Test.Test1</code>, you probably need GHCi to be in the directory just <i>above</i> the <code>Test</code> directory for this to work."}, {"owner": {"reputation": 318, "user_id": 2295871, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/dfdf75ad2a4730f1114c7b463def0596?s=128&d=identicon&r=PG", "display_name": "nbdip", "link": "https://stackoverflow.com/users/2295871/nbdip"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1536234999, "post_id": 52202854, "comment_id": 91356068, "body": "If I change the GHCi to work on the super directory. It then fails to load the Data.Test3 and Data.Test4 even if I change the format to Test.Data.Test3 and so on. But loads the Test2."}], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 3, "last_activity_date": 1536235377, "creation_date": 1536235377, "answer_id": 52203685, "question_id": 52202854, "link": "https://stackoverflow.com/questions/52202854/is-it-not-possible-to-import-modules-from-another-module-if-they-are-in-the-same/52203685#52203685", "title": "Is it not possible to import modules from another module if they are in the same dir? (Haskell)", "body": "<p>You need to decide where your root directory is, run GHCi from that directory, and then consistently name all your modules relative to that same directory.</p>\n\n<p>You need to name your modules consistently both in the module declaration (<code>module Foo where...</code>) <em>and</em> in the import statements (<code>import Foo</code>).</p>\n\n<p>So you need <em>either</em>:</p>\n\n<pre><code>module Test.Test1 where\n\nimport Test.Data.Test3\nimport Test.Data.Test4\nimport Test.Test2\n</code></pre>\n\n<p><em>or</em> run GHCi from inside <code>Test</code> and remove all the <code>Test</code> prefixes. But you can't have the prefix on some but not others. You have to be consistent everywhere. Each module name is basically a file path from the current directory to where the source file is.</p>\n"}], "owner": {"reputation": 318, "user_id": 2295871, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/dfdf75ad2a4730f1114c7b463def0596?s=128&d=identicon&r=PG", "display_name": "nbdip", "link": "https://stackoverflow.com/users/2295871/nbdip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 52203685, "answer_count": 1, "score": -1, "last_activity_date": 1536235377, "creation_date": 1536232526, "question_id": 52202854, "link": "https://stackoverflow.com/questions/52202854/is-it-not-possible-to-import-modules-from-another-module-if-they-are-in-the-same", "title": "Is it not possible to import modules from another module if they are in the same dir? (Haskell)", "body": "<p>To demonstrate my question, I've created a test project like this -></p>\n\n<p><a href=\"https://i.stack.imgur.com/gFTT9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gFTT9.png\" alt=\"enter image description here\"></a></p>\n\n<p>The directory \"Data\" has only 2 modules, namely \"Test3.hs\" and \"Test4.hs\". They are empty modules for test purposes. (implementation: \"module Data.Test3 where\" )</p>\n\n<p>\"Test1.hs\" imports all the modules like this -></p>\n\n<p><a href=\"https://i.stack.imgur.com/gqx2K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gqx2K.png\" alt=\"enter image description here\"></a></p>\n\n<p>which results in an error -></p>\n\n<p><a href=\"https://i.stack.imgur.com/rg1Vl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rg1Vl.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am using WinGHCi to import the modules, which automatically changes the directory to \"cd: ~\\.hs\".</p>\n\n<p>I also tried to import the modules by using GHCi and by manually changing the dir. But ended up with the same result as above.</p>\n\n<p>So I come to conclusion that there is no way of importing your own modules from the same directory and you have to always create sub dirs only for this purpose.</p>\n\n<p>Is that right?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1536223569, "post_id": 52200025, "comment_id": 91349060, "body": "Why not rename it to <code>introduceIdeaId</code>?"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536223611, "post_id": 52200025, "comment_id": 91349082, "body": "it adds a lot of verbosity for nothing don&#39;t you think ?"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536223655, "post_id": 52200025, "comment_id": 91349120, "body": "introduceIdeaId introduceIdea instead of id introduceIdea"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536223736, "post_id": 52200025, "comment_id": 91349169, "body": "then I don&#39;t understand why it clashes when it&#39;s applied to a specific type."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536223784, "post_id": 52200025, "comment_id": 91349202, "body": "Because you introduce two (or more) <code>id</code> functions, toogether with the <code>id</code> function of the <i>prelude</i>. The one has a <code>a -&gt; a</code> signature, the other a <code>IntroduceIdea -&gt; UUID</code>"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536223858, "post_id": 52200025, "comment_id": 91349234, "body": "can&#39;t we have 2 functions with the same name but with a different signatures ?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1536223907, "post_id": 52200025, "comment_id": 91349277, "body": "by default, no, since that would result in ambiguty. You can solve this by using a typeclass, like <code>f :: Foo x =&gt; x -&gt; Int</code> for example. This is more or less how you can <i>emulate</i> the <code>DuplicateRecordFields</code>: for every property you define a typeclass, like <code>class Idable a where id :: a -&gt; UUID</code>, or even <code>class Idable a b where id :: a -&gt; b</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1536240296, "post_id": 52200025, "comment_id": 91359348, "body": "Functions don&#39;t have names; rather, you can bind one or more names <i>to</i> an otherwise anonymous function. The name itself just refers to <i>a</i> value, with no information about what that value is stored with the name."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1536240451, "post_id": 52200025, "comment_id": 91359450, "body": "Language extensions are commonly used; don&#39;t feel bad about having lots of them. (There are jokes about a module being a toy example unless the extension list is longer than the actual code.) With any luck, the next Haskell standard will include many of the GHC-contributed extensions, letting you drop those pragmas."}], "answers": [{"comments": [{"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1536242244, "post_id": 52201075, "comment_id": 91360562, "body": "can I get something more flexible by using the libray Lens ? I&#39;m reading about it now..."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1536242387, "post_id": 52201075, "comment_id": 91360677, "body": "@NicolasHenin I don&#39;t <i>think</i> so; lenses aren&#39;t my forte, so I could be wrong, but I think that lenses need to have unique names as well."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1536245456, "post_id": 52201075, "comment_id": 91362792, "body": "<code>One of Haskell\u2019s most egregious shortcomings is that you can\u2019t use the same field name in different record types. I\u2019ll explain how we are planning to fix that (joint work with Adam Gundry), and how the result will fit nicely into the lens world.</code> <a href=\"https://skillsmatter.com/skillscasts/4251-lenses-compositional-data-access-and-manipulation\" rel=\"nofollow noreferrer\">skillsmatter.com/skillscasts/&hellip;</a>"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1536245496, "post_id": 52201075, "comment_id": 91362821, "body": "I don&#39;t have a concrete example about how but I&#39;m still searching about it :-)"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1536251497, "post_id": 52201075, "comment_id": 91366429, "body": "@NicolasHenin Lens won&#39;t allow you to create record fields with the same name, but it&#39;ll allow you to create <i>lenses</i> with the same name that can refer to similar fields in different types of records."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 2, "last_activity_date": 1536226638, "creation_date": 1536226638, "answer_id": 52201075, "question_id": 52200025, "link": "https://stackoverflow.com/questions/52200025/my-record-field-name-clashes-with-other-record-fields-in-the-same-scope/52201075#52201075", "title": "My record field name clashes with other record fields in the same scope", "body": "<p>Willem Van Onsem's suggestion of naming it <code>introduceIdeaId</code> seems to me the most idiomatic solution. This took me some time to get used to, coming from C# and F#, where objects and records are typically made up from class fields or record properties.</p>\n\n<p>In such languages, you can't really refer to such fields or properties without the record to which they're attached, so 'repeating' the name of the 'object' in the name of the field seems redundant.</p>\n\n<p>In Haskell, data records are made up of a collection of <em>functions</em>. Specifically, that label would be this function:</p>\n\n<pre><code>&gt; :t introduceIdeaId\nintroduceIdeaId :: IntroduceIdea -&gt; UUID\n</code></pre>\n\n<p>It's a function that takes an <code>IntroduceIdea</code> value as input, and returns a <code>UUID</code> as output.</p>\n\n<p>That data labels are 'real' functions can be useful when composing functions. For example, if you have a (small) list of <code>IntroduceIdea</code> values (<code>x</code> and <code>y</code>), you can extract the <code>introduceIdeaId</code> labels and turn them into <code>String</code> values in point-free style:</p>\n\n<pre><code>&gt; fmap (show . introduceIdeaId) [x, y]\n[\"c44a4cb1-f494-46b5-9459-9a022d364bfa\",\"f3de5def-0bad-46a7-b3a2-604c7ecd54e6\"]\n</code></pre>\n\n<p>Here, <code>introduceIdeaId</code> is used as the function that it is. The name has to be unambiguous. Had we used the name <code>id</code>, it wouldn't have been clear if we meant <code>IntroduceIdea -&gt; UUID</code> or <code>a -&gt; a</code>.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1536226854, "creation_date": 1536223459, "last_edit_date": 1536226854, "question_id": 52200025, "link": "https://stackoverflow.com/questions/52200025/my-record-field-name-clashes-with-other-record-fields-in-the-same-scope", "title": "My record field name clashes with other record fields in the same scope", "body": "<p>I have create the following data type :</p>\n\n<pre><code>data IntroduceIdea = IntroduceIdea { id :: UUID , userId ::UUID , createdOn :: UTCTime,\n                                 ideaContent :: String } deriving (Eq,Show)\n</code></pre>\n\n<p>I have clashes with the prelude (with the id field)... so I have added the extension <code>{-# LANGUAGE DuplicateRecordFields #-}</code> but it feels wrong to me to paste it everywhere I use it...do you have better solution ?   </p>\n"}, {"tags": ["postgresql", "haskell"], "comments": [{"owner": {"reputation": 249, "user_id": 1722399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e98942645afd09fdd8e00853bff4f2?s=128&d=identicon&r=PG", "display_name": "xafizoff", "link": "https://stackoverflow.com/users/1722399/xafizoff"}, "edited": false, "score": 0, "creation_date": 1536220180, "post_id": 52198898, "comment_id": 91347097, "body": "It seems that the problem is with leading <code>\\NUL</code>s."}], "answers": [{"tags": [], "owner": {"reputation": 249, "user_id": 1722399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e98942645afd09fdd8e00853bff4f2?s=128&d=identicon&r=PG", "display_name": "xafizoff", "link": "https://stackoverflow.com/users/1722399/xafizoff"}, "is_accepted": false, "score": 3, "last_activity_date": 1536221042, "creation_date": 1536221042, "answer_id": 52199322, "question_id": 52198898, "link": "https://stackoverflow.com/questions/52198898/how-to-insert-bytea-value-using-postgresql-simple-in-haskell/52199322#52199322", "title": "How to insert bytea value using postgresql-simple in Haskell", "body": "<p>Fixed by replacing the line</p>\n\n<pre><code>execute conn \"INSERT INTO users(val) values(?)\" $ Only encoded\n</code></pre>\n\n<p>with</p>\n\n<pre><code>execute conn \"INSERT INTO users(val) values(?)\" $ Only $ Binary encoded\n</code></pre>\n\n<p>It's because <code>toField(ByteString)</code> yields <code>Escape</code> whereas <code>toField(Binary ByteString)</code> yields <code>EscapeByteA</code></p>\n"}], "owner": {"reputation": 249, "user_id": 1722399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e98942645afd09fdd8e00853bff4f2?s=128&d=identicon&r=PG", "display_name": "xafizoff", "link": "https://stackoverflow.com/users/1722399/xafizoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1536221042, "creation_date": 1536219646, "question_id": 52198898, "link": "https://stackoverflow.com/questions/52198898/how-to-insert-bytea-value-using-postgresql-simple-in-haskell", "title": "How to insert bytea value using postgresql-simple in Haskell", "body": "<p>I have a table defined as</p>\n\n<pre><code>CREATE TABLE users (id SERIAL PRIMARY KEY, val BYTEA);\n</code></pre>\n\n<p>Then I want to serialize my data structure with <code>binary</code> and store in the table, and then retrieve and deserialize back.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings, DeriveAnyClass #-}\nimport Control.Monad (forM_)\nimport Data.Binary (encode, decode, Binary)\nimport Database.PostgreSQL.Simple\nimport GHC.Generics (Generic)\n\ndata User = { name :: Text, email :: Text } deriving (Show, Generic, Binary)\nmain = do\n  conn &lt;- connect --...\n  let encoded = encode User {name = \"me\", email = \"me@home.net\" }\n  execute conn \"INSERT INTO users(val) values(?)\" $ Only encoded\n  rs &lt;- query_ conn \"SELECT id, val FROM users\"\n  forM_ rs $ \\(id,val) -&gt;\n    putStrLn $ (show (id :: Int)) ++ \": \" ++ show (decode val :: User)\n</code></pre>\n\n<p>But I get error <code>Data.Binary.Get.runGet at position 0: not enough bytes</code>.</p>\n\n<p>Query</p>\n\n<pre><code>SELECT * FROM users;\n</code></pre>\n\n<p>gives</p>\n\n<pre><code> id | val \n----+-----\n  1 | \\x\n</code></pre>\n\n<p>I can't figure out how to map <code>ByteString</code>s to 'BYTEA`s. According to the <a href=\"http://hackage.haskell.org/package/postgresql-simple-0.5.4.0/docs/Database-PostgreSQL-Simple.html\" rel=\"nofollow noreferrer\">docs</a> everything should be OK. What am I doing wrong?</p>\n"}, {"tags": ["parsing", "haskell", "megaparsec"], "comments": [{"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1536220955, "post_id": 52198620, "comment_id": 91347555, "body": "Combinator <a href=\"http://hackage.haskell.org/package/parser-combinators-1.0.0/docs/Control-Monad-Combinators.html#v:sepBy1\" rel=\"nofollow noreferrer\"><code>sepBy1</code></a> should fulfill your needs, you then just need to convert a non-empty list into <code>Foo</code>."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 6, "last_activity_date": 1536220978, "creation_date": 1536220978, "answer_id": 52199303, "question_id": 52198620, "link": "https://stackoverflow.com/questions/52198620/recursive-parser/52199303#52199303", "title": "Recursive Parser", "body": "<blockquote>\n  <p>it does not parse any Dotted, because the first option always succeeds parsing the first piece of the string.</p>\n</blockquote>\n\n<p>That problem can be fixed easily enough by changing the order of your alternatives. Generally, whenever you have an alternative that can always match, that alternative must come last.</p>\n\n<p>However this will only lead you to your next problem: Your <code>Dotted</code> parser is left-recursive, which parsec does not support, meaning it will lead to an infinite recursion once its actually reached.</p>\n\n<p>Generally when we want to use a left-recursive grammar with a parsing algorithm that does not handle left-recursion, we replace the recursion with repetition and then perform a left-fold on the resulting list. So given the original grammar:</p>\n\n<pre><code>foo ::= alphanum\n      | foo \".\" alphanum\n</code></pre>\n\n<p>We can rewrite it using repetition like this:</p>\n\n<pre><code>foo ::= alphanum (\".\" alphanum)*\n</code></pre>\n\n<p>Now the most direct translation to Parsec would use <code>many</code> for the <code>*</code> and then left-fold the resulting list. However, we might notice that the pattern <code>rule (\"seperator\" rule)*</code> can be more simply matched by <code>sepBy1</code>. So this gives us:</p>\n\n<pre><code>fooParser =\n  do\n    first : rest &lt;- sepBy1 alphanum $ constant \".\"\n    return $ foldl Dotted (Simple first) rest\n</code></pre>\n"}], "owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 52199303, "answer_count": 1, "score": 4, "last_activity_date": 1536220978, "creation_date": 1536218655, "question_id": 52198620, "link": "https://stackoverflow.com/questions/52198620/recursive-parser", "title": "Recursive Parser", "body": "<p>I need to parse, using Megaparsec a data structure like</p>\n\n<pre><code>data Foo\n    = Simple String\n    | Dotted Foo String\n</code></pre>\n\n<p>where I can have alphanumeric strings separated by dots.</p>\n\n<p>For example <code>abc</code> should be parsed to <code>Simple \"abc\"</code> and <code>abc.def</code> to <code>Dotted (Simple \"abc\") \"def\"</code>.</p>\n\n<p>My parser at the moment is like</p>\n\n<pre><code>fooParser :: Parser Foo\nfooParser\n    = Simple &lt;$&gt; alphaNum\n    &lt;|&gt; do\n        foo &lt;- fooParser\n        constant \".\"\n        end &lt;- alphaNum\n        pure $ Dotted foo end\n</code></pre>\n\n<p>This works fine for <code>Simple</code>, but it does not parse any <code>Dotted</code>, because the first option always succeeds parsing the first piece of the string.</p>\n\n<p>Which is the best option to fix my parser?</p>\n"}, {"tags": ["haskell", "primes"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1536208305, "post_id": 52196382, "comment_id": 91342282, "body": "Please post the actual code you are using. The code you have provided has at least one syntax error and could not possibly produce one prime let alone 34 of them.  Also, if you are discussing performance then please include the way you are compiling and/or running the code presented."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1536208458, "post_id": 52196382, "comment_id": 91342315, "body": "Also, 35 is not prime so you should think about this algorithm some and why it produces 35... then fix the algorithm."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1536208484, "post_id": 52196382, "comment_id": 91342323, "body": "@ThomasM.DuBuisson It actually works fairly well, if only you disregard the obvious capitalization error."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 3, "creation_date": 1536208597, "post_id": 52196382, "comment_id": 91342352, "body": "@IgnatInsarov Oh I&#39;m well aware of the fix, but it proves the code presented is not the code the asker ran.  Copy and pasting code can save all potential answerers much time and clear up lots of confusion. Best not to start answering without a clear problem."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1536208781, "post_id": 52196382, "comment_id": 91342401, "body": "@ThomasM.DuBuisson True. There are actually several less trivial problems with this question, for instance it is unclear whether number 35 is produced or only 35 numbers are produced. But I want to point out that the algorithm described by this <i>Haskell-like pseudo code</i> actually produces prime numbers, albeit not very quickly."}, {"owner": {"reputation": 31, "user_id": 6880337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23da12cfccda50beca37c48081536ce7?s=128&d=identicon&r=PG&f=1", "display_name": "stephan", "link": "https://stackoverflow.com/users/6880337/stephan"}, "edited": false, "score": 0, "creation_date": 1536213216, "post_id": 52196382, "comment_id": 91343833, "body": "sorry for inconvenience actulally the code compile and run but after maybe 5 numbers it&#39;s stop."}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 1, "creation_date": 1536217295, "post_id": 52196382, "comment_id": 91345608, "body": "@WillemVanOnsem <a href=\"https://www.wolframalpha.com/input/?i=10!+mod+11\" rel=\"nofollow noreferrer\">Actually</a> it&#39;s correct(because <a href=\"https://en.wikipedia.org/wiki/Wilson%27s_theorem\" rel=\"nofollow noreferrer\">Wilson&#39;s theorem</a>). But the problem is because he&#39;s using <code>Int</code>s and the product overflows past a certain number (for 64-bit systems it overflows at n=22). Trying to formulate an answer to clearly explain it."}], "answers": [{"tags": [], "owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "is_accepted": false, "score": 4, "last_activity_date": 1536218245, "creation_date": 1536218245, "answer_id": 52198492, "question_id": 52196382, "link": "https://stackoverflow.com/questions/52196382/haskell-prime-numbers/52198492#52198492", "title": "Haskell prime numbers", "body": "<p>The problem of not finding primes larger than 19 stems from the line</p>\n\n<pre><code>primeach :: [Int]\n</code></pre>\n\n<p>This is because you have to calculate <code>product [1..n-1]</code> for those numbers. This overflows when <code>n &gt;= 22</code>, since <code>Int</code> is (usually) a 64-bit number under the hood in 64-bit systems (it's guaranteed to have at least 30 bits), in 32-bit systems with 32-bit <code>Int</code> it will overflow at <code>n &gt;= 14</code>.<br>\nSince it overflows, your are no longer taking the correct remainder anymore.<br>\nFor example, with 64-bit signed integers, we have for <code>n=23</code> (which is prime):</p>\n\n<pre><code>Prelude&gt; product [1..22]\n1124000727777607680000 :: Integer\nPrelude&gt; product [1..22] :: Int\n-1250660718674968576 :: Int\nPrelude&gt; product [1..22] `rem` 23\n22 :: Integer\nPrelude&gt; product [1..22] `rem` 23 :: Int\n-22 :: Int\n</code></pre>\n\n<p>As you can see, this no longer works because of the overflow.\nAnother example would be <code>n=29</code> which is also prime:  </p>\n\n<pre><code>Prelude&gt; product [1..28]\n304888344611713860501504000000 :: Integer\nPrelude&gt; product [1..28] :: Int\n-5968160532966932480 :: Int\nPrelude&gt; product [1..28] `rem` 29\n28 :: Integer\nPrelude&gt; product [1..28] `rem` 29 :: Int\n-27 :: Int\n</code></pre>\n\n<p>So this shows that it's not even a simple sign flip.</p>\n\n<p>You have 2 options:</p>\n\n<ul>\n<li><p>If you want to use this algorithm, switch to <code>Integer</code>s (Even if only for the <code>product</code> calculation), those will never overflow:</p>\n\n<pre><code>primeach :: [Int]\nprimeach = [fromInteger n | n &lt;- [2..] , product [1..n-1] `rem` n == n-1]\n</code></pre></li>\n<li><p>Use a different algorithm, or consider using an existing package for primes.</p></li>\n</ul>\n"}], "owner": {"reputation": 31, "user_id": 6880337, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23da12cfccda50beca37c48081536ce7?s=128&d=identicon&r=PG&f=1", "display_name": "stephan", "link": "https://stackoverflow.com/users/6880337/stephan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1536218245, "creation_date": 1536207018, "last_edit_date": 1536213081, "question_id": 52196382, "link": "https://stackoverflow.com/questions/52196382/haskell-prime-numbers", "title": "Haskell prime numbers", "body": "<p>I want to generate infinite prime numbers but in some case it's stopping without complete the infinite list </p>\n\n<p>here is my attempt:</p>\n\n<pre><code>Primeach :: [Int]\n\nPrimeach = [n | n &lt;- [2..] , product [1..n-1] `rem` n == n-1]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1536204710, "post_id": 52195843, "comment_id": 91341592, "body": "@n.m. From Hackage, <code>while &gt;&gt;= combines the outputs of the subcomputations using mappend.</code>....  So the final value created is one giant infinite list.  You can directly see it in the <code>print</code> output, which is always in the form of an unfinished list <code>[1,2,3....</code>, which no closing bracket."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536205007, "post_id": 52195843, "comment_id": 91341648, "body": "I&#39;m sorry I haven&#39;t woke up yet. Please disregard."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1536206080, "post_id": 52195843, "comment_id": 91341866, "body": "Obviously applications of mappend cannot be left-nested as claimed in the linked article."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 2, "creation_date": 1536213961, "post_id": 52195843, "comment_id": 91344110, "body": "IIUC, the real reason <code>WriterT</code> is considered bad (compared to <code>StateT</code>) is that you end up with a <code>mappend</code> on <i>every</i> bind, not just ones that produce writer output. In contrast, a <code>StateT</code> computation that never touches the state just threads the value along untouched. The constant uses of <code>mappend</code> on <code>mempty</code> end up being unnecessarily expensive in real programs, since <code>tell</code> is used infrequently relative to other monadic actions in a transformer stack, but it wouldn\u2019t matter in a toy program like this, since every action is a <code>tell</code>."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1536230746, "post_id": 52197390, "comment_id": 91353453, "body": "As for solutions, using a <a href=\"http://hackage.haskell.org/package/dlist\" rel=\"nofollow noreferrer\"><code>dlist</code></a> as the underlying monoid solves the first problem (nesting). I don&#39;t think it solves the second (keeping the log in memory)\u2013\u2013I don&#39;t know of any good solution to the second... curious about it"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1536246420, "post_id": 52197390, "comment_id": 91363447, "body": "@Ben Interesting, but I think this is more generic pitfalls of laziness than specific to <code>Writer</code>.  Both problems are variants of &quot;you can&#39;t wait on a whole infinite list&quot;.  The first failure waits for a whole list to be created before it starts outputting any of the &quot;logging&quot; messages.  The second blocks the ready-to-use messages in memory, not printing anything until the length of an infinite list is printed.  I could write a non <code>Writer</code>-non <code>append</code> program that has the same problems."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1536268276, "post_id": 52197390, "comment_id": 91373788, "body": "@jamshidh Essentially yes. But &quot;generic pitfalls with laziness&quot; is all the problems with Writer for large lists ever were. Your test program works well because it happens to avoid these issues, not because Writer has been rewritten to be more large-lazy-list-friendly. In particular, never using the result seems quite unrealistic for real uses of Writer; you could just use Monoid directly if the log is all you need."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 4, "last_activity_date": 1536213506, "creation_date": 1536213506, "answer_id": 52197390, "question_id": 52195843, "link": "https://stackoverflow.com/questions/52195843/is-the-writer-monad-now-suitable-for-large-lazy-lists/52197390#52197390", "title": "Is the Writer Monad Now Suitable for Large Lazy Lists?", "body": "<p>There are two factors at play here. The way the <code>&lt;&gt;</code>/<code>mappend</code> calls are nested, and whether the entire log is kept in memory.</p>\n\n<h3>How are the <code>&lt;&gt;</code> calls nested?</h3>\n\n<p>This depends on how you write your code <em>using</em> Writer, not on Writer's implementation. To see why, lets cheat.</p>\n\n<pre><code>data Tree a = Nil | Leaf a | Node (Tree a) (Tree a)\n  deriving (Show)\n\ninstance Semigroup (Tree a)\n  where x &lt;&gt; y = Node x y\n\ninstance Monoid (Tree a)\n  where mempty = Nil\n</code></pre>\n\n<p>This is not a proper monoid, since <code>&lt;&gt;</code> is not associative. <code>x &lt;&gt; (y &lt;&gt; z)</code> gives <code>Node x (Node y z)</code> whereas <code>(x &lt;&gt; y) &lt;&gt; z)</code> gives <code>Node (Node x y) z</code>. It allows us to tell after the fact whether the Writer's \"log\" was reduced left-nested or right nested.</p>\n\n<pre><code>go :: Int -&gt; Writer (Tree Int) ()\ngo i\n  | i &lt; 5\n    = do tell (Leaf i)\n         go (i+1)\n  | otherwise\n    = pure ()\n\nmain :: IO ()\nmain = do\n  let (result, log) = runWriter $ go 1\n  putStrLn (render log)\n\nrender Nil = \"Nil\"\nrender (Leaf x) = show x\nrender (Node x y) = \"(\" ++ render x ++ \") &lt;&gt; (\" ++ render y ++ \")\"\n</code></pre>\n\n<p>With this, you get: <code>(1) &lt;&gt; ((2) &lt;&gt; ((3) &lt;&gt; ((4) &lt;&gt; (Nil))))</code></p>\n\n<p>Clearly right-nested. Hence how you could generate an infinite list as the \"log\" of a <code>Writer</code> and consume it as it was generated in a relatively small amount of space.</p>\n\n<p>But swap the order of the <code>tell</code> and the recursion, so that it looks like this:</p>\n\n<pre><code>go :: Int -&gt; Writer (Tree Int) ()\ngo i\n  | i &lt; 5\n    = do go (i+1)\n         tell (Leaf i)\n  | otherwise\n    = pure ()\n</code></pre>\n\n<p>And you get this: <code>((((Nil) &lt;&gt; (4)) &lt;&gt; (3)) &lt;&gt; (2)) &lt;&gt; (1)</code>. Now it's left-nested, infinite recursion does not work:</p>\n\n<pre><code>import Control.Monad.Writer\n\ncreateInfiniteList :: Int -&gt; Writer [Int] ()\ncreateInfiniteList i = do\n  createInfiniteList (i+1)\n  tell [i]\n\nmain :: IO ()\nmain = do\n  let x = execWriter $ createInfiniteList 1\n  print x\n</code></pre>\n\n<p>This never prints anything, and consumes an ever-growing amount of memory.</p>\n\n<p>Basically the structure of the <code>&lt;&gt;</code> calls is similar to the structure of your <code>Writer</code> expressions. Everywhere you bind in a call to another function (including the equivalent in a do-block), all of the <code>&lt;&gt;</code> calls resulting from that call will be \"inside parentheses\". So <code>tell _ &gt;&gt; recurse</code> results in right-nested <code>&lt;&gt;</code>s, while <code>recurse &gt;&gt; tell _</code> results in left-nested <code>&lt;&gt;</code>s, and more complex call-graphs result in similarly-structured nesting of <code>&lt;&gt;</code>s.</p>\n\n<h3>Forcing the result builds the entire log</h3>\n\n<p>Another particular thing about your test program is that it doesn't use the \"result\" of the Writer at all, only the \"log\". Obviously if the recursion is infinite there's never any final result at all, but if we change your program like so:</p>\n\n<pre><code>import Control.Monad.Writer\n\ncreateLargeList :: Int -&gt; Writer [Int] ()\ncreateLargeList i\n  | i &lt; 50000000\n    = do tell [i]\n         createLargeList (i+1)\n  | otherwise\n    = pure ()\n\nmain :: IO ()\nmain = do\n  let (result, log) = runWriter $ createLargeList 1\n  print $ length log\n  print result\n</code></pre>\n\n<p>Then it behaves similarly; <code>length</code> consumes the list as it is produced and completes in short order (and relatively low memory usage). After that the <code>()</code> is readily available and is printed immediately.</p>\n\n<p>But if we change it to print the result first:</p>\n\n<pre><code>import Control.Monad.Writer\n\ncreateLargeList :: Int -&gt; Writer [Int] ()\ncreateLargeList i\n  | i &lt; 50000000\n    = do tell [i]\n         createLargeList (i+1)\n  | otherwise\n    = pure ()\n\nmain :: IO ()\nmain = do\n  let (result, log) = runWriter $ createLargeList 1\n  print result\n  print $ length log\n</code></pre>\n\n<p>Then on my system this takes much longer, and consumes nearly 15 GB of RAM<sup>1</sup>. It does have to materialise the log fully in RAM just to get at the final result, even when the <code>&lt;&gt;</code>s are right-nested and the log can be consumed lazily.</p>\n\n<p>Technically I believe it is not building the <em>list</em> in memory, but rather a chain of thunks applying <code>&lt;&gt;</code> to singleton lists, which is just as long as the final list and probably uses more memory per link in the chain. The resulting list is still consumed by <code>length</code> as it is generated by forcing those thunks, but that doesn't really help since the entire thunk chain had to be generated to get at the final <code>()</code> result, instead of having the thunk chain itself generates as <code>length</code> demands more of the list.</p>\n\n<hr>\n\n<p><sup>1</sup> That's compiling like <code>ghc foo.hs</code>; if I compile with <code>-O2</code> then it behaves similarly to printing the length of the log first. This is a fairly simple case for GHC to inline everything and figure out a better way of computing the same result; I wouldn't assume its optimisations could address this problem if the program were more complicated.</p>\n"}], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1536213506, "creation_date": 1536202475, "question_id": 52195843, "link": "https://stackoverflow.com/questions/52195843/is-the-writer-monad-now-suitable-for-large-lazy-lists", "title": "Is the Writer Monad Now Suitable for Large Lazy Lists?", "body": "<p>I've read in multiple places that the writer monad of a list keeps that full list in memory, and therefore shouldn't be used in anything other than small samples (no logging, for instance).</p>\n\n<p><a href=\"https://kseo.github.io/posts/2017-01-21-writer-monad.html\" rel=\"noreferrer\">For instance, read here</a></p>\n\n<p>However, to test the claim, I wrote the following program, and actually showed that it successfully outputs an infinite list lazily!</p>\n\n<pre><code>import Control.Monad.Writer\n\ncreateInfiniteList :: Int -&gt; Writer [Int] ()\ncreateInfiniteList i = do\n  tell [i]\n  createInfiniteList (i+1)\n\nmain :: IO ()\nmain = do\n  let x = execWriter $ createInfiniteList 1\n  print x\n</code></pre>\n\n<p>I've watched this program output over 1 billion items (it runs very fast), and monitored that the memory usage never went past 0.1% on my machine.</p>\n\n<p>Has the writer monad been rewritten to fix the original problem?  Can I count on it continuing to work this way in the future?</p>\n\n<p>note- I am aware that better logging monads exist (I use those elsewhere)...  My desired use case is not logging (but it is similar)</p>\n"}]