[{"tags": ["haskell", "package-managers", "haskell-stack"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1499311276, "post_id": 44936380, "comment_id": 76854702, "body": "Is this question even sensible? I thought an LTS was essentially just a collection of package versions. What would &quot;installing&quot; a collection of version numbers mean?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1499318802, "post_id": 44936380, "comment_id": 76856671, "body": "@DanielWagner Sometimes if I&#39;m creating a new package, I usually want to be using the same latest <code>lts</code> present in my system for that new package so that it can use cache from those locally stored snapshot."}], "answers": [{"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 6, "last_activity_date": 1499335890, "last_edit_date": 1499335890, "creation_date": 1499293778, "answer_id": 44936988, "question_id": 44936380, "link": "https://stackoverflow.com/questions/44936380/lts-versions-installed-by-stack/44936988#44936988", "title": "LTS versions installed by stack", "body": "<p>Not sure about <code>stack</code> command but you can do it with <code>bash</code> command:</p>\n\n<pre><code>$ ls ~/.stack/snapshots/x86_64-linux/\n</code></pre>\n\n<p>For me it prints:</p>\n\n<pre><code>lts-8.13  lts-8.15  lts-8.17  lts-8.21  lts-8.3\n</code></pre>\n\n<p>Instead of <code>x86_64-linux</code> should be your arch. But you don't need to remember it. Just press <code>TAB</code> after <code>snapshots/</code>.</p>\n"}], "owner": {"reputation": 711, "user_id": 1023733, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/2495649dc156081879843944795860d5?s=128&d=identicon&r=PG", "display_name": "user1023733", "link": "https://stackoverflow.com/users/1023733/user1023733"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1500279938, "creation_date": 1499290540, "last_edit_date": 1500279938, "question_id": 44936380, "link": "https://stackoverflow.com/questions/44936380/lts-versions-installed-by-stack", "title": "LTS versions installed by stack", "body": "<p>Is there a stack command one can run to get a list of all the LTS versions installed by stack on my system?</p>\n"}, {"tags": ["haskell", "ghc", "cabal", "happy"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1499283670, "post_id": 44934666, "comment_id": 76845363, "body": "You have to install <code>happy</code> and <code>alex</code> as Ubuntu package as well: <code>sudo apt-get install alex happy</code>."}, {"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1499283943, "post_id": 44934666, "comment_id": 76845524, "body": "@WillemVanOnsem perfect, this does it thank you !!"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1499283794, "creation_date": 1499283794, "answer_id": 44934720, "question_id": 44934666, "link": "https://stackoverflow.com/questions/44934666/building-ghc-configure-fails-on-happy-despite-successful-cabal-install/44934720#44934720", "title": "Building GHC: configure fails on happy despite successful cabal install", "body": "<p>You should install <code>alex</code> and <code>happy</code> as Debian packages as well. On a Debian machine, you can use <code>apt-get</code> for that:</p>\n\n<pre><code>sudo apt-get install alex happy\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "edited": false, "score": 0, "creation_date": 1499363609, "post_id": 44935559, "comment_id": 76887156, "body": "Thank you very much Daniel, I have now setup my <code>.bashrc</code> file accordingly"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1499286964, "creation_date": 1499286964, "answer_id": 44935559, "question_id": 44934666, "link": "https://stackoverflow.com/questions/44934666/building-ghc-configure-fails-on-happy-despite-successful-cabal-install/44935559#44935559", "title": "Building GHC: configure fails on happy despite successful cabal install", "body": "<p>I suspect you simply don't have them on your PATH. Make sure to include something like</p>\n\n<pre><code>PATH=\"$HOME/.cabal/bin:$PATH\"\n</code></pre>\n\n<p>in your .bashrc (or startup files for whatever shell you use). Installing them through the package manager simply installed them in a location that was already on your PATH.</p>\n\n<p>Even if you have things working now, you should consider modifying your .bashrc while it's fresh in your head, as other cabal-install'd executables will get put there in the future.</p>\n"}], "owner": {"reputation": 1024, "user_id": 5339728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bc87e9ae4adff4d75b1ad9233e04bc54?s=128&d=identicon&r=PG&f=1", "display_name": "Sven Williamson", "link": "https://stackoverflow.com/users/5339728/sven-williamson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 44935559, "answer_count": 2, "score": 5, "last_activity_date": 1499286964, "creation_date": 1499283580, "last_edit_date": 1499284620, "question_id": 44934666, "link": "https://stackoverflow.com/questions/44934666/building-ghc-configure-fails-on-happy-despite-successful-cabal-install", "title": "Building GHC: configure fails on happy despite successful cabal install", "body": "<p>I am attempting to build GHC from source following <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Building/QuickStart\" rel=\"nofollow noreferrer\">this page</a>. When installing dependencies, I had to install <code>happy</code> and <code>alex</code>:</p>\n\n<pre><code>$ cabal install alex happy\nResolving dependencies...\nConfiguring alex-3.2.1...\nConfiguring happy-1.19.5...\nBuilding happy-1.19.5...\nBuilding alex-3.2.1...\nInstalled alex-3.2.1\nInstalled happy-1.19.5\n</code></pre>\n\n<p>yet when running <code>configure</code> I get an error message:</p>\n\n<pre><code>$ ./configure\n...\nchecking for happy... no\nchecking for version of happy... \nconfigure: error: Happy version 1.19.4 or later is required to compile GHC.\n</code></pre>\n\n<p>I am running on Debian <code>stretch</code>:</p>\n\n<pre><code>$ uname -a \nLinux &lt;host&gt; 4.8.0-1-amd64 #1 SMP Debian 4.8.5-1 (2016-10-28) x86_64 GNU/Linux\n</code></pre>\n\n<p>Can anyone suggest an obvious step I could try to resolve this?</p>\n"}, {"tags": ["oracle", "macos", "haskell", "odbc", "hdbc"], "comments": [{"owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1499286336, "post_id": 44932715, "comment_id": 76846954, "body": "Does a tool like <code>isql</code> work for you with this driver?"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1499289201, "post_id": 44932715, "comment_id": 76848361, "body": "@Arnon How do I connect <code>isql</code> to an oracle db? When I google it I just get a huge amount of isql*plus and sql*plus noise instead of an answer."}, {"owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1499290628, "post_id": 44932715, "comment_id": 76849019, "body": "Well, you want to test that unixOdbc actually functions and your DSN/driver is correct. Single out unixOdbc before attempting the Haskell bit.... This man-page has some samples <a href=\"https://www.mankier.com/1/isql\" rel=\"nofollow noreferrer\">mankier.com/1/isql</a>"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1499290966, "post_id": 44932715, "comment_id": 76849175, "body": "I looked at the man page but I don&#39;t see how to pass in the connection string, so things like the driver, the server protocol / host / port and the service name."}, {"owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1499291136, "post_id": 44932715, "comment_id": 76849252, "body": "You define the parameters like user/port/etc... in the DSN settings... <a href=\"https://oracle-base.com/articles/linux/create-an-odbc-dsn-on-linux\" rel=\"nofollow noreferrer\">oracle-base.com/articles/linux/create-an-odbc-dsn-on-linux</a>"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1499442825, "post_id": 44932715, "comment_id": 76925211, "body": "@Arnon Ok <code>isql &lt;name&gt;</code> works fine now, but <code>connectODBC &quot;DSN=&lt;name&gt;&quot;</code> is still giving me <code>[unixODBC][Driver Manager]Can&#39;t open lib &lt;valid path to libsqora.dylib.12.1&gt;&#39; : file not found</code>."}, {"owner": {"reputation": 6003, "user_id": 4799035, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tuyZM.jpg?s=128&g=1", "display_name": "Christopher Jones", "link": "https://stackoverflow.com/users/4799035/christopher-jones"}, "edited": false, "score": 0, "creation_date": 1499585113, "post_id": 44932715, "comment_id": 76962364, "body": "Do you have Instant Client in ~/lib ? See the Instant Client installation instructions for details: <a href=\"http://www.oracle.com/technetwork/topics/intel-macsoft-096467.html#ic_osx_inst\" rel=\"nofollow noreferrer\">oracle.com/technetwork/topics/&hellip;</a>"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1499701834, "post_id": 44932715, "comment_id": 77006747, "body": "That fixed it, thanks!"}], "owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1499278264, "creation_date": 1499276275, "last_edit_date": 1499278264, "question_id": 44932715, "link": "https://stackoverflow.com/questions/44932715/how-do-i-connect-haskell-hdbc-to-an-oracle-db-on-osx", "title": "How do I connect Haskell HDBC to an oracle db on osx", "body": "<p>I was wondering how you are supposed to connect to an oracle db on mac with Haskell HDBC.</p>\n\n<p>I tried doing it through ODBC, by running <code>brew install unixobcd</code> and then installing oracle instant client basic and obdc into a directory. Then in Haskell, with HDBC and HDBC-odbc both installed, calling <code>connectODBC</code> with <code>Driver</code> set to the location of <code>libsqora.dylib.12.1</code> in said directory.</p>\n\n<p>It is giving me <code>sot-dba: SqlError {seState = \"[\\\"01000\\\"]\", seNativeError = -1, seErrorMsg = \"connectODBC/sqlDriverConnect: [\\\"0: [unixODBC][Driver Manager]Can't open lib '&lt;valid absolute path to libsqora.dylib.12.1&gt;' : file not found\\\"]\"}</code>, but when I <code>cat</code> that location it spills out the appropriate unreadably binary, so its definitely a valid file location.</p>\n\n<p>I was wondering if anyone could either help debug my issue, or just give me instructions on how to set it up from scratch and I will happily do it over properly. I just have no idea where to go from here since it is claiming a file doesn't exist that does, and I am having trouble finding many results on google on how to debug that.</p>\n\n<p>One thing perhaps worth noting is that I ran <code>./odbc_update_ini.sh /usr/local/Cellar/unixodbc/2.3.4</code> to set up the oracle odbc driver, because that is the location that brew put unixodbc, was that perhaps incorrect?</p>\n\n<p>If necessary I could consider a different library than HDBC, but I would strongly prefer not having to, it seems like some other libraries such as persistent actually use hdbc/hdbc-odbc under the covers anyway, so surely this shouldn't be hard.</p>\n"}, {"tags": ["haskell", "data-structures", "compilation", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1499275590, "post_id": 44932256, "comment_id": 76840848, "body": "Possible, probably yes. But a compiler should be <i>conservative</i>: only if the compiler can proof that it is safe, it can use <code>mset</code>."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1499275832, "post_id": 44932256, "comment_id": 76840989, "body": "@WillemVanOnsem sure! I&#39;m wondering what are the generalized scenarios where that is the case."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1499277949, "post_id": 44932256, "comment_id": 76842151, "body": "For instance, static analysis could detect that the data structure is used <i>linearly</i> (as in linear types / linear logic), and enable that optimization. That would require a full program analysis, though, or at least we need to be able to see all the points where each map could be used."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1499278997, "post_id": 44932256, "comment_id": 76842731, "body": "@chi I can have full program analysis, but some situations are confusing me. For example, <code>(let map = {}; inc = \\_ -&gt; update (+ 1) 0\u00a0map; foo = \\f -&gt; (f(0), f(0)) in (foo inc))</code>. Here, <code>map</code> appears only once. But it is used inside <code>inc</code>, which is sent to <code>foo</code>, which is then used twice. So it isn&#39;t enough to check that a variable is only used once, the problem seems to need some more complex analysis. I&#39;d love a resource studying / explaining the problem more concretely!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1499279194, "post_id": 44932256, "comment_id": 76842824, "body": "@MaiaVictor I am not a linear types expert, but that will not type check I guess. <code>inc</code> depends on <code>map</code>, so <code>inc</code> gets a linear type. <code>inc</code> is passed to <code>foo</code>, so <code>foo</code> must take a linear argument ... but it uses it twice, triggering a type error."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1499279381, "post_id": 44932256, "comment_id": 76842928, "body": "@chi fair enough! I&#39;m just noticing checking for linearity isn&#39;t trivial. The field itself is very big so I&#39;d love if someone with experience in linear types could point to a resource covering this problem! :)"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1499280683, "creation_date": 1499274685, "last_edit_date": 1499280683, "question_id": 44932256, "link": "https://stackoverflow.com/questions/44932256/is-it-possible-to-analyze-at-compile-time-when-a-map-like-structure-can-be-mut", "title": "Is it possible to analyze, at compile time, when a map-like structure can be mutated in-place?", "body": "<p>For simplicity, suppose we extend the lambda calculus with a primitive for maps with string keys. We add two operations: <code>set map key val</code> and <code>get map key</code>. To actually implement this primitive, we could use a persistent data structure a la Haskell's <code>Data.Map</code>, which would give us <code>O(log(n))</code> sets and gets. </p>\n\n<p>Suppose we, instead, implemented this structure with hash-tables. <code>get</code> would be <code>O(1)</code> and <code>set</code> would be <code>O(N)</code>, as it requires cloning the whole hash-table. <strong>Would it be possible to, during compile-type, analyze all places where it is safe to perform an in-place mutation, replacing <code>set</code> by a hidden <code>mset</code> operation?</strong></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1499278139, "post_id": 44931886, "comment_id": 76842254, "body": "If you want to print some value for debugging-only reasons, have a look at <code>Debug.Trace.trace</code>, or the GHCi debugger. This should however not be used of anything else, as it cheats the type system -- the general solution is the one in the answer below by Lee."}], "answers": [{"comments": [{"owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "edited": false, "score": 0, "creation_date": 1499274416, "post_id": 44932088, "comment_id": 76840188, "body": "ok, and what if I want <code>tick :: IO (State Int Int)</code>? how code will look after this?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "edited": false, "score": 0, "creation_date": 1499274805, "post_id": 44932088, "comment_id": 76840380, "body": "@bjornmelgaard - I don&#39;t think you can implement it with that type - an <code>IO a</code> allows externally visible effects, and a <code>State s a</code> is a pure stateful computation. An <code>IO (State Int Int)</code> therefore allows you to execute some effects before returning a pure stateful computation, but you want to interleave state changes with effects. Combining features of different monads is what monad transformers like <code>StateT</code> are for."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "edited": false, "score": 2, "creation_date": 1499277745, "post_id": 44932088, "comment_id": 76842043, "body": "@bjornmelgaard It&#39;s not that difficult. For comparison <code>IO (Int -&gt; Bool)</code> is the type of an action which can perform arbitrary I/O, and then returns a pure function which does not do any I/O. Hence, this can never print the integer: the I/O is over before the integer is passed. Instead, <code>Int -&gt; IO Bool</code> takes the integer first, then performs I/O, and finally returns a boolean. Here the integer can be printed. This is more or less what&#39;s happening under the state-transformer layer (which is indeed a bit tricky to understand at first -- a good monad tutorial should help)."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 5, "last_activity_date": 1499274092, "creation_date": 1499274092, "answer_id": 44932088, "question_id": 44931886, "link": "https://stackoverflow.com/questions/44931886/state-monad-how-to-print-intermediate-value-in-haskell/44932088#44932088", "title": "State monad: How to `print` intermediate value in Haskell", "body": "<p>If you want to run IO actions within a state computation you can change the type of <code>tick</code> to return a <code>StateT Int IO Int</code> and use <code>liftIO</code>. Then you can run it using <code>execStateT</code>:</p>\n\n<pre><code>import Control.Monad.State.Lazy\nimport Control.Monad.IO.Class (liftIO)\n\ntick :: StateT Int IO Int\ntick = do n &lt;- get\n          put (n+1)\n          liftIO $ print (n+1)\n          return n\n\nplusOne :: Int -&gt; IO Int\nplusOne = execStateT tick\n\nmain = plusOne 1 &gt;&gt; pure ()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": false, "score": 0, "last_activity_date": 1526314021, "creation_date": 1526314021, "answer_id": 50334665, "question_id": 44931886, "link": "https://stackoverflow.com/questions/44931886/state-monad-how-to-print-intermediate-value-in-haskell/50334665#50334665", "title": "State monad: How to `print` intermediate value in Haskell", "body": "<p>Another option, since you would have to use <code>IO</code> anyway to print a value in the intermediate state, would be to use <code>IORef</code>. It's a container that has an updateable value. </p>\n\n<pre><code>module Main where\n\nimport Data.IORef\n\ntick :: IORef Int -&gt; IO (IORef Int)\ntick ref = do\n  modifyIORef' ref (+1)\n  -- you can also print here since it is IO\n  pure ref\n\nmain :: IO ()\nmain = do\n  counter &lt;- newIORef 0\n\n  tick counter\n  v2 &lt;- readIORef counter\n  print v2\n\n  tick counter\n  v2 &lt;- readIORef counter\n  print v2\n</code></pre>\n\n<p>You can then clean it up with <code>ReaderT</code>.</p>\n\n<pre><code>module Main where\n\nimport Data.IORef\nimport Control.Monad.Reader\n\nreaderTick :: ReaderT (IORef Int) IO ()\nreaderTick = do\n  ref &lt;- ask\n  -- can also print here with liftIO $ print ...\n  liftIO $ modifyIORef' ref (+1)\n\nmain :: IO ()\nmain = do\n  counter &lt;- newIORef 0\n\n  runReaderT readerTick counter\n  v1 &lt;- readIORef counter\n  print v1\n\n  runReaderT readerTick counter\n  v2 &lt;- readIORef counter\n  print v2\n</code></pre>\n"}], "owner": {"reputation": 3281, "user_id": 3574379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/B85yX.png?s=128&g=1", "display_name": "srghma", "link": "https://stackoverflow.com/users/3574379/srghma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "accepted_answer_id": 44932088, "answer_count": 2, "score": 3, "last_activity_date": 1526314021, "creation_date": 1499273262, "last_edit_date": 1526239281, "question_id": 44931886, "link": "https://stackoverflow.com/questions/44931886/state-monad-how-to-print-intermediate-value-in-haskell", "title": "State monad: How to `print` intermediate value in Haskell", "body": "<p>I'm new in haskell and I have following code</p>\n\n<pre><code>module StateTest where\n\nimport Control.Monad.State.Lazy\n\ntick :: State Int Int\ntick = do n &lt;- get\n          put (n+1)\n          return n\n\nplusOne :: Int -&gt; Int\nplusOne = execState tick\n\nmain = print $ plusOne 1\n</code></pre>\n\n<p>And I want to print state value after <code>put (n+1)</code> and continue computation like this</p>\n\n<pre><code>tick = do n &lt;- get\n          put (n+1)\n          print\n          return n\n</code></pre>\n\n<p>How whole code will look following to this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1499270447, "post_id": 44930841, "comment_id": 76837825, "body": "It&#39;s not technically an operator; it&#39;s just syntax for binding the result of the <code>&gt;&gt;=</code> operator to a name in an implicit function. <code>a &lt;- b</code> is parsed as <code>b &gt;&gt;= (\\a -&gt; ...)</code>, where <code>...</code> is the rest of the <code>do</code> block."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1499272284, "post_id": 44930841, "comment_id": 76838966, "body": "Without <code>begin</code> and <code>end</code> (whose equality tests do indeed guide type inference, as only things of the same you&#39;re cam be tested for <code>==</code>), the type checker has no way to see that you&#39;re talking about <code>Nation</code>s and <code>Color</code>s. It just sees you want two types that are <code>Bounded</code>, <code>Enum</code>, and <code>Show</code>, and quite properly refuses to guess what you might mean."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1499275203, "post_id": 44930841, "comment_id": 76840612, "body": "Oh hell List Monad. Yeah well that&#39;s not exactly the most straightforward example."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1499277439, "post_id": 44930841, "comment_id": 76841840, "body": "A list comprehension would have been more idiomatic for this. This style is probably used to mimic logical programming, but it&#39;s not a very good style per se (IMO). (I also find <code>do..where</code> awful style)"}], "answers": [{"comments": [{"owner": {"reputation": 1540, "user_id": 6395452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a57f20b2424b5a90e46cf1bbe311e033?s=128&d=identicon&r=PG&f=1", "display_name": "ITA", "link": "https://stackoverflow.com/users/6395452/ita"}, "edited": false, "score": 1, "creation_date": 1499278454, "post_id": 44933079, "comment_id": 76842433, "body": "Thanks. That helps. For (3), adding <code>answers :: [[(Nation, Color)]]</code> to the code helps list all permutations without the <code>nation</code> and <code>color</code>. And for (1) I understand it now as a bunch of nested actions. So only (2) needs clarification."}, {"owner": {"reputation": 1540, "user_id": 6395452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a57f20b2424b5a90e46cf1bbe311e033?s=128&d=identicon&r=PG&f=1", "display_name": "ITA", "link": "https://stackoverflow.com/users/6395452/ita"}, "edited": false, "score": 0, "creation_date": 1499278734, "post_id": 44933079, "comment_id": 76842569, "body": "I suppose the type signature for answers helps values know which bounded type to act on as well. Oh well ... some of this seems like pure magic at times."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1540, "user_id": 6395452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a57f20b2424b5a90e46cf1bbe311e033?s=128&d=identicon&r=PG&f=1", "display_name": "ITA", "link": "https://stackoverflow.com/users/6395452/ita"}, "edited": false, "score": 0, "creation_date": 1499310667, "post_id": 44933079, "comment_id": 76854560, "body": "@IvanAbraham, well, <code>answers</code> doesn&#39;t even have a type signature. Type inference can indeed seem like magic sometimes, but it&#39;s really not. The key thing to remember is that type information can flow in all directions. In <code>color &lt;- values</code>, the <code>color</code> value is determined by the <code>values</code> value, but the <code>values</code> type is determined by the <code>color</code> type. The compiler just propagates the equalities it discovers through a fairly standard process called <i>unification</i> to work out what the types have to be for everything to match up properly. To help you understand your code, however, it&#39;s"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1540, "user_id": 6395452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a57f20b2424b5a90e46cf1bbe311e033?s=128&d=identicon&r=PG&f=1", "display_name": "ITA", "link": "https://stackoverflow.com/users/6395452/ita"}, "edited": false, "score": 0, "creation_date": 1499310738, "post_id": 44933079, "comment_id": 76854586, "body": "generally best to give type signatures to all top-level functions and all non-trivial local functions. Sometimes you&#39;ll need to use the <code>ScopedTypeVariables</code> extension for the latter."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 0, "last_activity_date": 1499277709, "creation_date": 1499277709, "answer_id": 44933079, "question_id": 44930841, "link": "https://stackoverflow.com/questions/44930841/understanding-haskell-operator/44933079#44933079", "title": "Understanding Haskell (&lt;-) operator", "body": "<p>You can translate <code>do</code> notation to list comprehension notation pretty mechanically:</p>\n\n<pre><code>answers = [ zip nation color\n          | nation &lt;- values, head nation == English\n          , color &lt;- values, last color == Red\n          ]\n</code></pre>\n\n<p>I really don't like this <code>head</code> and <code>last</code> business though.</p>\n"}], "owner": {"reputation": 1540, "user_id": 6395452, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a57f20b2424b5a90e46cf1bbe311e033?s=128&d=identicon&r=PG&f=1", "display_name": "ITA", "link": "https://stackoverflow.com/users/6395452/ita"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 44933079, "answer_count": 1, "score": 0, "last_activity_date": 1499277709, "creation_date": 1499269758, "question_id": 44930841, "link": "https://stackoverflow.com/questions/44930841/understanding-haskell-operator", "title": "Understanding Haskell (&lt;-) operator", "body": "<p>I was studying the code over at <a href=\"https://rosettacode.org/wiki/Zebra_puzzle#LP-like_version\" rel=\"nofollow noreferrer\">https://rosettacode.org/wiki/Zebra_puzzle#LP-like_version</a> and got somewhat confused. </p>\n\n<p>Here is a minimal example of what is going on in that code. </p>\n\n<pre><code>import Control.Monad\nimport Data.List\n\nvalues :: (Bounded a, Enum a) =&gt; [[a]]\nvalues = permutations [minBound..maxBound]\n\ndata Nation = English | Swede | Dane\n  deriving (Bounded, Eq, Enum, Show)\n\ndata Color = Red | Blue | Green\n  deriving (Bounded, Eq, Enum, Show)\n\nanswers = do\n\n  nation &lt;- values\n  begin nation English\n\n  color &lt;- values\n  end color Red\n\n  return $ zip nation color\n\n  where\n    end xs x = guard $ last xs == x\n    begin xs x = guard $ head xs == x\n\nmain :: IO ()\nmain = do\n    forM_ answers $ (\\answer -&gt;  -- for answer in answers:\n      do\n        mapM_ print answer\n        putStrLn \"----\" )\n    putStrLn \"No more solutions!\"\n</code></pre>\n\n<p>what is mysterious for me is what is happening in the do block. </p>\n\n<p>I understand from various sources that the <code>a &lt;- b</code> operator does an action <code>b</code> and binds it to <code>a</code>. But what is the action here exactly? </p>\n\n<p>I assumed it was <code>values</code> but if I comment out the <code>begin</code> and <code>end</code> function calls and definitions then haskell does not know what to do with <code>values</code> anymore. I guess this is because the equality test in their definitions is what lets haskell infer the type (am I wrong?). </p>\n\n<ol>\n<li>In that case what exactly <em>is</em> the <em>action</em> here?  </li>\n<li>Also how does <code>values</code> know which bounded type to apply <code>permutations</code> to? This part seems quite mysterious. </li>\n<li>Finally, if I wanted to keep the same\ncode as above but modify it list out all permutations (not just the\none that satisfy <code>begin</code> and <code>end</code>) how would I do it?</li>\n</ol>\n"}, {"tags": ["haskell", "haskell-stack", "git-worktree"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1499292748, "post_id": 44930473, "comment_id": 76849904, "body": "Concerns like these contribute to the fact that I still use Cabal most of the time (and <i>without</i> sandboxes) instead of Stack... probably unjustified though, for cannot Stack also keep a system-global cache?"}, {"owner": {"reputation": 41, "user_id": 7472126, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-U-YeWRG5HNc/AAAAAAAAAAI/AAAAAAAAG6A/xb1VZoFcg00/photo.jpg?sz=128", "display_name": "BooneJS", "link": "https://stackoverflow.com/users/7472126/boonejs"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1499353549, "post_id": 44930473, "comment_id": 76880439, "body": "From what I can tell, the only system-global &#39;cache&#39; <code>stack</code> keeps is GHC installs in <code>~&#47;.stack</code> and binary installs (like <code>alex</code> and <code>happy</code>) in <code>~&#47;.local&#47;bin</code>. Do you use Cabal for projects with dozens of dependencies, and if so, do you draw from Stackage releases or something else?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1499354802, "post_id": 44930473, "comment_id": 76881412, "body": "I mainly draw from good old Hackage (as <code>cabal install</code> defaults to), which works fine most of the time and generally avoids compiling any package over again if it has ever been installed before on the system. When there&#39;s a conflict (the kind that Stack was written to avoid), I&#39;ll generally clone the offending package straight from Github, tweak the dependencies as needed, and move on."}], "owner": {"reputation": 41, "user_id": 7472126, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-U-YeWRG5HNc/AAAAAAAAAAI/AAAAAAAAG6A/xb1VZoFcg00/photo.jpg?sz=128", "display_name": "BooneJS", "link": "https://stackoverflow.com/users/7472126/boonejs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1499268696, "creation_date": 1499268696, "question_id": 44930473, "link": "https://stackoverflow.com/questions/44930473/speeding-up-haskell-stack-project-compilation-and-git-branches", "title": "Speeding up Haskell stack project compilation and git branches", "body": "<p>I cannot change GHC's compilation times, but I can control the environment in which things are compiled. What can I do with <strong>git</strong> and <strong>stack</strong> to minimize downtime due to (re-)building?</p>\n\n<p>Haskell stack caches compiled dependencies in the <code>.stack-work</code> directory, and it great for working on one thing at a time. However, I find myself switching back and forth between branches. I've done <code>git checkout</code> in place, and perhaps some of the <code>.stack-work</code> cache is usable. But I greatly prefer <code>git worktree</code> to get a copy of a branch in a different directory altogether. Worktree is especially hard on build times as each worktree directory will have its own <code>.stack-work</code>, and therefore must download/configure/compile/install its own dependencies instead of using existing ones. </p>\n\n<p>I've been doing some reading about Nix and Haskell, but since stack creates its own cache, it ignores whatever Nix has compiled and installed. From what I've read, I really want Nix to handle dependencies and stack to handle my personal code. I get great benefit from stackage and <code>stack solver</code>, so I do not want to give them up. But when I see a screenful of \"unregistering\" messages when running <a href=\"https://twitter.com/ndm_haskell/status/778673153698566145\" rel=\"nofollow noreferrer\"><code>stack build --only-dependencies &amp;&amp; stack ghci</code></a>, I know that I've got at least 10-15 minutes before I get a prompt.</p>\n\n<p>Many thanks!</p>\n"}, {"tags": ["list", "haskell", "filter", "pattern-matching", "lazy-evaluation"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1499253936, "post_id": 44924897, "comment_id": 76825118, "body": "<code>(x:xs) == []</code> can never succeed. Since <code>(x:xs)</code> is a list with at least one element."}, {"owner": {"reputation": 273, "user_id": 5388727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f066380ff341cde5c43a68f82641395?s=128&d=identicon&r=PG&f=1", "display_name": "Snake", "link": "https://stackoverflow.com/users/5388727/snake"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1499254055, "post_id": 44924897, "comment_id": 76825201, "body": "Thanks, that helps. So I should work around it I guess? Not sure how to do that though, because I kinda need (x:xs) for my function.."}, {"owner": {"reputation": 4376, "user_id": 1109583, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VsfzL.jpg?s=128&g=1", "display_name": "lambda.xy.x", "link": "https://stackoverflow.com/users/1109583/lambda-xy-x"}, "edited": false, "score": 1, "creation_date": 1499254062, "post_id": 44924897, "comment_id": 76825211, "body": "To extend the answer, a list has two constructors: <code>[]</code> and <code>_ : _</code>, a list with outermost constructor <code>[]</code> can never have <code>:</code> as outermost constructor."}, {"owner": {"reputation": 4376, "user_id": 1109583, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/VsfzL.jpg?s=128&g=1", "display_name": "lambda.xy.x", "link": "https://stackoverflow.com/users/1109583/lambda-xy-x"}, "edited": false, "score": 2, "creation_date": 1499254143, "post_id": 44924897, "comment_id": 76825276, "body": "You already pattern match in the definition of <code>filterAge (x:xs)</code> and exclude empty lists there. The easiest fix is to add a definition <code>filterAge []</code> above. Alternatively you define filterAge xs and match on arbitrary lists."}, {"owner": {"reputation": 273, "user_id": 5388727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f066380ff341cde5c43a68f82641395?s=128&d=identicon&r=PG&f=1", "display_name": "Snake", "link": "https://stackoverflow.com/users/5388727/snake"}, "edited": false, "score": 0, "creation_date": 1499254257, "post_id": 44924897, "comment_id": 76825359, "body": "@ lambda.xy.x That works! I completely overlooked that possibilty, I have worked with that a little bit before but didn&#39;t think of it for this function. Thanks a lot!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1499277199, "post_id": 44924897, "comment_id": 76841721, "body": "I believe that this mistake, namely thinking that <code>x:xs</code> can be empty, has appeared a few times already on SO. We should take a canonical question (possibly this one), and close future occurrences as a duplicate."}], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 5388727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f066380ff341cde5c43a68f82641395?s=128&d=identicon&r=PG&f=1", "display_name": "Snake", "link": "https://stackoverflow.com/users/5388727/snake"}, "edited": false, "score": 1, "creation_date": 1499254812, "post_id": 44925094, "comment_id": 76825747, "body": "Thanks a lot for your answer! It helps a lot, not only by giving the answer to my question but to analyze my code and to make it better. While explaining why it will be better."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 10, "last_activity_date": 1499256425, "last_edit_date": 1499256425, "creation_date": 1499254395, "answer_id": 44925094, "question_id": 44924897, "link": "https://stackoverflow.com/questions/44924897/haskell-declare-empty-list-but-which-is-actually-not-empty/44925094#44925094", "title": "Haskell Declare empty list, but which is actually not empty?", "body": "<p>A list is defined as:</p>\n\n<pre><code>data [] a = [] | a : [a]\n</code></pre>\n\n<p>So there are two constructors for a list: <code>[]</code> the empty list, and <code>(x:xs)</code> a constructor with <em>one element</em>, and a <em>tail</em> that can store an arbitrary number (zero or more) remaining elements.</p>\n\n<p>Therefore <code>(x:xs)</code> is a list <strong>with at least one element</strong>: the <code>x</code>. The <code>xs</code> can be an empty list (since it has type <code>[a]</code>), but <code>x</code> has type <code>a</code> so that is the \"<em>head</em>\" of the list. Your <code>let</code> statement works with <strong>pattern matching</strong>, and since the empty list cannot match with <code>(x:xs)</code>, it will always fail.</p>\n\n<p>Another implication is that your <strong>first guard can never fire</strong>. In order to fix the issue, you should implement a separate case for the empty list. Like:</p>\n\n<pre><code>filterAge :: [Person] -&gt; [String]\n<b>filterAge []     = []</b> -- empty list case\nfilterAge (x:xs) -- first guard dropped\n    | (getAge x) &lt; 30 || (getAge x) &gt; 40  = [] ++ filterAge xs\n    | otherwise                           = [getName x] ++ filterAge xs</code></pre>\n\n<p>Note that we dropped the first guard in the second clause, since we know that will always fail, and thus checking this will (potentially) only cost CPU cycles.</p>\n\n<p>There are still some parts we can optimize:</p>\n\n<ol>\n<li>we call <code>getAge</code> twice, which is useless, we can use a <code>where</code> clause to optimize this;</li>\n<li><code>[] ++ somelist</code> is simply <code>somelist</code>: appending after an empty list results in that list; and</li>\n<li><code>[element] ++ somelist</code> is <code>element : somelist</code>, since now we work with the list constructor directly.</li>\n</ol>\n\n<p>So our <code>filterAge</code> can be rewritten into:</p>\n\n<pre><code>filterAge :: [Person] -&gt; [String]\nfilterAge []     = [] -- empty list case\nfilterAge (x:xs) | <b>age</b> &lt; 30 || <b>age</b> &gt; 40  = <b>filterAge xs</b>\n                 | otherwise             = <b>getName x : filterAge xs</b>\n    <b>where age = getAge x</b></code></pre>\n\n<p>Note that if you compile (or start the interpreter) with the <code>-Wincomplete-patterns</code> flag (<em>warnings</em> for incomplete patterns), Haskell will automatically warn you that your function definitions are not complete, and that there are input patterns for which you have not defined a clause.</p>\n"}, {"comments": [{"owner": {"reputation": 273, "user_id": 5388727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f066380ff341cde5c43a68f82641395?s=128&d=identicon&r=PG&f=1", "display_name": "Snake", "link": "https://stackoverflow.com/users/5388727/snake"}, "edited": false, "score": 0, "creation_date": 1499260207, "post_id": 44926397, "comment_id": 76829951, "body": "Thanks for the explanation, your answer created some more understanding for me."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 4, "last_activity_date": 1499261417, "last_edit_date": 1499261417, "creation_date": 1499257967, "answer_id": 44926397, "question_id": 44924897, "link": "https://stackoverflow.com/questions/44924897/haskell-declare-empty-list-but-which-is-actually-not-empty/44926397#44926397", "title": "Haskell Declare empty list, but which is actually not empty?", "body": "<p>To answer your \"main\" question,</p>\n\n<p><code>*Main> let (<strong>x</strong>:<strong>xs</strong>) = []      -- <em>(1)</em></code></p>\n\n<p>means, <em>when</em> <code>x</code>'s or <code>xs</code>'s value is required, <em>match</em> <code>(x:xs)</code> with <code>[]</code> and <em>use</em> the resulting bindings. The match will <em>never</em> succeed, and any such attempt will <em>always</em> result in patter-matching failure <em>error</em>.</p>\n\n<p>So why wasn't it?</p>\n\n<p><code>*Main> <b>(</b>x<b>:</b>xs<b>)</b> == []         -- <em>(2)</em></code></p>\n\n<p>Now this means, <em>try to compare</em> <code>(x:xs)</code> <em>and</em> <code>[]</code>. Both are lists; comparing lists involves pattern matching the top structure and then proceeding recursively  comparing the components, <em>on success</em> -- returning <code>False</code> <em>on failure</em> (not actually failing). Thus a match between <code>(_:_)</code> and <code>[]</code> is tried, and fails, resulting in an immediate <em>return</em> of the <code>False</code> value as the result of the comparison.</p>\n\n<p>Note that <em>values</em> bound to <strong><code>x</code></strong> and <strong><code>xs</code></strong> were <em>not</em> requested at any point; hence there was no error because the matching of <code>(x:xs)</code> and <code>[]</code> in <em><code>(1)</code></em> was never triggered.</p>\n"}], "owner": {"reputation": 273, "user_id": 5388727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f066380ff341cde5c43a68f82641395?s=128&d=identicon&r=PG&f=1", "display_name": "Snake", "link": "https://stackoverflow.com/users/5388727/snake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3542, "favorite_count": 0, "accepted_answer_id": 44925094, "answer_count": 2, "score": 4, "last_activity_date": 1499261417, "creation_date": 1499253831, "last_edit_date": 1499258977, "question_id": 44924897, "link": "https://stackoverflow.com/questions/44924897/haskell-declare-empty-list-but-which-is-actually-not-empty", "title": "Haskell Declare empty list, but which is actually not empty?", "body": "<p>I'm new to Haskell and are playing around a bit. I created a recursive function with guards. See function below: </p>\n\n<pre><code>filterAge :: [Person] -&gt; [String]\nfilterAge (x:xs)\n | (x:xs) == []                        = []\n | (getAge x) &lt; 30 || (getAge x) &gt; 40  = [] ++ filterAge xs\n | otherwise                           = [getName x] ++ filterAge xs\n</code></pre>\n\n<p>I have a data set created with 10 Persons which I use in this method. When I tried this function it gave all the right people, but after that it got a Non-exhaustive patterns error: \n<code>[\"Lise\",\"Jaap\",\"Elle\",\"Ebba\"*** Exception: D:\\...:(44,1)-(47,77): Non-exhaustive patterns in function filterAge</code></p>\n\n<p>I found out that it never reaches the first guard. So I played around a bit and found out something really strange (in my opinion): </p>\n\n<pre><code>*Main&gt; let (x:xs) = []\n*Main&gt; (x:xs) == []\nFalse\n</code></pre>\n\n<p>Now my main question is: Why does <code>(x:xs) == []</code> return False?</p>\n\n<p>If anyone has a better way for me of doing the function that'd be great, but it's not very important.</p>\n\n<p>Thanks in advance!</p>\n\n<p>EDIT</p>\n\n<p>Thanks to Willem Van Onsem and Lambda.xy.x I got a quick answer to my question. This resulted in the following function which works perfectly:</p>\n\n<pre><code>filterAge :: [Person] -&gt; [String]\nfilterAge []                           = []\nfilterAge (x:xs)\n | (getAge x) &lt; 30 || (getAge x) &gt; 40  = [] ++ filterAge xs\n | otherwise                           = [getName x] ++ filterAge xs\n</code></pre>\n\n<p>But for the best version you'd have to check the answer of Willem Van Onsem.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1499247413, "post_id": 44922403, "comment_id": 76820432, "body": "What is <code>String</code>?"}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1499252759, "post_id": 44922403, "comment_id": 76984057, "body": "I think you really should indicate what you&#39;re trying to do as well as any code you&#39;ve attempted as well as explaining your thought process. There are many possible things you could mean, depending on your level of understanding of these things. The fact that you&#39;ve written your code the way you have makes me think that it&#39;s quite possible you need to learn some much more fundmanetal things than String parsing first. I don&#39;t mean to sound rude or condescending, it&#39;s that what might seem like a simple thing quite probably isn&#39;t. It might help a lot to read the tutorial I helped write explicitly"}], "answers": [{"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": true, "score": 4, "last_activity_date": 1499248094, "creation_date": 1499248094, "answer_id": 44922683, "question_id": 44922403, "link": "https://stackoverflow.com/questions/44922403/understanding-haskell-basics/44922683#44922683", "title": "Understanding Haskell basics?", "body": "<p>What type are <code>apple</code> and <code>mango</code>? If you have created a Fruit type with several value constructors they should be capitalized like <code>Apple | Mango | Banana ...</code>  and you can then do like</p>\n\n<pre><code>read \"[Apple, Mango]\" :: [Fruit]\n</code></pre>\n\n<p>However if they are String type then your string should be like <code>\"[\\\"apple\\\",\\\"mango\\\"]\"</code> and you can then read them like</p>\n\n<pre><code>read \"[\\\"apple\\\",\\\"mango\\\"]\" :: [String]\n</code></pre>\n"}], "owner": {"reputation": 1231, "user_id": 6026051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-dO8H_7VApJo/AAAAAAAAAAI/AAAAAAAAFCw/Of-7HvES4dE/photo.jpg?sz=128", "display_name": "danish sodhi", "link": "https://stackoverflow.com/users/6026051/danish-sodhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "closed_date": 1499260913, "accepted_answer_id": 44922683, "answer_count": 1, "score": 0, "last_activity_date": 1499252759, "creation_date": 1499247357, "question_id": 44922403, "link": "https://stackoverflow.com/questions/44922403/understanding-haskell-basics", "closed_reason": "Needs details or clarity", "title": "Understanding Haskell basics?", "body": "<p>I have somethig like this : </p>\n\n<pre><code>String \"[apple,mango]\"\n</code></pre>\n\n<p>How can I extract apple and mango ? is there I way I can get List out of above expression ?</p>\n"}, {"tags": ["haskell", "reify", "rank-n-types"], "comments": [{"owner": {"reputation": 897, "user_id": 1755520, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mqzKa.jpg?s=128&g=1", "display_name": "bartavelle", "link": "https://stackoverflow.com/users/1755520/bartavelle"}, "edited": false, "score": 0, "creation_date": 1499261820, "post_id": 44920333, "comment_id": 76831179, "body": "Not answering your question, but the <code>serialize</code> and <code>deserialize</code> functions should not be defined, as it seems they only can have a single implementation, that is derived from the constraints."}], "answers": [{"comments": [{"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1499247284, "post_id": 44921277, "comment_id": 76820340, "body": "Not sure that&#39;s the kind of boilerplate removal I&#39;m looking at. I&#39;m trying to take the approach outlined at <a href=\"https://gist.github.com/aaronlevin/4aa22bd9c79997029167\" rel=\"nofollow noreferrer\">gist.github.com/aaronlevin/4aa22bd9c79997029167</a> - Any help with that?"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1499244458, "creation_date": 1499244458, "answer_id": 44921277, "question_id": 44920333, "link": "https://stackoverflow.com/questions/44920333/how-to-deserialise-a-json-where-the-corresponding-haskell-type-is-available-duri/44921277#44921277", "title": "How to deserialise a JSON where the corresponding Haskell type is available during runtime as a value?", "body": "<p>I wonder if something like this could work. I don't know the framework you are working with.</p>\n\n<pre><code>let go :: forall jobtype . Job -&gt; JobID -&gt; ....\n    go job jid =\n       case deserialise (job ^. jobdata) :: Either String jobtype of\n          Left e -&gt; error e\n          Right j -&gt; storeJobResult jid $ runAppM j\ncase (job ^. jobtype) of\n     SyncContacts -&gt; go @ SynContactsJob job jid\n     SendEmail    -&gt; go @ SendEmail job jid\n     ...\n</code></pre>\n\n<p>Otherwise, I'd try to see if singletons can help. Proxies could also be used if you don't want to enable ambiguous types &amp; type applications.</p>\n"}, {"comments": [{"owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "edited": false, "score": 0, "creation_date": 1499261072, "post_id": 44926498, "comment_id": 76830564, "body": "This is, unfortunately, my best ideas so far, as well. I&#39;m looking for something better than this :)"}], "tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": false, "score": 1, "last_activity_date": 1499258239, "creation_date": 1499258239, "answer_id": 44926498, "question_id": 44920333, "link": "https://stackoverflow.com/questions/44920333/how-to-deserialise-a-json-where-the-corresponding-haskell-type-is-available-duri/44926498#44926498", "title": "How to deserialise a JSON where the corresponding Haskell type is available during runtime as a value?", "body": "<p>I am loath to suggest it, but IMHO the \"right\" thing to do here is to forego type safety with a little runtime polymorphism. Instead of a type class, have an opaque <code>Handler</code> of sorts, in your case it'd probably be something like <code>Value -&gt; AppM ()</code>.</p>\n\n<p>Just put these in a <code>Map Type Handler</code> or something along those lines, which you can update dynamically; whereby <code>Type</code> is what you use to distinguish your job types (i.e. some sum type or, for minimum type safety, just a <code>String</code>). When you pull out a job you can just look up the appropriate handler in the list; The handler is opaque and knows which types it is responsible for, so the user end doesn't need to know how to deserialize values.</p>\n\n<p>This isn't very clever but should work nevertheless.</p>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1499258239, "creation_date": 1499241740, "question_id": 44920333, "link": "https://stackoverflow.com/questions/44920333/how-to-deserialise-a-json-where-the-corresponding-haskell-type-is-available-duri", "title": "How to deserialise a JSON where the corresponding Haskell type is available during runtime as a value?", "body": "<p>I'm trying to implement a port of DelayedJob (from the Rails world) in Haskell.</p>\n\n<p>Here's the typeclass I have which represents a <code>DelayedJob</code></p>\n\n<pre><code>class (FromJSON j, ToJSON j, FromJSON r, ToJSON r) =&gt; DelayedJob j r | j -&gt; r where\n  serialise :: j -&gt; Value\n  serialise = toJSON\n\n  deserialise :: Value -&gt; Either String j\n  deserialise = parseEither parseJSON\n\n  runJob :: j -&gt; AppM r\n</code></pre>\n\n<p>Here's how I plan to use it:</p>\n\n<pre><code>createJob :: (DelayedJob j r) =&gt; j -&gt; AppM JobId\n</code></pre>\n\n<p>I'm getting stuck with writing a fairly general <code>invokeJob</code> function which will read a row from the <code>jobs</code> table, look at the <code>jobs.jobtype</code> column and invoke the correct version of the <code>runJob</code> version (i.e. the <code>runJob</code> function belonging to the correct type-class instance).</p>\n\n<p>I have the following, but it is full of boilerplate:</p>\n\n<pre><code>data JobType = SyncContacts | SendEmail | SendSms deriving (Eq, Show, Generic)\n\ninvokeJob :: JobId -&gt; AppM ()\ninvokeJob jid = do\n  job &lt;- fetchJob jid\n  case (job ^. jobtype) of\n     SyncContacts -&gt; case (deserialise (job ^. jobdata) :: Either String SynContactsJob) of\n       Left e -&gt; error e\n       Right j -&gt; storeJobResult jid $ runAppM j\n     SendEmail -&gt; case (deserialise (job ^. jobdata) :: Either String SendEmailJob) of\n       Left e -&gt; error e\n       Right j -&gt; storeJobResult jid $ runAppM j\n     SendSms -&gt; case (deserialise (job ^. jobdata) :: Either String SendSms) of\n       Left e -&gt; error e\n       Right j -&gt; storeJobResult jid $ runAppM j\n</code></pre>\n\n<p>Essentially, is there a way to constrain the concrete type of the <code>deserialise</code> function dynamically during runtime without having to write so much boilerplate?</p>\n"}, {"tags": ["haskell", "asynchronous", "synchronized"], "answers": [{"comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1499225911, "post_id": 44916224, "comment_id": 76809325, "body": "You can also learn a lot reading the source of <code>async</code>. It&#39;s a very simple library, thanks to the power of stm primitives"}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 2, "last_activity_date": 1499222176, "creation_date": 1499222176, "answer_id": 44916224, "question_id": 44916052, "link": "https://stackoverflow.com/questions/44916052/synchronized-section-in-async-map/44916224#44916224", "title": "Synchronized section in async map", "body": "<p>The way you coordinate threads is via <code>MVar</code>s or <code>TVar</code>s if you want to use STM. You can read all about them in \"Parallel and Concurrent Haskell\". You could do something like:</p>\n\n<pre><code>do mutex &lt;- newMVar ()\n   let putStrLn' = withMVar mutex . const . putStrLn \n   mapConcurrently_ (iofunPrintingWith putStrLn') folderList\n</code></pre>\n"}], "owner": {"reputation": 302, "user_id": 4742633, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/b64bd428ea67772ed5eb5a1aa4d6108d?s=128&d=identicon&r=PG", "display_name": "Xlaech", "link": "https://stackoverflow.com/users/4742633/xlaech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1499222176, "creation_date": 1499220689, "question_id": 44916052, "link": "https://stackoverflow.com/questions/44916052/synchronized-section-in-async-map", "title": "Synchronized section in async map", "body": "<p>I have a big IO function that will continuesly load data from a folder, perform pure calculations on the data, and write it back.</p>\n\n<p>I am running this function over multiple folders in parallel using</p>\n\n<pre><code>mapConcurrently_ iofun folderList\n</code></pre>\n\n<p>from <a href=\"http://hackage.haskell.org/package/async-2.1.1.1/docs/Control-Concurrent-Async.html#v%3amapConcurrently\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/async-2.1.1.1/docs/Control-Concurrent-Async.html#v%3amapConcurrently</a></p>\n\n<p>This works perfecty... but a little bit too well. Now even the character output of the <code>putStrLn</code> calls are async, which leads to an unreadable console log.</p>\n\n<p><strong>Is there a way to make IO Actions synchronized or even better a synchronized version of putStrLn?</strong></p>\n"}, {"tags": ["haskell", "gtk3", "gtk2hs"], "answers": [{"tags": [], "owner": {"reputation": 3671, "user_id": 7728864, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hv4Sl.jpg?s=128&g=1", "display_name": "Jos&#233; Fonte", "link": "https://stackoverflow.com/users/7728864/jos%c3%a9-fonte"}, "is_accepted": false, "score": 0, "last_activity_date": 1499252068, "creation_date": 1499252068, "answer_id": 44924273, "question_id": 44914787, "link": "https://stackoverflow.com/questions/44914787/gtk2hs-missing-functions-when-migrating-from-gtk2-to-gtk3/44924273#44924273", "title": "Gtk2Hs : Missing functions when migrating from Gtk2 to Gtk3", "body": "<p><strong>GtkGLArea</strong> \u2014 A widget for custom drawing with OpenGL </p>\n\n<p>API: (<a href=\"https://developer.gnome.org/gtk3/stable/GtkGLArea.html\" rel=\"nofollow noreferrer\"> C </a>) (<a href=\"https://valadoc.org/gtk+-3.0/Gtk.GLArea.html\" rel=\"nofollow noreferrer\"> Vala </a>)</p>\n\n<blockquote>\n  <p>GtkGLArea is a widget that allows drawing with OpenGL.</p>\n  \n  <p>GtkGLArea sets up its own GdkGLContext for the window it creates, and\n  creates a custom GL framebuffer that the widget will do GL rendering\n  onto. It also ensures that this framebuffer is the default GL\n  rendering target when rendering.</p>\n  \n  <p>In order to draw, you have to connect to the \u201crender\u201d signal, or\n  subclass GtkGLArea and override the GtkGLAreaClass.render() virtual\n  function.</p>\n  \n  <p>The GtkGLArea widget ensures that the GdkGLContext is associated with\n  the widget's drawing area, and it is kept updated when the size and\n  position of the drawing area changes.</p>\n</blockquote>\n\n<p><strong>GtkWidget Size</strong></p>\n\n<p>To get the widget size, use the GtkAllocation getters. Notice that GtkWidget has request size methods but the allocated size may differ.</p>\n\n<ul>\n<li>Width: (<a href=\"https://developer.gnome.org/gtk3/stable/GtkWidget.html#gtk-widget-get-allocated-width\" rel=\"nofollow noreferrer\"> C </a>) (<a href=\"https://valadoc.org/gtk+-3.0/Gtk.Widget.get_allocated_width.html\" rel=\"nofollow noreferrer\"> Vala </a>)</li>\n<li>Height: (<a href=\"https://developer.gnome.org/gtk3/stable/GtkWidget.html#gtk-widget-get-allocated-height\" rel=\"nofollow noreferrer\"> C </a>) (<a href=\"https://valadoc.org/gtk+-3.0/Gtk.Widget.get_allocated_height.html\" rel=\"nofollow noreferrer\"> Vala </a>)</li>\n<li>GtkAllocation: (<a href=\"https://developer.gnome.org/gtk3/stable/GtkWidget.html#gtk-widget-get-allocation\" rel=\"nofollow noreferrer\"> C </a>) (<a href=\"https://valadoc.org/gtk+-3.0/Gtk.Widget.get_allocated_size.html\" rel=\"nofollow noreferrer\"> Vala </a>) </li>\n</ul>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499252068, "creation_date": 1499207851, "question_id": 44914787, "link": "https://stackoverflow.com/questions/44914787/gtk2hs-missing-functions-when-migrating-from-gtk2-to-gtk3", "title": "Gtk2Hs : Missing functions when migrating from Gtk2 to Gtk3", "body": "<p>I wrote a Haskell program with <code>Gtk2Hs</code> dealing with <code>Gtk2</code>. But when I tried to build my program with <code>Gtk3</code>, GHC complains about missing functions which doesn't exist anymore :</p>\n\n<pre><code>\u2022 Variable not in scope:\n    widgetGetSize :: GtkGL.GLDrawingArea -&gt; IO (Integer, Integer)\n\n\u2022 Variable not in scope:\n    renderWithDrawable :: t1 -&gt; Render () -&gt; IO ()\n</code></pre>\n\n<p><strong>Do you know if there are functions in <code>Gtk3</code> which could replace these functions ?</strong></p>\n\n<p><strong>Is there another way in Gtk3 to get the size of a widget ?</strong></p>\n\n<hr>\n\n<p>Note : I still can build my program with Gtk2 but I woulk like to anticipate a full migration to Gtk3 </p>\n"}, {"tags": ["haskell", "tree", "fold", "catamorphism"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1499206557, "post_id": 44914577, "comment_id": 76805570, "body": "What have you tried yourself? Furthermore I suppose the <code>fold</code> would work left to right?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1499206827, "post_id": 44914577, "comment_id": 76805655, "body": "Ah, good old catamorphisms. Briefy put, &quot;replace&quot; every constructor with a generic function (or constant). Note you have exactly 3 arguments (+ the plant), and 3 constructors. Name the arguments <code>leaf blossom stalk</code> so to make it obvious what they replace. Add some recursion."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1499206967, "post_id": 44914577, "comment_id": 76805687, "body": "@WillemVanOnsem There is no left-to-right or right-to-left here, it is not a list, nor an ADT visited like a <code>Foldable</code>. It&#39;s a plain catamorphism."}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 6278149, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/092596c1b1bc647a15058aafd34567b2?s=128&d=identicon&r=PG&f=1", "display_name": "dYTe", "link": "https://stackoverflow.com/users/6278149/dyte"}, "edited": false, "score": 0, "creation_date": 1499626136, "post_id": 44914735, "comment_id": 76973587, "body": "First of all, thanks for the great answer.  What I don&#39;t understand just yet is what exactly this fold function would be doing. How would an example call of the function look like? For example, how would I use this function to get the number of leaves in a plant? Since I can&#39;t just give a plant to the fold function"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1499207520, "creation_date": 1499207520, "answer_id": 44914735, "question_id": 44914577, "link": "https://stackoverflow.com/questions/44914577/how-would-i-implement-this-fold-function/44914735#44914735", "title": "How would I implement this fold function?", "body": "<p>If we look at the function signature:</p>\n\n<pre><code>fold_plant :: (x -&gt; x -&gt; x) -&gt; (Color -&gt; x) -&gt; x -&gt; Plant -&gt; x\n--            \\_____ _____/    \\____ _____/    |      |      |\n--                  v               v          v      v      v\n--                stalk           blossom     leaf  tree  output\n</code></pre>\n\n<p>We see that there is <code>stalk</code> part as well as a <code>blossom</code> part and a <code>leaf</code> part. We will name the <code>stalk</code> function <code>s</code> and the <code>blossom</code> function <code>b</code> here and the <code>leaf</code> part <code>l</code>. In order to simplify (and optimize) the function, we will unpack these three parameters, and then call a <em>recursive</em> method:</p>\n\n<pre><code>fold_plant s b l = fold_plant'\n    where fold_plant' = ...\n</code></pre>\n\n<p>Now the question is of course what to do with <code>fold_plant'</code>. Given we see a <code>Leaf</code>, we do not need to  perform any operation on the values, we simply return our leaf result <code>l</code>:</p>\n\n<pre><code>fold_plant' Leaf = l\n</code></pre>\n\n<p>In case we find a <code>(Blossom c)</code> with <code>c</code> a color, we have to perform a mapping from the <code>c :: Color</code> to an <code>x</code> with the <code>b</code> part to obtain the new value:</p>\n\n<pre><code>fold_plant' (Blossom c) = b c\n</code></pre>\n\n<p>Finally in case we have a <code>Stalk</code> we will have to perform recursion: we first call <code>fold_plant'</code> on the left stalk, and then we call the <code>fold_plant'</code> and construct an <code>s</code> with the two results:</p>\n\n<pre><code>fold_plant' (Stalk lef rig) = s (fold_plant' lef) (fold_plant' rig)\n</code></pre>\n\n<p>So we can put it all together into the following function:</p>\n\n<pre><code>fold_plant s b l = fold_plant'\n    where fold_plant' Leaf = l\n          fold_plant' (Blossom c) = b c\n          fold_plant' (Stalk lef rig) = s (fold_plant' lef) (fold_plant' rig)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": false, "score": 1, "last_activity_date": 1499255139, "last_edit_date": 1499255139, "creation_date": 1499254693, "answer_id": 44925180, "question_id": 44914577, "link": "https://stackoverflow.com/questions/44914577/how-would-i-implement-this-fold-function/44925180#44925180", "title": "How would I implement this fold function?", "body": "<p>A fold is a function that takes a piece of data in a structure, and collapses it to another piece of data. Usually we do this to \"reduce\" a collection to a single value. That's why if you look at other languages like Lisp, Smalltalk, Ruby, JavaScript, etc you'll find this operation called <code>reduce</code>, which is the poor cousin of folding in Haskell.</p>\n\n<p>I say it's the poor cousin because your intuition on lists is correct, but in Haskell we're much more abstract and general, so our fold functions can work on any kind of structure whose type we've told haskell what fold means for.</p>\n\n<p>So, we can talk about \"using addition with fold to turn a list of numbers into a sum value\", or we can talk about \"using a function to take a family tree of names and collapse it to a list\", and so on and so forth. Any time we have this idea of changing the structure of something to a single value, or maybe to a different structured set of values, that's folding.</p>\n\n<p>The \"canonical\" way to represent this in Haskell is <code>foldr :: Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b</code> but it's easier like you've thought to use \"a list of <code>a</code>\" as the <code>Foldable f =&gt; t a</code> type at the beginning coz it's a bit easier to understand. So we have a specialised type of <code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b</code>. But what are <code>a</code> and <code>b</code> ? and what is <code>(a -&gt; b -&gt; b)</code> and what do these three arguments do?</p>\n\n<p>Let's specialise it to <code>Int</code> values for both <code>a</code> and <code>b</code>: <code>foldr :: (Int -&gt; Int -&gt; Int) -&gt; Int -&gt; [Int] -&gt; Int</code> wow... that makes it ... interesting doesn't it? so <code>foldr</code> takes a function of two ints, like, say, the <code>(+)</code> function, and it takes a single <code>Int</code> value (this is the initial value it will use as the target result, and a list of <code>Int</code> values... then it'll produce a single <code>Int</code> from that... that is, it takes that <code>Int -&gt; Int -&gt; Int</code> function and applies it to the single <code>Int</code> and the first of the <code>[Int]</code>, then applies that function to that result and the next value of the <code>[Int]</code> and so on and so forth until there are no more <code>[Int]</code> left... then that's what it returns.</p>\n\n<p>It's quite literally folding the function over the data structure.</p>\n\n<p>That's all well and good for lists, which are a single straight line, but what you have is a tree, not a list. So how does it work there? Well, let's see how we might specialise <code>foldr</code> to produce a pair of the highest and lowest numbers from a list of <code>Int</code> instead? <code>foldr :: (Int -&gt; (Int, Int) -&gt; (Int, Int)) -&gt; (Int, Int) -&gt; [Int] -&gt; (Int, Int)</code>. So we take a function that takes an <code>Int</code> and a pair, and we put the initial pair into it, along with the first <code>Int</code> from our <code>[Int]</code>. That returns us a new pair, and we then do the same process for the <strong>next</strong> of the <code>[Int]</code> and then we continue that process untill all we're left with is a pair at the end.</p>\n\n<p><code>foldToMinMax = foldr (\\newNum (minnum,maxnum) -&gt; (min minnum newNum, max maxnum newNum)) (maxBound :: Int, minBound :: Int)</code></p>\n\n<p>So now things are getting a <em>little bit</em> clearer.</p>\n\n<p>What about this tree of flowers you have, though? Well, you need to write yourself a folding function that will take two values, one of which will be the same value as the initial value and the result value, and the other of which will be the type of your tree, and build a value of the result type. If I were to use pseudo code to write the types in a more descriptive way, I'd probably write something like: <code>foldr :: (contentOfCollectionType -&gt; resultType -&gt; resultType) -&gt; resultType -&gt; (collectionWrapper contentOfCollectionType) -&gt; resultType</code></p>\n\n<p>But you don't have to use <code>foldr</code> here, in fact you can't use it unless you do some fancy typeclass instantiation stuff anyway. You can totally write your own folding function using plain recursion. That's what they're after.</p>\n\n<p>If you want to learn about recursion and folding and whatnot, and you don't understand these things yet, I recommend the book I helped author. <a href=\"http://happylearnhaskelltutorial.com\" rel=\"nofollow noreferrer\">http://happylearnhaskelltutorial.com</a> It explains it in much more detail and with many clear examples. If you understand the basics, it should be pretty quick to get up to speed on the point where you want to know about recursion and folding... but if you don't, well it's going to be very useful for you to understand the basics because you need to know them before getting to the other stuff.</p>\n\n<p>I should mention that your particular fold also has a conversion function in it. It's the thing that converts a <code>Color</code> to an <code>x</code>. The function that you were given to work with as a folding function \"crushes x's together\" (ie takes two <code>x</code> values and produces another <code>x</code> value, very similar to <code>(+)</code> in our examples above). It can only work on trees because we also give it this function to turn a <code>Color</code> into an <code>x</code>, which effectively takes the meaningful data out of the tree and puts it into a form that the folding function can use.</p>\n\n<p>There's a very beautiful pattern at work here.</p>\n\n<p>Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1499263387, "last_edit_date": 1499263387, "creation_date": 1499260895, "answer_id": 44927473, "question_id": 44914577, "link": "https://stackoverflow.com/questions/44914577/how-would-i-implement-this-fold-function/44927473#44927473", "title": "How would I implement this fold function?", "body": "<p>Folding is the essence of recursive problem solving:</p>\n\n<pre><code>    data <b>Plant</b> =                        data Result <b>r</b> =    \n         Leaf                                RLeaf \n       | Blossom Color                     | RBlossom Color\n       | Stalk <b>Plant Plant</b>                 | RStalk <b>r r</b>\n            -- recursive data           -- non-recursive data: `r`, not `Result r`!</code></pre>\n\n<p>Recursive problem solving is about combining <em>in a simple manner</em> the results of recursively processing the constituents of the original structure:</p>\n\n<pre><code>    -- single-step reduction semantics:\n    -- reduction_step :: ..... -> Result r -> r\n    reduction_step :: (r -> r -> r) -> (Color -> r) -> r -> Result r -> r\n    reduction_step s b <b>l</b>  RLeaf       = <b>l</b>\n    reduction_step s <b>b</b> l (RBlosom c)  = <b>b</b> c\n    reduction_step <b>s</b> b l (RStalk x y) = <b>s</b> x y</code></pre>\n\n<p>But to get to this point we need to recurse into the constituent parts of our original structure which are of the same nature as the whole structure, and thus the <code>fold_plant</code> procedure which we seek to create can be applied to them as if already written (<em>recursion!</em>):</p>\n\n<pre><code>    recurse_into :: (r -> r -> r) -> (Color -> r) -> r -> Plant -> Result r\n    recurse_into s b l Leaf          = RLeaf\n    recurse_into s b l (Blossom c)   = RBlossom c\n    recurse_into s b l (Stalk <b>lt rt</b>) = RStalk (fold_plant s b l <b>lt</b>) (fold_plant s b l <b>rt</b>)</code></pre>\n\n<p>so, finally, our fold is simply a composition of the two,</p>\n\n<pre><code>    fold_plant :: (r -> r -> r) -> (Color -> r) -> r -> Plant -> r\n    fold_plant s b l <b>plant</b> = reduction_step s b l          --          Result r -> r\n                               (recurse_into s b l <b>plant</b>)  -- Plant -> Result r</code></pre>\n\n<p>Do follow the types and convince yourself that everything fits together as it should. </p>\n\n<p>The interim data definition can of course be eschewed and the function definition collapsed, but this is the <em>general</em> procedure to follow. </p>\n\n<p>(cf. <em>recursion schemes</em>).</p>\n"}], "owner": {"reputation": 161, "user_id": 6278149, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/092596c1b1bc647a15058aafd34567b2?s=128&d=identicon&r=PG&f=1", "display_name": "dYTe", "link": "https://stackoverflow.com/users/6278149/dyte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 908, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1499423330, "creation_date": 1499206336, "last_edit_date": 1499423330, "question_id": 44914577, "link": "https://stackoverflow.com/questions/44914577/how-would-i-implement-this-fold-function", "title": "How would I implement this fold function?", "body": "<p>Given are the two datatypes Color and Plant.</p>\n\n<pre><code>data Color = Red | Pink | White | Blue | Purple | Green | Yellow\n   deriving (Show, Eq)\n\ndata Plant =\n     Leaf\n   | Blossom Color\n   | Stalk Plant Plant\n   deriving (Show, Eq)\n</code></pre>\n\n<p>Now I'm supposed to implement a function <code>fold_plant</code> of following type:</p>\n\n<pre><code>(x -&gt; x -&gt; x) -&gt; (Color -&gt; x) -&gt; x -&gt; Plant -&gt; x\n</code></pre>\n\n<p>The way I understand a fold function is that it takes a list and for each iteration it removes the first element from the list and does something with that element.</p>\n\n<p>Apparently <code>fold_plant Stalk Blossom Leaf</code> is the identity on plants.</p>\n\n<p>Now I know that in Haskell you make functions like this:</p>\n\n<pre><code>fold_plant :: (x -&gt; x -&gt; x) -&gt; (Color -&gt; x) -&gt; x -&gt; Plant -&gt; x\nfold_plant = do something\n</code></pre>\n\n<p>But from here on I don't know how a fold function would work an a plant.</p>\n"}, {"tags": ["haskell", "hakyll"], "comments": [{"owner": {"reputation": 117024, "user_id": 200291, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/399cacf55045372a29f1f844d12ee777?s=128&d=identicon&r=PG", "display_name": "icktoofay", "link": "https://stackoverflow.com/users/200291/icktoofay"}, "edited": false, "score": 1, "creation_date": 1499206187, "post_id": 44914478, "comment_id": 76805483, "body": "Hackage doesn&#39;t know of a Hakyll 0.9.2.0, and it would be really old if it did exist. Did you mean 4.9.2.0? Furthermore, do you know what you upgraded from?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1499206336, "post_id": 44914478, "comment_id": 76805519, "body": "have you tried adding <code>{-# LANGUAGE OverloadedStrings -#}</code> Metadata is a type alias for <code>HashMap Text Value</code> and the compiler complains about the &quot;mathjax&quot; being a <code>String</code>"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1499206526, "post_id": 44914478, "comment_id": 76805562, "body": "Migrated from what to your current choice?"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1499208221, "answer_count": 0, "score": 0, "last_activity_date": 1499206432, "creation_date": 1499205601, "last_edit_date": 1499206432, "question_id": 44914478, "link": "https://stackoverflow.com/questions/44914478/new-version-of-hakyll-and-expected-type-map-char-a0", "closed_reason": "Duplicate", "title": "New version of Hakyll and Expected type : Map [Char] a0", "body": "<p>I wrote a context definition with Hakyll like this :</p>\n\n<pre><code>import qualified Data.Map as M\n....\nmathCtx :: Context String\nmathCtx = field \"mathjax\" $ \\item -&gt; do\n  metadata &lt;- getMetadata $ itemIdentifier item\n  return $ if \"mathjax\" `M.member` (metadata)\n           then \"&lt;script type=\\\"text/javascr ...  script&gt;\"\n           else \"\"\n</code></pre>\n\n<p>It worked well until I migrated to <code>Debian 9</code>, <code>Hakyll 4.9.2.0</code> and <code>GHC 8.0.1</code>. Now, I have this error message when compiling :</p>\n\n<pre><code>\u2022 Couldn't match type \u2018unordered-containers-0.2.7.1:Data.HashMap.Base.HashMap\n                         text-1.2.2.1:Data.Text.Internal.Text\n                         aeson-0.11.2.1:Data.Aeson.Types.Internal.Value\u2019\n                 with \u2018M.Map [Char] a0\u2019\n  Expected type: M.Map [Char] a0\n    Actual type: Metadata\n\u2022 In the second argument of \u2018M.member\u2019, namely \u2018(metadata)\u2019\n  In the expression: \"mathjax\" `M.member` (metadata)\n  In the second argument of \u2018($)\u2019, namely\n    \u2018if \"mathjax\" `M.member` (metadata) then\n         \"&lt;script type=\\\"text/javascr ...  script&gt;\"\n     else\n         \"\"\u2019\n</code></pre>\n\n<p><strong>Do you know what is going wrong now with my function and how to correct this ?</strong></p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 2913687, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61d8f7a79624abbd9cbdc0c3f3619e54?s=128&d=identicon&r=PG&f=1", "display_name": "patronus", "link": "https://stackoverflow.com/users/2913687/patronus"}, "edited": false, "score": 0, "creation_date": 1499202981, "post_id": 44914023, "comment_id": 76804647, "body": "That makes sense. Thank you!! I tried drop5 [2] and that did not return any error."}], "tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": true, "score": 5, "last_activity_date": 1499202614, "creation_date": 1499202614, "answer_id": 44914023, "question_id": 44913999, "link": "https://stackoverflow.com/questions/44913999/haskell-function-definition-not-working-as-expected/44914023#44914023", "title": "Haskell function definition not working as expected", "body": "<p>In the first definition, <code>[a]</code> is a pattern that only matches a list of exactly one element, and that element becomes known as <code>a</code> in the right part of the rule.</p>\n\n<p>Thus, you define the function as only accepting singleton lists.</p>\n\n<p>Moreover, dropping 5 elements from a list that only has one obviously results in an empty list (as does dropping of any positive number of elements).</p>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 2913687, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61d8f7a79624abbd9cbdc0c3f3619e54?s=128&d=identicon&r=PG&f=1", "display_name": "patronus", "link": "https://stackoverflow.com/users/2913687/patronus"}, "edited": false, "score": 0, "creation_date": 1499203251, "post_id": 44914031, "comment_id": 76804729, "body": "Interesting. How does compiler know if it is a pattern or parameter? Also I am using hugs98 to start with (this was recommended on edx Intro to functional programming course). I am not sure how to compile a file here."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 73, "user_id": 2913687, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61d8f7a79624abbd9cbdc0c3f3619e54?s=128&d=identicon&r=PG&f=1", "display_name": "patronus", "link": "https://stackoverflow.com/users/2913687/patronus"}, "edited": false, "score": 1, "creation_date": 1499203315, "post_id": 44914031, "comment_id": 76804755, "body": "@patronus: a parameter <i>is</i> a pattern. You can however - in the head - use a pattern. In that case the line is &quot;fired&quot; if the pattern matches. Pattern matching is one of the aspects that almost all functional programming languages share."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1499202627, "creation_date": 1499202627, "answer_id": 44914031, "question_id": 44913999, "link": "https://stackoverflow.com/questions/44913999/haskell-function-definition-not-working-as-expected/44914031#44914031", "title": "Haskell function definition not working as expected", "body": "<p>Your function definition:</p>\n\n<pre><code>drop5 [a] = drop 5 [a]\n</code></pre>\n\n<p>Specifies that the clause only \"fires\" for lists with exactly <em>one</em> element. Indeed in a function definition <code>[a]</code> is <strong>not the type</strong> of the parameter, it is <strong>a pattern</strong>. The pattern <code>[a]</code> means that we are working with a list with exactly one element.</p>\n\n<p>If you compile with <code>-Wall</code> you will get:</p>\n\n<pre><code>&lt;interactive&gt;:1:1: warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for \u2018drop5\u2019:\n        Patterns not matched:\n            []\n            (_:_:_)\n</code></pre>\n\n<p>The compiler/interpreter thus produces a warning that two patterns are not covered: one for an <em>empty</em> list, and one for a list with <em>two or more elements</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 378, "user_id": 5276213, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8bcd1b38316d6888a169c66403f8cc65?s=128&d=identicon&r=PG", "display_name": "aimorris", "link": "https://stackoverflow.com/users/5276213/aimorris"}, "is_accepted": false, "score": 2, "last_activity_date": 1499202922, "creation_date": 1499202922, "answer_id": 44914082, "question_id": 44913999, "link": "https://stackoverflow.com/questions/44913999/haskell-function-definition-not-working-as-expected/44914082#44914082", "title": "Haskell function definition not working as expected", "body": "<p><code>[a]</code> is telling Haskell that there is only one element in a list, while <code>ns</code> tells Haskell that it could be anything (even a boolean if you want) until you finish the function and it identifies the output and input type. You could also explicitly tell Haskell what the input and output type is by adding this above that line:</p>\n\n<pre><code>drop5 :: [Integer] -&gt; [Integer]\n</code></pre>\n\n<p>Which could be found by doing <code>:t drop5</code> in GHCI.</p>\n\n<p>Also, on a side note, this code can be reduced. By changing it to:</p>\n\n<pre><code>drop5 = drop 5\n</code></pre>\n\n<p>This may not make sense to you right now, but as you learn more you should learn that all Haskell functions take one argument.</p>\n"}], "owner": {"reputation": 73, "user_id": 2913687, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/61d8f7a79624abbd9cbdc0c3f3619e54?s=128&d=identicon&r=PG&f=1", "display_name": "patronus", "link": "https://stackoverflow.com/users/2913687/patronus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 44914023, "answer_count": 3, "score": 3, "last_activity_date": 1499202922, "creation_date": 1499202395, "last_edit_date": 1499202673, "question_id": 44913999, "link": "https://stackoverflow.com/questions/44913999/haskell-function-definition-not-working-as-expected", "title": "Haskell function definition not working as expected", "body": "<p>I am new to functional programming and Haskell. Trying to learn it. Not sure what is wrong with the following definition:</p>\n\n<p>Function definition in test.h</p>\n\n<pre><code>drop5 [a]  = drop 5 [a] \n</code></pre>\n\n<p>Trying to use this function I get Program error</p>\n\n<pre><code>$:load test.h\n$drop5 [2,3,4,5,6,7,8]\nProgram error: pattern match failure: drop5 [2,3,4,5,6,7,8]\n$:t drop5\ndrop5 :: [a] -&gt; [a]\n</code></pre>\n\n<p>When I change the definition to following it works; meaning it takes a list and drops first 5 elements of the list</p>\n\n<pre><code>drop5 ns = drop 5 ns\n</code></pre>\n\n<p>And in this case when print type I see:</p>\n\n<pre><code>$:t drop5\ndrop5 :: [a] -&gt; [a]\n</code></pre>\n\n<p>I am not sure why is the first definition different than second? And what does the error \"Program error: pattern match failure means\"?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1499198539, "post_id": 44912933, "comment_id": 76803041, "body": "I&#39;d rather use an explicit predicate <code>p :: t -&gt; Bool</code>, than relying on a kind-of implicit conversion. Also one can use <code>rule (fmap p someU)</code> if needed. More generally, if <code>if, &amp;&amp;, ||, ...</code> do not support &quot;truthy&quot; values, why should a library support those, especially when there&#39;s a good explicit way to convert? (And, before someone asks, I&#39;d not extend <code>if,...</code> to a typeclass -- even Java removed the C conditional <code>if (intExpr)</code> in favor of a better, explicit, statically checked boolean expression)"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 4, "creation_date": 1499199607, "post_id": 44912933, "comment_id": 76803449, "body": "Not being able to accidentally use a non-boolean value like 0 when you meant to use a boolean is exactly why we have a type system. This typeclass would do nothing but subvert the intention of the type system. One useful typeclass that is somewhat similar would be a lattice, where True and False would be top and bottom, respectively."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1499216168, "post_id": 44912933, "comment_id": 76807500, "body": "The answer below mentions boolean algebras; this structure can be formalized in terms of both rings and lattices, and there are several packages available which define classes for these algebraic structures. In a sense, a boolean algebra is &quot;too big&quot; to be practical - in most cases, you are actually working with a smaller algebraic structure (e.g. a monoid).  &quot;...other types that would be able to have truthyness values, such as Ints&quot; - the equivalence class of <code>Int</code> w.r.t the equality identifying 0 with 0 and every other number with every other number is a perfectly reasonable Boolean algebra!"}], "answers": [{"comments": [{"owner": {"reputation": 1698, "user_id": 4050510, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3123195051caa2f71674df0798284b0?s=128&d=identicon&r=PG", "display_name": "LudvigH", "link": "https://stackoverflow.com/users/4050510/ludvigh"}, "edited": false, "score": 0, "creation_date": 1499235244, "post_id": 44913396, "comment_id": 76812403, "body": "Actually the c is probably unnecessary.... I took it verbatim from the article referenced, so I didn&#39;t reflect on it before!  Thanks for a nice answer."}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": true, "score": 6, "last_activity_date": 1499211542, "last_edit_date": 1499211542, "creation_date": 1499198834, "answer_id": 44913396, "question_id": 44912933, "link": "https://stackoverflow.com/questions/44912933/is-there-a-typeclass-in-haskell-for-boolean-values/44913396#44913396", "title": "Is there a typeclass in haskell for boolean values?", "body": "<p>Digression: Generally we don't use type classes to do what you might call <em>mere overloading</em>, of the sort you find in dynamic languages (e.g. making <code>+</code> mean \"concatenate lists\" or \"add ints\", or overloading boolean operations to work on \"truthy\" values as in your question). The difference is I guess that we say good abstractions are made with type classes that have a set of laws that hold them together, so that you can write <em>polymorphic</em> code that is useful. It might be that we can make a \"truthy\" class that's good by this standard but I'm not sure.</p>\n\n<p>But to get to your question, there are certainly classes that abstract boolean logic to some degree (the field of study here being maybe <a href=\"https://en.wikipedia.org/wiki/Boolean_algebra\" rel=\"nofollow noreferrer\">Boolean algebra</a>), the most relevant here probably being the <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Bits.html\" rel=\"nofollow noreferrer\"><code>Bits</code></a> class from <code>Data.Bits</code>.</p>\n\n<p>So you'd get:</p>\n\n<pre><code>-- note, the polymorphic `t` has cooties, and we'd need to be able to\n-- make the caller polymorphic in a sensible way too for this to make sense\nrule :: (Bits t) =&gt; U t -&gt; t\nrule (U (a:_) b (c:_)) = complement (a .&amp;. b .&amp;. complement c .|. complement (a `xor` b))\n</code></pre>\n\n<p>The only tricky bit above is <code>a == b</code> becomes the wordy more general form <code>complement (a ``xor`` b)</code>. Actually if we restrict ourselves to the fundamental operations (AND/OR/NOT), then the more general form of <code>==</code> is quite complicated:</p>\n\n<pre><code>a .==. b = complement ((a .|. b) .&amp;. complement (a .&amp;. b))\n</code></pre>\n\n<p>It would be interesting to see whether or in what way this operation makes sense with this more general type (I don't know what it's meant to do), e.g. does it do something sensible for <code>Int</code>. Then compare that with <code>Int</code> had we used your \"truthy\" class. Is one more useful than the other? Does the <code>Bits</code> version give you any new insight into the algorithm or is it just an arbitrary overloading?</p>\n\n<p><strong>Edit</strong>: here's something interesting about working in this more abstract domain: we can use the laws of boolean algebra to reduce and understand our expression better. For instance by <a href=\"https://www.wolframalpha.com/input/?i=NOT+%28%28A+and+B+and+NOT+C%29+or+%28NOT+%28A+XOR+B%29%29%29\" rel=\"nofollow noreferrer\">handing it off to Wolfram Alpha</a> we can observe that the normalized forms of our expression <em>don't contain <code>c</code> at all</em> (you should double-check I haven't made a mistake somewhere), so we might as well have written:</p>\n\n<pre><code>rule (U (a:_) b _) = (a &amp;&amp; not b) || (not a &amp;&amp; b)\n</code></pre>\n\n<p>This might be interesting insight (is that <code>c</code> even necessary in our data structure?) or might indicate a bug in our logic.</p>\n"}], "owner": {"reputation": 1698, "user_id": 4050510, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3123195051caa2f71674df0798284b0?s=128&d=identicon&r=PG", "display_name": "LudvigH", "link": "https://stackoverflow.com/users/4050510/ludvigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 0, "accepted_answer_id": 44913396, "answer_count": 1, "score": 4, "last_activity_date": 1499211542, "creation_date": 1499196274, "last_edit_date": 1499197265, "question_id": 44912933, "link": "https://stackoverflow.com/questions/44912933/is-there-a-typeclass-in-haskell-for-boolean-values", "title": "Is there a typeclass in haskell for boolean values?", "body": "<p>I am trying to learn some Haskell by looking at a superb short and educational article on comonad application from 2006 <a href=\"http://blog.sigfpe.com/2006/12/evaluating-cellular-automata-is.html\" rel=\"nofollow noreferrer\">link</a> and it contains an expression like <code>rule (U (a:_) b (c:_)) = not (a &amp;&amp; b &amp;&amp; not c || (a==b))</code> whre <code>U</code> is a zipper comonad. That is stated in <code>data U x = [x] x [x]</code> and accompanying implementations of the comonad operations.</p>\n\n<p>Trying to learn more, I am attempting to annotate the type of the expression manually. A wise choice seems to be <code>rule :: U Bool -&gt; Bool</code>, but that seems a bit... restrictive. I could imagine other types that would be able to have truthyness values, such as Ints (0 corresponds to false, all other values could be True) and other. </p>\n\n<p>If there was a type class for truthyness called <code>truthy</code>, I guess I could write <code>rule :: (Truthy t) =&gt; U t -&gt; Bool</code>. Since I want to iterate over <code>rule</code>, the first type annotation (<code>rule :: U Bool -&gt; Bool</code>) is good enough, but still the question tickles my brain.</p>\n\n<p>Is there such a typeclass? If there is, what is it called? If not, why is there no need for it?</p>\n"}, {"tags": ["haskell", "distributed-computing", "actor", "cloud-haskell"], "owner": {"reputation": 261, "user_id": 6483826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/719b751a6f8adbf559f769fabbfed0e8?s=128&d=identicon&r=PG&f=1", "display_name": "pricks", "link": "https://stackoverflow.com/users/6483826/pricks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1499195525, "creation_date": 1499195525, "question_id": 44912772, "link": "https://stackoverflow.com/questions/44912772/node-edges-with-distribution", "title": "Node Edges with Distribution", "body": "<p>I've been playing around with cloud Haskell (erlang style distribution), and I was curious if there was any reason not to have every node store the node id of every other node.  I think it makes distributing the database easier as well as balancing processes, and the n size should be small enough that it shouldn't take up too much memory.  But before I move forward I was just curious if there are any downsides I haven't thought of.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "applicative"], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1499210085, "post_id": 44911664, "comment_id": 76806360, "body": "Thank you, that is an extremely helpful answer. How would you write the function then... something like <code>liftA2 (&lt;$&gt;) (,) (Just . reverse)</code> ?"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 3, "creation_date": 1499211938, "post_id": 44911664, "comment_id": 76806729, "body": "@matthias <code>(\\xs -&gt; Just (xs, reverse xs))</code> would probably be ideal for readability."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 3, "creation_date": 1499241758, "post_id": 44911664, "comment_id": 76816396, "body": "@matthias As a thumb rule, when pointfree code is longer than the pointful version, it should not be used. 4castle&#39;s version is perfectly clear, and even shorter. If I really wanted a pointfree one, I&#39;d use <code>Just . (id &amp;&amp;&amp; reverse)</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 10, "last_activity_date": 1499190321, "creation_date": 1499190321, "answer_id": 44911664, "question_id": 44910835, "link": "https://stackoverflow.com/questions/44910835/how-does-this-haskell-code-work-fmap-fmap-just-reverse/44911664#44911664", "title": "How does this Haskell code work? fmap fmap (,) &lt;*&gt; Just . reverse", "body": "<p>Let's try to decode this pointless style obfuscation:</p>\n\n<pre><code>fmap fmap (,) &lt;*&gt; Just . reverse $ \"stackoverflow\"\n</code></pre>\n\n<p>First step: how this is parsed? Well, <code>$</code> has low precedence, so it's</p>\n\n<pre><code>(fmap fmap (,) &lt;*&gt; Just . reverse) $ \"stackoverflow\"\n</code></pre>\n\n<p>Also, I guess that the infix <code>&lt;*&gt;</code> has a lower precedence than <code>.</code> (one could check using the documentation or <code>:i</code> in GHCi). So, we get</p>\n\n<pre><code>((fmap fmap (,)) &lt;*&gt; (Just . reverse)) $ \"stackoverflow\"\n</code></pre>\n\n<p>Let's beta-reduce the <code>$</code></p>\n\n<pre><code>((fmap fmap (,)) &lt;*&gt; (Just . reverse)) \"stackoverflow\"\n</code></pre>\n\n<p>So, the result of <code>&lt;*&gt;</code> is a function. This means that we are working in the <code>(-&gt;) a</code> applicative. There, <code>(&lt;*&gt;) = \\x y z -&gt; x z (y z)</code> AKA the S combinator from lambda calculus. We can beta-reduce that:</p>\n\n<pre><code>(\\z -&gt; (fmap fmap (,)) z ((Just . reverse) z)) \"stackoverflow\"\n</code></pre>\n\n<p>More betas, removing parentheses when we can:</p>\n\n<pre><code>fmap fmap (,) \"stackoverflow\" ((Just . reverse) \"stackoverflow\")\n</code></pre>\n\n<p>More simplification:</p>\n\n<pre><code>fmap fmap (,) \"stackoverflow\" (Just (reverse \"stackoverflow\"))\nfmap fmap (,) \"stackoverflow\" (Just \"wolfrevokcats\")\n</code></pre>\n\n<p>Now, the <code>fmap fmap (,)</code> part. The <code>(,)</code> argument is a function, so this means that the first <code>fmap</code> is working in the <code>(-&gt;) a</code> functor. There, <code>fmap = (.)</code>. So, it's just obfuscation for</p>\n\n<pre><code>(.) fmap (,) \"stackoverflow\" (Just \"wolfrevokcats\")\n(fmap . (,)) \"stackoverflow\" (Just \"wolfrevokcats\")\n(fmap ((,) \"stackoverflow\")) (Just \"wolfrevokcats\")\nfmap ((,) \"stackoverflow\") (Just \"wolfrevokcats\")\n</code></pre>\n\n<p>Now, the second argument of <code>fmap</code> is of type <code>Maybe String</code>, so the <code>fmap</code> is working in the <code>Maybe</code> functor. There, <code>fmap f (Just x) = Just (f x)</code>. We get</p>\n\n<pre><code>Just (((,) \"stackoverflow\") \"wolfrevokcats\")\nJust ((,) \"stackoverflow\" \"wolfrevokcats\")\nJust (\"stackoverflow\", \"wolfrevokcats\")\n</code></pre>\n\n<p>Conclusion: pointless code is often pointless. To decode this snippet we had to run the type inferer in our head, recall <em>three</em> specific instances (even if they are pretty standard), and cope with precedence. No one should ever use this style except for deliberate obfuscation. (Surely not as a hiring puzzle!)</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 44911664, "answer_count": 1, "score": 1, "last_activity_date": 1499190321, "creation_date": 1499186574, "question_id": 44910835, "link": "https://stackoverflow.com/questions/44910835/how-does-this-haskell-code-work-fmap-fmap-just-reverse", "title": "How does this Haskell code work? fmap fmap (,) &lt;*&gt; Just . reverse", "body": "<p>Would someone help explain/breakdown the following code:</p>\n\n<pre><code>\u03bb&gt; fmap fmap (,) &lt;*&gt; Just . reverse $ \"stackoverflow\"\nJust (\"stackoverflow\",\"wolfrevokcats\")\n</code></pre>\n\n<p>It would be great if someone could walk me through their process of understanding the mechanics of this kind of code.</p>\n"}, {"tags": ["json", "haskell", "abstract-syntax-tree", "purescript"], "answers": [{"tags": [], "owner": {"reputation": 4039, "user_id": 1341956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbed6f201f9a0e735e5660d118c6662d?s=128&d=identicon&r=PG", "display_name": "Phil Freeman", "link": "https://stackoverflow.com/users/1341956/phil-freeman"}, "is_accepted": false, "score": 4, "last_activity_date": 1499186841, "creation_date": 1499186841, "answer_id": 44910907, "question_id": 44909332, "link": "https://stackoverflow.com/questions/44909332/type-info-in-ast-in-purescript/44910907#44910907", "title": "Type info in AST in Purescript", "body": "<p>There is already <a href=\"https://github.com/purescript/purescript/issues/2657\" rel=\"nofollow noreferrer\">an issue for this in the compiler</a>. You would need to modify the compiler if you need type information. The only option right now is to fork the compiler if you want the full AST.</p>\n"}], "owner": {"reputation": 41, "user_id": 7027214, "user_type": "registered", "profile_image": "https://graph.facebook.com/586893134796393/picture?type=large", "display_name": "Danya Rogozin", "link": "https://stackoverflow.com/users/7027214/danya-rogozin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1499186841, "creation_date": 1499180820, "question_id": 44909332, "link": "https://stackoverflow.com/questions/44909332/type-info-in-ast-in-purescript", "title": "Type info in AST in Purescript", "body": "<p>I'm working with Purescript AST. Dump-corefn gives out incomplete info about program: there's no info about types in <code>corefn.json</code>-file. \nWhat could you advise for getting full AST without type removing?\nThank you.</p>\n\n<p>Example given <a href=\"https://github.com/paf31/24-days-of-purescript-2016/blob/master/22.markdown\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": ["parsing", "haskell", "functional-programming"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1499183977, "post_id": 44908127, "comment_id": 76796980, "body": "Your second test shows a space captured in the expected output on <code>&quot;bcde &quot;</code>. I thought you only wanted alphanumeric characters in the output. Is that a typo?"}, {"owner": {"reputation": 43, "user_id": 8226044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f335b3aead6b12030d0f2fb3b04da7?s=128&d=identicon&r=PG&f=1", "display_name": "JoeSteel", "link": "https://stackoverflow.com/users/8226044/joesteel"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1499185877, "post_id": 44908127, "comment_id": 76797878, "body": "Ahh. Missed that one. We were not given direct task instructions, just the test cases. So I assumed that it was only alphanumeric character, but I totaly missed that space character. I am going to edit it in my Quesition."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 8226044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f335b3aead6b12030d0f2fb3b04da7?s=128&d=identicon&r=PG&f=1", "display_name": "JoeSteel", "link": "https://stackoverflow.com/users/8226044/joesteel"}, "edited": false, "score": 0, "creation_date": 1499186105, "post_id": 44910054, "comment_id": 76797970, "body": "Great idea. didnt think of it. Could you explain pairs &lt;- parsePair <code>sepBy1</code> (string &quot;;\\n&quot; &gt;&gt; optional (char &#39; &#39;)) a bit more? what does &quot;sepBy 1 &quot; and optional do?"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 43, "user_id": 8226044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f335b3aead6b12030d0f2fb3b04da7?s=128&d=identicon&r=PG&f=1", "display_name": "JoeSteel", "link": "https://stackoverflow.com/users/8226044/joesteel"}, "edited": false, "score": 1, "creation_date": 1499186490, "post_id": 44910054, "comment_id": 76798150, "body": "Here&#39;s the documentation for <a href=\"http://hackage.haskell.org/package/parsec-3.1.11/docs/Text-Parsec-Combinator.html#v:sepBy1\" rel=\"nofollow noreferrer\"><code>sepBy1</code></a> and <a href=\"http://hackage.haskell.org/package/parsec-3.1.11/docs/Text-Parsec-Combinator.html#v:optional\" rel=\"nofollow noreferrer\"><code>optional</code></a>. <code>sepBy1</code> will parse a list of the first parameter separated by the second parameter. <code>optional</code> will try to parse something, but then ignores it if the match fails."}], "tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 2, "last_activity_date": 1499187244, "last_edit_date": 1499187244, "creation_date": 1499183384, "answer_id": 44910054, "question_id": 44908127, "link": "https://stackoverflow.com/questions/44908127/parser-in-haskell-for-triples/44910054#44910054", "title": "Parser in Haskell for Triples", "body": "<p>What you could do is:</p>\n\n<ol>\n<li>Parse the first character</li>\n<li>Parse a list of pairs</li>\n<li>Add the first character to each of the pairs to create triples</li>\n</ol>\n\n<p>Using <code>do</code> notation will make your code more readable.<br>\nYou can use <code>alphaNum</code> as a shorthand for <code>letter &lt;|&gt; digit</code>.</p>\n\n<pre><code>parseTriplesD :: Parser Triples\nparseTriplesD = Triples &lt;$&gt; parseTriples\n\nparseTriples :: Parser [Triple]\nparseTriples = do\n    a &lt;- parseString\n    char ','\n    pairs &lt;- parsePair `sepBy1` string \";\\n\"\n    char '.'\n    eof\n    return (map (\\(b, c) -&gt; (a, b, c)) pairs)\n\nparsePair :: Parser (String, String)\nparsePair = do\n    first &lt;- parseString\n    char ','\n    second &lt;- parseString\n    return (first, second)\n\nparseString :: Parser String\nparseString = many (char ' ') &gt;&gt; many (alphaNum &lt;|&gt; char ' ')\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8226044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f335b3aead6b12030d0f2fb3b04da7?s=128&d=identicon&r=PG&f=1", "display_name": "JoeSteel", "link": "https://stackoverflow.com/users/8226044/joesteel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 240, "favorite_count": 0, "accepted_answer_id": 44910054, "answer_count": 1, "score": 1, "last_activity_date": 1499187244, "creation_date": 1499177216, "last_edit_date": 1499186021, "question_id": 44908127, "link": "https://stackoverflow.com/questions/44908127/parser-in-haskell-for-triples", "title": "Parser in Haskell for Triples", "body": "<p>I am currently doing an assignment about Parsing in Haskell, but I am struggling with some of the basics.</p>\n\n<p><strong>Assignment</strong> :\nI am supposed to create a function which parses a string into a list of Triples.\nSo that:\nA, B, C\n  ,E ,D</p>\n\n<p>would result in </p>\n\n<pre><code>Triples [(\"A\",\"B\",\"C\"), (\"A\",\"E\",\"D\")]\n</code></pre>\n\n<p>The input string is going to include ;\\n as an indication for the beginng of a new Triple. The string is going to end with a dot.\nThe elements of the Triples can be letters or digits or combination, \ne.g. abc, a, 1, abc121.</p>\n\n<p>Therefore, </p>\n\n<pre><code>\"a,b,c;\\n d,e;\\n f,g;\\n h,i.\"  \n</code></pre>\n\n<p>would result in:</p>\n\n<pre><code>Triples [(\"a\",\"b\",\"c\"),(\"a\",\"d\",\"e\"),(\"a\",\"f\",\"g\"),(\"a\",\"h\",\"i\")]\n</code></pre>\n\n<h2>My current solution:</h2>\n\n<pre><code>parseTriplesD :: Parser Triples\nparseTriplesD = parseTriples \n            &gt;&gt;= \\rs -&gt; return (Triples rs)\n</code></pre>\n\n<p>This function is pretty simple and correct. Takes the string and returns a object of the newtype Triples with the List of Triples created by parseTriples.</p>\n\n<pre><code>parseTriples :: Parser [Triple]\nparseTriples = parseTriple \n            &gt;&gt;= \\r -&gt; ((string \";\\n\" &gt;&gt; parseTriples &gt;&gt;= \\rs -&gt; return (r:rs)) \n            P.&lt;|&gt;(return[r]))\n</code></pre>\n\n<p>This function needs some work. My idea is that I use another function which creates a Triple with tree Elements of the input string, ignores the /n and recursivly calls it self while adding the created triples to a return list. When this does not work because it can only create one Triple, it returns a list with the Triple. \nI somehow need to create the first Triple, and then use first element of this triple as the first element of the other ones. </p>\n\n<p><strong>Question 1</strong>\nHow do I create the first Triple and use the first Elements of the Triple for the other Triples?</p>\n\n<pre><code>parseTriple :: Parser Triple\nparseTriple = P.many (letter&lt;|&gt;digit) &gt;&gt;= \\a -&gt; P.char ','\n            &gt;&gt; P.many (letter&lt;|&gt;digit)&gt;&gt;= \\b -&gt; P.char ','\n            &gt;&gt; P.many (letter&lt;|&gt;digit)&gt;&gt;= \\c -&gt; return ((a,b,c))\n</code></pre>\n\n<p>This function is pretty simple but I am not sure if its correct.\nMy idea is that it takes the first couple of characters of the string which are either a letter or a digit, up until the comma  \",\" , and saves these charcters in a.\nIt is repeated 3 times, and the creates and returns a Triple with the three elements.</p>\n\n<p><strong>Question 2</strong> \nHow do I take only a few characters (which are either a letter or a digit EDIT: Or A SPACE Character) of the string up until the comma?\nIs P.many (letter&lt;|>digit) correct?</p>\n\n<h2>What we are given:</h2>\n\n<p><strong>The Triples data structue:</strong></p>\n\n<pre><code>newtype Triples = Triples [Triple] deriving (Show,Eq)\ntype Triple = (String, String, String) \n</code></pre>\n\n<p><strong>Imports:</strong></p>\n\n<pre><code>import Test.HUnit (runTestTT,Test(TestLabel,TestList),(~?=))\nimport qualified Text.Parsec as P (char,runP,noneOf,many,(&lt;|&gt;),eof)\nimport Text.ParserCombinators.Parsec\nimport Text.Parsec.String \nimport Text.Parsec.Char\nimport Data.Maybe\n</code></pre>\n\n<p><strong>Test cases</strong></p>\n\n<pre><code>runParsec :: Parser a -&gt; String -&gt; Maybe a\nrunParsec parser input = case P.runP parser () \"\" input of\n    Left  _ -&gt; Nothing\n    Right a -&gt; Just a\n\n-- | Tests the implementations of 'parseScore'.\nmain :: IO ()\nmain = do\n    testresults &lt;- runTestTT tests\n    print testresults\n\n-- | List of tests for 'parseScore'.\ntests :: Test\ntests = TestLabel \"parseScoreTest\" (TestList [\n    runParsec parseTriplesD \"0,1,2;\\n2,3.\"   ~?= Just (Triples [(\"0\",\"1\",\"2\"),(\"0\",\"2\",\"3\")]),\n    runParsec parseTriplesD \"a,bcde ,23.\" ~?= Just (Triples [(\"a\",\"bcde \",\"23\")]),\n    runParsec parseTriplesD \"a,b,c;\\n d,e;\\n f,g;\\n h,i.\" ~?= Just (Triples [(\"a\",\"b\",\"c\"),(\"a\",\"d\",\"e\"),(\"a\",\"f\",\"g\"),(\"a\",\"h\",\"i\")]),\n    runParsec parseTriplesD \"a,bcde23.\" ~?= Nothing,\n    runParsec parseTriplesD \"a,b,c;d,e;f,g;h,i.\" ~?= Nothing,\n    runParsec parseTriplesD \"a,b,c;\\nd;\\nf,g;\\nh,i.\" ~?= Nothing\n    ])\n</code></pre>\n"}, {"tags": ["haskell", "arguments", "functor", "newtype"], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1499180113, "post_id": 44908179, "comment_id": 76794666, "body": "Is &quot;fully grounded&quot; a technical term? I&#39;ve only hear fully applied. Just curious..."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1499180244, "post_id": 44908179, "comment_id": 76794761, "body": "@Alec: no, that was a mistake (too much into Prolog :))"}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1499180610, "post_id": 44908179, "comment_id": 76794996, "body": "How does the compiler know, that the type signature of Flip is <code>(* -&gt; * -&gt; *) -&gt; * -&gt; * -&gt; *</code> not <code>* -&gt; * -&gt; * -&gt; *</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1499180835, "post_id": 44908179, "comment_id": 76795132, "body": "Because the first one (between the brackets), is the <code>f</code> type parameter. It is the same with parameters of functions (only one meta level higher)."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1499181447, "post_id": 44908179, "comment_id": 76795496, "body": "So the compiler analyse the data constructor also? So when I define without parentheses <code>Prelude&gt; data Flip f b c = Flip f b c</code> then it becomes to <code>Flip :: * -&gt; * -&gt; * -&gt; *</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1499180226, "last_edit_date": 1499180226, "creation_date": 1499177346, "answer_id": 44908179, "question_id": 44908073, "link": "https://stackoverflow.com/questions/44908073/functor-type-variables-for-flip-data-type/44908179#44908179", "title": "Functor type variables for Flip data type", "body": "<p>The <code>Flip</code> data constructor has <strong>one argument</strong>. That argument has type <code>f b a</code>.</p>\n\n<p>That thus means that <code>f</code> itself is a higher order type argument with type <code>f :: * -&gt; * -&gt; *</code>. A more rigorous <code>newtype</code> statement would be:</p>\n\n<pre><code>newtype Flip (f :: * -&gt; * -&gt; *) a b = Flip (f b a)\n</code></pre>\n\n<p>You can thus for instance instantiate a <code>Flip Either Int Bool</code>, since <code>Either</code> is a type that requires two additional type parameters, and then construct a <code>Flip (Right 1) :: Flip Either Int Bool</code>.</p>\n\n<blockquote>\n  <p>What is the type of <code>(Flip K a)</code>?</p>\n</blockquote>\n\n<p><code>Flip K a</code> is not a fully applied type. In <em>pseudo-code</em>, it has type <code>b -&gt; Flip K a b</code>. Once the <code>b</code> has been resolved (<code>Functor</code> works with higher order types), we know that the only argument of <code>Flip</code> will have a <code>K b</code> constructor. So for instance <code>Flip (K 1)</code> is a <code>Flip K a Int</code> type.</p>\n"}, {"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1499328435, "post_id": 44915199, "comment_id": 76861918, "body": "Could you please explain <code>forall k k1 (b :: k) (f :: k -&gt; k1 -&gt; *) (a :: k1)</code>, how to read it? Or what does it mean."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1499376707, "post_id": 44915199, "comment_id": 76893794, "body": "I can try. Constructors like <code>MkFlip</code> take some <i>invisible</i> arguments that live in the world of types, as well as their <i>visible</i> arguments that live in the world of values. (There used to be a good reason why types were invisible and values were visibile, but it isn&#39;t good any more and we&#39;re stuck with it.) The big long <code>forall ...</code> is telling you about the invisible stuff, explaining exactly how polymorphic <code>MkFlip</code> is. It&#39;s very polymorphic. It says <code>f</code> is any two-parameter type former; <code>k</code> and <code>k1</code> are the (arbitrary) types of its parameters, but <code>b</code> fits with <code>k</code> and <code>a</code> fits with <code>k1</code>."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 7, "last_activity_date": 1499211198, "creation_date": 1499211198, "answer_id": 44915199, "question_id": 44908073, "link": "https://stackoverflow.com/questions/44908073/functor-type-variables-for-flip-data-type/44915199#44915199", "title": "Functor type variables for Flip data type", "body": "<p>The future is now, when you (use ghc 8 and) switch on a flag or two</p>\n\n<pre><code>Prelude&gt; :set -XPolyKinds -XFlexibleInstances\n</code></pre>\n\n<p>Let us declare</p>\n\n<pre><code>Prelude&gt; newtype Flip f a b = MkFlip (f b a)\n</code></pre>\n\n<p>and then enquire</p>\n\n<pre><code>Prelude&gt; :kind Flip\nFlip :: (k1 -&gt; k -&gt; *) -&gt; k -&gt; k1 -&gt; *\n\nPrelude&gt; :type MkFlip\nMkFlip\n  :: forall k k1 (b :: k) (f :: k -&gt; k1 -&gt; *) (a :: k1).\n     f b a -&gt; Flip f a b\n</code></pre>\n\n<p>The <em>type</em> constructor <code>Flip</code> takes two implicit arguments, being <code>k</code> and <code>k1</code>, and three explicit arguments, being a binary function producing a type, then its two arguments in reverse order. The arguments to this function are of unconstrained type (old people can say \"kind\" if they like), but it certainly returns a type (in the strict sense of \"thing in <code>*</code>\", rather than the uselessly vague sense of \"any old rubbish right of <code>::</code>\") because it is certainly used as a type in the declaration of <code>MkFlip</code>.</p>\n\n<p>The <em>data</em> constructor, <code>MkFlip</code>, takes <em>five</em> implicit arguments (exactly the arguments of <code>Flip</code>) and one explicit argument, being some data in <code>f b a</code>.</p>\n\n<p>What's going on is Hindley-Milner type inference one level up. Constraints are collected (e.g., <code>f b a</code> must inhabit <code>*</code> because a constructor argument must inhabit <code>f b a</code>) but otherwise a most general type is delivered: <code>a</code> and <code>b</code> could be anything, so their types are generalised as <code>k1</code> and <code>k</code>.</p>\n\n<p>Let's play the same game with the constant type constructor:</p>\n\n<pre><code>Prelude&gt; newtype K a b = MkK a\n\nPrelude&gt; :kind K\nK :: * -&gt; k -&gt; *\n\nPrelude&gt; :type MkK\nMkK :: forall k (b :: k) a. a -&gt; K a b\n</code></pre>\n\n<p>We see that <code>a :: *</code> but <code>b</code> can be any old rubbish (and for that matter, <code>k :: *</code>, as these days, <code>* :: *</code>). Clearly, <code>a</code> is actually used as the type of a thing, but <code>b</code> is not used at all, hence unconstrained.</p>\n\n<p>We may then declare</p>\n\n<pre><code>Prelude&gt; instance Functor (Flip K b) where fmap f (MkFlip (MkK a)) = MkFlip (MkK (f a))\n</code></pre>\n\n<p>and ask</p>\n\n<pre><code>Prelude&gt; :info Flip\n...\ninstance [safe] forall k (b :: k). Functor (Flip K b)\n</code></pre>\n\n<p>which tells us that the unused <code>b</code> can still be any old rubbish. Because we had</p>\n\n<pre><code>K    ::   * -&gt; k -&gt; *\nFlip :: (k1 -&gt; k -&gt; *) -&gt; k -&gt; k1 -&gt; *\n</code></pre>\n\n<p>we can unify <code>k1 = *</code> and get</p>\n\n<pre><code>Flip K :: k -&gt; * -&gt; *\n</code></pre>\n\n<p>and so</p>\n\n<pre><code>Flip K b :: * -&gt; *\n</code></pre>\n\n<p>for any old <code>b</code>. A <code>Functor</code> instance is thus plausible, and indeed deliverable, with the function acting on the packed up <code>a</code> element, corresponding to the argument of <code>Flip K b</code> which becomes the <em>first</em> argument of <code>K</code>, hence the type of the stored element.</p>\n\n<p>Unification-based type inference is alive and (fairly) well, right of <code>::</code>.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 44908179, "answer_count": 2, "score": 4, "last_activity_date": 1499211198, "creation_date": 1499177065, "last_edit_date": 1499199690, "question_id": 44908073, "link": "https://stackoverflow.com/questions/44908073/functor-type-variables-for-flip-data-type", "title": "Functor type variables for Flip data type", "body": "<p>I have following type definition:</p>\n\n<pre><code>newtype Flip f a b = \n  Flip (f b a) deriving (Eq, Show)\n</code></pre>\n\n<p>Does the <code>Flip</code> data constructor has one or three arguments? </p>\n\n<p>Consinder following implementation:</p>\n\n<pre><code>data K a b = K a\n\nnewtype Flip f a b = \n  Flip (f b a) deriving (Eq, Show)\n\ninstance Functor (Flip K a) where\n  fmap f (Flip (K b)) = Flip (K (f b))  \n</code></pre>\n\n<p>What is the type of <code>(Flip K a)</code>?</p>\n"}, {"tags": ["haskell", "time", "epoch", "gregorian-calendar"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1499171401, "post_id": 44905138, "comment_id": 76789042, "body": "The answer to this question depends <i>heavily</i> on what those seconds are. Are they unix time, which ignores leap seconds? Or are they seconds in UTC, and if so, since what epoch?"}], "answers": [{"comments": [{"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "edited": false, "score": 2, "creation_date": 1499169901, "post_id": 44905394, "comment_id": 76787971, "body": "it is difficult because I have to import 3 modules and know exactly what each module contains, which for a newbie like me is tiresome."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1499176818, "post_id": 44905394, "comment_id": 76792646, "body": "How many other languages do you know of where date conversion operations are just there by default and you don&#39;t need to know about them to use them?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1499215552, "post_id": 44905394, "comment_id": 76807390, "body": "Importing three modules is precisely three lines of code; I can&#39;t imagine how that is tiresome. Furthermore, you can have <code>import Data.Time</code> to get the first two modules, if you really consider 1 line vs. 2 an improvement. Finally, you don&#39;t have to &quot;know&quot; what each module contains - all you must be able to do is read documentation (that very documentation is linked in this answer!)."}, {"owner": {"reputation": 548, "user_id": 1247325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f642860e89e481f4542a51c77152df43?s=128&d=identicon&r=PG", "display_name": "pbarill", "link": "https://stackoverflow.com/users/1247325/pbarill"}, "edited": false, "score": 0, "creation_date": 1522953799, "post_id": 44905394, "comment_id": 86370328, "body": "I calmed down and found this useful tutorial on this matter: <a href=\"https://two-wrongs.com/haskell-time-library-tutorial\" rel=\"nofollow noreferrer\">two-wrongs.com/haskell-time-library-tutorial</a>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1499169442, "creation_date": 1499169442, "answer_id": 44905394, "question_id": 44905138, "link": "https://stackoverflow.com/questions/44905138/how-to-convert-epoch-to-gregorian-datetime-in-haskell/44905394#44905394", "title": "How to convert epoch to gregorian datetime in haskell", "body": "<p>Who says it is difficult?</p>\n\n<p>You can simply use <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:fromIntegral\" rel=\"noreferrer\"><strong><code>fromIntegral :: (Integral a, Num b) =&gt; a -&gt; b</code></strong></a> to convert the epoch (an integer) to <code>POSIXTime</code>.</p>\n\n<p>Next we can use <a href=\"http://hackage.haskell.org/packages/archive/time/latest/doc/html/Data-Time-Clock-POSIX.html#v:posixSecondsToUTCTime\" rel=\"noreferrer\"><strong><code>posixSecondsToUTCTime :: POSIXTime -&gt; UTCTime</code></strong></a> to obtain the <code>UTCTime</code>, and finally we use the <a href=\"http://hackage.haskell.org/packages/archive/time/latest/doc/html/Data-Time-Clock.html#v:utctDay\" rel=\"noreferrer\"><strong><code>utctDay :: UTCTime -&gt; Day</code></strong></a> to get the day part of the <code>UTCTime</code>.</p>\n\n<p>In case you want a (year,month,day) tuple, we can use the <a href=\"http://hackage.haskell.org/packages/archive/time/latest/doc/html/Data-Time-Calendar.html#v:toGregorian\" rel=\"noreferrer\"><strong><code>toGregorian :: Day -&gt; (Integer,Int,Int)</code></strong></a> method.</p>\n\n<p>So we can use the following method:</p>\n\n<pre><code>import Data.Time.Calendar(toGregorian)\nimport Data.Time.Clock(utctDay,UTCTime)\nimport Data.Time.Clock.POSIX(posixSecondsToUTCTime)\n\nepochToUTC :: Integral a =&gt; a -&gt; UTCTime\nepochToUTC = posixSecondsToUTCTime . fromIntegral\n\nepochToGregorian :: Integral a =&gt; a -&gt; (Integer,Int,Int)\nepochToGregorian = toGregorian . utctDay . epochToUTC\n</code></pre>\n\n<p>And then for instance:</p>\n\n<pre><code>Main&gt; epochToGregorian 1234567\n(1970,1,15)\nMain&gt; epochToGregorian 123456789\n(1973,11,29)\nMain&gt; epochToGregorian 1234567890\n(2009,2,13)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "edited": false, "score": 0, "creation_date": 1523562133, "post_id": 49782238, "comment_id": 86624006, "body": "Thank you so much for your informative answer , and I think the downvotes are probably due to noob hostility in Haskell community. And after all this time, your provided link is greatly appreciated"}, {"owner": {"reputation": 548, "user_id": 1247325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f642860e89e481f4542a51c77152df43?s=128&d=identicon&r=PG", "display_name": "pbarill", "link": "https://stackoverflow.com/users/1247325/pbarill"}, "reply_to_user": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "edited": false, "score": 1, "creation_date": 1523622427, "post_id": 49782238, "comment_id": 86648338, "body": "Glad to help. I don&#39;t think it&#39;s noob hostility. Haskellers feel very strongly about their language, which is a double edged sword. Ask a question, expect an answer. Ask a question while expressing a strong opinion, expect an answer with... a strong opinion."}, {"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "edited": false, "score": 0, "creation_date": 1523709718, "post_id": 49782238, "comment_id": 86678267, "body": "May be you are right. I guess I asked this question at a time of extreme frustration"}], "tags": [], "owner": {"reputation": 548, "user_id": 1247325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f642860e89e481f4542a51c77152df43?s=128&d=identicon&r=PG", "display_name": "pbarill", "link": "https://stackoverflow.com/users/1247325/pbarill"}, "is_accepted": false, "score": 4, "last_activity_date": 1523472817, "last_edit_date": 1523472817, "creation_date": 1523471703, "answer_id": 49782238, "question_id": 44905138, "link": "https://stackoverflow.com/questions/44905138/how-to-convert-epoch-to-gregorian-datetime-in-haskell/49782238#49782238", "title": "How to convert epoch to gregorian datetime in haskell", "body": "<p>Not a bad question at all, in spite of the down votes. So what would be the equivalent of fairly standard \"strptime\" and \"strftime\" here?</p>\n\n<p>You find this rather complicated, and I agree, as I spent a fair amount of time figuring this out (n00b here), so here are some of my findings. It is not simple, because:</p>\n\n<ol>\n<li>Handling time is complicated.</li>\n<li>The Data.Time library focuses on type safety (consistent with Haskell), which also means that there is no automatic type conversion done for you. Therefore, you must be aware of a thing or two on that matter.</li>\n<li>How to read epoch depends on what exactly it stands for and how it is stored. Thus if there is no implementation of a universal function <code>epoch -&gt; utc</code> in the standard library, it is not an omission, it is because it cannot exist.</li>\n</ol>\n\n<p>It's simpler in say python as <code>datetime</code> ship with \"pretty good defaults\" inferred from your environment. The concept of a \"good enough default parameter value for most circumstances\" is not something that works well with Haskell.</p>\n\n<p>If the epoch value comes from some arbitrary integer, then Willem Van Onsem's <code>epochToUTC</code> works. It if is a timestamp from a file (<code>EpochTime</code>), we need another function as this is not quite an integer (it looks like an integer, it behaves like an integer, but it is neither <code>Int</code> nor <code>Integer</code>\u2014that is some very deep water).</p>\n\n<p>As for the <code>import</code> statements, you may simplify this to a mere <code>import Data.Time</code>, which will grab all we need from this module, with the exception of <code>posixSecondsToUTCTime</code>, because... I suppose it is deemed as sort of specialized.</p>\n\n<pre><code>import System.Posix.Types(EpochTime)\nimport Data.Time\nimport Data.Time.Clock.POSIX(posixSecondsToUTCTime)\n\nepochToUTC :: EpochTime -&gt; UTCTime\nepochToUTC = posixSecondsToUTCTime . realToFrac\n</code></pre>\n\n<p>Example in ghci: (timestamp of current working directory)</p>\n\n<pre><code>import System.Posix.Files\n\nfStat &lt;- getFileStatus \".\"\nlet someTime = epochToUTC . modificationTime $ fStat\n</code></pre>\n\n<p>And we are good to manipulate this time value. Note that the <code>EpochTime</code> is specific to the <code>System.Posix</code> module. If it is a timestamp retrieved from say a database or a web page, it could be yet another story (type safety is not free).</p>\n\n<p>Just as this \"strptime\" operation was not terribly familiar, a similar story goes with a \"strftime\"-like operation. This would be done with <code>formatTime</code>. Example:</p>\n\n<pre><code>formatTime defaultTimeLocale \"%Y-%m-%d\" someTime\n\n--equivalent\nformatTime defaultTimeLocale ( iso8601DateFormat Nothing ) someTime\n\n--whichever dateFmt defined in that TimeLocale\nformatTime defaultTimeLocale ( dateFmt defaultTimeLocale ) someTime\n\n--\"%a, %_d %b %Y %H:%M:%S %Z\"\nformatTime defaultTimeLocale rfc822DateFormat someTime\n</code></pre>\n\n<p>If always on <code>defaultTimeLocale</code>, then you can elegantly abbreviate to:</p>\n\n<pre><code>formatTime' = formatTime defaultTimeLocale\n</code></pre>\n\n<p>Readings:</p>\n\n<p><a href=\"https://two-wrongs.com/haskell-time-library-tutorial\" rel=\"nofollow noreferrer\">A Haskell Time Library Tutorial</a> (We need more like this!)</p>\n\n<p><a href=\"https://wiki.haskell.org/Time\" rel=\"nofollow noreferrer\">Time - HaskellWiki</a></p>\n"}], "owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 959, "favorite_count": 0, "accepted_answer_id": 44905394, "answer_count": 2, "score": 4, "last_activity_date": 1523472817, "creation_date": 1499168733, "last_edit_date": 1499190026, "question_id": 44905138, "link": "https://stackoverflow.com/questions/44905138/how-to-convert-epoch-to-gregorian-datetime-in-haskell", "title": "How to convert epoch to gregorian datetime in haskell", "body": "<p>Let's say I have an integer representing Epoch time, for example <code>epoch = 1499055085</code>, and I want to convert it to <code>UTCTime</code> in Haskell. \nHow can I do this?</p>\n\n<p>In other languages this is a very trivial task, why is it so difficult in haskell?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 2, "last_activity_date": 1499164492, "creation_date": 1499164492, "answer_id": 44903617, "question_id": 44903425, "link": "https://stackoverflow.com/questions/44903425/functor-with-wrong-type-argument/44903617#44903617", "title": "Functor with wrong type argument", "body": "<p>Your definition of <code>fmap</code> has type</p>\n\n<pre><code>fmap :: Company a b c -&gt; (c -&gt; d) -&gt; Company a b d\n</code></pre>\n\n<p>so the function takes a value of type <code>c</code>. In </p>\n\n<pre><code>fmap f (Something b) = Something (f b)\n</code></pre>\n\n<p>you are attempting to apply a function <code>c -&gt; d</code> to a value of type <code>b</code> which causes the error. The actual type variables in the message have different names: <code>a1</code> is  <code>c</code> and <code>b1</code> is <code>d</code></p>\n"}, {"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 6, "last_activity_date": 1499164667, "creation_date": 1499164667, "answer_id": 44903666, "question_id": 44903425, "link": "https://stackoverflow.com/questions/44903425/functor-with-wrong-type-argument/44903666#44903666", "title": "Functor with wrong type argument", "body": "<p>You've declared <code>Company</code> as type with three generic types, <code>a</code>, <code>b</code>, and <code>c</code>. When you create an instance <code>instance Functor (Company a b)</code> you've said that for any <code>a</code> and <code>b</code>, there should exist a function <code>fmap</code> with the type:</p>\n\n<pre><code>(c -&gt; d) -&gt; Company a b c -&gt; Company a b d\n</code></pre>\n\n<p>The function <code>f</code> has the type <code>c -&gt; d</code>, so you can't use <code>b</code> as input for it, because it doesn't have the correct type.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 44903666, "answer_count": 2, "score": 1, "last_activity_date": 1499164667, "creation_date": 1499163957, "question_id": 44903425, "link": "https://stackoverflow.com/questions/44903425/functor-with-wrong-type-argument", "title": "Functor with wrong type argument", "body": "<p>I have following datatype and had apply to <code>Functor</code> instance:</p>\n\n<pre><code>data Company a b c = \n    DeepBlue a c\n  | Something b\n\ninstance Functor (Company a b) where \n  fmap f (Something b) = Something b\n  fmap f (DeepBlue a c) = DeepBlue a (f c)\n</code></pre>\n\n<p>It gets compiled without any complains.</p>\n\n<p>Then I played a bit around(I know it does not work), because of beginner curiosity:</p>\n\n<pre><code>data Company a b c = \n    DeepBlue a c\n  | Something b\n\ninstance Functor (Company a b) where \n  fmap f (Something b) = Something (f b)\n  fmap f (DeepBlue a c) = DeepBlue a (f c) \n</code></pre>\n\n<p>Then the compiler complains:</p>\n\n<pre><code>D:\\haskell\\chapter16\\src\\ChapterExercises.hs:18:26: error:\n    * Couldn't match type `b1' with `b'\n      `b1' is a rigid type variable bound by\n        the type signature for:\n          fmap :: forall a1 b1.\n                  (a1 -&gt; b1) -&gt; Company a b a1 -&gt; Company a b b1\n        at D:\\haskell\\chapter16\\src\\ChapterExercises.hs:18:3\n      `b' is a rigid type variable bound by\n        the instance declaration\n        at D:\\haskell\\chapter16\\src\\ChapterExercises.hs:17:10\n      Expected type: Company a b b1\n        Actual type: Company a b1 b1\n    * In the expression: Something (f b)\n      In an equation for `fmap': fmap f (Something b) = Something (f b)\n      In the instance declaration for `Functor (Company a b)'\n    * Relevant bindings include\n        b :: b\n          (bound at D:\\haskell\\chapter16\\src\\ChapterExercises.hs:18:21)\n        f :: a1 -&gt; b1\n          (bound at D:\\haskell\\chapter16\\src\\ChapterExercises.hs:18:8)\n        fmap :: (a1 -&gt; b1) -&gt; Company a b a1 -&gt; Company a b b1\n          (bound at D:\\haskell\\chapter16\\src\\ChapterExercises.hs:18:3)\n\nD:\\haskell\\chapter16\\src\\ChapterExercises.hs:18:39: error:\n    * Couldn't match expected type `a1' with actual type `b'\n      `b' is a rigid type variable bound by\n        the instance declaration\n        at D:\\haskell\\chapter16\\src\\ChapterExercises.hs:17:10\n      `a1' is a rigid type variable bound by\n        the type signature for:\n          fmap :: forall a1 b1.\n                  (a1 -&gt; b1) -&gt; Company a b a1 -&gt; Company a b b1\n        at D:\\haskell\\chapter16\\src\\ChapterExercises.hs:18:3\n    * In the first argument of `f', namely `b'\n      In the first argument of `Something', namely `(f b)'\n      In the expression: Something (f b)\n    * Relevant bindings include\n        b :: b\n          (bound at D:\\haskell\\chapter16\\src\\ChapterExercises.hs:18:21)\n        f :: a1 -&gt; b1\n          (bound at D:\\haskell\\chapter16\\src\\ChapterExercises.hs:18:8)\n        fmap :: (a1 -&gt; b1) -&gt; Company a b a1 -&gt; Company a b b1\n          (bound at D:\\haskell\\chapter16\\src\\ChapterExercises.hs:18:3)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>What does the compiler try say?</p>\n"}, {"tags": ["haskell", "constraints", "typeclass", "undecidable-instances"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1499133298, "post_id": 44895211, "comment_id": 76769614, "body": "<code>UndecidableInstances</code> means that GHC could diverge (as in give up with an less helpful message) while trying to type check your code. The particular problem is that <code>Monoid (f (Cofree f a))</code> could, for example, require <code>Monoid (Cofree f a)</code>, so just checking that instance might loop forever."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1499141551, "post_id": 44895211, "comment_id": 76771348, "body": "<code>UndeciableInstances</code> doesn&#39;t even mean that the compiler thinks that instance resolution <i>could</i> diverge; it means the compiler can&#39;t prove it <i>won&#39;t</i> diverge. This use case is probably pretty safe."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1499143465, "post_id": 44895211, "comment_id": 76771872, "body": "What difference between those two things are you trying to point out, @user2407038? If the compiler can&#39;t prove it won&#39;t diverge, then the compiler thinks it could diverge. They sound the same to me."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1499176468, "post_id": 44895211, "comment_id": 76792448, "body": "Feel free to reopen is you feel the duplicate doesn&#39;t answer enough. &quot;Do I need to add UndecidableInstances?&quot;: Yes, add <code>{-# LANGUAGES UndecidableInstances #-}</code> to the top of your file - it should be ok here."}], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1499176400, "answer_count": 0, "score": 1, "last_activity_date": 1499126768, "creation_date": 1499126768, "question_id": 44895211, "link": "https://stackoverflow.com/questions/44895211/writing-generic-monoid-over-cofree-undecidable", "closed_reason": "Duplicate", "title": "Writing generic Monoid over Cofree; undecidable?", "body": "<p>I'm trying to write the following Monoid instance for Cofree:</p>\n\n<pre><code>instance (Monoid a, Monoid (f (Cofree f a))) =&gt; Monoid (Cofree f a) where\n  mempty = mempty :&lt; mempty\n  (a :&lt; rest) `mappend` (b :&lt; rest') = (a `mappend` b) :&lt; (rest `mappend` rest')\n</code></pre>\n\n<p>but I'm getting the following error:</p>\n\n<pre><code>\u2022 Variable \u2018f\u2019 occurs more often\n    in the constraint \u2018Monoid (f (Cofree f a))\u2019\n    than in the instance head\n  (Use UndecidableInstances to permit this)\n\u2022 In the instance declaration for \u2018Monoid (Cofree f a)\u2019\n</code></pre>\n\n<p>I've come across Undecidable Instances before, but I'm not really sure WHY this is undecidable, and how can I fix it? Do I need to add UndecidableInstances? Thanks!!</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 3, "creation_date": 1499118714, "post_id": 44894152, "comment_id": 76766600, "body": "try <code>Prelude&gt; :unset -Wname-shadowing</code>. and it says &quot;warning&quot; there, not &quot;error&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1499123743, "post_id": 44894808, "comment_id": 76767789, "body": "<code>let</code> is optional in ghci now?"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1499122966, "creation_date": 1499122966, "answer_id": 44894808, "question_id": 44894152, "link": "https://stackoverflow.com/questions/44894152/in-ghci-how-to-remove-an-existing-binding/44894808#44894808", "title": "In ghci, how to remove an existing binding?", "body": "<blockquote>\n  <p>Is there a way to remove the existing binding so that I can redefine <code>t</code>?</p>\n</blockquote>\n\n<p>No, you cannot remove the existing binding. However, you can redefine <code>t</code> at any time, no problem.</p>\n\n<blockquote>\n  <p>Why does ghci error when redefining an existing binding in some cases and not in others?</p>\n</blockquote>\n\n<p>Because you ran ghci with different warning/error settings; e.g. by passing <code>-Wname-shadowing</code> on the command line (perhaps because you ran ghci through cabal or stack, and the associated project specifies this option in its .cabal file). N.B. <code>-Wname-shadowing</code> should not prevent you from redefining <code>t</code> unless combined with <code>-Werror</code> to turn the mere warning into a full-blown error.</p>\n\n<p>The behavior also appears to differ depending on whether you use <code>let</code> or not; this is probably a bug:</p>\n\n<pre><code>% ghci -Wname-shadowing -Werror\n&gt; let t=3\n&gt; let t=4\n&lt;interactive&gt;:3:5: warning: [-Wname-shadowing]\n    This binding for \u2018t\u2019 shadows the existing binding\n      defined at &lt;interactive&gt;:1:5\n\n&lt;no location info&gt;: error: \nFailing due to -Werror.\n&gt; t\n3\n&gt; t=4\n&gt; t\n4\n</code></pre>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 846, "favorite_count": 0, "accepted_answer_id": 44894808, "answer_count": 1, "score": 4, "last_activity_date": 1499122966, "creation_date": 1499117707, "question_id": 44894152, "link": "https://stackoverflow.com/questions/44894152/in-ghci-how-to-remove-an-existing-binding", "title": "In ghci, how to remove an existing binding?", "body": "<p>I am getting a \"binding shadows the existing binding\" error similar to the one from <a href=\"https://stackoverflow.com/questions/2902716/in-haskell-what-does-it-mean-if-a-binding-shadows-an-existing-binding\">this</a> question.</p>\n\n<pre><code>Prelude Api.Facility Control.Monad.IO.Class&gt; let t = getBadgesNot 1 (Nothing) (Just 1)\n\n&lt;interactive&gt;:55:5: warning: [-Wname-shadowing]\n    This binding for \u2018t\u2019 shadows the existing binding\n      defined at &lt;interactive&gt;:39:5\n</code></pre>\n\n<p>I defined the existing binding earlier in the session, and am now trying to redefine it. <strong>Is there a way to remove the existing binding so that I can redefine <code>t</code>?</strong></p>\n\n<p>I notice that in other circumstances ghci does not error when redefining an existing binding. For example</p>\n\n<pre><code>Prelude&gt; let t = 1\nPrelude&gt; let t = 2\nPrelude&gt; let t = \"there\"\n</code></pre>\n\n<p><strong>Why does ghci error when redefining an existing binding in some cases and not in others?</strong></p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 2265, "user_id": 2341336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/1892ca82e84d7ecd15712cf53fa65893?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/2341336/chris"}, "edited": false, "score": 3, "creation_date": 1499113988, "post_id": 44893462, "comment_id": 76765007, "body": "Could you please provide code for what you have tried?"}, {"owner": {"reputation": 3627, "user_id": 3695939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d75f41bcfc1d3f20c084ec7e87d82012?s=128&d=identicon&r=PG&f=1", "display_name": "moondaisy", "link": "https://stackoverflow.com/users/3695939/moondaisy"}, "edited": false, "score": 0, "creation_date": 1499117697, "post_id": 44893462, "comment_id": 76766278, "body": "Keep a counter, using an auxiliar function, and move through the list using recursion? Use some of the indexing lists functions in <code>Data.List</code>? Write something even if close to pseudo code"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1499134047, "post_id": 44893462, "comment_id": 76769759, "body": "Your error does not match the code you wrote..."}], "answers": [{"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": false, "score": 2, "last_activity_date": 1499165008, "creation_date": 1499165008, "answer_id": 44903796, "question_id": 44893462, "link": "https://stackoverflow.com/questions/44893462/to-leave-in-the-list-items-whose-values-coincide-with-the-numbers-of-their-posit/44903796#44903796", "title": "To leave in the list items whose values coincide with the numbers of their positions in the list", "body": "<p>A really nice way to work with this is to stitch functions together. First one might need to get to know the functions in the <code>Data.List</code> module, which you can find with hoogle: <a href=\"http://hoogle.haskell.org\" rel=\"nofollow noreferrer\">http://hoogle.haskell.org</a></p>\n\n<p><strong>Data.List Module functions</strong></p>\n\n<p>I'll give you a little bit of a boost here. The functions I would pick out are the <code>zip</code> function: <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html#v:zip\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html#v:zip</a> whose type is <code>[a] -&gt; [b] -&gt; [(a, b)]</code> and then the <code>filter</code> function <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:filter\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:filter</a> whose type is <code>(a -&gt; Bool) -&gt; [a] -&gt; [a]</code> and then the <code>map</code> function whose type is <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code> along with the <code>fst :: (a, b) -&gt; a</code></p>\n\n<p><strong>Function Composition</strong></p>\n\n<p>These functions can be stitched together using the function composition operator: <code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code> it takes two functions that share a common input/output point (in the type signature they are the second and first parameters, respectively; <code>a -&gt; b</code> and <code>b -&gt; c</code>) and it will then join them into one single function.</p>\n\n<p><strong>Stacking it up - required knowledge</strong></p>\n\n<p>In order to do what you want to do, you really need to know about simple types, parameterised types, ranges (including lazy infinite ranges would help), functions and possibly recursion as well some higher order functions and how Haskell functions are curried, and to understand function composition. It wouldn't hurt to add a basic understanding of what typeclasses do and are into the mix.</p>\n\n<p>I helped author a tutorial which can really help with understanding how this stuff works from a usage point of view by following a series of interesting examples. It's not too long, and you might find it much easier to approach your problem once you have understood some of the more foundational stuff: <a href=\"http://happylearnhaskelltutorial.com\" rel=\"nofollow noreferrer\">http://happylearnhaskelltutorial.com</a> \u2014 note that it's not tuned to teaching you how to construct stuff, that'll be coming in a later volume, but it should give you enough understanding to be able to at least guess at an answer, or understand the one below.</p>\n\n<p><strong>The Answer - spoilers</strong></p>\n\n<p>If you want to work this out yourself, you should stop here and come back later on when you're feeling more confident. However, I'm going to put one possible answer just below, so don't look if you don't want to know yet!</p>\n\n<pre><code>positionals :: (Enum a, Eq a, Num a) =&gt; [a] -&gt; [a]\npositionals = map fst . filter (\\(x, y) -&gt; x == y) . zip [1..]\n</code></pre>\n\n<p>Keep in mind this is only one way of doing this. There are simpler more explanatory ways to do it, and while it might possibly seem inefficient, Haskell has <strong>list/stream fusion</strong> which compiles that function into something that will do a single pass across your data.</p>\n"}], "owner": {"reputation": 31, "user_id": 8250377, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5744e6d6dfc74e91c329a7bac4c3cf0?s=128&d=identicon&r=PG&f=1", "display_name": "Oleksandr Serdiuk", "link": "https://stackoverflow.com/users/8250377/oleksandr-serdiuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499165008, "creation_date": 1499113643, "last_edit_date": 1499159842, "question_id": 44893462, "link": "https://stackoverflow.com/questions/44893462/to-leave-in-the-list-items-whose-values-coincide-with-the-numbers-of-their-posit", "title": "To leave in the list items whose values coincide with the numbers of their positions in the list", "body": "<p>I need to change list for example:</p>\n\n<p><code>[1,2,4,6,5,10]</code></p>\n\n<p>To this one</p>\n\n<p><code>[1,2,5]</code> (the list of elements that are on correct position).</p>\n\n<ol>\n<li>1st element value is 1 - ok, </li>\n<li>element value is 2 - ok, </li>\n<li>3rd element value is 4 but expected 3 (due to the index)- remove </li>\n</ol>\n\n<p>and etc. How can I solve the error which is attached below?</p>\n\n<p>My code:</p>\n\n<pre><code>module Count where\nimport Control.Monad.State\n\nnthel n xs = last xsxs\n    where xsxs = take n xs\n\n deleteNth i items = take i items ++ drop (1 + i) items\n\n repeatNTimes 0 _ = return ()\n repeatNTimes n xs =\n   do\n     if (n == nthel n xs) then return()\n       else deleteNth (n-1) xs\n         repeatNTimes (n-1) xs\n\n list = [1,2,3,4,5]\n main = repeatNTimes (length list) list\n</code></pre>\n\n<p>I have the following error:</p>\n\n<pre><code> * Couldn't match type `Int' with `()'\n       Expected type: [()]\n       Actual type: [Int]\n* In the expression: deleteNth (n - 2) xs\n  In a stmt of a 'do' block:\n    if (n == nthel n xs) then return () else deleteNth (n - 2) xs\n  In the expression:\n    do { if (n == nthel n xs) then return () else deleteNth (n - 2) xs;\n         repeatNTimes (n - 1) xs }\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1499106646, "post_id": 44890291, "comment_id": 76761777, "body": "I think the libraries will be compiled with their own options. Otherwise, one would need to recompile every library for each executable."}, {"owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1499116908, "post_id": 44890291, "comment_id": 76766039, "body": "@chi Isn&#39;t that a bit scary? For instance web apps that rely on <code>-threaded</code> to work properly. Couldn&#39;t these apps become dysfunctional when compiled with libraries without <code>-threaded</code>? Hmm."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1499117920, "post_id": 44890291, "comment_id": 76766362, "body": "<code>-threaded</code> affects <i>linking</i>, not compilation."}], "answers": [{"tags": [], "owner": {"reputation": 1336, "user_id": 794944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b885541101d504bbd39901d5d7fc1766?s=128&d=identicon&r=PG", "display_name": "Jack Henahan", "link": "https://stackoverflow.com/users/794944/jack-henahan"}, "is_accepted": true, "score": 2, "last_activity_date": 1499727476, "last_edit_date": 1499727476, "creation_date": 1499726968, "answer_id": 45022821, "question_id": 44890291, "link": "https://stackoverflow.com/questions/44890291/will-ghc-options-of-an-executable-override-ghc-options-of-linked-libraries/45022821#45022821", "title": "Will ghc-options of an executable override ghc-options of linked libraries?", "body": "<p>Under the normal <code>cabal-install</code> workflow (and the <code>stack</code> workflow built atop it), flags specified in your Cabal file are local to your package, and should not trigger rebuilds. Similarly, options specified with <code>--ghc-options</code> on the command line are local to your package.</p>\n\n<p>To your specific questions about <code>-threaded</code>, this flag has no effect on library code (as <code>cabal-install</code> will tell you), only on executables.</p>\n\n<p>A brief listing of GHC flags is available <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/flags.html\" rel=\"nofollow noreferrer\">here</a>. In particular, note that <code>-threaded</code> is listed under <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/flags.html#linking-options\" rel=\"nofollow noreferrer\">Linking options</a>, with a further link to <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/phases.html#options-linker\" rel=\"nofollow noreferrer\">Options affecting linking</a>. From this information, we conclude that <code>-threaded</code> is only meaningful for executables because it signals to GHC that we wish to use the threaded runtime. If your package doesn't provide an executable, it has no need for any runtime, threaded or otherwise.</p>\n\n<p>For a high-level explanation of compiling vs. linking: they are two of the steps between source code and executable. Compilation is the process of producing an object file from source code. Linking is the process of connecting the numerous object files which compose your executable. When you compile an executable, it has no idea that a function, say <code>map</code> exists unless you defined it, so it just compiles under the assumption that it does. The linking step is where we make all those names available and meaningful. In the case of <code>-threaded</code>, we are making the linking process aware of the threaded runtime, which all code calling on the runtime will use.</p>\n\n<p>Since I don't know if you're using the standard <code>cabal</code> workflow, <code>stack</code>, or the new <code>cabal.project</code> workflow, here's a digression to discuss this behavior in the <code>cabal.project</code> case.</p>\n\n<p>This is actually an open bug, right now.</p>\n\n<p>The bug is tracked as issue <a href=\"https://github.com/haskell/cabal/issues/3883\" rel=\"nofollow noreferrer\">3883</a> on the Cabal GitHub (and somewhat in the related issue <a href=\"https://github.com/haskell/cabal/issues/4247\" rel=\"nofollow noreferrer\">4247</a>).</p>\n\n<p>Relevant to your question, according to current behavior, specifying flags in a <code>ghc-options</code> stanza in a <code>cabal.project</code> file causes those dependencies to be compiled (or recompiled, as the case may be) with those flags.</p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 45022821, "answer_count": 1, "score": 7, "last_activity_date": 1499727476, "creation_date": 1499099311, "last_edit_date": 1499543383, "question_id": 44890291, "link": "https://stackoverflow.com/questions/44890291/will-ghc-options-of-an-executable-override-ghc-options-of-linked-libraries", "title": "Will ghc-options of an executable override ghc-options of linked libraries?", "body": "<p>I have a main Haskell executable program with a cabal file. There, I specify the <code>ghc-options</code>.</p>\n\n<p>This executable links against other libraries out in the wilderness. Will the <code>ghc-options</code> of the cabal files of these libraries be ignored?</p>\n\n<p>I'm basically wondering whether the executable's <code>ghc-options</code> will be used for the entire enchilada (main executable + libraries).</p>\n\n<p><strong>Additional bounty notes:</strong> Please also expand on chi's comment below, namely, what exactly is the difference between <code>ghc-options</code> for <em>compiling</em> vs. <em>linking</em>. Which are which, and which are never needed in libraries? Maybe you can talk about some of the most important ones, such as the <code>-threaded</code> mentioned below.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1499105731, "post_id": 44889398, "comment_id": 76761396, "body": "Any priority heap structure in Haskell is probably going to involve a decent amount of allocation tbh.  Just about any data structure will..."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1499114634, "post_id": 44889398, "comment_id": 76765269, "body": "the <a href=\"http://hackage.haskell.org/package/heaps-0.3.4.1\" rel=\"nofollow noreferrer\">heaps</a> package  promises an O(1) <a href=\"http://hackage.haskell.org/package/heaps-0.3.4.1/docs/Data-Heap.html#v:union\" rel=\"nofollow noreferrer\">union</a> operation. found it <a href=\"http://hackage.haskell.org/packages/search?terms=heap\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1499153012, "post_id": 44889398, "comment_id": 76776393, "body": "Please provide a <a href=\"https://stackoverflow.com/help/mcve\">mcve</a>. So a small programm using the data structure in question, which runs slower/produces more garbage than you expect, would be fine in this case."}], "owner": {"reputation": 265, "user_id": 7430178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/phrjq.jpg?s=128&g=1", "display_name": "Diego Vicente", "link": "https://stackoverflow.com/users/7430178/diego-vicente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 0, "score": 7, "last_activity_date": 1499096665, "creation_date": 1499096038, "last_edit_date": 1499096665, "question_id": 44889398, "link": "https://stackoverflow.com/questions/44889398/priority-queue-based-on-heap-causes-a-lot-of-garbage-collection-in-haskell", "title": "Priority Queue based on Heap causes a lot of garbage collection in Haskell", "body": "<p>I am trying to develop a Heuristic Search library in Haskell, and one of the main things that make the algorithm behave in a way or another is the data structure; so I declared the class:</p>\n\n<pre><code>class DataStructure ds where  \n  add :: Eq a =&gt; Node a -&gt; ds a -&gt; ds a\n  addList :: Eq a =&gt; [Node a] -&gt; ds a -&gt; ds a\n  next :: Eq a =&gt; ds a -&gt; (ds a, Node a)\n  isEmpty :: Eq a =&gt; ds a -&gt; Bool\n</code></pre>\n\n<p>And then, instances of this class are used in a general search algorithm that expands nodes like this:</p>\n\n<pre><code>generalSearch :: (DataStructure ds, Eq a, Hashable a)\n  =&gt; ProblemSpace a   -- ^ 'ProblemSpace' to be solved\n  -&gt; Cost a           -- ^ 'Cost' function to use\n  -&gt; Heuristic a      -- ^ 'Heuristic' function to use\n  -&gt; ds a             -- ^ 'DataStructure' that manages the node expansion\n  -&gt; [Node a]         -- ^ Returns the infinite list of final nodes (solutions)\n\ngeneralSearch problem g h open\n  | isEmpty open                    = []\n  | getGoalF problem (getState n)   = n : generalSearch problem g h open'\n  | otherwise                       = generalSearch problem g h open''\n  where (open', n) = next open\n        expanded = expand n g h (getActions problem)\n        open'' = addList expanded open'\n</code></pre>\n\n<p>This last snippet of code is quite hard to understand without the full context of the module, but the important part is the last line: it uses the the <code>DataStructure</code> method <code>addList</code> to merge together the just expanded nodes with the rest of the open list that the execution is carrying.</p>\n\n<p>Some of the algorithms require that the open list is sorted in some way: ascending cost, ascending heuristic... For which I used the <code>heap</code> package to build a <code>PriorityQueue</code> implementation like this:</p>\n\n<pre><code>data PriorityQueue a =\n  PriorityQueue { priorityQueueToHeap :: MinPrioHeap Double (Node a)\n                , valueFunction :: Node a -&gt; Double }\n</code></pre>\n\n<p>So this queue stores the Nodes in ascending order depending on the <code>valueFunction</code>. The relevant method for this problem, <code>addList</code>, is implemented like:</p>\n\n<pre><code>addList :: Eq a =&gt; [Node a] -&gt; PriorityQueue a -&gt; PriorityQueue a\naddList xs (PriorityQueue h f) = PriorityQueue (union h xs') f\n  where xs' = fromList $ map (\\n -&gt; (f n, n)) xs\n</code></pre>\n\n<p>From my inexperience in Haskell this seemed like a good approach, but it turns out that when testing it, the execution is super slow. After some profiling I was able to spot that the problem was a lot of pause due to Garbage Collection, and the cost centers revealed that the <code>union</code> method in <code>addList</code> is the most expensive one in time (which I can understand, due to the sorting) but also in space (it is the one allocating by far the most).</p>\n\n<pre><code>COST CENTRE   MODULE             SRC                                     %time %alloc\n\nunion         Data.Heap.Internal Data/Heap/Internal.hs:(134,1)-(141,79)   42.8   32.7\nvisited       Search.General     src/Search/General.hs:77:43-53           14.6    0.0\nexpand        Search.General     src/Search/General.hs:(70,40)-(76,78)    13.6   14.0\ncost          Search.General     src/Search/General.hs:74:70-81            7.8    7.9\ngeneralSearch Search.General     src/Search/General.hs:(52,1)-(58,37)      6.7   13.6\nfromList      Data.Heap          Data/Heap.hs:137:1-34                     4.7   11.7\nsize          Data.Heap.Internal Data/Heap/Internal.hs:(98,1)-(99,23)      3.4    8.3\nrank          Data.Heap.Internal Data/Heap/Internal.hs:(93,1)-(94,23)      2.7    8.0\nexpand        Search.General     src/Search/General.hs:(69,1)-(77,53)      1.4    3.4\n</code></pre>\n\n<p>The time problems appear to happen only when the list of open nodes is big, so I guess that it is related to the inmutability of the Heap, being written and erased in each new expansion. Is there a way to prevent this behavior, and reduce the garbage collection? Should I use a different type of data structure to build the priority queue?</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1499095814, "post_id": 44888846, "comment_id": 76756576, "body": "Do you know the difference between a prism and a lens? If so, that is your answer. :)"}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1499096383, "post_id": 44888846, "comment_id": 76756934, "body": "@Alec No I don&#39;t know!"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1499096838, "post_id": 44888846, "comment_id": 76757201, "body": "A prism essentially lets you check if something is of a specific form and, if it is, even edit it. Lens tend to be used with products and prisms with sums (co-products)."}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1499099324, "post_id": 44888846, "comment_id": 76758478, "body": "@Alec Thanks, can you please give me some examples using prisms?"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1499181135, "post_id": 44906062, "comment_id": 76795312, "body": "Thank you very much for the comprehensive answer :) Do you cover Lenses in your book?"}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1499196822, "post_id": 44906062, "comment_id": 76802337, "body": "Can you please tell me why &quot;uses&quot; or &quot;use&quot; is used in monad? Specifically here in line 208 and 228:  <a href=\"https://github.com/input-output-hk/cardano-sl/blob/1f866450a8a530c119e3fc9edb84c97c56417aa2/lrc/Pos/Lrc/Fts.hs\" rel=\"nofollow noreferrer\">github.com/input-output-hk/cardano-sl/blob/&hellip;</a>"}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1499202287, "post_id": 44906062, "comment_id": 76804411, "body": "That book is the first volume in a planned series that is taking a lot longer to produce than I would like. This is due to the fact that writing, editing and illustration takes a lot of time and energy and I want a better editor to help me do that, otherwise the boilerplate and admin work becomes huge so I&#39;m having to write a better editor."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1499202498, "post_id": 44906062, "comment_id": 76804482, "body": "Because the book is the first volume, and it&#39;s an introductory volume, and it&#39;s focussed on beginning programmers, we don&#39;t cover lenses. It&#39;s aimed at people for whom Haskell is their first language. We plan to cover them in later volumes, but lenses are pretty advanced if you want to understand them well. One needs to have a good grip on all kinds of things before lenses make sense, or are even needed, as you can see from the first sentence of my answer to your question, above."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1499202789, "post_id": 44906062, "comment_id": 76804565, "body": "As to <code>use</code> or <code>uses</code>, I saw your question <a href=\"https://stackoverflow.com/questions/44884171/haskell-use-or-uses-in-getter\" title=\"haskell use or uses in getter\">stackoverflow.com/questions/44884171/&hellip;</a> about this, but I think it&#39;s best to not hijack this question. I think someone gave you a reasonable answer there, if not a little terse. If you look through my answer here and learn it all, you&#39;ll be able to understand enough to answer the other question yourself, so maybe that&#39;s a good motivation."}], "tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": true, "score": 3, "last_activity_date": 1499171451, "creation_date": 1499171451, "answer_id": 44906062, "question_id": 44888846, "link": "https://stackoverflow.com/questions/44888846/use-cases-of-makeprisms-with-examples/44906062#44906062", "title": "Use cases of makePrisms with examples", "body": "<p>In order to understand this, you must understand types, type variables, algebraic data types (sum and product types) and you must also understand typeclasses and the <code>Functor</code> typeclass in particular. If you don't understand these things, bookmark this page, then go off and understand them, possibly with this resource that I helped work on for precisely this purpose, to illustrate and explain these basics: <a href=\"http://happylearnhaskelltutorial.com\" rel=\"nofollow noreferrer\">http://happylearnhaskelltutorial.com</a></p>\n\n<p>So before we get to Prisms, you first need to know what a Lens is.</p>\n\n<p>A <code>Lens</code> is often described as a functional getter/setter, but that's more about the implementation and so forth.</p>\n\n<p>I'd like to try an experiment of description here with you now.</p>\n\n<p>Say I have a page of very small text with some words on it. Now, I hand you a piece of cardboard the same size as that page, only it has hole for a magnifying glass set up to focus on a particular word. That word is in a specific place in that page.</p>\n\n<p>So we have these two things: a page, and a magnifying glass \"card\" without a magnifying glass... if we put a glass in, it focusses on a particular place on the page. Now someone comes along with another page with different words on it, but in the same layout as the first page.</p>\n\n<p>It's easy to image that you can take that card, put it on the new page and it will focus on the different word in that same place.</p>\n\n<p>As well as a magnifying glass, you also have a special \"eraser/printer\" glass that when you put it into the card allows you erase and type words over that page.</p>\n\n<p>So to now apply this to Lens, you can see with this example how if we take one piece of data (a page of text), a lens that fits that data (a card with a hole in it that matches the shape of the page) and a function that can \"get\" or \"set\" (or maybe other things) (that is, the magnifying glass or the eraser/printer glass, or other types of glasses), well, from this we can <code>view</code> the smaller piece of data (the word) in the larger piece of data (the page) to extract it... or perhaps we can <code>set</code> a different matching piece of data into the spot on that page...</p>\n\n<p><code>lens :: :: Functor f =&gt; (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; (a -&gt; f b) -&gt; s -&gt; f t</code></p>\n\n<p>What does this function do? It <strong>creates</strong> a lens from some functions. Now we have the framework above to understand what a lens is, we can undertsand this function. I say to you that the <code>s</code> variable stands for \"state\" and it corresponds to the type of the piece of paper that is the context that the lens will focus within. Next I can say the <code>a</code> type variable corresponds to the word on the page that the lens will focus on. What about <code>b</code> and <code>t</code>? They are the transformed <code>a</code> and <code>s</code> values if we decide to change the value of the <code>a</code>, and that change changes its type.</p>\n\n<p>What is the <code>Functor</code> for then? we'll find out in a while. Well, first up let's make a lens to make this practical. So, back to our <code>lens</code> function, its first argument is the \"getter\" function, the second argument is the \"setter\" function (hence the types). Then there's one other argument. Well, because Haskell functions are curried that's actually the return type: a function <code>s -&gt; f t</code>. Let's make that lens now.</p>\n\n<p>Let's say we have a list of values <code>[(1,(5,9)), (2,(3,6))]</code> and we'd like to make a lens that focusses on the second value in the second nested tuple. That's silly, though, because you could just use <code>snd . snd</code> right? Yeah, you could, so it's not a great example, but all the better examples are more complex, so bear with me - we'll get to them, and besides, can your <code>snd.snd</code> function also SET, or have a function applied to it? No, I didn't think so! :) (okay okay I know you could use <code>fmap (const val)</code> to set, but can it also change the type? well this line of thought is actually what you end up with Lens with if you continue it to its logical conclusion as Edward Kmett did - that's where the Functor comes in!)</p>\n\n<p><code>sndOfSndLens = lens (snd.snd) (\\(x,(y,z)) newZ -&gt; (x,(y,newZ)))</code></p>\n\n<p>So what did we get? we got a function of this type <code>sndOfSndLens :: Functor f =&gt; (a -&gt; f t2) -&gt; (t, (t1, a)) -&gt; f (t, (t1, t2))</code>.</p>\n\n<p>So let's get our values out: <code>map (view sndOfSnd) [(1,(5,9)), (2,(3,6))]</code> -> <code>[9,6]</code> Nice! That works... let's set new values in: <code>map (set sndOfSnd 2000) [(1,(5,9)), (2,(3,6))]</code> -> <code>[(1,(5,2000)),(2,(3,2000))]</code> okay fine...</p>\n\n<p>If it was just getters or setters, that's boring, but there's also a function called <code>over</code> which will take a lens and a transforming function and run that transformation on the function of the focus of the lens... so let's subtract 10 from each: <code>map (over sndOfSnd (flip (-) 10)) [(1,(5,9)), (2,(3,6))]</code> -> <code>[(1,(5,-1)),(2,(3,-4))]</code> that's cool! well I'll let you read the rest of the lens documentation to understand all the other functions, because they're deep and lenses compose, and you can do all sorts of other things with them, too.</p>\n\n<p><strong>Prism</strong></p>\n\n<p>I promised we'd get to Prism, and look we're here... A Lens is a specific \"optic\" (while also, sometimes confusingly referring to the entire set of optics in total, too, so watch out for that), and Prism is another optic, thankfully completely specific. If a Lens is an optic that works for focussing on a particular part of a <strong>product</strong> <em>algebraic data type</em>, then a Prims does the same thing for <strong>sum</strong> types. That's why we were able to make a lens that talked about pairs (<code>(,)</code>) because they're a <strong>product</strong> type... that is they combine two types into one. Lens lets you focus on one piece, or a path through those pieces. By the way, our lens we created above can easily be defined by composing the more generic built in lenses: <code>_2 . _2</code>. There are also operator versions of all the lens functions we were talking about. They look pretty crazy, but they have a logic to them. Read up about them!</p>\n\n<p>Prism lets you focus on one <strong>path</strong> through a <strong>sum type</strong>. What's a good example? Well, let's say we have think about the <code>Either</code> data type. It's <code>Either a b</code> where it's defined as <code>data Either a b = Left a | Right b</code>. So there's a corresponding <code>prism</code> function that lets us build a Prism the same as our above value. What happens if we use the built in <code>_Left</code> which focusses on the left side of an <code>Either</code>, but we only have a <code>Right 10</code> value? Let's see... but first, we should let you know that we can't use <code>view</code> any more because it might not work, so we need to use <code>preview</code> which will return a value that might <strong>fail</strong> (sorry, spoilers!):</p>\n\n<p><code>preview _Left (Left 10)</code> -> <code>Just 10</code> and then the <code>Right</code> one? <code>preview _Left (Right 10)</code> -> <code>Nothing</code>. Okay that's sweet.</p>\n\n<p>The <code>set</code> function works fine, because it can fail silently if it doesn't make sense: <code>set _Left 30 (Left 10)</code> -> <code>Left 30</code>. What happens when it doesn't work? <code>set _Right 30 (Left 10)</code> -> <code>Left 10</code> that's right, nothing.</p>\n\n<p>Cool... hopefully this explains Lenses and Prims. They're two really useful optics. The Lens library is <strong>full</strong> of them so I encourage you to look at them</p>\n\n<p><strong>What about the original question tho?</strong></p>\n\n<p>The original question was about <code>makeLenses</code> and <code>makePrisms</code>. These are template haskell expressions (that is, they're meta programming / similar to macros, but typed macros), and they let you automatically build your own lenses and/or prisms from your own data types. Hopefully it makes more sense now when you would pick one over the other and how they differ. This will give you at least an inkling into how they're different. To really understand, you should read the documentation and look up all the other functions and optics that are possible.</p>\n\n<p>Welcome to the amazingly cool world of Lenses!</p>\n"}], "owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 1, "accepted_answer_id": 44906062, "answer_count": 1, "score": 2, "last_activity_date": 1499171451, "creation_date": 1499094246, "last_edit_date": 1499101003, "question_id": 44888846, "link": "https://stackoverflow.com/questions/44888846/use-cases-of-makeprisms-with-examples", "title": "Use cases of makePrisms with examples", "body": "<p>It's not clear to me the difference between makeLense and makePrisms? </p>\n\n<p>I'm aware that when we want to access a nested structure/data then use makeLense like this:</p>\n\n<pre><code>data Point = Point { _x :: Int, _y :: Int}\ndata Test= Test {_name :: String, _position :: Point} \n\nmakeLenses ''Point\nmakeLenses ''Test\n</code></pre>\n\n<p>Then we can access or modify the component of Test or Point. For instance, we define a function:</p>\n\n<pre><code>modify :: Test -&gt; Test\nmodify = over (position . x) (*8)\n</code></pre>\n\n<p>So we can have: </p>\n\n<pre><code>let t1 = Test {_name= \"Me\", _position = Point {_x = 3, _y = 8}}\n</code></pre>\n\n<p>then</p>\n\n<pre><code>modify t1\n</code></pre>\n\n<p>would be:</p>\n\n<pre><code>Test {_name = \"Me\", _position = Point {_x = 24, _y = 8}}\n</code></pre>\n\n<p><strong>But, I don't know when and how to use makePrisms in the above example!</strong></p>\n"}, {"tags": ["javascript", "c", "performance", "haskell", "fibonacci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1499089421, "post_id": 44887128, "comment_id": 76752270, "body": "What if you add <code>-O2</code> to the compiler?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 5, "creation_date": 1499089715, "post_id": 44887128, "comment_id": 76752487, "body": "Haskell is probably defaulting to arbitrary-precision arithmetic too..."}, {"owner": {"reputation": 7115, "user_id": 2347483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80792d6741e11aaa6bec5f80fcc30a9c?s=128&d=identicon&r=PG", "display_name": "Phylogenesis", "link": "https://stackoverflow.com/users/2347483/phylogenesis"}, "edited": false, "score": 0, "creation_date": 1499089726, "post_id": 44887128, "comment_id": 76752494, "body": "Is there a real reason for this? This is pretty much the definitive example of a poorly written algorithm for calculating Fibonacci values [O(2^n) calculations required]."}, {"owner": {"reputation": 369690, "user_id": 182668, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b19917aa04a6839aef577f1117c71d48?s=128&d=identicon&r=PG", "display_name": "Pointy", "link": "https://stackoverflow.com/users/182668/pointy"}, "edited": false, "score": 7, "creation_date": 1499089730, "post_id": 44887128, "comment_id": 76752498, "body": "Your tests are far too short to be meaningful, and because the code is so limited you&#39;re really only testing a fraction of each language. Furthermore, that&#39;s a terrible way of computing Fibonacci numbers."}, {"owner": {"reputation": 11381, "user_id": 4774918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kQQAl.jpg?s=128&g=1", "display_name": "too honest for this site", "link": "https://stackoverflow.com/users/4774918/too-honest-for-this-site"}, "edited": false, "score": 0, "creation_date": 1499089820, "post_id": 44887128, "comment_id": 76752568, "body": "And if you calculate them by hand, it will be even slower! Your question is too broad, different implementations of an algorithm have different runtime. If you want to dig deeper, see the machine code or how the bytecode is interpreted."}, {"owner": {"reputation": 412, "user_id": 1117736, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/V9he1.jpg?s=128&g=1", "display_name": "Harrys Kavan", "link": "https://stackoverflow.com/users/1117736/harrys-kavan"}, "edited": false, "score": 1, "creation_date": 1499090152, "post_id": 44887128, "comment_id": 76752840, "body": "I did run the tests several times just to be sure it was not a one time thing, the times very just a little bit. And I understand that it is a poor way to compare them. I would just like why haskell is so much slower at computing the fibonacci in this particular way."}, {"owner": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 2, "creation_date": 1499090694, "post_id": 44887128, "comment_id": 76753236, "body": "Calculating <code>fib(30)</code> using your recursive algorithm requires about 2.7 million calls to <code>fib()</code> and uses up lots of stack space. What you&#39;re testing is, in effect, the ability of these languages to save and retrieve their operating state under insane conditions. This isn&#39;t a realistic way of comparing their performance when operating normally."}, {"owner": {"reputation": 412, "user_id": 1117736, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/V9he1.jpg?s=128&g=1", "display_name": "Harrys Kavan", "link": "https://stackoverflow.com/users/1117736/harrys-kavan"}, "reply_to_user": {"reputation": 21326, "user_id": 1679849, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpvxY.png?s=128&g=1", "display_name": "r3mainer", "link": "https://stackoverflow.com/users/1679849/r3mainer"}, "edited": false, "score": 0, "creation_date": 1499091244, "post_id": 44887128, "comment_id": 76753630, "body": "thanks @squeamishossifrage that helps. I understand that the way of comparing their performance is not usefull. All I wanted to know is where the difference might come from. And now that you say stack I have a bit of an idea why this particular way of calculating fib is so different in the languages."}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 2, "creation_date": 1499094260, "post_id": 44887128, "comment_id": 76755612, "body": "In addition to everything else that&#39;s been said: Did you force recompilation when adding <code>-O2</code> with <code>-fforce-recomp</code>? Otherwise, it&#39;s possible the recompilation did nothing. Furthermore, it should be possible to make it faster by adding a type signature <code>fib :: Int -&gt; Int</code>, because otherwise the type will be defaulted to <code>Integer</code> which is significantly slower."}], "answers": [{"comments": [{"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1499287057, "post_id": 44889047, "comment_id": 76847307, "body": "Not only that, but also whether the algorithm is tail recursive or not. <a href=\"https://wiki.haskell.org/The_Fibonacci_sequence\" rel=\"nofollow noreferrer\">Haskell Wiki</a> shows the different algorithms."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 10, "last_activity_date": 1499094910, "creation_date": 1499094910, "answer_id": 44889047, "question_id": 44887128, "link": "https://stackoverflow.com/questions/44887128/why-is-the-calculation-of-fibonacci-faster-in-javascript-than-haskell/44889047#44889047", "title": "Why is the calculation of fibonacci faster in javascript than haskell?", "body": "<p>It is just because of the difference between GMP <code>Integer</code>s and machine <code>Int</code>s:</p>\n\n<pre><code>% cat fib.hs\nfib :: Int -&gt; Int -- N.B. default is `Integer`\nfib 0 = 1\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n\nmain = print (fib 30)\n\n\n% ghc -O2 fib.hs &amp;&amp; time ./fib\n1346269\n./fib  0.01s user 0.00s system 87% cpu 0.013 total\n</code></pre>\n"}], "owner": {"reputation": 412, "user_id": 1117736, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/V9he1.jpg?s=128&g=1", "display_name": "Harrys Kavan", "link": "https://stackoverflow.com/users/1117736/harrys-kavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 44889047, "answer_count": 1, "score": 0, "last_activity_date": 1499095587, "creation_date": 1499089362, "last_edit_date": 1499089794, "question_id": 44887128, "link": "https://stackoverflow.com/questions/44887128/why-is-the-calculation-of-fibonacci-faster-in-javascript-than-haskell", "title": "Why is the calculation of fibonacci faster in javascript than haskell?", "body": "<p>As you can see in the examples below, javascript/node is much faster then haskell.<br>\nBut haskell is compiled and based on C. In the example, you see that C is the fastest. How comes that haskell is so slow in comparison?</p>\n\n<h2>JS executed by node:</h2>\n\n<pre><code>function fib(n) {\n    if ( n==0 || n==1 )\n        return 1;\n\n    return fib(n-2)+fib(n-1);\n}\nconsole.log(fib(30));\n</code></pre>\n\n<blockquote>\n  <p>$ time node fib.js<br>\n  1346269<br>\n  real  0m0,045s<br>\n  user  0m0,040s<br>\n  sys   0m0,004s  </p>\n</blockquote>\n\n<h2>haskell:</h2>\n\n<pre><code>fib 0 = 1\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n\nmain = print (fib 30)\n</code></pre>\n\n<blockquote>\n  <p>$ ghc -o fibh fib.hs<br>\n  $ time ./fibh<br>\n  1346269<br>\n  real  0m0,178s<br>\n  user  0m0,168s<br>\n  sys   0m0,000s  </p>\n</blockquote>\n\n<h2>c:</h2>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nint fib(int n) {\n    if (n == 0 || n == 1) \n        return 1;\n\n    return fib(n-1)+fib(n-2);\n}\n\nint main() {\n    int f = fib(30);\n    printf(\"cfib: %i\\n\", f);\n}\n</code></pre>\n\n<blockquote>\n  <p>$ gcc fib.c -o fibc<br>\n  $ time ./fibc<br>\n  cfib: 1346269<br>\n  real  0m0,023s<br>\n  user  0m0,020s<br>\n  sys   0m0,000s</p>\n</blockquote>\n\n<h1>EDIT1:</h1>\n\n<h2>haskell with -O2 like suggested</h2>\n\n<pre><code>$ ghc -O2 -o fibh fib.hs\n$ time ./fibh\n1346269\nreal 0m0,166s\nuser 0m0,160s\nsys 0m0,004s\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "typeclass"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 17, "creation_date": 1499088315, "post_id": 44886668, "comment_id": 76751558, "body": "It&#39;s more like &quot;<code>implements Interface</code>&quot; in Java."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1499088611, "post_id": 44886668, "comment_id": 76751754, "body": "I think you nailed it with &quot;instances are types (like ShirtSize) which you can apply type-class functions on (e.g the (==) function from MyEq).&quot;. Hardly any room left for an answer after that. Is there further confusion we can comment on when we respond?"}, {"owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "edited": false, "score": 1, "creation_date": 1499088683, "post_id": 44886668, "comment_id": 76751800, "body": "Read the section Typeclasses 102 from <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">learnyouahaskell.com/making-our-own-types-and-typeclasses</a> gives a really good description i think"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1499088905, "post_id": 44886668, "comment_id": 76751947, "body": "I think &quot;instance&quot; doesn&#39;t mean &quot;it can be instantiated&quot;, but rather &quot;this type is an instance of this type class, so its methods can be used&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 9, "last_activity_date": 1499089889, "creation_date": 1499089889, "answer_id": 44887313, "question_id": 44886668, "link": "https://stackoverflow.com/questions/44886668/what-does-instance-mean-in-haskell/44887313#44887313", "title": "What does instance mean in Haskell?", "body": "<p>If you're interested in explanation of type classes and difference from Java interfaces you should read <a href=\"https://joyofhaskell.com/posts/2017-03-15-typeclasses-in-translation.html\" rel=\"noreferrer\">this post by &lt;\u2764></a>. It also explains instances as well.</p>\n\n<p>As for me, I look at <code>instance</code> as <em>connection between data type and interface</em>. <code>data</code> contains some information, <code>class</code> contains methods. <code>data</code> is about <em>data</em> (sorry for tautology) and <code>class</code> is about <em>behavior</em>. When you look at data type you don't see what you can do with it, instead you see what it stores. When you look at <code>class</code> you see what type should be able to do, you don't care what it stores internally. In real programming you actually care about details of implementations and how methods implemented using specific data. So <code>instance</code> just shows you relation between some data and some behavior \u2014 how this behavior implemented using given data.</p>\n\n<p>In case you're interested more in model of type classes then read this blog post: <a href=\"http://www.haskellforall.com/2012/05/scrap-your-type-classes.html\" rel=\"noreferrer\">http://www.haskellforall.com/2012/05/scrap-your-type-classes.html</a></p>\n\n<p>You can look at instances as a values! It might blow your mind if you face such definition first time.</p>\n\n<p>In some dependently type languages <code>instances</code> are really values that you can pass to other functions. Take a look at this question:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/44339586/in-idris-is-eq-a-a-type-and-can-i-supply-a-value-for-it\">In Idris, is &quot;Eq a&quot; a type, and can I supply a value for it?</a></p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 22, "last_activity_date": 1499090777, "last_edit_date": 1499090777, "creation_date": 1499090462, "answer_id": 44887540, "question_id": 44886668, "link": "https://stackoverflow.com/questions/44886668/what-does-instance-mean-in-haskell/44887540#44887540", "title": "What does instance mean in Haskell?", "body": "<p>In Java, the class system is a way to group similar objects. An instance of a class is an individual object which belongs to that class. </p>\n\n<p>In Haskell, the class system is (roughly speaking) a way to group similar <em>types</em>. (This is the reason we call them \"type classes\"). An instance of a class is an individual <em>type</em> which belongs to that class. (That is, until you start considering multiparametric type classes).</p>\n\n<p>Incidentally, a Haskell (monoparametric) class somewhat resembles a Java interface and, by extension, a Java class. Or perhaps a Haskell instance resembles Java class. It's better to view this as a coincidence. Approach the term keeping its mathematical origins in mind. A class is just a bunch of things that belong together, and an instance is one of these things.</p>\n"}], "owner": {"reputation": 703, "user_id": 7763858, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e9fe17a86ba47917af5817de3f4fcc33?s=128&d=identicon&r=PG&f=1", "display_name": "August Jelemson", "link": "https://stackoverflow.com/users/7763858/august-jelemson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12190, "favorite_count": 6, "accepted_answer_id": 44887540, "answer_count": 2, "score": 16, "last_activity_date": 1610875656, "creation_date": 1499088019, "last_edit_date": 1610875656, "question_id": 44886668, "link": "https://stackoverflow.com/questions/44886668/what-does-instance-mean-in-haskell", "title": "What does instance mean in Haskell?", "body": "<p>In object-oriented languages (e.g; Java and Python) we can make objects/instances from classes.\nIn Haskell we can make instances from type-classes, ex:</p>\n<pre><code>data ShirtSize = S | M | L      -- Here ShirtSize is a enum data-type\n\nclass MyEq a where\n  (==) :: a -&gt; a -&gt; Bool\ninstance MyEq ShirtSize where   -- Here ShirtSize is an instance of the MyEq type-class\n  S == S = True\n  M == M = True\n  L == L = True\n  _ == _ = False\n</code></pre>\n<p><strong>My question is:</strong>\nWhat does instance mean in haskell?\nIn java we can make instances from classes, but in haskell it seems like instances are types (like ShirtSize) which you can apply type-class functions on (e.g the <strong>(==)</strong> function from MyEq). Am I right? and also what is an instance in Haskell compared to an instance/object in Java?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1499126061, "post_id": 44886335, "comment_id": 76768264, "body": "Perhaps useful to note that you can also write a version of <code>&lt;?&gt;</code> with the stronger type <code>(Typeable a, Typeable b) =&gt; (a -&gt; a) -&gt; Maybe (b -&gt; b)</code>; at this type, <code>&lt;?&gt;</code> is simply <code>cast</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1499135070, "post_id": 44886335, "comment_id": 76769981, "body": "@user2407038 Oh, of course! I didn&#39;t even think of that. Then the <code>&lt;?&gt;</code> in my answer is <code>sequenceA . cast</code>. Nice!"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 5, "last_activity_date": 1499089051, "last_edit_date": 1499089051, "creation_date": 1499087045, "answer_id": 44886335, "question_id": 44886170, "link": "https://stackoverflow.com/questions/44886170/using-typeable-to-effectively-case-match-against-different-types/44886335#44886335", "title": "Using Typeable to effectively case match against different types", "body": "<p>Here's code for the idea I outlined in <a href=\"https://stackoverflow.com/questions/44885661/pattern-matching-on-types/44885878?noredirect=1#comment76750186_44885878\">my earlier comment</a>. You need <code>ScopedTypeVariables</code> to tell the elaborator at which type to call <code>eqT</code>.</p>\n\n<pre><code>infixl 4 &lt;?&gt;\n(&lt;?&gt;) :: forall a b. (Typeable a, Typeable b) =&gt; (a -&gt; a) -&gt; b -&gt; Maybe b\nf &lt;?&gt; x = fmap (\\Refl -&gt; f x) (eqT :: Maybe (a :~: b))\n\nh :: Typeable t =&gt; t -&gt; Maybe t\nh x = f &lt;?&gt; x\n  &lt;|&gt; g &lt;?&gt; x\n</code></pre>\n\n<p>Probably warrants some explanation. <code>f &lt;?&gt; x</code> attempts to apply <code>f</code> to <code>x</code>, if its type matches. <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Typeable.html#v:eqT\" rel=\"nofollow noreferrer\"><code>eqT :: (Typeable a, Typeable b) =&gt; Maybe (a :~: b)</code></a> tests the two <code>Typeable</code> dictionaries to see if <code>a</code> and <code>b</code> are the same type. If they are, it returns <code>Just Refl</code>, a GADT proof that they are the same type. Pattern matching on <code>Refl</code>, as I did in the lambda, brings that equality into scope. In the body of the lambda GHC knows <code>a ~ b</code>, so we can safely apply <code>f</code> to <code>x</code>.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 1, "accepted_answer_id": 44886335, "answer_count": 1, "score": 2, "last_activity_date": 1499089051, "creation_date": 1499086557, "question_id": 44886170, "link": "https://stackoverflow.com/questions/44886170/using-typeable-to-effectively-case-match-against-different-types", "title": "Using Typeable to effectively case match against different types", "body": "<p>I roughly want to achieve the following:</p>\n\n<pre><code>f :: a -&gt; a\ng :: b -&gt; b\n\nh :: Typeable t =&gt; t -&gt; Maybe t\nh x = case x of\n  (x is of type a) -&gt; Just (f x)\n  (x is of type b) -&gt; Just (g x)\n  _ -&gt; Nothing\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1499085472, "post_id": 44885661, "comment_id": 76749537, "body": "As far as I know, objects have no type at runtime. So once the compiler produced a binary, the types are unknown: one cannot inspect the type nor act accordingly. That is the advantage of a statically typed language."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1499085506, "post_id": 44885661, "comment_id": 76749563, "body": "@WillemVanOnsem Note the <code>Typeable</code> constraint"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1499085540, "post_id": 44885661, "comment_id": 76749585, "body": "But there&#39;s a <code>Typeable</code> constraint. So I can do things like <code>cast</code> for example yes?"}], "answers": [{"comments": [{"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1499085895, "post_id": 44885878, "comment_id": 76749823, "body": "Ah, that&#39;s roughly what I was thinking, but using alternative does make the code prettier."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1499086153, "post_id": 44885878, "comment_id": 76749994, "body": "Could you look at the follow up question in the edit?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1499086407, "post_id": 44885878, "comment_id": 76750186, "body": "Probably warrants a separate question, but briefly: you&#39;ll have to bring the type equalities into scope by matching <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Typeable.html#v:eqT\" rel=\"nofollow noreferrer\"><code>eqT</code></a> with <code>Just Refl</code> (or <code>fmap</code>ping <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Type-Equality.html#v:gcastWith\" rel=\"nofollow noreferrer\"><code>gcastWith</code></a>). Then inside the block you know <code>t ~ a</code> or <code>t ~ b</code> and you can apply <code>f</code> or <code>g</code> as before"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1499086609, "post_id": 44885878, "comment_id": 76750313, "body": "I&#39;ve made a separate question and linked to it: <a href=\"https://stackoverflow.com/questions/44886170/using-typeable-to-effectively-case-match-against-different-types\" title=\"using typeable to effectively case match against different types\">stackoverflow.com/questions/44886170/&hellip;</a>"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 3, "last_activity_date": 1499085722, "creation_date": 1499085722, "answer_id": 44885878, "question_id": 44885661, "link": "https://stackoverflow.com/questions/44885661/pattern-matching-on-types/44885878#44885878", "title": "Pattern matching on types", "body": "<p>This is a job for the \"type safe cast\" bits of <code>Data.Typeable</code>. <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Typeable.html#v:cast\" rel=\"nofollow noreferrer\"><code>cast :: (Typeable a, Typeable b) =&gt; a -&gt; Maybe b</code></a> pulls the runtime type information out of the <code>Typeable</code> dictionaries for <code>a</code> and <code>b</code> and compares them; if <code>a</code> and <code>b</code> are the same type then it returns <code>Just</code> its argument, otherwise it fails.</p>\n\n<p>So, with <code>cast</code> and <code>Maybe</code>'s <code>Alternative</code> instance in hand, we have:</p>\n\n<pre><code>h x = f &lt;$&gt; cast x\n  &lt;|&gt; g &lt;$&gt; cast x\n</code></pre>\n\n<p>As far as I know, there's no way to avoid the repetitious calls to <code>cast</code>, since they occur at different types.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 44885878, "answer_count": 1, "score": 1, "last_activity_date": 1499086597, "creation_date": 1499085016, "last_edit_date": 1499086597, "question_id": 44885661, "link": "https://stackoverflow.com/questions/44885661/pattern-matching-on-types", "title": "Pattern matching on types", "body": "<p>Is there nice way to write the following \"x is of type t\" parts? (I suspect I should be using <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Type-Equality.html\" rel=\"nofollow noreferrer\">Data.Type.Equality</a> but I'm not sure exactly how)</p>\n\n<pre><code>f :: a -&gt; Int\ng :: b -&gt; Int\n\nh :: Typeable t =&gt; t -&gt; Maybe Int\nh x = case x of\n  (x is of type a) -&gt; Just (f x)\n  (x is of type b) -&gt; Just (g x)\n  _ -&gt; Nothing\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/44886170/using-typeable-to-effectively-case-match-against-different-types\">Follow up question</a></p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 3, "creation_date": 1499085347, "post_id": 44885585, "comment_id": 76749450, "body": "<code>twiceLifted&#39;</code> only has concrete type because it&#39;s declared with that type. If you remove the type declaration, it&#39;ll be exactly as general as <code>twiceLifted</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1499088195, "post_id": 44885585, "comment_id": 76751476, "body": "This is a case where thinking in System F, with explicit big-lambda abstraction and type application would make it simpler. Type inference sometimes is a bit too magic, in that it can instantiate a lot of type variables for us, sometimes making the process hard to follow."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1499095245, "post_id": 44886121, "comment_id": 76756234, "body": "So the introduction of type variables (e.g. <code>a</code>) or type constraints (e.g. <code>Functor</code>) result in generalization of types. In other words, polymorphism (both parametric and ad-hoc) represents the notion of generalization in the context of types. This is very interesting."}], "tags": [], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "is_accepted": true, "score": 3, "last_activity_date": 1499086839, "last_edit_date": 1499086839, "creation_date": 1499086374, "answer_id": 44886121, "question_id": 44885585, "link": "https://stackoverflow.com/questions/44885585/generalize-the-function/44886121#44886121", "title": "Generalize the function", "body": "<p>Generalization is about making <strong>concepts</strong> less restrictive. Consider a function that we might have, which goes through a <code>[Int]</code> and adds <code>5</code> to every element:</p>\n\n<pre><code>mapAdd5 :: [Int] -&gt; [Int]\nmapAdd5 [] = []\nmapAdd5 (x:xs) = (x + 5) : mapAdd5 xs\n</code></pre>\n\n<p>Okay, what if we want to be able to perform <em>more</em> than just adding <code>5</code> to every element? What if we want go through a whole list and instead multiply every element by <code>2</code>?</p>\n\n<pre><code>mapMult2 :: [Int] -&gt; [Int]\nmapMult2 [] = []\nmapMult2 (x:xs) = (x * 2) : mapMult2 xs\n</code></pre>\n\n<p>Something you've probably noticed is that we are in essence applying a function of type <code>Int -&gt; Int</code> to every element. Well?</p>\n\n<pre><code>mapInts :: (Int -&gt; Int) -&gt; [Int] -&gt; [Int]\nmapInts f [] = []\nmapInts f (x:xs) = (f x) : mapInts f xs\n</code></pre>\n\n<p>Great, we've generalized away the internal function now. But what if we want to be able to apply this concept to a <code>Double -&gt; Double</code> or even a <code>String -&gt; String</code>?</p>\n\n<pre><code>mapMore :: (a -&gt; a) -&gt; [a] -&gt; [a]\nmapMore f [] = []\nmapMore f (x:xs) = (f x) : mapMore f xs\n</code></pre>\n\n<p>What if we don't restrict the function to be of type <code>a -&gt; a</code>. That is, we currently force the output type to be the same as the input type. What if they can be different, like <code>a -&gt; b</code>? Although it <strong>might</strong> very well be the case that <code>a</code> is the same as <code>b</code>, but unlike <code>a -&gt; a</code>, we don't force it to be so:</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap f [] = []\nmap f (x:xs) = (f x) : map f xs\n</code></pre>\n\n<p>And now we've generalized from <code>mapAdd5</code> to <code>map</code>.</p>\n\n<p><strong>Bonus</strong></p>\n\n<p>What if we don't want to restrict ourselves to using lists? It turns out we can abstract / generalize lists into instances of <code>Functor</code>, which are merely things that enable functions to be applied on types that wrap / hold other items. Think about it, that's exactly what a list does!</p>\n\n<pre><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>How is <code>fmap</code> defined? Its definition will vary based on what type of container <code>f</code> you have. However, in the case of lists (also known as <code>[]</code>), we have it defined <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/src/GHC.Base.html#line-734\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>instance Functor [] where\n    fmap = map\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 44886121, "answer_count": 1, "score": 1, "last_activity_date": 1499086839, "creation_date": 1499084787, "question_id": 44885585, "link": "https://stackoverflow.com/questions/44885585/generalize-the-function", "title": "Generalize the function", "body": "<p>I am learning haskell and try to understand what does generalization mean in the functional programming. </p>\n\n<p>Consider follow code snippet:</p>\n\n<pre><code>twiceLifted :: (Functor f1, Functor f) =&gt;\n               f (f1 a) -&gt; f (f1 Char)\ntwiceLifted = (fmap . fmap) replaceWithP\n\ntwiceLifted' :: [Maybe String] -&gt; [Maybe Char]\ntwiceLifted' = twiceLifted\n</code></pre>\n\n<p>As you can see, the first function has not concrete type, functor has to be implemented.  </p>\n\n<p>The second function looks more interesting. It reused the first function, but it has a concrete type.<br>\nSo first function build the ground for the second function.<br>\nIs that what generalization in functional programming all about, reused something that already exists and build on top of it?</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1499086077, "post_id": 44885716, "comment_id": 76749946, "body": "Thanks, it was the way it was asked in a problem. This does make it all much clearer."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1499104814, "post_id": 44885716, "comment_id": 76761002, "body": "Also <code>a &gt;&gt;= return . f&#39;</code> is equivalent to <code>f&#39; &lt;$&gt; a</code>, so the whole thing could also be <code>f &gt;&gt;= (&lt;$&gt; a)</code>"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 8, "last_activity_date": 1499086096, "last_edit_date": 1499086096, "creation_date": 1499085181, "answer_id": 44885716, "question_id": 44885498, "link": "https://stackoverflow.com/questions/44885498/how-to-write-using-in-haskell/44885716#44885716", "title": "How to write (&lt;*&gt;) using (=&lt;&lt;) in Haskell", "body": "<p>This strikes me as a deliberately obtuse way of writing it. Whoever gave you this code is trying to mess with you. Here's the usual definition of <code>ap</code>, which is clean and easy to understand:</p>\n\n<pre><code>ap f a = do\n    f' &lt;- f\n    a' &lt;- a\n    return (f' a')\n</code></pre>\n\n<p>We can run this through the usual <code>do</code> desugaring transformation, replacing <code>&lt;-</code> with <code>&gt;&gt;=</code>:</p>\n\n<pre><code>ap f a =\n    f &gt;&gt;= \\f' -&gt;\n    a &gt;&gt;= \\a' -&gt;\n    return (f' a')\n</code></pre>\n\n<p>Now, note that the innermost term is <code>\\a' -&gt; return (f' a')</code>, which can be written as <code>return . f'</code>.</p>\n\n<pre><code>ap f a =\n    f &gt;&gt;= \\f' -&gt;\n    a &gt;&gt;= return . f'\n</code></pre>\n\n<p>Then, since <code>(=&lt;&lt;) = flip (&gt;&gt;=)</code>, we can replace <code>&gt;&gt;=</code> with <code>=&lt;&lt;</code> by exchanging the arguments:</p>\n\n<pre><code>ap f a = f &gt;&gt;= (\\f' -&gt; return . f' =&lt;&lt; a)  -- reverse inner bind\nap f a = (\\f' -&gt; return . f' =&lt;&lt; a) =&lt;&lt; f  -- reverse the other bind\n</code></pre>\n\n<p>There you go.</p>\n"}, {"comments": [{"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1499605265, "post_id": 44894058, "comment_id": 76967311, "body": "Vote Yess For Ness"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1499614601, "post_id": 44894058, "comment_id": 76970080, "body": "@naomik I... I... no words. :)"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1499118472, "last_edit_date": 1499118472, "creation_date": 1499117168, "answer_id": 44894058, "question_id": 44885498, "link": "https://stackoverflow.com/questions/44885498/how-to-write-using-in-haskell/44894058#44894058", "title": "How to write (&lt;*&gt;) using (=&lt;&lt;) in Haskell", "body": "<p>The use of names <code>f</code> and <code>a</code> is extremely confusing, because names are suggestive (\"f\" evokes \"function\", but isn't). Primed names can be confusing as well. Parens shouldn't be omitted while you're still learning and are unsure about the default operator precedences. Same goes for <code>do</code>'s optional curly braces and semicolons.</p>\n\n<p>The two names should have been  <code>fs</code> and <code>as</code>. Changing them could be part of the expected answer. Thus you have</p>\n\n<pre><code>fs &lt;*&gt; as = (\\f -&gt; (return . f) =&lt;&lt; as) =&lt;&lt; fs\n          = fs &gt;&gt;= (\\f -&gt;\n            as &gt;&gt;= (return . f))                -- by definition of &gt;&gt;= and =&lt;&lt;\n          = fs &gt;&gt;= (\\f -&gt;\n            as &gt;&gt;= (\\a -&gt; (return . f) a))      -- by \"eta expansion\"\n          = fs &gt;&gt;= (\\f -&gt;\n            as &gt;&gt;= (\\a -&gt; return (f a)))        -- by `(.)` reduction\n          = do { f &lt;- fs \n               ; a &lt;- as \n               ; return (f a) }                 -- by `do` syntax definition\n</code></pre>\n\n<p>because that's how the <code>do</code> syntax is defined. And that <em>is</em> <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/src/GHC.Base.html#ap\" rel=\"nofollow noreferrer\">the definition</a> of <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad.html#v:ap\" rel=\"nofollow noreferrer\"><code>ap</code></a>, which <code>&lt;*&gt;</code> is supposed to be a stand-in for. </p>\n\n<p>It goes without saying that this works only for a type which is not just an Applicative, but a Monad as well.</p>\n\n<p>With <em>monad comprehensions</em>, the last one is written </p>\n\n<pre><code>          = [f a | f &lt;- fs, a &lt;- as]\n</code></pre>\n\n<p>which is pretty clear in itself.</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 44885716, "answer_count": 2, "score": 2, "last_activity_date": 1499118472, "creation_date": 1499084565, "last_edit_date": 1499086044, "question_id": 44885498, "link": "https://stackoverflow.com/questions/44885498/how-to-write-using-in-haskell", "title": "How to write (&lt;*&gt;) using (=&lt;&lt;) in Haskell", "body": "<p>Could someone explain why the following representation of <code>(&lt;*&gt;)</code>  with <code>(=&lt;&lt;)</code> works:</p>\n\n<pre><code>f &lt;*&gt; a = (\\f' -&gt; return . f' =&lt;&lt; a) =&lt;&lt; f\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens", "lenses"], "comments": [{"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 1, "creation_date": 1499084044, "post_id": 44884171, "comment_id": 76748531, "body": "<code>use l</code> is <code>asks (view l)</code>, and <code>uses l f</code> is <code>asks (views l f)</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1499088779, "post_id": 44884171, "comment_id": 76751855, "body": "<code>uses l f = f &lt;$&gt; use l</code>, if that helps?"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1499610140, "post_id": 44914191, "comment_id": 76968709, "body": "thank you for the answer, I can see that you&#39;re suggesting learning Lenses first. My question is: Is there any textbook covering lenses with some examples?"}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1499690272, "post_id": 44914191, "comment_id": 76998063, "body": "Sadly there aren&#39;t any textbooks that I know of that cover lenses yet. I&#39;d like to add them to a future volume of my tutorial <a href=\"http://happylearnhaskelltutorial.com\" rel=\"nofollow noreferrer\">happylearnhaskelltutorial.com</a> but as you can see it&#39;s much more beginner focussed one at this point. My recommendation to learn Lenses is to study the page at <a href=\"https://github.com/ekmett/lens\" rel=\"nofollow noreferrer\">github.com/ekmett/lens</a> and build some toy eamples of your own, and ask as many questions as you have on Stack Overflow about them. Also to really study the types, and this series, too: <a href=\"https://artyom.me/lens-over-tea-1\" rel=\"nofollow noreferrer\">artyom.me/lens-over-tea-1</a> it&#39;s very good. (probably start with that first)"}], "tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": true, "score": 0, "last_activity_date": 1499203676, "creation_date": 1499203676, "answer_id": 44914191, "question_id": 44884171, "link": "https://stackoverflow.com/questions/44884171/haskell-use-or-uses-in-getter/44914191#44914191", "title": "Haskell: use or uses in Getter", "body": "<p>As I tried to make clear in my answer to your other question over at <a href=\"https://stackoverflow.com/questions/44888846/use-cases-of-makeprisms-with-examples/44906062#44906062\">Use cases of makePrisms with examples</a> there is a lot of requisite knowledge required before you can understand this.</p>\n\n<p>First up, you have to understand Lens quite well. Judging from your other question you're just beginning them. This is great! They're amazingly cool and it's excellent to tackle such things.</p>\n\n<p>However, I'd give you a big amount of caution here, one of the dangers of Haskell is it's <strong>so</strong> powerful, and can be <strong>so</strong> expressive and terse, that it seems easy to try to skip stuff.</p>\n\n<p>If you skipped understanding algebraic data types very well, for example, you can easily read code and <strong>think</strong> you have an understanding of it when you don't at all. This can then lead to compounded confusion, and you'll feel like you don't understand any of it, which actually might be true, but that feeling is not a good feeling to have when learning Haskell.</p>\n\n<p>I don't want you to feel like that.</p>\n\n<p>So I encourage you to learn Lens, but if you don't have the requisite knowledge for Lens, then I encourage you to go get that first. It's not <strong>too</strong> hard to understand this stuff to a degree, but the way Lens is written is not trivial or easy to approach for programmers who aren't quite familiar with at least simple types, parameterized types, Algebraic Data Types, Typeclasses, the Functor typeclass, and to really understand it, you need to understand several instances of Functor.</p>\n\n<p>As well, if you're trying to understand <code>use</code> and <code>uses</code>, which only make sense when dealing with <code>State</code> values, then I'd suggest it's almost impossible to understand what's happening without knowing what <code>State</code> <strong>is</strong>, as well as what <code>Lens</code> does and is.</p>\n\n<p><code>use</code> and <code>uses</code> are for taking a lens and a state value and looking into the current state inside a <code>State</code> value. So, to a degree you really need to also understand what <code>do</code> syntax is doing, therefore the <code>Monad</code> typeclass to a degree, as well as how the <code>State</code> / <code>MonadState</code> work from that perspective.</p>\n\n<p>If any of these preliminaries are skipped, you'll be confused.</p>\n\n<p>I hope this helps! And I wish you well.</p>\n"}], "owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "accepted_answer_id": 44914191, "answer_count": 1, "score": 0, "last_activity_date": 1499203676, "creation_date": 1499080537, "last_edit_date": 1499088745, "question_id": 44884171, "link": "https://stackoverflow.com/questions/44884171/haskell-use-or-uses-in-getter", "title": "Haskell: use or uses in Getter", "body": "<p>In Control.Lens we have Getter that can access the nested structure. Getter has use and uses, but it's not clear to me how they work. So it'd be great if someone can provide some simple examples that use or uses is utilised. </p>\n\n<p>Why do I need to know it? because I'm reading some <a href=\"https://github.com/input-output-hk/cardano-sl/blob/1f866450a8a530c119e3fc9edb84c97c56417aa2/lrc/Pos/Lrc/Fts.hs\" rel=\"nofollow noreferrer\">implementation</a> in Haskell and  \"uses\" and \"use\" were used in them. In particualr it says: </p>\n\n<pre><code>inRange &lt;- uses fsCurrentCoinRangeUpperBound (coinIndex &lt;=)\n</code></pre>\n\n<p>If the above code is just for comparing (&lt;=) two values, then why do we need \"uses\" at all, there? </p>\n"}, {"tags": ["json", "haskell", "aeson"], "comments": [{"owner": {"reputation": 20980, "user_id": 241990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/265f1d52e6e484c9abe60b4da20fb8ee?s=128&d=identicon&r=PG", "display_name": "Shaun the Sheep", "link": "https://stackoverflow.com/users/241990/shaun-the-sheep"}, "edited": false, "score": 0, "creation_date": 1499076549, "post_id": 44882695, "comment_id": 76743939, "body": "You could just use the existing <code>FromJSON</code> and <code>ToJSON</code> types for <code>Map</code>. Your tags would then be the keys."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1499077899, "post_id": 44882695, "comment_id": 76744751, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/44514645/fromjson-make-a-list-from-multiple-fields\">FromJSON make a list from multiple fields</a>"}, {"owner": {"reputation": 849, "user_id": 1714059, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f887aedbff06d22b6cfebb4526468e?s=128&d=identicon&r=PG", "display_name": "Batou99", "link": "https://stackoverflow.com/users/1714059/batou99"}, "edited": false, "score": 0, "creation_date": 1499159847, "post_id": 44882695, "comment_id": 76780908, "body": "It&#39;s a different case from the <a href=\"https://stackoverflow.com/questions/44514645/fromjson-make-a-list-from-multiple-fields\">FromJSON make a list from multiple fields</a>. The aforementioned link is for a case where the list of possible tags is known at compile time, in this case they are unknown."}], "answers": [{"tags": [], "owner": {"reputation": 1056, "user_id": 1268085, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ff2b99da4e49f13c53b2f718649fc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh Sajanikar", "link": "https://stackoverflow.com/users/1268085/yogesh-sajanikar"}, "is_accepted": true, "score": 1, "last_activity_date": 1499234814, "creation_date": 1499234814, "answer_id": 44918154, "question_id": 44882695, "link": "https://stackoverflow.com/questions/44882695/aeson-parse-dynamic-structure/44918154#44918154", "title": "AESON: Parse dynamic structure", "body": "<p>You can use the fact that Object is an HasMap and extract the key at runtime. You can then write the FromJSON instance as follows - </p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule Main where\n\nimport Data.Aeson\nimport qualified Data.Text as T\nimport qualified Data.HashMap.Lazy as HashMap\n\ndata TagResult = TagResult { name :: String\n                           , numberOfDevicesTagged :: Int\n                           } deriving (Show, Eq)\n\n\nnewtype TagResultList = TagResultList { tags :: [TagResult] } deriving Show\n\n\ninstance ToJSON TagResult where\n\n  toJSON (TagResult tag ntag) =\n    object [ T.pack tag .= ntag ]\n\ninstance ToJSON TagResultList where\n\n  toJSON (TagResultList tags) =\n    object [ \"tagresults\" .= toJSON tags ]\n\n\ninstance FromJSON TagResult where\n\n  parseJSON (Object v) =\n    let (k, _) = head (HashMap.toList v)\n    in TagResult (T.unpack k) &lt;$&gt; v .: k\n\n  parseJSON _ = fail \"Invalid JSON type\"\n\ninstance FromJSON TagResultList where\n\n  parseJSON (Object v) =\n    TagResultList &lt;$&gt; v .: \"tagresults\"\n\n\nmain :: IO ()\nmain = do\n\n  let tag1 = TagResult \"tag1\" 1\n      tag2 = TagResult \"tag2\" 7\n      taglist = TagResultList [tag1, tag2]\n\n  let encoded = encode taglist\n      decoded = decode encoded :: Maybe TagResultList\n\n  print decoded\n</code></pre>\n\n<p>The above program should print the tag result list. </p>\n\n<pre><code>Just (TagResultList {tags = [TagResult {name = \"tag1\", numberOfDevicesTagged = 1},TagResult {name = \"tag2\", numberOfDevicesTagged = 7}]})\n</code></pre>\n"}], "owner": {"reputation": 849, "user_id": 1714059, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95f887aedbff06d22b6cfebb4526468e?s=128&d=identicon&r=PG", "display_name": "Batou99", "link": "https://stackoverflow.com/users/1714059/batou99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 44918154, "answer_count": 1, "score": 0, "last_activity_date": 1499234814, "creation_date": 1499075933, "last_edit_date": 1499091954, "question_id": 44882695, "link": "https://stackoverflow.com/questions/44882695/aeson-parse-dynamic-structure", "title": "AESON: Parse dynamic structure", "body": "<p>I have a JSON structure like this</p>\n\n<pre><code>{\n  \"tag1\": 1,\n  \"tag2\": 7,\n  ...\n}\n</code></pre>\n\n<p>And I have a type like this</p>\n\n<pre><code>data TagResult { name :: String, numberOfDevicesTagged :: Int } deriving (Show, Eq)\nnewtype TagResultList = TagResultList { tags :: [TagResult] }\n</code></pre>\n\n<p>The tag names are of course fully dynamic and I don't know them at compile time.\nI'd like to create an instance <code>FromJSON</code> to parse the JSON data but I just cannot make it compile.</p>\n\n<p>How can I define <code>parseJSON</code> to make this happen?</p>\n"}, {"tags": ["haskell", "wit.ai"], "answers": [{"tags": [], "owner": {"reputation": 327, "user_id": 8018986, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sGzDM.png?s=128&g=1", "display_name": "ChiralCarbon", "link": "https://stackoverflow.com/users/8018986/chiralcarbon"}, "is_accepted": false, "score": 2, "last_activity_date": 1499077810, "creation_date": 1499077810, "answer_id": 44883326, "question_id": 44882118, "link": "https://stackoverflow.com/questions/44882118/haskelllexical-error-in-string-character-literal-at-character-d/44883326#44883326", "title": "Haskell:lexical error in string/character literal at character &#39;d&#39;", "body": "<p>It was fixed by using <code>\\\\</code> instead of <code>\\</code> in the pattern.</p>\n"}], "owner": {"reputation": 327, "user_id": 8018986, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sGzDM.png?s=128&g=1", "display_name": "ChiralCarbon", "link": "https://stackoverflow.com/users/8018986/chiralcarbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 455, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1499077810, "creation_date": 1499074192, "last_edit_date": 1499075059, "question_id": 44882118, "link": "https://stackoverflow.com/questions/44882118/haskelllexical-error-in-string-character-literal-at-character-d", "title": "Haskell:lexical error in string/character literal at character &#39;d&#39;", "body": "<pre><code>ruleYear :: Rule\nruleYear = Rule\n{ name = \"year\"\n , pattern=[regex \"[12]\\d{3})|(([\\.\\/\\-\\'])[901]\\d)\"] \n --pattern = [Predicate $ isIntegerBetween 1000 2100]\n , prod = \\tokens -&gt; case tokens of\n   (token:_) -&gt; do\n     n &lt;- getIntValue token\n     tt $ year n\n    _ -&gt; Nothing\n}\n</code></pre>\n\n<p>I am new to Haskell.\nI was trying to modify the time parser in <a href=\"https://github.com/facebookincubator/duckling\" rel=\"nofollow noreferrer\">duckling</a>. </p>\n\n<p>I changed one of the several rules for parsing and received this error:</p>\n\n<pre><code>\"lexical error in string/character literal at character 'd' \" for line 4.\n</code></pre>\n\n<p>I am not sure what is the cause of this error and how to rectify it.  </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1499071914, "post_id": 44881191, "comment_id": 76740772, "body": "The names printed out by GHCi don&#39;t have any special meaning there."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1499071998, "post_id": 44881191, "comment_id": 76740830, "body": "OK, so <code>b</code> can be just any type."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 3, "creation_date": 1499072011, "post_id": 44881191, "comment_id": 76740840, "body": "<code>a</code> and <code>b</code> may be of different type, but they don&#39;t have to. <code>f</code> is a polymorphic type that must have the functor constraint."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1499072467, "post_id": 44881191, "comment_id": 76741134, "body": "So when a function that have following signature <code>a -&gt; b</code>, so the type <code>a</code> does not have to be different then the type <code>b</code>? It can be the same type?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1499073046, "post_id": 44881191, "comment_id": 76741526, "body": "Firstly, the identity of type variables doesn&#39;t correspond to the literal character used to name them except in the local scope of a particular type. So <code>forall a b . a -&gt; b</code> and <code>forall a b . b -&gt; a</code> are <i>precisely</i> the same type. Second, indeed, <code>a -&gt; b</code> doesn&#39;t mean that <code>a</code> and <code>b</code> must be different - a type variable can take on any type, including another type variable."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1499074378, "post_id": 44881191, "comment_id": 76742430, "body": "What does it mean <code>forall</code>?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1499074502, "post_id": 44881191, "comment_id": 76742512, "body": "<code>forall</code> is implicitly inserted before parametrized types. A function <code>a -&gt; String</code> is actually <code>forall a. a -&gt; String</code>, meaning that it works for all types (&quot;for all a, the type is a -&gt; String&quot;)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1499077903, "post_id": 44881191, "comment_id": 76744755, "body": "To understand its type signature it is probably more helpful if you start with a specific <code>fmap</code> instance (e.g. for lists: <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code>). <code>f</code> is <code>[]</code> - the parameterized type. <code>a</code> of the function domain must correspond to <code>a</code> in <code>[a]</code> (and so is it with <code>b</code>). There is no reason why <code>a</code> and <code>b</code> must not be of the same type."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1499077474, "creation_date": 1499077474, "answer_id": 44883216, "question_id": 44881191, "link": "https://stackoverflow.com/questions/44881191/what-is-the-difference-between-typevariable-a-and-b/44883216#44883216", "title": "What is the difference between typevariable a and b", "body": "<p>First, the type</p>\n\n<pre><code>fmap replaceWithP :: Functor f =&gt; f b -&gt; f Char\n</code></pre>\n\n<p>is exactly equivalent to</p>\n\n<pre><code>fmap replaceWithP :: Functor f =&gt; f a -&gt; f Char\n</code></pre>\n\n<p>because all type variables are implicitly universally quantified, so they can be renamed at will (this is known as alpha-conversion).</p>\n\n<p>One might still wonder where the name <code>b</code> printed by GHC comes from. After all, <code>fmap</code> had <code>f a</code> in its type, so why did GHC choose to rename it as  <code>b</code>?</p>\n\n<p>The \"culprit\" here is <code>replaceWithP</code></p>\n\n<pre><code>&gt; :t const\nconst :: a -&gt; b -&gt; a\n&gt; let replaceWithP = const 'p'\n&gt; :t replaceWithP \nreplaceWithP :: b -&gt; Char\n</code></pre>\n\n<p>So, <code>b</code> comes from the type of <code>replaceWithP</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 755, "user_id": 2704964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79d2160e8cd355915182506411e69489?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Xue", "link": "https://stackoverflow.com/users/2704964/anton-xue"}, "is_accepted": false, "score": 3, "last_activity_date": 1499080390, "last_edit_date": 1499080390, "creation_date": 1499077673, "answer_id": 44883291, "question_id": 44881191, "link": "https://stackoverflow.com/questions/44881191/what-is-the-difference-between-typevariable-a-and-b/44883291#44883291", "title": "What is the difference between typevariable a and b", "body": "<p>Type variables can be thought of normal variables, except you have types instead.</p>\n\n<p>What does this mean? For instance, the variable <code>a</code> in C might be defined as:</p>\n\n<pre><code>int a = 2;\n</code></pre>\n\n<p>What are the possible values that you could have assigned <code>a</code>? The whole <code>int</code> range, because that's the set of <em>values</em> that <code>a</code> may take on. Let's take a look at this in pseudo-Haskell:</p>\n\n<pre><code>type b = Int\n</code></pre>\n\n<p>What are the set of values that <code>b</code> may take on? That's a trickier question. Typically we're used to seeing things such as <code>2</code>, <code>\"hello\"</code>, or <code>True</code> as values. However, in Haskell, we also allow types to be treated as values. Sort of. Let's say that <code>b</code> can take on any <a href=\"https://wiki.haskell.org/Kind\" rel=\"nofollow noreferrer\"><em>kind</em></a> of form *. Essentially, this includes all types that do not need extra information for their construction:</p>\n\n<pre><code>data Tree a = Leaf a | Branch (Tree a) (Tree a)\nTree      -- no, has kind: * -&gt; *\nTree Int  -- okay!\nInt       -- okay!\nString    -- okay!\n</code></pre>\n\n<p>This means that in your example:</p>\n\n<pre><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>The variables <code>a</code> and <code>b</code> can be thought of variables that can take on types of any form provided that the type you decide to give it is within the appropriate range of type values (as restricted by kinds).</p>\n\n<p>To more precisely answer your question now: why do we observe that:</p>\n\n<pre><code>fmap              :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\nfmap replaceWithP :: Functor f =&gt;             f b -&gt; f Char\n</code></pre>\n\n<p>Let me rewrite the following equivalent definition, because variable naming can cause confusion:</p>\n\n<pre><code>fmap              :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\nfmap replaceWithP :: Functor f =&gt;             f z -&gt; f Char\n</code></pre>\n\n<p>Hopefully this looks more clear now. When you supplied the <code>replaceWithP :: x -&gt; Char</code> function, the following mappings occur:</p>\n\n<pre><code>-- Function types\nfmap         :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\nreplaceWithP ::              x -&gt; Char\n\n-- Type variable mappings\na -&gt; x\nb -&gt; Char\n</code></pre>\n\n<p>What does this look like if we perform substitution?</p>\n\n<pre><code>Functor f =&gt; (x -&gt; Char) -&gt; f x -&gt; f Char\n</code></pre>\n\n<p>After you have supplied in the <code>replaceWithP</code> function, you consume the first parameter, so you're left with:</p>\n\n<pre><code>fmap replaceWithP :: Functor f =&gt; f x -&gt; f Char\n</code></pre>\n\n<p>Or equivalently:</p>\n\n<pre><code>fmap replaceWithP :: Functor f =&gt; f b -&gt; f Char\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 44883216, "answer_count": 2, "score": 2, "last_activity_date": 1499080390, "creation_date": 1499071420, "question_id": 44881191, "link": "https://stackoverflow.com/questions/44881191/what-is-the-difference-between-typevariable-a-and-b", "title": "What is the difference between typevariable a and b", "body": "<p>I am learning haskell and one of the tricky part are type variables.<br>\nConsider following example:  </p>\n\n<pre><code>Prelude&gt; :t fmap\nfmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>there is type variables <code>a</code> and <code>b</code>, they can be any type. And <code>f</code> is a type that has to be implemented a Functor.   </p>\n\n<p>Lets define a function for first argument for <code>fmap</code>:</p>\n\n<pre><code>Prelude&gt; let replaceWithP = const 'p'\n</code></pre>\n\n<p>Now, I pass the function <code>replaceWithP</code> to <code>fmap</code> and looking at the type signature:  </p>\n\n<pre><code>Prelude&gt; :t fmap replaceWithP\nfmap replaceWithP :: Functor f =&gt; f b -&gt; f Char\n</code></pre>\n\n<p>Why does <code>f a</code> becomes to <code>f b</code>, why does it not stay <code>a</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499069125, "post_id": 44880372, "comment_id": 76739123, "body": "where is TC used ?"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499069182, "post_id": 44880372, "comment_id": 76739167, "body": "Whoops in the constructor see edit"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499069618, "post_id": 44880372, "comment_id": 76739385, "body": "Just to parse the code, speaking out loud: the type T is indexed by kind I. but its value constructor, via the constraints from TC, only allow to create value at type index &#39;A and &#39;C. type &#39;B and &#39;D can not be index of any value of type TC."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499069778, "post_id": 44880372, "comment_id": 76739482, "body": "Yes (I think). The T1 constructor can only have type <code>T A</code> or <code>T C</code>. There is of course other constructors, I&#39;ve added a few examples to the code to illustrate this idea."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499069979, "post_id": 44880372, "comment_id": 76739589, "body": "now castToT1 attempts to convert a value of type T, indexed by some type a of kind I, to a value of type T indexed by b of kind I, b being provided by the caller of castToT1."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499070050, "post_id": 44880372, "comment_id": 76739628, "body": "That&#39;s right. Returns Nothing if you can&#39;t construct T1 with that type but if you can, returns a T1 of that type. It&#39;s like the ordinary <code>cast</code> function, but instead of only one valid target there&#39;s multiple."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499070345, "post_id": 44880372, "comment_id": 76739821, "body": "shouldn&#39;t your casts be [ ((cast x) :: T &#39;A), ((cast x) :: T &#39;C)] instead ?"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499070568, "post_id": 44880372, "comment_id": 76739953, "body": "I&#39;ve removed the <code>castToT1</code> and added <code>mkT1</code>, this should make things clearer"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499071316, "post_id": 44880372, "comment_id": 76740403, "body": "no pb. so the caller of mkT1 request a value of type T at type index a, and mkT1 provide them through constructor T1. it&#39;s an indexed smart constructor, which might fail as T1 is guarded by TC1 which you have provided."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499071384, "post_id": 44880372, "comment_id": 76740451, "body": "Yep that&#39;s pretty much it."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499071758, "post_id": 44880372, "comment_id": 76740700, "body": "and then since you don&#39;t know yet the index which will be requested, you enumerate now the witnesses (values) at all possible indexes, and let cast transform them into the value Nothing if the provided index is different, or Just the same if the index requested will be the same."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499071928, "post_id": 44880372, "comment_id": 76740787, "body": "so what you&#39;d want is a way to provide an enumeration of every possible index for which TC1 provide you with empty constraints"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1499072005, "post_id": 44880372, "comment_id": 76740834, "body": "Yes that would be nice although I am open to alternate approaches also."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1499081097, "post_id": 44880372, "comment_id": 76746711, "body": "Minor point: in the second family we find <code>TC2</code> which should read <code>TC4</code>, I guess."}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1499081139, "creation_date": 1499068442, "last_edit_date": 1499081139, "question_id": 44880372, "link": "https://stackoverflow.com/questions/44880372/type-safe-casting-to-multiple-potential-types", "title": "Type safe casting to multiple potential types", "body": "<p>I've currently got a pattern like the following happening in my code (this is simplified from the actual code which is a large GADT dealing with expressions).</p>\n\n<pre><code>data I = A | B | C | D\n\ntype family TC1 (a :: I) :: Constraint where\n  TC1 'A = ()\n  TC1 'C = ()\n  TC1 _ = ('True ~ 'False)\n\ntype family TC4 (a :: I) :: Constraint where\n  TC4 'B = ()\n  TC4 'C = ()\n  TC4 'D = ()\n  TC4 _ = ('True ~ 'False)\n\ndata T (t :: I) where\n  T1 :: (TC1 t) =&gt; T t\n  T2 :: T B\n  T3 :: T t\n  T4 :: (TC4 t) =&gt; T t\n  etc\n\ncastL :: (Typeable t) =&gt; [Maybe t] -&gt; Maybe t\ncastL l = case catMaybes l of\n  (x:_) -&gt; Just x\n  [] -&gt; Nothing\n\nmkT1 :: Typeable a =&gt; Maybe (T a)\nmkT1 = castL [cast (T1 :: T 'A), cast (T1 :: T 'C)]\n</code></pre>\n\n<p>A few questions:</p>\n\n<ol>\n<li>Is there a nicer way to specify a constraint that always fails instead of <code>('True ~ 'False)</code>?</li>\n<li><code>mkT1</code> looks a bit hacky but it does seem to work. Is there a nicer way of doing it?</li>\n<li>Is there a better way to structure the whole thing (I understand this is a tricky question as I can't include all the detail of what I'm trying to achieve in a reasonably length post, but I'm basically generating a parse tree). </li>\n</ol>\n"}, {"tags": ["haskell", "monads", "continuations"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1499054589, "post_id": 44877444, "comment_id": 76733391, "body": "If your only jumping instruction is <code>Halt</code>, you could do something simpler using <code>Except</code>. Apart from that, the continuation monad isn&#39;t a bad fit for interpreters in general."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1499069925, "post_id": 44877444, "comment_id": 76739560, "body": "This is fine. If we never have to change <code>k</code>, as done above, we could try using <code>traverse_</code> or <code>mapM_</code> over the whole list. Note that <code>k ()</code> is the same of <code>k () &gt;&gt; ...</code> because of the &quot;early return&quot; effect, so traversing the whole list (lazily) should be equivalent."}], "answers": [{"tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": true, "score": 8, "last_activity_date": 1499055038, "creation_date": 1499055038, "answer_id": 44877680, "question_id": 44877444, "link": "https://stackoverflow.com/questions/44877444/is-this-an-appropriate-use-of-contt/44877680#44877680", "title": "Is this an appropriate use of ContT?", "body": "<p>Yes, this looks to be precisely the sort of use case for which <code>Control.Monad.Cont</code> is appropriate.</p>\n\n<p>You are almost certainly aware of this, but for other readers, it's worth spelling out that if you'd written <code>interpret</code> so that it was a function from a list of instructions to an <code>IO ()</code> like so:</p>\n\n<pre><code>main :: IO ()\nmain = interpret instructions\n\ninterpret :: [Instruction] -&gt; IO ()\ninterpret []     = pure ()\ninterpret (a:as) = case a of\n    Print str -&gt; putStrLn str &gt;&gt; interpret as\n    Block ins -&gt; interpret ins &gt;&gt; interpret as\n    Halt      -&gt; pure ()\n</code></pre>\n\n<p>then <code>foo</code> <code>bar</code> and <code>baz</code> all would have printed. What you needed was an escape mechanism that would allow you to abort the entire computation and immediately return a value. This is precisely what <code>callCC</code> provides. Calling the named computation (<code>k</code> in your code) allows you to escape out of the whole computation, not just that level/layer.</p>\n\n<p>So good job, you've found precisely the appropriate use case for ContT here, I believe. </p>\n"}], "owner": {"reputation": 173, "user_id": 1998438, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09ad1a02f21266cedc0ec02465d2bc3c?s=128&d=identicon&r=PG", "display_name": "Bryan", "link": "https://stackoverflow.com/users/1998438/bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1662, "favorite_count": 2, "accepted_answer_id": 44877680, "answer_count": 1, "score": 7, "last_activity_date": 1499055038, "creation_date": 1499053047, "question_id": 44877444, "link": "https://stackoverflow.com/questions/44877444/is-this-an-appropriate-use-of-contt", "title": "Is this an appropriate use of ContT?", "body": "<p>I'm working on a project that requires me to write a small interpreter. The instructions have a simple tree structure and one of the commands has the effect of halting execution. So in the example below, \"baz\" is never printed.</p>\n\n<pre><code>import Control.Monad.Cont\n\ndata Instruction = Print String | Halt | Block [Instruction]\n    deriving (Eq, Show)\n\ninstructions =\n  [ Print \"foo\"\n  , Block\n    [ Print \"bar\"\n    , Halt\n    ]\n  , Print \"baz\"\n  ]\n\nmain :: IO ()\nmain = runContT (callCC $ interpret instructions)\n                (const $ pure ())\n\ninterpret []     k = pure ()\ninterpret (a:as) k = case a of\n    Print str -&gt; liftIO (putStrLn str) &gt;&gt; interpret as k\n    Block ins -&gt; interpret ins k       &gt;&gt; interpret as k\n    Halt      -&gt; k ()\n</code></pre>\n\n<p>This is the first time I've seen a potential use for <code>ContT</code> in one of my projects. I was wondering if this is an appropriate use of it or if there is a simpler solution I might be overlooking.</p>\n"}, {"tags": ["string", "haskell", "character-encoding"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1499048698, "post_id": 44876904, "comment_id": 76732288, "body": "A string does not take up <code>x</code> bytes (unless you mean in Haskell memory, but I&#39;m pretty sure you don&#39;t, in which case, this string certainly doesn&#39;t take up 18 bytes). A string <i>in a particular encoding</i> takes up <code>x</code> bytes. Indeed, encoded as UTF8 string, <code>&quot;Hello Snowman \u2603!&quot;</code> takes up 18 bytes. However, a Haskell <code>String</code> doesn&#39;t have an encoding. Encode the string in your preferred encoding and compute the length of the encoded expression."}], "answers": [{"comments": [{"owner": {"reputation": 60183, "user_id": 66475, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/BPKeb.png?s=128&g=1", "display_name": "Bjorn", "link": "https://stackoverflow.com/users/66475/bjorn"}, "edited": false, "score": 0, "creation_date": 1499050010, "post_id": 44877079, "comment_id": 76732525, "body": "Thank you. I think I have also had luck now with <code>Data.ByteArray.length</code> after I used <code>Data.Text.pack</code> and <code>encodeUtf8</code> from Data.Text.Encoding. That also has given me the right value. Yours seems more succinct though."}, {"owner": {"reputation": 24109, "user_id": 775954, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9f5a87db35489d2958945f35b457f1ee?s=128&d=identicon&r=PG", "display_name": "Matthias Braun", "link": "https://stackoverflow.com/users/775954/matthias-braun"}, "edited": false, "score": 0, "creation_date": 1575557724, "post_id": 44877079, "comment_id": 104613584, "body": "In my case it was important to realize that <code>Data.ByteString.length</code> returns the number of bytes whereas <code>Data.ByteString.UTF8.length</code> returns the number of <i>characters</i>. Easy to mix them up."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1499054625, "last_edit_date": 1499054625, "creation_date": 1499049748, "answer_id": 44877079, "question_id": 44876904, "link": "https://stackoverflow.com/questions/44876904/in-haskell-how-do-i-get-the-number-of-bytes-in-a-utf8-string/44877079#44877079", "title": "In Haskell how do I get the number of bytes in a UTF8 string?", "body": "<p>You can use the excellent <a href=\"https://hackage.haskell.org/package/utf8-string\" rel=\"nofollow noreferrer\">utf8-string</a> package for this.</p>\n\n<pre><code>import qualified Data.ByteString as BS\nimport qualified Data.ByteString.UTF8 as UTF8\n\nnumBytesUtf8 :: String -&gt; Int\nnumBytesUtf8 = BS.length . UTF8.fromString\n</code></pre>\n\n<p>Then, to use your example, </p>\n\n<pre><code>ghci&gt; numBytesUtf8 \"Hello Snowman \u2603!\"\n18\n</code></pre>\n\n<p>Of course, you should probably not be doing this in the first place. <code>UTF8.fromString</code> and <code>BS.length</code> are probably the functions you want to use, but your strings probably ought to be <em>already</em> bytestrings for you to be interested in how many bytes it takes to encode them as such.</p>\n"}], "owner": {"reputation": 60183, "user_id": 66475, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/BPKeb.png?s=128&g=1", "display_name": "Bjorn", "link": "https://stackoverflow.com/users/66475/bjorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 1, "accepted_answer_id": 44877079, "answer_count": 1, "score": 2, "last_activity_date": 1499054655, "creation_date": 1499048195, "last_edit_date": 1499054655, "question_id": 44876904, "link": "https://stackoverflow.com/questions/44876904/in-haskell-how-do-i-get-the-number-of-bytes-in-a-utf8-string", "title": "In Haskell how do I get the number of bytes in a UTF8 string?", "body": "<p>Say I have the UTF8 string <code>\"Hello Snowman \u2603!\"</code>. It has 16 characters and takes up 18 bytes. How can I get haskell to show me the number of bytes this string takes up?</p>\n\n<p>I've tried using Data.ByteArray, Data.Text, ByteString and in each case I have come up short.</p>\n"}, {"tags": ["haskell", "effect-systems"], "answers": [{"comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 3, "creation_date": 1499049055, "post_id": 44876823, "comment_id": 76732355, "body": "Indeed, this does seem to work, but it\u2019s a lot uglier than I expected. I\u2019m now a little worried\u2014should I take the difficulty of this as an indication that I\u2019m \u201cusing freer wrong\u201d? Or is this just the complexity cost we must currently pay for performant extensible effects?"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1499050361, "post_id": 44876823, "comment_id": 76732581, "body": "I have no idea -- I was just following the types. I haven&#39;t used Freer or freer-effects at all."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 2, "last_activity_date": 1499047374, "creation_date": 1499047374, "answer_id": 44876823, "question_id": 44876305, "link": "https://stackoverflow.com/questions/44876305/encode-effect-in-terms-of-another-with-freer-extensible-effects/44876823#44876823", "title": "Encode effect in terms of another with freer extensible effects", "body": "<p>DISCLAIMER: the below typechecks but I haven't tried running it.</p>\n\n<p>You need to walk <code>q</code> (from the <code>E u q</code> pattern match) and shift all its steps from <code>Eff (f ': r)</code> to <code>Eff (g ': r)</code>. We can write this traversal polymorphically:</p>\n\n<pre><code>shiftQ :: forall m n a b. (forall a. m a -&gt; n a) -&gt; FTCQueue m a b -&gt; FTCQueue n a b\nshiftQ shift q = case tviewl q of\n    TOne act -&gt; tsingleton (shift . act)\n    act :| q -&gt; go (tsingleton (shift . act)) q\n  where\n    go :: forall a b c. FTCQueue n a b -&gt; FTCQueue m b c -&gt; FTCQueue n a c\n    go q' q = case tviewl q of\n        TOne act -&gt; q' |&gt; (shift . act)\n        act :| q -&gt; go (q' |&gt; (shift . act)) q\n</code></pre>\n\n<p>(it's a bit awkward because we can only snoc and only uncons <code>FTCQueue</code>s).</p>\n\n<p>and then we can use it in <code>reencode</code> by passing <code>reencode f</code> itself as the <code>shift</code>er:</p>\n\n<pre><code>reencode :: forall r w f g. (forall v. f v -&gt; Eff (g ': r) v) -&gt; Eff (f ': r) w -&gt; Eff (g ': r) w\nreencode f m = loop m\n  where\n    loop :: Eff (f ': r) w -&gt; Eff (g ': r) w\n    loop (Val x) = return x\n    loop (E u q) = case decomp u of\n      Right x -&gt; qComp q loop =&lt;&lt; f x\n      Left u' -&gt; E (weaken u') (shiftQ (reencode f) q)\n</code></pre>\n"}], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 44876823, "answer_count": 1, "score": 4, "last_activity_date": 1499047437, "creation_date": 1499041298, "last_edit_date": 1499047437, "question_id": 44876305, "link": "https://stackoverflow.com/questions/44876305/encode-effect-in-terms-of-another-with-freer-extensible-effects", "title": "Encode effect in terms of another with freer extensible effects", "body": "<p>I have been playing around with <a href=\"http://okmij.org/ftp/Haskell/extensible/\" rel=\"nofollow noreferrer\">\u201cfreer monads\u201d and extensible effects</a>, implemented in the <a href=\"https://hackage.haskell.org/package/freer-effects\" rel=\"nofollow noreferrer\">freer-effects</a> package, and I\u2019ve run into a problem that seems feasible but I\u2019m having trouble solving.</p>\n\n<p>I\u2019ve written a type that represents simple interactions with a file system:</p>\n\n<pre><code>data FileSystem v where\n  ReadFile :: FilePath -&gt; FileSystem String\n  WriteFile :: FilePath -&gt; String -&gt; FileSystem ()\n</code></pre>\n\n<p>Writing an interpreter for this in <code>IO</code> is easy, but boring. What I\u2019m really interested in doing is writing a pure interpreter that uses <code>State</code> internally. I <em>could</em> effectively inline the implementation of <code>runState</code> into my interpreter for <code>FileSystem</code>, but that seems like it would sort of defeat the purpose. What I\u2019d <em>really</em> like to be able to do is write a transformation between these two types, then reuse the <code>State</code> interpreter.</p>\n\n<p>Writing such a transformation is straightforward:</p>\n\n<pre><code>fsAsState :: forall v r. FileSystem v -&gt; Eff (State [(FilePath, String)] ': r) v\nfsAsState (ReadFile a) = (lookup a &lt;$&gt; get) &gt;&gt;=\n  maybe (fail \"readFile: file does not exist\") return\nfsAsState (WriteFile a b) = modify $ \\fs -&gt;\n  (a, b) : filter ((/= a) . fst) fs\n</code></pre>\n\n<p>Now I want a generic <code>reencode</code> function that can accept my <code>fsAsState</code> transformation and use it to interpret my <code>FileSystem</code> by reusing the <code>State</code> interpreter. With such a function, I would be able to write the following interpreter:</p>\n\n<pre><code>runInMemoryFS :: forall r w. [(FilePath, String)] -&gt; Eff (FileSystem ': r) w -&gt; Eff r (w, [(FilePath, String)])\nrunInMemoryFS fs m = runState (reencode fsAsState m) fs\n</code></pre>\n\n<p>The tricky thing is actually implementing <code>reencode</code>. I\u2019ve gotten something that <em>almost</em> typechecks:</p>\n\n<pre><code>reencode :: forall r w f g. (forall v. f v -&gt; Eff (g ': r) v) -&gt; Eff (f ': r) w -&gt; Eff (g ': r) w\nreencode f m = loop m\n  where\n    loop :: Eff (f ': r) w -&gt; Eff (g ': r) w\n    loop (Val x) = return x\n    loop (E u q) = case decomp u of\n      Right x -&gt; qComp q loop =&lt;&lt; f x\n      Left u' -&gt; E (weaken u') undefined\n</code></pre>\n\n<p>Unfortunately, I can\u2019t figure out how to provide the second argument to <code>E</code> in the final case of <code>loop</code>. I don\u2019t think I understand the implementation details of how the optimized <code>FTCQueue</code> type works in order to understand if there\u2019s something I need to do here that is simple, or if what I\u2019m doing is just impossible.</p>\n\n<p>Is this possible? If the answer is no, and it turns out that what I\u2019m doing <em>is</em>, in fact, impossible, I would be interested in an explanation to help me understand why.</p>\n"}, {"tags": ["performance", "haskell", "ghci", "runhaskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1499049154, "post_id": 44876285, "comment_id": 76732377, "body": "This seems to me to be a contradiction - &quot;set of compilation flags [... to ...] generate a profile-able binary that is identical to that executed by runghc&quot;. <code>runghc</code> doesn&#39;t compile your program; it interprets it. From the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/runghc.html\" rel=\"nofollow noreferrer\">docs</a>: &quot;runghc allows you to run Haskell programs without first having to compile them.&quot;. Interpreted programs don&#39;t benefit from optimization, so even if you could profile it, you would have no way of improving the performance (other than to compile it with optimizations, of course)."}, {"owner": {"reputation": 5774, "user_id": 105137, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/253329f6f7506a5299db1cb608d8defd?s=128&d=identicon&r=PG", "display_name": "kostmo", "link": "https://stackoverflow.com/users/105137/kostmo"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1499050903, "post_id": 44876285, "comment_id": 76732659, "body": "I&#39;ve clarified the text - if it is possible, I&#39;d like to obtain a profile-able binary that <i>performs</i> identically to the interpreted execution of the code.  A flame graph of this binary may still help identify algorithmic performance issues in the interpreted code, and would serve pedagogically to compare interpreted performance vs. optimized-compiled performance."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1499052066, "post_id": 44876285, "comment_id": 76732883, "body": "It is not at all possible to get identical performance from code interpreted by GHC and code compiled by GHC, even without optimizations on the compiled version. It is also not at all possible to use the profiling mechanism of the GHC <i>compiler</i> to profile a program interpreted by GHC. You can view these things as limitations of GHC, but I would view them as different tools for different jobs. Also, I disagree that there is pedagogical value to comparing performance of compiled vs. interpreted - these parts of GHC have entirely distinct operational semantics (it is literally apples to oranges)"}], "owner": {"reputation": 5774, "user_id": 105137, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/253329f6f7506a5299db1cb608d8defd?s=128&d=identicon&r=PG", "display_name": "kostmo", "link": "https://stackoverflow.com/users/105137/kostmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 182, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1499050727, "creation_date": 1499041006, "last_edit_date": 1499050727, "question_id": 44876285, "link": "https://stackoverflow.com/questions/44876285/replicating-runghc-performance-with-compiled-code", "title": "Replicating runghc performance with compiled code", "body": "<p>I am running an application \"as a script\" with <code>stack runghc</code>.  Naturally, it runs slower that way than when compiled and run with <code>stack exec</code>.</p>\n\n<p>I would like to compare the hotspots of the application as run with \"runghc\" relative to the compiled version.</p>\n\n<p>I was able to compile my application with profiling enabled via <code>stack build --profile</code>, then generate a flame graph as described <a href=\"https://www.fpcomplete.com/blog/2015/04/ghc-prof-flamegraph\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Is there any set of compilation flags that could be used to generate a profile-able binary that is identical (<em>edit:</em> in terms of <strong>performance</strong>) to that executed by <code>runghc</code>?</p>\n"}, {"tags": ["haskell", "recursion", "complexity-theory", "fibonacci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1499022279, "post_id": 44874253, "comment_id": 76726862, "body": "Why would a recursive defintion have a higher time complexity."}, {"owner": {"reputation": 100, "user_id": 4206409, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000309454768/picture?type=large", "display_name": "Zachary Bechhoefer", "link": "https://stackoverflow.com/users/4206409/zachary-bechhoefer"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1499022381, "post_id": 44874253, "comment_id": 76726906, "body": "The recursively defined Fibonacci function requires more calculations, I believe it has complexity of O(2^n)."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1499022410, "post_id": 44874253, "comment_id": 76726920, "body": "@ZacharyBechnoefer: not if you use <i>accumulators</i>."}, {"owner": {"reputation": 100, "user_id": 4206409, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000309454768/picture?type=large", "display_name": "Zachary Bechhoefer", "link": "https://stackoverflow.com/users/4206409/zachary-bechhoefer"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1499022584, "post_id": 44874253, "comment_id": 76726965, "body": "So like this stuff? <a href=\"http://www.idryman.org/blog/2012/04/14/recursion-best-practices/#tail-recursion\" rel=\"nofollow noreferrer\">idryman.org/blog/2012/04/14/recursion-best-practices/&hellip;</a>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1499022637, "post_id": 44874253, "comment_id": 76726984, "body": "yes, using accumulators is usually good for tail recursion optimization, but it can also - if carefully chosen - reduce the time complexity."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1499022646, "post_id": 44874253, "comment_id": 76726987, "body": "Relevant: <a href=\"https://wiki.haskell.org/The_Fibonacci_sequence\" rel=\"nofollow noreferrer\">wiki.haskell.org/The_Fibonacci_sequence</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1499036048, "post_id": 44874253, "comment_id": 76730175, "body": "If you simultaneously switch from iterative to recursive <i>and</i> from this standard algorithm to the naive algorithm, then yes, you get O(fib(n)) time complexity. But <i>just</i> switching from iterative to recursive style -- while keeping the same algorithm -- will keep the same O(n) time complexity."}], "answers": [{"comments": [{"owner": {"reputation": 100, "user_id": 4206409, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000309454768/picture?type=large", "display_name": "Zachary Bechhoefer", "link": "https://stackoverflow.com/users/4206409/zachary-bechhoefer"}, "edited": false, "score": 1, "creation_date": 1499022770, "post_id": 44874303, "comment_id": 76727034, "body": "Very cool! Was there a particular class you studied this in? Like, Algorithm Design or something? Thanks!"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 100, "user_id": 4206409, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000309454768/picture?type=large", "display_name": "Zachary Bechhoefer", "link": "https://stackoverflow.com/users/4206409/zachary-bechhoefer"}, "edited": false, "score": 1, "creation_date": 1499023022, "post_id": 44874303, "comment_id": 76727097, "body": "@ZacharyBechhoefer: Nope. Actually I first learned about accumulators in a logic programming course (Prolog). But logic and functional programming have some common background."}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "reply_to_user": {"reputation": 100, "user_id": 4206409, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000309454768/picture?type=large", "display_name": "Zachary Bechhoefer", "link": "https://stackoverflow.com/users/4206409/zachary-bechhoefer"}, "edited": false, "score": 5, "creation_date": 1499031096, "post_id": 44874303, "comment_id": 76729160, "body": "@ZacharyBechhoefer this is (among other places, I&#39;m sure) taught in Structure and Interpretation of Computer Programs (SICP), very early in th book \u2013 it actually uses fibonacci as the example program too, comparing iterative vs recursive <i>procedures</i> vs <i>processes</i>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1515415138, "last_edit_date": 1592644375, "creation_date": 1499022574, "answer_id": 44874303, "question_id": 44874253, "link": "https://stackoverflow.com/questions/44874253/fibonacci-in-haskell/44874303#44874303", "title": "Fibonacci in Haskell", "body": "<blockquote>\n<p>My question is, is the function recursive? It uses values that it calculates to do more calculations, but never calls itself.</p>\n</blockquote>\n<p><strong>No</strong>: recursion means that something is defined in terms of itself. The <code>fibfast</code> function is not defined in terms of itself.</p>\n<blockquote>\n<p>My other question is, how do I get this same time-space compactness in Haskell? Haskell functions I have found either have space complexity greater than O(1), returning an entire list of terms, and/or they have time complexity greater than O(n) because they use the typical recursive definition.</p>\n</blockquote>\n<p>You can use the following function:</p>\n<pre><code>fibfast :: Int -&gt; Int\nfibfast n = fib' 0 1 n\n    where fib' a b n | n &lt;= 1 = b\n                     | otherwise = fib' b (a+b) (n-1)\n</code></pre>\n<p>So here we define a recursive function <code>fib'</code> and use two accumulators <code>a</code> and <code>b</code> that store the last two values in the sequence. Each iteration, the two are updated and we decrement the number of iterations we have to do until it hits a number <code>n</code> less than or equal to <code>1</code> in which case we return the second accumulator.</p>\n<p>A problem can be that Haskell usually does not evaluate expressions eagerly, but <em>lazily</em>. So it stores <code>a+b</code> instead of calculating <code>a+b</code>. As a result the expression tree rapidly will be like <code>a+b+a+b+a+b...</code>, which thus grows rapidly. We can for instance use <em>bang patterns</em>:</p>\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\nfibfast :: Int -&gt; Int\nfibfast n = fib' 0 1 n\n    where fib' a !b !n | n &lt;= 1 = b\n                       | otherwise = fib' b (a+b) (n-1)\n</code></pre>\n"}], "owner": {"reputation": 100, "user_id": 4206409, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000309454768/picture?type=large", "display_name": "Zachary Bechhoefer", "link": "https://stackoverflow.com/users/4206409/zachary-bechhoefer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1816, "favorite_count": 0, "accepted_answer_id": 44874303, "answer_count": 1, "score": 3, "last_activity_date": 1515415138, "creation_date": 1499022175, "last_edit_date": 1499025708, "question_id": 44874253, "link": "https://stackoverflow.com/questions/44874253/fibonacci-in-haskell", "title": "Fibonacci in Haskell", "body": "<p>So here's a fibonacci term-calculating function (in Ruby):</p>\n\n<pre><code>def fibfast(n)\n  xs = [0,1]\n  (n-1).times do |i|\n    next_term = xs.sum\n    xs[0]=xs[1]\n    xs[1]=next_term\n   end\n   return xs[1]\n end\n</code></pre>\n\n<p>I am pretty sure it has constant space complexity (its only stored data is in xs), and linear time complexity (it uses one loop to calculate the nth term of the sequence).</p>\n\n<p>My question is, is the function recursive? It uses values that it calculates to do more calculations, but never calls itself. My other question is, how do I get this same time-space compactness in Haskell? Haskell functions I have found either have space complexity greater than O(1), returning an entire list of terms, and/or they have time complexity greater than O(n) because they use the typical recursive definition.</p>\n\n<p>Any thoughts appreciated, thanks!</p>\n"}, {"tags": ["haskell", "monads", "optparse-applicative"], "comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1499022873, "post_id": 44873551, "comment_id": 76727056, "body": "Instead of <code>data Args = Args { input :: IO Handle }</code> perhaps you need <code>data Args = Args { input :: Maybe (IO Handle) }</code>?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1499051916, "post_id": 44873551, "comment_id": 76732862, "body": "The simplest possible solution is to replace <code>IO Handle</code> with <code>Maybe FilePath</code> and to read from the file after your program arguments have been parsed. Your parser becomes <code>Args &lt;$&gt; argument (Just &lt;$&gt; str) (value Nothing)</code>, and you are free to deal with the existence/non-existence of the file in any way you like in e.g. <code>main</code>. This logic is not part of a parser anyways, and the type of the parser reflects this. You can always make <code>input</code> a parameter (i.e. <code>data Args a = Args { input :: a }</code>) and have a function <code>Args FilePath -&gt; IO (Args Handle)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "edited": false, "score": 0, "creation_date": 1499558834, "post_id": 44877453, "comment_id": 76958559, "body": "I&#39;m willing to concede that what I&#39;m looking for is perhaps far fetched. I&#39;d argue however that  But just for the academic exercise of mucking with monads, are you saying that the type of <code>eitherReader</code> makes it impossible to do any other sort of monadic computation?"}, {"owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "reply_to_user": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "edited": false, "score": 1, "creation_date": 1499560653, "post_id": 44877453, "comment_id": 76958851, "body": "My comment was about what you should do, not what you could do. You should use a validation library to validate your data, then pass your validated data to functions that perform monadic computations. Don&#39;t try to needlessly force monadic computations inside your applicative validators. Remember, the library is based around applicative computations - not monadic ones; yet the behavior you want is fundamentally monadic (i.e. to perform certain computations in the case of certain values, other computations in the case of other values). That&#39;s really outside the purview of optparse-applicative."}], "tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": true, "score": 2, "last_activity_date": 1499053150, "creation_date": 1499053150, "answer_id": 44877453, "question_id": 44873551, "link": "https://stackoverflow.com/questions/44873551/handle-exception-from-openfile-in-a-optparse-applicative-readm/44877453#44877453", "title": "handle exception from openFile in a optparse-applicative ReadM", "body": "<p>I believe your approach is somewhat misguided.</p>\n\n<p>You said: <code>\"I'd like to have an optional argument, which should be a path to a file...\"</code></p>\n\n<p>Ok, so how about something along the lines of <code>Maybe FilePath</code>? That sounds like it might be what you want here. Or an equivalent ADT:</p>\n\n<pre><code>data Path = StandardInput | Path FilePath\n</code></pre>\n\n<p>When you say, <code>\"The obvious choice here is to make this argument type IO Handle and when an argument is passed in use openFile\"</code>\n you're getting ahead of yourself. </p>\n\n<p>Parsing from the command line should be about transforming the input to be parsed into data that's suitable for future use in your program. Don't worry about opening files at this stage, or handling exceptions if files don't exist, or any other ways in which you're going to <em>use</em> this data... Just worry about the question, did the user of my program give me a file path or not? That is, what data do I have? The other stuff is not (and should not be) <code>optparse-applicative</code>'s job.</p>\n\n<p>So just build your parser for this datatype <code>Path</code>. It may be composed of parsers for each constructor. E.g.:</p>\n\n<pre><code>stdInputParser :: Parser Path\nstdInputParser = ...\n\npathSuppliedParser :: Parser Path\npathSuppliedParser = ...\n\npathParser :: Parser Path\npathParser = pathSuppliedParser &lt;|&gt; stdInputParser\n</code></pre>\n\n<p>Anyway, once you run <code>execParser</code>, you'll be left with your <code>Path</code> datatype. So you'll pass that as the argument to your <code>run</code> function:</p>\n\n<pre><code>run :: Path -&gt; IO ()\nrun StandardInput = ... use stdin here\nrun (Path filePath) = ... use openFile here, catch and handle exceptions if the file doesn't exist, etc.\n</code></pre>\n"}], "owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 44877453, "answer_count": 1, "score": 1, "last_activity_date": 1499053150, "creation_date": 1499017383, "question_id": 44873551, "link": "https://stackoverflow.com/questions/44873551/handle-exception-from-openfile-in-a-optparse-applicative-readm", "title": "handle exception from openFile in a optparse-applicative ReadM", "body": "<p>Using optparse-applicative, I'd like to have an optional argument, which should be a path to a file, or when not specified, <code>stdin</code>. The obvious choice here is to make this argument type <code>IO Handle</code> and when an argument is passed in use <code>openFile</code>. Here's what I have currently:</p>\n\n<pre><code>module Main where\n\nimport Data.Semigroup ((&lt;&gt;))\nimport Options.Applicative\nimport System.IO\n\ndata Args = Args { input :: IO Handle }\n\nparseArgs = Args &lt;$&gt; argument parseReadHandle (value defaultHandle)\n  where defaultHandle = return stdin :: IO Handle\n\nparseReadHandle :: ReadM (IO Handle)\nparseReadHandle = eitherReader $ \\path -&gt; Right $ openFile path ReadMode\n\ngetArgs :: IO Args\ngetArgs = execParser $ info (parseArgs &lt;**&gt; helper) fullDesc\n\nmain :: IO ()\nmain = run =&lt;&lt; getArgs\n\nrun :: Args -&gt; IO ()\nrun (Args input) = putStrLn =&lt;&lt; hGetContents =&lt;&lt; input\n</code></pre>\n\n<p>The trouble with this is, we don't properly <code>handle</code> exceptions from <code>openFile</code> and instead rely on the default behavior for an unhandled exception (prints error and exits). This seems yucky.</p>\n\n<p>I think the more proper way would be to return <code>Left</code> with the error message from <code>openFile</code>. The trouble is, <code>eitherReader</code> expects a <code>String -&gt; Either String a</code> so we can't do something like:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\nimport Control.Exception\n\nparseReadHandle :: ReadM (IO Handle)\nparseReadHandle = eitherReader tryOpenFile\n\ntryOpenFile :: IO (Either String (IO Handle)) -&gt; FilePath\ntryOpenFile path = do\n  handle (\\(e :: IOException) -&gt; return $ Left $ show e) $ do\n    return $ Right $ openFile path ReadMode\n</code></pre>\n\n<p>Of course, you can see from the type of <code>tryOpenFile</code> that this won't typecheck. I'm unsure if what I'm asking for is possible, because it seems like the error message must be an <code>IO String</code>, because to get the error the IO computation must be performed. So at the least it seems you would need <code>eitherReader</code> to take a <code>String -&gt; IO (Either String a)</code> or a <code>String -&gt; Either (IO String) (IO Handle)</code>. From my basic understanding of them, it sounds like a monad transformer could be used here to wrap the ReadM (or the other way around?). But that's a bit deeper than my understanding goes, and I'm at a loss about how to precede.</p>\n\n<p>Is there a way to accomplish <code>handle</code>ing an <code>IOException</code> in an optparse-applicative <code>ReadM</code>?</p>\n"}, {"tags": ["windows", "haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1499012377, "post_id": 44872846, "comment_id": 76724132, "body": "Please show the exact line that leads to that error."}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1499012467, "post_id": 44872846, "comment_id": 76724164, "body": "@Carcigenicate thanks, I did."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1499012605, "post_id": 44872846, "comment_id": 76724203, "body": "What happens if you just paste this into a file and run it? <a href=\"https://repl.it/JKhB\" rel=\"nofollow noreferrer\">repl.it/JKhB</a> I seriously doubt this has anything to do with you needing to &quot;install more stuff&quot;. Last time I used Haskell, I just installed the compiler package, and it worked."}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1499012873, "post_id": 44872846, "comment_id": 76724284, "body": "@Carcigenicate    In this case, (after running !: ghc test.hs and :load test.hs) I need to type: main, then Car 32 would appear (successfully)! So, what&#39;s the problem?"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1499013055, "post_id": 44872846, "comment_id": 76724337, "body": "I don&#39;t know, because <code>data constructor not in scope: Car :: Integer -&gt; t</code> is a rather odd error. It leads me to believe you&#39;re missing some important information in the question."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1499015870, "post_id": 44872846, "comment_id": 76725094, "body": "Is that the entire contents of the file? I think you may need a <code>module</code> declaration first."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1499015872, "post_id": 44872846, "comment_id": 76725096, "body": "How is the module declared? I suspect that you must not be exporting the <code>Car</code> data constructor from your module."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1499016410, "post_id": 44872846, "comment_id": 76725234, "body": "What do you mean that you run <code>:! ghc test.hs</code> and <code>:! load test.hs</code>? From where? That doesn&#39;t look like valid Windows 7 commands."}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1499016594, "post_id": 44872846, "comment_id": 76725284, "body": "@MarkSeemann I put : main= print () in the file as well as: data Car = Car Int deriving (Show)."}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1499016661, "post_id": 44872846, "comment_id": 76725302, "body": "@MarkSeemann I ran :! ghc test.hs and :! load test.hs in prelude."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1499016708, "post_id": 44872846, "comment_id": 76725316, "body": "What do you mean by &quot;in prelude&quot;? Are you running in GHCI?"}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1499016824, "post_id": 44872846, "comment_id": 76725352, "body": "@MarkSeemann Yes, I am. I think in the question I mentioned that I&#39;m using GHCi."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1499016995, "post_id": 44872846, "comment_id": 76725398, "body": "Put <code>module Test (main, Car(Car)) where</code> at the top of your file."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1499017540, "post_id": 44872846, "comment_id": 76725548, "body": "What happens when you run <code>:! load test.hs</code>? <code>:!</code> means running an external program, in this case a program called <code>load</code>. There is, however, no <code>load</code> program on my Windows machine."}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1499018440, "post_id": 44872846, "comment_id": 76725782, "body": "@MarkSeemann I&#39;ve just tried:   :! load test.hs , it says: &#39;load&#39; is not recognized as an internal or external command."}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1499018553, "post_id": 44872846, "comment_id": 76725810, "body": "@4castle Yes, with module, thanks. I need to figure out how to change it when I have more data, e.g. Car, Bike, etc. But Thanks a lot."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1499019012, "post_id": 44872846, "comment_id": 76725941, "body": "Well, there you go, then: your code isn&#39;t loaded."}, {"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1499019242, "post_id": 44872846, "comment_id": 76726002, "body": "@MarkSeemann Thank you very much for the hints :)"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1499021531, "post_id": 44873824, "comment_id": 76726613, "body": "Thanks for the answer, but something important is missing in your answer which was @4castle comment: &quot;Put   module Test (main, Car(Car))    where at the top of your file&quot;"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "edited": false, "score": 0, "creation_date": 1499023848, "post_id": 44873824, "comment_id": 76727302, "body": "@4xx That would be an appropriate thing to do, but experimentation on my system shows that when you have the <code>main</code> function you wrote that you have, it&#39;s not <i>strictly</i> necessary."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 0, "last_activity_date": 1499019209, "creation_date": 1499019209, "answer_id": 44873824, "question_id": 44872846, "link": "https://stackoverflow.com/questions/44872846/step-by-step-installing-haskell-on-windows-7/44873824#44873824", "title": "Step by step installing Haskell on Windows 7", "body": "<p>Assuming that you're on a command line with <code>ghcii.sh</code> in <code>PATH</code>, start by running it and loading your file:</p>\n\n<pre><code>$ ghcii.sh\nGHCi, version 8.0.1: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :load test.hs\n[1 of 1] Compiling Main             ( 44872846.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; Car 32\nCar 32\n</code></pre>\n\n<p>When you're alread in GHCi, you don't need to run <code>ghc</code> as an external command, since you're already in an interactive Haskell environment.</p>\n\n<p>GHCi is only one of several programs included with GHC. It's a <a href=\"https://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop\" rel=\"nofollow noreferrer\">REPL</a>, used for interactive, ad-hoc testing.</p>\n\n<p>Another program included with GHC is <code>ghc.exe</code>. This is the compiler, which can turn your code into an <code>.exe</code> file.</p>\n"}], "owner": {"reputation": 159, "user_id": 8237830, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ee8cfbfaf68eb21e3587f7741f1e837b?s=128&d=identicon&r=PG&f=1", "display_name": "4xx", "link": "https://stackoverflow.com/users/8237830/4xx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 1, "accepted_answer_id": 44873824, "answer_count": 1, "score": -2, "last_activity_date": 1499019209, "creation_date": 1499012261, "last_edit_date": 1499012681, "question_id": 44872846, "link": "https://stackoverflow.com/questions/44872846/step-by-step-installing-haskell-on-windows-7", "title": "Step by step installing Haskell on Windows 7", "body": "<p>I'm aware of the following posts:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/42555250/installing-haskell-on-windows-cabal-config\">Installing Haskell on Windows, cabal config</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/42725607/how-to-modify-cabal-config-file-on-windows\">How to modify cabal config file on windows</a></p>\n\n<p>But they haven't been answered yet.</p>\n\n<hr>\n\n<p>I have installed Haskell framework (GHCi) from <a href=\"https://www.haskell.org/platform/windows.html\" rel=\"nofollow noreferrer\">here</a> on my Windows 7, but I'm still struggling with running simple files. For instance, I've saved this file in test.hs</p>\n\n<pre><code>data Car = Car Int deriving (Show)\n</code></pre>\n\n<p>Then I run :! ghc test.hs and then :! load test.hs. Both run without any error. But when I run:</p>\n\n<pre><code>Car 32\n</code></pre>\n\n<p>error like this appears:</p>\n\n<pre><code>data constructor not in scope: Car :: Integer -&gt; t\n</code></pre>\n\n<p>I think I need to install more stuff but I don't know what. </p>\n\n<p>I'm willing to use any other compilers, as long as they don't need any time consuming and complex configurations. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1499010469, "post_id": 44872452, "comment_id": 76723634, "body": "You may want to look at the type of <code>floor</code>. It may surprise you. You&#39;ll need to replace <code>floor ((y - x) &#47; dx) </code> with <code>fromInteger (floor ((y - x) &#47; dx))</code>."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1499011091, "post_id": 44872452, "comment_id": 76723797, "body": "@Alec Don&#39;t you mean <code>toInteger</code>?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "edited": false, "score": 0, "creation_date": 1499014318, "post_id": 44872452, "comment_id": 76724666, "body": "@AmiTavory Yes, Oops. :)"}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1499020969, "post_id": 44872452, "comment_id": 76726458, "body": "@Alec Not a big deal; it was an obvious typo."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8244645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2896afe9aac90fb0378bc4f5935f129d?s=128&d=identicon&r=PG&f=1", "display_name": "Newt", "link": "https://stackoverflow.com/users/8244645/newt"}, "edited": false, "score": 0, "creation_date": 1499011178, "post_id": 44872631, "comment_id": 76723819, "body": "Thank you! Can you please elaborate on the type of <code>floor</code>? I spent a good amount of time staring at:     <code>Prelude&gt; :t floor     floor :: (Integral b, RealFrac a) =&gt; a -&gt; b</code> yesterday so I&#39;m still pretty confused."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 33, "user_id": 8244645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2896afe9aac90fb0378bc4f5935f129d?s=128&d=identicon&r=PG&f=1", "display_name": "Newt", "link": "https://stackoverflow.com/users/8244645/newt"}, "edited": false, "score": 0, "creation_date": 1499011507, "post_id": 44872631, "comment_id": 76723909, "body": "Are you familiar with <code>typeclass</code>es? It is a <code>typeclass</code> which <code>Integer</code> and <code>Int</code> instantiate (see <a href=\"http://zvon.org/other/haskell/Outputprelude/Integral_c.html\" rel=\"nofollow noreferrer\">here</a>)."}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 3, "last_activity_date": 1499010754, "creation_date": 1499010754, "answer_id": 44872631, "question_id": 44872452, "link": "https://stackoverflow.com/questions/44872452/haskell-type-errors/44872631#44872631", "title": "Haskell type errors?", "body": "<p>This version compiles:</p>\n\n<pre><code>linspace :: Double -&gt; Double -&gt; Double -&gt; [Double]                                                                                                                   \nlinspace x dx y\n    | y' == y   = [x + (fromIntegral i) * dx | i &lt;- nums]\n    | otherwise = ([x + (fromIntegral i) * dx | i &lt;- nums] ++ [y])\n    where\n        n = toInteger $ floor ((y - x) / dx)\n        nums = [0..n]\n        y' = (x + (fromIntegral n) * dx)\n</code></pre>\n\n<p>What are the changes?</p>\n\n<ul>\n<li><p>As @Alec commented, while <code>floor</code> is <em>logically</em> an integer, it's type is not. You need to use <code>toInteger</code>.</p></li>\n<li><p>Following that, you need to use <code>fromIntegral</code> when multiplying <code>i</code> and `dex.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 748, "user_id": 7801892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9f87eb8937bf17dd8dee0658a4695d2?s=128&d=identicon&r=PG&f=1", "display_name": "Phil Kiener", "link": "https://stackoverflow.com/users/7801892/phil-kiener"}, "is_accepted": false, "score": 5, "last_activity_date": 1499011507, "creation_date": 1499011507, "answer_id": 44872728, "question_id": 44872452, "link": "https://stackoverflow.com/questions/44872452/haskell-type-errors/44872728#44872728", "title": "Haskell type errors?", "body": "<p>You have bound the result of <code>linspace</code> to be a <code>[Double]</code>, due to the type annotation. Therefore, <code>[x + i * dx | i &lt;- nums]</code> must produce such a list of <code>Double</code>s. <code>x</code> and <code>dx</code> are bound to be <code>Double</code> as they are parameters passed to the function, which are all declared as <code>Double</code>. But what about <code>i</code>? It stems from <code>nums</code>; to have <code>i</code> be a <code>Double</code>, <code>nums</code> must be a <code>[Double]</code>.</p>\n\n<p>Nums is defined as</p>\n\n<pre><code>nums = [0..n]\n</code></pre>\n\n<p>Okay, <code>nums</code> is a list alright. But a list of <em>what</em>? That depends on <code>n</code>; let's take a look!</p>\n\n<pre><code>n = floor ((y - x) / dx)\n</code></pre>\n\n<p><code>floor</code> takes, in a nutshell, your <code>Double</code> and produces an <code>Integral</code>. Therefore, <code>nums</code> is a list of integrals. This is the error you're getting: there is no instance of <code>Integral</code> for <code>Double</code>; there is no way for the types to work out nicely.</p>\n\n<p>To fix those errors, you have to make <code>n</code> a <code>Double</code>:</p>\n\n<pre><code>n = fromIntegral $ floor ((y - x) / dx)\n</code></pre>\n\n<p>As such, your definition of <code>y'</code> must be changed as well:</p>\n\n<pre><code>y' = x + n * dx\n</code></pre>\n\n<h1>In a nutshell</h1>\n\n<pre><code>linspace :: Double -&gt; Double -&gt; Double -&gt; [Double]\nlinspace x dx y\n    | y' == y   = [x + i * dx | i &lt;- nums]\n    | otherwise = ([x + i * dx | i &lt;- nums] ++ [y])\n    where\n        n = fromIntegral $ floor ((y - x) / dx)\n        nums = [0.. n]\n        y' = (x + n * dx)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8244645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2896afe9aac90fb0378bc4f5935f129d?s=128&d=identicon&r=PG&f=1", "display_name": "Newt", "link": "https://stackoverflow.com/users/8244645/newt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "accepted_answer_id": 44872631, "answer_count": 2, "score": 3, "last_activity_date": 1544984784, "creation_date": 1499009522, "last_edit_date": 1544984784, "question_id": 44872452, "link": "https://stackoverflow.com/questions/44872452/haskell-type-errors", "title": "Haskell type errors?", "body": "<p>I'm really new to Haskell, and it's giving me quite a time. I was trying to write a basic function similar to 'linspace' in Matlab but the compiler seems to reject the idea that 'floor' produces an Integral type. My code:</p>\n\n<pre><code>linspace :: Double -&gt; Double -&gt; Double -&gt; [Double]\nlinspace x dx y\n    | y' == y   = [x + i * dx | i &lt;- nums]\n    | otherwise = ([x + i * dx | i &lt;- nums] ++ [y])\n    where\n        n = floor ((y - x) / dx)\n        nums = [0..n]\n        y' = (x + (fromIntegral n) * dx)\n</code></pre>\n\n<p>Which produces an error in ghci:</p>\n\n<pre><code>maths.hs:8:21: error:\n    * No instance for (Integral Double) arising from a use of `floor'\n    * In the expression: floor ((y - x) / dx)\n      In an equation for `n': n = floor ((y - x) / dx)\n      In an equation for `linspace':\n          linspace x dx y\n            | y' == y = [x + i * dx | i &lt;- nums]\n            | otherwise = ([x + i * dx | i &lt;- nums] ++ [y])\n            where\n                n = floor ((y - x) / dx)\n                nums = [0 .. n]\n                y' = (x + (fromIntegral n) * dx)\n\nmaths.hs:10:28: error:\n    * No instance for (Integral Double)\n        arising from a use of `fromIntegral'\n    * In the first argument of `(*)', namely `(fromIntegral n)'\n      In the second argument of `(+)', namely `(fromIntegral n) * dx'\n      In the expression: (x + (fromIntegral n) * dx)\nFailed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["haskell", "generics"], "answers": [{"comments": [{"owner": {"reputation": 1168, "user_id": 1784261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b48c91bf6b6f0bfd0fda50625598656?s=128&d=identicon&r=PG", "display_name": "kakigoori", "link": "https://stackoverflow.com/users/1784261/kakigoori"}, "edited": false, "score": 0, "creation_date": 1499029724, "post_id": 44873550, "comment_id": 76728848, "body": "Sorry, realized that the question in my title is wholly different from the content of the body, but then I found that since I only call my method with data types, I could get away with less hacky solutions. Thanks! I have my repo here where I&#39;m now trying to convert the ExtractFields instances to SOP here: <a href=\"https://github.com/justinwoo/godawful-purescript-codegen-demo\" rel=\"nofollow noreferrer\">github.com/justinwoo/godawful-purescript-codegen-demo</a>"}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": true, "score": 2, "last_activity_date": 1499017378, "creation_date": 1499017378, "answer_id": 44873550, "question_id": 44872179, "link": "https://stackoverflow.com/questions/44872179/how-to-get-the-datatype-info-from-a-type-after-sop-representation-conversion/44873550#44873550", "title": "How to get the Datatype Info from a type after SOP representation conversion?", "body": "<p>You can get the top-level constructor name of a value using generics-sop as follows:</p>\n\n<pre><code>constructor ::\n  forall a .\n  (Generic a, HasDatatypeInfo a) =&gt; a -&gt; String\nconstructor a =\n  hcollapse $\n  hzipWith\n    (\\ con _args -&gt; K (constructorName con))\n    (constructorInfo (datatypeInfo (Proxy @a)))\n    (unSOP $ from a)\n</code></pre>\n\n<p>Here, <code>constructorInfo ...</code> gives you a product containing all constructor names of the datatype in question. the <code>hzipWith</code> call then selects the constructor that the given value <code>a</code> belongs to.</p>\n\n<p>Examples:</p>\n\n<pre><code>GHCi&gt; constructor True\n\"True\"\nGHCi&gt; constructor (Just 3)\n\"Just\"\nGHCi&gt; constructor [1,2,3]\n\":\"\n</code></pre>\n\n<p>Unfortunately, it's not entirely clear to me what you want to do with list types, so I cannot show how to combine this with the code you already have.</p>\n"}], "owner": {"reputation": 1168, "user_id": 1784261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b48c91bf6b6f0bfd0fda50625598656?s=128&d=identicon&r=PG", "display_name": "kakigoori", "link": "https://stackoverflow.com/users/1784261/kakigoori"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 44873550, "answer_count": 1, "score": 3, "last_activity_date": 1499017378, "creation_date": 1499007671, "question_id": 44872179, "link": "https://stackoverflow.com/questions/44872179/how-to-get-the-datatype-info-from-a-type-after-sop-representation-conversion", "title": "How to get the Datatype Info from a type after SOP representation conversion?", "body": "<p>I'm trying to do some shallow printing on datatype names but I'm not sure how to do this with Generics-SOP.</p>\n\n<p>For the cases where I have a List of my newtype, I can print out what I need fairly easily:</p>\n\n<pre><code>class GTypeName f where\n  gtypeName :: g f -&gt; String\n\ninstance (HasDatatypeInfo a) =&gt; GTypeName (SOP I ('[ '[], '[a, [a]] ])) where\n  gtypeName _ = \"(Array \" ++ name ++ \")\"\n    where\n      name = datatypeName $ datatypeInfo (Proxy @ a)\n</code></pre>\n\n<p>As you can see, I'm matching on the List kind and using the inner <code>a</code>'s Datatype Info to get the name out. But I don't know how to handle the case where I want to get the actual top level constructor name itself.</p>\n\n<p>In GHC Generics I did the following:</p>\n\n<pre><code>instance (GTypeName f) =&gt; GTypeName (D1 m f) where -- peer inside\n  gtypeName _ = gtypeName (Proxy @ f)\n\n-- go into the Cons constructed type\ninstance {-# OVERLAPPING #-} (GTypeName f) =&gt; GTypeName (C1 ('MetaCons \":\" g s) f) where\n  gtypeName _ = gtypeName (Proxy @ f)\n\n-- return the constructor name here\ninstance (KnownSymbol n) =&gt; GTypeName (C1 ('MetaCons n g s) f) where\n  gtypeName _ = symbolVal (Proxy @ n)\n\n-- take the left side, as this is the result of a type product from Cons\ninstance (GTypeName a) =&gt; GTypeName (a :*: b) where\n  gtypeName _ =\n    gtypeName (Proxy @ a)\n\n-- match on array and take it out here\ninstance (GTypeName b) =&gt; GTypeName ((C1 ('MetaCons \"[]\" g s) f) :+: b) where\n  gtypeName _ = \"(Array \" ++ gtypeName (Proxy @ b) ++ \")\"\n</code></pre>\n\n<p>This is ultimately used with a newtype and some data types like so:</p>\n\n<pre><code>newtype Status = Status Text\n\nnewtype OpenRequest = OpenRequest\n  { path :: Path\n  }\n\ndata Route req res = Route\n  { method :: Method\n  , url :: Url\n  }\n\nopen :: Route OpenRequest Success\nopen = Route {method = POST, url = Url \"/api/open\"}\n</code></pre>\n"}, {"tags": ["haskell", "quicksort", "elm"], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 2, "last_activity_date": 1499029149, "creation_date": 1499029149, "answer_id": 44875158, "question_id": 44871349, "link": "https://stackoverflow.com/questions/44871349/elm-quicksort-visualization/44875158#44875158", "title": "Elm quicksort visualization", "body": "<p>If you are trying to get that kind of output, direct recursion inside the view isn't going to work well. Instead, I would approach it as writing a variation of quicksort which logs the state along the way.</p>\n\n<p>Here is an example of quicksort which also returns a list of logs. The type aliases are included to try and make the function annotation more clear:</p>\n\n\n\n<pre class=\"lang-elm prettyprint-override\"><code>type alias Depth =\n    Int\n\n\ntype alias Log comparable =\n    ( Depth, List comparable, comparable, List comparable )\n\n\nquicksortLog : Depth -&gt; List comparable -&gt; ( List comparable, List (Log comparable) )\nquicksortLog depth list =\n    case list of\n        [] -&gt;\n            ( [], [] )\n\n        x :: xs -&gt;\n            let\n                ( lower, lowerLog ) =\n                    quicksortLog (depth + 1) (List.filter ((&gt;=) x) xs)\n\n                ( higher, higherLog ) =\n                    quicksortLog (depth + 1) (List.filter ((&lt;) x) xs)\n\n                log =\n                    ( depth, lower, x, higher )\n            in\n                ( lower ++ [ x ] ++ higher, log :: lowerLog ++ higherLog )\n</code></pre>\n\n<p>Given that result, you could then write a view which displays the data in the way you see fit.</p>\n"}], "owner": {"reputation": 3, "user_id": 8244284, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76e9a012e61c4a341cc9271e5e5700a9?s=128&d=identicon&r=PG&f=1", "display_name": "samd9827359823", "link": "https://stackoverflow.com/users/8244284/samd9827359823"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 44875158, "answer_count": 1, "score": 0, "last_activity_date": 1499029149, "creation_date": 1499002324, "question_id": 44871349, "link": "https://stackoverflow.com/questions/44871349/elm-quicksort-visualization", "title": "Elm quicksort visualization", "body": "<p>I'm trying to display the sorting process of quicksort with Elm</p>\n\n<pre><code>[ 5, 8, 6, 2, 4, 1, 0, 3, 10, 7, 9 ]\n[2,4,1,0,3]      5      [8,6,10,7,9]\n[1,0] 2 [4,3]         [6,7] 8 [10,9]\n[ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 ]\n</code></pre>\n\n<p>Right now i can get the first 2 lines but I'm unsure how to approach this in a recursive manner.</p>\n\n<pre><code>list_to_html : List (List Int) -&gt; Html msg\nlist_to_html x =\n    div [] [ x |&gt; toString |&gt; text ]\n\nquicksort_partition : List Int -&gt; Html msg\nquicksort_partition list =\n    case list of\n        x :: xs -&gt;\n            let\n                lower =\n                    List.filter ((&gt;=) x) xs\n\n                higher =\n                    List.filter ((&lt;) x) xs\n            in\n            list_to_html [ lower, [ x ], higher ]\n\n        [] -&gt;\n            list_to_html []\n</code></pre>\n\n<p>This outputs:</p>\n\n<pre><code>[ 5, 8, 6, 2, 4, 1, 0, 3, 10, 7, 9 ]\n[2,4,1,0,3]     [5]     [8,6,10,7,9]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 2, "creation_date": 1498994699, "post_id": 44870150, "comment_id": 76719190, "body": "<a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Concurrent.html#v:forkIO\" rel=\"nofollow noreferrer\">forkIO</a> or <a href=\"https://hackage.haskell.org/package/async-2.1.1.1/docs/Control-Concurrent-Async.html#v:withAsync\" rel=\"nofollow noreferrer\">withAsync</a>, then <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Concurrent.html#v:threadDelay\" rel=\"nofollow noreferrer\">threadDelay</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1499008027, "post_id": 44870745, "comment_id": 76722877, "body": "Here you&#39;re explicitly calling <code>forkIO</code> twice; is the initial <code>forkIO</code> necessary?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1499012903, "post_id": 44870745, "comment_id": 76724301, "body": "@George I recommend Simon Marlow&#39;s &quot;Parallel and Concurrent Haskell&quot; <a href=\"http://chimera.labs.oreilly.com/books/1230000000929\" rel=\"nofollow noreferrer\">chimera.labs.oreilly.com/books/1230000000929</a> . You can probably start with chapter 7 to get a basic overview of threads, etc"}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1499013007, "post_id": 44870745, "comment_id": 76724327, "body": "@jberryman: Thanks for the recommendation. Is there anything dated in that book I should look out for?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1499025627, "post_id": 44870745, "comment_id": 76727748, "body": "No I don&#39;t think so."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 3, "last_activity_date": 1498997989, "creation_date": 1498997989, "answer_id": 44870745, "question_id": 44870150, "link": "https://stackoverflow.com/questions/44870150/how-to-deploy-an-io-function-every-5-minutes-w-o-blocking-haskell/44870745#44870745", "title": "How to Deploy an IO Function every 5 Minutes w/o Blocking (Haskell)?", "body": "<p>This could be done by starting a thread that repeatedly</p>\n\n<ol>\n<li>starts another thread that just runs <code>slowBlockingFunction</code>, then</li>\n<li>sleeps for 5 minutes and repeats.</li>\n</ol>\n\n<p>Like this:</p>\n\n<pre><code>import Control.Concurrent\n\nrepeatedlyDoSlowStuffInBackground = forkIO doStuff\n    where\n    doStuff = do\n        forkIO slowBlockingFunction\n        threadDelay (1000 * 1000 * 60 * 5)\n        doStuff\n</code></pre>\n\n<p>Then you just call <code>repeatedlyDoSlowStuffInBackground</code> somewhere once.</p>\n\n<p>Note that this does not compensate for variable delays. E.g. it's possible for the thread to be delayed due to system load by, say, 2 seconds, in which case it's going to sleep for an additional 5 minutes instead of compensating by only sleeping for 4 minutes 58 seconds.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498997989, "creation_date": 1498993737, "last_edit_date": 1498994385, "question_id": 44870150, "link": "https://stackoverflow.com/questions/44870150/how-to-deploy-an-io-function-every-5-minutes-w-o-blocking-haskell", "title": "How to Deploy an IO Function every 5 Minutes w/o Blocking (Haskell)?", "body": "<p><strong>Context:</strong> I have a simple IO function called <code>slowBlockingFunction</code> which sends a payload of data to a server. The problem is this function is slow and blocking, and I otherwise need real-time performance for the rest of my program.</p>\n\n<p><strong>Question:</strong> Is there way to repeatedly call <code>slowBlockingFunction</code> every 5 minutes in an async fashion (so it doesn't interfere with the other realtime performing code by blocking)? I suppose this would be moving it to a new thread somehow?</p>\n"}, {"tags": ["haskell", "recursion", "fold", "language-features", "haskell-prelude"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1498990433, "post_id": 44869082, "comment_id": 76718069, "body": "Why do <code>foldr (flip f)</code> and <code>foldl</code> always  yield the same result for the non-commutative <code>-</code> operation, but <code>foldl (flip f)</code>/<code>foldr</code> do not?"}, {"owner": {"reputation": 438, "user_id": 3739851, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bP6eh.jpg?s=128&g=1", "display_name": "isaacg", "link": "https://stackoverflow.com/users/3739851/isaacg"}, "edited": false, "score": 2, "creation_date": 1498999600, "post_id": 44869082, "comment_id": 76720455, "body": "@ftor Because <code>-</code> follows the identity <code>(a-b)-c = (a-c)-b</code>. In general, all four results may be different, but not with <code>-</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1499025035, "post_id": 44869082, "comment_id": 76727592, "body": "@ftor, there is a general identity of that nature: <code>foldl f b xs = foldr (flip f) b (reverse xs)</code>. For finite lists, it&#39;s also true that <code>foldr c n xs = foldl (flip c) n (reverse xs)</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1499025180, "post_id": 44869082, "comment_id": 76727619, "body": "Another one that always holds: <code>foldr c n (reverse xs) = foldl (flip c) n xs</code>."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 17, "last_activity_date": 1499021946, "last_edit_date": 1499021946, "creation_date": 1498985902, "answer_id": 44869082, "question_id": 44869048, "link": "https://stackoverflow.com/questions/44869048/the-missing-folds/44869082#44869082", "title": "The missing folds", "body": "<p><code>foldrl</code> and <code>foldlr</code> don't add any expressive power: they are just the same as the other two folds but with the folding function flipped. </p>\n\n<pre><code>foldrl f = foldr (flip f)\nfoldlr f = foldl (flip f)\n\n-- Or this, if you prefer\nfoldrl = foldr . flip\nfoldlr = foldl . flip\n</code></pre>\n\n<p>But it is not so easy to define <code>foldl</code> in terms of <code>foldr</code>, so providing them both is useful.</p>\n"}], "owner": {"reputation": 962, "user_id": 4921099, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aqAiW.png?s=128&g=1", "display_name": "martin", "link": "https://stackoverflow.com/users/4921099/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "accepted_answer_id": 44869082, "answer_count": 1, "score": 9, "last_activity_date": 1512973984, "creation_date": 1498985678, "last_edit_date": 1512973984, "question_id": 44869048, "link": "https://stackoverflow.com/questions/44869048/the-missing-folds", "title": "The missing folds", "body": "<p>If you want to fold a list, I see four ways to do it. </p>\n\n<h3>Fold from the right of the list, with the recursive term on the right</h3>\n\n<blockquote>\n  <p>foldrr (-) 100 [1..10] = 1 - (2 - (3 - (4 - (5 - (6 - (7 - (8 - (9 - (10 - (100))))))))))  = 95</p>\n</blockquote>\n\n<pre><code>foldrr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldrr step zero (x:xs) = step x (foldrr step zero xs)\nfoldrr _    zero []     = zero\n</code></pre>\n\n<h3>Fold from the right of the list, with the recursive term on the left</h3>\n\n<blockquote>\n  <p>foldrl (-) 100 [1..10] = ((((((((((100) - 10) - 9) - 8) - 7) - 6) - 5) - 4) - 3) - 2) - 1 = 45</p>\n</blockquote>\n\n<pre><code>foldrl :: (a -&gt; b -&gt; a) -&gt; a -&gt; [b] -&gt; a\nfoldrl step zero (x:xs) = step (foldrl step zero xs) x\nfoldrl _    zero []     = zero\n</code></pre>\n\n<h3>Fold from the left of the list with the recursive term on the right</h3>\n\n<blockquote>\n  <p>foldlr (-) 100 [1..10] = 10 - (9 - (8 - (7 - (6 - (5 - (4 - (3 - (2 - (1 - (100)))))))))) = 105</p>\n</blockquote>\n\n<pre><code>foldlr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldlr step zero (x:xs) = foldlr step (step x zero) xs\nfoldlr _    zero []     = zero\n</code></pre>\n\n<h3>Fold from the left of the list with the recursive term on the left</h3>\n\n<blockquote>\n  <p>foldll (-) 100 [1..10] = ((((((((((100) - 1) - 2) - 3) - 4) - 5) - 6) - 7) - 8) - 9) - 10 = 45</p>\n</blockquote>\n\n<pre><code>foldll :: (a -&gt; b -&gt; a) -&gt; a -&gt; [b] -&gt; a\nfoldll step zero (x:xs) = foldll step (step zero x) xs\nfoldll _    zero []     = zero\n</code></pre>\n\n<hr>\n\n<p>Only two of these folds made it into Prelude as <code>foldr</code> and <code>foldl</code>. Was there any reason to just include two folds, and why those two?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8243542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762f9836689987c43c8f118ee7e6f629?s=128&d=identicon&r=PG&f=1", "display_name": "ggarcia.jr", "link": "https://stackoverflow.com/users/8243542/ggarcia-jr"}, "edited": false, "score": 0, "creation_date": 1498991939, "post_id": 44869115, "comment_id": 76718494, "body": "about the hamlet template, what I meant is, why we couldn&#39;t have something like: ` setPassWordLayout = &quot;my-custom-template&quot; `  Regarding: &quot;It is on this password reset page, where I define all my custom fields along with setting new password. I define my own handler for setting new password.&quot; so, your set password page (after registration) has extra fields? And so, you use a different route to process the form? given that <b>postPasswordR</b> cannot be rewritten in the instance of <code>YesodAuthEmail</code>"}, {"owner": {"reputation": 33, "user_id": 8243542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762f9836689987c43c8f118ee7e6f629?s=128&d=identicon&r=PG&f=1", "display_name": "ggarcia.jr", "link": "https://stackoverflow.com/users/8243542/ggarcia-jr"}, "edited": false, "score": 0, "creation_date": 1498992575, "post_id": 44869115, "comment_id": 76718661, "body": "I want to understand those reasons before changing <code>Yesod.Auth.Email</code> and open a PR. Because if I&#39;m taking this completely by the wrong side, then it is easier to change the way I&#39;m approaching the problem than the other way around."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 33, "user_id": 8243542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762f9836689987c43c8f118ee7e6f629?s=128&d=identicon&r=PG&f=1", "display_name": "ggarcia.jr", "link": "https://stackoverflow.com/users/8243542/ggarcia-jr"}, "edited": false, "score": 0, "creation_date": 1498995231, "post_id": 44869115, "comment_id": 76719318, "body": "@ggarcia.jr Yes, my set password page has all the extra fields like first name, last name etc. And yes, I use a different route and set the password accordingly (along with updating new fields in the password page)."}, {"owner": {"reputation": 590, "user_id": 3029543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100004855955180/picture?type=large", "display_name": "ptkato", "link": "https://stackoverflow.com/users/3029543/ptkato"}, "edited": false, "score": 0, "creation_date": 1515346969, "post_id": 44869115, "comment_id": 83257376, "body": "@Sibi, by &quot;my own handler&quot; do you mean creating a route separate from the subsite? If yes, what&#39;s the point of using the subsite then?"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 2, "last_activity_date": 1498986144, "creation_date": 1498986144, "answer_id": 44869115, "question_id": 44868821, "link": "https://stackoverflow.com/questions/44868821/custom-registration-form-with-yesod-auth-email/44869115#44869115", "title": "Custom registration form with Yesod.Auth.Email", "body": "<p>I'm not exactly aware of the design decisions made by Michael Snoyman on this, but my reasoning was that \"email\" is the minimal information required to register an account. Once you have registered your email, a registration link email is sent to your account through which you can verify your account. It is on this password reset page, where I define all my custom fields along with setting new password. I define my own handler for setting new password. The code usually goes something like this:</p>\n\n<pre><code>  if (jpNewPassword profile == jpConfirmPassword profile)\n    then do\n      newPass &lt;- liftIO $ saltPass (jpNewPassword profile)\n      lift $\n        runDB $\n        do user &lt;- getUser maid\n           update maid [UserPassword =. (Just newPass)]\n</code></pre>\n\n<p>The above is a code from one of my personal projects.</p>\n\n<blockquote>\n  <p>why we can't simply provide a custom hamlet file and be done with it?</p>\n</blockquote>\n\n<p>Well you can still provide a custom hamlet file. This is how my <code>setPasswordHandler</code> is defined in the instance of <code>YesodAuthEmail</code>:</p>\n\n<pre><code>  setPasswordHandler _ =\n    selectRep $\n    do provideRep $ return $(shamletFile \"./templates/password.shamlet\")\n</code></pre>\n\n<blockquote>\n  <p>Why Yesod.PasswordStore was not exposed? </p>\n</blockquote>\n\n<p>As explained above, you can still update the password without <code>Yesod.PasswordStore</code> being exposed. The <a href=\"https://www.stackage.org/haddock/lts-8.21/yesod-auth-1.4.17.2/Yesod-Auth-Email.html#v:saltPass\" rel=\"nofollow noreferrer\">relevant functions</a> are in <code>Yesod.Auth.Email</code> module.</p>\n\n<p>That being said, I can understand your concern. This is why I implemented JSON endpoints for all of the endpoints in <code>Yesod.Auth.Email</code> module so that validation and other stuffs can be easily done at client side itself. Those endpoints have been documented in the above linked Haddock page. But if you want to have custom fields in the registration page, I think it may involve some code change in <code>Yesod.Auth.Email</code> module. I would suggest you to open a issue in github (brownie points if you can also send a PR!) and give us the feedback there. We are very open to change!</p>\n"}], "owner": {"reputation": 33, "user_id": 8243542, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762f9836689987c43c8f118ee7e6f629?s=128&d=identicon&r=PG&f=1", "display_name": "ggarcia.jr", "link": "https://stackoverflow.com/users/8243542/ggarcia-jr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 2, "accepted_answer_id": 44869115, "answer_count": 1, "score": 3, "last_activity_date": 1498986144, "creation_date": 1498983951, "question_id": 44868821, "link": "https://stackoverflow.com/questions/44868821/custom-registration-form-with-yesod-auth-email", "title": "Custom registration form with Yesod.Auth.Email", "body": "<p>I have a question regarding why Yesod.Auth was done the way it was. I was trying to create a custom register form - i.e: more fields other than just email - and here are the issues I've encoutered along the way:</p>\n\n<ol>\n<li>I tried to create customized versions of functions defined in the Email module to render customized templates: <strong>defaultEmailLoginHandler</strong>, <strong>defaultRegisterHandler</strong>, <strong>defaultForgotPasswordHandler</strong>. </li>\n</ol>\n\n<p>And it kept me wondering: why we can't simply provide a custom hamlet file and be done with it? Why do I have to create custom versions of those functions?</p>\n\n<ol start=\"2\">\n<li>After the template part was done I moved to processing the forms, and here I hit the wall. I tried to create a custom version of the <strong>registerHelper</strong> function but, that is not a visible member of the Yesod.Auth.Email class\nso, creating a custom <strong>registerHelper</strong> won't work. Then I thought I could provide a custom route to process the form by rewriting <strong>postRegisterR</strong> and again I was out of luck. </li>\n</ol>\n\n<p>Why those functions, particularly <strong>registerHelper</strong>, were not created as visible members of Yesod.Auth.Email?</p>\n\n<ol start=\"3\">\n<li>My third attempt would be to \"fork\" the whole Email.hs module, but again I failed to meet some requirements to make this possible. In this case was the Yesod.PasswordStore that is not an exposed module, so I cannot import it into my custom Yesod.Auth.Email. </li>\n</ol>\n\n<p>Why <strong>Yesod.PasswordStore</strong> was not exposed? </p>\n\n<p>Given I don't want to go deeper into the rabbit hole and rewrite fork the PasswordStore, I just came to realize that it is not possible to have a custom registration form using Yesod.Auth.Email.</p>\n\n<p>Am I missing something here or I got this right? Why Yesod.Auth.Email was built in that way?</p>\n"}, {"tags": ["haskell", "polymorphism"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1498970901, "post_id": 44867311, "comment_id": 76714266, "body": "In the real case, can you change the first two types? If so, what about something like <code>data CreatureType = Dog | Person ;   data Creature = { cName :: !String, cAge :: !Int, cType :: CreatureType }</code>?"}, {"owner": {"reputation": 93, "user_id": 2713180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6386cff106a78e4d498c4c88ec4909fe?s=128&d=identicon&r=PG&f=1", "display_name": "m88", "link": "https://stackoverflow.com/users/2713180/m88"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1499024373, "post_id": 44867311, "comment_id": 76727442, "body": "I suppose that&#39;s the problem with contrived examples -- there are multiple data types and they are not as congruent as the ones listed."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 2713180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6386cff106a78e4d498c4c88ec4909fe?s=128&d=identicon&r=PG&f=1", "display_name": "m88", "link": "https://stackoverflow.com/users/2713180/m88"}, "edited": false, "score": 0, "creation_date": 1499022984, "post_id": 44868186, "comment_id": 76727089, "body": "So, this does away with the &quot;Creature&quot; type, which is an improvement.  I&#39;m wondering if there is a way to make the dispatcher more general."}, {"owner": {"reputation": 93, "user_id": 2713180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6386cff106a78e4d498c4c88ec4909fe?s=128&d=identicon&r=PG&f=1", "display_name": "m88", "link": "https://stackoverflow.com/users/2713180/m88"}, "edited": false, "score": 0, "creation_date": 1499024596, "post_id": 44868186, "comment_id": 76727494, "body": "Maybe so that I could do something like [ instance Animal Dog where animalName=&quot;dog&quot; ] and getAnimal  would resolve (perhaps with a few other functions dependant on &#39;name&#39;).  Then again, I&#39;m not sure if this is any better or more concise than just declaring getAnimal by hand....especially in an example with finite and clearly defined data types...."}, {"owner": {"reputation": 166, "user_id": 8242965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5724b2e35bafc1fbff7092793b3ffb4a?s=128&d=identicon&r=PG", "display_name": "user8242965", "link": "https://stackoverflow.com/users/8242965/user8242965"}, "reply_to_user": {"reputation": 93, "user_id": 2713180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6386cff106a78e4d498c4c88ec4909fe?s=128&d=identicon&r=PG&f=1", "display_name": "m88", "link": "https://stackoverflow.com/users/2713180/m88"}, "edited": false, "score": 0, "creation_date": 1499038118, "post_id": 44868186, "comment_id": 76730526, "body": "<code>instance Animal Dog where animalName=&quot;dog&quot;</code> will only get you<code>Animal a =&gt; a -&gt; String</code> which won&#39;t give you directly what you want. If you prefer to have universal dispatcher that works on arbitrary instance... Let&#39;s try some high energy magic...."}, {"owner": {"reputation": 93, "user_id": 2713180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6386cff106a78e4d498c4c88ec4909fe?s=128&d=identicon&r=PG&f=1", "display_name": "m88", "link": "https://stackoverflow.com/users/2713180/m88"}, "edited": false, "score": 0, "creation_date": 1499122269, "post_id": 44868186, "comment_id": 76767450, "body": "I did something else (see the update).  With the information that was given, however, this is a good answer."}], "tags": [], "owner": {"reputation": 166, "user_id": 8242965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5724b2e35bafc1fbff7092793b3ffb4a?s=128&d=identicon&r=PG", "display_name": "user8242965", "link": "https://stackoverflow.com/users/8242965/user8242965"}, "is_accepted": true, "score": 1, "last_activity_date": 1499038624, "last_edit_date": 1499038624, "creation_date": 1498978167, "answer_id": 44868186, "question_id": 44867311, "link": "https://stackoverflow.com/questions/44867311/haskell-type-polymorphism-mapping-to-string/44868186#44868186", "title": "Haskell Type Polymorphism -- Mapping to String", "body": "<p>If what you want to consume at the end is json value - it might make sense to\nrepresent result as json value using aeson library:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n\nimport Data.Aeson\nimport GHC.Generics\n\ndata Dog = Dog Int String deriving (Show, Generic)\ndata Cat = Cat Int String deriving (Show, Generic)\n\n-- here I'm using instance derived with generics, but you can write one by\n-- hands\ninstance ToJSON Dog\ninstance ToJSON Cat\n\n-- actions to get stuff from db\ngetDog :: Monad m =&gt; Int -&gt; m Dog\ngetDog i = return (Dog i (show i))\n\ngetCat :: Monad m =&gt; Int -&gt; m Cat\ngetCat i = return (Cat i (show i))\n\n-- dispatcher - picks which action to use\ngetAnimal :: Monad m =&gt; String -&gt; Int -&gt; m (Maybe Value)\ngetAnimal \"dog\" i = Just . toJSON &lt;$&gt; getDog i\ngetAnimal \"cat\" i = Just . toJSON &lt;$&gt; getCat i\ngetAnimal _ _ = return Nothing\n\n\nmain :: IO ()\nmain = do\n    getAnimal \"dog\" 2 &gt;&gt;= print\n    getAnimal \"cat\" 3 &gt;&gt;= print\n    getAnimal \"chupakabra\" 12 &gt;&gt;= print\n</code></pre>\n\n<p>High energy magic version</p>\n\n<pre><code>class Monad m =&gt; MonadAnimal m where\n    -- basically you want something that fetches extra argumets from HTTP or\n    -- whatevere, perform DB query and so on.\n\nclass Animal a where\n    animalName :: Proxy a -&gt; String\n    animalGetter :: MonadAnimal m =&gt; m a\n\nlocateAnimals :: MonadAnimal m =&gt; Q [(String, m Value)]\nlocateAnimals -- implement using TH (reify function is your friend). It should look for\n-- all the animal instances in scope and make a list from them with serialized\n-- fetcher.\n\n-- with that in place dispatcher should be easy to implement\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 2713180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6386cff106a78e4d498c4c88ec4909fe?s=128&d=identicon&r=PG&f=1", "display_name": "m88", "link": "https://stackoverflow.com/users/2713180/m88"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 44868186, "answer_count": 1, "score": 1, "last_activity_date": 1499122757, "creation_date": 1498967759, "last_edit_date": 1499122757, "question_id": 44867311, "link": "https://stackoverflow.com/questions/44867311/haskell-type-polymorphism-mapping-to-string", "title": "Haskell Type Polymorphism -- Mapping to String", "body": "<p>I am new to Haskell, so maybe I am missing some fundamental concepts here (or maybe failed to find the appropriate extension). I was wondering if there was a way to optimize or further abstract the following scenario.  This code seems very redundant.</p>\n\n<p>Let's say I have the following data classes:</p>\n\n<pre><code>data Person = Person\n              { personName :: !String\n              , personAge  :: !Int\n              } deriving Show\n\ndata Dog = Dog\n           { dogName :: !String\n           , dogAge  :: !Int\n           } deriving Show\n</code></pre>\n\n<p>Let's say I have a service and I'm only concerned with outputing records as strings.  In reality, the strings will probably be JSON and the records fetched from the DB, but let's take a simpler case.  I basically need a URL token to fetch an appropriate object (say, the string \"dog\" will get me a Dog, or even just the Haskell \"show\" string, without expressly declaring it as (value)::Dog).</p>\n\n<p>I have attempted to implement this in several ways...the only thing that seems to work is the following:</p>\n\n<pre><code>data Creature =  DogC    Dog\n               | PersonC Person  \n               deriving Show\n\nfromString :: String -&gt; Maybe Creature\nfromString \"dog\" =    Just $ DogC    $ Dog \"muffin\" 8\nfromString \"person\" = Just $ PersonC $ Person \"John\" 22\nfromString   _    = Nothing\n\nmain :: IO ()\nmain = do\n       putStrLn $ show $ fromString \"dog\"\n</code></pre>\n\n<p>I'm not entirely fond of the new type, nor the list of fromString declarations.  And to benefit from the original data declarations, I would probably need to write a similarly tedious expression (eg, \"fromCreature\") to revert Creature back into my original types. This information might change, so I would probably need TH for a few of the declarations...</p>\n\n<p>Is there a way around some of this?  I fiddled with GADTs and classes, but both seemed to be dependent on type- rather than value- based polymorphism (A string identifier tends to cause issues with ambiguous instances).  It would be nice to map the constructor to a string (Say, with Data.Map), but constructors often have different kinds.</p>\n\n<p><strong>Update</strong></p>\n\n<p>So, I went with an approach that isn't exactly relevant to the question I had asked, but it may be useful to someone. I did want to maintain some record types, but most didn't add much value and were getting in my way. The steps I had followed went something like:</p>\n\n<ul>\n<li>Use a different/lower-level DB driver, that returns workable types (eg, [ColumnDef] and [[SQLValue]] instead of tuples and records...).</li>\n<li>Create ToJSON instances for SQLValue -- most of the types were covered, except a few ByteString types, and I had to handle the conversion of SQLNull to Null.  To maintain compatibility with some record types, my default handler looked like: <code>toJSON = genericToJSON defaultOptions { sumEncoding = UnTaggedValue}</code>  The untagged value should allow one to read the JSON into defined data types (eg, Dog / Person ) if desired....</li>\n<li>Given that column name is accessible from ColumnDef, I wrote an expression that zips [ColumnDef] and [SqlValue] to a list of Aeson-compatible key-value pairs, eg: <code>toJsPairs :: [ColumnDef] -&gt; [SqlValue] -&gt; [(Text,Value)]</code></li>\n<li>Then, I wrote an expression to fetch the JSON from a table name, which more or less serves as my \"universal dispatcher.\"  It references a list of authorized tables, so it's less crazy than it might sound.  </li>\n</ul>\n\n<p>The code looked a bit like this (using mysql-haskell). </p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport qualified Control.Applicative as App\nimport Database.MySQL.Base\nimport qualified System.IO.Streams as Streams\nimport Data.Aeson (FromJSON, ToJSON)\nimport Data.Aeson.Encode.Pretty (encodePretty)\nimport Data.Aeson.Types\nimport Data.Text.Encoding\nimport Data.String (fromString)\nimport Data.ByteString.Internal\nimport qualified Data.ByteString.Lazy.Internal as BLI\nimport Data.HashMap.Strict (fromList)\n\nappConnectInfo = defaultConnectInfo {\n                   ciUser = \"some_user\"\n                 , ciPassword = \"some_password\"\n                 , ciDatabase = \"some_db\"\n             }\n\ninstance FromJSON ByteString where\n  parseJSON (String s) = pure $ encodeUtf8 s\n  parseJSON _ = App.empty\n\ninstance ToJSON ByteString where\n    toJSON  = String . decodeUtf8 \n\ninstance ToJSON MySQLValue where\n    toJSON (MySQLNull) = Null\n    toJSON x = genericToJSON defaultOptions\n                       { sumEncoding = UntaggedValue } x \n\n-- This expression should fail on dimensional mismatch.\n-- It's stupidly lenient, but really dimensional mismatch should\n-- never occur...\n\ntoJsPairs :: [ColumnDef] -&gt; [MySQLValue] -&gt; [(Text,Value)]\ntoJsPairs [] _ = []\ntoJsPairs _ [] = []\ntoJsPairs (x:xs) (y:ys) = (txt x, toJSON y):toJsPairs xs ys\n                    where\n                         -- Implement any modifications to the key names here\n                         txt = decodeUtf8.columnName\n\nlistRecords :: String -&gt; IO BLI.ByteString \nlistRecords tbl = do\n    conn &lt;- connect appConnectInfo\n\n    -- This is clearly an injection vulnerability.\n    -- Implemented, however, the values for 'tbl' are intensely\n    -- vetted.  This is just an example.\n\n    (defs, is) &lt;- query_ conn $ fromString ( \"SELECT * FROM `\" ++ tbl ++ \"` LIMIT 100\")\n    rcrds &lt;- Streams.toList is\n    return $ encodePretty $ map (jsnobj defs) rcrds\n        where\n            jsnobj :: [ColumnDef] -&gt; [MySQLValue] -&gt; Value\n            jsnobj defs x = Object $ fromList $ toJsPairs defs x\n</code></pre>\n"}, {"tags": ["haskell", "servant"], "comments": [{"owner": {"reputation": 2890, "user_id": 3821009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8c7fb1f9e34d1b461b185b16dd447cad?s=128&d=identicon&r=PG&f=1", "display_name": "levant pied", "link": "https://stackoverflow.com/users/3821009/levant-pied"}, "edited": false, "score": 0, "creation_date": 1599665500, "post_id": 44865000, "comment_id": 112845269, "body": "A great article related to this: <a href=\"https://www.parsonsmatt.org/2017/04/26/basic_type_level_programming_in_haskell.html\" rel=\"nofollow noreferrer\">parsonsmatt.org/2017/04/26/&hellip;</a>"}, {"owner": {"reputation": 2890, "user_id": 3821009, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8c7fb1f9e34d1b461b185b16dd447cad?s=128&d=identicon&r=PG&f=1", "display_name": "levant pied", "link": "https://stackoverflow.com/users/3821009/levant-pied"}, "edited": false, "score": 0, "creation_date": 1599685399, "post_id": 44865000, "comment_id": 112853586, "body": "Another great article: <a href=\"https://diogocastro.com/blog/2018/10/17/haskells-kind-system-a-primer/\" rel=\"nofollow noreferrer\">diogocastro.com/blog/2018/10/17/haskells-kind-system-a-prime&zwnj;&#8203;r</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": false, "score": 11, "last_activity_date": 1498940369, "creation_date": 1498940369, "answer_id": 44865077, "question_id": 44865000, "link": "https://stackoverflow.com/questions/44865000/what-does-an-apostrophe-in-front-of-a-list-something-mean-in-haskell/44865077#44865077", "title": "What does an apostrophe in front of a list ( &#39;[Something] ) mean in Haskell?", "body": "<p>Quotes are used to distinguish type-level constructors vs. term-level constructors of promoted types.</p>\n\n<p>For instance:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n\ndata Which = One | Two\n\nmyPick :: Which -- Type\nmyPick = One\n\ntype MyPick :: Which -- Kind\ntype MyPick = 'One\n</code></pre>\n\n<p>By the way, the kind annotation <code>type MyPick :: Which</code> is not valid Haskell but it gives you an idea of the correspondence between the term and the type level. The closest you can get to this requires turning on another extension:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\ntype family MyPick :: Which where\n  MyPick = 'One\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1534058337, "post_id": 44865078, "comment_id": 90568693, "body": "(useful)?  <code>&#39;[JSON]</code> isn&#39;t a type at all, there shouldn&#39;t be any terms of this &quot;type&quot;."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1534063907, "post_id": 44865078, "comment_id": 90569775, "body": "@luqui Right. I probably was thinking about bottoms, which do not apply here. Fixed."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1534063707, "last_edit_date": 1534063707, "creation_date": 1498940371, "answer_id": 44865078, "question_id": 44865000, "link": "https://stackoverflow.com/questions/44865000/what-does-an-apostrophe-in-front-of-a-list-something-mean-in-haskell/44865078#44865078", "title": "What does an apostrophe in front of a list ( &#39;[Something] ) mean in Haskell?", "body": "<p>This is <code>DataKinds</code> in action, which:</p>\n\n<ul>\n<li>lifts values at the type level, and</li>\n<li>lifts types to the kind level</li>\n</ul>\n\n<p>This however causes confusion at the type level. Now, in types, <code>[X]</code> might either be <code>[X] :: *</code>, the list-of-<code>X</code> type, or instead we might have <code>[X] :: [T]</code> due to the lifting -- that is the value <code>[X]</code> (list containing only the single value <code>X</code>), with <code>X</code> of type <code>T</code>, lifted at the type level.</p>\n\n<p>To overcome this ambiguity, GHC requires a quote in front of lifted value constructors. So, we have <code>[X] :: *</code>, and <code>'[X] :: [T]</code>.</p>\n\n<p>Concretely, in your case, <code>Get '[JSON] [User]</code> involves both the list value <code>[JSON]</code> lifted to the type level, and the list type <code>[User]</code>. To better appreciate the difference, note that there are no terms of type <code>'[JSON]</code>, since this is not a list type. We could even have <code>Get '[JSON,JSON,JSON] [User]</code> as a well-kinded expression, or even <code>Get '[] [User]</code>. Instead, we can't have <code>Get '[JSON] [User,User]</code> since <code>[User,User]</code> is not a type.</p>\n\n<p>(The type <code>Get '[JSON,JSON,JSON] [User]</code>, even if it is valid, could not be meaningfully used by the Servant library. I have no idea of what that lifted list is used for in Servant.)</p>\n"}], "owner": {"reputation": 7435, "user_id": 4617597, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/b1Sdw.png?s=128&g=1", "display_name": "Marcelo Lazaroni", "link": "https://stackoverflow.com/users/4617597/marcelo-lazaroni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 974, "favorite_count": 1, "accepted_answer_id": 44865078, "answer_count": 2, "score": 12, "last_activity_date": 1534063707, "creation_date": 1498939715, "question_id": 44865000, "link": "https://stackoverflow.com/questions/44865000/what-does-an-apostrophe-in-front-of-a-list-something-mean-in-haskell", "title": "What does an apostrophe in front of a list ( &#39;[Something] ) mean in Haskell?", "body": "<p>I was reading the Servant <a href=\"http://haskell-servant.readthedocs.io/en/stable/tutorial/ApiType.html\" rel=\"noreferrer\">documentation</a> and came across this line:</p>\n\n<pre><code>type UserAPI = \"users\" :&gt; QueryParam \"sortby\" SortBy :&gt; Get '[JSON] [User]\n</code></pre>\n\n<p>What is the <code>'</code> doing to that list? </p>\n"}, {"tags": ["haskell", "version"], "comments": [{"owner": {"reputation": 1056, "user_id": 1268085, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ff2b99da4e49f13c53b2f718649fc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh Sajanikar", "link": "https://stackoverflow.com/users/1268085/yogesh-sajanikar"}, "edited": false, "score": 0, "creation_date": 1499315839, "post_id": 44861447, "comment_id": 76855809, "body": "On a related note (but not related to your question about sandbox), you can switch to stack and leave the resolution to stack LTS packages. It is much simpler packages already resolved by LTS."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 1, "last_activity_date": 1498930244, "last_edit_date": 1498930244, "creation_date": 1498922716, "answer_id": 44862568, "question_id": 44861447, "link": "https://stackoverflow.com/questions/44861447/recompile-module-haskell-conflict-versions-haskell/44862568#44862568", "title": "Recompile module Haskell - Conflict versions - Haskell", "body": "<p>Yes, you can re-install packages to depend on other, common, versions.  Make a cabal file for your project and build via the cabal library (using cabal-install or stack), cabal will ensure there is only one version of text installed that satisfies both scotty and cookie.</p>\n\n<p>If you want to resolve the situation more manually then consider re-installing cookie with a constraint on the text version.  For example:</p>\n\n<pre><code>ghc-pkg unregister cookie\ncabal install cookie --constraint='text == 1.2.2.2'\n</code></pre>\n\n<p>Or a middle ground, you could unregister both packages and install them at the same time so they implicitly get the same dependency resolution:</p>\n\n<pre><code>ghc-pkg unregister cookie\nghc-pkg unregister scotty\ncabal install cookie scotty\n</code></pre>\n\n<p>Notice that the unregistration process can break other packages so it might be a bit of a manual process. This is why it's best to use sandboxes, cabal new-build, or similar.</p>\n"}], "owner": {"reputation": 455, "user_id": 5252811, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/25f4662cd8d11abc2110cad00a9e2b52?s=128&d=identicon&r=PG&f=1", "display_name": "x4rkz", "link": "https://stackoverflow.com/users/5252811/x4rkz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 44862568, "answer_count": 1, "score": 0, "last_activity_date": 1498930244, "creation_date": 1498915411, "question_id": 44861447, "link": "https://stackoverflow.com/questions/44861447/recompile-module-haskell-conflict-versions-haskell", "title": "Recompile module Haskell - Conflict versions - Haskell", "body": "<p>I am using scotty and cookie, scotty uses text 1.2.2.2 and cookie text 1.2.2.1. Can I recompile cookie in order to use the newer version of text? \nIs there a way to include both version (I basically only need text to transform it into strings). Or how can I manage this version conflict in sandbox?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": true, "score": 1, "last_activity_date": 1498869546, "creation_date": 1498869546, "answer_id": 44856393, "question_id": 44856238, "link": "https://stackoverflow.com/questions/44856238/will-stack-yaml-of-library-ignored-in-main-program/44856393#44856393", "title": "Will stack.yaml of library ignored in main program?", "body": "<p>The one for your project is used. The packages and versions available to you are those available in the snapshot referred to by the resolver specified in your project's <code>stack.yaml</code>. You will have to set <code>extra-deps</code> if you want packages or versions not available in that snapshot. </p>\n"}], "owner": {"reputation": 957, "user_id": 5771245, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d4ff1986f900f764881c1862b5300a6d?s=128&d=identicon&r=PG&f=1", "display_name": "haskellHQ", "link": "https://stackoverflow.com/users/5771245/haskellhq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 44856393, "answer_count": 1, "score": 2, "last_activity_date": 1498869546, "creation_date": 1498867743, "question_id": 44856238, "link": "https://stackoverflow.com/questions/44856238/will-stack-yaml-of-library-ignored-in-main-program", "title": "Will stack.yaml of library ignored in main program?", "body": "<p>My main Haskell program has a <code>stack.yaml</code> file that specifies, among other things, a Stack resolver.</p>\n\n<p>The main program makes use of libraries that each have their own <code>stack.yaml</code> where different Stack resolvers are used.</p>\n\n<p>So the question is, when I compile my main program with <code>stack build</code>, which Stack resolver is actually used? Only the one for the main program, or all of them at once?</p>\n"}, {"tags": ["json", "http", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1498858276, "post_id": 44854937, "comment_id": 76690946, "body": "This compiled without error; however, my JSON POSTing still isn&#39;t being accepted by the host. It&#39;s unclear if it&#39;s related to this issue or something else entirely."}, {"owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 1, "creation_date": 1498858752, "post_id": 44854937, "comment_id": 76691112, "body": "The issue is that the JSON isn&#39;t being attached to the <code>data</code>query paramater to the endpoint URL, so that it shows up as <code>http:&#47;&#47;api.mixpanel.com&#47;track&#47;?data=&lt;...encoded JSON here...&gt;</code>. Am reading the docs to figure out that issue but I think you solved the B64 encoding issue."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "edited": false, "score": 0, "creation_date": 1498865090, "post_id": 44854937, "comment_id": 76692706, "body": "Ah so you don&#39;t want it in the body of the post, but in the querystring"}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 3, "last_activity_date": 1498857460, "creation_date": 1498857460, "answer_id": 44854937, "question_id": 44854803, "link": "https://stackoverflow.com/questions/44854803/encoding-json-as-base64-before-http-posting-it-in-haskell/44854937#44854937", "title": "Encoding JSON as Base64 Before HTTP POSTing It (in Haskell)", "body": "<p><code>B64.encode</code> <a href=\"https://hackage.haskell.org/package/base64-bytestring-1.0.0.1/docs/Data-ByteString-Base64.html\" rel=\"nofollow noreferrer\">here</a> is a function from strict <code>ByteString</code> to strict <code>ByteString</code> (you'll need to hover over the type name in the haddocks to see this if you're just browsing), while <code>Aeson.encode</code> returns a lazy bytestring (from the <code>Data.ByteString.Lazy</code> module). These are two distinct types although they have the same name.</p>\n\n<p>You probably have to do something like:</p>\n\n<pre><code>   ...\n   requestBody = RequestBodyLBS $ L8.fromStrict $ Data.Bytestring.Base64.encode (L8.toStrict $ encode requestObject)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": true, "score": 2, "last_activity_date": 1498932690, "creation_date": 1498932690, "answer_id": 44864016, "question_id": 44854803, "link": "https://stackoverflow.com/questions/44854803/encoding-json-as-base64-before-http-posting-it-in-haskell/44864016#44864016", "title": "Encoding JSON as Base64 Before HTTP POSTing It (in Haskell)", "body": "<p>I have two things to add to jberryman's answer.</p>\n\n<p>First, if (as it now appears) you're going to be putting this in a query string, you need to make sure you don't just use a base64 encoded bytestring, but instead use a base64 <em>url-encoded</em> bytestring. So don't use <code>Data.Bytestring.Base64</code> (as jberryman linked to), but rather <code>Data.Bytestring.Base64.URL</code> (<a href=\"https://hackage.haskell.org/package/base64-bytestring-1.0.0.1/docs/Data-ByteString-Base64-URL.html\" rel=\"nofollow noreferrer\">here</a>). </p>\n\n<p>Second, while he pointed you in the right direction on the Base64 encoding part, it seems you're still hung up on setting the querystring. For that, you should check out the <code>setQueryString</code> function in the <code>http-client</code> library you're already using (link <a href=\"https://hackage.haskell.org/package/http-client-0.5.4/docs/Network-HTTP-Client.html#v:setQueryString\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>That function has the signature:</p>\n\n<pre><code>setQueryString :: [(ByteString, Maybe ByteString)] -&gt; Request -&gt; Request\n</code></pre>\n\n<p>So if you're base64 encoded bytestring is built like this</p>\n\n<pre><code>let urlEncodedBytestring = Data.Bytestring.Base64.URL.encode . L8.toStrict $ encode requestObject\n</code></pre>\n\n<p>and if you're attemtping to set the <code>data</code> key in the querystring of your request, then you'll probably want:</p>\n\n<pre><code>let requestWithQueryStringSet = setQueryString [(\"data\", (Just urlEncodedBytestring))] request\n</code></pre>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 572, "favorite_count": 0, "accepted_answer_id": 44864016, "answer_count": 2, "score": 0, "last_activity_date": 1498932690, "creation_date": 1498856687, "question_id": 44854803, "link": "https://stackoverflow.com/questions/44854803/encoding-json-as-base64-before-http-posting-it-in-haskell", "title": "Encoding JSON as Base64 Before HTTP POSTing It (in Haskell)", "body": "<p><strong>Problem:</strong> I am attempting to POST some JSON to an HTTP endpoint that <em>only accepts Base64 encoding</em>.</p>\n\n<p><strong>Code Sample:</strong> Here is a code sample which successfully posts <em>without</em> Base64 encoding:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Lib where\n\nimport           Data.Aeson                 (encode, object, (.=))\nimport qualified Data.ByteString.Lazy.Char8 as L8\nimport           Network.HTTP.Client\nimport           Network.HTTP.Client.TLS\nimport           Network.HTTP.Types.Status  (statusCode)\nimport qualified Data.ByteString.Base64 as B64\n\npostJSON :: IO ()\npostJSON = do\n    manager &lt;- newManager tlsManagerSettings\n\n    -- Nested JSON object to POST:\n    let requestObject = object\n            [ \"event\" .= (\"App launched.\" :: String)\n            , \"properties\"  .=  object [  \"distinct_id\" .= (\"user\" :: String)\n                                       ,  \"token\"       .= (\"f793bae9548d8e123cef251fd81df487\" :: String)\n                                       ]\n            ]  \n    initialRequest &lt;- parseRequest \"http://api.mixpanel.com/track\"\n    let request = initialRequest\n            { method = \"POST\"\n            , requestBody = RequestBodyLBS $ encode requestObject\n            , requestHeaders =\n                [ (\"Content-Type\", \"application/json; charset=utf-8\")\n                ]\n            }\n\n    response &lt;- httpLbs request manager\n    putStrLn $ \"The status code was: \"\n            ++ show (statusCode $ responseStatus response)\n    L8.putStrLn $ responseBody response\n</code></pre>\n\n<p><strong>Attempt:</strong> In order to send the JSON as Base64 encoded, I tried replacing <code>requestBody = RequestBodyLBS $ encode requestObject</code> with <code>requestBody = RequestBodyLBS $ Data.Bytestring.Base64.encode (encode requestObject)</code>, but I get a type error. So how do I encode the JSON as Base64 for this HTTP POST?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1498841432, "post_id": 44851035, "comment_id": 76683620, "body": "Why not <code>cadr1 :: forall a n&#39;. Vec a (Succ (Succ n&#39;)) -&gt; a</code> ?"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1498843160, "post_id": 44851035, "comment_id": 76684386, "body": "Sounds like an excellent solution for that specific case. but I wonder if there are ways to remove/scope (via quantification) those names. Here I would like <code>n&#39;</code> to be scoped to this code. and since I intend to not use anything from it, its mere existence is fine. and it should not be &#39;ambiguous&#39; it GHC does not try to assign it to something out of its intended scope"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1498843691, "post_id": 44851035, "comment_id": 76684639, "body": "@chi i&#39;ll modify the question it&#39;s.. ambiguous :)"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 3, "creation_date": 1498847308, "post_id": 44851035, "comment_id": 76686386, "body": "Boolean type families are the #1 <a href=\"https://stackoverflow.com/q/37923470/1523776\">most</a> <a href=\"https://stackoverflow.com/q/38209817/1523776\">common</a>  <a href=\"https://stackoverflow.com/q/38290067/1523776\">antipattern</a> I see in Stack Overflow questions about dependently typed Haskell. <code>n ~ Succ (Succ n&#39;)</code> is a perfectly good constraint and is not ambiguous."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498848875, "post_id": 44851035, "comment_id": 76687107, "body": "@BenjaminHodgson :)) ok it&#39;s a outbreak. you seem to have a valid point for the BoolEq case, I was trying to come up with something simple where we <b>do</b> have a ambiguity, not trying to find ways to avoid it."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498849410, "post_id": 44851035, "comment_id": 76687369, "body": "@nicolas I see. The general remedy for this is &quot;use a better design&quot;, though that&#39;s not particularly useful advice, haha. The better design in question depends on the situation, of course. We&#39;d probably be able to give you more advice if the code in your question was more representative of the real-life code in which you&#39;re seeing this problem?"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498851714, "post_id": 44851035, "comment_id": 76688436, "body": "@BenjaminHodgson Thank you. I was more curious as to how such names are dealt with currently in haskell as of now. notably how to control their scope. but I guess that your answer of &quot;use a better design&quot; is saying nonetheless, like the AllowAmbiguousTypes pragma, or resorting to Singletons (afaik)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498859404, "post_id": 44851035, "comment_id": 76691305, "body": "Even if you enable <code>AllowAmbiguousTypes</code>, the <code>n&#39;</code> type parameter is entirely useless - types are erased at runtime, so there is absolutely no way to compute with it inside the body of <code>op</code>. You need a type class constraint on <code>n&#39;</code>, or a singleton storing its value, or something of the sort. You are probably thinking of something like the user calling e.g. <code>op @5</code> and getting a parametric function which always produces a vector of a least length <code>7</code>; but with the given type, you simply could not implement such a function."}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1498849302, "creation_date": 1498839901, "last_edit_date": 1592644375, "question_id": 44851035, "link": "https://stackoverflow.com/questions/44851035/type-parameter-in-context-which-cause-some-ambiguity", "title": "Type parameter in context which cause some ambiguity", "body": "<p>I have the following error for the <code>cadr1</code> below, which makes sense</p>\n<blockquote>\n<p>Could not deduce (BoolEq n ('Succ ('Succ n'0)) ~ 'True)</p>\n<p>from the context (BoolEq n ('Succ ('Succ n')) ~ 'True)</p>\n<p>The type variable \u2018n'0\u2019 is ambiguous</p>\n</blockquote>\n<pre><code>{-# LANGUAGE DataKinds      #-}\n{-# LANGUAGE GADTs          #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE RankNTypes     #-}\n{-# LANGUAGE TypeFamilies   #-}\n\nmodule DecidablePropositionalEquality where\n\n\ndata Nat = Zero | Succ Nat\n\ndata Vec :: * -&gt; Nat -&gt; * where\n  VNil  :: Vec a Zero\n  VCons :: a -&gt; Vec a n -&gt; Vec a (Succ n)\n\ntype family Greater (a:: Nat) (b:: Nat) :: Bool where\n  Greater Zero Zero = True\n  Greater Zero (Succ x) = False\n  Greater (Succ x) Zero = True\n  Greater (Succ a) (Succ b) = Greater a b\n\nop :: forall a n n'. (Greater n (Succ (Succ n')) ~ True) =&gt; Vec a n -&gt; a \nop v = undefined\n</code></pre>\n<p>I don't use <code>n'</code> at the definition site, so it is ambiguous.</p>\n<p>Is there anyway for me to existentially quantify over this <code>n'</code>, so that ghc does not try to assign it to some type, and fails as nothing ties it to anything ?</p>\n<p>More generally, how to control the scope of those type variables ?</p>\n<p><strong>edit</strong> : modified to remove Boolean type family</p>\n"}, {"tags": ["haskell", "type-families", "type-kinds"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1498834673, "post_id": 44849002, "comment_id": 76679457, "body": "Aren&#39;t things on the right side of the <code>::</code> for a type family kinds? So the first one (would) say &quot;kind t has sort k&quot; while the second one says &quot;type t has kind k&quot;?"}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1498835413, "post_id": 44849002, "comment_id": 76679882, "body": "With TypeInType it&#39;s all the same."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1498836142, "post_id": 44849002, "comment_id": 76680328, "body": "Perhaps <code>type family F (k :: Type) :: k -&gt; Type</code> is closer to what you want?"}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1498837646, "post_id": 44849002, "comment_id": 76681389, "body": "@chi Wow, of course. I have no idea why I over complicated that so much."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498858610, "post_id": 44849002, "comment_id": 76691064, "body": "Type families are not real &#39;functions&#39;. The 2nd type family does not have type <code>(k :: Type) -&gt; (t :: k) -&gt; Type</code>. In fact, it has no type which can be currently expressed in Haskell. The first type family is invalid because <code>(-&gt;) :: Type -&gt; Type -&gt; Type</code> but you&#39;ve explicitly declared <code>t :: k</code> and <code>k</code> (a fresh type variable) doesn&#39;t unify with <code>Type</code>. <code>(t :: Type) -&gt; Type</code> would be completely valid (and is equivalent to the type in the accepted answer)."}, {"owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498977508, "post_id": 44849002, "comment_id": 76715349, "body": "@user2407038 I&#39;m pretty sure (-&gt;) is polykinded."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1498838168, "creation_date": 1498838168, "answer_id": 44850554, "question_id": 44849002, "link": "https://stackoverflow.com/questions/44849002/type-family-forcing-parameter-to-have-the-kind/44850554#44850554", "title": "Type family forcing parameter to have the kind *", "body": "<p>There is no need to name <code>t</code> in the resulting type. You can can simply use</p>\n\n<pre><code>type family F (k :: Type) :: k -&gt; Type\n</code></pre>\n"}], "owner": {"reputation": 3975, "user_id": 1031627, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/yamFN.jpg?s=128&g=1", "display_name": "Luka Horvat", "link": "https://stackoverflow.com/users/1031627/luka-horvat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 44850554, "answer_count": 1, "score": 2, "last_activity_date": 1498838168, "creation_date": 1498833403, "last_edit_date": 1498834062, "question_id": 44849002, "link": "https://stackoverflow.com/questions/44849002/type-family-forcing-parameter-to-have-the-kind", "title": "Type family forcing parameter to have the kind *", "body": "<p>This simple code doesn't compile</p>\n\n<pre><code>import Data.Kind\ntype family F (k :: Type) :: (t :: k) -&gt; Type\n</code></pre>\n\n<p>The error message is</p>\n\n<pre><code>\u2022 Expected a type, but \u2018t\u2019 has kind \u2018k\u2019\n\u2022 In the kind \u2018(t :: k) -&gt; Type\u2019\n</code></pre>\n\n<p>I get in some sense that this actually defines a \"family of type families\" but I don't really understand why this limitation would exist.</p>\n\n<pre><code>type family F (k :: Type) (t :: k) :: Type\n</code></pre>\n\n<p>does work but it doesn't have the same semantics and can't be used the same.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1498825795, "post_id": 44845683, "comment_id": 76673328, "body": "Familiar with <code>future</code>/<code>promise</code> concepts? These are instances of more abstract <code>Monad</code> concept. Or take <code>map</code> function in JS or <code>Array.Select()</code> method in C#. These are examples of abstract pattern called <code>Functor</code>."}, {"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "edited": false, "score": 0, "creation_date": 1498826564, "post_id": 44845683, "comment_id": 76673837, "body": "<a href=\"https://redd.it/68nspj\" rel=\"nofollow noreferrer\">redd.it/68nspj</a> is probably related."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 1, "creation_date": 1498829152, "post_id": 44845683, "comment_id": 76675588, "body": "Since you talked about monoids: <code>[] ++ [7]</code>, <code>&quot;&quot; ++ &quot;foo&quot;</code>, <code>0 + 3</code>, <code>1 * 3</code>. Do you recognize the recurring, reliable trait? This is a pattern and it has a nice representation in math. Patterns are inherently abstract and to call them <i>abstract patterns</i> might be unnecessary."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 1, "creation_date": 1498830554, "post_id": 44847894, "comment_id": 76676630, "body": "I think typeclasses rather represent the notion of generalization, because they don&#39;t suppress details but define type constraints."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1498844938, "post_id": 44847894, "comment_id": 76685231, "body": "@ftor Type variables are the thing that generalises IMO. Typeclasses let us constrain that generalisation more or less. We can do the same thing with &quot;method dictionaries&quot;, though not as flexibly, so one <i>might</i> say that functions with type variables provide the most flexilibity in terms of abstraction? Typeclasses are definitely more convenient."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1498859218, "post_id": 44847894, "comment_id": 76691237, "body": "Agreed, parametric polymorphic functions are even more generalized than those with ad-hoc polymorphic behavior. I think polymorphism per se has the effect of generalization, whether constrained or unconstrained. Functions on the other hand abstract over expressions. So with polymorphic functions you have always both, abstraction (over expressions) and generalization (in their applicability) - at least this is my current understanding, which might change in the future :D"}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1498864003, "post_id": 44847894, "comment_id": 76692499, "body": "Yeah! parameterisation of any kind is abstraction. If I have an expression that represents printing the name &quot;Julian&quot; to the screen, then that&#39;s less flexible and abstract than if I write a function that takes <i>any</i> String and prints it to the screen. Types allow us to be more expressive, which lets us distinguish between things. Parameterised types allow us to maintain that specificity while also being general which gives us power. Fascinating isn&#39;t it!"}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1498864127, "post_id": 44847894, "comment_id": 76692524, "body": "The most interesting thing coming out of this, to me, is that while most &quot;modern&quot; languages are capable of being very very general, because they have these types that can effectively be any type, they&#39;re not capable of also being very expressive, while maintaining that generality, which takes away their power! (ie you can <i>do</i> less). So interesting."}], "tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": true, "score": 6, "last_activity_date": 1499073851, "last_edit_date": 1499073851, "creation_date": 1498829930, "answer_id": 44847894, "question_id": 44845683, "link": "https://stackoverflow.com/questions/44845683/what-are-abstract-patterns/44847894#44847894", "title": "What are abstract patterns?", "body": "<p>Abstract in this sense is the opposite of concrete. This is probably one of the key things to understand about Haskell.</p>\n\n<p>What is a concrete thing? Well, most values in Haskell are concrete. For example <code>'a' :: Char</code>. The letter 'a' is a Char value, and it's a concrete value. <code>Char</code> is a concrete type. But in <code>1 :: Num a =&gt; a</code>, the number <code>1</code> is actually a value of <strong>any</strong> type, so long as that type has the set of functions that the <code>Num</code> typeclass sets out as mandatory. This is an abstract value! We can have abstract values, abstract types, and therefore abstract functions. When the program is compiled, the Haskell compiler will pick a particular concrete value that supports all of our requirements.</p>\n\n<p>Haskell, at its core, has a very simple, small but incredibly flexible language. It's very similar to an expression of maths, actually. This makes it very powerful. Why? because most things that would be built in language constructs in other languages are not directly built into Haskell, but defined in terms of this simple core.</p>\n\n<p>One of the core pieces is the function, which, it turns out, most of computation is expressible in terms of. Because so much of Haskell is just defined in terms of this small simple core, it means we can extend it to almost anywhere we can imagine.</p>\n\n<p>Typeclasses are probably the best example of this. <code>Monoid</code>, and <code>Num</code> are examples of typeclasses. These are constructs that allow programmers to use an abstraction like a function across a great many types but only having to define it once. Typeclasses let us use the same function names across a whole range of types if we can define those functions for those types. Why is that important or useful? Well, if we can recognise a pattern across, for example, all numbers, and we have a mechanism for talking about all numbers in the language itself, then we can write functions that work with <strong>all numbers</strong> at once. This is an abstract pattern. You'll notice some Haskellers are quite interested in a branch of mathematics called Category Theory. This branch is pretty much the mathematical definition of abstract patterns. Contrast this ability to encode such things with the <em>inability</em> of other languages, where in other languages the patterns the community notice are often far less rigorous and have to be manually written out, and without any respect for its mathematical nature. The beauty of following the mathematics is the extremely large body of stuff we get for free by aligning our language closer with mathematics.</p>\n\n<p>This is a good explanation of these basics including typeclasses in a book that I helped author: <a href=\"http://www.happylearnhaskelltutorial.com/1/output_other_things.html\" rel=\"nofollow noreferrer\">http://www.happylearnhaskelltutorial.com/1/output_other_things.html</a></p>\n\n<p>Because functions are written in a very general way (because Haskell puts hardly any limits on our ability to express things generally), we can write functions that use types which express such things as \"any type, so long as it's a <code>Monoid</code>\". These are called type constraints, as above.</p>\n\n<p>Generally abstractions are very useful because we can, for example, write on single function to operate on an entire range of types which means we can often find functions that do exactly what we want on our types if we just make them instances of specific typeclasses. The <code>Ord</code> typeclass is a great example of this. Making a type we define ourselves an instance of <code>Ord</code> gives us a whole bunch of sorting and comparing functions for free.</p>\n\n<p>This is, in my opinion, one of the most exciting parts about Haskell, because while most other languages also allow you to be very general, they mostly take an extreme dip in how expressive you can be with that generality, so therefore also are less powerful. (This is because they are less precise in what they talk about, because their types are less well \"defined\").</p>\n\n<p>This is how we're able to reason about the \"possible values\" of a function, and it's not limited to Haskell. The more information we encode at the type level, the more toward the specificity end of the spectrum of expressivity we veer. For example, to take a classic case, the function <code>const :: a -&gt; b -&gt; a</code>. This function requires that <code>a</code> and <code>b</code> can be of absolutely any type at all, including the same type if we like. From that, because the second parameter <strong>can</strong> be a different type than the first, we can work out that it really only has one possible functionality. It can't return an <code>Int</code>, unless we <strong>give</strong> it an <code>Int</code> as its first value, because that's not <strong>any</strong> type, right? So therefore we know the only value it can return is the first value! The functionality is defined right there in the type! If that's not mindblowing, then I don't know what is. :)</p>\n\n<p>As we move to dependent types (that is, a type system where types are first class, which means also that ordinary values can be encoded in the type system), we can get closer and closer to having the type system specify specifically what the constraints of possible functionality are. However, the kicker is, it doesn't necessarily speak about the implementation of the functionality unless we want it to, because <strong>we're</strong> in control of how abstract it is, but while maintaining expressivity and much precision. That's pretty fascinating, and amazingly powerful.</p>\n\n<p>Much math can be expressed in the language that underpins Haskell, the lambda calculus.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 44847894, "answer_count": 1, "score": 3, "last_activity_date": 1499106557, "creation_date": 1498823112, "last_edit_date": 1499106557, "question_id": 44845683, "link": "https://stackoverflow.com/questions/44845683/what-are-abstract-patterns", "title": "What are abstract patterns?", "body": "<p>I am learning Haskell and trying to understand the Monoid typeclass.\nAt the moment, I am reading the haskellbook and it says the following about the pattern (monoid):  </p>\n\n<blockquote>\n  <p>One of the finer points of the Haskell community has been its\n  propensity for recognizing abstract patterns in code which have\n  well-defined, lawful representations in mathematics.  </p>\n</blockquote>\n\n<p>What does the author mean by <code>abstract patterns</code>?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1498835712, "post_id": 44845483, "comment_id": 76680059, "body": "All type information is erased during compilation: at runtime, values are not tagged in memory with their types, nor there is a representation of all the typeclass instances. This makes such checks impossible. If this information is needed, then the programmer must explicitly ask to keep it around, e.g. like Daniel Wagner does below with a custom class."}], "answers": [{"comments": [{"owner": {"reputation": 265, "user_id": 7430178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/phrjq.jpg?s=128&g=1", "display_name": "Diego Vicente", "link": "https://stackoverflow.com/users/7430178/diego-vicente"}, "edited": false, "score": 0, "creation_date": 1498835445, "post_id": 44847971, "comment_id": 76679900, "body": "I&#39;m not sure if I get it: I still don&#39;t know how to make an implementation of the  <code>Memorable</code> class of something as <code>Eq a</code>, which would let me generalize it. Is something like <code>instance Memorable (Eq a =&gt; a) where</code> possible?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 265, "user_id": 7430178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/phrjq.jpg?s=128&g=1", "display_name": "Diego Vicente", "link": "https://stackoverflow.com/users/7430178/diego-vicente"}, "edited": false, "score": 0, "creation_date": 1498835842, "post_id": 44847971, "comment_id": 76680144, "body": "@DiegoVicente If that were possible, you wouldn&#39;t need the <code>Memorable</code> type class. <code>Eq</code> simply does not carry enough information to perform the checks you want."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 265, "user_id": 7430178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/phrjq.jpg?s=128&g=1", "display_name": "Diego Vicente", "link": "https://stackoverflow.com/users/7430178/diego-vicente"}, "edited": false, "score": 0, "creation_date": 1498844451, "post_id": 44847971, "comment_id": 76685012, "body": "@DiegoVicente No, that&#39;s not possible (well, it is; but then you can&#39;t have any other instances). You have to write e.g. <code>instance Memorable Int where type Memory Int = EqMemory Int; remember = eqRemember; known = eqKnown</code> if you want <code>Int</code> to use the <code>Eq</code> instance for its memory. Yes, this means you have to duplicate all the instance declarations that already exist for <code>Ord</code>, <code>Hashable</code>, and <code>Eq</code> -- and this is why most people just pick either <code>Ord</code> or <code>Hashable</code> and run with it."}, {"owner": {"reputation": 265, "user_id": 7430178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/phrjq.jpg?s=128&g=1", "display_name": "Diego Vicente", "link": "https://stackoverflow.com/users/7430178/diego-vicente"}, "edited": false, "score": 0, "creation_date": 1498845428, "post_id": 44847971, "comment_id": 76685465, "body": "@DanielWagner oh, ok, now I get it! I thought it was a different workaround, didn&#39;t get the point at first. I think I&#39;ll then stick to the <code>Hashable</code> type, thank you!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1498830136, "creation_date": 1498830136, "answer_id": 44847971, "question_id": 44845483, "link": "https://stackoverflow.com/questions/44845483/checking-haskell-typeclasses-in-a-function/44847971#44847971", "title": "Checking Haskell typeclasses in a function", "body": "<p>No, you can't do this. However, you could make your own class:</p>\n\n<pre><code>class Memorable a where\n    type Memory a\n    remember :: a -&gt; Memory a -&gt; Memory a\n    known :: a -&gt; Memory a -&gt; Bool\n</code></pre>\n\n<p>Instantiate this class for a few base types, and add some default implementations for folks that want to add new instances, e.g.</p>\n\n<pre><code>-- suitable implementations of Memorable methods and type families for hashable things\ntype HashMemory = Data.HashSet.HashSet\nhashRemember = Data.HashSet.insert\nhashKnown = Data.HashSet.member\n\n-- suitable implementations for orderable things\ntype OrdMemory = Data.Set.Set\nordRemember = Data.Set.insert\nordKnown = Data.Set.member\n\n-- suitable implementations for merely equatable things\ntype EqMemory = Prelude.[]\neqRemember = (Prelude.:)\neqKnown = Prelude.elem\n</code></pre>\n"}], "owner": {"reputation": 265, "user_id": 7430178, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/phrjq.jpg?s=128&g=1", "display_name": "Diego Vicente", "link": "https://stackoverflow.com/users/7430178/diego-vicente"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 44847971, "answer_count": 1, "score": 2, "last_activity_date": 1498830136, "creation_date": 1498822371, "question_id": 44845483, "link": "https://stackoverflow.com/questions/44845483/checking-haskell-typeclasses-in-a-function", "title": "Checking Haskell typeclasses in a function", "body": "<p>If I wanted to perform a search on a problem space and I wanted to keep track of different states a node has already visited, I <a href=\"https://stackoverflow.com/questions/44636042/keep-record-of-previously-visited-states-when-searching\">several options to do it depending on the constraints of those states</a>. However; is there a way I can dispatch a function or another depending on the constraint of the states the user is using as input? For example, if I had:</p>\n\n<pre><code>data Node a = Node { state :: a, cost :: Double }\n</code></pre>\n\n<p>And I wanted to perform a search on a <code>Problem a</code>, is there a way I could check if <code>a</code> is <code>Eq</code>, <code>Ord</code> or <code>Hashable</code> and then call a different kind of search? In pseudocode, something like:</p>\n\n<pre><code>search :: Eq a =&gt; Problem a -&gt; Node a\nsearch problem@(... initial ...) -- Where initial is a State of type a\n  | (Hashable initial) = searchHash problem\n  | (Ord initial)      = searchOrd problem\n  | otherwise          = searchEq problem\n</code></pre>\n\n<p>I am aware I could just let the user choose one <code>search</code> or another depending on their own use; but being able to do something like that could be very handy for me since search is not really one of the user endpoints as such (one example could be a function <code>bfs</code>, that calls <code>search</code> with some parameters to make it behave like a Breadth-First Search).</p>\n"}, {"tags": ["haskell", "megaparsec"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1498810716, "post_id": 44841659, "comment_id": 76663760, "body": "I think this has been asked before, but don&#39;t know of a standard solution (I have once done this myself in a somewhat cumbersome way)."}], "answers": [{"comments": [{"owner": {"reputation": 1415, "user_id": 474491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba21053d650c48ca674e577b38a976aa?s=128&d=identicon&r=PG", "display_name": "Pierre Carbonnelle", "link": "https://stackoverflow.com/users/474491/pierre-carbonnelle"}, "edited": false, "score": 0, "creation_date": 1498832580, "post_id": 44844067, "comment_id": 76678011, "body": "Can&#39;t use makeExprParser, though, which is a pity, because it deals with operator precedence, ..."}], "tags": [], "owner": {"reputation": 1415, "user_id": 474491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba21053d650c48ca674e577b38a976aa?s=128&d=identicon&r=PG", "display_name": "Pierre Carbonnelle", "link": "https://stackoverflow.com/users/474491/pierre-carbonnelle"}, "is_accepted": true, "score": 2, "last_activity_date": 1498818051, "last_edit_date": 1498818051, "creation_date": 1498817743, "answer_id": 44844067, "question_id": 44841659, "link": "https://stackoverflow.com/questions/44841659/how-to-write-a-parser-that-does-not-consume-space/44844067#44844067", "title": "how to write a parser that does not consume space?", "body": "<p>I ended up writing parseLexeme, to replace lexeme in <a href=\"https://markkarpov.com/megaparsec/parsing-simple-imperative-language.html\" rel=\"nofollow noreferrer\">this tutorial</a></p>\n\n<pre><code>data Lexeme a = Lexeme a String -- String contains the spaces after the lexeme\n\nwhites :: Parser String\nwhites = many spaceChar\n\nparseLexeme :: Parser a -&gt; Parser (Lexeme a)\nparseLexeme p = do\n  value &lt;- p\n  w &lt;- whites\n  return $ Lexeme value w\n\ninstance PPrint a =&gt; PPrint (Lexeme a) where\n  pprint (Lexeme value w) = (pprint value) ++ w\n</code></pre>\n\n<p>The parser for identifier becomes :</p>\n\n<pre><code>data Identifier = Identifier (Lexeme String)\n\nparseIdentifier :: Parser Identifier\nparseIdentifier = do\n  v &lt;- parseLexeme $ (:) &lt;$&gt; letterChar &lt;*&gt; many (alphaNumChar &lt;|&gt; char '_')\n  return $ Identifier v\n\ninstance PPrint Identifier where\n  pprint (Identifier l) = pprint l\n</code></pre>\n"}], "owner": {"reputation": 1415, "user_id": 474491, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ba21053d650c48ca674e577b38a976aa?s=128&d=identicon&r=PG", "display_name": "Pierre Carbonnelle", "link": "https://stackoverflow.com/users/474491/pierre-carbonnelle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 44844067, "answer_count": 1, "score": 4, "last_activity_date": 1498818051, "creation_date": 1498810056, "question_id": 44841659, "link": "https://stackoverflow.com/questions/44841659/how-to-write-a-parser-that-does-not-consume-space", "title": "how to write a parser that does not consume space?", "body": "<p>I'm writing a program to modify source code files.  I need to parse the file (e.g. with megaparsec), modify its Abstract Syntax Tree AST (e.g. with Uniplate), and regenerate the file with as little changes as possible (e.g. preserving spaces, comments, ...).</p>\n\n<p>So, the AST should contain the spaces, for example :</p>\n\n<pre><code>data Identifier = Identifier String String\n</code></pre>\n\n<p>where the first string is the name of the identifier, and the second is the spaces after it.  The same applies for any symbol in the language.</p>\n\n<p>How can I write a parser for Identifier ?</p>\n"}, {"tags": ["haskell", "gcc", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 1168, "user_id": 1784261, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3b48c91bf6b6f0bfd0fda50625598656?s=128&d=identicon&r=PG", "display_name": "kakigoori", "link": "https://stackoverflow.com/users/1784261/kakigoori"}, "is_accepted": false, "score": 0, "last_activity_date": 1498801685, "creation_date": 1498801685, "answer_id": 44839385, "question_id": 44839260, "link": "https://stackoverflow.com/questions/44839260/gcc-exe-failed-in-phase-c-compiler-exit-code-1/44839385#44839385", "title": "`gcc.exe&#39; failed in phase `C Compiler&#39;. (Exit code: 1)", "body": "<p>Try doing 'stack setup--reinstall'. I had a similar message cleaned up this way.</p>\n"}], "owner": {"reputation": 69, "user_id": 7031226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/763e0cdaa2ef586815f61a0074638717?s=128&d=identicon&r=PG&f=1", "display_name": "Lin Baby", "link": "https://stackoverflow.com/users/7031226/lin-baby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 926, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1498801685, "creation_date": 1498801044, "question_id": 44839260, "link": "https://stackoverflow.com/questions/44839260/gcc-exe-failed-in-phase-c-compiler-exit-code-1", "title": "`gcc.exe&#39; failed in phase `C Compiler&#39;. (Exit code: 1)", "body": "<p>When Cabal or Stack install hackage the error message like title.\nFull mes is:\ncabal install ghc-mod\nrealgcc.exe: error: C:\\Users\\\u6d60\u30e6\u4ebd\\AppData\\Local\\Temp\\4118467.c: No such file or directory\nrealgcc.exe: warning: '-x c' after last input file has no effect\nrealgcc.exe: fatal error: no input files\ncompilation terminated.\n<code>gcc.exe' failed in phase</code>C Compiler'. (Exit code: 1)</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 6279125, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MqvQ1.jpg?s=128&g=1", "display_name": "Boo89100", "link": "https://stackoverflow.com/users/6279125/boo89100"}, "edited": false, "score": 0, "creation_date": 1498796735, "post_id": 44838574, "comment_id": 76657513, "body": "Thank you so much! This is exactly what I was looking for. :)"}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 4, "last_activity_date": 1498796662, "creation_date": 1498796662, "answer_id": 44838574, "question_id": 44838547, "link": "https://stackoverflow.com/questions/44838547/how-to-use-replicate-to-generate-a-matrix/44838574#44838574", "title": "How to use replicate to generate a matrix", "body": "<p>To flatten a list of lists, you can use <code>concat</code>:</p>\n\n<pre><code>concat (replicate 9 [1..9])\n</code></pre>\n\n<p>Another option is to make an infinite list of <code>[1..9, 1..9, 1..9, \u2026]</code> using <code>cycle</code> and take the first 81 elements:</p>\n\n<pre><code>take 81 (cycle [1..9])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1498797414, "creation_date": 1498797414, "answer_id": 44838672, "question_id": 44838547, "link": "https://stackoverflow.com/questions/44838547/how-to-use-replicate-to-generate-a-matrix/44838672#44838672", "title": "How to use replicate to generate a matrix", "body": "<p>So you have a list of lists <code>[[Int]]</code>, and you want to make a simple list <code>[Int]</code> out of it. <a href=\"https://www.haskell.org/hoogle/?hoogle=%5B%5BInt%5D%5D+-%3E+%5BInt%5D\" rel=\"nofollow noreferrer\">Ask <code>Hoogle</code></a>! The first result is</p>\n\n<pre><code>concat :: [[a]] -&gt; [a]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 6, "last_activity_date": 1498798141, "last_edit_date": 1592644375, "creation_date": 1498798141, "answer_id": 44838783, "question_id": 44838547, "link": "https://stackoverflow.com/questions/44838547/how-to-use-replicate-to-generate-a-matrix/44838783#44838783", "title": "How to use replicate to generate a matrix", "body": "<p>Since there is a semigroup over lists, you can use <code>stimes</code> to repeat it some fixed number of times.</p>\n<blockquote>\n<p><a href=\"https://www.stackage.org/haddock/lts-8.21/base-4.9.1.0/Data-Semigroup.html#v:stimes\" rel=\"noreferrer\"><code>stimes</code></a><code> :: (Semigroup a, Integral b) =&gt; b -&gt; a -&gt; a</code></p>\n<p>Repeat a value n times.</p>\n</blockquote>\n<pre><code>stimes 9 [1..9]\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 6279125, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MqvQ1.jpg?s=128&g=1", "display_name": "Boo89100", "link": "https://stackoverflow.com/users/6279125/boo89100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 44838574, "answer_count": 3, "score": 1, "last_activity_date": 1498798141, "creation_date": 1498796375, "last_edit_date": 1498796682, "question_id": 44838547, "link": "https://stackoverflow.com/questions/44838547/how-to-use-replicate-to-generate-a-matrix", "title": "How to use replicate to generate a matrix", "body": "<p>I was curious how to use replicate in Haskell to create a list of integers that repeated a set of numbers. This is for a homework and the rules kind of confuse me to begin with but essentially I'm wanting to create a list that is 1..9 9 times, so 81 integers in this list just 1..9 each time. I've tried a few things upon google search, the thing that got me the closest was </p>\n\n<pre><code>zipWith' (replicate 9 1) [1..]\n</code></pre>\n\n<p>Which seemed close to what I was going for but it spiraled out of control and I'm not sure how to reset it back to 1 I suppose</p>\n\n<p>My first thought was something super simple as in</p>\n\n<pre><code>replicate 9 [1..9]\n</code></pre>\n\n<p>Which seems very very close to what I need, however it's a list of lists and I'm not sure how to make just a list of all those numbers. Any help is much appreciated.</p>\n"}, {"tags": ["parsing", "haskell", "parsec"], "comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 2, "creation_date": 1498769615, "post_id": 44834764, "comment_id": 76650183, "body": "Is there a reason you can&#39;t post <code>cellP</code>? It&#39;s possible with Parsec that <code>cellP</code> is too eager and eating input, so it might help if we saw that implementation."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1498770010, "post_id": 44834764, "comment_id": 76650338, "body": "There is no need to use parser for that, are you using it for some particular reason?"}, {"owner": {"reputation": 1242, "user_id": 3252252, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/4V81y.jpg?s=128&g=1", "display_name": "Jesuspc", "link": "https://stackoverflow.com/users/3252252/jesuspc"}, "reply_to_user": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1498770667, "post_id": 44834764, "comment_id": 76650647, "body": "I have added the code for cellP @SilvioMayolo . There is no particular reason to use parsec, I just thought it would make the code look more declarative."}], "answers": [{"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 5, "last_activity_date": 1498771734, "creation_date": 1498771734, "answer_id": 44835266, "question_id": 44834764, "link": "https://stackoverflow.com/questions/44834764/parsing-multiple-lines-into-a-list-of-lists-in-haskell/44835266#44835266", "title": "Parsing multiple lines into a list of lists in Haskell", "body": "<p>Parser combinators are overkill for something this simple. I'd use <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:lines\" rel=\"noreferrer\"><code>lines :: String -&gt; [String]</code></a> and <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:words\" rel=\"noreferrer\"><code>words :: String -&gt; [String]</code></a> to break up the input and then map the individual tokens into <code>MyType</code>s.</p>\n\n<pre><code>toMyType :: String -&gt; Maybe MyType\ntoMyType \"a\" = Just A\ntoMyType \"b\" = Just B\ntoMyType \"c\" = Just C\ntoMyType _ = Nothing\n\nparseMyType :: String -&gt; Maybe [[MyType]]\nparseMyType = traverse (traverse toMyType) . fmap words . lines\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1242, "user_id": 3252252, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/4V81y.jpg?s=128&g=1", "display_name": "Jesuspc", "link": "https://stackoverflow.com/users/3252252/jesuspc"}, "edited": false, "score": 0, "creation_date": 1498772839, "post_id": 44835363, "comment_id": 76651537, "body": "Thanks! That was very useful."}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 4, "last_activity_date": 1498772136, "creation_date": 1498772136, "answer_id": 44835363, "question_id": 44834764, "link": "https://stackoverflow.com/questions/44834764/parsing-multiple-lines-into-a-list-of-lists-in-haskell/44835363#44835363", "title": "Parsing multiple lines into a list of lists in Haskell", "body": "<p>You're right that <code>manyTill</code> keeps parsing until a newline. But <code>manyTill</code> never gets to see the newline because <code>cellP</code> is too eager. <code>cellP</code> ends up calling <code>P.symbol</code>, whose documentation states</p>\n\n<blockquote>\n  <p><code>symbol :: String -&gt; ParsecT s u m String</code></p>\n  \n  <p>Lexeme parser symbol s parses string s and skips trailing white space.</p>\n</blockquote>\n\n<p>The keyword there is 'white space'. It turns out, Parsec defines whitespace as being any character which satisfies <code>isSpace</code>, which includes newlines. So <code>P.symbol</code> is happily consuming the <code>c</code>, followed by the space and the newline, and then <code>manyTill</code> looks and doesn't see a newline because it's <em>already been consumed</em>.</p>\n\n<p>If you want to drop the Parsec routine, go with Benjamin's solution. But if you're determined to stick with that, the basic idea is that you want to modify the language's <code>whiteSpace</code> field to correctly define whitespace to not be newlines. Something like</p>\n\n<pre><code>lexer = let lexer0 = P.makeTokenParser emptyDef\n        in lexer0 { whiteSpace = void $ many (oneOf \" \\t\") }\n</code></pre>\n\n<p>That's pseudocode and probably won't work for your specific case, but the idea is there. You want to change the definition of <code>whiteSpace</code> to be whatever you want to define as <code>whiteSpace</code>, not what the system defines by default. Note that changing this will also break your comment syntax, if you have one defined, since <code>whiteSpace</code> was previously equipped to handle comments.</p>\n\n<p>In short, Benjamin's answer is probably the best way to go. There's no real reason to use Parsec here. But it's also helpful to know <em>why</em> this particular solution didn't work: Parsec's default definition of a language wasn't designed to treat newlines with significance.</p>\n"}], "owner": {"reputation": 1242, "user_id": 3252252, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/4V81y.jpg?s=128&g=1", "display_name": "Jesuspc", "link": "https://stackoverflow.com/users/3252252/jesuspc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "accepted_answer_id": 44835363, "answer_count": 2, "score": 3, "last_activity_date": 1498772136, "creation_date": 1498769348, "last_edit_date": 1498770767, "question_id": 44834764, "link": "https://stackoverflow.com/questions/44834764/parsing-multiple-lines-into-a-list-of-lists-in-haskell", "title": "Parsing multiple lines into a list of lists in Haskell", "body": "<p>I am trying to parse a file that looks like:</p>\n\n<pre><code>a b c \nf e d\n</code></pre>\n\n<p>I want to match each of the symbols in the line and parse everything into a list of lists such as:</p>\n\n<pre><code>[[A, B, C], [D, E, F]]\n</code></pre>\n\n<p>In order to do that I tried the following:</p>\n\n<pre><code>import           Control.Monad\nimport           Text.ParserCombinators.Parsec\nimport           Text.ParserCombinators.Parsec.Language\nimport qualified Text.ParserCombinators.Parsec.Token    as P\n\nparserP :: Parser [[MyType]]\nparserP = do\n  x  &lt;- rowP\n  xs &lt;- many (newline &gt;&gt; rowP)\n  return (x : xs)\n\nrowP :: Parser [MyType]\nrowP = manyTill cellP $ void newline &lt;|&gt; eof\n\ncellP :: Parser (Cell Color)\ncellP = aP &lt;|&gt; bP &lt;|&gt; ... -- rest of the parsers, they all look very similar\n\naP :: Parser MyType\naP = symbol \"a\" &gt;&gt; return A\n\nbP :: Parser MyType\nbP = symbol \"b\" &gt;&gt; return B\n\nlexer = P.makeTokenParser emptyDef\nsymbol  = P.symbol lexer\n</code></pre>\n\n<p>But it fails to return multiple inner lists. Instead what I get is:</p>\n\n<pre><code>[[A, B, C, D, E, F]]\n</code></pre>\n\n<p>What am I doing wrong? I was expecting manyTill to parse cellP until the newline character, but that's not the case.</p>\n"}, {"tags": ["haskell", "frp", "reactive-banana", "wxhaskell"], "comments": [{"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1498874173, "post_id": 44833951, "comment_id": 76694010, "body": "I know this is a pain, but would you consider adjusting your example case so that it&#39;s got less code in it? <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "owner": {"reputation": 405, "user_id": 3581753, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4cfe62cc75a67f573e9f638c348f5004?s=128&d=identicon&r=PG&f=1", "display_name": "archaephyrryx", "link": "https://stackoverflow.com/users/3581753/archaephyrryx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1498782266, "creation_date": 1498766367, "last_edit_date": 1498782266, "question_id": 44833951, "link": "https://stackoverflow.com/questions/44833951/updating-visibility-of-dynamically-created-content", "title": "Updating visibility of dynamically created content", "body": "<p>Duplicating this from github as per @HeinrichApfelmus's suggestion:</p>\n\n<p>This may be just a usage error on my part, but I am noticing a strange phenomenon when trying to set up conditional visibility/layout for dynamically created UI elements (in WX of course). As somewhat of a toy-example, I tried to create a widget that created StaticText elements on the fly and allowed the user to \"browse\" through these elements through '&lt;' '>' buttons.</p>\n\n<p>The problem I am noting is that all labels are invisible until a new one is created, at which point the current widget in focus becomes visible. Whether this is a bug or just a paradigm I am misusing, or a subtlety with reactive frameworks, I am unsure as to how to resolve this. Here is the code I have at this point, which exhibits the problem:</p>\n\n<p></p>\n\n<pre><code>{-# LANGUAGE RecursiveDo #-}\n\nmodule Test.Adder where\n\nimport Reactive.Banana\nimport Reactive.Banana.WX\nimport Graphics.UI.WX.Attributes\nimport Graphics.UI.WX hiding (Event, newEvent, empty, Identity)\nimport Graphics.UI.WXCore hiding (Event, Timer, empty, Identity, newEvent)\nimport Graphics.UI.WXCore.Frame\n\n-- | Combine Unit-Events\nanyEvent :: [Event ()] -&gt; Event ()\nanyEvent = foldl1 (unionWith (\\_ _ -&gt; ()))\n\n-- | Unsugared if-then-else function\nif_ :: Bool -&gt; a -&gt; a -&gt; a\nif_ True x _ = x\nif_ False _ y = y\n\n-- | Apply a function to the value at an index, or return a default value\n-- if the index is out of range\n(!?) :: (a -&gt; b) -&gt; b -&gt; Int -&gt; ([a] -&gt; b)\n(f!? ~y) n xs\n  | n &lt; 0 = y\n  | otherwise = case drop n xs of\n                  x:_ -&gt; f x\n                  [] -&gt; y\n\nmain :: IO ()\nmain = start test\n\n\ncreate :: Window w -&gt; Int -&gt; Behavior Int -&gt; Event Int -&gt; Event () -&gt; MomentIO (StaticText ())\ncreate t i bi ei eRef = do\n  let tx = replicate i '\\t' ++ show i\n\n  x &lt;- liftIO $ staticText t [ text := tx ]\n\n  let beq = (==i) &lt;$&gt; bi\n\n  let eMe = filterE (==i) ei\n\n  sink x [ visible :== beq ]\n  reactimate (refresh x &lt;$ anyEvent [ eRef, () &lt;$ eMe ])\n  return x\n\ntest :: IO ()\ntest = do\n    f &lt;- frame [text := \"Test\"]\n\n    add &lt;- button f [ text := \"+\" ]\n\n    prv &lt;- button f [ text := \"&lt;\" ]\n    cur &lt;- staticText f []\n    nxt &lt;- button f [ text := \"&gt;\" ]\n\n    tab &lt;- panel f [ clientSize := sz 200 300 ]\n    deb &lt;- staticText f []\n    ref &lt;- button f [ text := \"refresh\" ]\n\n\n    let networkDescription :: MomentIO ()\n        networkDescription = mdo\n                eAdd &lt;- event0 add command\n                eRef &lt;- event0 ref command\n\n                let bNotFirst = (&gt;0) &lt;$&gt; bCur\n                    bNotLast  = (&lt;) &lt;$&gt; bCur &lt;*&gt; bNext\n\n                sink prv [ enabled :== bNotFirst ]\n                sink cur [ text :== show &lt;$&gt; bCur ]\n                sink nxt [ enabled :== bNotLast ]\n\n                ePrev &lt;- event0 prv command\n                eNext &lt;- event0 nxt command\n\n                let eDelta :: Enum n =&gt; Event (n -&gt; n)\n                    eDelta = unions [ pred &lt;$ whenE bNotFirst ePrev\n                                    , succ &lt;$ whenE bNotLast  eNext ]\n                    eChange = flip ($) &lt;$&gt; bCur &lt;@&gt; eDelta\n\n                bCur &lt;- stepper 0 $ eChange\n\n                (eIndex, bCount) &lt;- mapAccum 0 ((\\x -&gt; (x, succ x)) &lt;$ eAdd)\n\n                let bView = (\\n i -&gt; if_ (n==0) (0) i) &lt;$&gt; bCount &lt;*&gt; bCur\n                    bNext = pred &lt;$&gt; bCount\n                    eCreate = (\\n -&gt; create tab n bView eChange $ anyEvent [eRef,eAdd]) &lt;$&gt; eIndex\n\n                reCreate &lt;- execute eCreate\n\n                bItemer &lt;- accumB id $ flip (.) . (:) &lt;$&gt; reCreate\n                let bItems = ($[]) &lt;$&gt; bItemer\n                    bThis = (widget!?(nullLayouts!!0)) &lt;$&gt; bCur &lt;*&gt; bItems\n\n                sink tab [ layout :== bThis ]\n                liftIO $ set f [ layout := column 5 [ margin 10 $ row 5 [ widget add\n                                                                        , widget prv\n                                                                        , widget cur\n                                                                        , widget nxt\n                                                                        , widget ref\n                                                                        ]\n                                                    , fill $ widget tab\n                                                    ]\n                               ]\n\n    network &lt;- compile networkDescription\n    actuate network\n</code></pre>\n\n<p></p>\n\n<p>></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501400392, "post_id": 44833632, "comment_id": 77755612, "body": "<code>( (&lt;$&gt;) . const ) 2 Just 3</code> = <code>(const 2 &lt;$&gt; Just) 3</code> is <i>not</i> in <code>Maybe</code>, but in <code>((-&gt;) r)</code>, where <code>fmap = (.)</code> so it becomes <code>(const 2 . Just) 3 = const 2 (Just 3)</code>. <code>2 &lt;$ Just 3 = fmap (const 2) (Just 3) = Just ( (const 2) 3)</code>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1498766998, "post_id": 44833660, "comment_id": 76648777, "body": "Is there a common name for this function (<code>&lt;$</code>)? Maybe <code>constMap</code>?"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1498767850, "post_id": 44833660, "comment_id": 76649239, "body": "@ftor <a href=\"https://stackoverflow.com/questions/7746894/are-there-pronounceable-names-for-common-haskell-operators\" title=\"are there pronounceable names for common haskell operators\">stackoverflow.com/questions/7746894/&hellip;</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501400388, "post_id": 44833660, "comment_id": 77755611, "body": "<code>2 &lt;$ Just</code> is <code>const 2 . Just</code>."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501400465, "post_id": 44833660, "comment_id": 77755626, "body": "@WillNess: \u2026 which is <code>const 2</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501400608, "post_id": 44833660, "comment_id": 77755648, "body": "skipping of derivation steps belongs in scientific papers, not in textbooks. :)"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501400644, "post_id": 44833660, "comment_id": 77755654, "body": "@WillNess: It\u2019s not a derivation. It\u2019s a simplification of parts of the expression at a time so the OP can follow what\u2019s happening."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501400804, "post_id": 44833660, "comment_id": 77755690, "body": "skipping of simplification steps belongs in scientific papers, not in textbooks."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501400864, "post_id": 44833660, "comment_id": 77755703, "body": "@WillNess: It\u2019s not a textbook. My answer also uses the RyanHC implementation where <code>Functor ((-&gt;) r)</code> has <code>x &lt;$ _ = const x</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501401033, "post_id": 44833660, "comment_id": 77755754, "body": "SO answers are addressed to newcomers, as textbooks are."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501401091, "post_id": 44833660, "comment_id": 77755768, "body": "@WillNess: Cool. Still not a textbook despite potentially sharing a target audience, and this remains exactly the answer I would give a newcomer."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501401126, "post_id": 44833660, "comment_id": 77755777, "body": "then they wd still have hard time following it."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501401233, "post_id": 44833660, "comment_id": 77755808, "body": "@WillNess: No, I\u2019m pretty sure addressing it at a semantic level rather than \u201cexpand the GHC implementation\u201d is easier to follow. I\u2019ll be happy to add words on the former if a newcomer asks. :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501408300, "post_id": 44833660, "comment_id": 77757615, "body": "the <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Functor.html#v:-60--36-\" rel=\"nofollow noreferrer\">&quot;default definition <code>fmap . const</code>&quot;</a> looks like a semantic level definition, and the <a href=\"https://stackoverflow.com/questions/44833632/in-maybe-definition/44833660?noredirect=1#comment77755703_44833660\">&quot;RyanHC implementation&quot;</a> looks like a specific implementation, a clever shortcut, to me. (what is RyanHC BTW?) --- of course <i>&quot; <code>2 &lt;$ Just</code> is <code>const 2</code>&quot;</i> on its own is completely baffling to me, that&#39;s why I commented in the first place. I can&#39;t understand it except by filling in the missing step."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501409983, "post_id": 44833660, "comment_id": 77758056, "body": "@WillNess: Different people have different intuitive explanations I guess :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1501413418, "post_id": 44833660, "comment_id": 77759030, "body": "yes, some are comfortable with skipping steps, some are not. experts more among the first group, newbies the second."}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": false, "score": 6, "last_activity_date": 1498765234, "creation_date": 1498765234, "answer_id": 44833660, "question_id": 44833632, "link": "https://stackoverflow.com/questions/44833632/in-maybe-definition/44833660#44833660", "title": "&lt;$ in Maybe definition", "body": "<p><code>(fmap . const) 2 Just 3</code> is equivalent to <code>((fmap . const) 2 Just) 3</code>, where <code>2 &lt;$ Just</code> is <code>const 2</code> and <code>const 2 3</code> is <code>2</code>.</p>\n\n<p>You meant:</p>\n\n<pre><code>(fmap . const) 2 $ Just 3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "is_accepted": false, "score": 6, "last_activity_date": 1498765410, "creation_date": 1498765410, "answer_id": 44833707, "question_id": 44833632, "link": "https://stackoverflow.com/questions/44833632/in-maybe-definition/44833707#44833707", "title": "&lt;$ in Maybe definition", "body": "<p>The problem is that you typed <code>(fmap . const) 2 Just 3</code>. I believe what you meant was rather <code>(fmap . const) 2 (Just 3)</code>. In the former, the function <code>fmap . const</code> is applied to three arguments, namely <code>2</code>, <code>Just</code> and <code>3</code>, and, in the latter, your expression is indeed equivalent to <code>2 &lt;$ Just 3</code>.</p>\n\n<pre><code>&gt; (fmap . const) 2 (Just 3)\nJust 2\n&gt; 2 &lt;$ Just 3\nJust 3\n</code></pre>\n"}], "owner": {"reputation": 1518, "user_id": 332348, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/694d53039b1ff43bdfcd2033c90a1647?s=128&d=identicon&r=PG", "display_name": "echo", "link": "https://stackoverflow.com/users/332348/echo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1498787314, "creation_date": 1498765114, "last_edit_date": 1498787314, "question_id": 44833632, "link": "https://stackoverflow.com/questions/44833632/in-maybe-definition", "title": "&lt;$ in Maybe definition", "body": "<pre><code>Prelude&gt; (fmap . const ) 2 Just 3\n2\nPrelude&gt; 2 &lt;$ Just 3\nJust 2\nPrelude&gt; :t (&lt;$)\n(&lt;$) :: Functor f =&gt; a -&gt; f b -&gt; f a\nPrelude&gt; :t fmap . const\nfmap . const :: Functor f =&gt; b -&gt; f a -&gt; f b\n</code></pre>\n\n<p>in functor, </p>\n\n<pre><code>(&lt;$)        =  fmap . const   \n</code></pre>\n\n<p>why I get different result for Maybe? did not find a implement of <code>&lt;$</code> in Maybe. Thanks.</p>\n"}, {"tags": ["haskell", "max"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1498762831, "post_id": 44832978, "comment_id": 76646582, "body": "<code>maximumBy</code> works in <i>O(n)</i>..."}], "answers": [{"tags": [], "owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "is_accepted": false, "score": 1, "last_activity_date": 1498763005, "creation_date": 1498763005, "answer_id": 44833049, "question_id": 44832978, "link": "https://stackoverflow.com/questions/44832978/haskell-maximumby-for-ord-instances/44833049#44833049", "title": "Haskell maximumBy for Ord instances", "body": "<p>I don't know any built-in function that does what you want, but you can really simplify your implementation of <code>maximumBy'</code>.</p>\n\n<p>You could use <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Function.html#v:on\" rel=\"nofollow noreferrer\"><code>on</code></a> for example:</p>\n\n<pre><code>import Data.Function (on)\n\nmaximumBy' :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; a\nmaximumBy' f = maximumBy (compare `on` f)\n</code></pre>\n\n<p>In fact, this definition is so simple you could use it as-is, without defining <code>maximumBy'</code> at all.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1498763410, "post_id": 44833057, "comment_id": 76646903, "body": "Correct; however <code>compare `on` f</code> does have a significant performance penalty, because for every comparison <code>f</code> needs to be calculated on <i>both</i> elements, i.e. you get twice as many calls to <code>f</code> than necessary."}, {"owner": {"reputation": 2581, "user_id": 1234443, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9f4a7a9822caa42024e8e76b36e26964?s=128&d=identicon&r=PG", "display_name": "jchitel", "link": "https://stackoverflow.com/users/1234443/jchitel"}, "edited": false, "score": 0, "creation_date": 1498765099, "post_id": 44833057, "comment_id": 76647775, "body": "This is exactly what I was looking for, thank you. And excellent point @leftroundabout. I will take that in mind."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1498770547, "post_id": 44833057, "comment_id": 76650585, "body": "Use the Schawrtz...ian transform!"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1498805140, "post_id": 44833057, "comment_id": 76660626, "body": "@leftaroundabout Yours is the Schwartzian transform to which I was referring."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1498763016, "creation_date": 1498763016, "answer_id": 44833057, "question_id": 44832978, "link": "https://stackoverflow.com/questions/44832978/haskell-maximumby-for-ord-instances/44833057#44833057", "title": "Haskell maximumBy for Ord instances", "body": "<p>First of all you make a claim that is wrong:</p>\n\n<blockquote>\n  <p><code>maximumBy</code> takes a list of non-Ord values and a sort function that provides an ordering for them, and computes the maximum using that function. This is <em>O(nlogn)</em>.</p>\n</blockquote>\n\n<p>No sorting has to be done to calculate the maximum element. An ordering relation has to be <em>reflexive</em>, <em>anti-symmetric</em> and <em>transitive</em>, and therefore one can simply alsways hold the maximum thus far, and use the custom comparison to check whether the new item is greater.</p>\n\n<p>Furthermore you can construct you <code>maximumBy'</code> function as:</p>\n\n<pre><code>maximumBy' f = maximumBy (compare `on` f)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 4, "last_activity_date": 1498763095, "creation_date": 1498763095, "answer_id": 44833070, "question_id": 44832978, "link": "https://stackoverflow.com/questions/44832978/haskell-maximumby-for-ord-instances/44833070#44833070", "title": "Haskell maximumBy for Ord instances", "body": "<p>I think what you are looking for is easily expressed using <code>Data.Ord.comparing</code>:</p>\n\n<p>Instead of using your <code>maximumBy'</code> function:</p>\n\n<pre><code>maximumBy' head [\"abc\", \"def\", \"geh\"]\n</code></pre>\n\n<p>you can build a comparator with <code>comparing</code> and give that to the usual <code>maximumBy</code>:</p>\n\n<pre><code>maximumBy (comparing head) [\"abc\", \"def\", \"geh\"]\n</code></pre>\n\n<p>And as Willem Van Onsem says in another answer, you are incorrect to be concerned about the cost of <code>maximumBy</code>: it does not sort the list.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1498763311, "creation_date": 1498763311, "answer_id": 44833133, "question_id": 44832978, "link": "https://stackoverflow.com/questions/44832978/haskell-maximumby-for-ord-instances/44833133#44833133", "title": "Haskell maximumBy for Ord instances", "body": "<p>That function is defined <a href=\"http://hackage.haskell.org/package/tip-lib-0.2.2/docs/Tip-Utils.html#v:maximumOn\" rel=\"nofollow noreferrer\">the <code>tip-lib</code> package</a> as</p>\n\n<pre><code>maximumOn :: (Foldable f, Ord b) =&gt; (a -&gt; b) -&gt; f a -&gt; b\n</code></pre>\n\n<p>The general idea has also been <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html#v:sortOn\" rel=\"nofollow noreferrer\">adopted in recent <code>base</code>, with</a></p>\n\n<pre><code>sortOn :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>Note that thanks to laziness, you can use</p>\n\n<pre><code>maximumOn :: Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; b\nmaximumOn f = head . sortOn f\n</code></pre>\n\n<p>and get the same asymptotic performance as a manual implementation.</p>\n"}], "owner": {"reputation": 2581, "user_id": 1234443, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9f4a7a9822caa42024e8e76b36e26964?s=128&d=identicon&r=PG", "display_name": "jchitel", "link": "https://stackoverflow.com/users/1234443/jchitel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1679, "favorite_count": 0, "accepted_answer_id": 44833057, "answer_count": 4, "score": 1, "last_activity_date": 1498763311, "creation_date": 1498762689, "question_id": 44832978, "link": "https://stackoverflow.com/questions/44832978/haskell-maximumby-for-ord-instances", "title": "Haskell maximumBy for Ord instances", "body": "<p>I keep finding myself wanting a function for this, and I always need to implement it myself, but I feel like there must be a built-in for it.</p>\n\n<p>Basically, what I want is sort of halfway between <code>maximum</code> and <code>maximumBy</code>.</p>\n\n<p><code>maximum</code> takes a list of <code>Ord</code> values and returns the maximum. This is O(n).</p>\n\n<pre><code>maximum :: (Ord a) =&gt; [a] -&gt; a\n</code></pre>\n\n<p><code>maximumBy</code> takes a list of non-<code>Ord</code> values and a sort function that provides an ordering for them, and computes the maximum using that function. This is O(nlogn) (or whatever the complexity is for a sort).</p>\n\n<pre><code>maximumBy :: (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; a\n</code></pre>\n\n<p>I want a <code>maximumBy</code> that takes a list of values of type <code>a</code> and a function that returns <code>Ord</code> values for <code>a</code> values, and computes the maximum <code>a</code> using the <code>Ord</code> values. This would be O(n) because it only needs to keep track of the maximum as it goes along. This is what that signature would be:</p>\n\n<pre><code>maximumBy' :: (Ord b) =&gt; (a -&gt; b) -&gt; [a] -&gt; a\n</code></pre>\n\n<p>And this is my rough implementation:</p>\n\n<pre><code>maximumBy' func list = foldl1' (\\max i -&gt; let (maxby, iby) = (func max, func i) in if iby &gt; maxby then i else max) list\n</code></pre>\n\n<p>Is there such a function built-in, or perhaps an easy way to write this using existing built-ins?</p>\n"}, {"tags": ["haskell", "docker", "haskell-stack"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498756477, "post_id": 44830881, "comment_id": 76642977, "body": "Have you read the <a href=\"https://docs.haskellstack.org/en/stable/docker_integration/\" rel=\"nofollow noreferrer\">documentation</a>? In particular, the <code>run-args</code> field and the <code>--docker-run-args</code> flag?"}, {"owner": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498807475, "post_id": 44830881, "comment_id": 76661954, "body": "Yes I did, the problem is not the running of the app via stack, the problem is when i create the image and then later run it via docker. Can&#39;t see how the run-args would help me there, in particular when i later compose the app in a docker stack."}], "answers": [{"tags": [], "owner": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "is_accepted": false, "score": 3, "last_activity_date": 1524175315, "last_edit_date": 1524175315, "creation_date": 1498809309, "answer_id": 44841451, "question_id": 44830881, "link": "https://stackoverflow.com/questions/44830881/haskell-stack-image-container-execute-on-docker-run/44841451#44841451", "title": "Haskell Stack Image Container Execute On Docker run", "body": "<p>I figured it out myself. Everything is working correctly, I just didn't understand that stack creates two separate images. One just for the environment and one for the entrypoint.</p>\n\n<p>So I checked <code>docker images</code> and found indeed two images. I was simply running the wrong image. This is correct\n<code>docker run -p 5000:5000 {imagename-app-exe}</code></p>\n\n<p>Man sometimes you don't see the forest.</p>\n"}], "owner": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524175315, "creation_date": 1498754970, "question_id": 44830881, "link": "https://stackoverflow.com/questions/44830881/haskell-stack-image-container-execute-on-docker-run", "title": "Haskell Stack Image Container Execute On Docker run", "body": "<p>I am following the turorials from stackage and docker to run a haskell build via docker.</p>\n\n<p>Building and Image creation works well and i can run the app via <code>docker run -p 5000:5000 {imagename} {app-exe}</code></p>\n\n<p>I am using the build in features of the latest stack to create the docke image with this minimal configuration.</p>\n\n<pre><code>image:\n    container:\n       base: \"fpco/ubuntu-with-libgmp\"\n</code></pre>\n\n<p>How can i make the image to launch the executable automatically, so that i can just type <code>docker run -p 5000:5000 {imagename}</code>. I know how to do it in a dockerfile but not with stack. I was thinking that I have to use:</p>\n\n<pre><code>entrypoints:\n      - appname-exe\n</code></pre>\n\n<p>No success, no matter if I just use the name of executable or the absolute path to it. Maybe I don't understand what the entrypoint is for.</p>\n\n<p>I am using Docker for Mac.</p>\n\n<p>Any suggestions appreciated.</p>\n\n<p>Cheers\nBjorn</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1498747683, "post_id": 44828264, "comment_id": 76637135, "body": "<code>Control.Lens</code> comes from the <a href=\"http://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\">lens package on Hackage</a>. You can easily include packages from Hackage using Cabal, Stack, or direct download."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1498754589, "post_id": 44828264, "comment_id": 76641904, "body": "Are you sure your question isn&#39;t &quot;How do I add the <code>Control.Lens</code> module to a GHCi session&quot;? If it is, the answer is <code>:m + Control.Lens</code>."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1498755506, "post_id": 44828264, "comment_id": 76642394, "body": "@ReinHenrichs It&#39;s not. Problem is OP doesn&#39;t know what packages are"}, {"owner": {"reputation": 93, "user_id": 4564798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187f9717149081b976cff7068e7b0fb5?s=128&d=identicon&r=PG&f=1", "display_name": "user4564798", "link": "https://stackoverflow.com/users/4564798/user4564798"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1498755725, "post_id": 44828264, "comment_id": 76642536, "body": "@Cubic, I used import Control.Lens,  my the script, but I think I need to install it."}], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 93, "user_id": 4564798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187f9717149081b976cff7068e7b0fb5?s=128&d=identicon&r=PG&f=1", "display_name": "user4564798", "link": "https://stackoverflow.com/users/4564798/user4564798"}, "edited": false, "score": 0, "creation_date": 1498749621, "post_id": 44828735, "comment_id": 76638662, "body": "@user4564798 Prelude is the default module imported in Haskell. It has nothing to do with your ability to install packages."}, {"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1498749876, "post_id": 44828735, "comment_id": 76638873, "body": "<code>apt-get install libghc-lens-dev</code> on debian/ubuntu"}, {"owner": {"reputation": 93, "user_id": 4564798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187f9717149081b976cff7068e7b0fb5?s=128&d=identicon&r=PG&f=1", "display_name": "user4564798", "link": "https://stackoverflow.com/users/4564798/user4564798"}, "edited": false, "score": 0, "creation_date": 1498759673, "post_id": 44828735, "comment_id": 76644812, "body": "Thank you guys, I used your ideas and this is how I installed it  &quot;  :! cabal install lens &quot;"}], "tags": [], "owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "is_accepted": true, "score": 2, "last_activity_date": 1498748506, "creation_date": 1498748506, "answer_id": 44828735, "question_id": 44828264, "link": "https://stackoverflow.com/questions/44828264/how-to-install-haskell-control-lens/44828735#44828735", "title": "How to install Haskell Control Lens", "body": "<p>see <a href=\"http://lens.github.io/tutorial.html\" rel=\"nofollow noreferrer\">lens tutorial</a></p>\n\n<pre><code>$ cabal install lens\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4564798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187f9717149081b976cff7068e7b0fb5?s=128&d=identicon&r=PG&f=1", "display_name": "user4564798", "link": "https://stackoverflow.com/users/4564798/user4564798"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1481, "favorite_count": 2, "accepted_answer_id": 44828735, "answer_count": 1, "score": 4, "last_activity_date": 1498753694, "creation_date": 1498747259, "last_edit_date": 1498753694, "question_id": 44828264, "link": "https://stackoverflow.com/questions/44828264/how-to-install-haskell-control-lens", "title": "How to install Haskell Control Lens", "body": "<p>I've noticed that Control.Lens is not part of Haskell platform, so I probably need to install it. </p>\n\n<p>Can anyone explain how to install it? Is it not really part of Haskell platform?</p>\n\n<p>Edit: I'm using GHCi, and it uses prelude. </p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "type-safety", "type-level-computation"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1498748759, "post_id": 44828082, "comment_id": 76638032, "body": "This looks a bit like the extensible record <a href=\"https://stackoverflow.com/a/44666983/3072788\">question I answered a week or so ago</a>. Obviously not a duplicate but probably relevant."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1498756300, "post_id": 44828082, "comment_id": 76642860, "body": "It&#39;s unclear what you really want to achieve. Can you give an example of the code you would <i>like</i> to write? It seems like you want to generate boilerplate for the <code>Position</code> and <code>Name</code> types - if so, Template Haskell is probably the easiest way to do so. To me this is reminiscent of extensible records (for which there are a throng of libraries already - take your pick!), or generic programming idioms as implemented by e.g. <code>syb</code> or <code>uniplate</code>. In any case, don&#39;t write it yourself - research the available technology and see if any works for you."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8231216"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1498761084, "post_id": 44828082, "comment_id": 76645674, "body": "I am still learning Haskell but after I learned about the expression problem, I thought I should try to solve it in a simple problem using what I already learned. @Alec That seems like the sort of structure I want to create indeed. But at the moment I don&#39;t even really understand the extensions you used for getting it to work."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8231216"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498761155, "post_id": 44828082, "comment_id": 76645717, "body": "@user2407038 Unfortunately, these tools like Template Haskell and syb seems too much complicated to resolve this (seemingly ?) simple problem. If these are the idiomatic/preferred way of getting this sort of problem to work, then I will look at them in detail. I only thought there was a solution that involved no code generation at all."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498762292, "post_id": 44828082, "comment_id": 76646309, "body": "If you are looking for a Haskell solution to the expression problem (although I don&#39;t see that in the question) then <a href=\"http://okmij.org/ftp/tagless-final/index.html\" rel=\"nofollow noreferrer\">this</a> is a very powerful technique. Also, I think you&#39;ve made this mistake of assuming that the expression problem is a simple problem (it&#39;s not - accept that hard problems have complicated solutions); and that technologies which you do not yet understand must be complicated. And my previous comment still stands: can you give an example of what you would like to write?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498762466, "post_id": 44828082, "comment_id": 76646397, "body": "Finally, it seems to me this question is about learning - if so, then you must read the existing literature; trying to derive things from first principles yourself is at best tedious, and at worst takes you down the entirely incorrect path. By reading the literature, you find out whether the problem you are trying to solve has already been explored a thousand times over, or a slight variation on a well-known problem, or if you are trying to solve a brand new, nearly unknown problem. Then you will be in a good position to ask a more concrete question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8231216"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498764537, "post_id": 44828082, "comment_id": 76647485, "body": "@user2407038 You&#39;re right, I only need to find the right documentation, beginning with the basics. Also, sorry for not being clear enough about this problem being in relation to the expression problem, I thought it was implied by the &quot;Open&quot; and &quot;easy to extend&quot; keywords. This <a href=\"https://oleksandrmanzyuk.wordpress.com/2014/06/18/from-object-algebras-to-finally-tagless-interpreters-2/\" rel=\"nofollow noreferrer\">link</a> is what I read before trying myself. This is concrete in a way because I&#39;m trying to implement a concrete component system for a small video game. Now I guess I just need to read all of this papers."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498765068, "post_id": 44828082, "comment_id": 76647753, "body": "Your link describes one technique (&quot;finally tagless interpreters&quot;) which is precisely the same one described in one of my links (to be explicit, <a href=\"http://okmij.org/ftp/tagless-final/index.html\" rel=\"nofollow noreferrer\">this one</a>). That resource gives a derivation of the strategy from the ground up - which I think would be an excellent resource for your purposes. My recommendation would be to begin with the code examples, lecture slides, etc., and to end by reading the papers (as opposed to reading the papers first). Good luck!"}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1498874421, "post_id": 44828082, "comment_id": 76694041, "body": "@user2407038 I think you should put this as an answer so OP can accept it."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8231216"}, "is_accepted": false, "score": 0, "last_activity_date": 1499206660, "creation_date": 1499206660, "answer_id": 44914624, "question_id": 44828082, "link": "https://stackoverflow.com/questions/44828082/open-type-safe-and-easy-to-extend-component-structure-in-haskell/44914624#44914624", "title": "Open, type safe and easy to extend component structure in Haskell?", "body": "<p>After looking at some Generic Haskell, I finally found an easier way than automatic derivation to avoid writing each instance for <code>Finder</code> (formerly <code>CompFinder</code>).\nBy doing this way, we only need to define instances of <code>Finder</code> for the structural types defined by the user.</p>\n\n<p>Start with some pragmas</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-} -- allows functions at the type level\n{-# LANGUAGE FlexibleContexts #-} -- allows using data types in typeclass declarations\n</code></pre>\n\n<p>Then define a simple Component wrapper. This way we will write the instance for the Finder only once for all the simple components.</p>\n\n<pre><code>data Component a = Comp a\n</code></pre>\n\n<p>Then define the Finder class, we will use MultiParamTypeClasses without Functional dependencies because we want to specify the return type to get the desired components:</p>\n\n<pre><code>class Finder s c where -- s is the structure and c the component\n    find :: s -&gt; [c]\n    find _ = [] -- provides empty list on search fail\n</code></pre>\n\n<p>We can implement this for our wrapper, first with actual component and searched component matching.</p>\n\n<pre><code>instance {-# OVERLAPABLE #-} Finder (Component a) (Component a) where\n    find (Comp o) = [Comp o]\n</code></pre>\n\n<p>We take advantage of the <code>OVERLAPPABLE</code> pragma to provide an empty list if components differs:</p>\n\n<pre><code>instance Finder (Component a) (Component b) where\n    find (Comp o) = []\n</code></pre>\n\n<p>We can structure our components with a simple Mix (2-Tuple) for instance:</p>\n\n<pre><code>data Mix a b = Mix a b deriving (Show,Eq,Ord)\ninstance (Finder a (Component c), Finder b (Component c) ) =&gt; Finder (Mix a b) (Component c) where\n    find (Mix x y) = find x ++ (find y)\n</code></pre>\n\n<p>Now let's define some components:</p>\n\n<pre><code>data Velocity = Vel Int Int deriving (Show,Eq,Ord)\ndata Name = Name String deriving (Show,Eq,Ord)\n</code></pre>\n\n<p>And finally:</p>\n\n<pre><code>myStruct = Mix (Comp $ Name \"Julien\") (Comp $ Vel 5 2)\n\n-- we can use the return type to ask for a list of components of that type\nPrelude&gt; find myStruct :: [Component Name]\n  [Comp (Name \"Julien\")]\n\nPrelude&gt; find myStruct :: [Component Velocity]\n  [Comp (Vel 5 2)]\n\nPrelude&gt; find (Comp $ Name \"Marie\") :: [Component Velocity]\n  []\n</code></pre>\n\n<p>This works with nested Mix too!\nThe only downside is the use of the Component wrapper but it's fine.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8231216"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1499206660, "creation_date": 1498746796, "question_id": 44828082, "link": "https://stackoverflow.com/questions/44828082/open-type-safe-and-easy-to-extend-component-structure-in-haskell", "title": "Open, type safe and easy to extend component structure in Haskell?", "body": "<p>I im trying to implement a small and simple open type component structure in Haskell.<br>\nThe goal is to easily allow function and type extension by creating new components in other modules while preserving type safety at compile time.  </p>\n\n<p>I managed to implement a recursive search function by component type (find, in <code>CompFinder</code>), and it works well in the simple tests i tried. However i need to write trivial instances for <code>CompFinder</code> for non-composite components and multiple instances with the only difference being the component type for the <code>CompFinder CompMix</code> instance.</p>\n\n<p>I am aware of <a href=\"https://github.com/ndmitchell/derive#readme\" rel=\"nofollow noreferrer\">Derive</a> for automatic code generation for instance deriving but I would like a simpler solution if there is one, the compiler doing the code generation in the worst case, if possible.</p>\n\n<p>So the questions are: How can I modify this system to simplify the writing of new Components?<br>\nor: How can I tell GHC to automatically generate CompFinder instances since only the type change in the different definitions?</p>\n\n<p>Perhaps by doing something like this:</p>\n\n<pre><code>instance (Component a, CompFinder a T, Component b, CompFinder b T) =&gt; CompFinder (CompMix a b) T where\n    find (CompMix x y ) = (find x :: [T]) ++ (find y :: [T])\n</code></pre>\n\n<p>where T would by a type parameter</p>\n\n<p>Or maybe by writing CompFinder so it automatically works for all Components.</p>\n\n<p>This is the full code:</p>\n\n<pre><code>--ghc 7.10\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n\n-- Defined in the library module\nclass Component a\n\nclass ComponentMix a where -- Allow recursive component aggregation\n    add :: b -&gt; c -&gt; a b c\n\nclass (Component a, Component b) =&gt; CompFinder a b where -- class that need a new instance for each new component type\n    find :: a -&gt; [b]\n    find _ = []\n\n-- Defined in the user module\ndata CompMix a b = CompMix a b deriving (Show, Eq)\n\ninstance ComponentMix CompMix where\n    add x y = ( CompMix x y )\n\ninstance (Component a, Component b) =&gt; Component (CompMix a b)\n\n-- Two simple component types that can be defined in another module\ndata Position = Pos Int Int deriving (Show, Eq, Ord)\ndata Name = Name String deriving (Show, Eq)          \n\ninstance Component Position\ninstance CompFinder Position Position where -- Trivial instance\n    find x = [x]\ninstance CompFinder Position Name           -- Trivial instance\n\ninstance Component Name\ninstance CompFinder Name Name where -- Trivial instance\n    find x = [x]\ninstance CompFinder Name Position   -- Trivial instance\n\ninstance (Component a, CompFinder a Name, Component b, CompFinder b Name) =&gt; CompFinder (CompMix a b) Name where\n    find (CompMix x y ) = (find x :: [Name]) ++ (find y :: [Name])\n\ninstance (Component a, CompFinder a Position, Component b, CompFinder b Position) =&gt; CompFinder (CompMix a b) Position where\n    find (CompMix x y ) = (find x :: [Position]) ++ (find y :: [Position])\n\nmain = print $ (find (CompMix (Name \"Henri\") (CompMix (Pos 1 2) (Name \"Julie\") ) ) :: [Position] ) -- Correctly outputs [Pos 1 2]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1498744463, "post_id": 44826145, "comment_id": 76634476, "body": "You forgot the constraint <code>Monoid b</code>. <code>mempty :: Monoid b =&gt; Combine a b</code>. <code>Combine a b</code> is just a wrapper for <code>a -&gt; b</code>. So it is basically <code>Monoid b =&gt; a -&gt; b</code> again. The part before the <code>=&gt;</code> is the typeclass, which is replaced by the corresponding type dictionary at compile time. It tells the compiler how to produce a value of type <code>b</code>."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1498743423, "creation_date": 1498743423, "answer_id": 44826716, "question_id": 44826145, "link": "https://stackoverflow.com/questions/44826145/what-is-the-instance-for-the-type/44826716#44826716", "title": "What is the instance for the type?", "body": "<p>Why not ask ghci? You have <code>mempty = Combine mempty</code>, so:</p>\n\n<pre><code>&gt; :t Combine mempty\nCombine mempty :: Monoid b =&gt; Combine a b\n</code></pre>\n\n<p>Therefore the type of <code>mempty</code> for <code>Combine</code> must be at least as specific as that.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 44826716, "answer_count": 1, "score": 0, "last_activity_date": 1498743423, "creation_date": 1498741959, "question_id": 44826145, "link": "https://stackoverflow.com/questions/44826145/what-is-the-instance-for-the-type", "title": "What is the instance for the type?", "body": "<p>The type signature from Monoid <code>mempty</code> function is:</p>\n\n<pre><code>*Exercises Data.Monoid&gt; :t mempty\nmempty :: Monoid a =&gt; a\n</code></pre>\n\n<p>When I look at the type signature for function(->) type on typeclass Monoid for <code>mempty</code> function it becomes to:</p>\n\n<pre><code>mempty :: Monoid b =&gt; a -&gt; b\n</code></pre>\n\n<p>Because <code>a</code> will be replace through <code>a -&gt; b</code>.</p>\n\n<pre><code>mempty :: Monoid a =&gt; a\nmempty :: a -&gt; b\n</code></pre>\n\n<p>I did not mention that <code>b</code> has to be a <code>Monoid</code>, otherwise the <code>mappend</code> function would not work.  </p>\n\n<p>Now I have following data type </p>\n\n<pre><code>newtype Combine a b = \n  Combine { unCombine :: a -&gt; b }\n\ninstance (Semigroup b) \n  =&gt; Semigroup (Combine a b) where \n  Combine {unCombine=f} &lt;&gt; Combine {unCombine=g} = Combine (f &lt;&gt; g)\n\ninstance (Semigroup b, Monoid b)\n  =&gt; Monoid (Combine a b) where\n  mempty = Combine mempty\n  mappend = (&lt;&gt;)\n</code></pre>\n\n<p>How the <code>mempty</code> function signature looks like for <code>Combine</code>?   </p>\n\n<p>So I am going to do exactly the same way as above:</p>\n\n<p>The mempty declaration: </p>\n\n<pre><code>mempty :: Monoid a =&gt; a\n</code></pre>\n\n<p><code>a</code> will be replace through Combine, then it becomes to:</p>\n\n<pre><code>mempty :: Combine a b\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["haskell", "functor", "category-theory"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1498743302, "post_id": 44825864, "comment_id": 76633508, "body": "Something to keep in mind: if you&#39;re exposing <code>fmapF</code> to users (or colleagues), you&#39;re giving them something that&#39;s more difficult to reason about from the type (<code>fmapF</code> can do infinitely more possible things, and I don&#39;t know what properties it has)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1498743647, "post_id": 44825864, "comment_id": 76633777, "body": "@jberryman Actually, it can&#39;t do infinitely more things -- the typeclass constraint has already weakened parametricity."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1498747884, "post_id": 44825864, "comment_id": 76637292, "body": "@chi how so ? from the point of view of the user, isn&#39;t it just a normal function, there are no typeclass constraint. fmapF can just give back Z, which fmap can not"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1498748133, "post_id": 44825864, "comment_id": 76637525, "body": "@jberryman actually what would be nice would be to play with that specific F, then explicitely quantify, to have best of both world. It should be possible with Dict I suppose, to have (named) instances enter the context. like fix does, or ST, but at type level"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1498748153, "post_id": 44825864, "comment_id": 76637537, "body": "@nicolas Sure, but the functor instance can also do anything <code>fmapF</code> can. It would be &quot;wrong&quot; to write a law-breaking instance, but types do not prevent that."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1498748661, "post_id": 44825864, "comment_id": 76637951, "body": "@chi The distinction is interesting. &quot;theorems for free&quot; restrictions come from  parametric polymorphism which will always be true without boundaries. fmap give you guarantee that <i>it</i> will do lawful operations within its own boundaries"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1498753596, "post_id": 44825864, "comment_id": 76641363, "body": "@nicolas I&#39;m unsure about what you are implying. There are, exactly, the same parametricity guarantees for a standalone <code>fmapF</code> and the instance <code>fmap</code> definition. Both have the same polytype, and are subject to the same free theorem. A definition <code>fmap _ _ = Z</code> is allowed by parametricity, and it breaks the functor laws -- just as one can do using a standalone <code>fmapF</code> definition. So your &quot;lawful operations&quot; does not imply the functor laws."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1498770103, "post_id": 44825864, "comment_id": 76650380, "body": "fmap ensure some laws, <i>provided</i> a lawful implementation of Functor. that&#39;s quite something. fmapF does not ensure anything. It boils down to the same in the &quot;end&quot; as we have to resolve things statically, but you could imagine having mutiple stages of resolution. the (polymorphic) parametricity guarantee are just the one that are valid across every stages, they are context free (thus context-laws free). as I understand things."}], "answers": [{"comments": [{"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1498741690, "post_id": 44826010, "comment_id": 76632240, "body": "YES ! that&#39;s nice. Now we have names... bindings.. slippery slope. I guess you can nest <code>Dict t</code> to play with that :)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1498741550, "creation_date": 1498741550, "answer_id": 44826010, "question_id": 44825864, "link": "https://stackoverflow.com/questions/44825864/removing-ad-hoc-polymorphism/44826010#44826010", "title": "removing ad-hoc polymorphism", "body": "<p>I think you actually want</p>\n\n<pre><code>{-# LANGUAGE TypeApplications #-}\nr = fmap @ F f Z\n</code></pre>\n\n<p>The <code>@ F</code> part specifies that we want the <code>fmap</code> of functor <code>F</code>.</p>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 44826010, "answer_count": 1, "score": 1, "last_activity_date": 1498741550, "creation_date": 1498741210, "question_id": 44825864, "link": "https://stackoverflow.com/questions/44825864/removing-ad-hoc-polymorphism", "title": "removing ad-hoc polymorphism", "body": "<p>What is the best way to remove ad-hoc polymorshism in haskell ?</p>\n\n<p>80% of the time, I don't need <code>fmap</code> to be polymorphic in <code>Functor f</code>, I actually know which instance I apply it to. Replacing it with a specific instance gives me :</p>\n\n<ul>\n<li>less brain inference when reading code, more brain checking</li>\n<li>more type error caught when type checker verifies</li>\n</ul>\n\n<p>What is the best way to apply, like in category theory, a functor F to a morphism in haskell using its name ?</p>\n\n<pre><code>-- F is a functor : it maps objects of * to objects of *\ndata F r = Z | Suc r\n\n-- F is a functor : it maps arrows of *  to arrows of *\n-- generic fmap will be found for this type, I inherit much code for free, great\ninstance Functor F where\n  fmap f Z       = Z\n  fmap f (Suc n) = Suc (f n)\n\n-- But I care writing code specific for this functor only\n-- Applies F for arrows of *\nfmapF = fmap :: (a -&gt; b) -&gt; (F a -&gt; F b)\n\n-- an arrow in *, aka a function -- (and also a value as * is CCC)\nf = id :: a -&gt; a\n\n-- works for values F a, not any functor f\nr = fmapF f Z :: F a\nr' = fmap f \"hi\" -- as opposed to\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1498739004, "post_id": 44824815, "comment_id": 76630041, "body": "You have read the <a href=\"http://hackage.haskell.org/package/lens-4.15.3/docs/Control-Lens-Getter.html#v:uses\" rel=\"nofollow noreferrer\"><i>documentation</i> on <code>uses</code></a>, and know how to <a href=\"https://hayoo.fh-wedel.de/?query=uses\" rel=\"nofollow noreferrer\">generally find documentation</a>? It makes very seldom sense to rely on Google for finding out about some Haskell function, the specific engines Hoogle and Hayoo are much better."}, {"owner": {"reputation": 93, "user_id": 4564798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187f9717149081b976cff7068e7b0fb5?s=128&d=identicon&r=PG&f=1", "display_name": "user4564798", "link": "https://stackoverflow.com/users/4564798/user4564798"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1498739232, "post_id": 44824815, "comment_id": 76630243, "body": "@leftaroundabout Thanks for the tip!"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1498739442, "post_id": 44824815, "comment_id": 76630390, "body": "Another option for navigating docs faster - and offline - is Dash or Zeal"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1498740297, "post_id": 44824815, "comment_id": 76631091, "body": "@nicolas the default Zeal database on Haskell isn&#39;t particularly complete though \u2013 is there an easy way to extend it, or Dash&#39;s? Else I&#39;d say a local Hoogle together with locally-install haddocks is more useful for offline help, since it works for any installed package."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1498741813, "post_id": 44824815, "comment_id": 76632333, "body": "@leftaroundabout You can use haddocset <a href=\"https://github.com/philopon/haddocset/\" rel=\"nofollow noreferrer\">github.com/philopon/haddocset</a> works great for me. I wish stackage would generate that automatically"}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 4564798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187f9717149081b976cff7068e7b0fb5?s=128&d=identicon&r=PG&f=1", "display_name": "user4564798", "link": "https://stackoverflow.com/users/4564798/user4564798"}, "edited": false, "score": 0, "creation_date": 1498739179, "post_id": 44825059, "comment_id": 76630194, "body": "Thank you very much!  I had a look at it, but I didn&#39;t know it was part of &quot;Getter&quot;."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 93, "user_id": 4564798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187f9717149081b976cff7068e7b0fb5?s=128&d=identicon&r=PG&f=1", "display_name": "user4564798", "link": "https://stackoverflow.com/users/4564798/user4564798"}, "edited": false, "score": 1, "creation_date": 1498739261, "post_id": 44825059, "comment_id": 76630264, "body": "Thinking about it, you could perhaps have discovered that by asking GHCi with the <code>:i</code> command. I hadn&#39;t thought of that. (I don&#39;t have this package installed myself.)"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1498741227, "post_id": 44825059, "comment_id": 76631847, "body": "This is a big shortcoming of the <code>lens</code> docs, in my opinion. It&#39;s difficult to tell where a given combinator comes from. I&#39;d love there to be a big &quot;index&quot; page with every combinator listed out, so you can cmd-F and find the one you&#39;re looking for."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1498744792, "post_id": 44825059, "comment_id": 76634768, "body": "Uh.  You guys are aware of haddock index pages, right? <a href=\"https://hackage.haskell.org/package/lens-4.15.3/docs/doc-index-All.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/lens-4.15.3/docs/doc-index-All.h&zwnj;&#8203;tml</a>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1498752010, "post_id": 44825059, "comment_id": 76640432, "body": "@Carl I am now! Thanks, this is exactly what I had in mind :)"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 1, "last_activity_date": 1498739000, "creation_date": 1498739000, "answer_id": 44825059, "question_id": 44824815, "link": "https://stackoverflow.com/questions/44824815/haskell-what-does-uses-do-in-control-lens/44825059#44825059", "title": "Haskell: What does &quot;uses&quot; do in control lens?", "body": "<p>The first hit for a Google search on \"haskell control.lens\" gives me this:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/lens-4.15.3/docs/Control-Lens.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/lens-4.15.3/docs/Control-Lens.html</a></p>\n\n<p>...the documentation for the Lens package where the <code>uses</code> function comes from. From there, it's not actually straight-forward to determine which exact module defines this function. It turns out it's <code>Control.Lens.Getter</code>:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/lens-4.15.3/docs/Control-Lens-Getter.html#v:uses\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/lens-4.15.3/docs/Control-Lens-Getter.html#v:uses</a></p>\n\n<p>So that's how you track down the documentation for random Haskell functions. Whether that documentation is actually helpful varies considerably...</p>\n"}, {"tags": [], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "is_accepted": false, "score": 0, "last_activity_date": 1498739589, "last_edit_date": 1498739589, "creation_date": 1498739284, "answer_id": 44825175, "question_id": 44824815, "link": "https://stackoverflow.com/questions/44824815/haskell-what-does-uses-do-in-control-lens/44825175#44825175", "title": "Haskell: What does &quot;uses&quot; do in control lens?", "body": "<p>The documentation is the type + haddoc extra bits, and vice versa.</p>\n\n<p>For instance we can see </p>\n\n<p><code>uses :: MonadState s m =&gt; LensLike' (Const r) s a -&gt; (a -&gt; r) -&gt; m r</code></p>\n\n<p>That the return value is like a burrito (hence the <code>&lt;-</code>. which gives you the current filling to grow a bigger burrito)</p>\n"}], "owner": {"reputation": 93, "user_id": 4564798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/187f9717149081b976cff7068e7b0fb5?s=128&d=identicon&r=PG&f=1", "display_name": "user4564798", "link": "https://stackoverflow.com/users/4564798/user4564798"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1498739589, "creation_date": 1498738362, "last_edit_date": 1498738753, "question_id": 44824815, "link": "https://stackoverflow.com/questions/44824815/haskell-what-does-uses-do-in-control-lens", "title": "Haskell: What does &quot;uses&quot; do in control lens?", "body": "<p>I'm new to Haskell. I was reading the code <a href=\"https://github.com/input-output-hk/cardano-sl/blob/04dc8e4a640a62f0d82633f3a78ab3d8540fd5e6/lrc/Pos/Lrc/Fts.hs#L219\" rel=\"nofollow noreferrer\">here</a> and I'm not sure (though I can guess) what <code>uses</code> do: </p>\n\n<pre><code>inRange &lt;- uses fsCurrentCoinRangeUpperBound (coinIndex &lt;=)\n</code></pre>\n\n<p>Also, why's <code>&lt;-</code> been used? </p>\n\n<p>I've looked up for \"Control lens uses in Haskell\" but I couldn't find any explanation. </p>\n"}, {"tags": ["haskell", "haddock"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1498747966, "post_id": 44820920, "comment_id": 76637364, "body": "Are you open to making a major API change? If so, I could write a short answer on how to use a <a href=\"https://byorgey.wordpress.com/2010/04/03/haskell-anti-pattern-incremental-ad-hoc-parameter-abstraction/\" rel=\"nofollow noreferrer\">single record argument</a> for this."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1498751504, "post_id": 44820920, "comment_id": 76640044, "body": "With Haddock 2.16.1, I get the per-argument doc rendered just fine, for standalone functions as well as for class methods."}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1498753881, "post_id": 44820920, "comment_id": 76641514, "body": "@leftaroundabout, I&#39;m running through 2.17.1, this: <a href=\"https://github.com/mrkkrp/megaparsec/blob/master/Text/Megaparsec.hs#L572-L575\" rel=\"nofollow noreferrer\">github.com/mrkkrp/megaparsec/blob/master/Text/&hellip;</a> for example, no per-argument docs. Can you spot a difference in markup, or is it a regression?"}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1498754005, "post_id": 44820920, "comment_id": 76641574, "body": "@DanielWagner, Major changes are possible, but they should not make the API emm... stylized just for the sake of a bit better docs. I&#39;d like to keep it simple."}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1498754676, "post_id": 44820920, "comment_id": 76641944, "body": "@leftaroundabout, Just confirmed, works with Haddock 2.16.1 but not with 2.17.1. Looks like a regression."}], "answers": [{"tags": [], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "is_accepted": true, "score": 3, "last_activity_date": 1498757649, "creation_date": 1498757649, "answer_id": 44831617, "question_id": 44820920, "link": "https://stackoverflow.com/questions/44820920/is-there-a-way-to-make-haddock-render-per-argument-docs-for-type-class-methods/44831617#44831617", "title": "Is there a way to make Haddock render per-argument docs for type class methods?", "body": "<p>OK, this was a regression. This thing should work (and worked in version 2.16.1), but stopped (2.17.1 and later).</p>\n\n<p>I have reported this: <a href=\"https://github.com/haskell/haddock/issues/647\" rel=\"nofollow noreferrer\">https://github.com/haskell/haddock/issues/647</a>, should be fixed in version 2.18 (you can see there is a PR for this already).</p>\n"}], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 44831617, "answer_count": 1, "score": 8, "last_activity_date": 1498757649, "creation_date": 1498727637, "question_id": 44820920, "link": "https://stackoverflow.com/questions/44820920/is-there-a-way-to-make-haddock-render-per-argument-docs-for-type-class-methods", "title": "Is there a way to make Haddock render per-argument docs for type class methods?", "body": "<p>It turns out that Haddock does not render per-argument docs for type class\nmethods:</p>\n\n\n\n<pre class=\"lang-haskell prettyprint-override\"><code>class Foo a where\n\n  foo\n    :: Int -- ^ This string will be ignored by Haddock\n    -&gt; a\n</code></pre>\n\n<p>This causes certain issues for users of a library I maintain, because\nthe methods in my case have quite lengthy signatures. I have always had the descriptions in\nthe source formatted like that (certainly works for ordinary functions), but\nit turns out Haddock does not display them (and does not complain about them\neither).</p>\n\n<p>Is there a way to display the per-argument docs with Haddock? Some workaround perhaps?</p>\n"}, {"tags": ["haskell", "monads", "io-monad"], "comments": [{"owner": {"reputation": 5679, "user_id": 1878788, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fc54887ecbaba35e17251129e5b78c9a?s=128&d=identicon&r=PG", "display_name": "bli", "link": "https://stackoverflow.com/users/1878788/bli"}, "edited": false, "score": 0, "creation_date": 1498727252, "post_id": 44820732, "comment_id": 76621669, "body": "Maybe you could fold your <code>zipWith</code> with dummy actions so that you end up with the correct type ?"}, {"owner": {"reputation": 962, "user_id": 4921099, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aqAiW.png?s=128&g=1", "display_name": "martin", "link": "https://stackoverflow.com/users/4921099/martin"}, "reply_to_user": {"reputation": 5679, "user_id": 1878788, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fc54887ecbaba35e17251129e5b78c9a?s=128&d=identicon&r=PG", "display_name": "bli", "link": "https://stackoverflow.com/users/1878788/bli"}, "edited": false, "score": 0, "creation_date": 1498727734, "post_id": 44820732, "comment_id": 76622032, "body": "@bli The thing I&#39;m struggling with here is that I want the type to be <code>[IO ()]</code> since I want to perform multiple IO actions. I feel like there should be a way for the do block to accept a list, or flatten it out for me."}], "answers": [{"comments": [{"owner": {"reputation": 962, "user_id": 4921099, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aqAiW.png?s=128&g=1", "display_name": "martin", "link": "https://stackoverflow.com/users/4921099/martin"}, "edited": false, "score": 0, "creation_date": 1498728243, "post_id": 44821038, "comment_id": 76622396, "body": "I also had to change the type of main to <code>main :: IO [()]</code>, but that did it for me. Thanks."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 962, "user_id": 4921099, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aqAiW.png?s=128&g=1", "display_name": "martin", "link": "https://stackoverflow.com/users/4921099/martin"}, "edited": false, "score": 1, "creation_date": 1498728827, "post_id": 44821038, "comment_id": 76622802, "body": "@martin That is an option, though it&#39;s more common to leave <code>main :: IO ()</code> and add <code>return ()</code> as the last entry in the <code>do</code> block, after the <code>zipWithM</code> line."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 962, "user_id": 4921099, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aqAiW.png?s=128&g=1", "display_name": "martin", "link": "https://stackoverflow.com/users/4921099/martin"}, "edited": false, "score": 2, "creation_date": 1498729720, "post_id": 44821038, "comment_id": 76623424, "body": "@martin ...or, even better, use the <code>zipWithM_</code> variant which does not even return the useless list of units <code>[()]</code> in the first place."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 2, "last_activity_date": 1498727896, "creation_date": 1498727896, "answer_id": 44821038, "question_id": 44820732, "link": "https://stackoverflow.com/questions/44820732/write-to-multiple-files-in-haskell/44821038#44821038", "title": "Write to multiple files in Haskell", "body": "<p>The function you need is <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad.html#v:zipWithM\" rel=\"nofollow noreferrer\">zipWithM</a>.</p>\n\n<p>Re. <code>way to loop through a list in a do block</code>, there is also a function for this - <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad.html#v:sequence\" rel=\"nofollow noreferrer\">sequence</a>, so you can write <code>sequence $ zipWith writeFile letter letter</code>.</p>\n"}], "owner": {"reputation": 962, "user_id": 4921099, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/aqAiW.png?s=128&g=1", "display_name": "martin", "link": "https://stackoverflow.com/users/4921099/martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 1, "accepted_answer_id": 44821038, "answer_count": 1, "score": 1, "last_activity_date": 1498727896, "creation_date": 1498727082, "question_id": 44820732, "link": "https://stackoverflow.com/questions/44820732/write-to-multiple-files-in-haskell", "title": "Write to multiple files in Haskell", "body": "<p>In Haskell, how would one go about writing to an arbitrarily large number of files? </p>\n\n<p>As an example, let's say I want to take the letters <code>a</code> through <code>z</code> and put them in files named for the letter of their contents. An initial attempt was to do the following:</p>\n\n<pre><code>main :: IO ()\nmain = do\n       let letter = map (:\"\") ['a'..'z']\n       zipWith writeFile letter letter\n</code></pre>\n\n<p>which produced the following error:</p>\n\n<blockquote>\n  <p>Couldn't match expected type 'IO ()' with actual type '[IO ()]'</p>\n</blockquote>\n\n<p>I feel like there should be a way to loop through a list in a do block, but I haven't been able to find it yet. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1498722058, "post_id": 44818972, "comment_id": 76618159, "body": "With the built-in <code>Monoid</code> instance for functions <code>Monoid b =&gt; Monoid (a -&gt; b)</code>, <code>const mempty</code>, since <code>mappend f g</code> is <code>\\x -&gt; mappend (f x) (g x)</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1498723636, "post_id": 44818972, "comment_id": 76619134, "body": "to elaborate on the previous comment, <code>(f&lt;&gt;g) x = f x &lt;&gt; g x</code>; since <code>f&lt;&gt;mempty</code> must be <code>== f</code> by Monoid laws (and <code>mempty&lt;&gt;f == f</code>, too), we have <code>(f&lt;&gt;mempty) x = f x &lt;&gt; mempty x</code> == <code>f x &lt;&gt; mempty = f x &lt;&gt; (const mempty) x</code>. thus for functions into a Monoid, <code>mempty = const mempty</code>."}], "answers": [{"comments": [{"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1498731461, "post_id": 44821801, "comment_id": 76624651, "body": "Why does the <code>mempty</code> for function(-&gt;) has an argument? When I look at the type of signature of  <code>mempty</code>, it has no arguement <code>mempty :: Monoid a =&gt; a</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1498733074, "post_id": 44821801, "comment_id": 76625651, "body": "What do you mean with <code>(-&gt;) isn&#39;t a type constant</code>? Isn&#39;t type constant just another term for nullary cons? I think <code>(-&gt;)</code> cannot have a monoid instance because it has the wrong kind: <code>* -&gt; * -&gt; *</code>. @zero_coding: What do you think is <code>a</code> in the function instance?"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1498734511, "post_id": 44821801, "comment_id": 76626657, "body": "I thought <code>type constant</code> refer to nullary <code>type constructors</code> that is type constructors of kind <code>*</code>. But I checked the haskell report and it mentions <code>type constant</code> only twice, so I am unsure, wethet thats widely used anymore."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1498735157, "post_id": 44821801, "comment_id": 76627033, "body": "@ftor Look at the <code>mempty :: Monoid a =&gt; a</code> definition, it does expect any argument but if you look at <code>(a -&gt; b)</code> monoid instance, <code>mempty</code> expects an parameter. Why?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1498737616, "post_id": 44821801, "comment_id": 76628919, "body": "@zero_coding <code>mempty :: Monoid a =&gt; a</code> is the generic type signature. For the function instance <code>a</code> is <code>a -&gt; b</code> (where <code>b</code> must be a monoid). Hence the type sig for this instance is <code>mempty :: Monoid b =&gt; a -&gt; b</code> and <code>a</code> is the argument you&#39;re looking for."}, {"owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "edited": false, "score": 0, "creation_date": 1498738691, "post_id": 44821801, "comment_id": 76629776, "body": "Why <code>b</code> has to be a monoid, because of closed type?"}, {"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1498738772, "post_id": 44821801, "comment_id": 76629848, "body": "<code>b</code> has to be a monoid, because only in this case, there is a monoid instance for <code>a -&gt; b</code>."}], "tags": [], "owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "is_accepted": true, "score": 5, "last_activity_date": 1498772067, "last_edit_date": 1498772067, "creation_date": 1498729851, "answer_id": 44821801, "question_id": 44818972, "link": "https://stackoverflow.com/questions/44818972/what-is-the-mempty-of-the-data-type/44821801#44821801", "title": "What is the mempty of the data type?", "body": "<ol>\n<li>The type constructor <code>(-&gt;)</code> isn't a type constant (there aren't any values of type <code>(-&gt;)</code>), and therefore can't have a monoid instance.</li>\n<li>If the type <code>b</code> has a monoid instance, the type constant <code>a -&gt; b</code> (or <code>(-&gt;) a b</code>) does have a monoid instance and <code>mempty</code> yields a function, which ignores its inputs and returns <code>mempty</code> of <code>b</code> as value.</li>\n</ol>\n\n<p>If you look at</p>\n\n<pre><code>instance Monoid <b>b</b> => Monoid (a -> <b>b</b>) where\n    mempty _ = <b>mempty</b>\n    mappend f g x = f x `<b>mappend</b>` g x</code></pre>\n\n<p>the line <code>mempty _ = <strong>mempty</strong></code> implements this.</p>\n\n<p>What is the type of <code>mempty</code> for <code>a -&gt; b</code>? It is <code>a -&gt; b</code>, as <code>mempty</code> needs to be a value of type <code>a -&gt; b</code>. So</p>\n\n<p><code>mempty _ = <strong>mempty</strong></code></p>\n\n<p>tells us , that <code>mempty</code> for <code>a -&gt; b</code> is a function, which discards its input and returns <strong><code>mempty</code></strong>, <strong>a value of type <code>b</code></strong>. The two occurrences of the name <code>mempty</code> in this definition <strong>refer to different</strong> functions/values.</p>\n\n<p>Let's hit some concrete examples:</p>\n\n<ol>\n<li><p>You tried</p>\n\n<pre><code>mempty :: (-&gt; Integer Bool)\n</code></pre>\n\n<p>that is syntactically wrong. You wanted to try</p>\n\n<pre><code>mempty :: (-&gt;) Integer Bool\n</code></pre>\n\n<p>which yields a new error</p>\n\n<pre><code>&lt;interactive&gt;:5:1: error:\n   \u2022 No instance for (Monoid Bool) arising from a use of \u2018mempty\u2019\n   \u2022 In the expression: mempty :: (-&gt;) Integer Bool\n     In an equation for \u2018it\u2019: it = mempty :: (-&gt;) Integer Bool\n</code></pre>\n\n<p>as <code>Bool</code> doesn't have a monoid instance.</p></li>\n<li><p>You tried</p>\n\n<pre><code>mempty :: (Product Integer)\n</code></pre>\n\n<p>which worked and yielded <code>Product {getProduct = 1}</code> as value.\nThat tells you, that <code>Product Integer</code> has a monoid instance. Therefore we <em>could</em> try having <code>Product Integer</code> as type <strong><code>b</code></strong> in <code>a -> <strong>b</strong></code>.</p></li>\n<li><p>Now try</p>\n\n<pre><code>&gt; let f = mempty :: a -&gt; Product Integer\n&gt; f 'x'\nProduct {getProduct = 1}\n</code></pre>\n\n<p>In this example <code>mempty</code> refers to some value of type <code>a -&gt; Product Integer</code> and therefore is a function. So the type variable <code>t</code> from <code>mempty :: (Monoid t) =&gt; t</code> refers to the type  <code>a -&gt; Product Integer</code> in this case.</p></li>\n</ol>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1029, "favorite_count": 0, "accepted_answer_id": 44821801, "answer_count": 1, "score": 2, "last_activity_date": 1498772067, "creation_date": 1498721650, "last_edit_date": 1498724581, "question_id": 44818972, "link": "https://stackoverflow.com/questions/44818972/what-is-the-mempty-of-the-data-type", "title": "What is the mempty of the data type?", "body": "<p>I have following data type with monoid and semigroup instance:</p>\n\n<pre><code>newtype Combine a b = \n  Combine { unCombine :: a -&gt; b }\n\ninstance (Semigroup b) \n  =&gt; Semigroup (Combine a b) where \n  Combine {unCombine=f} &lt;&gt; Combine {unCombine=g} = Combine (f &lt;&gt; g)\n\ninstance (Semigroup b, Monoid b)\n  =&gt; Monoid (Combine a b) where\n  mempty = Combine mempty\n  mappend = (&lt;&gt;)\n</code></pre>\n\n<p>I want to configure it out, what is the <code>mempty</code> value of the function<code>(-&gt;)</code>?  </p>\n\n<p>I've tried for example:</p>\n\n<pre><code>*Exercises Data.Monoid&gt; mempty :: (-&gt; Integer Bool)\n&lt;interactive&gt;:21:15: error: parse error on input `Integer'\n</code></pre>\n\n<p>How does the implementation of <code>mempty</code> in <code>monoid</code> looks like?</p>\n\n<p>I looked at hackage source:</p>\n\n<pre><code>instance Monoid b =&gt; Monoid (a -&gt; b) where\n        mempty _ = mempty\n        mappend f g x = f x `mappend` g x\n</code></pre>\n\n<p>and can not find the implementation of <code>mempty</code>.</p>\n\n<p>Maybe to clarify what I mean, consider following example:</p>\n\n<pre><code>*Exercises Data.Monoid&gt; mempty :: (Product Integer)\nProduct {getProduct = 1}\n</code></pre>\n\n<p>The mempty of <code>Product Integer</code> is <code>Product {getProduct = 1}</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1498706798, "post_id": 44815858, "comment_id": 76611872, "body": "<code>wrap (x:xs) = [x] : wrap xs</code>?"}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1498706832, "post_id": 44815858, "comment_id": 76611885, "body": "^, but also just <code>wrap = map pure</code>."}, {"owner": {"reputation": 1233, "user_id": 101326, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b67dd441d570e1913e87396718b70f48?s=128&d=identicon&r=PG", "display_name": "anru ", "link": "https://stackoverflow.com/users/101326/anru"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1498707043, "post_id": 44815858, "comment_id": 76611933, "body": "@zerkms, that causing Couldn&#39;t match type \u2018a\u2019 with \u2018[a]\u2019 error"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1498707176, "post_id": 44815858, "comment_id": 76611967, "body": "@anru it totally works for me <code>&#175;\\_(\u30c4)_&#47;&#175; </code>"}, {"owner": {"reputation": 1233, "user_id": 101326, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b67dd441d570e1913e87396718b70f48?s=128&d=identicon&r=PG", "display_name": "anru ", "link": "https://stackoverflow.com/users/101326/anru"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1498707426, "post_id": 44815858, "comment_id": 76612034, "body": "@zerkms, my bad, I had typed wrap :: [a] -&gt; [a]"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1498731753, "post_id": 44815858, "comment_id": 76624850, "body": "Sometimes, it&#39;s worth working through an example. You know that for input <code>[1,2,3]</code>, you want output <code>[[1],[2],[3]]</code>. Now, when you match <code>(x:xs)</code>, <code>x=1</code> and <code>xs=[2,3]</code>. So <code>wrap xs</code> should be <code>[[2],[3]]</code>. Now think concretely how to get from <code>[[2],[3]]</code> to <code>[[1],[2],[3]]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1233, "user_id": 101326, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b67dd441d570e1913e87396718b70f48?s=128&d=identicon&r=PG", "display_name": "anru ", "link": "https://stackoverflow.com/users/101326/anru"}, "edited": false, "score": 0, "creation_date": 1498707222, "post_id": 44815926, "comment_id": 76611979, "body": "thanks, i see what i have done wrong, my type declaration is not there."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1498707308, "post_id": 44815926, "comment_id": 76612004, "body": "Yes, GHC will happily infer the type of <code>wrap</code> for you. Writing top-level type declarations is a good practice, though, and you should get into the habit anyway."}, {"owner": {"reputation": 1233, "user_id": 101326, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b67dd441d570e1913e87396718b70f48?s=128&d=identicon&r=PG", "display_name": "anru ", "link": "https://stackoverflow.com/users/101326/anru"}, "edited": false, "score": 0, "creation_date": 1498707380, "post_id": 44815926, "comment_id": 76612022, "body": "my bad, I had typed wrap :: [a] -&gt; [a]"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1498707420, "post_id": 44815926, "comment_id": 76612032, "body": "Yes, before you can tell GHC what you want you must first know what you want. :)"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1498707577, "post_id": 44815926, "comment_id": 76612068, "body": "@ReinHenrichs if only it was a haskell extension that could infer an <i>implementation</i> from the signature... /me sighs"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1498708310, "post_id": 44815926, "comment_id": 76612263, "body": "@zerkms You should try Agda!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1498720300, "post_id": 44815926, "comment_id": 76617086, "body": "@zerkms Look up Djinn, on simple (non recursive) cases it often gets it right."}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 4, "last_activity_date": 1498707072, "creation_date": 1498707072, "answer_id": 44815926, "question_id": 44815858, "link": "https://stackoverflow.com/questions/44815858/wraps-around-each-top-level-element-of-list/44815926#44815926", "title": "wraps [] around each top-level element of list", "body": "<p><code>[wrap xs]</code> wraps the entire result of <code>wrap xs</code>. You don't want to wrap the entire result. You only want to wrap each individual element of the remainder of the list and that is exactly what <code>wrap xs</code> already does. Thus, <code>wrap</code> is:</p>\n\n<pre><code>wrap :: [a] -&gt; [[a]]\nwrap [] = []\nwrap (x:xs) = [x] : wrap xs\n</code></pre>\n\n<p>The error is telling you that you are trying to use a <code>[t]</code> where GHC expects a <code>t</code>. This is exactly what we said above, that you are wrapping something too many times.</p>\n"}], "owner": {"reputation": 1233, "user_id": 101326, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b67dd441d570e1913e87396718b70f48?s=128&d=identicon&r=PG", "display_name": "anru ", "link": "https://stackoverflow.com/users/101326/anru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 44815926, "answer_count": 1, "score": 1, "last_activity_date": 1498707072, "creation_date": 1498706599, "question_id": 44815858, "link": "https://stackoverflow.com/questions/44815858/wraps-around-each-top-level-element-of-list", "title": "wraps [] around each top-level element of list", "body": "<pre><code>wrap [1,2,3] should output [[1],[2],[3]]\nwrap [[1],[2],[3]] should output [ [[1]], [[2]], [[3]] ]\n</code></pre>\n\n<p>my implementation is:</p>\n\n<pre><code>wrap [] = []\nwrap (x:xs) = [x] :  [wrap xs]\n</code></pre>\n\n<p>and haskell output an error:  Occurs check: cannot construct the infinite type: t ~ [t]</p>\n\n<p>Expected type: [t] -> [t]\nActual type: [t] -> [[t]]</p>\n"}, {"tags": ["haskell", "checksum", "icmp"], "comments": [{"owner": {"reputation": 4578, "user_id": 5180047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Z8PTw2eJC9E/AAAAAAAAAAI/AAAAAAAAAco/2C4t6AgoQNc/photo.jpg?sz=128", "display_name": "Nick Brady", "link": "https://stackoverflow.com/users/5180047/nick-brady"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1498713648, "post_id": 44815097, "comment_id": 76613758, "body": "Perhaps, though your explanation is much clearer (at least to me). Also, I spent a while googling trying to find this answer.. it seems obvious now in hind sight seeing the link, but perhaps someone else will search in the same manner as I did and this will be helpful?"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1498714097, "post_id": 44815097, "comment_id": 76613940, "body": "That&#39;s OK, <a href=\"https://meta.stackexchange.com/a/10844/229359\">closed duplicates are not deleted</a> so someone else will be able to find it just the same."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498716934, "post_id": 44815627, "comment_id": 76615105, "body": "Answers in the linked question suggest you have to do this twice to make sure the high bits go to zero."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 5, "last_activity_date": 1498704804, "creation_date": 1498704804, "answer_id": 44815627, "question_id": 44815097, "link": "https://stackoverflow.com/questions/44815097/why-is-icmp-checksum-shifted-16-bits/44815627#44815627", "title": "why is ICMP checksum shifted 16 bits", "body": "<p><a href=\"http://www.faqs.org/rfcs/rfc1071.html\" rel=\"noreferrer\">RFC 1071</a> describes in detail the checksum definition, including this important part:</p>\n\n<blockquote>\n  <p>On a 2's complement machine, the 1's complement sum must be\n  computed by means of an \"end around carry\", i.e., any overflows\n  from the most significant bits are added into the least\n  significant bits. </p>\n</blockquote>\n\n<p>In your code,</p>\n\n<pre><code>total = sum (map fromIntegral ws) :: Word32\n</code></pre>\n\n<p>is the 32-bit sum, i.e. its low 16 bits is the sum without carries, and the high 16 bits will contain the sum of the carries. By using the fact that <code>fromIntegral :: Word32 -&gt; Word16</code> does truncation, we have</p>\n\n<pre><code>low = fromIntegral total :: Word16\nhigh = fromIntegral $ total `shiftR` 16 :: Word16\n</code></pre>\n\n<p>and so we can calculate the \"end around carry\" as</p>\n\n<pre><code>eac = low + high\n</code></pre>\n"}], "owner": {"reputation": 4578, "user_id": 5180047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-Z8PTw2eJC9E/AAAAAAAAAAI/AAAAAAAAAco/2C4t6AgoQNc/photo.jpg?sz=128", "display_name": "Nick Brady", "link": "https://stackoverflow.com/users/5180047/nick-brady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "closed_date": 1498715441, "accepted_answer_id": 44815627, "answer_count": 1, "score": 3, "last_activity_date": 1498713431, "creation_date": 1498700886, "last_edit_date": 1498713431, "question_id": 44815097, "link": "https://stackoverflow.com/questions/44815097/why-is-icmp-checksum-shifted-16-bits", "closed_reason": "Duplicate", "title": "why is ICMP checksum shifted 16 bits", "body": "<p>I'm struggling to understand why the ICMP checksum total (before being complemented) is the total + shifted right 16 bits total in <a href=\"https://github.com/thesealion/Learning-Haskell/blob/c1396a29b93db9166afe802d1aac49b209c2a859/ping.hs#L56\" rel=\"nofollow noreferrer\">this line of code</a>: </p>\n\n<pre><code>checksum bs = let bs' = (if (BL.length bs) `mod` 2 == 0 then bs else BL.snoc bs 0)\n                  ws = runGet listOfWord16 bs'\n                  total = sum (map fromIntegral ws) :: Word32\n              in complement (fromIntegral total + fromIntegral (total `shiftR` 16))\n</code></pre>\n\n<p><strong>RFC 792</strong> has this to say about calculating the checksum:</p>\n\n<blockquote>\n  <p>Checksum</p>\n  \n  <p>The checksum is the 16-bit ones's complement of the one's\n    complement sum of the ICMP message starting with the ICMP Type.\n    For computing the checksum , the checksum field should be zero.\n    If the total length is odd, the received data is padded with one\n    octet of zeros for computing the checksum.  This checksum may be\n    replaced in the future.</p>\n</blockquote>\n\n<p>I understand why <code>bs'</code> is calculated, as required by <em>\"If the total length is odd, the received data is padded with one octet of zeros for computing the checksum.\"</em></p>\n\n<p>I can also understand summing the total of the 16 bit words done in this line of the code <code>total = sum (map fromIntegral ws) :: Word32</code></p>\n\n<p>I just can't figure out why in this line of code:</p>\n\n<pre><code>complement (fromIntegral total + fromIntegral (total `shiftR` 16))\n</code></pre>\n\n<p>that <code>+ fromIntegral (total `shiftR` 16)</code> should be included at all.</p>\n\n<p>NOTE: I have verified with wireshark that the checksum is only correct if I complement the <code>total + total `shiftR` 16</code> as done in the linked line of code. So I know it is correct, I just don't understand why.</p>\n"}]