[{"tags": ["string", "parsing", "haskell", "tuples", "lambda-calculus"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1541629497, "post_id": 53198782, "comment_id": 93286155, "body": "Hint: use <code>chunksOf</code>: <a href=\"http://hackage.haskell.org/package/split-0.2.3.3/docs/Data-List-Split.html#v:chunksOf\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/split-0.2.3.3/docs/&hellip;</a>"}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541629672, "post_id": 53198782, "comment_id": 93286224, "body": "thank you @WillemVanOnsem unfortunately I can&#39;t import nothing."}, {"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 1, "creation_date": 1541631591, "post_id": 53198782, "comment_id": 93286902, "body": "Your simplest path if you are a beginner at haskell is to write out the recursive solution explicitly.  You might ask yourself, for example, what output you would expect if your string were empty.  Then you might ask yourself how you would handle a string that had two characters, followed by a string that might or might not be empty..."}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "reply_to_user": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1541632646, "post_id": 53198782, "comment_id": 93287270, "body": "Thank you @MarcTalbot, I already did the recursive solution of this, but I must use a map in the solution."}], "answers": [{"comments": [{"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1541632641, "post_id": 53199242, "comment_id": 93287268, "body": "I already did the recursive solution of this, but I must use a map in the solution."}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 1, "last_activity_date": 1541631928, "creation_date": 1541631928, "answer_id": 53199242, "question_id": 53198782, "link": "https://stackoverflow.com/questions/53198782/parse-string-to-list-of-binary-tuples/53199242#53199242", "title": "Parse String to list of binary tuples", "body": "<p>There's a few problems.</p>\n\n<ol>\n<li><p>The pattern <code>[a, b]</code> in <code>map (\\[a, b] -&gt; ...) x</code> only matches lists of two elements, so the compiler infers that the function <code>\\[a, b] -&gt; ...</code> has type <code>[r] -&gt; s</code> for some <code>r</code> and <code>s</code>.</p>\n\n<p>The compiler knows that <code>map</code> has the type <code>(u -&gt; v) -&gt; [u] -&gt; [v]</code>, so it unifies <code>u</code> with <code>[r]</code> and <code>v</code> with <code>s</code> to infer the type <code>[[r]] -&gt; [s]</code> for <code>map (\\[a, b] -&gt; ...)</code>.</p>\n\n<p>This means <code>x</code> must have type <code>[[r]]</code>, that is, it must be a list of lists. But you want <code>x</code> to be a <code>String</code> which is a synonym for <code>[Char]</code>. The compiler can't unify <code>[[r]]</code> and <code>[Char]</code>, so it objects.</p></li>\n<li><p>You're attempting to \"cast\" <code>a</code> to a <code>Char</code> and <code>b</code> to an <code>Int</code> like you would in C, but you can't do that in Haskell. If you want to convert a <code>Char</code> like <code>'1'</code> into the <code>Int</code> <code>1</code>, you need a different approach, like <code>read</code>, which you can use to convert from a <code>String</code> to an <code>Int</code>.</p></li>\n</ol>\n\n<p>Here's some advice. Don't use <code>map</code>. Try writing a recursive solution instead.</p>\n\n<p>Start by considering a few cases:</p>\n\n<ul>\n<li>what does <code>myParser \"\"</code> return?</li>\n<li>what does <code>myParser \"a1\"</code> return?</li>\n<li>what does <code>myParser [a,b]</code> return?</li>\n<li>what does <code>myParser (a:b:cs)</code> return?</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1541633900, "creation_date": 1541633900, "answer_id": 53199542, "question_id": 53198782, "link": "https://stackoverflow.com/questions/53198782/parse-string-to-list-of-binary-tuples/53199542#53199542", "title": "Parse String to list of binary tuples", "body": "<p>I came up with this but it's really not safe as it doesn't handle incorrect string like <code>\"AA11B2C3\"</code>!</p>\n\n<pre><code>splitingN :: Int -&gt; [a] -&gt; [[a]]\nsplitingN _ [] = []\nsplitingN n l\n  | n &gt; 0 = take n l : splitingN n (drop n l)\n  | otherwise = error \"uhhhhhh\"\n\ntuplify :: String -&gt; (Char, Int)\ntuplify a = (head a, read $ tail a)\n\nstringy :: String -&gt; [(Char, Int)]\nstringy s = tuplify &lt;$&gt; splitingN 2 s\n\n&gt; stringy \"A1B2C3D4\" == [('A',1),('B',2),('C',3),('D',4)]\n</code></pre>\n\n<p>A much nicer way but still not fully safe would be:</p>\n\n<pre><code>stringy :: [a] -&gt; [(a, a)]\nstringy [] = []\nstringy (a : b : rest) = (a, b) : splitting rest\nstringy [a] = error \"uhhhhh\"\n</code></pre>\n\n<p>Should really check if <code>a</code> and <code>b</code> from <code>(a : b : rest)</code> are indeed <code>Char</code> &amp; <code>Int</code>. Also this uses recursion and you mentioned using <code>map</code> so might not suffice and it's pretty polymorphic in it's types.</p>\n"}, {"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1541647576, "post_id": 53200332, "comment_id": 93290702, "body": "A couple minor improvements: <code>if x then True else False</code> = <code>x</code>, and <code>&quot;0123456789&quot;</code> = <code>[&#39;0&#39;..&#39;9&#39;]</code>. The pair of <code>filter</code>s makes me want <code>partition</code>, but with only Prelude functions this is good."}], "tags": [], "owner": {"reputation": 91, "user_id": 8191625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de65caf95710c13ed7d59d5fd8c5794b?s=128&d=identicon&r=PG&f=1", "display_name": "LearnYouACode", "link": "https://stackoverflow.com/users/8191625/learnyouacode"}, "is_accepted": false, "score": 2, "last_activity_date": 1541706401, "last_edit_date": 1541706401, "creation_date": 1541640691, "answer_id": 53200332, "question_id": 53198782, "link": "https://stackoverflow.com/questions/53198782/parse-string-to-list-of-binary-tuples/53200332#53200332", "title": "Parse String to list of binary tuples", "body": "<p>Well, <code>map</code> is really meant for applying a single function to every element of something, one-by-one. Splitting the string how you want requires context (knowing the next letter), so <code>map</code> isn't the best choice here.</p>\n\n<p>However, you said your solution is required to be in terms of <code>map</code>. It can be done, but it's a bit roundabout. I couldn't think of any way to make <code>map</code> split the actual string, but it can certainly be used to transform it to the correct type:</p>\n\n<pre><code>isDigit :: Char -&gt; Bool\nisDigit c = elem c ['0'..'9']\n\nsplit :: String -&gt; [(Char, Int)]\nsplit str = let chars  = filter (not . isDigit) str\n                nums   = filter isDigit str\n                zipped = zip chars nums in\n              map (\\(a, b) -&gt; (a, read [b])) zipped\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1141, "user_id": 1367497, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1ab83696683e53a9940cd2a8c480894?s=128&d=identicon&r=PG", "display_name": "peeyush singh", "link": "https://stackoverflow.com/users/1367497/peeyush-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1541645080, "creation_date": 1541645080, "answer_id": 53200824, "question_id": 53198782, "link": "https://stackoverflow.com/questions/53198782/parse-string-to-list-of-binary-tuples/53200824#53200824", "title": "Parse String to list of binary tuples", "body": "<p>As others have pointed out, you need to understand that <code>map</code> applies the given function over each member of the list. Once you understand that, you will realize that there is no way you can get the conversion you want by applying a function on the existing list.</p>\n\n<p>This leads to realization that once you have a list of \"A1\", \"B2\",... then you can take these and convert it using a map function.</p>\n\n<p>I have given the code for function below. The <code>split'</code> function is not safe as it can blow up in lot of cases (expected a string which can be perfectly split into 2 chars). I am also using the function <code>digitToInt</code>, for which you need to <code>import Data.Char</code>. You did say you want no import, in that case you can write your own <code>digitToInt</code> function, look into the library code, it is fairly straightforward.</p>\n\n<pre><code>import Data.Char\n\nsplit' :: String -&gt; [String]\nsplit' [] = []\nsplit' (x:y:xs) = (x:[y]) : split' xs\n\nconvert :: String -&gt; [(Char, Int)]\nconvert input = map (\\s -&gt; (s!!0 ,  digitToInt(s!!1) )) $ split' input\n</code></pre>\n"}], "owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1541706401, "creation_date": 1541629334, "last_edit_date": 1541630176, "question_id": 53198782, "link": "https://stackoverflow.com/questions/53198782/parse-string-to-list-of-binary-tuples", "title": "Parse String to list of binary tuples", "body": "<p>I'm trying to parse a string <code>\"A1B2C3D4\"</code> to <code>[('A',1),('B',2),('C',3)]</code> in Haskell.</p>\n\n<p>I'm trying to use a <code>map</code> like this <code>map (\\[a, b] -&gt; (a :: Char, b :: Int)) x</code> where <code>x</code> is the string.</p>\n\n<p>This is the function signature I need to follow <code>:: String -&gt; [(Char, Int)]</code>.</p>\n\n<p>Unfortunately i'm getting type mismatches, can anyone give any hint how to solve this?</p>\n\n<p>I'm in the right direction?</p>\n"}, {"tags": ["haskell", "fold"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 9, "creation_date": 1541621654, "post_id": 53197120, "comment_id": 93282767, "body": "<code>(++[])</code> is just <code>id</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1541622003, "post_id": 53197120, "comment_id": 93282914, "body": "I&#39;m not sure anyone would find <code>((:) x)</code> less clunky than <code>(x :)</code>."}, {"owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541622098, "post_id": 53197120, "comment_id": 93282937, "body": "@chepner I changed that one a few seconds ago lol."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1541622242, "post_id": 53197120, "comment_id": 93282997, "body": "@chepner what do you mean? (\u22a2 never (is clunky (notation &#39;prefix)))"}], "answers": [{"comments": [{"owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "edited": false, "score": 0, "creation_date": 1541623938, "post_id": 53197543, "comment_id": 93283795, "body": "I&#39;m not familiar with <code>Applicative</code> yet but thanks for the answer."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 2, "last_activity_date": 1541623530, "creation_date": 1541623530, "answer_id": 53197543, "question_id": 53197120, "link": "https://stackoverflow.com/questions/53197120/can-my-implementation-of-filter-be-improved/53197543#53197543", "title": "Can my implementation of filter be improved?", "body": "<p>You can use the <code>Applicative</code> instance of <code>(-&gt;) a</code> to make the lambda cleaner. But, if you want to use <code>foldr</code>, I don't think there's any substantial change you can effect:</p>\n\n<pre><code>myFilter f = foldr (bool id &lt;$&gt; (:) &lt;*&gt; f) []\n</code></pre>\n\n<p><code>bool id &lt;$&gt; (:) &lt;*&gt; f</code> means <code>\\x -&gt; bool id ((:) x) (f x)</code>. <code>bool id</code> has type <code>([a] -&gt; [a]) -&gt; Bool -&gt; ([a] -&gt; [a])</code>. <code>(:)</code> has type <code>a -&gt; [a] -&gt; [a]</code>, and <code>f</code> has type <code>a -&gt; Bool</code>. When <code>(&lt;$&gt;)</code> and <code>(&lt;*&gt;)</code> are used in this way, you can think of it as pretending that <code>(:)</code> and <code>f</code> don't have an <code>a</code> argument, making them <code>[a] -&gt; [a]</code> and <code>Bool</code>, respectively, applying them to <code>bool id</code> to get a <code>[a] -&gt; [a]</code>, and then ending the lie by reintroducing the <code>a</code> argument, making a <code>a -&gt; [a] -&gt; [a]</code>. The operators are in charge of threading that <code>a</code> around, so you don't need a lambda abstraction.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1541626355, "post_id": 53197571, "comment_id": 93284901, "body": "That applicative code is indeed quite obfuscated. I also greatly prefer the plain code below."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 5, "last_activity_date": 1541782818, "last_edit_date": 1541782818, "creation_date": 1541623676, "answer_id": 53197571, "question_id": 53197120, "link": "https://stackoverflow.com/questions/53197120/can-my-implementation-of-filter-be-improved/53197571#53197571", "title": "Can my implementation of filter be improved?", "body": "<p>I would <em>only</em> use <code>bool</code> if it let me get rid of the lambda expression simply, by composing a call to <code>bool</code> with the predicate <code>p</code>: <code>bool iffalse iftrue . p</code>. However, <code>p</code> isn't the only function that needs to be called on a list element; <code>(:)</code> does as well. You <em>could</em> use the <code>Applicative</code> instance for functions, to write</p>\n\n<pre><code>myfilter p = foldr (bool id . (:) &lt;*&gt; p) []  -- yuck\n</code></pre>\n\n<p>but in this case I would just use a plain <code>if</code> expression, inside the lambda expression:</p>\n\n<pre><code>myfilter p = foldr (\\x -&gt; if p x then (x:) else id) []  -- much clearer!\n</code></pre>\n\n<hr>\n\n<p>Note that when specialized to functions, the <code>Applicative</code>'s <code>(&lt;*&gt;)</code> operator is defined as <code>f &lt;*&gt; g = \\x -&gt; f x (g x)</code>. I leave it as an exercise to use that definition to transform <code>bool id . (:) &lt;*&gt; p</code> into\n<code>\\x -&gt; bool id (x:) (p x)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541697863, "post_id": 53208218, "comment_id": 93313789, "body": "I also sensed some Richard Bird in there, esp. at the start, from his &quot;theory of lists&quot;... :) is it so?"}, {"owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541699543, "post_id": 53208218, "comment_id": 93314534, "body": "Possibly, since my very first book on Haskell was his classic &quot;Introduction to Functional Programming using Haskell&quot;, but never read that particular paper to be honest."}], "tags": [], "owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "is_accepted": false, "score": 1, "last_activity_date": 1541706462, "last_edit_date": 1541706462, "creation_date": 1541681802, "answer_id": 53208218, "question_id": 53197120, "link": "https://stackoverflow.com/questions/53197120/can-my-implementation-of-filter-be-improved/53208218#53208218", "title": "Can my implementation of filter be improved?", "body": "<p>Rather than merely searching for a more elegant implementation, it would might help you more to learn an elegant process of searching for an implementation. This should make it simpler to find elegant solutions.  </p>\n\n<p>For any function <code>h</code> on lists we have that, </p>\n\n<pre><code>h = foldr f e \n</code></pre>\n\n<p>if and only if </p>\n\n<pre><code>h [] = e\nh (x:xs) = f x (h xs)\n</code></pre>\n\n<p>In this case your <code>h</code> is <code>filter p</code> for some boolean function <code>p</code> that selects which elements to keep. Implementing <code>filter p</code> as a \"simple\" recursive function is not too hard.</p>\n\n<pre><code>filter p [] = []\nfilter p (x:xs) = if p x then x : (filter p xs) else (filter p xs)\n</code></pre>\n\n<p>The 1st line implies <code>e = []</code>. The 2nd line needs to be written in the form <code>f x (filter p xs)</code> to match the equation of <code>h</code> above, in order for us to deduce which <code>f</code> to plug in  the <code>foldr</code>. To do that we just abstract over those two expressions. </p>\n\n<pre><code>filter p [] = []\nfilter p (x:xs) = (\\x ys -&gt; if p x then x : ys else ys) x (filter p xs)\n</code></pre>\n\n<p>So we have found that, </p>\n\n<pre><code>e = [] \nf x ys = if p x then x: ys else ys\n</code></pre>\n\n<p>It therefore follows, </p>\n\n<pre><code>filter p = foldr (\\y ys -&gt; if p y then y : ys else ys) []\n</code></pre>\n\n<p>To learn more about this method of working with <code>foldr</code> I recommend reading \n<a href=\"http://www.cs.nott.ac.uk/~pszgmh/fold.pdf\" rel=\"nofollow noreferrer\">\"A tutorial on the universality and expressiveness of fold\"</a> by Graham Hutton.</p>\n\n<p><strong>Some added notes:</strong> </p>\n\n<p>In case this seems overly complicated, note that while the principles above can be used in this \"semi rigorous\" fashion via algebraic manipulation, they can and should also be used to guide your intuition and aid you in informal development.</p>\n\n<p>The equation for <code>h (x:xs) = f x (h xs)</code> sheds some clarity on how to find <code>f</code>. In the case where <code>h</code> is the filtering function you want an <code>f</code> which combines the element <code>x</code> with a tail that has already been filtered. If you really understand this it should be easy to arrive at,</p>\n\n<pre><code>f x ys = if p x then x : ys else ys\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1541697815, "creation_date": 1541697815, "answer_id": 53213077, "question_id": 53197120, "link": "https://stackoverflow.com/questions/53197120/can-my-implementation-of-filter-be-improved/53213077#53213077", "title": "Can my implementation of filter be improved?", "body": "<p>Yes, there is:</p>\n\n<pre><code>myFilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nmyFilter f = foldMap (\\x -&gt; [x | f x])\n\n&gt; myFilter even [1..10]\n[2,4,6,8,10]\n</code></pre>\n\n<p>See, I switched it on you, with <code>foldMap</code>. </p>\n\n<p>Well, with <code>foldr</code> it is <code>foldr (\\x -&gt; ([x | f x] ++)) []</code>.</p>\n"}], "owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 53197571, "answer_count": 4, "score": 7, "last_activity_date": 1541782818, "creation_date": 1541621601, "question_id": 53197120, "link": "https://stackoverflow.com/questions/53197120/can-my-implementation-of-filter-be-improved", "title": "Can my implementation of filter be improved?", "body": "<p>An exercise in Haskell from First Principles says to implement <code>filter</code> using <code>foldr</code> and this is what I came up with but it feels and looks clunky. Is there a more natural way to implement it with a <code>foldr</code>?</p>\n\n<pre><code>import Data.Bool\nmyFilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nmyFilter f = foldr (\\x -&gt; bool (++ []) ((:) x) (f x)) []\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "edited": false, "score": 0, "creation_date": 1541998788, "post_id": 53196818, "comment_id": 93396946, "body": "Are you using someone&#39;s branch of <code>ghc-mod</code>? It seems the project proper does not yet support <code>ghc-8.4</code>. <a href=\"https://github.com/DanielG/ghc-mod/issues/931\" rel=\"nofollow noreferrer\">github.com/DanielG/ghc-mod/issues/931</a>"}, {"owner": {"reputation": 23, "user_id": 10619982, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jc0R0.jpg?s=128&g=1", "display_name": "DEzell", "link": "https://stackoverflow.com/users/10619982/dezell"}, "reply_to_user": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "edited": false, "score": 0, "creation_date": 1542079187, "post_id": 53196818, "comment_id": 93429515, "body": "Hi Dan:  I&#39;ve actually tried to stay as &quot;vanilla&quot; as possible, and downloaded 8.4.3 from here (for Mac) <a href=\"https://www.haskell.org/platform/mac.html\" rel=\"nofollow noreferrer\">haskell.org/platform/mac.html</a>.  I tried some other kinds of download (home-brew) but removed all that.  I&#39;ve always been mystified that the version is 8.4.3, yet it consistently seems to point at ghc-boot-8.4.4.  I am not using branches, nor am I downloading from git."}, {"owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "edited": false, "score": 0, "creation_date": 1542126782, "post_id": 53196818, "comment_id": 93453015, "body": "you also mentioned &quot;I\u2019m using lts-12.17&quot; which specifies <code>ghc-8.4.4</code>. Stack can install ghc-8.4.4 for you, and usually does by default, unless you have specified something in your stack.yaml that tells it not to."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10619982, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jc0R0.jpg?s=128&g=1", "display_name": "DEzell", "link": "https://stackoverflow.com/users/10619982/dezell"}, "edited": false, "score": 0, "creation_date": 1541630202, "post_id": 53197242, "comment_id": 93286417, "body": "I did run &quot;stack update&quot; again (no luck there).  I then changed the line in my configuration file ~/.stack/global-project/stack.yaml to &quot;resolver: its-12.14&quot;, removed ~/.stack/indices/Hackage directory, and reran &quot;stack update.&quot;  I still get the &quot;... not found in your indices:  ghc-boot-8.4.4."}, {"owner": {"reputation": 23, "user_id": 10619982, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jc0R0.jpg?s=128&g=1", "display_name": "DEzell", "link": "https://stackoverflow.com/users/10619982/dezell"}, "edited": false, "score": 0, "creation_date": 1541973805, "post_id": 53197242, "comment_id": 93391944, "body": "Hi Tylerweir:  I have a question about your answer.  You suggested GHC 8.4.3.  That&#39;s what I installed from Haskell.org.  The references are all what came down in the bundle.  Also, how do I change to lts-12-14?  Is that defined in the ~/.stack/global-project/stack.yaml file?  Here&#39;s the link to what I installed (GHC 8.4.3).  <a href=\"https://www.haskell.org/platform/mac.html\" rel=\"nofollow noreferrer\">haskell.org/platform/mac.html</a>  Thanks for the help"}, {"owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "reply_to_user": {"reputation": 23, "user_id": 10619982, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jc0R0.jpg?s=128&g=1", "display_name": "DEzell", "link": "https://stackoverflow.com/users/10619982/dezell"}, "edited": false, "score": 0, "creation_date": 1542028725, "post_id": 53197242, "comment_id": 93410199, "body": "@DEzell I would not install GHC that way, I would instead install stack and let it install GHC per project."}, {"owner": {"reputation": 23, "user_id": 10619982, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jc0R0.jpg?s=128&g=1", "display_name": "DEzell", "link": "https://stackoverflow.com/users/10619982/dezell"}, "edited": false, "score": 0, "creation_date": 1542135291, "post_id": 53197242, "comment_id": 93457453, "body": "Thanks @tylerwier, that was my original attempt to install.  The instructions recommended exactly what you&#39;re recommending:  <a href=\"https://github.com/simonmichael/haskell-atom-setup\" rel=\"nofollow noreferrer\">github.com/simonmichael/haskell-atom-setup</a>. I got exactly the same result when I got to the step to install ghc-mod."}], "tags": [], "owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "is_accepted": false, "score": 0, "last_activity_date": 1541622155, "creation_date": 1541622155, "answer_id": 53197242, "question_id": 53196818, "link": "https://stackoverflow.com/questions/53196818/haskell-stack-wont-load-ghc-mod/53197242#53197242", "title": "Haskell &quot;stack&quot; won&#39;t load ghc-mod", "body": "<p><code>ghc-boot</code> for 8.4.4 exists - <code>https://www.stackage.org/lts-12.17/package/ghc-boot-8.4.4</code></p>\n\n<p>If you run <code>stack update</code> and then try again, that may solve it.</p>\n\n<p>If not, then I would switch back to resolver <code>lts-12-14</code> and use GHC 8.4.3 instead.  </p>\n"}, {"tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": false, "score": 1, "last_activity_date": 1541975584, "creation_date": 1541975584, "answer_id": 53253918, "question_id": 53196818, "link": "https://stackoverflow.com/questions/53196818/haskell-stack-wont-load-ghc-mod/53253918#53253918", "title": "Haskell &quot;stack&quot; won&#39;t load ghc-mod", "body": "<p>ghc-boot-8.4.4 is not present on hackage, for some reason. (As of Nov 11, 2018)</p>\n\n<p><a href=\"http://hackage.haskell.org/package/ghc-boot\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/ghc-boot</a></p>\n\n<p>I'm not sure why stack would need to find it in the hackage index, though. It comes already installed with ghc.</p>\n"}], "owner": {"reputation": 23, "user_id": 10619982, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jc0R0.jpg?s=128&g=1", "display_name": "DEzell", "link": "https://stackoverflow.com/users/10619982/dezell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1542226031, "creation_date": 1541620339, "last_edit_date": 1542226031, "question_id": 53196818, "link": "https://stackoverflow.com/questions/53196818/haskell-stack-wont-load-ghc-mod", "title": "Haskell &quot;stack&quot; won&#39;t load ghc-mod", "body": "<p>I think I might have created confusion.  Here are bash command line entries I used to install Stack to start with:  </p>\n\n<pre><code>curl -sSL https://get.haskellstack.org/ | sh  \necho 'export PATH=\\$HOME/.local/bin:\\$PATH' &gt;&gt; ~/.bashrc  \nstack setup\n</code></pre>\n\n<p>So far this works, and I can test the compiler and the interactive environment and they work fine (ghc and ghci).</p>\n\n<p>Then, when I try to install ghc-mod, it fails:  </p>\n\n<pre><code>stack install ghc-mod\n</code></pre>\n\n<p>This command fails saying that ghc-boot-8.4.4 is not in my indices.  I get the same error if I remove everything, start over, and install the bundled version (Haskell.org).</p>\n\n<p>Again, any help much appreciated.</p>\n\n<p>=== Previous post ===\nAll:\nA few more details.  I have tried the suggestions, and I've also tried removing the ~/.stack/indices directory and then running \"stack update\" to refresh it.</p>\n\n<p>The same error still happens when trying to do \"stack install ghc-mod\" or \"stack build ghc-mod\", i.e. \"The following package identifiers were not found in your indices: ghc-boot-8.4.4.\"</p>\n\n<p>Any help much appreciated.</p>\n\n<p>Best regards, David</p>\n\n<p>=== Original Question ===\nProblem: stack install ghc-mod fails, missing ghc-boot-8.4.4</p>\n\n<p>My question is:\u00a0 how do I get my environment to load the required modules (ghc-boot) into the index?</p>\n\n<p>Hello All:\nMy apologies in advance for being an absolute newbie to Haskell.\u00a0 Better late than never.  Here\u2019s the background.</p>\n\n<p>My goal is to get \u201cAtom with Haskell\u201d working on My MacOS version 10.13.6.</p>\n\n<p>There are a couple of thoughtful pages that attempt to lead one through getting things to work:\n    <a href=\"http://www.jkrause.io/blog/2016/03/26/setup-atom-io-for-developing-haskell-on-osx/\" rel=\"nofollow noreferrer\">http://www.jkrause.io/blog/2016/03/26/setup-atom-io-for-developing-haskell-on-osx/</a>\n    <a href=\"https://github.com/simonmichael/haskell-atom-setup\" rel=\"nofollow noreferrer\">https://github.com/simonmichael/haskell-atom-setup</a></p>\n\n<p>I have attempted to follow these instructions loading the GHC environment, and I\u2019ve also tried loading the complete platform:\n    <a href=\"https://www.haskell.org/platform/mac.html\" rel=\"nofollow noreferrer\">https://www.haskell.org/platform/mac.html</a></p>\n\n<p>GHC and GHCi appear to work just fine in all three cases.</p>\n\n<p>The problem comes with the following step, and happens the same way following either of the two sets of instructions:</p>\n\n<p>$ stack install ghc-mod</p>\n\n<pre><code>Didn't see ghc-boot-8.4.4 in your package indices\nUpdating and trying again.\nSelected mirror https://s3.amazonaws.com/hackage.fpcomplete.com/\u00a0 \u00a0 \u00a0 \u00a0   \nDownloading timestamp \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\nNo updates to your package index were found \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \nUpdate complete \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\nThe following package identifiers were not found in your indices: ghc-boot-8.4.4\nPossible candidates: ghc-boot-8.4.3, ghc-boot-8.4.1, ghc-boot-8.4.2.\n</code></pre>\n\n<p>I\u2019ve tried many things, but have been unable to move past this error, i.e. that ghc-boot-8.4.4 is not found in my index.\u00a0 I\u2019m using lts-12.17.\u00a0 Examining the page for its-12.17, it appears that ghc-boot-8.4.4 should be in the index, see <a href=\"https://www.stackage.org/lts-12.17\" rel=\"nofollow noreferrer\">https://www.stackage.org/lts-12.17</a>.</p>\n\n<p>Thanks, David\n\u00a0</p>\n"}, {"tags": ["ubuntu", "haskell", "terminal"], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1541620697, "post_id": 53196560, "comment_id": 93282297, "body": "That behaviour of the <code>Show</code> instance is due for an overhaul... I don&#39;t think Unicode characters should pose much of a problem anywhere anymore."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541621153, "post_id": 53196560, "comment_id": 93282522, "body": "@leftaroundabout I agree. Escapes should only be used for non printable or otherwise &quot;funny&quot; characters. (During debugging it&#39;s still useful to see the escapes, sometimes, to distinguish between similar but different chars)"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1541621754, "post_id": 53196560, "comment_id": 93282816, "body": "At the very least, it would be nice for such a function (one that escapes only the &quot;funny&quot; characters) to exist in <code>base</code>."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1543441497, "post_id": 53196560, "comment_id": 93925904, "body": "@leftaroundabout printing non-ascii characters on Windows using the functions in <code>System.IO</code> is still dangerous."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1543447302, "post_id": 53196560, "comment_id": 93927757, "body": "@JeremyList the functions from <code>System.IO</code> just encode string to UTF-8. That should be safe on any system with 8-bit bytes, i.e. on any system. Whether these characters can actually be <i>displayed</i> is another question, but it should at any rate be safe to try. If the Windows console for some reason can&#39;t handle it (which would be utterly pathetic), that means it is broken and shouldn&#39;t be used."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1543450004, "post_id": 53196560, "comment_id": 93928457, "body": "@leftaroundabout <code>System.IO</code> on Windows doesn&#39;t just use UTF-8: it checks the encoding of the associated windows console and uses that; by default throwing an exception on any unsupported character (<code>hSetEncoding</code> and friends are needed to avoid this)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1543450152, "post_id": 53196560, "comment_id": 93928491, "body": "Ok, so what&#39;s unsafe then?"}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1543450615, "post_id": 53196560, "comment_id": 93928567, "body": "The exceptions make it unsafe."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1543452399, "post_id": 53196560, "comment_id": 93928971, "body": "There&#39;s nothing really worrying about an exception in GHCi."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1543483412, "post_id": 53196560, "comment_id": 93938768, "body": "GHCi raises an exception since the windows console can&#39;t handle the unicode chars. This should not happen for an output message. I can&#39;t blame GHCi for this: it has no alternative. Instead, the windows console should handle unicode more gracefully: as it is, it is broken. <code>chcp 65001</code> handles some unicode (even if it prints garbage for non ascii chars), and should be the default encoding for the console. Some crashes still happen, though. WinGHCi is similarly broken. The only almost sane option seems to be ConEmu (non-wide-char output is ok, keyboard input still broken)."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1541619632, "last_edit_date": 1541619632, "creation_date": 1541619302, "answer_id": 53196560, "question_id": 53196301, "link": "https://stackoverflow.com/questions/53196301/why-russian-characters-are-displayed-incorrectly/53196560#53196560", "title": "Why Russian characters are displayed incorrectly?", "body": "<p>You are probably calling <code>show</code> on strings. This may also happen implicitly, e.g. by <code>print</code>, or by asking GHCi to print a string.</p>\n\n<p>Consider this GHCi session:</p>\n\n<pre><code>&gt; str = \"\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430\"                                           \n&gt; str                                                          \n\"\\1055\\1086\\1078\\1072\\1083\\1091\\1081\\1089\\1090\\1072\"                  \n</code></pre>\n\n<p>The variable <code>str</code> contains the right string. When we ask GHCi to print it, it calls <code>print str</code> implicitly, which calls <code>show</code>.</p>\n\n<p><code>show</code>, in turn, converts a string into a ASCII escaped form, turning all non-printable characters into escape sequences.</p>\n\n<p>I stress that the string <code>str</code> is indeed the intended string: we can print it correctly if we use <code>putStrLn</code>, for instance:</p>\n\n<pre><code>&gt; putStrLn str\n\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430\n</code></pre>\n\n<p>Note that if you call <code>show</code> on a data type which contains a <code>String</code> inside (e.g. inside a constructor like <code>InvalidDate</code>), then that will in turn call <code>show</code> on the string, producing the unwanted escapes.</p>\n\n<p>I would suggest to write a custom pretty-printer for your type and use that, so that strings are not mangled by this escaping.</p>\n"}], "owner": {"reputation": 7, "user_id": 10479712, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YF0cZu3Saq0/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DXSc2LVlx58EBWp06qhvwEGMwRBUg/mo/photo.jpg?sz=128", "display_name": "juice", "link": "https://stackoverflow.com/users/10479712/juice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "closed_date": 1541620801, "answer_count": 1, "score": 0, "last_activity_date": 1541660281, "creation_date": 1541618226, "last_edit_date": 1541660281, "question_id": 53196301, "link": "https://stackoverflow.com/questions/53196301/why-russian-characters-are-displayed-incorrectly", "closed_reason": "Duplicate", "title": "Why Russian characters are displayed incorrectly?", "body": "<p>When I run the program, I see the following:</p>\n\n<pre><code>\u03bb ashot Weather \u2192 \u03bb git master* \u2192 stack exec Weather-exe\n\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u0434\u043b\u044f \u043f\u0440\u043e\u0433\u043d\u043e\u0437\u0430 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u0413\u0413\u0413\u0413-\u041c\u041c-\u0414\u0414:\n2018-11-07\n\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043e\u0434\u0438\u043d \u0438\u0437 \u044d\u0442\u0438\u0445 \u043c\u0430\u0440\u0437\u043e\u0432: [Aragatsotn,Ararat,Armavir,Dilijan,Gegharkunik,Gyumri,Kotayk,Shirak,Syunik,Vanadzor,Yerevan]\nYerevan \n</code></pre>\n\n<p>Everything is working.\nBut when I enter something wrong I get it:</p>\n\n<p><code>InvalidDate \"\\1058\\1077\\1082\\1089\\1090, \\1082\\1086\\1090\\1086\\1088\\1099\\1081 \\1074\\1099 \\1074\\1074\\1077\\1083\\1080 - \\1101\\1090\\1086 \\1082\\1072\\1082\\1072\\1103-\\1090\\1086 \\1073\\1077\\1083\\1080\\1073\\1077\\1088\\1076\\1072!\"</code></p>\n\n<p>But instead of these figures 1072/1052 ... I should receive the text in Russian.\nHow can I fix this so that Russian characters are displayed correctly?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1541614028, "post_id": 53195211, "comment_id": 93279208, "body": "There are multiple lists inside the outer one. It isn&#39;t clear which one you want to check the length of."}, {"owner": {"reputation": 25, "user_id": 7817987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OiENf.jpg?s=128&g=1", "display_name": "Kyriakos Hadjipandeli", "link": "https://stackoverflow.com/users/7817987/kyriakos-hadjipandeli"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1541614170, "post_id": 53195211, "comment_id": 93279261, "body": "I want to check if the lists inside the big one have a length (&gt;=) to 3"}, {"owner": {"reputation": 25, "user_id": 7817987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OiENf.jpg?s=128&g=1", "display_name": "Kyriakos Hadjipandeli", "link": "https://stackoverflow.com/users/7817987/kyriakos-hadjipandeli"}, "reply_to_user": {"reputation": 97030, "user_id": 189205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c60305494593d556e57a3cf8e4a8c163?s=128&d=identicon&r=PG", "display_name": "interjay", "link": "https://stackoverflow.com/users/189205/interjay"}, "edited": false, "score": 0, "creation_date": 1541614231, "post_id": 53195211, "comment_id": 93279295, "body": "I corrected the question to be more clear"}, {"owner": {"reputation": 2043, "user_id": 2676937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d42ec82c3feefc3c7e13b37dae77f21?s=128&d=identicon&r=PG", "display_name": "merlyn", "link": "https://stackoverflow.com/users/2676937/merlyn"}, "edited": false, "score": 0, "creation_date": 1541614694, "post_id": 53195211, "comment_id": 93279504, "body": "So, are you trying to find out if the length of inner lists are all greater than or equal to 3?"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 0, "creation_date": 1541616080, "post_id": 53195211, "comment_id": 93280118, "body": "What have you tried so far?  Have you written other functions that work on lists?  This will help us give an answer that uses things you already know."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1541617175, "post_id": 53195211, "comment_id": 93280602, "body": "<code>and</code> and <code>or</code> are your friends in this quest."}], "answers": [{"tags": [], "owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "is_accepted": true, "score": 2, "last_activity_date": 1541619717, "last_edit_date": 1541619717, "creation_date": 1541618525, "answer_id": 53196378, "question_id": 53195211, "link": "https://stackoverflow.com/questions/53195211/length-of-a-list-inside-a-list-and-return-boolean/53196378#53196378", "title": "Length of a list inside a list and return boolean", "body": "<p>Possible solution using the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#g:14\" rel=\"nofollow noreferrer\"><code>all</code></a> function:</p>\n\n<pre><code>check :: [[Bool]] -&gt; Bool\ncheck = all ((&gt;=3) . length)\n</code></pre>\n\n<p>The <code>all</code> function will return <code>True</code> when every element satisfies a predicate; in this case the predicate <code>(&gt;=3) . length</code> evaluates to <code>True</code> when a list's length is greater than or equal to three. So, if <code>all</code> the inner lists have a length greater than or equal to three, then <code>check</code> evaluates to <code>True</code>.</p>\n\n<p>Using the code you've provided and avoiding point-free style, maybe this will help piece together the above solution:</p>\n\n<pre><code>lengthGreaterEqualThree :: [Bool] -&gt; Bool\nlengthGreaterEqualThree xs = length xs &gt;= 3\n\ncheck' :: [[Bool]] -&gt; Bool\ncheck' listOfLists = all lengthGreaterEqualThree listOfLists\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1541619494, "creation_date": 1541619494, "answer_id": 53196604, "question_id": 53195211, "link": "https://stackoverflow.com/questions/53195211/length-of-a-list-inside-a-list-and-return-boolean/53196604#53196604", "title": "Length of a list inside a list and return boolean", "body": "<p>Here's four solutions:</p>\n\n<h3>Explicit recursion</h3>\n\n<pre><code>allLongerThanThree :: [[a]] -&gt; Bool\nallLongerThanThree []     = True\nallLongerThanThree (x:xs) = (length x) &gt;= 3 &amp;&amp; allLongerThanThree xs\n</code></pre>\n\n<h3>Map and <code>and</code></h3>\n\n<pre><code>allLongerThanThree :: [[a]] -&gt; Bool\nallLongerThanThree = and . fmap ((&gt;=3) . length)\n</code></pre>\n\n<h3>Folding</h3>\n\n<pre><code>allLongerThanThree :: [[a]] -&gt; Bool\nallLongerThanThree = (foldr ((&amp;&amp;) . (&gt;=3) . length) True)\n</code></pre>\n\n<h3>Using <code>all</code></h3>\n\n<pre><code>allLongerThanThree :: [[a]] -&gt; Bool\nallLongerThanThree = all ((&gt;=3) . length)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1541620523, "creation_date": 1541620523, "answer_id": 53196859, "question_id": 53195211, "link": "https://stackoverflow.com/questions/53195211/length-of-a-list-inside-a-list-and-return-boolean/53196859#53196859", "title": "Length of a list inside a list and return boolean", "body": "<p>If all the sublists have length 3 or greater, then the list of sublists <em>shorter</em> than 3 should be empty:</p>\n\n<pre><code>hasShortLists :: [[a]] -&gt; Bool  -- The contents of the inner lists doesn't matter\nhasShortLists = null . filter ((&lt;3) . length)\n</code></pre>\n\n<p>(This is basically deconstructing <code>all</code> a notch; it's also equivalent to <code>not . any ((&lt; 3) . length)</code>.)</p>\n"}], "owner": {"reputation": 25, "user_id": 7817987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OiENf.jpg?s=128&g=1", "display_name": "Kyriakos Hadjipandeli", "link": "https://stackoverflow.com/users/7817987/kyriakos-hadjipandeli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 53196378, "answer_count": 3, "score": 1, "last_activity_date": 1541620523, "creation_date": 1541613827, "last_edit_date": 1541614206, "question_id": 53195211, "link": "https://stackoverflow.com/questions/53195211/length-of-a-list-inside-a-list-and-return-boolean", "title": "Length of a list inside a list and return boolean", "body": "<p>I am fairly new to Haskell and I am trying to find the length of a list inside a list and return true if it is more than 3 and vise versa.\nFor example:</p>\n\n<pre><code>[[Bool]] -&gt; Bool\nxs = length xs &gt;= 3\n</code></pre>\n\n<p>This returns true if the outer list is equal or over 3, but I want to check if the inner lists have the same argument.\nAlso, I know that map length produces a list of the length of the 2nd list.</p>\n\n<pre><code>[[T,F,T],[F,F,T],[F,F]] -- output : False\n[[T,F,T],[F,F,T],[T,F,F]] -- output : True\n</code></pre>\n\n<p>This is what I am expecting to find.</p>\n\n<p>I hope the explanation of my problem is clear, thanks.</p>\n"}, {"tags": ["haskell", "tuples", "element"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1541611487, "post_id": 53194251, "comment_id": 93278001, "body": "if you&#39;re adding the first and second elements you&#39;re probably doing the computations wrong."}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 3507206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/848870b4043d5ca319aa3111cb55845b?s=128&d=identicon&r=PG", "display_name": "tejasbubane", "link": "https://stackoverflow.com/users/3507206/tejasbubane"}, "is_accepted": false, "score": 1, "last_activity_date": 1541610411, "creation_date": 1541610411, "answer_id": 53194372, "question_id": 53194251, "link": "https://stackoverflow.com/questions/53194251/accessing-certain-elements-of-tuples/53194372#53194372", "title": "Accessing certain elements of tuples", "body": "<p>Since this is university studies I won't give the entire answer right away but will point you to read up on <a href=\"https://www.haskell.org/tutorial/patterns.html\" rel=\"nofollow noreferrer\">pattern matching</a> and <a href=\"https://en.wikibooks.org/wiki/Haskell/Pattern_matching#Tuple_constructors\" rel=\"nofollow noreferrer\">tuple constructor</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "edited": false, "score": 0, "creation_date": 1541611230, "post_id": 53194378, "comment_id": 93277868, "body": "damn I ruthless just came out with the answer!! sorry :S"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1541620686, "post_id": 53194378, "comment_id": 93282289, "body": "I think this is fine, I don&#39;t see how it&#39;s pedagogically helpful not to reveal the <i>syntax</i> of what they&#39;re trying to do.  There&#39;s nothing to &quot;think through&quot; here."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1541627530, "post_id": 53194378, "comment_id": 93285390, "body": "This is fine as it is. You didn&#39;t solve the full task of the OP: the OP also needs to compute the taxi distance, and that will involve a (slightly) more complex formula. Revealing &quot;how to access the pair components&quot; is perfectly OK, since you can find it on books anyway. What is usually frowned upon (IMO) is to answer a much more broad question dumping the full solution, without a careful explanation. Doing that would only allow the OP to copy&amp;paste their homework, with no chance of actually learning anything. But you didn&#39;t do that :)"}], "tags": [], "owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "is_accepted": false, "score": 4, "last_activity_date": 1541610430, "creation_date": 1541610430, "answer_id": 53194378, "question_id": 53194251, "link": "https://stackoverflow.com/questions/53194251/accessing-certain-elements-of-tuples/53194378#53194378", "title": "Accessing certain elements of tuples", "body": "<p>you can use the functions <a href=\"https://www.stackage.org/haddock/lts-12.17/base-4.11.1.0/Prelude.html#v:fst\" rel=\"nofollow noreferrer\">fst</a> + <a href=\"https://www.stackage.org/haddock/lts-12.17/base-4.11.1.0/Prelude.html#v:snd\" rel=\"nofollow noreferrer\">snd</a> like this:</p>\n\n<pre><code>taxiDistance :: (Integer, Integer) -&gt; (Integer, Integer) -&gt; Integer\ntaxiDistance x y = fst x + fst y\n</code></pre>\n\n<p>or alternatively you can deconstruct the tuples in the declaration like:</p>\n\n<pre><code>taxiDistance :: (Integer, Integer) -&gt; (Integer, Integer) -&gt; Integer\ntaxiDistance (a,b) (c,d) = a + b + c + d\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 9224926, "user_type": "registered", "profile_image": "https://graph.facebook.com/591499281228577/picture?type=large", "display_name": "Mathmeeeeen", "link": "https://stackoverflow.com/users/9224926/mathmeeeeen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541610430, "creation_date": 1541609937, "question_id": 53194251, "link": "https://stackoverflow.com/questions/53194251/accessing-certain-elements-of-tuples", "title": "Accessing certain elements of tuples", "body": "<p>I have to solve a problem for university studies. So what I want basically is that I want to access certain elements two 2-tuples. I already defined a function:</p>\n\n<pre><code>taxiDistance :: (Integer, Integer) -&gt; (Integer, Integer) -&gt; Integer\n</code></pre>\n\n<p>as you can see the function takes two 2-tuples containing integers and returns a integer.\nAnd now I have to add the first elements of both tuples and 2nd of both. And I don't now how to access these values which were put in by a user before.  </p>\n\n<p>Thank you for your help.</p>\n"}, {"tags": ["haskell", "compiler-errors", "literate-programming"], "comments": [{"owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "edited": false, "score": 2, "creation_date": 1541609371, "post_id": 53193807, "comment_id": 93276867, "body": "if you&#39;re using prelude&#39;s maximum you don&#39;t even need to use it and just have <code>(z-z&#39;)</code>"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1541609753, "post_id": 53193807, "comment_id": 93277087, "body": "This doesn\u2019t directly answer your question, but it may add some additional context: it\u2019s probably worth pointing out that Hugs hasn\u2019t been updated in more than a decade, while GHC is actively developed."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1541609932, "post_id": 53193807, "comment_id": 93277186, "body": "You want to use <code>max 0 (z - z&#39;)</code>. <code>maximum</code> finds the largest value in a list, not the larger of two arguments."}], "answers": [{"comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 3, "creation_date": 1541615339, "post_id": 53195162, "comment_id": 93279792, "body": "In order for it to work the way that you want, you must do the same in GHC. The version of <code>maximum</code> you want takes in a list (which is given with square braces). In GHC, <code>maximum</code> is generalized to work over any <code>Traversable</code>. Pair types are a kind of <code>Traversable</code>, but not the kind you want: due to how the <code>Traversable</code> instance for pairs work, <code>maximum (a,b)</code> will <i>always</i> be <code>b</code>. The reason for this is probably outside the scope of this question (it is a controversial decision though). What you should really use for finding the maximum of two values, as suggested by @chepner, is <code>max a b</code>."}], "tags": [], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "is_accepted": true, "score": 0, "last_activity_date": 1541613663, "creation_date": 1541613663, "answer_id": 53195162, "question_id": 53193807, "link": "https://stackoverflow.com/questions/53193807/literate-haskell-type-error-in-application/53195162#53195162", "title": "literate haskell - Type error in application", "body": "<pre><code>&gt; newtype IN_0 = IN_0 Integer deriving Show\n\n&gt; nminus :: IN_0 -&gt; IN_0 -&gt; IN_0\n&gt; nminus (IN_0 z) (IN_0 z')\n&gt;        | z &gt;= 0 &amp;&amp; z' &gt;= 0 = IN_0 $ maximum [0,z-z']\n&gt;        | otherwise = IN_0 0\n</code></pre>\n\n<p>In Hugs you have to use [Square] brackets when using maximum</p>\n"}], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 53195162, "answer_count": 1, "score": 0, "last_activity_date": 1541613663, "creation_date": 1541608410, "last_edit_date": 1541609235, "question_id": 53193807, "link": "https://stackoverflow.com/questions/53193807/literate-haskell-type-error-in-application", "title": "literate haskell - Type error in application", "body": "<p>Here is my code:</p>\n\n<pre><code>&gt; newtype IN_0 = IN_0 Integer deriving Show\n\n&gt; nminus :: IN_0 -&gt; IN_0 -&gt; IN_0\n&gt; nminus (IN_0 z) (IN_0 z')\n&gt;        | z &gt;= 0 &amp;&amp; z' &gt;= 0 = IN_0 $ maximum(0,z-z')\n&gt;        | otherwise = IN_0 0\n</code></pre>\n\n<p>When I compile this in ghci it compiles without error, but when I try to compile it in hugs I get this error message:</p>\n\n<pre><code>ERROR \"untitled.lhs\":51 - Type error in application\n*** Expression     : maximum (0,z - z')\n*** Term           : (0,z - z')\n*** Type           : (b,Integer)\n*** Does not match : [a]\n</code></pre>\n\n<p>Why ? </p>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 4423652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQH9m.gif?s=128&g=1", "display_name": "Sam Prescott", "link": "https://stackoverflow.com/users/4423652/sam-prescott"}, "edited": false, "score": 0, "creation_date": 1541609515, "post_id": 53193868, "comment_id": 93276961, "body": "Thanks a lot! I&#39;d tried this but forgotten to enable the ScopedTypeVariables extension :)"}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 65, "user_id": 4423652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQH9m.gif?s=128&g=1", "display_name": "Sam Prescott", "link": "https://stackoverflow.com/users/4423652/sam-prescott"}, "edited": false, "score": 2, "creation_date": 1541611623, "post_id": 53193868, "comment_id": 93278078, "body": "ScopedTypeVariables is on my short list of &quot;would like to see enabled by default in future GHC&quot; :)"}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 2, "last_activity_date": 1541608572, "creation_date": 1541608572, "answer_id": 53193868, "question_id": 53193618, "link": "https://stackoverflow.com/questions/53193618/could-not-deduce-show-a10-arising-from-a-use-of-def/53193868#53193868", "title": "Could not deduce (Show a10) arising from a use of \u2018def\u2019", "body": "<p>You probably intend that <code>def</code> and <code>def &amp; nodeDrawFunction .~ drawDefaultNode</code> have the same type.  <code>nodeDrawFunction</code> is flexible enough to allow them to have different types, <code>Settings a</code> and <code>Settings a10</code>.  GHC is starting with this more general assumption, and then can't pick a specific type for <code>a10</code>, since it's not constrained by anything in the function.</p>\n\n<p>One option is to define <code>nodeDrawFunction</code> with a less general type.</p>\n\n<p>Another option is to add a type signature on <code>def</code> to guide GHC.  I think this will work if you add <code>-XScopedTypeVariables</code>:</p>\n\n<pre><code>(def :: Settings a) &amp; nodeDrawFunction .~ drawDefaultNode\n</code></pre>\n\n<p>Without <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#lexically-scoped-type-variables\" rel=\"nofollow noreferrer\">ScopedTypeVariables</a> the two type variables <code>a</code> are interpreted as different, and given different unique names before type checking.  If you had multiple fields in <code>Settings</code> that involve <code>a</code>, <code>makeLenses</code> would derive lenses that cannot change <code>a</code>, since no single-field lens could do so.</p>\n"}], "owner": {"reputation": 65, "user_id": 4423652, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YQH9m.gif?s=128&g=1", "display_name": "Sam Prescott", "link": "https://stackoverflow.com/users/4423652/sam-prescott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 53193868, "answer_count": 1, "score": 1, "last_activity_date": 1541608572, "creation_date": 1541607773, "question_id": 53193618, "link": "https://stackoverflow.com/questions/53193618/could-not-deduce-show-a10-arising-from-a-use-of-def", "title": "Could not deduce (Show a10) arising from a use of \u2018def\u2019", "body": "<p>I have been stuck on this error for quite a while. I'm not sure if I am being stupid but I cannot see where it is coming from...</p>\n\n<p>The data type <code>Settings</code> is defined as so:</p>\n\n<pre><code>data Settings a = Settings { \n         _nodeDrawFunction :: a -&gt; Diagram B\n       , _dynamicHead :: Measure Double\n       , _dynamicThick :: Measure Double\n       , _directed :: Directed\n       , _horizontalOrientation :: Maybe Bool\n       , _layerSpacing :: Maybe Double\n       , _nodeSpacing :: Maybe Double\n       , _graphPadding :: Maybe Double\n       , _colF :: Maybe (Int -&gt; Colour Double)\n       , _bgOp :: Maybe Double\n       , _initPos :: Maybe Int\n      }\n</code></pre>\n\n<p>And <code>makeLenses ''Settings</code> is used to create lenses for each record. The default for <code>_drawNodeFunction</code> is <code>drawDefaultNode</code>.</p>\n\n<p>When I create a function overwriting some of these values using Lens setters it works fine, for example: </p>\n\n<pre><code>test1 :: (Show a) =&gt; Graph a -&gt; Settings a\ntest1 g = def &amp; bgOp .~ Just 1\n</code></pre>\n\n<p>Which works as expected. The type of <code>Graph</code> is from the library algebraic-graphs.</p>\n\n<p>If I try to set <code>nodeDrawFunction</code>, for example with:</p>\n\n<pre><code>test2 :: (Show a) =&gt; Graph a -&gt; Settings a\ntest2 g = def &amp; nodeDrawFunction .~ drawDefaultNode\n              &amp; bgOp .~ Just 1\n</code></pre>\n\n<p>The following error is produced:</p>\n\n<pre><code>Could not deduce (Show a10) arising from a use of \u2018def\u2019\n  from the context: Show a\n    bound by the type signature for:\n               test2 :: forall a. Show a =&gt; Graph a -&gt; Settings a\n    at Visualise/Hierarchical.hs:78:1-42\n  The type variable \u2018a10\u2019 is ambiguous\n  These potential instances exist:\n    instance Show n =&gt; Show (Duration n) -- Defined in \u2018Data.Active\u2019\n    instance Show n =&gt; Show (Era n) -- Defined in \u2018Data.Active\u2019\n    instance Show n =&gt; Show (Time n) -- Defined in \u2018Data.Active\u2019\n    ...plus 74 others\n    ...plus 264 instances involving out-of-scope types\n    (use -fprint-potential-instances to see them all)\n\u2022 In the first argument of \u2018(&amp;)\u2019, namely \u2018def\u2019\n  In the first argument of \u2018(&amp;)\u2019, namely\n    \u2018def &amp; nodeDrawFunction .~ drawDefaultNode\u2019\n  In the expression:\n    def &amp; nodeDrawFunction .~ drawDefaultNode &amp; bgOp .~ Just 1\n</code></pre>\n\n<p>Even if I try to set <code>nodeDrawFunction</code> to the default value (as well as any other valid function).</p>\n\n<p>Any help would be much appreciated, thanks!</p>\n"}, {"tags": ["haskell", "error-handling", "exception-handling", "user-input"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1541602154, "post_id": 53191510, "comment_id": 93272380, "body": "It probably comes down what type class instances are defined for <code>Except</code>; you can convert between <code>Except</code> and <code>Either</code> using <code>except</code> and <code>runExcept</code>."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541602639, "post_id": 53191510, "comment_id": 93272708, "body": "@chepner Ah, so there&#39;s some fluidity there, wrt. tuning <code>Except</code> vs <code>Either</code> depending on context."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541602721, "post_id": 53191510, "comment_id": 93272760, "body": "Here <a href=\"https://github.com/orome/crypto-enigma-hs/blob/develop/Crypto/Enigma.hs#L319\" rel=\"nofollow noreferrer\">in my package</a>, FWIW, getting a valid <code>AThing</code> is really essential, and entering valid args can be a bit tricky. So failure from user input (e.g. from a typo) can be common; but in code, something would have had to go quite wrong with whatever was generating the arguments: code that supplied bad arguments would be doing a bad job of making <code>AThing</code>s."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541602730, "post_id": 53191510, "comment_id": 93272764, "body": "So, naively, the former case is like an &quot;either&quot; or even a &quot;maybe&quot; (it could happen fix it and try again), while the latter is closer to an &quot;exception&quot; (your code isn&#39;t specifying <code>AThing</code>s correctly)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1541603070, "post_id": 53191510, "comment_id": 93273059, "body": "You&#39;ll have to wait for someone who actually knows to provide an answer :) I <i>think</i> the only real difference is that the name <code>ExceptT</code> was introduced to provide a type that was semantically devoted to error handling, as opposed to <code>Either</code> which is the generic way to define sum types, only one application of which is to provide error-handling semantics."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1543070781, "post_id": 53191510, "comment_id": 93790218, "body": "@chepner: How do I import <code>except</code> (or for that mater <code>ExceptT</code> as a constructor). I can&#39;t seem to make an <code>Except</code> from an <code>Either</code>."}], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1543016573, "post_id": 53192859, "comment_id": 93780470, "body": "I have a <a href=\"https://stackoverflow.com/q/53453944/656912\">follow up question</a>."}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 2, "last_activity_date": 1541605448, "creation_date": 1541605448, "answer_id": 53192859, "question_id": 53191510, "link": "https://stackoverflow.com/questions/53191510/what-are-the-difference-in-usage-between-either-and-except-in-haskell/53192859#53192859", "title": "What are the difference in usage between Either and Except in Haskell?", "body": "<p>As noted in the comments, it's easy to convert between <code>Except</code> &amp; <code>Either</code>.  The runtime representation is the same, even.</p>\n\n<p>I would always choose to use <code>Either</code>.  It's ubiquitous in libraries.  I very rarely see <code>Except</code>.</p>\n\n<p><code>Except</code> is a special case of <a href=\"https://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Monad-Trans-Except.html#t:ExceptT\" rel=\"nofollow noreferrer\">ExceptT</a>, which you <em>will</em> see in libraries.  If you find yourself writing a lot of functions with <code>Reader SomeType (Either e a)</code> or <code>IO (Either e a)</code> or <code>Monad m =&gt; m (Either e a)</code>, then you might want to consider <code>ExceptT</code>.  It's fine not to worry about it until then - <code>Either</code> is easier to use until it isn't.</p>\n"}, {"tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 5, "last_activity_date": 1591482805, "last_edit_date": 1591482805, "creation_date": 1548836113, "answer_id": 54435982, "question_id": 53191510, "link": "https://stackoverflow.com/questions/53191510/what-are-the-difference-in-usage-between-either-and-except-in-haskell/54435982#54435982", "title": "What are the difference in usage between Either and Except in Haskell?", "body": "<p>The difference is in the instance of <code>Alternative</code>. The \"base\" package does not export any for <code>Either</code>, as I understand because the authors didn't want to introduce a bias towards any of the values, which on itself is because <code>Either</code> is supposed to be a general sum-type, and representing the possibility of errors is only a special case. However <a href=\"http://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Monad-Trans-Error.html#v:-36-fAlternativeEither\" rel=\"nofollow noreferrer\">the \"transformers\" package does provide an orphan instance</a>, which binds it to <a href=\"http://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Monad-Trans-Error.html\" rel=\"nofollow noreferrer\">the <code>Error</code> class</a>:</p>\n\n<pre><code>Error e =&gt; Alternative (Either e)\n</code></pre>\n\n<p>However the community has never accepted either the typeclass or the orphan instance, which is why it is now deprecated. IOW you can look at it as if <code>Either</code> still has no instance of <code>Alternative</code>.</p>\n\n<p>The <code>Except</code> type does have a non-orphan instance, which doesn't even bind the user to any made-up classes, but <code>Monoid</code> instead:</p>\n\n<pre><code>(Monad m, Monoid e) =&gt; Alternative (ExceptT e m)\n</code></pre>\n\n<p>It is also worth noting, that for cases when dealing with validation and accumulating all errors, <a href=\"http://hackage.haskell.org/package/validation-selective-0.1.0.0/docs/Validation.html\" rel=\"nofollow noreferrer\">the <code>Validation</code> abstraction</a> is more appropriate. There is a tradeoff though: it cannot be a monad, but it is a selective (between applicative and monad) and an alternative.</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 2, "accepted_answer_id": 53192859, "answer_count": 2, "score": 7, "last_activity_date": 1591482805, "creation_date": 1541601100, "question_id": 53191510, "link": "https://stackoverflow.com/questions/53191510/what-are-the-difference-in-usage-between-either-and-except-in-haskell", "title": "What are the difference in usage between Either and Except in Haskell?", "body": "<p>I have a class that can be created from several arguments in Haskell which requires some complex validation of those arguments. Currently I have something like</p>\n\n<pre><code>makeAThingExcept :: String -&gt; String -&gt; ... String -&gt; Except ThingError AThing\nmakeAThingExcept s1 s2 ... = do\n    unless (s1CheckPasses s1) (throwError (BadS1 s1))\n    ...\n\ndata ThingError = BadS1 String ...\n\ninstance Show ThingError where\n        show (BadS1 s) = \"Bad S1: \" ++ s\n\nmakeAThing :: String -&gt; String -&gt; ... String -&gt; AThing\nmakeAThing s1 s2 ... = case runExcept (makeAThingExcept s1 s2 ...) of\n        Right thing  -&gt; thing\n        Left err -&gt; error (show err)\n</code></pre>\n\n<p>Setting aside whether there is a better way to do this by using more specific types than <code>String</code> as arguments to <code>makeAThingExcept</code>, is there a reason to prefer <code>Except</code> over <code>Either</code> in a case like this? What are the differences here between the capabilities and idiom of <code>Except</code> vs <code>Either</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1541601225, "post_id": 53191477, "comment_id": 93271814, "body": "You want to look at <code>fromIntegral</code>."}, {"owner": {"reputation": 198, "user_id": 9766517, "user_type": "registered", "profile_image": "https://graph.facebook.com/979212112247081/picture?type=large", "display_name": "Ellis Thompson", "link": "https://stackoverflow.com/users/9766517/ellis-thompson"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541602479, "post_id": 53191477, "comment_id": 93272600, "body": "Ivetried the fomIntegral but im getting a new error : areaCalcuator:: Int -&gt; Float priceCalcuator :: Int -&gt; Int -&gt; Float --isMoreExpensive :: Bool  areaCalcuator x = ((fromIntegral x / 2) ^2)* pi  priceCalcuator x y = let area = (\\z -&gt; (((fromIntegral x / 2) ^2)* pi))                      in (0.001 * area) + ((fromIntegral y)*0.002 * area) * 1.5   * Couldn&#39;t match expected type <code>Float&#39; with actual type </code>p0 -&gt; a0&#39;"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541602669, "post_id": 53191477, "comment_id": 93272724, "body": "Why restrict the types so much? For example, the inferred type for <code>areaCalculator = ((x&#47;2) ^ 2) * pi</code> is <code>Floating a =&gt; a -&gt; a</code>. The inferred type for your updated definition is <code>(Integral a2, Floating a1) =&gt; a2 -&gt; a1</code>."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541602732, "post_id": 53191477, "comment_id": 93272768, "body": "Please <a href=\"https://stackoverflow.com/posts/53191477/edit\">edit</a> the question with relevant updates, comments don&#39;t work well for this. Also please format the compiler messages as code."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541602863, "post_id": 53191477, "comment_id": 93272876, "body": "Now the question doesn&#39;t match the title though."}, {"owner": {"reputation": 198, "user_id": 9766517, "user_type": "registered", "profile_image": "https://graph.facebook.com/979212112247081/picture?type=large", "display_name": "Ellis Thompson", "link": "https://stackoverflow.com/users/9766517/ellis-thompson"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541603343, "post_id": 53191477, "comment_id": 93273245, "body": "I&#39;ve managed to solve the errors thanks to @n.m. and chepner I&#39;ve also reformatted the question"}], "answers": [{"tags": [], "owner": {"reputation": 198, "user_id": 9766517, "user_type": "registered", "profile_image": "https://graph.facebook.com/979212112247081/picture?type=large", "display_name": "Ellis Thompson", "link": "https://stackoverflow.com/users/9766517/ellis-thompson"}, "is_accepted": true, "score": 1, "last_activity_date": 1541603026, "creation_date": 1541603026, "answer_id": 53192116, "question_id": 53191477, "link": "https://stackoverflow.com/questions/53191477/match-float-with-actual-type-p0-a0/53192116#53192116", "title": "Match Float with actual type `p0 -&gt; a0&#39;", "body": "<p>Thanks to n.m for the fromIntegral I managed to rewrite the code so it works which also fixed my second error.</p>\n\n<pre><code>priceCalcuator :: Int -&gt; Int -&gt; Float\nisMoreExpensive :: Bool\npriceCalcuator x y = let area = (((fromIntegral x / 2) ^2)* pi)\n                     in  ((0.001 * area) + ((fromIntegral y * area)*0.002))*1.5\n</code></pre>\n\n<p>Apologies to the poor formatting\nIf anyone can explain this then please let me know </p>\n"}, {"comments": [{"owner": {"reputation": 198, "user_id": 9766517, "user_type": "registered", "profile_image": "https://graph.facebook.com/979212112247081/picture?type=large", "display_name": "Ellis Thompson", "link": "https://stackoverflow.com/users/9766517/ellis-thompson"}, "edited": false, "score": 0, "creation_date": 1541604038, "post_id": 53192239, "comment_id": 93273712, "body": "I had something similar to that to start with, however a requirement was that for the &quot;priceClacuator&quot; it had to be &gt; priceCalculator :: Integer -&gt; Integer -&gt; Float As to satisfy an automatic test"}, {"owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "reply_to_user": {"reputation": 198, "user_id": 9766517, "user_type": "registered", "profile_image": "https://graph.facebook.com/979212112247081/picture?type=large", "display_name": "Ellis Thompson", "link": "https://stackoverflow.com/users/9766517/ellis-thompson"}, "edited": false, "score": 0, "creation_date": 1541604145, "post_id": 53192239, "comment_id": 93273789, "body": "ah cool, wasn&#39;t too sure from original question but see you&#39;ve edited it now :)"}], "tags": [], "owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "is_accepted": false, "score": 2, "last_activity_date": 1541603404, "creation_date": 1541603404, "answer_id": 53192239, "question_id": 53191477, "link": "https://stackoverflow.com/questions/53191477/match-float-with-actual-type-p0-a0/53192239#53192239", "title": "Match Float with actual type `p0 -&gt; a0&#39;", "body": "<p>Alternately you could also do it this way:</p>\n\n<pre><code>areaCalculator :: Floating a =&gt; a -&gt; a\nareaCalculator x = ((x / 2) ^2) * pi\n\npriceCalculator :: Double -&gt; Double -&gt; Double\npriceCalculator x y = \n (  (areaCalculator x * 0.001) \n  + (areaCalculator x * 0.002 * y)) * 1.5\n</code></pre>\n"}], "owner": {"reputation": 198, "user_id": 9766517, "user_type": "registered", "profile_image": "https://graph.facebook.com/979212112247081/picture?type=large", "display_name": "Ellis Thompson", "link": "https://stackoverflow.com/users/9766517/ellis-thompson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 53192116, "answer_count": 2, "score": 1, "last_activity_date": 1541603404, "creation_date": 1541600987, "last_edit_date": 1541603230, "question_id": 53191477, "link": "https://stackoverflow.com/questions/53191477/match-float-with-actual-type-p0-a0", "title": "Match Float with actual type `p0 -&gt; a0&#39;", "body": "<p>I had this working when all the types were doubles however i need them to be in this format, any idea how I can solve my error?</p>\n\n<pre><code>areaCalcuator:: Int -&gt; Float\npriceCalcuator :: Int -&gt; Int -&gt; Float\n--isMoreExpensive :: Bool\n\nareaCalcuator x = ((fromIntegral x / 2) ^2)* pi\n\npriceCalcuator x y = let area = (\\z -&gt; (((fromIntegral x / 2) ^2)* pi))\n                     in (0.001 * area) + ((fromIntegral y)*0.002 * area) * 1.5\n</code></pre>\n\n<p>The new error I got was</p>\n\n<pre><code> * Couldn't match expected type `Float' with actual type `p0 -&gt; a0'\n    * Probable cause: `(+)' is applied to too few arguments\n      In the expression:\n        (0.001 * area) + ((fromIntegral y) * 0.002 * area) * 1.5\n      In the expression:\n        let area = (\\ z -&gt; (((fromIntegral x / 2) ^ 2) * pi))\n        in (0.001 * area) + ((fromIntegral y) * 0.002 * area) * 1.5\n      In an equation for `priceCalcuator':\n          priceCalcuator x y\n            = let area = (\\ z -&gt; ...)\n              in (0.001 * area) + ((fromIntegral y) * 0.002 * area) * 1.5\n    * Relevant bindings include\n        area :: forall p. p -&gt; a0\n          (bound at C:\\\\Users\\Ellis\\OneDrive\\Year 2\\CS-205 Declarative Programming\\CW1\\Haskell-Cw1\\Coursework1.hs:13:26)\n   |\n14 |                      in (0.001 * area) + ((fromIntegral y)*0.002 * area) * 1.5\n   |  \n</code></pre>\n\n<p>I believe my lack of understanding with haskell is what caused this issue                       </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1541601595, "post_id": 53191551, "comment_id": 93272022, "body": "Don&#39;t pattern synonyms need to start with a capital letter?"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541601786, "post_id": 53191551, "comment_id": 93272131, "body": "yeah I knew the way using guard, but you made me discover this PatternSynonyms ! thanks :-)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1541602688, "last_edit_date": 1541602688, "creation_date": 1541601244, "answer_id": 53191551, "question_id": 53191372, "link": "https://stackoverflow.com/questions/53191372/can-we-pattern-match-in-a-case-with-a-fct/53191551#53191551", "title": "can we pattern match in a case with a fct?", "body": "<p>Not directly. Names are treated as irrefutable patterns; the value of the name is not used as the pattern to match.</p>\n\n<p>Instead, you can define a pattern synonym using the <code>PatternSynonyms</code> extension.</p>\n\n<pre><code>{-# LANGUAGE PatternSynonyms -#}\npattern EventNameForWorkspaceCreated = \"workspaceCreated\"\n\nfromEvent :: Event -&gt; Maybe WorkspaceCreated\nfromEvent event = case (eventName $ header event) of\n                EventNameForWorkspaceCreated -&gt; Just WorkspaceCreated {eventId = CoreEvent.event}\n                _ -&gt; Nothing\n</code></pre>\n\n<p>However, guard syntax is probably simpler if you don't really need pattern matching. (<code>String</code> values can be compared for equality.)</p>\n\n<pre><code>fromEvent event | eventName $ header event == eventNameForWorkspaceCreated = Just WorkspaceCreated {eventId = CoreEvent.event}\n                | otherwise = Nothing\n</code></pre>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 53191551, "answer_count": 1, "score": 0, "last_activity_date": 1541602688, "creation_date": 1541600660, "question_id": 53191372, "link": "https://stackoverflow.com/questions/53191372/can-we-pattern-match-in-a-case-with-a-fct", "title": "can we pattern match in a case with a fct?", "body": "<p>I was wondering If I could use a method instead of a constant in a case, passing from this :</p>\n\n<pre><code>fromEvent :: Event -&gt; Maybe WorkspaceCreated\nfromEvent event =\n  case (eventName $ header event) of\n    \"workspaceCreated\" -&gt; Just WorkspaceCreated {eventId = CoreEvent.eventId $ header event, workspaceId = aggregateId $ header event}\n    _ -&gt; Nothing\n</code></pre>\n\n<p>to something like this :</p>\n\n<pre><code>eventNameForWorkspaceCreated = \"workspaceCreated\" :: String\nfromEvent :: Event -&gt; Maybe WorkspaceCreated\nfromEvent event =\n  case (eventName $ header event) of\n    eventNameForWorkspaceCreated -&gt; Just WorkspaceCreated {eventId = CoreEvent.eventId $ header event, workspaceId = aggregateId $ header event}\n    _ -&gt; Nothing\n</code></pre>\n\n<p>In the last example it takes eventNameForWorkspaceCreated for the name of a variable which make sense...</p>\n"}, {"tags": ["list", "haskell", "optimization"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541600169, "post_id": 53191190, "comment_id": 93271195, "body": "What exactly are <code>partishner</code>, etc. doing? One can here basically solve the problem in two passes: first calcuate the sum of the list, then each time iterate over an element add the element to the sum on the left, and subtract it at the sum of the right, and keep track of what the optimial delta is."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1541603230, "post_id": 53191190, "comment_id": 93273170, "body": "If your lists are always of <code>[1..n]</code> type then this is just a simple math problem involving quadratic formula."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1541604645, "post_id": 53191190, "comment_id": 93274144, "body": "@Redu No that&#39;s just an example. I should&#39;ve made it clear in my question. The input could have any number of variation, but they&#39;ll always be ordered."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541606837, "post_id": 53192008, "comment_id": 93275448, "body": "<code>head . snd</code> is the wrong choice for the 70K case though. it is the other one."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1541602661, "creation_date": 1541602661, "answer_id": 53192008, "question_id": 53191190, "link": "https://stackoverflow.com/questions/53191190/haskell-split-a-list-into-two-sublists-with-closest-sums/53192008#53192008", "title": "Haskell - split a list into two sublists with closest sums", "body": "<p>It looks to me that the implementation is quite chaotic. For example <code>partishner</code> seems to construct a list of lists of lists of <code>a</code>, where, given I understood it correctly, the outer list contains lists with each two elements: the list of elements on \"the left\", and the list of elements at the \"right\". As a result, this will take <em>O(n<sup>2</sup>)</em> to construct the lists.</p>\n\n<p>By using lists over 2-tuples, this is also quite \"unsafe\", since a list can - although here probably impossible - contain no elements, one element, or more than two elements. If you make a mistake in one of the functions, it will be hard to find out that mistake.</p>\n\n<p>It looks to me that it might be easier to implement a \"sweep algorithm\": we first calculate the sum of all the elements in the list. This is the value on the \"right\" in case we decide to split at that specific point, next we start moving from left to right, each time subtracting the element from the sum on the right, and adding it to the sum on the left. We can each time evaluate the difference in score, like:</p>\n\n<pre><code>import Data.List(unfoldr)\n\nsweep :: Num a =&gt; [a] -&gt; [(Int, a, [a])]\nsweep lst = x0 : unfoldr f x0\n    where x0 = (0, sum lst, lst)\n          f (_, _, []) = Nothing\n          f (i, r, (x: xs)) = Just (l, l)\n              where l = (i+1, r-2*x, xs)\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>Prelude Data.List&gt; sweep [1,4,2,5]\n[(0,12,[1,4,2,5]),(1,10,[4,2,5]),(2,2,[2,5]),(3,-2,[5]),(4,-12,[])]\n</code></pre>\n\n<p>So if we select to split at the first split point (before the first element), the sum on the right is <code>12</code> higher than the sum on the left, if we split after the first element, the sum on the right (<code>11</code>) is <code>10</code> higher than the sum on the left (<code>1</code>).</p>\n\n<p>We can then obtain the minimum of these splits with <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:minimumBy\" rel=\"nofollow noreferrer\"><strong><code>minimumBy :: (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; a</code></strong></a>:</p>\n\n<pre><code>import Data.List(minimumBy)\nimport Data.Ord(comparing)\n\nfindTheEquilizer :: (Ord a, Num a) =&gt; [a] -&gt; ([a], [a])\nfindTheEquilizer lst = (take idx lst, tl)\n    where (idx, _, tl) = minimumBy (comparing (abs . \\(_, x, _) -&gt; x)) (sweep lst)\n</code></pre>\n\n<p>We then obtain the correct value for <code>[1..10]</code>:</p>\n\n<pre><code>Prelude Data.List Data.Ord Data.List&gt; findTheEquilizer [1..10]\n([1,2,3,4,5,6,7],[8,9,10])\n</code></pre>\n\n<p>or for 70'000:</p>\n\n<pre><code>Prelude Data.List Data.Ord Data.List&gt; head (snd (findTheEquilizer [1..70000]))\n49498\n</code></pre>\n\n<p>The above is not ideal, it can be implemented more elegantly, but I leave this as an exercise.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1541606066, "post_id": 53192925, "comment_id": 93275015, "body": "How&#39;s that better than linear?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541606277, "post_id": 53192925, "comment_id": 93275132, "body": "That&#39;s... not how you compute complexity."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1541606372, "post_id": 53192925, "comment_id": 93275180, "body": "Don&#39;t you need at least three points to reach that? You&#39;ve likely just captured some fixed cost in the interpreter (a constant term) or even a meaningless artifact (GC, etc.)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1541607407, "post_id": 53192925, "comment_id": 93275789, "body": "You are also only testing lists of the form <code>[1..n]</code>, which the OP has clarified is not always the case; the input is just ordered."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541608562, "post_id": 53192925, "comment_id": 93276425, "body": "The fact that you are using <code>last</code> means you are scanning the entire input. All you are demonstrating is that there&#39;s a fixed amount of overhead that becomes decreasingly relevant as the list gets longer."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1541609601, "post_id": 53192925, "comment_id": 93277015, "body": "It&#39;s not &quot;better than linear&quot;, it <i>is</i> linear; the exponent is going up because you have a cost function like <code>c(n) + x</code>, and you are seeing the decreasing contribution of <code>x</code> as <code>n</code> increases."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1601824694, "post_id": 53192925, "comment_id": 113519563, "body": "that&#39;s... how you measure <i>empirical</i> orders of growth.(*) all the above comments are true, and all do not address what the answer is saying. yes there&#39;s a diminishing contribution from a constant factor, and yes, it is seen as a <i>sub</i>-linear <i>empirical</i> orders of growth with increasing (towards 1.0) power coefficient. (*) of course one could get fancy and perform a linear regression discovering said constant factor intercept and the exact linear power law coefficient, but simple is simple enough, and is enough."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1541927233, "last_edit_date": 1541927233, "creation_date": 1541605688, "answer_id": 53192925, "question_id": 53191190, "link": "https://stackoverflow.com/questions/53191190/haskell-split-a-list-into-two-sublists-with-closest-sums/53192925#53192925", "title": "Haskell - split a list into two sublists with closest sums", "body": "<p>Here's a code which is <a href=\"http://en.wikipedia.org/wiki/Analysis_of_algorithms#Empirical_orders_of_growth\" rel=\"nofollow noreferrer\">empirically</a> behaving better than linear, and gets to the 2,000,000 in just over 1 second even when interpreted:</p>\n\n<pre><code>g :: (Ord c, Num c) =&gt; [c] -&gt; [(Int, c)]\ng = head . dropWhile ((&gt; 0) . snd . last) . map (take 2) . tails . zip [1..]\n         . (\\xs -&gt; zipWith (-) (map (last xs -) xs) xs) . scanl1 (+) \n\ng [1..10]      ==&gt; [(6,13),(7,-1)]                        -- 0.0s\ng [1..70000]   ==&gt; [(49497,32494),(49498,-66502)]         -- 0.09s\ng [70000,70000-1..1] ==&gt; [(20502,66502),(20503,-32494)]   -- 0.09s\ng [1..100000]  ==&gt; [(70710,75190),(70711,-66232)]         -- 0.11s\ng [1..1000000] ==&gt; [(707106,897658),(707107,-516556)]     -- 0.62s\ng [1..2000000] ==&gt; [(1414213,1176418),(1414214,-1652010)] -- 1.14s  n^0.88\ng [1..3000000] ==&gt; [(2121320,836280),(2121321,-3406362)]  -- 1.65s  n^0.91\n</code></pre>\n\n<p>It works by running the partial sums with <code>scanl1 (+)</code> and taking the total sum as its <code>last</code>, so that for each partial sum, subtracting it from the total gives us the sum of the second part of the split. </p>\n\n<p>The algorithm assumes all the numbers in the input list are strictly positive, so the partial sums list is monotonically increasing. Nothing else is assumed about the numbers. </p>\n\n<p>The value must be chosen from the pair (the <code>g</code>'s result) so that its second component's  absolute value is the smaller between the two. </p>\n\n<p>This is achieved by <code>minimumBy (comparing (abs . snd)) . g</code>.</p>\n\n<hr>\n\n<p><em>clarifications:</em> There's some confusion about \"complexity\" in the comments below, yet the answer says nothing at all about complexity but uses a specific empirical measurement. You can't argue with empirical data (unless you misinterpret its meaning). </p>\n\n<p>The answer does <strong>not</strong> claim it \"<em>is</em> better than linear\", it says \"it <em>behaves</em> better than linear\" [in the tested range of problem sizes], which the empirical data incontrovertibly show. </p>\n\n<p>Finally, <a href=\"https://rjlipton.wordpress.com/2009/07/24/how-to-avoid-o-abuse-and-bribes/\" rel=\"nofollow noreferrer\">an appeal to authority</a>. <a href=\"https://en.wikipedia.org/wiki/Robert_Sedgewick_(computer_scientist)\" rel=\"nofollow noreferrer\">Robert Sedgewick</a> is an authority on algorithms. Take it up with him. </p>\n\n<p>(and of course the algorithm handles unordered data as well as it does ordered).</p>\n\n<p>As for the reasons for OP's code inefficiency: <code>map sum . inits</code> can't help being quadratic, but the equivalent <code>scanl (+) 0</code> is linear. The radical improvement comes about from a lot of redundant calculations in the former being avoided in the latter. (Another example of this can be seen <a href=\"https://stackoverflow.com/a/13517443/849891\">here</a>.)</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541659505, "post_id": 53194267, "comment_id": 93293507, "body": "FYI <code>sumList = scanl1 (+)</code>."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541661698, "post_id": 53194267, "comment_id": 93294237, "body": "@WillNess Great! but sumList show the detail how it work may be more suitable for Haskell beginner"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541661843, "post_id": 53194267, "comment_id": 93294282, "body": "it&#39;s always good to re-code a library definition by yourself to see how it does its work. :)"}], "tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": false, "score": 1, "last_activity_date": 1541610003, "creation_date": 1541610003, "answer_id": 53194267, "question_id": 53191190, "link": "https://stackoverflow.com/questions/53191190/haskell-split-a-list-into-two-sublists-with-closest-sums/53194267#53194267", "title": "Haskell - split a list into two sublists with closest sums", "body": "<p>Okay, firstly, let analyse why it run forever (...actually not forever, just slow), take a look of partishner function:</p>\n\n<pre><code>partishner y xs = [take y xs : [drop y xs]] ++ partishner (y - 1) xs\n</code></pre>\n\n<p>where <code>take y xs</code> and <code>drop y xs</code> are run linear time, i.e. O(N), and so as</p>\n\n<pre><code>[take y xs : [drop y xs]]\n</code></pre>\n\n<p>is O(N) too. </p>\n\n<p>However, it is run again and again in recursive way over each element of given list. Now suppose the length of given list is M, each call of partishner function take O(N) times, to finish computation need:</p>\n\n<pre><code>O(1+2+...M) = (M(1+M)/2) ~ O(M^2)\n</code></pre>\n\n<p>Now, the list has 70k elements, it at least need 70k ^ 2 step. So why it hang.</p>\n\n<p>Instead of using partishner function, you can sum the list in linear way as:</p>\n\n<pre><code>sumList::(Floating a)=&gt;[a]-&gt;[a]\nsumList xs = sum 0 xs\n    where sum _ [] = []\n          sum s (y:ys) = let s' = s + y in s' : sum s' ys\n</code></pre>\n\n<p>and findEqilizer just sum the given list from left to right (leftSum) and from right to left (rightSum) and take the result just as your original program, but the whole process just take linear time.   </p>\n\n<pre><code>findEquilizer::(Ord a, Floating a) =&gt; [a] -&gt; a\nfindEquilizer [] = 0 \nfindEquilizer xs = \n    let leftSum  = reverse $ 0:(sumList $ init xs)\n        rightSum = sumList $ reverse $ xs\n        afterParty = zipWith (\\x y-&gt;(x-y) ** 2) leftSum rightSum\n    in  fst $ minimumBy (comparing snd) (zip (reverse $ init xs) afterParty)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541644745, "post_id": 53197427, "comment_id": 93290134, "body": "the result for <code>[1..10]</code> is incorrect, though for e.g. <code>[1..12]</code> it is correct. also, the results for lists like <code>replicate 100 1</code> are meaningless."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541646528, "post_id": 53197427, "comment_id": 93290510, "body": "@WillNess, what do you mean by &quot;incorrect&quot;? And why do you call those results &quot;meaningless&quot;?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541647721, "post_id": 53197427, "comment_id": 93290731, "body": "@WillNess, note that my version produces the last &quot;at most half&quot; one and also a list whose first element is the first &quot;over half&quot; one. So you take your pick or average them or whatever you like."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541696732, "post_id": 53197427, "comment_id": 93313162, "body": "@WillNess, <code>sum [1..7] = 28</code> and <code>sum [8..10] = 27</code>. So <code>7</code> is one too many. My interpretation of the question is that the ultimate goal was to find the number that crosses, and that splitting the list was just the OP&#39;s approach to doing so (i.e., something of an XY problem). Of course, my solution can easily be adapted to produce the split index as well, allowing the user to recover the first list with <code>take</code> (the second list comes for free already)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541696821, "post_id": 53197427, "comment_id": 93313220, "body": "no, not one too many. the OP wants the minimal difference between the sums. -1 is better than 13. they even run it through <code>((x - y) ** 2)</code> and do a <code>minimumBy (comparing snd)</code> on it."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541696927, "post_id": 53197427, "comment_id": 93313280, "body": "@WillNess, ah, I wasn&#39;t too clear on exactly what they meant. But I think the real point is that the function I offer lets them choose whichever they like quite easily in post-processing. I can clarify."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1541624335, "last_edit_date": 1541624335, "creation_date": 1541622983, "answer_id": 53197427, "question_id": 53191190, "link": "https://stackoverflow.com/questions/53191190/haskell-split-a-list-into-two-sublists-with-closest-sums/53197427#53197427", "title": "Haskell - split a list into two sublists with closest sums", "body": "<p>I assume that none of the list elements are negative, and use a \"tortoise and hare\" approach. The hare steps through the list, adding up elements. The tortoise does the same thing, but it keeps its sum doubled and it carefully ensures that it only takes a step when that step won't put it ahead of the hare.</p>\n\n<pre><code>approxEqualSums\n  :: (Num a, Ord a)\n  =&gt; [a] -&gt; (Maybe a, [a])\napproxEqualSums as0 = stepHare 0 Nothing as0 0 as0\n  where\n    -- ht is the current best guess.\n    stepHare _tortoiseSum ht tortoise _hareSum []\n      = (ht, tortoise)\n    stepHare tortoiseSum ht tortoise hareSum (h:hs)\n      = stepTortoise tortoiseSum ht tortoise (hareSum + h) hs\n\n    stepTortoise tortoiseSum ht [] hareSum hare\n      = stepHare tortoiseSum ht [] hareSum hare\n    stepTortoise tortoiseSum ht tortoise@(t:ts) hareSum hare\n      | tortoiseSum' &lt;= hareSum\n      = stepTortoise tortoiseSum' (Just t) ts hareSum hare\n      | otherwise\n      = stepHare tortoiseSum ht tortoise hareSum hare\n      where tortoiseSum' = tortoiseSum + 2*t\n</code></pre>\n\n<p>In use:</p>\n\n<pre><code>&gt; approxEqualSums [1..10]\n(Just 6,[7,8,9,10])\n</code></pre>\n\n<p>6 is the last element before going over half, and 7 is the first one after that.</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1541630717, "last_edit_date": 1541630717, "creation_date": 1541629384, "answer_id": 53198788, "question_id": 53191190, "link": "https://stackoverflow.com/questions/53191190/haskell-split-a-list-into-two-sublists-with-closest-sums/53198788#53198788", "title": "Haskell - split a list into two sublists with closest sums", "body": "<p>I asked in the comment and OP says <code>[1..n]</code> is not really defining the question. Yes i guess what's asked is like <code>[1 -&gt; n]</code> in random ascending sequence such as <code>[1,3,7,19,37,...,1453,...,n]</code>.</p>\n\n<p>Yet..! Even as per the given answers, for a list like <code>[1..n]</code> we really don't need to do any list operation at all.</p>\n\n<ul>\n<li>The sum of <code>[1..n]</code> is <code>n*(n+1)/2</code>.</li>\n<li>Which means we need to find <code>m</code> for <code>n*(n+1)/4</code></li>\n<li>Which means <code>m(m+1)/2 = n*(n+1)/4</code>.</li>\n<li>So if <code>n == 100</code> then <code>m^2 + m - 5050 = 0</code></li>\n</ul>\n\n<p>All we need is \n<a href=\"https://i.stack.imgur.com/oXHjP.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oXHjP.gif\" alt=\"enter image description here\"></a>\nformula where <code>a = 1</code>, <code>b = 1</code> and <code>c = -5050</code> yielding the reasonable root to be  70.565 \u21d2 71 (rounded). Lets check. <code>71*72/2 = 2556</code> and <code>5050-2556 = 2494</code> which says <code>2556 - 2494 = 62</code> minimal difference (&lt;71). Yes we must split at 71. So just do like <code>result = [[1..71],[72..100]]</code> over..!</p>\n\n<p>But when it comes to not subsequent ascending, that's a different animal. It has to be done by first finding the sum and then like binary search by jumping halfway the list and comparing the sums to decide whether to jump halfway back or forward accordingly. I will implement that one later.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 1, "accepted_answer_id": 53192008, "answer_count": 5, "score": 3, "last_activity_date": 1541927233, "creation_date": 1541599989, "last_edit_date": 1541645897, "question_id": 53191190, "link": "https://stackoverflow.com/questions/53191190/haskell-split-a-list-into-two-sublists-with-closest-sums", "title": "Haskell - split a list into two sublists with closest sums", "body": "<p>I'm a Haskell beginner trying to learn more about the language by solving some online quizzes/problem sets.</p>\n\n<p>The problem/question is quite lengthy but a part of it requires code that can find the number which divides a given list into two (nearly) equal (by sum) sub-lists.</p>\n\n<p>Given <code>[1..10]</code></p>\n\n<p>Answer should be <code>7</code> since <code>1+2+..7 = 28</code> &amp; <code>8+9+10 = 27</code></p>\n\n<p>This is the way I implemented it</p>\n\n<pre><code>-- partitions list by y\npartishner :: (Floating a) =&gt; Int -&gt; [a] -&gt; [[[a]]]\npartishner 0 xs = [[xs],[]]\npartishner y xs = [take y xs : [drop y xs]] ++ partishner (y - 1) xs\n\n\n-- finds the equal sum\nfindTheEquilizer :: (Ord a, Floating a) =&gt; [a] -&gt; [[a]]\nfindTheEquilizer xs = fst $ minimumBy (comparing snd) zipParty\n  where party = (tail . init) (partishner (length xs) xs) -- removes [xs,[]] types\n        afterParty = (map (\\[x, y] -&gt; (x - y) ** 2) . init . map (map sum)) party\n        zipParty = zip party afterParty -- zips partitions and squared diff betn their sums\n</code></pre>\n\n<p>Given <code>(last . head) (findTheEquilizer [1..10])</code>\noutput : <code>7</code></p>\n\n<hr>\n\n<p>For numbers near <code>50k</code> it works fine</p>\n\n<pre><code>\u03bb&gt; (last . head) (findTheEquilizer [1..10000])                                                   \n   7071.0 \n</code></pre>\n\n<p>The trouble starts when I put in lists with any more than <code>70k</code> elements in it. It takes forever to compute. </p>\n\n<hr>\n\n<p>So what do I have to change in the code to make it run better or do I have to change my whole approach? I'm guessing it's the later, but I'm not sure how to go about do that.</p>\n"}, {"tags": ["haskell", "algebra", "newtype"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1541589571, "post_id": 53188123, "comment_id": 93265919, "body": "there is no inheritance. every type must implement all of its typeclass instances by itself."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541604046, "post_id": 53188123, "comment_id": 93273719, "body": "Will Ness is right, though I&#39;d remark that quite often GHC can <i>derive</i> those instances automatically for you. Just you do need to ask it... and for <code>Num</code>, deriving is actually not possible at all currently."}], "answers": [{"comments": [{"owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "edited": false, "score": 1, "creation_date": 1541593130, "post_id": 53188346, "comment_id": 93267532, "body": "nice much more in depth than my answer :)"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1541615878, "post_id": 53188346, "comment_id": 93280036, "body": "Might be worth mentioning <code>GeneralizedNewtypeDeriving</code>... :)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1541626513, "last_edit_date": 1541626513, "creation_date": 1541589164, "answer_id": 53188346, "question_id": 53188123, "link": "https://stackoverflow.com/questions/53188123/performing-algebra-with-newtypes-based-on-integers-haskell/53188346#53188346", "title": "Performing algebra with newtypes based on integers Haskell", "body": "<p>Well Haskell can not add up two <code>Money</code>s, since you never specified how to do that. In order to add up two <code>a</code>s, the <code>a</code>s should implement the <code>Num</code> typeclass. In fact <code>newtype</code>s are frequently used to specify <em>different</em> type instances, for example <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Monoid.html#t:Sum\" rel=\"nofollow noreferrer\"><code>Sum</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Monoid.html#v:Product\" rel=\"nofollow noreferrer\"><code>Product</code></a> are used to define two different monoids.</p>\n\n<p>You thus need to make it an instance of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#t:Num\" rel=\"nofollow noreferrer\"><strong><code>Num</code></strong></a>, so you have to define an instance like:</p>\n\n<pre><code>instance Num Money where\n    Money a + Money b = Money (a+b)\n    Money a - Money b = Money (a-b)\n    Money a * Money b = Money (a*b)\n    abs (Money a) = Money (abs a)\n    signum (Money a) = Money (signum a)\n    fromInteger = Money</code></pre>\n\n<p>Since <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-47-\" rel=\"nofollow noreferrer\"><strong><code>(/) :: Fractional a =&gt; a -&gt; a -&gt; a</code></strong></a> is a member of the <code>Fractional</code> typeclass, this will give some problems, since your <code>Money</code> wraps an <code>Integer</code> object.</p>\n\n<p>You can however implement the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#t:Integral\" rel=\"nofollow noreferrer\"><code>Integral</code></a> typeclass such that it supports <code>div</code>. In order to do this, we however need to implement the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#t:Real\" rel=\"nofollow noreferrer\"><code>Real</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#t:Enum\" rel=\"nofollow noreferrer\"><code>Enum</code></a> typeclass. The <code>Real</code> typeclass requires the type to be implement the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#t:Ord\" rel=\"nofollow noreferrer\"><code>Ord</code></a>, and since the <code>Ord</code> typeclass requires the object to be an instance of the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#t:Integral\" rel=\"nofollow noreferrer\"><code>Eq</code></a> typeclass, we thus end up implementing the <code>Eq</code>, <code>Ord</code>, <code>Real</code> and <code>Enum</code> typeclass.</p>\n\n<pre><code>instance Eq Money where\n    Money x == Money y = x == y\n\ninstance Ord Money where\n    compare (Money x) (Money y) = compare x y\n\ninstance Real Money where\n    toRational (Money x) = toRational x\n\ninstance Enum Money where\n    fromEnum (Money x) = fromEnum x\n    toEnum = Money . toEnum\n\ninstance Integral Money where\n    toInteger (Money x) = x\n    quotRem (Money x) (Money y) = (Money q, Money r)\n        where (q, r) = quotRem x y</code></pre>\n\n<h1><code>GeneralizedNewtypeDeriving</code></h1>\n\n<p>As <a href=\"https://stackoverflow.com/questions/53188123/performing-algebra-with-newtypes-based-on-integers-haskell/53188346?noredirect=1#comment93280036_53188346\">@Alec says</a> we can use a GHC extension named <a href=\"https://downloads.haskell.org/~ghc/8.0.2/docs/html/users_guide/glasgow_exts.html#ghc-flag--XGeneralizedNewtypeDeriving\" rel=\"nofollow noreferrer\"><strong><code>-XGeneralizedNewtypeDeriving</code></strong></a>.</p>\n\n<p>The above derivations are quite \"boring\" here we each time \"unwrap\" the data constructor(s), perform some actions, and \"rewrap\" them (well in some cases either unwrapping or rewrapping are not necessary). Especially since a <code>newtype</code> actually does not exists at runtime (this is more a way to let Haskell treat the data differently, but the data constructor will be \"optimized away\"), it makes not much sense.</p>\n\n<p>If we compile with:</p>\n\n<pre><code>ghc <b>-XGeneralizedNewtypeDeriving</b> file.hs</code></pre>\n\n<p>we can declare the <code>Money</code> type as:</p>\n\n<pre><code>newtype Money = Money Integer deriving (Show, <b>Num</b>, Enum, Eq, Ord, <b>Real, Integral</b>)</code></pre>\n\n<p>and Haskell will perform the above derivations for us. This is, to the best of my knowledge, a GHC feature, and thus other Haskell compilers do not <em>per se</em> (well they can of course have this feature) support this.</p>\n"}, {"tags": [], "owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "is_accepted": false, "score": 4, "last_activity_date": 1541589349, "creation_date": 1541589349, "answer_id": 53188390, "question_id": 53188123, "link": "https://stackoverflow.com/questions/53188123/performing-algebra-with-newtypes-based-on-integers-haskell/53188390#53188390", "title": "Performing algebra with newtypes based on integers Haskell", "body": "<p>You're missing a instance of how your money can add together, the clue was in the error <code>Instance   : Num Money</code>.</p>\n\n<p>So for addition in Haskell the <code>Num</code> type what is needed to add two things together as long you are dealing with numbers so let's make an instance of <code>Num</code> on <code>Money</code>:</p>\n\n<pre><code>newtype Money =\n  Money Integer deriving Show\n\ninstance Num Money where\n  Money a + Money b = Money $ a + b\n\n-- Money 1 + Money 2 == Money 3\n</code></pre>\n\n<p>Notice that it returns <code>Money</code>, will let you research how you can get the number out of the type :)</p>\n"}], "owner": {"reputation": 145, "user_id": 5365363, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/R69Dw.png?s=128&g=1", "display_name": "Mats", "link": "https://stackoverflow.com/users/5365363/mats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 1, "accepted_answer_id": 53188346, "answer_count": 2, "score": 4, "last_activity_date": 1541626513, "creation_date": 1541588265, "question_id": 53188123, "link": "https://stackoverflow.com/questions/53188123/performing-algebra-with-newtypes-based-on-integers-haskell", "title": "Performing algebra with newtypes based on integers Haskell", "body": "<p>I'm having some trouble with performing simple addition, subtraction -- any kind of algebra really with Haskells newtype.</p>\n\n<p>My definition is (show included so I can print them to console):</p>\n\n<pre><code>newtype Money = Money Integer deriving Show\n</code></pre>\n\n<p>What I'm trying to do is basically:</p>\n\n<pre><code>Money 15 + Money 5 = Money 20\nMoney 15 - Money 5 = Money 10\nMoney 15 / Money 5 = Money 3\n</code></pre>\n\n<p>And so on, but I'm getting</p>\n\n<pre><code>m = Money 15\nn = Money 5\nMain&gt;&gt; m-n\n\nERROR - Cannot infer instance\n*** Instance   : Num Money\n*** Expression : m - n\n</code></pre>\n\n<p>I can't find a clear and consise explanation as to how the inheritance here works. Any and all help would be greatly appreciated.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1519, "user_id": 1486848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNtLf.jpg?s=128&g=1", "display_name": "ShamPooSham", "link": "https://stackoverflow.com/users/1486848/shampoosham"}, "edited": false, "score": 0, "creation_date": 1541582488, "post_id": 53186296, "comment_id": 93262488, "body": "There is no function <code>read::Char-&gt;Int</code> in the default libraries. <code>read</code> is only defined for string input in Prelude. You can always look at the type definitions at haskell.org/hoogle"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1541591341, "post_id": 53186296, "comment_id": 93266671, "body": "The module Data.Char provides the function <a href=\"https://www.haskell.org/hoogle/?hoogle=Char+-%3E+Int\" rel=\"nofollow noreferrer\"><code>digitToInt :: Char -&gt; Int</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 1141, "user_id": 1367497, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1ab83696683e53a9940cd2a8c480894?s=128&d=identicon&r=PG", "display_name": "peeyush singh", "link": "https://stackoverflow.com/users/1367497/peeyush-singh"}, "edited": false, "score": 2, "creation_date": 1541582137, "post_id": 53186402, "comment_id": 93262289, "body": "ahh completely forgot that read can only take string as the input! Thanks."}], "tags": [], "owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "is_accepted": true, "score": 7, "last_activity_date": 1541581905, "creation_date": 1541581905, "answer_id": 53186402, "question_id": 53186296, "link": "https://stackoverflow.com/questions/53186296/converting-char-to-int-in-haskell/53186402#53186402", "title": "Converting Char to Int in haskell", "body": "<p>The problem is <code>read :: Read a =&gt; String -&gt; a</code>. So <code>read</code> should be applied to <code>String</code> not to <code>Char</code>. Try this instead:</p>\n\n<pre><code> map (read :: String -&gt; Int) [\"1\", \"2\"]\n -- or\n map read [\"1\", \"2\"] :: [Int] -- same but clearer?\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 11, "last_activity_date": 1541595113, "last_edit_date": 1541595113, "creation_date": 1541588106, "answer_id": 53188081, "question_id": 53186296, "link": "https://stackoverflow.com/questions/53186296/converting-char-to-int-in-haskell/53188081#53188081", "title": "Converting Char to Int in haskell", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:read\" rel=\"noreferrer\"><code>read :: Read a =&gt; String -&gt; a</code></a> converts a <em>string</em> to a <code>Read</code>able element. So if you want to read the digits from a string, you can use:</p>\n\n<pre><code>map (read . pure :: Char -&gt; Int) ['1','2']\n</code></pre>\n\n<p>but if the characters are digits, it might be better to use the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Char.html#v:digitToInt\" rel=\"noreferrer\"><strong><code>digitToInt :: Char -&gt; Int</code></strong></a> function:</p>\n\n<pre><code>import Data.Char(digitToInt)\n\nmap digitToInt ['1', '2']\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 10619228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e83ffde9360cf171bfa20534704ece59?s=128&d=identicon&r=PG", "display_name": "albuck97", "link": "https://stackoverflow.com/users/10619228/albuck97"}, "is_accepted": false, "score": 2, "last_activity_date": 1541605171, "creation_date": 1541605171, "answer_id": 53192770, "question_id": 53186296, "link": "https://stackoverflow.com/questions/53186296/converting-char-to-int-in-haskell/53192770#53192770", "title": "Converting Char to Int in haskell", "body": "<p>You can try doing it this way <code>map (\\x -&gt; read (x:[]) :: Int) \"12\"</code>\nThis should work, if you have any doubts about it just search lambda expressions.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 7823114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa1c22e331dabfcddd340a48d28b35d3?s=128&d=identicon&r=PG&f=1", "display_name": "VladAndronik", "link": "https://stackoverflow.com/users/7823114/vladandronik"}, "is_accepted": false, "score": 2, "last_activity_date": 1570388941, "creation_date": 1570388941, "answer_id": 58260438, "question_id": 53186296, "link": "https://stackoverflow.com/questions/53186296/converting-char-to-int-in-haskell/58260438#58260438", "title": "Converting Char to Int in haskell", "body": "<p>You could try something like that:</p>\n\n<pre><code>toInt x = read x :: Int\nmap (toInt . (:\"\")) ['1', '2']\n</code></pre>\n"}], "owner": {"reputation": 1141, "user_id": 1367497, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c1ab83696683e53a9940cd2a8c480894?s=128&d=identicon&r=PG", "display_name": "peeyush singh", "link": "https://stackoverflow.com/users/1367497/peeyush-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13914, "favorite_count": 1, "accepted_answer_id": 53186402, "answer_count": 4, "score": 4, "last_activity_date": 1570388941, "creation_date": 1541581474, "question_id": 53186296, "link": "https://stackoverflow.com/questions/53186296/converting-char-to-int-in-haskell", "title": "Converting Char to Int in haskell", "body": "<p>I am trying to convert a string (of numbers) into individual digits. There are multiple ways to solve this, one being to <code>map digitToInt \"1234\"</code></p>\n\n<p>I was trying a similar approach but instead of using <code>digitToInt</code>, I was trying to use the <code>read::Char-&gt;Int</code> function. However I am getting compilation error when I use the above, as in:</p>\n\n<pre><code>map (read::Char-&gt;Int) ['1','2']\n</code></pre>\n\n<p>gives me the following error given below. I am not sure what is wrong here, I am trying to map a function which takes Char over a list of Char, what am I missing?</p>\n\n<p>Please do not tell me of alternate approach as I understand there are several other ways to do this. Just want to understand what is happening here.</p>\n\n<pre><code>Couldn't match type \u2018Char\u2019 with \u2018[Char]\u2019\n      Expected type: Char -&gt; Int\n        Actual type: String -&gt; Int\n    \u2022 In the first argument of \u2018map\u2019, namely \u2018(read :: Char -&gt; Int)\u2019\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 10583067, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kNbR847Vc5Q/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA9VRmC9k1kXg1B64azyHib2Jz4DQ/mo/photo.jpg?sz=128", "display_name": "Kev", "link": "https://stackoverflow.com/users/10583067/kev"}, "edited": false, "score": 0, "creation_date": 1541542333, "post_id": 53180708, "comment_id": 93251783, "body": "I knew I was overthinking it. I appreciate it!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1541549939, "last_edit_date": 1541549939, "creation_date": 1541541640, "answer_id": 53180708, "question_id": 53180649, "link": "https://stackoverflow.com/questions/53180649/haskell-return-numbers-in-a-given-list-greater-than-n/53180708#53180708", "title": "Haskell - Return numbers in a given list greater than n", "body": "<p>Keep it simple:</p>\n\n<pre><code>foo n xs = filter (&gt; n) xs\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>foo n = filter (&gt; n)\n</code></pre>\n\n<p>(We could also go further and write <code>foo = filter . (&lt;)</code> but I do not recommend it since we are approaching obfuscated code.)</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1541541952, "creation_date": 1541541952, "answer_id": 53180770, "question_id": 53180649, "link": "https://stackoverflow.com/questions/53180649/haskell-return-numbers-in-a-given-list-greater-than-n/53180770#53180770", "title": "Haskell - Return numbers in a given list greater than n", "body": "<p>You are mixing a <code>filter</code>-free definition (which mostly duplicates the definition of <code>filter</code>):</p>\n\n<pre><code>foo n [] = []\nfoo n (x:xs) | x &gt; n     = x : foo n xs\n             | otherwise =     foo n xs\n</code></pre>\n\n<p>with a thin wrapper around <code>filter</code>:</p>\n\n<pre><code>foo n xs = filter (&gt; n) xs\n-- foo n = filter (&gt; n)\n-- foo = filter . (&lt;)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "is_accepted": false, "score": 1, "last_activity_date": 1541574861, "creation_date": 1541574861, "answer_id": 53184959, "question_id": 53180649, "link": "https://stackoverflow.com/questions/53180649/haskell-return-numbers-in-a-given-list-greater-than-n/53184959#53184959", "title": "Haskell - Return numbers in a given list greater than n", "body": "<p>This can be done using fold function also. </p>\n\n<pre><code>foo n xs = foldl (\\acc x-&gt; if (x &lt; n) then x:acc else acc) [] xs\n</code></pre>\n\n<p>This is not the best approach for this problem but it becomes handy some times. </p>\n"}], "owner": {"reputation": 33, "user_id": 10583067, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kNbR847Vc5Q/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbA9VRmC9k1kXg1B64azyHib2Jz4DQ/mo/photo.jpg?sz=128", "display_name": "Kev", "link": "https://stackoverflow.com/users/10583067/kev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 956, "favorite_count": 0, "accepted_answer_id": 53180708, "answer_count": 3, "score": 1, "last_activity_date": 1541574861, "creation_date": 1541541394, "question_id": 53180649, "link": "https://stackoverflow.com/questions/53180649/haskell-return-numbers-in-a-given-list-greater-than-n", "title": "Haskell - Return numbers in a given list greater than n", "body": "<p>I have to create a function that receives a list of numbers and a number n, and it returns a list of all numbers greater than n. I want to use filter(>n) [x:xs] but I am unsure how to create that in a function foo.</p>\n\n<p>Example: foo [1,2,3,4,5] 3 returns [4,5].</p>\n\n<p>This is what I have but it isn't giving the correct output. I feel like it should be very simple.</p>\n\n<pre><code>foo n (x:xs)\n| n x       = x : filter(&gt;n) xs\n| otherwise = foo f xs\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541540148, "post_id": 53180348, "comment_id": 93250875, "body": "What library are you using? It looks like <code>matchEmpty</code> can only return <code>True</code> here."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1541540365, "post_id": 53180348, "comment_id": 93250964, "body": "What&#39;s the definition of <code>RE</code> and what&#39;s the whole error message? Which type was expected to be <code>a</code>, but was <code>RE a</code>? The type of <code>a</code> in <code>[a]</code>? If so, what are the operand types of <code>:+:</code>?"}, {"owner": {"reputation": 123, "user_id": 6669575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df689a83e4f53ca8c4f8fb29414d3d?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo H", "link": "https://stackoverflow.com/users/6669575/pablo-h"}, "edited": false, "score": 0, "creation_date": 1541540724, "post_id": 53180348, "comment_id": 93251125, "body": "matchEmpty can only return True or False, if it returns False for a then I know a has a value and I want to return a list of that value. The point of firstMatches is to return a list of the first values that are possible from a given regular expression."}, {"owner": {"reputation": 123, "user_id": 6669575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df689a83e4f53ca8c4f8fb29414d3d?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo H", "link": "https://stackoverflow.com/users/6669575/pablo-h"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1541540875, "post_id": 53180348, "comment_id": 93251187, "body": "@sepp2k added definition of RE. Expected return type is RE a. List should have a list of type a. :+: is regex for concatenation of two types a"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1541541136, "post_id": 53180348, "comment_id": 93251285, "body": "Can you please also post the full error message. &quot;Expected return type is RE a.&quot; Of what? The declared return type of <code>firstMatches</code> is <code>[a]</code>, not <code>RE a</code>. &quot;List should have a list of type a&quot; Not sure what you&#39;re trying to say here. &quot; :+: is regex for concatenation of two types a&quot; Not according to your code. According to your code <code>:+:</code> takes two <code>RE a</code>s, not two <code>a</code>s."}, {"owner": {"reputation": 123, "user_id": 6669575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df689a83e4f53ca8c4f8fb29414d3d?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo H", "link": "https://stackoverflow.com/users/6669575/pablo-h"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1541541463, "post_id": 53180348, "comment_id": 93251425, "body": "@sepp2k  Couldn&#39;t match expected type <code>a&#39; with actual type </code>[a]&#39;       <code>a&#39; is a rigid type variable bound by           the type signature for firstMatches :: RE a -&gt; [a]           at Project.hs:29:17     In the return type of a call of </code>firstMatches&#39;     In the expression: firstMatches a     In the expression: [firstMatches a]"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1541541813, "post_id": 53180348, "comment_id": 93251573, "body": "&quot;In the expression: firstMatches a In the expression: [firstMatches a]&quot; Those expressions don&#39;t seem to be part of the code you posted."}], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 0, "last_activity_date": 1541542368, "creation_date": 1541542368, "answer_id": 53180864, "question_id": 53180348, "link": "https://stackoverflow.com/questions/53180348/haskell-type-error-couldnt-match-expected-type-a-with-actual-type-re-a/53180864#53180864", "title": "Haskell type error - Couldn&#39;t match expected type `a&#39; with actual type &#39;RE a&#39;", "body": "<p>Your first code block has two things called <code>a</code>.  Here I replaced variables to avoid that duplication:</p>\n\n<pre><code>firstMatches :: RE r -&gt; [r] \nfirstMatches (a :+: b)\n    | (matchEmpty a == True) = [a]\n</code></pre>\n\n<p>Making the same substitution in the error message:</p>\n\n<blockquote>\n  <p>Couldn't match expected type 'r' with actual type [r].  'r' is a rigid type variable bound by the type signature for firstMatches :: RE r -> [r]</p>\n</blockquote>\n\n<p>You have <code>a :: Re r</code>, and construct <code>[a] :: [RE r]</code>.  But the type signature says that <code>firstMatches</code> returns <code>[r]</code>.  </p>\n\n<ol>\n<li>Maybe your implementation is correct, and you intend `firstMatches :: RE r -> [RE r]</li>\n<li>Maybe your type signature is correct.  One way to make the RHS match the type sig is <code>| (matchEmpty a == True) = []</code>.  This function that always returns the empty list isn't very useful, but there's no value of type <code>r</code> in scope that we can use.  Do you have other functions that take an <code>RE r</code> and give back an <code>r</code>?  Should <code>firstMatches</code> get another argument?</li>\n</ol>\n"}], "owner": {"reputation": 123, "user_id": 6669575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3df689a83e4f53ca8c4f8fb29414d3d?s=128&d=identicon&r=PG&f=1", "display_name": "Pablo H", "link": "https://stackoverflow.com/users/6669575/pablo-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 120, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1541542368, "creation_date": 1541539918, "last_edit_date": 1541540759, "question_id": 53180348, "link": "https://stackoverflow.com/questions/53180348/haskell-type-error-couldnt-match-expected-type-a-with-actual-type-re-a", "title": "Haskell type error - Couldn&#39;t match expected type `a&#39; with actual type &#39;RE a&#39;", "body": "<p>So I have the following lines... </p>\n\n<pre><code>firstMatches :: RE a -&gt; [a] \nfirstMatches (a :+: b)\n    | (matchEmpty a == True) = [a]\n</code></pre>\n\n<p>where matchEmpty is defined as...</p>\n\n<pre><code>matchEmpty :: RE a -&gt; Bool\n\nmatchEmpty Empty =  True\nmatchEmpty (a :+: b)\n    | matchEmpty a == False = False\n    | matchEmpty b == False = False\n    | otherwise = True\n</code></pre>\n\n<p>I'm getting the error \"Couldn't match expected type `a' with actual type 'RE a'\"</p>\n\n<p>I'm pretty sure I'm just not giving the correct argument for matchEmpty but I don't know what to do</p>\n\n<pre><code>matchEmpty a == False = False\n</code></pre>\n\n<p>RE is defined as </p>\n\n<pre><code>data RE a            -- regular expressions over an alphabet defined by 'a'\n= Empty          -- empty regular expression\n| Sym a          -- match the given symbol\n| RE a :+: RE a  -- concatenation of two regular expressions\n| RE a :|: RE a  -- choice between two regular expressions\n| Rep (RE a)     -- zero or more repetitions of a regular expression\n| Rep1 (RE a)    -- one or more repetitions of a regular expression\nderiving (Show)\n</code></pre>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541538571, "post_id": 53179993, "comment_id": 93250243, "body": "There is a <code>ppa</code> that contains the latest GHC versions: <a href=\"https://launchpad.net/~hvr/+archive/ubuntu/ghc\" rel=\"nofollow noreferrer\">launchpad.net/~hvr/+archive/ubuntu/ghc</a>"}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541539475, "post_id": 53179993, "comment_id": 93250594, "body": "@WillemVanOnsem When I added it and tried to update, it gave a 404."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1541540000, "post_id": 53179993, "comment_id": 93250815, "body": "Use <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">stack</a>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1541544438, "post_id": 53179993, "comment_id": 93252609, "body": "@n.m. &quot;Use stack&quot; isn&#39;t really an answer to &quot;how do I install cabal-install&quot;, especially given that the OP&#39;s issue appears to be a pre-installation configuration mixup, as opposed to any difficulties while actually using cabal-install."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 2, "creation_date": 1541544738, "post_id": 53179993, "comment_id": 93252731, "body": "The Cabal homepage <a href=\"https://www.haskell.org/cabal/download.html\" rel=\"nofollow noreferrer\">haskell.org/cabal/download.html</a> has precompiled versions of Cabal-install for various architectures. Regrettably, at this moment there aren&#39;t binaries for the latest 2.4 version, only for 2.2. Take care to put the executable in a path that gives it preference to the system-installed one. There are binary packages for GHC as well <a href=\"https://www.haskell.org/ghc/download_ghc_8_4_4.html#binaries\" rel=\"nofollow noreferrer\">haskell.org/ghc/download_ghc_8_4_4.html#binaries</a>"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1541544840, "post_id": 53179993, "comment_id": 93252773, "body": "Another option is to disregard the GHC/Cabal-install that come with the standard package marager (sometimes they&#39;re quite old) and download and install the Haskell Platform instead <a href=\"https://www.haskell.org/platform/\" rel=\"nofollow noreferrer\">haskell.org/platform</a>"}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1541555749, "post_id": 53179993, "comment_id": 93255385, "body": "@danidiaz How do you determine which paths have precedence? The director <code>~&#47;.cabal&#47;bin</code> is not in my <code>PATH</code> variable, should I put it in toward the front of its definition?"}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1541556760, "post_id": 53179993, "comment_id": 93255553, "body": "@danidiaz Also, looking through the Cabal folder, I don&#39;t see binaries.  The only folders present are Distribution, Language, tests, and doc.  The <code>~&#47;.cabal&#47;bin</code> folder was for the system-installed one but the downloaded one doesn&#39;t seem to have a <code>bin</code> folder."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1541565810, "post_id": 53179993, "comment_id": 93257156, "body": "@duplode It&#39;s not an answer indeed, because OP is asking a wrong question (XY problem)."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541565950, "post_id": 53179993, "comment_id": 93257185, "body": "@n.m. What are X and Y, then?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541566952, "post_id": 53179993, "comment_id": 93257384, "body": "Cabal is a tool. Tools are out there to help people solve problems. What problem does Cabal help solve? That&#39;s X. (Building Haskell programs and libraries).  Any problem with obtaining and using tools would be Y then. A good question is &quot;how do I build Haskell programs and libraries&quot; A good answer is &quot;use stack&quot;. It will do the right thing, which includes obtaining and using the correct tools (ghc and cabal) for the package one builds, automatically and transparently."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541568013, "post_id": 53179993, "comment_id": 93257548, "body": "@n.m. As far as building Haskell programs and libraries go, cabal-install and Stack are both reasonable options. That being so, it is reasonable to ask about how to get one of them working while expecting an answer involving the tool the question is actually about. I would say that taking &quot;use Stack&quot; as an acceptable answer to any cabal-install question (or vice-versa!) isn&#39;t constructive, and claiming the OP has asked a &quot;wrong question&quot; based on such an opinion is rather unpleasant."}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541568577, "post_id": 53179993, "comment_id": 93257668, "body": "@n.m. Thing is, I don&#39;t want to ask how to build programs and libraries.  Mostly I don&#39;t want to ask that because I am required to use Cabal by the person who gave me the assignment."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1541569290, "post_id": 53179993, "comment_id": 93257812, "body": "@duplode I&#39;m trying to be useful, not necessarily pleasant. I believe Stack is useful, more so than global Cabal."}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541569334, "post_id": 53179993, "comment_id": 93257826, "body": "@n.m. You think being pleasant comes at the cost of being useful?  That sounds like a thin excuse."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541569819, "post_id": 53179993, "comment_id": 93257916, "body": "You should mention that you have an assignment in the question, and what is the stated objective. Saves everyone&#39;s time. Stack uses Cabal and generates nesessarily Cabal files. If your assignment is to produce a Cabal-based Haskell package, Stack does that. If the assignment is to install Cabal on a computer, then Stack is not an answer."}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541569911, "post_id": 53179993, "comment_id": 93257941, "body": "@n.m. I&#39;m not sure I need to explain why I&#39;m asking my question ... seems like I should just be able to ask a well-defined question appropriate to StackOverflow.  I shouldn&#39;t have to try to anticipate reasons people will spend time trying to not answer the question."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541574920, "post_id": 53179993, "comment_id": 93259334, "body": "You don&#39;t <i>need</i> to explain why you are asking your question or provide extended context. However, doing so tends to help getting more useful answers. The choice is yours."}], "answers": [{"comments": [{"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1541559368, "post_id": 53182996, "comment_id": 93256038, "body": "When you say to remove any old installs of Cabal, does that include removing the <code>~&#47;.cabal&#47;</code> folder that&#39;s currently there from the system-install?"}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1541559597, "post_id": 53182996, "comment_id": 93256080, "body": "So what I&#39;ve done so far is: I did not delete the <code>~&#47;.cabal</code> folder as I suspect I shouldn&#39;t.  I downloaded the <code>cabal-install</code> binaries, moved them to this folder.  Since the folder doesn&#39;t have a <code>bin</code> folder, should I make one?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1541560021, "post_id": 53182996, "comment_id": 93256149, "body": "@Addem (1) I suggest that you delete <code>~&#47;.cabal</code> as well -- it won&#39;t do harm, and it will remove one potential source of confusion. (If you had any executables installed with cabal-install there, you&#39;ll have to reinstall them; going by what you say that&#39;s not the case, though). (2) Yes, run <code>mkdir -p ~&#47;.cabal&#47;bin</code> to create that directory, and put the executable there."}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1541562283, "post_id": 53182996, "comment_id": 93256563, "body": "So I did that, downloaded the Cabal binaries, they were in a .tar.gz, so I moved the tarball to the <code>.cabal&#47;bin</code> folder and ran <code>sudo tar -xvzf ...</code> and the name of the tarball.  It created a new object called <code>cabal</code> but I don&#39;t seem to be able to do anything with it.  It&#39;s not a folder, or at least, I can&#39;t navigate into it.  I tried <code>.&#47;cabal</code> and <code>make install</code> and just <code>cabal</code> and <code>make cabal</code>.  So I&#39;m really confused about what I should do.  Should I have only moved the file after decompression rather than before?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1541562862, "post_id": 53182996, "comment_id": 93256672, "body": "@Addem &quot;Should I have only moved the file after decompression rather than before?&quot; -- Indeed. The <code>cabal</code> file you extract from the tarball is the executable; you don&#39;t need to do anything else with it other than moving it to <code>~&#47;.cabal&#47;bin</code>. By the way, don&#39;t use <code>sudo</code> to extract, or to do anything else: you are working in your home directory, so you don&#39;t need elevated permissions to do things."}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1541564037, "post_id": 53182996, "comment_id": 93256869, "body": "Ok, so I deleted everything, decompressed the tarball, made the directories without sudo, moved the binaries in.  Edited my <code>.bashrc</code> file so that the PATH is now <code>&#47;home&#47;addem&#47;.cabal&#47;bin:&#47;home&#47;addem&#47;anaconda3&#47;bin:&#47;usr&#47;local&#47;&zwnj;&#8203;texlive&#47;2018&#47;bin&#47;x86&zwnj;&#8203;_64-linux:$PATH</code>.  Navigated to <code>~&#47;.cabal&#47;bin</code> and entered <code>cabal new-update</code>.  I get the error &quot;No cabal.project file or cabal file matching the default glob &#39;./*.cabal&#39; was found.&quot;  If I enter <code>cabal new-install cabal-install</code> it gives the error &quot;Warning: The package list for &#39;hackage.haskell.org&#39; does not exist. Run &#39;cabal update&#39; to download it.&quot;"}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1541564132, "post_id": 53182996, "comment_id": 93256892, "body": "I tried running the cabal command from several other directories and the behavior was the same.  There&#39;s no boostrap file, but I think you mentioned that only if I had the source files, and I&#39;ve since been trying to work with the binaries."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1541564583, "post_id": 53182996, "comment_id": 93256972, "body": "@Addem (1) On <code>new-update</code>: sorry, I missed that <a href=\"https://github.com/haskell/cabal/issues/5096\" rel=\"nofollow noreferrer\"><code>new-update</code> in the 2.2 version doesn&#39;t work outside of a project</a> -- it does work with 2.4. For this first run, use <code>cabal update</code> instead. (2) Now that you have <code>~&#47;.cabal&#47;bin</code> in your path, you shouldn&#39;t need to navigate to it to run <code>cabal</code> -- just open a new terminal or run <code>source ~&#47;.bashrc</code> to make sure the new PATH is loaded."}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1541569393, "post_id": 53182996, "comment_id": 93257838, "body": "Finally!  I have Cabal 2 and Haskell 8!  Thanks so much for your help and patience, it was really wonderful to have this assistance."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1541569753, "post_id": 53182996, "comment_id": 93257898, "body": "@Addem You&#39;re welcome; glad it worked out in spite of my slip-ups in the course of explaining it."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 7, "last_activity_date": 1541731440, "last_edit_date": 1541731440, "creation_date": 1541559181, "answer_id": 53182996, "question_id": 53179993, "link": "https://stackoverflow.com/questions/53179993/how-do-you-get-the-most-recent-version-of-cabal-for-haskell/53182996#53182996", "title": "How do you get the most recent version of Cabal for Haskell?", "body": "\n\n<p>Along the lines of danidiaz's comments, I suggest directly installing cabal-install in your home directory.</p>\n\n<p>Begin by making sure you are actually using the 8.x version of GHC you want (use <code>which ghc</code> and <code>ghc --version</code> if need be). Also, get rid of any other cabal-install versions you might have installed, so that there is less margin for confusion.</p>\n\n<blockquote>\n  <p>The [directory] <code>~/.cabal/bin</code> is not in my <code>PATH</code> variable, should I put it in toward the front of its definition?</p>\n</blockquote>\n\n<p>Exactly. <code>~/.cabal/bin</code> is the default location for executables locally installed with cabal-install, which includes cabal-install itself, and so it must be in the PATH. Putting it towards the front of the PATH will give it priority over any system-wide installation of cabal-install installed with your package managers. (Note that that won't be an issue if you remove said system-wide installation beforehand.)</p>\n\n<hr>\n\n<p>Once the terrain is clear, you can download a suitable binary tarball from <a href=\"https://www.haskell.org/cabal/download.html\" rel=\"nofollow noreferrer\">Cabal's download page</a>, extract the executable and put it in <code>~/.cabal/bin</code>. As danidiaz notes, the binaries there aren't necessarily at the latest stable version (as I write this, the Linux binaries are 2.2.0.0 rather than 2.4.0.0), but that likely won't matter, as once you have some version of cabal-install available you can simply run...</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>cabal new-update # For version 2.4 or above; if not, use cabal update instead.\ncabal new-install cabal-install\n</code></pre>\n\n<p>... which will update your cabal-install to the latest stable version.</p>\n\n<p>(Note that I'm using <a href=\"https://www.haskell.org/cabal/users-guide/nix-local-build-overview.html\" rel=\"nofollow noreferrer\">the new-* cabal-install commands</a>. I strongly advise you to do the same.)</p>\n\n<hr>\n\n<blockquote>\n  <p>Also, looking through the Cabal folder, I don't see binaries. The only folders present are Distribution, Language, tests, and doc.</p>\n</blockquote>\n\n<p>It sounds like you downloaded the sources of Cabal, the library, rather than the ones of cabal-install, the tool. The cabal-install sources are also available from the download page linked above (as I write this, their version is 2.4.0.0). If you are getting them <a href=\"https://github.com/haskell/cabal\" rel=\"nofollow noreferrer\">from GitHub</a> instead, you should look into the <code>cabal-install</code> directory, rather than the <code>Cabal</code> one. Either way, once yo are in the appropriate directory, to install from source run...</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>./bootstrap.sh --sandbox\n</code></pre>\n\n<p>... which only requires GHC (as opposed to a pre-existing cabal-install). Once it finishes building cabal-install, the script will tell you the location of the executable (presumably in a <code>.cabal-sandbox/bin</code> subdirectory). Copy the executable to <code>~/.cabal/bin</code> and proceed as before.</p>\n"}], "owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 776, "favorite_count": 0, "accepted_answer_id": 53182996, "answer_count": 1, "score": 4, "last_activity_date": 1541731440, "creation_date": 1541538371, "question_id": 53179993, "link": "https://stackoverflow.com/questions/53179993/how-do-you-get-the-most-recent-version-of-cabal-for-haskell", "title": "How do you get the most recent version of Cabal for Haskell?", "body": "<p>I've just spent about an hour going in circles trying to get version 2 of Cabal.  Initially I found that the version that came with my LinuxMint install was version 1, so I tried <code>cabal update</code>, didn't do it.  So I found instructions which said to use <code>cabal install Cabal cabal-install</code>.  Did it, got an error.  Found that the error apparently had to do with using the most current version of Haskell. So I installed version 7 to get Cabal.  Seemed to work, looked like I finally got Cabal version 2.  But I also want the most current version of Haskell so I downloaded the binaries for it and installed that again--now it seems like Cabal is set back to version 1.  Is it not possible to have both version 8 of Haskell and version 2 of Cabal?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1541532682, "post_id": 53178582, "comment_id": 93247513, "body": "Works for me.  The ability to do this without <code>let</code> was added somewhat recently... what version of ghc are you using?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 4, "creation_date": 1541532757, "post_id": 53178582, "comment_id": 93247549, "body": "As for <code>:{</code>, it has to be on its own line"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1541534509, "post_id": 53178582, "comment_id": 93248361, "body": "(And the closer is <code>:}</code>, not <code>}:</code>.)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1541536087, "post_id": 53178582, "comment_id": 93249077, "body": "Does the single line one work if you surround the contents of the do-block with plain braces, that is <code>act = do { ... }</code>?"}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1541536166, "post_id": 53178582, "comment_id": 93249109, "body": "@luqui Yep, it was the version number, thought I had it up to date but my version controller gives me a pretty outdated one."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1541545702, "post_id": 53180233, "comment_id": 93253049, "body": "Worth noting that <code>let</code> is also a layout keyword as it takes a block of bindings, so <code>do { let x = 1; y = 2; pure (x, y) }</code> is invalid\u2014you need <code>do { let { x = 1; y = 2 }; pure (x, y) }</code>."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1541567343, "post_id": 53180233, "comment_id": 93257444, "body": "The general rule is that indenting in is equivalent to a &quot;virtual <code>{</code>&quot;, and indenting out is equivalent to &quot;virtual <code>}</code>&quot;s, one for every open layout level you indent out of."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 6, "last_activity_date": 1541540791, "last_edit_date": 1541540791, "creation_date": 1541539437, "answer_id": 53180233, "question_id": 53178582, "link": "https://stackoverflow.com/questions/53178582/can-anything-done-in-a-haskell-script-be-reproduced-in-a-ghci-session/53180233#53180233", "title": "Can anything done in a Haskell script be reproduced in a GHCi session?", "body": "<p>You can't <em>just</em> insert semicolons to replace each line break. Doing stuff on one line means opting out of the <a href=\"https://en.wikibooks.org/wiki/Haskell/Indentation\" rel=\"noreferrer\">layout rule</a>, so you have to insert your own semicolons <em>and braces</em>. This means you need to know where those braces and semicolons would be required without the layout rule. For this case in particular, each <code>do</code> block needs braces around the whole block, and semicolons between each operation. The layout rule normally inserts these for you based on indentation.</p>\n\n<p>So to write this specific example on one line, you can do this:</p>\n\n<pre><code>let act :: IO(Char, Char); act = do {x &lt;- getChar; getChar; y &lt;- getChar; return (x,y)}\n</code></pre>\n\n<p>On a new enough version of ghci you can omit the <code>let</code> as well.</p>\n\n<p>For simple enough <code>do</code> blocks you might even get away with omitting the braces. In your example there's only one place the <code>{</code> and <code>}</code> could possibly go, and so GHCI inserts them even when you do everything on one line. But for an expression with multiple <code>do</code> blocks or other multiline constructs, you will need to insert them explicitly if you want them on one line.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 0, "last_activity_date": 1541562229, "creation_date": 1541562229, "answer_id": 53183296, "question_id": 53178582, "link": "https://stackoverflow.com/questions/53178582/can-anything-done-in-a-haskell-script-be-reproduced-in-a-ghci-session/53183296#53183296", "title": "Can anything done in a Haskell script be reproduced in a GHCi session?", "body": "<p>On the broader question:</p>\n\n<blockquote>\n  <p>Besides just getting this particular case to work, is there a generic way of taking code that would run in a Haskell script and making it run in an interactive session?</p>\n</blockquote>\n\n<p>The closest thing I know of is using the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#ghci-cmd-:%7B\" rel=\"nofollow noreferrer\">multiline delimiters</a>, \"<code>:{</code> and <code>:}</code> (each on a single line of its own)\". They can handle almost anything you can throw at them. They <em>can't</em> handle imports (GHCi does support the full import syntax, but each import must be on its own in a line) and pragmas (the only alternative is <code>:set</code>, which also need a line all of its own), which means you can't help but separate them from the rest of the code and enter them beforehand.</p>\n\n<p>(You can always save the code somewhere and load the file with <code>:l</code>, and that will often turn out to be the more convenient option. Still, I have a soft spot for <code>:{</code> and <code>:}</code> -- if I want no more than trying out half a dozen lines of impromptu code with no context, I tend to open a text editor window, write the little snippet and paste it directly in GHCi.)</p>\n"}], "owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 53180233, "answer_count": 2, "score": 2, "last_activity_date": 1541562229, "creation_date": 1541531947, "question_id": 53178582, "link": "https://stackoverflow.com/questions/53178582/can-anything-done-in-a-haskell-script-be-reproduced-in-a-ghci-session", "title": "Can anything done in a Haskell script be reproduced in a GHCi session?", "body": "<p>I want to run the function </p>\n\n<pre><code>act :: IO(Char, Char)\nact = do x &lt;- getChar\n         getChar\n         y &lt;- getChar\n         return (x,y)\n</code></pre>\n\n<p>interactively in a GHCi session.  I've seen elsewhere that you can define a function in a session by using the semi-colon to replace a line-break.  However, when I write </p>\n\n<pre><code>act :: IO(Char, Char); act = do x &lt;- getChar; getChar; y &lt;- getChar; return (x,y)\n</code></pre>\n\n<p>it doesn't compile, saying </p>\n\n<pre><code>parse error on input \u2018;\u2019\n</code></pre>\n\n<p>I've elsewhere seen that <code>:{ ... }:</code> can be used for multiple line commands, but typing </p>\n\n<pre><code>:{ act :: IO(Char, Char)\n</code></pre>\n\n<p>and then hitting enter causes an error--perhaps I'm misunderstanding how to use them.  </p>\n\n<p>Besides just getting this particular case to work, is there a generic way of taking code that would run in a Haskell script and making it run in an interactive session?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541531119, "post_id": 53178348, "comment_id": 93246768, "body": "No, Haskell will, for a &quot;automatically generated&quot; <code>Ord</code>, first compare the constructors (in the order these are defined). Only  if the data constructor is the same, it will lexicographically compare the parameters."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 2, "creation_date": 1541537035, "post_id": 53178348, "comment_id": 93249544, "body": "&quot;Shouldn&#39;t B &lt;= C A A be false for the same reason [2] &lt; [1,5] is too?&quot; No, but <code>C B B &lt;= C A A</code> is false for that reason."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1541546032, "post_id": 53178348, "comment_id": 93253157, "body": "You can see the instances generated by <code>deriving</code> with the <code>-ddump-deriv</code> flag, and make the output a little more readable with options like <code>-dsuppress-uniques</code> and <code>-dsuppress-module-prefixes</code>. These options can be added on the command line, in the <code>ghc-options</code> field in a Cabal file, or with the pragma <code>{-# OPTIONS_GHC -ddump-deriv -dsuppress-uniques -dsuppress-module-prefixes #-}</code> in a module."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 7, "last_activity_date": 1541532116, "last_edit_date": 1541532116, "creation_date": 1541531703, "answer_id": 53178527, "question_id": 53178348, "link": "https://stackoverflow.com/questions/53178348/what-determines-data-constructor-order-in-haskell/53178527#53178527", "title": "What determines data constructor order in Haskell?", "body": "<p>The <a href=\"https://www.haskell.org/onlinereport/derived.html\" rel=\"noreferrer\">Haskell report</a> specifies how the automatically derived instances should look like:</p>\n\n<blockquote>\n  <p><strong>10.1  Derived instances of <code>Eq</code> and <code>Ord</code></strong></p>\n  \n  <p>The class methods automatically introduced by derived instances of\n  <code>Eq</code> and <code>Ord</code> are <code>(==)</code>, <code>(/=)</code>, <code>compare</code>, <code>(&lt;)</code>, <code>(&lt;=)</code>, <code>(&gt;)</code>,\n  <code>(&gt;=)</code>, <code>max</code>, and <code>min</code>. <strong>The latter seven operators are defined so\n  as to compare their arguments lexicographically with respect to the\n  constructor set given, with earlier constructors in the datatype\n  declaration counting as smaller than later ones</strong>.</p>\n  \n  <p>For example, for the <code>Bool</code> datatype, we have that <code>(True &gt; False) ==\n  True</code>.</p>\n  \n  <p>Derived comparisons <strong>always traverse constructors from left to\n  right</strong>. These examples illustrate this property:</p>\n\n<pre><code>  (1,undefined) == (2,undefined) =&gt;    False\n  (undefined,1) == (undefined,2) =&gt;    _|_\n</code></pre>\n  \n  <p>All derived operations of class <code>Eq</code> and <code>Ord</code> are strict in both\n  arguments. For example, <code>False &lt;= _|_ is _|_</code>, even though <code>False</code> is\n  the first constructor of the <code>Bool</code> type.</p>\n</blockquote>\n\n<p>So Haskell will implement an <code>Ord</code> function here where, regardless of the arguments, an object with data constructor <code>A</code> will be less than an object with data constructor <code>B</code>, and an object with data constructor <code>B</code> is less than an object with data constructor <code>C</code>. This is because <code>A</code> has been defined before <code>B</code> has been defined.</p>\n\n<p>Only in case the data constructor is the same, it compares the arguments lexicographically: so first the first arguments of both objects are compares, and if these are not equal, that is the result of the comparison, in case these are, then we compare the second arguments, and so on.</p>\n\n<p>So for your <code>T</code> type, these are implemented as:</p>\n\n<pre><code>instance Ord T where\n    (&lt;=) A A = True\n    (&lt;=) A B = True\n    (&lt;=) A (C _ _) = True\n    (&lt;=) B C = True\n    (&lt;=) B (C _ _) = True\n    (&lt;=) (C xa ya) (C xb yb) = xa &lt;= xb || (xa == xb &amp;&amp; ya &lt;= yb)\n    (&lt;=) _ _ = False\n</code></pre>\n\n<p>If a list is defined as:</p>\n\n<pre><code>data [] a = [] | (:) a ([] a)\n</code></pre>\n\n<p>then the order of a list also follows from that definition, since an empty list is less than a non-empty list, and in case we compare two non-empty lists, we first compare the first elements (first argument of the \"cons\" data constructor), and then in case of an equal head, we compare the tails (second argument of the \"cons\" constructor). So an automatic derivation would look like:</p>\n\n<pre><code>import Data.Monoid((&lt;&gt;))\n\ninstance Ord ([] a) where\n    compare [] [] = EQ\n    compare [] (_:_) = LT\n    compare (_:_) [] = GT\n    compare (ha:ta) (hb:tb) = compare ha hb &lt;&gt; compare ta tb\n</code></pre>\n\n<p>here the <code>(&lt;&gt;)</code> operator for <code>Ordering</code>s takes the left element if it is not equal to <code>EQ</code> and the right element otherwise.</p>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 5, "last_activity_date": 1541534060, "last_edit_date": 1541534060, "creation_date": 1541531735, "answer_id": 53178535, "question_id": 53178348, "link": "https://stackoverflow.com/questions/53178348/what-determines-data-constructor-order-in-haskell/53178535#53178535", "title": "What determines data constructor order in Haskell?", "body": "<p>An auto-generated <code>Ord</code> instance will consider one value less than another if it's constructor comes before the other in the list of constructors. If the constructors are the same, it will compare the elements pair-wise in lexicographical order. The <code>Ord</code> instance for lists acts the same way if we assume that <code>[]</code> comes before <code>:</code>.</p>\n\n<p>The reason that <code>[2] &lt;= [1,5]</code> is false is that <code>[2]</code> (a.k.a. <code>2 : []</code>) and <code>[1,5]</code> (a.k.a. <code>1:5:[]</code>) both use the same constructor, so it will compare <code>2</code> and <code>1</code> and <code>2</code> is greater than <code>1</code>.</p>\n\n<p>This reason does not apply to <code>B &lt;= C A A</code> at all. <code>B</code> and <code>C A A</code> do not use the same constructor, so <code>B</code> wins because it comes before <code>C</code> in the list of constructors.</p>\n"}], "owner": {"reputation": 109, "user_id": 10609356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q3gJijTJ3Go/AAAAAAAAAAI/AAAAAAAAAl4/CPnaPuLSFmU/photo.jpg?sz=128", "display_name": "Jaime Fern&#225;ndez", "link": "https://stackoverflow.com/users/10609356/jaime-fern%c3%a1ndez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1541534060, "creation_date": 1541531014, "question_id": 53178348, "link": "https://stackoverflow.com/questions/53178348/what-determines-data-constructor-order-in-haskell", "title": "What determines data constructor order in Haskell?", "body": "<p>When I run this on Haskell:</p>\n\n<pre><code>[2] &lt;= [1,5]\n</code></pre>\n\n<p>I get False.</p>\n\n<p>However, when I run this:</p>\n\n<pre><code>data T = A | B | C T T deriving (Eq,Ord)\nA &lt;= B &amp;&amp; B &lt;= C A A\n</code></pre>\n\n<p>I get True.</p>\n\n<p>Why is this? Shouldn't B &lt;= C A A be false for the same reason [2] &lt; [1,5] is too?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1541528128, "creation_date": 1541528128, "answer_id": 53177668, "question_id": 53177621, "link": "https://stackoverflow.com/questions/53177621/failing-to-use-map-on-my-own-defined-data-structure/53177668#53177668", "title": "Failing to use map on my own defined data structure", "body": "<p>You here applied the <code>map</code> on the <code>branch :: Tree -&gt; Tree a</code> function, instead of the result of <code>branch x</code>. This is due to the fact that te parenthesis are written in the wrong way.</p>\n\n<p>You can implement your function as:</p>\n\n<pre><code>sumTree :: Num a =&gt; Tree a -&gt; a\nsumTree x = element x + <b>sum (map sumTree (branch x))</b></code></pre>\n\n<p>Here we thus call <code>map</code> with <code>sumTree</code> and <code>(branch x)</code> as parameters.</p>\n\n<p>Here <code>branch x</code> will thus generate the list of branches, we then call <code>map sumTree</code> on that list to generate the sum of each subtree, and then we sum these up with <code>sum</code>. We then add <code>element x</code> to the result.</p>\n"}, {"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1541528478, "post_id": 53177733, "comment_id": 93245497, "body": "I don&#39;t think the <code>.</code> is necessarily misplaced. OP could well have meant <code>element x + (sum . map sumTree) (branch x)</code>. Indeed, to me that&#39;s what their whitespacing suggests."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1541528527, "post_id": 53177733, "comment_id": 93245528, "body": "@amalloy perhaps, though that would seem too advanced an error for someone confused about function call syntax. :) I think confusing <code>.</code> with <code>$</code> is pretty common."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541529026, "post_id": 53177733, "comment_id": 93245764, "body": "About reading those error messages, don&#39;t panic, take it slow, read them slowly and the meaning will become clearer. :)"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 4, "last_activity_date": 1541528382, "creation_date": 1541528382, "answer_id": 53177733, "question_id": 53177621, "link": "https://stackoverflow.com/questions/53177621/failing-to-use-map-on-my-own-defined-data-structure/53177733#53177733", "title": "Failing to use map on my own defined data structure", "body": "<p>Parentheses in Haskell serve for grouping of code elements only. Haskell function call syntax is not <code>f(x)</code>, it is simply <code>f x</code>.</p>\n\n<p>You wrote</p>\n\n<pre><code>sumTree x = element(x) + sum.map (sumTree) branch(x)\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre><code>sumTree x = element x + sum . map sumTree branch x\n</code></pre>\n\n<p>but you meant</p>\n\n<pre><code>sumTree x = element x + sum . map sumTree (branch x)\n</code></pre>\n\n<p>The dot is still misplaced, you wanted it to be</p>\n\n<pre><code>sumTree x = element x + (sum $ map sumTree (branch x))\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre><code>sumTree x = element x + sum (map sumTree (branch x))\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8301619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96b1539226c86d22c497f1c79a814adc?s=128&d=identicon&r=PG&f=1", "display_name": "porcupine", "link": "https://stackoverflow.com/users/8301619/porcupine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 53177733, "answer_count": 2, "score": 2, "last_activity_date": 1541531897, "creation_date": 1541527931, "last_edit_date": 1541531897, "question_id": 53177621, "link": "https://stackoverflow.com/questions/53177621/failing-to-use-map-on-my-own-defined-data-structure", "title": "Failing to use map on my own defined data structure", "body": "<p>I defined my own rose tree and tried to sum its content. All the types match, but it fails to compile for an unknown reason.<br>\nThat's my piece of code:</p>\n\n<pre><code>data Tree a = Tree {element :: a, branch :: [Tree a]} deriving (Show)\nsumTree :: (Num a) =&gt; Tree a -&gt; a\nsumTree x = element(x) + sum.map (sumTree) branch(x)\n</code></pre>\n\n<p>I am getting these errors:</p>\n\n<pre><code>Prelude&gt; ::l tree.hs\n[1 of 1] Compiling Main             ( tree.hs, interpreted )\n\ntree.hs:3:32: error:\n    \u2022 Couldn't match expected type \u2018Tree a -&gt; t0 a\u2019\n                  with actual type \u2018[b0]\u2019\n    \u2022 The function \u2018map\u2019 is applied to three arguments,\n      but its type \u2018(Tree b0 -&gt; b0) -&gt; [Tree b0] -&gt; [b0]\u2019 has only two\n      In the first argument of \u2018sum\u2019, namely \u2018(map (sumTree) branch (x))\u2019\n      In the second argument of \u2018(+)\u2019, namely\n        \u2018(sum (map (sumTree) branch (x)))\u2019\n    \u2022 Relevant bindings include\n        x :: Tree a (bound at tree.hs:3:9)\n        sumTree :: Tree a -&gt; a (bound at tree.hs:3:1)\n  |\n3 | sumTree x = element(x) + (sum (map (sumTree) branch(x)))\n  |                                ^^^^^^^^^^^^^^^^^^^^^^^\n\ntree.hs:3:46: error:\n    \u2022 Couldn't match expected type \u2018[Tree b0]\u2019\n                  with actual type \u2018Tree a0 -&gt; [Tree a0]\u2019\n    \u2022 Probable cause: \u2018branch\u2019 is applied to too few arguments\n      In the second argument of \u2018map\u2019, namely \u2018branch\u2019\n      In the first argument of \u2018sum\u2019, namely \u2018(map (sumTree) branch (x))\u2019\n      In the second argument of \u2018(+)\u2019, namely\n        \u2018(sum (map (sumTree) branch (x)))\u2019\n  |\n3 | sumTree x = element(x) + (sum (map (sumTree) branch(x)))\n  |                                              ^^^^^^\n</code></pre>\n\n<p>When clearly </p>\n\n<pre><code>Prelude&gt; :t branch\nbranch :: Tree a -&gt; [Tree a]\n</code></pre>\n"}, {"tags": ["function", "haskell", "mapping"], "comments": [{"owner": {"reputation": 1639, "user_id": 389946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f38ae5c8db89d6e4a997644ad609b7c0?s=128&d=identicon&r=PG", "display_name": "KJH", "link": "https://stackoverflow.com/users/389946/kjh"}, "edited": false, "score": 0, "creation_date": 1541520993, "post_id": 53175662, "comment_id": 93241495, "body": "Hello Rui - welcome! A good idea is to also include the error message you&#39;re getting."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541521318, "post_id": 53175662, "comment_id": 93241685, "body": "If you specified that <code>xs</code> is an <code>[Int]</code>, this is indeed not possible, since <code>(&#47;)</code> is defined over <code>Fractional</code>."}, {"owner": {"reputation": 39, "user_id": 9084155, "user_type": "registered", "profile_image": "https://graph.facebook.com/1819169931450044/picture?type=large", "display_name": "Rui", "link": "https://stackoverflow.com/users/9084155/rui"}, "edited": false, "score": 0, "creation_date": 1541521577, "post_id": 53175662, "comment_id": 93241821, "body": "Basically i have <code>potenciasPor12(funcao(xs))</code> in which <code>funcao</code> is basically <code>map (3-) xs</code> and i now have this error <code>&lt;interactive&gt;:176:1:     No instance for (Fractional Int)       arising from a use of \u2018potenciasPor12\u2019     In the expression: potenciasPor12 xs     In an equation for \u2018it\u2019: it = potenciasPor12 xs</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541525031, "post_id": 53175662, "comment_id": 93243793, "body": "Sounds like the monomorphism restriction: <code>xs</code> is defaulting to <code>[Int]</code> instead of the more general <code>Num a =&gt; [a]</code>"}, {"owner": {"reputation": 494, "user_id": 5447207, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d96199ece7ba3bc4f3c1d97d645f5fad?s=128&d=identicon&r=PG", "display_name": "Bargros", "link": "https://stackoverflow.com/users/5447207/bargros"}, "edited": false, "score": 1, "creation_date": 1541527244, "post_id": 53175662, "comment_id": 93244886, "body": "The compiler is complaining about the type argument being provided to (/12), if you type <code>:t map (&#47;12) xs</code> and <code>:t (&#47;)</code> in ghci, it should tell you that your list is the problem. In this case since you&#39;re trying to map <code>(&#47;12)</code> over a list of Ints, if you are not specifying the type of the list before hand then somehow the compiler&#39;s inference is defaulting the list from <code>Num a =&gt; [a]</code> to <code>[Int]</code>, in this case I&#39;d just specify what types my list holds when creating the list, basically <code>let xs = [1,2,3,4...50] :: (Num a, Enum a) =&gt; [a]</code>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1541529894, "post_id": 53175662, "comment_id": 93246164, "body": "@MarkSeemann I think this is a fine MCVE. As it happens you won&#39;t be able to reproduce if you&#39;re on a newer version of GHCI (and can&#39;t tell that it&#39;s the monomorphism restriction), but we don&#39;t normally expect everyone to post their GHCI version as part of the question - it&#39;s quite reasonable to assume this would be the same for all Haskell versions, in which case the question appears to OP to contain everything needed to reproduce the problem."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1541538080, "post_id": 53175662, "comment_id": 93250052, "body": "@amalloy OK, I stand corrected. Thank you for clarifying that. I&#39;ll delete my comment."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1541525305, "creation_date": 1541525305, "answer_id": 53177004, "question_id": 53175662, "link": "https://stackoverflow.com/questions/53175662/trouble-mapping-functions-with-the-operator-x/53177004#53177004", "title": "Trouble mapping functions with the operator (/x)", "body": "<p>If the monomorphism restriction is set (it is off by default in newer GCHi, but on in compiled code), then <code>xs</code> will default to <code>[Int]</code> rather than the more general type <code>Num a =&gt; [a]</code> which would work the the <code>(/)</code> operator.</p>\n\n<p>(In GHCi 8.4.1, at least, it appears to default to <code>Integer</code> instead of <code>Int</code>.)</p>\n\n<pre><code>% ghci\nGHCi, version 8.4.1: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; let xs = [1,2]\nPrelude&gt; :t xs\nxs :: Num a =&gt; [a]\nPrelude&gt; :set -XMonomorphismRestriction\nPrelude&gt; let ys = [1,2]\nPrelude&gt; :t ys\nys :: [Integer]\n</code></pre>\n\n<p>Always provide explicit type signatures to be sure:</p>\n\n<pre><code>% ghci -XMonomorphismRestriction\nGHCi, version 8.4.1: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; let xs = [23,32,1,3] :: Num a =&gt; [a]\nPrelude&gt; :t xs\nxs :: Num a =&gt; [a]\nPrelude&gt; map (/12) xs\n[1.9166666666666667,2.6666666666666665,8.333333333333333e-2,0.25]\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9084155, "user_type": "registered", "profile_image": "https://graph.facebook.com/1819169931450044/picture?type=large", "display_name": "Rui", "link": "https://stackoverflow.com/users/9084155/rui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 53177004, "answer_count": 1, "score": 1, "last_activity_date": 1541525305, "creation_date": 1541520518, "last_edit_date": 1541522503, "question_id": 53175662, "link": "https://stackoverflow.com/questions/53175662/trouble-mapping-functions-with-the-operator-x", "title": "Trouble mapping functions with the operator (/x)", "body": "<p>So i have the result of a function that given a list of ints subtractes an int to all of the numbers in the list and then i want to divide the new list by x in this case 12. If i do the first paragraph of coding it gives me an error but if i do the second one it is possible. How do i do this and why does it give me an error?</p>\n\n<pre><code>let xs = [23,32,1,3]\nmap (/12) xs\n\nmap(/12) [23,32,1,3]\n\npotenciasPor12 xs = map (/12) xs\n</code></pre>\n\n<p>This is the error i'm getting</p>\n\n<pre><code>&lt;interactive&gt;:176:1:\nNo instance for (Fractional Int)\n  arising from a use of \u2018potenciasPor12\u2019\nIn the expression: potenciasPor12 xs\nIn an equation for \u2018it\u2019: it = potenciasPor12 xs\n</code></pre>\n"}, {"tags": ["debugging", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1541519079, "post_id": 53175175, "comment_id": 93240349, "body": "You can use <code>trace</code> from <code>Debug.Trace</code> to print satements when something is evaluated."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1541522766, "post_id": 53175175, "comment_id": 93242563, "body": "Here&#39;s how I usually go about understanding how pure functions work: <a href=\"https://stackoverflow.com/a/48222438/126014\">stackoverflow.com/a/48222438/126014</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1541534236, "creation_date": 1541534236, "answer_id": 53179104, "question_id": 53175175, "link": "https://stackoverflow.com/questions/53175175/debugging-pure-method-chain/53179104#53179104", "title": "Debugging pure method chain", "body": "<p>I tend to use <a href=\"https://www.stackage.org/haddock/lts-12.17/base-4.11.1.0/Debug-Trace.html#v:trace\" rel=\"nofollow noreferrer\">trace</a> as previously mentioned</p>\n\n<p><code>trace :: String -&gt; a -&gt; a</code> so it take a <code>String</code> and the value and returns the same value like <code>id</code>. It will be triggered at the point you want to use it, so for you:</p>\n\n<pre><code>main = do\n  dat &lt;- readTcpFile \"test.txt\"\n  _ &lt;- trace \"write what you want to see in console\" dat\n  writeTcpFile \"output.txt\" dat\n</code></pre>\n\n<p>if you want to trace the value of <code>dat</code> you have to make sure to convert it to a <code>String</code>.\nAlso inside the do block it's been bound to <code>_</code> so it doesn't do any side effects.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1541534236, "creation_date": 1541518826, "question_id": 53175175, "link": "https://stackoverflow.com/questions/53175175/debugging-pure-method-chain", "title": "Debugging pure method chain", "body": "<p>Hello i want to ask fellow haskellers how can you debug haskell programs efficiently if you have a long chain of pure methods.E.g:</p>\n\n<pre><code>do\n  a&lt;-impure\n  (pure a)  # where pure calls pure1-&gt;pure2-&gt;pure2 \n</code></pre>\n\n<p>How can i debug anything deep in the call stack if everything is not <code>IO</code> ,therefore i can't <code>print</code> or <code>writeFile</code> anywhere without significant effort ?<br>Do haskell fellows just change all signatures to <code>IO something</code> to see where the code crashes?</p>\n\n<p><strong>Concrete example</strong></p>\n\n<p><strong>Main</strong></p>\n\n<pre><code>module Main where \n    import Data.Text(Text,pack,unpack)\n    import Data.Text.IO(readFile,writeFile)\n    import TCPFile(TCPFile)\n    import TCPEncoding(toText,fromText)\n    main::IO()\n    main=do\n        dat&lt;-readTcpFile \"test.txt\"\n        print dat\n        writeTcpFile \"output.txt\" dat\n\n    writeTcpFile::FilePath-&gt;TCPFile-&gt;IO()\n    writeTcpFile path file=Data.Text.IO.writeFile path (toText file)\n\n    readTcpFile::FilePath-&gt;IO TCPFile\n    readTcpFile path =fromText &lt;$&gt; Data.Text.IO.readFile path \n\n\nmodule TCPEncoding where \nimport Data.Text\nclass TextEncode a where\n    toText::a-&gt; Text\n    fromText::Text-&gt; a\n</code></pre>\n\n<p>I will not write the whole hierarchy of methods.I just want to know how can i run the program until a certain line and get the variable values and the stack frame.</p>\n\n<p>In the case of this program all i get at the end written in my file with <code>writeTcpFile</code>is: </p>\n\n<p><code>main: &lt;&lt;loop&gt;&gt;</code><br><br>\nSo how can i debug the <code>fromText</code> method  used inside <code>readTcpFile</code> and its internals?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1541508817, "post_id": 53172307, "comment_id": 93234223, "body": "<code>fst :: (a,b) -&gt; a</code>. You need something like an <code>fst3</code>, which would work on triples, but that&#39;s not in the Prelude. Pretty easy to write yourself, though."}, {"owner": {"reputation": 145, "user_id": 10448841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ee631428bfbd476b1ab1c60d534e084?s=128&d=identicon&r=PG&f=1", "display_name": "Maqruis1", "link": "https://stackoverflow.com/users/10448841/maqruis1"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1541508870, "post_id": 53172307, "comment_id": 93234254, "body": "so fst works with only two element tuples?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 4, "creation_date": 1541508873, "post_id": 53172307, "comment_id": 93234255, "body": "<code>fst</code> only applies to pairs (2-tuples)"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1541509019, "last_edit_date": 1541509019, "creation_date": 1541508943, "answer_id": 53172343, "question_id": 53172307, "link": "https://stackoverflow.com/questions/53172307/haskell-couldnt-match-expected-type-a-b0-with-actual-type-a-b-h/53172343#53172343", "title": "Haskell: Couldn&#39;t match expected type \u2018(a, b0)\u2019 with actual type \u2018(a, b, h)\u2019", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:fst\" rel=\"noreferrer\"><strong><code>fst :: (a, b) -&gt; a</code></strong></a> only works for <strong>2</strong>-tuples, not tuples with a different arity than 2.</p>\n\n<p>You can use pattern matching to obtain the first item of the 3-tuple, and personally I would use pattern matching for the second tuple as well, since this is - in my opinion - a more transparent syntax:</p>\n\n<pre><code>g :: (a, b, h) -&gt; (c, d, i) -&gt; (a, c)\ng <b>(x, _, _)</b> <b>(y, _, _)</b> = (<b>x, y</b>)</code></pre>\n\n<p>Note that <code>((a, c))</code> is the same as <code>(a, c)</code>, so we can remove the extra parenthesis.</p>\n"}], "owner": {"reputation": 145, "user_id": 10448841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ee631428bfbd476b1ab1c60d534e084?s=128&d=identicon&r=PG&f=1", "display_name": "Maqruis1", "link": "https://stackoverflow.com/users/10448841/maqruis1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 53172343, "answer_count": 1, "score": 1, "last_activity_date": 1541509019, "creation_date": 1541508775, "question_id": 53172307, "link": "https://stackoverflow.com/questions/53172307/haskell-couldnt-match-expected-type-a-b0-with-actual-type-a-b-h", "title": "Haskell: Couldn&#39;t match expected type \u2018(a, b0)\u2019 with actual type \u2018(a, b, h)\u2019", "body": "<p>My code: </p>\n\n<pre><code>g :: (a, b, h) -&gt; (c, d, i) -&gt; ((a, c))\ng x y = ((fst x, fst y))\n</code></pre>\n\n<p>Why does it print the following errors?:  </p>\n\n<pre><code>ax.hs:11:15: error:\n    \u2022 Couldn't match expected type \u2018(a, b0)\u2019\n                  with actual type \u2018(a, b, h)\u2019\n    \u2022 In the first argument of \u2018fst\u2019, namely \u2018x\u2019\n      In the expression: fst x\n      In the expression: ((fst x, fst y))\n    \u2022 Relevant bindings include\n        x :: (a, b, h) (bound at ax.hs:11:3)\n        g :: (a, b, h) -&gt; (c, d, i) -&gt; (a, c) (bound at ax.hs:11:1)\n   |\n11 | g x y = ((fst x, fst y))\n   |               ^\n\nax.hs:11:22: error:\n    \u2022 Couldn't match expected type \u2018(c, b1)\u2019\n                  with actual type \u2018(c, d, i)\u2019\n    \u2022 In the first argument of \u2018fst\u2019, namely \u2018y\u2019\n      In the expression: fst y\n      In the expression: ((fst x, fst y))\n    \u2022 Relevant bindings include\n        y :: (c, d, i) (bound at ax.hs:11:5)\n        g :: (a, b, h) -&gt; (c, d, i) -&gt; (a, c) (bound at ax.hs:11:1)\n   |\n11 | g x y = ((fst x, fst y))\n</code></pre>\n\n<p>Please help. I'm not sure why this is happening. How do I fix it? Thank you</p>\n"}, {"tags": ["haskell", "package"], "answers": [{"comments": [{"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1541504960, "post_id": 53171021, "comment_id": 93232235, "body": "Thanks for info, but does it has documents describe how to use it?"}, {"owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 1, "creation_date": 1541505296, "post_id": 53171021, "comment_id": 93232402, "body": "I&#39;m not sure now I look, go into the preferences of the app and on the download tab you can download all the docsets you require or even straight to a repo. For example some of the ones I have are Haskell, Yesod, Persistent, Esquelito...  hope that helps"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 3, "creation_date": 1541507082, "post_id": 53171021, "comment_id": 93233270, "body": "@assembly.jc <a href=\"https://zealdocs.org/\" rel=\"nofollow noreferrer\">zealdocs.org</a> is a cross-platform client. (I personally don&#39;t find it useful, though.)"}, {"owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "edited": false, "score": 0, "creation_date": 1541509186, "post_id": 53171021, "comment_id": 93234417, "body": "or alternatively you could manually download them all for offline usage as mentioned here <a href=\"https://stackoverflow.com/questions/9454793/haskell-offline-documentation?rq=1\" title=\"haskell offline documentation\">stackoverflow.com/questions/9454793/&hellip;</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541509533, "post_id": 53171021, "comment_id": 93234628, "body": "@leftaroundabout I tried Zeal but it only has the packages in the Haskell Platform. That&#39;s nice, but a lot of packages are missing. I guess Dash has the same issue, since they share the docs (AFAICS)."}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1541557874, "post_id": 53171021, "comment_id": 93255748, "body": "@cmdv Thank for your help, it is no different for us whether documents are offline or online. I think I need to do it for myself, maybe someone has done the same thing, we are just reinvent the wheel."}], "tags": [], "owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1541509959, "last_edit_date": 1541509959, "creation_date": 1541503821, "answer_id": 53171021, "question_id": 53170644, "link": "https://stackoverflow.com/questions/53170644/where-do-i-find-the-haskell-packages-document-in-javadoc-style/53171021#53171021", "title": "Where do I find the Haskell packages document in javadoc style?", "body": "<p>I tend to use <a href=\"https://kapeli.com/dash\" rel=\"nofollow noreferrer\">Dash</a> but technically that's just downloading it from Hackage, you can also <a href=\"https://stackoverflow.com/questions/9454793/haskell-offline-documentation?rq=1\">build docs locally</a> (if library has them) but I find those a little cumbersome.</p>\n"}], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1541509959, "creation_date": 1541502479, "last_edit_date": 1541508824, "question_id": 53170644, "link": "https://stackoverflow.com/questions/53170644/where-do-i-find-the-haskell-packages-document-in-javadoc-style", "title": "Where do I find the Haskell packages document in javadoc style?", "body": "<p><a href=\"https://hackage.haskell.org/\" rel=\"nofollow noreferrer\">Hackage</a> is great and always be the first place to study how function to be defined and used of specific package.  </p>\n\n<p>However, frequently, we need refers multi-packages simultaneously, e.g. Control.Monad, Data.List and ... so on, and switches among of them. The easy way to do that is open mulit-tabs in chrome, but as the number of tabs grow, there are many tabs be opened and the name of package on the tab cannot be showed fully.</p>\n\n<p>So, Are there exist some web sites organize Haskell packages documents like <a href=\"https://docs.oracle.com/javase/8/docs/api/\" rel=\"nofollow noreferrer\">javadoc</a> style, we can browse and select packages in right frame and show the content of document in left frame. Furthermore, it is more appreciated if it can save and list frequent use package document in another frame.</p>\n"}, {"tags": ["haskell", "ghci", "haskell-platform"], "comments": [{"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 4, "creation_date": 1541500943, "post_id": 53170142, "comment_id": 93230233, "body": "<code>cuadrados&#39;</code> has no empty list case, so when quickCheck generates the test <code>cuadrados [] == cuadrados&#39; []</code> it fails."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1541500981, "post_id": 53170142, "comment_id": 93230254, "body": "well that is correct, your <code>cuadrados&#39;</code> only works with <i>non</i>-empty lists, you should use <code>cuadrados&#39; xs  = cuadrados&#39;&#39; (pares xs)</code>, or event better <code>cuadrados&#39; = cuadrados&#39;&#39; . pares</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1541501421, "post_id": 53170142, "comment_id": 93230497, "body": "The missing pattern is not only found by QuickCheck, but even by GHC itself if you enable warnings."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1541501549, "post_id": 53170142, "comment_id": 93230562, "body": "It is really advisable to always compile with <code>-Wall</code>: like chi says, the compiler can already generate a lists of patterns for which the funcion is not defined."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541518295, "post_id": 53170142, "comment_id": 93239866, "body": "Unrelated, but don&#39;t use <code>[x] ++ y</code> when <code>x:y</code> will do. Also, don&#39;t reimplement <code>map</code> when you don&#39;t have to: <code>cuadrados&#39;&#39; = map (^2)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1541587922, "post_id": 53188013, "comment_id": 93265177, "body": "If you code works, feel free to head over to <a href=\"https://codereview.stackexchange.com\">Code Review</a>."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 0, "last_activity_date": 1541587876, "creation_date": 1541587876, "answer_id": 53188013, "question_id": 53170142, "link": "https://stackoverflow.com/questions/53170142/quickcheck-non-exhaustive-patterns-in-function-haskell/53188013#53188013", "title": "QuickCheck - Non exhaustive patterns in function - Haskell", "body": "<p>We can find that problem immediately if we either apply <code>-Wall</code> in GHC (which automatically enables <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/flags.html#ghc-flag--Wincomplete-patterns\" rel=\"nofollow noreferrer\"><code>-Wincomplete-patterns</code></a>) or just try the found counter example by hand.</p>\n\n<p>QuickCheck finds <code>xs = []</code> as counterexample. So let us have a look at <code>cuadrados'</code>:</p>\n\n<pre><code>cuadrados' []\n</code></pre>\n\n<p>At that point, we cannot continue, as <code>cuadrados'</code> only binds on a single pattern: <code>(x:xs)</code>. Unfortunately, <code>[]</code> cannot match that pattern and you end up with an error. To fix it, simply add another pattern:</p>\n\n<pre><code>cuadrados' []     = []\ncuadrados' (x:xs) = \u2026\n</code></pre>\n\n<p>or just use</p>\n\n<pre><code>cuadrados' xs = cuadrados'' (pares xs)\n</code></pre>\n\n<p>as we don't use the first element explicitly.</p>\n\n<p>That being said, <code>pares</code> is <code>filter even</code>, and <code>cuadrados</code> is <code>map (^2) . filter even</code>. Try to use the standard library and higher order functions a little bit more.</p>\n"}], "owner": {"reputation": 98, "user_id": 7671431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8dbf6f132deeebc3106cf3e6ee9fbd9?s=128&d=identicon&r=PG&f=1", "display_name": "vps", "link": "https://stackoverflow.com/users/7671431/vps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541587876, "creation_date": 1541500502, "question_id": 53170142, "link": "https://stackoverflow.com/questions/53170142/quickcheck-non-exhaustive-patterns-in-function-haskell", "title": "QuickCheck - Non exhaustive patterns in function - Haskell", "body": "<p>I have  two function. One is implemented using patterns and the other using intensive lists. I want to check if the result is the same always with QickCheck.</p>\n\n<pre><code>pares xs = [a | a &lt;- xs , mod a 2 == 0]\ncuadrados xs = [x^2 | x &lt;- pares xs ]\ncuadrados'' [] = []\ncuadrados'' (x:xs) = [x^2] ++ cuadrados'' xs\ncuadrados' (x:xs)  = cuadrados'' (pares (x:xs))\n</code></pre>\n\n<p>Im trying:</p>\n\n<pre><code>prop_cuadrados xs = cuadrados xs == cuadrados' xs\n</code></pre>\n\n<p>When I try quickCkeck prop_cuadrados the output is the following:</p>\n\n<blockquote>\n  <p>*Main> quickCheck prop_cuadrados\n  *** Failed! (after 1 test):\n  Exception:\n    sesion4.hs:10:1-47: Non-exhaustive patterns in function cuadrados'\n  []</p>\n</blockquote>\n\n<p>How can I solve this problem?\nThanks</p>\n"}, {"tags": ["haskell", "gloss"], "comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 2, "creation_date": 1541499341, "post_id": 53169728, "comment_id": 93229364, "body": "just call <code>exitWith</code> in <code>input</code> or <code>step</code> wherever you would check the condition, if all the chips have been eaten. <code>exitWith</code> is polymorphic in <code>a</code> an can be called in any <code>IO a</code> context, whatever <code>a</code> is. So <code>IO world</code> is ok."}, {"owner": {"reputation": 175, "user_id": 8843385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36b066e6fbd3997a82d7ea39d665603?s=128&d=identicon&r=PG&f=1", "display_name": "ramon abacherli", "link": "https://stackoverflow.com/users/8843385/ramon-abacherli"}, "reply_to_user": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1541500703, "post_id": 53169728, "comment_id": 93230109, "body": "I actually tried that the first time, because I thought that too, and it didn&#39;t work then (I think it was a typo somewhere then). Now it works, thank you ;)"}], "owner": {"reputation": 175, "user_id": 8843385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c36b066e6fbd3997a82d7ea39d665603?s=128&d=identicon&r=PG&f=1", "display_name": "ramon abacherli", "link": "https://stackoverflow.com/users/8843385/ramon-abacherli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 360, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1541498949, "creation_date": 1541498949, "question_id": 53169728, "link": "https://stackoverflow.com/questions/53169728/how-to-exit-a-game-in-playio-function", "title": "How to Exit a Game in playIO function?", "body": "<p>I am making Pacman in Haskell Gloss. Now I am trying to Exit the game, once all the chips on the gameboard have been eaten by pacman. I have the function to check if that is the case, but I can't find a way to exit the game after that.</p>\n\n<p>This is because I don't have a function that returns an IO a (because exitWith outputs that).</p>\n\n<p>Here is the code of my Main.hs:</p>\n\n<pre><code>window :: Display\nwindow = FullScreen\n\nbackground :: Color\nbackground = black\n\nfps :: Int\nfps = 5\n\nmain :: IO ()\nmain = playIO (InWindow \"Pacman\" (600, 600) (0, 0)) -- Or FullScreen\n          background            -- Background color\n          fps               -- Frames per second\n          initialState     -- Initial state\n          view             -- View function\n          input            -- Event function\n          step             -- Step function from controller\n</code></pre>\n\n<p>The playIO function has the following type signature:</p>\n\n<pre><code>playIO :: Display -&gt; \n          Color -&gt; \n          Int -&gt; \n          world -&gt; \n          (world -&gt; IO Picture) -&gt;\n          (Event -&gt; world -&gt; IO world) -&gt; \n          (Float -&gt; world -&gt; IO world) -&gt; \n          IO ()\n</code></pre>\n\n<p>I might be overlooking something, but I would like to exit the loop of the playIO function once there is a winner. The following function might be of help:</p>\n\n<pre><code>exitWith :: ExitCode -&gt; IO a\n</code></pre>\n\n<p>Any advice is greatly appreciated, I am still new to Haskell/Gloss.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 733, "user_id": 1025192, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/134f2acc9c6343574969a9fa937175c1?s=128&d=identicon&r=PG", "display_name": "Magicloud", "link": "https://stackoverflow.com/users/1025192/magicloud"}, "edited": false, "score": 0, "creation_date": 1541488418, "post_id": 53166996, "comment_id": 93224367, "body": "So Char is involved any way. I can see the filter func, just wondering if there is a more directly way. Thanks."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 733, "user_id": 1025192, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/134f2acc9c6343574969a9fa937175c1?s=128&d=identicon&r=PG", "display_name": "Magicloud", "link": "https://stackoverflow.com/users/1025192/magicloud"}, "edited": false, "score": 1, "creation_date": 1541494600, "post_id": 53166996, "comment_id": 93226963, "body": "@Magicloud: What would you prefer to write, over <code>T.filter isPrint t</code> / <code>T.all isPrint t</code>? (Assuming <code>import qualified Data.Text as T</code> and <code>t :: Text</code>.) I guess if you\u2019re going to use this operation in multiple places, you can factor it out into a function, e.g. <code>onlyPrint = T.filter isPrint</code> then use <code>onlyPrint t</code>."}, {"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "reply_to_user": {"reputation": 733, "user_id": 1025192, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/134f2acc9c6343574969a9fa937175c1?s=128&d=identicon&r=PG", "display_name": "Magicloud", "link": "https://stackoverflow.com/users/1025192/magicloud"}, "edited": false, "score": 0, "creation_date": 1541495442, "post_id": 53166996, "comment_id": 93227303, "body": "@Magicloud Not likely there is a specialised function for that."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 733, "user_id": 1025192, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/134f2acc9c6343574969a9fa937175c1?s=128&d=identicon&r=PG", "display_name": "Magicloud", "link": "https://stackoverflow.com/users/1025192/magicloud"}, "edited": false, "score": 1, "creation_date": 1541507925, "post_id": 53166996, "comment_id": 93233747, "body": "@Magicloud Of course <code>Char</code> is involved; <code>Text</code> is a sequence of <code>Char</code>s."}], "tags": [], "owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "is_accepted": true, "score": 4, "last_activity_date": 1541487134, "creation_date": 1541487134, "answer_id": 53166996, "question_id": 53166882, "link": "https://stackoverflow.com/questions/53166882/is-there-a-way-to-check-if-the-char-is-printable-for-data-text/53166996#53166996", "title": "Is there a way to check if the char is printable for Data.Text?", "body": "<p>The function would have a signature of</p>\n\n<pre><code>(Char -&gt; Bool) -&gt; Text -&gt; Text\n</code></pre>\n\n<p>So, <a href=\"https://hayoo.fh-wedel.de/?query=(Char+-%3E+Bool)+-%3E+Text+-%3E+Text\" rel=\"nofollow noreferrer\">asking Hayoo</a> we find <a href=\"http://hackage.haskell.org/package/text/docs/Data-Text-Lazy.html#v:filter\" rel=\"nofollow noreferrer\">Data.Text.filter</a>:</p>\n\n<pre><code>filter :: (Char -&gt; Bool) -&gt; Text -&gt; Text\n</code></pre>\n\n<p>Or if you wanted to ensure all the characters in the string are printable, let's <a href=\"https://hayoo.fh-wedel.de/?query=%28Char+-%3E+Bool%29+-%3E+Text+-%3E+Bool\" rel=\"nofollow noreferrer\">ask for</a>...</p>\n\n<pre><code>(Char -&gt; Bool) -&gt; Text -&gt; Bool\n</code></pre>\n\n<p>And find <a href=\"http://hackage.haskell.org/package/text/docs/Data-Text.html#v:all\" rel=\"nofollow noreferrer\">Data.Text.all</a>:</p>\n\n<pre><code>all :: (Char -&gt; Bool) -&gt; Text -&gt; Bool\n</code></pre>\n"}], "owner": {"reputation": 733, "user_id": 1025192, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/134f2acc9c6343574969a9fa937175c1?s=128&d=identicon&r=PG", "display_name": "Magicloud", "link": "https://stackoverflow.com/users/1025192/magicloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 53166996, "answer_count": 1, "score": 0, "last_activity_date": 1541487134, "creation_date": 1541486561, "question_id": 53166882, "link": "https://stackoverflow.com/questions/53166882/is-there-a-way-to-check-if-the-char-is-printable-for-data-text", "title": "Is there a way to check if the char is printable for Data.Text?", "body": "<p>There is an \"isprint\" in Data.Char which just calls a C function.</p>\n\n<p>Now I have a bunch of Text from Data.Text needs to be filtered by this. Is there an efficient way? Or I have to convert Text to String?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "functor"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1541485463, "post_id": 53165836, "comment_id": 93223325, "body": "As a matter of style, I\u2019d probably write this as <code>fmap greet &lt;$&gt; fmap maybeName pb</code> to reduce parentheses. You can check the type of a subexpression like <code>fmap</code> using a \u201ctype wildcard\u201d (<code>_</code>), e.g. <code>(fmap :: _) greet &lt;$&gt; (fmap :: _) maybeName pb</code>: the compiler will report that the first has type <code>(a -&gt; b) -&gt; Maybe a -&gt; Maybe b</code>, the second <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code>. Also, you can compose the two fmaps into one by the <code>Functor</code> law <code>fmap f . fmap g</code> = <code>fmap (f . g)</code>, which also lets you omit (eta-reduce) the <code>pb</code> parameter: <code>generateScripts = fmap (fmap (&quot;Hello &quot; ++) . maybeName)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": true, "score": 3, "last_activity_date": 1541487592, "last_edit_date": 1541487592, "creation_date": 1541482183, "answer_id": 53166227, "question_id": 53165836, "link": "https://stackoverflow.com/questions/53165836/confusion-on-using-functor/53166227#53166227", "title": "confusion on using functor &lt;$&gt;", "body": "<p><code>(greet &lt;$&gt;)</code> is a function which apply to each elements of type Maybe String, and the <code>(greet &lt;$&gt;) &lt;$&gt;</code> apply to whole List, i.e. [Maybe String], as illustration</p>\n\n<pre><code>(greet &lt;$&gt;) &lt;$&gt; (maybeName &lt;$&gt; pb)\n= (greet &lt;$&gt;) &lt;$&gt; [Just \"Bob\", Nothing, Just \"Alice\"]\n= [greet &lt;$&gt; Just \"Bob\", greet &lt;$&gt; Nothing, greet &lt;$&gt; Just \"Alice\"] \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 0, "last_activity_date": 1541482903, "creation_date": 1541482903, "answer_id": 53166320, "question_id": 53165836, "link": "https://stackoverflow.com/questions/53165836/confusion-on-using-functor/53166320#53166320", "title": "confusion on using functor &lt;$&gt;", "body": "<p>Looks like <code>&lt;$&gt;</code> near <code>greet</code> is a <code>fmap</code> for <code>Maybe</code>, that is, it applies <code>greet</code> to <code>x</code> if the value is <code>Just x</code> and does nothing in case of <code>Nothing</code>.</p>\n\n<p>So, <code>maybeName &lt;$&gt; pb</code> maps <code>maybeName</code> function over <code>pb</code> list, the <code>&lt;$&gt;</code> in the middle maps <code>greet &lt;$&gt;</code> over the result and the <code>greet &lt;$&gt;</code> itself modifies <code>Just</code> values with <code>greet</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 5, "last_activity_date": 1541483021, "creation_date": 1541483021, "answer_id": 53166336, "question_id": 53165836, "link": "https://stackoverflow.com/questions/53165836/confusion-on-using-functor/53166336#53166336", "title": "confusion on using functor &lt;$&gt;", "body": "<p><code>pb</code> is a list of <code>(String, String)</code> tuples.</p>\n\n<p><code>maybeName &lt;$&gt; pb</code> maps <code>maybeName</code> over that list, giving <code>[Maybe String]</code> (a list of Maybes). The functor in question is <code>[]</code>.</p>\n\n<p><code>(greet &lt;$&gt;) &lt;$&gt; ...</code> maps <code>(greet &lt;$&gt;)</code> over that list, i.e. it applies <code>(greet &lt;$&gt;)</code> to each element of the list (the elements having type <code>Maybe String</code>). The functor in question is <code>[]</code>.</p>\n\n<p><code>(greet &lt;$&gt;)</code> maps <code>greet</code> over <code>Maybe String</code>. The functor in question is <code>Maybe</code>.</p>\n\n<p>In general, if you have a function <code>f :: a -&gt; b</code>, then <code>(f &lt;$&gt;) :: (Functor f) =&gt; f a -&gt; f b</code>, and <code>((f &lt;$&gt;) &lt;$&gt;) :: (Functor f, Functor g) =&gt; g (f a) -&gt; g (f b)</code>. Every <code>&lt;$&gt;</code> maps over another layer of functor.</p>\n\n<p>In this case we have <code>g = []</code> and <code>f = Maybe</code>, so this effectively makes <code>greet :: String -&gt; String</code> operate on a structure where strings are nested two levels deep, such as <code>[Maybe String]</code>.</p>\n"}], "owner": {"reputation": 93, "user_id": 10502229, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Saki", "link": "https://stackoverflow.com/users/10502229/saki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 53166227, "answer_count": 3, "score": 4, "last_activity_date": 1541487592, "creation_date": 1541479312, "last_edit_date": 1541482525, "question_id": 53165836, "link": "https://stackoverflow.com/questions/53165836/confusion-on-using-functor", "title": "confusion on using functor &lt;$&gt;", "body": "<p>Why does the code of line     </p>\n\n<pre><code>generateScripts pb = (greet &lt;$&gt;) &lt;$&gt; (maybeName &lt;$&gt; pb\n</code></pre>\n\n<p>have an extra functor after <code>greet</code>? Based on my understanding, I know that the LHS function will be used on the RHS but since there is an extra functor, I don't understand how it works.</p>\n\n<pre><code>maybeName :: (String, String) -&gt; Maybe String\nmaybeName p = if length (snd p) == 10 then Just (fst p) else Nothing\n\ngenerateScripts :: [(String, String)] -&gt; [Maybe String]\ngenerateScripts pb = (greet &lt;$&gt;) &lt;$&gt; (maybeName &lt;$&gt; pb)\n    where greet = (\"Hello \"++)\n\nphonebook = [ (\"Bob\",   \"0178866524\"), (\"Fred\",  \"01624556442\"), (\"Alice\", \"0188998533\") ]\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; phonebook = [ (\"Bob\",   \"0178866524\"), (\"Fred\",  \"01624556442\"), (\"Alice\", \"0188998533\") ]\nGHCi&gt; generateScripts phonebook\n[Just \"Hello Bob\",Nothing,Just \"Hello Alice\"]\n</code></pre>\n"}, {"tags": ["haskell", "return-value"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 4, "creation_date": 1541476177, "post_id": 53165485, "comment_id": 93221137, "body": "<code>return</code> is not a special keyword. It is a function. It has type <code>return :: Monad m =&gt; a -&gt; m a</code>. I don&#39;t think applying this function is what you are looking to do (for one, as its type signature indicates, its the type of its result is not the same as its input type). It is a shame that <code>return</code> has the name that it has because it is really unrelated to what <code>return</code> means in many other languages."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1541476397, "post_id": 53165485, "comment_id": 93221170, "body": "BTW nowadays <code>pure</code> is preferred to <code>return</code> (according to hlint), probably because <code>return</code> is confusing in exactly this way."}, {"owner": {"reputation": 17, "user_id": 10024999, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kDi7ZlYU-0Y/AAAAAAAAAAI/AAAAAAAAACU/arPvof09Ub0/photo.jpg?sz=128", "display_name": "Takyon", "link": "https://stackoverflow.com/users/10024999/takyon"}, "edited": false, "score": 0, "creation_date": 1541476688, "post_id": 53165485, "comment_id": 93221217, "body": "Thank you all for the fast reply, I did understand that it was a function, but I didn&#39;t thought that the use of <code>Monad</code> would alter it&#39;s type. I guess my problem here is the understanding of <code>Monad</code>."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1541486439, "post_id": 53165485, "comment_id": 93223637, "body": "You <i>can</i> use <code>do</code> notation to write pure code; you just need to omit <code>return</code>/<code>pure</code> and avoid binding statements (<code>pattern &lt;- expression</code>), e.g. <code>do (ssm, csm)</code> is equivalent to <code>(ssm, csm)</code>. <code>let</code> statements will also work: <code>do { let { x = 1; y = 2 }; let { z = 3 }; (x, y, z) }</code> is equivalent to <code>let { x = 1; y = 2 } in let { z = 3 } in (x, y, z)</code>. The only potential advantage of using <code>do</code> notation everywhere is that you wouldn\u2019t need to change the syntax of a pure function if you added effects later\u2014but that\u2019s fairly rare and not idiomatic, so it\u2019s not really worth it imo."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 3, "last_activity_date": 1541476246, "creation_date": 1541476246, "answer_id": 53165503, "question_id": 53165485, "link": "https://stackoverflow.com/questions/53165485/the-use-of-do-return-expressions-in-haskell/53165503#53165503", "title": "The use of `do..return` expressions in Haskell", "body": "<p><code>return</code> is a function of type <code>Monad m =&gt; a -&gt; m a</code>, so when you pass in a value of type <code>(SmartMail, CompteSmail)</code>, you get back a value of type <code>m (SmartMail, CompteSmail)</code> for some monad <code>m</code> (for example <code>IO (SmartMail, CompteSmail)</code> or <code>Maybe (SmartMail, CompteSmail)</code>). Since that's not what you want here, you shouldn't use <code>return</code>.</p>\n\n<p><code>do</code> notation is unrelated to this. <code>do</code> is simply a syntactic shortcut around the <code>&gt;&gt;</code> and <code>&gt;&gt;=</code> operators. When you use <code>do</code> with a single expression, it does nothing at all. In other words <code>envoyerMessage' ssm csm tr = do return (ssm, csm)</code> is exactly the same as just <code>envoyerMessage' ssm csm tr = return (ssm, csm)</code>.</p>\n"}], "owner": {"reputation": 17, "user_id": 10024999, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kDi7ZlYU-0Y/AAAAAAAAAAI/AAAAAAAAACU/arPvof09Ub0/photo.jpg?sz=128", "display_name": "Takyon", "link": "https://stackoverflow.com/users/10024999/takyon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 53165503, "answer_count": 1, "score": 1, "last_activity_date": 1541476400, "creation_date": 1541476023, "last_edit_date": 1541476400, "question_id": 53165485, "link": "https://stackoverflow.com/questions/53165485/the-use-of-do-return-expressions-in-haskell", "title": "The use of `do..return` expressions in Haskell", "body": "<p>For this fonction:</p>\n\n<pre><code>envoyerMessage' :: SmartMail -&gt; CompteSmail -&gt; Trame -&gt; (SmartMail, CompteSmail)\n</code></pre>\n\n<p>For the sake of testing, I try to simply return the element passed without any changes.</p>\n\n<p>My problem is this:</p>\n\n<pre><code>envoyerMessage' ssm csm tr = (ssm, csm) \n</code></pre>\n\n<p>works as intended, but with <code>do..return</code>:</p>\n\n<pre><code>envoyerMessage' ssm csm tr = do\n                             return (ssm, csm)\n</code></pre>\n\n<p>I get this error message:\n<a href=\"https://i.stack.imgur.com/UuJZj.png\" rel=\"nofollow noreferrer\">error about being unable to match actual and expected type</a></p>\n\n<p>Why does <code>return</code> doesn't return the expected type?</p>\n\n<p>edit: I often see <code>return</code> being associated with <code>IO type</code> in the function description, is it related to this issue? Will the value obtained from a <code>return</code> always be of <code>IO type</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "edited": false, "score": 2, "creation_date": 1541474675, "post_id": 53165315, "comment_id": 93220871, "body": "You have a pattern for a string of length 2+ and 0, but you do not have a pattern for length 1."}], "answers": [{"comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 2, "creation_date": 1541476666, "post_id": 53165513, "comment_id": 93221213, "body": "The condition <code>length(x:x2:xs) &gt; 1</code> can&#39;t possibly be false, so that <code>if</code> statement is unnecessary since the <code>else</code> can never be executed. The other <code>if</code> statement is also unnecessary because if <code>length (x:xs)</code> weren&#39;t 1 (that is if <code>xs</code> weren&#39;t empty), the first pattern would have matched already. With that in mind, we can also conclude that the pattern <code>x:xs</code> is equivalent to <code>[x]</code> in this case because, as I said, the previous pattern would already have matched if there were more than one element."}], "tags": [], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "is_accepted": true, "score": 0, "last_activity_date": 1541476337, "creation_date": 1541476337, "answer_id": 53165513, "question_id": 53165315, "link": "https://stackoverflow.com/questions/53165315/haskell-checking-string-length-non-exhaustive-patterns-exception/53165513#53165513", "title": "haskell checking String length - Non-exhaustive patterns exception", "body": "<pre><code>length' :: String -&gt; String \nlength' (x:x2:xs) = if length(x:x2:xs) &gt; 1\n                    then \"length is &gt;1\"\n                    else length'(x:x2:xs)\n\nlength' (x:xs) = if length(x:xs) == 1\n                    then \"length is 1\"\n                    else \"\"\n\nlength' \"\" = \"\"\n</code></pre>\n\n<p>This solves the problem for me. (x:x2:xs) is a pattern for String of length 2+ and 0 as @Brady Dean said. Now when String with the length of 1 is passed to this function it will call the function again and now it will have a pattern for 1+ and 0.</p>\n"}, {"tags": [], "owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "is_accepted": false, "score": 3, "last_activity_date": 1541506770, "last_edit_date": 1541506770, "creation_date": 1541477057, "answer_id": 53165581, "question_id": 53165315, "link": "https://stackoverflow.com/questions/53165315/haskell-checking-string-length-non-exhaustive-patterns-exception/53165581#53165581", "title": "haskell checking String length - Non-exhaustive patterns exception", "body": "<p>You are missing the case for the single element in the string. </p>\n\n<p>There is also no need for if else. A simple pattern matching can solve the problem. </p>\n\n<p>The way the cases of pattern matching are placed are important. The base case should be first. In this case it may not matter as there is no recursion. But still it's better to write in that way as it is easy to read.</p>\n\n<pre><code>length' :: String -&gt; String\nlength' \"\" = \"\"\nlength' [x] = \"length is 1\"\nlength' _ = \"length is &gt; 1\"              \n</code></pre>\n\n<p>In the last line we don't use the argument anywhere, hence _. </p>\n"}], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 53165513, "answer_count": 2, "score": 0, "last_activity_date": 1541506770, "creation_date": 1541474347, "question_id": 53165315, "link": "https://stackoverflow.com/questions/53165315/haskell-checking-string-length-non-exhaustive-patterns-exception", "title": "haskell checking String length - Non-exhaustive patterns exception", "body": "<p>Why does length function work well when checking for Strings that are >1 and it gives <strong>Non-exhaustive patterns in function</strong> error for ones that are exatly length 1?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>    length' :: String -&gt; String \n    length' (x:x2:xs) = if length(x:x2:xs) == 1\n                           then \"length is 1\"\n                           else \"length is &gt; 1\" \n    length' \"\" = \"\" \n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>input : \"aa\"\noutput: \"length is &gt; 1\"\n\ninput : \"a\" \noutput: \"*** Exception: untitled.hs:(169,1)-(172,15): Non-exhaustive patterns in function length'\n</code></pre>\n\n<p>However: </p>\n\n<pre><code>        length' :: String -&gt; String \n        length' (x:xs) = if length(x:xs) == 1\n                               then \"length is 1\"\n                               else \"length is &gt; 1\" \n        length' \"\" = \"\"\n</code></pre>\n\n<p>Example: </p>\n\n<pre><code>input : \"a\"\noutput: \"length is 1\"\n</code></pre>\n"}, {"tags": ["haskell", "types", "equivalence"], "comments": [{"owner": {"reputation": 109, "user_id": 10609356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q3gJijTJ3Go/AAAAAAAAAAI/AAAAAAAAAl4/CPnaPuLSFmU/photo.jpg?sz=128", "display_name": "Jaime Fern&#225;ndez", "link": "https://stackoverflow.com/users/10609356/jaime-fern%c3%a1ndez"}, "edited": false, "score": 0, "creation_date": 1541443137, "post_id": 53160080, "comment_id": 93210869, "body": "More context: this is a question from a test that shows 3 answers. The first 2 ones are the ones I showed, and the third answer is &quot;the other answers are wrong&quot;. This is the correct answer according to the test solutions."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1541443334, "post_id": 53160080, "comment_id": 93210968, "body": "I would double-check I copied the Q&amp;A correctly. If no errors are found, I would suggest you report this Q&amp;A to your instructor (assuming they wrote the test)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1541446983, "post_id": 53160080, "comment_id": 93212629, "body": "Presumably this notation was defined in class or earlier in the test. Otherwise if the notation is completely undefined of course the question is unanswerable. But we don&#39;t have access to the materials you do to search for the definition, so..."}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 3, "last_activity_date": 1541442542, "creation_date": 1541442542, "answer_id": 53160130, "question_id": 53160080, "link": "https://stackoverflow.com/questions/53160080/what-makes-two-type-expressions-in-haskell-equivalent/53160130#53160130", "title": "What makes two type expressions in Haskell equivalent?", "body": "<p>I agree with your assessment. All three types are different and you have simplified them correctly. Are you sure you're reading the question and answer right, if you think the answer provided disagrees with yours?</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1541443125, "creation_date": 1541443125, "answer_id": 53160240, "question_id": 53160080, "link": "https://stackoverflow.com/questions/53160080/what-makes-two-type-expressions-in-haskell-equivalent/53160240#53160240", "title": "What makes two type expressions in Haskell equivalent?", "body": "<p>Indeed, they are all distinct for the reason you mention.</p>\n\n<p>We can even ask GHC to confirm it. (Below, I chose <code>a ~ Int</code> to obtain a closed type.)</p>\n\n<pre><code>&gt; import Data.Type.Equality\n&gt; type T1 a = (a -&gt; a) -&gt; (a -&gt; a -&gt; a)\n&gt; type T2 a = a -&gt; a -&gt; ((a -&gt; a) -&gt; a)\n&gt; type T3 a = a -&gt; a -&gt; (a -&gt; (a -&gt; a))\n&gt; :kind! T1 Int == T2 Int\nT1 Int == T2 Int :: Bool\n= 'False\n&gt; :kind! T1 Int == T3 Int\nT1 Int == T3 Int :: Bool\n= 'False\n&gt; :kind! T2 Int == T3 Int\nT2 Int == T3 Int :: Bool\n= 'False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541446071, "post_id": 53160538, "comment_id": 93212165, "body": "<code>:t [f . g, g . f]</code> reports a type. :) can we conclude from this that both are <code>id</code>, no matter what <code>f</code> and <code>g</code> themselves are?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541456617, "post_id": 53160538, "comment_id": 93216686, "body": "@WillNess Good question, but I think that doesn&#39;t hold in general. A far removed counterexample would be <code>[join . return, return . join]</code>. Back to the present case, a shortcut would be noting the most general type for both <code>f</code> and <code>g</code> is <code>(a -&gt; b -&gt; c -&gt; d) -&gt; c -&gt; b -&gt; a -&gt; d</code>, which parametricity ensures can only be implemented as <code>\\x c b a -&gt; x a b c</code>, which is its own inverse. (That only works with the most general type, as with <code>f :: T1 -&gt; T2</code>, we can sneak stuff in -- e.g. <code>\\x c b a -&gt; x (a . a) b c</code>."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 5, "last_activity_date": 1541445121, "last_edit_date": 1541445121, "creation_date": 1541444448, "answer_id": 53160538, "question_id": 53160080, "link": "https://stackoverflow.com/questions/53160080/what-makes-two-type-expressions-in-haskell-equivalent/53160538#53160538", "title": "What makes two type expressions in Haskell equivalent?", "body": "<p>The three types...</p>\n\n<pre><code>type T1 a = (a -&gt; a) -&gt; (a -&gt; a -&gt; a)\ntype T2 a = a -&gt; a -&gt; ((a -&gt; a) -&gt; a)\ntype T3 a = a -&gt; a -&gt; (a -&gt; (a -&gt; a))\n</code></pre>\n\n<p>... are indeed distinct. However, <code>T1</code> and <code>T2</code> are equivalent <em>in the sense that</em> there is an isomorphism between them, which amounts to changing the order of arguments:</p>\n\n<pre><code>GHCi&gt; :info T1\ntype T1 a = (a -&gt; a) -&gt; a -&gt; a -&gt; a\n    -- Defined at &lt;interactive&gt;:12:1\nGHCi&gt; :info T2\ntype T2 a = a -&gt; a -&gt; (a -&gt; a) -&gt; a\n    -- Defined at &lt;interactive&gt;:13:1\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; :t flip\nflip :: (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c\nGHCi&gt; :t (flip .)\n(flip .) :: (a1 -&gt; a2 -&gt; b -&gt; c) -&gt; a1 -&gt; b -&gt; a2 -&gt; c\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; f = (flip .) . flip\nGHCi&gt; :t f :: T1 a -&gt; T2 a\nf :: T1 a -&gt; T2 a :: T1 a -&gt; T2 a\nGHCi&gt; g = flip . (flip .)\nGHCi&gt; :t g :: T2 a -&gt; T1 a\ng :: T2 a -&gt; T1 a :: T2 a -&gt; T1 a\n</code></pre>\n\n<p>We can then show that <code>f</code> and <code>g</code> are inverses (i.e. <code>g . f = id</code> and <code>f . g = id</code>):</p>\n\n<pre><code>f . g\n(flip .) . flip . flip . (flip .)\n(flip .) . (flip .) -- flip . flip = id\nid -- (flip .) . (flip .) = \\h -&gt; \\x -&gt; flip (flip (h x)) = \\h -&gt; \\x -&gt; h x = id\n\ng . f\nflip . (flip .) . (flip .) . flip\nflip . flip \nid\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 10609356, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Q3gJijTJ3Go/AAAAAAAAAAI/AAAAAAAAAl4/CPnaPuLSFmU/photo.jpg?sz=128", "display_name": "Jaime Fern&#225;ndez", "link": "https://stackoverflow.com/users/10609356/jaime-fern%c3%a1ndez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 53160240, "answer_count": 3, "score": 4, "last_activity_date": 1541487455, "creation_date": 1541442292, "last_edit_date": 1541487455, "question_id": 53160080, "link": "https://stackoverflow.com/questions/53160080/what-makes-two-type-expressions-in-haskell-equivalent", "title": "What makes two type expressions in Haskell equivalent?", "body": "<p>So I was asked whether these 3 type expressions where equivalent in Haskell:</p>\n\n<pre><code>\u03c41 = (a -&gt; a) -&gt; (a -&gt; a -&gt; a)\n\u03c42 = a -&gt; a -&gt; ((a -&gt; a) -&gt; a)\n\u03c43 = a -&gt; a -&gt; (a -&gt; (a -&gt; a))\n</code></pre>\n\n<p>if I take away the parenthesis I'm left with this</p>\n\n<pre><code>\u03c41 = (a -&gt; a) -&gt; a -&gt; a -&gt; a\n\u03c42 = a -&gt; a -&gt; (a -&gt; a) -&gt; a\n\u03c43 = a -&gt; a -&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>So it's obvious to me that they are all different from each other. However, according to the question, these two answers are wrong:</p>\n\n<pre><code>\u03c41 !\u2261 \u03c42 !\u2261 \u03c43 !\u2261 \u03c41\n\u03c41 !\u2261 \u03c42 \u2261 \u03c43\n</code></pre>\n\n<p>So I'm a bit confused right here, what would be the right answer and why?</p>\n"}, {"tags": ["haskell", "compiler-errors"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1541437890, "post_id": 53159048, "comment_id": 93208635, "body": "You forgot the <code>else</code> case."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1541437926, "post_id": 53159048, "comment_id": 93208645, "body": "But it looks like you want to use a <code>filter</code> here."}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541438127, "post_id": 53159048, "comment_id": 93208736, "body": "I know it is easier to use filter but i want to use fold if it is possible"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541438173, "post_id": 53159048, "comment_id": 93208760, "body": "I didn&#39;t forget the else because in this case is not necessary at least I think so"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1541438227, "post_id": 53159048, "comment_id": 93208783, "body": "in Haskell an <code>if</code> has <i>always</i> a <code>then</code> and <code>else</code> since you do not specify <i>actions</i> but functions. It also looks like you here ignore the <code>acc</code>, as a result, this will return a <i>function</i>, not a string."}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541438293, "post_id": 53159048, "comment_id": 93208813, "body": "So how do i do this without the if and with the foldl?"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541438327, "post_id": 53159048, "comment_id": 93208826, "body": "I did it with filter which has worked but i wanted to try it with foldl or foldr"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1541438852, "post_id": 53159048, "comment_id": 93209051, "body": "@RuiFernando Consider doing it <i>with</i> the <code>if</code>. What would happen in the <code>else</code> branch? Think about what you have in the <code>then</code> branch and think about how it would be different in the <code>else</code> case. Also, don&#39;t put parentheses around an operator that you are using infix: <code>acc (++) x</code> is not the same as <code>acc ++ x</code>. You will want the second one since that is the one that uses <code>++</code> as an infix operator (there is a type error there as well, but I think that will put you on the right track for that part)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541439369, "post_id": 53159048, "comment_id": 93209280, "body": "<code>Char</code> has an <code>Ord</code> instance; you can write <code>x &gt;= &#39;A&#39; &amp;&amp; x &lt;= &#39;G&#39; || x &gt;= &#39;a&#39; &amp;&amp; x &lt;=  &#39;g&#39;</code>. Even simpler, just use <code>toLower x `elem` [&#39;a&#39;..&#39;g&#39;]</code> (as <code>Char</code> also has an <code>Enum</code> instance)."}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1541439632, "post_id": 53159048, "comment_id": 93209394, "body": "I realy don&#39;t get it what to put in the else case because i don&#39;t see another case. Like if the char isn&#39;t between that values it will just ignore it"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1541439728, "post_id": 53159048, "comment_id": 93209449, "body": "@RuiFernando Well, can you describe what you are doing in the <code>then</code> case (in terms of <code>acc</code> and <code>x</code>)? What does the function you have in the <code>foldl</code> do when it is in the <code>then</code> case?"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1541439755, "post_id": 53159048, "comment_id": 93209462, "body": "Nevermind this is my new attempt     foldl (\\acc x -&gt; if toLower x <code>elem</code> [&#39;a&#39;..&#39;g&#39;] then acc ++ x else acc) [] xs"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1541439873, "post_id": 53159048, "comment_id": 93209520, "body": "I want to put the x always in the end of the string"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1541439914, "post_id": 53159048, "comment_id": 93209539, "body": "@RuiFernando You&#39;ve almost got it! Think about the type of <code>(++)</code>. Willem Van Onsem&#39;s suggestion would give the correct order if you were using <code>foldr</code> (instead of <code>foldl</code>)."}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1541439958, "post_id": 53159048, "comment_id": 93209557, "body": "So if i put foldr it is done? Not really understanding the fold"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1541440344, "post_id": 53159048, "comment_id": 93209745, "body": "@RuiFernando I would suggest continuing with <code>foldl</code> right now since you are so close, and then figure out <code>foldr</code> afterwards. Like I said: the remaining error you have is due to how you are using <code>++</code>. Specifically, the type is wrong. You should look at the type of <code>++</code> and compare it to the types of the two things you are giving it. Also, <a href=\"https://image.slidesharecdn.com/introtohaskell2011-04-13-170607095410/95/introduction-to-haskell-20110413-83-638.jpg?cb=1496829637\" rel=\"nofollow noreferrer\">these diagrams</a> I find useful in understanding the folds (the ones at the bottom of the slide)."}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1541440350, "post_id": 53159048, "comment_id": 93209750, "body": "So i made this    foldl (\\acc x -&gt; if toLower x <code>elem</code> [&#39;a&#39;..&#39;g&#39;] then (x:acc) else acc) [] xs with the string &quot;ag12&quot; and it gave me the ouput &quot;ga&quot; but i want it to give me &quot;ag&quot;. How do i do it?"}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1541440792, "post_id": 53159048, "comment_id": 93209937, "body": "Nevermind just used <code>reverse</code>"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1541440851, "post_id": 53159048, "comment_id": 93209966, "body": "Well, the key to fixing the original <code>foldl</code> code is understanding why <code>acc ++ x</code> gives a type error. Consider the type of <code>x</code> and compare to the type <code>(++)</code> expects."}, {"owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "edited": false, "score": 0, "creation_date": 1541440917, "post_id": 53159048, "comment_id": 93209983, "body": "Yeah now i got it right. Thank you all guys"}], "answers": [{"tags": [], "owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1541480066, "creation_date": 1541480066, "answer_id": 53165927, "question_id": 53159048, "link": "https://stackoverflow.com/questions/53159048/haskel-parse-error-on-input-in-a-fuction/53165927#53165927", "title": "Haskel parse error on input &#39;)&#39; in a fuction", "body": "<p>You are finding all occurrecne of letters A to G in a string in case in sensitive manner. As said in comments you are missing the else case. The else case should simply be returning the acc variable. </p>\n\n<p>But still there are mistakes in your program. The function chr takes a number and returns ascii character. What you need is ord, which takes char and returns ascii value. </p>\n\n<p>So the version of your program will be </p>\n\n<pre><code>ola xs = foldl (\\acc x -&gt; if (ord x &gt;= 65 &amp;&amp; ord x &lt;= 71 || ord x &gt;= 97 &amp;&amp; ord x &lt;= 103) then acc ++ [x] else acc) [] xs\n</code></pre>\n\n<p>Char data type is already of the Ord class, so you can compare them. No need for using ord. With this you can write above as </p>\n\n<pre><code>ola xs = foldl (\\acc x -&gt; if (x &gt;= 'A' &amp;&amp; x &lt;= 'G' || x &gt;= 'a' &amp;&amp; x &lt;= 'g') then acc ++ [x] else acc) [] xs\n</code></pre>\n\n<p>There is special function in list known as filter which takes from a list only the needed elements. Using filter the above program will be. </p>\n\n<pre><code>ola xs = filter (\\x -&gt; x &gt;= 'A' &amp;&amp; x &lt;= 'G' || x &gt;= 'a' &amp;&amp; x &lt;= 'g') xs\n</code></pre>\n\n<p>now the argument can simply be removed and it can be simply written as </p>\n\n<pre><code>ola = filter (\\x -&gt; x &gt;= 'A' &amp;&amp; x &lt;= 'G' || x &gt;= 'a' &amp;&amp; x &lt;= 'g')\n</code></pre>\n\n<p><em>Bonus :-</em> \nBut now what if you have some random character you want to check. You can first create a string for the characters you want to filter. For the above example this will suffice.</p>\n\n<pre><code>strList=['A'..'G','a'..'g'];\n</code></pre>\n\n<p>Now filter using elem. elem checks if a given element is present in string. </p>\n\n<pre><code>ola xs = filter (\\x -&gt; elem x strList) xs\n</code></pre>\n\n<p><em>Bonus 2:-</em> \nWhat if you want to remove the arguments xs. For that first you need to first flip the arguments of the elem, so that the list will be first. </p>\n\n<pre><code>ola = filter ((flip elem) strList)\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 10550444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acee5395fdafa904623f041d827fdf9?s=128&d=identicon&r=PG", "display_name": "Rui Fernando", "link": "https://stackoverflow.com/users/10550444/rui-fernando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1541480066, "creation_date": 1541437859, "question_id": 53159048, "link": "https://stackoverflow.com/questions/53159048/haskel-parse-error-on-input-in-a-fuction", "title": "Haskel parse error on input &#39;)&#39; in a fuction", "body": "<p>Basically i have this code</p>\n\n<pre><code>ola xs = foldl (\\acc x -&gt; if (chr x &gt;= 65 &amp;&amp; chr x &lt;= 71 || chr x &gt;= 97 &amp;&amp; chr x &lt;= 103) then acc (++) x) [] xs\n</code></pre>\n\n<p>And when i try to load it on ghci it says i have a parse error in the last parenthesys so can you help me? What is wrong here? </p>\n"}, {"tags": ["list", "haskell", "functional-programming", "permutation"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1541432684, "post_id": 53157534, "comment_id": 93205760, "body": "<code>filterM (\\_ -&gt; [False, True]) [2,4,8]</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541432805, "post_id": 53157534, "comment_id": 93205827, "body": "@WillemVanOnsem That doesn&#39;t select with replacement."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541432881, "post_id": 53157534, "comment_id": 93205873, "body": "@chepner: aarghh, I missed that part :("}, {"owner": {"reputation": 45, "user_id": 8472265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037bef6a9e08aa8b46585fa61728b15a?s=128&d=identicon&r=PG&f=1", "display_name": "ailun0x0e", "link": "https://stackoverflow.com/users/8472265/ailun0x0e"}, "edited": false, "score": 0, "creation_date": 1541434028, "post_id": 53157534, "comment_id": 93206572, "body": "That solution does not take in account the possibility of repeated numbers. I did not want to post my solution because it was pretty ugly tho... I even came up with a solution without permutations and it&#39;s pretty ugly too"}, {"owner": {"reputation": 45, "user_id": 8472265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037bef6a9e08aa8b46585fa61728b15a?s=128&d=identicon&r=PG&f=1", "display_name": "ailun0x0e", "link": "https://stackoverflow.com/users/8472265/ailun0x0e"}, "edited": false, "score": 0, "creation_date": 1541434151, "post_id": 53157534, "comment_id": 93206653, "body": "<code>genAllSize x = concat(iterate (\\z -&gt; genAllSize&#39; z x) [[]]) where genAllSize&#39; l li = foldl (\\t i -&gt; t++(map(\\s -&gt; s++[i]) l ) ) [ ] li </code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1553307880, "post_id": 53157534, "comment_id": 97347754, "body": "The solution using <code>concat</code> and <code>iterate</code> is almost not ugly. Can you see a way to replace the <code>foldl</code> with an invocation of <code>concatMap</code> that accomplishes the same general purpose? Can you see that <code>i:s</code> accomplishes the same general purpose as <code>s++[i]</code> but in a different order and much more efficiently? This general approach will eventually run into efficiency trouble because its memory use grows fairly quickly, but it&#39;s otherwise fairly reasonable."}], "answers": [{"comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1541435843, "post_id": 53158058, "comment_id": 93207568, "body": "why is it finite?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1541437668, "post_id": 53158058, "comment_id": 93208520, "body": "@karakfa We only involve finite lists above. <code>xs</code> is finite, so <code>inits xs</code> is finite, and <code>&gt;&gt;=</code> loops over a finite number of finite prefixes. <code>mapM</code> loops over each element (finitely many), and replaces them with an element taken from <code>xs</code> (finite)."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1541465765, "post_id": 53158058, "comment_id": 93219184, "body": "This doesn\u2019t actually use the elements of the results of <code>inits</code>, just their lengths, so you could write this a bit more explicitly (albeit less elegantly imo) as <code>join [sequence $ take n $ repeat xs | n &lt;- [0..length xs]]</code>. Also it\u2019s worth knowing that <code>mapM (const xs)</code> = <code>sequence . fmap (const xs)</code> = <code>sequence . (xs &lt;$)</code>; the expression <code>x &lt;$ y</code> is handy for replacing all elements in the container <code>y</code> with <code>x</code> while retaining its shape, or running an action <code>y</code>, discarding its result, and returning <code>x</code> (where you might otherwise write <code>y *&gt; pure x</code>)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1553230368, "post_id": 53158058, "comment_id": 97314790, "body": "I don&#39;t think you&#39;re getting all the lists the question asks for. Daniel Wagner&#39;s answer seems more on point."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1553230489, "post_id": 53158058, "comment_id": 97314816, "body": "Alternatively, you can use <a href=\"https://stackoverflow.com/questions/53157534/generate-all-permutations-of-a-list-including-diferent-sizes-and-repeated-elemen#comment93381293_53247900\">Will Ness&#39;s fix</a>"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1541434187, "creation_date": 1541434187, "answer_id": 53158058, "question_id": 53157534, "link": "https://stackoverflow.com/questions/53157534/generate-all-permutations-of-a-list-including-diferent-sizes-and-repeated-elemen/53158058#53158058", "title": "Generate all permutations of a list including diferent sizes and repeated elements", "body": "<ul>\n<li>Given an input list <code>xs</code>, select a prefix of that in a non deterministic way</li>\n<li>For each element in the prefix, replace it with any element of <code>xs</code>, in a non deterministic way</li>\n</ul>\n\n<p>Result:</p>\n\n<pre><code>&gt; xs = [2,4,8]\n&gt; inits xs &gt;&gt;= mapM (const xs)\n[[],[2],[4],[8],[2,2],[2,4],[2,8],[4,2],[4,4],[4,8],[8,2],[8,4],\n[8,8],[2,2,2],[2,2,4],[2,2,8],[2,4,2],[2,4,4],[2,4,8],[2,8,2],\n[2,8,4],[2,8,8],[4,2,2],[4,2,4],[4,2,8],[4,4,2],[4,4,4],[4,4,8],\n[4,8,2],[4,8,4],[4,8,8],[8,2,2],[8,2,4],[8,2,8],[8,4,2],[8,4,4],\n[8,4,8],[8,8,2],[8,8,4],[8,8,8]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 2, "last_activity_date": 1541438217, "creation_date": 1541438217, "answer_id": 53159132, "question_id": 53157534, "link": "https://stackoverflow.com/questions/53157534/generate-all-permutations-of-a-list-including-diferent-sizes-and-repeated-elemen/53159132#53159132", "title": "Generate all permutations of a list including diferent sizes and repeated elements", "body": "<p>Hmm I guess you a need a lazy infinite list of cycling subsequences. One naive way could be like</p>\n\n<pre><code>Prelude&gt; take 100 $ nub . subsequences . cycle $ [2,4,8]\n[[],[2],[4],[2,4],[8],[2,8],[4,8],[2,4,8],[2,2],[4,2],[2,4,2],[8,2],[2,8,2],[4,8,2],[2,4,8,2],[4,4],[2,4,4],[8,4],[2,8,4],[4,8,4],[2,4,8,4],[2,2,4],[4,2,4],[2,4,2,4],[8,2,4],[2,8,2,4],[4,8,2,4],[2,4,8,2,4],[8,8],[2,8,8],[4,8,8],[2,4,8,8],[2,2,8],[4,2,8],[2,4,2,8],[8,2,8],[2,8,2,8],[4,8,2,8],[2,4,8,2,8],[4,4,8],[2,4,4,8],[8,4,8],[2,8,4,8],[4,8,4,8],[2,4,8,4,8],[2,2,4,8],[4,2,4,8],[2,4,2,4,8],[8,2,4,8],[2,8,2,4,8],[4,8,2,4,8],[2,4,8,2,4,8],[2,2,2],[4,2,2],[2,4,2,2],[8,2,2],[2,8,2,2],[4,8,2,2],[2,4,8,2,2],[4,4,2],[2,4,4,2],[8,4,2],[2,8,4,2],[4,8,4,2],[2,4,8,4,2],[2,2,4,2],[4,2,4,2],[2,4,2,4,2],[8,2,4,2],[2,8,2,4,2],[4,8,2,4,2],[2,4,8,2,4,2]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541934381, "post_id": 53247900, "comment_id": 93381009, "body": "indeed. But I&#39;m going to leave it because I get confused by the myriad of maximally refined concepts and I bet others do too."}, {"owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541934469, "post_id": 53247900, "comment_id": 93381035, "body": "My current solution has a problem that it keeps looking for branch extensions forever for genAllSize [] but where there&#39;s a finite answer, the list should be finite, really"}, {"owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541934577, "post_id": 53247900, "comment_id": 93381075, "body": "<code>genAllSize xs = join $ iterate (liftA2 (&lt;|&gt;) (pure &lt;$&gt; xs)) (pure empty)</code> is write-only, though. Mine needs to be expanded out into more explicit definitions as it is, removing some can&#39;t be right."}, {"owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541934800, "post_id": 53247900, "comment_id": 93381138, "body": "It&#39;s not supposed to do what chi&#39;s answer is doing, chi&#39;s answer isn&#39;t correct"}, {"owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541935336, "post_id": 53247900, "comment_id": 93381290, "body": "[2,2,2,2] is a list made from some combination of elements from [2,4,8] and yet chi&#39;s answer doesn&#39;t include it in the output list. My answer correctly includes it."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1541935352, "post_id": 53247900, "comment_id": 93381293, "body": "if you mean the sizes should be infinite, chi&#39;s code can be tweaked into <code>inits [1..] &gt;&gt;= mapM (const xs)</code>."}, {"owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541936642, "post_id": 53247900, "comment_id": 93381637, "body": "<code>inits (repeat ()) &gt;&gt;= mapM (const xs)</code> would be a better tweak for chi&#39;s answer because the seed structure explicitly has no content and that carries useful meaning."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541936813, "post_id": 53247900, "comment_id": 93381685, "body": "consider <code>\\xs -&gt; concat $ iterate (liftA2 (:) xs) [[]]</code>, or <code>\\xs -&gt; concat $ iterate (map (:) xs &lt;*&gt;) [[]]</code> as your code&#39;s rewrite."}, {"owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541937208, "post_id": 53247900, "comment_id": 93381793, "body": "@Will Ness, only a mathematician could understand that and I bet they&#39;d need to attend a conference presentation to do it, why remove the cues for the human leaving in place only what the computer uses? If that&#39;s a positive direction then you could compile my code and paste the raw machine code as a better alternative."}, {"owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541937372, "post_id": 53247900, "comment_id": 93381833, "body": "@Will Ness, I agree concat might be better than join because we want to explicitly retain the growth-based ordering and not leave it up to the datatype. I didn&#39;t do that to begin with because I like to practice retaining both descriptiveness and generality."}], "tags": [], "owner": {"reputation": 1155, "user_id": 962394, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/97268298c366b07e5556567639105ee1?s=128&d=identicon&r=PG", "display_name": "codeshot", "link": "https://stackoverflow.com/users/962394/codeshot"}, "is_accepted": false, "score": 0, "last_activity_date": 1541935832, "last_edit_date": 1541935832, "creation_date": 1541932625, "answer_id": 53247900, "question_id": 53157534, "link": "https://stackoverflow.com/questions/53157534/generate-all-permutations-of-a-list-including-diferent-sizes-and-repeated-elemen/53247900#53247900", "title": "Generate all permutations of a list including diferent sizes and repeated elements", "body": "<p>This produces the elements in a different order within each length than your example, but it meets the definition of the text of your question. Changing the order is easy - you have to replace <code>&lt;*&gt;</code> with a slightly different operator of your own making.</p>\n\n<pre><code>import Control.Applicative\nimport Control.Monad\n\nrinvjoin :: Applicative both =&gt; both a -&gt; both (both a)\nrinvjoin = fmap pure\n\nextendBranches options branches = (&lt;|&gt;) &lt;$&gt; options &lt;*&gt; branches\nsingletonBranchExtensions = rinvjoin\n\ngenAllSize [] = []\ngenAllSize xs = join &lt;$&gt; iterate (extendBranches extensions) $ initialBranches\n  where extensions = singletonBranchExtensions xs\n        initialBranches = pure empty\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1553230655, "post_id": 55290785, "comment_id": 97314855, "body": "That does seem rather straightforward."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553260058, "post_id": 55290785, "comment_id": 97328879, "body": "a sidenote, <code>replicateM n = sequence . replicate n</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1553308731, "post_id": 55290785, "comment_id": 97347849, "body": "Like my solution, yours needs a special case to avoid looping on the empty list, and (less obviously) it wants a special case to avoid incrementing unary numbers the wrong way around when passed a singleton."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1553211435, "creation_date": 1553211435, "answer_id": 55290785, "question_id": 53157534, "link": "https://stackoverflow.com/questions/53157534/generate-all-permutations-of-a-list-including-diferent-sizes-and-repeated-elemen/55290785#55290785", "title": "Generate all permutations of a list including diferent sizes and repeated elements", "body": "<p>The other answers seem sort of complicated. I'd do it this way:</p>\n\n<pre><code>&gt; [0..] &gt;&gt;= flip replicateM \"abc\"\n[\"\",\"a\",\"b\",\"c\",\"aa\",\"ab\",\"ac\",\"ba\",\"bb\",\"bc\",\"ca\",\"cb\",\"cc\",\"aaa\",\"aab\",...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1553283230, "post_id": 55293272, "comment_id": 97341579, "body": "perhaps also, simply, <code>genAllSize xs = p   where     p = [] : [x:q|q&lt;-genAllSize xs,x&lt;-xs]</code> ? Also, I wonder, does the version with the flipped ordering really performs badly? Have you tested, perchance?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553284353, "post_id": 55293272, "comment_id": 97342098, "body": "Ooh, you&#39;re almost certainly right about the shorter version. What do you mean about the flipped ordering?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553299365, "post_id": 55293272, "comment_id": 97346583, "body": "@WillNess, the need for a special case for singletons makes me wonder if there&#39;s a slightly better way that doesn&#39;t need one. Haven&#39;t found it yet."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1553301024, "post_id": 55293272, "comment_id": 97346862, "body": "Ah, but that actually makes a lot of sense. Efficient counting in unary looks very different from efficient counting in another base, and we don&#39;t have the option of using a segmented system."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553332568, "post_id": 55293272, "comment_id": 97351594, "body": "re: flipped ordering: it would be the <code>genAllSize xs = p where p = [] : [x:q|x&lt;-xs,q&lt;-genAllSize xs]</code>. but testing it with <code>xs = [1..3]</code>, it produces just 1s... facepalm. :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553424374, "post_id": 55293272, "comment_id": 97372119, "body": "&quot;counting in unary looks very different&quot; indeed. In unary, the only possible digit value is zero, and 0000000 is still a zero. :) So indeed it&#39;s a very special case."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553445531, "post_id": 55293272, "comment_id": 97378106, "body": "@WillNess, huh? The only digit value is 1, and all carries propagate to the end."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553453566, "post_id": 55293272, "comment_id": 97380591, "body": "the highest digit value allowed in base n is n-1, no?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553454204, "post_id": 55293272, "comment_id": 97380826, "body": "@WillNess, yes, but what&#39;s called unary is quite different, as you surely know. The usual algorithm for incrementing a base-k number will work just fine for incrementing a unary representation (all 1s except for leading 0s, all places worth 1), but it&#39;ll be a lot less efficient than <code>snoc 1</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1553454540, "post_id": 55293272, "comment_id": 97380928, "body": "I was overloading the meaning by using it as &quot;base-1&quot;, with the word &quot;digit&quot;. so it means that counting with sticks, or list elements, is not in <i>any</i> base, i.e. very special. I should&#39;ve been clearer with my wording perhaps. was intending the smiley to show my half-joking intent."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1553454989, "last_edit_date": 1553454989, "creation_date": 1553231534, "answer_id": 55293272, "question_id": 53157534, "link": "https://stackoverflow.com/questions/53157534/generate-all-permutations-of-a-list-including-diferent-sizes-and-repeated-elemen/55293272#55293272", "title": "Generate all permutations of a list including diferent sizes and repeated elements", "body": "<p>A simple and highly efficient option:</p>\n\n<pre><code>genAllSize [] = [[]]\ngenAllSize [a] = iterate (a:) []\ngenAllSize xs =\n  [] : [x:q|q&lt;-genAllSize xs,x&lt;-xs]\n</code></pre>\n\n<p>(Thanks to Will Ness for a small but very nice simplification.)</p>\n\n<p>This solution takes advantage of the fact that a valid solution list is either empty or an element of the argument list consed onto a shorter valid solution list. Unlike Daniel Wagner's solution, this one doesn't resort to counting. My tests suggest that it performs extremely well under typical conditions.</p>\n\n<p>Why do we need a special case for a one-element list? The general case performs extremely badly for that, because it maps over the same list over and over with no logarithmic slowdown.</p>\n\n<p>But what's the deal with that call to <code>genAllSizes</code> with the very same argument? Wouldn't it be better to save the result to increase sharing?</p>\n\n<pre><code>genAllSize [] = [[]]\ngenAllSize xs = p\n  where\n    p = [] : [x:q|q&lt;-p,x&lt;-xs]\n</code></pre>\n\n<p>Indeed, on a theoretical machine with unlimited constant-time memory, this is optimal: walking the list takes worst-case O(1) time for each cons. In practice, it's only a good idea if a great many entries will be realized and retained. Otherwise, there's a problem: most of the list entries will be retained indefinitely, dramatically increasing memory residency and the amount of work the garbage collector needs to do. The non-bold sharing version above still offers <em>amortized</em> O(1) time per cons, but it needs very little memory (logarithmic rather than linear).</p>\n\n<h3>Examples</h3>\n\n<pre><code>genAllSize \"ab\" =\n [\"\",\"a\",\"b\",\"aa\",\"ba\"\n ,\"ab\",\"bb\",\"aaa\",\"baa\"\n ,\"aba\",\"bba\",\"aab\",\"bab\"\n ,\"abb\",\"bbb\",\"aaaa\",...]\n\ngenAllSize \"abc\" =\n  [\"\",\"a\",\"b\",\"c\",\"aa\",\"ba\"\n  ,\"ca\",\"ab\",\"bb\",\"cb\",\"ac\"\n  ,\"bc\",\"cc\",\"aaa\",\"baa\"\n  ,\"caa\",\"aba\",\"bba\",\"cba\"\n  ,\"aca\",...]\n</code></pre>\n\n<h3>An explicit option</h3>\n\n<p>You can also use two accumulators:</p>\n\n<pre><code>genAllSize [] = [[]]\ngenAllSize [a] = iterate (a:) []\ngenAllSize (x:xs) = go ([], []) where\n  go (curr, remain) = curr : go (step curr remain)\n  step [] [] = ([x], [xs])\n  step (_:ls) ((r:rs):rss) =\n    (r:ls, rs:rss)\n  step (_:ls) ([] : rs) =\n    (x : ls', xs : rs')\n    where\n      !(ls', rs') = step ls rs\n</code></pre>\n\n<p>This version keeps track of the current \"word\" and also the remaining available \"letters\" in each position. The performance seems comparable in general, but a bit better with regard to memory residency. It's also much harder to understand!</p>\n"}], "owner": {"reputation": 45, "user_id": 8472265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037bef6a9e08aa8b46585fa61728b15a?s=128&d=identicon&r=PG&f=1", "display_name": "ailun0x0e", "link": "https://stackoverflow.com/users/8472265/ailun0x0e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1553454989, "creation_date": 1541432419, "last_edit_date": 1541574647, "question_id": 53157534, "link": "https://stackoverflow.com/questions/53157534/generate-all-permutations-of-a-list-including-diferent-sizes-and-repeated-elemen", "title": "Generate all permutations of a list including diferent sizes and repeated elements", "body": "<p>I wanted to create the function <code>genAllSize ::[a] -&gt; [[a]]</code>, that receives a list <code>l</code> and generates all the lists sorted by size that can be built with the elements of the list <code>l</code>;  i.e.</p>\n\n<pre><code>&gt; genAllSize [2,4,8] \n[[],[2],[4],[8],[2,2],[4,2],[8,2],[2,4],[4,4],[8,4],[2,8],[4,8],[8,8],[2,2,2],[4,2,2],[8,2,2], ...\n</code></pre>\n\n<p>How would you do it? I came up with a solution using permutations from <code>Data.List</code> but I do not want to use it.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 4, "creation_date": 1541429104, "post_id": 53156016, "comment_id": 93203612, "body": "The error is pretty descriptive in this case. You need to implement an instance for <code>Command</code>. However it&#39;s actually not possible to implement because you will have trouble with  <code>FromJSON</code>. In any case, encoding OOP patterns in Haskell like this most likely not the right solution to your problem so you might want to ask a higher level question about your actual objective."}], "answers": [{"comments": [{"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541431657, "post_id": 53156720, "comment_id": 93205199, "body": "BTW, I have reproduced the approach suggested by the page linked in my question description...  Are you suggesting that I should have converter instead of Polymorphism ? like function toCommand :: MyCommandFromASpecificBusinessDomain -&gt; Command ? That is what I understand from the link you gave to me (e.g toWidget :: Window -&gt; Widget) This is not what I need if it&#39;s the case... I need to read Commands (CQRS command sourcing) from a CommandStore and process each command with their own specific information..."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541465359, "post_id": 53156720, "comment_id": 93219107, "body": "@NicolasHenin The point is your existing <code>Command_</code> class is isomorphic to a record with 3 fields. There&#39;s no value in having many different types that all must be treated the same way, rather than one type which is a record containing three values and can be customized at the value level instead of the type level."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541491930, "post_id": 53156720, "comment_id": 93225798, "body": "ok, so I&#39;m making a CQRS library where users define their own commands, so in the context of the that library It is not aware of them, Users have to provide them.. Command_ is not isomorphic to a record with 3 fields, Command_ is just saying there is a contract where if you want to define a Command, you need to provide these functions... am I missing something ?"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1541492380, "post_id": 53156720, "comment_id": 93225991, "body": "@amalloy, &quot;one type which is a record containing three values and can be customized at the value level instead of the type level.&quot; That I originally did... but then your sum type has to be compulsory defined and I cannot have a  library then (something more generic)... You need to show me an example because I don&#39;t see how you are saying to me satisfy my needs..."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541492855, "post_id": 53156720, "comment_id": 93226219, "body": "You can read this : <a href=\"https://two-wrongs.com/dynamic-dispatch-in-haskell-how-to-make-code-extendable\" rel=\"nofollow noreferrer\">two-wrongs.com/&hellip;</a>"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541494374, "post_id": 53156720, "comment_id": 93226858, "body": "even better : <a href=\"https://stackoverflow.com/questions/13106683/dynamic-dispatch-in-haskell/13110560#13110560\" title=\"dynamic dispatch in haskell\">stackoverflow.com/questions/13106683/&hellip;</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 1, "creation_date": 1541497184, "post_id": 53156720, "comment_id": 93228101, "body": "@NicolasHenin having a fixed <code>data Command= Command {i, ai, cn}</code> doesn&#39;t prevent users from defining their own specialised command types. It just demands that, before passing the commands to something more generic, they \u201cconvert\u201d them to the general <code>Command</code> type, which amounts to packing the methods as function-values into the \u201cplain-data struct\u201d. (These function values may still have a pointer to some more specialised state object internally, but it&#39;ll be completely encapsulated in their closure.)"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541499089, "post_id": 53156720, "comment_id": 93229215, "body": "it took me sometimes to integrate what you &#39;ve said with my current codebase (actually a night of sleep :-) ), but it makes senses now for me..."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1541429317, "creation_date": 1541429317, "answer_id": 53156720, "question_id": 53156016, "link": "https://stackoverflow.com/questions/53156016/issue-implementing-dynamic-dispatch-mechanism-of-oop/53156720#53156720", "title": "Issue implementing Dynamic dispatch mechanism of OOP", "body": "<p>You need to unwrap the <code>Command</code> constructor to get at the value whose type actually is an instance of <code>Command_</code>.</p>\n\n<pre><code>getMyCommandName :: Command -&gt; String\ngetMyCommandName (Command c) = getCommandName c\n</code></pre>\n\n<p>FWIW, you code reeks <em>strongly</em> of <a href=\"https://lukepalmer.wordpress.com/2010/01/24/haskell-antipattern-existential-typeclass/\" rel=\"nofollow noreferrer\">existential antipattern</a>. Why not just make it</p>\n\n<pre><code>data Command = Command\n       { getCommandId :: CommandId\n       , getAggregateId :: AggregateId\n       , getCommandName :: String }\n</code></pre>\n\n<p>and be done?</p>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 53156720, "answer_count": 1, "score": 0, "last_activity_date": 1541429317, "creation_date": 1541426864, "question_id": 53156016, "link": "https://stackoverflow.com/questions/53156016/issue-implementing-dynamic-dispatch-mechanism-of-oop", "title": "Issue implementing Dynamic dispatch mechanism of OOP", "body": "<p>I need to implement a dynamic dispatch, I've used Existential types based on this <a href=\"https://wiki.haskell.org/Existential_type\" rel=\"nofollow noreferrer\">page</a> and produced the following code : </p>\n\n<pre><code>{-# LANGUAGE DuplicateRecordFields #-}\n{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE ExistentialQuantification #-}\nmodule Cqrs.Command where\n\nimport Data.UUID\nimport Data.Time\nimport Data.Aeson\n\nimport Cqrs.Core\nimport Data.Text\nimport GHC.Generics\n\ntype CommandName = String\n\nclass (FromJSON command,ToJSON command , Show command) =&gt; Command_ command where\n  getCommandId :: command -&gt; CommandId\n  getAggregateId :: command -&gt; AggregateId\n  getCommandName :: command -&gt; String\n\n\ndata Command = forall command . Command_ command =&gt; Command command\n\n\ngetMyCommandName :: Command -&gt; String\ngetMyCommandName command = getCommandName command\n</code></pre>\n\n<p>I'm not able to use functions from the typeclass Command_ on a Command datatype, the compiler complains that way : </p>\n\n<pre><code>/Users/xxx/dev/gsdFlow/src/Cqrs/Command.hs:26:28: error:\n    \u2022 No instance for (Command_ Command)\n        arising from a use of \u2018getCommandName\u2019\n    \u2022 In the expression: getCommandName command\n      In an equation for \u2018getMyCommandName\u2019:\n          getMyCommandName command = getCommandName command\n   |\n26 | getMyCommandName command = getCommandName command\n   |                            ^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell", "type-parameter", "type-constructor"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1541412866, "post_id": 53152208, "comment_id": 93194914, "body": "Hold on, here there is an error on <code>(fu b) &quot;asa&quot;</code>, not on <code>(fu var) &#39;c&#39;</code>."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541412892, "post_id": 53152208, "comment_id": 93194930, "body": "Sorry i have changed the variable names."}], "answers": [{"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1541413594, "post_id": 53152396, "comment_id": 93195300, "body": "This was indeed the problem , but still for visibility purposes can you specify somehow the type parameter that you want ?Something similar to how you use <code>read</code> ?  <code>read t::String</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1541413736, "post_id": 53152396, "comment_id": 93195403, "body": "@BercoviciAdrian If you want to use the old <code>A</code> for which you defined <code>fu</code>, you probably can use something like <code>var = Ghci30.M ...</code>. If you want to use the new <code>A</code>, you have to redefine <code>fu</code> -- the old definition won&#39;t get &quot;ported&quot; to the new type."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1541413270, "creation_date": 1541413270, "answer_id": 53152396, "question_id": 53152208, "link": "https://stackoverflow.com/questions/53152208/how-to-enforce-a-type-constructor-parameter-for-ghci/53152396#53152396", "title": "How to enforce a type constructor parameter for GHCI", "body": "<p>When you see names like <code>Ghci30.A [Char]</code>, this means that you have redefined your type <code>A</code> in GHCi. This would not be an issue if you used a proper <code>.hs</code> file and reloaded it.</p>\n\n<p>Consider this GHCi session:</p>\n\n<pre><code>&gt; data A = A Int\n&gt; x = A 2\n&gt; data A = A Char  -- redefinition\n&gt; :t x\n</code></pre>\n\n<p>What should be the output? The type of <code>x</code> is <code>A</code>, but it's not the same type <code>A</code> having a <code>Char</code> inside. GHCi will print the type as</p>\n\n<pre><code>x :: Ghci0.A\n</code></pre>\n\n<p>You won't get the error again if you (re-)define <code>x</code> after you redefine the type <code>A</code>.</p>\n\n<p>If your case, the <code>x</code> to be redefined is likely <code>fu</code>, which is still referring to the old <code>A</code>. Check it with <code>:t fu</code>: if it mentions <code>Ghci30.A</code>, that's it.</p>\n\n<p>For non trivial definitions, I'd recommend to use a <code>.hs</code> file and reload it, so to avoid any trouble.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 53152396, "answer_count": 1, "score": 1, "last_activity_date": 1541413270, "creation_date": 1541412538, "question_id": 53152208, "link": "https://stackoverflow.com/questions/53152208/how-to-enforce-a-type-constructor-parameter-for-ghci", "title": "How to enforce a type constructor parameter for GHCI", "body": "<p>Hello i have the following problem:\nI am constructing a parametric <code>newtype</code> over a method and i do not know how to explictly tell <code>GHCI</code> : <code>I want you to instiantiate this newtype using this type parameter</code></p>\n\n<pre><code> newtype M a = M {fu::a-&gt;Int}\n\n var = M (\\s-&gt; length (s:\"asa\"))  #tell him i want the type parameter to be Char\n\n b = (fu var) 'c' \n</code></pre>\n\n<p>What i expect to get is : <code>4</code>      because <code>length 'c':\"aaa\"==4</code> <br></p>\n\n<p>What i do  get is :</p>\n\n<pre><code>interactive&gt;:118:5: error:\n    * Couldn't match expected type `A [Char]'\n                  with actual type `Ghci30.A [Char]'\n      NB: `Ghci30.A' is defined at &lt;interactive&gt;:100:1-25\n          `A' is defined at &lt;interactive&gt;:109:1-25\n    * In the first argument of `fu', namely `b'\n      In the expression: (fu b) \"asa\"\n      In an equation for `it': it = (fu b) \"asa\"\n</code></pre>\n"}, {"tags": ["haskell", "functor"], "comments": [{"owner": {"reputation": 944, "user_id": 49554, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02c8ecc24181d171df85a26458b9cd5f?s=128&d=identicon&r=PG", "display_name": "jneira", "link": "https://stackoverflow.com/users/49554/jneira"}, "edited": false, "score": 0, "creation_date": 1541406062, "post_id": 53150426, "comment_id": 93191506, "body": "I think you could use the <code>Monad</code> class to handle the &quot;wrapped&quot; values with <code>&gt;&gt;=</code>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1541406670, "post_id": 53150426, "comment_id": 93191803, "body": "I really don&#39;t understand what you mean by \u201cunwrap\u201d here. Seems that your two examples do something completely different. Typeclasses are for when you&#39;re doing something that can be understood as a special case of some more general, abstract concept. A typeclass for which you can&#39;t come up with <i>laws</i> is usually not worth it. So, I&#39;d say you should probably go with separate, differently named functions. But perhaps I&#39;m wrong and your examples just aren&#39;t representative of what you&#39;re really trying to do."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1541407102, "post_id": 53150426, "comment_id": 93191984, "body": "By <code>unwrap</code> i mean to <code>extract</code> the <code>value</code> from the <code>context</code>. <b>E.g:</b> <code>Just 1 -&gt; 1 </code>&lt;br&gt;What i mean is where do you place the code responsible for <code>extracting</code> the values from your functors?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1541407217, "post_id": 53150426, "comment_id": 93192042, "body": "But you examples don&#39;t seem to just \u201cextract\u201d values, but perform nontrivial computations on them. Please give a realistic example."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 2, "creation_date": 1541407255, "post_id": 53150426, "comment_id": 93192059, "body": "You generally can&#39;t do that: <a href=\"https://stackoverflow.com/a/51620647/126014\">stackoverflow.com/a/51620647/126014</a>"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1541407482, "post_id": 53150426, "comment_id": 93192147, "body": "So for example i am asking how would you place code that deals with a <code>Maybe Int</code>, a <code>Maybe Double</code> and a <code>Maybe Bool</code>. I want different behaviours for each type and <code>Maybe</code> value.Is there a place where i can treat all 3X2 cases ( 3 types * 2 (Just and Nothing for each) ).Is there a typeclass method where you can write all the code ?"}, {"owner": {"reputation": 944, "user_id": 49554, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02c8ecc24181d171df85a26458b9cd5f?s=128&d=identicon&r=PG", "display_name": "jneira", "link": "https://stackoverflow.com/users/49554/jneira"}, "edited": false, "score": 1, "creation_date": 1541409646, "post_id": 53150426, "comment_id": 93193182, "body": "Maybe the other answer could be useful: <a href=\"https://stackoverflow.com/a/51619859/49554\">stackoverflow.com/a/51619859/49554</a> <code>extract :: Comonad w =&gt; w a -&gt; a</code>"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1541411944, "post_id": 53150426, "comment_id": 93194375, "body": "I see so from the thread..i have to  write my methods in order to <code>extract</code> the values from the context given a <code>functor</code>,and the grouping of the methods is done by me in which way it seems to have most reason."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1541413582, "post_id": 53150426, "comment_id": 93195288, "body": "If it&#39;s only for <code>Maybe</code> and <code>Either</code>, you could write a <code>eitherToMaybe :: Either a b -&gt; Maybe b</code> function and then use <code>fromMaybe</code> in both cases. Usually, though, one can use <code>fmap</code> or monadic combinators to &quot;lift&quot; the operation to the functor instead of &quot;extracting&quot; the (possibly missing) value."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541434179, "post_id": 53150426, "comment_id": 93206674, "body": "You might also be looking for functions like <code>maybe :: b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b</code> and <code>either :: (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c</code>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1541441502, "post_id": 53150426, "comment_id": 93210220, "body": "Why not just use pattern matching directly? Your first example would be <code>case a of  Just (X 2 3) -&gt; 2^3 ; Nothing -&gt; 0</code> (Note that this pattern match, as-is, doesn&#39;t cover all cases. It can cover them though with a small modification)."}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541409568, "creation_date": 1541405006, "last_edit_date": 1541409568, "question_id": 53150426, "link": "https://stackoverflow.com/questions/53150426/where-to-put-code-responsible-with-value-extraction-from-various-functors", "title": "Where to put code responsible with value extraction from various functors", "body": "<p>Given a functor and given a specific way you want to unwrap its value , is there a predefined typeclass that you should implement to <code>unwrap</code> it?</p>\n\n<p>For example given a type: <code>data X = X Int Int</code> where can i specialize the <code>unwrapping</code> of a <code>Maybe X</code>?</p>\n\n<p>Lets say i have a <code>a = Just (X 2 3)</code> and i want to <code>unwrap</code> it the in a custom way:</p>\n\n<pre><code>(Just 2 3)-&gt; 2^3\nNothing -&gt; 0\n</code></pre>\n\n<p>But i also want to use the same method/interface to <code>unwrap</code> another type like a <code>Maybe (Int,Int)</code> like:</p>\n\n<pre><code>Just (x, y) -&gt; x + y\nNothing -&gt; 0\n</code></pre>\n\n<p>The question is more about organisation:</p>\n\n<p>Is there a typeclass method where i can implement for unwrapping a <code>Maybe X</code>,<code>Maybe Y</code>, <code>Either Z</code>, <code>Either K</code>, etc.?</p>\n\n<p>Or do i have to provide ungrouped (not a typeclass method instance) methods for each type that i want to unwrap from the functor?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1541374093, "post_id": 53146472, "comment_id": 93184301, "body": "Do you have a <code>.o</code> file with the C side binary? You need to link that together e.g. <code>stack ghc Nuk.hs cside.o</code>. If you do not want to link, instead, use <code>-c</code>. (And link afterwards)"}, {"owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1541375055, "post_id": 53146472, "comment_id": 93184474, "body": "@chi, I don&#39;t. The C side is a single header file that should be included in C programs. The implementations are also inside that header file"}], "answers": [{"comments": [{"owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "edited": false, "score": 0, "creation_date": 1544999560, "post_id": 53146721, "comment_id": 94462763, "body": "How about using inline-c?"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 5, "last_activity_date": 1541376627, "last_edit_date": 1541376627, "creation_date": 1541376245, "answer_id": 53146721, "question_id": 53146472, "link": "https://stackoverflow.com/questions/53146472/haskell-ffi-local-c-header/53146721#53146721", "title": "Haskell FFI local c header", "body": "<p>If it\u2019s a header-only library, you need a C compiler to produce an object file for it so that your Haskell program can link to the definitions. According to the documentation for Nuklear, you can create a stub C file:</p>\n\n<pre><code>// nuklear.c\n#define NK_IMPLEMENTATION\n#include \"nuklear.h\"\n</code></pre>\n\n<p>As part of your build, compile this (e.g. with <code>gcc -c nuklear.c -o nuklear.o</code>) to produce an object file <code>nuklear.o</code>, use <code>ar</code> (e.g. <code>ar -csr libnuklear.a nuklear.o</code>) to create a static library <code>libnuklear.a</code>, then supposing this archive is in <code>libs</code>, you would add:</p>\n\n<pre><code>extra-lib-dirs: libs\nextra-libraries: nuklear\n</code></pre>\n\n<p>To the <code>executable</code> section in your Cabal file. (Or the corresponding section in <code>package.yml</code> for hpack.)</p>\n\n<p>To coordinate this, you might have a Makefile that builds this library and also invokes <code>stack</code>/<code>cabal</code>/<code>ghc</code> to produce the final build result. <a href=\"http://www.the-efficient-programmer.com/programming/link-c-lib-in-haskell.html\" rel=\"noreferrer\">This tutorial</a> covers the process in a little more explicit detail. But for this simple use case, you may be able to just use the <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#pkg-field-c-sources\" rel=\"noreferrer\"><code>c-sources</code> section</a> to do this from within Cabal:</p>\n\n<pre><code>c-sources: nuklear.c\n</code></pre>\n\n<p>You may also need to specify <code>includes</code> and <code>include-dirs</code>, e.g.:</p>\n\n<pre><code>includes: nuklear.h\n</code></pre>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 1, "accepted_answer_id": 53146721, "answer_count": 1, "score": 2, "last_activity_date": 1541376627, "creation_date": 1541373718, "question_id": 53146472, "link": "https://stackoverflow.com/questions/53146472/haskell-ffi-local-c-header", "title": "Haskell FFI local c header", "body": "<p>I want to call a C single header library with FFI.</p>\n\n<p>Here's the <code>Nuk.hs</code></p>\n\n<pre><code>{-# LANGUAGE CPP, ForeignFunctionInterface #-}\nmodule Main where\n\nimport Foreign\nimport Foreign.C.Types\n\nforeign import ccall unsafe \"nuklear.h nk_sin\"\n c_nk_sin:: IO CFloat\n\nmain = print $ c_nk_sin (5)\n</code></pre>\n\n<p>In the same directory, I have the <code>nuklear.h</code></p>\n\n<p>When I do <code>stack ghc Nuk.hs</code>, I get</p>\n\n<pre><code>[1 of 1] Compiling Main             ( Nuk.hs, Nuk.o )\nLinking Nuk ...\nNuk.o:r1Rq_info: error: undefined reference to 'nk_sin'\ncollect2: error: ld returned 1 exit status\n`gcc' failed in phase `Linker'. (Exit code: 1)\n</code></pre>\n\n<p>How should I solve this?</p>\n"}, {"tags": ["haskell", "continuations"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1541374462, "post_id": 53146114, "comment_id": 93184366, "body": "You might prefer <a href=\"http://hackage.haskell.org/package/kan-extensions-5.1/docs/Control-Monad-Codensity.html#t:Codensity\" rel=\"nofollow noreferrer\"><code>Codensity</code></a> <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Functor-Identity.html#t:Identity\" rel=\"nofollow noreferrer\"><code>Identity</code></a>, which prevents those sorts of shenanigans."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1541375440, "post_id": 53146114, "comment_id": 93184556, "body": "@Carl I wouldn&#39;t call them <i>shenanigans</i>, really. As per my comment in the linked question, this has uses. I&#39;m not well-versed in this stuff, but what I think happened here is that <code>Codensity</code> represents a &quot;weak&quot; form of continuations, <code>SCont f r a = (a -&gt; r) -&gt; f</code> represents a very &quot;powerful&quot; sort, and we have <code>Cont r a = (a -&gt; r) -&gt; r</code> as a middle ground. <code>Codensity</code> prohibits &quot;post-processing&quot;, <code>SCont</code> allows it in its full glory (but we don&#39;t use it because Haskell doesn&#39;t have syntax for it), and <code>Cont</code> has it in a crippled form that we <i>do</i> have a syntax for."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1541375800, "post_id": 53146114, "comment_id": 93184607, "body": "@HTNW <code>Codensity m</code> doesn&#39;t prevent post-processing, exactly.  You can still add arbitrary <code>m</code> effects.  You have to go to <code>Codensity Identity</code> to prevent all post-processing, because <code>Identity</code> doesn&#39;t have any effects."}], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "closed_date": 1541397650, "answer_count": 0, "score": 1, "last_activity_date": 1541370224, "creation_date": 1541370224, "question_id": 53146114, "link": "https://stackoverflow.com/questions/53146114/does-the-result-of-a-continuation-have-to-be-the-final-result", "closed_reason": "Duplicate", "title": "Does the result of a continuation have to be the final result?", "body": "<p>To produce the final result from a <code>Cont r a</code>  type, you need to pass it to <code>runCont</code> and provide a continuation of type <code>(a -&gt; r)</code>:</p>\n\n<pre><code>runCont :: Cont r a -&gt; (a -&gt; r) -&gt; r\n</code></pre>\n\n<p>The signature only tells us, that the the return value of the continuation must have the same <strong>type</strong> <code>r</code> as the final result, but it doesn't tell us, that the return <strong>value</strong> of the continuation must be the final result. </p>\n\n<p>I can actually do some further processing of <code>r</code> before returning the final result. Here I prepend a String to the result:</p>\n\n<pre><code>cnt :: Num p =&gt; p -&gt; Cont String p\ncnt x = let f k = \"result=\" ++ k (x+1)\n        in cont f\n\n\u03bb&gt; runCont (cnt 1) show\n\"result=2\"\n\n\u03bb&gt; runCont (cnt 1) (flip take \"Hello\")\n\"result=He\"\n</code></pre>\n\n<p>However, the continuation is often said to be <em>the rest of the computation</em>. This suggests its return value undergoes no further processing within <code>Cont</code> and <em>is</em> the final result. </p>\n\n<p>I have a feeling, that directly returning that <code>r</code> value, gives me a tail call and least restricts the possible types of <code>r</code>, but I'm not sure if this is correct, not whether this is the whole story.</p>\n\n<ul>\n<li>Is further processing of the return value of a continuation something to be avoided or is it perfectly normal?</li>\n<li>Does further processing of <code>r</code> have any drawbacks, or can it even break things?</li>\n<li>Are there additional things to consider when using the <code>ContT</code> monad transformer?</li>\n</ul>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1541369499, "post_id": 53145952, "comment_id": 93183243, "body": "How about switch the order of <code>liftM</code> and <code>ap</code>?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1541584350, "post_id": 53145952, "comment_id": 93263403, "body": "Where does that exercise come from? <code>liftM*</code> and <code>ap</code> are pretty much obsolete, the modern versions are <code>fmap</code>/<code>liftA*</code> and <code>&lt;$&gt;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 770, "user_id": 4798397, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh4.googleusercontent.com/-RbvyOI92KHs/AAAAAAAAAAI/AAAAAAAAAEk/B4Yg7W9lXAk/photo.jpg?sz=128", "display_name": "The Coding Wombat", "link": "https://stackoverflow.com/users/4798397/the-coding-wombat"}, "edited": false, "score": 0, "creation_date": 1618392497, "post_id": 53146022, "comment_id": 118585339, "body": "Thanks for explicitly noting the key idea. It is really insightful to consider $f$ working on just one argument as returning another function, which in turn expects a single argument."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1541370463, "last_edit_date": 1541370463, "creation_date": 1541369487, "answer_id": 53146022, "question_id": 53145952, "link": "https://stackoverflow.com/questions/53145952/implementing-liftm2-in-haskell/53146022#53146022", "title": "Implementing liftM2 in Haskell", "body": "<p>The general pattern is transforming</p>\n\n<pre><code>liftMn f a1 ... an\n</code></pre>\n\n<p>into</p>\n\n<pre><code>f &lt;$&gt; a1 &lt;*&gt; ... &lt;*&gt; an\n-- i.e., more precisely\n(... ((f &lt;$&gt; a1) &lt;*&gt; a2) ... &lt;*&gt; an)\n</code></pre>\n\n<p>where <code>&lt;$&gt;</code> is <code>liftM</code> (AKA <code>fmap</code>) and <code>&lt;*&gt;</code> is <code>ap</code>.</p>\n\n<p>Hence, for <code>n=2</code> we get</p>\n\n<pre><code>(f `liftM` a1) `ap` a2\n-- i.e.\nap (liftM f a1) a2\n</code></pre>\n\n<p>Checking the types:</p>\n\n<pre><code>f :: t1 -&gt; t2 -&gt; r\nliftM f :: IO t1 -&gt; IO (t2 -&gt; r)\na1 :: IO t1\nliftM f a1 :: IO (t2 -&gt; r)\nap (liftM f a1) :: IO t2 -&gt; IO r\na2 :: IO t2\nap (liftM f a1) a2 :: IO r\n</code></pre>\n\n<p>The key idea here is to read <code>f :: t1 -&gt; t2 -&gt; r</code> as <code>f :: t1 -&gt; (t2 -&gt; r)</code> so that <code>liftM f :: IO t1 -&gt; IO (t2 -&gt; r)</code> follows. Note the function type inside the <code>IO</code>. We can then \"distribute\" <code>IO</code> over <code>-&gt;</code> using <code>ap</code>, so that we can apply <code>a2 :: IO t2</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1541530218, "creation_date": 1541530218, "answer_id": 53178159, "question_id": 53145952, "link": "https://stackoverflow.com/questions/53145952/implementing-liftm2-in-haskell/53178159#53178159", "title": "Implementing liftM2 in Haskell", "body": "<p>I think it's worth noting that your initial guess,</p>\n\n<pre><code>liftM2 f a b = liftM (_) (ap _ a)\n</code></pre>\n\n<p>isn't really that far off. But <code>ap</code> isn't quite the right place to start for that shape. Rather, consider</p>\n\n<pre><code>pairIO :: IO a -&gt; IO b -&gt; IO (a, b)\npairIO m n = do\n  a &lt;- m\n  b &lt;- n\n  return (a, b)\n</code></pre>\n\n<p>Now, you can write</p>\n\n<pre><code>liftM2 :: (a -&gt; b -&gt; c) -&gt; IO a -&gt; IO b -&gt; IO c\nliftM2 f m n = liftM _ (pairIO m n)\n</code></pre>\n\n<p>GHC will tell you that it needs</p>\n\n<pre><code>_ :: (a, b) -&gt; c\n</code></pre>\n\n<p>and you should be able to fill that very easily.</p>\n\n<p>This actually reflects a common alternative formulation of the notion of an \"applicative Functor\":</p>\n\n<pre><code>class Functor f =&gt; Monoidal f where\n  pur :: a -&gt; f a\n  pair :: f a -&gt; f b -&gt; f (a, b)\n</code></pre>\n\n<p>This class turns out to be equivalent in power to the standard <code>Applicative</code> class.</p>\n\n<hr>\n\n<p>It turns out that you can actually combine actions in various ways, thanks to the <code>Monoidal</code> associative law. This looks like</p>\n\n<pre><code>xs `pair` (ys `pair` zs) = jigger &lt;$&gt; ((xs `pair` ys) `pair` z's)\n   where\n     jigger ((x, y), z) = (x, (y, z))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1541583888, "creation_date": 1541583888, "answer_id": 53186909, "question_id": 53145952, "link": "https://stackoverflow.com/questions/53145952/implementing-liftm2-in-haskell/53186909#53186909", "title": "Implementing liftM2 in Haskell", "body": "<p>With <code>ap :: IO (a -&gt; b) -&gt; IO a -&gt; IO b</code>, we have both</p>\n\n<pre><code>  IO (a -&gt; b)         {- and -}       IO (a -&gt; b -&gt; c)\n  IO  a                               IO  a\n  -----------                         ----------------\n  IO       b                          IO      (b -&gt; c)\n</code></pre>\n\n<p>thus we can combine two IO values with an IO binary function through</p>\n\n<pre><code>ap2 :: IO (a -&gt; b -&gt; c) -&gt; IO a -&gt; IO b -&gt; IO c\nap2 mf mx my = ap mf mx `ap` my\n\n             IO (a -&gt; b -&gt; c)\n             IO  a\n             ----------------\n             IO      (b -&gt; c)\n             IO       b\n             ----------------\n             IO            c\n</code></pre>\n\n<p>or with a pure binary function,</p>\n\n<pre><code>liftM2 :: (a -&gt; b -&gt; c) -&gt; IO a -&gt; IO b -&gt; IO c\nliftM2 f mx my = ap2 (return f) mx my\n               = ap (return f) mx `ap` my\n               = (ap . return) f mx `ap` my\n</code></pre>\n\n<p>And what is the type of <code>ap . return</code>? </p>\n\n<pre><code>&gt; :t ap . return\nap . return :: Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b\n</code></pre>\n\n<p>Why, it's the type of <code>liftM</code>! (here a more specific <code>(a -&gt; b -&gt; c) -&gt; IO a -&gt; IO (b -&gt; c)</code>)</p>\n\n<pre><code>              = liftM f mx `ap` my\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 6531041, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9608949f5389592ff98140d22a63367a?s=128&d=identicon&r=PG&f=1", "display_name": "justan0therlurker", "link": "https://stackoverflow.com/users/6531041/justan0therlurker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 53146022, "answer_count": 3, "score": 4, "last_activity_date": 1541583888, "creation_date": 1541368973, "last_edit_date": 1541428146, "question_id": 53145952, "link": "https://stackoverflow.com/questions/53145952/implementing-liftm2-in-haskell", "title": "Implementing liftM2 in Haskell", "body": "<p>For an exercise, I've been trying to implement liftM2 using just the functions ap and liftM. The functions are defined as:</p>\n\n<pre><code>ap :: IO (a -&gt; b) -&gt; IO a -&gt; IO b\nliftM :: (a -&gt; b) -&gt; IO a -&gt; IO b\n\nliftM2 :: (a -&gt; b -&gt; c) -&gt; IO a -&gt; IO b -&gt; IO c\n</code></pre>\n\n<p>I can easily do liftM2 using do notation but not sure how to do it using just ap and liftM. I was thinking of having the result be something that looks like this:</p>\n\n<pre><code>liftM2 f a b = liftM (_) (ap _ a)\n</code></pre>\n\n<p>I'm confused on how to mess with f, which is (a -> b -> c) such that I can just turn a to b and b to c. Thank you.</p>\n"}, {"tags": ["haskell", "recursion", "binary-tree"], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1541368752, "post_id": 53145906, "comment_id": 93183065, "body": "<code>flip</code> can be avoided with Applicative: <code>Node val key &lt;$&gt; insertm x y left &lt;*&gt; pure right</code> or <code>liftA2 (Node val key) (insertm x y left) (pure right)</code> (where <code>pure</code> = <code>Just</code> in this case)"}, {"owner": {"reputation": 53, "user_id": 10429855, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W_igRWf4x3s/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4trEcL4TtM1k3bD1zAi529BmJoQ/mo/photo.jpg?sz=128", "display_name": "Thierno Diallo", "link": "https://stackoverflow.com/users/10429855/thierno-diallo"}, "edited": false, "score": 0, "creation_date": 1541369209, "post_id": 53145906, "comment_id": 93183183, "body": "This is super cool! I\u2019ve been studying Haskell for a bit and im still not familar with all the tricks. Thank you."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1541370203, "last_edit_date": 1541370203, "creation_date": 1541368609, "answer_id": 53145906, "question_id": 53145804, "link": "https://stackoverflow.com/questions/53145804/haskell-insert-function-for-binary-trees/53145906#53145906", "title": "Haskell Insert function for Binary Trees", "body": "<p>The problem is that <code>(insertm x y left)</code> is a <code>Maybe (BinaryTree a b)</code> in:</p>\n\n<pre><code> | x &lt; val = Just (Node val key (insertm x y left) right)\n</code></pre>\n\n<p>not a <code>BinaryTree a b</code>, you thus can not just construct such a <code>BinaryTree</code> with a <code>Maybe (BinaryTree a b)</code> as subtree.</p>\n\n<p>You can however \"unpack\" the value, and then use this, like:</p>\n\n<pre><code>insertm :: (Ord a, Show a, Show b) =&gt; a -&gt; b -&gt; BinaryTree a b -&gt; Maybe (BinaryTree a b)\ninsertm val key Leaf = Just (Node val key Leaf Leaf)\ninsertm x y (Node val key left right)\n    | x == val = Nothing\n    | x &lt; val = case insertm x y left of\n        Just l -&gt; Just (Node val key l right)\n        Nothing -&gt; Nothing\n    | otherwise =  case insertm x y right of\n        Just r -&gt; Just (Node val key left r)\n        Nothing -&gt; Nothing</code></pre>\n\n<p>The above pattern is quite popular, we can use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:fmap\" rel=\"nofollow noreferrer\"><strong><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code></strong></a> here, to map the <code>x</code> in <code>Just x</code> to a <code>Just (f x)</code> and map <code>Nothing</code> on <code>Nothing</code>:</p>\n\n<pre><code>insertm :: (Ord a, Show a, Show b) =&gt; a -&gt; b -&gt; BinaryTree a b -&gt; Maybe (BinaryTree a b)\ninsertm val key Leaf = Just (Node val key Leaf Leaf)\ninsertm x y (Node val key left right)\n    | x == val = Nothing\n    | x &lt; val = fmap (flip (Node val key) right) (insertm x y left)\n    | otherwise = fmap (Node val key left) (insertm x y right)</code></pre>\n\n<p>or like <a href=\"https://stackoverflow.com/questions/53145804/haskell-insert-function-for-binary-trees/53145906#comment93183065_53145906\">@JonPurdy</a> says:</p>\n\n<pre><code>insertm :: (Ord a, Show a, Show b) =&gt; a -&gt; b -&gt; BinaryTree a b -&gt; Maybe (BinaryTree a b)\ninsertm val key Leaf = Just (Node val key Leaf Leaf)\ninsertm x y (Node val key left right)\n    | x == val = Nothing\n    | x &lt; val = Node val key &lt;$&gt; insertm x y left &lt;*&gt; pure right\n    | otherwise = Node val key left &lt;$&gt; insertm x y right</code></pre>\n\n<p>The <code>(&lt;$&gt;)</code> is function that is equivalent to <code>fmap</code>, and <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Applicative.html#v:-60--42--62-\" rel=\"nofollow noreferrer\"><strong><code>(&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b</code></strong></a> is a function that takes a here a <code>Maybe (BinaryTree a b -&gt; BinaryTree a b)</code>, and applies the function <code>f</code> wrapped in the <code>Just</code> with the value <code>x</code> wrapped in the right <code>Just</code> and returns <code>Just (f x)</code> given the two are thus <code>Just</code>s, if one of the two is a <code>Nothing</code> (or both), then it will return <code>Nothing</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 10429855, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-W_igRWf4x3s/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DV4trEcL4TtM1k3bD1zAi529BmJoQ/mo/photo.jpg?sz=128", "display_name": "Thierno Diallo", "link": "https://stackoverflow.com/users/10429855/thierno-diallo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 0, "accepted_answer_id": 53145906, "answer_count": 1, "score": 2, "last_activity_date": 1541370203, "creation_date": 1541368042, "last_edit_date": 1541368439, "question_id": 53145804, "link": "https://stackoverflow.com/questions/53145804/haskell-insert-function-for-binary-trees", "title": "Haskell Insert function for Binary Trees", "body": "<p>I'm trying to create a function called \"insertm\" that is supposed to insert a key and value into a binary tree.If the key already exists it should return \"nothing\". If not it should insert the key and value into the tree based on it's value. I was able to get most of it to go, but I'm getting an error that i'm not sure how to fix. </p>\n\n<p>Here is an example:</p>\n\n<pre><code>      TestQ4&gt; insertm 25 \"vw\" t5\n      Just (10:\"ghi\")&lt;$,(30:\"def\")&lt;(20:\"abc\")&lt;$,(25:\"vw\")&gt;,$&gt;&gt;\n      TestQ4&gt; insertm 20 \"vw\" t5\n      Nothing\n</code></pre>\n\n<p>Here is my code: </p>\n\n<pre><code>     data BinaryTree a b = Leaf | Node a b (BinaryTree a b) (BinaryTree a b) \n\n     insertm :: (Ord a, Show a, Show b) =&gt;\n     a -&gt; b -&gt; BinaryTree a b -&gt; Maybe (BinaryTree a b)\n\n     insertm val key Leaf = Just (Node val key Leaf Leaf)\n     insertm x y (Node val key left right)\n          | x == val = Nothing\n          | x &lt; val = Just (Node val key (insertm x y left) right)\n          | otherwise = Just (Node val key left (insertm x y right))\n</code></pre>\n\n<p>And this is the error i get:</p>\n\n<pre><code>       * Couldn't match expected type `BinaryTree a b'\n              with actual type `Maybe (BinaryTree a b)'\n       * In the fourth argument of `Node', namely `(insertm x y right)'\n         In the first argument of `Just', namely\n           `(Node val key left (insertm x y right))'\n         In the expression: Just (Node val key left (insertm x y right))\n       * Relevant bindings include\n          right :: BinaryTree a b (bound at TestQ4.hs:101:32)\n          left :: BinaryTree a b (bound at TestQ4.hs:101:27)\n          key :: b (bound at TestQ4.hs:101:23)\n          val :: a (bound at TestQ4.hs:101:19)\n          y :: b (bound at TestQ4.hs:101:11)\n          x :: a (bound at TestQ4.hs:101:9)\n         (Some bindings suppressed; use -fmax-relevant-binds=N or -fno-max- \n            relevant-binds)\n\n          | x &lt; val = Just (Node val key (insertm x y left) right)\n                                          ^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>I also get the error for my otherwise case. So im a bit stuck any help would be appreciated.</p>\n"}, {"tags": ["haskell", "haskell-platform"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541363731, "post_id": 53145187, "comment_id": 93181636, "body": "Hint: use <code>(++)</code> and <code>(.)</code>."}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541363820, "post_id": 53145187, "comment_id": 93181662, "body": "I have to do it with  (function composition ) but thanks for your help"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541364002, "post_id": 53145187, "comment_id": 93181713, "body": "<a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#&zwnj;&#8203;v</a>:."}, {"owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1541364513, "post_id": 53145187, "comment_id": 93181868, "body": "yup I knew it @Carcigenicate"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1541365613, "post_id": 53145187, "comment_id": 93182191, "body": "<code>.</code> is the function composition operator."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541444072, "post_id": 53145807, "comment_id": 93211312, "body": "<code>f . id == f</code> for any function; <code>id</code> doesn&#39;t serve any useful purpose here."}, {"owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541446293, "post_id": 53145807, "comment_id": 93212279, "body": "@chepner &quot;technically you could just use (++) on it&#39;s own&quot;"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541447086, "post_id": 53145807, "comment_id": 93212673, "body": "That doesn&#39;t explain why you bother using <code>id</code> in the first place."}, {"owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541447595, "post_id": 53145807, "comment_id": 93212884, "body": "I used someone&#39;s hint.. &quot;Hint: use <code>(++)</code> and <code>(.)</code>&quot; so thought how can I use compose and append in a single function that takes two arguments. The question wasn&#39;t clear but gave it a go anyways. Out of interest is there an alternate solution to using <code>(.)</code> and <code>(++)</code> together to append two strings?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541448324, "post_id": 53145807, "comment_id": 93213221, "body": "There is, but it&#39;s not anything you would ever write naturally. Function composition simply isn&#39;t warranted or useful here. Visit pointfree.io and see what it does to <code>f bar baz = take 3 bar ++ take 2 baz</code>."}, {"owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541448635, "post_id": 53145807, "comment_id": 93213362, "body": "I thought that was part of the question hence the challenge /: I&#39;m aware how (++) works and pointfree but thank you for your input."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541448835, "post_id": 53145807, "comment_id": 93213443, "body": "It&#39;s not a challenge if the only answer is exploiting trivial identities. That&#39;s why you get verification from the OP about what they are actually asking."}, {"owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541448960, "post_id": 53145807, "comment_id": 93213483, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/183146/discussion-between-cmdv-and-chepner\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "is_accepted": false, "score": 1, "last_activity_date": 1541368053, "creation_date": 1541368053, "answer_id": 53145807, "question_id": 53145187, "link": "https://stackoverflow.com/questions/53145187/function-composition-haskell-language/53145807#53145807", "title": "function composition (Haskell language)", "body": "<p>one solution could be:</p>\n\n<pre><code>bar = take 3 \"Helium\"\nbaz = take 2 \"lol\"\n\ncombine :: [a] -&gt; [a] -&gt; [a]\ncombine = (++) . (id)\n</code></pre>\n\n<p>we're using <code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code> which is <a href=\"https://www.stackage.org/haddock/lts-12.16/base-4.11.1.0/Prelude.html#v:.\" rel=\"nofollow noreferrer\">function composition</a> and <code>id :: a -&gt; a</code></p>\n\n<p>technically you could just use <code>(++)</code> on it's own</p>\n"}], "owner": {"reputation": 119, "user_id": 8012467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b671c5fcf115067e21acb9fcd967cc68?s=128&d=identicon&r=PG&f=1", "display_name": "Alaa Alsayed", "link": "https://stackoverflow.com/users/8012467/alaa-alsayed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "closed_date": 1541385073, "answer_count": 1, "score": -4, "last_activity_date": 1541368053, "creation_date": 1541363613, "last_edit_date": 1541363679, "question_id": 53145187, "link": "https://stackoverflow.com/questions/53145187/function-composition-haskell-language", "closed_reason": "Needs details or clarity", "title": "function composition (Haskell language)", "body": "<p>I have the word <code>bar</code> which contains the string <code>\"Helium\"</code> and the word <code>baz</code> which contains the string <code>\"lol\"</code>.</p>\n\n<p>I tried to use :</p>\n\n<pre><code>takeCharacters (3) bar (takeCharacters (2) baz)\n</code></pre>\n\n<p>to get the string <code>\"Hello\"</code> but it doesn't work (I have to use function composition)\ncan someone help me please!!!!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1541360410, "post_id": 53144673, "comment_id": 93180703, "body": "Because the <code>(**)</code> has as type <code>Floating a =&gt; a -&gt; a -&gt; a</code>"}, {"owner": {"reputation": 35, "user_id": 8839928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92c15709f54d40a97524bda358fb4f90?s=128&d=identicon&r=PG&f=1", "display_name": "Silver", "link": "https://stackoverflow.com/users/8839928/silver"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541360718, "post_id": 53144673, "comment_id": 93180793, "body": "@WillemVanOnsem then what other operator can i use?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541360762, "post_id": 53144673, "comment_id": 93180807, "body": "<code>(^)</code> works for integral types."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541360830, "post_id": 53144673, "comment_id": 93180834, "body": "You probably also should replace <code>(...) &#47; 12</code> with <code>div (...) 12</code>."}, {"owner": {"reputation": 35, "user_id": 8839928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92c15709f54d40a97524bda358fb4f90?s=128&d=identicon&r=PG&f=1", "display_name": "Silver", "link": "https://stackoverflow.com/users/8839928/silver"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541360875, "post_id": 53144673, "comment_id": 93180851, "body": "but that gives ` No instance for (Fractional Int)`"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541360909, "post_id": 53144673, "comment_id": 93180861, "body": "see above, your <code>div</code> forces you to make it a <code>Fractional</code>. So given the number in the numerator is dividable by <code>12</code>, you can use <code>div</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1541365295, "post_id": 53144673, "comment_id": 93182095, "body": "@WillemVanOnsem <code>div</code> would make no sense whatsoever here, since the purpose of the exponent is to divide the octave into steps of &#185;&#178;\u221a2. The numerator is <i>not</i> divisible by 12."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1541365191, "post_id": 53144765, "comment_id": 93182062, "body": "Right. Alternatively, <code>(2**(1&#47;12))^^(midi &#39;A&#39; 4 - midi x y)</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 8, "last_activity_date": 1541361767, "last_edit_date": 1541361767, "creation_date": 1541360949, "answer_id": 53144765, "question_id": 53144673, "link": "https://stackoverflow.com/questions/53144673/why-actual-type-is-double/53144765#53144765", "title": "Why actual type is Double?", "body": "<ol>\n<li><code>fromNotes</code> returns a <code>[Double]</code>, so</li>\n<li><code>freq</code> must return a <code>Double</code>, so</li>\n<li><code>2**((midi 'A' 4 - midi x y)/12)</code> must be a <code>Double</code>, so</li>\n<li><code>midi</code> must return a <code>Double</code>, so</li>\n<li><code>o * 12</code> must be a <code>Double</code>, so</li>\n<li>the second argument to <code>midi</code> must be a <code>Double</code>, so</li>\n<li>the <code>y</code> in <code>midi x y</code> must be a <code>Double</code>, so</li>\n<li><code>freq</code> must take a <code>Double</code> as the second part of its tuple.</li>\n</ol>\n\n<p>You can use <code>fromIntegral :: Int -&gt; Double</code> at almost any step in that chain to fix things up. It's probably simplest to do it right away, as in</p>\n\n<pre><code>freq (x, y) = ... midi x (fromIntegral y) ...\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8839928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92c15709f54d40a97524bda358fb4f90?s=128&d=identicon&r=PG&f=1", "display_name": "Silver", "link": "https://stackoverflow.com/users/8839928/silver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 53144765, "answer_count": 1, "score": 2, "last_activity_date": 1541363774, "creation_date": 1541360361, "last_edit_date": 1541363774, "question_id": 53144673, "link": "https://stackoverflow.com/questions/53144673/why-actual-type-is-double", "title": "Why actual type is Double?", "body": "<pre><code>fromNotes :: [(Char, Int)] -&gt; [Double]\nfromNotes = map freq\n  where\n    freq (x,y) =  440 * 2**((midi x y - midi 'A' 4)/12)\n    midi c o = o * 12 + getIndex c s 0 + 12\n    s = \"CcDdEFfGgAaB\"\n    getIndex c (x:xs) i\n            | c == x    = i\n            | otherwise = getIndex c xs (i+1)\n</code></pre>\n\n<p>The code gives the error: </p>\n\n<pre><code>* Couldn't match type `Int' with `Double'\nExpected type: [(Char, Int)] -&gt; [Double]\nActual type: [(Char, Double)] -&gt; [Double]\n</code></pre>\n\n<p>From what i can tell the problem is in <code>midi x y - midi 'A' 4</code>. </p>\n\n<p>But why is Haskell saying the actual type is a Double?</p>\n"}, {"tags": ["haskell", "record", "newtype"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541344713, "post_id": 53142208, "comment_id": 93176074, "body": "What if the two do not have the same <code>first_name</code>?"}, {"owner": {"reputation": 101, "user_id": 10429975, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D-E2-UHsaOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWNBrMIBj8VPPmGT-WHLnDQWGC0Wg/mo/photo.jpg?sz=128", "display_name": "Yellowsgg", "link": "https://stackoverflow.com/users/10429975/yellowsgg"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541344869, "post_id": 53142208, "comment_id": 93176120, "body": "Then it should not be sorted. Thank you!"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1541345232, "post_id": 53142208, "comment_id": 93176205, "body": "It isn&#39;t quite clear how you plan to sort only some elements and leave others unsorted. It doesn&#39;t compute. You can only sort an entire list."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541356886, "post_id": 53142208, "comment_id": 93179689, "body": "A stable sort using a comparison function that treats all first names as equivalent should do the trick."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541357316, "post_id": 53142208, "comment_id": 93179793, "body": "@chepner that&#39;s exactly what <code>compare `on` last_name</code> does, and OP  claims it doesn&#39;t work, and perhaps not because the default sort is unstable."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541358816, "post_id": 53142208, "comment_id": 93180253, "body": "<code>compare `on` last_name</code> will compare two <code>Person</code>s by their last name, regardless of their first name. Unless the first names are equal, you want two <code>Person</code>s to compare as equal so that the stable sort won&#39;t alter their relative position."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10429975, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D-E2-UHsaOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWNBrMIBj8VPPmGT-WHLnDQWGC0Wg/mo/photo.jpg?sz=128", "display_name": "Yellowsgg", "link": "https://stackoverflow.com/users/10429975/yellowsgg"}, "edited": false, "score": 0, "creation_date": 1541363553, "post_id": 53144421, "comment_id": 93181590, "body": "Thank you so much! I think that&#39;s what I want, although it&#39;s a bit weird. But anyway, that&#39;s a weird question..."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1541375627, "post_id": 53144421, "comment_id": 93184584, "body": "I think you meant <code>first_name x &#47;= first_name y</code>? My preference would be to write this inline unless it\u2019s going to be reused, e.g. <code>sortBy (\\ a b -&gt; case comparing first_name a b of { EQ -&gt; comparing last_name a b; _ -&gt; EQ })</code> or break out a helper function like <code>whenEqual EQ a = a; whenEqual _ _ = EQ</code> so you can write <code>whenEqual (comparing first_name a b) (comparing last_name a b)</code>; this can also be written pointfree as <code>liftA2 whenEqual &lt;$&gt; comparing first_name &lt;*&gt; comparing last_name</code>, although that\u2019s maybe a bit too far, haha"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1541527266, "post_id": 53144421, "comment_id": 93244896, "body": "This comparison doesn&#39;t impose an non-strict partial order. relation. John Blake is equivalent to Maria Hernandez, and Maria Hernandez is equivalent to John Browne, but John Browne is not equivalent to John Blake. The documentation doesn&#39;t say what <code>sortBy</code> should do with a comparison function that doesn&#39;t respect the non-strict partial order laws, and I&#39;m having a hard time imagining what sorting with this comparison could ever mean."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1541527600, "post_id": 53144421, "comment_id": 93245064, "body": "Correction, Haskell 2010 report says &quot;The function is assumed to define a total ordering&quot;, so it is undefined what <code>sortBy foo</code> will do."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541531351, "post_id": 53144421, "comment_id": 93246874, "body": "Hm. If <code>sortBy</code> is guaranteed to be stable given a total ordering, does that imply anything about what calls to <code>foo</code> are made? If <code>foo a b == EQ</code>, we&#39;re left to imply that both <code>a &lt;= b</code> and <code>b &lt;= a</code> are true, but for sorting purposes that is, in some sense, <i>not</i> true, because <code>[b, a]</code> would be guaranteed to sort as <code>[b, a]</code>, not <code>[a, b]</code>. So <code>foo</code> itself does not define even a preorder (since we lack transitivity), but can it ever be used by <code>sortBy</code> in such a way to distinguish it from a total order?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541535703, "post_id": 53144421, "comment_id": 93248915, "body": "Not much. If you are using merge sort, the final order will depend on where exactly you split the list, and whether you do any insertion passes."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541535904, "post_id": 53144421, "comment_id": 93248996, "body": "Yes, but whether or not merge sort is stable depends on the implementation; Haskell (or at least GHC) <code>sort</code> is stated to have a stable implementation."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541536484, "post_id": 53144421, "comment_id": 93249278, "body": "The traditional straightforward implementation (where you break the list into &#39;low&#39; and &#39;high&#39; parts) is stable. Tiimsort is also stable."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1541431908, "last_edit_date": 1541431908, "creation_date": 1541358761, "answer_id": 53144421, "question_id": 53142208, "link": "https://stackoverflow.com/questions/53142208/haskell-how-to-sort-a-record-type-by-one-attribute-if-the-other-is-same/53144421#53144421", "title": "Haskell : How to sort a record type by one attribute if the other is same?", "body": "<p>The comparison function you want is to treat two <code>Person</code> values as equal if their first names are different. If the first names are the same, <em>then</em> compare based on the last name.</p>\n\n<p>Since <code>sort</code> in Haskell is stable, if an element <code>a</code> precedes an equal element <code>b</code> in the input, it will also precede <code>b</code> in the output. In this case, two elements with different first names will compare as equal, so <code>sort</code> will really only sort the consecutive subsequences sharing a first name.</p>\n\n<p>There is probably a clever way to implement this, but a straightforward comparison function might look like</p>\n\n<pre><code>foo :: Person -&gt; Person -&gt; Ordering\nfoo x y | first_name x /= first_name y = EQ\n        | otherwise                   = (comparing last_name) x y\n</code></pre>\n\n<p>Given <code>people = [ Person \"A\" \"B\",Person \"Z\" \"C\",Person \"Z\" \"A\"]</code>, you can see\nthe difference between <code>sortBy (comparing last_name)</code> and <code>sortBy foo</code>.</p>\n\n<pre><code>&gt; people\n[Person {first_name = \"A\", last_name = \"B\"},Person {first_name = \"Z\", last_name = \"C\"},Person {first_name = \"Z\", last_name = \"A\"}]\n&gt; sortBy (comparing last_name) people\n[Person {first_name = \"Z\", last_name = \"A\"},Person {first_name = \"A\", last_name = \"B\"},Person {first_name = \"Z\", last_name = \"C\"}]\n&gt; sortBy foo people\n[Person {first_name = \"A\", last_name = \"B\"},Person {first_name = \"Z\", last_name = \"A\"},Person {first_name = \"Z\", last_name = \"C\"}]\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 10429975, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-D-E2-UHsaOw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DWNBrMIBj8VPPmGT-WHLnDQWGC0Wg/mo/photo.jpg?sz=128", "display_name": "Yellowsgg", "link": "https://stackoverflow.com/users/10429975/yellowsgg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541431908, "creation_date": 1541344117, "last_edit_date": 1541363253, "question_id": 53142208, "link": "https://stackoverflow.com/questions/53142208/haskell-how-to-sort-a-record-type-by-one-attribute-if-the-other-is-same", "title": "Haskell : How to sort a record type by one attribute if the other is same?", "body": "<p>If I just have a very simple custom data type:</p>\n\n<pre><code>data Person = Person {first_name :: String,\n                      last_name :: String\n                     } deriving (Ord, Eq, Show)\n</code></pre>\n\n<p>If I have a list of these Person data types, and I want to sort it by <code>last_name</code> if and only if the <code>first_name</code> is the same. But I should <strong>not</strong> sort the <code>first_name</code>. Simply call the following obviously doesn't work.</p>\n\n<pre><code>import Data.Function (on)\nimport Data.List (sortBy)\n\nsortBy (compare `on` last_name ) persons\n</code></pre>\n\n<p>How can I solve it? I do agree it's quite confusing. What I want is that if I have the following (that's definitely not a list of the custom data type, I just want to show it clearly)</p>\n\n<pre><code>[(\"c\",\"d\"),(\"a\",\"c\"),(\"a\",\"a\")]\n</code></pre>\n\n<p>After sorting I would like to have </p>\n\n<pre><code>[(\"c\",\"d\"),(\"a\",\"a\"),(\"a\",\"c\")]\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code> [(\"a\",\"a\"),(\"a\",\"c\"),(\"c\",\"d\")]\n</code></pre>\n\n<p>So the idea is that first element should still appear at first, since it does not have the same <code>first_name</code> with the other two. Is that possible? Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1541337960, "post_id": 53141301, "comment_id": 93174274, "body": "If you do not know how to start with a certain function, that is typically because you start &quot;too high&quot;. In that case, it makes sense to first do some more basic exercises."}, {"owner": {"reputation": 944, "user_id": 49554, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02c8ecc24181d171df85a26458b9cd5f?s=128&d=identicon&r=PG", "display_name": "jneira", "link": "https://stackoverflow.com/users/49554/jneira"}, "edited": false, "score": 1, "creation_date": 1541338914, "post_id": 53141301, "comment_id": 93174515, "body": "I would follow the previous comment advice but anyway it would be useful include the <code>BinaryTree</code> definition (or link to it)"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 6, "creation_date": 1541340391, "post_id": 53141301, "comment_id": 93174929, "body": "Welcome to Stackoverflow @Lisa! What&#39;s the definition of your tree? What have you tried so far? See <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 944, "user_id": 49554, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02c8ecc24181d171df85a26458b9cd5f?s=128&d=identicon&r=PG", "display_name": "jneira", "link": "https://stackoverflow.com/users/49554/jneira"}, "edited": false, "score": 1, "creation_date": 1541341185, "post_id": 53141301, "comment_id": 93175167, "body": "All right, so i would use pattern matching and recursion to implement the function. There is a lot of resources about them out there, you could start with <a href=\"http://learnyouahaskell.com/recursion\" rel=\"nofollow noreferrer\">learnyouahaskell.com/recursion</a> and <a href=\"http://learnyouahaskell.com/syntax-in-functions#pattern-matching\" rel=\"nofollow noreferrer\">learnyouahaskell.com/syntax-in-functions#pattern-matching</a> f.e."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1541343590, "post_id": 53141301, "comment_id": 93175779, "body": "Start by defining a function <code>isLeaf :: BinaryTree a -&gt; Bool</code> that returns true if its argument is a leaf. Even if it isn&#39;t immediately clear how (or if) such a function would be useful, just defining it will give you practice with manipulating trees."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1541343604, "post_id": 53141301, "comment_id": 93175783, "body": "Welcome to SO. SO is not a homework or coding service. You should post your best attempt, and ask about <i>specific</i> issues you are having. Try using all of: 1) pattern matching, 2) recursion on trees, 3) <code>++</code> to concatenate lists."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541349829, "post_id": 53141301, "comment_id": 93177598, "body": "with <code>deriving (Functor, Foldable)</code> added to the data type definition, <code>foldMap pure</code> <a href=\"https://stackoverflow.com/a/53067471/849891\">should do it</a>. But, it&#39;s not the beginner&#39;s level. :)"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541357246, "post_id": 53141301, "comment_id": 93179777, "body": "@WillNess The question asks for the leaves, not a list of all nodes."}], "answers": [{"tags": [], "owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1541404361, "creation_date": 1541404361, "answer_id": 53150293, "question_id": 53141301, "link": "https://stackoverflow.com/questions/53141301/get-leaves-of-binary-tree-use-haskell/53150293#53150293", "title": "Get leaves of binary tree use Haskell", "body": "<p>This is easily done using pattern matching and recursion. In recursion, there are base cases and recursive cases. </p>\n\n<ul>\n<li><p>Base case is where the function returns something without calling\nsame function</p></li>\n<li><p>recursive case is where function calls the same function with arguments of lower scope and does something with it before returning.</p></li>\n</ul>\n\n<p>So for your Tree structure in Haskell you need following three things. </p>\n\n<ol>\n<li>Pattern for base case for your tree definition. </li>\n<li>Pattern for the leaf node. </li>\n<li>Pattern  for the recursive case.</li>\n</ol>\n\n<p>For each of the above you will also need to figure out what the function needs to return. </p>\n"}], "owner": {"reputation": 11, "user_id": 10603674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34771043b03411dfd8fa93ba9cfe9d83?s=128&d=identicon&r=PG&f=1", "display_name": "Lisa", "link": "https://stackoverflow.com/users/10603674/lisa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 207, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1541404361, "creation_date": 1541337900, "last_edit_date": 1541346320, "question_id": 53141301, "link": "https://stackoverflow.com/questions/53141301/get-leaves-of-binary-tree-use-haskell", "title": "Get leaves of binary tree use Haskell", "body": "<p>I have a function <code>treeLeaves :: BinaryTree a -&gt; [a]</code>. This function should take a binary tree and return a list containing the leaves of that tree\u2014that is, all the nodes with no subtrees beneath them. Can you help me? I have no idea about how to begin.</p>\n\n<pre><code>data BinaryTree a = Null | Node a (BinaryTree a) (BinaryTree a)\n</code></pre>\n"}, {"tags": ["haskell", "types", "int"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1541338004, "post_id": 53141138, "comment_id": 93174288, "body": "What&#39;s <code>filterMultiples</code>?"}, {"owner": {"reputation": 944, "user_id": 49554, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02c8ecc24181d171df85a26458b9cd5f?s=128&d=identicon&r=PG", "display_name": "jneira", "link": "https://stackoverflow.com/users/49554/jneira"}, "edited": false, "score": 0, "creation_date": 1541338572, "post_id": 53141138, "comment_id": 93174429, "body": "Your example compiles for me using ghc 8.2.2 and replacing <code>filterMultiples</code>with <code>undefined</code> (cause it is not in the code example)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541342839, "post_id": 53141138, "comment_id": 93175595, "body": "And <code>n</code> in <code>length n</code> would be ...?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1541343234, "post_id": 53141138, "comment_id": 93175689, "body": "It&#39;s impossible to debug this without full information. You should post an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}], "owner": {"reputation": 43, "user_id": 4984040, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2JHj1ZbDlEM/AAAAAAAAAAI/AAAAAAAAABs/m6UWDLfRai0/photo.jpg?sz=128", "display_name": "Skipper HUN", "link": "https://stackoverflow.com/users/4984040/skipper-hun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541342484, "creation_date": 1541336802, "last_edit_date": 1541342484, "question_id": 53141138, "link": "https://stackoverflow.com/questions/53141138/haskell-error-couldnt-match-type-a1-with-int", "title": "Haskell error: Couldn&#39;t match type `a1&#39; with `Int&#39;", "body": "<p>In haskell I have this function, which works great: </p>\n\n<pre><code>primesAtMost :: Integral a =&gt; a -&gt; [a]\nprimesAtMost n = sieve [2..n]\nwhere\n    sieve :: Integral a =&gt; [a] -&gt; [a]\n    sieve [] = []\n    sieve (x:xs) = (x:sieve (filterMultiples x xs))\n</code></pre>\n\n<p>The problem is, it's parameter type is a, and I'm not allowed to change that.\nWhen I try to call this function with a parameter that's type is Int, it gives an error: Couldn't match type `a1' with `Int'\nFor example: </p>\n\n<pre><code>primesAtMost (length n)\n</code></pre>\n"}, {"tags": ["haskell", "ghci", "winghci"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541343877, "post_id": 53140675, "comment_id": 93175858, "body": "<a href=\"https://en.wikipedia.org/wiki/Horner%27s_method\" rel=\"nofollow noreferrer\">Horner&#39;s Method</a> is useful."}], "answers": [{"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 3, "last_activity_date": 1541334018, "creation_date": 1541334018, "answer_id": 53140753, "question_id": 53140675, "link": "https://stackoverflow.com/questions/53140675/convert-a-list-of-digits-to-a-number-haskell/53140753#53140753", "title": "Convert a list of digits to a number HASKELL", "body": "<p>This may simply be done by folding with <code>foldl1 :: Foldable t =&gt; (a -&gt; a -&gt; a) -&gt; t a -&gt; a</code> as follows;</p>\n\n<pre><code>Prelude&gt; foldl1 (\\x y -&gt; 10*x+y) [1,2,3]\n123\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1541334029, "creation_date": 1541334029, "answer_id": 53140755, "question_id": 53140675, "link": "https://stackoverflow.com/questions/53140675/convert-a-list-of-digits-to-a-number-haskell/53140755#53140755", "title": "Convert a list of digits to a number HASKELL", "body": "<p>You can use a \"fold\" pattern for this. We thus write this in terms of <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:foldl\" rel=\"nofollow noreferrer\"><strong><code>foldl :: (a -&gt; b -&gt; a) -&gt; a -&gt; [b] -&gt; a</code></strong></a>:</p>\n\n<pre><code>function5 :: Num n =&gt; [n] -&gt; n\nfunction5 = foldl f 0\n    where f a x = ...\n</code></pre>\n\n<p>So here <code>f</code> takes two parameters <code>a</code> (the thus far generated number), and <code>x</code> the next digit.</p>\n\n<p>In a <a href=\"https://en.wikipedia.org/wiki/Positional_notation\" rel=\"nofollow noreferrer\">positional notation system</a>, one can obtain the value by \"scanning\" left-to-right and each time multiplying the thus far obtained value with the radix, and adding the next digit. So this is the logic you need to \"encode\" in <code>f</code>: taking the thus far obtained value, and the next digit, and producing the next value.</p>\n"}, {"tags": [], "owner": {"reputation": 98, "user_id": 7671431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8dbf6f132deeebc3106cf3e6ee9fbd9?s=128&d=identicon&r=PG&f=1", "display_name": "vps", "link": "https://stackoverflow.com/users/7671431/vps"}, "is_accepted": false, "score": 2, "last_activity_date": 1541334964, "creation_date": 1541334964, "answer_id": 53140880, "question_id": 53140675, "link": "https://stackoverflow.com/questions/53140675/convert-a-list-of-digits-to-a-number-haskell/53140880#53140880", "title": "Convert a list of digits to a number HASKELL", "body": "<pre><code>multiplos_10 = [10^x | x &lt;- [0..]]\naux (x:xs) = sum ([a*b | (a,b) &lt;- zip (x:xs) multiplos_10])\na_numero (x:xs) = aux (reverse(x:xs))\n</code></pre>\n"}], "owner": {"reputation": 98, "user_id": 7671431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8dbf6f132deeebc3106cf3e6ee9fbd9?s=128&d=identicon&r=PG&f=1", "display_name": "vps", "link": "https://stackoverflow.com/users/7671431/vps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1541334964, "creation_date": 1541333459, "question_id": 53140675, "link": "https://stackoverflow.com/questions/53140675/convert-a-list-of-digits-to-a-number-haskell", "title": "Convert a list of digits to a number HASKELL", "body": "<p>I want to make a function in haskell that given a list of single digits, i make the full number. I was thinking in using intensive lists and patrons, as the code it follows:</p>\n\n<pre><code>funcion5 (x:xs) = [y*(10^w) | y &lt;- (x:xs) w]\n</code></pre>\n\n<p>The idea is, to go over the list and multiplie each digit to 10 pow to the position of the number. Finally i only have to sum all digits and I have the number as this:</p>\n\n<pre><code>sum (funcion5 (x:xs))\n</code></pre>\n\n<p>Can anyone help me, please? Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 21991, "user_id": 75103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7dfc20ceb7d6e1686d9be8f68469afa7?s=128&d=identicon&r=PG", "display_name": "thebjorn", "link": "https://stackoverflow.com/users/75103/thebjorn"}, "edited": false, "score": 1, "creation_date": 1541327449, "post_id": 53139761, "comment_id": 93171706, "body": "Backwards compatibility seems like a good reason.. besides, wouldn&#39;t you just be moving the empty-check from the calling site to the receiving site?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1541327525, "post_id": 53139761, "comment_id": 93171726, "body": "I agree it would have been a good idea to make a signature <code>head :: Unsafe =&gt; [a] -&gt; a</code>, such that one can &quot;turn off&quot; unsafe functions, but unfortunately it is &quot;too late&quot;, by introducing that, it would break a lot of existing code. Furthermore a lot of functions have been designed <i>without</i> such signature, hence it would be of &quot;limited&quot; use."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1541327700, "post_id": 53139761, "comment_id": 93171775, "body": "One of the main problems is that you can use unsafe functions in such a way, that the result itself is safe. For example one can use <code>head</code>, but if you know for sure you are dealing with a non-empty list, then this is not unsafe, so you can make a very <i>conservative</i> approach where you mark everything that uses unsafe functions as unsafe. But this will act like a &quot;virus&quot; contaminating a lot of functions that are safe."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "reply_to_user": {"reputation": 21991, "user_id": 75103, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7dfc20ceb7d6e1686d9be8f68469afa7?s=128&d=identicon&r=PG", "display_name": "thebjorn", "link": "https://stackoverflow.com/users/75103/thebjorn"}, "edited": false, "score": 0, "creation_date": 1541328787, "post_id": 53139761, "comment_id": 93172004, "body": "@thebjorn , usually it&#39;s a good practice to unlift a Maybe/Either at the highest layer because then you have a better context to treat the issue."}], "answers": [{"comments": [{"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541327929, "post_id": 53139845, "comment_id": 93171828, "body": "Wow you made me discover something today ! Do you know other attempts to rewrite the prelude ?"}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 1, "creation_date": 1541328350, "post_id": 53139845, "comment_id": 93171913, "body": "@NicolasHenin There are quite a few of custom preludes on hackage. One of the better one IMHO is the <a href=\"https://hackage.haskell.org/package/foundation\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/foundation</a> Another very practical one, that I use on daily basis is <a href=\"https://hackage.haskell.org/package/rio\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/rio</a>"}, {"owner": {"reputation": 116, "user_id": 8913528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543d32ab8a13de3822308785d6803d46?s=128&d=identicon&r=PG&f=1", "display_name": "Th&#233;ophile Choutri", "link": "https://stackoverflow.com/users/8913528/th%c3%a9ophile-choutri"}, "edited": false, "score": 0, "creation_date": 1541332024, "post_id": 53139845, "comment_id": 93172812, "body": "Check out Aelve&#39;s list on alternative preludes: <a href=\"https://guide.aelve.com/haskell/alternative-preludes-zr69k1hc\" rel=\"nofollow noreferrer\">guide.aelve.com/haskell/alternative-preludes-zr69k1hc</a>"}], "tags": [], "owner": {"reputation": 116, "user_id": 8913528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543d32ab8a13de3822308785d6803d46?s=128&d=identicon&r=PG&f=1", "display_name": "Th&#233;ophile Choutri", "link": "https://stackoverflow.com/users/8913528/th%c3%a9ophile-choutri"}, "is_accepted": true, "score": 5, "last_activity_date": 1541327466, "creation_date": 1541327466, "answer_id": 53139845, "question_id": 53139761, "link": "https://stackoverflow.com/questions/53139761/why-head-from-the-prelude-package-has-not-been-implemented-the-safe-way-with/53139845#53139845", "title": "Why &#39;head&#39; (from the prelude package) has not been implemented the safe way with a Maybe?", "body": "<p>The community has been fixing this issue in the <em>custom</em> preludes that are distributed on Hackage.\nBut it can't fix the prelude itself, it's up to the Haskell Committee in charge. For matters of backward compatibility, it has never been fixed.</p>\n\n<p>(I personally prefer <a href=\"https://github.com/kowainik/relude\" rel=\"noreferrer\">Relude</a>'s approach on that matter. This prelude's <code>head</code> function is typed as <code>NonEmpty a -&gt; a</code>.)</p>\n"}, {"comments": [{"owner": {"reputation": 116, "user_id": 8913528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543d32ab8a13de3822308785d6803d46?s=128&d=identicon&r=PG&f=1", "display_name": "Th&#233;ophile Choutri", "link": "https://stackoverflow.com/users/8913528/th%c3%a9ophile-choutri"}, "edited": false, "score": 0, "creation_date": 1541360982, "post_id": 53140493, "comment_id": 93180878, "body": "It exists so you can compose it with other functions?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 116, "user_id": 8913528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543d32ab8a13de3822308785d6803d46?s=128&d=identicon&r=PG&f=1", "display_name": "Th&#233;ophile Choutri", "link": "https://stackoverflow.com/users/8913528/th%c3%a9ophile-choutri"}, "edited": false, "score": 1, "creation_date": 1541362871, "post_id": 53140493, "comment_id": 93181399, "body": "@Th&#233;ophileChoutri yeah, that&#39;s also one of the more reasonably things it&#39;s used for, and which only works with the unsafe signature. (Unless you use Kleisli composition, but in that case you might as well stay in the list monad: <code>take 1</code> instead of <code>head</code>.) However, a composition with <code>head</code> is only safe you can guarantee that the first function yields a non-empty list, in which case there&#39;s a good chance its signature should actually be <code>-&gt; NonEmpty A</code> rather than <code>-&gt; [A]</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1541332197, "creation_date": 1541332197, "answer_id": 53140493, "question_id": 53139761, "link": "https://stackoverflow.com/questions/53139761/why-head-from-the-prelude-package-has-not-been-implemented-the-safe-way-with/53140493#53140493", "title": "Why &#39;head&#39; (from the prelude package) has not been implemented the safe way with a Maybe?", "body": "<p>The real question is why there is a function <code>head</code> <em>at all</em>. This isn't needed for working with lists. To case-separate <code>(x:_)</code> and <code>[]</code>, as \u201csafe head\u201d would allow you, the best option is to just use pattern matching, or suitable higher-order functions / lens operators.</p>\n\n<p>In practice, the only use for <code>head</code> is when you're in some big function, want at the head of some list <code>xs</code> (among many other parameters) where you <em>have already checked that it is nonempty</em>, e.g. because some other clause has already covered that. In that case, the safety would be redundant.</p>\n\n<p>Arguably, this is still a kludge and would better be expressed with pattern-matching. But the point is, the unsafe head has at least some ugly-but-pragmatic uses, whereas a safe head would mostly add extra noise to pattern matching that needs to be done anyway.</p>\n\n<p>IMO, <code>head</code>, <code>tail</code> and <code>!!</code> should just be deprecated, not changed. They keep tripping up beginners coming from Python etc. thinking that they need such functions, but actually this style is inherently against the grain of Haskell.</p>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 1, "accepted_answer_id": 53139845, "answer_count": 2, "score": 2, "last_activity_date": 1541337535, "creation_date": 1541326892, "last_edit_date": 1541337535, "question_id": 53139761, "link": "https://stackoverflow.com/questions/53139761/why-head-from-the-prelude-package-has-not-been-implemented-the-safe-way-with", "title": "Why &#39;head&#39; (from the prelude package) has not been implemented the safe way with a Maybe?", "body": "<p>In prelude, <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:head\" rel=\"nofollow noreferrer\">head</a> has the following signature : <code>head :: [a] -&gt; a</code> which makes it unsafe on empty list, which is not good !! (<code>head :: [a] -&gt; Maybe a</code> is the good way :-) )</p>\n\n<p>this applies for a couple of other functions on list : last, tail, init minimum, maximum, cycle, last, init, foldl1, cycle... there are actually a lot of these calling <code>errorEmptyList</code> </p>\n\n<p>Quoting <em>Stephen Diehl</em> from his <a href=\"http://www.stephendiehl.com/posts/protolude.html\" rel=\"nofollow noreferrer\">website</a> : </p>\n\n<blockquote>\n  <p>\"Safe provides Maybe versions of many of the various partial functions\n  (head, tail) that are shipped by default. Wrapping it up in a Maybe is\n  widely considered the right approach and if Haskell were designed\n  today, they would not be present.\"</p>\n</blockquote>\n\n<p>I would love to see these unsafe functions tagged somehow with some convention at least because I don't think any of us like when an exception blows up in production :-)</p>\n\n<p>What prevents the community from fixing these issues in the prelude ?  </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1541326988, "post_id": 53139539, "comment_id": 93171584, "body": "What do you mean by &quot;a data_base&quot;? What exactly is <code>updateContact</code> supposed to do? Just add a new entry to the list of contacts in a MailAccount?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1541327090, "post_id": 53139539, "comment_id": 93171611, "body": "Why are you using IO everywhere? If a function does not need to have side effects, don&#39;t use IO. <code>createPerson l n m = Person m (l,n)</code> is better. Avoid <code>do</code> if not using monads. Don&#39;t use <code>return</code> if not working with monads. You are thinking about imperative code and trying to shoehorn it into Haskell, but that won&#39;t work."}, {"owner": {"reputation": 135, "user_id": 9425001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66f9931cc1ba87e96931428c76511173?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell-newb", "link": "https://stackoverflow.com/users/9425001/haskell-newb"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1541327274, "post_id": 53139539, "comment_id": 93171651, "body": "@melpomene yes just add new entry and by data base  i mean that mail account is a stored variable."}, {"owner": {"reputation": 135, "user_id": 9425001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66f9931cc1ba87e96931428c76511173?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell-newb", "link": "https://stackoverflow.com/users/9425001/haskell-newb"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1541327316, "post_id": 53139539, "comment_id": 93171664, "body": "@chi ok i see , thanks for the advice"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541337808, "post_id": 53139539, "comment_id": 93174247, "body": "<code>Person</code> and <code>Contact</code> are isomorphic, it isn&#39;t quite clear why you need <code>MailAccount</code> with the same data twice. Of course in real life a person may have more than one mail address so <code>Person Mail FullName</code> is hardly an adequate representation of a person. I suspect you need to take this into account. Names are also not unique, so identifying a person with their name is not realistic. Not speaking of the <code>FullName  = (LastName, Name)</code> equation which holds in the fantasy world of CS101 exercises but not elsewhere."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 9425001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66f9931cc1ba87e96931428c76511173?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell-newb", "link": "https://stackoverflow.com/users/9425001/haskell-newb"}, "edited": false, "score": 0, "creation_date": 1541356403, "post_id": 53140867, "comment_id": 93179563, "body": "I apreciate the time you to to explain it to, sadly i can&#39;t change the type and signature or obviously i would have gone for and easier way : <code>updateContact :: Mail -&gt; LastName -&gt; Name -&gt;MailAccount -&gt; IO MailAccount</code> and <code>type MailAccount</code>"}], "tags": [], "owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "is_accepted": false, "score": 2, "last_activity_date": 1541335237, "last_edit_date": 1541335237, "creation_date": 1541334806, "answer_id": 53140867, "question_id": 53139539, "link": "https://stackoverflow.com/questions/53139539/editing-data-type-in-haskell/53140867#53140867", "title": "Editing data type in Haskell", "body": "<p>There is a neater version of this but I'm doing like this so it can be more understanding:</p>\n\n<pre><code>type Name     = String\ntype LastName = String\ntype Mail     = String\ntype Id       = Int\ntype FullName = (LastName, Name)\ntype Contact  = (Id, FullName)\n\ndata Person =\n  Person Mail FullName [Contact]\n  deriving (Show, Read)\n\nupdatePersonContact :: Person -&gt; FullName -&gt; Id -&gt; Person\nupdatePersonContact (Person m fn contacts) newfullName id =\n    Person m fn (updateContact id newfullName contacts)\n\nupdateContact :: Id -&gt; FullName -&gt; [Contact] -&gt; [Contact]\nupdateContact id newfullName contacts =\n  map (\\(i, fn) -&gt;\n         if i == id\n         then (i, newfullName)\n         else (i, fn)) contacts\n\nperson1 :: Person\nperson1 = Person \"email@me.com\"(\"last\",\"first\")\n            [(1,(\"last1\",\"first1\")), (2,(\"last2\",\"first2\"))]\n</code></pre>\n\n<p>then using it you would:</p>\n\n<pre><code>&gt; updatePersonContact person1 (\"NEW\",\"NEWW\") 2\n-- Person \"email@me.com\" (\"last\",\"first\") [(1,(\"last1\",\"first1\")),(2,(\"NEW\",\"NEWW\"))]\n</code></pre>\n\n<p>We've update <code>Person</code> to have a list of <code>[Contact]</code> so now contacts are attached to a person. Each <code>Contact</code> now has an <code>Id</code> that we can use for getting to the right contact.</p>\n\n<p>You can deconstruct your types in the input like so <code>updatePersonContact (Person m fn contacts)</code> so now we can use all the bits we need to reconstruct our person.\nWith <code>m fn</code> we give them straight back as those don't need changing. But we're interested in <code>contacts</code> so we pass it to this function <code>updateContact id newfullName contacts</code>.</p>\n\n<p>In <code>updateContact</code> as inputs we have an <code>Id</code>, <code>FullName</code> and list of <code>[Contact]</code>.\nthe way to loop over a list is to use <code>map</code> so here we are using map to go through our list of contacts one by one. <code>map () contacts</code></p>\n\n<p>the <code>()</code> needs to be a function from <code>a -&gt; b</code> and our <code>a</code> when it loops the first time is <code>(1,(\"last1\",\"first1\")</code> so as you can see it has 2 values which we deal with by having <code>\\(i, fn) -&gt;</code>.\nSo <code>i == 1</code> and <code>fn == (\"last1\",\"first1\")</code>. These would update on every iteration of the list like any loop.</p>\n\n<p>The next part we check if <code>i == id</code> and if it does then that's the contact we want to update so we return <code>(i, newfullName)</code> which is our new full name originally passed into <code>updatePersonContact</code>. If <code>i</code> doesn't match <code>id</code> then let's just leave those values alone and return them as they came.</p>\n\n<p><code>map</code> is a functor so as you might see it's not that bad you might need to do a bit more reading on it to get a better understanding. :)</p>\n\n<p>In Haskell lists are immutable which means every time you are given a list you must return a brand new list.</p>\n"}, {"tags": [], "owner": {"reputation": 3063, "user_id": 439578, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e032fbe640b2234c8dce244907b99eab?s=128&d=identicon&r=PG", "display_name": "Manoj R", "link": "https://stackoverflow.com/users/439578/manoj-r"}, "is_accepted": true, "score": 2, "last_activity_date": 1541481641, "last_edit_date": 1541481641, "creation_date": 1541410183, "answer_id": 53151589, "question_id": 53139539, "link": "https://stackoverflow.com/questions/53139539/editing-data-type-in-haskell/53151589#53151589", "title": "Editing data type in Haskell", "body": "<p>Check you contacts function. It should be </p>\n\n<pre><code>contacts (_,x) = x \n</code></pre>\n\n<p>MailAccount is a tuple, with first element as person and second as contact. So it cannot be (<em>,</em>,x) but should be (_,x). </p>\n\n<p>The below updatecontact definition is working fine. </p>\n\n<pre><code>updateContact l n m macc = let myP = Person l (n,m) \n                               newMacc = (myP,((n,m),l):contacts macc) \n                           in return newMacc\n</code></pre>\n\n<p>I agree with others that there is no need for using IO in definition. The error would have been understood easily without IO. </p>\n"}], "owner": {"reputation": 135, "user_id": 9425001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66f9931cc1ba87e96931428c76511173?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell-newb", "link": "https://stackoverflow.com/users/9425001/haskell-newb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 53151589, "answer_count": 2, "score": -1, "last_activity_date": 1541481641, "creation_date": 1541325075, "last_edit_date": 1541325736, "question_id": 53139539, "link": "https://stackoverflow.com/questions/53139539/editing-data-type-in-haskell", "title": "Editing data type in Haskell", "body": "<p>i need help with haskell i'm kinda confused.</p>\n\n<p>I have custom types/Data like this: </p>\n\n<pre><code>type Name         = String \ntype LastName     = String\ntype Mail         = String\ntype FullName     = (LastName, Name)\n\ndata Person       = Person Mail FullName deriving (Show, Read)\ntype Contact      = (FullName,Mail)\ntype MailAccount = (Person,[Contact])\n</code></pre>\n\n<p>Let's assume that mail account is stored in a data_base , what i want from now is update the list of contact and i don't know how to do it  using this signature:</p>\n\n<pre><code>updateContact :: Mail -&gt; LastName -&gt; Name -&gt;MailAccount -&gt; IO MailAccount\n</code></pre>\n\n<p>I tried with this :</p>\n\n<pre><code>updateContact l n m macc = do\n           x &lt;- createPerson l n m\n           return $ mailAccountUpdate macc x\n</code></pre>\n\n<p>I created these three function:</p>\n\n<pre><code> --return my list of contacts\n  contacts:: MailAccount-&gt;[Contact]\n  contacts (_,_,con) = con\n\n  createPerson l n m = do\n       return (Person m (l,n))\n\n  mailAccountUpdate acc x = do \n       return (x:contact acc)\n</code></pre>\n\n<ol>\n<li>My problem is that thes code won't work  because return <code>$ mailAccountUpdate macc x</code> retruns a list and not an IO MailAccount.</li>\n<li>I'm not skilled enough to play with the <code>functors</code> and <code>fmap</code> yet.</li>\n<li>I want a way to update my list of contact in the mail account , meaning i want a way to access and edit this data and override it with the updated list.</li>\n<li>I have to respect the signature , so i tried to play with the logic in the terminal, so i tried a few things so my question is  : </li>\n</ol>\n\n<p>Is there a way to edit the data directly like OOP <code>ex : MailAccount.contact()</code> ? if not how can i create a function that can do the work.</p>\n\n<p>Is there a way to have for example two mailAccount with the same type and code it to do the equivalent of this in the ghci terminal : </p>\n\n<pre><code>mail1 = mail2\n</code></pre>\n\n<p>This will override the data in mail1 with the data from mail2. but i dont know how to code it in haskell with data type.</p>\n\n<p>Thank you everyone in advance for helping me.</p>\n"}, {"tags": ["haskell", "functor", "applicative"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1541319535, "post_id": 53138860, "comment_id": 93170099, "body": "Do you know about <code>minimumBy</code> ?"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1541318650, "creation_date": 1541318650, "question_id": 53138860, "link": "https://stackoverflow.com/questions/53138860/haskell-will-kurt-exercise-getting-more-info-from-dictionary", "title": "Haskell: Will Kurt exercise - getting more info from dictionary", "body": "<p>Exercise 28.3 \"get programming with haskell\" from Will Kurt. Idea is to use the cheapest robot part using applicative functors. Now I wrote the code below, which does exactly that, but I don't want to know the cost, but actually the entire part (name, description etc). Seems pointless to me to provide only the number. Have tried pattern matching and even cheating using sorting to get to the right solution, but I am surely overlooking something. My qualified import of <code>Data.Map</code> is called <code>DAMA</code></p>\n\n<pre><code>data RoPart = RoPart { fpName :: String\n                     , fpDesc :: String\n                     , fpCost :: Int\n                     , fpCount :: Int\n                     } deriving Show\nfpLeftArm = RoPart \"Left Arm\" \"Left hydraulic arm of robot\" 2000 1\nfpRightArm = RoPart \"Right Arm\" \"Electrically actuated arm of robot\" 3425 2\nfpHead = RoPart \"Head\" \"Camera operated AI control unit for robot\" 9456 3\nfpBody = RoPart \"Body\" \"Mounting unit for various robot parts\" 6788 4\nfpMove = RoPart \"Transport\" \"Caterpillar-operated transportation unit\" 4590 5\n\nfpPartsList = [fpLeftArm, fpRightArm, fpHead, fpBody, fpMove]\nfpPartsIndex = [1..5]\nfpDictionary = DAMA.fromList (zip fpPartsIndex fpPartsList)\n\nfPrintCost :: Maybe Int -&gt; IO ()\nfPrintCost Nothing = putStrLn \"item missing from dBase\"\nfPrintCost (Just fpCost) = print fpCost\n\nfpEnterPart :: IO ()\nfpEnterPart = do\n  putStrLn \"Provide part number 1: \"\n  val1 &lt;- getLine\n  putStrLn \"Provide part number 2: \"\n  val2 &lt;- getLine\n  let part1 = DAMA.lookup (read val1) fpDictionary\n  let part2 = DAMA.lookup (read val2) fpDictionary\n  let cheapest = min &lt;$&gt; (fpCost &lt;$&gt; part1) &lt;*&gt; (fpCost &lt;$&gt; part2)\n  fPrintCost cheapest\n</code></pre>\n"}, {"tags": ["haskell", "typeclass", "functor"], "comments": [{"owner": {"reputation": 1519, "user_id": 1486848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNtLf.jpg?s=128&g=1", "display_name": "ShamPooSham", "link": "https://stackoverflow.com/users/1486848/shampoosham"}, "edited": false, "score": 1, "creation_date": 1541324812, "post_id": 53138741, "comment_id": 93171075, "body": "The <code>&gt;&gt;?</code> operator wants a function <code>(a -&gt; Maybe b)</code> as second parameter, but its type declaration is <code>FileData -&gt; TCPFile</code>, where the return value isn&#39;t wrapped in a maybe"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 1519, "user_id": 1486848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNtLf.jpg?s=128&g=1", "display_name": "ShamPooSham", "link": "https://stackoverflow.com/users/1486848/shampoosham"}, "edited": false, "score": 0, "creation_date": 1541361972, "post_id": 53138741, "comment_id": 93181147, "body": "Oh damn..you are right...I need to exit the <code>&gt;&gt;?</code> chain somehow"}, {"owner": {"reputation": 1519, "user_id": 1486848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNtLf.jpg?s=128&g=1", "display_name": "ShamPooSham", "link": "https://stackoverflow.com/users/1486848/shampoosham"}, "edited": false, "score": 0, "creation_date": 1541406773, "post_id": 53138741, "comment_id": 93191850, "body": "Not sure what you mean by exiting the <code>&gt;&gt;?</code> chain, but I&#39;d say you need to change the type of <code>makeFile</code> to <code>FileData -&gt; Maybe TCPFile</code>. I think you&#39;ll stumble upon other problems after that, but it&#39;s a first step"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 1519, "user_id": 1486848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNtLf.jpg?s=128&g=1", "display_name": "ShamPooSham", "link": "https://stackoverflow.com/users/1486848/shampoosham"}, "edited": false, "score": 0, "creation_date": 1541406966, "post_id": 53138741, "comment_id": 93191925, "body": "Well my problem is that if i take your advice i still have to <code>unwrap</code> from the <code>Maybe TCPFile</code> to <code>TCPFile</code> to match the <code>fromText</code> signature, outside the <code>makeFile</code>"}, {"owner": {"reputation": 1519, "user_id": 1486848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNtLf.jpg?s=128&g=1", "display_name": "ShamPooSham", "link": "https://stackoverflow.com/users/1486848/shampoosham"}, "edited": false, "score": 0, "creation_date": 1541407297, "post_id": 53138741, "comment_id": 93192081, "body": "That&#39;s true. If it&#39;s possible, I&#39;d change the signature of <code>fromText</code> to <code>Text -&gt; Maybe a</code>. It makes sense because fromText is essentially a parser which is supposed to be able to fail (<code>Nothing</code> usually represents a failed operation)."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 1519, "user_id": 1486848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNtLf.jpg?s=128&g=1", "display_name": "ShamPooSham", "link": "https://stackoverflow.com/users/1486848/shampoosham"}, "edited": false, "score": 0, "creation_date": 1541408409, "post_id": 53138741, "comment_id": 93192618, "body": "Yes but then my <code>Empty</code> data constructor  from <code>TCPFile</code> type constructor would be useless right? I can remove that as well.I provided it for the case if the parser fails , wanting to not use <code>Maybe</code>"}, {"owner": {"reputation": 1519, "user_id": 1486848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KNtLf.jpg?s=128&g=1", "display_name": "ShamPooSham", "link": "https://stackoverflow.com/users/1486848/shampoosham"}, "edited": false, "score": 0, "creation_date": 1541409437, "post_id": 53138741, "comment_id": 93193084, "body": "I think I&#39;d remove it. It&#39;s better to make it clear in the <code>fromText</code> type declaration that it can fail, instead of relying that the type given to the instance that implements <code>TextEncode</code> (in this case <code>TCPFile</code>) has a constructor that represents failing."}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1541317527, "creation_date": 1541317527, "question_id": 53138741, "link": "https://stackoverflow.com/questions/53138741/could-not-match-type-with-maybe-b0", "title": "Could not match type with Maybe b0", "body": "<p>Hello i am encountering the following problem:\nI have defined a typeclass:</p>\n\n<p><strong>Typeclass</strong><br></p>\n\n<pre><code>class TextEncode  a where\n        toText::a-&gt;Text\n        fromText::Text-&gt;a\n</code></pre>\n\n<p>And i want to parse a <code>TCPFile</code>:</p>\n\n<pre><code>data TCPFile=Rfile (Maybe Readme) | Dfile  Samples | Empty \n</code></pre>\n\n<p>I will not show the <code>Samples</code> and <code>Readme</code> types because they do not matter in this case.I am trying to use the <code>fromText</code> method to get a <code>TCPFile</code>.</p>\n\n<p><strong>Types</strong></p>\n\n<pre><code>data FileData=FileData{ header::Header,rawContent::Text}\n\ndata Header=Header { ftype::Char}\n</code></pre>\n\n<p>The <code>FileData</code> is used to store the <code>Header</code> of the file and the content that will get parsed:</p>\n\n<p>I am using a <code>Functor</code> defined by me for chaining operations:</p>\n\n<pre><code>(&gt;&gt;?)::Maybe a-&gt;(a-&gt;Maybe b)-&gt;Maybe b\n    (Just t) &gt;&gt;? f=f t\n    Nothing &gt;&gt;? _=Nothing\n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>instance TextEncode TCPFile where\n        fromText txt = readHeader txt &gt;&gt;? (\\h -&gt; Just (FileData h txt)) &gt;&gt;? makeFile\n\n\n    readHeader::Text-&gt;Maybe Header\n    readHeader txt=case Data.Text.head txt of \n        'r' -&gt;Just (Header{ ftype='r'})\n        'd' -&gt;Just (Header {ftype ='d'})\n        _  -&gt;Nothing\n\n\n\n    makeFile::FileData-&gt;TCPFile\n    makeFile fd= case ftype.header $ fd of\n            'r'-&gt;Rfile (Just (fromText . rawContent $ fd))\n            'd'-&gt;Dfile (fromText . rawContent $ fd)\n            _  -&gt;Empty \n</code></pre>\n\n<p>I keep getting this error in <code>makeFile</code> method and i do not understand why.What i put inside <code>makeFile</code> is a <code>Maybe FileData</code>,that is unwrapped via <code>&gt;&gt;?</code>.So i provide a good input parameter and i output a <code>TCPFile</code> which matches the <code>TextEncode</code> <code>typeclass</code>.What is wrong here?</p>\n\n<p><strong>Error</strong></p>\n\n<pre><code>  TCPFile.hs:59:24: error:\n        * Couldn't match expected type `TCPFile'\n                      with actual type `Maybe b0'\n        * In the expression:\n            readHeader txt &gt;&gt;? (\\ h -&gt; Just (FileData h txt)) &gt;&gt;? makeFile\n          In an equation for `fromText':\n              fromText txt\n                = readHeader txt &gt;&gt;? (\\ h -&gt; Just (FileData h txt)) &gt;&gt;? makeFile\n          In the instance declaration for `TextEncode TCPFile'\n       |\n    59 |         fromText txt = readHeader txt &gt;&gt;? (\\h -&gt; Just (FileData h txt)) &gt;&gt;? makeFile\n\n       |                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n^^^\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1541442930, "post_id": 53136919, "comment_id": 93210805, "body": "Just a guess, but the doc for <code>directory</code> gives an example: <code>directory &quot;foo&#47;bar.txt&quot; =&gt; &quot;foo&quot;</code>. If <code>nots</code> is getting passed the <code>web</code> directory, do you know if this is treated as a directory (the trailing slash is removed), or as a file (the <code>web</code> is removed and the comparison is done with the parent directory name)?"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1541443144, "post_id": 53136919, "comment_id": 93210872, "body": "Oh, actually, I think you need to use <code>&amp;&amp;</code> instead of <code>||</code> in your <code>nots</code> definition. Right now <code>web</code> is passing <code>notIsSuffixOf &quot;stack-work&quot; d</code>, which is causing it to pass the filter, and vice versa."}], "owner": {"reputation": 252, "user_id": 3230177, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/PN2aL.jpg?s=128&g=1", "display_name": "mat4nier", "link": "https://stackoverflow.com/users/3230177/mat4nier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1541305961, "creation_date": 1541293662, "last_edit_date": 1541305961, "question_id": 53136919, "link": "https://stackoverflow.com/questions/53136919/haskell-filemanip-find-ignoring-directories-when-recursively-searching-not-w", "title": "Haskell - fileManip find - ignoring directories when recursively searching not working", "body": "<p>I'm trying to use the <code>FilePath.Find</code> function from FileManip to ignore recursion on certain directories.</p>\n\n<p>E.g. I want to ignore directories ending in test, or ignore .git, etc.</p>\n\n<p>Example: give me all files not in the stack-work dir or the web dir </p>\n\n<pre><code>import System.Directory\nimport System.Environment\nimport System.FilePath.Find\nimport System.FilePath.GlobPattern\nimport qualified Data.List as L\nimport Control.Monad\n\nnotIsSuffixOf :: [Char] -&gt; [Char] -&gt; Bool\nnotIsSuffixOf a b = not (L.isSuffixOf a b)\n\nnots :: FindClause Bool\nnots = (\\d -&gt; notIsSuffixOf \"web\" d || notIsSuffixOf \"stack-work\" d) `liftM` directory\n\nfindAllNots :: FilePath -&gt; IO [FilePath]\nfindAllNots path = find nots (fileType ==? RegularFile) path\n</code></pre>\n\n<p>But it's definitely not ignoring the web or stack-work directories.  I've been wracking my brain on this but can't seem to figure it out. Doing them in isolation doesn't seem to work reliably either (doing just stack-work works, but <code>\"web\"</code> still matches <code>/blah/web/jds.txt</code> for example.</p>\n\n<p>If I change it to <code>isSuffixOf</code> I match on nothing, which is also disconcerting.  Reading through <a href=\"http://hackage.haskell.org/package/filemanip-0.3.6.3/docs/System-FilePath-Find.html\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/filemanip-0.3.6.3/docs/System-FilePath-Find.html</a> indicates that this should work, see top example where <code>(isInfixOf \"temp\") `liftM` directory</code> matches any directory with <code>temp</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1541289375, "post_id": 53136545, "comment_id": 93166241, "body": "To clarify, do you want the sublists sorted first by length and then by lexicographic ordering, or just by length (or by length and sum)? Your above example is ambiguous in this respect."}, {"owner": {"reputation": 19, "user_id": 10402123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wGR9YJDqyhU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DU5haz4tEpUhpFOhnBMSfRky6wf2g/mo/photo.jpg?sz=128", "display_name": "shubham", "link": "https://stackoverflow.com/users/10402123/shubham"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1541289639, "post_id": 53136545, "comment_id": 93166299, "body": "@hnefatl first it should be sorted by number of elements in an sublist (ascending order), and then by total sum of elements in sublists (ascending order). <code>[[4],[1,2],[2,3],[1,2,3],[2,3,1],[1,2,5,4]]</code> like this"}, {"owner": {"reputation": 19, "user_id": 10402123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wGR9YJDqyhU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DU5haz4tEpUhpFOhnBMSfRky6wf2g/mo/photo.jpg?sz=128", "display_name": "shubham", "link": "https://stackoverflow.com/users/10402123/shubham"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1541290136, "post_id": 53136545, "comment_id": 93166399, "body": "@hnefatl no, it only sorts the list with respect to the sum of elements present in the sublist....see the question, I have written both, what I want and what I get when using <code>sortOn sum . sortOn length</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1541293017, "post_id": 53136762, "comment_id": 93166821, "body": "Think it should be <code>sortOn sum</code> instead of <code>sort</code>: in the comments OP mentioned it should be sorted by list sum rather than lexicographic."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1541326542, "post_id": 53136762, "comment_id": 93171464, "body": "Possibly; didn&#39;t quite understand the question. But it should be obvious how to generalise that, the crucial point is about stability."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1541291642, "creation_date": 1541291642, "answer_id": 53136762, "question_id": 53136545, "link": "https://stackoverflow.com/questions/53136545/haskell-function-which-sorts-a-list-of-integer-lists-according-to-the-length-of/53136762#53136762", "title": "Haskell function which sorts a list of integer lists according to the length of the sublists", "body": "<p><code>sort{[By,On]}</code> are stable sorts, so you can simply sort by the secondary critereon and then by the primary one.</p>\n\n<pre><code>&gt; :m +Data.List\n&gt; sortOn length $ sort [[1,2],[1,2,3],[2,3],[4],[1,2,5,4],[2,3,1]]\n[[4],[1,2],[2,3],[1,2,3],[2,3,1],[1,2,5,4]]\n</code></pre>\n\n<p>If it is already sorted lexicographically, then simply <code>sortOn length</code> alone will do.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541326458, "post_id": 53137376, "comment_id": 93171436, "body": "That&#39;s really beautiful. It could use some explanation though... my go, the idea is to build <i>tuples</i> of length and sum. The tuple <code>Ord</code> instance sorts by the <i>tuple</i> elements lexicographically, i.e. <code>length</code> has priority."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 3, "last_activity_date": 1541300270, "creation_date": 1541300270, "answer_id": 53137376, "question_id": 53136545, "link": "https://stackoverflow.com/questions/53136545/haskell-function-which-sorts-a-list-of-integer-lists-according-to-the-length-of/53137376#53137376", "title": "Haskell function which sorts a list of integer lists according to the length of the sublists", "body": "<p>with one <code>sort</code></p>\n\n<pre><code>&gt; sortOn (length &amp;&amp;&amp; sum)\n</code></pre>\n\n<p><code>&amp;&amp;&amp;</code> is from Control.Arrow</p>\n"}], "owner": {"reputation": 19, "user_id": 10402123, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-wGR9YJDqyhU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DU5haz4tEpUhpFOhnBMSfRky6wf2g/mo/photo.jpg?sz=128", "display_name": "shubham", "link": "https://stackoverflow.com/users/10402123/shubham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1541300270, "creation_date": 1541288997, "question_id": 53136545, "link": "https://stackoverflow.com/questions/53136545/haskell-function-which-sorts-a-list-of-integer-lists-according-to-the-length-of", "title": "Haskell function which sorts a list of integer lists according to the length of the sublists", "body": "<p>I have a list:</p>\n\n<pre><code>[[1,2],[1,2,3],[2,3],[4],[1,2,5,4],[2,3,1]]\n</code></pre>\n\n<p>I want to sort this list in ascending order and length with respect to sublists</p>\n\n<p>like this:</p>\n\n<pre><code>[[4],[1,2],[2,3],[1,2,3],[2,3,1],[1,2,5,4]]\n</code></pre>\n\n<p>I found one solution, but that is not what I want</p>\n\n<p>I found this function:</p>\n\n<pre><code>import Data.List\n\ndoubleSort :: (Ord a, Num a) =&gt; [[a]] -&gt; [[a]]\ndoubleSort = sortOn sum . map sort\n</code></pre>\n\n<p>But this sorts the list in a way which I dont want:</p>\n\n<pre><code>[[1,2],[4],[2,3],[1,2,3],[1,2,3],[1,2,4,5]]\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "template-haskell"], "comments": [{"owner": {"reputation": 436, "user_id": 7642575, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yy1r5.jpg?s=128&g=1", "display_name": "Strong will", "link": "https://stackoverflow.com/users/7642575/strong-will"}, "edited": false, "score": 2, "creation_date": 1541284643, "post_id": 53135728, "comment_id": 93165360, "body": "I think it is caused by GHC rather then by Cabal. If I am not wrong, Cabal executes GHC on any modified file. This means only GHC truly knows if significant changes have been made to the file, Cabal is not a compiler and so it doesn&#39;t know any better then to check the &quot;modified&quot; flag on the filesystem. I would guess there is some enforced recompilation rule for TH code in GHC. Will try to find something more."}], "answers": [{"comments": [{"owner": {"reputation": 12250, "user_id": 2425163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05f4000597865eeaf51c32ed5694479c?s=128&d=identicon&r=PG", "display_name": "tarleb", "link": "https://stackoverflow.com/users/2425163/tarleb"}, "edited": false, "score": 0, "creation_date": 1541365383, "post_id": 53143607, "comment_id": 93182128, "body": "Interesting, thank you. However, the issue persists when using stack to build. I thought stack is using cabal under the hood, is that wrong?"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 12250, "user_id": 2425163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05f4000597865eeaf51c32ed5694479c?s=128&d=identicon&r=PG", "display_name": "tarleb", "link": "https://stackoverflow.com/users/2425163/tarleb"}, "edited": false, "score": 0, "creation_date": 1541394734, "post_id": 53143607, "comment_id": 93187902, "body": "I haven&#39;t seen a description of a problem in this question, I thought you were just asking for information."}, {"owner": {"reputation": 12250, "user_id": 2425163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05f4000597865eeaf51c32ed5694479c?s=128&d=identicon&r=PG", "display_name": "tarleb", "link": "https://stackoverflow.com/users/2425163/tarleb"}, "edited": false, "score": 0, "creation_date": 1541397461, "post_id": 53143607, "comment_id": 93188594, "body": "You are right, the issue got a bit hidden. The problem is that TH files get recompiled needlessly sometimes, thereby slowing down the re-build. But I&#39;d indeed already be happy to understand what exactly is happening."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 12250, "user_id": 2425163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05f4000597865eeaf51c32ed5694479c?s=128&d=identicon&r=PG", "display_name": "tarleb", "link": "https://stackoverflow.com/users/2425163/tarleb"}, "edited": false, "score": 2, "creation_date": 1541398424, "post_id": 53143607, "comment_id": 93188878, "body": "Doesn&#39;t sound needless to me. It seems like you&#39;ve determined that, semantically, these two versions of the file are the same (with or without a newline). However, that&#39;s not always the case; the <code>file-embed</code> library would generate two different <code>ByteString</code>s. There&#39;s no way for GHC, Cabal, Stack, or any other build tool I can think of to determine what is or is not a semantically meaningful change, and therefore <i>must</i> recompile in all cases."}, {"owner": {"reputation": 12250, "user_id": 2425163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05f4000597865eeaf51c32ed5694479c?s=128&d=identicon&r=PG", "display_name": "tarleb", "link": "https://stackoverflow.com/users/2425163/tarleb"}, "edited": false, "score": 0, "creation_date": 1541398752, "post_id": 53143607, "comment_id": 93188956, "body": "Ah, that makes sense! Thank you for clarifying!"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1541353243, "creation_date": 1541353243, "answer_id": 53143607, "question_id": 53135728, "link": "https://stackoverflow.com/questions/53135728/when-does-cabal-recompile-a-module-which-contains-template-haskell/53143607#53143607", "title": "When does cabal recompile a module which contains Template Haskell?", "body": "<p>There's a feature in Template Haskell called <code>addDependentFile</code>, which adds metadata to the <code>.hi</code> file indicating that the source file in question depends on another file as well. To my knowledge, Cabal will <em>always</em> ask GHC to try to build, though it may have more intelligent logic. Stack tries to bypass that process, and has logic to parse the <code>addDependentFile</code> information out.</p>\n"}], "owner": {"reputation": 12250, "user_id": 2425163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05f4000597865eeaf51c32ed5694479c?s=128&d=identicon&r=PG", "display_name": "tarleb", "link": "https://stackoverflow.com/users/2425163/tarleb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 53143607, "answer_count": 1, "score": 6, "last_activity_date": 1541353243, "creation_date": 1541281034, "last_edit_date": 1541282506, "question_id": 53135728, "link": "https://stackoverflow.com/questions/53135728/when-does-cabal-recompile-a-module-which-contains-template-haskell", "title": "When does cabal recompile a module which contains Template Haskell?", "body": "<p>I understand that cabal will recompile a module if the interface of any of its dependencies has changed. It seems that this simple rule does not hold if the module contains Template Haskell. In that case, even just adding a trailing newline character to a file in the module's (transitive) dependencies will cause the cabal to recompile the file.</p>\n\n<p>Minimal example:</p>\n\n<p><strong>file: Foo.hs</strong></p>\n\n<pre><code>module Foo where\nfoo = \"foo\"\n</code></pre>\n\n<p><strong>file: FooTH.hs</strong></p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nmodule FooTH where\nimport Data.Bifunctor.TH\nimport Foo\n\ndata FooPair a b = FooPair a b\n$(deriveBifunctor ''FooPair)\n</code></pre>\n\n<p><strong>file: MCVE.cabal</strong></p>\n\n<pre><code>name:                MCVE\nversion:             0.1.0.0\nsynopsis:            MCVE\nlicense:             MIT\nlicense-file:        LICENSE\nauthor:              tarleb\nmaintainer:          tarleb@example.com\nbuild-type:          Simple\nextra-source-files:  CHANGELOG.md\ncabal-version:       &gt;=1.10\n\nlibrary\n  exposed-modules:     Foo\n                     , FooTH\n  build-depends:       base &gt;=4.8 &amp;&amp; &lt;4.13\n                     , bifunctors\n  default-language:    Haskell2010\n</code></pre>\n\n<p>Adding a newline to Foo.hs, e.g. by running <code>echo \"\\n\" &gt;&gt; Foo.hs</code>, will cause recompilation of module FooTH. This ceases to happen if the TH line in FooTH is commented out.</p>\n\n<p>What is the reason for this, and is there a way to avoid this unnecessary recompilation?</p>\n"}, {"tags": ["git", "haskell", "nix", "hydra"], "answers": [{"comments": [{"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 1, "creation_date": 1551717284, "post_id": 53182600, "comment_id": 96732926, "body": "Hm, I&#39;d like to figure out how to do this without re-building Hydra. I tried adding <code>extraEnv = { NIX_PREFETCH_GIT_LEAVE_DOT_GIT = &quot;1&quot;; };</code> but that didn&#39;t seem to work."}], "tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": true, "score": 2, "last_activity_date": 1541555182, "creation_date": 1541555182, "answer_id": 53182600, "question_id": 53134477, "link": "https://stackoverflow.com/questions/53134477/is-it-possible-to-get-the-current-git-sha-when-building-a-nix-project-with-hydra/53182600#53182600", "title": "Is it possible to get the current git SHA when building a Nix project with Hydra?", "body": "<p>By default Hydra will delete the <code>.git</code> folder, preventing you from reading the git SHA. You can tell it not to do this by setting the <code>NIX_PREFETCH_GIT_LEAVE_DOT_GIT</code> to <code>\"1\"</code>.</p>\n\n<p>If you are building Hydra using the release.nix file in its repo, you would add <code>--set NIX_PREFETCH_GIT_LEAVE_DOT_GIT \"1\"</code> after the other <code>--set</code>s in the file: <a href=\"https://github.com/NixOS/hydra/blob/1c44de1779d0e315615b072049fb2d2ce333fb32/release.nix#L155-L157\" rel=\"nofollow noreferrer\">https://github.com/NixOS/hydra/blob/1c44de1779d0e315615b072049fb2d2ce333fb32/release.nix#L155-L157</a></p>\n"}], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 1, "accepted_answer_id": 53182600, "answer_count": 1, "score": 3, "last_activity_date": 1541555182, "creation_date": 1541271212, "last_edit_date": 1541272779, "question_id": 53134477, "link": "https://stackoverflow.com/questions/53134477/is-it-possible-to-get-the-current-git-sha-when-building-a-nix-project-with-hydra", "title": "Is it possible to get the current git SHA when building a Nix project with Hydra?", "body": "<p>I'm building a Haskell project with Nix, with CI done by a Hydra server. One thing I would like to do is embed the git SHA in the application itself, that way the SHA can be included in our exception reports and as a header in HTTP responses (to check that the latest server is running).</p>\n\n<p>It's easy to pull the SHA from the <code>.git</code> directory in my dev environment using a package like <a href=\"https://hackage.haskell.org/package/gitrev\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/gitrev</a>, but it appears that Hydra doesn't have that directory present after cloning (I added some Template Haskell logging that confirmed that <code>doesDirectoryExist &lt;PWD&gt;.git</code> is false).</p>\n\n<p>Is there a way to get the git SHA from Hydra somehow? Either by including the git directory so I can get the SHA myself, or some other way?</p>\n\n<p>Hydra version: SNAPSHOT-b11789f39993c614e53da39c29711b63cd266291 (using nix-2.0.4)</p>\n\n<p>Edit: I also sshed into the worker server and confirmed there is no <code>.git</code> directory present where the build is being done:</p>\n\n<pre><code>[maximiliantagher@ip-10-0-2-46:/tmp]$ sudo ls -a nix-build-mercury-web-backend-0.0.0.drv-0/szjq4m1zklbydw7wrz7dbbxl9ndw0d0f-source\n.     app     db          Dockerfile  Gemfile.lock  .ghcid   Makefile           one-off-task  README.md    shell.nix    stack.yaml\n..    config  .dir-locals.el  docs        gemset.nix    .gitignore   mercury-web-backend.cabal  package.yaml  release.nix  sql-scripts  templates\nAPI-Spec  data    dist        Gemfile     .ghci     .hlint.yaml  .nix               Rakefile      Setup        src      test\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "nix", "hydra"], "answers": [{"tags": [], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "is_accepted": false, "score": 1, "last_activity_date": 1541554525, "last_edit_date": 1541554525, "creation_date": 1541269553, "answer_id": 53134265, "question_id": 53134264, "link": "https://stackoverflow.com/questions/53134264/how-can-i-stream-test-output-when-building-a-haskell-package-with-nix/53134265#53134265", "title": "How can I stream test output when building a Haskell package with Nix?", "body": "<p>Edit: The <code>cabal new-run test:test</code> part is incorrect. I'm looking into how to get Nix's Haskell builder to stream test results.</p>\n\n<p>You can override the <code>checkPhase</code> in Nix to accomplish this. You can see it defined here: <a href=\"https://github.com/NixOS/nixpkgs/blob/32340793aafec24dcef95fee46a21e634dd63457/pkgs/development/haskell-modules/generic-builder.nix#L357-L361\" rel=\"nofollow noreferrer\">https://github.com/NixOS/nixpkgs/blob/32340793aafec24dcef95fee46a21e634dd63457/pkgs/development/haskell-modules/generic-builder.nix#L357-L361</a></p>\n\n<p>This <code>checkPhase</code> should work:</p>\n\n<pre><code>checkPhase = ''\n  runHook preCheck\n  cabal new-run test:test\n  runHook postCheck\n'';\n</code></pre>\n"}], "owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541554525, "creation_date": 1541269553, "question_id": 53134264, "link": "https://stackoverflow.com/questions/53134264/how-can-i-stream-test-output-when-building-a-haskell-package-with-nix", "title": "How can I stream test output when building a Haskell package with Nix?", "body": "<p>I have a project built with Nix on Hydra. When the tests are run for it, it prints the logs to a file, which makes them hard to view from a CI server. Is there a way I can make the project print stdout/err as the test suite runs? This is what I currently get:</p>\n\n<pre><code>Running 1 test suites...\nTest suite test: RUNNING...\nTest suite test: FAIL\nTest suite logged to: dist/test/project-name-0.0.0-test.log\n0 of 1 test suites (0 of 1 test cases) passed.\n</code></pre>\n"}, {"tags": ["loops", "haskell", "input", "getline"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1541246486, "post_id": 53131043, "comment_id": 93155799, "body": "What is <code>z:input</code> supposed to do?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1541249531, "post_id": 53131043, "comment_id": 93156555, "body": "@melpomene At a guess: put on your mutable-language-hat and think of it as a typo for <code>input = z:input</code>."}, {"owner": {"reputation": 263, "user_id": 8951449, "user_type": "registered", "profile_image": "https://graph.facebook.com/511247505901446/picture?type=large", "display_name": "kaiya", "link": "https://stackoverflow.com/users/8951449/kaiya"}, "edited": false, "score": 0, "creation_date": 1541262152, "post_id": 53131043, "comment_id": 93159748, "body": "right, that was a typo I didn&#39;t notice"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1541249447, "creation_date": 1541249447, "answer_id": 53131488, "question_id": 53131043, "link": "https://stackoverflow.com/questions/53131043/read-n-lines-input-with-haskell/53131488#53131488", "title": "Read n lines input with Haskell", "body": "<p>Haskell is immutable: once you write</p>\n\n<pre><code>input = []\n</code></pre>\n\n<p>then <code>input</code> is <code>[]</code> forever and ever, amen. You could use the same technique you used for having a \"changing\" value of <code>n</code> to have a \"changing\" value of <code>input</code>, that is, pass it as an argument to <code>readString</code>:</p>\n\n<pre><code>readString 0 input = return input\nreadString n input = do\n  z &lt;- getLine\n  readString (n-1) (z:input)\n</code></pre>\n\n<p>If you do this, you will discover that the lines you input get put into <code>input</code> starting from the end -- so they come out in reverse order! (If your code snippet had worked, it would also have behaved this way.) One easy fix would be to change the base case:</p>\n\n<pre><code>readString 0 input = return (reverse input)\n</code></pre>\n\n<p>A more idiomatic fix would be to do away with the argument entirely, simply returning things in the right order in the first place:</p>\n\n<pre><code>readString 0 = return []\nreadString n = do\n  z &lt;- getLine\n  zs &lt;- readString (n-1)\n  return (z:zs)\n</code></pre>\n\n<p>As you get comfortable with the standard library, you might first graduate to</p>\n\n<pre><code>readString 0 = return []\nreadString n = liftA2 (:) getLine (readString (n-1))\n</code></pre>\n\n<p>and then to skipping the definition of <code>readString</code> entirely in favor of rewriting <code>main</code>:</p>\n\n<pre><code>main = do\n  n &lt;- readLn\n  replicateM n getLine\n</code></pre>\n"}], "owner": {"reputation": 263, "user_id": 8951449, "user_type": "registered", "profile_image": "https://graph.facebook.com/511247505901446/picture?type=large", "display_name": "kaiya", "link": "https://stackoverflow.com/users/8951449/kaiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 2, "accepted_answer_id": 53131488, "answer_count": 1, "score": 0, "last_activity_date": 1541249447, "creation_date": 1541245934, "question_id": 53131043, "link": "https://stackoverflow.com/questions/53131043/read-n-lines-input-with-haskell", "title": "Read n lines input with Haskell", "body": "<p>I am trying to learn to write Haskell programs.\nI am failing to read n lines input.</p>\n\n<p>The input is </p>\n\n<p>n</p>\n\n<p>a b (&lt;----- n times)</p>\n\n<p>where n, a, b are numbers.</p>\n\n<p>I tried</p>\n\n<pre><code>input = []\n\nreadString 0 = return()\nreadString n =\n do\n  z &lt;- getLine\n  z:input\n  readString (n-1)\n\nmain = do\n n &lt;- getLine\n readString n\n</code></pre>\n\n<p>which throws errors. How do I looped read correctly in Haskell?</p>\n"}, {"tags": ["haskell", "recursion", "tail-recursion"], "comments": [{"owner": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "edited": false, "score": 0, "creation_date": 1541224669, "post_id": 53128763, "comment_id": 93151832, "body": "<code>sum (x:xs) = aux xs x</code>  where <code>aux (x:xs) total = aux xs (x + total)</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1541226464, "post_id": 53128763, "comment_id": 93152114, "body": "For the recursion to be tail recursion, you need your cases to be similar to <code>tailRecursiveFunction something = tailRecursiveFunction somethingElse</code>."}], "answers": [{"comments": [{"owner": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "edited": false, "score": 0, "creation_date": 1541234945, "post_id": 53129730, "comment_id": 93153433, "body": "You can start with <code>sum (x:xs) = g x xs</code> immediately to avoid <code>0 + ...</code>. (Which only works because <code>(+) 0</code> is essentially <code>id</code> for numeric types.)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "edited": false, "score": 1, "creation_date": 1541234970, "post_id": 53129730, "comment_id": 93153436, "body": "but then I have to handle the <code>[]</code> case separately. With the explicit <code>0</code>. It&#39;s unavoidable."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1541264305, "post_id": 53129730, "comment_id": 93160317, "body": "What do you mean by the last one (of the first code block) being in tail recursive form?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1541270202, "post_id": 53129730, "comment_id": 93162003, "body": "@DavidYoung in <code>g x (y:xs) = g (x+y) xs</code>, call to <code>g</code> is a tail call."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 1, "last_activity_date": 1541234544, "creation_date": 1541234544, "answer_id": 53129730, "question_id": 53128763, "link": "https://stackoverflow.com/questions/53128763/implementing-tail-recursion/53129730#53129730", "title": "Implementing tail recursion", "body": "<p>Playing with it for a bit,</p>\n\n<pre><code>sum (x:y:xs) = x + sum (y:xs)\n             = x + (y + sum xs)\n             = (x + y) + sum xs\n\ng a b = a + sum b\n\nsum (x:y:xs) = g x (y:xs)\n             = x + g y xs\n             = g (x+y) xs   -- !!!\n</code></pre>\n\n<p>the last one is in tail recursive form! We thus just define</p>\n\n<pre><code>sum xs = g 0 xs\n  where\n  g acc [] = ...\n  g acc (x:xs) = g (acc + ...) ...\n</code></pre>\n\n<p>Fill in the blanks!</p>\n"}], "owner": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 53129730, "answer_count": 1, "score": 1, "last_activity_date": 1541234544, "creation_date": 1541223949, "last_edit_date": 1541233594, "question_id": 53128763, "link": "https://stackoverflow.com/questions/53128763/implementing-tail-recursion", "title": "Implementing tail recursion", "body": "<p>I've written a simple function in haskell that is non tail recursive that sums up the values inside a list where:</p>\n\n<pre><code>nonTailRecursiveSum :: [Integer] -&gt; Integer\nnonTailRecursiveSum [] = 0 --base case\nnonTailRecursiveSum (x:xs) = x + sum xs\n</code></pre>\n\n<p>But what I'm trying to do now is to implement the same function but using tail recursion. For what i know, tail recursion performs the recursive call at the final step so i tried something like:</p>\n\n<pre><code>tailRecursiveSum :: [Integer] -&gt; Integer\ntailRecursiveSum [] = 0\ntailRecursiveSum (x:xs) = aux_f(x) + tailRecursiveSum xs\n.\n.\n</code></pre>\n\n<p>But i got lost in the midway as I'm not familiar with tail recursion in Haskell. Could anyone assist me on the continuation of the tail recursive version of the code?</p>\n"}, {"tags": ["haskell", "haskell-persistent"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1541231335, "post_id": 53128523, "comment_id": 93152846, "body": "When you get error 500, you should also see some error message on the console."}], "answers": [{"tags": [], "owner": {"reputation": 383, "user_id": 5181829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LQG85.jpg?s=128&g=1", "display_name": "Marronnier", "link": "https://stackoverflow.com/users/5181829/marronnier"}, "is_accepted": false, "score": 0, "last_activity_date": 1541231297, "creation_date": 1541231297, "answer_id": 53129454, "question_id": 53128523, "link": "https://stackoverflow.com/questions/53128523/haskells-persistent-sometmes-returns-500-internal-server-error/53129454#53129454", "title": "Haskell&#39;s Persistent sometmes returns 500 Internal Server Error", "body": "<p>Oops. I missed that <a href=\"https://www.stackage.org/haddock/lts-12.16/persistent-sqlite-2.8.2/Database-Persist-Sqlite.html#v:withSqlitePool\" rel=\"nofollow noreferrer\"><code>withSqlitePool</code> should not be used with :memory:</a>. By giving it a file name, the problem fixes.</p>\n"}], "owner": {"reputation": 383, "user_id": 5181829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LQG85.jpg?s=128&g=1", "display_name": "Marronnier", "link": "https://stackoverflow.com/users/5181829/marronnier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541231297, "creation_date": 1541220884, "question_id": 53128523, "link": "https://stackoverflow.com/questions/53128523/haskells-persistent-sometmes-returns-500-internal-server-error", "title": "Haskell&#39;s Persistent sometmes returns 500 Internal Server Error", "body": "<p>The following code launches a web server at localhost:3000.</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack script --resolver=lts-12.16\n\n{-# LANGUAGE EmptyDataDecls             #-}\n{-# LANGUAGE FlexibleContexts           #-}\n{-# LANGUAGE GADTs                      #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE MultiParamTypeClasses      #-}\n{-# LANGUAGE OverloadedStrings          #-}\n{-# LANGUAGE QuasiQuotes                #-}\n{-# LANGUAGE TemplateHaskell            #-}\n{-# LANGUAGE TypeFamilies               #-}\n{-# LANGUAGE ViewPatterns               #-}\nimport Yesod\nimport Database.Persist.Sqlite\nimport Control.Monad.Trans.Resource (runResourceT)\nimport Control.Monad.Logger (runStderrLoggingT)\nimport Data.Text\n\n-- Define our entities as usual\nshare [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nBook\n    title Text\n    author Text\n    publisher Text\n    date Text\n    price Int\n    deriving Show\n|]\n\n-- We keep our connection pool in the foundation. At program initialization, we\n-- create our initial pool, and each time we need to perform an action we check\n-- out a single connection from the pool.\ndata SQLi = SQLi ConnectionPool\n\n-- We'll create a single route, to access a person. It's a very common\n-- occurrence to use an Id type in routes.\nmkYesod \"SQLi\" [parseRoutes|\n/ HomeR GET\n/book/#BookId BookR GET\n|]\n\n-- Nothing special here\ninstance Yesod SQLi\n\n-- Now we need to define a YesodPersist instance, which will keep track of\n-- which backend we're using and how to run an action.\ninstance YesodPersist SQLi where\n    type YesodPersistBackend SQLi = SqlBackend\n\n    runDB action = do\n        SQLi pool &lt;- getYesod\n        runSqlPool action pool\n\nsearchFrame :: [Entity Book] -&gt; Widget\nsearchFrame books = \n  [whamlet|\n    &lt;table border=1&gt;\n      &lt;tr&gt;\n        &lt;th&gt;ID\n        &lt;th&gt;Title\n        &lt;th&gt;Author\n        &lt;th&gt;Publisher\n        &lt;th&gt;Publication date\n        &lt;th&gt;Price\n      $forall Entity bookid book &lt;- books\n        &lt;tr&gt;\n          &lt;td&gt;\n            &lt;a href=@{BookR bookid}&gt;#{show bookid}\n          &lt;td&gt;\n            #{bookTitle book}\n          &lt;td&gt;\n            #{bookAuthor book}\n          &lt;td&gt;\n            #{bookPublisher book}\n          &lt;td&gt;\n            #{bookDate book}\n          &lt;td&gt;\n            #{bookPrice book}\n  |]\n\n-- List all people in the database\ngetHomeR :: Handler Html\ngetHomeR = do\n  mBookAuthor &lt;- lookupGetParam \"author\"\n  maybe (do\n    books &lt;- runDB $ selectList [] [Asc BookId]\n    defaultLayout $ searchFrame books)\n    (\u00a5author -&gt; do\n       books &lt;- runDB $ selectList [BookAuthor ==. author] [Asc BookId]\n\n       defaultLayout $ [whamlet|\n         &lt;h1&gt;Search books manually\n         ^{searchFrame books}\n       |]) $ mBookAuthor\n\n-- We'll just return the show value of a person, or a 404 if the Person doesn't\n-- exist.\ngetBookR :: BookId -&gt; Handler String\ngetBookR bookId = do\n    book &lt;- runDB $ get404 bookId\n    return $ show book\n\nopenConnectionCount :: Int\nopenConnectionCount = 10\n\nmain :: IO ()\nmain = runStderrLoggingT $ withSqlitePool \":memory:\" openConnectionCount $ \u00a5pool -&gt; liftIO $ do\n    runResourceT $ flip runSqlPool pool $ do\n        runMigration migrateAll\n        insert $ Book \"A Midsummer Night's Dream\" \"Shakespeare\" \"A bookstore\"   \"1979/01\" 600\n        insert $ Book \"Hamlet\"    \"Shakespeare\" \"B bookstore\"   \"1997/04\" 1260\n        insert $ Book \"Macbeth\"   \"Shakespeare\" \"C bookstore\"   \"2001/05\" 1530\n        insert $ Book \"King Lear\"     \"Shakespeare\" \"D bookstore\" \"2004/07\" 1890\n    warp 3000 $ SQLi pool\n</code></pre>\n\n<p>Then, loading <a href=\"http://localhost:3000/?author=&#39;%20AND%20EXTRACTVALUE(0,%20(SELECT%20CONCAT(&#39;$&#39;,%20id,%20&#39;:&#39;,%20pwd)%20FROM%20users%20LIMIT%200,%201))%20#\" rel=\"nofollow noreferrer\">http://localhost:3000/?author=' AND EXTRACTVALUE(0, (SELECT CONCAT('$', id, ':', pwd) FROM users LIMIT 0, 1)) #</a> sometimes results 500 Internal Server Error and this error message is issued even if we load normal pages such as <a href=\"http://localhost:3000/\" rel=\"nofollow noreferrer\">http://localhost:3000/</a></p>\n\n<p>Actually, this could be an attack vector for SQL injection. So, I'm confused with weather this is caused by an attack, or something else. Can someone explain this behavior?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 2, "creation_date": 1541202521, "post_id": 53127048, "comment_id": 93148843, "body": "Since you don&#39;t know <code>f</code> but know how <code>map</code> works, consider just applying the equations for <code>map</code> while keeping the application of <code>f</code> as it is. For example, I can rewrite <code>map f [0]</code> as <code>[f 0]</code>. Successive applications of this rule can get you almost to the solution."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 8037821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f819743e5ac5bbddd5b234dbea73abb0?s=128&d=identicon&r=PG&f=1", "display_name": "ktii", "link": "https://stackoverflow.com/users/8037821/ktii"}, "edited": false, "score": 0, "creation_date": 1541207250, "post_id": 53127164, "comment_id": 93149571, "body": "f = x+2 is my initial thought now but as map is applied 2 times, then my idea breaks again. Got me through the first map and tail though. Still blind about something here.."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1541203347, "creation_date": 1541203347, "answer_id": 53127164, "question_id": 53127048, "link": "https://stackoverflow.com/questions/53127048/find-haskell-function-if-given-a-result-output/53127164#53127164", "title": "Find Haskell function if given a result output", "body": "<p>You can continue your own computation:</p>\n\n<pre><code>g f xs \n= map f (tail (map f [10,8,6,4,2]))\n= map f (tail [f 10,f 8,f 6,f 4,f 2])\n= map f [f 8,f 6,f 4,f 2]\n= [f (f 8),f (f 6),f (f 4),f (f 2)]\n</code></pre>\n\n<p>Can you now see how to find <code>f</code> such that</p>\n\n<pre><code>[f (f 8),f (f 6),f (f 4),f (f 2)] = [10,8,6,4]\n</code></pre>\n\n<p>?</p>\n"}], "owner": {"reputation": 55, "user_id": 8037821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f819743e5ac5bbddd5b234dbea73abb0?s=128&d=identicon&r=PG&f=1", "display_name": "ktii", "link": "https://stackoverflow.com/users/8037821/ktii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 53127164, "answer_count": 1, "score": 1, "last_activity_date": 1541209154, "creation_date": 1541202132, "last_edit_date": 1541209154, "question_id": 53127048, "link": "https://stackoverflow.com/questions/53127048/find-haskell-function-if-given-a-result-output", "title": "Find Haskell function if given a result output", "body": "<p>I am trying to solve a beginner problem but can't reach the solution:</p>\n\n<p>Find function <code>f</code> where <code>g f [10,8,6,4,2] == [10,8,6,4]</code>\nand</p>\n\n<pre><code>g :: (Int -&gt; Int) -&gt; [Int] -&gt; [Int]\ng f xs = map f (tail (map f xs))\n</code></pre>\n\n<p>How to solve it step by step to develop the right way of thinking?</p>\n\n<p>For solution, my first thought was <code>reverse</code> but discarding it immediately as <code>map</code> cannot apply <code>reverse</code> to each element of the list, it seems nonsense. Next I try to think like this:</p>\n\n<pre><code>g f xs = map f (tail (map f xs)) == \ng f xs = map f (tail (map f [10,8,6,4,2])) == \n</code></pre>\n\n<p>and now I get stuck as I don't see the solution immediately what to apply to each element of this list to get out something that, when <code>tail</code> is applied, gives me out something that I can use again for this unknown function and then get out the input list but without <code>2</code> in the end. Please kindly help, I feel stupidly stuck. </p>\n"}, {"tags": ["haskell", "recursion-schemes"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 3, "last_activity_date": 1552612020, "last_edit_date": 1552612020, "creation_date": 1541221387, "answer_id": 53128553, "question_id": 53126614, "link": "https://stackoverflow.com/questions/53126614/histomorphism-a-la-mendler/53128553#53128553", "title": "Histomorphism a la Mendler", "body": "<p>This is it:</p>\n\n<pre><code>modds :: Fix (ListF a) -&gt; [a]\nmodds = mhisto alg\n    where\n    alg _ _ Nil = []\n    alg odd pre (Cons a b) = a : case pre b of\n        Nil -&gt; []\n        Cons _ b' -&gt; odd b' \n</code></pre>\n\n\n\n<pre><code>GHCi&gt; list = cata embed [1..10] :: Fix (ListF Int)\nGHCi&gt; odds (cata embed list)\n[1,3,5,7,9]\nGHCi&gt; modds list\n[1,3,5,7,9]\n</code></pre>\n\n<p><code>odd</code> folds the rest of the list, while <code>pre</code> digs the predecessor. Note how the availability of an <code>y -&gt; f y</code> function in the Mendler algebra mirrors the introduction of <code>Cofree</code> in the ordinary histomorphism algebra (in which digging back can be done by reaching for the tail of the <code>Cofree</code> stream):</p>\n\n<pre><code>cata  :: Functor f =&gt; (f c -&gt; c) -&gt; Fix f -&gt; c\nhisto :: Functor f =&gt; (f (Cofree f c) -&gt; c) -&gt; Fix f -&gt; c\n\nmcata  :: (forall y. (y -&gt; c) -&gt; f y -&gt; c) -&gt; Fix f -&gt; c\nmhisto :: (forall y. (y -&gt; c) -&gt; (y -&gt; f y) -&gt; f y -&gt; c) -&gt; Fix f -&gt; c \n</code></pre>\n\n<p>For further reading on <code>mcata</code> and <code>mhisto</code>, see chapters 5 and 6 of <a href=\"https://kodu.ut.ee/~varmo/papers/thesis.pdf\" rel=\"nofollow noreferrer\"><em>Categorical programming with inductive and coinductive types</em>, by Varmo Vene</a>.</p>\n"}], "owner": {"reputation": 249, "user_id": 4643591, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206103105435558/picture?type=large", "display_name": "Marius Catalin", "link": "https://stackoverflow.com/users/4643591/marius-catalin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1552612020, "creation_date": 1541198090, "last_edit_date": 1541221419, "question_id": 53126614, "link": "https://stackoverflow.com/questions/53126614/histomorphism-a-la-mendler", "title": "Histomorphism a la Mendler", "body": "<p>Using a histomorphism (<code>histo</code>) from <a href=\"http://hackage.haskell.org/package/recursion-schemes-5.0.3/docs/Data-Functor-Foldable.html\" rel=\"nofollow noreferrer\"><em>recursion-schemes</em></a> I can get the a list containing only the odd indexes from an initial list:</p>\n\n<pre><code>import Data.Functor.Foldable\n\nodds :: [a] -&gt; [a]\nodds = histo $ \\case\n  Nil                           -&gt; []\n  Cons h (_ :&lt; Nil)             -&gt; [h]\n  Cons h (_ :&lt; Cons _ (t :&lt; _)) -&gt; h:t\n</code></pre>\n\n<p>How can get the same thing using <code>mhisto</code>?  </p>\n\n<pre><code>nil      = Fix Nil\ncons a b = Fix $ Cons a b\nlist = cons 1 $ cons 2 $ cons 3 $ nil\n\nmodds :: Fix (ListF a) -&gt; [a]\nmodds = mhisto alg where\n   alg _ _ Nil = []\n   alg f g (Cons a b) = ?\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1541179447, "post_id": 53123008, "comment_id": 93141092, "body": "Are you familiar with how <code>[a]</code> is defined? It&#39;s a nested structure, like a Russian doll: the &quot;end&quot; of the list is better thought of as the center. If you wish to add a new smallest doll you&#39;ll need to unwrap every layer (an O(n) operation). Try implementing <code>++</code> for yourself"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1541180158, "post_id": 53123008, "comment_id": 93141423, "body": "&quot;It&#39;s expensive, and indicates you are building your list in the wrong order. There is usually a better approach&quot; part is very important. May be you should concentrate on how to create your <code>numbers</code> list in the reverse order first and then just do like <code>56  : numbers</code> for efficiency."}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 5, "last_activity_date": 1541178983, "creation_date": 1541178983, "answer_id": 53123130, "question_id": 53123008, "link": "https://stackoverflow.com/questions/53123008/correct-way-to-add-an-element-to-the-end-of-a-list/53123130#53123130", "title": "Correct way to add an element to the end of a list?", "body": "<p>It's the correct way in that all ways of doing it must reduce to at least that much work. The problem is wanting to append to the end of a list at all. That's not an operation that's possible to do efficiently with immutable linked lists.</p>\n\n<p>The better approach is figuring out how to solve your specific problem without doing that. There are a lot of potential approaches. Picking the right one depends on the details of what you're doing. Maybe you can get away with just using laziness correctly. Maybe you are best off generating the list backwards and then reversing it once at the end. Maybe you're best off using a different data structure. It all depends on your specific use case. </p>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 6, "last_activity_date": 1541179030, "creation_date": 1541179030, "answer_id": 53123141, "question_id": 53123008, "link": "https://stackoverflow.com/questions/53123008/correct-way-to-add-an-element-to-the-end-of-a-list/53123141#53123141", "title": "Correct way to add an element to the end of a list?", "body": "<p><code>++ [x]</code> is the correct way to add an element to the end of a list, but what the comment is saying is that you shouldn't add elements to the end of a list.</p>\n\n<p>Due to the way lists are defined, adding an element at the end always requires making a copy of the list. That is,</p>\n\n<pre><code>xs ++ ys\n</code></pre>\n\n<p>needs to copy all of <code>xs</code> but can reuse <code>ys</code> unchanged.</p>\n\n<p>If <code>xs</code> is just one element (i.e. we're adding to the beginning of a list), that's no problem: Copying one element takes practically no time at all.</p>\n\n<p>But if <code>xs</code> is longer, we need to spend more time in <code>++</code>.</p>\n\n<p>And if we're doing this repeatedly (i.e. we're building up a big list by continually adding elements to the end), then we need to spend a lot of time making redundant copies. (Building an n-element list in this way is an O(n<sup>2</sup>) operation.)</p>\n\n<p>If you need to do this, there is usually a better way to structure your algorithm. For example, you can build your list in reverse order (adding elements at the beginning) and only call <code>reverse</code> at the end.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10597450"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2400, "favorite_count": 0, "accepted_answer_id": 53123141, "answer_count": 2, "score": 2, "last_activity_date": 1541179030, "creation_date": 1541178455, "question_id": 53123008, "link": "https://stackoverflow.com/questions/53123008/correct-way-to-add-an-element-to-the-end-of-a-list", "title": "Correct way to add an element to the end of a list?", "body": "<p>I was reading on <a href=\"https://wiki.haskell.org/How_to_work_on_lists#Adding\" rel=\"nofollow noreferrer\">this</a> Haskell page about adding an element to the end of a <code>List</code>.</p>\n\n<p>Using the example, I tried it out for my self. Given the following <code>List</code> I wanted to add the number <code>56</code> at the end of it.</p>\n\n<p>Example:</p>\n\n<pre><code>let numbers = [4,8,15,16,23,42] \nnumbers ++ [56]\n</code></pre>\n\n<p>I was thrown off by <a href=\"https://stackoverflow.com/questions/42798257/add-a-element-at-the-end-of-list-in-haskell?newreg=a77ce676ed624d5780546ae43ccabb81\">this</a> comment:</p>\n\n<blockquote>\n  <p>Adding an item to the end of a list is a fine exercise, but usually\n  you shouldn't do it in real Haskell programs. It's expensive, and\n  indicates you are building your list in the wrong order. There is\n  usually a better approach.</p>\n</blockquote>\n\n<p><a href=\"https://stackoverflow.com/questions/1817865/haskell-and-differences\">Researching</a>, I realize that what I'm actually doing is creating a <code>List</code> with <code>56</code> as the only element and I'm combining it with the <code>numbers</code> <code>list</code>. Is that correct? </p>\n\n<p>Is using <code>++</code> the correct way to add an element to the end of a <code>List</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1541177536, "post_id": 53122745, "comment_id": 93140161, "body": "Are you sure you want <code>[[a]] -&gt; [(Int,a)]</code>, not <code>[a] -&gt; [(Int,a)]</code>? The former (if the inner lists are already homogeneous groups) would actually be much easier."}, {"owner": {"reputation": 81, "user_id": 6919456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b6094b3396750e31b59c661285db9e?s=128&d=identicon&r=PG&f=1", "display_name": "Akos Fajszi", "link": "https://stackoverflow.com/users/6919456/akos-fajszi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541177719, "post_id": 53122745, "comment_id": 93140274, "body": "If a is a list then [a] would be good, but - if I am correct - in this way I can&#39;t assume it has more than one list in the list. So yeah I am positive it is that way."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541177931, "post_id": 53122745, "comment_id": 93140392, "body": "Can any of the interior lists be empty? <code>map (length &amp;&amp;&amp; head)</code> would work otherwise. (Actually, a better question is what <i>would</i> you do if a list were empty? You can&#39;t produce an arbitrary value of type <code>a</code> for the output in that case.) (<code>&amp;&amp;&amp;</code> is imported from <code>Control.Arrow</code>)"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1541178027, "post_id": 53122745, "comment_id": 93140429, "body": "Basically i think the type signature is right. You may try something like <code>map ((,) &lt;$&gt; length &lt;*&gt; head) :: [[a]] -&gt; [(Int, a)]</code>."}, {"owner": {"reputation": 81, "user_id": 6919456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b6094b3396750e31b59c661285db9e?s=128&d=identicon&r=PG&f=1", "display_name": "Akos Fajszi", "link": "https://stackoverflow.com/users/6919456/akos-fajszi"}, "edited": false, "score": 0, "creation_date": 1541178116, "post_id": 53122745, "comment_id": 93140488, "body": "Yes the list can be empty, all I care about is that I can count the elements inside the list."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1541178173, "post_id": 53122745, "comment_id": 93140511, "body": "Like I said in my updated comment, what will you do if a list is empty? <code>compress [[1,1,1], []] == [(3,1), (0,???)]</code>."}, {"owner": {"reputation": 81, "user_id": 6919456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b6094b3396750e31b59c661285db9e?s=128&d=identicon&r=PG&f=1", "display_name": "Akos Fajszi", "link": "https://stackoverflow.com/users/6919456/akos-fajszi"}, "edited": false, "score": 0, "creation_date": 1541178269, "post_id": 53122745, "comment_id": 93140555, "body": "Then it is not in the list. [[1,1,1], []] == [(3,1)]"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541179165, "post_id": 53122745, "comment_id": 93140983, "body": "Is it guaranteed that each sublist contains one unique element, or just that the output only reflects the ones that do. That is, does <code>compress [[1,1,1], [1,2]]</code>  produce <code>[(3,1)]</code>, or is it undefined?"}, {"owner": {"reputation": 81, "user_id": 6919456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b6094b3396750e31b59c661285db9e?s=128&d=identicon&r=PG&f=1", "display_name": "Akos Fajszi", "link": "https://stackoverflow.com/users/6919456/akos-fajszi"}, "edited": false, "score": 0, "creation_date": 1541179515, "post_id": 53122745, "comment_id": 93141118, "body": "It is undefined, because all the lists have identical elements or none at all."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1541197479, "post_id": 53123035, "comment_id": 93147718, "body": "I hate seeing beginners pointed to <code>head</code> or the general &quot;look, then leap&quot; style. That&#39;s idiomatic for Lisp, but widely discouraged in Haskell. The list comprehension version is much nicer; another option is to use <code>mapMaybe</code> with either <code>uncons</code> or <code>headMay</code>. Separately, it should be noted that these both calculate lengths lazily, which probably won&#39;t cause a space leak in likely applications but still seems a bit weird to me."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1541189282, "last_edit_date": 1541189282, "creation_date": 1541178540, "answer_id": 53123035, "question_id": 53122745, "link": "https://stackoverflow.com/questions/53122745/haskell-compression-on-list-of-lists/53123035#53123035", "title": "Haskell compression on list of lists", "body": "<p>What you want is to </p>\n\n<ol>\n<li>Filter out empty lists</li>\n<li>Apply <code>length</code> and <code>head</code> to the remaining lists</li>\n<li>Collect the results in the final output.</li>\n</ol>\n\n<p><code>Control.Arrow</code> provides a useful operator <code>&amp;&amp;&amp;</code> which, when specialized to functions, looks like</p>\n\n<pre><code>f &amp;&amp;&amp; g = \\x -&gt; (f x, g x)\n</code></pre>\n\n<p>With that, you can simply write</p>\n\n<pre><code>compress = map (length &amp;&amp;&amp; head) . filter (not . null)\n</code></pre>\n\n<p>Using a list comprehension, it's just</p>\n\n<pre><code>compress xs = [(length x, y) | x@(y:_) &lt;- xs]\n</code></pre>\n\n<p>The pattern match implicitly filters out the empty lists while extracting the first element without a call to <code>head</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1541182480, "post_id": 53123224, "comment_id": 93142373, "body": "<code>length s == 0</code> is O(n) in the length of the list, and strict in its spine; <code>null s</code> is O(1) and only examines the first cons/nil constructor. This was something I expected to be lazier as a beginner\u2014so, for the curious, if you want lazy behaviour from the first expression (e.g. an analogue of <code>length xs &lt; 3</code> that only examines at most 3 constructors) then you need to use <code>genericLength s == (0 :: Nat)</code> with a lazy number type like <code>data Nat = Zero | Succ Nat</code> (with an appropriate <code>instance Num</code>); unfortunately this is neither very efficient nor very idiomatic."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1541183767, "post_id": 53123224, "comment_id": 93142898, "body": "@Jon Purdy Very good comment. Thanks for pointing out will. I correct acordingly."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 2, "last_activity_date": 1541185387, "last_edit_date": 1541185387, "creation_date": 1541179371, "answer_id": 53123224, "question_id": 53122745, "link": "https://stackoverflow.com/questions/53122745/haskell-compression-on-list-of-lists/53123224#53123224", "title": "Haskell compression on list of lists", "body": "<p>This seems to be a better fit for a folding job since conditionally you will drop some of the sublists (ie when <code>length</code> is 0). One approach could be</p>\n\n<pre><code>Prelude&gt; let comp = foldr (\\s r -&gt; if null s then r else (length s, head s):r) []\nPrelude&gt; comp [[1,1,1],[2,2,2],[],[5,5,5,5,5,5]]\n[(3,1),(3,2),(6,5)]\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6919456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78b6094b3396750e31b59c661285db9e?s=128&d=identicon&r=PG&f=1", "display_name": "Akos Fajszi", "link": "https://stackoverflow.com/users/6919456/akos-fajszi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 53123035, "answer_count": 2, "score": 0, "last_activity_date": 1541189282, "creation_date": 1541177291, "question_id": 53122745, "link": "https://stackoverflow.com/questions/53122745/haskell-compression-on-list-of-lists", "title": "Haskell compression on list of lists", "body": "<p>I imagined the following code:</p>\n\n<pre><code>compress :: [[a]] -&gt; [(Int,a)]\ncompress  [[]] = []\ncompress  [(x:xs)] = (1 + length (takeWhile x xs), x) : compress [(dropWhile x xs)]\n</code></pre>\n\n<p>I want to count each element in a list of lists. There are identical elements in each list, for example: \n<code>[[1,1,1], [2,2]]</code>.</p>\n\n<p>I can only achieve the following output: </p>\n\n<p><code>[(1,[1,1,1]), (1,[2,2])]</code></p>\n\n<p>, but what I really need is this: </p>\n\n<p><code>[(3,1), (2,2)]</code>.</p>\n\n<p>I can't get deep enough to count the element in each list and probably made it more complicated with takeWhile dropWhile, hence each list has the same element in it.</p>\n"}, {"tags": ["function", "haskell", "operator-precedence"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541176928, "post_id": 53121573, "comment_id": 93139831, "body": "&quot;Is this an order of operations problem, where I need to wrap in parentheses to assert which function should be applied first?&quot; <i>yes.</i> &quot;And if so, what is the <code>$</code> doing in the second version?&quot; <i>just that</i>. :)"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1541173363, "creation_date": 1541173363, "answer_id": 53121711, "question_id": 53121573, "link": "https://stackoverflow.com/questions/53121573/what-is-in-haskell-and-how-to-apply-functions-to-functions/53121711#53121711", "title": "What is $ in Haskell, and how to apply functions to functions", "body": "<p>Function application <code>f x</code> is the highest-priority operation (and left-associative), so that </p>\n\n<pre><code>sum listValid 10\n</code></pre>\n\n<p>is equivalent to <code>(sum listValid) 10</code>.</p>\n\n<p>The <code>$</code> operator, on the other hand, has the lowest precedence possible (and is right-associative, although that isn't relevant here), so that </p>\n\n<pre><code>sum $ listValid 10\n</code></pre>\n\n<p>is implicitly the same as <code>sum $ (listValid 10)</code>, not <code>(sum $ listValid) 10</code>. Thus, it is commonly used to eliminate parentheses.</p>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541174463, "post_id": 53121718, "comment_id": 93138499, "body": "It&#39;s more about precedence than associativity, or <code>sum $ listValid 10</code> would still try to evaluate <code>sum $ listValid</code> before applying the result to <code>10</code>. (Plus, the right associativity only becomes relevant if multiple <code>$</code> operators are used as once; <code>f $ g $ h</code> is the same as <code>f $ (g $ h)</code>, not <code>(f $ g) $ h</code>)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541177568, "post_id": 53121718, "comment_id": 93140178, "body": "because of the <i>associativity</i> issue with <code>f g x</code>, <i>precedence</i> comes into play in <code>f $ g x</code>."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 5, "last_activity_date": 1541173385, "creation_date": 1541173385, "answer_id": 53121718, "question_id": 53121573, "link": "https://stackoverflow.com/questions/53121573/what-is-in-haskell-and-how-to-apply-functions-to-functions/53121718#53121718", "title": "What is $ in Haskell, and how to apply functions to functions", "body": "<p>It's about associativity. Function application is left-associative, so <code>sum listValid 10</code> is equivalent to <code>(sum listValid) 10</code>, not <code>sum (listValid 10)</code>. And if you think about it, it has to be that way: If you define <code>add x y = x+y</code>, you wouldn't want <code>add 1 2</code> to be equivalent to <code>add (1 2)</code>.</p>\n\n<p>So the issue here is that in <code>sum listValid 10</code>, it doesn't see <code>listValid 10</code> as the argument to <code>sum</code>; it sees <code>listValid</code> as the argument to <code>sum</code> and then <code>10</code> as the argument to <code>sum listValid</code>.</p>\n\n<p><code>$</code> resolves this issue because it's an infix operator and it's perfectly clear that <code>sum</code> is its left operand and <code>listValid 10</code> is its right operand (keeping in mind that function application has higher precedence than any infix operator, so it can't be seen as <code>(sum $ listValid) 10</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1541173412, "creation_date": 1541173412, "answer_id": 53121726, "question_id": 53121573, "link": "https://stackoverflow.com/questions/53121573/what-is-in-haskell-and-how-to-apply-functions-to-functions/53121726#53121726", "title": "What is $ in Haskell, and how to apply functions to functions", "body": "<p>When you write <code>f $ x</code>, you write in fact <code>($) f x</code>, with <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-36-\" rel=\"nofollow noreferrer\"><strong><code>($) :: (a -&gt; b) -&gt; a -&gt; b</code></strong></a> a function. This function is <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#%24\" rel=\"nofollow noreferrer\">defined as</a>:</p>\n\n<blockquote>\n<pre><code>($) :: forall r a (b :: TYPE r). (a -&gt; b) -&gt; a -&gt; b\nf $ x = f x\n</code></pre>\n</blockquote>\n\n<p>The above does not look very impressive. If you thus write <code>f $ x</code>, it is equivalent to <code>f x</code>, so then why write a <code>$</code> anyway? Because this operator has <a href=\"https://www.haskell.org/onlinereport/decls.html#sect4.4.2\" rel=\"nofollow noreferrer\">precedence 0</a>. It thus means that if you write:</p>\n\n<pre><code>f $ x+2\n</code></pre>\n\n<p>it is interpreted as:</p>\n\n<pre><code>($) f (x+2)\n</code></pre>\n\n<p>and thus:</p>\n\n<pre><code>f (x+2)\n</code></pre>\n\n<p>without the need to write brackets.</p>\n\n<p>Going back to your question, if you write:</p>\n\n<pre><code>sum $ listValid 10\n</code></pre>\n\n<p>this is parsed as:</p>\n\n<pre><code>($) (sum) (listValid 10)\n</code></pre>\n\n<p>and thus functionally equivalent to:</p>\n\n<pre><code>sum (listValid 10)\n</code></pre>\n\n<p>If you however write:</p>\n\n<pre><code>sum listValid 10\n</code></pre>\n\n<p>Haskell interprets this as:</p>\n\n<pre><code>(sum listValid) 10\n</code></pre>\n\n<p>now the <code>sum</code> of a function with type <code>Integer -&gt; [Integer]</code> does not make sense, <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:sum\" rel=\"nofollow noreferrer\"><strong><code>sum :: Num a =&gt; [a] -&gt; a</code></strong></a> should take a list of <code>Num</code>erical values, hence the error.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1541173464, "creation_date": 1541173464, "answer_id": 53121740, "question_id": 53121573, "link": "https://stackoverflow.com/questions/53121573/what-is-in-haskell-and-how-to-apply-functions-to-functions/53121740#53121740", "title": "What is $ in Haskell, and how to apply functions to functions", "body": "<p>Function application is left-associative, so</p>\n\n<pre><code>f x y\n</code></pre>\n\n<p>is parsed as:</p>\n\n<pre><code>(f x) y\n</code></pre>\n\n<p>However, function application has higher precedence than any infix operator, so</p>\n\n<pre><code>f x $ g y\n</code></pre>\n\n<p>is parsed as:</p>\n\n<pre><code>(f x) $ (g y)\n</code></pre>\n\n<p>In particular, you have:</p>\n\n<pre><code>sum listValid 10 = (sum listValid) 10\nsum $ listValid 10 = sum $ (listValid 10) = sum (listValid 10)\n</code></pre>\n"}], "owner": {"reputation": 24870, "user_id": 146077, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/IvgEc.jpg?s=128&g=1", "display_name": "Kirk Broadhurst", "link": "https://stackoverflow.com/users/146077/kirk-broadhurst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "closed_date": 1541177514, "accepted_answer_id": 53121718, "answer_count": 4, "score": 1, "last_activity_date": 1541173936, "creation_date": 1541172871, "last_edit_date": 1541173936, "question_id": 53121573, "link": "https://stackoverflow.com/questions/53121573/what-is-in-haskell-and-how-to-apply-functions-to-functions", "closed_reason": "Duplicate", "title": "What is $ in Haskell, and how to apply functions to functions", "body": "<p>I'm doing Project Euler with Haskell, and found something to learn when completing <a href=\"https://projecteuler.net/problem=1\" rel=\"nofollow noreferrer\">the very first problem</a>. Here's my code:</p>\n\n<pre><code>isValid x = (mod x 3 == 0) || (mod x 5 == 0)\nlistValid :: Integer -&gt; [Integer]\nlistValid n = [x | x &lt;- [1..n-1], isValid x]\n</code></pre>\n\n<p>The function <code>listValid</code> will get all the positive integers less than <code>n</code> that are divisble by either 3 or 5.  Easy enough.</p>\n\n<pre><code>*Main&gt; listValid 10\n[3,5,6,9]\n</code></pre>\n\n<p>Now I need to sum them. I figure the sum function is the right way to do this. What I don't understand is why the first two versions work, and then third doesn't.</p>\n\n<pre><code>*Main&gt; sum (listValid 10)\n23\n*Main&gt; sum $ listValid 10\n23\n*Main&gt; sum listValid 10\n\n&lt;interactive&gt;:4:5:\n    Couldn't match type \u2018[Integer]\u2019 with \u2018a0 -&gt; t\u2019\n    Expected type: Integer -&gt; a0 -&gt; t\n      Actual type: Integer -&gt; [Integer]\n    Relevant bindings include it :: t (bound at &lt;interactive&gt;:4:1)\n    In the first argument of \u2018sum\u2019, namely \u2018listValid\u2019\n    In the expression: sum listValid 10\n</code></pre>\n\n<p>Is this an order of operations problem, where I need to wrap in parentheses to assert which function should be applied first? And if so, what is the <code>$</code> doing in the second version?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1541171566, "post_id": 53121135, "comment_id": 93136832, "body": "What&#39;s wrong with <code>(Ord s, Ord e, Eq a)</code> constraints everywhere? To me seeing that in a type signature tells me a lot of things I probably want to know anyway about the value. You can abbreviate it with e.g. <code>type Machine s e a = (Ord s, Ord e, Eq a)</code> if you just don&#39;t like typing it repeatedly."}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1541171815, "post_id": 53121135, "comment_id": 93136971, "body": "If you have a function that needs only the state <code>s</code>, and it does so by invoking <code>nextOperation</code>, you have to supply the three constraints. GHC won&#39;t compile such a function because it doesn&#39;t use <code>e</code> or <code>a</code>, and now you have to do backflips to get it to compile."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1541171951, "post_id": 53121135, "comment_id": 93137046, "body": "Your statement is true, but only vacuously: if you have a function that invokes <code>nextOperation</code>, then it is not true that it needs only the state <code>s</code>. So the premise of your &quot;if&quot; is false. To me this sounds like an XY problem. Why don&#39;t you put the details of the problem you&#39;re <i>actually</i> having instead of this vague surrogate? Show us the code for the thing you&#39;re actually having trouble with."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541172597, "post_id": 53121135, "comment_id": 93137445, "body": "A <a href=\"https://stackoverflow.com/q/53114614/1126841\">recent question</a> might be relevant."}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1541172661, "post_id": 53121135, "comment_id": 93137478, "body": "It&#39;s not vacuous when it takes substantial time to decode error messages, sort through which language extensions I should and shouldn&#39;t use, etc. I edited my question with more code to show the difference in expressiveness using type family approach."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1541173763, "post_id": 53121135, "comment_id": 93138098, "body": "Your code as posted compiles fine here. If you want help with a problem, you need to show what doesn&#39;t work (that you wish <i>would</i> work) together with the error you get."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1541173883, "post_id": 53121135, "comment_id": 93138158, "body": "I&#39;ve thought of designing state machine by the past I came up with the fact that  a function along <code>State -&gt; ev -&gt; Maybe (State, [a])</code>  should be enough. No need for typeclass or type or anything. Am I wrong ?"}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1541174788, "post_id": 53121135, "comment_id": 93138661, "body": "It compiles fine now. I still have a requirement to show the results of the <code>transitiveClosure</code> function. That requires adding <code>Show</code> constraints to <b>every</b> ... <b>single</b> ... <b>function</b>. I have two more constraints waiting in the wings. Using the type family approach allows specifying the constraints in one place instead of dozens of places, most of which have no use for the constraint. We call this &quot;tramp typing&quot;, analogous to &quot;tramp data&quot;."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1541183526, "post_id": 53121135, "comment_id": 93142803, "body": "@BobDalgleish No, you don&#39;t need to add <code>Show</code> to every single function. Only to those functions which show the results of <code>transitiveClosure</code>."}], "answers": [{"comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1541175015, "post_id": 53122120, "comment_id": 93138786, "body": "<code>ConstraintKinds</code> is deprecated. If you don&#39;t pass the<code>Show</code> constraints into each function, the result won&#39;t be <code>Show</code>able."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1541175154, "post_id": 53122120, "comment_id": 93138859, "body": "@BobDalgleish no, constraint kinds are not deprecated. I think you&#39;re confusing them with data declaration constraints, which are something different."}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1541182018, "post_id": 53122120, "comment_id": 93142169, "body": "Thank you for the complete answer. Not only did you provide technical details, but you helped me in thinking about the problem I am trying to solve."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1541175731, "last_edit_date": 1541175731, "creation_date": 1541174809, "answer_id": 53122120, "question_id": 53121135, "link": "https://stackoverflow.com/questions/53121135/how-to-package-a-state-machine-library/53122120#53122120", "title": "How to package a state machine library", "body": "<p>That data family doesn't really accomplish anything your concrete parameterised <code>StateMachine</code> doesn't. The only real difference is that the constraints are packed into a single constraint, as the \u201csuperclasses\u201d of <code>MachineState</code>. But that doesn't require the data family \u2013 you could as well use</p>\n\n<pre><code>class (SMstate s, SMevent e, SMaction a) =&gt; MachineState s e a\n {- Empty! -}\n\ndata StateMachine s e a =\n    StateMachine { states :: [s]\n                 , ... }\n</code></pre>\n\n<p>In fact you don't even need a class for this at all:</p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds #-}\ntype MachineState s e a = (Ord s, Show s, Ord e, Show e, Eq a, Show a)\n</code></pre>\n\n<p>...though I would dispute that it's a good idea to <em>always require <code>Show</code></em>.</p>\n\n<p>So, no, I'd say a data family is not the way to go. Your original approach is the way to go, just listing whatever constraints each function actually needs.</p>\n\n<p>If you're running into ambiguous types, that probably means just you've accidentally mentioned a type variable in a function that does <em>not</em> use a full <code>StateMachine</code> but merely some e.g. list of actions. In that case, it should normally be enough to just remove the constraint.</p>\n\n<p>There are some applications where ambiguous types actually are useful. I don't think this should be the case for yours, but you can check out the <code>-XTypeApplications</code> extension, which is what's needed to invoke functions with ambiguous type.</p>\n\n<hr>\n\n<p>A a general workflow, I recommend this:</p>\n\n<ol>\n<li><p>Start your functions with a signature, but <em>without any constraint</em> and with empty implementation.</p>\n\n<pre><code>nextOperation :: StateMachine s e a -&gt; s -&gt; e -&gt; Maybe (a, s)\nnextOperation = _\n</code></pre></li>\n<li><p>Let GHC's typed-hole feature help you writing the implementation.</p></li>\n<li>Add any constraints the compiler wants.</li>\n</ol>\n\n<p>If it also complains about missing <em>extensions</em>, here are the ones I would always do without qualms:</p>\n\n<ul>\n<li><code>FlexibleInstances</code> (includes <code>TypeSynonymInstances</code>)</li>\n<li><code>FlexibleContexts</code></li>\n<li><code>TypeFamilies</code></li>\n<li><code>GADTs</code></li>\n<li><code>ConstraintKinds</code></li>\n</ul>\n\n<p>Not uncontroversial, but IMO also no big deal are</p>\n\n<ul>\n<li><code>UndecidableInstances</code></li>\n<li><code>LiberalTypeSynonyms</code></li>\n<li><code>AllowAmbiguousTypes</code>+<code>TypeApplications</code></li>\n<li><code>Rank2Types</code></li>\n</ul>\n\n<p>Don't use, unless you really want to</p>\n\n<ul>\n<li><code>OverlappingInstances</code> (resp. the <code>Overlapping</code>/<code>Overlappable</code> pragmas)</li>\n<li>Definitely not <code>IncoherentInstances</code></li>\n<li><code>ImpredicativeTypes</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 0, "last_activity_date": 1541249415, "creation_date": 1541249415, "answer_id": 53131482, "question_id": 53121135, "link": "https://stackoverflow.com/questions/53121135/how-to-package-a-state-machine-library/53131482#53131482", "title": "How to package a state machine library", "body": "<p>I needed a few state machines by the past and AFAIR everything boilds down to just one transition function and the use of a few basic typeclass.\nYour <code>nextOperation</code> function should be enough </p>\n\n<p>For example, let's say I have</p>\n\n<pre><code>type Transition s e a :: s -&gt; e -&gt; Maybe (a,s)\n\ndata State = Pending | InProgress | Processed \ndata Even = Start | Finished\n\nnextOperation :: Transition State Event (IO ())\nnextOperation Pending Start = Just (print \"started\", InProgress)\nnextOperation InProgress Finished = Just (print \"finished\", Processed)\nnextOperation _ _ = Nothing\n</code></pre>\n\n<p>You can create a function which given a list of transitions create a <code>nextOperation</code> like function</p>\n\n<pre><code>fromTransition :: [(s, e), (a,s)] -&gt; s -&gt; e -&gt; Maybe (a,s)\n</code></pre>\n\n<p>(I let you implement it)</p>\n\n<p>To write the <code>transitiveClosure</code> function you'll need the list of all states, all events and all initial states. Getting all states and all events can be done easily by using <code>[minBound .. maxBound]</code>, this requires the <code>Enum</code> and <code>Bounded</code> constraints which are generated automatically from GHC, so you just need</p>\n\n<pre><code>data State = Pending | InProgress | Processed deriving (Eq, Show, Enum, Bounded)\n</code></pre>\n\n<p>For the initial state, you have two options, you can either pass it as an argument to transitiveClosure or create a new typeclass </p>\n\n<pre><code>class Initials a where\n     initials :: [a]\n</code></pre>\n\n<p>With a few common instances</p>\n\n<p>instance Initials () where initials = [()]\n   instance Initials (Maybe a) where initials = [Nothing]\n   instance Initials Bool where initials = [False]\n   instance Num a => Initials a where initials = [0]</p>\n\n<p>Things starts to be interesting with things like tuple</p>\n\n<pre><code>instance (Initials a, Initials b) =&gt; Initials (a,b) \n     where initials = liftA2 (,) initials initials\n</code></pre>\n\n<p>And of course <code>State</code></p>\n\n<pre><code>instance Initials State where initials = [Pending]\n</code></pre>\n\n<p>Then <code>transitiveClosure</code> just need the following signature</p>\n\n<pre><code>transitiveClosure :: ( Bounded s, Enum s, Initials s\n                     , Bounded e, Enum )\n                  =&gt; (Transition s e a) -&gt; [s]\n</code></pre>\n\n<p>We created only one typeclass (<code>Initials</code>) which has (pretty much) nothing todo with a state machine can be reused for something else. Moreover, via the <code>(,)</code> instance, you can easily extend your state and have for free you new initials states.     </p>\n\n<p>Everything else is just functions, which manipulate or create <code>Transition</code>s (I'use a type synonym here, but you could just use the plain function type). Some function might more contrains that other (ex, Show or Ord, Enum, etc ...) but that's the beauty of it.</p>\n\n<p>TL;DR\nIn short, a state machine is just a transition function <code>s -&gt; e -&gt; Maybe (a,s)</code>. Haskell if a functional language, so we can actually modelize it just as a function. Nothing more</p>\n"}], "owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 53122120, "answer_count": 2, "score": 0, "last_activity_date": 1541249415, "creation_date": 1541171306, "last_edit_date": 1541173715, "question_id": 53121135, "link": "https://stackoverflow.com/questions/53121135/how-to-package-a-state-machine-library", "title": "How to package a state machine library", "body": "<p>I want to use Haskell for finite state machine analysis and documentation. I want the library to be generic enough to require little boilerplate when I instantiate a particular FSM.</p>\n\n<p>A state machine definition is based on states <code>s</code>, events <code>e</code>, and actions <code>a</code>. Primary requirements are:</p>\n\n<ul>\n<li>Display the machine as text (define or derive <code>Show</code>).</li>\n<li>Display in fancy form, such as emitting <code>dot</code> notation for Graphviz.</li>\n<li>Determine correctness (for some definition of correctness), termination conditions and other properties of a directed graph.</li>\n<li>Use the state machine definition to aid in ensuring test coverage for implementations of the FSM in other languages (source code generation, test coverage analysis).</li>\n</ul>\n\n<p>My initial implementation looked like:</p>\n\n<pre><code>import Data.List\n\ndata StateMachine s e a =\n    StateMachine { \n                   states :: [s]                    -- ^states that the machine can be in\n                 , events :: [e]                    -- ^events that the machine can process\n                 , actions :: [a]                   -- ^actions the machine can perform\n                 , initialStates :: [s]             -- ^starting states\n                 , transitions :: [((s,e),(a,s))]   -- ^state transitions\n                 }\n\n-- |Find the action and next state for an event in the given state\nnextOperation :: (Ord s, Ord e, Eq a) =&gt; \n                 StateMachine s e a -&gt; s -&gt; e -&gt; Maybe (a, s)\nnextOperation sm st ev = lookup (st, ev) (transitions sm)\n\n-- |Find the next state from this state for an event, if present\nnextTransition :: (Ord s, Ord e, Eq a) =&gt; StateMachine s e a -&gt; s -&gt; e -&gt; Maybe s\nnextTransition sm st ev = fmap snd $ nextOperation sm st ev\nallNextStates :: (Ord s, Ord e, Eq a) =&gt; StateMachine s e a -&gt; s -&gt; [e] -&gt; [s]\nallNextStates _ _ [] = []\nallNextStates sm st (ev:es) = case nextTransition sm st ev of\n                                Just st' -&gt; st': allNextStates sm st es\n                                Nothing  -&gt; allNextStates sm st es\n\n-- |Compute the set of states reachable from a state\nreachableStates :: (Ord s, Ord e, Eq a) =&gt; StateMachine s e a -&gt; s -&gt; [s]\nreachableStates sm st = nub $ allNextStates sm st (events sm)\n\n-- |Compute the transitive closure from the initial states\ntransitiveClosure :: (Ord s, Ord e, Eq a) =&gt; StateMachine s e a -&gt; [s]\ntransitiveClosure sm = transitives sm (initialStates sm) (initialStates sm)\n    where\n        transitives :: (Ord s, Ord e, Eq a) =&gt; StateMachine s e a -&gt; [s] -&gt; [s] -&gt; [s]\n        transitives _ [] reach = reach\n        transitives stm reachable@(st: sts) reach =\n             let r = reachableStates stm st\n                 rs = [r' | r' &lt;- r, not (r' `elem` reach)]\n             in\n                if null rs\n                then transitives stm sts reach\n                else transitives stm (sts ++ rs) (reach ++ rs)\n</code></pre>\n\n<p>From there, almost all of the operations needed to test reachability, and transitive closures could be readily built. However, I ended up with <code>(Ord s, Ord e, Eq a)</code> constraints everywhere, and kept running into \"ambiguous type\" problems. This also irritates the heck out of me, as I could readily define this using an abstract class in Java, let's say.</p>\n\n<p>My second approach was to use type families, but this has not gone well. The first step was the definition of the class:</p>\n\n<pre><code>{-# language TypeFamilies #-}\n{-# language MultiParamTypeClasses #-}\n\n...    \n\nclass (Ord s, Show s) =&gt; SMstate s\nclass (Ord e, Show e) =&gt; SMevent e\nclass (Eq a, Show a) =&gt; SMaction a\n\nclass (SMstate s, SMevent e, SMaction a) =&gt; MachineState s e a where\n    data MS s e a\n    allEvents      :: MS s e a -&gt; [e]\n    initialStates  :: MS s e a -&gt; [s]\n    allStates      :: MS s e a -&gt; [s]\n    allActions     :: MS s e a -&gt; [a]\n    nextOperation  :: MS s e a -&gt; s -&gt; e -&gt; Maybe (a,s)\nnextTransition :: MS s e a -&gt; s -&gt; e -&gt; Maybe s\nnextTransition sm st ev = fmap snd $ nextOperation sm st ev\nnextState      :: MS s e a -&gt; s -&gt; e -&gt; s\nnextState sm st ev = case nextTransition sm st ev of\n                        Just st' -&gt; st'\n                        Nothing  -&gt; st\nallNextStates  :: MS s e a -&gt; s -&gt; [e] -&gt; [s]\nallNextStates _ _ [] = []\nallNextStates sm st (ev:evs) =\n    let nextStates = allNextStates sm st evs\n    in  (maybeToList $ nextTransition sm st ev) ++ nextStates\nreachableStates :: MS s e a -&gt; s -&gt; [s]\nreachableStates sm s = nub $ allNextStates sm s (allEvents sm)\ntransitiveClosure :: MS s e a -&gt; [s]\ntransitiveClosure sm = transitivesOf sm (initialStates sm) (initialStates sm)\n    where\n        transitivesOf :: MachineState s e a =&gt; MS s e a -&gt; [s] -&gt; [s] -&gt; [s]\n        transitivesOf _ [] reach = reach\n        transitivesOf sm reachable@(st:sts) reach =\n            let r = reachableStates sm st\n                rs = [r' | r' &lt;- r, r' `notElem` reach]\n            in\n                if null rs\n                then transitivesOf sm sts reach\n                else transitivesOf sm (sts ++ rs) (reach ++ rs)\n</code></pre>\n\n<p>Because the class constraints are wired into the definitions around <code>MachineState</code>, I no longer have to worry about propagating the constraints.</p>\n\n<p>Are type families the way to go with this? How do I connect the <code>StateMachine</code> to the <code>MachineState</code> class?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1541165327, "post_id": 53119434, "comment_id": 93133299, "body": "<code>data PersistedCommand a = PersistedCommand { offset :: Offset , command :: a}</code> and add the constraints in the function signatures, like: <code>Command a =&gt; PersistentCommand a -&gt; ...</code>."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541166340, "post_id": 53119434, "comment_id": 93133867, "body": "can&#39;t we do better than that ?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541166503, "post_id": 53119434, "comment_id": 93133964, "body": "I don&#39;t get what is &quot;bad&quot; with that. Typeclasses are a meta-level higher than types, so it makes sense not to start mixing these."}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1541166884, "post_id": 53119434, "comment_id": 93134155, "body": "I agree with @WillemVanOnsem.  If you tell us more about what interface you are trying to provide to users of <code>PersistedCommand</code>, we might be able to offer some other options."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1541167125, "post_id": 53119434, "comment_id": 93134278, "body": "@NicolasHenin: you can use <code>DatatypeContexts</code>, but for good reasons, these are now deprecated <a href=\"https://stackoverflow.com/questions/7438600/datatypecontexts-deprecated-in-latest-ghc-why\" title=\"datatypecontexts deprecated in latest ghc why\">stackoverflow.com/questions/7438600/&hellip;</a>"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541167357, "post_id": 53119434, "comment_id": 93134389, "body": "yeah I have seen that, I&#39;m confused why you don&#39;t see the need of it. My persisted command need to be serializable, having some specific functions like getAgreggateId /getCommandId etc....Everywhere I&#39;m using it"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 2, "creation_date": 1541167485, "post_id": 53119434, "comment_id": 93134448, "body": "maybe it&#39;s my OOP background that fools me...."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1541167676, "post_id": 53119434, "comment_id": 93134540, "body": "I guess it <i>is</i> your OOP background that fools you. \u201cChanged <code>Command</code> from a data type to a type class\u201d sounds quite fishy; data types and type classes serve two rather fundamentally different needs.  I think you should probably stay with a <code>data Command</code>, but without more code it&#39;s hard to be sure."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541167960, "post_id": 53119434, "comment_id": 93134689, "body": "I wanted to decoupled the concept of Command from the examples of commands you could have... at the beginning it was funny to put all my commands in a sum type, but I realized it was becoming fishy and that command is more a typeclass that a datatype."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541167995, "post_id": 53119434, "comment_id": 93134705, "body": "I have added some code around to help..."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541168203, "post_id": 53119434, "comment_id": 93134845, "body": "<a href=\"https://wiki.haskell.org/Data_declaration_with_constraint\" rel=\"nofollow noreferrer\">wiki.haskell.org/Data_declaration_with_constraint</a>"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541168401, "post_id": 53119434, "comment_id": 93134964, "body": "from what I understand I could do it with the GADTs form but I would have to give up the record type syntax"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541168560, "post_id": 53119434, "comment_id": 93135050, "body": "<a href=\"https://stackoverflow.com/questions/40825878/type-constraints-in-data-declaration-haskell\" title=\"type constraints in data declaration haskell\">stackoverflow.com/questions/40825878/&hellip;</a>"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541168825, "post_id": 53119434, "comment_id": 93135207, "body": "I want to guarantee the integrity of my data lol is it so bad ? I&#39;m thinking encapsulation in a way... I have the same reasoning that the guy in the stack-overflow link"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1541169177, "post_id": 53119434, "comment_id": 93135422, "body": "basically you are saying to me that encapsulation should be a convention more than something enforced by the language"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1541169768, "post_id": 53119434, "comment_id": 93135785, "body": "Plugging one of my older answers: <a href=\"https://stackoverflow.com/questions/50292576/haskell-how-to-cast-a-data-type-to-one-of-its-specific-typeclass/50293231#50293231\" title=\"haskell how to cast a data type to one of its specific typeclass\">stackoverflow.com/questions/50292576/&hellip;</a> - this is a common problem to have. The answer isn&#39;t typeclasses it&#39;s rethinking how you structure your data types."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1541169984, "post_id": 53119434, "comment_id": 93135918, "body": "That is, if you actually need dynamism. If you don&#39;t... just use typeclasses the intended way. Have a <code>Command a</code> and slap a <code>(DoesWhatIWant a) =&gt; ...</code> constraint everywhere you need it."}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1541167720, "creation_date": 1541165141, "last_edit_date": 1541167720, "question_id": 53119434, "link": "https://stackoverflow.com/questions/53119434/add-a-typeclass-constraint-on-a-record-type", "title": "Add a typeclass constraint on a Record type", "body": "<p>Before this declaration was working well in my context :</p>\n\n<pre><code>data PersistedCommand = PersistedCommand { offset :: Offset , command :: Command }\n\ninstance Show PersistedCommand where\n  show persistedCommand = \"PersistedCommand { offset = \" ++ ( show $ offset persistedCommand) ++ \" , command = \" ++ (show $ getCommandName $ command persistedCommand) ++ \":\"\n    ++ (show $ getAggregateId $ command persistedCommand) ++ \" }\"\n</code></pre>\n\n<p>But I've changed <code>Command</code> from a data type to a type class. How do I express this now in the previous declaration ?  </p>\n"}, {"tags": ["haskell", "addition"], "comments": [{"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1541153689, "post_id": 53116413, "comment_id": 93127519, "body": "Your <code>add</code> function is <code>Int -&gt; Int -&gt; Int</code> and your <code>add&#39;&#39;</code> function returns an <code>[Int]</code>"}, {"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1541153912, "post_id": 53116413, "comment_id": 93127646, "body": "There are also simpler ways to do the thing that you are trying to do, especially if the numbers are always positive, which means that they could represent the length of something..."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1541154674, "post_id": 53116413, "comment_id": 93128082, "body": "so <code>+</code> is basic, but <code>mod</code> and <code>div</code> are not? :) (joking). -- nice exercise!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541162832, "post_id": 53116413, "comment_id": 93132034, "body": "You realize that <code>succ :: Int -&gt; Int</code> is just defined as <code>succ x = x + 1</code>, though, right? You&#39;re jumping through multiple layers of abstraction to avoid <code>+</code>, which is  hidden in the final layer anyway."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1541162923, "post_id": 53116413, "comment_id": 93132069, "body": "You may as well define your own <code>succ&#39;</code> function explicitly (<code>succ 0 = 1; succ 1 = 2; -- etc</code>), then figure out how to handle carrying."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1541155975, "post_id": 53116653, "comment_id": 93128729, "body": "not futile at all. :) --- 9+9=18; 9+9+1=19. the carry is only ever 0, or 1. an occasional additional <code>succ</code> is all that&#39;s needed. right?"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1541155570, "last_edit_date": 1541155570, "creation_date": 1541153998, "answer_id": 53116653, "question_id": 53116413, "link": "https://stackoverflow.com/questions/53116413/adding-two-numbers-together-without-using-the-operator-in-haskell/53116653#53116653", "title": "Adding two numbers together without using the + operator in Haskell", "body": "<ol>\n<li><p>You can't use <code>head</code> and <code>last</code> on tuples. ...Frankly, you should <em>never</em> use these functions at all because they're unsafe (partial), but they <em>can</em> be used on lists. In Haskell, lists are something completely different from tuples.<br>To get at the elements of a tuple, use <em>pattern matching</em>.</p>\n\n<pre><code>add'' ((x,y):xs) = [add''' x y] ++ add'' xs \n</code></pre>\n\n<p>(To get at the elements of a list, pattern matching is very often the best too.) Alternatively, you can use <code>fst</code> and <code>snd</code>, these do on 2-tuples what you apparently thought <code>head</code> and <code>last</code> would.</p></li>\n<li><p>Be clear which functions are curried and which aren't. The way you write <code>add'''</code>, its type signature is actually <code>Int -&gt; Int -&gt; Int</code>. That is <em>equivalent</em> to <code>(Int, Int) -&gt; Int</code>, but it's still not the same to the type checker.</p></li>\n<li><p>The result of <code>add''</code> is <code>[Int]</code>, but you're trying to use this as <code>Int</code> in the result of <code>add</code>. That can't work, you need to translate from digits to numbers again.</p></li>\n<li><p><code>add''</code> doesn't handle the empty case. That's fixed easily enough, but better than doing this recursion at all is using standard combinators. In your case, this is only supposed to work element-wise anyway, so you can simply use <code>map</code> \u2013 or do that right in the zipping, with <code>zipWith</code>. Then you also don't need to unwrap any tuples <em>at all</em>, because it works with a curried function.</p></li>\n</ol>\n\n<hr>\n\n<p>A clean version of your attempt:</p>\n\n<pre><code>add :: Int -&gt; Int -&gt; Int\nadd x y = fromDigits 0 $ zipWith addDigits (toDigits x []) (toDigits y [])\n where\n       fromDigits :: Int -&gt; [Int] -&gt; Int\n       fromDigits acc [] = acc\n       fromDigits acc (d:ds)\n            = acc `seq`  -- strict accumulator, to avoid thunking.\n                fromDigits (acc*10 + d) ds\n\n       toDigits :: Int -&gt; [Int] -&gt; [Int]                -- yield difference-list,\n       toDigits 0 = id                                  -- because we're consing\n       toDigits x = toDigits (x`div`10) . ((x`mod`10):) -- left-associatively.\n\n       addDigits :: Int -&gt; Int -&gt; Int\n       addDigits x y = last $ take (succ x) $ iterate succ y\n</code></pre>\n\n<p>Note that <code>zipWith</code> requires both numbers to have the same number of digits (as does <code>zip</code>).</p>\n\n<p>Also, yes, I'm using <code>+</code> in <code>fromDigits</code>, making this whole thing pretty futile. In practice you would of course use binary, then it's just a bitwise-or and the multiplication is a left shift. What you actually <em>don't</em> need to do here is take special care with 10-overflow, but that's just because of the cheat of using <code>+</code> in <code>fromDigits</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1541156416, "last_edit_date": 1541156416, "creation_date": 1541155418, "answer_id": 53117049, "question_id": 53116413, "link": "https://stackoverflow.com/questions/53116413/adding-two-numbers-together-without-using-the-operator-in-haskell/53117049#53117049", "title": "Adding two numbers together without using the + operator in Haskell", "body": "<p>By <code>head</code> and <code>last</code> you meant <code>fst</code> and <code>snd</code>, but you don't need them at all, the components are right there:</p>\n\n<pre><code>add'' :: [(Int, Int)] -&gt; [Int]\nadd'' (pair : pairs) = [(add''' pair)] ++ add'' pairs \n  where\n  add''' :: (Int, Int) -&gt; Int\n  add''' (x, y) = last (take (succ y) $ iterate succ x)\n                = iterate succ x !! y\n                = [x ..] !! y          -- nice idea for an exercise!\n</code></pre>\n\n<p>Now the big question that remains is what to do with those <em>big</em> scary 10-and-over numbers. Here's a thought: produce a digit and a carry with</p>\n\n<pre><code>   = ([(d, 0) | d &lt;- [x .. 9]] ++ [(d, 1) | d &lt;- [0 ..]]) !! y\n</code></pre>\n\n<p>Can you take it from here? Hint: reverse order of digits is your friend!</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 0, "last_activity_date": 1541166745, "creation_date": 1541166745, "answer_id": 53119848, "question_id": 53116413, "link": "https://stackoverflow.com/questions/53116413/adding-two-numbers-together-without-using-the-operator-in-haskell/53119848#53119848", "title": "Adding two numbers together without using the + operator in Haskell", "body": "<p>The other answers cover what's gone wrong in your approach. From a theoretical perspective, though, they each have some drawbacks: they either land you at <code>[Int]</code> and not <code>Int</code>, or they use <code>(+)</code> in the conversion back from <code>[Int]</code> to <code>Int</code>. What's more, they use <code>mod</code> and <code>div</code> as subroutines in defining addition -- which would be okay, but then to be theoretically sound you would want to make sure that you could define <code>mod</code> and <code>div</code> themselves without using addition as a subroutine!</p>\n\n<p>Since you say efficiency is no concern, I propose using the usual definition of addition that mathematicians give, namely: 0 + y = y, and (x+1) + y = (x + y)+1. Here you should read <code>+1</code> as a separate operation than addition, a more primitive one: the one that just increments a number. We spell it <code>succ</code> in Haskell (and its \"inverse\" is <code>pred</code>). With this theoretical definition in mind, the Haskell almost writes itself:</p>\n\n<pre><code>add :: Int -&gt; Int -&gt; Int\nadd 0 y = y\nadd x y = succ (add (pred x) y)\n</code></pre>\n\n<p>So: compared to other answers, we can take an <code>Int</code> and return an <code>Int</code>, and the only subroutines we use are ones that \"feel\" more primitive: <code>succ</code>, <code>pred</code>, and checking whether a number is zero or nonzero. (And we land at only three short lines of code... about a third as long as the shortest proposed alternative.) Of course the price we pay is very bad performance... try <code>add (2^32) 0</code>!</p>\n\n<p>Like the other answers, this only works for positive numbers. When you are ready for handling negative numbers, we should chat again -- there's some <a href=\"https://en.wikipedia.org/wiki/Integer#Construction\" rel=\"nofollow noreferrer\">fascinating mathematical tricks</a> to pull.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541346268, "post_id": 53139875, "comment_id": 93176477, "body": "This doesn&#39;t require \u201csame length\u201d. In fact it has no notion of \u201clength\u201d, or rather the \u201clength\u201d is the value, as in <a href=\"https://en.wikipedia.org/wiki/Unary_numeral_system\" rel=\"nofollow noreferrer\">unary</a>... it&#39;s just <i>horribly</i> inefficient, your original approach was much faster."}], "tags": [], "owner": {"reputation": 31, "user_id": 10539691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54570bd3e562e269bdc35174f10b0067?s=128&d=identicon&r=PG&f=1", "display_name": "vKkU4NBz5x", "link": "https://stackoverflow.com/users/10539691/vkku4nbz5x"}, "is_accepted": false, "score": 1, "last_activity_date": 1541327689, "creation_date": 1541327689, "answer_id": 53139875, "question_id": 53116413, "link": "https://stackoverflow.com/questions/53116413/adding-two-numbers-together-without-using-the-operator-in-haskell/53139875#53139875", "title": "Adding two numbers together without using the + operator in Haskell", "body": "<p>the official answer my professor gave</p>\n\n<p>works on positive and negative numbers too, but still requires the two numbers to be the same length</p>\n\n<pre><code>add 0 y = y\nadd x y\n | x&gt;0 = add (pred x) (succ y)\n | otherwise = add (succ x) (pred y)\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10539691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54570bd3e562e269bdc35174f10b0067?s=128&d=identicon&r=PG&f=1", "display_name": "vKkU4NBz5x", "link": "https://stackoverflow.com/users/10539691/vkku4nbz5x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1113, "favorite_count": 0, "accepted_answer_id": 53119848, "answer_count": 4, "score": 1, "last_activity_date": 1541327689, "creation_date": 1541152994, "question_id": 53116413, "link": "https://stackoverflow.com/questions/53116413/adding-two-numbers-together-without-using-the-operator-in-haskell", "title": "Adding two numbers together without using the + operator in Haskell", "body": "<p>I want to add two positive numbers together without the use of any basic operators like + for addition. I've already worked my way around that  (in the add''' function) (i think) may not be efficient but thats not the point right now. I am getting lots of type errors however which i have no idea how to handle, and is very confusing for me as it works on paper and i've come from python.</p>\n\n<p>add 1245 7489</p>\n\n<pre><code>--add :: Int -&gt; Int -&gt; Int\nadd x y = add'' (zip (add' x) (add' y))\n where\n add' :: Int -&gt; [Int]\n add' 0 = []\n add' x = add' (x `div` 10) ++ [x `mod` 10]\n</code></pre>\n\n<p>conversion [1,2,4,5] [7,4,8,9] then zipping them together [(1,7),(2,4)....]    </p>\n\n<pre><code> add'' :: [(Int,Int)] -&gt; [Int]\n add'' (x:xs) = [(add''' (head x) (last x))] ++ add'' xs \n</code></pre>\n\n<p>summary [8,6,...] what happens when the sum reaches 10 is not implemented yet.</p>\n\n<pre><code>  where\n  --add''' :: (Int,Int) -&gt; Int\n  add''' x y = last (take (succ y) $ iterate succ x)\n</code></pre>\n\n<p>adding two numbers together</p>\n"}, {"tags": ["haskell", "pointfree"], "answers": [{"comments": [{"owner": {"reputation": 4295, "user_id": 1916893, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/XTlc8.png?s=128&g=1", "display_name": "TobiMcNamobi", "link": "https://stackoverflow.com/users/1916893/tobimcnamobi"}, "edited": false, "score": 0, "creation_date": 1541167686, "post_id": 53116308, "comment_id": 93134546, "body": "Sorry, I don&#39;t get it. How is <code>((.) (+) ((*) a)) b c = ((.) (+) . (*)) a b c</code>? What is <code>f</code> and <code>g</code> here if this were perceived as <code>(f . g) x = f (g x)</code>?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 4295, "user_id": 1916893, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/XTlc8.png?s=128&g=1", "display_name": "TobiMcNamobi", "link": "https://stackoverflow.com/users/1916893/tobimcnamobi"}, "edited": false, "score": 1, "creation_date": 1541168050, "post_id": 53116308, "comment_id": 93134734, "body": "@TobiMcNamobi <code>f = (.) (+) = ((.) (+)) ; g = (*) ; (f (g a)) == (f . g) a</code>. <code>b, c</code> are just hanging, irrelevant for <i>this</i> transformation. extraneous parentheses are also irrelevant."}, {"owner": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "edited": false, "score": 0, "creation_date": 1541319920, "post_id": 53116308, "comment_id": 93170164, "body": "@WillNess thanks for the thorough explanation previously. So based on it, I&#39;ve worked on another example i attempted in the updated post above, would appreciate if you could assess it and inform me if I&#39;m right with the rules."}, {"owner": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "edited": false, "score": 0, "creation_date": 1541328867, "post_id": 53116308, "comment_id": 93172023, "body": "@WillNess thank you. One question, why is it that its div a (g b) then reverted back to (a <code>div</code>) (g b)? Does the ` ` play a role in the change?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541329168, "post_id": 53116308, "comment_id": 93172088, "body": "it was unnecessary in the first place."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 6, "last_activity_date": 1541326319, "last_edit_date": 1541326319, "creation_date": 1541152604, "answer_id": 53116308, "question_id": 53116154, "link": "https://stackoverflow.com/questions/53116154/transforming-a-function-in-haskell-to-point-free-notation/53116308#53116308", "title": "Transforming a function in Haskell to point free notation", "body": "<p>You can apply the <strong>B</strong> combinator (i.e. <code>(f . g) x = f (g x)</code>) there:</p>\n\n<pre><code>function2 a b c = (a * b) + c\nfunction2 a b c = ((*) a b) + c    -- operator sectioning\nfunction2 a b c = (+) ((*) a b) c  -- operator sectioning once more\n      = (+) (((*) a) b) c          -- explicit parentheses\n      = ((+) . ((*) a)) b c        -- B combinator\n      = ((.) (+) ((*) a)) b c      -- operator sectioning \n      = ((.) (+) . (*)) a b c      -- B combinator\n</code></pre>\n\n<p>Indeed the types are the same:</p>\n\n<pre><code>&gt; :t let function2 a b c = (a * b) + c in function2\nlet function2 a b c = (a * b) + c in function2\n  :: Num a =&gt; a -&gt; a -&gt; a -&gt; a\n\n&gt; :t ((.) (+) . (*))\n((.) (+) . (*)) :: Num b =&gt; b -&gt; b -&gt; b -&gt; b\n</code></pre>\n\n<p>We work by extricating the arguments one by one in the correct order, to end up with </p>\n\n<pre><code>function2 a b c = (......) a b c\n</code></pre>\n\n<p>so that the <em>eta-contraction</em> can be applied to get rid of the explicit arguments,</p>\n\n<pre><code>function2       = (......) \n</code></pre>\n\n<p>Our <em>tools</em> in this, which we get to apply <em>in both directions</em>, are</p>\n\n<pre><code>S a b c  =  (a c) (b c)  =  (a &lt;*&gt; b) c\nK a b    =  a            =  const a b\nI a      =  a            =  id a\nB a b c  =  a (b c)      =  (a . b) c\nC a b c  =  a c b        =  flip a b c\nW a b    =  a b b        =  join a b\nU a      =  a a          -- not in Haskell: `join id` has no type\n</code></pre>\n\n<p>There's also <code>(f =&lt;&lt; g) x = f (g x) x = join (f . g) x</code>.</p>\n\n<p>Some more, useful patterns that emerge when we work with pointfree for a while are:</p>\n\n<pre><code>((f .) .) g x y = f (g x y)\n(((f .) .) .) g x y z = f (g x y z)\n.....\n((. g) . f) x y = f x (g y)\n((. g) . f . h) x y = f (h x) (g y)\n</code></pre>\n\n<hr>\n\n<p>(update.) There's an error near the start in your second example, invalidating all the following steps after it:</p>\n\n<pre><code>function3 a b = a `div` (g b)\nfunction3 a b = -- `div` a (g b)     -- wrong syntax, you meant\n                div a (g b)\nfunction3 a b = -- (`div` a) (g b)   -- wrong; it is\n                (a `div`) (g b) --operator sectioning\nfunction3 a b = ((a `div`) . g) b --B combinator\nfunction3 a   = (div a . g) --eta conversion; back with plain syntax\nfunction3 a   = (.) (div a) g --operator sectioning\nfunction3 a   = flip (.) g (div a) --definition of flip\nfunction3 a   = (flip (.) g . div) a --B combinator\nfunction3     = (flip (.) g . div) --eta conversion\n              = (.) (flip (.) g) div  --operator section\n</code></pre>\n\n<p>So yeah, some of the steps were in the right direction.</p>\n"}, {"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1541185803, "post_id": 53116438, "comment_id": 93143768, "body": "I presume you\u2019re calling it \u201cowl\u201d to avoid the fact that people in practice refer to it as a different kind of hooters, but in the usual aviary of <a href=\"http://www.angelfire.com/tx4/cus/combinator/birds.html\" rel=\"nofollow noreferrer\">combinator birds</a>, the owl O is \u03bbfg.g(fg); this is the blackbird B\u2081 = \u03bbfgxy.f(gxy), sometimes spelled <code>(.:)</code>, <code>(...)</code>, or <code>fmap fmap fmap</code> if you want to be silly about it. For my pointfree code though, I prefer to just add an <code>fmap</code>\u2014<code>fmap (+) . (*)</code>\u2014since even though it\u2019s just composition here, semantically I think of it as \u201cmapping over\u201d the extra argument."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1541190303, "last_edit_date": 1541190303, "creation_date": 1541153118, "answer_id": 53116438, "question_id": 53116154, "link": "https://stackoverflow.com/questions/53116154/transforming-a-function-in-haskell-to-point-free-notation/53116438#53116438", "title": "Transforming a function in Haskell to point free notation", "body": "<p>We can continue with:</p>\n\n<pre><code>function2 a b = (+) ((*) a b)     [eta-reduction]\nfunction2 a = (+) . (*) a         [using a dot, to eliminate the b]\nfunction2 = ((.) . (.)) (+) (*)   [\"blackbird\" operator to pass two parameters]\n</code></pre>\n\n<p>Here the <a href=\"http://hackage.haskell.org/package/data-aviary-0.4.0/docs/Data-Aviary-Birds.html#v:blackbird\" rel=\"nofollow noreferrer\">\"blackbird operator\"</a> is a combination of three <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:.\" rel=\"nofollow noreferrer\"><strong><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code></strong></a> operators. It is functionally equivalent to:</p>\n\n<pre><code>((.) . (.)) :: (c -&gt; d) -&gt; (a -&gt; b -&gt; c) -&gt; a -&gt; b -&gt; d\n((.) . (.)) f g x y = f (g x y)\n</code></pre>\n\n<p>see here for a <a href=\"https://stackoverflow.com/a/50852623/67579\">derivation</a>.</p>\n"}], "owner": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 356, "favorite_count": 2, "accepted_answer_id": 53116308, "answer_count": 2, "score": 6, "last_activity_date": 1541326319, "creation_date": 1541152016, "last_edit_date": 1541325046, "question_id": 53116154, "link": "https://stackoverflow.com/questions/53116154/transforming-a-function-in-haskell-to-point-free-notation", "title": "Transforming a function in Haskell to point free notation", "body": "<p>I have a function in haskell on paper as an example:</p>\n\n<pre><code>function2 a b c = (a * b) + c \n</code></pre>\n\n<p>and I'm required to write the example in point free notation. I'm really bad at working with point free style as I find it really confusing with no proper guide through it so i gave it a try:</p>\n\n<pre><code>function2 a b c = (a * b) + c\nfunction2 a b c = ((*) a b) + c #operator sectioning\nfunction2 a b c = (+) ((*) a b)c #operator sectioning once more\n#I'm stuck here now\n</code></pre>\n\n<p>I wasnt sure what should come up next as that was the limit i could think of for this example. Would appreciate some help on this.</p>\n\n<p>--Second example:</p>\n\n<pre><code>function3 a b = a `div` (g b)\nfunction3 a b = `div` a (g b) --operator sectioning\nfunction3 a b = (`div` a) (g b) --parentheses\nfunction3 a b = ((`div` a g).)b --B combinator\nfunction3 a   = ((`div` a g).) --eta conversion\nfunction3 a   = ((.)(`div` a g)) --operator sectioning\nfunction3 a   = ((.)flip(`div` g a))\nfunction3 a   = ((.)flip(`div` g).a) --B combinator\nfunction3     = ((.)flip(`div` g)) --eta conversion (complete)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1541148593, "post_id": 53114614, "comment_id": 93124974, "body": "FWIW, <code>Data.Functor.Classes</code> defines <code>Show1</code> and <code>Show2</code> classes. They&#39;re different than the types shown here, but perhaps those standard classes could serve as inspiration..."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1541149738, "creation_date": 1541149738, "answer_id": 53115580, "question_id": 53114614, "link": "https://stackoverflow.com/questions/53114614/define-a-constraint-for-multiple-type-variables/53115580#53115580", "title": "Define a constraint for multiple type variables", "body": "<p>You could use a type family, and type-level lists-of-types.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, DataKinds, TypeOperators #-}\n\nimport Data.Kind\n\ntype family ShowN (xs :: [*]) :: Constraint\ntype instance ShowN '[] = ()\ntype instance ShowN (t ': ts) = (Show t, ShowN ts)\n\nfoo :: ShowN '[a, b, c] =&gt; a -&gt; b -&gt; c -&gt; String\nfoo xa xb xc = show xa ++ \" \" ++ show xb ++ \" \" ++ show xc\n\nmain :: IO ()\nmain = putStrLn (foo 3 True 'f')\n</code></pre>\n"}], "owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 53115580, "answer_count": 1, "score": 4, "last_activity_date": 1541149738, "creation_date": 1541145097, "question_id": 53114614, "link": "https://stackoverflow.com/questions/53114614/define-a-constraint-for-multiple-type-variables", "title": "Define a constraint for multiple type variables", "body": "<p>In my codebase I have several types with a different number of type variables.</p>\n\n<p>For example, consider</p>\n\n<pre><code>data MyType a b c = ...\ndata MyOtherType a b c d e = ...\n</code></pre>\n\n<p>Then I am defining functions using these types and I want to require that every type variable is an instance of <code>Show</code>.</p>\n\n<p>To avoid too much repetition I used <code>ConstraintKinds</code> to define types</p>\n\n<pre><code>type Show2 a b = (Show a, Show b)\ntype Show3 a b c = (Show2 a b, Show c)\ntype Show4 a b c d = (Show3 a b c, Show d)\ntype Show5 a b c d e = (Show4 a b c d, Show e)\n</code></pre>\n\n<p>so that in the definition of my functions I can use</p>\n\n<pre><code>f :: (Show5 a b c d e) =&gt; MyOtherType a b c d e -&gt; ...\n</code></pre>\n\n<p>Now my question is: is there a way to simplify the definition of types <code>Show2</code>, ..., <code>Show5</code>? It looks like their definition is recursive and I was wondering if there was an extension which allowed me to define them in one go</p>\n"}, {"tags": ["haskell", "haskell-stack", "intero"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1541155534, "post_id": 53114445, "comment_id": 93128494, "body": "You probably shouldn&#39;t install <code>intero</code> directly using <code>stack install</code> like this (see <a href=\"https://lexi-lambda.github.io/blog/2018/02/10/an-opinionated-guide-to-haskell-in-2018/#understanding-stacks-model-and-avoiding-its-biggest-gotcha\" rel=\"nofollow noreferrer\">here</a>); what happens if you let emacs install it for you?"}, {"owner": {"reputation": 2885, "user_id": 1360368, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7997d33ca6f47d0e48080d6f58a72443?s=128&d=identicon&r=PG", "display_name": "Ashesh", "link": "https://stackoverflow.com/users/1360368/ashesh"}, "edited": false, "score": 1, "creation_date": 1541329093, "post_id": 53114445, "comment_id": 93172070, "body": "I can also confirm this. But it looks like intero can only support up to GHC <code>8.4.3</code> at this time."}], "answers": [{"tags": [], "owner": {"reputation": 1177, "user_id": 456551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7024df9e050fec69022dbbb02c49e0?s=128&d=identicon&r=PG", "display_name": "tylerweir", "link": "https://stackoverflow.com/users/456551/tylerweir"}, "is_accepted": true, "score": 5, "last_activity_date": 1541165266, "creation_date": 1541165266, "answer_id": 53119475, "question_id": 53114445, "link": "https://stackoverflow.com/questions/53114445/stack-fails-to-install-intero/53119475#53119475", "title": "Stack fails to install intero", "body": "<p>Currently intero supports <code>GHC 8.4.3</code>, but stack is grabbing <code>8.4.4</code>.  Change your resolver to <code>lts-12.14</code> in <code>stack.yaml</code></p>\n"}], "owner": {"reputation": 1666, "user_id": 794779, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/6fcb78bccab141509b0d9f74953dd4c9?s=128&d=identicon&r=PG", "display_name": "fred", "link": "https://stackoverflow.com/users/794779/fred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1822, "favorite_count": 2, "accepted_answer_id": 53119475, "answer_count": 1, "score": 4, "last_activity_date": 1541165266, "creation_date": 1541144296, "question_id": 53114445, "link": "https://stackoverflow.com/questions/53114445/stack-fails-to-install-intero", "title": "Stack fails to install intero", "body": "<p>I just installed Stack using </p>\n\n<pre><code>curl -sSL https://get.haskellstack.org/ | sh\n</code></pre>\n\n<p>The install went fine but when trying to install Intero using Stack it fails</p>\n\n<pre><code>ffriis@BNEC02QR6Y0G8WN ~&gt; stack install hlint intero\n\nError: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for intero-0.1.32:\n    ghc-8.4.4 from stack configuration does not match &gt;=7.8 &amp;&amp; &lt;=8.4.3  (latest matching version is 8.4.3)\nneeded since intero is a build target.\n\nSome different approaches to resolving this:\n\n  * Set 'allow-newer: true' in /Users/ffriis/.stack/config.yaml to ignore all version constraints and build anyway.\n\n  * Consider trying 'stack solver', which uses the cabal-install solver to attempt to find some working build configuration. This can be convenient when dealing with many complicated constraint\n    errors, but results may be unpredictable.\n\n  * Recommended action: try adding the following to your extra-deps in /Users/ffriis/.stack/global-project/stack.yaml:\n\nghc-8.4.3@sha256:07ee8fb5dab414c35f93d5d5afc1ecaa65a49c409346e5063436cc8b838cd754\n\nPlan construction failed.\n</code></pre>\n\n<p>I've edited the file as instructed but I'm still getting the same error. What is the best way to resolve the problem?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1541138560, "post_id": 53113289, "comment_id": 93121462, "body": "The question is telling you that <code>_hole</code> is a function, and then asking you what type it has to have in order for that definition to type-check. Assume everything else in the definition of <code>sequence</code> is correct and that you won&#39;t change it.  Also, you don&#39;t need an implementation for <code>_hole</code>.  (Maybe the next question asks about that.  Once you figure out the type, the implementation is pretty easy.)"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1541149206, "creation_date": 1541149206, "answer_id": 53115459, "question_id": 53113289, "link": "https://stackoverflow.com/questions/53113289/haskell-function-using-applicative-and-functor/53115459#53115459", "title": "Haskell function using Applicative and Functor", "body": "<p>The exercise wants you to assume that some value <code>_hole</code> is defined somewhere, and that the code above type checks. Then, the goal is to determine what would be the type of that <code>_hole</code>. Then, it would ask a possible definition for <code>_hole</code>.</p>\n\n<p>For instance, if we were given</p>\n\n<pre><code>foo :: Int\nfoo = 3 + _hole\n</code></pre>\n\n<p>the answer should be <code>_hole :: Int</code>, since that's what we need to make the code above to work. For the definition <code>_hole = 2</code> is OK.</p>\n\n<p>Instead, in</p>\n\n<pre><code>foo :: Int -&gt; Bool\nfoo = const _hole \"hello\" True\n</code></pre>\n\n<p>then we need <code>_hole :: Bool -&gt; Int -&gt; Bool</code> and for instance <code>_hole = \\b i -&gt; b</code>.</p>\n\n<p>Your own code is more complex, so it's better to write down all the steps:</p>\n\n<pre><code>sequence :: Applicative f =&gt; [f a] -&gt; f[a]\nsequence = foldr (_hole (:)) (pure [])\n</code></pre>\n\n<p>Here <code>foldr</code> is used, which (on lists) has type</p>\n\n<pre><code>foldr :: (b -&gt; c -&gt; c) -&gt; c -&gt; [b] -&gt; c\n</code></pre>\n\n<p>To type check, the arguments must have type</p>\n\n<pre><code>_hole (:) :: b -&gt; c -&gt; c\npure [] :: c\n</code></pre>\n\n<p>the result of <code>foldr</code>, being called with only two arguments is</p>\n\n<pre><code>sequence :: [b] -&gt; c\n</code></pre>\n\n<p>since this must match the type of <code>sequence</code> above, we get</p>\n\n<pre><code>[b] = [f a]\nc = f [a]\n</code></pre>\n\n<p>Hence, <code>b = f a</code> and</p>\n\n<pre><code>_hole (:) :: f a -&gt; f [a] -&gt; f [a]\npure [] :: f [a]\n</code></pre>\n\n<p>The <code>pure []</code> part type checks as it is. For the other, we need</p>\n\n<pre><code>_hole :: (type of (:)) -&gt; f a -&gt; f [a] -&gt; f [a]\n</code></pre>\n\n<p>i.e. since <code>(:) :: d -&gt; [d] -&gt; [d]</code> for any <code>d</code>, we get</p>\n\n<pre><code>_hole :: (d -&gt; [d] -&gt; [d]) -&gt; f a -&gt; f [a] -&gt; f [a]\n</code></pre>\n\n<p>where <code>d</code> can be picked arbitrarily. It is \"natural\", though, to pick <code>d=a</code>, so that we get</p>\n\n<pre><code>_hole :: (a -&gt; [a] -&gt; [a]) -&gt; f a -&gt; f [a] -&gt; f [a]\n</code></pre>\n\n<p>Now, we need to write a definition <code>_hole f x y = ??</code> in terms of <code>&lt;$&gt;</code> and <code>&lt;*&gt;</code>. Essentially, we need to re-implement <code>liftA2</code> from the library. You should now be able to solve this last part.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1541272077, "last_edit_date": 1541272077, "creation_date": 1541201729, "answer_id": 53127006, "question_id": 53113289, "link": "https://stackoverflow.com/questions/53113289/haskell-function-using-applicative-and-functor/53127006#53127006", "title": "Haskell function using Applicative and Functor", "body": "<p>Let's do it step by step, gradually discovering the types of the entities involved in our definition. We are given</p>\n\n<pre><code>sequence :: Applicative f =&gt; [f a] -&gt; f [a]               --  (1)\nsequence = foldr (_hole (:)) (pure [])                    --  (2)\n</code></pre>\n\n<p>so that <code>sequence = mksequence g</code> for some <code>g</code>:</p>\n\n<pre><code>mksequence g xs = foldr (g (:)) (pure []) xs              --  (3)\n\nmksequence g [a,b,...,n] = r where                        --  (4)\n    r = g (:) a $ g (:) b $ ... $ g (:) n (pure [])       --  (5)\n\nmksequence g [a] = g (:) a (pure [])                      --  (6)\n\nmksequence g []  = pure []                                --  (7)\n\n-- [a,b,...,n] :: [f a]                     &lt;-(4,1)       --  (8)\n--  a,b,...,n  ::  f a                      &lt;-(8)         --  (9)\n--  r          :: f [a]                     &lt;-(4,1)       --  (10)\n-- pure []     :: f [a]                     &lt;-(7,1)       --  (11)\n-- g (:)       :: f a -&gt; f [a] -&gt; f [a]     &lt;-(6,8,11,1)\n</code></pre>\n\n<p>Finally, we've found the type of <code>g (:)</code>! Compare it with</p>\n\n<pre><code>(&lt;*&gt;)  :: f (a -&gt; t) -&gt; f a -&gt; f t          , _A :: f (a -&gt; t)\n(_A &lt;*&gt; _C)                 :: f t          , _C :: f  a\n(_B &lt;*&gt; _C)                 :: f (t -&gt; s)   , _B :: f (a -&gt; (t -&gt; s))\n((_B &lt;*&gt; _C) &lt;*&gt; _D)        :: f       s    , _D :: f        t\n</code></pre>\n\n<p>So that we have,</p>\n\n<pre><code>\\ _B _C _D -&gt; ((_B &lt;*&gt; _C) &lt;*&gt; _D)  \n          :: f (a -&gt; (t  -&gt;  s)) -&gt; f a -&gt; f  t  -&gt; f  s\n   g ((:) ::    a -&gt; [a] -&gt; [a]) :: f a -&gt; f [a] -&gt; f [a]\n</code></pre>\n\n<p>The signatures nearly match! With just a little nudge we have</p>\n\n<pre><code>g (:) = (\\ _B _C _D -&gt; ((_B &lt;*&gt; _C) &lt;*&gt; _D)) (pure (:))\n</code></pre>\n\n<p>and so, generalizing,</p>\n\n<pre><code>g  f2  fa  ft  =  pure f2  &lt;*&gt;  fa  &lt;*&gt;  ft\n</code></pre>\n\n<p>because <code>(&lt;*&gt;)</code> associates to the left. Re-checking the types,</p>\n\n<pre><code>g  f2  fa  ft  =  pure f2  &lt;*&gt;  fa  &lt;*&gt;  ft\n               =       f2  &lt;$&gt;  fa  &lt;*&gt;  ft\n\n-- fa                 :: f a\n-- f2                 ::   a -&gt; t -&gt; s\n-- f2 &lt;$&gt; fa          :: f     (t -&gt; s)\n-- ft                 :: f      t\n-- (f2 &lt;$&gt; fa) &lt;*&gt; ft :: f           s\n</code></pre>\n\n<p>In fact this definition already exists, and is named <code>liftA2</code> -- for \"lifting\" a binary function (<code>f2</code>) into an applicative \"context\" (<code>f</code>):</p>\n\n<pre><code>           f2 ::   a -&gt;   t -&gt;   s\n    liftA2 f2 :: f a -&gt; f t -&gt; f s\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 10513295, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hNAO7bYMxyc/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsIIg2tLxpED_OmNmokxr3aKUTQQ/mo/photo.jpg?sz=128", "display_name": "jazzer97", "link": "https://stackoverflow.com/users/10513295/jazzer97"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 53115459, "answer_count": 2, "score": 1, "last_activity_date": 1541272077, "creation_date": 1541137942, "question_id": 53113289, "link": "https://stackoverflow.com/questions/53113289/haskell-function-using-applicative-and-functor", "title": "Haskell function using Applicative and Functor", "body": "<p>I have a practice question, where I'm given a function:</p>\n\n<pre><code>sequence :: Applicative f =&gt; [f a] -&gt; f[a]\nsequence = foldr (_hole (:)) (pure [])\n</code></pre>\n\n<p>and the question says:</p>\n\n<pre><code>\"What type is required for the function that needs to be placed at \n_hole in the following expression? Also give a definition for the \nexpression using  and &lt;$&gt; and &lt;*&gt;\".\n</code></pre>\n\n<p>I'm having issue understanding what the question is asking. So for what I've tried, i assume that I'm required to specify the operator since it's using foldr so i assume its something like sequence = foldr((+) (:)) (pure[]).</p>\n\n<p>Then for the definition of the expression, i wrote something like:</p>\n\n<pre><code>sequence :: &lt;*&gt; f =&gt; [f a] -&gt; f[a]\nsequence = foldr &lt;$&gt; pure []\n</code></pre>\n\n<p>I'm pretty sure I'm not 100% correct so would appreciate some help on this on any corrections.</p>\n"}, {"tags": ["validation", "haskell", "scope", "either"], "answers": [{"comments": [{"owner": {"reputation": 1264, "user_id": 7813290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcbe552141510b2f519018d4cf1a5ae4?s=128&d=identicon&r=PG&f=1", "display_name": "Jamin", "link": "https://stackoverflow.com/users/7813290/jamin"}, "edited": false, "score": 0, "creation_date": 1541177250, "post_id": 53112510, "comment_id": 93140004, "body": "Thank you for your answer. It was very thoughtful and informing, I appreciate it a lot."}], "tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": true, "score": 2, "last_activity_date": 1541131081, "creation_date": 1541131081, "answer_id": 53112510, "question_id": 53112125, "link": "https://stackoverflow.com/questions/53112125/haskell-continuing-to-next-do-after-validating-with-either/53112510#53112510", "title": "Haskell - Continuing to next do after validating with either", "body": "<p>It sounds like you just need to bind the value returned in the monad from <code>start</code>, like this:</p>\n\n<pre><code>main = do\n    putStrLn \"Welcome.\"\n    let start startMessage = do\n        putStrLn startMessage\n        let ask message = do\n            putStrLn message\n            choice &lt;- getLine\n            either ask return $ userChoice(choice)\n        ask $ \"What would you like to do?\\n\" ++ displayOptions(0)\n\n    -- THE NEW BIT I ADDED:\n    opt &lt;- start \"Choose a number between 1-4.\"\n    putStrLn opt   -- THIS PRINTS \"You proceed with ...\"\n\n    -- SNIP\n</code></pre>\n\n<p>You can read about \"desugaring <code>do</code> notation\" to learn how this translates to lambdas and the methods of the <code>Monad</code> class (<code>&gt;&gt;=</code> and <code>return</code>).</p>\n\n<hr>\n\n<p>A couple other suggestions:</p>\n\n<p>You can use (and should prefer) pattern matching instead of guards and <code>==</code> (a method of the <code>Eq</code> class, which not all types implement). E.g.</p>\n\n<pre><code>userChoice2 option = case option of\n    \"1\" -&gt; \"You proceed with option 1.\"\n    \"2\" -&gt; \"You proceed with option 2\"\n</code></pre>\n\n<p>Remember that in haskell the syntax for calling <code>foo</code> on <code>a</code> and <code>b</code> is <code>foo a b</code> not <code>foo(a,b)</code></p>\n\n<p>It can be very helpful to turn on warnings (both when you're learning and on production code bases) e.g. here I load your file in ghci after turning on <code>-Wall</code>:</p>\n\n<pre><code>Prelude&gt; :set -Wall\nPrelude&gt; :l k.hs\n[1 of 1] Compiling Main             ( k.hs, interpreted )\n\nk.hs:15:1: warning: [-Wmissing-signatures]\n    Top-level binding with no type signature: main :: IO b\n   |\n15 | main = do\n   | ^^^^\n\nk.hs:24:5: warning: [-Wunused-do-bind]\n    A do-notation statement discarded a result of type \u2018String\u2019\n    Suppress this warning by saying\n      \u2018_ &lt;- start \"Choose a number between 1-4.\"\u2019\n   |\n24 |     start \"Choose a number between 1-4.\"\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nOk, one module loaded.\n</code></pre>\n\n<p>Notice it warns you that <code>start</code> returns <code>IO String</code> but that you've done nothing with the <code>String</code> value, which indeed was an error. If you really want to discard the value you can use <code>void</code> to make it explicit and silence the error.</p>\n"}], "owner": {"reputation": 1264, "user_id": 7813290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dcbe552141510b2f519018d4cf1a5ae4?s=128&d=identicon&r=PG&f=1", "display_name": "Jamin", "link": "https://stackoverflow.com/users/7813290/jamin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 53112510, "answer_count": 1, "score": 0, "last_activity_date": 1541131081, "creation_date": 1541127650, "question_id": 53112125, "link": "https://stackoverflow.com/questions/53112125/haskell-continuing-to-next-do-after-validating-with-either", "title": "Haskell - Continuing to next do after validating with either", "body": "<p>I'm new to Haskell and using do notation to validate a user's choice with an Either.</p>\n\n<pre><code>userChoice :: String -&gt; Either String String\nuserChoice option\n    | option == \"1\" = Right \"You proceed with option 1.\"\n    | option == \"2\" = Right \"You proceed with option 2\"\n    | option == \"3\" = Right \"You proceed with option 3\"\n    | option == \"4\" = Right \"You proceed with option 4\"\n    | otherwise = Left $ \"\\n\\nInvalid Option...\\nWhat would you like to do?\\n\" ++ displayOptions(0)\n\ndisplayOptions :: Int -&gt; String\ndisplayOptions option\n    | option == 0 = \"1 - Option 1\\n2 - Option 2\\n3 - Option 3\\n4 - Option 4\"\n    | otherwise = \"invalid\"\n\nmain = do\n    putStrLn \"Welcome.\"\n    let start startMessage = do\n        putStrLn startMessage\n        let ask message = do\n            putStrLn message\n            choice &lt;- getLine\n            either ask ask $ userChoice(choice)\n        ask $ \"What would you like to do?\\n\" ++ displayOptions(0)\n    start \"Choose a number between 1-4.\"\n</code></pre>\n\n<p>This works fine, but after the user chooses a correct option, I'd like to proceed to the next part of the program. I could use return but I lose which option the user chose.</p>\n\n<p>As an example, I can put return here when the user chooses a right, but then it will not say the String \"You proceed with option...\".  </p>\n\n<pre><code>main = do\n    putStrLn \"Welcome.\"\n    let start startMessage = do\n        putStrLn startMessage\n        let ask message = do\n            putStrLn message\n            choice &lt;- getLine\n            either ask return $ userChoice(choice)\n        ask $ \"What would you like to do?\\n\" ++ displayOptions(0)\n    start \"Choose a number between 1-4.\"\n\n    -- putStrLn userChoice2(choice)\n\n    let continue continueMessage = do\n        putStrLn continueMessage\n        let ask message = do\n            putStrLn message\n            choice &lt;- getLine\n            either continue continue $ userChoice(choice)\n        ask $ \"What would you like to do?\"\n    continue \"We are now here...\"\n</code></pre>\n\n<p>If I try to put continue as the right option then it throws a scope error.  Similarly, if I use return and try to make a primitive clone function for userChoice I no longer have access to the scope choice is in.</p>\n\n<pre><code>userChoice2 :: String -&gt; String\nuserChoice2 option\n    | option == \"1\" = \"You proceed with option 1.\"\n    | option == \"2\" = \"You proceed with option 2\"\n    | option == \"3\" = \"You proceed with option 3\"\n    | option == \"4\" = \"You proceed with option 4\"\n    | otherwise = \"\\n\\nInvalid Option...\\nWhat would you like to do?\\n\" ++ displayOptions(0)\n</code></pre>\n\n<p>Is there a way to chain these together elegantly?</p>\n"}, {"tags": ["javascript", "haskell", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1541112017, "post_id": 53109889, "comment_id": 93115847, "body": "I don&#39;t get your question. Yes, flattening nested structures is exactly what Monads can do that Functors cannot. That&#39;s why we use two different terms for two different concepts."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1541112485, "post_id": 53109889, "comment_id": 93115989, "body": "Branching on <code>result.contextValue !== undefined</code> makes no sense. You should not overload <code>bind</code> to do <code>fmap</code> as well. Also, I don&#39;t get what point you are trying to make with that example?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10583507"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1541113491, "post_id": 53109889, "comment_id": 93116276, "body": "@Bergi I wrote &quot; Is there any counter example that Functors cannnot do what Monads can do except the robustness of functional composition by flattening the nested structure?&quot; and other got the idea.Sorry, but your comment is not helpful."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1541114018, "post_id": 53109889, "comment_id": 93116409, "body": "You must be the same person who&#39;s kept asking questions just like this on several different accounts over the last week or so.  Why do you keep creating new accounts?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10583507"}, "edited": false, "score": 0, "creation_date": 1541114290, "post_id": 53109889, "comment_id": 93116490, "body": "I don&#39;t use several accounts to ask."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1541116812, "post_id": 53109889, "comment_id": 93117100, "body": "@Carl It seems unlikely that there are three or four people on here, all asking similar questions about monads and trying to back up their points with Javascript. I&#39;m willing to pass it off as a coincidence, but I can understand why others might be suspicious."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1541136036, "post_id": 53109889, "comment_id": 93120875, "body": "Are you aware that <code>join</code> and <code>&gt;&gt;=</code> are isomorphic and that it is considered a boring questions which of the two should be required methods to implement <code>Monad</code>? And can you clarify &quot;there is Maybe functor in Haskell, that does not has join&quot;? <code>Maybe</code> is a <i>type</i> and it implements both Functor and Monad (indeed all Monad instances are also instances of Functor)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10583507"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1541138429, "post_id": 53109889, "comment_id": 93121425, "body": "@jberryman No, that&#39;s not boring question, because in fact, the answer from @DarthFennec corresponding to my question is based on his idea: &quot;<code>join</code> is the heart of a monad.&quot; or &quot;There are plenty of situations where you&#39;re doing something very simple that doesn&#39;t require join, and in those cases it&#39;s easy to treat the monad as a functor or applicative functor. But usually that isn&#39;t enough, and in those cases we use monads.&quot; I disagree with him, and I illustrated the reason."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1541175716, "post_id": 53109889, "comment_id": 93139168, "body": "@user10583507 <code>join</code> is the heart of the monad because it encompasses everything a monad can do that a functor cannot. Since <code>join</code> and <code>&gt;&gt;=</code> are isomorphic and you can define each in terms of the other, defining <code>&gt;&gt;=</code> without <code>join</code> still provides the same degree of freedom (you could say that defining <code>&gt;&gt;=</code> indirectly defines <code>join</code>, and vice versa). You get the same thing either way, except that <code>&gt;&gt;=</code> is more convenient and <code>join</code> is more &quot;pure&quot;. So it is really a boring question to compare the two."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1541111877, "creation_date": 1541111877, "answer_id": 53110361, "question_id": 53109889, "link": "https://stackoverflow.com/questions/53109889/whats-so-special-about-monads-in-kleisli-category/53110361#53110361", "title": "What&#39;s so special about Monads in Kleisli category?", "body": "<p>Your \u201cfunctor\u201d is very manifestly not a functor, violating both the identity and composition law:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>console.log(\"Functor\");\r\n{\r\n  const unit = (val) =&gt; ({\r\n    // contextValue: () =&gt; val,\r\n    fmap: (f) =&gt; unit((() =&gt; {\r\n      //you can do pretty much anything here\r\n      const newVal = f(val);\r\n      console.log(newVal); //IO in the functional context\r\n      return newVal;\r\n    })()),\r\n  });\r\n\r\n  console.log(\"fmap(id) ...\");\r\n  const a0 = unit(3)\r\n    .fmap(x =&gt; x);      // prints something\r\n  console.log(\"         \u2261 id?\");\r\n  const a1 = (x =&gt; x)(unit(3));   // prints nothing\r\n\r\n  console.log(\"fmap(f) \u2218 fmap(g) ...\");\r\n  const b0 = unit(3)\r\n    .fmap(x =&gt; 3*x)\r\n    .fmap(x =&gt; 4+x);     // prints twice\r\n  console.log(\"                   \u2261 fmap(f\u2218g)?\");\r\n  const b1 = unit(3)\r\n    .fmap(x =&gt; 4+(3*x));    // prints once\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1541139504, "post_id": 53110397, "comment_id": 93121724, "body": "@SmoothOperator Quoting your edit: &quot;there is Maybe functor in Haskell, that does not has join&quot;. But <code>Maybe</code> has a <code>join</code>, like any other <code>Monad</code> does."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 4, "last_activity_date": 1541112475, "last_edit_date": 1592644375, "creation_date": 1541112100, "answer_id": 53110397, "question_id": 53109889, "link": "https://stackoverflow.com/questions/53109889/whats-so-special-about-monads-in-kleisli-category/53110397#53110397", "title": "What&#39;s so special about Monads in Kleisli category?", "body": "\n<blockquote>\n<p>The point is we can implement whatever we like in the Functor structure, and in this case, I simply made it IO/<code>console.log</code> the value.</p>\n<p>Another point is, to do this Monads is absolutely unnecessary.</p>\n</blockquote>\n<p>The problem is that once you do that your functor is no longer a functor. Functors should preserve identities and composition. For Haskell <code>Functor</code>s, those requirements amount to:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>fmap id = id\nfmap (g . f) = fmap g . fmap f\n</code></pre>\n<p>Those laws are a guarantee that all <code>fmap</code> does is using the supplied function to modify values -- it doesn't do funny stuff behind your back. In the case of your code, <code>fmap(x =&gt; x)</code> should do nothing; instead, it prints to the console.</p>\n<p>Note that all of the above applies to the <code>IO</code> functor: if <code>a</code> is an <code>IO</code> action, executing <code>fmap f a</code> will have no I/O effects other than those <code>a</code> already had. One stab at writing something similar in spirit to your code might be...</p>\n<pre class=\"lang-hs prettyprint-override\"><code>applyAndPrint :: Show b =&gt; (a -&gt; b) -&gt; a -&gt; IO b\napplyAndPrint f x = let y = f x in fmap (const y) (print y)\n\npseudoFmap :: Show b =&gt; (a -&gt; b) -&gt; IO a -&gt; IO b\npseudoFmap f a = a &gt;&gt;= applyAndPrint f\n</code></pre>\n<p>... but that makes use of <code>Monad</code> already, as we have an effect (printing a result) which depends on the result of a previous computation.</p>\n<p>It goes without saying that if you are so inclined (and your type system allows it) you can write code that disregards all of those distinctions. There is, however, a trade-off: the decreased power of <code>Functor</code> with respect to <code>Monad</code> comes with extra guarantees on what functions using the interface can and cannot do -- that is what makes the distinctions useful in the first place.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10583507"}, "edited": false, "score": 0, "creation_date": 1541131207, "post_id": 53110746, "comment_id": 93119849, "body": "Ok, &quot;&quot;Avoiding the nested type&quot; is not in fact the purpose of join, it&#39;s just a neat side-effect. The way you put it makes it sound like join just strips the outer type, but the monad&#39;s value is unchanged. This is not the case. join is the heart of a monad, and it&#39;s what allows the monad to do things.&quot; I don&#39;t see any definition of Monads in categort theory explains this. All I read about join is stil <code>MMX =&gt; MX</code> and that is exactly what my code does."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10583507"}, "edited": false, "score": 0, "creation_date": 1541131474, "post_id": 53110746, "comment_id": 93119911, "body": "&quot;A monad is a functor with a special power: where fmap allows you to work on an inner value, bind allows you to combine outer values in a consistent way. This is much more powerful than a simple functor.&quot;\u3000There is MaybeFunctor in Haskell. There&#39;s no &quot;join&quot; or &quot;bind&quot; there, and I wonder from where the power come. What is the difference between MaybeFunctor and MaybeMonad?"}], "tags": [], "owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "is_accepted": false, "score": 5, "last_activity_date": 1541181915, "last_edit_date": 1541181915, "creation_date": 1541114776, "answer_id": 53110746, "question_id": 53109889, "link": "https://stackoverflow.com/questions/53109889/whats-so-special-about-monads-in-kleisli-category/53110746#53110746", "title": "What&#39;s so special about Monads in Kleisli category?", "body": "<blockquote>\n  <p>Is there any counter example that Functors cannnot do what Monads can do except the robustness of functional composition by flattening the nested structure?</p>\n</blockquote>\n\n<p>I think this is the important point:</p>\n\n<blockquote>\n  <p>Monads is a little expansion for robustness of function composition by join : <code>M(M(X)) -&gt; M(X)</code> to avoid the nested type.</p>\n</blockquote>\n\n<p>\"Avoiding the nested type\" is not in fact the purpose of <code>join</code>, it's just a neat side-effect. The way you put it makes it sound like <code>join</code> just strips the outer type, but the monad's value is unchanged. This is not the case. <code>join</code> is the heart of a monad, and it's what allows the monad to <em>do things</em>.</p>\n\n<p>You can think of a functor as basically a container. There's an arbitrary inner type, and around it an outer structure that allows some variance, some extra values to \"decorate\" your inner value. <code>fmap</code> allows you to work on the things inside the container, the way you would work on them normally. This is basically the limit of what you can do with a functor.</p>\n\n<p>A monad is a functor with a special power: where <code>fmap</code> allows you to work on an inner value, <code>bind</code> allows you to <em>combine outer values</em> in a consistent way. This is much more powerful than a simple functor.</p>\n\n<hr>\n\n<blockquote>\n  <p>The point is we can implement whatever we like in the Functor structure, and in this case, I simply made it IO/<code>console.log</code> the value.</p>\n</blockquote>\n\n<p>This is incorrect, actually. The only reason you were able to do IO here is because you're using Javascript, and you can do IO anywhere. In a purely functional language like Haskell, IO cannot be done in a functor like this.</p>\n\n<p>This is a gross generalization, but for the most part it's useful to describe <code>IO</code> as a glorified <code>State</code> monad. Each <code>IO</code> action takes an extra hidden parameter called <code>RealWorld</code> (which represents the state of the real world), maybe reads from it or modifies it, and then sends it on to the next <code>IO</code> action. This <code>RealWorld</code> parameter is threaded through the chain. If something is written to the screen, that's <code>RealWorld</code> being copied, modified, and passed along. But how does the \"passing along\" work? The answer is <code>join</code>.</p>\n\n<p>Say we want to read a line from the user, and print it back to the screen:</p>\n\n<pre><code>getLine :: IO String\nputStrLn :: String -&gt; IO ()\n\nmain :: IO ()\nmain = -- ?\n</code></pre>\n\n<p>Let's assume <code>IO</code> is a functor. How do we implement this?</p>\n\n<pre><code>main :: IO (IO ())\nmain = fmap putStrLn getLine\n</code></pre>\n\n<p>Here we've lifted <code>putStrLn</code> to <code>IO</code>, to get <code>fmap putStrLn :: IO String -&gt; IO (IO ())</code>. If you recall, <code>putStrLn</code> takes a <code>String</code> and a <em>hidden <code>RealWorld</code></em> and returns a modified <code>RealWorld</code>, where the <code>String</code> parameter is printed to the screen. We've lifted this function with <code>fmap</code>, so that it now takes an <code>IO</code> (which is an action that takes a hidden <code>RealWorld</code>, and returns a modified <code>RealWorld</code> and a <code>String</code>), and returns the <em>same io action</em>, just wrapped around a different value (a completely separate action that also takes a separate hidden <code>RealWorld</code> and returns a <code>RealWorld</code>). Even after applying <code>getLine</code> to this function, nothing actually happens or gets printed.</p>\n\n<p>We now have a <code>main :: IO (IO ())</code>. This is an action that takes a hidden <code>RealWorld</code>, and returns a modified <code>RealWorld</code> and a separate action. This second action takes a different <code>RealWorld</code> and returns another modified <code>RealWorld</code>. This on its own is pointless, it doesn't get you anything and it doesn't print anything to the screen. What needs to happen is, the two <code>IO</code> actions need to be connected together, so that one action's returned <code>RealWorld</code> gets fed in as the other action's <code>RealWorld</code> parameter. This way it becomes one continuous chain of <code>RealWorld</code>s that mutate as time goes on. This \"connection\" or \"chaining\" happens when the two <code>IO</code> actions are merged with <code>join</code>.</p>\n\n<hr>\n\n<p>Of course, <code>join</code> does different things depending on which monad you're working with, but for <code>IO</code> and <code>State</code>-type monads, this is more or less what's happening under the hood. There are plenty of situations where you're doing something very simple that doesn't require <code>join</code>, and in those cases it's easy to treat the monad as a functor or applicative functor. But usually that isn't enough, and in those cases we use monads.</p>\n\n<hr>\n\n<p><strong>EDIT: Responses to comments and edited question:</strong></p>\n\n<blockquote>\n  <p>I don't see any definition of Monads in categort theory explains this. All I read about join is stil <code>MMX =&gt; MX</code> and that is exactly what my code does.</p>\n</blockquote>\n\n<p>Can you also tell exactly what a function <code>String -&gt; String</code> does? Might it not return the input verbatim, reverse it, filter it, append to it, ignore it and return a completely different value, or anything else that results in a <code>String</code>? A type does not determine what a function does, it <em>restricts</em> what a function <em>can</em> do. Since <code>join</code> in general is only defined by its type, any particular monad can do <em>anything allowed by that type</em>. This might just be stripping the outer layer, or it might be some extremely complex method of combining the two layers into one. As long as you start with two layers and end up with one layer, it doesn't matter. The type allows for a number of possibilities, which is part of what makes monads so powerful to begin with.</p>\n\n<blockquote>\n  <p>There is MaybeFunctor in Haskell. There's no \"join\" or \"bind\" there, and I wonder from where the power come. What is the difference between MaybeFunctor and MaybeMonad?</p>\n</blockquote>\n\n<p>Every monad is also a functor: a monad is nothing more than a functor that also has a <code>join</code> function. If you use <code>join</code> or <code>bind</code> with a <code>Maybe</code>, you're using it as a monad, and it has the full power of a monad. If you do not use <code>join</code> or <code>bind</code>, but only use <code>fmap</code> and <code>pure</code>, you're using it as a functor, and it becomes limited to doing the things a functor can do. If there's no <code>join</code> or <code>bind</code>, there is no extra monad power.</p>\n\n<blockquote>\n  <p>I believe \"Avoiding the nested type\" is not just a neat side-effect, but a definition of \"join\" of Monad in category theory</p>\n</blockquote>\n\n<p>The definition of <code>join</code> is a transformation from a nested monad to a non-nested monad. Again, this could imply <em>anything</em>. Saying the purpose of <code>join</code> is \"to avoid the nested type\" is like saying the purpose of <code>+</code> is to avoid pairs of numbers. Most operations combine things in some way, but very few of those operations exist simply for the sake of having a combination of things. The important thing is <em>how the combining happens</em>.</p>\n\n<blockquote>\n  <p>there is <strong>Maybe functor</strong> in Haskell, that does not has <code>join</code>, or there is <strong>Free monad</strong> that <code>join</code> is embedded from the first place into the defined structure. They are objects that users define <strong>Functors to <em>do things</em></strong>.</p>\n</blockquote>\n\n<p>I've already discussed <code>Maybe</code>, and how when you use it as a functor only, it can't do the things it can do if you use it as a monad. <code>Free</code> is weird, in that it's one of the few monads that <em>doesn't actually do anything</em>.</p>\n\n<p><code>Free</code> can be used to turn any functor into a monad, which allows you to use <code>do</code> notation and other conveniences. However, the conceit of <code>Free</code> is that <code>join</code> does not combine your actions the way other monads do, instead it keeps them separate, inserting them into a list-like structure; the idea being that this structure is later processed and the actions are combined by <em>separate code</em>. An equivalent approach would be to move that processing code into <code>join</code> itself, but that would turn the functor into a monad and there would be no point in using <code>Free</code>. So the only reason <code>Free</code> works is because it delegates the actual \"doing things\" part of the monad elsewhere; its <code>join</code> opts to defer action to code running outside the monad. This is like a <code>+</code> operator that, instead of adding the numbers, returns an abstract syntax tree; one could then process that tree later in whatever way is needed.</p>\n\n<blockquote>\n  <p>These observation does not fit the fact of the existence of Maybe functor and Free monad.</p>\n</blockquote>\n\n<p>You are incorrect. As explained, <code>Maybe</code> and <code>Free</code> fit perfectly into my previous observations:</p>\n\n<ul>\n<li>The <code>Maybe</code> functor simply does not have the same expressiveness as the <code>Maybe</code> monad.</li>\n<li>The <code>Free</code> monad transforms functors into monads in the only way it possibly can: by not implementing a monadic behavior, and instead simply deferring it to some assumed processing code.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": false, "score": 1, "last_activity_date": 1541129426, "creation_date": 1541129426, "answer_id": 53112319, "question_id": 53109889, "link": "https://stackoverflow.com/questions/53109889/whats-so-special-about-monads-in-kleisli-category/53112319#53112319", "title": "What&#39;s so special about Monads in Kleisli category?", "body": "<p>overly long comment:</p>\n\n<p>I would suggest forgetting about Kleisli categories for now; I don't believe they have anything to do with your confusion. </p>\n\n<p>Also while I still don't fully understand your question and assertions, some context that might be useful: category theory is extremely general and abstract; the concepts like <code>Monad</code> and <code>Functor</code> as they exist in haskell are (necessarily) somewhat <em>less</em> general and <em>less</em> abstract (e.g. the notion of the category of \"Hask\"). </p>\n\n<p>As a general rule the more concrete (the less abstract) a thing becomes, the more power you have: if I tell you you have a vehicle then you know you have a thing that can take you from one place to another, but you don't know how fast, you don't know whether it can go on land, etc. If I tell you you have a speed boat then there opens up a whole larger world of things you can do and reason about (you can use it to catch fish, you know that it won't get you from NYC to Denver).</p>\n\n<p>When you say:</p>\n\n<blockquote>\n  <p>What's so special about Monads in Kleisli category?</p>\n</blockquote>\n\n<p>...I believe you're making the mistake of suspecting that the conception of <code>Monad</code> and <code>Functor</code> in haskell is in some way <em>more</em> restrictive relative to category theory but, as I try to explain by analogy above, the opposite is true.</p>\n\n<p>Your code is the same sort of flawed thinking: you model a speedboat (which is a vehicle) and claim it shows that all vehicles are fast and travel on water.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10583507"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 815, "favorite_count": 1, "answer_count": 4, "score": -3, "last_activity_date": 1541181915, "creation_date": 1541109222, "last_edit_date": 1592644375, "question_id": 53109889, "link": "https://stackoverflow.com/questions/53109889/whats-so-special-about-monads-in-kleisli-category", "title": "What&#39;s so special about Monads in Kleisli category?", "body": "<p>The related Question is</p>\n<ol>\n<li><p><a href=\"https://stackoverflow.com/questions/16439025/what-is-so-special-about-monads\">What is so special about Monads?</a></p>\n</li>\n<li><p><a href=\"https://stackoverflow.com/questions/51376391/bind-can-be-composed-of-fmap-and-join-so-do-we-have-to-use-monadic-functions-a\">bind can be composed of fmap and join, so do we have to use monadic functions a -&gt; m b?</a></p>\n</li>\n</ol>\n<p><strong>In the first question:</strong></p>\n<blockquote>\n<p>What is so special about Monads?</p>\n<p>A monad is a mathematical structure which is heavily used in (pure) functional programming, basically Haskell. However, there are many other mathematical structures available, like for example applicative functors, strong monads, or monoids. Some have more specific, some are more generic. Yet, monads are much more popular. Why is that?</p>\n</blockquote>\n<p>The comment to reply the question:</p>\n<blockquote>\n<p>As far as I recall, monads were popularised by Wadler, and at the time the idea of doing IO without tedious CPS and parsing without explicit state passing were huge selling points; it was a hugely exciting time. A.F.A.I.R., Haskell didn't do constructor classes, but Gofer (father of Hugs) did. Wadler proposed overloading list comprehension for monads, so the do notation came later. Once IO was monadic, monads became a big deal for beginners, cementing them as a major thing to grok. Applicatives are much nicer when you can, and Arrows more general, but they came later, and IO sells monads hard. \u2013 AndrewC May 9 '13 at 1:34</p>\n</blockquote>\n<p>The answer by @Conal is:</p>\n<blockquote>\n<p>I suspect that the disproportionately large attention given to this one particular type class (<code>Monad</code>) over the many others is mainly a historical fluke. People often associate <code>IO</code> with <code>Monad</code>, although the two are independently useful ideas (<a href=\"https://dl.dropboxusercontent.com/u/7810909/docs/what-does-monad-mean/what-does-monad-mean/chunk-html/ar01s02s02s02.html\" rel=\"nofollow noreferrer\">as are list reversal and bananas</a>). Because <code>IO</code> is magical (having an implementation but no denotation) and <code>Monad</code> is often associated with <code>IO</code>, it's easy to fall into magical thinking about <code>Monad</code>.</p>\n</blockquote>\n<p>First of all, I agree with them, and I think the usefulness of Monads mostly arises from Functors that we can embed many functions within the structure, and Monads is a little expansion for robustness of function composition by <code>join</code> : <code>M(M(X)) -&gt; M(X)</code> to avoid the nested type.</p>\n<p><strong>In the 2nd Question:</strong></p>\n<blockquote>\n<p>do we have to use monadic functions a -&gt; m b?</p>\n<p>so many tutorials around the web still insist to use a monadic functions since that is the Kleisli triple and the monad-laws.</p>\n</blockquote>\n<p>and many answers like</p>\n<blockquote>\n<p>I like to think of such an m as meaning &quot;plan-to-get&quot;, where &quot;plans&quot; involve some sort of additional interaction beyond pure computation.</p>\n</blockquote>\n<p>or</p>\n<blockquote>\n<p>In situations where <code>Monad</code> isn't necessary, it is often simpler to use <code>Applicative</code>, <code>Functor</code>, or just basic pure functions. In these cases, these things should be (and generally are) used in place of a <code>Monad</code>. For example:</p>\n</blockquote>\n<pre><code>ws &lt;- getLine &gt;&gt;= return . words  -- Monad\nws &lt;- words &lt;$&gt; getLine           -- Functor (much nicer)\n</code></pre>\n<blockquote>\n<p>To be clear: If it's possible without a monad, and it's simpler and more readable without a monad, then you should do it without a monad! If a monad makes the code more complex or confusing than it needs to be, don't use a monad! Haskell has monads for the sole purpose of making certain complex computations simpler, easier to read, and easier to reason about. If that's not happening, <em>you shouldn't be using a monad</em>.</p>\n</blockquote>\n<p>Reading their answers, I suppose their special feeling about Monad arises from the historical incident that Haskell community has happend to chose Monads in  Kleisli category to solve their problem(IO etc.)</p>\n<p>So, again, I think the usefulness of Monads mostly arises from Functors that we can embed many functions within the structure, and Monads is a little expansion for robustness of function composition by <code>join</code> : <code>M(M(X)) -&gt; M(X)</code> to avoid the nested type.</p>\n<p>In fact, in JavaScript I implemented as below..</p>\n<h3>Functor</h3>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>console.log(\"Functor\");\n{\n  const unit = (val) =&gt; ({\n    // contextValue: () =&gt; val,\n    fmap: (f) =&gt; unit((() =&gt; {\n      //you can do pretty much anything here\n      const newVal = f(val);\n    //  console.log(newVal); //IO in the functional context\n      return newVal;\n    })()),\n  });\n\n  const a = unit(3)\n    .fmap(x =&gt; x * 2)  //6\n    .fmap(x =&gt; x + 1); //7\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n<p>The point is we can implement whatever we like in the Functor structure, and in this case, I simply made it IO/<code>console.log</code> the value.</p>\n<p>Another point is, to do this Monads is absolutely unnecessary.</p>\n<h3>Monad</h3>\n<p>Now, based on the Functor implementation above, I add extra <code>join: MMX =&gt; MX</code> feature to avoid the nested structure that should be helpful for robustness of complex functional composition.</p>\n<p>The functionality is exactly identical to the Functor above, and please note the usage is also identical to the Functor <code>fmap</code>. This does not require a &quot;monadic function&quot; to <code>bind</code> (Kleisli composition of monads).</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>console.log(\"Monad\");\n{\n  const unit = (val) =&gt; ({\n    contextValue: () =&gt; val,\n    bind: (f) =&gt; {\n      //fmap value operation\n      const result = (() =&gt; {\n        //you can do pretty much anything here\n        const newVal = f(val);\n        console.log(newVal);\n        return newVal;\n      })();\n      //join: MMX =&gt; MX\n      return (result.contextValue !== undefined)//result is MX\n        ? result //return MX\n        : unit(result) //result is X, so re-wrap and return MX\n    }\n  });\n  //the usage is identical to the Functor fmap.\n  const a = unit(3)\n    .bind(x =&gt; x * 2)  //6\n    .bind(x =&gt; x + 1); //7\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n<h3>Monad Laws</h3>\n<p>Just in case, this implementation of the Monad satisfies the monad laws, and the Functor above does not.</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>console.log(\"Monad laws\");\n{\n  const unit = (val) =&gt; ({\n    contextValue: () =&gt; val,\n    bind: (f) =&gt; {\n      //fmap value operation\n      const result = (() =&gt; {\n        //you can do pretty much anything here\n        const newVal = f(val);\n        //console.log(newVal);\n        return newVal;\n      })();\n      //join: MMX =&gt; MX\n      return (result.contextValue !== undefined)\n        ? result\n        : unit(result)\n    }\n  });\n\n  const M = unit;\n  const a = 1;\n  const f = a =&gt; (a * 2);\n  const g = a =&gt; (a + 1);\n\n  const log = m =&gt; console.log(m.contextValue()) &amp;&amp; m;\n  log(\n    M(f(a))//==m , and f is not monadic\n  );//2\n  console.log(\"Left Identity\");\n  log(\n    M(a).bind(f)\n  );//2\n  console.log(\"Right Identity\");\n  log(\n    M(f(a))//m\n      .bind(M)// m.bind(M)\n  );//2\n  console.log(\"Associativity\");\n  log(\n    M(5).bind(f).bind(g)\n  );//11\n  log(\n    M(5).bind(x =&gt; M(x).bind(f).bind(g))\n  );//11\n\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n<p>So, here is my question.</p>\n<p>I may be wrong.</p>\n<p>Is there any counter example that Functors cannnot do what Monads can do except the robustness of functional composition by flattening the nested structure?</p>\n<p>What's so special about Monads in Kleisli category? It seems like it's fairly possible to implement Monads with a little expansion to avoid the nested structure of Functor and without the monadic functions <code>a -&gt; m b</code> that is the entity in Kleisli category.</p>\n<p>Thanks.</p>\n<p><strong>edit(2018-11-01)</strong></p>\n<p>Reading the answers, I agree it's not appropriate to perform <code>console.log</code> inside the IdentityFunctor that should satisfy Functor-laws, so I commented out like the Monad code.</p>\n<p>So, eliminating that problem, my question still holds:</p>\n<p><em>Is there any counter example that Functors cannnot do what Monads can do except the robustness of functional composition by flattening the nested structure?</em></p>\n<p><em>What's so special about Monads in Kleisli category? It seems like it's fairly possible to implement Monads with a little expansion to avoid the nested structure of Functor and without the monadic functions <code>a -&gt; m b</code> that is the entity in Kleisli category.</em></p>\n<p>An answer from @DarthFennec is:</p>\n<blockquote>\n<p>&quot;Avoiding the nested type&quot; is not in fact the purpose of <code>join</code>, it's just a neat side-effect. The way you put it makes it sound like <code>join</code> just strips the outer type, but the monad's value is unchanged.</p>\n</blockquote>\n<p>I believe &quot;Avoiding the nested type&quot; is not just a neat side-effect, but a definition of &quot;join&quot; of Monad in category theory,</p>\n<blockquote>\n<p>the multiplication natural transformation \u03bc:T\u2218T\u21d2T of the monad provides for each object X a morphism \u03bcX:T(T(X))\u2192T(X)</p>\n</blockquote>\n<p><a href=\"https://ncatlab.org/nlab/show/monad+%28in+computer+science%29\" rel=\"nofollow noreferrer\">monad (in computer science): Relation to monads in category theory</a></p>\n<p>and that's exactly what my code does.</p>\n<p>On the other hand,</p>\n<blockquote>\n<p>This is not the case. <code>join</code> is the heart of a monad, and it's what allows the monad to <em>do things</em>.</p>\n</blockquote>\n<p>I know many people implements monads in Haskell in this manner, but the fact is, there is <strong>Maybe functor</strong> in Haskell, that does not has <code>join</code>, or there is <strong>Free monad</strong> that <code>join</code> is embedded from the first place into the defined structure. They are objects that users define <strong>Functors to <em>do things</em></strong>.</p>\n<p>Therefore,</p>\n<blockquote>\n<p>You can think of a functor as basically a container. There's an arbitrary inner type, and around it an outer structure that allows some variance, some extra values to &quot;decorate&quot; your inner value. <code>fmap</code> allows you to work on the things inside the container, the way you would work on them normally. This is basically the limit of what you can do with a functor.</p>\n<p>A monad is a functor with a special power: where <code>fmap</code> allows you to work on an inner value, <code>bind</code> allows you to <em>combine outer values</em> in a consistent way. This is much more powerful than a simple functor.</p>\n</blockquote>\n<p>These observation does not fit the fact of the existence of Maybe functor and Free monad.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1541108362, "post_id": 53109343, "comment_id": 93114720, "body": "It vaguely resembles an <a href=\"https://wiki.haskell.org/Enumerator_and_iteratee\" rel=\"nofollow noreferrer\">iteratee</a>, but the type above uses the <code>b -&gt;</code> in a different place, exploiting polymorphic recursion (unlike an iteratee)."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1541108474, "post_id": 53109343, "comment_id": 93114765, "body": "As far as further reading material goes, a good starting point could be <a href=\"https://bartoszmilewski.com/2018/10/12/trading-funlists-at-a-bazaar-with-yoneda/\" rel=\"nofollow noreferrer\"><i>Trading FunLists at a Bazaar with Yoneda</i></a> at Bartosz Milewski&#39;s blog."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1541108513, "post_id": 53109343, "comment_id": 93114777, "body": "An <code>Iteratee</code> gets given a bunch of values and can build up whatever it wants, whereas this gives you values and you get to step through the computation that builds up a result in the same shape."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1541122414, "post_id": 53109343, "comment_id": 93118225, "body": "It reminds me of the notion of a \u201c[smart] view\u201d from <a href=\"https://www.fceia.unr.edu.ar/~mauro/pubs/smartviews/smartviews.pdf\" rel=\"nofollow noreferrer\">A Smart View on Datatypes</a>."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 2, "creation_date": 1541168133, "post_id": 53109343, "comment_id": 93134797, "body": "Could this type be a basis for a library like <a href=\"https://hackage.haskell.org/package/foldl-1.4.5/\" rel=\"nofollow noreferrer\">foldl</a>, but of composable traversals instead of folds?"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1541188690, "post_id": 53109343, "comment_id": 93144898, "body": "@Li-yaoXia possibly but they don\u2019t really compose the way folds do. It\u2019s sort of clear to me that if you have a fold for the sum and a fold for the count then you can compose into a fold for the (sum, count) and so get the average. However I\u2019m not sure how such traversals should compose. Perhaps this would be a useful way to express how to traverse over a composition of data structures, but why not just compose <code>traverse</code> with itself a sufficient number of times?"}], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1541182931, "creation_date": 1541106306, "last_edit_date": 1541182931, "question_id": 53109343, "link": "https://stackoverflow.com/questions/53109343/a-traversal-as-data", "title": "A traversal as data", "body": "<p>I heard about this construction which is loosely described as \u201ca traversal represented in data, applied to some structure, without the need for the applicative\u201d</p>\n\n<p>It can be defined as:</p>\n\n<pre><code>data X a b r =\n    | Done r\n    | Step a (X a b (b -&gt; r))\n</code></pre>\n\n<p>A word description would be as follows:</p>\n\n<ul>\n<li>the type <code>X a b r</code> describes the shape of a structure</li>\n<li>which contains things of type <code>a</code></li>\n<li>and for each <code>a</code> you get the opportunity to produce something of type <code>b</code></li>\n<li>and provided you do that for each <code>a</code>,</li>\n<li>you get something of type <code>r</code>.</li>\n</ul>\n\n<p>Thus a \u201ctraversal\u201d of a list, <code>[a]</code>, has type <code>X a b [b]</code>, because if you can turn each <code>a</code> of the list into a <code>b</code> then you get a <code>[b]</code>.</p>\n\n<p><strong>My question is</strong>: what is this thing called? Is there a reference to more information about it?</p>\n\n<hr>\n\n<p>Example usage:</p>\n\n<pre><code>instance Functor (X a b) where\n  fmap f (Done r) = f r\n  fmap f (Step a next) = Step a (fmap (f .) next)\n\nf :: [a] -&gt; X a b [b]\nf [] = Done []\nf (a:as) = Step a (fmap (flip (:)) as)\n\ng :: Applicative f =&gt; (a -&gt; f b) -&gt; X a b r -&gt; f r\ng f (Done r) = pure r\ng f (Step a next) = g f next &lt;*&gt; f a\n</code></pre>\n\n<p>More generally:</p>\n\n<pre><code>instance Applicative (X a b) where\n  pure x = Done x\n  Done f &lt;*&gt; y = fmap (\\y -&gt; f y) y\n  Step a next &lt;*&gt; y = Step a (fmap flip next &lt;*&gt; y)\n\nt :: Traversable t =&gt; t a -&gt; X a b (t b)\nt = traverse (\\a -&gt; Step a (Done id))\n</code></pre>\n\n<p>And, assuming I haven\u2019t made any errors, we should find that:</p>\n\n<pre><code>flip g . t == traverse\n</code></pre>\n\n<hr>\n\n<p>Edit: I\u2019ve thought about this some more. There is something this doesn\u2019t have which a <code>traversal</code> has: a <code>traversal</code> can split up the computation into something that isn\u2019t \u201cone at a time,\u201d for example to traverse a binary tree one can traverse the left and right half \u201cin parallel.\u201d Here is a structure that I think gives the same effect:</p>\n\n<pre><code>data Y a b r =\n  | Done r\n  | One a (b -&gt; r)\n  | forall s t. Split (Y a b s) (Y a b t) (s -&gt; t -&gt; r)\n</code></pre>\n\n<p>(Slightly vague syntax as I don\u2019t remember it and don\u2019t want to write this as a gadt)</p>\n\n<pre><code>f1 :: X a b r -&gt; Y a b r\nf1 (Done x) = Done x\nf1 (Step a next) = Split (One a id) (f1 next) (flip ($))\n\nf2 :: Y a b r -&gt; X a b r\nf2 (Done x) = Done x\nf2 (One a f) = Step a (Done f)\nf2 (Split x y f) = f &lt;$&gt; f2 x &lt;*&gt; f2 y\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1541100765, "post_id": 53107986, "comment_id": 93111607, "body": "At no point does your code compute <code>[[1,2]] ++ [[3,4]]</code>. There isn&#39;t even a <code>4</code> in your input list."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1541100766, "post_id": 53107986, "comment_id": 93111608, "body": "Try to stay away from <code>!!</code>. There are three classes of lists to consider: the empty list <code>[]</code>, the singleton list <code>x:[]</code> (aka <code>[x]</code>), and the general case <code>(x:y:ys)</code>. Also, solve the main problem for sorted lists with something like <code>check&#39; :: [Int] -&gt; [[Int]]</code>; then <code>check = check&#39; . sort</code>. There&#39;s no need to (re)sort the list in every recursive call."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541100957, "post_id": 53107986, "comment_id": 93111708, "body": "Hint: after recursively grouping <code>(y:ys)</code>, <code>x</code> either goes in a group by itself or gets added to the beginning of the group containing <code>y</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1541103125, "post_id": 53107986, "comment_id": 93112651, "body": "Dont&#39; use <code>length, !!, head, tail</code> unless you really have to -- usually you do not. Instead of checking <code>if length sorted &gt; 1 then ...</code> use <code>case sorted of (x1:x2:rest) -&gt; ... ; _ -&gt; ...</code> which gives you access to the first and second elements without <code>!!</code>."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1541101469, "post_id": 53108305, "comment_id": 93111933, "body": "<code>safeTail = drop 1</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1541102131, "post_id": 53108305, "comment_id": 93112235, "body": "Generalize to <code>(Eq a, Enum a) =&gt; [a] -&gt; [[a]]</code>, and all you have to check is that <code>n == succ x</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541102248, "post_id": 53108305, "comment_id": 93112277, "body": "@chepner: well it is a bit a pity that the <code>sort</code> step is nexessary for the &quot;outer&quot; <code>check</code> function :("}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541103005, "post_id": 53108305, "comment_id": 93112606, "body": "You could use <code>map toEnum . sort . map fromEnum</code> to sidestep the ordering requirement :)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541103181, "post_id": 53108305, "comment_id": 93112671, "body": "(or <code>sortBy (compare `on` fromEnum)</code>; not sure if that would be any more efficient)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541103232, "post_id": 53108305, "comment_id": 93112687, "body": "@chepner: well there is a functional difference I guess, since <code>fromEnum</code> for <code>Double</code> will truncate the result, so information can get &quot;lost&quot; with the <code>fromEnum</code> function."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541103791, "post_id": 53108305, "comment_id": 93112943, "body": "Ugh, <code>Double</code> has an <code>Enum</code> instance? <i>looks at it</i>. I&#39;m going to go out on a limb and say that no one should rely on that for anything."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541103963, "post_id": 53108305, "comment_id": 93113032, "body": "@chepner: well personally I find it a bit problematic, especially since the <code>succ x</code> for a double is not the next representable <code>Double</code>, but just incremented with <code>1</code>., and the saddest thing is that <code>fromEnum</code> truncates, so that means that <code>toEnum . fromEnum</code> is not the identity function, and that there are <code>Double</code>s between <code>x</code> and <code>succ x</code> :("}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541104319, "post_id": 53108305, "comment_id": 93113167, "body": "Yeah, that was the point I meant to make. It would be theoretically possible to define a real enumeration of any floating-point type (although in practice I think it would be infeasible, given that the difference between adjacent values isn&#39;t fixed). Probably best to just ignore <code>Enum Double</code> and the like, and if you choose to take advantage of it, <i>caveat emptor</i>."}, {"owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "edited": false, "score": 0, "creation_date": 1541120861, "post_id": 53108305, "comment_id": 93117919, "body": "@Willem Van Onsem I am really sorry to bother, but I am really just getting started with haskell. I don&#39;t quite understand the syntax of: go :: (Ord n, Num n) =&gt; [n] -&gt; [[n]]. I would Like to add an argument &quot;y&quot; (something like: go :: (Ord n, Num n) =&gt; [n] -&gt; Int -&gt; [[n]] ) and use it to find bigger whole between numbers, for example for y = 2 and [1,2,5,6,9] --&gt; [[2,5],[6,9]]? Also I noticed that It prints also the numbers that are alone (Example go [1,2,5,7,8,20] --&gt; [[1,2], ---&gt; [5] &lt;---,[7,8]]). Would it be possible to eliminate those numbers? I am really struggling with haskell syntax"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "edited": false, "score": 1, "creation_date": 1541147620, "post_id": 53108305, "comment_id": 93124603, "body": "@cheshire: I think you then better start with some list functions that are simpler, like <code>map</code> and <code>filter</code>, etc. See here for some details about the list data structure: <a href=\"http://learnyouahaskell.com/starting-out#an-intro-to-lists\" rel=\"nofollow noreferrer\">learnyouahaskell.com/starting-out#an-intro-to-lists</a>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1541103388, "last_edit_date": 1541103388, "creation_date": 1541101285, "answer_id": 53108305, "question_id": 53107986, "link": "https://stackoverflow.com/questions/53107986/understanding-lists-in-list-in-recursive-function-haskell/53108305#53108305", "title": "Understanding lists in list in recursive function - haskell", "body": "<p>A problem here is that you only append the <em>first sublist</em>:</p>\n\n<pre><code>then [[x]  ++ check(xs) !! 0]</code></pre>\n\n<p>You thus make a recursive call that will return a list of sublists, but you \"throw away\" all the lists but the first one, and you then concatenate the first one. The remaining sublists, are ignored.</p>\n\n<p>You can fix this with:</p>\n\n<pre><code>then [[x]  ++ check(xs) !! 0] ++ safeTail check\n</code></pre>\n\n<p>where we implement <code>safeTail</code> as:</p>\n\n<pre><code>safeTail :: [a] -&gt; [a]\nsafeTail (x:xs) = xs\nsafeTail [] = []\n</code></pre>\n\n<p>or, like <a href=\"https://stackoverflow.com/questions/53107986/understanding-lists-in-list-in-recursive-function-haskell/53108305?noredirect=1#comment93111933_53108305\">@melpomene says</a>:</p>\n\n<pre><code>safeTail :: [a] -&gt; [a]\nsafeTail = drop 1\n</code></pre>\n\n<p>Later it will turn out we can just use <code>tail</code>, but with the above code, that is difficult to see.</p>\n\n<p>but the implementation is not very \"Haskellish\". Your code uses a lot of <code>(!!)</code>s, and <code>length</code>s. Since <code>(!!)</code> runs in <em>O(k)</em> with <em>k</em> the index to of which we want to obtain the element, and <code>length</code> runs in <em>O(n)</em> with <em>n</em> the length of the list, this will also be quite inefficient.</p>\n\n<p>It makes sense to first sort the list before processing it further. Next we only have to look for the current element <code>x</code>, and the next element <code>n</code>, and the rest of the elements <code>xs</code>, so:</p>\n\n<pre><code>go :: (Ord n, Num n) =&gt; [n] -&gt; [[n]]\ngo (x:n:xs) = ...\ngo other = other\n</code></pre>\n\n<p>In case <code>n &lt;= x+1</code>, then we know that the difference between the two numbers is either zero or one, so in that case the <em>head</em> (first element) of the recursive call to check should be prepended with <code>x</code>, so we can write this like:</p>\n\n<pre><code>go :: (Ord n, Num n) =&gt; [n] -&gt; [[n]]\ngo (x:n:xs) | n &lt;= x+1 = (x:r) : rs\n            | otherwise = ...\n   where (r:rs) = go (n:xs)\ngo [x] = [[x]]\ngo [] = []\n</code></pre>\n\n<p>otherwise we can just construct a singleton list, followed by the rest of the list:</p>\n\n<pre><code>go :: (Ord n, Num n) =&gt; [n] -&gt; [[n]]\ngo (x:n:xs) | n &lt;= x+1 = (x:r) : rs\n            | otherwise = [x]:(r:rs)\n    where (r:rs) = go (n:xs)\ngo [x] = [[x]]\ngo [] = []\n</code></pre>\n\n<p>we know that <code>go (n:xs)</code> has at least one element, since we call the list recursively with one element, and in all cases where the list is non-empty, we return a non-empty list.</p>\n\n<p>By using an <em>as-pattern</em>, we can make this a bit more elegant:</p>\n\n<pre><code>go :: (Ord n, Num n) =&gt; [n] -&gt; [[n]]\ngo (x:na@(n:xs)) | n &lt;= x+1 = (x:r) : rs\n                 | otherwise = [x]: ra\n    where ra@(~(r:rs)) = go na\ngo [x] = [[x]]\ngo [] = []\n</code></pre>\n\n<p>We can generalize the above, like <a href=\"https://stackoverflow.com/questions/53107986/understanding-lists-in-list-in-recursive-function-haskell/53108305?noredirect=1#comment93112235_53108305\">@chepner says</a>, to require only the <code>Eq a</code>, and <code>Ord a</code>:</p>\n\n<pre><code>go :: (Ord n, Enum n) =&gt; [n] -&gt; [[n]]\ngo (x:na@(n:xs)) | succ x &gt;= n = (x:r) : rs\n                 | otherwise = [x]: ra\n    where ra@(~(r:rs)) = go na\ngo [x] = [[x]]\ngo [] = []\n</code></pre>\n\n<p>So now we only need to express <code>check</code> in terms of <code>go</code>, with:</p>\n\n<pre><code>import Data.List(sort)\n\ncheck :: (Ord n, Enum n) =&gt; [n] -&gt; [[n]]\ncheck = go . sort\n    where go (x:na@(n:xs)) | succ x &gt;= n = (x:r) : rs\n                           | otherwise = [x]: ra\n              where ra@(~(r:rs)) = go na\n          go [x] = [[x]]\n          go [] = []\n</code></pre>\n\n<p>or we can let the <code>check</code> function operate on <code>(Eq n, Enum n)</code> types:</p>\n\n<pre><code>import Data.List(sortBy)\nimport Data.Ord(comparing)\n\ncheck :: (Ord n, Enum n) =&gt; [n] -&gt; [[n]]\ncheck = go . sortBy (comparing fromEnum)\n    where go (x:na@(n:xs)) | succ x == n || x == n = (x:r) : rs\n                           | otherwise = [x]: ra\n              where ra@(~(r:rs)) = go na\n          go [x] = [[x]]\n          go [] = []\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575305748, "post_id": 53191704, "comment_id": 104513181, "body": "for me, <code>splitConsequtives [] = [] ; splitConsequtives xs =  foldr ($) [[last xs]] $ zipWith f xs $ tail xs  where   f x y ~(g:gs) | x+1 == y  =  (x : g) : gs  | otherwise =  [x] : g : gs</code> is more readable and clear. :)"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575316196, "post_id": 53191704, "comment_id": 104517448, "body": "@WillNess Respect..! While honestly, i think, people coding in Haskell should know applicatives by heart as a reflex in their mind set so that my code should be straightforward to read. I believe only then one may get comfortable with the tricks like continuation passing (like we did in our recent answers). I also don&#39;t like  the list comprehensions and the <b>do</b> notation but that&#39;s another thing for another time :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575317891, "post_id": 53191704, "comment_id": 104518136, "body": "I actually do like LCs and <code>do</code> very much. even MCs, MonadComprehensions. matters of taste..."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1575358579, "post_id": 53191704, "comment_id": 104529163, "body": "(I used to hate <code>do</code> before I learned to love it. :) but I like my <code>do</code>s with explicit separators -- braces and semicolons all the way. the &quot;naked&quot; <code>do</code> code I do dislike. maybe that&#39;s the old lisper in me, but have your code break because of one accidental space? what is that? )"}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 2, "last_activity_date": 1541618410, "last_edit_date": 1541618410, "creation_date": 1541601735, "answer_id": 53191704, "question_id": 53107986, "link": "https://stackoverflow.com/questions/53107986/understanding-lists-in-list-in-recursive-function-haskell/53191704#53191704", "title": "Understanding lists in list in recursive function - haskell", "body": "<p>Well this is an interesting question and here is an experimental approach in applicative style. Yes it looks a little convoluted but in fact very simple. The only thing that i don't like is the usage of <code>last</code> function. May be we can find a way to drop that somehow.</p>\n\n<pre><code>splitConsequtives :: Integral a =&gt; [a] -&gt; [[a]]\nsplitConsequtives xs = foldr id [[last xs]] $ zipWith f &lt;*&gt; tail $ xs\n                       where f x y | y-x == 1  = (:) &lt;$&gt; (x:) . head &lt;*&gt; tail\n                                   | otherwise = ([x]:)\n\n*Main&gt; splitConsequtives [1,2,3,6,7]\n[[1,2,3],[6,7]]\n*Main&gt; splitConsequtives [-1,2,3,6,8,9]\n[[-1],[2,3],[6],[8,9]]\n</code></pre>\n\n<p>The idea is to place the constructor functions in a list those will eventually construct our whole result list when chained up by folding. List constructor <code>(:)</code> is right associative and that's why i use <code>foldr</code>.</p>\n\n<p>It all starts with <code>zipWith</code>ing our <code>xs</code> list with it's <code>tail</code> by the <code>f</code> function like <code>zipWith f xs (tail xs)</code>. The <code>f :: a -&gt; a -&gt; [[a]] -&gt; [[a]]</code> function is where we get our applicatives  as elements of the resulting list.</p>\n\n<p>OK..! Now lets focus at the <code>f</code> function which takes <code>x</code> and <code>y</code> as parameters.</p>\n\n<ul>\n<li>If <code>y</code> is subsequent of <code>x</code> then our <code>[[a]] -&gt; [[a]]</code> type function\nis <code>(:) &lt;$&gt; (x:) . head &lt;*&gt; tail</code> which takes a list of lists of\nnumbers then takes the sublist at the <code>head</code>, appends <code>x</code> to it and\nputs everything back together. So if our result being constructed\n(the accumulator parameter of <code>foldr</code>) is <code>[[7], [9,10]]</code> and <code>x</code> is\n<code>6</code> then we shall get <code>[[6,7],[9,10]]</code>.</li>\n<li>If <code>y</code> is not a subsequent of <code>x</code> then our <code>[[a]] -&gt; [[a]]</code> type\nfunction is <code>([x]:)</code>. So if our result being constructed (the\naccumulator parameter of <code>foldr</code>) is <code>[[6,7], [9,10]]</code> and <code>x</code> is <code>3</code>\nthen we shall get <code>[[3],[6,7],[9,10]]</code>.</li>\n</ul>\n\n<p>One interesting point to notice is the type of iterating function that we use for <code>foldr :: Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b</code>. You expect it to be of type <code>a -&gt; b -&gt; b</code> but <code>id :: a -&gt; a</code> looks different. How is this possible..? I believe it is because <code>a ~ [[a]] -&gt; [[a]]</code> and <code>b ~ [[a]]</code> in <code>(a -&gt; b -&gt; b)</code> of <code>foldr</code>.</p>\n"}], "owner": {"reputation": 996, "user_id": 7907300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e028848530c7b0b75a1142879de5a48?s=128&d=identicon&r=PG&f=1", "display_name": "cheshire", "link": "https://stackoverflow.com/users/7907300/cheshire"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 53108305, "answer_count": 2, "score": 1, "last_activity_date": 1541618410, "creation_date": 1541099940, "question_id": 53107986, "link": "https://stackoverflow.com/questions/53107986/understanding-lists-in-list-in-recursive-function-haskell", "title": "Understanding lists in list in recursive function - haskell", "body": "<p>I am writing a function to order a given list by tuples or triples. It should order it by numbers that are between two elements of the list.</p>\n\n<p>for example if given list is <code>[1,2,3,6,7]</code> it should return <code>[[1,2,3], [6,7]]</code>\nbecause there is zero numbers between <strong>1,2</strong> and <strong>2,3</strong> and also between <strong>6,7</strong></p>\n\n<p><strong>here is my code</strong>: </p>\n\n<pre><code>import Data.List \n\ncheck :: [Int] -&gt; [[Int]]\ncheck listCopy@(x:xs) = \n    let sorted = sort (listCopy) \n        in if (length sorted &gt; 1) \n              then if ((sorted !! 1 ) - (sorted !! 0)) == 1 || ((sorted !! 1 ) - (sorted !! 0)) == 0 \n                      then [[x]  ++ check(xs) !! 0] \n                      else [[x]] ++ check(xs)\n              else [[x]]\ncheck [] = [[]]\n</code></pre>\n\n<p><code>if ((sorted !! 1 ) - (sorted !! 0)) == 1 || ((sorted !! 1 ) - (sorted !! 0)) == 0</code> is checking if there is 0 numbers between two elements of the list</p>\n\n<p>If above statement is True then <code>[[x]  ++ check(xs) !! 0]</code> will add that element to the list and call the function again and take the 1st element that it returns. Example: <code>[1,2,3,6,7] -&gt; [[1 ++ check [2,3,6,7]]] -&gt; [[1,2 ++ check[3,6,7]]]</code> and so on... </p>\n\n<p>However when <code>if ((sorted !! 1 ) - (sorted !! 0)) == 1 || ((sorted !! 1 ) - (sorted !! 0)) == 0</code>is False it should <code>else [[x]] ++ check(xs)</code> set the element inside a list inside a list and call function again AND make another new list inside of list. Example: <code>[[1,2 ++ check[3,6,7]]]</code> -> is 6-3 == 0 or 1(False) return <code>[[1,2,3]] + check[6,7]</code> which should result in [[1,2,3], [6,7]]</p>\n\n<p>Calling <code>check[1,2,3,6,7]</code> however returns <code>[[1,2,3]]</code>. I am getting no error, \nbut as I know <code>[[1,2]] ++ [[3,4]]</code> should result in <code>[[1,2], [3,4]]</code> and thats exactly what I am doing in <code>else [[x]] ++ check(xs)</code> and somehow my function ends there. Where did I make mistake or it does something that I am missing? </p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1541095312, "post_id": 53106334, "comment_id": 93109015, "body": "Note it <i>would</i> work if you used <code>Control.Monad.join</code>, instead of your own definition, for the reasons given in <a href=\"https://stackoverflow.com/a/53106377/1126841\">luqui&#39;s answer</a>."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1541186559, "post_id": 53106377, "comment_id": 93144060, "body": "If you add <code>:set -fprint-explicit-foralls</code> then <code>:info join</code> gives the type as <code>forall {m :: * -&gt; *} {a}. Monad m =&gt; m (m a) -&gt; m a</code>, while <code>:info</code> for the version from <code>Control.Monad</code> shows as <code>forall (m :: * -&gt; *) a. \u2026</code>\u2014as in the paper, the curly braces indicate that a type parameter isn\u2019t from a type signature and thus can\u2019t be used with visible type applications."}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 1, "creation_date": 1541533099, "post_id": 53106377, "comment_id": 93247696, "body": "Why does <code>:type join</code> still give <code>{a}</code> even if the type signature is explicit?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1541534329, "post_id": 53106377, "comment_id": 93248272, "body": "@MarkNeu, my guess is that <code>:type join</code> is asking about the <i>expression</i> <code>join</code>, i.e. a particular use of it, where the type variables have been instantiated and then re-abstracted.  Whereas <code>:info</code> join is asking about the <code>join</code> definition itself.  /cc @JonPurdy"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 13, "last_activity_date": 1541094512, "last_edit_date": 1541094512, "creation_date": 1541093390, "answer_id": 53106377, "question_id": 53106334, "link": "https://stackoverflow.com/questions/53106334/why-doesnt-ghci-allow-type-arguments-for-this-version-of-join/53106377#53106377", "title": "Why doesn&#39;t GHCi allow type arguments for this version of join?", "body": "<p>Type applications only work for definitions that have explicit type signatures.</p>\n\n<pre><code>&gt;&gt;&gt; join :: (Monad m) =&gt; m (m a) -&gt; m a; join = (&gt;&gt;= id)\n&gt;&gt;&gt; :t join @[]\njoin @[] :: [[a]] -&gt; [a]\n</code></pre>\n\n<p>All the gory details (and there are quite a few) of this extension are in the paper <a href=\"https://www.seas.upenn.edu/~sweirich/papers/type-app-extended.pdf\" rel=\"noreferrer\">Visible Type Application</a>.</p>\n"}], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 1, "accepted_answer_id": 53106377, "answer_count": 1, "score": 7, "last_activity_date": 1541096224, "creation_date": 1541093216, "last_edit_date": 1541096224, "question_id": 53106334, "link": "https://stackoverflow.com/questions/53106334/why-doesnt-ghci-allow-type-arguments-for-this-version-of-join", "title": "Why doesn&#39;t GHCi allow type arguments for this version of join?", "body": "<p>I've tried toying around with <code>TypeApplications</code>, and used the following:</p>\n\n<pre><code> join = (&gt;&gt;= id)\n :t join\njoin :: Monad m =&gt; m (m a) -&gt; m a\n :t join @[]\n</code></pre>\n\n<p>But I get the following error:</p>\n\n<pre><code>&lt;interactive&gt;:1:1: error:\n    * Cannot apply expression of type `m0 (m0 b0) -&gt; m0 b0'\n      to a visible type argument `[]'\n    * In the expression: join @[]\n</code></pre>\n\n<p>This, in my view, should work, as</p>\n\n<pre><code> :t fmap @[]\nfmap @[] :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>works.</p>\n"}, {"tags": ["haskell", "hspec", "hakyll"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1541093342, "post_id": 53106288, "comment_id": 93108032, "body": "You might want to test this with your own <code>MonadMetadata</code> instance, creating a whole <code>Compiler</code> or <code>Rules</code> value for this will be overly complicated."}, {"owner": {"reputation": 3754, "user_id": 604382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b768ebe08698de5cf097fbaa2e66f9cf?s=128&d=identicon&r=PG", "display_name": "declension", "link": "https://stackoverflow.com/users/604382/declension"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1541095099, "post_id": 53106288, "comment_id": 93108906, "body": "Great - I started down that route (<code>newtype FakeMetadata</code> with lots of instances) but even that seemed a little aimless to me... I guess I need a <code>runFakeMetadata</code> or something?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1541100014, "post_id": 53106288, "comment_id": 93111260, "body": "I guess you could use a <code>Reader</code>-like data type for <code>MonadMetadata</code>, with a <code>Metadata</code> environment. For pattern matches, probably just ignore the pattern and always return an empty list. And yes, in the end you would want to <code>run</code> the reader with example objects."}, {"owner": {"reputation": 3754, "user_id": 604382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b768ebe08698de5cf097fbaa2e66f9cf?s=128&d=identicon&r=PG", "display_name": "declension", "link": "https://stackoverflow.com/users/604382/declension"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1541170484, "post_id": 53106288, "comment_id": 93136275, "body": "Thanks. Haven&#39;t managed to work this out still though"}], "answers": [{"tags": [], "owner": {"reputation": 3754, "user_id": 604382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b768ebe08698de5cf097fbaa2e66f9cf?s=128&d=identicon&r=PG", "display_name": "declension", "link": "https://stackoverflow.com/users/604382/declension"}, "is_accepted": true, "score": 1, "last_activity_date": 1559906526, "last_edit_date": 1559906526, "creation_date": 1541355042, "answer_id": 53143861, "question_id": 53106288, "link": "https://stackoverflow.com/questions/53106288/testing-with-hakylls-monadmetadata/53143861#53143861", "title": "Testing with Hakyll&#39;s MonadMetadata", "body": "<p>Eventually (and thanks to @Bergi's suggestions) I got something working, and then tidied up:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\ntype KeyedValuesOf a = [(String, a)]\n\n-- | Create Metadata from basic list of key-values -- stolen from Hakyll itself.\nmeta :: Yaml.ToJSON a =&gt; KeyedValuesOf a -&gt; Metadata\nmeta pairs = HMS.fromList [(T.pack k, Yaml.toJSON v) | (k, v) &lt;- pairs]\n\n-- | A 'Reader' class of our own, with a specialised environment\n--   for key-value metadata pairs.\nnewtype MonadMetadataReader a =\n    MonadMetadataReader {runMonadMetadataReader :: KeyedValuesOf String -&gt; a}\n        deriving (Functor, Applicative, Monad)\n\n-- | Simple 'Metadata' holder.\n-- There are never any matches found,\n-- and all metadata (for all items)\n-- comes from from the Reader-like environment at setup.\ninstance MonadMetadata MonadMetadataReader where\n    getMetadata identifier = MonadMetadataReader meta\n\n    getMatches pattern = return []\n</code></pre>\n\n<p>Which allowed simple unit tests like:</p>\n\n<pre><code>it \"enables for a value of \\\"false\\\"\" $ do\n    let enabled = runMonadMetadataReader (unlessEnabled \"key\" item) [(\"key\", \"false\")]\n    enabled `shouldBe` True\n\nit \"disables for a value of \\\"true\\\"\" $ do\n    let enabled = runMonadMetadataReader (unlessEnabled \"key\" item) [(\"key\", \"true\")]\n    enabled `shouldBe` False\n\nit \"enables if no metadata found\" $ do\n    let enabled = runMonadMetadataReader (unlessEnabled \"key\" item) []\n    enabled `shouldBe` True\n</code></pre>\n"}], "owner": {"reputation": 3754, "user_id": 604382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b768ebe08698de5cf097fbaa2e66f9cf?s=128&d=identicon&r=PG", "display_name": "declension", "link": "https://stackoverflow.com/users/604382/declension"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 53143861, "answer_count": 1, "score": 0, "last_activity_date": 1559906526, "creation_date": 1541093024, "question_id": 53106288, "link": "https://stackoverflow.com/questions/53106288/testing-with-hakylls-monadmetadata", "title": "Testing with Hakyll&#39;s MonadMetadata", "body": "<p>For our Hakyll codebase, I've written a few helper methods and have started adding some HSpec unit tests around newer ones e.g.:</p>\n\n<pre><code>-- | Reject an item unless @fieldName@ is set to \"true\"\nunlessEnabled :: MonadMetadata m\n              =&gt; String\n              -&gt; Item a\n              -&gt; m Bool\nunlessEnabled fieldName item = do\n    maybeValue &lt;- getMetadataBool (itemIdentifier item) fieldName\n    return $ maybe True not maybeValue\n\n-- | Try to look up a boolean field (\"true\" maps to @Just True@)\ngetMetadataBool :: MonadMetadata m\n                =&gt; Identifier\n                -&gt; String\n                -&gt; m (Maybe Bool)\ngetMetadataBool ident name = do\n    maybeString &lt;- getMetadataField ident name\n    return $ ((== \"true\") . map toLower) &lt;$&gt; maybeString\n</code></pre>\n\n<p>Now creating an <code>Item</code> or <code>Identifier</code> for testing is easy enough, but I'm not sure where to go with the <a href=\"https://jaspervdj.be/hakyll/reference/Hakyll-Core-Metadata.html#t:MonadMetadata\" rel=\"nofollow noreferrer\"><code>MonadMetadata</code></a> when running an Hspec.</p>\n\n<p>I've seen <a href=\"https://github.com/jaspervdj/hakyll/blob/1abdeee743d65d96c6f469213ca6e7ea823340a7/tests/TestSuite/Util.hs#L56\" rel=\"nofollow noreferrer\"><code>testCompiler</code></a> which feels like it might be copyable / useful (<a href=\"https://github.com/jaspervdj/hakyll/blob/1abdeee743d65d96c6f469213ca6e7ea823340a7/lib/Hakyll/Core/Compiler/Internal.hs#L173\" rel=\"nofollow noreferrer\"><code>Compiler</code> has a <code>MonadMetadata</code> instance</a>), but I'm out of my Haskell-depth here...</p>\n"}, {"tags": ["haskell", "property-based-testing", "haskell-hedgehog"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 1, "creation_date": 1541100025, "post_id": 53106042, "comment_id": 93111268, "body": "Having <code>forAllT</code> as part of the external API seems like a good feature to request from Hedgehog."}, {"owner": {"reputation": 9946, "user_id": 467754, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3rEtR.png?s=128&g=1", "display_name": "Nikos Baxevanis", "link": "https://stackoverflow.com/users/467754/nikos-baxevanis"}, "edited": false, "score": 0, "creation_date": 1541173263, "post_id": 53106042, "comment_id": 93137825, "body": "There was actually <a href=\"https://github.com/hedgehogqa/haskell-hedgehog/pull/206\" rel=\"nofollow noreferrer\">a PR for it</a> but it was closed by its author. We <i>do</i> consider exposing <code>forAllT</code> and <code>forAllWithT</code> though."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1541173717, "post_id": 53106042, "comment_id": 93138069, "body": "I was about to open an issue, but indeed, I saw that <a href=\"https://github.com/hedgehogqa/haskell-hedgehog/issues/208\" rel=\"nofollow noreferrer\">somebody requested this already</a>. It seems exposing <code>forAllT</code> would be a small change, however I wonder if there are good reasons for keeping this <code>Internal</code>."}, {"owner": {"reputation": 9946, "user_id": 467754, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3rEtR.png?s=128&g=1", "display_name": "Nikos Baxevanis", "link": "https://stackoverflow.com/users/467754/nikos-baxevanis"}, "edited": false, "score": 1, "creation_date": 1541189980, "post_id": 53106042, "comment_id": 93145398, "body": "Those where added in <a href=\"https://github.com/hedgehogqa/haskell-hedgehog/pull/99/files/\" rel=\"nofollow noreferrer\">github.com/hedgehogqa/haskell-hedgehog/pull/99/files</a>. We should have probably exposed them back then."}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1541092059, "creation_date": 1541092059, "question_id": 53106042, "link": "https://stackoverflow.com/questions/53106042/how-to-use-gent-in-hedgehog", "title": "How to use `GenT` in `hedgehog`", "body": "<p>In the <code>hedgehog</code> library, there is a <a href=\"http://hackage.haskell.org/package/hedgehog-0.6.1/docs/Hedgehog.html#t:GenT\" rel=\"nofollow noreferrer\"><code>GenT</code></a> monad transformer. However the <a href=\"http://hackage.haskell.org/package/hedgehog-0.6.1/docs/Hedgehog.html#v:forAll\" rel=\"nofollow noreferrer\"><code>forAll</code></a> function takes a <code>Gen</code> type.</p>\n\n<p>There is a <a href=\"http://hackage.haskell.org/package/hedgehog-0.6.1/docs/src/Hedgehog.Internal.Property.html#forAllT\" rel=\"nofollow noreferrer\"><code>forAllT</code></a> function, but it is in an <code>Internal</code> module. </p>\n\n<p>So if I'd like to use a generator monad transformer with a specific monad (say <code>State</code>), what would be the way of making use of such a <code>GenT</code>?</p>\n"}, {"tags": ["haskell", "types", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1541091216, "post_id": 53105637, "comment_id": 93106881, "body": "The last claim is not necessarily so, thanks to <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow noreferrer\">the dreaded monomorphism restriction</a>. But of course it becomes so if you turn that restriction off."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1541091261, "post_id": 53105637, "comment_id": 93106902, "body": "Let&#39;s pretend it is off :)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1541091093, "last_edit_date": 1541091093, "creation_date": 1541090493, "answer_id": 53105637, "question_id": 53105436, "link": "https://stackoverflow.com/questions/53105436/no-instance-for-num-p-arising-from-a-use-of/53105637#53105637", "title": "No instance for (Num p) arising from a use of `+&#39;", "body": "<p>You've defined <code>wtf</code> to work for <em>any</em> type <code>p</code>, not just types that have <code>Num</code> instances. You need to include the constraint in your type annotation.</p>\n\n<pre><code>wtf :: Num p =&gt; [p]\nwtf = myZipWith (+) (Point [1,2,3]) (Point [4,5,6])\n</code></pre>\n\n<p>This is the solution the suggested possible fix alludes to (i.e., \"add[ing] <code>Num p</code> to the context of the type signature\"). <code>myZip</code> and <code>myZipWith</code> don't need the annotation, because there is nothing <code>Num</code>-specific about them. Only the definition of <code>wtf</code>, which uses <code>(+) :: Num a =&gt; a -&gt; a -&gt; a</code>, requires the additional constraint.</p>\n\n<p>If you had left off the type annotation, and simply wrote <code>wtf = myZipWith (+) (Point [1,2,3]) (Point [4,5,6])</code>, then Haskell would have inferred the type <code>Num a =&gt; [a]</code> for the list. Your explicit, overly general type prevented the inference from happening.</p>\n"}], "owner": {"reputation": 25, "user_id": 6779366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/627cb04fc23f098c5d8afd8593c4e7d9?s=128&d=identicon&r=PG&f=1", "display_name": "glow", "link": "https://stackoverflow.com/users/6779366/glow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "closed_date": 1541096362, "accepted_answer_id": 53105637, "answer_count": 1, "score": 1, "last_activity_date": 1541091370, "creation_date": 1541089746, "last_edit_date": 1541091370, "question_id": 53105436, "link": "https://stackoverflow.com/questions/53105436/no-instance-for-num-p-arising-from-a-use-of", "closed_reason": "Duplicate", "title": "No instance for (Num p) arising from a use of `+&#39;", "body": "<p>If I execute <code>myZipWith (+) (Point [1,2,3]) (Point [4,5,6])</code> from the GHCi terminal everything is OK, but if I try to execute it from a simple function, it gives me error.</p>\n\n<p>Why is the execution directly from the terminal different even if the code is the same?</p>\n\n<p>This is my code:</p>\n\n<pre><code>data Point p = Point [p]\nderiving (Show)\n\nwtf :: [p]\nwtf = myZipWith (+) (Point [1,2,3]) (Point [4,5,6])\n\nmyZip :: Point p -&gt; Point p -&gt; [(p, p)]\nmyZip (Point []) _ = []\nmyZip _ (Point []) = []\nmyZip (Point (a:as)) (Point (b:bs)) = (a, b) : myZip (Point as) (Point bs)\n\n\nmyZipWith :: (p -&gt; p -&gt; p) -&gt; Point p -&gt; Point p -&gt; [p]\nmyZipWith f (Point p1) (Point p2) = [ f (fst x) (snd x) | x &lt;- (myZip (Point p1) (Point p2)) ]\n</code></pre>\n\n<p>Error code: </p>\n\n<pre><code>No instance for (Num p) arising from a use of `+'\n      Possible fix:\n        add (Num p) to the context of\n          the type signature for:\n            wtf :: forall p. [p]\n    * In the first argument of `myZipWith', namely `(+)'\n      In the expression:\n        myZipWith (+) (Point [1, 2, 3]) (Point [4, 5, 6])\n      In an equation for `wtf':\n          wtf = myZipWith (+) (Point [1, 2, 3]) (Point [4, 5, 6])\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3587, "user_id": 7824574, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a639be4c9ecc139065fbc6b12b87e6a9?s=128&d=identicon&r=PG&f=1", "display_name": "typetetris", "link": "https://stackoverflow.com/users/7824574/typetetris"}, "edited": false, "score": 0, "creation_date": 1541091615, "post_id": 53105392, "comment_id": 93107111, "body": "This should be posted on <a href=\"https://codereview.stackexchange.com/\">codereview</a>"}, {"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 2, "creation_date": 1541093886, "post_id": 53105392, "comment_id": 93108320, "body": "<code>S.size (S.unions xss) == sum (fmap S.size xss)</code> might be the easiest way to do it.  (Doesn&#39;t shortcut on the first duplicate, if that matters.)"}], "answers": [{"tags": [], "owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "is_accepted": true, "score": 1, "last_activity_date": 1541116095, "last_edit_date": 1541116095, "creation_date": 1541115344, "answer_id": 53110826, "question_id": 53105392, "link": "https://stackoverflow.com/questions/53105392/mutually-exclusive-events-probability-theory/53110826#53110826", "title": "Mutually Exclusive Events (Probability Theory)", "body": "<p>It's a really good start. I think we can identify two goals:</p>\n\n<ol>\n<li>we don't want our algorithm to be quadratic in the number of sub-sets</li>\n<li>we want our loop over the input set of sets to truly short-circuit as soon as we determine there is overlap</li>\n</ol>\n\n<p>We would fail at 1 if we tried the naive solution of checking the intersection of each pair of sub-sets in turn. In your solution you've recognized or intuited that if <code>s1</code> intersects with <code>s2</code> then it also intersects with the union of <code>s2</code> and <code>s3</code> so you can accumulate a union and check for intersection in one pass and save work.</p>\n\n<p>You also partially succeed at (2) in that you avoid doing meaningful work as soon as you find an intersection. The only deficiency is you still have to traverse the entire list. We'd like <code>mutuallyExclusiveEvents</code> to truly short-circuit, that is it should work on infinite lists. A good way to test this when you're developing is using <code>undefined</code>:</p>\n\n<pre><code>*Main S&gt; mutuallyExclusiveEvents' ([S.fromList [1,3,5], S.fromList [10,12,1]] ++ undefined )\n*** Exception: Prelude.undefined\nCallStack (from HasCallStack):\n  error, called at libraries/base/GHC/Err.hs:79:14 in base:GHC.Err\n  undefined, called at &lt;interactive&gt;:95:93 in interactive:Ghci3\n</code></pre>\n\n<p>Due to laziness <code>foldr</code> (and other functions implemented in terms of it), <code>scanr</code> etc. can truly shortcircuit in the way that we want, e.g.:</p>\n\n<pre><code>*Main S&gt; foldr (&amp;&amp;) True ([True, False] ++ undefined )\nFalse\n</code></pre>\n\n<p>The trick is that if you want to be able to short-circuit when some condition holds, the function <code>:: a -&gt; b -&gt; b</code> you pass to <code>foldr</code> must be able to return a result without inspecting the second argument (of type <code>b</code>), i.e. it must be lazy in its second argument. Vice versa for <code>foldl</code>.</p>\n\n<p>Here's the solution I came up with:</p>\n\n<pre><code>mutuallyExclusiveEvents\n  :: (Ord a) =&gt; [S.Set a] -&gt; Bool\nmutuallyExclusiveEvents xss = \n  all nonOverlapping $ zip xss $ scanl S.union S.empty xss\n    where nonOverlapping (s1, s2) = S.null $ S.intersection s1 s2\n</code></pre>\n\n<p>One way of looking at the functions above: <code>scanl</code> and <code>zip</code> are both <em>productive</em> ( inspecting the head of the resulting list only requires one step of evaluation) while <code>all</code> short-circuits in the way we've just been talking about.</p>\n\n<p>Note it's less general than yours, working only over lists. I thought to rewrite it without <code>zip</code> but with scanl1 but was surprised to find that is not polymorphic in <code>Traversable</code> (there may be a good reason).</p>\n\n<p><strong>EDIT</strong>: also as you probably know you can likely get very sophisticated with your approach to this (and related) problems if you want to, especially if false-positives or approximations are okay, e.g. <a href=\"https://en.wikipedia.org/wiki/HyperLogLog\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/HyperLogLog</a></p>\n"}], "owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 53110826, "answer_count": 1, "score": 2, "last_activity_date": 1541150122, "creation_date": 1541089608, "last_edit_date": 1541150122, "question_id": 53105392, "link": "https://stackoverflow.com/questions/53105392/mutually-exclusive-events-probability-theory", "title": "Mutually Exclusive Events (Probability Theory)", "body": "<p>Data.Set and Data.List have not a function for intersectionS. </p>\n\n<p>As I was interested in mutually exclusive events, I wrote the following function.</p>\n\n<p>Is it correct? Is it efficient?</p>\n\n<pre><code>mutuallyExclusiveEvents\n  :: (Foldable t, Ord a) =&gt; t (S.Set a) -&gt; Bool\nmutuallyExclusiveEvents xss = \n    isJust $ foldr (\\xs acc -&gt; case acc of\n                                 Nothing -&gt; Nothing\n                                 Just s  -&gt; if any (`S.member` s) xs\n                                            then Nothing\n                                            else Just (S.union xs s)\n                   ) (Just $ S.empty) xss\n</code></pre>\n\n<p>EXAMPLES</p>\n\n<pre><code>mutuallyExclusiveEvents [S.fromList [1,3,5], S.fromList [2,4,6], S.fromList [10,12,1]] == False\n\nmutuallyExclusiveEvents [S.fromList [1,3,5], S.fromList [2,4,6], S.fromList [10,12]] == True\n</code></pre>\n"}, {"tags": ["haskell", "error-handling", "command-line-interface", "user-experience"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541088894, "post_id": 53104972, "comment_id": 93105587, "body": "Why do you use <code>Encode { config :: String, message :: String }</code> rather than <code>{ config :: EnigmaConfig, ... }</code>?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541090731, "post_id": 53104972, "comment_id": 93106627, "body": "@leftaroundabout: That&#39;s for command dispatch, which expects strings entered on the command line, no? How would I enter an <code>EnigmaConfig</code> on the command line (in a usable way)?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541090795, "post_id": 53104972, "comment_id": 93106667, "body": "Well, through a suitable parser, which seems to be what you want anyways."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541091108, "post_id": 53104972, "comment_id": 93106818, "body": "@leftaroundabout: The command line syntax is as <a href=\"https://github.com/orome/crypto-enigma-hs/blob/new/cli/enigma.hs#L72\" rel=\"nofollow noreferrer\">in the examples</a>: the config is specified as a string. Read, mostly through the constructor, should handle all the parsing and validation."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541091809, "post_id": 53104972, "comment_id": 93107222, "body": "Don&#39;t you think <i>the <b>parser</b></i> should handle all the <b>parsing</b> and validation?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541092172, "post_id": 53104972, "comment_id": 93107407, "body": "@leftaroundabout: The constructor already handles much of it, why write it again? Anyway, what does any of this have to do with the question? If you&#39;ve got an answer to the question, please suggest one."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541092671, "post_id": 53104972, "comment_id": 93107677, "body": "Not sure what you even mean by \u201cthe constructor\u201d. At any rate the <code>instance {Show&#47;Read} EnigmaConfig</code> aren&#39;t really a well-behaved implementations anyway, since <code>show</code> should yield <i>Haskell code</i>. The proper thing to do is implement a proper parser, and using the error features of the parser-combinator library rather than <code>Read</code> which does not support proper error handling."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541093075, "post_id": 53104972, "comment_id": 93107893, "body": "Anyone else \u2014 please!"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541093871, "post_id": 53104972, "comment_id": 93108310, "body": "Well, you ask \u201chow do I report <code>read</code> or constructor errors at the command line\u201d. The probably most sensible answer is, by <i>properly using</i> the command-line parser, instead of <i>circumventing the command line parser</i> (as you do, by giving an excessively weak type to its result). That is, unless you have a well-founded reason for making it <code>Encode { config :: String ... }</code>, but this isn&#39;t evident from the question, hence my comment."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1541102581, "post_id": 53104972, "comment_id": 93112426, "body": "@leftaroundabout: Like is said, if there&#39;s an answer lurking there somewhere, I&#39;d love to see it. (Again.)"}], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1541254378, "post_id": 53131854, "comment_id": 93157739, "body": "Could you elaborate a bit? Right now I simply have the <a href=\"https://github.com/orome/crypto-enigma-hs/blob/develop/Crypto/Enigma.hs#L312\" rel=\"nofollow noreferrer\">constructor</a> validate. That gives me error checking for uses other than <code>read</code>. But if I can&#39;t pass errors detected there through <code>read</code> (e.g. I should restore <code>Left err -&gt; []</code> there) it&#39;s not clear to me how to make use of that validation and error reporting when instantiating based on a supplied string (which is what <code>read</code> does, and what I need from the command line)."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1541254431, "post_id": 53131854, "comment_id": 93157751, "body": "Is it just that I should effectively take the implementation I now have in <code>read</code>, put that in a different &quot;reading&quot; function (instantiating one the parser-combinator libraries&#39; classes, that can propagate errors) and use that when reading from the command line; and then just call that new function from <code>read</code> (not propagating errors there)?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1541266681, "post_id": 53131854, "comment_id": 93161056, "body": "@orome I haven&#39;t clicked any of your links, and don&#39;t plan to. If you have a question which is about the combination of your <code>read</code> implementation and some other validation code, you should produce a minimal example and include it in a fresh question."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1541535575, "post_id": 53131854, "comment_id": 93248855, "body": "So (1) definitely have errors in <code>read</code> return <code>[]</code> and since that means <code>read</code> is not useful for reporting error info, (2) write a new &quot;read-like&quot; function to report errors and use that when instantiating based on CLI input, which (3) can be reported using <code>errorWithoutStackTrace </code>.?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1541535604, "post_id": 53131854, "comment_id": 93248872, "body": "(Sketching out a simple version of that <a href=\"https://github.com/orome/crypto-enigma-hs/blob/new/cli/Crypto/Enigma.hs#L335\" rel=\"nofollow noreferrer\">that function</a> and <a href=\"https://github.com/orome/crypto-enigma-hs/blob/new/cli/enigma.hs#L69\" rel=\"nofollow noreferrer\">using it in the CLI</a> certainly behaves the way I&#39;d like it too, but I&#39;m still not sure that I&#39;ve got the Haskell error reporting idiom right.)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 0, "last_activity_date": 1541252094, "creation_date": 1541252094, "answer_id": 53131854, "question_id": 53104972, "link": "https://stackoverflow.com/questions/53104972/how-should-a-haskell-command-line-script-report-errors-from-read/53131854#53131854", "title": "How should a Haskell command line script report errors from `read`?", "body": "<ol>\n<li>Yes: pure code cannot catch <code>error</code> calls. It is frequently useful to know from pure code that <code>read</code> (well, <code>reads</code>) has failed.</li>\n<li>Use a different class than <code>Read</code> for parsing that lets you report errors more clearly. Each of the popular parser-combinator libraries have facilities for good error reporting.</li>\n<li>Use the imaginatively-named <code>errorWithoutStackTrace</code>.</li>\n</ol>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 1, "accepted_answer_id": 53131854, "answer_count": 1, "score": 1, "last_activity_date": 1541252094, "creation_date": 1541088169, "question_id": 53104972, "link": "https://stackoverflow.com/questions/53104972/how-should-a-haskell-command-line-script-report-errors-from-read", "title": "How should a Haskell command line script report errors from `read`?", "body": "<p>I'm uncertain about the correct way to report errors from <code>read</code> creating an instance in response to user input at the command line within a <code>main = do ...</code>.</p>\n\n<p>Specifically, I have a <a href=\"https://github.com/orome/crypto-enigma-hs/blob/develop/Crypto/Enigma.hs#L312\" rel=\"nofollow noreferrer\">constructor</a> that validates its arguments and reports an error in the usual way</p>\n\n<pre><code>-- ...\nRight cfg  -&gt; cfg\nLeft err -&gt; error (show err)\n</code></pre>\n\n<p>and an implementation of <code>read</code> that uses this constructor. However inside my implementation I have a <a href=\"https://github.com/orome/crypto-enigma-hs/blob/develop/Crypto/Enigma.hs#L368\" rel=\"nofollow noreferrer\">cryptic note</a> (inherited from some long-ago research that I've since lost track of) that removes error information</p>\n\n<pre><code>instance Read ... where\n        readsPrec _ i = case ...\n            Right cfg  -&gt; [(cfg, \"\")]\n            Left _ -&gt; [] -- Loses error information, but conforms to specification of 'readsPrec' in 'Read'\n</code></pre>\n\n<p>so that <a href=\"https://github.com/orome/crypto-enigma-hs/blob/new/cli/enigma.hs\" rel=\"nofollow noreferrer\">my command line parser</a></p>\n\n<pre><code>main :: IO ()\nmain = do\n    ... read\n</code></pre>\n\n<p>reports all errors generated by the constructor as merely </p>\n\n<pre><code>Prelude.read: no parse\n</code></pre>\n\n<p>If I ignore my cryptic comment and <a href=\"https://github.com/orome/crypto-enigma-hs/blob/new/cli/Crypto/Enigma.hs#L370\" rel=\"nofollow noreferrer\">instead have</a> </p>\n\n<pre><code>Left err -&gt; error (show err)\n</code></pre>\n\n<p>in the constructor, then I get complete error information reported to the user:</p>\n\n<pre><code>script: Detailed error information here\n  CallStack (from HasCallStack):\n  error, called at ./Pkg/Module.hs:371:57 in main:Pkg.Module\n</code></pre>\n\n<p>(though with stack and line information I'd rather not report in this context).</p>\n\n<p>So I have three related questions about this:</p>\n\n<ol>\n<li>Is there actually any reason not to report full error information from <code>read</code> using <code>Left err -&gt; error (show err)</code>?</li>\n<li>If so and something like <code>Left err -&gt; []</code> is required there, how do I report <code>read</code> or constructor errors at the command line?</li>\n</ol>\n\n<p>and (not as important)</p>\n\n<ol start=\"3\">\n<li>How do i get rid of the line an stack information when reporting from <code>read</code> in my <code>main = do ...</code>?</li>\n</ol>\n"}, {"tags": ["haskell", "functor", "map-function"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1541178074, "post_id": 53104252, "comment_id": 93140464, "body": "define <code>(&lt;&lt;$&gt;&gt;) = fmap . fmap</code>, then use <code>(+1) &lt;&lt;$&gt;&gt; [Just 1, Just 2, Just 3]</code>. also, <code>(&lt;&lt;&lt;$&gt;&gt;&gt;) = fmap . fmap . fmap</code> for <code>(+1) &lt;&lt;&lt;$&gt;&gt;&gt; Right [Just 1, Just 2, Just 3]</code> etc."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1541086063, "post_id": 53104305, "comment_id": 93103967, "body": "There is also <code>(+1) &lt;$&gt; Compose [Just 1, Just 2]</code>. But in every real-life case I&#39;ve come across, it&#39;s been way syntactically heavier to bring in <code>Compose</code> than to just type <code>fmap</code> twice, so... +1 on this answer from me. =)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1541086408, "post_id": 53104305, "comment_id": 93104147, "body": "@DanielWagner: thanks. Did not know about the <code>Compose</code>, added to the answer."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 9, "last_activity_date": 1541086394, "last_edit_date": 1541086394, "creation_date": 1541085931, "answer_id": 53104305, "question_id": 53104252, "link": "https://stackoverflow.com/questions/53104252/map-functor-over-a-list-in-haskell/53104305#53104305", "title": "map Functor over a list in Haskell", "body": "<p>No <code>fmap</code> means you can <em>map</em> over an arbitrary <code>Functor</code> type (well think about it for now as a collection), but you only do this <em>one \"functor level\"</em> deep. In case you <code>fmap</code> with a list, it is exactly equivalent to <code>map</code>.</p>\n\n<p><code>fmap</code> however is defined over all sorts of <code>Functor</code>s, like lists, <code>Maybe</code>s, etc. Here you can thus <code>fmap</code> in the <code>fmap</code> to map over <em>two</em> levels:</p>\n\n<pre><code>fApplyFunctor = <b>fmap (fmap (+1))</b> [Just 1, Just 2]</code></pre>\n\n<p>This will then result in:</p>\n\n<pre><code>Prelude&gt; fmap (fmap (+1)) [Just 1, Just 2]\n[Just 2,Just 3]\nPrelude&gt; (fmap (+1)) &lt;$&gt; [Just 1, Just 2]\n[Just 2,Just 3]\nPrelude&gt; ((+1) &lt;$&gt;) &lt;$&gt; [Just 1, Just 2]\n[Just 2,Just 3]\n</code></pre>\n\n<p><strong>EDIT</strong>: like <a href=\"https://stackoverflow.com/questions/53104252/map-functor-over-a-list-in-haskell/53104305?noredirect=1#comment93103967_53104305\">@DanielWagner</a> says, there exists a data type <a href=\"https://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Functor-Compose.html#t:Compose\" rel=\"noreferrer\"><strong><code>Compose</code></strong></a> which works over two (or more if you <em>cascade</em>) <code>Functor</code>s and thus allows us to <code>fmap</code> two levels deep. This is implemented like:</p>\n\n<blockquote>\n<pre><code>newtype Compose f g a = Compose { getCompose :: f (g a) }\n\ninstance (Functor f, Functor g) =&gt; Functor (Compose f g) where\n    fmap f (Compose x) = Compose (fmap (fmap f) x)\n</code></pre>\n</blockquote>\n\n<p>so here we again perform an <code>fmap</code> on two levels:</p>\n\n<pre><code>Prelude Data.Functor.Compose&gt; getCompose ((+1) &lt;$&gt; Compose [Just 1, Just 2])\n[Just 2,Just 3]\n</code></pre>\n\n<p>But as you see it requires some syntax to first wrap the data in a <code>Compose</code>, and then to later \"unwrap\" it out of the <code>Compose</code>, so this requires some extra work as well.</p>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 0, "accepted_answer_id": 53104305, "answer_count": 1, "score": 7, "last_activity_date": 1541087408, "creation_date": 1541085731, "last_edit_date": 1541087408, "question_id": 53104252, "link": "https://stackoverflow.com/questions/53104252/map-functor-over-a-list-in-haskell", "title": "map Functor over a list in Haskell", "body": "<p>bit confused. <code>fmap</code> sounds like it can <code>map</code> all over a list of <code>Maybe</code>'s, but I can't get it to work if I use e.g. <code>fApplyFunctor = (+1) &lt;$&gt; [Just 1, Just 2]</code>. </p>\n\n<p>What seems to work perfectly fine is: <code>map ((+1) &lt;$&gt;) [Just 1, Just 2, Just 3]</code>. This seems to be overkill in that sense that I recall <code>fmap</code> could do that by itself already... </p>\n"}, {"tags": ["multithreading", "haskell", "ghc", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "edited": false, "score": 0, "creation_date": 1541083769, "post_id": 53103122, "comment_id": 93102636, "body": "Doesn&#39;t <code>waitForProcess hand</code> account for that? I moved it out of the callback of <code>withCreateProcess</code> and it still doesn&#39;t work. I am also reluctant to agree with your diagnosis because <code>runhaskell</code> works."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "edited": false, "score": 0, "creation_date": 1541087172, "post_id": 53103122, "comment_id": 93104590, "body": "@fakedrake <code>waitForProcess</code> waits for the external process (bash). In your code you also spawn two Haskell threads with <code>forkIO</code>, so you have to wait for those as well."}, {"owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "edited": false, "score": 0, "creation_date": 1541088499, "post_id": 53103122, "comment_id": 93105396, "body": "I&#39;m a bit confused how to do that, shouldn&#39;t the messages have shown up before the bash process stops? Could you show me some code on how to fix it?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "edited": false, "score": 0, "creation_date": 1541099322, "post_id": 53103122, "comment_id": 93110937, "body": "@fakedrake See my attempt above."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1541099242, "last_edit_date": 1541099242, "creation_date": 1541081869, "answer_id": 53103122, "question_id": 53102931, "link": "https://stackoverflow.com/questions/53102931/ghc-subsumes-stdout-in-the-presence-of-threads-but-ghci-doesnt/53103122#53103122", "title": "GHC subsumes stdout in the presence of threads but GHCi doesn&#39;t", "body": "<p>A Haskell program terminates immediately when its main thread halts.</p>\n\n<p>You need to modify your <code>main</code> to to wait for the spawned threads before exiting. </p>\n\n<p>In GHCi this is not an issue since the main thread runs the REPL, so it does not halt.</p>\n\n<p>Untested attempt:</p>\n\n<pre><code>handleProcess lock _ (Just outh) (Just errh) hand = do\n      lockOut &lt;- newEmptyMVar\n      _ &lt;- forkIO (showLines lock outh \"STDOUT\" &gt;&gt; putMVar lockOut ())\n      lockErr &lt;- newEmptyMVar\n      _ &lt;- forkIO (showLines lock errh \"STDERR\" &gt;&gt; putMVar lockErr ())\n      waitForProcess hand\n      takeMVar lockOut\n      takeMVar lockErr\n</code></pre>\n"}], "owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1541099242, "creation_date": 1541081121, "last_edit_date": 1541081517, "question_id": 53102931, "link": "https://stackoverflow.com/questions/53102931/ghc-subsumes-stdout-in-the-presence-of-threads-but-ghci-doesnt", "title": "GHC subsumes stdout in the presence of threads but GHCi doesn&#39;t", "body": "<p>I have the following haskell program</p>\n\n<pre><code>module Main where\n\nimport           Control.Concurrent\nimport           Control.Monad\nimport           GHC.IO.Handle\nimport           System.Process\n\nunlessM :: Monad m =&gt; m Bool -&gt; m () -&gt; m()\nunlessM cond m = do\n  c &lt;- cond\n  unless c m\n\nmain :: IO ()\nmain = do\n  lock &lt;- newMVar ()\n  void $ withCreateProcess\n    (proc exe args){ std_out = CreatePipe, std_err = CreatePipe }\n    $ handleProcess lock\n  where\n    exe = \"/bin/bash\"\n    args = [\"-c\", \"echo 1; sleep 1; echo 2; sleep 1; echo 3 \"]\n    handleProcess lock _ (Just outh) (Just errh) hand = do\n      _ &lt;- forkIO $ showLines lock outh \"STDOUT\"\n      _ &lt;- forkIO $ showLines lock errh \"STDERR\"\n      waitForProcess hand\n    handleProcess _ _ _ _ _ = fail \"No output or error handlers\"\n    showLines :: MVar () -&gt; Handle -&gt; String -&gt; IO ()\n    showLines v h str =\n      unlessM (hIsClosed h) $\n        unlessM (hIsEOF h) $ do\n          l &lt;- hGetLine h\n          () &lt;- takeMVar v\n          putStrLn $ str ++ \": \" ++ l\n          putMVar v ()\n          showLines v h str\n</code></pre>\n\n<p>Running it with ghci provides the expected output but compiling and running yields nothing</p>\n\n<pre><code>$ ghci\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /home/drninjabatman/.ghci\nPrelude&gt; :load Main.hs\n[1 of 1] Compiling Main             ( Main.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; main\nSTDOUT: 1\nSTDOUT: 2\nSTDOUT: 3\n*Main&gt; \nLeaving GHCi.\n$ runhaskell ./Main.hs\nSTDOUT: 1\nSTDOUT: 2\nSTDOUT: 3\n$ ghc Main.hs -o test\n[1 of 1] Compiling Main             ( Main.hs, Main.o )\nLinking test ...\n$ ./test\n$ # No output \n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1541082800, "creation_date": 1541082800, "answer_id": 53103408, "question_id": 53101532, "link": "https://stackoverflow.com/questions/53101532/text-parsercombinators-parsec-oneof-function-has-error/53103408#53103408", "title": "Text.ParserCombinators.Parsec oneOf function has error", "body": "<p>You can not print a <code>Parser Char</code> like <code>oneOf \"abcde\"</code>. That would be like printing a function which expects the input text. Functions can not be printed.</p>\n\n<p>(The error is due to parsers involving some extensions you did not turn on, but you can ignore the error you got. That's not the main issue.)</p>\n\n<p>To run a parser, you need to provide a source name and input text as follows:</p>\n\n<pre><code>&gt; import Text.ParserCombinators.Parsec\n&gt; parse (oneOf \"abcde\") \"sourceName\" \"a\"\nRight 'a'\n&gt; parse (oneOf \"abcde\") \"sourceName\" \"b\"\nRight 'b'\n&gt; parse (oneOf \"abcde\") \"sourceName\" \"z\"\nLeft \"sourceName\" (line 1, column 1):\nunexpected \"z\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6623366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b05ca9a2e9b5250086d32d1e28af9068?s=128&d=identicon&r=PG&f=1", "display_name": "Yuchang Ke", "link": "https://stackoverflow.com/users/6623366/yuchang-ke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1541082800, "creation_date": 1541076277, "last_edit_date": 1541078998, "question_id": 53101532, "link": "https://stackoverflow.com/questions/53101532/text-parsercombinators-parsec-oneof-function-has-error", "title": "Text.ParserCombinators.Parsec oneOf function has error", "body": "<p>ghci version is GHCi, version 8.6.1: <a href=\"http://www.haskell.org/ghc/\" rel=\"nofollow noreferrer\">http://www.haskell.org/ghc/</a></p>\n\n<pre><code>Prelude&gt; :m +Text.ParserCombinators.Parsec\nPrelude Text.ParserCombinators.Parsec&gt; oneOf \"abcd\"\n\n&lt;interactive&gt;:7:1: error:\n? Non type-variable argument\n        in the constraint: Text.Parsec.Prim.Stream s m Char\n      (Use FlexibleContexts to permit this)\n    ? When checking the inferred type\n        it :: forall s (m :: * -&gt; *) u.\n              Text.Parsec.Prim.Stream s m Char =&gt;\n              Text.Parsec.Prim.ParsecT s u m Char\n</code></pre>\n\n<p>Why?</p>\n"}, {"tags": ["haskell", "maybe"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1541069685, "post_id": 53099136, "comment_id": 93095179, "body": "<code>myWrapper</code> is exactly  <code>return</code>, just as <code>&gt;&gt;?</code> is exactly <code>&gt;&gt;=</code>."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1541072288, "post_id": 53099136, "comment_id": 93096502, "body": "But <code>return</code> works for the <code>IO</code> monad i want something that works for <code>Maybe</code>."}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 5, "creation_date": 1541072808, "post_id": 53099136, "comment_id": 93096756, "body": "<code>return</code> (definitionally) works for <i>any</i> monad, including <code>Maybe</code> and <code>Either a</code>."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 2, "creation_date": 1541072915, "post_id": 53099136, "comment_id": 93096804, "body": "And <code>pure</code> instead of <code>return</code> works as well for any <code>Applicative</code>, including <code>Maybe</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1541080385, "post_id": 53099136, "comment_id": 93100819, "body": "You <i>do</i> need wrappers for each monad, but tha&#39;t"}], "answers": [{"comments": [{"owner": {"reputation": 196, "user_id": 4534918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UU8hS.jpg?s=128&g=1", "display_name": "z0lupka", "link": "https://stackoverflow.com/users/4534918/z0lupka"}, "edited": false, "score": 0, "creation_date": 1542035242, "post_id": 53099329, "comment_id": 93413934, "body": "Happy b-day, arrowd! =D"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 196, "user_id": 4534918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UU8hS.jpg?s=128&g=1", "display_name": "z0lupka", "link": "https://stackoverflow.com/users/4534918/z0lupka"}, "edited": false, "score": 0, "creation_date": 1542038510, "post_id": 53099329, "comment_id": 93415717, "body": "Who&#39;s there? ._."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 6, "last_activity_date": 1541067913, "creation_date": 1541067913, "answer_id": 53099329, "question_id": 53099136, "link": "https://stackoverflow.com/questions/53099136/what-is-the-reverse-of-fmap/53099329#53099329", "title": "What is the reverse of fmap?", "body": "<blockquote>\n  <p>(is there any built in way more concise?)</p>\n</blockquote>\n\n<p>Sure:</p>\n\n<pre><code>myWrapper = Just\n</code></pre>\n\n<p>Or inline:</p>\n\n<pre><code>fm x= f1 x&gt;&gt;? Just . f2 &gt;&gt;? f3\n</code></pre>\n\n<p>Data constructors can be viewed as plain functions, so you can compose them with other functions.</p>\n"}, {"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 5, "last_activity_date": 1541068038, "creation_date": 1541068038, "answer_id": 53099370, "question_id": 53099136, "link": "https://stackoverflow.com/questions/53099136/what-is-the-reverse-of-fmap/53099370#53099370", "title": "What is the reverse of fmap?", "body": "<p>There is <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Functor.html#v:-60--38--62-\" rel=\"noreferrer\"><code>(&lt;&amp;&gt;) = flip fmap</code></a>, that has the same precedence as <code>(&gt;&gt;=)</code>:</p>\n\n<pre><code>fm x = f1 x &lt;&amp;&gt; f2 &gt;&gt;= f3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1541081059, "creation_date": 1541081059, "answer_id": 53102913, "question_id": 53099136, "link": "https://stackoverflow.com/questions/53099136/what-is-the-reverse-of-fmap/53102913#53102913", "title": "What is the reverse of fmap?", "body": "<blockquote>\n  <p>I am asking because when chaining I suppose you would need wrappers for other monads too like Either.</p>\n</blockquote>\n\n<p>Correct. Each type constructor like <code>Maybe</code> and <code>Either</code> needs its own definition for things like <code>&gt;&gt;=</code> and <code>return</code>, but that's exactly what an instance of a typeclass is: the definitions of the typeclass's methods specialized for a particular type constructor. For example,</p>\n\n<pre><code>class Monad m where\n    return :: a -&gt; m a\n    (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n\ninstance Monad Maybe where\n    return = Just\n    Nothing &gt;&gt;= _ = Nothing\n    (Just x) &gt;&gt;= f = f x\n\n-- This looks similar to the Maybe instance because in some sense,\n-- Maybe is just a special case of Either: Maybe ~ Either ()\ninstance Monad (Either a) where\n    return = Right\n    (Left x) &gt;&gt;= _ = Left x\n    (Right x) &gt;&gt;= f = f x\n</code></pre>\n\n<p>Your <code>fm</code> function can then be written in a way that works for <em>any</em> monad, not just <code>Maybe</code>:</p>\n\n<pre><code>fm :: Maybe m =&gt; Int -&gt; m Int\nfm x = f1 x &gt;&gt;= return . f2  &gt;&gt;= f3\n</code></pre>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 53099329, "answer_count": 3, "score": 1, "last_activity_date": 1541081059, "creation_date": 1541067145, "last_edit_date": 1541070912, "question_id": 53099136, "link": "https://stackoverflow.com/questions/53099136/what-is-the-reverse-of-fmap", "title": "What is the reverse of fmap?", "body": "<p>I have a chaining of functors and I need at some point to wrap my value in a <code>Maybe</code>:</p>\n\n<pre><code>module Funct where \n(&gt;&gt;?) :: Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b\n(Just a) &gt;&gt;? f = f a\nNothing &gt;&gt;? _ = Nothing\n\n\nf1 :: Int -&gt; Maybe Bool\nf1 a = if a &gt; 2 then Just (a `mod` 2 == 0)  else Nothing\n\nf2 :: Bool -&gt;  Char\nf2 b = if b then 'a' else 'b'\n\nf3 :: Char -&gt; Maybe Int\nf3 c = if c == 'a' then Just 1 else Nothing\n\nfm :: Int -&gt; Maybe Int\nfm x = f1 x &gt;&gt;? f2  &gt;&gt;? f3\n                 ^ \n                 Is there a reverse method for fmap particular for Maybe \n                 or do I have to implement it?\n</code></pre>\n\n<p><strong>Implemented</strong></p>\n\n<pre><code>myWrapper :: Char-&gt;Maybe Char\nmyWrapper c = Just c\n\nfm x = f1 x &gt;&gt;? myWrapper . f2 &gt;&gt;? f3  -- is there any built in way more concise?\n</code></pre>\n\n<p>I am asking because when chaining I suppose you would need wrappers for other monads too like <code>Either</code>.</p>\n"}]