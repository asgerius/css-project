[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1545865927, "post_id": 53937912, "comment_id": 94716189, "body": "<a href=\"http://hackage.haskell.org/package/memory-0.14.18/docs/Data-ByteArray.html#v:withByteArray\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/memory-0.14.18/docs/&hellip;</a>?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1545866832, "post_id": 53937912, "comment_id": 94716384, "body": "What C library do you have that expects text in the form of <code>uint16_t *</code> (encoded as UTF-16)?"}, {"owner": {"reputation": 4250, "user_id": 1833322, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c32eff9bf6efb2b8e496407efa690e99?s=128&d=identicon&r=PG", "display_name": "Flip", "link": "https://stackoverflow.com/users/1833322/flip"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1545866917, "post_id": 53937912, "comment_id": 94716397, "body": "PCRE2 can take UTF-8, UTF-16 and UTF-32 but i&#39;m going with UTF-16 to avoid conversion from haskell Text type."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1545867072, "post_id": 53937912, "comment_id": 94716425, "body": "Ah, so this is a bit of an XY problem. What are you trying to do with PCRE2?"}, {"owner": {"reputation": 4250, "user_id": 1833322, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c32eff9bf6efb2b8e496407efa690e99?s=128&d=identicon&r=PG", "display_name": "Flip", "link": "https://stackoverflow.com/users/1833322/flip"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1545867587, "post_id": 53937912, "comment_id": 94716506, "body": "Now it will be PCRE2, next time it will be some other thing. Don&#39;t need an explanation of the PCRE2 library and it&#39;s functions to answer the original question which is about zero-copy FFI when memory was already allocated by RTS. But if you want to dive into PCRE2 the function is pcre2_compile_16 which needs a pattern."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1545867666, "post_id": 53937912, "comment_id": 94716517, "body": "... is that really the performance bottleneck? How big are your regexes?"}, {"owner": {"reputation": 4250, "user_id": 1833322, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c32eff9bf6efb2b8e496407efa690e99?s=128&d=identicon&r=PG", "display_name": "Flip", "link": "https://stackoverflow.com/users/1833322/flip"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1545867867, "post_id": 53937912, "comment_id": 94716544, "body": "Now it&#39;s the pattern. Guess what comes next .. the subject. The time after this it can be another C library. It doesn&#39;t matter which specific library or function, everyone doing FFI will benefit from a good answer to this question."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1545886540, "post_id": 53937912, "comment_id": 94719271, "body": "<code>StablePtr</code>s are not supposed to be derefenced <i>from C</i>. Calling <code>deRefStablePtr</code> is of course fine if you haven&#39;t called <code>freeStablePtr</code> yet. Neither the wiki nor the linked SO post contradict this claim in the slightest, so you may want to reread them more carefully. Another misconception: memory is not first allocated then marked as pinned. There is a separate heap for pinned memory, so no, there is not just a flag you can set; even if there were a way to &quot;pin&quot; an existing structure it would involve copying it into the pinned heap."}, {"owner": {"reputation": 1915, "user_id": 2682729, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/PZlkg.gif?s=128&g=1", "display_name": "typesanitizer", "link": "https://stackoverflow.com/users/2682729/typesanitizer"}, "edited": false, "score": 1, "creation_date": 1545895111, "post_id": 53937912, "comment_id": 94721583, "body": "Have you looked at <a href=\"https://www.stackage.org/haddock/lts-13.0/text-1.2.3.1/Data-Text-Foreign.html\" rel=\"nofollow noreferrer\">Data.Text.Foreign</a>? While this doesn&#39;t address the general case (only works for Text), it does say &quot;The Text type is implemented using arrays that are not guaranteed to have a fixed address in the Haskell heap. All communication with native code must thus occur by copying data back and forth.&quot; So yeah, looks like you don&#39;t have any out-of-the-box options for zero-copy FFI :(."}, {"owner": {"reputation": 4250, "user_id": 1833322, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c32eff9bf6efb2b8e496407efa690e99?s=128&d=identicon&r=PG", "display_name": "Flip", "link": "https://stackoverflow.com/users/1833322/flip"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1545921872, "post_id": 53937912, "comment_id": 94731917, "body": "@DanielWagner The SO posts says &quot;To pass a reference to Haskell data to C, where the memory is allocated in the Haskell heap, and C will operate on the data directly&quot; and gives StablePtr as a solution. Explain to me how C can operate on the data directly and not deference the pointer. Also the wiki describe giving a value to foreign code and later retrieve that value. &quot;You need to be sure that the value is not collected between the time you give it and the time you retrieve it.&quot; foreign code is of course implicit by the whole wiki page being about FFI."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1545925238, "post_id": 53937912, "comment_id": 94733295, "body": "@Flip Your quote from the SO post is followed by two bullet points describing what you need to do. The two additional options listed later do not meet those needs, and are not implied to; they are alternatives to &quot;allocate in Haskell, operate in C&quot;, not to &quot;allocate pinned and ensure correct shape&quot;. Allocate in C and use a finalizer is an alternative to &quot;allocate in Haskell&quot;; <code>StablePtr</code> is an alternative to &quot;operate in C&quot;."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1545925277, "post_id": 53937912, "comment_id": 94733306, "body": "@Flip The wiki describes giving a value to foreign code and later retrieving that value -- but <i>not retrieving it from C</i>. It is retrieved on the Haskell side (with <code>deRefStablePtr</code>, as described by me two comments ago)."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1545926927, "post_id": 53937912, "comment_id": 94733981, "body": "Fwiw a <code>Text</code> that used pinned memory so you didn&#39;t have to copy, and possibly was encoded in utf-8, is a very reasonable thing to want (rust went this route). It could have been designed that way, and it would be possible to create a new library that worked like that (it might even be possible to have a package  flag that turned on allocation in pinned heap). You might consider filling an issue or proposal for the package and discussing it with the maintainers"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1545926978, "post_id": 53937912, "comment_id": 94734003, "body": "The main issue is that supposedly/in theory a lot of pinned objects can lead to memory fragmentation"}, {"owner": {"reputation": 4250, "user_id": 1833322, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c32eff9bf6efb2b8e496407efa690e99?s=128&d=identicon&r=PG", "display_name": "Flip", "link": "https://stackoverflow.com/users/1833322/flip"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1545928753, "post_id": 53937912, "comment_id": 94734740, "body": "@DanielWagner what&#39;s the point of passing StablePtr in the first place when it&#39;s not supposed to be retrieved from C? If it&#39;s just a filler why not just pass nullPtr"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1545929968, "post_id": 53937912, "comment_id": 94735256, "body": "@Flip The point is that it can be passed back from C to Haskell and dereferenced from there (whereas <code>nullPtr</code> can be passed back to Haskell but not usefully dereferenced from either side)."}, {"owner": {"reputation": 138, "user_id": 1270253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09a3b6267f194aa45b09aca3e41f110f?s=128&d=identicon&r=PG", "display_name": "cmspice", "link": "https://stackoverflow.com/users/1270253/cmspice"}, "edited": false, "score": 0, "creation_date": 1580165249, "post_id": 53937912, "comment_id": 106001170, "body": "I&#39;m looking to do the same. It seems copying is the only solution for now?  I tried dereferencing a StablePtr inside C and got a SIGSEGV 11. Notably, the address of the stableptr was 0x1b."}, {"owner": {"reputation": 4250, "user_id": 1833322, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c32eff9bf6efb2b8e496407efa690e99?s=128&d=identicon&r=PG", "display_name": "Flip", "link": "https://stackoverflow.com/users/1833322/flip"}, "reply_to_user": {"reputation": 138, "user_id": 1270253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09a3b6267f194aa45b09aca3e41f110f?s=128&d=identicon&r=PG", "display_name": "cmspice", "link": "https://stackoverflow.com/users/1270253/cmspice"}, "edited": false, "score": 1, "creation_date": 1580390203, "post_id": 53937912, "comment_id": 106087095, "body": "@cmspice this works <a href=\"https://hackage.haskell.org/package/memory-0.15.0/docs/Data-ByteArray.html#t:ByteArrayAccess\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/memory-0.15.0/docs/&hellip;</a> but you still need to encode/decode when you come or go to other types like Text for example. However i&#39;m not putting this as my own answer because i would like more understanding or control over how pinning works in the garbage collector"}, {"owner": {"reputation": 138, "user_id": 1270253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09a3b6267f194aa45b09aca3e41f110f?s=128&d=identicon&r=PG", "display_name": "cmspice", "link": "https://stackoverflow.com/users/1270253/cmspice"}, "edited": false, "score": 0, "creation_date": 1580488229, "post_id": 53937912, "comment_id": 106126061, "body": "Thanks @flip. I think that also only works when calling C from Haskell and not the other way (at least without using a function ptr to call back into C)."}, {"owner": {"reputation": 138, "user_id": 1270253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09a3b6267f194aa45b09aca3e41f110f?s=128&d=identicon&r=PG", "display_name": "cmspice", "link": "https://stackoverflow.com/users/1270253/cmspice"}, "edited": false, "score": 0, "creation_date": 1580488247, "post_id": 53937912, "comment_id": 106126071, "body": "Following up on my own comment: I read docs more carefully on StablePtr. Though the reference says that StablePtrs should pin the underlying value (it doesn&#39;t say specifically &quot;pin&quot; though), it makes no guarantees about the memory address and in particular, may not even be a valid memory (and hence SIGSEGV). That&#39;s fine and all. It&#39;s a little weird they call them &quot;Ptrs&quot; and even offer the &quot;castStablePtrToPtr&quot; function.  <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Foreign-StablePtr.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 4250, "user_id": 1833322, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c32eff9bf6efb2b8e496407efa690e99?s=128&d=identicon&r=PG", "display_name": "Flip", "link": "https://stackoverflow.com/users/1833322/flip"}, "edited": false, "score": 0, "creation_date": 1580567460, "post_id": 53937912, "comment_id": 106143887, "body": "The reference to ByteArrayAcces is a mistake by me, you don&#39;t get a guarantee with this typeclass. However .. wether haskell calls C or C calls haskell is not the interesting part. It&#39;s wether haskell or C allocates the data you want to work with. I think StablePtr works so that the address of the pointer itself is guaranteed to stay the same, but what it points to can be changed by haskell as it wants. Therefor you can use this pointer in C to pass from and to haskell, but not access the data of this pointer because the location can change by the GC while you are accessing it."}], "owner": {"reputation": 4250, "user_id": 1833322, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c32eff9bf6efb2b8e496407efa690e99?s=128&d=identicon&r=PG", "display_name": "Flip", "link": "https://stackoverflow.com/users/1833322/flip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 193, "favorite_count": 1, "answer_count": 0, "score": 6, "last_activity_date": 1545872451, "creation_date": 1545864117, "last_edit_date": 1545872451, "question_id": 53937912, "link": "https://stackoverflow.com/questions/53937912/pass-haskell-gc-allocated-data-to-c-by-pointer", "title": "Pass haskell GC allocated data to C by pointer", "body": "<p>After reading several wiki's and stackoverflow QA i'm left with the question how to pass mark/pass regions of memory allocated by the GC to the C library. Most of the libraries handling FFI seem to allocate memory first, copy the value into it and wrap it in a Ptr type. The problem is to get a guarantee that the memory won't be moved or deallocated while spending time in the C library.</p>\n\n<p>Suppose i have a value myInput that is of type Text and i want to do zero-copy FFI with C. What are my options?</p>\n\n<p>So far i've found the following:</p>\n\n<p><a href=\"https://wiki.haskell.org/Foreign_Function_Interface#Pointers_to_Haskell_data\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Foreign_Function_Interface#Pointers_to_Haskell_data</a></p>\n\n<blockquote>\n  <p>In some cases, you may want to give to the foreign code an opaque reference to a Haskell value that you will retrieve later on. You need to be sure that the value is not collected between the time you give it and the time you retrieve it. Stable pointers have been created exactly to do this. You can wrap a value into a StablePtr and give it to the foreign code (StablePtr is one of the marshallable foreign types).</p>\n</blockquote>\n\n<p>After talking to some people. They tell me that the StablePtr is not supposed to be dereferenced. And is mainly used for passing void* around. On the other hand the wiki says it's suitable for this purpose and also this answer indicates the same <a href=\"https://stackoverflow.com/a/10900699/1833322\">https://stackoverflow.com/a/10900699/1833322</a></p>\n\n<p>More information on StablePtr:</p>\n\n<p><a href=\"https://www.well-typed.com/blog/2018/05/ghc-special-gc-objects/\" rel=\"nofollow noreferrer\">https://www.well-typed.com/blog/2018/05/ghc-special-gc-objects/</a></p>\n\n<blockquote>\n  <p>after every GC stable pointers are updated to point to new locations of the Haskell objects that they were pointing to before the GC</p>\n</blockquote>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.11.1.0/docs/Foreign-StablePtr.html#t:StablePtr\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/base-4.11.1.0/docs/Foreign-StablePtr.html#t:StablePtr</a></p>\n\n<blockquote>\n  <p>A stable pointer is a reference to a Haskell expression that is guaranteed not to be affected by garbage collection, i.e., it will neither be deallocated nor will the value of the stable pointer itself change during garbage collection (ordinary references may be relocated during garbage collection). Consequently, stable pointers can be passed to foreign code, which can treat it as an opaque reference to a Haskell value.</p>\n</blockquote>\n\n<p>I thought i could just wrap my Text with newStablePtr <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Foreign-StablePtr.html#v:newStablePtr\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/base-4.12.0.0/docs/Foreign-StablePtr.html#v:newStablePtr</a> and be done with it. I don't understand what is now the situation with StablePtr. If i can use it for this purpose or not. And if not what is it actually used for.</p>\n\n<p>Then there is pinned memory <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/GC/Pinned\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/GC/Pinned</a> with ByteString</p>\n\n<p>There are also pinned ByteArray <a href=\"http://hackage.haskell.org/package/primitive-0.6.2.0/docs/Data-Primitive-ByteArray.html#g:2\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/primitive-0.6.2.0/docs/Data-Primitive-ByteArray.html#g:2</a></p>\n\n<p>Just the thing with ByteString and ByteArray is that often IO libraries provide their own data structures and data would have to be copied first INTO ByteString/ByteArray which is what i'm trying to avoid in the first place.</p>\n\n<p>Maybe there are some (unsafe ?) casting functions?</p>\n\n<p>It seems to be a simple problem since the GC already seems to be able to mark portions of the memory to \"don't move\" (pinning). Is there a function i can call on a structure to toggle this flag? Or are there any other suitable functions for this use case?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1545860491, "post_id": 53936636, "comment_id": 94714921, "body": "What would you expect to be the result of <code>mappairs (\\(x,y) -&gt; x-y) [5]</code>? This call type checks according to your signature."}], "answers": [{"comments": [{"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1545855471, "post_id": 53936687, "comment_id": 94713528, "body": "I tried <code>mappairs :: ((a, a) -&gt; b) -&gt; [a] -&gt; [b] mappairs f xs = foldr (\\(x, y) acc -&gt; (f x y : acc)) [] xs</code> and I receive the error"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1545855512, "post_id": 53936687, "comment_id": 94713535, "body": "<code>&lt;interactive&gt;:492:40: error:     \u2022 Occurs check: cannot construct the infinite type: b ~ t0 -&gt; b     \u2022 The function \u2018f\u2019 is applied to two arguments,       but its type \u2018(a, a) -&gt; b\u2019 has only one       In the first argument of \u2018(:)\u2019, namely \u2018f x y\u2019       In the expression: (f x y : acc)     \u2022 Relevant bindings include         acc :: [b] (bound at &lt;interactive&gt;:492:32)         y :: t0 (bound at &lt;interactive&gt;:492:29)         f :: (a, a) -&gt; b (bound at &lt;interactive&gt;:492:10)         mappairs :: ((a, a) -&gt; b) -&gt; [a] -&gt; [b]           (bound at &lt;interactive&gt;:492:1)</code>"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1545855543, "post_id": 53936687, "comment_id": 94713544, "body": "<code>&lt;interactive&gt;:492:57: error:     \u2022 Occurs check: cannot construct the infinite type:         a ~ ((a, a), t0)       Expected type: [((a, a), t0)]         Actual type: [a]     \u2022 In the third argument of \u2018foldr\u2019, namely \u2018xs\u2019       In the expression: foldr (\\ (x, y) acc -&gt; (f x y : acc)) [] xs       In an equation for \u2018mappairs\u2019:           mappairs f xs = foldr (\\ (x, y) acc -&gt; (f x y : acc)) [] xs     \u2022 Relevant bindings include</code>"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1545855551, "post_id": 53936687, "comment_id": 94713548, "body": "<code>xs :: [a] (bound at &lt;interactive&gt;:492:12)         f :: (a, a) -&gt; b (bound at &lt;interactive&gt;:492:10)         mappairs :: ((a, a) -&gt; b) -&gt; [a] -&gt; [b]           (bound at &lt;interactive&gt;:492:1)</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1545855592, "post_id": 53936687, "comment_id": 94713558, "body": "@user65526: hold on, the type should be <code>((a, a) -&gt; b) -&gt; [(a, a)] -&gt; [b]</code> (or even <code>((a, b) -&gt; c) -&gt; [(a, b)] -&gt; [c]</code>."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1545855751, "post_id": 53936687, "comment_id": 94713593, "body": "But the idea was to have something like <code>map</code>, but which took a binary function as its first argument and a list (not a list of tuples) as its second argument."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1545855840, "post_id": 53936687, "comment_id": 94713619, "body": "@user65526: and what would be the semantics of that function? Right now you only define the types, but there are an infinite amount of functions with the same type."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1545855909, "post_id": 53936687, "comment_id": 94713638, "body": "It would add the first member of the tuple to the second, then the third to the second and first, then the fourth to the first three..."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 1, "creation_date": 1545858170, "post_id": 53936687, "comment_id": 94714258, "body": "@user65526 That doesn&#39;t sound like it has much to do with tuples. Are you perhaps looking for Data.List.scanl?"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1545856114, "last_edit_date": 1545856114, "creation_date": 1545855173, "answer_id": 53936687, "question_id": 53936636, "link": "https://stackoverflow.com/questions/53936636/a-map-function-that-operates-on-pairs/53936687#53936687", "title": "A map function that operates on pairs", "body": "<p>The pattern:</p>\n\n<pre><code>\\(x,y) -&gt; f x y</code></pre>\n\n<p>in the clause:</p>\n\n<pre><code>mappairs <b>(\\(x,y) -&gt; f x y)</b> xs = foldr (\\(x, y) acc -&gt; (f x y : acc)) [] xs</code></pre>\n\n<p>is indeed not valid, since <code>(-&gt;)</code> is not a data constructor.</p>\n\n<p>You can however use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:zipWith\" rel=\"nofollow noreferrer\"><strong><code>zipWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]</code></strong></a> here:</p>\n\n<pre><code>mappairs :: ((a, a) -&gt; b) -&gt; [a] -&gt; [b]\nmappairs _ [] = []\nmappairs f xa@(_:xs) = zipWith (curry f) xa xs</code></pre>\n\n<p>For example:</p>\n\n<pre><code>&gt; mappairs (\\(x,y) -&gt; x+y) [1,4,2,5]\n[5,6,7]\n</code></pre>\n\n<p>But it looks more \"<em>Haskell-ish</em>\" to omit the tuples, and thus use a function directly:</p>\n\n<pre><code>mappairs :: (a -&gt; a -&gt; b) -&gt; [a] -&gt; [b]\nmappairs _ [] = []\nmappairs f xa@(_:xs) = zipWith f xa xs</code></pre>\n"}], "owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 53936687, "answer_count": 1, "score": -2, "last_activity_date": 1545856114, "creation_date": 1545854894, "question_id": 53936636, "link": "https://stackoverflow.com/questions/53936636/a-map-function-that-operates-on-pairs", "title": "A map function that operates on pairs", "body": "<p>I am trying to write a function which is like <code>map</code>, but which takes functions of type <code>(a, a) -&gt; b</code> as its first argument. However, I get the error </p>\n\n<pre><code> &lt;interactive&gt;:474:11: error:\nParse error in pattern: \\ (x, y) -&gt; f x y\n</code></pre>\n\n<p>with the following code:</p>\n\n<pre><code>Prelude&gt; :{\nPrelude| mappairs :: ((a, a) -&gt; b) -&gt; [a] -&gt; [b]\nPrelude| mappairs (\\(x,y) -&gt; f x y) xs = foldr (\\(x, y) acc -&gt; (f x y : acc)) [] xs \nPrelude| :}\n</code></pre>\n\n<p>What is the problem?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1545848418, "creation_date": 1545848418, "answer_id": 53935632, "question_id": 53935520, "link": "https://stackoverflow.com/questions/53935520/why-do-some-function-calls-fail-to-work-without-a-type-application/53935632#53935632", "title": "Why do some function calls fail to work without a type application?", "body": "<p>Type inference is the cause. This type contains <code>s</code> ...</p>\n\n<pre><code>refuteRefuteKnockable :: SingI s =&gt; Refuted (Refuted (Knockable s)) -&gt; Knockable s\n                                                                       ^^^^^^^^^^^\n</code></pre>\n\n<p>So, this  </p>\n\n<pre><code> refuteRefuteKnockable rrK =\n   case isKnockable $ sing of\n     Proved k -&gt; k\n                ^^^\n</code></pre>\n\n<p>must have type <code>Knockable s</code>. Hence, the type of <code>Proved k</code> is inferred, probably containing <code>s</code> as well. That is the same type of <code>isKnockable $ sing</code>, from which we infer what type should be applied to <code>sing</code> (exploiting the signature of <code>isKnockable</code>). GHC does all of this for us.</p>\n\n<p>In the latter example, we can't perform the same reasoning.</p>\n\n<pre><code>case sing of\n     SOpened -&gt; OrRight $ Refl\n     SClosed -&gt; OrLeft KnockClosed\n     SLocked -&gt; OrLeft KnockLocked\n</code></pre>\n\n<p>is ambiguous because, even if the three branches must return a known type, we can still call <code>sing</code> on a different type then <code>s</code> and make everything typecheck. Since there isn't a <em>unique</em> <code>s</code>, inference can not work.</p>\n\n<p>Note that above I had to guess a few things. If you shared the definitions of your types, we could be more accurate. (I.e., where is <code>SOpened</code> defined? What about <code>Knockable</code>, etc.?)</p>\n"}], "owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 2, "accepted_answer_id": 53935632, "answer_count": 1, "score": 3, "last_activity_date": 1545849169, "creation_date": 1545847653, "last_edit_date": 1545849169, "question_id": 53935520, "link": "https://stackoverflow.com/questions/53935520/why-do-some-function-calls-fail-to-work-without-a-type-application", "title": "Why do some function calls fail to work without a type application?", "body": "<p>I am having trouble understanding how type applications work. Why can <code>sing</code> in <code>refuteRefuteKnockable</code> be used without a type application when the call to <code>sing</code> in <code>knockableOrOpened</code> will fail to type check without a type application?</p>\n\n<pre><code> refuteRefuteKnockable :: SingI s =&gt; Refuted (Refuted (Knockable s)) -&gt; Knockable s\n refuteRefuteKnockable rrK =\n   case isKnockable $ sing of\n     Proved k -&gt; k\n     Disproved rK -&gt; absurd $ rrK rK\n\n knockableOrOpened :: forall s. SingI s =&gt; Or Knockable ((:~:) Opened) s\n knockableOrOpened =\n   case sing @s of\n     SOpened -&gt; OrRight $ Refl\n     SClosed -&gt; OrLeft KnockClosed\n     SLocked -&gt; OrLeft KnockLocked\n</code></pre>\n\n<p>I am working from the following codebase: <a href=\"https://github.com/mstksg/inCode/blob/master/code-samples/singletons/Door3.hs\" rel=\"nofollow noreferrer\">https://github.com/mstksg/inCode/blob/master/code-samples/singletons/Door3.hs</a></p>\n"}, {"tags": ["list", "haskell", "duplicates", "tuples", "grouping"], "comments": [{"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 1, "creation_date": 1545846464, "post_id": 53935172, "comment_id": 94710795, "body": "Hint: use <code>sortBy</code>"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1545847267, "post_id": 53935172, "comment_id": 94710992, "body": "There&#39;s already a definition of <code>Ord</code> for <code>String</code> that will do what you want."}, {"owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1545847651, "post_id": 53935172, "comment_id": 94711119, "body": "@assembly.jc Thanks for the hint!"}], "answers": [{"tags": [], "owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "is_accepted": true, "score": 1, "last_activity_date": 1545847607, "creation_date": 1545847607, "answer_id": 53935512, "question_id": 53935172, "link": "https://stackoverflow.com/questions/53935172/haskell-grouping-duplicate-tuples-from-a-list-and-making-them-unique-by-snd/53935512#53935512", "title": "Haskell - Grouping duplicate tuples from a list and making them unique by snd", "body": "<p>I was able to solve the problem.</p>\n\n<p><a href=\"https://www.stackage.org/haddock/lts-13.0/base-4.12.0.0/Data-List.html#v:sortOn\" rel=\"nofollow noreferrer\">sortOn</a> did the trick.</p>\n\n<pre><code>sortOn snd theList\n</code></pre>\n\n<p>Now duplicate elements are adjacent so <code>group</code> can work like usual</p>\n\n<p>Thanks @assembly.js for the hint!</p>\n"}], "owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "closed_date": 1545885724, "accepted_answer_id": 53935512, "answer_count": 1, "score": 0, "last_activity_date": 1545847607, "creation_date": 1545845347, "question_id": 53935172, "link": "https://stackoverflow.com/questions/53935172/haskell-grouping-duplicate-tuples-from-a-list-and-making-them-unique-by-snd", "closed_reason": "Duplicate", "title": "Haskell - Grouping duplicate tuples from a list and making them unique by snd", "body": "<p>I have a list of tuples</p>\n\n<pre><code>[(1, \"aa\"), (1, \"bb\"), (2, \"aa\"), (3, \"cc\"), (4, \"cc\"), (1, \"aa\")]\n</code></pre>\n\n<p>and I want to convert it into this</p>\n\n<pre><code>[(1, \"aa\"), (2, \"aa+1\"), (1, \"aa+2\"), (1, \"bb\"), (3, \"cc\"), (4, \"cc+1\")]\n</code></pre>\n\n<p>where sequence doesn't matter.</p>\n\n<p>Each element is unique by <code>snd</code></p>\n\n<p>I was thinking something along the lines of this could work</p>\n\n<pre><code>identifier :: [String]\nidentifier = map (\\ x -&gt; (\\ a b -&gt; b ++ show a) x \"+\") [1, 2 .. ]\n\n\nunUniqueNumbered :: [(String, String)] -&gt; [(String, String)]\nunUniqueNumbered = zipWith (\\b a -&gt; (fst a, snd a ++ b)) identifier\n\n\nuniquifySND :: [(String, String)] -&gt; [(String, String)]\nuniquifySND theList = concat $ groupBy ((==) `on` snd) theList\n</code></pre>\n\n<p>The problem was, <code>groupBy</code> only groups adjacent duplicate elements.</p>\n\n<p>What do I need to change?</p>\n"}, {"tags": ["haskell", "monad-transformers"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1565636543, "post_id": 53934982, "comment_id": 101406936, "body": "One caveat: <code>local</code> from <code>C.M.T.R</code> allows the environment type to change, while the one from <code>C.M.R</code> does not."}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 6, "last_activity_date": 1545846617, "last_edit_date": 1545846617, "creation_date": 1545844206, "answer_id": 53934982, "question_id": 53934939, "link": "https://stackoverflow.com/questions/53934939/why-cant-i-call-ask-with-monadreader-constraint/53934982#53934982", "title": "Why can&#39;t I call ask with MonadReader constraint", "body": "<p>It seems like you have <code>ask</code> imported from <code>Control.Monad.Trans.Reader</code> but <code>MonadReader</code> imported from <code>Control.Monad.Reader</code>. The <code>ask</code> function from <code>Control.Monad.Trans.Reader</code> is monomorphic, and it only works with <code>ReaderT</code>. Just import <code>Control.Monad.Reader</code> on its own\u2014it re-exports <code>ReaderT</code>, but it provides generalized versions of <code>ask</code>, <code>local</code>, and <code>reader</code>.</p>\n"}], "owner": {"reputation": 35, "user_id": 10833599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3777bda0145c972a19f0b2bc4063a075?s=128&d=identicon&r=PG&f=1", "display_name": "xicohuni", "link": "https://stackoverflow.com/users/10833599/xicohuni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 53934982, "answer_count": 1, "score": 1, "last_activity_date": 1545846617, "creation_date": 1545843945, "question_id": 53934939, "link": "https://stackoverflow.com/questions/53934939/why-cant-i-call-ask-with-monadreader-constraint", "title": "Why can&#39;t I call ask with MonadReader constraint", "body": "<p>I am trying to call <code>ask</code> in a <code>do</code> notation block with a <code>MonadReader</code> constraint but am getting an error about rigid types. As far as I can tell, <code>ask</code> is defined for all <code>MonadReader</code>s ?</p>\n\n<pre><code>bar :: MonadReader r m =&gt; m r\nbar = do\n  i &lt;- ask\n  return i\n</code></pre>\n\n<p>This returns the </p>\n\n<blockquote>\n<pre><code>\u2022 Couldn't match type \u2018m\u2019 with \u2018ReaderT r m0\u2019\n  \u2018m\u2019 is a rigid type variable bound by\n    the type signature for:\n      bar :: forall r (m :: * -&gt; *). MonadReader r m =&gt; m r\n    at mem.hs:50:8\n  Expected type: m r\n    Actual type: ReaderT r m0 r\n\u2022 In a stmt of a 'do' block: i &lt;- ask\n  In the expression:\n    do { i &lt;- ask;\n         return i }\n  In an equation for \u2018bar\u2019:\n      bar\n        = do { i &lt;- ask;\n               return i }\n</code></pre>\n</blockquote>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 944, "user_id": 49554, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02c8ecc24181d171df85a26458b9cd5f?s=128&d=identicon&r=PG", "display_name": "jneira", "link": "https://stackoverflow.com/users/49554/jneira"}, "edited": false, "score": 0, "creation_date": 1545841570, "post_id": 53934348, "comment_id": 94709180, "body": "Hi and welcome! To understand correctly your question: you have a main function <code>weaveHunks :: [a] -&gt; [a] -&gt; [a]</code> (the &quot;function above as its only two parameters are two lists&quot;) and you have <i>another</i> auxiliary function which should have another name, f.e. <code>weaveHunksAux :: Int -&gt; [a] -&gt; [a] -&gt; [a]</code>, right?"}, {"owner": {"reputation": 23, "user_id": 10835566, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RUa2NcuzY3o/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZjeAZOS7RKLVmIRUGtkxKp5kAV6w/mo/photo.jpg?sz=128", "display_name": "Itsyourboi", "link": "https://stackoverflow.com/users/10835566/itsyourboi"}, "reply_to_user": {"reputation": 944, "user_id": 49554, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/02c8ecc24181d171df85a26458b9cd5f?s=128&d=identicon&r=PG", "display_name": "jneira", "link": "https://stackoverflow.com/users/49554/jneira"}, "edited": false, "score": 0, "creation_date": 1545843384, "post_id": 53934348, "comment_id": 94709810, "body": "Hi, you&#39;re correct about the main function weaveHunks, takes in two lists and outputs a list which is result of weaving both given lists together, increasing the size of each chunk from the two given lists each time. The auxiliary function was just my idea about how I could somehow keep a counter so i could increase the size of the chunks each time, It&#39;s not part of the actual question."}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1545842940, "post_id": 53934762, "comment_id": 94709677, "body": "Can you just pass <code>n+1</code> and recursive call with <code>go (n+1) lb ab</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1545843036, "post_id": 53934762, "comment_id": 94709707, "body": "@ThomasM.DuBuisson: but the next time we take <code>3</code> elements from the first list if I understood it correctly. We can indeed do that, and multiply with <code>2</code> at the <code>splitAt</code> level. But I&#39;m not sure this makes it more elegant."}, {"owner": {"reputation": 23, "user_id": 10835566, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RUa2NcuzY3o/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZjeAZOS7RKLVmIRUGtkxKp5kAV6w/mo/photo.jpg?sz=128", "display_name": "Itsyourboi", "link": "https://stackoverflow.com/users/10835566/itsyourboi"}, "edited": false, "score": 0, "creation_date": 1545844323, "post_id": 53934762, "comment_id": 94710111, "body": "You are correct with your understanding of the question, your solution is what I was trying to achieve."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1545886218, "post_id": 53934762, "comment_id": 94719210, "body": "@WillemVanOnsem No need to multiply by 2. <code>go n la lb = aa ++ go (n+1) lb ab where (aa, ab) = splitAt n la</code> is a drop-in replacement (keep the base case, of course). Try it and see."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1545891910, "last_edit_date": 1545891910, "creation_date": 1545842844, "answer_id": 53934762, "question_id": 53934348, "link": "https://stackoverflow.com/questions/53934348/haskell-combine-two-lists-incrementing-the-size-of-each-chunk-from-each-list-eve/53934762#53934762", "title": "Haskell combine two lists incrementing the size of each chunk from each list every time", "body": "<p>What is probably missing here is an accumulator that increments, such that we know how much to take from the first and the second list.</p>\n\n<p>If I understood it correct, there are basically two cases here:</p>\n\n<ol>\n<li>in case both lists are exhausted, the result is an empty list; and</li>\n<li>if at least one of the two lists is not empty, we take <code>n</code> elements from the first list, <code>n+1</code> elements from the second list, and we recurse on the remaining elements of the lists, but now with <code>n+2</code>, so that means we define a function like:</li>\n</ol>\n\n<pre><code>import Data.List(splitAt)\n\nweaveHunks :: [a] -&gt; [a] -&gt; [a]\nweaveHunks = go 1\n    where go _ [] [] = []\n          go n la lb = aa ++ ba ++ go (n+2) ab bb\n              where (aa, ab) = splitAt n la\n                    (ba, bb) = splitAt (n+1) lb</code></pre>\n\n<p>Or like <a href=\"https://stackoverflow.com/questions/53934348/haskell-combine-two-lists-incrementing-the-size-of-each-chunk-from-each-list-eve/53934762?noredirect=1#comment94709677_53934762\">@ThomasM.DuBuisson</a> and <a href=\"https://stackoverflow.com/questions/53934348/haskell-combine-two-lists-incrementing-the-size-of-each-chunk-from-each-list-eve/53934762?noredirect=1#comment94719210_53934762\">@DanielWagner</a> suggest, we can each time take <code>n</code> from the first list, and recurse with <code>n+1</code> and <em>swap</em> the lists, like:</p>\n\n<pre><code>import Data.List(splitAt)\n\nweaveHunks :: [a] -&gt; [a] -&gt; [a]\nweaveHunks = go 1\n    where go _ [] [] = []\n          go n la lb = aa ++ go (n+1) lb ab\n              where (aa, ab) = splitAt n la</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10835566, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RUa2NcuzY3o/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcZjeAZOS7RKLVmIRUGtkxKp5kAV6w/mo/photo.jpg?sz=128", "display_name": "Itsyourboi", "link": "https://stackoverflow.com/users/10835566/itsyourboi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 53934762, "answer_count": 1, "score": 0, "last_activity_date": 1545891910, "creation_date": 1545840433, "last_edit_date": 1545843033, "question_id": 53934348, "link": "https://stackoverflow.com/questions/53934348/haskell-combine-two-lists-incrementing-the-size-of-each-chunk-from-each-list-eve", "title": "Haskell combine two lists incrementing the size of each chunk from each list every time", "body": "<p>Need to create a function in Haskell that takes two lists and yields\na list combining all the elements in the two input lists, taking 1 from the first list, 2 from the second list, 3 from the first list, 4 from the second list, etc,until both are exhausted. </p>\n\n<p>Example:</p>\n\n<pre><code>weaveHunks [1,2,3,4,5,6,7,8] [11,12,13,14,15,16,17,18]\n=&gt; [1,11,12,2,3,4,13,14,15,16,5,6,7,8,17,18]\n</code></pre>\n\n<p>I have a function so far that given a number n and two lists it will, combine both given lists together in chunks that are of size n.</p>\n\n<pre><code>weaveHunks :: Int -&gt; [a] -&gt; [a] -&gt; [a]\nweaveHunks _ xs [] = xs\nweaveHunks _ [] ys = ys\nweaveHunks n xs ys = xHunk ++ yHunk ++ weaveHunks n xRemain yRemain\n where [(xHunk, xRemain), (yHunk, yRemain)] = splitAt n &lt;$&gt; [xs,ys]\n</code></pre>\n\n<p>Trying to expand on this answer so instead of giving it a parameter that defines the chunk size I want to increment a counter everytime the function is called recursively. </p>\n\n<p>This is where I am not sure how would you go about creating some sort of counter that increases the chunk size everytime the function is called. I can't pass a number to the function above as its only two parameters are the two lists. I thought about using some sort of auxiliary function that would keep a incrementing a counter each time weaveHunks runs but I don't think that's a feasible option either.</p>\n\n<p>Is there a different way that does not rely on a incrementing a counter? I feel like i should be using the <code>succ</code> operator to accomplish what i am trying to do </p>\n"}, {"tags": ["haskell", "multidimensional-array"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1545834956, "post_id": 53932863, "comment_id": 94707091, "body": "Unless you have a specific question about the code, this belongs on <a href=\"https://codereview.stackexchange.com\">Code Review</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10834995, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-exgfuD4Fe4A/AAAAAAAAAAI/AAAAAAAABKA/6rXIHEwKf24/photo.jpg?sz=128", "display_name": "tiquer", "link": "https://stackoverflow.com/users/10834995/tiquer"}, "edited": false, "score": 2, "creation_date": 1545839315, "post_id": 53933524, "comment_id": 94708467, "body": "Thank you for quick solutions! <code>nubOrd</code> saved 30 sec <code>IOUArray</code> saved 3 sec in average. In fact previously I ran without compilation, just used <code>stack runghc ..</code>. After compilation now it ends in 2 seconds! (with <code>nub</code> it still takes about 20 secs)"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 4, "last_activity_date": 1545835766, "last_edit_date": 1545835766, "creation_date": 1545835401, "answer_id": 53933524, "question_id": 53932863, "link": "https://stackoverflow.com/questions/53932863/haskell-ioarray-is-too-slow-when-reading-and-writing-a-lot/53933524#53933524", "title": "Haskell: IOArray is too slow when reading and writing a lot", "body": "<p>I haven't done any profiling, but this is the line that leaps out at me:</p>\n\n<pre><code>  filterM (isEmpty grid) $ nub $ filter inArea $ [up, down, left, right] &lt;*&gt; points\n</code></pre>\n\n<p>In particular, <code>nub</code> is an O(n^2) operation. You might start by trying to use <code>ordNub</code> from <code>Data.Containers.ListUtils</code>.</p>\n\n<p>Another thing I see is that you're using <em>boxed</em> arrays. Boxed arrays have indirection costs and also extra GC costs; they could easily make code using them several times slower than it should be. As a general rule, you should only use boxed arrays if you need either their polymorphism or their laziness. I don't immediately see any of that here.</p>\n\n<p>Finally, a micro-optimization: If you need both the quotient and the remainder, use <code>divMod</code> or <code>quotRem</code> to do the job with just one hardware division. That's not why your code is slow, but it's a good habit. If the numbers are positive, use <code>quotRem</code> for speed. If they're not, be sure to read the documentation to figure out which you should use.</p>\n"}], "owner": {"reputation": 13, "user_id": 10834995, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-exgfuD4Fe4A/AAAAAAAAAAI/AAAAAAAABKA/6rXIHEwKf24/photo.jpg?sz=128", "display_name": "tiquer", "link": "https://stackoverflow.com/users/10834995/tiquer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 53933524, "answer_count": 1, "score": 1, "last_activity_date": 1545835766, "creation_date": 1545831515, "question_id": 53932863, "link": "https://stackoverflow.com/questions/53932863/haskell-ioarray-is-too-slow-when-reading-and-writing-a-lot", "title": "Haskell: IOArray is too slow when reading and writing a lot", "body": "<p>I wrote a small code in Haskell. Could you give a solution to improve performance?</p>\n\n<ul>\n<li>Input: <code>Height</code> and <code>Width</code> of a grid. Locations of point shown as <code>'#'</code></li>\n</ul>\n\n<pre>\n4 4\n##..\n#...\n...#\n....\n</pre>\n\n<ul>\n<li>Output: grid of numbers showing \"Manhattan distance\" to each nearest point.</li>\n</ul>\n\n<pre>\n0 0 1 2\n0 1 2 1\n1 2 1 0\n2 3 2 1\n</pre>\n\n<p>To set a lot of numbers into a grid, I used two-dimensional <code>IOArray</code> to reduce modification costs. It takes more than a minute to process a grid of 500x500, while an alternative code I wrote in Python just takes within 5 seconds.</p>\n\n<p>Less than 16 seconds would be highly appreciated!</p>\n\n<pre><code>import Data.List\nimport Data.Array.IO\nimport Control.Monad\n\ntype Point = (Int, Int)\ntype Grid = IOArray Point Int\n\nmain :: IO ()\nmain = do\n  [height, width] &lt;- (map read . take 2 . words) &lt;$&gt; getLine\n  points &lt;- zeroPoints width &lt;$&gt; getContents\n  grid &lt;- newArray ((1,1), (height, width)) (-1)\n  wfs grid points 0\n  printArray grid\n\nzeroPoints :: Int -&gt; String -&gt; [Point]\nzeroPoints width str = [(i `div` width + 1, i `mod` width + 1) | (i, c) &lt;- chars, c == '#']\n  where chars = zip [0..] (concat $ words str)\n\nwfs :: Grid -&gt; [Point] -&gt; Int -&gt; IO [Point]\nwfs grid [] _ = return []\nwfs grid points distance = do\n  mapM_ (\\p -&gt; writeArray grid p distance) points\n  (_, (height, width)) &lt;- getBounds grid\n  newPoints &lt;- neighbors grid height width points\n  wfs grid newPoints (distance + 1)\n\nneighbors :: Grid -&gt; Int -&gt; Int -&gt; [Point] -&gt; IO [Point]\nneighbors grid height width points =\n  filterM (isEmpty grid) $ nub $ filter inArea $ [up, down, left, right] &lt;*&gt; points\n  where\n    up    (x, y) = (x - 1, y)\n    down  (x, y) = (x + 1, y)\n    left  (x, y) = (x, y - 1)\n    right (x, y) = (x, y + 1)\n    inArea (x, y) = x &gt; 0 &amp;&amp; x &lt;= height &amp;&amp; y &gt; 0 &amp;&amp; y &lt;= width\n    isEmpty grid p = (&lt; 0) &lt;$&gt; readArray grid p\n\nprintArray :: Grid -&gt; IO ()\nprintArray grid = do\n  (_, (height, width)) &lt;- getBounds grid\n  forM_ [(h, w) | h &lt;- [1..height], w &lt;- [1..width]] $ \\(h, w) -&gt; do\n    i &lt;- readArray grid (h, w)\n    if w == width then putStrLn $ show i else putStr $ show i ++ \" \"\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 10, "last_activity_date": 1545797266, "creation_date": 1545797266, "answer_id": 53927318, "question_id": 53927234, "link": "https://stackoverflow.com/questions/53927234/couldnt-match-type-error-even-with-type-constraint/53927318#53927318", "title": "Couldn&#39;t match type error even with type constraint", "body": "<p><code>IO</code> is not equal to <code>MonadIO</code>.</p>\n\n<p><code>MonadIO</code> is a typeclass that, in plain terms, means that the monad in question can perform IO operations. In practice, since <code>IO</code> monad is \"magic\", this can mean only one of two things: the monad in question is <code>IO</code> itself, or the monad in question <em>wraps</em> <code>IO</code> in some way.</p>\n\n<p>To express this idea of wrapping, the <code>MonadIO</code> type class has a method <code>liftIO :: IO a -&gt; m a</code>, which lets you take an <code>IO</code> operation and \"lift\" it (or, if you prefer, \"wrap\" it) into the monad <code>m</code>, whatever that is.</p>\n\n<p>So, to fix your code, all you need is <code>liftIO</code>:</p>\n\n<pre><code>foo :: MonadIO m =&gt; m ()\nfoo = liftIO $ print \"hi\"\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10833599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3777bda0145c972a19f0b2bc4063a075?s=128&d=identicon&r=PG&f=1", "display_name": "xicohuni", "link": "https://stackoverflow.com/users/10833599/xicohuni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 53927318, "answer_count": 1, "score": 2, "last_activity_date": 1545797266, "creation_date": 1545796151, "question_id": 53927234, "link": "https://stackoverflow.com/questions/53927234/couldnt-match-type-error-even-with-type-constraint", "title": "Couldn&#39;t match type error even with type constraint", "body": "<p>How come the following</p>\n\n<pre><code>foo :: MonadIO m =&gt; m ()\nfoo = print \"hi\"\n</code></pre>\n\n<p>causes the following error</p>\n\n<blockquote>\n  <p>Couldn't match type \u2018m\u2019 with \u2018IO\u2019\n        \u2018m\u2019 is a rigid type variable bound by\n          the type signature for:\n            foo :: forall (m :: * -> *). MonadIO m => m ()\n          at foo.hs:57:8\n        Expected type: m ()\n          Actual type: IO ()</p>\n</blockquote>\n\n<p>As far as I know, shouldn't the MonadIO constraint allow this to work since IO () should be equal to a MonadIO ?</p>\n"}, {"tags": ["haskell", "testing", "typeclass", "monad-transformers", "acid-state"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1545819311, "post_id": 53926860, "comment_id": 94701815, "body": "Can you make <code>event</code> a parameter of <code>Db</code>?  <code>class Db event m</code>"}, {"owner": {"reputation": 105, "user_id": 7977320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VlKB.png?s=128&g=1", "display_name": "Harold Fincher", "link": "https://stackoverflow.com/users/7977320/harold-fincher"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1545831086, "post_id": 53926860, "comment_id": 94705820, "body": "@Li-yaoXia Wouldnt I need to pass in a specific type at some point? I dont want to do that since i want to be able to use all the different acid state events from within my monad"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1545838308, "post_id": 53926860, "comment_id": 94708146, "body": "Yes you would need to. If you can&#39;t change the classes, the only way to do anything with a given <code>event</code> is to use the <code>QueryEvent</code>/<code>UpdateEvent</code> classes, but the post doesn&#39;t say what they are."}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 7977320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VlKB.png?s=128&g=1", "display_name": "Harold Fincher", "link": "https://stackoverflow.com/users/7977320/harold-fincher"}, "edited": false, "score": 0, "creation_date": 1545839829, "post_id": 53934116, "comment_id": 94708631, "body": "Thanks this looks very promising but i cant get it to work for my instance Db Test for this line in the instance declaration <code>dbQuery (IsEvent (GetUser name)) = return Nothing</code> i get this error: <code>Could not deduce: MethodResult event ~ Maybe a0       from the context: (MethodState event ~ Database, QueryEvent event)         bound by the type signature for:                    dbQuery :: (MethodState event ~ Database, QueryEvent event) =&gt;                               event -&gt; Test lg (EventResult event)</code>"}, {"owner": {"reputation": 1435, "user_id": 6676199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21f60cb3880bf43a7c74ffeecbf996e1?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Amidon", "link": "https://stackoverflow.com/users/6676199/peter-amidon"}, "reply_to_user": {"reputation": 105, "user_id": 7977320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VlKB.png?s=128&g=1", "display_name": "Harold Fincher", "link": "https://stackoverflow.com/users/7977320/harold-fincher"}, "edited": false, "score": 1, "creation_date": 1545840002, "post_id": 53934116, "comment_id": 94708683, "body": "Aha, that roughly makes sense. I will add a section showing something that might fix it by bringing a type equality into scope (at the cost of some nice syntax)."}, {"owner": {"reputation": 1435, "user_id": 6676199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21f60cb3880bf43a7c74ffeecbf996e1?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Amidon", "link": "https://stackoverflow.com/users/6676199/peter-amidon"}, "reply_to_user": {"reputation": 105, "user_id": 7977320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VlKB.png?s=128&g=1", "display_name": "Harold Fincher", "link": "https://stackoverflow.com/users/7977320/harold-fincher"}, "edited": false, "score": 1, "creation_date": 1545841589, "post_id": 53934116, "comment_id": 94709189, "body": "@HaroldFincher Sorry I missed the type family in the result type earlier! The new section in the solution should work better."}, {"owner": {"reputation": 105, "user_id": 7977320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VlKB.png?s=128&g=1", "display_name": "Harold Fincher", "link": "https://stackoverflow.com/users/7977320/harold-fincher"}, "edited": false, "score": 0, "creation_date": 1545843283, "post_id": 53934116, "comment_id": 94709780, "body": "thanks for all your help but i still cant get it to work. I added an extra sections to my questions."}, {"owner": {"reputation": 1435, "user_id": 6676199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21f60cb3880bf43a7c74ffeecbf996e1?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Amidon", "link": "https://stackoverflow.com/users/6676199/peter-amidon"}, "reply_to_user": {"reputation": 105, "user_id": 7977320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VlKB.png?s=128&g=1", "display_name": "Harold Fincher", "link": "https://stackoverflow.com/users/7977320/harold-fincher"}, "edited": false, "score": 1, "creation_date": 1545843601, "post_id": 53934116, "comment_id": 94709867, "body": "@HaroldFincher - My mistake, can you try the edit I just made to <code>exampleFunction</code>?"}, {"owner": {"reputation": 105, "user_id": 7977320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VlKB.png?s=128&g=1", "display_name": "Harold Fincher", "link": "https://stackoverflow.com/users/7977320/harold-fincher"}, "edited": false, "score": 0, "creation_date": 1545844287, "post_id": 53934116, "comment_id": 94710092, "body": "yes thank you very much! And there is no option to provide cleaner syntax? using a pattern synonym or something?"}, {"owner": {"reputation": 1435, "user_id": 6676199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21f60cb3880bf43a7c74ffeecbf996e1?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Amidon", "link": "https://stackoverflow.com/users/6676199/peter-amidon"}, "reply_to_user": {"reputation": 105, "user_id": 7977320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VlKB.png?s=128&g=1", "display_name": "Harold Fincher", "link": "https://stackoverflow.com/users/7977320/harold-fincher"}, "edited": false, "score": 1, "creation_date": 1545844650, "post_id": 53934116, "comment_id": 94710204, "body": "I agree that it feels like there should be, but I don&#39;t know of anything particularly great. A little bit of experimenting with various patterns failed to find anything that didn&#39;t result in ambiguous type variable errors. I have &quot;digging through GHC&#39;s implementation inference in pattern synonyms&quot; on my todo list, but haven&#39;t gotten around to it yet. <a href=\"https://stackoverflow.com/questions/41753345/how-can-i-write-this-pattern-synonym-without-ambiguous-type-errors\" title=\"how can i write this pattern synonym without ambiguous type errors\">stackoverflow.com/questions/41753345/&hellip;</a> gives a slightly nicer syntax, however."}], "tags": [], "owner": {"reputation": 1435, "user_id": 6676199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21f60cb3880bf43a7c74ffeecbf996e1?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Amidon", "link": "https://stackoverflow.com/users/6676199/peter-amidon"}, "is_accepted": true, "score": 1, "last_activity_date": 1545843529, "last_edit_date": 1545843529, "creation_date": 1545839006, "answer_id": 53934116, "question_id": 53926860, "link": "https://stackoverflow.com/questions/53926860/using-type-classes-to-provide-alternative-implementations-for-when-using-acid-st/53934116#53934116", "title": "using type classes to provide alternative implementations for when using Acid-State", "body": "<p>In this case, what you want should be possible, because a <code>QueryEvent</code> or <code>UpdateEvent</code> is a <code>Method</code>, and a <code>Method</code> is <code>Typeable</code>. <code>Typeable</code> lets us use functions from <code>Data.Typeable</code> to inspect what specific type we have at runtime, which we can't really normally do.</p>\n\n<p>Here's a small, self-contained example that doesn't directly use <code>acid-state</code> but begins to illustrate the idea:</p>\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\n{-# LANGUAGE PatternSynonyms #-}\n</code></pre>\n\n<p>These aren't strictly necessary, but make it possible to make nicer syntax for matching on <code>Event</code>s.</p>\n\n<pre><code>import Data.Typeable\n</code></pre>\n\n<p>We need functions from this module to access the run-time typing information.</p>\n\n<pre><code>data GetVersion = GetVersion\ndata GetUser = GetUser String\nclass Typeable a =&gt; QueryEvent a where\ninstance QueryEvent GetVersion where\ninstance QueryEvent GetUser where\n</code></pre>\n\n<p>A simplified set of types/classes to emulate what <code>acid-state</code> should produce.</p>\n\n<pre><code>pattern IsEvent p &lt;- (cast -&gt; Just p)\n</code></pre>\n\n<p>This \"pattern synonym\" makes it so that we can write <code>IsEvent p</code> on the LHS of a pattern match and have it work the same way as if we had written <code>(cast -&gt; Just p)</code>. This latter is a \"view pattern\" which essentially runs the function <code>cast</code> on the input and then pattern matches it against <code>Just p</code>. <code>cast</code> is a function defined in <code>Data.Typeable</code>: <code>cast :: forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b</code>.  This means that if we write, for example, <code>(cast -&gt; Just GetVersion)</code>, what happens is that <code>cast</code> tries to convert the argument into a value of type <code>GetVersion</code>, which is then pattern-matched against the value-level <code>GetVersion</code> symbol; if the conversion fails (implying that the event is something else), <code>cast</code> returns <code>Nothing</code>, so this pattern doesn't match.  This lets us write:</p>\n\n<pre><code>exampleFunction :: QueryEvent a =&gt; a -&gt; String\nexampleFunction (IsEvent GetVersion) = \"get version\"\nexampleFunction (IsEvent (GetUser a)) = \"get user \" ++ a\n</code></pre>\n\n<p>This then works:</p>\n\n<pre><code>\u03bb&gt; exampleFunction GetVersion\n\"get version\"\n\u03bb&gt; exampleFunction (GetUser \"foo\")\n\"get user foo\"\n</code></pre>\n\n<hr>\n\n<p>Your situation is a bit more complicated, since the (type of) the RHS of the function depends on the type of the input.  We will need some more extensions for this:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}               -- For type equality\n{-# LANGUAGE TypeOperators #-}       -- For type equality\n{-# LANGUAGE TypeFamilies #-}        -- For EventResult\n{-# LANGUAGE ScopedTypeVariables #-} -- For writing castWithWitness\n{-# LANGUAGE TypeApplications #-}    -- For convenience\n</code></pre>\n\n<p>We can also add <code>EventResult</code> to our dummy simple <code>QueryEvent</code>:</p>\n\n<pre><code>class Typeable a =&gt; QueryEvent a where\n  type EventResult a\ninstance QueryEvent GetVersion where\n  type EventResult GetVersion = Int\ninstance QueryEvent GetUser where\n  type EventResult GetUser = String\n</code></pre>\n\n<p>Instead of using <code>cast</code>, we can use</p>\n\n<pre><code>castWithWitness :: forall b a. (Typeable a, Typeable b)\n                =&gt; a -&gt; Maybe (b :~: a, b)\ncastWithWitness x = case eqT @a @b of\n                      Nothing -&gt; Nothing\n                      Just Refl -&gt; Just (Refl, x)\n</code></pre>\n\n<p>The <code>@a</code> and <code>@b</code> are using <code>TypeApplications</code> to apply <code>eqT</code> to the types that <code>castWithWitness</code> was applied to, which are bound via <code>ScopedTypeVariables</code> using the <code>forall</code> in the type signature. <code>castWithWitness</code> is like <code>cast</code>, but in addition to the \"casted\" variable, it returns a proof that the passed-in types are the same.  Unfortunately, this makes it a bit harder to use: the <code>IsEvent</code> pattern synonym can't be used, and the relevant type needs to be passed in directly:</p>\n\n<pre><code>exampleFunction :: forall a. QueryEvent a =&gt; a -&gt; EventResult a\nexampleFunction (castWithWitness @GetVersion -&gt; Just (Refl, GetVersion)) = 1\nexampleFunction (castWithWitness @GetUser -&gt; Just (Refl, GetUser n)) = n\n</code></pre>\n\n<p>This works, because in each case, after matching on <code>Refl</code>, GHC knows on the RHS of the function what <code>a</code> is and can reduce the <code>EventResult</code> type family.</p>\n"}], "owner": {"reputation": 105, "user_id": 7977320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VlKB.png?s=128&g=1", "display_name": "Harold Fincher", "link": "https://stackoverflow.com/users/7977320/harold-fincher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 53934116, "answer_count": 1, "score": 0, "last_activity_date": 1545843529, "creation_date": 1545790985, "last_edit_date": 1545843182, "question_id": 53926860, "link": "https://stackoverflow.com/questions/53926860/using-type-classes-to-provide-alternative-implementations-for-when-using-acid-st", "title": "using type classes to provide alternative implementations for when using Acid-State", "body": "<p>I wrote a web application using scotty and acid state, now i would like to use type classes to be able to provide alternative implementations for the capabilities of my application for testing.\nI get the general idea of it and am able to apply it so simple examples but since im am using acid state there are a lot of type classes and template haskell involved which i am not entirely comfortable with yet.</p>\n\n<p>so i have these straight-forward classes for the different capabilities</p>\n\n<pre><code>class Logging m where\n  log :: T.Text -&gt; m ()\n\nclass Server m where\n  body :: m B.ByteString\n  respond :: T.Text -&gt; m ()\n  setHeader :: T.Text -&gt; T.Text -&gt; m ()\n\nclass Db m where\n  dbQuery :: (MethodState event ~ Database,QueryEvent event) =&gt; event -&gt; m (EventResult event)\n  dbUpdate :: (MethodState event ~ Database,UpdateEvent event) =&gt; event -&gt; m (EventResult event)\n</code></pre>\n\n<p>and i also provided instances for them for my \"production\" monad. </p>\n\n<p>But when it comes to the database capability i cant get to work what i want.</p>\n\n<p>the class looks like this</p>\n\n<pre><code>class Db m where\n  dbQuery :: (MethodState event ~ Database,QueryEvent event) =&gt; event -&gt; m (EventResult event)\n  dbUpdate :: (MethodState event ~ Database,UpdateEvent event) =&gt; event -&gt; m (EventResult event)\n</code></pre>\n\n<p>and the instance for the production monad works fine since it only passes the event to the update and query functions of acid state, but for a test monad i would like to have something like this:\n    instance Db Test where\n      dbQuery (GetVersion) = use (testDb . clientVersion)\n      dbQuery (GetUser name) = preuse (testDb . users . ix name)\n      dbUpdate (PutUser name user) = users %= M.insert name user\n      ...\nso that I can match on GetVersion,GetUser etc. (which are generated by the template haskell function makeAcidic ... ) and specify how they should be handled in the test environment. </p>\n\n<p>But I get the error:</p>\n\n<pre><code>Could not deduce: event ~ GetVersion\nfrom the context: (MethodState event ~ Database, QueryEvent event)\n  bound by the type signature for:\n              dbQuery :: (MethodState event ~ Database, QueryEvent event) =&gt;\n                        event -&gt; Test (EventResult event)\n  at Main.hs:88:3-9\n\u2018event\u2019 is a rigid type variable bound by\n  the type signature for:\n    dbQuery :: forall event.\n                (MethodState event ~ Database, QueryEvent event) =&gt;\n                event -&gt; Test (EventResult event)\n  at Main.hs:88:3\n\u2022 In the pattern: GetVersion\nIn an equation for \u2018dbQuery\u2019:\n    dbQuery (GetVersion) = use (testDb . clientVersion)\nIn the instance declaration for \u2018Db Test\u2019\n\u2022 Relevant bindings include\n  dbQuery :: event -&gt; Test (EventResult event)\n    (bound at Main.hs:88:3)\n</code></pre>\n\n<p>i guess thats because GetVersion, GetUser etc. all have a their different own types. So is there a way to do this?</p>\n\n<hr>\n\n<h2>Incorporating suggestions</h2>\n\n<p>I tried the suggestions proposed by Peter Amidon but sadly it still doesnt compile here is my test code</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}               -- For type equality\n{-# LANGUAGE TypeOperators #-}       -- For type equality\n{-# LANGUAGE TypeFamilies #-}        -- For EventResult\n{-# LANGUAGE ScopedTypeVariables #-} -- For writing castWithWitness\n{-# LANGUAGE TypeApplications #-}    -- For convenience\n{-# LANGUAGE TemplateHaskell #-}\n{-# LANGUAGE ViewPatterns #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Lens\nimport Data.Acid\nimport qualified Data.Text.Lazy as T\nimport Types\nimport Data.Typeable\n\nmain = return ()\n\ngetUser :: Username -&gt; Query Database (Maybe User)\ngetUser name = preview (users . ix name)\n\ngetVersion :: Query Database T.Text\ngetVersion = view clientVersion\n\n$(makeAcidic ''Database ['getUser,'getVersion])\n\ncastWithWitness :: forall b a. (Typeable a, Typeable b)\n                =&gt; a -&gt; Maybe (b :~: a, b)\ncastWithWitness x = case eqT @a @b of\n                      Nothing -&gt; Nothing\n                      Just Refl -&gt; Just (Refl, x)\n\nexampleFunction :: forall a. QueryEvent a =&gt; a -&gt; EventResult a\nexampleFunction (castWithWitness @GetVersion -&gt; (Just Refl, Just GetVersion)) = \"1.0\"\nexampleFunction (castWithWitness @GetUser -&gt; (Just Refl, Just (GetUser n))) = Nothing\n</code></pre>\n\n<p>and here the error</p>\n\n<pre><code>Main.hs:124:49: error:\n    \u2022 Couldn't match expected type \u2018Maybe\n                                      (GetVersion :~: a, GetVersion)\u2019\n                  with actual type \u2018(Maybe (t1 :~: t2), t0)\u2019\n    \u2022 In the pattern: (Just Refl, Just GetVersion)\n      In the pattern:\n        castWithWitness @GetVersion -&gt; (Just Refl, Just GetVersion)\n      In an equation for \u2018exampleFunction\u2019:\n          exampleFunction\n            (castWithWitness @GetVersion -&gt; (Just Refl, Just GetVersion))\n            = \"1.0\"\n    \u2022 Relevant bindings include\n        exampleFunction :: a -&gt; EventResult a (bound at Main.hs:124:1)\n\nMain.hs:124:61: error:\n    \u2022 Couldn't match expected type \u2018t0\u2019\n                  with actual type \u2018Maybe GetVersion\u2019\n        \u2018t0\u2019 is untouchable\n          inside the constraints: t2 ~ t1\n          bound by a pattern with constructor:\n                    Refl :: forall k (a :: k). a :~: a,\n                  in an equation for \u2018exampleFunction\u2019\n          at Main.hs:124:55-58\n    \u2022 In the pattern: Just GetVersion\n      In the pattern: (Just Refl, Just GetVersion)\n      In the pattern:\n        castWithWitness @GetVersion -&gt; (Just Refl, Just GetVersion)\n\nMain.hs:125:46: error:\n    \u2022 Couldn't match expected type \u2018Maybe (GetUser :~: a, GetUser)\u2019\n                  with actual type \u2018(Maybe (t4 :~: t5), t3)\u2019\n    \u2022 In the pattern: (Just Refl, Just (GetUser n))\n      In the pattern:\n        castWithWitness @GetUser -&gt; (Just Refl, Just (GetUser n))\n      In an equation for \u2018exampleFunction\u2019:\n          exampleFunction\n            (castWithWitness @GetUser -&gt; (Just Refl, Just (GetUser n)))\n            = Nothing\n    \u2022 Relevant bindings include\n        exampleFunction :: a -&gt; EventResult a (bound at Main.hs:124:1)\n\nMain.hs:125:79: error:\n    \u2022 Could not deduce: MethodResult a ~ Maybe a0\n      from the context: t5 ~ t4\n        bound by a pattern with constructor:\n                  Refl :: forall k (a :: k). a :~: a,\n                in an equation for \u2018exampleFunction\u2019\n        at Main.hs:125:52-55\n      Expected type: EventResult a\n        Actual type: Maybe a0\n      The type variable \u2018a0\u2019 is ambiguous\n    \u2022 In the expression: Nothing\n      In an equation for \u2018exampleFunction\u2019:\n          exampleFunction\n            (castWithWitness @GetUser -&gt; (Just Refl, Just (GetUser n)))\n            = Nothing\n    \u2022 Relevant bindings include\n        exampleFunction :: a -&gt; EventResult a (bound at Main.hs:124:1)\n</code></pre>\n"}, {"tags": ["haskell", "higher-order-functions"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1545766638, "post_id": 53925014, "comment_id": 94691826, "body": "What helper are you talking about? <code>filter&#39;</code> <i>is</i> <code>filter</code>. This is just a straightforward recursive function, with <code>filter&#39;</code> calling itself on the tail of its list input."}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1545783051, "post_id": 53925014, "comment_id": 94694377, "body": "@chepner I think helper is the function given to <code>filter</code>. <code>filter&#39;</code> is used to distinguish it from the real <code>filter</code>."}, {"owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 1, "creation_date": 1545783325, "post_id": 53925014, "comment_id": 94694416, "body": "I don&#39;t see why you used &quot;lambda calculus&quot; here."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "edited": false, "score": 0, "creation_date": 1545965076, "post_id": 53925014, "comment_id": 94744693, "body": "@MarkNeu He talks about the helper function evaluating <code>a</code>, which is the predicate passed to <code>filter</code>."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1545910860, "post_id": 53925908, "comment_id": 94727562, "body": "Why does f doesnt have the type a -&gt; [a] -&gt; Bool because it would make more sense to evaluate the predicate a on list [a]. Its illogical that a on itself can be determined as True or False, isnt it? The filter&#39; function also takes in a list (second parameter) to give back a list. Is the first [a] in the type denotation xs and the second [a] represents x:filter&#39; f xs. Thanks a lot. I find your explanation most comprehensible."}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1545911704, "post_id": 53925908, "comment_id": 94727937, "body": "In every Haskell function type signature, the part after the last arrow is the result of the function.  Here, the second <code>[a]</code> is the result - the list of elements for which the predicate is True.  This <code>filter&#39;</code> is the same as <code>filter</code> in the standard library.  It works for predicates on single elements.  For example, <code>filter even</code> or <code>filter (not . null)</code>.  This is also efficient - the function considers each <code>a</code> exactly once."}, {"owner": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1545990981, "post_id": 53925908, "comment_id": 94751064, "body": "I think you have missed my point. i understand that the second [a] is the result                                                        filter&#39; f (x:xs)   | f x == True = x:filter&#39; f xs                                                                                           What i dont get is the fourth line, we already have the function f and x as a in (a-&gt; Bool) but im not sure where the first [a] is implemented."}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "edited": false, "score": 0, "creation_date": 1546025128, "post_id": 53925908, "comment_id": 94764400, "body": "The second argument to <code>filter</code> has the type <code>[a]</code>.  This list matches either <code>[]</code> or <code>(x:xs)</code>.  The line <code>filter _ [] = []</code> defines what to do if passed the empty list.  The 3 lines beginning <code>filter f (x:xs)</code> defines what to do if passed a non-empty list, and bind the two variables <code>x</code> and <code>xs</code>.  These two cases cover all possible lists."}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 2, "last_activity_date": 1545775514, "creation_date": 1545775514, "answer_id": 53925908, "question_id": 53925014, "link": "https://stackoverflow.com/questions/53925014/understanding-haskell-function-in-a-lambda-calculus-way/53925908#53925908", "title": "Understanding Haskell function in a lambda calculus way", "body": "<p>I think this will be clearer if we give the function of type <code>a -&gt; Bool</code> a name other than <code>a</code>.</p>\n\n<pre><code>filter' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' _ [] = []\nfilter' f (x:xs)\n  | f x == True = x:filter' f xs\n  | otherwise = filter' f xs\n</code></pre>\n\n<p>Now <code>f</code> has type <code>a -&gt; Bool</code>, <code>x :: a</code>, and <code>xs :: [a]</code>.</p>\n\n<p>I like your description of <code>(a -&gt; Bool) -&gt; [a] -&gt; [a]</code> as \"takes in a function and a list to give a list\".  The recursive calls to <code>filter'</code> in lines 4 &amp; 5 have the same type.  <code>f</code> is passed along unchanged.  <code>xs</code> is a list of <code>a</code>s, but it's one <code>a</code> shorter than the input list.  There is only <em>one</em> function <code>filter'</code>.  The definition of the function refers to itself - that's an essential part of what we mean by \"recursive function\".</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1545813034, "creation_date": 1545813034, "answer_id": 53929441, "question_id": 53925014, "link": "https://stackoverflow.com/questions/53925014/understanding-haskell-function-in-a-lambda-calculus-way/53929441#53929441", "title": "Understanding Haskell function in a lambda calculus way", "body": "<p>You can use the syntax even more to aid your understanding:</p>\n\n<pre><code>filter' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' p [] = []\nfilter' p (x:xs)\n     | (p  x) == True   = x : ( filter' p xs )\n     | otherwise        =     ( filter' p xs )\n</code></pre>\n\n<p>Which is</p>\n\n<pre><code>filter' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' p [] = []\nfilter' p (x:xs)\n     | (p  x)     = x : ( filter' p xs )\n     | otherwise  =     ( filter' p xs )\n</code></pre>\n\n<p>Or translate it to the more basic constructs,</p>\n\n<pre><code>filter' :: (a -&gt; Bool) \n          -&gt;   [a] -&gt; [a]\nfilter' p = ( \\ xs -&gt; case xs of \n             {  []            -&gt;  []\n             ;  (x:ys) | p x  -&gt;  x : ( filter' p ys )\n             ;  (x:ys)        -&gt;      ( filter' p ys )  } )\n</code></pre>\n\n<p><em>\" <code>p</code>\"</em> is for <em>\"predicate\"</em>. It is used by <code>filter'</code> to test each <code>x</code> in the input <code>xs</code>, to decide whether to include that <code>x</code> or not in the output, according to the <code>Bool</code>ean value that the testing has produced. </p>\n\n<p><code>p</code> is just passed around unchanged from one invocation of <code>filter'</code> to the next. This is usually coded away with the so called \"worker-wrapper\" transformation,</p>\n\n<pre><code>filter' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' p xs = go xs where\n   go [] = []\n   go (x:xs) | p x   = x : go xs\n             | otherwise = go xs\n</code></pre>\n\n<p>Lastly, a simpler-looking definition could also be</p>\n\n<pre><code>filter' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' p xs = go xs where\n   go []     = []\n   go (x:xs) = [x | p x] ++ go xs\n</code></pre>\n\n<p>which corresponds nicely with the <code>foldMap</code>-based definition</p>\n\n<pre><code>filter' p = foldMap (\\ x -&gt; [x | p x])\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 10832310, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-BTRsOLhbuYY/AAAAAAAAAAI/AAAAAAAAAAA/sZXLwRw5JZ0/photo.jpg?sz=128", "display_name": "Jung", "link": "https://stackoverflow.com/users/10832310/jung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1545813034, "creation_date": 1545765313, "question_id": 53925014, "link": "https://stackoverflow.com/questions/53925014/understanding-haskell-function-in-a-lambda-calculus-way", "title": "Understanding Haskell function in a lambda calculus way", "body": "<p>Im trying to define the filter function. Based on the function's definition, the filter' function is a function (say help function to differ from the main filter' function) that takes in a function and a list to give a list. The help function takes in a variable and gives back a Bool value. But according the line 4, the help function evaluates a along with [x] to give a Bool Value which then finally gives back a list. </p>\n\n<p>So can I understand the help function as a function that takes in a and [a] to give a Bool value. The main filter' function then takes in this Bool value to give back a list? </p>\n\n<p>Im aware that the function's definition does not suggest this but it's kinda logical based on the code. Thanks</p>\n\n<pre><code>filter' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' _ [] = []\nfilter' a (x:xs)\n  | a x == True = x:filter' a xs\n  | otherwise = filter' a xs\n</code></pre>\n"}, {"tags": ["haskell", "typeclass", "monoids", "semigroup"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1545808194, "post_id": 53924817, "comment_id": 94698300, "body": "I wonder if what you really want is semigroup with subtraction of some kind, or the cancellation property... that is with a different class maybe you could write an implementation that is more interesting, e.g. maybe it might be <code>isSubSequenxeOf</code> on lists as sequences."}, {"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1545820762, "post_id": 53924817, "comment_id": 94702331, "body": "@assembly.jc: I&#39;m looking for a function that would do the same as <code>isSubSetOf</code> when instantiated for <code>Set a</code>, and in general would always do something equivalent to <code>mayBeMempty</code> defined above but efficiently (not necessarily using <code>&lt;&gt;</code> and <code>==</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 0, "creation_date": 1545809229, "post_id": 53926355, "comment_id": 94698602, "body": "It could be made more efficient if there was a class for this method. Then <code>Set a</code>&#39;s instance would be <code>isSubSetOf</code>."}, {"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 0, "creation_date": 1545822013, "post_id": 53926355, "comment_id": 94702753, "body": "I&#39;ve also searched with Hoogle before asking on SO and didn&#39;t find anything.  After thinking more about this and concluding the the term for it is &quot;partial order&quot; I&#39;ve now found both <a href=\"https://www.stackage.org/haddock/lts-13.0/lattices-1.7.1.1/Algebra-PartialOrd.html\" rel=\"nofollow noreferrer\">stackage.org/haddock/lts-13.0/lattices-1.7.1.1/&hellip;</a> and the <code>partial-order</code> package on Hackage"}], "tags": [], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "is_accepted": false, "score": 0, "last_activity_date": 1545781767, "creation_date": 1545781767, "answer_id": 53926355, "question_id": 53924817, "link": "https://stackoverflow.com/questions/53924817/maybemempty-function-for-a-semigroup/53926355#53926355", "title": "&quot;mayBeMempty&quot; function for a Semigroup", "body": "<p>I have searched with Hoogle and think there is no pre-implemented version of this.</p>\n\n<p>I don't really see how it could be made more efficient, TBH.</p>\n"}, {"tags": [], "owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "is_accepted": true, "score": 0, "last_activity_date": 1545902857, "creation_date": 1545902857, "answer_id": 53942680, "question_id": 53924817, "link": "https://stackoverflow.com/questions/53924817/maybemempty-function-for-a-semigroup/53942680#53942680", "title": "&quot;mayBeMempty&quot; function for a Semigroup", "body": "<p><code>PartialOrd</code>'s <a href=\"https://www.stackage.org/haddock/lts-13.0/lattices-1.7.1.1/Algebra-PartialOrd.html#v:leq\" rel=\"nofollow noreferrer\"><code>leq</code></a> is what I was looking for.</p>\n\n<p>IIUC, a difference is that it is not designed to fit the rules as I described for <code>Semigroup</code>, but instead it's designed to work in this manner with <code>Lattice</code> which is defined in the same package, which is similar to a semigroup in some ways but better fits things like sets where merging something with itself results in itself.</p>\n"}], "owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 1, "accepted_answer_id": 53942680, "answer_count": 2, "score": 1, "last_activity_date": 1545902857, "creation_date": 1545763595, "question_id": 53924817, "link": "https://stackoverflow.com/questions/53924817/maybemempty-function-for-a-semigroup", "title": "&quot;mayBeMempty&quot; function for a Semigroup", "body": "<p>The following function -</p>\n\n<pre><code>mayBeMempty :: (Eq a, Semigroup a) =&gt; a -&gt; a -&gt; Bool\nmayBeMempty candidate ref = candidate &lt;&gt; ref == ref\n</code></pre>\n\n<p>Is a (less efficient) generalization of <code>Data.Set.isSubSetOf</code>. It checks if the first argument is \"contained\" in the second one and always returns <code>True</code> when the first argument is <code>mempty</code> (when it returns <code>False</code> it is known to not be <code>mempty</code>).</p>\n\n<p>Does anyone know if this function or concept already exist under some name or even an existing type-class (in which case it would not be less efficient than <code>isSubSetOf</code>)?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 3, "creation_date": 1545728082, "post_id": 53920562, "comment_id": 94683716, "body": "Why do you need to make <code>Box</code> as instance of <code>Monad</code>? Actually, it cannot, because every instance of <code>Monad</code> must have a polymorphic type parameter, like <code>data Box a = Box a</code>. You cannot specify it only for <code>Candy</code> type."}, {"owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "edited": false, "score": 2, "creation_date": 1545728180, "post_id": 53920562, "comment_id": 94683740, "body": "<code>Box</code> <i>cannot</i> be a monad because it has no type parameter."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1545730501, "post_id": 53920562, "comment_id": 94684217, "body": "Whatever you are trying to do, I think you don&#39;t need monads at all."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1545731237, "post_id": 53920562, "comment_id": 94684373, "body": "I we&#39;re supposed to make sense of what you&#39;re trying to achieve here, please add some more realistic example, make sure it uses proper, correct Haskell syntax, and show what you&#39;d want the result to be."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1545754589, "post_id": 53920562, "comment_id": 94689465, "body": "I wonder if you are thinking of the State monad, with Box as the state parameter. See <a href=\"https://wiki.haskell.org/State_Monad\" rel=\"nofollow noreferrer\">wiki.haskell.org/State_Monad</a> and <a href=\"http://brandon.si/code/the-state-monad-a-tutorial-for-the-confused/\" rel=\"nofollow noreferrer\">brandon.si/code/the-state-monad-a-tutorial-for-the-confused</a>"}], "answers": [{"comments": [{"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1545758002, "post_id": 53922937, "comment_id": 94690111, "body": "The thing inside a <code>Box</code> is a <code>Candy</code>, so it is confusing to bind it to a variable named <code>box</code>"}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 1, "last_activity_date": 1545745417, "creation_date": 1545745417, "answer_id": 53922937, "question_id": 53920562, "link": "https://stackoverflow.com/questions/53920562/how-to-write-this-simple-monad-that-can-chang-any-item-of-a-record/53922937#53922937", "title": "How to write this simple Monad that can chang any item of a record?", "body": "<p>As others have noted, none of your examples require a Monad.  All are valid if you leave out the <code>&gt;&gt;=</code> and <code>return</code>.  For example:</p>\n\n<pre><code>expensiveToffee (Box box) = Box (box {name=\"Toffee\",price=2})\n\nisToffee (Box box) = \n  if (name box==\"toffee\") \n  then Box (box {name=\"Toffee\",price=2})\n  else Box (box {name=\"other\"})\n</code></pre>\n\n<p>As an aside, since several of these don't actually use any fields of the <code>Box</code>, you can construct a <code>Candy</code> directly instead of using the record-update syntax.</p>\n\n<pre><code>expensiveToffee2 (Box _box) = Box (Candy {name=\"Toffee\",price=2})\n</code></pre>\n\n<p>or even skip the input to this function, since it is ignored:</p>\n\n<pre><code>expensiveToffee3 = Box (Candy {name=\"Toffee\",price=2})\n</code></pre>\n"}], "owner": {"reputation": 1277, "user_id": 7254635, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/280e5fa5140a804fcd8fd9dfe3198542?s=128&d=identicon&r=PG&f=1", "display_name": "wang kai", "link": "https://stackoverflow.com/users/7254635/wang-kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 53922937, "answer_count": 1, "score": 0, "last_activity_date": 1545745417, "creation_date": 1545725825, "question_id": 53920562, "link": "https://stackoverflow.com/questions/53920562/how-to-write-this-simple-monad-that-can-chang-any-item-of-a-record", "title": "How to write this simple Monad that can chang any item of a record?", "body": "<p>I have these data types,which means a box of candy:</p>\n\n<pre><code>data Candy=Candy {name::String,price::Int}\n\ndata Box=Box Candy\n\nlet toffee=Candy {name=\"toffee\",price=1}\n\nlet box=Box {candy=toffee}\n</code></pre>\n\n<p>I want make the Box as instance of Monad,that can do this:</p>\n\n<pre><code>box&gt;&gt;=x-&gt;return x {name=\"Toffee\",price=2}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>box&gt;&gt;=x-&gt;return x {name=\"Toffee\"}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>box&gt;&gt;=x-&gt;return x {price=2}\n</code></pre>\n\n<p>or </p>\n\n<pre><code>box&gt;&gt;=x-&gt;\n  if (name x==\"toffee\") return x {name=\"Toffee\",price=2}\n  else return x {name=\"other\"}\n</code></pre>\n\n<p>I am new to haskell,I try to write this but fail:</p>\n\n<pre><code>instance Monad Box where\n return x=Box x\n Box x&gt;&gt;=f=f x\n</code></pre>\n\n<p>so how to write this monad?Thanks!</p>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 3, "last_activity_date": 1545771281, "last_edit_date": 1545771281, "creation_date": 1545724528, "answer_id": 53920424, "question_id": 53920220, "link": "https://stackoverflow.com/questions/53920220/how-to-modify-an-element-that-matches-a-condition-using-lenses/53920424#53920424", "title": "How to modify an element that matches a condition using lenses?", "body": "<p>Try this:</p>\n\n<pre><code>modifyElem :: Traversable t =&gt; (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; t a -&gt; t a\nmodifyElem predicate transform target =\n  target &amp; traverse . filtered predicate %~ transform\n</code></pre>\n"}], "owner": {"reputation": 5657, "user_id": 534481, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/60df8c1a366ab1bf4378154e71a93367?s=128&d=identicon&r=PG", "display_name": "Saurabh Nanda", "link": "https://stackoverflow.com/users/534481/saurabh-nanda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545771281, "creation_date": 1545722593, "question_id": 53920220, "link": "https://stackoverflow.com/questions/53920220/how-to-modify-an-element-that-matches-a-condition-using-lenses", "title": "How to modify an element that matches a condition using lenses?", "body": "<p>I'm trying to write a function with the following type-signature using lenses, but staring blankly at <a href=\"http://hackage.haskell.org/package/lens-4.17/docs/Control-Lens-Fold.html#v:filtered\" rel=\"nofollow noreferrer\"><code>filtered</code></a> is apparently not working!</p>\n\n<pre><code>modifyElem\n  :: (a -&gt; Bool)      -- predicate function\n  -&gt; (a -&gt; a)         -- modification to apply\n  -&gt; [a]\n  -&gt; [a]\n</code></pre>\n\n<p>If possible, this could also be generalised further to the following:</p>\n\n<pre><code>modifyElem\n  :: (Foldable t)     -- or (Traversable t)\n  -&gt; (a -&gt; Bool)\n  -&gt; (a -&gt; a)\n  -&gt; t a\n  -&gt; t a\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1545720772, "post_id": 53919852, "comment_id": 94682418, "body": "Implicit parameters and the &quot;implicit configurations&quot; paper might be some help."}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1545750869, "post_id": 53919852, "comment_id": 94688713, "body": "In my experience, <i>explicitly</i> passing dependencies the &quot;ugly&quot; way you describe is a best practice, in <i>every</i> programming language.  &quot;I import this module and my dependencies magically appear&quot; makes it very hard to tell what the dependencies actually are and how you interact with them."}], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": true, "score": 0, "last_activity_date": 1545744921, "creation_date": 1545744921, "answer_id": 53922866, "question_id": 53919852, "link": "https://stackoverflow.com/questions/53919852/how-to-got-put-params-from-config-file-to-a-single-module/53922866#53922866", "title": "How to got put params from config file to a single module?", "body": "<p>The most common way to pass a global state in Haskell is with a <a href=\"https://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Monad-Trans-Reader.html\" rel=\"nofollow noreferrer\">Reader</a> type.  Then you can access your <code>Params</code> with <a href=\"https://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Monad-Trans-Reader.html#v:ask\" rel=\"nofollow noreferrer\">ask</a> when needed.</p>\n\n<p>This is quite similar to passing the <code>Params</code> explicitly, and that's also a fine choice.</p>\n"}], "owner": {"reputation": 1277, "user_id": 7254635, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/280e5fa5140a804fcd8fd9dfe3198542?s=128&d=identicon&r=PG&f=1", "display_name": "wang kai", "link": "https://stackoverflow.com/users/7254635/wang-kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 53922866, "answer_count": 1, "score": 1, "last_activity_date": 1545744921, "creation_date": 1545718778, "question_id": 53919852, "link": "https://stackoverflow.com/questions/53919852/how-to-got-put-params-from-config-file-to-a-single-module", "title": "How to got put params from config file to a single module?", "body": "<p>I have a program have to read params from config file when the program start.In other language,I create a module,or class,called Params,when the program start,I use Params.set to set the params read from config file,and at any place,when I need to use the params,I use Params.get to read the value of the params</p>\n\n<p>but in haskell,because there is no varaible,so it seems I have to read the params from the main function,then put all of it to a record,for example,named Params,then use the record Params as the function's param and pass it to every function that use the params form config file.I think it's ulgy.I have no idea of how to put the param values to a seperate module or file</p>\n\n<p>Is there some way to resolve this?Thanks!</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "haskell-spock"], "comments": [{"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1545753459, "post_id": 53919450, "comment_id": 94689246, "body": "Which version of Spock are you using? Looking at the <a href=\"http://hackage.haskell.org/package/Spock-0.13.0.0/docs/Web-Spock.html\" rel=\"nofollow noreferrer\">latest version</a> it seems that <code>SpockM</code> is just a type alias for <code>SpockCtxT</code>, which is a monad transformer, and the alias uses <a href=\"http://hackage.haskell.org/package/Spock-0.13.0.0/docs/Web-Spock.html#t:WebStateM\" rel=\"nofollow noreferrer\"><code>WebStateM</code></a> inside. Perhaps adding <code>Statet</code> somewhere within this stack might work."}, {"owner": {"reputation": 4040, "user_id": 365377, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6f5d678558599d715bfaa6284509e99f?s=128&d=identicon&r=PG", "display_name": "Jesse Shieh", "link": "https://stackoverflow.com/users/365377/jesse-shieh"}, "reply_to_user": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1545757792, "post_id": 53919450, "comment_id": 94690069, "body": "I&#39;m on version 0.13.0.0. Yeah, it looks like the transformer stack they use is SpockCtxT -&gt; WebStateT -&gt; ResourceT -&gt; IO, but with no apparent way to insert <code>m</code> anywhere. My best guess at the moment, is that they expect you to revert back to the <code>spockT</code> function in order to use a custom monad, but then you lose all the nice features of <code>spock</code>, <code>SpockCfg</code> and <code>SpockM</code>."}], "owner": {"reputation": 4040, "user_id": 365377, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/6f5d678558599d715bfaa6284509e99f?s=128&d=identicon&r=PG", "display_name": "Jesse Shieh", "link": "https://stackoverflow.com/users/365377/jesse-shieh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1545713815, "creation_date": 1545713815, "question_id": 53919450, "link": "https://stackoverflow.com/questions/53919450/how-to-add-a-monad-transformer-into-a-spock-app", "title": "How to add a monad transformer into a Spock app?", "body": "<p>I have a basic hello world Spock app from following the <a href=\"https://www.spock.li/tutorials/getting-started\" rel=\"nofollow noreferrer\">tutorial</a>, but now I want to add my own monad transformer, <code>FooT</code>, into the Spock transformer stack somehow. </p>\n\n<p>I found <a href=\"https://stackoverflow.com/questions/31952792/how-do-i-use-a-persistent-state-monad-with-spock\">this answer</a>, but it looks like <code>spockT</code> isn't really used in the latest version of spock. Looks like now there is a <code>spock</code> function that takes a <code>SpockCfg</code> and a <code>SpockM</code>, but I don't see anything that takes an <code>m</code> argument where I can specify my monad transformer. Is it still possible to insert a <code>FooT</code>, <code>StateT</code>, or any other monad transformer into the spock transformer stack somehow? What am I misunderstanding? Thank you!</p>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1545706447, "post_id": 53918918, "comment_id": 94680612, "body": "According to <a href=\"https://www.stackage.org/lts-13.0/package/parsec-3.1.13.0\" rel=\"nofollow noreferrer\">Stackage</a>, such module indeed does not exist in that package. Did you mean <code>Text.Parsec.Numbers</code> from <code>ParsecTools</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 1474, "user_id": 8025936, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Kue08.png?s=128&g=1", "display_name": "schuelermine", "link": "https://stackoverflow.com/users/8025936/schuelermine"}, "is_accepted": false, "score": 0, "last_activity_date": 1545782182, "creation_date": 1545782182, "answer_id": 53926382, "question_id": 53918918, "link": "https://stackoverflow.com/questions/53918918/could-not-find-module-text-parsec-number/53926382#53926382", "title": "Could not find module \u2018Text.Parsec.Number\u2019", "body": "<p>There is not <code>Text.Parsec.Number</code> in <code>parsec</code>, but there is <code>Text.Parsec.Number</code> that is a copy of <code>Text.ParserCombinators.Parsec.Number</code> from the <code>parsec-number</code> package.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/parsec3-numbers-0.1.0/docs/Text-Parsec-Number.html\" rel=\"nofollow noreferrer\">Link</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10830645, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IX6k80i-BAk/AAAAAAAAAAI/AAAAAAAACCI/ABgM8FtAqCc/photo.jpg?sz=128", "display_name": "Changting", "link": "https://stackoverflow.com/users/10830645/changting"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545782182, "creation_date": 1545704891, "last_edit_date": 1545753546, "question_id": 53918918, "link": "https://stackoverflow.com/questions/53918918/could-not-find-module-text-parsec-number", "title": "Could not find module \u2018Text.Parsec.Number\u2019", "body": "<pre><code>(octopus) \u279c  src git:(master) \u2717 ghc -o solidity-cfg-builder Main.hs\n[7 of 9] Compiling CFG.Parsing      ( CFG/Parsing.hs, CFG/Parsing.o )\n\nCFG/Parsing.hs:6:1: error:\n    Could not find module \u2018Text.Parsec.Number\u2019\n    Perhaps you meant\n      Text.Parsec.Char (from parsec-3.1.13.0)\n      Text.Parsec.Error (from parsec-3.1.13.0)\n      Text.Parsec.Expr (from parsec-3.1.13.0)\n    Use -v to see a list of the files searched for.\n  |\n6 | import Text.Parsec.Number\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>The <code>parsec</code> is 3.1.13, but the module <code>Text.Parsec.Number</code> cannot be found</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1545676872, "post_id": 53916755, "comment_id": 94676334, "body": "Note the difference between <code>empty</code> and <code>Empty</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": true, "score": 3, "last_activity_date": 1545676913, "creation_date": 1545676913, "answer_id": 53916809, "question_id": 53916755, "link": "https://stackoverflow.com/questions/53916755/haskell-how-can-i-test-a-btree-in-ghci/53916809#53916809", "title": "Haskell. How can I test a BTree in GHCi?", "body": "<p>Your definition says that there are two ways to make a <code>BTree a</code>:</p>\n\n<ol>\n<li>As <code>Empty</code></li>\n<li>As <code>Node x y z</code> where <code>x</code> has type <code>a</code>, and <code>y</code> and <code>z</code> have type <code>BTree a</code>.</li>\n</ol>\n\n<p>So some examples of <code>BTree Int</code> would be:</p>\n\n<ol>\n<li><code>Empty</code></li>\n<li><code>Node 0 Empty Empty</code></li>\n<li><code>Node 1 (Node 2 Empty Empty) Empty</code></li>\n</ol>\n"}], "owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 53916809, "answer_count": 1, "score": 0, "last_activity_date": 1545676913, "creation_date": 1545676417, "question_id": 53916755, "link": "https://stackoverflow.com/questions/53916755/haskell-how-can-i-test-a-btree-in-ghci", "title": "Haskell. How can I test a BTree in GHCi?", "body": "<p>I have this Code\nDefinition from a binarytree</p>\n\n<pre><code>data BTree a = Empty | Node a (BTree a) (BTree a)\nderiving (Eq, Show, Read)\n</code></pre>\n\n<p>And definition of function size</p>\n\n<pre><code>size' :: BTree a -&gt; Integer\nsize' Empty = 0\nsize' (Node _ l r) = size' l + size' r + 1\n</code></pre>\n\n<p>How I understand, I have empty tree or a tree with a Node and two children.\nIs it correct?</p>\n\n<pre><code>Node a (BTree a) (BTree a) \n</code></pre>\n\n<p>according to this definition, cann I have only one Node? </p>\n\n<p>I'm testing this so </p>\n\n<pre><code>size' (BTree 2 (Node 3 empty) (Node 6 empty)) \nsize' (BTree 5 (Node 3 empty) (Node 8 empty) empty)\nsize' (BTree 'A' (Node 'B' empty) (Node 'C' empty))\nsize' (Node 5 (BTree 3 empty) (BTree 8 empty) empty)\nsize' (Node 5 (BTree 3 empty) (BTree 8 empty))\n</code></pre>\n\n<p>But all these causes errors</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1545658471, "post_id": 53914134, "comment_id": 94671492, "body": "Once you have the list of pairs, you would just <code>map</code> the function over the list. To get the pair though, I believe Haskell has a <code>partition</code> function that does what you want. Also, Haskell <i>does</i> have looping technically, just not formal looping language constructs. Most things are achieved by either recursion, or some abstraction that uses recursion (like <code>map</code>)."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1545658597, "post_id": 53914134, "comment_id": 94671528, "body": "Hint: use <code>zipWith</code>."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1545658745, "post_id": 53914134, "comment_id": 94671582, "body": "@WillemVanOnsem Out of curiosity, do you get phone alerts or something for the <code>[Haskell]</code> tag? Your response time is typically very quick for Haskell questions."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1545658755, "post_id": 53914134, "comment_id": 94671584, "body": "Can&#39;t you just do this with <code>zip</code>, nevermind <code>zipWith</code>? If your list is <code>lst</code>, then <code>zip (init lst) (tail lst)</code> should do it, no? [Obviously you&#39;ll have to take care if your list might be empty.]"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1545659188, "post_id": 53914134, "comment_id": 94671693, "body": "@Carcigenicate: well you can open the newest questions in a tab. If you pin it, some browsers, like Firefox, give a notification if the title changes, that&#39;s all :)"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1545659308, "post_id": 53914134, "comment_id": 94671741, "body": "@WillemVanOnsem Ahh. I was expecting something complicated using email notifications or something. I want to get something set up for [Clojure]. Thanks. Chrome might allow for the same notifications if I look through the settings."}, {"owner": {"reputation": 21, "user_id": 10519594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342e863ba5bdda22444f7bcce6f5b58c?s=128&d=identicon&r=PG&f=1", "display_name": "luckydemon", "link": "https://stackoverflow.com/users/10519594/luckydemon"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1545659650, "post_id": 53914134, "comment_id": 94671849, "body": "@Carcigenicate thanks! I missed <code>map</code> function. And for parting initial list into list of pairs, I used this <a href=\"https://stackoverflow.com/questions/3067048/haskell-convert-list-to-list-of-tuples\" title=\"haskell convert list to list of tuples\">stackoverflow.com/questions/3067048/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": false, "score": 5, "last_activity_date": 1545660164, "creation_date": 1545660164, "answer_id": 53914410, "question_id": 53914134, "link": "https://stackoverflow.com/questions/53914134/haskell-function-that-goes-through-each-pair-in-list-and-returns-a-list-with-siz/53914410#53914410", "title": "Haskell function that goes through each pair in list and returns a list with size smaller than original by 1", "body": "<p>Here are some ways you could try to solve this. The first step will be to get the pairs and the second will be applying the function to the pairs. One way to do the first step is with a recursive function. Now in Haskell lists are made using <code>[]</code> and <code>:</code>, with <code>[1,2,3]</code> being syntactic sugar for <code>1:(2:(3:[]))</code>. So let us write our function:</p>\n\n<pre><code>window [] = []\nwindow [a] = []\nwindow [a,b] = [(a,b)]\nwindow (a:b:r) = (a,b):window (b:r)\n</code></pre>\n\n<p>Another way we could do this is with the function <code>zip</code>. Recall that this takes two lists, pairs up their elements, and ends the list when either input ends.</p>\n\n<pre><code>window [] = []\nwindow xs = zip xs (tail xs)\n</code></pre>\n\n<p>The second step is to apply our function to the pairs. We can do this with <code>map (uncurry f)</code>. All together:</p>\n\n<pre><code>onWindow f = map (uncurry f) . window\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1545662015, "post_id": 53914427, "comment_id": 94672569, "body": "You can shorten this even more: <code>(zipWith f &lt;*&gt; tail) [0..9]</code>."}], "tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 2, "last_activity_date": 1545660241, "creation_date": 1545660241, "answer_id": 53914427, "question_id": 53914134, "link": "https://stackoverflow.com/questions/53914134/haskell-function-that-goes-through-each-pair-in-list-and-returns-a-list-with-siz/53914427#53914427", "title": "Haskell function that goes through each pair in list and returns a list with size smaller than original by 1", "body": "<p>There's several approaches that could work here.</p>\n\n<p>You could use recursion:</p>\n\n<pre><code>mapCons :: (a -&gt; a -&gt; b) -&gt; [a] -&gt; [b]\n-- input has at least two elements\nmapCons f (a0:a1:as) =\n  -- use them to compute the head of the output\n  f a0 a1 :\n  -- reuse the second element to compute the tail of the output\n  mapCons f (a1:as)\n-- input has less than two elements, so output is the empty list\nmapCons _ _ = []\n</code></pre>\n\n<p>Alternately, <code>zip</code> converts a pair of lists into a list of pairs:</p>\n\n<pre><code>\u03bb zip [1..10] ['a'..'z']\n[(1,'a'),(2,'b'),(3,'c'),(4,'d'),(5,'e'),(6,'f'),(7,'g'),(8,'h'),(9,'i'),(10,'j')]\n</code></pre>\n\n<p>This gives a way to generate all the consecutive pairs in a list by zipping a list with its own tail:</p>\n\n<pre><code>\u03bb zip [1..10] ['a'..'z']\n[(1,'a'),(2,'b'),(3,'c'),(4,'d'),(5,'e'),(6,'f'),(7,'g'),(8,'h'),(9,'i'),(10,'j')]\n</code></pre>\n\n<p>You could then use <code>map</code> to run your function on each pair in the list</p>\n\n<pre><code>\u03bb map (\\(a,b) -&gt; 10*a + b) $ zip [0..9] (tail [0..9])\n[1,12,23,34,45,56,67,78,89]\n</code></pre>\n\n<p>This is a common enough pattern that there's a function that combines <code>map</code> and <code>zip</code>: <code>zipWith</code>:</p>\n\n<pre><code>\u03bb :t zipWith\nzipWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\n\u03bb zipWith (\\a b -&gt; 10*a + b) [0..9] (tail [0..9])\n[1,12,23,34,45,56,67,78,89]\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10519594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/342e863ba5bdda22444f7bcce6f5b58c?s=128&d=identicon&r=PG&f=1", "display_name": "luckydemon", "link": "https://stackoverflow.com/users/10519594/luckydemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1545660241, "creation_date": 1545658348, "question_id": 53914134, "link": "https://stackoverflow.com/questions/53914134/haskell-function-that-goes-through-each-pair-in-list-and-returns-a-list-with-siz", "title": "Haskell function that goes through each pair in list and returns a list with size smaller than original by 1", "body": "<p>Suppose we have list [1,2,3,4].\nI want to take every pair of consecutive elements (i.e. (1,2),(2,3),(3,4)), apply them to some function, and return list which consist of results of this function.\nI don't quite understand, how to do this on haskell, since we don't actually have loops and arrays here. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1545647373, "post_id": 53912161, "comment_id": 94668142, "body": "See: <a href=\"https://downloads.haskell.org/~ghc/7.6.1/docs/html/users_guide/win32-dlls.html\" rel=\"nofollow noreferrer\">creating a Haskell DLL</a>."}, {"owner": {"reputation": 321, "user_id": 6746453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1e1cf14f1e5a48fa1d079b3cb81fe437?s=128&d=identicon&r=PG&f=1", "display_name": "Jacky Wong", "link": "https://stackoverflow.com/users/6746453/jacky-wong"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1545647487, "post_id": 53912161, "comment_id": 94668186, "body": "Is that means Haskell DLL equivalent to jar in Java?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1545647993, "post_id": 53912161, "comment_id": 94668333, "body": "If you can release the source code, you probably should create a Cabal package, so that others can compile &amp; install it by running <code>cabal install</code>. <a href=\"https://www.haskell.org/cabal/users-guide/intro.html\" rel=\"nofollow noreferrer\">haskell.org/cabal/users-guide/intro.html</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1545648370, "post_id": 53912161, "comment_id": 94668441, "body": "I don&#39;t think there&#39;s a JAR equivalent for Haskell. JARs include enough information to allow one to compile against them. A DLL (or .so file) as far as I know only contains information to allow (dynamic) linking and running the library, but does not allow compilation. For compiling one also needs a bunch of <code>.hi</code> files (one per module), I believe."}, {"owner": {"reputation": 321, "user_id": 6746453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1e1cf14f1e5a48fa1d079b3cb81fe437?s=128&d=identicon&r=PG&f=1", "display_name": "Jacky Wong", "link": "https://stackoverflow.com/users/6746453/jacky-wong"}, "edited": false, "score": 0, "creation_date": 1545648877, "post_id": 53912161, "comment_id": 94668607, "body": "Thanks chi, so you mean if I sort out my program&#39;s <code>.cabal</code> file and pack it, send it to another program, it can be installed and be used ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1545656028, "post_id": 53912161, "comment_id": 94670738, "body": "You don&#39;t need to \u201csend it\u201d to another program, you can just either <code>cabal install</code> it locally, or publish it on hackage so Cabal can automatically pull it as a dependency and anybody who may need the module has it available."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1545674141, "post_id": 53912161, "comment_id": 94675659, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19622809/depending-on-a-local-package-in-cabal\">Depending on a local package in cabal</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1545691163, "post_id": 53912161, "comment_id": 94679061, "body": "@jberryman Yes, I think so. If you send a &quot;cabalized&quot; source archive to someone, they can unpack it, and use cabal to compile and install it."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 4, "creation_date": 1545698518, "post_id": 53912161, "comment_id": 94679936, "body": "For the sake of completeness, I think I should add that the usual way to make your library available to other people is to upload it to <a href=\"https://hackage.haskell.org/\" rel=\"nofollow noreferrer\">Hackage</a>; other people can then add your package as a dependency using Cabal. The package manager will then download the package and build it, allowing its modules to be used in your program. (Edit: formatting)"}, {"owner": {"reputation": 321, "user_id": 6746453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1e1cf14f1e5a48fa1d079b3cb81fe437?s=128&d=identicon&r=PG&f=1", "display_name": "Jacky Wong", "link": "https://stackoverflow.com/users/6746453/jacky-wong"}, "edited": false, "score": 1, "creation_date": 1545725853, "post_id": 53912161, "comment_id": 94683293, "body": "Oh thanks, I may know now. I write some tools , pack it, I can upload it to Hackage to make it possible to be downloaded and installed. Also, I can make another program depend on it. Am I right ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1545730674, "post_id": 53912161, "comment_id": 94684255, "body": "Yes, that&#39;s right. Before uploading to Hackage, you can test it locally on your computer. You install the library with cabal, and then write another program exploiting the installed library."}], "answers": [{"tags": [], "owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "is_accepted": true, "score": 0, "last_activity_date": 1545809475, "creation_date": 1545809475, "answer_id": 53928868, "question_id": 53912161, "link": "https://stackoverflow.com/questions/53912161/how-to-release-a-module-in-haskell-that-can-be-used-in-another-program/53928868#53928868", "title": "how to release a module in Haskell that can be used in another program?", "body": "<ul>\n<li><p>If you're fine with sharing your library and its source code with everyone, it is common to upload it to Hackage. Other projects built with any common Haskell build tool know how to interface with Hackage packages</p></li>\n<li><p>If you want to selectively share your library and its source code, you can upload it to a private or public github repository, and it could be used as a stack dependency</p></li>\n<li><p>If you want to share the library locally with yourself, stack supports depending on local paths</p></li>\n<li><p>If you wish to share your library without sharing source code, you can expose a C-api and make a DLL</p></li>\n</ul>\n"}], "owner": {"reputation": 321, "user_id": 6746453, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1e1cf14f1e5a48fa1d079b3cb81fe437?s=128&d=identicon&r=PG&f=1", "display_name": "Jacky Wong", "link": "https://stackoverflow.com/users/6746453/jacky-wong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 53928868, "answer_count": 1, "score": 3, "last_activity_date": 1545809475, "creation_date": 1545647232, "question_id": 53912161, "link": "https://stackoverflow.com/questions/53912161/how-to-release-a-module-in-haskell-that-can-be-used-in-another-program", "title": "how to release a module in Haskell that can be used in another program?", "body": "<p>I'm a beginner of Haskell, and I got a question here, how to release or build a module which can be used in another program ?\nFor example, when I use Java, I can write some classes, some functions and make it to be a jar that can be use in another program. So , how does this go with Haskell? Is there necessary to use the same functions, modules with the source code ?\nAnd thanks.</p>\n"}, {"tags": ["haskell", "unicode"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 5, "creation_date": 1545637805, "post_id": 53910628, "comment_id": 94665362, "body": "Try adding a type signature? <code>(\u2260) :: Eq a =&gt; a -&gt; a -&gt; Bool</code>?"}, {"owner": {"reputation": 329, "user_id": 4994484, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24a65f33e5aa69b46364833d25840063?s=128&d=identicon&r=PG", "display_name": "crisis.sheep", "link": "https://stackoverflow.com/users/4994484/crisis-sheep"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1545638262, "post_id": 53910628, "comment_id": 94665468, "body": "Facepalm. Yes, that&#39;s it! Please make this an answer so I can accept it?"}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 3, "creation_date": 1545638412, "post_id": 53910628, "comment_id": 94665504, "body": "<code>:set -XNoMonomorphismRestriction</code> in GHCi will load without error"}], "answers": [{"comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 6, "creation_date": 1545642245, "post_id": 53910711, "comment_id": 94666557, "body": "&quot;Gets confused&quot; is maybe not the most accurate way to phrase it, as that would imply that GHCi, which doesn&#39;t &quot;get confused&quot;, is somehow more intelligent than GHC. The relevant keyword here is the monomorphism restriction."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1545642403, "post_id": 53910711, "comment_id": 94666604, "body": "@sepp2k that&#39;s true, this answer was badly phrased."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 6, "last_activity_date": 1545638307, "creation_date": 1545638307, "answer_id": 53910711, "question_id": 53910628, "link": "https://stackoverflow.com/questions/53910628/why-does-this-haskell-statement-work-in-ghci-but-fail-to-compile/53910711#53910711", "title": "Why does this Haskell statement work in GHCi but fail to compile?", "body": "<p>You'll need to add a type signature, otherwise Haskell is trying to assign one specific type but gets confused due to the ambiguous type.</p>\n\n<pre><code>(\u2260) :: Eq a =&gt; a -&gt; a -&gt; Bool\n(\u2260) = (/=)\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 4994484, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/24a65f33e5aa69b46364833d25840063?s=128&d=identicon&r=PG", "display_name": "crisis.sheep", "link": "https://stackoverflow.com/users/4994484/crisis-sheep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "closed_date": 1545671267, "accepted_answer_id": 53910711, "answer_count": 1, "score": 2, "last_activity_date": 1545638307, "creation_date": 1545637642, "question_id": 53910628, "link": "https://stackoverflow.com/questions/53910628/why-does-this-haskell-statement-work-in-ghci-but-fail-to-compile", "closed_reason": "Duplicate", "title": "Why does this Haskell statement work in GHCi but fail to compile?", "body": "<p>In GHCi the following works just dandy:</p>\n\n<pre><code>let (\u2260) = (/=)\n</code></pre>\n\n<p>But trying to compile this from a source file results in an error:</p>\n\n<pre><code>(\u2260) = (/=)\n</code></pre>\n\n<p>Here is the error, for reference:</p>\n\n<p>\"Ambiguous type variable 'a0' arising from a use of '/=' prevents the constraint '(Eq a0)' from being solved.\"</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1545601719, "post_id": 53906446, "comment_id": 94659269, "body": "Could you clarify your question? I barely understand your problem. I don&#39;t get what are you going to print \u2013 <code>(fmap weather)</code> is definitely not the thing"}, {"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1545609356, "post_id": 53906446, "comment_id": 94660698, "body": "I also don&#39;t understand the question, but the last line should probably be <code>Right stuff -&gt; putStrLn $ weather stuff</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": false, "score": 1, "last_activity_date": 1545621853, "creation_date": 1545621853, "answer_id": 53908881, "question_id": 53906446, "link": "https://stackoverflow.com/questions/53906446/how-to-get-key-value-from-data/53908881#53908881", "title": "How to get key value from data", "body": "<blockquote>\n  <p>Want to show id and description but map not the right way, is int?</p>\n</blockquote>\n\n<p><strong>Yes</strong>, it is not the right way.</p>\n\n<p>Actually, you can get the list of <code>DataPoint</code> from <code>Temperatures</code> using <code>weather</code> as:</p>\n\n<pre><code>weather stuff\n</code></pre>\n\n<p>and print the <code>id</code> and <code>description</code> from list of <code>DataPoint</code> using <code>mapM_</code> as:</p>\n\n<pre><code>import Control.Monad (mapM_)\nimport Prelude hiding (id)\n\n...\nRight stuff -&gt; mapM_ (\\d-&gt;putStrLn (show (id d) ++ \" \" ++ (description d))) \n                     (weather stuff)\n...\n</code></pre>\n\n<p>Notes that, it need to hide <code>id</code> function from <code>Prelude</code>. Otherwise <code>Ambiguous occurrence</code> error will occur.</p>\n"}], "owner": {"reputation": 69, "user_id": 6812730, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/676fdb3d252c9fe9ee2d17342888db8a?s=128&d=identicon&r=PG&f=1", "display_name": "Ilya Chikmarev", "link": "https://stackoverflow.com/users/6812730/ilya-chikmarev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545621853, "creation_date": 1545592237, "question_id": 53906446, "link": "https://stackoverflow.com/questions/53906446/how-to-get-key-value-from-data", "title": "How to get key value from data", "body": "<p>I am new to Haskell, and want to parse JSON for user. </p>\n\n<p>Have this kind of \u0441ode:</p>\n\n<pre><code>import Data.Aeson as Q\nimport Data.Text\nimport Control.Applicative\nimport Control.Monad\nimport qualified Data.ByteString.Lazy as B\nimport Network.HTTP.Conduit (simpleHttp)\nimport GHC.Generics\n\ndata DataPoint = DataPoint { id :: Int\n                           , description :: String\n                           , icon :: String\n                           } deriving (Show, Generic)\n\ndata Temperatures = Temperatures { weather :: [DataPoint]\n                                 } deriving (Show, Generic)\n\ninstance FromJSON Temperatures\ninstance ToJSON Temperatures\ninstance FromJSON DataPoint\ninstance ToJSON DataPoint`\n\njsonURL :: String -&gt; String\njsonURL q = \"url here hidden\"\n\ngetJSON :: String -&gt; IO B.ByteString\ngetJSON town = simpleHttp (jsonURL town)\n\nmain :: IO ()\nmain = do\n putStrLn \"Hello! Please insert your town &gt;&gt;&gt; \\n \"\n town &lt;- getLine\n putStrLn (\"Your town is: \" ++ town ++ \"\\n\")\n d &lt;- (eitherDecode &lt;$&gt; (getJSON town)) :: IO (Either String Temperatures)\n case d of\n  Left e -&gt; putStrLn \"Error occured. Try again please\"\n  Right stuff -&gt; putStrLn (fmap weather) $ stuff\n</code></pre>\n\n<p>Want to show id and description but map not the right way, is int?\nAnd is okey to store data like this or I should </p>\n"}, {"tags": ["haskell", "io", "gadt"], "comments": [{"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1545995163, "post_id": 53904818, "comment_id": 94752675, "body": "In before: I have just spotted that <code>insert</code> does not always change AVL tree&#39;s depth, but it does not break the question&#39;s meritum"}], "answers": [{"comments": [{"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1545581672, "post_id": 53904863, "comment_id": 94654841, "body": "That&#39;s what I was looking for. You forgot to add <code>a</code> as argument to <code>insert&#39;</code> btw"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1545584949, "post_id": 53904863, "comment_id": 94655652, "body": "Uh oh. Good catch!"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1552661956, "post_id": 53904863, "comment_id": 97108709, "body": "Alternate syntax: <code>data SomeAVL a = forall n. SomeAVL (AVL n a)</code>"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 8, "last_activity_date": 1545584920, "last_edit_date": 1545584920, "creation_date": 1545579066, "answer_id": 53904863, "question_id": 53904818, "link": "https://stackoverflow.com/questions/53904818/weaken-gadts-type-constraints-to-deal-with-unpredictable-data/53904863#53904863", "title": "Weaken GADTs type constraints to deal with unpredictable data", "body": "<p>You can use another GADT to hide the depth of the tree. (This is called an existential type.)</p>\n\n<pre><code>data SomeAVL a where\n  SomeAVL :: AVL n a -&gt; SomeAVL a\n</code></pre>\n\n<p>With wrappers to operate on <code>SomeAVL</code>s:</p>\n\n<pre><code>insert' :: a -&gt; SomeAVL a -&gt; SomeAVL a\ninsert' a (SomeAVL t) = SomeAVL (insert a t)\n</code></pre>\n"}], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 2, "accepted_answer_id": 53904863, "answer_count": 1, "score": 8, "last_activity_date": 1610653946, "creation_date": 1545578603, "last_edit_date": 1610653946, "question_id": 53904818, "link": "https://stackoverflow.com/questions/53904818/weaken-gadts-type-constraints-to-deal-with-unpredictable-data", "title": "Weaken GADTs type constraints to deal with unpredictable data", "body": "<p>I am trying to make use of GADTs to have well constrained types, but some dependencies are impossible to handle during compilation time \u2013 for example user input. Let's consider following AVL tree definition:</p>\n<pre><code>data Zero\ndata S a\n\ndata AVL depth where\n  Nil :: AVL Zero\n  LNode :: AVL n -&gt; Int -&gt; AVL (S n) -&gt; AVL (S (S n))\n  RNode :: AVL (S n) -&gt; Int -&gt; AVL n -&gt; AVL (S (S n))\n  MNode :: AVL n -&gt; Int -&gt; AVL n -&gt; AVL (S n)\n</code></pre>\n<p>Magic of GADTs ensures that every AVL tree is well balanced. I can define some basic functions like</p>\n<pre><code>singleton :: a -&gt; AVL (S Zero) x\nsingleton a = MNode Nil a Nil\n\ninsert :: a -&gt; AVL n a -&gt; AVL (S n) a\ninsert = ...\n</code></pre>\n<p>Now I would like to write program that will read <code>n</code> numbers, insert them into AVL tree and return in order (assuming that these functions are defined):</p>\n<pre><code>main = IO ()\nmain = do\n  (n :: Int) &lt;- readInt  -- some IO defined somewhere\n  (inp :: [Int]) &lt;- readInts\n  let avl = foldl (\\tree x -&gt; insert x tree) Nil inp\n  print $ toList avl\n</code></pre>\n<p>And obviously I get error:</p>\n<pre><code>    \u2022 Couldn't match type \u2018S Zero\u2019 with \u2018Zero\u2019\n      Expected type: AVL Zero\n        Actual type: AVL (S Zero)\n</code></pre>\n<p>because type (depth) of the tree is going to change along with every <code>insert</code>. I understand what is happening here, but I don't see any reasonable way to use this AVL while handling input &quot;online&quot; \u2013 that is without any knowledge of how many elements I am going to insert.</p>\n<p>Is there any solution that would allow me to abstract out tree's depth for this case? Even if AVL is too complicated example, this problem applies also to compile-time-sized vectors and matrices. For now I can solve only hardcoded tasks, which makes my programs completely inflexible.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1545576266, "post_id": 53904514, "comment_id": 94653629, "body": "When looking at regular operators, <code>(1+)</code> and <code>(+) 1</code> mean the same thing, right?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1545576500, "post_id": 53904514, "comment_id": 94653680, "body": "Your explanation is correct. We don&#39;t write it as <code>(r -&gt;)</code> because there is no <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-300003.5\" rel=\"nofollow noreferrer\">section syntax</a> for type operators (i.e. for no deep reason)."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1545576732, "post_id": 53904514, "comment_id": 94653737, "body": "@Ry- Yup, they do (as opposed to <code>(+1)</code>, which amounts to <code>\\x -&gt; x + 1</code>)."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1545577528, "post_id": 53904514, "comment_id": 94653890, "body": "The other comments and answers give you the detail and how this syntax fits in with Haskell generally, but in terms of &quot;what does this mean&quot;, <code>(-&gt;) r</code> is a type constructor for all functions whose argument is a value of type <code>r</code>. So given a type <code>a</code>, this type constructor gives you the type of all functions <code>r -&gt; a</code>, where <code>r</code> is a fixed type. (It&#39;s not just an applicative, it&#39;s also a monad, known as the &quot;reader monad&quot; because it allows you to &quot;read&quot; data of the type <code>r</code>.)"}, {"owner": {"reputation": 13928, "user_id": 1058292, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/M7vPd.jpg?s=128&g=1", "display_name": "atreeon", "link": "https://stackoverflow.com/users/1058292/atreeon"}, "edited": false, "score": 0, "creation_date": 1545578133, "post_id": 53904514, "comment_id": 94654044, "body": "Ok! So, -&gt; surrounded by brackets like (-&gt;) takes the type level operator out of infix notation and into prefix notation.  The r is just the first parameter of a function this then satisfies the definition of a functor of type function and allows us to do functor like operations on it."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1545578389, "post_id": 53904552, "comment_id": 94654104, "body": "On &quot;a good way to read it&quot;, in this specific case some variation of &quot;functions from <code>r</code>&quot;  might do the trick sometimes."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1545623789, "post_id": 53904552, "comment_id": 94662573, "body": "That&#39;s pretty imprecise; I&#39;d use the same phrase to (more accurately) refer to the polymorphic type <code>r -&gt; a</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1545661387, "post_id": 53904552, "comment_id": 94672373, "body": "I was mostly thinking of turns of phrase like &quot;the functions-from-<code>r</code> type constructor&quot;, or, say, &quot;the functions-from-<code>r</code> <code>Functor</code>&quot; (if that is the aspect one is interested in, and if the specific choice of <code>r</code> matters)."}, {"owner": {"reputation": 13928, "user_id": 1058292, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/M7vPd.jpg?s=128&g=1", "display_name": "atreeon", "link": "https://stackoverflow.com/users/1058292/atreeon"}, "edited": false, "score": 0, "creation_date": 1545670372, "post_id": 53904552, "comment_id": 94674765, "body": "Could I say ((-&gt;) r) is all functions with at least one parameter?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 13928, "user_id": 1058292, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/M7vPd.jpg?s=128&g=1", "display_name": "atreeon", "link": "https://stackoverflow.com/users/1058292/atreeon"}, "edited": false, "score": 0, "creation_date": 1545686833, "post_id": 53904552, "comment_id": 94678412, "body": "@orangesherbert That&#39;s not a very good way to look at it.  At a very technical level, all functions in Haskell have exactly one parameter.  And that definition works at precisely that technical of a level."}, {"owner": {"reputation": 13928, "user_id": 1058292, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/M7vPd.jpg?s=128&g=1", "display_name": "atreeon", "link": "https://stackoverflow.com/users/1058292/atreeon"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1545688713, "post_id": 53904552, "comment_id": 94678727, "body": "thanks @Carl, so could I say ((-&gt;) r) matches all functions in Haskell?  (I thought no parameter functions in Haskell were allowed but they are not)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1545763329, "post_id": 53904552, "comment_id": 94691101, "body": "<code>(-&gt;) r</code> is a function, but not the kind you are thinking of. It doesn&#39;t have a type at all, but a <i>kind</i>, specifically <code>* -&gt; *</code>. Its argument is something of kind <code>*</code> (aka, a concrete type), and it returns another concrete type. For a fixed <code>r</code>, you can think of it as the <i>constructor</i> of all function types that have <code>r</code> as their argument type. For example, <code>(-&gt;) Int</code> is the constructor for the types <code>Int -&gt; Int</code>, <code>Int -&gt; Char</code>, <code>Int -&gt; IO Float</code>, <code>Int -&gt; (Int -&gt; Int)</code>, etc."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 8, "last_activity_date": 1545576434, "creation_date": 1545576434, "answer_id": 53904552, "question_id": 53904514, "link": "https://stackoverflow.com/questions/53904514/what-does-the-r-mean-in-instance-applicative-r-where/53904552#53904552", "title": "What does the ((-&gt;) r) mean in instance Applicative ((-&gt;) r) where?", "body": "<p>Here, <code>-&gt;</code> is a type-level operator; it takes two types and returns a new type (the function type). In <code>((-&gt;) r</code>, it's partially applied, so you can think of it as a type-level function that takes one type <code>a</code> and returns the type of functions that take an <code>r</code> and returns an <code>a</code>.</p>\n\n<pre><code>((-&gt;) r) a == (-&gt;) r a  -- function application is left-associative\n           == r -&gt; a    -- switch to infix notation\n</code></pre>\n\n<p>You <em>could</em> say <code>(r -&gt;)</code>, except Haskell doesn't support type-level sections. (And I don't <em>think</em> there is a GHC extension to enable such support.)</p>\n\n<p>There isn't really a good way to read it, because it exists at a level of abstraction that isn't talked about commonly enough to merit a natural language description.</p>\n"}, {"tags": [], "owner": {"reputation": 169, "user_id": 1325960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gB5mi.jpg?s=128&g=1", "display_name": "Philip Schwarz", "link": "https://stackoverflow.com/users/1325960/philip-schwarz"}, "is_accepted": false, "score": 0, "last_activity_date": 1609845549, "creation_date": 1609845549, "answer_id": 65577857, "question_id": 53904514, "link": "https://stackoverflow.com/questions/53904514/what-does-the-r-mean-in-instance-applicative-r-where/65577857#65577857", "title": "What does the ((-&gt;) r) mean in instance Applicative ((-&gt;) r) where?", "body": "<p>Here is a slide deck dedicated to this subject: <a href=\"https://www2.slideshare.net/pjschwarz/function-applicative-for-great-good-of-palindrome-checker-function-polyglot-fp-for-fun-and-profit-haskell-and-scala\" rel=\"nofollow noreferrer\">https://www2.slideshare.net/pjschwarz/function-applicative-for-great-good-of-palindrome-checker-function-polyglot-fp-for-fun-and-profit-haskell-and-scala</a></p>\n<p>And here are a couple of slides from it:</p>\n<p><a href=\"https://i.stack.imgur.com/peYW0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/peYW0.png\" alt=\"enter image description here\" /></a>\n<a href=\"https://i.stack.imgur.com/lb8Sg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lb8Sg.png\" alt=\"enter image description here\" /></a></p>\n"}], "owner": {"reputation": 13928, "user_id": 1058292, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/M7vPd.jpg?s=128&g=1", "display_name": "atreeon", "link": "https://stackoverflow.com/users/1058292/atreeon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 1, "accepted_answer_id": 53904552, "answer_count": 2, "score": 3, "last_activity_date": 1609845549, "creation_date": 1545576061, "last_edit_date": 1545576221, "question_id": 53904514, "link": "https://stackoverflow.com/questions/53904514/what-does-the-r-mean-in-instance-applicative-r-where", "title": "What does the ((-&gt;) r) mean in instance Applicative ((-&gt;) r) where?", "body": "<pre><code>instance Applicative ((-&gt;) r) where\n</code></pre>\n\n<p>This is the implementation of the Applicative typeclass for a function in Haskell.  I don't really understand the <code>((-&gt;) r)</code> and how to read it.</p>\n\n<p><em>I think it means it is a function that takes one parameter and returns anything (another curried function, a String) but I'm not sure, is that right.  Would that not be (r ->)</em></p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 2, "creation_date": 1545573985, "post_id": 53904227, "comment_id": 94653110, "body": "You can also do the pattern match on the LHS - <code>countAces (NormalCard Ace _ : cs) = 1 + countAces cs; countAces (Joker:cs) = 1 + countAces cs; countAces (_:cs) = countAces cs</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1545574773, "post_id": 53904227, "comment_id": 94653295, "body": "@rampion Yup; I wanted to stay close to the original code to highlight the difference, but that&#39;s definitely more idiomatic."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 7, "last_activity_date": 1545573750, "creation_date": 1545573750, "answer_id": 53904227, "question_id": 53904181, "link": "https://stackoverflow.com/questions/53904181/why-cant-i-write-the-function-like-this/53904227#53904227", "title": "Why can&#39;t I write the function like this?", "body": "<p>In your guard <code>c == (NormalCard Ace _)</code>, you aren't performing a pattern match; you are trying to compare <code>c</code> to a new value of <code>Card</code> whose suit you haven't specified. The <code>_</code> is a \"hole\", which is a non-value that triggers an error but determines what <em>type</em> the <code>_</code> should have, which is useful for debugging and development.</p>\n\n<p>To do the pattern match, use an explicit <code>case</code> expression:</p>\n\n<pre><code>countAces (c:cs) = case c of\n                     (NormalCard Ace _) -&gt; 1 + countAces cs\n                     Joker -&gt; 1 + countAces cs\n                     otherwise -&gt; countAces cs\n</code></pre>\n\n<p>Because <code>case</code> is an expression, not a statement, you can refactor this to reduce some repetition:</p>\n\n<pre><code>countAces (c:cs) = countAces cs + case c of\n                      (NormalCar Ace _) -&gt; 1\n                      Joker -&gt; 0\n                      otherwise -&gt; 0\n</code></pre>\n\n<p>which basically inlines the <code>countCard</code> function you defined in your second attempt.</p>\n"}, {"tags": [], "owner": {"reputation": 11377, "user_id": 553279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de617e09030cad8f06663113eeea27cc?s=128&d=identicon&r=PG", "display_name": "fdreger", "link": "https://stackoverflow.com/users/553279/fdreger"}, "is_accepted": true, "score": 5, "last_activity_date": 1545575216, "creation_date": 1545575216, "answer_id": 53904396, "question_id": 53904181, "link": "https://stackoverflow.com/questions/53904181/why-cant-i-write-the-function-like-this/53904396#53904396", "title": "Why can&#39;t I write the function like this?", "body": "<p>This question is more about your mental model of what things mean, not about Haskell itself (if you ask about Haskell itself, then the answer is: \"because that's how the language is works\").</p>\n\n<p>So I will try to just appeal to your imagination:</p>\n\n<p>In the first case you have an expression, which will evaluate to <code>True</code> or <code>False</code> - both are valid outcomes. You are performing a comparison, using an existing function: <code>(==)</code>. This function takes two values - and you need to provide them fully, without holes - for exactly the same reason, why you can't write <code>(2 + _) * 10</code> and expect it to evaluate to a number. </p>\n\n<p>In the second case, you use a language construct <code>=</code>. This construct is not a function that returns a value. It is used to build a <em>definition</em>. When you write <code>a = 2</code>, you are not writing an expression which can be true or false. You are defining <code>a</code> in terms of <code>2</code>. It will either work and be <em>forever true</em> - or will not compile. In this context - you can use holes. When you write <code>a _ = 2</code>, you really say: No matter what you apply to <code>a</code> you will get <code>2</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1545613570, "post_id": 53906900, "comment_id": 94661270, "body": "This is not correct. <code>deriving Eq</code> is enough to completely define <code>(==)</code> for these types. The issue is the attempt at pattern matching in the call to <code>(==)</code> (see the other answers). That sort of \u201cpattern matching\u201d in a function call is never valid Haskell."}], "tags": [], "owner": {"reputation": 29, "user_id": 5512565, "user_type": "registered", "profile_image": "https://graph.facebook.com/10205004269454939/picture?type=large", "display_name": "Jos&#233; Carlos Ramalho", "link": "https://stackoverflow.com/users/5512565/jos%c3%a9-carlos-ramalho"}, "is_accepted": false, "score": -1, "last_activity_date": 1545596469, "creation_date": 1545596469, "answer_id": 53906900, "question_id": 53904181, "link": "https://stackoverflow.com/questions/53904181/why-cant-i-write-the-function-like-this/53906900#53906900", "title": "Why can&#39;t I write the function like this?", "body": "<p>Without going through the manuals, my guess is that with \"==\" you are comparing values and here what you is different structures. In the second solution you are using pattern matching against the structure.</p>\n\n<p>When you define an abstract data type in Haskell with alternative structures \"deriving Eq\" is not enough in order to compare those different structures, you will have to provide a definition for the equality. You use \"==\" in the way you put it in the first case as long as define \"==\" over two Card elements.</p>\n"}], "owner": {"reputation": 83, "user_id": 10826091, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iMxFe.jpg?s=128&g=1", "display_name": "Fraus", "link": "https://stackoverflow.com/users/10826091/fraus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 53904396, "answer_count": 3, "score": 1, "last_activity_date": 1545596469, "creation_date": 1545573335, "last_edit_date": 1545573869, "question_id": 53904181, "link": "https://stackoverflow.com/questions/53904181/why-cant-i-write-the-function-like-this", "title": "Why can&#39;t I write the function like this?", "body": "<p>I am studying for an \"Introduction to Functional Programming\" exam.\nThis is one of the problems I am stuck on:</p>\n\n<p>\"The following datatypes are used to represent a hand of cards:</p>\n\n<pre><code>data Suit = Hearts | Clubs | Diamonds | Spades                           \n  deriving Eq\n\ndata Rank = Numeric Int | Jack | Queen | King | Ace                      \n   deriving Eq\n\ndata Card = NormalCard Rank Suit | Joker   \n  deriving Eq\n</code></pre>\n\n<p>Define a function</p>\n\n<pre><code>countAces:: [Card] -&gt; Int\ncountAces = undefined\n</code></pre>\n\n<p>where countAces returns the number of cards in the given hand which are either aces or jokers. So for example, if there are three aces and two jokers in the hand, the answer will be five.\"</p>\n\n<p>So I thought I would write it like this:</p>\n\n<pre><code>countAces:: [Card] -&gt; Int\ncountAces []                               = 0\ncountAces (c:cs) | c == (NormalCard Ace _) = 1 + countAces (cs)\n                 | c == Joker              = 1 + countAces (cs)\n                 | otherwise               = countAces (cs)\n</code></pre>\n\n<p>But this won't compile, and I have understood that I can't write c == (NormalCard Ace _). But if I change the function to:</p>\n\n<pre><code>countAces:: [Card] -&gt; Int\ncountAces []                         = 0\ncountAces (c : cs) = countCard c + countAces cs\n  where countCard Joker              = 1\n        countCard (NormalCard Ace _) = 1\n        countCard _                  = 0\n</code></pre>\n\n<p>Then it works!\nSo my question is, why doesn't the first version work?</p>\n\n<p>This is the error: </p>\n\n<pre><code>    * Found hole: _ :: Suit\n    * In the second argument of `NormalCard', namely `_'\n      In the second argument of `(==)', namely `(NormalCard Ace _)'\n      In the expression: c == (NormalCard Ace _)\n    * Relevant bindings include\n        cs :: [Card] (bound at exam.hs:96:14)\n        c :: Card (bound at exam.hs:96:12)\n        countAces :: [Card] -&gt; Int (bound at exam.hs:95:1)\n      Valid substitutions include\n        Hearts :: Suit (defined at exam.hs:87:13)\n        Clubs :: Suit (defined at exam.hs:87:22)\n        Diamonds :: Suit (defined at exam.hs:87:30)\n        Spades :: Suit (defined at exam.hs:87:41)\n        undefined :: forall (a :: TYPE r).\n                     GHC.Stack.Types.HasCallStack =&gt;\n                     a\n          (imported from `Prelude' at exam.hs:1:1\n           (and originally defined in `GHC.Err'))\n</code></pre>\n\n<p>Thanks a ton to anyone who took the time to read this.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 6, "last_activity_date": 1545563965, "creation_date": 1545563965, "answer_id": 53903164, "question_id": 53903109, "link": "https://stackoverflow.com/questions/53903109/performance-difference-of-vs/53903164#53903164", "title": "Performance difference of $ vs. &#39;()&#39;", "body": "<p>They're exactly the same. There's just some variance in runtime - your passing test case is within 5% of failing on time as well.</p>\n"}], "owner": {"reputation": 1, "user_id": 6658604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e5776b34097b177d7cc327137f60337?s=128&d=identicon&r=PG&f=1", "display_name": "Ishmum Khan", "link": "https://stackoverflow.com/users/6658604/ishmum-khan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 1, "closed_date": 1545575623, "answer_count": 1, "score": -2, "last_activity_date": 1545563965, "creation_date": 1545563494, "question_id": 53903109, "link": "https://stackoverflow.com/questions/53903109/performance-difference-of-vs", "closed_reason": "Not suitable for this site", "title": "Performance difference of $ vs. &#39;()&#39;", "body": "<p>I have 2 code submissions on codeforces - </p>\n\n<p><a href=\"https://codeforces.com/contest/762/submission/29695191\" rel=\"nofollow noreferrer\">https://codeforces.com/contest/762/submission/29695191</a>\n&amp; <a href=\"https://codeforces.com/contest/762/submission/29695201\" rel=\"nofollow noreferrer\">https://codeforces.com/contest/762/submission/29695201</a></p>\n\n<p>both have the exact same code except for the usage of $ vs. () . One with the $ exceeded the time limit on the 6th test and the other passed all the tests.</p>\n\n<p>Any suggestions on why that might be the case?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 10823919, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IxmCArcp864/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbSRexjEbXRN-yya7mosiV0A15r0A/mo/photo.jpg?sz=128", "display_name": "KamilJu", "link": "https://stackoverflow.com/users/10823919/kamilju"}, "edited": false, "score": 0, "creation_date": 1545577678, "post_id": 53901021, "comment_id": 94653928, "body": "Thanks a lot! I have another question now. After making an instance of Player how can I print the current location and direction of the player with putStrLn?"}, {"owner": {"reputation": 105, "user_id": 10823919, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IxmCArcp864/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbSRexjEbXRN-yya7mosiV0A15r0A/mo/photo.jpg?sz=128", "display_name": "KamilJu", "link": "https://stackoverflow.com/users/10823919/kamilju"}, "edited": false, "score": 0, "creation_date": 1545581484, "post_id": 53901021, "comment_id": 94654793, "body": "I still have problems with Advance and BackOff. I changed type Gamemap to Map Location (Map Direction Location) but now it says that i cannot match wonderland type (Location,Direction,Location) with Map Location... Im rly confused because i dont know how Maps work"}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 105, "user_id": 10823919, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IxmCArcp864/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbSRexjEbXRN-yya7mosiV0A15r0A/mo/photo.jpg?sz=128", "display_name": "KamilJu", "link": "https://stackoverflow.com/users/10823919/kamilju"}, "edited": false, "score": 0, "creation_date": 1545583234, "post_id": 53901021, "comment_id": 94655211, "body": "@KamilJu: If you want to stick something more like your old code, you can use a list of triples; if you want to use <code>Map</code>s, you&#39;ll have to change your code to work with them (<a href=\"http://hackage.haskell.org/package/containers-0.6.0.1/docs/Data-Map.html\" rel=\"nofollow noreferrer\">the documentation</a> may be helpful).  Either way, if you&#39;re getting stuck, there&#39;s not really enough space in the comments to explain \u2013 figure out what the problem is and <a href=\"https://stackoverflow.com/questions/ask\">ask a new question!</a> :-)"}], "tags": [], "owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "is_accepted": false, "score": 4, "last_activity_date": 1545536078, "creation_date": 1545536078, "answer_id": 53901021, "question_id": 53900129, "link": "https://stackoverflow.com/questions/53900129/text-adventure-game-problems-with-moving-around-with-directions/53901021#53901021", "title": "Text adventure game problems with moving around with Directions", "body": "<p>The first thing I see in your design is that you have global constants <code>location</code> and <code>currentDirection</code>.  This isn't compatible with the way that Haskell works: because Haskell is purely functional, you'll never be able to change <code>location</code> or <code>currentDirection</code>.  Instead, you'll need something like</p>\n\n<pre><code>data Player = Player { location :: Location\n                     , direction :: Direction }\n            deriving (Eq, Ord, Show, Read)\n</code></pre>\n\n<p>And then you'll want <code>move</code> to have the type</p>\n\n<pre><code>move :: Player -&gt; Movement -&gt; Player\n</code></pre>\n\n<p>The second thing to note is that you gave <code>move</code> the type <code>Movement -&gt; Direction -&gt; Location</code>, but you didn't actually give it a <code>Movement</code> and a <code>Direction</code> argument \u2013 you only gave it one argument, the <code>Movement</code>.  We'll instead want something like</p>\n\n<pre><code>move :: Player -&gt; Movement -&gt; Player\nmove p m = case m of {- ... -}\n</code></pre>\n\n<p>Note the extra <code>p</code> argument that wasn't in your code.</p>\n\n<p>Now, I like the notion of using <code>pred</code> and <code>succ</code> for turning!  Unfortunately, the problem is that <code>pred</code> and <code>succ</code> will explode with an error if they overflow, rather than wrapping around, so we'll need to write our own.</p>\n\n<pre><code>turnRight :: Direction -&gt; Direction\nturnRight North = East\nturnRight East  = South\nturnRight South = West\nturnRight West  = North\n\nturnLeft :: Direction -&gt; Direction\nturnLeft North = West\nturnLeft East  = North\nturnLeft South = East\nturnLeft West  = South\n</code></pre>\n\n<p>Here, I used \"equational style\", instead of <code>turnLeft d = case d of ...</code>.  It's more common, but the two are equivalent.</p>\n\n<p>So, in <code>move</code>, we'd have</p>\n\n<pre><code>move :: Player -&gt; Movement -&gt; Player\nmove p m = case m of\n  TurnLeft  -&gt; p{direction = turnLeft  $ direction p}\n  TurnRight -&gt; p{direction = turnRight $ direction p}\n  Advance   -&gt; undefined\n  BackOff   -&gt; undefined\n</code></pre>\n\n<p>(Here, I switched back to \"expression style\", with <code>case</code>.  Again, same thing!)</p>\n\n<p>Now, to advance and back off, I assume you're using a value <code>wonderland</code> of type <code>GameMap</code> and <code>filterAccess</code>.  <code>GameMap</code> is a bit of a suspicious type: if you want it as-is, it'd be better to use a plain triple <code>(Location, Direction, Location)</code> rather than nesting pairs.  Now, <code>filterAccess</code> is a bit dodgy as it stands because it only checks the starting location and ignores the direction.  But a better design would probably be to use a real <code>Map</code>, which would let you look up by key directly.  Make sure you add <code>Ord</code> to your derived classes for <code>Direction</code>, and then you can have</p>\n\n<pre><code>import Data.Map (Map)\nimport qualified Data.Map as M\n\ntype GameMap = Map Location (Map Direction Location)\n  -- Or `Map (Location, Direction) Location`\n\nnextLocation :: Player -&gt; GameMap -&gt; Maybe Direction\nnextLocation Player{location = loc, direction = dir} gmap =\n  case M.lookup loc gmap of\n    Nothing -&gt; Nothing\n    Just m' -&gt; M.lookup dir m'\n-- Or:\n--     nextLocation Player{location = loc, direction = dir} gmap =\n--       M.lookup dir =&lt;&lt; M.lookup loc gmap\n</code></pre>\n\n<p>And that should fill in the advancing case.  The backing off case will be similar, you just need to fill in the \"backwards direction\" logic :-)</p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 2, "last_activity_date": 1545576802, "last_edit_date": 1545576802, "creation_date": 1545548068, "answer_id": 53901814, "question_id": 53900129, "link": "https://stackoverflow.com/questions/53900129/text-adventure-game-problems-with-moving-around-with-directions/53901814#53901814", "title": "Text adventure game problems with moving around with Directions", "body": "<p>I get the impression you want to solve this yourself, but here\u2019s a simplified toy program that might give you some ideas:</p>\n\n<pre><code>import Data.Maybe (fromJust, isNothing)\n\ndata Direction = North | South | East | West\n  deriving Show\n\ndata WorldState = WorldState { longitude :: Integer,\n                               latitude :: Integer,\n                               facing :: Direction\n                             }\n  deriving Show\n\ninitialState :: WorldState\ninitialState = WorldState 0 0 West\n\nprocessCommands :: WorldState -&gt;\n                   (WorldState -&gt; String -&gt; Maybe WorldState) -&gt;\n                   [String] -&gt;\n                   [WorldState]\n{- Given an interpreter that executes commands one at a time, and a list of commands\n - to execute, return a list of the WorldState after the execution of each command.\n -}\nprocessCommands _ _ [] = []\nprocessCommands initial interpreter (x:xs)\n  | isNothing outcome' = []\n  | otherwise          = outcome:(processCommands outcome interpreter xs)\n    where outcome' = interpreter initial x\n          outcome = fromJust outcome'\n\nrunCommand :: WorldState -&gt; String -&gt; Maybe WorldState\n{- Given a WorldState and a command, returns the updated WorldState, or\n - Nothing if the program is to quit.\n -}\nrunCommand _ \"quit\" = Nothing\nrunCommand (WorldState a b North) \"left\" = Just (WorldState a b West)\nrunCommand (WorldState a b West)  \"left\" = Just (WorldState a b South)\nrunCommand (WorldState a b South) \"left\" = Just (WorldState a b East)\nrunCommand (WorldState a b East)  \"left\" = Just (WorldState a b North)\nrunCommand (WorldState a b North) \"right\" = Just (WorldState a b East)\nrunCommand (WorldState a b East)  \"right\" = Just (WorldState a b South)\nrunCommand (WorldState a b South) \"right\" = Just (WorldState a b West)\nrunCommand (WorldState a b West)  \"right\" = Just (WorldState a b North)\nrunCommand (WorldState a b North) \"forward\" = Just (WorldState a (b+1) North)\nrunCommand (WorldState a b West)  \"forward\" = Just (WorldState (a-1) b West)\nrunCommand (WorldState a b South) \"forward\" = Just (WorldState a (b-1) South)\nrunCommand (WorldState a b East)  \"forward\" = Just (WorldState (a+1) b East)\nrunCommand (WorldState a b North) \"back\" = Just (WorldState a (b-1) North)\nrunCommand (WorldState a b West)  \"back\" = Just (WorldState (a+1) b West)\nrunCommand (WorldState a b South) \"back\" = Just (WorldState a (b+1) South)\nrunCommand (WorldState a b East)  \"back\" = Just (WorldState (a-1) b East)\nrunCommand s _ = Just s\n\nmain :: IO ()\nmain = interact\n     ( unlines\n     . map show\n     . processCommands initialState runCommand\n     . lines )\n</code></pre>\n\n<p>The <code>main</code> routine calls <code>interact</code>, a function that maps input to output.  Since the input and output are both read lazily, each line of input is evaluated as soon as it is entered.</p>\n\n<p>The only non-functional part of the program is the call to <code>interact</code>, and in particular, you don\u2019t need to work with monads directly.  (Although they\u2019re nothing to be afraid of.)  Just write your pure function that transforms the input string into the output string.</p>\n\n<p>So we do, in point-free style.  It splits the input into lines, and calls <code>processCommands</code> on the list of commands, one per line.</p>\n\n<p>The <code>processCommands</code> function then repeatedly calls <code>runCommand</code> on each command, passing it the current state, until it says not to continue or there are no more commands.  It builds a list of each successive game state.  It is tail-recursive modulo cons, and the items of the list are consumed from left to right as soon as they are created, so this does not need to keep around any kind of state other than its parameters.  (Nor does each call to <code>runCommand</code> need any.)</p>\n\n<p>This list of game states gets passed back to <code>main</code>, which turns them into printable strings with <code>show</code> and then formats them into a single output string, with the items separated by newlines.  This output string is lazily evaluated, so the program will print each state as soon as it is known.  The program thus runs interactively.</p>\n\n<p>There are certainly many ways to improve this program!  I\u2019m sure you can think of some and try them out.</p>\n\n<p>For example, to check whether a direction is available, you would want to look up the position the agent is trying to get to on some kind of world map, which might be static, or passed around as part of the world state and updated.  And <code>processCommands</code> is really just one of the higher-order functions from <code>Data.List</code>.  (Which?)</p>\n"}], "owner": {"reputation": 105, "user_id": 10823919, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-IxmCArcp864/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcbSRexjEbXRN-yya7mosiV0A15r0A/mo/photo.jpg?sz=128", "display_name": "KamilJu", "link": "https://stackoverflow.com/users/10823919/kamilju"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 2, "answer_count": 2, "score": 2, "last_activity_date": 1545576802, "creation_date": 1545522319, "last_edit_date": 1545533675, "question_id": 53900129, "link": "https://stackoverflow.com/questions/53900129/text-adventure-game-problems-with-moving-around-with-directions", "title": "Text adventure game problems with moving around with Directions", "body": "<p>I have problems moving around my map in Haskell. If the player's input is e.g. <code>BackOff</code>, I need to change the current location to the new one, but i also need to check if there is a location.</p>\n\n<p>I'm not sure how exactly to write the <code>move</code> function. I also want to show the player where they can move to from the current location (You can only move one space at a time.) </p>\n\n<p>My first idea was to check if the input is <code>TurnLeft</code> for example, and reduce <code>Direction</code> so it gets to <code>West</code> (I assume I programmed it wrong) and increase so it gets to <code>East</code> and so on.</p>\n\n<p>How do I check if the location the player wants to travel is available and how do I change location then?</p>\n\n<pre><code>location = \"Fort Neugrad\" -- the player starts in Fort Neugrad first\n\ncurrentDirection = North -- the player faces north at first\n\ndata Direction = North | East | South | West deriving(Show, Eq, Enum)\n\ndata Movement = TurnLeft | TurnRight | Advance | BackOff deriving(Show)\n\ntype Location = String\n\ntype GameMap = [((Location, Direction), Location)]   -- First location is the     current location, second is the next location where the direction points to(Ive made a map but its to large to post it)\n\n--move :: Movement -&gt; Direction -&gt; Location\n--move m = case m of TurnLeft -&gt; pred currentDirection\n       --            TurnRight -&gt; succ currentDirection\n       --            Advance -&gt;\n       --            BackOff -&gt;\n\n\nfilterAccess :: Location -&gt; [Location]\nfilterAccess l = [ c | ((a,b), c) &lt;- wonderland, a == l ]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1545516313, "post_id": 53899579, "comment_id": 94644716, "body": "Well <code>and</code> is basically making a <code>fold</code> with <code>&amp;&amp;</code> for all elements, but one needs initially <code>True</code> (since otherwise the result is always <code>False</code>, regardless of the values)."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1545516585, "post_id": 53899579, "comment_id": 94644771, "body": "This is pretty standard handling across languages. For example, <a href=\"https://stackoverflow.com/questions/30223079/why-does-stream-allmatch-return-true-for-an-empty-stream\">here&#39;s the same question in Java</a>. The concept is known as &quot;vacuous truth&quot;."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1545518839, "post_id": 53899579, "comment_id": 94645216, "body": "Note that, for the same reason, <code>sum [] == 0</code> and <code>product [] == 1</code>."}], "answers": [{"tags": [], "owner": {"reputation": 51262, "user_id": 208257, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8d59503078761ba50620cbee4348882e?s=128&d=identicon&r=PG", "display_name": "Dan Burton", "link": "https://stackoverflow.com/users/208257/dan-burton"}, "is_accepted": false, "score": 7, "last_activity_date": 1545516303, "creation_date": 1545516303, "answer_id": 53899600, "question_id": 53899579, "link": "https://stackoverflow.com/questions/53899579/why-does-and-return-true-for-empty-foldable-but-or-return-false-in-haskell/53899600#53899600", "title": "Why does `and` return True for empty foldable but `or` return False in Haskell?", "body": "<p>This is true of most languages with comparable functions. It is because \"True\" is the identity of \"&amp;&amp;\" (meaning x &amp;&amp; True == x). Likewise, \"False\" is the identity of \"||\" (meaning x || False == x).</p>\n"}, {"tags": [], "owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "is_accepted": true, "score": 8, "last_activity_date": 1545518175, "creation_date": 1545518175, "answer_id": 53899800, "question_id": 53899579, "link": "https://stackoverflow.com/questions/53899579/why-does-and-return-true-for-empty-foldable-but-or-return-false-in-haskell/53899800#53899800", "title": "Why does `and` return True for empty foldable but `or` return False in Haskell?", "body": "<p>To expand on the answer by Dan, the conjunction of an empty list of truth values being true <code>True</code> allows you to extend the expected properties of conjunction to that case. </p>\n\n<p>For instance, we would expect that, </p>\n\n<pre><code>and (xs ++ ys) = (and xs) &amp;&amp; (and ys) \n</code></pre>\n\n<p>and for all <code>xs</code> we have, <code>xs = xs ++ []</code> so, </p>\n\n<pre><code>  and xs \n= and (xs ++ [])\n= (and xs) &amp;&amp; (and []) \n</code></pre>\n\n<p>considering that <code>and xs</code> might be <code>True</code> or <code>False</code> it follows that, </p>\n\n<pre><code>True  = True  &amp;&amp; (and [])\nFalse = False &amp;&amp; (and [])\n</code></pre>\n\n<p>Therefore we must have that <code>and []</code> is <code>True</code>. </p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "closed_date": 1545524472, "accepted_answer_id": 53899800, "answer_count": 2, "score": 4, "last_activity_date": 1545518175, "creation_date": 1545515945, "last_edit_date": 1545516280, "question_id": 53899579, "link": "https://stackoverflow.com/questions/53899579/why-does-and-return-true-for-empty-foldable-but-or-return-false-in-haskell", "closed_reason": "Duplicate", "title": "Why does `and` return True for empty foldable but `or` return False in Haskell?", "body": "<p>Is there a reason that would explain whether such results are to be expected? Are they better than being undefined?</p>\n\n<pre><code>&gt;&gt;&gt; any (const True) []\nFalse\n\n&gt;&gt;&gt; any (const False) []\nFalse\n\n&gt;&gt;&gt; or []\nFalse\n\n&gt;&gt;&gt; and []\nTrue\n</code></pre>\n\n<p>I don't really understand what the Report is trying to say:</p>\n\n<pre><code>-- and returns the conjunction of a Boolean list. For the result to be\n-- True, the list must be finite; False, however, results from a False\n-- value at a finite index of a finite or infinite list. or is the\n-- disjunctive dual of and. \nand, or     :: [Bool]    -&gt; Bool\nand         =  foldr    (&amp;&amp;)    True\nor          =  foldr    (||)    False\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 429, "user_id": 796557, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/2807764ba0f590416c540c55a960e9a9?s=128&d=identicon&r=PG&f=1", "display_name": "elliptic00", "link": "https://stackoverflow.com/users/796557/elliptic00"}, "edited": false, "score": 0, "creation_date": 1594710918, "post_id": 53898957, "comment_id": 111212674, "body": "Any idea how to use customized executable name?"}, {"owner": {"reputation": 1465, "user_id": 12448530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb57856d03e9cd71a9350d79540729f0?s=128&d=identicon&r=PG&f=1", "display_name": "Firefly", "link": "https://stackoverflow.com/users/12448530/firefly"}, "reply_to_user": {"reputation": 429, "user_id": 796557, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/2807764ba0f590416c540c55a960e9a9?s=128&d=identicon&r=PG&f=1", "display_name": "elliptic00", "link": "https://stackoverflow.com/users/796557/elliptic00"}, "edited": false, "score": 0, "creation_date": 1598265699, "post_id": 53898957, "comment_id": 112392213, "body": "@elliptic00 You can change the executable name in <code>package.yaml</code> under <code>executables</code>"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 11, "last_activity_date": 1545509340, "creation_date": 1545509340, "answer_id": 53898957, "question_id": 53898956, "link": "https://stackoverflow.com/questions/53898956/stack-install-executable-to-a-custom-location/53898957#53898957", "title": "stack install executable to a custom location", "body": "<p>You can use the <code>--local-bin-path</code> to specify your custom destination path. Demo:</p>\n\n<pre><code>$ stack install tldr --local-bin-path /home/sibi\nCopying from /home/sibi/github/tldr-hs/.stack-work/install/x86_64-linux/lts-12.10/8.4.3/bin/tldr to /home/sibi/tldr\n\nCopied executables to /home/sibi:\n- tldr\n\nWarning: Installation path /home/sibi not found on the PATH environment variable.\n$ ls -lh /home/sibi/tldr\n-rwxr-xr-x 1 sibi sibi 3.0M Dec 23 01:37 /home/sibi/tldr\n</code></pre>\n"}], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 1, "accepted_answer_id": 53898957, "answer_count": 1, "score": 4, "last_activity_date": 1545509340, "creation_date": 1545509340, "question_id": 53898956, "link": "https://stackoverflow.com/questions/53898956/stack-install-executable-to-a-custom-location", "title": "stack install executable to a custom location", "body": "<p>I usually do <code>stack install &lt;package-name&gt;</code> and Stack installs it in the location <code>~/.local/bin</code>.</p>\n\n<p>Is there a way for me to specify the destination location ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 2, "creation_date": 1545503065, "post_id": 53898222, "comment_id": 94641997, "body": "Try to evaluate it on paper for (-3) and [1] and you will see.  (-3) and nonempty list goes to last pattern and recursively lowers <code>n</code> and cuts off list&#39;s head leaving it empty and activating third pattern.  Btw, what does it exactly mean that &quot;function is secure against negative numbers&quot;?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1545503088, "post_id": 53898222, "comment_id": 94642000, "body": "I think he means &quot;defined&quot; instead of &quot;secured&quot;."}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1545503146, "post_id": 53898222, "comment_id": 94642017, "body": "@Haskell could you edit your question to be more specific and fix the wording&amp;spelling?"}, {"owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "reply_to_user": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "edited": false, "score": 0, "creation_date": 1545504624, "post_id": 53898222, "comment_id": 94642353, "body": "@radrow I have corrected, It is okay so?"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "edited": false, "score": 0, "creation_date": 1545503472, "post_id": 53898248, "comment_id": 94642084, "body": "Thanks f&#252;r the explanation. I have another question. Is there a possibility to catch negative numbers without using if else or guards in this code. only purely pattern matching?   What menas secend line  (h:t) = h:t list with one element?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "edited": false, "score": 1, "creation_date": 1545503741, "post_id": 53898248, "comment_id": 94642156, "body": "1) Types like <code>Int</code> don&#39;t have broad patterns to match; you can only match individual elements or an arbitrary element. You need to use a guard. 2) The pattern <code>(h:t)</code> matches a singleton list like <code>[1]</code> by equating <code>h = 1</code> and <code>t = []</code>, since <code>[1]</code> is just syntactic sugar for <code>1:[]</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 7, "last_activity_date": 1545504904, "last_edit_date": 1545504904, "creation_date": 1545503009, "answer_id": 53898248, "question_id": 53898222, "link": "https://stackoverflow.com/questions/53898222/haskell-how-this-function-catch-negative-numbers-as-a-parameter/53898248#53898248", "title": "Haskell. How this function catch negative numbers as a parameter?", "body": "<p>Nothing catches the negative number specifically, but decreasing <code>n</code> is <em>always</em> accompanied by a shorter list, so eventually you  hit the empty list and the 3rd equation matches. <code>n</code> is an example of an irrefutable pattern; it will match <em>any</em> number (positive, zero, or negative), although with the given definition, it will never be checked until you've already confirmed that the first argument is non-zero.</p>\n\n<p>Effectively, a negative argument produces the same result as a sufficiently large argument, in that it can always be decremented without reaching 0.</p>\n\n<p>Tracing it manually,</p>\n\n<pre><code>     mdrop (-3) [1,2,3,4,5,7,88,6] \n  == mdrop (-4) [2,3,4,5,7,88,6]\n  == mdrop (-5) [3,4,5,7,88,6]\n  == mdrop (-6) [4,5,7,88,6]\n  == mdrop (-7) [5,7,88,6]\n  == mdrop (-8) [7,88,6]\n  == mdrop (-9) [88,6]\n  == mdrop (-10) [6]\n  == mdrop (-11) []\n  == []\n</code></pre>\n\n<hr>\n\n<p>As an aside, your first two definitions could be replaced by the single definition</p>\n\n<pre><code>mdrop 0 xs = xs\n</code></pre>\n\n<p>since in both original definitions, you simply return the second argument when you the first matches 0.</p>\n"}], "owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "accepted_answer_id": 53898248, "answer_count": 1, "score": 2, "last_activity_date": 1545504904, "creation_date": 1545502760, "last_edit_date": 1545504529, "question_id": 53898222, "link": "https://stackoverflow.com/questions/53898222/haskell-how-this-function-catch-negative-numbers-as-a-parameter", "title": "Haskell. How this function catch negative numbers as a parameter?", "body": "<p>I don't understand, how this function negative numbers catchs? </p>\n\n<pre><code>mdrop 0 []    = []\nmdrop 0 (h:t) = h:t\nmdrop n []    = []\nmdrop n (h:t) = mdrop (n-1) t\n</code></pre>\n\n<p>If my input looks like this <code>mdrop (-3) [1, 2, 3, 4, 5, 7, 88, 6]</code>\nI receive an empty list. But I don't understand in which line catches the negative number. </p>\n"}, {"tags": ["haskell", "lazy-evaluation", "ghci"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1545503401, "post_id": 53898220, "comment_id": 94642069, "body": "Cannot reproduce: I get <code>x = True : _</code> for the last <code>:sprint</code>"}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1545503991, "post_id": 53898220, "comment_id": 94642225, "body": "@chi which version of ghc are you using?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1545504032, "post_id": 53898220, "comment_id": 94642236, "body": "GHCi version 8.4.4. Weird. Try <code>:t x</code> to check that <code>x :: [Bool]</code>, as it should."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1545510452, "post_id": 53898220, "comment_id": 94643538, "body": "I can confirm this really happens in 8.6.2. It&#39;s very strange. If you use <code>() &lt;$ evaluate x</code> instead, then it behaves as expected. I suggest you file a GHC tiicket."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1545510600, "post_id": 53898220, "comment_id": 94643562, "body": "Also: the <code>undefined</code> is irrelevant. The same happens if you use <code>x = [True, False]</code>."}, {"owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1545566674, "post_id": 53898220, "comment_id": 94651623, "body": "@dfeuer <code>const True $! x</code> gives <code>x = True : _</code> as well. And yes, <code>undefined</code> is irrevelant \u2013 I have put it there because I wanted to check how deep the evaluation will perform."}], "answers": [{"tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": true, "score": 1, "last_activity_date": 1545935055, "last_edit_date": 1545935055, "creation_date": 1545934652, "answer_id": 53949209, "question_id": 53898220, "link": "https://stackoverflow.com/questions/53898220/sprint-and-seq-together-missing-evaluation/53949209#53949209", "title": ":sprint and `seq` together - missing evaluation?", "body": "<p>Okay, I made a ticket on trac (link: <a href=\"https://ghc.haskell.org/trac/ghc/ticket/16089\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/ticket/16089</a>) and it seems to be a bug related to another one (<a href=\"https://ghc.haskell.org/trac/ghc/ticket/16096\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/ticket/16096</a>). </p>\n\n<p>Problem was a result of how <code>x = y</code> and <code>let x = y</code> were treated in GHCi \u2013 the first one was interpreted as toplevel binding (with monomorphism restriction turned off by default) and the second one as <code>let</code> statement in <code>do</code> block. This issue implied some other unwanted behaviors like for example lack of shadowing warnings when <code>-Wall</code> was turned on. You may inspect fix for this at this thread: <a href=\"https://phabricator.haskell.org/D5473\" rel=\"nofollow noreferrer\">https://phabricator.haskell.org/D5473</a></p>\n"}], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 2, "accepted_answer_id": 53949209, "answer_count": 1, "score": 5, "last_activity_date": 1545935055, "creation_date": 1545502742, "last_edit_date": 1545504020, "question_id": 53898220, "link": "https://stackoverflow.com/questions/53898220/sprint-and-seq-together-missing-evaluation", "title": ":sprint and `seq` together - missing evaluation?", "body": "<p>I understand <code>a `seq` b</code> as \"be strict on a and compute b\", so <code>undefined `seq` True</code> throws and Exception.</p>\n\n<p>I am playing around with <code>:sprint</code> and tried following test in ghci:</p>\n\n<pre><code>Prelude&gt; x = [True, undefined]\nPrelude&gt; :sprint x\nx = _\n</code></pre>\n\n<p>Okay, because <code>x</code> was not computed yet</p>\n\n<pre><code>Prelude&gt; x `seq` True\nTrue\nPrelude&gt; :sprint x\nx = _\n</code></pre>\n\n<p>Why <code>x = _</code> at this moment? I thought that <code>seq</code> will evaluate <code>x</code> at least to <code>_:_</code> (or more possibly <code>True:_</code>), but its value still remains completely latent. It needs somehow check whether <code>x</code> is not <code>undefined</code>, so it needs to perform kind of evaluation, but why doesn't it keep the result?</p>\n\n<p>I am using GHC 8.6.3 </p>\n"}, {"tags": ["haskell", "xmonad"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1545490544, "post_id": 53896580, "comment_id": 94638924, "body": "Easy: you haven&#39;t got the right type for <code>keys</code>."}], "answers": [{"comments": [{"owner": {"reputation": 484, "user_id": 5587299, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/68b696bfe3bdb63c600cdf67bf2983e6?s=128&d=identicon&r=PG", "display_name": "aryndin", "link": "https://stackoverflow.com/users/5587299/aryndin"}, "edited": false, "score": 0, "creation_date": 1545491747, "post_id": 53896644, "comment_id": 94639200, "body": "Thank you, <code>data XConfig</code> source code made it totally clear for me ;-)"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 2, "last_activity_date": 1545490284, "creation_date": 1545490284, "answer_id": 53896644, "question_id": 53896580, "link": "https://stackoverflow.com/questions/53896580/how-does-xmonad-keys-functions-gets-reduced/53896644#53896644", "title": "How does XMonad keys functions gets reduced?", "body": "<p>Your description isn't quite correct. <code>keys</code> is a record field.</p>\n\n<p>When you have a record type <code>R</code> with a field <code>foo :: T</code>, then <code>foo</code> itself (used as a value) has the type <code>R -&gt; T</code> (it's a record accessor function).</p>\n\n<p>Since <code>keys</code> is a field of <code>XConfig</code>, its type is actually</p>\n\n<pre><code>keys :: XConfig l -&gt; !(XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ()))\n</code></pre>\n\n<p>In</p>\n\n<pre><code>keys defaultConfig c\n</code></pre>\n\n<p>We extract the <code>keys</code> field from <code>defaultConfig</code>. The value stored in this field is itself a function, which we apply to <code>c</code> to get a <code>Map</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1545490427, "creation_date": 1545490427, "answer_id": 53896669, "question_id": 53896580, "link": "https://stackoverflow.com/questions/53896580/how-does-xmonad-keys-functions-gets-reduced/53896669#53896669", "title": "How does XMonad keys functions gets reduced?", "body": "<p>The <code>Map</code> is not a function; it's a data structure, and it doesn't get applied to anything. Instead, you are creating a new config, based on <code>defaultConfig</code>, with its <code>keys</code> function replace with a new anonymous function. <em>That</em> function takes a configuration, and applies two functions to it: your <code>mikeys</code>, and whatever function <code>keys defaultConfig</code> returns. The two resulting <code>Maps</code> are merged and returned by your configuration's <code>key</code> function.</p>\n\n<p><code>xmonad</code> then uses this new configuration, which involves extracting the merged <code>Map</code> to set up your key bindings.</p>\n"}], "owner": {"reputation": 484, "user_id": 5587299, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/68b696bfe3bdb63c600cdf67bf2983e6?s=128&d=identicon&r=PG", "display_name": "aryndin", "link": "https://stackoverflow.com/users/5587299/aryndin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 53896644, "answer_count": 2, "score": 1, "last_activity_date": 1545490427, "creation_date": 1545489774, "question_id": 53896580, "link": "https://stackoverflow.com/questions/53896580/how-does-xmonad-keys-functions-gets-reduced", "title": "How does XMonad keys functions gets reduced?", "body": "<p>I'm trying to understand how XMonad configuration functions are evaluated. The first example is from Xmonad <a href=\"https://wiki.haskell.org/Xmonad/General_xmonad.hs_config_tips\" rel=\"nofollow noreferrer\">docs</a>:</p>\n\n<pre><code>import qualified Data.Map as M\n--\n\nmain = xmonad $ defaultConfig {\n  --\n  , keys          = \\c -&gt; mykeys c `M.union` keys defaultConfig c\n  --\n  }\nwhere\n    mykeys (XConfig {modMask = modm}) = M.fromList $\n         [ ((modm , xK_x), spawn \"xlock\") ]\n</code></pre>\n\n<p>The type of keys is a function:\n<code>keys :: !(XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ()))</code>\nThe question here is evaluation order. <code>keys</code> returns Map when applied to some <code>XConfig</code>, and then Map we've got should be applied to <code>c</code> (if I get it right), but how Map can be applied to something?</p>\n"}, {"tags": ["git", "haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1545721558, "post_id": 53896327, "comment_id": 94682540, "body": "I&#39;ve never used it but it seems like you could accomplish this easily by iterating <code>lookupCommitParents</code>.  Or am I misunderstanding your question?"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1545487631, "creation_date": 1545487631, "question_id": 53896327, "link": "https://stackoverflow.com/questions/53896327/git-log-output-from-haskells-gitlib-library", "title": "&quot;git log&quot; output from Haskell&#39;s gitlib library?", "body": "<p>I'm trying to get a value of type<code>[CommitObjOid]</code> in the form of <code>git log</code> (a list of commits to all files in the repository, sorted by date).</p>\n\n<p>Although I'm familiar with how to interface with git as a end user, I'm not sure if the <code>git log</code> data is stored in some form of data structure?</p>\n\n<p>How could this be accomplished with the <code>gitlib</code> haskell library? Would I need to aggregate a log based on each file in git repository?</p>\n"}, {"tags": ["haskell", "bytestring"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 3, "creation_date": 1545482678, "post_id": 53895751, "comment_id": 94637294, "body": "<a href=\"https://hackage.haskell.org/package/bytestring-0.10.8.2/docs/Data-ByteString.html#v:index\" rel=\"nofollow noreferrer\">ByteString.index</a> is probably what you&#39;re looking for."}, {"owner": {"reputation": 71, "user_id": 8423881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d20071bbf3be523d87ed13232b3d497?s=128&d=identicon&r=PG&f=1", "display_name": "Malyutin Egor", "link": "https://stackoverflow.com/users/8423881/malyutin-egor"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1545483329, "post_id": 53895751, "comment_id": 94637423, "body": "@DavidMaze, Can you just write answer?"}], "answers": [{"tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": true, "score": 7, "last_activity_date": 1545484553, "creation_date": 1545484553, "answer_id": 53895957, "question_id": 53895751, "link": "https://stackoverflow.com/questions/53895751/how-to-get-nth-byte-from-bytestring/53895957#53895957", "title": "How to get nth byte from ByteString?", "body": "<p><a href=\"https://hackage.haskell.org/package/bytestring-0.10.8.2/docs/Data-ByteString.html#v:index\" rel=\"noreferrer\">ByteString.index</a> is the function you're looking for.</p>\n\n<p>Most of the \"containerish\" types emulate the extended list interface; you also want to be careful because that <code>index</code> function will crash the program if you feed it a string that's too short (as will <code>!!</code> on ordinary lists).  A better implementation might be</p>\n\n<pre><code>import Data.ByteString as B\nnthByte :: Int -&gt; B.ByteString -&gt; Maybe Word8\nnthByte n bs = fst &lt;$&gt; B.uncons (B.drop n bs)\n</code></pre>\n\n<p>which, reading inside out, drops the first <em>n</em> bytes (maybe producing an empty byte string), then attempts to split the first character from the remainder, and if successful, ignores the rest of the string.</p>\n"}], "owner": {"reputation": 71, "user_id": 8423881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d20071bbf3be523d87ed13232b3d497?s=128&d=identicon&r=PG&f=1", "display_name": "Malyutin Egor", "link": "https://stackoverflow.com/users/8423881/malyutin-egor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 53895957, "answer_count": 1, "score": 0, "last_activity_date": 1545484553, "creation_date": 1545482464, "question_id": 53895751, "link": "https://stackoverflow.com/questions/53895751/how-to-get-nth-byte-from-bytestring", "title": "How to get nth byte from ByteString?", "body": "<p>How can I get nth byte of ByteString in Haskell?</p>\n\n<p>I tried to find function like <code>!!</code> for ByteStrings, but found nothing.</p>\n"}, {"tags": ["haskell", "functional-programming", "currying"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1545432996, "post_id": 53891629, "comment_id": 94630166, "body": "Your nomenclature is a little confused: you don\u2019t apply <code>item</code> to <code>runParser</code>, you apply <code>runParser</code> to <code>item</code>. Functions are applied to their arguments, not the other way around."}, {"owner": {"reputation": 125, "user_id": 5594534, "user_type": "registered", "profile_image": "https://graph.facebook.com/957702314318004/picture?type=large", "display_name": "koalag", "link": "https://stackoverflow.com/users/5594534/koalag"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1545433157, "post_id": 53891629, "comment_id": 94630199, "body": "Okay, I have only recently looked into lambda calculus, I&#39;ll rephrase my question. Thanks for the hint."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 5594534, "user_type": "registered", "profile_image": "https://graph.facebook.com/957702314318004/picture?type=large", "display_name": "koalag", "link": "https://stackoverflow.com/users/5594534/koalag"}, "edited": false, "score": 0, "creation_date": 1545439848, "post_id": 53891880, "comment_id": 94631205, "body": "Thanks, that&#39;s very helpful! One little question: How do you come to the definition of <code>parse</code>? using <code>:t parse</code> in ghci yields <code>parse :: Parser a -&gt; String -&gt; [(a, String)]</code>."}, {"owner": {"reputation": 125, "user_id": 5594534, "user_type": "registered", "profile_image": "https://graph.facebook.com/957702314318004/picture?type=large", "display_name": "koalag", "link": "https://stackoverflow.com/users/5594534/koalag"}, "edited": false, "score": 0, "creation_date": 1545441175, "post_id": 53891880, "comment_id": 94631342, "body": "I think, I got it; <code>parse</code> takes a <code>Parser</code> and yields the value inside the <code>Parser</code>; the new type and the value of the field are basically the same"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1545435293, "creation_date": 1545435293, "answer_id": 53891880, "question_id": 53891629, "link": "https://stackoverflow.com/questions/53891629/how-to-manually-partially-apply-a-function-in-haskell/53891880#53891880", "title": "How to manually partially apply a function in Haskell", "body": "<p>Perhaps this will get you started in the right direction:</p>\n\n<pre><code>runParser item\n= { definition of item }\nrunParser (Parser $ \\s -&gt; case s of ...)\n= { definition of runParser }\n(\\m s -&gt; case parse m s of ...) (Parser $ \\s -&gt; case s of ...)\n= { substitute argument for m everywhere }\n(\\s -&gt; case parse (Parser $ \\s -&gt; case s of ...) s of ...)\n= { definition of parse }\n(\\s -&gt; case (\\(Parser f) -&gt; f) (Parser $ \\s -&gt; case s of ...) s of ...)\n= { substitute argument for f everywhere }\n(\\s -&gt; case (\\s -&gt; case s of ...) s of ...)\n= { substitute argument for s everywhere }\n(\\s -&gt; case (case s of ...) of ...)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 125, "user_id": 5594534, "user_type": "registered", "profile_image": "https://graph.facebook.com/957702314318004/picture?type=large", "display_name": "koalag", "link": "https://stackoverflow.com/users/5594534/koalag"}, "is_accepted": false, "score": 0, "last_activity_date": 1545443398, "creation_date": 1545443398, "answer_id": 53892454, "question_id": 53891629, "link": "https://stackoverflow.com/questions/53891629/how-to-manually-partially-apply-a-function-in-haskell/53892454#53892454", "title": "How to manually partially apply a function in Haskell", "body": "<p>I have slightly modified my code, it uses pattern matching instead of record syntax. This might be easier to understand for others:</p>\n\n<pre><code>module NanoParsec where\n\nimport Data.Char\nimport Control.Monad\nimport Control.Applicative\n\n-- newtype Parser a = Parser { parse :: String -&gt; [(a,String)] }\nnewtype Parser a = Parser (String -&gt; [(a,String)])\n\nrunParser :: Parser a -&gt; String -&gt; a\nrunParser (Parser p) s =\n    case p s of\n        [(res, [])] -&gt; res\n        [(_, rs)]   -&gt; error \"Parser did not consume entire stream.\"\n        _           -&gt; error \"Parser error.\"\n\nitem :: Parser Char\nitem = Parser $ \\s -&gt;\n    case s of\n        []     -&gt; []\n        (c:cs) -&gt; [(c,cs)]\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 5594534, "user_type": "registered", "profile_image": "https://graph.facebook.com/957702314318004/picture?type=large", "display_name": "koalag", "link": "https://stackoverflow.com/users/5594534/koalag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 53891880, "answer_count": 2, "score": -1, "last_activity_date": 1545443398, "creation_date": 1545432775, "last_edit_date": 1545433708, "question_id": 53891629, "link": "https://stackoverflow.com/questions/53891629/how-to-manually-partially-apply-a-function-in-haskell", "title": "How to manually partially apply a function in Haskell", "body": "<p>I'm having trouble understanding how the following code works. I'm trying to follow the parser example found <a href=\"http://dev.stephendiehl.com/fun/002_parsers.html#parsec\" rel=\"nofollow noreferrer\">here</a>. I have used <code>ReadP</code> before and want to get a more in-depth understanding of how parsers work. My question isn't specific to parsers, rather to how function application in Haskell works. Here's the code:</p>\n\n<pre><code>module NanoParsec where\n\nimport Data.Char\nimport Control.Monad\nimport Control.Applicative\n\nnewtype Parser a = Parser { parse :: String -&gt; [(a,String)] }\n\nrunParser :: Parser a -&gt; String -&gt; a\nrunParser m s =\n    case parse m s of\n        [(res, [])] -&gt; res\n        [(_, rs)]   -&gt; error \"Parser did not consume entire stream.\"\n        _           -&gt; error \"Parser error.\"\n\nitem :: Parser Char\nitem = Parser $ \\s -&gt;\n    case s of\n        []     -&gt; []\n        (c:cs) -&gt; [(c,cs)]\n</code></pre>\n\n<p>I understand the imports aren't needed yet. When I load this into <code>ghci</code>, it works as expected:</p>\n\n<pre><code>Prelude&gt; runParser item \"m\"\n'm'\nPrelude&gt; runParser item \"ms\"\n*** Exception: Parser did not consume entire stream.\n</code></pre>\n\n<p>So no surprise here. What I'm having trouble wrapping my head around is how <code>runParser</code> is applied to <code>item</code>. Partially applying <code>runParser</code> to <code>item</code> yields a function of type <code>String -&gt; Char</code>:</p>\n\n<pre><code>Parser&gt; :t runParser item\nrunParser item :: String -&gt; Char\n</code></pre>\n\n<p>Here's how I'm trying to desugar/apply <code>runParser</code> to <code>item</code> manually:</p>\n\n<pre><code>runParser item \nrunParser Parser (\\s -&gt; ...)\n(\\m -&gt; \\s -&gt; case parse m s of ...) Parser (\\s -&gt; ...)\n</code></pre>\n\n<p>This is where I'm stuck. If I replace <code>m</code> with the function within <code>Parser</code>, I get <code>parse parse s</code>, which seems wrong to me. How do I apply <code>runParser</code> to <code>item</code> so I end up with a function of type <code>String -&gt; Char</code>? I feel like my <a href=\"http://www.haskellforall.com/2014/10/how-to-desugar-haskell-code.html\" rel=\"nofollow noreferrer\">attempt at desugaring</a> are off.</p>\n\n<p><strong>EDIT</strong>: I wrongly stated that <code>item</code> is applied to <code>runParser</code>; I confused the function and variable here.</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1545427165, "post_id": 53890793, "comment_id": 94628796, "body": "You can have multiple libraries in a <code>.cabal</code> file? Since when?"}, {"owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1545428114, "post_id": 53890793, "comment_id": 94629013, "body": "Now that you mention it, maybe it was a similar situation where all but the last was ignored; not sure but could check later."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1614487530, "post_id": 53890793, "comment_id": 117398461, "body": "@AlexisKing <a href=\"https://fgaz.me/posts/2019-11-14-cabal-multiple-libraries/\" rel=\"nofollow noreferrer\">Since Cabal 3.0.0.0, apparently</a>."}], "owner": {"reputation": 7711, "user_id": 3096687, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/31c95c0c159392d4c16fca6b55b5848d?s=128&d=identicon&r=PG", "display_name": "bbarker", "link": "https://stackoverflow.com/users/3096687/bbarker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 251, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1545426418, "creation_date": 1545426418, "question_id": 53890793, "link": "https://stackoverflow.com/questions/53890793/how-does-one-have-multiple-libraries-using-hpack", "title": "How does one have multiple libraries using hpack?", "body": "<p>I'd like to organize my project into different libraries, since eventually I may be splitting some out to external repositories.</p>\n\n<p>In a <code>.cabal</code> file I can have multiple libraries (one unnamed, and multiple named, I believe):</p>\n\n<pre><code>library\n  import: servant-deps\n  exposed-modules:\n      App\n  other-modules:\n      Paths_cow_streamer\n  hs-source-dirs:\n      src\n  build-depends:\n      servant-server &gt;= 0.15\n\n\nlibrary sxapi\n  import: servant-deps\n  exposed-modules:\n      SxClient\n  other-modules:\n      Paths_cow_streamer\n  hs-source-dirs:\n      sxapi\n  build-depends:\n      http-client\n</code></pre>\n\n<p>Initially I tried like this in my hpack <code>package.yaml</code>:</p>\n\n<pre><code>library:\n  bar:\n    source-dirs:\n      - src\n    dependencies:\n      - servant-server &gt;= 0.14\n      - wai\n      - warp\n  foo:\n    source-dirs:\n      - sxapi\n    dependencies:\n      - servant-server &gt;= 0.14\n      - wai\n      - warp    \n</code></pre>\n\n<p>But in this case, none of the entries seemed to be interpreted correctly, since e.g. source-dirs weren't present in the generated cabal file.</p>\n\n<p>I also tried this, but unsurprisingly, one of the library definitions was overwritten:</p>\n\n<pre><code>library:\n  source-dirs:\n    - src\n  dependencies:\n    - servant-server &gt;= 0.14\n    - wai\n    - warp\n\nlibrary:      \n  source-dirs:\n    - sxapi\n  dependencies:\n    - servant-server &gt;= 0.14\n    - wai\n    - warp    \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 4, "creation_date": 1545420413, "post_id": 53889775, "comment_id": 94626633, "body": "The error message you&#39;ve given comes from failing to load the file that contains your function. There should be a different compilation error that tells the reason why the file couldn&#39;t be compiled."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1545427412, "post_id": 53889775, "comment_id": 94628844, "body": "To improve your question to where someone could help you out, try compiling the file containing your code with <code>ghc</code> and copy-paste the command you used and the output it gave here. As 4castle said, there&#39;s probably an error there that you&#39;re missing."}, {"owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "edited": false, "score": 0, "creation_date": 1545428837, "post_id": 53889775, "comment_id": 94629164, "body": "I have rewrite my code. I do not receive an error any more but output is 0 &lt;pre&gt; howManyTimes y xs = howManyIntern y xs 0   where       howManyIntern y [] acc = 0       howManyIntern y (x:xs) acc | x == y = howManyIntern y xs (acc + 1) \t                             | otherwise =  howManyIntern y xs acc &lt;code&gt;"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "edited": false, "score": 0, "creation_date": 1545472901, "post_id": 53894193, "comment_id": 94635343, "body": "Many Thanks. Second solution is very nice and short but for understanding Recursion I think first solution is better."}], "tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": true, "score": 1, "last_activity_date": 1545468253, "last_edit_date": 1545468253, "creation_date": 1545467952, "answer_id": 53894193, "question_id": 53889775, "link": "https://stackoverflow.com/questions/53889775/haskell-variable-not-in-scope-howmanytimes-integer-integer-t/53894193#53894193", "title": "Haskell. Variable not in scope: howManyTimes :: Integer -&gt; [Integer] -&gt; t", "body": "<blockquote>\n  <p>I have rewrite my code. I do not receive an error any more but output is 0</p>\n</blockquote>\n\n<pre><code>howManyTimes y xs = howManyIntern y xs 0 \n    where howManyIntern y [] acc = 0 \n          howManyIntern y (x:xs) acc | x == y = howManyIntern y xs (acc + 1) \n                                     | otherwise = howManyIntern y xs acc \n</code></pre>\n\n<p>The output is 0 from above code in comment since the expression:</p>\n\n<pre><code>howManyIntern y [] acc = 0 \n</code></pre>\n\n<p>return 0 whenever it finish the counting. It is easy to be fixed by return <code>acc</code> instead:</p>\n\n<pre><code>howManyIntern y [] acc = acc\n</code></pre>\n\n<p>An alternative way to do that uses existing functions:</p>\n\n<pre><code>howManyTimes y xs = length $ filter (==y) xs\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 53894193, "answer_count": 1, "score": 0, "last_activity_date": 1545468253, "creation_date": 1545420027, "question_id": 53889775, "link": "https://stackoverflow.com/questions/53889775/haskell-variable-not-in-scope-howmanytimes-integer-integer-t", "title": "Haskell. Variable not in scope: howManyTimes :: Integer -&gt; [Integer] -&gt; t", "body": "<p>I wrote a small code, which counts of characters or a numbers in a list and how many times. for example howManyTimes 3 [2, 3, 4, 5, 3, 3, 1, 80, 3] should be 4</p>\n\n<p>This is my code</p>\n\n<pre><code>howManyTimes y [] = 0\nhowManyTimes y xs = howManyIntern y (x:xs) acc \n                        | x == y = howManyIntern y xs (acc + 1)\n                        | otherwise = howManyIntern y xs acc  \n</code></pre>\n\n<p>And I receive this error message. Variable not in scope: howManyTimes :: Integer -> [Integer] -> t</p>\n\n<p>Can anyone say me a hint?</p>\n"}, {"tags": ["haskell", "definition", "category-theory"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 0, "creation_date": 1545453249, "post_id": 53886406, "comment_id": 94632568, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/185639/discussion-on-question-by-sereja-bogolubov-a-b-c-d-in-haskell\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 0, "creation_date": 1545406479, "post_id": 53887283, "comment_id": 94621257, "body": "Yeah, agree, your example is quite explicit and yet redundant for programming language. But still - why not be a little bit explicit by default and force <code>GHC</code> to refer <code>(a -&gt; b) -&gt; (f a -&gt; f b)</code>. <code>(a -&gt; b) -&gt; f a -&gt; f b</code> is WAY MUCH unusual abuse of notation!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 3, "creation_date": 1545407318, "post_id": 53887283, "comment_id": 94621604, "body": "@SerejaBogolubov It&#39;s not an abuse; there just aren&#39;t any other common right-associative, non-commutative operators to use for intuition. There is <i>no</i> ambiguity about what <code>(a -&gt; b) -&gt; f a -&gt; f b</code> means. Because it is right-associative, the only possible parse is (switching to prefix notation) <code>(-&gt;) (a -&gt; b) ((-&gt;) (f a) (f b))</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 2, "creation_date": 1545408004, "post_id": 53887283, "comment_id": 94621889, "body": "@SerejaBogolubov Do you also object that <code>3 * 4 * 5</code> is an abuse of notation, and that we should be forced to write either <code>(3 * 4) * 5</code> or <code>3 * (4 * 5)</code>? What about <code>1 - 2 - 3</code> or <code>f $ g $ x</code>? If you agree it is okay to have a notion of which way operators associate by default at the computation level, then why not at the type level, too?"}, {"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1545408281, "post_id": 53887283, "comment_id": 94622015, "body": "@DanielWagner, see the comments under the other answer. That resolves all issues."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1545418514, "post_id": 53887283, "comment_id": 94625993, "body": "@DanielWagner <code>3 * 4 * 5</code> isn&#39;t a great analogy, because that&#39;s unambiguous even <i>without</i> a notion of which way operators associate. (At least for exact arithmetic.)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1545406125, "creation_date": 1545406125, "answer_id": 53887283, "question_id": 53886406, "link": "https://stackoverflow.com/questions/53886406/a-b-c-d-in-haskell/53887283#53887283", "title": "`(a -&gt; b) -&gt; (c -&gt; d)` in Haskell?", "body": "<blockquote>\n  <p>is <code>(a -&gt; b) -&gt; f a -&gt; f b</code> suppose to be an <code>(a -&gt; b) -&gt; (f a -&gt; f b) -&gt; f b</code>, sugared for simplicity</p>\n</blockquote>\n\n<p>No. I think what you're missing, and it's not really your fault, is that it's only a very special case that the middle arrow in <code>(a -> b) <b>-></b> (f a -> f b)</code> can be called <em>morphism</em> in the same way as the outer <code>(a <b>-></b> b) -> (f a <b>-></b> f b)</code> can. The general case of a Functor class would be (in pseudo-syntax)</p>\n\n<pre><code>class (Category (\u2500\u2500&gt;), Category (~&gt;)) =&gt; Functor f (\u2500\u2500&gt;) (~&gt;) where\n  fmap :: (a \u2500\u2500&gt; b) -&gt; f a ~&gt; f b\n</code></pre>\n\n<p>So, it maps morphisms in the category whose arrows are denoted <code>\u2500\u2500&gt;</code> to morphisms in the category <code>~&gt;</code>, but this morphism-mapping itself is just plainly a <em>function</em>. Your right, in <strong>Hask</strong> specifically function-arrows are the same sort of arrows as the morphism arrows, but this is mathematically speaking a rather degenerate scenario.</p>\n"}, {"comments": [{"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 0, "creation_date": 1545407004, "post_id": 53887424, "comment_id": 94621479, "body": "<code>(a -&gt; b)</code> is a morphism, it is well-understood notation. <code>(a -&gt; b) -&gt; f a</code> <i>could be</i> interpreted is such a way that there exists a morphism from the <code>(a -&gt; b)</code> to the <code>f a</code>. Saying that <code>(a -&gt; b) -&gt; (f a -&gt; f b)</code>, would rather mean that morphism is mapped to another morphism, and no uncertainty remained! That&#39;s what I was asking - what&#39;s the point to introduce such a weird context-based uncertainty, if there is no syntax sugar staying behind?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 2, "creation_date": 1545407361, "post_id": 53887424, "comment_id": 94621622, "body": "@SerejaBogolubov It is merely a matter of notational convenience. Putting <code>fmap</code> aside for a moment, it is convenient to be able to write <code>(+) :: Num a =&gt; a -&gt; a -&gt; a</code> rather than <code>(+) :: Num a =&gt; a -&gt; (a -&gt; a)</code>, or <code>foldr :: Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b</code> rather than <code>foldr :: Foldable t =&gt; (a -&gt; (b -&gt; b)) -&gt; (b -&gt; (t a -&gt; b))</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 4, "creation_date": 1545407526, "post_id": 53887424, "comment_id": 94621683, "body": "@SerejaBogolubov It can only be interpreted that way if you willfully ignore the associativity of the <code>-&gt;</code> operator. <i>Don&#39;t do that!</i> Do you complain that <code>1 + 2 * 3</code> could be interpreted as <code>(1+2)*3 == 9</code>? No, because you don&#39;t ignore the fact that <code>*</code> is assumed to have a higher precedence."}, {"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 0, "creation_date": 1545407680, "post_id": 53887424, "comment_id": 94621748, "body": "Well, I pointed out from the very beginning - it is <b>category theory specific question</b>. Arrows are not operators - the compositor is. Arrows have no precedence. Arrows are just arrows - unless the context is provided. In Hask arrows are just functions: do functions preserve associativity? Nope, however function composition - does."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1545407713, "post_id": 53887424, "comment_id": 94621766, "body": "The whole reason for dropping the parentheses is to maintain the illusion of multi-argument functions, a mental model that is usually (but not always) more useful than a higher-order function. When the less-commonly used interpretation is desired, <i>then</i> you can apply the extra work of the redundant parentheses to emphasize the point."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 6, "creation_date": 1545407926, "post_id": 53887424, "comment_id": 94621860, "body": "@SerejaBogolubov A question involving the syntax of Haskell type signatures is not purely about category theory, though."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1545408026, "post_id": 53887424, "comment_id": 94621899, "body": "Haskell is not category theory, though - despite the fact that parts of Haskell are obviously deeply based on certain ideas of category theory. Haskell <i>does</i> have an &quot;arrow operator&quot;, which is right associative and where <code>a -&gt; b</code> denotes a morphism (or function, in programming terms) from type <code>a</code> to type <code>b</code>. It&#39;s a convenience which sits on top of the category-theoretic underpinning. But it doesn&#39;t contradict or somehow go against anything from category theory."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1545408078, "post_id": 53887424, "comment_id": 94621913, "body": "But <code>fmap</code> is <i>not</i> an arrow, which is where this simple substitution breaks down. Categorically speaking, there are two separate adjunct functors that we choose to &quot;merge&quot; into a single operator <code>(-&gt;)</code>. You might want to read <a href=\"https://bartoszmilewski.com/2015/03/13/function-types/\" rel=\"nofollow noreferrer\">bartoszmilewski.com/2015/03/13/function-types</a>, which explains categorically what a function type actually is, and mentions <code>curry</code> and <code>uncurry</code>. (Somewhere in Zmilewski&#39;s book is also a discussion about how adjunct functors apply to all this, but I forget where at the moment.)"}, {"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 0, "creation_date": 1545408230, "post_id": 53887424, "comment_id": 94621994, "body": "@chepner. that&#39;s nice hint! Much appreciated. I had to specify that this is not just Haskell-specific question in a more explicit manner, apologizes for long misunderstanding."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1545408445, "post_id": 53887424, "comment_id": 94622087, "body": "Thanks @chepner - I&#39;d missed that point, and still aren&#39;t too sure about it myself, but I&#39;ll definitely read that article, which looks interesting!"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1545408875, "last_edit_date": 1545408875, "creation_date": 1545406727, "answer_id": 53887424, "question_id": 53886406, "link": "https://stackoverflow.com/questions/53886406/a-b-c-d-in-haskell/53887424#53887424", "title": "`(a -&gt; b) -&gt; (c -&gt; d)` in Haskell?", "body": "<p><code>fmap</code> is actually an entire <em>family</em> of morphisms. A morphism in <strong>Hask</strong> is always from a concrete type to another concrete type. You can think of a function as a morphism if the function has a concrete argument type and a concrete return type. A function of type <code>Int -&gt; Int</code> represents a morphism (an endomorphism, really) from <code>Int</code> to <code>Int</code> in <strong>Hask</strong>. <code>fmap</code>, however has type <code>Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code>. Not a concrete type in sight! We just have type variables and a quasi-operator <code>=&gt;</code> to deal with.</p>\n\n<p>Consider the following set of concrete function types.</p>\n\n<pre><code>Int -&gt; Int\nChar -&gt; Int\nInt -&gt; Char\nChar -&gt; Char\n</code></pre>\n\n<p>Further, consider the following type constructors</p>\n\n<pre><code>[]\nMaybe\n</code></pre>\n\n<p><code>[]</code> applied to <code>Int</code> returns a type we could call <code>List-of-Ints</code>, but we usually just call <code>[Int]</code>. (One of the most confusing things about functors when I started out was that we just don't have separate names to refer to the types that various type constructors produce; the output is just named by the expression that evaluates to it.) <code>Maybe Int</code> returns the type we just call, well, <code>Maybe Int</code>.</p>\n\n<p>Now, we can define a bunch of functions like the following</p>\n\n<pre><code>fmap_int_int_list :: (Int -&gt; Int) -&gt; [Int] -&gt; [Int]\nfmap_int_char_list :: (Int -&gt; Char) -&gt; [Int] -&gt; [Char]\nfmap_char_int_list :: (Char -&gt; Int) -&gt; [Char] -&gt; [Int]\nfmap_char_char_list :: (Char -&gt; Char) -&gt; [Char] -&gt; [Char]\nfmap_int_int_maybe :: (Int -&gt; Int) -&gt; Maybe Int -&gt; Maybe Int\nfmap_int_char_maybe :: (Int -&gt; Char) -&gt; Maybe Int -&gt; Maybe Char\nfmap_char_int_maybe:: (Char -&gt; Int) -&gt; Maybe Char -&gt; Maybe Int\nfmap_char_char_maybe :: (Char -&gt; Char) -&gt; Maybe Char -&gt; Maybe Char\n</code></pre>\n\n<p>Each of these is a distinct morphism in <strong>Hask</strong>, but when we define them in Haskell, there's a lot of repetition.</p>\n\n<pre><code>fmap_int_int_list f xs = map f xs\nfmap_int_char_list f xs = map f xs\nfmap_char_int_list f xs = map f xs\nfmap_char_char_list f xs = map f xs\nfmap_int_int_maybe f x = case x of Nothing -&gt; Nothing; Just y -&gt; Just (f y)\nfmap_int_char_maybe f x = case x of Nothing -&gt; Nothing; Just y -&gt; Just (f y)\nfmap_char_int_maybe f x = case x of Nothing -&gt; Nothing; Just y -&gt; Just (f y)\nfmap_char_char_maybe f x = case x of Nothing -&gt; Nothing; Just y -&gt; Just (f y)\n</code></pre>\n\n<p>The definitions don't differ when the type of <code>f</code> differs, only when the type of <code>x</code>/<code>xs</code> differs. That means we can define the following <em>polymorphic</em> functions</p>\n\n<pre><code>fmap_a_b_list f xs = map f xs\nfmap_a_b_maybe f x = case x of Nothing -&gt; Nothing; Just y -&gt; Just (f y)\n</code></pre>\n\n<p>each of which represents a set of morphisms in <strong>Hask</strong>.</p>\n\n<p><code>fmap</code> itself is an umbrella term we use to refer to constructor-specific morphisms referred to by all the polymorphic functions.</p>\n\n<p>With that out of the way, we can better understand <code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code>.</p>\n\n<p>Given <code>fmap f</code>, we first look at the type of <code>f</code>. We might find out, for example, that <code>f :: Int -&gt; Int</code>, which means <code>fmap f</code> has to return one of <code>fmap_int_int_list</code> or <code>fmap_int_int_maybe</code>, but we're not sure which yet. So instead, it returns a <em>constrained</em> function of type <code>Functor f =&gt; (Int -&gt; Int) -&gt; f Int -&gt; f Int</code>. Once that function is applied to a value of type <code>[Int]</code> or <code>Maybe Int</code>, we'll finally have enough information to know which morphism is actually meant.</p>\n"}, {"tags": [], "owner": {"reputation": 2280, "user_id": 1442575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd9a74eef0b1c8e998edf3891cb6ed2e?s=128&d=identicon&r=PG", "display_name": "Jorge Adriano", "link": "https://stackoverflow.com/users/1442575/jorge-adriano"}, "is_accepted": false, "score": 3, "last_activity_date": 1545534356, "last_edit_date": 1592644375, "creation_date": 1545525671, "answer_id": 53900363, "question_id": 53886406, "link": "https://stackoverflow.com/questions/53886406/a-b-c-d-in-haskell/53900363#53900363", "title": "`(a -&gt; b) -&gt; (c -&gt; d)` in Haskell?", "body": "<blockquote>\n<p>Now weird thing happens: fmap, obviously, is a morphism of the Hask, so it is a function, that takes another function and transform it to a yet another function; final function hasn't been applied yet.</p>\n<p>Hence, one needs one more Hask's morphism to get from the (f a -&gt; f b) to the f b. For each item i of type a there exists a morphism apply_i :: (f a -&gt; f b) -&gt; f b defined as \\f -&gt; f (lift i), where lift i is a way to build an f a with particular i inside.</p>\n</blockquote>\n<p>The notion of application in category theory is modelled in the form of <a href=\"https://en.wikipedia.org/wiki/Cartesian_closed_category\" rel=\"nofollow noreferrer\">CCC's - Cartesian Closed Categories</a>. A category \ud835\udcd2 is a CCC if you have a natural bijection \ud835\udcd2(X\u00d7Y,Z) \u2245 \ud835\udcd2(X,Y\u21d2Z).</p>\n<p>In particular this implies that there exists a natural transformation \ud835\udf3a (the evaluation), where \ud835\udf3a[Y,Z]:(Y\u21d2Z)\u00d7Y\u2192Z, such that for every g:X\u00d7Y\u2192Z there exists a \ud835\udf40g:X\u2192(Y\u21d2Z) such that, g = \ud835\udf40g\u00d7id;\ud835\udf3a[Y,Z]. So when you say,</p>\n<blockquote>\n<p>Hence, one needs one more Hask's morphism to get from the (f a -&gt; f b) to the f b.</p>\n</blockquote>\n<p>The way you go from <code>(f a -&gt; f b)</code> to the <code>f b</code>, or using the notation above, from <code>(f a \u21d2 f b)</code> is via <code>\ud835\udf3a[f a,f b]:(f a \u21d2 f b) \u00d7 f a \u2192 f b</code>.</p>\n<p>The other important point to keep in mind is that in Category Theory &quot;elements&quot; are not primitive concepts. Rather an element is an arrow of the form \ud835\udfcf\u2192X,where \ud835\udfcf is the terminal object. If you take X=\ud835\udfcf you have that \ud835\udcd2(Y,Z) \u2245 \ud835\udcd2(\ud835\udfcf\u00d7Y,Z) \u2245 \ud835\udcd2(\ud835\udfcf,Y\u21d2Z). That is, the morphisms g:Y\u2192Z are in bijection to elements \ud835\udf40g:\ud835\udfcf\u2192(Y\u21d2Z).</p>\n<p>In Haskell this means functions are precisely the &quot;elements&quot; of arrow types. So in Haskell an application <code>h y</code> would be modelled via the evaluation of \ud835\udf40h:\ud835\udfcf\u2192(Y\u21d2Z) on y:\ud835\udfcf\u2192Y. That is, the evaluation of (\ud835\udf40h)\u00d7y:\ud835\udfcf\u2192(Y\u21d2Z)\u00d7Y, which is given by the composition (\ud835\udf40h)\u00d7y;\ud835\udf3a[Y,Z]:\ud835\udfcf\u2192Z.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 2, "last_activity_date": 1545575831, "creation_date": 1545575831, "answer_id": 53904484, "question_id": 53886406, "link": "https://stackoverflow.com/questions/53886406/a-b-c-d-in-haskell/53904484#53904484", "title": "`(a -&gt; b) -&gt; (c -&gt; d)` in Haskell?", "body": "<p>For the sake of completeness, this answer focuses on a point that was addressed in various comments, but not by the the other answers.</p>\n\n<blockquote>\n  <p>The other way to see it is GHC-style: <code>(a -&gt; b) -&gt; f a -&gt; f b</code>. On the contrast with what I've written above, <code>(a -&gt; b) -&gt; f a</code> is mapping to the regular object of the Hask. </p>\n</blockquote>\n\n<p><code>-&gt;</code> in type signatures is right-associative. That being so, <code>(a -&gt; b) -&gt; f a -&gt; f b</code> is really the same as <code>(a -&gt; b) -&gt; (f a -&gt; f b)</code>, and seeing <code>(a -&gt; b) -&gt; f a</code> in it would be a syntactic mix-up. It is no different from how...</p>\n\n<pre><code>(++) :: [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>... doesn't mean that partially applying <code>(++)</code> will give us an <code>[a]</code> list (rather, it gives us a function that prepends some list).</p>\n\n<p>From this point of view, the category theory questions you raise (for instance, on \"need[ing] one more Hask's morphism to get from the <code>(f a -&gt; f b)</code> to the <code>f b</code>\") are a separate matter, addressed well by <a href=\"https://stackoverflow.com/a/53900363/2751851\">Jorge Adriano's answer</a>.</p>\n"}], "owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 1, "accepted_answer_id": 53887283, "answer_count": 4, "score": 6, "last_activity_date": 1545575831, "creation_date": 1545402428, "last_edit_date": 1545403096, "question_id": 53886406, "link": "https://stackoverflow.com/questions/53886406/a-b-c-d-in-haskell", "title": "`(a -&gt; b) -&gt; (c -&gt; d)` in Haskell?", "body": "<p>This is yet another Haskell-through-category-theory question.</p>\n\n<p>Let's take something simple and well-known as an example. <code>fmap</code>? \nSo <code>fmap :: (a -&gt; b) -&gt; f a -&gt; f b</code>, omitting the fact that <code>f</code> is actually a <code>Functor</code>. As far as I understand, <code>(a -&gt; b) -&gt; f a -&gt; f b</code> is nothing but a <strong>syntax sugar</strong> for the <code>(a -&gt; b) -&gt; (f a -&gt; f b)</code>; hence conclusion: </p>\n\n<p><strong>(1)</strong> <code>fmap</code> is a function producing a function.</p>\n\n<p>Now, <strong>Hask</strong> contains functions as well, so <code>(a -&gt; b)</code> and, in particular, <code>(f a -&gt; f b)</code> is <strong>an object</strong> of the Hask (because objects of the Hask are well-defined Haskell types - a-ka mathematical sets - and there indeed exists set of type <code>(a -&gt; b)</code> for each possible <code>a</code>, right?). So, once again:</p>\n\n<p><strong>(2)</strong> <code>(a -&gt; b)</code> is an object of the Hask.</p>\n\n<p>Now weird thing happens: <code>fmap</code>, obviously, is a <strong>morphism</strong> of the Hask, so it is a function, that takes another function and transform it to a yet another function; <strong>final function hasn't been applied yet</strong>.</p>\n\n<p>Hence, one needs one more Hask's morphism to get from the <code>(f a -&gt; f b)</code> to the <code>f b</code>. For each item <code>i</code> of type <code>a</code> there exists a morphism <code>apply_i :: (f a -&gt; f b) -&gt; f b</code> defined as <code>\\f -&gt; f (lift i)</code>, where <code>lift i</code> is a way to build an <code>f a</code> with particular <code>i</code> inside.</p>\n\n<p>The other way to see it is <code>GHC</code>-style: <code>(a -&gt; b) -&gt; f a -&gt; f b</code>. On the contrast with what I've written above, <code>(a -&gt; b) -&gt; f a</code> is mapping to the regular object of the Hask. But such a view contradicts fundamental Haskell's axiom - no multivariate functions, but applied (curried) alternatives.</p>\n\n<hr>\n\n<p>I'd like to ask at this point: is <code>(a -&gt; b) -&gt; f a -&gt; f b</code> suppose to be an <code>(a -&gt; b) -&gt; (f a -&gt; f b) -&gt; f b</code>, sugared for simplicity, or am I missing something really, really important there?</p>\n"}, {"tags": ["haskell", "graph"], "comments": [{"owner": {"reputation": 147, "user_id": 6838782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356f31873735c15aaa2421c68c5a2df1?s=128&d=identicon&r=PG", "display_name": "Dortmunder", "link": "https://stackoverflow.com/users/6838782/dortmunder"}, "edited": false, "score": 0, "creation_date": 1545396106, "post_id": 53884898, "comment_id": 94616342, "body": "If it would be oo-programming i would do it something like that:   foreach x in nodes do \tforeach s in sucs x do \t\tif exists s in sucs&#39; \t\t\tadd x to sucs&#39; s \t\telse \t\t\tadd s -&gt; [x] to sucs&#39;  but i dont get how to do it in functional programming"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1545397690, "post_id": 53884898, "comment_id": 94617032, "body": "You&#39;ll need to actually call the function on each node to find out what the edges really are. This isn&#39;t a good representation for a graph whose edges you want to reverse."}, {"owner": {"reputation": 147, "user_id": 6838782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356f31873735c15aaa2421c68c5a2df1?s=128&d=identicon&r=PG", "display_name": "Dortmunder", "link": "https://stackoverflow.com/users/6838782/dortmunder"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1545397963, "post_id": 53884898, "comment_id": 94617163, "body": "Well, thats what i have. I would also prefer something different."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1545398130, "post_id": 53884898, "comment_id": 94617249, "body": "Sorry, you can&#39;t dig into a function like that. You first have to reify it as an explicit mapping."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1545400542, "post_id": 53884898, "comment_id": 94618379, "body": "<code>[n] ++ ...</code> is much better written as <code>n : ...</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1545417592, "post_id": 53884898, "comment_id": 94625656, "body": "I took the liberty of adding a reasonable declaration of the <code>Graph</code> type, which you should have done yourself. If I got it wrong, please feel free to edit."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1545417887, "post_id": 53884898, "comment_id": 94625775, "body": "I think it&#39;s important to mention that the type of <code>reverseGraph</code>, namely the fact that it has only an <code>Eq a</code> constraint, forces you to use a very inefficient implementation. If you had a constraint of <code>Ord a</code> or <code>(Eq a, Hashable a)</code>, then you could do considerably better."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1545439801, "post_id": 53884898, "comment_id": 94631200, "body": "nitpick: as you probably know you&#39;re asking specifically about a <i>directed</i> graph. Personally if I saw a type named <code>Graph</code> I would assume it was undirected"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 6838782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356f31873735c15aaa2421c68c5a2df1?s=128&d=identicon&r=PG", "display_name": "Dortmunder", "link": "https://stackoverflow.com/users/6838782/dortmunder"}, "edited": false, "score": 0, "creation_date": 1545399549, "post_id": 53885441, "comment_id": 94617924, "body": "That helped me very much! Thank you!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1545398164, "creation_date": 1545398164, "answer_id": 53885441, "question_id": 53884898, "link": "https://stackoverflow.com/questions/53884898/how-to-reverse-a-graph-in-haskell/53885441#53885441", "title": "How to reverse a graph in haskell?", "body": "<p>Here's a hint. Let's consider the reverse of <code>G vertices edges</code>.\nThat will be of the form <code>G vertices' edges'</code>.</p>\n\n<p>It's obvious that <code>vertices' = vertices</code>.</p>\n\n<p>What about <code>edges'</code>? Well, for any value <code>v</code>, <code>edges' v</code> must return</p>\n\n<ul>\n<li>\"the list of all the <code>w</code> in <code>vertices</code> such that <code>edge w</code> contains <code>v</code> as an element\"</li>\n</ul>\n\n<p>You can translate the above English description into Haskell code using a list comprehension. You can use <code>x `elem` list</code> to check whether <code>x</code> is an element of <code>list</code>.</p>\n"}], "owner": {"reputation": 147, "user_id": 6838782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/356f31873735c15aaa2421c68c5a2df1?s=128&d=identicon&r=PG", "display_name": "Dortmunder", "link": "https://stackoverflow.com/users/6838782/dortmunder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 1, "accepted_answer_id": 53885441, "answer_count": 1, "score": 4, "last_activity_date": 1545417542, "creation_date": 1545395634, "last_edit_date": 1545417542, "question_id": 53884898, "link": "https://stackoverflow.com/questions/53884898/how-to-reverse-a-graph-in-haskell", "title": "How to reverse a graph in haskell?", "body": "<p>for an exercise I need to reverse a graph (reverse all edges), but I don't get anywhere.\nSo I need some help.</p>\n\n<p>I am aware you might not want to solve the exercise for me, so that's not what I am asking for. I just need to get some advice...</p>\n\n<p>So to get to it:</p>\n\n<pre><code>data Graph a = G\n  { nodes :: [a]\n  , successors :: a -&gt; [a] }\n\nreverseGraph :: Eq a =&gt; Graph a -&gt; Graph a\n</code></pre>\n\n<p>A graph has to parameters: a list of nodes and a function that defines the successors. This function has the type: \n<code>a -&gt; [a]</code></p>\n\n<p>for example: </p>\n\n<pre><code>graph1 :: Graph Int\ngraph1 = G [1..6] $ \\case   1 -&gt; [2,3]\n                            2 -&gt; []\n                            3 -&gt; [1,4,6]\n                            4 -&gt; [1]\n                            5 -&gt; [3,5]\n                            6 -&gt; [2,4,5]\n</code></pre>\n\n<p>the reversed graph would be:</p>\n\n<pre><code>reverseGraph graph1 ~&gt;\n    2 -&gt; [1,6]\n    3 -&gt; [1,5]\n    1 -&gt; [3,4]\n    4 -&gt; [3,6]\n    6 -&gt; [3]\n    5 -&gt; [5,6]\n</code></pre>\n\n<p>I get that I need to check for each node in the input graph the successors and add for each the input node to the new successor list of the output node.</p>\n\n<p>But i just don't get how to do this in Haskell. </p>\n\n<p>Any help is appreciated!</p>\n\n<hr>\n\n<p>Here is my solution for anyone who may attempt something similar:</p>\n\n<pre><code>reverseGraph :: Eq a =&gt; Graph a -&gt; Graph a\nreverseGraph (G nodes sucs) =  (G nodes sucs') where \n    sucs' a = getVert a nodes sucs\n\n--Makes a list of all occurrences of v in the succeccor list.\ngetVert :: Eq a =&gt; a -&gt; [a] -&gt; (a-&gt; [a]) -&gt; [a]\ngetVert v [] succs = []\ngetVert v (n:ns) succs = if v `elem` succs n then [n]++getVert v ns succs else getVert v ns succs\n</code></pre>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1559515834, "post_id": 53883530, "comment_id": 99434560, "body": "Maybe <code>:script filename</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 13928, "user_id": 1058292, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/M7vPd.jpg?s=128&g=1", "display_name": "atreeon", "link": "https://stackoverflow.com/users/1058292/atreeon"}, "edited": false, "score": 0, "creation_date": 1545394266, "post_id": 53884109, "comment_id": 94615501, "body": "ah, that explains the error I received when I tried to import them both at the same time too.  It makes sense.  Many thanks :-)"}], "tags": [], "owner": {"reputation": 934, "user_id": 7459445, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GBpx1.png?s=128&g=1", "display_name": "Claude", "link": "https://stackoverflow.com/users/7459445/claude"}, "is_accepted": true, "score": 3, "last_activity_date": 1545392016, "creation_date": 1545392016, "answer_id": 53884109, "question_id": 53883530, "link": "https://stackoverflow.com/questions/53883530/how-to-load-multiple-hs-files-with-only-functions-no-modules-into-haskell-ghc/53884109#53884109", "title": "How to load multiple .hs files with only functions (no modules) into haskell ghci?", "body": "<p>Ref: <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch5.html#x11-990005.1\" rel=\"nofollow noreferrer\">https://www.haskell.org/onlinereport/haskell2010/haskellch5.html#x11-990005.1</a></p>\n\n<blockquote>\n  <p>An abbreviated form of module, consisting only of the module body, is permitted. If this is used, the header is assumed to be <code>module Main(main) where</code>.</p>\n</blockquote>\n\n<p>I don't think you can have two identically named modules loaded into <code>ghci</code> (the real name of the module; you can have aliased qualified imports).</p>\n"}], "owner": {"reputation": 13928, "user_id": 1058292, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/M7vPd.jpg?s=128&g=1", "display_name": "atreeon", "link": "https://stackoverflow.com/users/1058292/atreeon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 53884109, "answer_count": 1, "score": 0, "last_activity_date": 1545392016, "creation_date": 1545389633, "question_id": 53883530, "link": "https://stackoverflow.com/questions/53883530/how-to-load-multiple-hs-files-with-only-functions-no-modules-into-haskell-ghc", "title": "How to load multiple .hs files with only functions (no modules) into haskell ghci?", "body": "<p>I can load a single haskell file with a single function into ghci using <code>:l addOne.hs</code></p>\n\n<p>If I load another haskell file <code>:l addTwo.hs</code> it wipes the reference to the other and I get a <code>Variable not in scope: addOne</code> error when I try to call <code>addOne</code></p>\n\n<p>addOne.hs</p>\n\n<pre><code>addOne x = x + 1\n</code></pre>\n\n<p>addTwo.hs</p>\n\n<pre><code>addTwo x = x + 2\n</code></pre>\n\n<p>There are a few other posts that talk about loading multiple modules.  Is the only way to achieve the above to convert them to modules and call</p>\n\n<pre><code>&gt; :load Module1 Module2\n&gt; :module Module1 Module2\n</code></pre>\n"}, {"tags": ["haskell", "openssl", "haskell-stack", "libssl"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1545366375, "post_id": 53878632, "comment_id": 94605318, "body": "The bindings are likely for a different version of openssl. Have you looked at the version they indicated? EDIT: Ok it says <code>OpenSSL version &lt; 1.1.0</code>, perhaps the downgrade didn&#39;t take? Are you confident the include and linker paths were set correctly?"}, {"owner": {"reputation": 707, "user_id": 7868376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4d92cc168903249d34560da543ef621f?s=128&d=identicon&r=PG&f=1", "display_name": "picotard", "link": "https://stackoverflow.com/users/7868376/picotard"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1545373542, "post_id": 53878632, "comment_id": 94607085, "body": "How do I set the include and linker paths? I downloaded the openssl 1.0.1g package, and did the standard <code>.&#47;config</code>, <code>make</code> and <code>make install</code>."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1545374071, "post_id": 53878632, "comment_id": 94607232, "body": "That will usually install libraries in <code>&#47;usr&#47;local&#47;$LIB</code> and include files in <code>&#47;usr&#47;local&#47;include</code>.  If you still have a packaged openssl installed it will probably be under <code>&#47;usr&#47;lib</code> and <code>&#47;usr&#47;include</code>.  You should remove the old version of openssl if you haven&#39;t yet.  If the linker still has issues you can do the explicit thing and add <code>&#47;usr&#47;local&#47;lib</code> to <code>&#47;etc&#47;ld.so.conf</code> and run <code>sudo ldconfig</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7897684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17aa8f588e70c7b067816b8681cc9325?s=128&d=identicon&r=PG&f=1", "display_name": "Anand Sinha", "link": "https://stackoverflow.com/users/7897684/anand-sinha"}, "is_accepted": false, "score": 0, "last_activity_date": 1596703010, "creation_date": 1596703010, "answer_id": 63279817, "question_id": 53878632, "link": "https://stackoverflow.com/questions/53878632/undefined-reference-errors-for-openssl-for-a-haskell-repository/63279817#63279817", "title": "Undefined reference errors for openssl for a haskell repository", "body": "<p>This should help you in resolving the issue. If you would want to take your existing openssl's backup, make sure you do it before by using this command <code>sudo mv /usr/bin/openssl /usr/bin/openssl.backup</code></p>\n<p>Installing <code>openssl-1.1.1g</code> resolved those linker issues for me. Maybe bindings were expecting this version.</p>\n<pre><code>  $ sudo rm -rf /usr/bin/openssl /usr/share/man/man1/openssl.1ssl.gz\n  $ wget https://www.openssl.org/source/openssl-1.1.1g.tar.gz\n  $ tar -zxf openssl-1.1.1g.tar.gz &amp;&amp; cd openssl-1.1.1g\n  $ ./config\n  $ sudo apt install make gcc\n  $ make\n  $ make test\n  $ sudo make install\n  $ sudo ln -s /usr/local/bin/openssl /usr/bin/openssl\n  $ sudo ldconfig\n  $ cd ..\n  $ rm -rf openssl-1.1.1g*\n</code></pre>\n<p>If all the above steps worked successfully for you, you should be able to check the the version details using <code>$ openssl version -a</code></p>\n<blockquote>\n<p>OpenSSL 1.1.1g  21 Apr 2020\nbuilt on: Wed Aug  5 07:16:04 2020 UTC\nplatform: linux-x86_64\noptions:  bn(64,64) rc4(16x,int) des(int) idea(int) blowfish(ptr)\ncompiler: gcc -fPIC -pthread -m64 -Wa,--noexecstack -Wall -O3 -DOPENSSL_USE_NODELETE -DL_ENDIAN -DOPENSSL_PIC -DOPENSSL_CPUID_OBJ -DOPENSSL_IA32_SSE2 -DOPENSSL_BN_ASM_MONT -DOPENSSL_BN_ASM_MONT5 -DOPENSSL_BN_ASM_GF2m -DSHA1_ASM -DSHA256_ASM -DSHA512_ASM -DKECCAK1600_ASM -DRC4_ASM -DMD5_ASM -DAESNI_ASM -DVPAES_ASM -DGHASH_ASM -DECP_NISTZ256_ASM -DX25519_ASM -DPOLY1305_ASM -DNDEBUG\nOPENSSLDIR: &quot;/usr/local/ssl&quot;\nENGINESDIR: &quot;/usr/local/lib/engines-1.1&quot;\nSeeding source: os-specific</p>\n</blockquote>\n"}], "owner": {"reputation": 707, "user_id": 7868376, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4d92cc168903249d34560da543ef621f?s=128&d=identicon&r=PG&f=1", "display_name": "picotard", "link": "https://stackoverflow.com/users/7868376/picotard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1596703010, "creation_date": 1545361036, "question_id": 53878632, "link": "https://stackoverflow.com/questions/53878632/undefined-reference-errors-for-openssl-for-a-haskell-repository", "title": "Undefined reference errors for openssl for a haskell repository", "body": "<p>I'm completely new to Haskell. I'm trying to get <a href=\"https://github.com/wireapp/mls-server\" rel=\"nofollow noreferrer\">https://github.com/wireapp/mls-server</a> project to build. When I run <code>make build</code>, I get undefined reference errors:</p>\n\n<pre><code>Linking .stack-work/dist/x86_64-linux/Cabal-2.2.0.1/build/mls-server-test/mls-server-test ...\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Internal.o)(.text+0x69d): error: undefined reference to 'EVP_CIPHER_CTX_init'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Internal.o)(.text+0x7e5): error: undefined reference to 'EVP_CIPHER_CTX_init'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Internal.o)(.text+0x89d): error: undefined reference to 'EVP_CIPHER_CTX_init'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Internal.o)(.text+0x9e5): error: undefined reference to 'EVP_CIPHER_CTX_init'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Internal.o):HsOpenSSLzm0zi11zi4zi14zm1RUGvOiXKv4J8uIsPTtnnt_OpenSSLziEVPziInternal_digestLazzily3_info: error: undefined reference to 'EVP_MD_CTX_create'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Internal.o):HsOpenSSLzm0zi11zi4zi14zm1RUGvOiXKv4J8uIsPTtnnt_OpenSSLziEVPziInternal_digestLazzily3_info: error: undefined reference to 'EVP_MD_CTX_init'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Internal.o):HsOpenSSLzm0zi11zi4zi14zm1RUGvOiXKv4J8uIsPTtnnt_OpenSSLziEVPziInternal_digestLazzily3_info: error: undefined reference to 'EVP_MD_CTX_destroy'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Internal.o):HsOpenSSLzm0zi11zi4zi14zm1RUGvOiXKv4J8uIsPTtnnt_OpenSSLziEVPziInternal_digestLazzily3_info: error: undefined reference to 'EVP_MD_CTX_init'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Internal.o):HsOpenSSLzm0zi11zi4zi14zm1RUGvOiXKv4J8uIsPTtnnt_OpenSSLziEVPziInternal_digestLazzily3_info: error: undefined reference to 'EVP_MD_CTX_destroy'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Store.o):HsOpenSSLzm0zi11zi4zi14zm1RUGvOiXKv4J8uIsPTtnnt_OpenSSLziX509ziStore_getStoreCtxChain1_info: error: undefined reference to 'X509_STORE_CTX_get_chain'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Stack.o)(.text+0x33): error: undefined reference to 'sk_new_null'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Stack.o)(.text+0xcc): error: undefined reference to 'sk_push'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Stack.o)(.text+0x1a2): error: undefined reference to 'sk_free'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Stack.o)(.text+0x242): error: undefined reference to 'sk_free'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Stack.o)(.text+0x3a2): error: undefined reference to 'sk_free'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Stack.o)(.text+0x41a): error: undefined reference to 'sk_free'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Stack.o)(.text+0xa6b): error: undefined reference to 'sk_value'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Stack.o)(.text+0xb73): error: undefined reference to 'sk_value'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Stack.o):HsOpenSSLzm0zi11zi4zi14zm1RUGvOiXKv4J8uIsPTtnnt_OpenSSLziStack_zdwmapStack_info: error: undefined reference to 'sk_num'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(X509.o)(.text+0x1dcf): error: undefined reference to 'X509_set_notBefore'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(X509.o)(.text+0x20cf): error: undefined reference to 'X509_set_notAfter'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Revocation.o)(.text+0x225f): error: undefined reference to 'X509_CRL_set_lastUpdate'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(Revocation.o)(.text+0x255f): error: undefined reference to 'X509_CRL_set_nextUpdate'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_init: error: undefined reference to 'SSL_load_error_strings'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_init: error: undefined reference to 'OPENSSL_add_all_algorithms_noconf'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_HMAC_CTX_new: error: undefined reference to 'HMAC_CTX_init'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_HMAC_CTX_free: error: undefined reference to 'HMAC_CTX_cleanup'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_setupMutex: error: undefined reference to 'CRYPTO_num_locks'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_setupMutex: error: undefined reference to 'CRYPTO_num_locks'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_setupMutex: error: undefined reference to 'CRYPTO_set_locking_callback'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_setupMutex: error: undefined reference to 'CRYPTO_set_id_callback'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_setupMutex: error: undefined reference to 'CRYPTO_set_dynlock_create_callback'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_setupMutex: error: undefined reference to 'CRYPTO_set_dynlock_lock_callback'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_init: error: undefined reference to 'SSL_library_init'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_X509_ref: error: undefined reference to 'CRYPTO_add_lock'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_X509_CRL_ref: error: undefined reference to 'CRYPTO_add_lock'\n/home/euphoria/.stack/snapshots/x86_64-linux/lts-12.4/8.4.3/lib/x86_64-linux-ghc-8.4.3/HsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt/libHSHsOpenSSL-0.11.4.14-1RUGvOiXKv4J8uIsPTtnnt.a(HsOpenSSL.o):function HsOpenSSL_setupMutex: error: undefined reference to 'CRYPTO_set_dynlock_destroy_callback'\ncollect2: error: ld returned 1 exit status\n`gcc' failed in phase `Linker'. (Exit code: 1)\nProgress 1/2\n\n--  While building package mls-server-0.1.0 using:\n      /home/euphoria/.stack/setup-exe-cache/x86_64-linux/Cabal-simple_mPHDZzAJ_2.2.0.1_ghc-8.4.3 --builddir=.stack-work/dist/x86_64-linux/Cabal-2.2.0.1 build lib:mls-server exe:mls-server exe:mls-server-schema test:mls-server-test --ghc-options \" -ddump-hi -ddump-to-file -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure 1\nMakefile:8: recipe for target 'build' failed\nmake: *** [build] Error 1\n</code></pre>\n\n<p>I have tried downgrading openssl to 1.0.1g. I've tried updating it as well. Despite everything, I keep getting these errors. Not sure what's going wrong.</p>\n"}, {"tags": ["haskell", "pushdown-automaton"], "comments": [{"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1545348692, "post_id": 53877299, "comment_id": 94602161, "body": "Why not add some types and make it more general. Make it so the types force you to only be able to represent valid configurations or transitions. E.g <code>data Transition state letter symbol =  Trans (state, Maybe letter, symbol) (state,  [symbol])</code>"}, {"owner": {"reputation": 75, "user_id": 6051166, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e76ff91a8324c3de2991954a16980c4d?s=128&d=identicon&r=PG&f=1", "display_name": "Jambo", "link": "https://stackoverflow.com/users/6051166/jambo"}, "reply_to_user": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1545348834, "post_id": 53877299, "comment_id": 94602192, "body": "Isn&#39;t that what <code>type Transition = ((Int, String, String),(Int,String))</code> is for? Apologies, I&#39;m new to Haskell and PDA&#39;s."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 1, "creation_date": 1545349142, "post_id": 53877299, "comment_id": 94602252, "body": "The point is that if you write your function to be general then you are forced to not accidentally mix up stack symbols and word symbols. You are also forced to e.g. not have more than one letter on the LHS. Questions: is your automata meant to be deterministic? What do you intend by a <code>Transition</code> like <code>((a,b,&quot;&quot;),...)</code>? Does the empty string mean bottom of the stack?"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1545349372, "post_id": 53877299, "comment_id": 94602295, "body": "Your definition of <code>nextsteps</code> looks wrong. Specifically when you reach the end of the list of configurations, you will have a pattern matching error."}, {"owner": {"reputation": 75, "user_id": 6051166, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e76ff91a8324c3de2991954a16980c4d?s=128&d=identicon&r=PG&f=1", "display_name": "Jambo", "link": "https://stackoverflow.com/users/6051166/jambo"}, "reply_to_user": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1545349640, "post_id": 53877299, "comment_id": 94602350, "body": "The automata is non-deterministic, for the Transition <code>a = initial state, b = current input read by the automata (a,b) and c is the current state of the stack, while &quot;&quot; simply denotes an empty stack</code>. I dont get any pattern matching errors, it usually defaults to [(2,&quot;&quot;,&quot;&quot;)] or []. This changes though depending on wether I use <code>nextsteps (h : t) rules =  steps h rules ++ nextsteps t rules</code> or <code>nextsteps (h : t) rules =  steps h rules</code>"}], "owner": {"reputation": 75, "user_id": 6051166, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e76ff91a8324c3de2991954a16980c4d?s=128&d=identicon&r=PG&f=1", "display_name": "Jambo", "link": "https://stackoverflow.com/users/6051166/jambo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1608576443, "creation_date": 1545347675, "last_edit_date": 1545348127, "question_id": 53877299, "link": "https://stackoverflow.com/questions/53877299/applying-pda-transitions-over-a-list-of-input-strings-in-haskell", "title": "Applying PDA transitions over a list of input strings in haskell", "body": "<p>I'm trying to implement a PDA in Haskell based on my lecturer's notes, she has described the general process to us and left the actual function implementation up to us. I feel like I have the majority of it working bar one little bug in the <code>nextsteps</code> function.  </p>\n\n<p>The rules of the PDA are as follows:</p>\n\n<p><code>[((1,\"a\",\"\"),(1,\"a\")),((1,\"b\",\"\"),(1,\"b\")),((1,\"a\",\"\"),(2,\"\")),((1,\"b\",\"\"),(2,\"\")),((1,\"\",\"\"),(2,\"\")),((2,\"a\",\"a\"),(2,\"\")),((2,\"b\",\"b\"),(2,\"\"))]</code></p>\n\n<pre><code>    run :: PDA -&gt; String -&gt; Result\nrun _ \"\" = Reject\nrun (state,finalState,rules) str = findpath [(state,str,\"\"(state,finalState,rules) \ndata Result = Accept | Reject deriving Show\n\ntype PDA = (Int,[Int],[Transition])\n\n\n-- Takes in the start state, the current value read by the input string, the current stack and the new state along with the change to the stack\n-- ((1,\"a\",\"\"),(1,\"a\"))\ntype Transition = ((Int, String, String),(Int,String))\n\n-- contains the current state, current input string and current state of the stack\n--    (1,\"abba\",\"ba\")\ntype Configuration = (Int, String, String)\n\n--if the list of configurations isnt accepted, apply the PDA transitions to it and try again\nfindpath :: [Configuration] -&gt; PDA -&gt; Result\nfindpath [] pda = Reject \nfindpath (h:t) (a,b,c) = if accept (h:t) b == True then Accept else findpath (nextsteps (h:t) c) (a,b,c) \n\naccept' :: Configuration -&gt; [Int] -&gt; Bool\naccept' config [] = False\naccept' (x,y,z) [a] = if x == a  &amp;&amp; y == \"\" &amp;&amp; z == \"\" then True else False\n\naccept:: [Configuration] -&gt; [Int] -&gt; Bool\naccept [] _ = False\naccept _ [] = False\naccept (h:t) finalState = if accept' h finalState then True else accept t finalState\n\n\n-- apply a given transition to a configuration based on the values in the configuration and transition\nstep :: Configuration -&gt; Transition -&gt; [Configuration]\nstep (a,b,\"\")((d,\"\",\"\"),(g,\"\")) = if a == d then [(g,b,\"\")] else []\nstep (a,(b:bs),\"\")((d,\"\",\"\"),(g,h)) = if a == d then [(g,bs,[b])] else []\nstep (a,(b:bs),\"\") ((d,\"\",f),(g,\"\")) = if a == d then [(g,(b:bs),f)] else []   \nstep (a,(b:bs),\"\") ((d,\"\",f),(g,h)) = if a == d then [(g,(b:bs),h)] else []\nstep (a,(b:bs),\"\") ((d,[e],\"\"),(g,\"\")) = if a == d &amp;&amp; b == e then [(g,bs,\"\")] else []\nstep (a,(b:bs),\"\") ((d,[e],\"\"),(g,h)) = if a == d &amp;&amp; b == e then [(g,bs,[b])] else []\nstep (a,(b:bs),\"\") ((d,[e],f),(g,\"\")) = if a == d &amp;&amp; b == e then [(g,bs,\"\")] else []\nstep (a,(b:bs),\"\") ((d,[e],f),(g,h)) = if a == d &amp;&amp; b == e then  [] else []\nstep (a,b,c) ((d,\"\",\"\"),(g,\"\")) = if a == d then [(g,b,c)] else []\nstep (a,(b:bs),c) ((d,\"\",\"\"),(g,h))  = if a == d then  [(g,bs,c)] else []\nstep (a,b,(c:cs))((d,\"\",[f]),(g,\"\")) = if a == d &amp;&amp; c == f then [(g,b,cs)] else []\nstep (a,b,(c:cs)) ((d,\"\",[f]),(g,h)) = if a == d &amp;&amp; c == f then [(g,b,cs++h)] else []\nstep (a,(b:bs),c) ((d,[e],\"\"),(g,\"\")) = if a == d then [(g,bs,c)] else []\nstep (a,(b:bs),c) ((d,[e],\"\"),(g,h)) = if a == d &amp;&amp; b == e then [(g,bs,[b]++c)] else []\nstep (a,(b:bs),(c:cs)) ((d,[e],[f]),(g,\"\"))= if a == d &amp;&amp; b == e &amp;&amp; c == f then [(g,bs,cs)] else []\nstep (a,(b:bs),(c:cs)) ((d,[e],[f]),(g,h)) = if a == d &amp;&amp; b == e &amp;&amp; c == f then [(g,bs,cs++h)] else []\n\n-- apply the entire ruleset of the PDA over one configuration and return a list of the results\nsteps :: Configuration -&gt; [Transition] -&gt; [Configuration] \nsteps config [] = []\nsteps (a,b,c) (h:t) = if b /= \"\" then step (a,b,c) h ++ steps (a,b,c) t else []\n\n\n-- take in a list of configurations and apply the entire rulest over each configuration and return a list of results\nnextsteps :: [Configuration] -&gt; [Transition] -&gt; [Configuration]\nnextsteps config [] = []\nnextsteps (h : t) rules =  steps h rules ++ nextsteps t rules \n</code></pre>\n\n<p>The program works for certain strings and not others, I'm certain its to do with my nextsteps function. In my lecturer's notes she gives the example\n<code>nextsteps [(1,\"bbabba\",\"a\"),(2,\"abbabba\",\"\"),(2,\"bbabba\",\"\") rules = [(1,\"babba\",\"ba\"),(2,\"babba\",\"a\"),(2,\"bbabba\",\"a\")]</code></p>\n\n<p>However, when I call the function on the exact same inputs I get <code>[(1,\"babba\",\"ba\"),(2,\"babba\",\"a\"),(2,\"babba\",\"a\"),(2,\"bbabba\",\"a\")]</code>. </p>\n\n<p>I'm not sure where this extra duplicate value is coming from and is the main reason why strings that shouldn't be excepted are getting accepted. I have tried removing the tail of the configurations list and only applying the steps function to the head of the list, and that will make sure any list that shouldn't be accepted is <code>Rejected</code>, but also <code>Rejected</code> inputs that should be <code>Accepted</code>.</p>\n"}, {"tags": ["parsing", "haskell", "state", "monad-transformers", "megaparsec"], "comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 1, "creation_date": 1545341642, "post_id": 53876024, "comment_id": 94599969, "body": "In <code>letStarExpr</code>, you may need to create a new state instead of resetting the old state. The new state is a copy of the state at entrance to the &quot;let*&quot;"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1545341744, "post_id": 53876024, "comment_id": 94600009, "body": "A checkable code example and specifying the megaparsec version would help."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1545342705, "post_id": 53876024, "comment_id": 94600392, "body": "Consider parsing and evaluating in separate steps rather than trying to do evaluation at the same time you\u2019re doing parsing."}, {"owner": {"reputation": 629, "user_id": 4727280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38762034473fd7e48dcce03fc091e343?s=128&d=identicon&r=PG&f=1", "display_name": "fmg", "link": "https://stackoverflow.com/users/4727280/fmg"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1545345203, "post_id": 53876024, "comment_id": 94601225, "body": "@Andr&#225;sKov&#225;cs: Here is a gist with a runnable code sample, together with <code>package.yaml</code> and <code>stack.yaml</code>, for package versions, etc. In particular, I&#39;m using <code>megaparsec-7.0.4</code>. <a href=\"https://gist.github.com/mgreenbe/61d45a089ba3df0d02b2d7c05e738637\" rel=\"nofollow noreferrer\">gist.github.com/mgreenbe/61d45a089ba3df0d02b2d7c05e738637</a>"}, {"owner": {"reputation": 629, "user_id": 4727280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38762034473fd7e48dcce03fc091e343?s=128&d=identicon&r=PG&f=1", "display_name": "fmg", "link": "https://stackoverflow.com/users/4727280/fmg"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1545345311, "post_id": 53876024, "comment_id": 94601257, "body": "@AlexisKing: Splitting it up is definitely a good option. Still curious if it is idiomatically possible in one pass."}, {"owner": {"reputation": 629, "user_id": 4727280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38762034473fd7e48dcce03fc091e343?s=128&d=identicon&r=PG&f=1", "display_name": "fmg", "link": "https://stackoverflow.com/users/4727280/fmg"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1545345374, "post_id": 53876024, "comment_id": 94601279, "body": "@BobDalgleish: Could you, perhaps, say a few words about how to do that?"}], "answers": [{"comments": [{"owner": {"reputation": 629, "user_id": 4727280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38762034473fd7e48dcce03fc091e343?s=128&d=identicon&r=PG&f=1", "display_name": "fmg", "link": "https://stackoverflow.com/users/4727280/fmg"}, "edited": false, "score": 0, "creation_date": 1545413774, "post_id": 53877209, "comment_id": 94624263, "body": "Awesome. Thanks for shaving a monad transformer off of my stack!"}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 3, "last_activity_date": 1545389413, "last_edit_date": 1545389413, "creation_date": 1545346930, "answer_id": 53877209, "question_id": 53876024, "link": "https://stackoverflow.com/questions/53876024/parsing-with-haskell-megaparsec-statet-for-building-up-local-lexical-scope/53877209#53877209", "title": "Parsing with Haskell/Megaparsec: StateT for building up local, lexical scope?", "body": "<p>As Alexis King pointed out in comments, it is standard practice to separate parsing from evaluation.</p>\n\n<p>However, to address the current question, it is possible here to evaluate while parsing in an idiomatic way. The key point is the following: lexical scoping without any context-sensitive rules only ever requires a <code>Reader</code> monad, for scope/type checking and evaluation as well. The reason is in the \"lexical\" property: purely nested scopes have no side effects on other branches of scope structure, hence there should be nothing to be carried around in a state. So it's best to just get rid of the <code>State</code>. </p>\n\n<p>The interesting part is <code>letStarExpr</code>. There, we cannot use <code>many</code> anymore, because it doesn't allow us to handle the newly bound names on each key-value pair. Instead, we can write a custom version of <code>many</code> which uses <code>local</code> to bind a new name on each recursive step. In the code example I just inline this function using <code>fix</code>. </p>\n\n<p>Another note: <code>lift</code> should not be commonly used with <code>mtl</code>; the point of <code>mtl</code> is to eliminate most lifts. The <code>megaparsec</code> exports are already generalized over <code>MonadParsec</code>. Below is a code example with <code>megaparsec</code> 7.0.4, I did the mentioned changes and a few further stylistic ones.</p>\n\n<pre><code>import Control.Monad.Reader\nimport Data.Map as Map\nimport Data.Void\n\nimport Text.Megaparsec\nimport qualified Text.Megaparsec.Char as Char\nimport qualified Text.Megaparsec.Char.Lexer as Lexer\n\ntype Env    = Map String Double\ntype Parser = ReaderT Env (Parsec Void String)\n\nspaceConsumer :: Parser ()\nspaceConsumer = Lexer.space Char.space1\n                            (Lexer.skipLineComment \";\")\n                            (Lexer.skipBlockComment \"#|\" \"|#\")\n\nlexeme = Lexer.lexeme spaceConsumer\nsymbol = Lexer.symbol spaceConsumer\nchar   = lexeme . Char.char\n\nparens :: Parser a -&gt; Parser a\nparens = between (char '(') (char ')')\n\nnum :: Parser Double\nnum = lexeme $ Lexer.signed (pure ()) Lexer.float\n\nidentifier :: Parser String\nidentifier = try $ lexeme (some Char.letterChar)\n\nkeyValuePair :: Parser (String, Double)\nkeyValuePair = parens ((,) &lt;$&gt; identifier &lt;*&gt; num)\n\nexpr :: Parser Double\nexpr = num &lt;|&gt; var &lt;|&gt; parens (arithExpr &lt;|&gt; letStarExpr)\n\nvar :: Parser Double\nvar = do\n  env  &lt;- ask\n  name &lt;- identifier\n  maybe mzero pure (Map.lookup name env)\n\narithExpr :: Parser Double\narithExpr =\n      (((sum &lt;$ char '+') &lt;|&gt; (product &lt;$ char '*')) &lt;?&gt; \"operation\")\n  &lt;*&gt; many (expr &lt;?&gt; \"argument\")\n\nletStarExpr :: Parser Double\nletStarExpr = do\n  symbol \"let*\"\n  char '('\n  fix $ \\go -&gt;\n        (char ')' *&gt; expr)\n    &lt;|&gt; do {(x, n) &lt;- keyValuePair; local (insert x n) go}\n\nmain :: IO ()\nmain = do\n    parseTest (runReaderT expr (fromList [(\"x\", 1)]))\n              \"(+ (let* ((x 666.0)) x) x)\"\n    parseTest (runReaderT expr (fromList [(\"x\", 1)]))\n              \"(+ (let* ((x 666.0)) x) (let* ((w 0.0)) x))\"\n</code></pre>\n"}], "owner": {"reputation": 629, "user_id": 4727280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38762034473fd7e48dcce03fc091e343?s=128&d=identicon&r=PG&f=1", "display_name": "fmg", "link": "https://stackoverflow.com/users/4727280/fmg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 2, "accepted_answer_id": 53877209, "answer_count": 1, "score": 4, "last_activity_date": 1545389413, "creation_date": 1545339879, "question_id": 53876024, "link": "https://stackoverflow.com/questions/53876024/parsing-with-haskell-megaparsec-statet-for-building-up-local-lexical-scope", "title": "Parsing with Haskell/Megaparsec: StateT for building up local, lexical scope?", "body": "<p>So I'm trying to do the standard \"write yourself a parser for a scheme-like language\" exercise to figure out MegaParsec and monad transformers. Following the suggestions of many tutorials and blog posts, I'm using <code>ReaderT</code> and <code>local</code> to implement lexical scope.</p>\n\n<p>I run into trouble trying to implement <code>let*</code>. Both <code>let</code> and <code>let*</code> share the same syntax, binding variables for use in a subsequent expression. The difference between the two is that <code>let*</code> lets you use a binding in subsequent ones, whereas <code>let</code> doesn't:</p>\n\n<pre><code>(let ((x 1) (y 2)) (+ x y))       ; 3\n(let* ((x 1) (y (+ x x)) (+ x y)) ; 3\n(let ((x 1) (y (+ x x)) (+ x y))  ; Error unbound symbol \"x\"\n</code></pre>\n\n<p>My problem is that when parsing a <code>let*</code> expression, I need to add the bindings to the current scope one-by-one so that each binding is available for use in the subsequent ones. This seems like a good use case for <code>StateT</code>; allowing me to build up the local scope one binding at a time.\nThen, having parsed all the new bindings, I can pass these, together with those inherited from the parent scope, to the third argument of the <code>let*</code> expression, via <code>local</code>.</p>\n\n<p>I build my monad transformer stack as follows:</p>\n\n<pre><code>type Parser = Parsec Void String\ntype Env = Map.Map String Float\ntype RSParser = ReaderT Env (StateT Env Parser)\n</code></pre>\n\n<p>And here's the parser, simplified as much as I could while still making my point. In particular, <code>Float</code> is the only data type and <code>+</code>, <code>*</code>, and <code>let*</code> are the only commands.</p>\n\n<pre><code>data Op = Plus | Times\n\nspaceConsumer :: Parser ()\nspaceConsumer = Lexer.space space1\n                            (Lexer.skipLineComment \";\")\n                            (Lexer.skipBlockComment \"#|\" \"|#\")\nlexeme :: Parser a -&gt; RSParser a\nlexeme = lift . lift . Lexer.lexeme spaceConsumer\n\nlParen, rParen :: RSParser Char\nlParen = lexeme $ char '('\nrParen = lexeme $ char ')'\n\nplus, times :: RSParser Op\nplus = lexeme $ char '+' $&gt; Plus\ntimes = lexeme $ char '*' $&gt; Times\n\nkeyValuePair :: RSParser ()\nkeyValuePair = between lParen rParen $ do\n    state &lt;- get\n    name  &lt;- lift . lift $ Lexer.lexeme spaceConsumer (some letterChar)\n    x     &lt;- num\n    modify (union (fromList [(name, x)]))\n\nkeyValuePairs :: RSParser ()\nkeyValuePairs = between lParen rParen (many keyValuePair) $&gt; ()\n\nnum :: RSParser Float\nnum = lexeme $ Lexer.signed (return ()) Lexer.float\n\nexpr, var :: RSParser Float\nexpr = num &lt;|&gt; var &lt;|&gt; between lParen rParen (arithExpr &lt;|&gt; letStarExpr)\nvar = do\n    env &lt;- ask\n    lift . lift $ do\n        name &lt;- Lexer.lexeme spaceConsumer (some letterChar)\n        case Map.lookup name env of\n            Nothing -&gt; mzero\n            Just x  -&gt; return x\narithExpr = do\n    op   &lt;- (plus &lt;|&gt; times) &lt;?&gt; \"operation\"\n    args &lt;- many (expr &lt;?&gt; \"argument\")\n    return $ case op of\n        Plus  -&gt; sum args\n        Times -&gt; product args\nletStarExpr = lexeme (string \"let*\") *&gt; do\n    keyValuePairs\n    bindings &lt;- get\n    local (Map.union bindings) expr\n\nmain :: IO ()\nmain = do\n    parseTest (runStateT (runReaderT expr (fromList [(\"x\", 1)])) Map.empty)\n              \"(+ (let* ((x 666.0)) x) x)\"\n        -- (667.0,fromList [(\"x\",666.0)]) Ok\n    parseTest (runStateT (runReaderT expr (fromList [(\"x\", 1)])) Map.empty)\n              \"(+ (let* ((x 666.0)) x) (let* ((w 0.0)) x))\"\n        -- (1332.0,fromList [(\"x\",666.0)]) Wrong\n</code></pre>\n\n<p>The first test above succeeds, but the second fails. It fails because the mutable state holding <code>x</code>'s binding in the first <code>let*</code> expression is carried over to the second <code>let*</code> expression. <strong>I need a way to make the this mutable state <em>local</em> to the computation in question and this is what I can't figure out how to do.</strong> Is there an analogue of the <code>local</code> command from <code>Reader</code> for <code>State</code>? Am I using the wrong monad transformer stack? Is my approach fundamentally flawed?</p>\n\n<p>The naive (in retrospect) solution that I tried is resetting the mutable state at each <code>let*</code> expression by adding a <code>put Map.empty</code> statement to <code>letStarExpr</code>:</p>\n\n<pre><code>letStarExpr = lexeme (string \"let*\") *&gt; do\n    keyValuePairs\n    bindings &lt;- get\n    put Map.empty\n    local (Map.union bindings) expr\n</code></pre>\n\n<p>But this is incompatible with nested <code>let*</code> expressions:</p>\n\n<pre><code>parseTest (runStateT (runReaderT expr (fromList [(\"x\", 1)])) Map.empty)\n    (let* ( (x 666.0) (y (let* ((z 3.0)) z)) ) x)\n</code></pre>\n\n<p>gives 1.0 instead of 666.0.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1545339927, "post_id": 53876017, "comment_id": 94599245, "body": "Hint: use <code>sum</code>."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "edited": false, "score": 0, "creation_date": 1545341424, "post_id": 53876144, "comment_id": 94599900, "body": "I&#39;m laughing the answer is really small. but despite difficult for newbie. Thank you very much for your help"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1545348588, "post_id": 53876144, "comment_id": 94602133, "body": "Almost equally literal, but in a different sense, is <code>p n m = if m &lt;= n then 1 else sum [...]</code>."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 8, "last_activity_date": 1545340472, "creation_date": 1545340472, "answer_id": 53876144, "question_id": 53876017, "link": "https://stackoverflow.com/questions/53876017/how-to-solve-this-math-function-in-haskell/53876144#53876144", "title": "How to solve this math Function in Haskell?", "body": "<p>I would normally give a hint instead of a full solution, but since this question is mostly about syntax, and the translation is very close, almost literal, I'll just give it to you in full.</p>\n\n<p><a href=\"https://i.stack.imgur.com/YzuwP.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/YzuwP.png\" alt=\"math thing\"></a></p>\n\n<pre><code>p n m \n    | m &lt;= n    = 1\n    | otherwise = sum [ p n (m - i) | i &lt;- [1..n] ]\n</code></pre>\n\n<p>The bars distinguishing the different cases by conditions are called <em>guards</em>, and the bracket structure in the last line is known as a <em>list comprehension</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1545342696, "last_edit_date": 1545342696, "creation_date": 1545342011, "answer_id": 53876396, "question_id": 53876017, "link": "https://stackoverflow.com/questions/53876017/how-to-solve-this-math-function-in-haskell/53876396#53876396", "title": "How to solve this math Function in Haskell?", "body": "<p>luqui's answer gives the natural, straightforward translation of the math definition into Haskell code. As a specification, it is perfect: beautiful and obviously correct. As a teaching tool, it is perfect: easy to read, easy to understand, and no advanced features used. But as an <em>algorithm</em> it is a little unfortunate: the existence of many recursive calls that each do recomputation makes it very slow for large inputs. So in this answer I will give a taste of what a solution not intended for simplicity might look like.</p>\n\n<p>One observation of interest is that <code>P(2,-)</code> is the Fibonacci sequence, which has a well-known, beautiful, and efficient definition as an infinite list in Haskell:</p>\n\n<pre><code>fibs = 1:1:zipWith (+) fibs (tail fibs)\n</code></pre>\n\n<p>This recursively-defined list uses itself as a memoization table. One might ask whether there is a clean generalization of this trick to P with other first arguments than 2; the answer is yes. The basic idea is this: since <code>transpose</code> is the natural extension of <code>zip</code> to arbitrary arity, and <code>sum</code> is the natural extension of <code>(+)</code> to arbitrary arity, we can write:</p>\n\n<pre><code>import Data.List\n\ntransposeWith :: ([a] -&gt; b) -&gt; [[a]] -&gt; [b]\ntransposeWith f xss = map f (transpose xss)\n\ngenFib :: Int -&gt; [Integer]\ngenFib n = result where\n    result = replicate n 1 ++ transposeWith sum [drop i result | i &lt;- [0..n-1]]\n</code></pre>\n\n<p>This gives us an efficient way to compute <code>P(n,-)</code> for any <code>n</code>, using a list for memoization. If we wish to memoize even the <code>n</code> dimension, we can write:</p>\n\n<pre><code>p :: [[Integer]]\np = map genFib [1..]\n</code></pre>\n\n<p>How much faster is it? On my machine, computing <code>P(100, 130)</code> takes luqui's solution more than ten minutes (and appears to roughly double in time each time you add one to <code>m</code>), while my solution responds in under a second for even such a large input as <code>P(100, 10000)</code>.</p>\n"}], "owner": {"reputation": 109, "user_id": 10817559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f89bbca16e893e1a7ea764dd019863ce?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell", "link": "https://stackoverflow.com/users/10817559/haskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1545342696, "creation_date": 1545339831, "question_id": 53876017, "link": "https://stackoverflow.com/questions/53876017/how-to-solve-this-math-function-in-haskell", "title": "How to solve this math Function in Haskell?", "body": "<p>How can I solve this math Funcion with Haskell? \nCan anyone help me?</p>\n\n<p><a href=\"https://i.stack.imgur.com/2let6.png\" rel=\"nofollow noreferrer\">Rekursive math Function</a></p>\n\n<pre><code>myFunc n m = myFuncRec n m if m &lt;= n then 1\n                       else myFuncRec n(m - 1):[]\n</code></pre>\n\n<p>Do I need two recursion? because for this problem in java needs two or three loops. </p>\n"}, {"tags": ["haskell", "process"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1545325984, "post_id": 53873161, "comment_id": 94593611, "body": "<code>System.Process.Typed</code> has a <code>createPipe</code> method which returns a streamspec, maybe you should be using that instead of <code>System.Process</code>&#39;s version.  There is an example close to what you are doing in the <a href=\"https://github.com/fpco/typed-process/blob/master/README.md#interacting-with-a-process\" rel=\"nofollow noreferrer\"><code>README.md</code></a> of <code>typed-process</code>."}, {"owner": {"reputation": 191, "user_id": 1582379, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ffb4652fe7745dec548d1c37ec94a8c?s=128&d=identicon&r=PG", "display_name": "Geekingfrog", "link": "https://stackoverflow.com/users/1582379/geekingfrog"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1551187582, "post_id": 53873161, "comment_id": 96542101, "body": "It seems it&#39;s only about communication between the parent and the child, but it doesn&#39;t handle communications directly between children."}], "owner": {"reputation": 191, "user_id": 1582379, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ffb4652fe7745dec548d1c37ec94a8c?s=128&d=identicon&r=PG", "display_name": "Geekingfrog", "link": "https://stackoverflow.com/users/1582379/geekingfrog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1545325616, "creation_date": 1545325616, "question_id": 53873161, "link": "https://stackoverflow.com/questions/53873161/racy-behavior-when-piping-two-subprocesses", "title": "Racy behavior when piping two subprocesses", "body": "<p>I have racy behavior with the following code</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Main where\n\nimport Control.Concurrent (threadDelay)\nimport qualified Control.Concurrent.Async      as Async\nimport qualified System.Process.Typed          as Proc\nimport qualified System.Process                as P\nimport qualified GHC.IO.Handle                 as H\n\nmain :: IO ()\nmain = do\n  print \"starting\"\n\n  (readEnd, writeEnd) &lt;- P.createPipe\n\n  let p1 = Proc.setStdout (Proc.useHandleClose writeEnd) \"echo -n 'foo'\"\n  let p2 = Proc.setStdin (Proc.useHandleClose readEnd) \"base64 -\"\n\n  Async.concurrently\n    (threadDelay 1000 *&gt; Proc.runProcess_ p2) -- with the delay, it works\n    -- (Proc.runProcess_ p2) -- that line will make the program hang forever\n    (Proc.runProcess_ p1)\n\n  print \"done\"\n</code></pre>\n\n<p>I want to pipe stdout from the first subprocess to the second subprocess.\nI tried using <code>getStdout</code> and <code>setStdin</code> but get into problem with the typechecker:</p>\n\n<pre><code>Proc.withProcess_ \"echo -n foo\" $ \\r1 -&gt; do\n  let p2 = Proc.setStdin (Proc.getStdout r1) \"base64\"\n\n\n  \u2022 Couldn't match expected type \u2018Proc.StreamSpec\n                                    'Proc.STInput stdin0\u2019\n                with actual type \u2018()\u2019\n  \u2022 In the first argument of \u2018Proc.setStdin\u2019, namely\n      \u2018(Proc.getStdout r1)\u2019\n    In the expression: Proc.setStdin (Proc.getStdout r1) \"base64\"\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1545324976, "post_id": 53872683, "comment_id": 94593121, "body": "What is the type of <code>f</code>?"}, {"owner": {"reputation": 21, "user_id": 10683523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ALdOAg1Uvu0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gXANU_xmNaDZPgjm9zVxHMX2YXRQ/mo/photo.jpg?sz=128", "display_name": "zhong zheng", "link": "https://stackoverflow.com/users/10683523/zhong-zheng"}, "reply_to_user": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1545325352, "post_id": 53872683, "comment_id": 94593323, "body": "@pat I felt confused, the code is just my thought."}, {"owner": {"reputation": 21, "user_id": 10683523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ALdOAg1Uvu0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gXANU_xmNaDZPgjm9zVxHMX2YXRQ/mo/photo.jpg?sz=128", "display_name": "zhong zheng", "link": "https://stackoverflow.com/users/10683523/zhong-zheng"}, "reply_to_user": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1545325481, "post_id": 53872683, "comment_id": 94593372, "body": "@pat I want the last accumulator becomes the Int. The median acc might contains operators like + or -"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1545327784, "post_id": 53872683, "comment_id": 94594444, "body": "Your types are wrong. What&#39;s your actual question?"}, {"owner": {"reputation": 21, "user_id": 10683523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ALdOAg1Uvu0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gXANU_xmNaDZPgjm9zVxHMX2YXRQ/mo/photo.jpg?sz=128", "display_name": "zhong zheng", "link": "https://stackoverflow.com/users/10683523/zhong-zheng"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1545327991, "post_id": 53872683, "comment_id": 94594521, "body": "@AJFarmar evaluate string to int . example: \u201c1+2\u201d -&gt; 3"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1545328706, "post_id": 53872683, "comment_id": 94594856, "body": "@zhengzhong that is not a question, that is an instruction. Please ask a question. We&#39;re not going to write your code for you."}, {"owner": {"reputation": 21, "user_id": 10683523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ALdOAg1Uvu0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gXANU_xmNaDZPgjm9zVxHMX2YXRQ/mo/photo.jpg?sz=128", "display_name": "zhong zheng", "link": "https://stackoverflow.com/users/10683523/zhong-zheng"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1545330018, "post_id": 53872683, "comment_id": 94595377, "body": "@AJFarmar the type of f is wrong, but how do i change that, I want the output of f is type of Int."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1545333078, "post_id": 53872683, "comment_id": 94596650, "body": "@zhengzhong Writing <code>0</code> produces a different type to other results of <code>f</code>; change it."}, {"owner": {"reputation": 21, "user_id": 10683523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ALdOAg1Uvu0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gXANU_xmNaDZPgjm9zVxHMX2YXRQ/mo/photo.jpg?sz=128", "display_name": "zhong zheng", "link": "https://stackoverflow.com/users/10683523/zhong-zheng"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1545333676, "post_id": 53872683, "comment_id": 94596866, "body": "@AJFarmar which 0? if you said the type of f should be fixed, how do I deal with the operator which makes accumulator to be a function."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1545335674, "post_id": 53872683, "comment_id": 94597648, "body": "Your <code>x == &quot; &quot;</code> and <code>otherwise</code> lines return values of type <code>Int</code>, but the <code>x == &quot;+&quot;</code> and <code>x == &quot;-&quot;</code> lines return <code>(+) acc</code> and <code>(-) acc</code>, which are both of type <code>Num a =&gt; a -&gt; a</code>. You need to change your code so that all four lines return the same type."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10683523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ALdOAg1Uvu0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gXANU_xmNaDZPgjm9zVxHMX2YXRQ/mo/photo.jpg?sz=128", "display_name": "zhong zheng", "link": "https://stackoverflow.com/users/10683523/zhong-zheng"}, "edited": false, "score": 0, "creation_date": 1545337745, "post_id": 53875577, "comment_id": 94598412, "body": "Thank you very much, i will look at that."}], "tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": true, "score": 0, "last_activity_date": 1545337602, "creation_date": 1545337602, "answer_id": 53875577, "question_id": 53872683, "link": "https://stackoverflow.com/questions/53872683/haskell-evalute-string-containing-a-simple-arithmetic-expression-to-int/53875577#53875577", "title": "Haskell: Evalute String containing a simple arithmetic expression to Int", "body": "<p>Your issue is that the result type of <code>f</code> is different in different branches, which is not allowed. In the first two it is (e.g.) <code>Int -&gt; Int</code>, the type of <code>(+) 3</code> (which is the same as <code>\\x -&gt; 3 + x</code>. The type of the third and fourth lines is just <code>Int</code>. These types are not the same.</p>\n\n<p>Here is a simple solution.</p>\n\n<pre><code>data Token = Plus | Minus | Num Int \nlex [] = Nothing\nlex ('+':s) = Just (Plus,s)\nlex ('-':s) = Just (Minus,s)\nlex (num:s) | isDigit num = Just (Num k,rest) where\n  numstr a (d:s) | isDigit d = numstr (digitVal d:a) s\n  numstr a r = a,r\n  digits,rest = numstr [digitVal num] s\n  k = foldr 0 (\\acc d -&gt; acc*10 + d) digits\n\nparse s = case lex s of\n  Nothing -&gt; []\n  Just (x,s') -&gt; x:parse s'\n\neval (Num n:r) = eval (Plus:Num n:r)\neval = eval' 0 where\n  eval' acc (Plus:Num n:r) = eval' (acc+n) r\n  eval' acc (Minus:Num n:r) = eval' (acc-n) r\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10683523, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ALdOAg1Uvu0/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-gXANU_xmNaDZPgjm9zVxHMX2YXRQ/mo/photo.jpg?sz=128", "display_name": "zhong zheng", "link": "https://stackoverflow.com/users/10683523/zhong-zheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 53875577, "answer_count": 1, "score": -1, "last_activity_date": 1545337602, "creation_date": 1545323728, "last_edit_date": 1545324127, "question_id": 53872683, "link": "https://stackoverflow.com/questions/53872683/haskell-evalute-string-containing-a-simple-arithmetic-expression-to-int", "title": "Haskell: Evalute String containing a simple arithmetic expression to Int", "body": "<p>I am learning Haskell, and I encounter a tricky problem which is evaluating String containing a simple arithmetic expression like (+) and (-) to int. \nTake some for example:\n\"1+2+3\" -> 6 , \" \" -> 0 .\nI am trying to type the code. However, I cannot complete that. The following is my code.</p>\n\n<pre><code>evalExpr xs  = foldl f 0 xs where\n f acc x | x == \"+\" =  (+) acc\n         | x == \"-\" =  (-) acc\n         | x == \" \" = 0\n         | otherwise = read x ::Int\n* In the expression: read x :: Int\n  In an equation for `f':\n      f acc x\n        | x == \"+\" = (+) acc\n        | x == \"-\" = (-) acc\n        | x == \" \" = 0\n        | otherwise = read x :: Int\n  In an equation for `evalExpr':\n      evalExpr xs\n        = foldl f 0 xs\n        where\n            f acc x\n              | x == \"+\" = (+) acc\n              | x == \"-\" = (-) acc\n              | x == \" \" = 0\n              | otherwise = read x :: Int\n* Relevant bindings include\n    acc :: a1 (bound at A2.hs:24:8)\n    f :: a1 -&gt; [Char] -&gt; a1 -&gt; a1 (bound at A2.hs:24:6)\n</code></pre>\n\n<p>Could someone help me? Thank you!</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1545321398, "post_id": 53871886, "comment_id": 94591266, "body": "Have you tried using <a href=\"https://kseo.github.io/posts/2017-01-08-visible-type-application-ghc8.html\" rel=\"nofollow noreferrer\"><code>TypeApplications</code></a>?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1545321600, "post_id": 53871886, "comment_id": 94591375, "body": "@AJFarmar What, if any, is the syntax for a partial application of a type constructor? <code>:t (&lt;*&gt;) @Maybe</code> works, but things like <code>Either a</code> or <code>((-&gt;) r</code> contain undefined type variables."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1545322058, "post_id": 53871886, "comment_id": 94591625, "body": "@chepner You can use holes for that. <code>(&lt;*&gt;) @(Either _)</code>, <code>(&lt;*&gt;) @((-&gt;) _)</code>. What if you want two holes that are the same type? For that one I&#39;m not sure..."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1545322634, "post_id": 53871886, "comment_id": 94591927, "body": "Is there a version of Haskell that supports named type holes, or am I thinking of Idris (or maybe Agda)?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1545323372, "post_id": 53871886, "comment_id": 94592294, "body": "@chepner I don&#39;t know of such a thing for Haskell, so I suspect you&#39;re thinking of another language."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1545323382, "post_id": 53871886, "comment_id": 94592300, "body": "@chepner That sounds like agda to me."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1545323852, "post_id": 53871886, "comment_id": 94592542, "body": "I have a cunning plan for emulating named type holes in GHC. Imagine I want to ask <code>:t id @(a -&gt; a)</code>. I make a new type alias, <code>type Tmp a = a -&gt; a</code>. Then I ask <code>:t id @(Tmp _)</code>. This works (and is generalizable to other named-type-hole situations), but the result has <code>Tmp</code> applications un-expanded, which is a bit unfortunate..."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 8, "last_activity_date": 1545322521, "last_edit_date": 1545322521, "creation_date": 1545321845, "answer_id": 53872161, "question_id": 53871886, "link": "https://stackoverflow.com/questions/53871886/can-ghci-perform-substitutions-in-type-expr-commands/53872161#53872161", "title": "Can GHCi perform substitutions in `:type &lt;expr&gt;` commands?", "body": "<p>Yes, there are a few ways. Many operations make their type variables a part of their API, and you can observe this by turning on the right options and asking in the right way.</p>\n\n<pre><code>&gt; :set -fprint-explicit-foralls \n&gt; :t +v (&lt;*&gt;)\n(&lt;*&gt;)\n  :: forall (f :: * -&gt; *).\n     Applicative f =&gt;\n     forall a b. f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>This actually doesn't look that special, but says something important: because the <code>forall</code>d type variables are not enclosed in braces, they can be the subject of type applications. (But you should trust the \"braces\"/\"not braces\" distinction <em>only</em> in <code>:t +v</code> queries! Normal <code>:t</code> munges type-application-availableness in a brittle way that may change from GHC version to GHC version.)</p>\n\n<pre><code>&gt; :set -XTypeApplications\n&gt; :t (&lt;*&gt;) @((-&gt;) _)\n(&lt;*&gt;) @((-&gt;) _)\n  :: forall {w} {a} {b}. (w -&gt; a -&gt; b) -&gt; (w -&gt; a) -&gt; w -&gt; b\n</code></pre>\n\n<p>Sometimes you will find a term where you cannot use type applications in this way. For example:</p>\n\n<pre><code>&gt; :t +v \\f x -&gt; f &lt;*&gt; x\n\\f x -&gt; f &lt;*&gt; x\n  :: forall {f :: * -&gt; *} {a} {b}.\n     Applicative f =&gt;\n     f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>Here the braces indicate that there are no types available for type application. Are we out of luck? No, we can still use type holes to fill in only the parts we care about and ask GHC about the rest.</p>\n\n<pre><code>&gt; :set -XPartialTypeSignatures\n&gt; :set -Wno-partial-type-signatures\n&gt; :t (\\f x -&gt; f &lt;*&gt; x) :: ((_ -&gt; _) -&gt; _)\n(\\f x -&gt; f &lt;*&gt; x) :: ((_ -&gt; _) -&gt; _)\n  :: forall {w} {a} {b}. (w -&gt; a -&gt; b) -&gt; (w -&gt; a) -&gt; w -&gt; b\n</code></pre>\n"}], "owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 53872161, "answer_count": 1, "score": 2, "last_activity_date": 1545322521, "creation_date": 1545320824, "question_id": 53871886, "link": "https://stackoverflow.com/questions/53871886/can-ghci-perform-substitutions-in-type-expr-commands", "title": "Can GHCi perform substitutions in `:type &lt;expr&gt;` commands?", "body": "<p>GHCi has <code>:type &lt;expr&gt;</code> to show the type of an expression:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Prelude&gt; :t (&lt;*&gt;)\n(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>Can GHCi show the result after a substitution of any of the type variables? For example, let <code>f = ((-&gt;) c)</code>, then </p>\n\n<pre class=\"lang-none prettyprint-override\"><code>:t (&lt;*&gt;) ::  ((-&gt;) c) (a-&gt;b) -&gt; ((-&gt;) c) a -&gt; ((-&gt;) c) b\n(&lt;*&gt;) ::  ((-&gt;) c) (a-&gt;b) -&gt; ((-&gt;) c) a -&gt; ((-&gt;) c) b\n  :: (c -&gt; a -&gt; b) -&gt; (c -&gt; a) -&gt; c -&gt; b\n</code></pre>\n\n<p>Is there a way to let GHCi work out these substitutions?</p>\n"}, {"tags": ["haskell", "sqlite", "hdbc"], "answers": [{"tags": [], "owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "is_accepted": true, "score": 0, "last_activity_date": 1545408162, "creation_date": 1545408162, "answer_id": 53887717, "question_id": 53871402, "link": "https://stackoverflow.com/questions/53871402/haskell-hdbc-sqlite3-how-to-add-a-column-if-it-doesnt-exist-already/53887717#53887717", "title": "Haskell, HDBC.Sqlite3 - How to add a column if it doesn&#39;t exist already?", "body": "<p>I was able to solve the problem.</p>\n\n<p>First use <code>describeTable</code> function from HDBC package. The function will return column names and type. If you just need the names like I did, this is what you can do</p>\n\n<pre><code>getColumnsInTable :: conn -&gt; String -&gt; IO [String]\ngetColumnsInTable conn tableName = do\n  d &lt;- describeTable conn tableName\n  return $ fst &lt;$&gt; d\n</code></pre>\n\n<p>The return will have all the columns' names.</p>\n\n<p>Scan through the list to see if it contains all the columns you wish. If it doesn't use a function like the following to alter the table, i.e. add a new column with <code>INT</code> type.</p>\n\n<pre><code>createNewColumn conn columnName = do\n  let stmt = \"ALTER TABLE FantasyBooks ADD COLUMN \" ++ columnName ++ \" INT;\"\n  run conn stmt []\n</code></pre>\n"}], "owner": {"reputation": 798, "user_id": 9235239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8579e6ebaa62c34792078b38f18e2866?s=128&d=identicon&r=PG&f=1", "display_name": "atis", "link": "https://stackoverflow.com/users/9235239/atis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 53887717, "answer_count": 1, "score": 0, "last_activity_date": 1545408162, "creation_date": 1545319055, "last_edit_date": 1545322428, "question_id": 53871402, "link": "https://stackoverflow.com/questions/53871402/haskell-hdbc-sqlite3-how-to-add-a-column-if-it-doesnt-exist-already", "title": "Haskell, HDBC.Sqlite3 - How to add a column if it doesn&#39;t exist already?", "body": "<p>I have a function that given an <code>Int</code> returns a list of lists of Strings.</p>\n\n<p><code>fetchParts :: Int -&gt; [[String]]</code></p>\n\n<p>This is what the output looks like</p>\n\n<p><code>[[\"title\", \"some title\"], [\"rate\", \"2.4\"], [\"dist\", \"some string\"], [\"tr\", \"1\"], [\"td, \"2\"] ..]]</code></p>\n\n<p>The length of the output can be variable. Only the first 3 lists can be present 100% of the time.</p>\n\n<p>The later part of the list can be</p>\n\n<p><code>[\"a\", \"1\"], [\"b\", \"2\"] ..</code></p>\n\n<p>or</p>\n\n<p><code>[\"some\", \"1\"], [\"part\", \"2\"], [\"of\", \"3\"] ..]</code></p>\n\n<p>or</p>\n\n<p><code>[\"ex1\", \"a\"], [\"ex2\", \"b\"], ..]</code></p>\n\n<p>or some other combination of strings.</p>\n\n<p>And I want to add this output to a sqlite3 database file. I'm using <a href=\"https://www.stackage.org/lts-12.24/package/HDBC-2.4.0.2\" rel=\"nofollow noreferrer\">HDBC</a> and <a href=\"https://www.stackage.org/package/HDBC-sqlite3\" rel=\"nofollow noreferrer\">HDBC.Sqlite3</a> for this.</p>\n\n<p>To add something to a database file I'm running functions like these</p>\n\n<pre><code>  initialConnection &lt;- connectSqlite3 \"src/parts.db\"\n  run initialConnection partsEntry []\n  commit initialConnection\n  disconnect initialConnection\n</code></pre>\n\n<p>where <code>partsEntry</code> is a simple SQL String like this</p>\n\n<p><code>partsEntry = \"INSERT INTO PARTSDATA ( title, rate, dist, ...) VALUES ( \"some title\", \"2.4\", \"some string\", ...)</code></p>\n\n<p>where</p>\n\n<p><code>( title, rate, dist, ...)</code> are from <code>head &lt;$&gt; fetchParts 1</code></p>\n\n<p>and</p>\n\n<p><code>(\"some title\", \"2.4\", \"some string\" ...)</code> are from <code>last &lt;$&gt; fetchParts 1</code></p>\n\n<p>The problem is say if <code>\"some\"</code> column doesn't exists, code will throw errors.</p>\n\n<p>What I want to do is something like this</p>\n\n<ul>\n<li>if column <code>\"abc\"</code> doesn't exists, add column <code>\"abc\"</code> and insert\n<code>\"this\"</code> value at the current row </li>\n<li>if column <code>\"abc\"</code> exists, just insert <code>\"this\"</code> value at the current row</li>\n</ul>\n\n<p>But I'm not sure how to go about doing that.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1545315567, "post_id": 53870097, "comment_id": 94587928, "body": "You want your C code to call a Haskell function?  I haven&#39;t used inline-c before and had thought it was only for calling <i>out</i> to C and not back.  Ignoring that, have you already <code>foreign export</code>ed your <code>reverseIO</code> function?  When GHC compiles Haskell the functions do not directly translate to symbols so without a foreign export there will be no <code>reverseIO</code> symbol at link time or prototype for compiling."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1545315605, "post_id": 53870097, "comment_id": 94587950, "body": "I&#39;m not familiar with inline-c but <code>String</code> is not <code>char *</code>. Perhaps you need to use bytestrings, which seem to be supported by inline-c. Beware that passing (byte)strings may require to deal with C-level allocation."}, {"owner": {"reputation": 639, "user_id": 10654293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N3y4b1ilweA/AAAAAAAAAAI/AAAAAAAAAAQ/nO5VTzQiUu0/photo.jpg?sz=128", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/10654293/mcbear-holden"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1545316048, "post_id": 53870097, "comment_id": 94588207, "body": "@ThomasM.DuBuisson Yes I use inline-c to call a GUI library(Dear imgui) only.  The rest of the stuff I&#39;d like to do in Haskell and call those Haskell functions in C.  Regarding Foreign export as you have mentioned, I didn&#39;t see this in the fpcomplete tutorial: <a href=\"https://www.fpcomplete.com/blog/2015/05/inline-c\" rel=\"nofollow noreferrer\">fpcomplete.com/blog/2015/05/inline-c</a> . But let me dig deeper in this direction. Thanks"}, {"owner": {"reputation": 639, "user_id": 10654293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N3y4b1ilweA/AAAAAAAAAAI/AAAAAAAAAAQ/nO5VTzQiUu0/photo.jpg?sz=128", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/10654293/mcbear-holden"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1545316124, "post_id": 53870097, "comment_id": 94588248, "body": "@chi Good point, I&#39;ve switched to BS."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1545410963, "post_id": 53877271, "comment_id": 94623173, "body": "Would you mind adding some minimal working code for <code>pageturnerui.cpp</code>?  This answer could be very valuable to people getting started with inline-c-cpp."}, {"owner": {"reputation": 639, "user_id": 10654293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N3y4b1ilweA/AAAAAAAAAAI/AAAAAAAAAAQ/nO5VTzQiUu0/photo.jpg?sz=128", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/10654293/mcbear-holden"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1545416397, "post_id": 53877271, "comment_id": 94625171, "body": "@luqui Done. Hope this is useful."}], "tags": [], "owner": {"reputation": 639, "user_id": 10654293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N3y4b1ilweA/AAAAAAAAAAI/AAAAAAAAAAQ/nO5VTzQiUu0/photo.jpg?sz=128", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/10654293/mcbear-holden"}, "is_accepted": true, "score": 2, "last_activity_date": 1545416377, "last_edit_date": 1545416377, "creation_date": 1545347483, "answer_id": 53877271, "question_id": 53870097, "link": "https://stackoverflow.com/questions/53870097/haskell-inline-c-cpp-call-haskell-function/53877271#53877271", "title": "Haskell inline-c-cpp call Haskell function", "body": "<p>Finally got it working:</p>\n\n<pre><code>import           Data.Monoid           ((&lt;&gt;))\nimport           Foreign.C.String\nimport qualified Language.C.Inline.Cpp as C\n\nC.context (C.cppCtx &lt;&gt; C.baseCtx  &lt;&gt;C.funCtx)\n\nC.include \"pageturnerui.cpp\"\n\nsomeFunc :: IO ()\nsomeFunc = do\n  let reverseIO :: CString -&gt; IO CString\n      reverseIO cs = peekCString cs &gt;&gt;= return. reverse &gt;&gt;= newCString\n\n  [C.block| void {\n      pageturnerui($fun:(char* (*reverseIO)(char *)));\n                         } |]\n</code></pre>\n\n<p>In my pageturnerui.cpp:</p>\n\n<pre><code>int pageturnerui(char* (*foo)(char*))\n{\n...\n            static char strTest[128] = \"Hello, Haskell!\";\n\n            if (ImGui::Button(\"Button\")) {\n              strcpy(strTest, foo(strTest));\n            }\n...\n}\n</code></pre>\n\n<p>PS: My code doesn't illustrate the best practice. I'm not experienced enough to be able to provide advice on that. Just showing that it compiles and works and didn't crash.</p>\n"}], "owner": {"reputation": 639, "user_id": 10654293, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-N3y4b1ilweA/AAAAAAAAAAI/AAAAAAAAAAQ/nO5VTzQiUu0/photo.jpg?sz=128", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/10654293/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 1, "accepted_answer_id": 53877271, "answer_count": 1, "score": 2, "last_activity_date": 1545416377, "creation_date": 1545314178, "last_edit_date": 1545416247, "question_id": 53870097, "link": "https://stackoverflow.com/questions/53870097/haskell-inline-c-cpp-call-haskell-function", "title": "Haskell inline-c-cpp call Haskell function", "body": "<p>I am using inline-c-cpp in a small example to reverse a String:</p>\n\n<pre><code>[C.block| void {\n        static char strTest[128] = \"Hello, Haskell!\";\n        c_func();\n  } |]\n</code></pre>\n\n<p>The Haskell code are:</p>\n\n<pre><code>reverseIO :: BS.ByteString -&gt; IO BS.ByteString\nreverseIO str = return $ BS.reverse str\n</code></pre>\n\n<p><code>c_func()</code> is defined in another c file that I included by <code>C.include \"test.c\"</code>\nIn that <code>test.c</code> I call         </p>\n\n<pre><code>$fun:(char * (*reverseIO)(char * ))(strTest)\n</code></pre>\n\n<p>I get several errors:</p>\n\n<pre><code> error: use of undeclared identifier 'reverseIO'\n              $fun:(char (*reverseIO)(char * ))(strTest)\n                           ^\n</code></pre>\n\n<p>Could anyone help me get this right?</p>\n\n<p>Update:\nI finally got it working with proper C function pointer syntax.</p>\n\n<pre><code>  [C.block| void {\n           c_func($fun:(char* (*reverseIO)(char*)));\n                         } |]\n</code></pre>\n\n<p>But still I have the type problem:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018BS.ByteString\u2019 with \u2018GHC.Ptr.Ptr CChar\u2019\n  Expected type: GHC.Ptr.Ptr CChar -&gt; IO (GHC.Ptr.Ptr CChar)\n    Actual type: BS.ByteString -&gt; IO BS.ByteString\n</code></pre>\n"}, {"tags": ["haskell", "constraints"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1545314306, "post_id": 53869557, "comment_id": 94587210, "body": "What&#39;s the error message you&#39;re getting?"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1545384068, "post_id": 53869557, "comment_id": 94610778, "body": "oops, added the error message"}], "answers": [{"comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1545315540, "post_id": 53870200, "comment_id": 94587907, "body": "Wait, but if defining such constraint as <code>Ctx2 (And a b) m = ...</code> is legal, then why doesn&#39;t the OP&#39;s original attempt work?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1545316361, "post_id": 53870200, "comment_id": 94588391, "body": "@FyodorSoikin Ah, right, thank you! I forgot to eta-contract. Should be fixed now. The whole point is to avoid mentioning the <code>m</code>, on both sides."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1545384600, "post_id": 53870200, "comment_id": 94611037, "body": "Ah, I had tried a variant of the first version on my own, but could not make it work for the same reason :)) Thank you for the excellent perspective and comment on kinds"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1545316205, "last_edit_date": 1545316205, "creation_date": 1545314582, "answer_id": 53870200, "question_id": 53869557, "link": "https://stackoverflow.com/questions/53869557/tupling-of-indexed-constraints-in-haskell/53870200#53870200", "title": "Tupling of indexed constraints in haskell", "body": "<p>You probably need to use a named class, i.e., something like</p>\n\n<pre><code>instance (Paramed a, Paramed b) =&gt; Paramed (And a b) where\n   type Cxt0 (And a b) = (Cxt0 a, Cxt0 b) -- OK\n   type Cxt2 (And a b) = C a b\n\nclass (Cxt2 a m, Cxt2 b m) =&gt; C a b (m :: * -&gt; *) where\ninstance (Cxt2 a m, Cxt2 b m) =&gt; C a b m where\n</code></pre>\n\n<p>turning on undecidable instances. (You can use another name than <code>C</code>, of course)</p>\n\n<p>In Haskell, the kind <code>* -&gt; *</code> is not inhabited by lambdas like <code>\\ t -&gt; [t]</code>, since there are no type level lambdas. We need to declare a named type (using <code>data</code> or <code>newtype</code>) and use that to inhabit <code>* -&gt; *</code>.</p>\n\n<p>The kind <code>* -&gt; Constraint</code> is similar: you need a named class.\nDitto for <code>(* -&gt; *) -&gt; Constraint</code> or any other <code>... -&gt; Constraint</code> kind.</p>\n\n<p>If I remember correctly, using a named type / class is needed to make type inference possible.</p>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 53870200, "answer_count": 1, "score": 0, "last_activity_date": 1545384035, "creation_date": 1545311952, "last_edit_date": 1545384035, "question_id": 53869557, "link": "https://stackoverflow.com/questions/53869557/tupling-of-indexed-constraints-in-haskell", "title": "Tupling of indexed constraints in haskell", "body": "<p>Is it possible to do a pointwise tupling of indexed constraints in Haskell ?</p>\n\n<pre><code>{-# LANGUAGE KindSignatures           #-}\n{-# LANGUAGE RankNTypes           #-}\n{-# LANGUAGE DataKinds        #-}\n{-# LANGUAGE MultiParamTypeClasses        #-}\n{-# LANGUAGE GADTs        #-}\n{-# LANGUAGE TypeApplications        #-}\n{-# LANGUAGE TypeFamilies        #-}\n{-# LANGUAGE TypeOperators        #-}\n{-# LANGUAGE ConstraintKinds        #-}\n\n\nimport Data.Kind\n\n\nclass Paramed t where\n   type Cxt0 t :: Constraint\n   type Cxt2 t :: (* -&gt; *) -&gt; Constraint\n\ndata And a b\n\ninstance (Paramed a, Paramed b) =&gt; Paramed (And a b) where\n   type Cxt0 (And a b) = (Cxt0 a, Cxt0 b) -- OK\n   --type Cxt2 (And a b) = (\\@m -&gt; ((Cxt2 a m, Cxt2 b m))) -- does not work\n   type Cxt2 (And a b) m = (Cxt2 a m, Cxt2 b m) -- does not work either\n</code></pre>\n\n<p>It leads to the following</p>\n\n<pre><code>error:\n    \u2022 Number of parameters must match family declaration; expected 1\n    \u2022 In the type instance declaration for \u2018Cxt2\u2019\n      In the instance declaration for \u2018Paramed (And a b)\u2019\n</code></pre>\n"}, {"tags": ["haskell", "metaprogramming", "typeclass", "template-haskell", "deriving"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 1, "creation_date": 1545313930, "post_id": 53864911, "comment_id": 94586976, "body": "Looks like the easiest solution for you is to define data type in non-record form like <code>newtype T = T Int deriving (Show)</code> and write record field accessor separately: <code>getT :: T -&gt; Int; getT (T n) = n</code>."}], "answers": [{"comments": [{"owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "edited": false, "score": 1, "creation_date": 1545317114, "post_id": 53870520, "comment_id": 94588842, "body": "Thanks! Ended up writing as <code>showsPrec p (FuncType i o) = (showCon &quot;FuncType&quot; @| i @| o) p</code>"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 3, "last_activity_date": 1545317304, "last_edit_date": 1545317304, "creation_date": 1545315828, "answer_id": 53870520, "question_id": 53864911, "link": "https://stackoverflow.com/questions/53864911/derive-positional-show/53870520#53870520", "title": "Derive positional Show", "body": "<h2>Implementing Show by hand</h2>\n\n<p>The default way of implementing <code>Show</code> requires a fair amount of boilerplate. That is taken care of by <a href=\"https://hackage.haskell.org/package/show-combinators-0.1.0.0/docs/Text-Show-Combinators.html\" rel=\"nofollow noreferrer\">show-combinators</a>, reducing the code needed to the bare essentials:</p>\n\n<pre><code>instance Show ... where\n  showPrec = flip (\\(FuncType i o) -&gt; showCon \"FuncType\" @| i @| o)\n</code></pre>\n\n<p>I think this solution is the simplest possible. No extensions, no typeclass magic under the hood. Just plain functional programming.</p>\n\n<p>(Disclaimer: I wrote the two libraries mentioned in this post.)</p>\n\n<h2>With GHC Generics</h2>\n\n<p>There is a generic implementation of <code>Show</code> in <code>generic-data</code>: <code>gshowsPrec</code> (<a href=\"https://hackage.haskell.org/package/generic-data-0.3.0.0/docs/src/Generic.Data.Internal.Show.html#gshowsPrec\" rel=\"nofollow noreferrer\">link to source</a>). But it shows types declared with record syntax as records.</p>\n\n<h3>Redoing the implementation</h3>\n\n<p>One way of course is to copy the implementation and remove the special handling of records.</p>\n\n<pre><code>{- 1. The usual boilerplate -}\n\nclass GShow p f where\n  gPrecShows :: p (ShowsPrec a) -&gt; f a -&gt; PrecShowS\n\ninstance GShow p f =&gt; GShow p (M1 D d f) where\n  gPrecShows p (M1 x) = gPrecShows p x\n\ninstance (GShow p f, GShow p g) =&gt; GShow p (f :+: g) where\n  gPrecShows p (L1 x) = gPrecShows p x\n  gPrecShows p (R1 y) = gPrecShows p y\n\n{- 2. A simplified instance for (M1 C), that shows all constructors\n      using positional syntax. The body mostly comes from the instance\n      (GShowC p ('MetaCons s y 'False) f). -}\n\ninstance (Constructor c, GShowFields p f) =&gt; GShow p (M1 C c f) where\n  gPrecShows p x = gPrecShowsC p (conName x) (conFixity x) x\n   where\n    gPrecShowsC p name fixity (M1 x)\n      | Infix _ fy &lt;- fixity, k1 : k2 : ks &lt;- fields =\n        foldl' showApp (showInfix name fy k1 k2) ks\n      | otherwise = foldl' showApp (showCon cname) fields\n      where\n        cname = case fixity of\n          Prefix -&gt; name\n          Infix _ _ -&gt; \"(\" ++ name ++ \")\"\n        fields = gPrecShowsFields p x\n</code></pre>\n\n<h3>Type surgery</h3>\n\n<p>(Section named after <a href=\"https://blog.poisson.chat/posts/2018-11-26-type-surgery.html\" rel=\"nofollow noreferrer\">my blogpost</a> but this thread is a much simpler situation.)</p>\n\n<p>Another way is to transform the generic representation of our type to pretend that it's not declared using record syntax. Fortunately, the only difference is in a phantom type parameter, so that transformation can be as simple as <code>coerce</code> at run time.</p>\n\n<pre><code>unsetIsRecord ::\n  Coercible (f p) (UnsetIsRecord f p) =&gt; Data f p -&gt; Data (UnsetIsRecord f) p\nunsetIsRecord = coerce\n\n-- UnsetIsRecord defined at the end\n</code></pre>\n\n<p>The <a href=\"https://hackage.haskell.org/package/generic-data-0.3.0.0/docs/Generic-Data-Types.html#t:Data\" rel=\"nofollow noreferrer\"><code>Data</code> newtype</a> basically creates a data type out of a generic representation (which is the inverse of what <code>Generic</code> does, in some sense). We can map a normally declared type to a <code>Data</code> type using <code>toData :: a -&gt; Data (Rep a) p</code>.</p>\n\n<p>Finally, we can directly apply the <code>gshowsPrec</code> function from the <code>generic-data</code> library to the output of <code>unsetIsRecord</code>.</p>\n\n<pre><code>instance Show T where\n  showsPrec n = gshowsPrec n . unsetIsRecord . toData\n</code></pre>\n\n<hr>\n\n<p><code>UnsetIsRecord</code> should ideally be in <code>generic-data</code>, but since it's not yet there, here is a possible implementation:</p>\n\n<pre><code>type family UnsetIsRecord (f :: * -&gt; *) :: * -&gt; *\ntype instance UnsetIsRecord (M1 D m f) = M1 D m (UnsetIsRecord f)\ntype instance UnsetIsRecord (f :+: g) = UnsetIsRecord f :+: UnsetIsRecord g\ntype instance UnsetIsRecord (M1 C ('MetaCons s y _isRecord) f) = M1 C ('MetaCons s y 'False) f)\n</code></pre>\n"}], "owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 1, "accepted_answer_id": 53870520, "answer_count": 1, "score": 1, "last_activity_date": 1545317304, "creation_date": 1545294535, "last_edit_date": 1545301592, "question_id": 53864911, "link": "https://stackoverflow.com/questions/53864911/derive-positional-show", "title": "Derive positional Show", "body": "<p>Notice how <code>T 5</code> shows in</p>\n\n<pre><code>&gt; newtype T = T { getT :: Int } deriving Show\n&gt; T 5\nT {getT = 5}\n</code></pre>\n\n<p>Is there some way to derive the positional, non-record-syntax variant of Show for a type that was declared with record syntax?</p>\n\n<p>(btw <code>T</code> is only a simple example to explain the question, I'm looking for a general answer for any type defined with record syntax)</p>\n\n<p>Some options I would be satisfied with:</p>\n\n<ul>\n<li>TH generation for it provided by a library</li>\n<li>A <code>Generic</code> based derivation (where the manual instance refers to an existing function)</li>\n<li>An easy way / guide to manually implement <code>Show</code> instances</li>\n<li>Any other idea I didn't think about</li>\n</ul>\n\n<p>For a more complicated example I have <a href=\"https://github.com/lamdu/syntax-tree/blob/master/src/AST/Term/FuncType.hs#L34\" rel=\"nofollow noreferrer\">this hand-written instance</a>:</p>\n\n<pre><code>instance ... where\n    showsPrec p (FuncType i o) =\n        showParen (p &gt; 0)\n        ((\"FuncType \" &lt;&gt;) . showsPrec 1 i . (\" \" &lt;&gt;) . showsPrec 1 o)\n</code></pre>\n\n<p>I would like the answer to be able to avoid this boilerplate.</p>\n"}, {"tags": ["haskell", "recursion", "recursion-schemes"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 3, "last_activity_date": 1545274948, "last_edit_date": 1545274948, "creation_date": 1545272540, "answer_id": 53861644, "question_id": 53861134, "link": "https://stackoverflow.com/questions/53861134/learning-recursion-schemes-in-haskell-by-tictactoe/53861644#53861644", "title": "Learning recursion schemes in Haskell by TicTacToe", "body": "<p>In <code>minimax</code> you have your minimax algebra <code>phi :: GameTreeF Board (MinimaxRating, [Move]) -&gt; (MinimaxRating, [Move])</code>.</p>\n\n<p>In <code>computeKITree</code>, which is going to be a <code>cata</code>, you need <code>psi :: GameTreeF Board (GameTree (Board, ..., ...) Move) -&gt; GameTree (Board, ..., ...) Move</code>.</p>\n\n<p><code>psi</code> can use <code>phi</code> to compute the minimax, and then wrap everything in a <code>GameTreeF</code>.</p>\n\n<p>We must transform the argument of <code>psi</code> to an argument of <code>phi</code>:</p>\n\n<pre><code>adaptPhi :: GameTreeF Board (GameTree (Board, ..., ...) Move) -&gt; GameTreeF Board (..., ...)\n</code></pre>\n\n<p>That looks like a nice <code>fmap</code>! (Exercise for the reader.)</p>\n\n<p>Once you have that...</p>\n\n<pre><code>computeKITree :: GameTree Board Move -&gt; GameTree (Board, MinimaxRating, [Move]) Move\ncomputeKITree = cata psi where\n  psi t@(GameTree b ts) =\n    let (rating, ms) = phi (adaptPhi t) in\n    Fix (GameTree (b, rating, ms) ts)\n</code></pre>\n"}], "owner": {"reputation": 4369, "user_id": 3102935, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/22985d9fffff3b76a11b1f2bccbf2f42?s=128&d=identicon&r=PG&f=1", "display_name": "WorldSEnder", "link": "https://stackoverflow.com/users/3102935/worldsender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 1, "accepted_answer_id": 53861644, "answer_count": 1, "score": 4, "last_activity_date": 1545274948, "creation_date": 1545267306, "last_edit_date": 1545267623, "question_id": 53861134, "link": "https://stackoverflow.com/questions/53861134/learning-recursion-schemes-in-haskell-by-tictactoe", "title": "Learning recursion schemes in Haskell by TicTacToe", "body": "<p>Looking around, I noticed that recursion schemes are quite a general concept and I wanted to learn by experiencing it first hand. So I started implementing a minimax algorithm for TicTacToe. Here is a small snippet that sets the stage. Feel free to skip it, since it's just a basic implementation for completeness or read in an <a href=\"https://ideone.com/4QxrQz\" rel=\"nofollow noreferrer\">online IDE</a></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DeriveFunctor #-}\nimport Data.Maybe\nimport Data.Sequence hiding (zip, filter, length)\nimport Data.Foldable\nimport Data.Monoid\nimport Control.Arrow\n\ndata Player = Cross | Nought deriving (Eq, Show)\ntype Cell = Maybe Player\ndata Board = Board { getPlayer :: Player, getCells :: Seq Cell }\ntype Move = Int\n\n(!?) :: Seq a -&gt; Move -&gt; a\ns !? m = index s m\nshowCell :: Cell -&gt; String\nshowCell Nothing = \" \"\nshowCell (Just Cross) = \"x\"\nshowCell (Just Nought) = \"o\"\ninstance Show Board where\n    show (Board p cells) = \"+---+---+---+\\n\"\n                        ++ \"| \" ++ showCell (cells !? 0)\n                           ++ \" | \" ++ showCell (cells !? 1)\n                               ++ \" | \" ++ showCell (cells !? 2) ++ \" |\\n\"\n                        ++ \"+---+---+---+\\n\"\n                        ++ \"| \" ++ showCell (cells !? 3)\n                           ++ \" | \" ++ showCell (cells !? 4)\n                               ++ \" | \" ++ showCell (cells !? 5) ++ \" |\\n\"\n                        ++ \"+---+---+---+\\n\"\n                        ++ \"| \" ++ showCell (cells !? 6)\n                           ++ \" | \" ++ showCell (cells !? 7)\n                               ++ \" | \" ++ showCell (cells !? 8) ++ \" |\\n\"\n                        ++ \"+---+---+---+\\n\"\n                        ++ \"It's \" ++ show p ++ \"'s turn\\n\"\n\nother :: Player -&gt; Player\nother Cross = Nought\nother Nought = Cross\n\n-- decide on a winner. The first found winner is taken, no matter if more exist\ndecide :: Board -&gt; Maybe Player\ndecide (Board p cells) = getAlt $\n                         isWinner 0 1 2 &lt;&gt; isWinner 3 4 5 &lt;&gt; isWinner 6 7 8 &lt;&gt;\n                         isWinner 0 3 6 &lt;&gt; isWinner 1 4 7 &lt;&gt; isWinner 2 5 8 &lt;&gt;\n                         isWinner 0 4 8 &lt;&gt; isWinner 2 4 6 where\n    sameAs :: Cell -&gt; Cell -&gt; Cell\n    sameAs (Just Cross) (Just Cross) = Just Cross\n    sameAs (Just Nought) (Just Nought) = Just Nought\n    sameAs _ _ = Nothing\n    isWinner a b c = Alt $ (cells !? a) `sameAs` (cells !? b) `sameAs` (cells !? c)\n\ninitialState :: Board\ninitialState = (Board Cross (fromList $ map (const Nothing) [0..8]))\n\nfindMoves :: Board -&gt; [Move]\nfindMoves (Board p cells) = map fst $ filter (isNothing . snd) $ zip [0..] $ toList cells\n\napplyMove :: Board -&gt; Move -&gt; Board\napplyMove (Board player cells) move = Board (other player) (update move (Just player) cells)\n\ndata MinimaxRating = Loss | Draw | Win deriving (Eq, Ord, Show)\ninvertRating Win = Loss\ninvertRating Draw = Draw\ninvertRating Loss = Win\n</code></pre>\n\n<p>Now, for the fun parts. I've come up with the following type to define my game tree:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- a game tree is a tree with a current board\n-- and a list of next boards tagged with moves\ndata GameTreeF b m f = Tree b [(m, f)]\n    deriving (Functor)\ntype GameTree b m = Fix (GameTreeF b m)\n</code></pre>\n\n<p>and, easily enough, we can use an anamorphism to represent expanding a game by all legal moves</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>fullGameTree :: Board -&gt; GameTree Board Move\nfullGameTree = ana phi where\n    phi board = Tree board $ map (id &amp;&amp;&amp; applyMove board) (findMoves board)\n</code></pre>\n\n<p>and the minimax algorithm is represented as a catamorphism which we can write like so</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- given a game tree to explore, finds the best rating and a\n-- move sequence that results in it\nminimax :: GameTree Board Move -&gt; (MinimaxRating, [Move])\nminimax = cata phi where\n    mergeInMove (m, (r, ms)) = (invertRating r, m:ms)\n    compareMoves (m, ms) (n, ns) = compare m n &lt;&gt; compare (length ns) (length ms)\n    phi (Tree board []) = (Draw, []) -- no legal moves is a draw\n    phi (Tree board moves) = case decide board of\n        Just winner | winner == getPlayer board -&gt; (Win, []) -- we win\n        Just winner                             -&gt; (Loss, []) -- they win\n        Nothing -&gt; maximumBy compareMoves $ map mergeInMove moves\n</code></pre>\n\n<p>For my question: I now want to construct a <code>GameTree</code> that has tagged at each node the minimax result. So what I'm searching for, I believe is this function:</p>\n\n<pre><code>-- tag each node with the result of minimax for its subtree\ncomputeKITree :: GameTree Board Move -&gt; GameTree (Board, MinimaxRating, [Move]) Move\n</code></pre>\n\n<p>I just can't figure out how to write this function with recursion schemes. Can someone help me out here?</p>\n"}]