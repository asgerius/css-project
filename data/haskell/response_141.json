[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1505944935, "post_id": 46332382, "comment_id": 79625575, "body": "Sounds like a use case for a prism from lens."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1505946299, "post_id": 46332382, "comment_id": 79626082, "body": "If <code>DatabaseItem</code> was a type-indexed GADT, the last <code>unwrap</code> would compile, with type <code>DatabaseItem a -&gt; a</code>. But this requires some change to the original data type."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1505946773, "post_id": 46332382, "comment_id": 79626239, "body": "It\u2019s surprisingly difficult to answer this question without understanding how you use <code>getDate</code> and how you would want to use <code>unwrap</code>. Even if the second definition of <code>unwrap</code> were valid Haskell, the value it produces is no more useful than <code>DatabaseItem</code>, since it still can\u2019t be used as a <code>String</code>, <code>Integer</code>, or <code>UTCTime</code> (since it might be any of them). How do you intend to use these functions? What problem are you trying to solve? I\u2019m having trouble understanding that."}, {"owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "reply_to_user": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 0, "creation_date": 1505950698, "post_id": 46332382, "comment_id": 79627273, "body": "@AlexisKing Here&#39;s more complete usage <a href=\"https://gist.github.com/bcherny/b500babe22f75b02a2c424b8d3efe7e2\" rel=\"nofollow noreferrer\">gist.github.com/bcherny/b500babe22f75b02a2c424b8d3efe7e2</a>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1505963467, "post_id": 46332382, "comment_id": 79629943, "body": "@bcherny The question was more about, how do you imagine using <code>unwrap</code> once you&#39;ve implemented it? It&#39;s clear how to use the other functions you&#39;ve already implemented."}, {"owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1506201587, "post_id": 46332382, "comment_id": 79726875, "body": "@amalloy <code>unwrap DbNumber 9001 -- 9001</code>, or <code>unwrap DbString &quot;Hello&quot; -- &quot;Hello&quot;</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1506202884, "post_id": 46332382, "comment_id": 79727184, "body": "And what type would you give to <code>unwrap</code> in that case? It can&#39;t be both <code>DatabaseItem -&gt; Integer</code> and <code>DatabaseItem -&gt; String</code> at the same time, and yet that is how you are hoping to use <code>unwrap</code>."}, {"owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1506281207, "post_id": 46332382, "comment_id": 79745078, "body": "@amalloy I see. Because <code>DatabaseItem</code> is monomorphic, the return type can&#39;t be different depending on what concrete type is passed into <code>unwrap</code>. Is there a way in Haskell to overload <code>unwrap</code>&#39;s signature? eg. in TypeScript you can give unwrap 3 signatures, and the compiler will select the correct one depending on which concrete type the <code>DatabaseItem</code> sum type resolved to <a href=\"https://gist.github.com/bcherny/761159d49fb155e9724b841a5a5f479e\" rel=\"nofollow noreferrer\">gist.github.com/bcherny/761159d49fb155e9724b841a5a5f479e</a>"}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1505948739, "post_id": 46332959, "comment_id": 79626770, "body": "I think you just made me understand catamorphisms and why they are important."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1505948504, "creation_date": 1505948504, "answer_id": 46332959, "question_id": 46332382, "link": "https://stackoverflow.com/questions/46332382/get-value-from-disjoint-union-of-data-constructors/46332959#46332959", "title": "Get value from disjoint union of data constructors", "body": "<p>A common pattern for user-defined datatypes is to define a catamorphism for them; e.g. in the standard library there are <code>foldr</code> for <code>[]</code>, <code>maybe</code> for <code>Maybe</code>, <code>bool</code> for <code>Bool</code>, <code>either</code> for <code>Either</code>, and so forth. A catamorphism is essentially a reification of a pattern match into a function, together with a tiny bit of fanciness for recursive types which isn't relevant here.</p>\n\n<p>For your type, it might look like this:</p>\n\n<pre><code>databaseItem ::\n    (String       -&gt; a) -&gt;\n    (Integer      -&gt; a) -&gt;\n    (UTCTime      -&gt; a) -&gt;\n    (DatabaseItem -&gt; a)\ndatabaseItem string number date item = case item of\n    DbString s -&gt; string s\n    DbNumber n -&gt; number n\n    DbDate   d -&gt; date   d\n</code></pre>\n\n<p>For example, if you wanted to get a string representing the item, you might use:</p>\n\n<pre><code>databaseItem id show (formatTime defaultTimeLocale \"%c\")\n    :: DatabaseItem -&gt; String\n</code></pre>\n\n<p>You can also implement your constructor-specific extractors in terms of it.</p>\n\n<pre><code>getDate = databaseItem (const Nothing) (const Nothing) Just\n</code></pre>\n\n<p>There is significantly more material on catamorphisms and why they are the Right Choice for consuming ADTs scattered around the web if this piques your interest.</p>\n"}, {"comments": [{"owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "edited": false, "score": 0, "creation_date": 1506202637, "post_id": 46333611, "comment_id": 79727132, "body": "Thanks for the concise solution! I&#39;ve played with lenses in other languages, but need to review them in Haskell."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 3, "last_activity_date": 1505953756, "creation_date": 1505953756, "answer_id": 46333611, "question_id": 46332382, "link": "https://stackoverflow.com/questions/46332382/get-value-from-disjoint-union-of-data-constructors/46333611#46333611", "title": "Get value from disjoint union of data constructors", "body": "<p>I agree with Daniel's suggestion, but it is worth pointing out that <code>lens</code> has the notion of <a href=\"https://hackage.haskell.org/package/lens-4.15.4/docs/Control-Lens-Prism.html\" rel=\"nofollow noreferrer\"><code>Prism</code></a> which lets you do this too (and much more!). Especially given the gist you link in the comments, this might be interesting</p>\n\n<pre><code>{-# Language TemplateHaskell #-}\nimport Data.Time.Clock\nimport Control.Lens.TH\n\ndata DatabaseItem = DbString String\n                  | DbNumber Integer\n                  | DbDate   UTCTime\n\nmakePrisms ''DatabaseItem\n</code></pre>\n\n<p>This automatically generates <code>_DbString</code>, <code>_DbNumber</code> and <code>_DbDate</code> functions which can easily be adapted inline to do what <code>getString</code>, <code>getNumber</code>, and <code>getDate</code> would do. Namely:</p>\n\n<pre><code>main&gt; import Control.Lens\nmain&gt; :t (^? _DbString)\n(^? _DbString) :: DatabaseItem -&gt; Maybe String\nmain&gt; :t (^? _DbNumber)\n(^? _DbNumber) :: DatabaseItem -&gt; Maybe Integer\nmain&gt; :t (^? _DbDate)\n(^? _DbDate) :: DatabaseItem -&gt; Maybe UTCTime\n</code></pre>\n\n<p>However, <code>lens</code> is a fair bit more powerful. It can filter through your data base to collect one of the variants in one line too. For example, I can get all the dates in <code>theDatabase :: [DatabaseItem]</code> using just <code>theDatabase ^.. each . _DbDate</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "edited": false, "score": 0, "creation_date": 1506202352, "post_id": 46366861, "comment_id": 79727053, "body": "Thanks for the example. Why is this so complicated in Haskell? Eg. in TypeScript there are no casts necessary, because <code>unwrap</code>&#39;s argument is structurally typed - if the argument has the expected structure, then the code compiles. <a href=\"https://gist.github.com/bcherny/03297dc849305da2f1aae99501e60f21\" rel=\"nofollow noreferrer\">gist.github.com/bcherny/03297dc849305da2f1aae99501e60f21</a>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1506203578, "post_id": 46366861, "comment_id": 79727345, "body": "The difference is that in your TypeScript example, you preserve the type information in the type parameter, whereas your Haskell code throws it away. You could as easily write <code>data DatabaseItem a = Item a</code>, and then <code>unwrap (Item 5) == 5</code> as expected. But if you do this, then values of type DatabaseItem are only useful if you know exactly what their type is: you can&#39;t recover that information after building a value. It looks to me like the same would be true in your TypeScript code, but I don&#39;t know TypeScript well enough to say for sure."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1506234329, "post_id": 46366861, "comment_id": 79732146, "body": "As @amalloy notes, your Haskell and TypeScript examples aren&#39;t really comparable.  I&#39;ve added a note to my answer to provide what I think is the Haskell equivalent of your TypeScript example."}, {"owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "edited": false, "score": 0, "creation_date": 1506280856, "post_id": 46366861, "comment_id": 79744981, "body": "Thanks for the detailed response @K.A.Buhr!"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 1, "last_activity_date": 1506234264, "last_edit_date": 1506234264, "creation_date": 1506089692, "answer_id": 46366861, "question_id": 46332382, "link": "https://stackoverflow.com/questions/46332382/get-value-from-disjoint-union-of-data-constructors/46366861#46366861", "title": "Get value from disjoint union of data constructors", "body": "<p><em>Edited:</em> Added response to comment.</p>\n\n<p>In case you can't figure out why no one is answering your question directly, note that you can write <code>unwrap</code> as follows, using <code>Data.Typeable</code>:</p>\n\n<pre><code>import Data.Maybe\nimport Data.Time\nimport Data.Typeable\n\ndata DatabaseItem = DbString String\n                  | DbNumber Integer\n                  | DbDate   UTCTime\n\nunwrap :: (Typeable a) =&gt; DatabaseItem -&gt; a\nunwrap x = case x of\n             DbString x -&gt; go x\n             DbNumber x -&gt; go x\n             DbDate   x -&gt; go x\n  where go :: (Typeable a, Typeable b) =&gt; a -&gt; b\n        go = fromMaybe (error \"unwrap: type mismatch\") . cast\n</code></pre>\n\n<p>It can be used like this:</p>\n\n<pre><code>&gt; unwrap (DbNumber 1) :: Integer\n1\n&gt; 1 + unwrap (DbNumber 1)\n2\n&gt; 1 + unwrap (DbString \"foo\")\n*** Exception: unwrap: type mismatch\nCallStack (from HasCallStack):\n  error, called at Unwrap.hs:16:25 in main:Main\n&gt;\n</code></pre>\n\n<p>Now, go try to use it in some actual code.  You will find it a largely frustrating experience and realize that either having separate functions, like:</p>\n\n<pre><code>getString (DbString x) = Just x\ngetString _ = Nothing\n</code></pre>\n\n<p>or using a catamorphism or prism will be a much better approach.</p>\n\n<p>In a follow-up comment, you asked why the Haskell version was so much more complicated than the TypeScript version, which doesn't require a cast:</p>\n\n<pre><code>type DatabaseItem&lt;T&gt; = { value: T }\n\nlet DbString = (value: string) =&gt; ({ value })\nlet DbNumber = (value: number) =&gt; ({ value })\nlet DbDate = (value: Date) =&gt; ({ value })\n\nfunction unwrap&lt;T&gt;({ value }: DatabaseItem&lt;T&gt;) {\n  return value\n}\n\nunwrap(DbString(\"Hello\")) // \"Hello\"\nunwrap(DbNumber(42)) // 42\nunwrap(DbDate(new Date)) // Date\n</code></pre>\n\n<p>As @amalloy noted, your TypeScript example isn't really analogous to the Haskell example we've been discussing.  In the Haskell example, <code>DbString \"Hello\"</code> and <code>DbNumber 42</code> have the same type.  In the TypeScript example, <code>DbString(\"Hello\")</code> is of type <code>DatabaseItem&lt;string&gt;</code> and <code>DbNumber(42)</code> is of type <code>DatabaseItem&lt;number&gt;</code>.  A Haskell version of this TypeScript code would look more like this, which seems pretty similar in structure to the TypeScript example and doesn't involve any casts:</p>\n\n<pre><code>import Data.Time\n\nnewtype DatabaseItem a = Item { unwrap :: a }\n\ndbString :: String -&gt; DatabaseItem String\ndbString = Item\n\ndbNumber :: (Num a) =&gt; a -&gt; DatabaseItem a\ndbNumber = Item\n\ndbDate :: UTCTime -&gt; DatabaseItem UTCTime\ndbDate = Item\n\nmain = do print $ unwrap (dbString \"Hello\")\n          print $ unwrap (dbNumber 42)\n          now &lt;- zonedTimeToUTC &lt;$&gt; getZonedTime\n          print $ unwrap (dbDate now)\n</code></pre>\n"}], "owner": {"reputation": 2714, "user_id": 435124, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/869caf84d3e2f1963345501b2e420df9?s=128&d=identicon&r=PG", "display_name": "bcherny", "link": "https://stackoverflow.com/users/435124/bcherny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 46366861, "answer_count": 3, "score": 0, "last_activity_date": 1506234264, "creation_date": 1505944678, "question_id": 46332382, "link": "https://stackoverflow.com/questions/46332382/get-value-from-disjoint-union-of-data-constructors", "title": "Get value from disjoint union of data constructors", "body": "<p>Given this type constructor:</p>\n\n<pre><code>data DatabaseItem = DbString String\n                  | DbNumber Integer\n                  | DbDate   UTCTime\n</code></pre>\n\n<p>I can write a function that unwraps a <code>DatabaseItem</code> to, for example, a <code>UTCTime</code>:</p>\n\n<pre><code>getDate :: DatabaseItem -&gt; Maybe UTCTime\ngetDate (DbDate a) = Just a\ngetDate _ = Nothing\n</code></pre>\n\n<p>Rather than write a function like this for each of the 3 data constructors, I want a general function (which also means I don't need the <code>Maybe</code> anymore), but I can't quite figure out how to write it. I tried:</p>\n\n<pre><code>unwrap :: DatabaseItem -&gt; a\nunwrap (i a) = a\n\n-- error: Parse error in pattern: i\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>unwrap :: DatabaseItem -&gt; String | Integer | UTCTime\nunwrap (DbString a) = a\nunwrap (DbDate a) = a\nunwrap (DbNumber a) = a\n\n-- error: parse error on input \u2018|\u2019\n</code></pre>\n\n<p>Neither compiles. Could someone point out what's wrong with these, and suggest a better implementation? Thanks!</p>\n"}, {"tags": ["haskell", "functional-programming", "lazy-evaluation"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1505945897, "post_id": 46332245, "comment_id": 79625945, "body": "Maybe it does not matter here, but before measuring any performance remember to turn on optimization compiling with <code>-O2</code> or something similar. Sometimes it makes a huge difference."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1505948002, "post_id": 46332245, "comment_id": 79626584, "body": "If you only care about how many there are, a bit of combinatorics should get you where you want to go much more cheaply. I&#39;d be happy to write a second answer about that if it sounds interesting to you."}, {"owner": {"reputation": 493, "user_id": 5329204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0a6616217699ba7b326e1a14faa8b7f?s=128&d=identicon&r=PG", "display_name": "Kevin Johnson", "link": "https://stackoverflow.com/users/5329204/kevin-johnson"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1505964980, "post_id": 46332245, "comment_id": 79630325, "body": "@DanielWagner A bit of combinatorics would be most welcome, and a nice way to help confirm the program&#39;s correctness!  Please do write it up."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1506130352, "post_id": 46332245, "comment_id": 79709599, "body": "Okay, I&#39;ve written about how the combinatorics approach can lead us to a pretty definition for <code>eSet</code> that is faster and less memory-intensive than your proposal, and doesn&#39;t need sneaky tricks to avoid GHC optimizations like my first answer."}], "answers": [{"comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1505951407, "post_id": 46332865, "comment_id": 79627423, "body": "Is the <code>ignored+h</code> supposed to be <code>ignored+1</code> or something?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1505958116, "post_id": 46332865, "comment_id": 79628797, "body": "@K.A.Buhr Oops, it&#39;s supposed to be <code>ignored+x</code>. My test file used <code>h</code> and <code>t</code> instead of <code>x</code> and <code>xs</code> but I found the overloading of <code>t</code> a bit confusing when doing the writeup and incompletely changed the names. Fix incoming; thanks for noticing!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1505958132, "last_edit_date": 1505958132, "creation_date": 1505947819, "answer_id": 46332865, "question_id": 46332245, "link": "https://stackoverflow.com/questions/46332245/finding-the-size-of-a-list-thats-too-big-for-memory/46332865#46332865", "title": "Finding the size of a list that&#39;s too big for memory?", "body": "<p>I suspect the culprit here is <code>replicateM</code>, which has <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/src/Control.Monad.html#replicateM\" rel=\"noreferrer\">this implementation</a>:</p>\n\n<pre><code>replicateM cnt0 f =\n    loop cnt0\n  where\n    loop cnt\n        | cnt &lt;= 0  = pure []\n        | otherwise = liftA2 (:) f (loop (cnt - 1))\n</code></pre>\n\n<p>The problem line is <code>liftA2 (:) f (loop (cnt - 1))</code>; probably <code>loop (cnt - 1)</code> is getting shared among all the calls to <code>(:)</code> partially applied to elements of <code>f</code>, and so <code>loop (cnt - 1)</code> must be kept in memory. Unfortunately <code>loop (cnt - 1)</code> is quite a long list...</p>\n\n<p>It can be a bit fiddly to convince GHC <em>not</em> to share something. The following redefinition of <code>superSet</code> gives me a nice flat memory usage; it will probably be a bit slower on examples that do fit in memory, of course. The key idea is to make it look to the untrained eye (i.e. GHC) like the recursive monadic action depends on the choices made earlier, even though it doesn't.</p>\n\n<pre><code>superSet :: Int -&gt; Int -&gt; [[Int]]\nsuperSet r t = go r 0 where\n    go 0 ignored = if ignored == 0 then [[]] else [[]]\n    go r ignored = do\n        x &lt;- [0..t]\n        xs &lt;- go (r-1) (ignored+x)\n        return (x:xs)\n</code></pre>\n\n<p>If you don't mind avoiding optimizations, the more natural definition also works:</p>\n\n<pre><code>superSet 0 t = [[]]\nsuperSet r t = do\n    x &lt;- [0..t]\n    xs &lt;- superSet (r-1) t\n    return (x:xs)\n</code></pre>\n\n<p>...but with <code>-O2</code> GHC is too clever and notices that it can share the recursive call.</p>\n"}, {"tags": [], "owner": {"reputation": 493, "user_id": 5329204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0a6616217699ba7b326e1a14faa8b7f?s=128&d=identicon&r=PG", "display_name": "Kevin Johnson", "link": "https://stackoverflow.com/users/5329204/kevin-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1505967667, "creation_date": 1505967667, "answer_id": 46335431, "question_id": 46332245, "link": "https://stackoverflow.com/questions/46332245/finding-the-size-of-a-list-thats-too-big-for-memory/46335431#46335431", "title": "Finding the size of a list that&#39;s too big for memory?", "body": "<p>After re-reading parts of <a href=\"http://learnyouahaskell.com/for-a-few-monads-more\" rel=\"nofollow noreferrer\">LYaH</a> and thinking about @daniel-wagners answer monadically composing sounded like it would be worthwhile to try again.  The new code total memory is flat and works with and without the <code>-O2</code> optimization.</p>\n\n<p>Source:</p>\n\n<pre><code>import Control.Monad\nimport System.Environment\nimport System.Exit\n\nallowed :: [Int] -&gt; Bool\nallowed a = allowed' [] a\n    where\n        allowed' [ ] [ ]       = False\n        allowed' [ ] [0]       = True\n        allowed'  _  [ ]       = True\n        allowed' acc (0:aTail) = allowed' acc aTail\n        allowed' acc (a:aTail)\n             | a `elem` acc    = False\n             | otherwise       = allowed' (a:acc) aTail\n\nbranch :: Int -&gt; [Int] -&gt; [[Int]]\nbranch t x  = filter allowed [n:x | n &lt;- [0..t]]\n\neSet :: Int -&gt; Int -&gt; [[Int]]\neSet r t = return [] &gt;&gt;= foldr (&lt;=&lt;) return (replicate r (branch t))\n\nmain :: IO ()\nmain = do\n    args &lt;- getArgs\n    case args of\n        [rArg, tArg] -&gt;\n            print $ length $ eSet (read rArg) (read tArg)\n        [rArg, tArg, \"set\"] -&gt;\n            print $          eSet (read rArg) (read tArg)\n        _ -&gt; die \"Usage: eSet r r set &lt;set optional&gt;\"\n</code></pre>\n\n<p>The version with monadic function composition tests much faster and without the memory issues...</p>\n\n<pre><code>$ ./eSetMonad 10 5 +RTS -sstderr\n63591\n 289,726,000 bytes allocated in the heap\n     997,968 bytes copied during GC\n      63,360 bytes maximum residency (2 sample(s))\n      24,704 bytes maximum slop\n           2 MB total memory in use (0 MB lost due to fragmentation)\n\n                                 Tot time (elapsed)  Avg pause  Max pause\nGen  0       553 colls,     0 par    0.008s   0.008s     0.0000s    0.0002s\nGen  1         2 colls,     0 par    0.000s   0.000s     0.0002s    0.0003s\n\nINIT    time    0.000s  (  0.000s elapsed)\nMUT     time    0.426s  (  0.429s elapsed)\nGC      time    0.009s  (  0.009s elapsed)\nEXIT    time    0.000s  (  0.000s elapsed)\nTotal   time    0.439s  (  0.438s elapsed)\n\n%GC     time       2.0%  (2.0% elapsed)\n\nAlloc rate    680,079,893 bytes per MUT second\n\nProductivity  98.0% of total user, 98.3% of total elapsed\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 493, "user_id": 5329204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0a6616217699ba7b326e1a14faa8b7f?s=128&d=identicon&r=PG", "display_name": "Kevin Johnson", "link": "https://stackoverflow.com/users/5329204/kevin-johnson"}, "edited": false, "score": 0, "creation_date": 1506142390, "post_id": 46346975, "comment_id": 79711307, "body": "Impressive.  This eSet 10 5 runs in 0.527s elapsed vs 0.766s elapsed for my solution with:  eSet r t = return [] &gt;&gt;= foldr (&lt;=&lt;) return (replicate r (branch t))  and it has very nice properties (no filtering, works with -O2, and fast).  Excellent application of domain specific know-how.  Thank you!  Well done!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1506130276, "last_edit_date": 1506130276, "creation_date": 1506005097, "answer_id": 46346975, "question_id": 46332245, "link": "https://stackoverflow.com/questions/46332245/finding-the-size-of-a-list-thats-too-big-for-memory/46346975#46346975", "title": "Finding the size of a list that&#39;s too big for memory?", "body": "<p>A completely alternate approach is to just do a little bit of combinatorics analysis. Here's the process that <code>eSet r t</code> does, as near as I can make out:</p>\n\n<ol>\n<li>Choose at most <code>r</code> elements without replacement from a set of size <code>t</code>.</li>\n<li>Pad the sequence to a length of <code>r</code> by interleaving a sentinel value.</li>\n</ol>\n\n<p>So let's just count the ways of doing each of these steps, rather than actually performing them. We'll introduce a new parameter, <code>s</code>, which is the length of the sequence produced by step (1) (and which we therefore know has <code>s &lt;= r</code> and <code>s &lt;= t</code>). How many sequences of size <code>s</code> are there when drawing elements without replacement from a set of size <code>t</code>? Well, there are <code>t</code> choices for the first element, <code>t-1</code> choices for the second element, <code>t-2</code> choices for the third element, ...</p>\n\n<pre><code>-- sequencesWithoutReplacement is a very long name!\nseqWORepSize :: Integer -&gt; Integer -&gt; Integer\nseqWORepSize s t = product [t-s+1 .. t]\n</code></pre>\n\n<p>Then we want to pad the sequence out to a length of <code>r</code>. We're going to choose <code>s</code> positions in the <code>r</code>-long sequence to be drawn from our sequence, and the remainder will be sentinels. How many ways are there to do that? This one is a well-known combinatorics operator called <code>choose</code>.</p>\n\n<pre><code>choose :: Integer -&gt; Integer -&gt; Integer\nchoose r s = product [r-s+1 .. r] `div` product [2 .. s]\n</code></pre>\n\n<p>The number of ways to produce a padded sequence of a given length is just the product of these two numbers, since the choices of \"what values to insert\" and \"where to insert values\" can be made completely independently.</p>\n\n<pre><code>paddedSeqSize :: Integer -&gt; Integer -&gt; Integer -&gt; Integer\npaddedSeqSize r s t = seqWORepSize s t * (r `choose` s)\n</code></pre>\n\n<p>And now we're pretty much done. Just iterate over all possible sequence lengths and add up the <code>paddedSeqSize</code>.</p>\n\n<pre><code>eSetSize :: Integer -&gt; Integer -&gt; Integer\neSetSize r t = sum $ map (\\s -&gt; paddedSeqSize r s t) [0..r]\n</code></pre>\n\n<p>We can try it out in ghci:</p>\n\n<pre><code>&gt; :set +s\n&gt; map length $ [eSet 1 1, eSet 4 4, eSet 6 4, eSet 4 6]\n[2,209,1045,1045]\n(0.13 secs, 26,924,264 bytes)\n&gt; [eSetSize 1 1, eSetSize 4 4, eSetSize 6 4, eSetSize 4 6]\n[2,209,1045,1045]\n(0.01 secs, 120,272 bytes)\n</code></pre>\n\n<p>This way is significantly faster and significantly more memory-friendly. Indeed, we can make queries and get answers about <code>eSet</code>s that we would never be able to count the size of one-by-one, e.g.</p>\n\n<pre><code>&gt; length . show $ eSetSize 1000 1000\n2594\n(0.26 secs, 909,746,448 bytes)\n</code></pre>\n\n<p>Good luck counting to 10^2594 one at a time. =P</p>\n\n<p><strong>Edit</strong><br>\nThis idea can also be adapted to produce the padded sequences themselves rather than just counting how many there are. First, a handy utility that I find myself defining over and over for picking out individual elements of a list and reporting on the leftovers:</p>\n\n<pre><code>zippers :: [a] -&gt; [([a], a, [a])]\nzippers = go [] where\n    go ls [] = []\n    go ls (h:rs) = (ls, h, rs) : go (h:ls) rs\n</code></pre>\n\n<p>Now, the sequences without replacement can be done by repeatedly choosing a single element from the leftovers.</p>\n\n<pre><code>seqWORep :: Int -&gt; [a] -&gt; [[a]]\nseqWORep 0 _  = [[]]\nseqWORep n xs = do\n    (ls, y, rs) &lt;- zippers xs\n    ys &lt;- seqWORep (n-1) (ls++rs)\n    return (y:ys)\n</code></pre>\n\n<p>Once we have a sequence, we can pad it to a desired size by producing all the interleavings of the sentinel value as follows:</p>\n\n<pre><code>interleavings :: Int -&gt; a -&gt; [a] -&gt; [[a]]\ninterleavings 0 _ xs = [xs]\ninterleavings n z [] = [replicate n z]\ninterleavings n z xs@(x:xt) =  map (z:) (interleavings (n-1) z xs)\n                            ++ map (x:) (interleavings  n    z xt)\n</code></pre>\n\n<p>And finally, the top-level function just delegates to <code>seqWORep</code> and <code>interleavings</code>.</p>\n\n<pre><code>eSet :: Int -&gt; Int -&gt; [[Int]]\neSet r t = do\n    s &lt;- [0..r]\n    xs &lt;- seqWORep s [1..t]\n    interleavings (r-s) 0 xs\n</code></pre>\n\n<p>In my tests this modified <code>eSet</code> has nice flat memory usage both with and without optimizations; does not generate any spurious elements that need to be later <code>filter</code>ed out, and so is faster than your original proposal; and to me looks like quite a natural definition compared to the answer that relies on tricking GHC. A nice collection of properties!</p>\n"}], "owner": {"reputation": 493, "user_id": 5329204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0a6616217699ba7b326e1a14faa8b7f?s=128&d=identicon&r=PG", "display_name": "Kevin Johnson", "link": "https://stackoverflow.com/users/5329204/kevin-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 46346975, "answer_count": 3, "score": 2, "last_activity_date": 1506130276, "creation_date": 1505944067, "question_id": 46332245, "link": "https://stackoverflow.com/questions/46332245/finding-the-size-of-a-list-thats-too-big-for-memory", "title": "Finding the size of a list that&#39;s too big for memory?", "body": "<p>Brand new Haskell programmer here.  Just finished \"Learn you a Haskell\"...  I'm interested in how large a set is that has some particular properties. I have working code for some small parameter values, but I'd like to know how to deal with larger structures.  I know Haskell can do \"infinite data structures\" but I'm just not seeing how to get there from where I'm at and Learn You a Haskell / Google isn't getting me over this.</p>\n\n<p>Here's the working code for my <code>eSet</code> given \"small\" arguments <code>r</code> and <code>t</code></p>\n\n<pre><code>import Control.Monad\nimport System.Environment\nimport System.Exit\n\nmyPred :: [Int] -&gt; Bool\nmyPred a = myPred' [] a\n    where\n        myPred' [] []         = False\n        myPred' [] [0]        = True\n        myPred' _  []         = True\n        myPred' acc (0:aTail) = myPred' acc aTail\n        myPred' acc (a:aTail)\n             | a `elem` acc   = False\n             | otherwise      = myPred' (a:acc) aTail\n\nsuperSet :: Int -&gt; Int -&gt; [[Int]]\nsuperSet r t = replicateM r [0..t]\n\neSet :: Int -&gt; Int -&gt; [[Int]]\neSet r t = filter myPred $ superSet r t\n\nmain :: IO ()\nmain = do\n    args &lt;- getArgs\n    case args of\n        [rArg, tArg] -&gt;\n            print $ length $ eSet (read rArg) (read tArg)\n        [rArg, tArg, \"set\"] -&gt;\n            print $          eSet (read rArg) (read tArg)\n        _ -&gt;\n            die \"Usage: eSet r r set &lt;set optional for printing set itself otherwise just print the size\n</code></pre>\n\n<p>When compiled/run I get</p>\n\n<pre><code>$ ghc eSet.hs -rtsopts\n[1 of 1] Compiling Main             ( eSet.hs, eSet.o )\nLinking eSet ...\n$ # Here's is a tiny eSet to illustrate.  It is the set of lists of r integers from zero to t with no repeated nonzero list entries\n$ ./eSet 4 2 set\n[[0,0,0,0],[0,0,0,1],[0,0,0,2],[0,0,1,0],[0,0,1,2],[0,0,2,0],[0,0,2,1],[0,1,0,0],[0,1,0,2],[0,1,2,0],[0,2,0,0],[0,2,0,1],[0,2,1,0],[1,0,0,0],[1,0,0,2],[1,0,2,0],[1,2,0,0],[2,0,0,0],[2,0,0,1],[2,0,1,0],[2,1,0,0]]\n$ ./eSet 8 4 +RTS -sstderr\n3393\n     174,406,136 bytes allocated in the heap\n      29,061,152 bytes copied during GC\n       4,382,568 bytes maximum residency (7 sample(s))\n         148,664 bytes maximum slop\n              14 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0       328 colls,     0 par    0.047s   0.047s     0.0001s    0.0009s\n  Gen  1         7 colls,     0 par    0.055s   0.055s     0.0079s    0.0147s\n\n  INIT    time    0.000s  (  0.000s elapsed)\n  MUT     time    0.298s  (  0.301s elapsed)\n  GC      time    0.102s  (  0.102s elapsed)\n  EXIT    time    0.001s  (  0.001s elapsed)\n  Total   time    0.406s  (  0.405s elapsed)\n\n  %GC     time      25.1%  (25.2% elapsed)\n\n  Alloc rate    585,308,888 bytes per MUT second\n\n  Productivity  74.8% of total user, 75.0% of total elapsed\n\n$ ./eSet 10 5 +RTS -sstderr\n63591\n  27,478,010,744 bytes allocated in the heap\n   4,638,903,384 bytes copied during GC\n     532,163,096 bytes maximum residency (15 sample(s))\n      16,500,072 bytes maximum slop\n            1556 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0     52656 colls,     0 par    6.865s   6.864s     0.0001s    0.0055s\n  Gen  1        15 colls,     0 par    8.853s   8.997s     0.5998s    1.8617s\n\n  INIT    time    0.000s  (  0.000s elapsed)\n  MUT     time   52.652s  ( 52.796s elapsed)\n  GC      time   15.717s  ( 15.861s elapsed)\n  EXIT    time    0.193s  (  0.211s elapsed)\n  Total   time   68.564s  ( 68.868s elapsed)\n\n  %GC     time      22.9%  (23.0% elapsed)\n\n  Alloc rate    521,883,277 bytes per MUT second\n\n  Productivity  77.1% of total user, 76.7% of total elapsed\n</code></pre>\n\n<p>I see my memory usage is very high and there's a lot of garbage collecting.  When running <code>eSet 12 6</code> I get a Segmentation fault.</p>\n\n<p>I feel like <code>filter myPred $ superSet r t</code> is keeping me from lazily making the subset one part at a time so I can deal with much larger (but finite) sets, but I don't know how to change to another approach that would do that.  I think that's the root of my question.</p>\n\n<p>Also, as this is my first Haskell program, points on style and how to achieve the Haskell analog of \"pythonic\" are much appreciated!</p>\n"}, {"tags": ["haskell", "traversable"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1505950505, "post_id": 46332201, "comment_id": 79627245, "body": "First you would need to create an instance of <code>Foldable</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1505994428, "post_id": 46332201, "comment_id": 79646036, "body": "<code>pure</code> is a function, not a data constructor. The closest thing to a constructor for a function value is a lambda expression: <code>\\x -&gt; x + 1 :: Num a =&gt; (-&gt; a) a</code>. What value of type <code>Num a =&gt; a</code> do you imagine you could extract from this function?"}], "answers": [{"tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": true, "score": 6, "last_activity_date": 1505984737, "last_edit_date": 1505984737, "creation_date": 1505944454, "answer_id": 46332326, "question_id": 46332201, "link": "https://stackoverflow.com/questions/46332201/how-to-write-a-traversable-instance-for-function-in-haskell/46332326#46332326", "title": "How to write a Traversable instance for function, in Haskell?", "body": "<p>Generally there is no such thing as <code>unwrap</code>, consider <code>f</code> being the list functor <code>[]</code> what should <code>unwrap</code> return for <code>[_, _, _]</code> or better yet for the empty list <code>[]</code>? Similar thing with <code>Maybe</code>, suppose <code>h</code> is <code>const Nothing</code>, you would expect to get <code>Nothing</code>. But your line of thought would fail upon trying to <code>unwrap</code> the <code>Nothing</code> into a value <code>a</code>. You can notice that trying to apply <code>pure</code> (to re-pack the result in the functor) means that you expect the result to be always <code>Just</code> for <code>Maybe</code> functor, non-empty for <code>[]</code> etc.</p>\n\n<p>There is little hope for <code>Traversable</code> instance for a reader functor <code>((-&gt;) k)</code>. While it is not proof, a good evidence in that direction is that such an instance is missing from the <code>Prelude</code>. Also to traverse a function and produce a final container (<code>[]</code> or <code>Maybe</code>) you would need to apply your function <code>h</code> to any thinkable output of the function, that is a lot of potential values, in general infinitely many.</p>\n\n<pre><code>Prelude&gt; traverse (\\n -&gt; if n == 42 then Nothing else Just n) [1, 2, 3]\nJust [1,2,3]\nPrelude&gt; traverse (\\n -&gt; if n == 42 then Nothing else Just n) [1..]\nNothing\n</code></pre>\n\n<p>suppose that <code>k</code> is <code>Int</code>, so the functor is <code>Int -&gt;</code>, suppose you have a value <code>g :: Int -&gt; Int</code>, let it be <code>\\n -&gt; if n == 42 then 0 else n</code>, suppose you wanted to traverse that value with the above function, that traversal would be <code>Nothing</code> if <code>g</code> outputs <code>42</code> for any input, but it doesn't. The traversal cannot know that though (it has no access to the code of the function), so it would have to try all outputs.</p>\n\n<p>If <code>k</code> were finite, then you could traverse a function by tabulating it. After traversing the table you could possibly produce a result. This may not be what you are after but:</p>\n\n<pre><code>import Data.Char\nimport Data.Maybe\nimport Data.Word\n\ninstance ( Enum k, Bounded k ) =&gt; Foldable ((-&gt;) k) where\n    foldMap h f = foldMap (h . f) domain\n\ninstance ( Enum k, Bounded k, Eq k ) =&gt; Traversable ((-&gt;) k) where\n    traverse h f = fmap (\\vs k -&gt; fromJust $ k `lookup` zip domain vs) (traverse (h . f) domain)\n\ndomain :: ( Enum k, Bounded k ) =&gt; [k]\ndomain = enumFromTo minBound maxBound\n\ntabulate :: ( Enum k, Bounded k ) =&gt; (k -&gt; a) -&gt; [(k, a)]\ntabulate f = zip domain (map f domain)\n\nf1 :: Bool -&gt; Int\nf1 b = if b then 42 else 666\n\nf2 :: Ordering -&gt; Char\nf2 LT = 'l'\nf2 EQ = 'e'\nf2 GT = 'g'\n\nf3 :: Word8 -&gt; Bool\nf3 n = fromIntegral n &lt; 256\n\nf4 :: Word16 -&gt; Bool\nf4 n = fromIntegral n &lt; 256\n\nmain = do\n    print (tabulate f1)\n    print (tabulate &lt;$&gt; traverse (\\n -&gt; [n, 2*n]) f1)\n    putStrLn \"\"\n    print (tabulate f2)\n    print (tabulate &lt;$&gt; traverse (\\c -&gt; [c, toUpper c]) f2)\n    putStrLn \"\"\n    print (tabulate f3)\n    print (tabulate &lt;$&gt; traverse (\\b -&gt; if b then Just b else Nothing) f3)\n    putStrLn \"\"\n    print (tabulate &lt;$&gt; traverse (\\b -&gt; if b then Just b else Nothing) f4)\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "is_accepted": false, "score": 1, "last_activity_date": 1506136138, "creation_date": 1506136138, "answer_id": 46375634, "question_id": 46332201, "link": "https://stackoverflow.com/questions/46332201/how-to-write-a-traversable-instance-for-function-in-haskell/46375634#46375634", "title": "How to write a Traversable instance for function, in Haskell?", "body": "<blockquote>\n  <p>But, alas, GHC won't let me get away with that:</p>\n</blockquote>\n\n<p>It seems your error is that you tried to use a function (<code>pure</code>) as a pattern. Haskell only allows <em>constructors</em> to appear in patterns. So</p>\n\n<pre><code>unwrap (Just x) = x\n</code></pre>\n\n<p>is valid, while</p>\n\n<pre><code>unwrap (pure x) = x\n</code></pre>\n\n<p>is not. </p>\n"}], "owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 0, "accepted_answer_id": 46332326, "answer_count": 2, "score": 1, "last_activity_date": 1506136138, "creation_date": 1505943809, "question_id": 46332201, "link": "https://stackoverflow.com/questions/46332201/how-to-write-a-traversable-instance-for-function-in-haskell", "title": "How to write a Traversable instance for function, in Haskell?", "body": "<p>How do I write the <em>Traversable</em> instance for <code>((-&gt;) a)</code>?</p>\n\n<p>I think I could do it, <em>if</em> I could generically unwrap an <em>Applicative Functor</em>:</p>\n\n<pre><code>instance Traversable ((-&gt;) k) where\n  -- traverse :: (a -&gt; f b) -&gt; (k -&gt; a) -&gt; f (k -&gt; b)\n  -- traverse h t = ?\n  -- h                     :: Applicative f =&gt; a -&gt; f b\n  -- t                     :: k -&gt; a\n  -- h . t                 :: k -&gt; f b\n  -- unwrap . h . t        :: k -&gt; b\n  -- pure $ unwrap . h . t :: f (k -&gt; b)\n  traverse h t = pure $ unwrap . h . t\n\nunwrap :: (Functor f, Applicative f) =&gt; f a -&gt; a\nunwrap y@(pure x) = x\n</code></pre>\n\n<p>But, alas, GHC won't let me get away with that:</p>\n\n<pre><code>Parse error in pattern: pure\n</code></pre>\n"}, {"tags": ["haskell", "error-handling", "hunit"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 2, "creation_date": 1505941953, "post_id": 46330592, "comment_id": 79624450, "body": "The <code>HUnit-Plus</code> package provides <a href=\"https://hackage.haskell.org/package/HUnit-Plus-2.0.0/docs/Test-HUnitPlus-Base.html#v:assertThrows\" rel=\"nofollow noreferrer\"><code>assertThrows</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 5, "last_activity_date": 1505938119, "creation_date": 1505938119, "answer_id": 46330966, "question_id": 46330592, "link": "https://stackoverflow.com/questions/46330592/is-it-possible-to-assert-an-error-case-in-hunit/46330966#46330966", "title": "Is it possible to assert an error case in HUnit?", "body": "<p>You can catch an error and assert if it doesn't happen using standard exception handling:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>errored &lt;- catch (somethingThatErrors &gt;&gt; pure False) handler\nif errored then\n    assertFailure \"Did not catch expected error\"\nelse\n    pure ()\nwhere\n   handler :: ErrorCall -&gt; IO Bool\n   handler _ = pure True\n</code></pre>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "accepted_answer_id": 46330966, "answer_count": 1, "score": 5, "last_activity_date": 1505938119, "creation_date": 1505936665, "question_id": 46330592, "link": "https://stackoverflow.com/questions/46330592/is-it-possible-to-assert-an-error-case-in-hunit", "title": "Is it possible to assert an error case in HUnit?", "body": "<p>If I have a function which results in an error for a certain input, is it possible to write a test verifying the error occurs for that input?</p>\n\n<p>I do not find this \"assert error\" functionality available in <a href=\"https://hackage.haskell.org/package/HUnit-1.6.0.0/docs/Test-HUnit-Base.html\" rel=\"noreferrer\">HUnit</a>. Is it available in HUnit or perhaps in some other test package?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1505928048, "post_id": 46328183, "comment_id": 79617262, "body": "read parses the 1-char string into another datastructure. This can be anything. But here it is probably an <code>Int</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1505929892, "post_id": 46328406, "comment_id": 79618359, "body": "<a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Char.html#v:digitToInt\" rel=\"nofollow noreferrer\"><code>digitToInt</code></a> is even more elegant than <code>read . pure</code>."}, {"owner": {"reputation": 77, "user_id": 8453107, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c7515e106e298934473ed3faaf3062c?s=128&d=identicon&r=PG&f=1", "display_name": "JavaDeveloper", "link": "https://stackoverflow.com/users/8453107/javadeveloper"}, "edited": false, "score": 0, "creation_date": 1506051482, "post_id": 46328406, "comment_id": 79672696, "body": "Thanks...it indeed helps a lot... Also i read that read functions can only give us numerical types such as an Int or a double...cam you explain more about it"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 77, "user_id": 8453107, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c7515e106e298934473ed3faaf3062c?s=128&d=identicon&r=PG&f=1", "display_name": "JavaDeveloper", "link": "https://stackoverflow.com/users/8453107/javadeveloper"}, "edited": false, "score": 0, "creation_date": 1506060218, "post_id": 46328406, "comment_id": 79675354, "body": "@DaminShah: no, <code>read</code> can produce all types for which the type constraint <code>Read</code> holds."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1505930533, "last_edit_date": 1505930533, "creation_date": 1505928786, "answer_id": 46328406, "question_id": 46328183, "link": "https://stackoverflow.com/questions/46328183/can-anyone-explain-me-the-meaning-of-read-function-in-the-following-code-in-hask/46328406#46328406", "title": "Can anyone explain me the meaning of read function in the following code in haskell", "body": "<blockquote>\n  <p><strong>Note</strong>: all <code>toDigits</code> here only work with positive numbers (zero included), and will error on negative numbers.</p>\n</blockquote>\n\n<p><code>read</code> has signature:</p>\n\n<pre><code>read :: Read a =&gt; String -&gt; a\n</code></pre>\n\n<p>So based on the signature we can say that if a type <code>a</code> is <code>Read a</code>, then it turns a <code>String</code> into that <code>a</code>. In natural language it means that it <em>parses</em> a textual representation of an object into that object. For instance it can parse <code>\"\\\"foo\\\"\"</code> into the String <code>\"foo\"</code>. Or it can parse <code>\"23\"</code> into the integer <code>23</code>. It is the output type that determines into what we parse the elements, but based on the function, it has probably some type signature <code>toDigits :: Int -&gt; Int</code>.</p>\n\n<p>Nowe we still have to understand how the function works. <code>show :: Show a =&gt; a -&gt; String</code> is actually the opposite of <code>read</code>: it converts an object into a textual representation. So <code>23</code> is for instance converted into <code>\"23\"</code>, a <code>String</code>.</p>\n\n<p>So first we convert a number, for instance <code>1425</code> into <code>\"1425\"</code>. A <code>String</code> is a <em>list</em> of <code>Char</code>s, or more formal <code>type String = [Char]</code>. So that means we can perform a <code>map</code> on it, and <code>map</code> will thus process each <code>Char</code> of the <code>String</code>, one at a time.</p>\n\n<p>Now for each char <code>c</code>, we first construct a list <code>[c]</code>. Why do we do that? To make it a <code>String</code>. Since a <code>String</code> is a list of chars. A list with one character is equal to a string with that character. Next we call read on the 1-char String, to turn it into whatever we like.</p>\n\n<p>This means that <code>toDigits</code> has as most generic type:</p>\n\n<pre><code>toDigits :: (Show a, Read b) =&gt; a -&gt; [b]\n</code></pre>\n\n<p>Note that according to this signature, we are not bounded by the fact that <code>a</code> should be a number, nor that the output should be numbers. As long as the textual representation of the <code>a</code> object can be split into 1-char strings that can be parsed indivudually into object of <code>b</code>, we are fine. However in reality, it will probably only make sense if both <code>a</code> and <code>b</code> are <code>Integral</code>, so:</p>\n\n<pre><code>toDigits :: (Show a, Read b, Integral a, Integral b) =&gt; a -&gt; [b]\n</code></pre>\n\n<p>A final note is that we can make the implementation a bit more elegant, like:</p>\n\n<pre><code>toDigits :: (Show a, Read b, Integral a, Integral b) =&gt; a -&gt; [b]\ntoDigits = map (read . pure) . show\n</code></pre>\n\n<p>We can further restrict the output type to <code>Int</code>, since an <code>Int</code> is guaranteed to have all numbers between (and including) 0 and 9, and construct:</p>\n\n<pre><code>import Data.Char(digitToInt)\n\ntoDigits :: (Show a, Integral a) =&gt; a -&gt; [Int]\ntoDigits = map digitToInt . show\n</code></pre>\n\n<p>That being said, the function makes some assumptions: for instance that all numbers will have a textual representation that is the decimal notation. This is not per se guaranteed: I could construct my own number system, and decide to construct a show that for instance uses the unary system (although that is probably not a good idea). This makes it a bit a <em>dangerous</em> approach: you rely on some assumptions that are not guaranteed. Furthermore this </p>\n\n<p>We can use the <code>div</code> and <code>mod</code> to calculate the digits. For instance like:</p>\n\n<pre><code>toDigits :: Integral a =&gt; a -&gt; [a]\ntoDigits 0 = [0]\ntoDigits n | n &lt; 0 = error \"Negative number!\"\n           | otherwise = step [] n\n    where step xs 0 = xs\n          step xs d = step ((mod d 10):xs) (div d 10)\n</code></pre>\n\n<p>furthermore we dropped the <code>Show a</code> type constraint, so integrals that do not have such <code>show</code> can still be handled.</p>\n"}], "owner": {"reputation": 77, "user_id": 8453107, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0c7515e106e298934473ed3faaf3062c?s=128&d=identicon&r=PG&f=1", "display_name": "JavaDeveloper", "link": "https://stackoverflow.com/users/8453107/javadeveloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 46328406, "answer_count": 1, "score": 1, "last_activity_date": 1505930533, "creation_date": 1505927982, "last_edit_date": 1505928008, "question_id": 46328183, "link": "https://stackoverflow.com/questions/46328183/can-anyone-explain-me-the-meaning-of-read-function-in-the-following-code-in-hask", "title": "Can anyone explain me the meaning of read function in the following code in haskell", "body": "<pre><code>toDigits n = map (\\c -&gt; read [c]) (show n)\n</code></pre>\n\n<p>I'm unable to understand the meaning of read function in the above code</p>\n"}, {"tags": ["string", "function", "haskell", "boolean", "compare"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505927950, "post_id": 46328106, "comment_id": 79617216, "body": "Can you post the request in verbatim? The way you describe it, is not very clear."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505928968, "post_id": 46328106, "comment_id": 79617854, "body": "So if I understand it correctly, both strings have the format <code>a*h*</code> (that&#39;s a regex, the <code>*</code> means *any number of the previous char), and the number of <code>a</code>&#39;s and <code>h</code>s should be greater than or equal to the requested aahh?"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 2, "creation_date": 1505929432, "post_id": 46328106, "comment_id": 79618127, "body": "What should be the output of <code>seeDoctor &quot;foo&quot; &quot;aaaaaaaah&quot;</code>?"}, {"owner": {"reputation": 299, "user_id": 8604329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34e9794ad93744d1fcf341dfb763b345?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Robbins", "link": "https://stackoverflow.com/users/8604329/matt-robbins"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1505932915, "post_id": 46328106, "comment_id": 79619997, "body": "I believe it should be False in that case, @MarkSeemann."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1505939776, "post_id": 46328106, "comment_id": 79623483, "body": "Why don&#39;t you just filter <code>&#39;a&#39;</code>s and <code>compare</code> their length..?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1505945065, "post_id": 46328106, "comment_id": 79625626, "body": "Also notice your first attempt is a common antipattern.  Any time you see <code>if p then True else False</code> you can just write <code>p</code>.  In this case you could even have written <code>seeDoctor = (==)</code> and not been explicit about the arguments."}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 7, "last_activity_date": 1505934609, "creation_date": 1505934609, "answer_id": 46330016, "question_id": 46328106, "link": "https://stackoverflow.com/questions/46328106/comparing-two-strings-in-haskell/46330016#46330016", "title": "Comparing two strings in Haskell", "body": "<p>Since you're trying to learn Haskell, I'm not going to give you a solution, but I'll try to give you enough hints to enable you to put a function together yourself.</p>\n\n<p>Strings are lists, so you can use the normal list functions from <code>Data.List</code>. For instance, <code>isSubsequenceOf</code> almost does what you need:</p>\n\n<pre><code>Prelude Data.List&gt; isSubsequenceOf \"aah\" \"aaah\"\nTrue\nPrelude Data.List&gt; isSubsequenceOf \"aaaah\" \"aah\"\nFalse\n</code></pre>\n\n<p>If I interpret the problem description correctly, you should probably also check that only <code>a</code> and <code>h</code> are in the input strings, and that <code>h</code> is the last character.</p>\n\n<p>In order to check that <code>h</code> is the last character, you could use the <code>last</code> function:</p>\n\n<pre><code>Prelude Data.List&gt; last \"aaaah\"\n'h'\nPrelude Data.List&gt; last \"ah\"\n'h'\nPrelude Data.List&gt; last \"foo\"\n'o'\n</code></pre>\n\n<p>Perhaps you'd also want to check the input for rogue characters, and return <code>False</code> if the two strings contain any other character than <code>a</code> and <code>h</code>...</p>\n\n<pre><code>Prelude Data.List&gt; all (\\c -&gt; c == 'a' || c == 'h') \"aaah\"\nTrue\nPrelude Data.List&gt; all (\\c -&gt; c == 'a' || c == 'h') \"aaah!\"\nFalse\n</code></pre>\n\n<p>What would you do about a string like <code>\"aha\"</code>, though? I'll leave that as an exercise :)</p>\n"}], "owner": {"reputation": 299, "user_id": 8604329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34e9794ad93744d1fcf341dfb763b345?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Robbins", "link": "https://stackoverflow.com/users/8604329/matt-robbins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13093, "favorite_count": 0, "accepted_answer_id": 46330016, "answer_count": 1, "score": 3, "last_activity_date": 1505934609, "creation_date": 1505927678, "last_edit_date": 1505928832, "question_id": 46328106, "link": "https://stackoverflow.com/questions/46328106/comparing-two-strings-in-haskell", "title": "Comparing two strings in Haskell", "body": "<p>I came across a rather silly practice problem that was listed as easy, so I thought I could do it.  The premise is that a doctor must hear a patient say aah in order to give a diagnosis, but the aah from the patient must match the aah requested by the doctor.  If the doctor asks for aaaaah and the patient says ah, then no diagnosis can be given.  The Haskell program is supposed to read in a doctor and a patient aah in that order and return a Bool value for if a diagnosis may be given.  At first I thought they needed to be identical so this was my code:</p>\n\n<pre><code>seeDoctor :: String -&gt; String -&gt; Bool\nseeDoctor a b = if a == b then True\n                else False\n</code></pre>\n\n<p>However, I realized I wasn't following all the rules of the problem and it wasn't so simple.  The patient may say aah for longer than the doctor and return True, so \"aah\" \"aaaah\" returns True, as does \"\" \"aaah\" and \"h\" \"aah\", but \"aaah\" \"ah\" returns False. But even if the doctor doesn't include an 'h' in their aah, the patient must, so \"a\" \"a\" returns False, but my code would return True. So if the patient says anything, it must be the necessary number of 'a's followed by a single 'h' and no other characters.  You see, once I started trying the suggested test cases, I realized how little I understood.  Can I keep a count of 'a' in each string? How do I check for extra characters? Sorry this took a while to read. Thanks for making it this far.</p>\n\n<p>Here is the exact question:</p>\n\n<blockquote>\n  <p>\"When we go to see a doctor, the doctor always asks us to say \"aaah\".\n  Sometimes, the doctor needs us to say \"aaaaaah\", but we are only able\n  to say \"aaah\". In that case, the doctor is unable to diagnose our\n  disease, because the 'a's in our \"aaah\" are fewer than his or her\n  requirements. Now, write a Haskell function called seeDoctor to judge\n  if the doctor can diagnose us with our \"aah\". The input of the\n  function consists of two strings. The first string is the \"aaaah\" the\n  doctor needs and the second string is the \"aah\" we are able to say.\n  Output \"True\" if our \"aah\" meets the requirements of the doctor, and\n  output \"False\" otherwise. The test should pass with a \"True\" only when\n  lowercase 'a's and 'h's are used, and each string contains a certain\n  number of 'a's followed by a single 'h'.\"</p>\n</blockquote>\n"}, {"tags": ["haskell", "polymorphism"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1505937648, "post_id": 46327990, "comment_id": 79622470, "body": "The second example doesn&#39;t involve any rank 2 types. It is the same as <code>:t (undefined :: a -&gt; String ) . (undefined :: String -&gt; b)</code>. It just has the <code>forall</code> written explicitly instead of implicitly."}], "answers": [{"tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 7, "last_activity_date": 1505927854, "creation_date": 1505927854, "answer_id": 46328148, "question_id": 46327990, "link": "https://stackoverflow.com/questions/46327990/illegal-polymorphic-or-qualified-type-in-typeclass/46328148#46328148", "title": "Illegal polymorphic or qualified type in typeclass", "body": "<p><code>ListModifier</code> is a type alias, not a \u201creal\u201d type. Type aliases are essentially macros at the type level, always expanded by the typechecker before actually typechecking. That means your instance declaration is equivalent to the following:</p>\n\n<pre><code>instance Monoid (forall a. s -&gt; [a] -&gt; [a]) where\n</code></pre>\n\n<p>Even if that <em>were</em> allowed, it would overlap with the existing <code>Monoid (a -&gt; b)</code> instance, so it still wouldn\u2019t work. The larger problem, however, is that you can\u2019t have an instance defined on a <code>forall</code>-quantified type because it wouldn\u2019t make sense from the perspective of instance resolution.</p>\n\n<p>What you could do instead is define a fresh type instead of a type alias using <code>newtype</code>:</p>\n\n<pre><code>newtype ListModifier s = ListModifier (forall a. s -&gt; [a] -&gt; [a])\n</code></pre>\n\n<p>Now you can define a <code>Monoid</code> instance, since typeclass resolution only needs to look for the <code>ListModifier</code> type, which is much simpler to match on:</p>\n\n<pre><code>instance Monoid (ListModifier s) where\n  mempty = ListModifier (const id)\n  mappend (ListModifier f) (ListModifier g) = ListModifier (\\st -&gt; f st . g st)\n</code></pre>\n\n<p>Alternatively, you could keep your type alias and define a newtype with a different name, like <code>ReifiedListModifier</code>, then define an instance on that, and you could only do the wrapping when you need to store a <code>ListModifier</code> in a container or use a typeclass instance.</p>\n"}], "owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 46328148, "answer_count": 1, "score": 0, "last_activity_date": 1505927854, "creation_date": 1505927296, "question_id": 46327990, "link": "https://stackoverflow.com/questions/46327990/illegal-polymorphic-or-qualified-type-in-typeclass", "title": "Illegal polymorphic or qualified type in typeclass", "body": "<p>The following file <code>Poly.hs</code> file</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE TypeSynonymInstances #-}\n{-# LANGUAGE RankNTypes #-}\nmodule Poly () where\n\ntype ListModifier s = forall a. s -&gt; [a] -&gt; [a]\n\ninstance Monoid (ListModifier s) where\n  mempty = const id\n  mappend f g st = f st . g st\n</code></pre>\n\n<p>Gets the typechecker to complain:</p>\n\n<pre><code>Poly.hs:8:10: Illegal polymorphic or qualified type: ListModifier s \u2026\n    In the instance declaration for \u2018Monoid (ListModifier s)\u2019\nCompilation failed.\n</code></pre>\n\n<p>Initially I though it couldn't compose the rank 2 types but:</p>\n\n<pre><code>\u03bb&gt; :t (undefined :: forall a . a -&gt; String ) . (undefined :: forall b . String -&gt; b)\n(undefined :: forall a . a -&gt; String ) . (undefined :: forall b . String -&gt; b)\n  :: String -&gt; String\n</code></pre>\n\n<p>I feel the <code>Poly</code> module is in some way inherently inconsistent but I can't put my finger on the problem.</p>\n"}, {"tags": ["haskell", "terminal", "parsec"], "comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1505926841, "post_id": 46327846, "comment_id": 79616572, "body": "Can you post the command line? Have you listed it in your cabal file?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1505926984, "post_id": 46327846, "comment_id": 79616643, "body": "Also the output of <code>stack exec -- ghc-pkg list</code> would be helpful"}, {"owner": {"reputation": 1, "user_id": 5293231, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CI0thKfUurA/AAAAAAAAAAI/AAAAAAAAApg/wUKaoGmAGUw/photo.jpg?sz=128", "display_name": "Hannah Deen", "link": "https://stackoverflow.com/users/5293231/hannah-deen"}, "edited": false, "score": 0, "creation_date": 1505927130, "post_id": 46327846, "comment_id": 79616717, "body": "updated to answer questions"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1505954271, "post_id": 46327846, "comment_id": 79628035, "body": "What command are you using to compile your program? If you&#39;re in a cabal project (using <code>cabal build</code> or <code>stack build</code>) you must add parsec as a dependency in the .cabal file."}], "owner": {"reputation": 1, "user_id": 5293231, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CI0thKfUurA/AAAAAAAAAAI/AAAAAAAAApg/wUKaoGmAGUw/photo.jpg?sz=128", "display_name": "Hannah Deen", "link": "https://stackoverflow.com/users/5293231/hannah-deen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 337, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505927679, "creation_date": 1505926746, "last_edit_date": 1505927679, "question_id": 46327846, "link": "https://stackoverflow.com/questions/46327846/parsec-module-not-found-in-ghc", "title": "Parsec Module not found in GHC", "body": "<p>I keep getting the error:</p>\n\n<pre><code>error:\n    Could not find module \u2018Text.Parsec.Expr\u2019\n    Use -v to see a list of the files searched for.\n</code></pre>\n\n<p>I have the newest haskell/ghc and have run <code>cabal install parsec</code> &amp;&amp; <code>stack install parsec</code></p>\n\n<p>no matter what i do it cannot find the module</p>\n\n<p>EDIT:</p>\n\n<p>Can you post the command line? Have you listed it in your cabal file? \u2013 Paul Johnson 3 mins ago </p>\n\n<p>it was my first install of cabal so it said it would generate the file for me.</p>\n\n<p>cmd line</p>\n\n<pre><code>    PA1Helper.hs:3:1: error:\n    Could not find module \u2018Text.Parsec\u2019\n    Use -v to see a list of the files searched for.\n  |\n3 | import Text.Parsec\n  | ^^^^^^^^^^^^^^^^^^\n\nPA1Helper.hs:4:1: error:\n    Could not find module \u2018Text.Parsec.String\u2019\n    Use -v to see a list of the files searched for.\n  |\n4 | import Text.Parsec.String\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^\n\nPA1Helper.hs:5:1: error:\n    Could not find module \u2018Text.Parsec.Expr\u2019\n    Use -v to see a list of the files searched for.\n  |\n5 | import Text.Parsec.Expr\n  | ^^^^^^^^^^^^^^^^^^^^^^^\n\nPA1Helper.hs:6:1: error:\n    Could not find module \u2018Text.Parsec.Token\u2019\n    Use -v to see a list of the files searched for.\n  |\n6 | import Text.Parsec.Token\n  | ^^^^^^^^^^^^^^^^^^^^^^^^\n\nPA1Helper.hs:7:1: error:\n    Could not find module \u2018Text.Parsec.Language\u2019\n    Use -v to see a list of the files searched for.\n  |\n7 | import Text.Parsec.Language\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nPA1Helper.hs:8:1: error:\n    Could not find module \u2018Text.Parsec.Char\u2019\n    Use -v to see a list of the files searched for.\n  |\n8 | import Text.Parsec.Char\n  | ^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Also the output of stack exec -- ghc-pkg list would be helpful:</p>\n\n<pre><code>Cabal-1.24.2.0\narray-0.5.1.1\nbase-4.9.1.0\nbinary-0.8.3.0\nbytestring-0.10.8.1\ncontainers-0.5.7.1\ndeepseq-1.4.2.0\ndirectory-1.3.0.0\nfilepath-1.4.1.1\nghc-8.0.2\nghc-boot-8.0.2\nghc-boot-th-8.0.2\nghc-prim-0.5.0.0\nghci-8.0.2\nhaskeline-0.7.3.0\nhoopl-3.10.2.1\nhpc-0.6.0.3\ninteger-gmp-1.0.0.1\npretty-1.1.3.3\nprocess-1.4.3.0\nrts-1.0\ntemplate-haskell-2.11.1.0\nterminfo-0.4.0.2\ntime-1.6.0.1\ntransformers-0.5.2.0\nunix-2.7.2.1\nxhtml-3000.2.1\n/Users/hannahdeen/.stack/snapshots/x86_64-osx/lts-9.5/8.0.2/pkgdb\n    mtl-2.2.1\n    parsec-3.1.11\n    text-1.2.2.2\n/Users/hannahdeen/.stack/global-project/.stack-work/install/x86_64-osx/lts-9.5/8.0.2/pkgdb\n    (no packages)\n</code></pre>\n"}, {"tags": ["haskell", "types", "z3", "sbv"], "answers": [{"comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1505926857, "post_id": 46327828, "comment_id": 79616580, "body": "Really? It has the type <code>SymWord a =&gt; a -&gt; SBV a</code>, and I don&#39;t see a <code>SymWord Integer</code> instance."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1505927000, "post_id": 46327828, "comment_id": 79616653, "body": "Nevermind, there must be. There&#39;s a <a href=\"https://hackage.haskell.org/package/sbv-7.3/docs/Data-SBV.html#t:SIntegral\" rel=\"nofollow noreferrer\"><code>SIntegral Integer</code></a> instance."}, {"owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1505927250, "post_id": 46327828, "comment_id": 79616788, "body": "@Cirdec is right. It&#39;s important to be clear about the precise type; You can use <code>IntN</code> or <code>WordN</code> for <code>N=8,16,32,64</code>, or just <code>Integer</code>; whichever fits your purpose."}], "tags": [], "owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "is_accepted": true, "score": 5, "last_activity_date": 1505937387, "last_edit_date": 1505937387, "creation_date": 1505926661, "answer_id": 46327828, "question_id": 46327632, "link": "https://stackoverflow.com/questions/46327632/turning-haskell-int-values-into-constants-for-sbv-constraints/46327828#46327828", "title": "Turning Haskell Int values into Constants for SBV constraints", "body": "<p>The function <a href=\"https://hackage.haskell.org/package/sbv-7.3/docs/Data-SBV.html#v:literal\" rel=\"nofollow noreferrer\">literal</a> should do it. You'll probably have to be more clear on the type though, such as <code>Integer</code>, <code>Int8</code>, <code>Int16</code> etc. instead of just <code>Int</code>.</p>\n\n<p>You can also just do <code>fromIntegral</code>, since numeric symbolic types are instances of the <code>Num</code> class:</p>\n\n<pre><code>Prelude Data.SBV&gt; (fromIntegral (2::Int)) :: SInteger\n2 :: SInteger\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 1612614, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1eb300f91a6949bb637dfe98bbb9d11f?s=128&d=identicon&r=PG", "display_name": "Matt Ahrens", "link": "https://stackoverflow.com/users/1612614/matt-ahrens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "accepted_answer_id": 46327828, "answer_count": 1, "score": 4, "last_activity_date": 1505937387, "creation_date": 1505926035, "question_id": 46327632, "link": "https://stackoverflow.com/questions/46327632/turning-haskell-int-values-into-constants-for-sbv-constraints", "title": "Turning Haskell Int values into Constants for SBV constraints", "body": "<p>I see lots of examples of the SBV library being used like so:</p>\n\n<pre><code>f :: IO SatResult\nf = sat $ do\n      x &lt;- sInteger \"x\"\n      constraint $ x .&lt; 200\n</code></pre>\n\n<p>For a function that takes in a Haskell Int, I would like to use that Int in my constraint formulas being passed to Z3 via the Data.SBV library:</p>\n\n<pre><code>f :: Int -&gt; IO SatResult\nf i = sat $ do\n          x &lt;- sInteger \"x\"\n          constraint $ x .&lt; (g i)\n        where\n          g = ???\n</code></pre>\n\n<p>How can I convert from a Haskell Int to an SInteger or some appropriate instance of OrdSymbolic and EqSymbolic to be used with (.&lt;) and (.==)?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1505923992, "post_id": 46326880, "comment_id": 79614845, "body": "To me, this sounds like a problem with <code>createNode</code>, not a problem with <code>chunksOf</code>. Perhaps you&#39;d better follow the usual advice: include enough code that we can reproduce your problem -- and be sure to say exactly what the problem is (e.g. use a concrete list that we can type into ghci rather than a schematic list like <code>[x,y,z,d,f,g,h,s,t,q]</code> together with the concrete output you expect)."}, {"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1506146529, "post_id": 46326880, "comment_id": 79711935, "body": "I agree with @DanielWagner. May be you should modify your createNode or create a helper function to intermediate between your list and your createNode function. It depends on your problem."}], "answers": [{"comments": [{"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "edited": false, "score": 0, "creation_date": 1506146660, "post_id": 46328036, "comment_id": 79711956, "body": "+1 for the pair function. I love the simplicity and effectiveness, though I don&#39;t know about its performance."}, {"owner": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "reply_to_user": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "edited": false, "score": 0, "creation_date": 1506212668, "post_id": 46328036, "comment_id": 79728911, "body": "As implemented here, <code>pair</code> is not an efficient function, to be sure. But for this example it&#39;s nicely illustrative :)"}], "tags": [], "owner": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "is_accepted": false, "score": 2, "last_activity_date": 1537212788, "last_edit_date": 1537212788, "creation_date": 1505927446, "answer_id": 46328036, "question_id": 46326880, "link": "https://stackoverflow.com/questions/46326880/is-there-a-way-to-use-chunksof-without-creating-nested-lists/46328036#46328036", "title": "Is there a way to use chunksOf without creating nested lists?", "body": "<p>Since <code>chunksOf</code> is able to produce dynamically sized chunks (ie. the size of the chunk depends on the <code>Int</code> argument which is only known at runtime), it must return a list. A regular tuple cannot work because tuples in Haskell have fixed, static length.</p>\n\n<p>As for this specific problem, you can use a pairing function instead of <code>chunksOf</code>:</p>\n\n<pre><code>pair :: [a] -&gt; [(a, a)]\npair = liftM2 zip odds evens\n</code></pre>\n\n<p>where <code>odds</code> and <code>evens</code> respectively pick the odd and even ordinal elements. Then your example is simply</p>\n\n<pre><code>newMerk &lt;- map (uncurry createNode) (pair mrk)\n</code></pre>\n\n<p>For extra <em>Fun</em>\u2122, you could try to write a function along these lines:</p>\n\n<pre><code>{-# LANGUAGE DataKinds, TypeFamiles #-}\n\nimport Data.Proxy\nimport GHC.TypeLits\n\ntype family Tuple (n :: Nat) a where\n    Tuple 1 a = a\n    Tuple 2 a = (a, a)\n    Tuple 3 a = (a, a, a)\n    Tuple 4 a = (a, a, a, a)\n    ...\n\nchunksOf :: KnownNat n =&gt; Proxy n -&gt; [a] -&gt; [Tuple n a]\nchunksOf p xs = ???\n</code></pre>\n\n<p>But this seems like a lot more trouble than it's worth. I'm not even sure how to implement such a function with the dependently-typed tools available in current GHC and I expect writing a function to consume <code>[Tuple n a]</code> would be a headache as well.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "is_accepted": false, "score": 0, "last_activity_date": 1506136640, "creation_date": 1506136640, "answer_id": 46375677, "question_id": 46326880, "link": "https://stackoverflow.com/questions/46326880/is-there-a-way-to-use-chunksof-without-creating-nested-lists/46375677#46375677", "title": "Is there a way to use chunksOf without creating nested lists?", "body": "<p>Use tuples instead. </p>\n\n<pre><code>newMerk &lt;- map (\\[x, y] -&gt; createNode x y) . chuncksOf 2 $ mrk\n</code></pre>\n\n<p>is a bad idea because <code>[x,y]</code> could fail to match. <code>chunksOf</code> will eventually spit back a list with one element if <code>mrk</code> has an odd number of elements. So you should try to make <code>mrk</code> a list of tuples instead.</p>\n\n<blockquote>\n  <p>[x, y, z, d, f, g, h, s, t, q] I would like this to work out so it looks like this after. [xy, zd, fg, hs, tq] instead of [[xy], [zd], [fg], [hs], [tq]]</p>\n</blockquote>\n\n<p>This doesn't make sense in general. If you can concatenate the elements of the list, you could use <code>fmap mconcat</code>, but I don't think that's the case here. Instead, construct the list to contain tuples by default.</p>\n"}], "owner": {"reputation": 37, "user_id": 8566256, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/3c79cd07c6ade981058759288c6abfcf?s=128&d=identicon&r=PG&f=1", "display_name": "hawkeye", "link": "https://stackoverflow.com/users/8566256/hawkeye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1537212788, "creation_date": 1505923509, "question_id": 46326880, "link": "https://stackoverflow.com/questions/46326880/is-there-a-way-to-use-chunksof-without-creating-nested-lists", "title": "Is there a way to use chunksOf without creating nested lists?", "body": "<p>I'm trying to use the chunksOf function to map a function onto two items at a time in a current list so for example.</p>\n\n<pre><code>newMerk &lt;- map (\\[x, y] -&gt; createNode x y) . chuncksOf 2 $ mrk\n</code></pre>\n\n<p>and lets say we have a list [x, y, z, d, f, g, h, s, t, q] I would like this to work out so it looks like this after. [xy, zd, fg, hs, tq] instead of [[xy], [zd], [fg], [hs], [tq]]</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8642606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdc2e36ef407826db2846bc81d81076d?s=128&d=identicon&r=PG&f=1", "display_name": "nnnachev", "link": "https://stackoverflow.com/users/8642606/nnnachev"}, "edited": false, "score": 0, "creation_date": 1505923884, "post_id": 46326868, "comment_id": 79614780, "body": "Thank you very much for the fast and useful response!"}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 1, "last_activity_date": 1505923458, "creation_date": 1505923458, "answer_id": 46326868, "question_id": 46326694, "link": "https://stackoverflow.com/questions/46326694/haskell-pattern-matching-specifying-the-number-of-elements-in-a-list/46326868#46326868", "title": "Haskell Pattern Matching: Specifying the number of elements in a list", "body": "<p>It may help to first write the function that swaps the second value in a list with the third.</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>swap (x:y:z:rest) = x:z:z:rest\nswap xs = xs\n</code></pre>\n\n<p>In the above, <code>x:y:z:rest</code> matches a list of at least length 3. The value of <code>rest</code>, since it is at the end of the pattern, will match any kind of list, both empty and full. The second pattern match of <code>xs</code> is a catch-all for any other type of list, which will just return the same list if it is less than 3 items long.</p>\n\n<p>From there, you can write <code>f</code> in terms of mapping over the outer list and applying <code>swap</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f = map swap\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8642606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdc2e36ef407826db2846bc81d81076d?s=128&d=identicon&r=PG&f=1", "display_name": "nnnachev", "link": "https://stackoverflow.com/users/8642606/nnnachev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 843, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1505923938, "creation_date": 1505922888, "last_edit_date": 1505923938, "question_id": 46326694, "link": "https://stackoverflow.com/questions/46326694/haskell-pattern-matching-specifying-the-number-of-elements-in-a-list", "title": "Haskell Pattern Matching: Specifying the number of elements in a list", "body": "<p>So i am currently working with Haskell at my college, but kinda struggling with pattern-matching and to be more specific i'll give the program, that i am to solve:</p>\n\n<p>My function is awaiting a list of lists ( with each list containing at least 3 elements ) and in each list the second element is replaced with the number of the third element. </p>\n\n<p>Example: </p>\n\n<p><code>[[1,2,3],[4,5,6,7],[8,9,10]]</code> should become <code>[[1,3,3],[4,6,6,7],[8,10,10]</code></p>\n\n<p>So far I've made the following:</p>\n\n<pre><code> f [] = []\n f [[x]] = []\n f [[x,y]] = []\n f [[x,y,z]] = [[x,z,z]]\n f ([x,y,z]:xs) = [x,z,z]:f(xs)\n</code></pre>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>How can i identify, that some lists may contain more than 3 elements and that the list must remain the same, only the 2nd element changes.</p></li>\n<li><p>How can i make the recursion, so that it handles exceptions (for example the first list has 4 elements).\nThank you in advance!</p></li>\n</ol>\n"}, {"tags": ["haskell", "function-composition"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1506047041, "post_id": 46326244, "comment_id": 79671657, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/46131310/haskell-having-trouble-understanding-a-small-bit-of-code\">Haskell - Having trouble understanding a small bit of code</a>"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1505922589, "creation_date": 1505922589, "answer_id": 46326558, "question_id": 46326244, "link": "https://stackoverflow.com/questions/46326244/function-composition-in-haskell-example/46326558#46326558", "title": "Function composition in Haskell example", "body": "<p>It is given <em>implicitly</em>. If you write:</p>\n\n<pre><code>map (\\a -&gt; ((head a), (length a))) . group . sort\n</code></pre>\n\n<p>this is actually short for:</p>\n\n<pre><code>\\b -&gt; (map (\\a -&gt; ((head a), (length a))) . group . sort) b\n</code></pre>\n\n<p>which is equivalent to:</p>\n\n<pre><code>\\b -&gt; map (\\a -&gt; ((head a), (length a))) $ group $ sort b\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>\\b -&gt; map (\\a -&gt; ((head a), (length a))) (group (sort b))\n</code></pre>\n\n<p>The <code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code> operator, thus composes two functions together in some sort of pipeline:</p>\n\n<pre><code>(.) f g x = f (g x)\n</code></pre>\n\n<p>Since we here write three functions separated by dots:</p>\n\n<pre><code>   map (\\a -&gt; ((head a), (length a))) . group . sort\n-- \\_________________ ______________/   \\_ _/   \\_ /\n--                   v                    v       v\n--                   f                    g       h\n</code></pre>\n\n<p>we have defined some sort of pipeline where an element is first processed through <code>h</code>, then the result is processed through <code>g</code>, and finally the result of that is processed through <code>f</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1505922756, "creation_date": 1505922756, "answer_id": 46326615, "question_id": 46326244, "link": "https://stackoverflow.com/questions/46326244/function-composition-in-haskell-example/46326615#46326615", "title": "Function composition in Haskell example", "body": "<p>The dot is itself a function, defined like this:</p>\n\n<pre><code>(f . g) x = f (g x)\n</code></pre>\n\n<p>Let's use this equation in the first argument to the outer map:</p>\n\n<pre><code>map (\\a -&gt; (head a, length a)) . group . sort\n= { definition of (.), with map (\\a -&gt; ...) as f and group . sort as g }\n\\x -&gt; map (\\a -&gt; (head a, length a)) ((group . sort) x)\n</code></pre>\n\n<p>So, <code>map (\\a -&gt; ...) . group . sort</code> is a function which, when applied to argument <code>x</code>, supplies <code>(group . sort) x</code> as an argument to <code>map (\\a -&gt; ...)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 402, "user_id": 4106764, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iFnH0.jpg?s=128&g=1", "display_name": "Ignacio Tiraboschi", "link": "https://stackoverflow.com/users/4106764/ignacio-tiraboschi"}, "is_accepted": true, "score": 2, "last_activity_date": 1505943539, "last_edit_date": 1505943539, "creation_date": 1505943229, "answer_id": 46332089, "question_id": 46326244, "link": "https://stackoverflow.com/questions/46326244/function-composition-in-haskell-example/46332089#46332089", "title": "Function composition in Haskell example", "body": "<p>What you have noticed is called <a href=\"https://wiki.haskell.org/Currying\" rel=\"nofollow noreferrer\">currying</a> and it's one of many great (or maybe not) aspects of Haskell functions. This is your code:</p>\n\n<pre><code>map (map (\\a -&gt; ((head a), (length a))) . group . sort) (transpose b)\n</code></pre>\n\n<p>Let's check the type of the first <code>map</code>:</p>\n\n<pre><code>map (\\a -&gt; ((head a), (length a))) :: [[a]] -&gt; [(a, Int)]\n</code></pre>\n\n<p>We do so by typing this</p>\n\n<pre><code>:t map (\\a -&gt; ((head a), (length a)))\n</code></pre>\n\n<p>into <strong>ghci</strong>.</p>\n\n<p>So know we know it's a function. It takes an element of type <code>[[a]]</code> and returns <code>[(a, Int)]</code>. Give the type of the map function is</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>This is perfectly fine. We have given <code>map</code> it's first argument, now, all that it need it's a proper list. What just happened with map is called <a href=\"https://wiki.haskell.org/Currying\" rel=\"nofollow noreferrer\">currying</a>.</p>\n\n<p>Now let's see, we have our <code>map</code> \"connected\" to <code>sort</code> and <code>group</code> through the <code>(.)</code> function.</p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>Now let's change a little your piece of code so we can see better what's going on with the composition function.</p>\n\n<pre><code>map (\\a -&gt; ((head a), (length a))) . (group . sort)\n</code></pre>\n\n<p>I just separated <code>group</code> and <code>sort</code> with some parenthesis. But now we clearly see which elements act as arguments of the outer <code>(.)</code>.</p>\n\n<p>We have the map in question, and another function, which results from the other composition. Again we have the <em>currying</em> in action, when we leave out the last argument:</p>\n\n<pre><code>map (\\a -&gt; ((head a), (length a))) . (group . sort)\n:: Ord a =&gt; [a] -&gt; [(a, Int)]\n</code></pre>\n\n<p>Finally the outer <code>map</code> takes the function from above and a list <code>(transpose b)</code>. </p>\n"}], "owner": {"reputation": 250, "user_id": 3006011, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/bf21d7239544fd04d0eb8eb40751e4ed?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Martines Sanches", "link": "https://stackoverflow.com/users/3006011/erik-martines-sanches"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 871, "favorite_count": 1, "accepted_answer_id": 46332089, "answer_count": 3, "score": 3, "last_activity_date": 1505943539, "creation_date": 1505921620, "last_edit_date": 1505924720, "question_id": 46326244, "link": "https://stackoverflow.com/questions/46326244/function-composition-in-haskell-example", "title": "Function composition in Haskell example", "body": "<p>Assume b is a list of Strings and consider,</p>\n\n<p><code>map (map (\\a -&gt; ((head a), (length a))) . group . sort) (transpose b)</code></p>\n\n<p>I know what each individual function above does, but I'm having trouble seeing how the result is assembled. How would I go about figuring out the order in which the functions on this line run, with which parameters? </p>\n\n<p>Specifically, I seem to understand that <code>(map (\\a -&gt; ((head a), (length a))) . group . sort)</code> is the the first parameter to the outer map and <code>(transpose b)</code> is the second parameter to the outer map. </p>\n\n<p>But which are the parameters for the inner map? The inner map appears to just have one parameter: <code>(\\a -&gt; ((head a), (length a))) . group . sort)</code>. Where is the second parameter (the list to which to apply, element-wise, the function in the first parameter)?</p>\n"}, {"tags": ["parsing", "haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1505918186, "post_id": 46324842, "comment_id": 79610529, "body": "Could you include the sample file you are running this on?"}], "answers": [{"tags": [], "owner": {"reputation": 829, "user_id": 6717054, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/72a7bcb06a087a25530bcbab56c2024f?s=128&d=identicon&r=PG", "display_name": "ritchie46", "link": "https://stackoverflow.com/users/6717054/ritchie46"}, "is_accepted": true, "score": 1, "last_activity_date": 1505919571, "creation_date": 1505919571, "answer_id": 46325500, "question_id": 46324842, "link": "https://stackoverflow.com/questions/46324842/trouble-with-the-haskell-readp-function/46325500#46325500", "title": "Trouble with the haskell ReadP (&lt;++) function", "body": "<p>Just 20 minutes later, it turns out I was to snappy with asking questions.</p>\n\n<p>The problem is that the munch function always succeeds, thus I needed to provide an helper function that fails when the parsed string is null.</p>\n\n<pre><code>isFloatDot = do\n    s &lt;- munch floatDot\n    if null s then pfail\n        else return s\n</code></pre>\n\n<p>The following snippet produces the correct output:</p>\n\n<pre><code>singleBlock :: ReadP (String, String)\nsingleBlock = do\n    st &lt;- look\n\n    if \"LOAD INCREMENT\" `isInfixOf` st then do\n        fmap (head . splitOn \"LOAD INCREMENT\") look &gt;&gt;= string\n\n        increment &lt;- (munch PP.nonDigitOnLine &gt;&gt; munch PP.floatDot &gt;&gt; munch PP.nonDigitOnLine &gt;&gt; PP.isFloatDot) &lt;++ (munch PP.nonDigit &gt;&gt; munch PP.floatDot)\n        fmap (head. splitOn \"STEP\") look &gt;&gt;= string\n        munch PP.nonDigit\n        step &lt;- munch PP.digit\n\n        return (increment, step)\n    else pfail\n</code></pre>\n"}], "owner": {"reputation": 829, "user_id": 6717054, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/72a7bcb06a087a25530bcbab56c2024f?s=128&d=identicon&r=PG", "display_name": "ritchie46", "link": "https://stackoverflow.com/users/6717054/ritchie46"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 46325500, "answer_count": 1, "score": 0, "last_activity_date": 1505919571, "creation_date": 1505917860, "last_edit_date": 1505918564, "question_id": 46324842, "link": "https://stackoverflow.com/questions/46324842/trouble-with-the-haskell-readp-function", "title": "Trouble with the haskell ReadP (&lt;++) function", "body": "<p>At the moment I'm trying to learn Haskell by writing a parser for a certain type of log file.</p>\n\n<p>if I execetue the following <code>singleBlock</code> parser:</p>\n\n<pre><code>singleBlock :: ReadP (String, String)\nsingleBlock = do\n   st &lt;- look\n\n   if \"LOAD INCREMENT\" `isInfixOf` st then do\n       fmap (head . splitOn \"LOAD INCREMENT\") look &gt;&gt;= string\n       increment &lt;- (munch PP.nonDigit &gt;&gt; munch PP.floatDot) \n\n       fmap (head. splitOn \"STEP\") look &gt;&gt;= string\n       munch PP.nonDigit\n       step &lt;- munch PP.digit\n\n    return (increment, step)\n   else pfail\n</code></pre>\n\n<p>It produces the following output:</p>\n\n<p><code>[(\"3.000E-01\",\"1\"),(\"3.000E-01\",\"2\"),(\"3.000E-01\",\"3\"),(\"1.000E-01\",\"4\"),(\"1\",\"5\")]</code></p>\n\n<p>The problem is that the upon step 5 the file changes and thus the Float isn't parsed anymore.</p>\n\n<p>If I change the increment line to:</p>\n\n<p><code>increment &lt;- (munch PP.nonDigitOnLine &gt;&gt; munch PP.floatDot &gt;&gt; munch PP.nonDigitOnLine &gt;&gt; munch PP.floatDot)</code></p>\n\n<p><code>[(\"\",\"1\"),(\"\",\"2\"),(\"\",\"3\"),(\"\",\"4\"),(\"2.500E-01\",\"5\")]</code></p>\n\n<p>The fift step gets parsed correctly. The first 4 steps produce an empty string, thus I thought I could change the <code>increment line</code> to this:</p>\n\n<p><code>increment &lt;- (munch PP.nonDigitOnLine &gt;&gt; munch PP.floatDot &gt;&gt; munch PP.nonDigitOnLine &gt;&gt; munch PP.floatDot) &lt;++ (munch PP.nonDigit &gt;&gt; munch PP.floatDot)</code></p>\n\n<p>Using the <code>&lt;++</code> left biased choice. It however doesn't change my output:</p>\n\n<p><code>[(\"\",\"1\"),(\"\",\"2\"),(\"\",\"3\"),(\"\",\"4\"),(\"2.500E-01\",\"5\")]</code></p>\n\n<p>Edit:</p>\n\n<p>The log file is something like this (Focusing on the LOAD INCREMENT line): </p>\n\n<pre><code> STEP      4 INITIATED:\n   LOAD INCREMENT:  START STEPS *   1.000E-01\n      SPARSE: DIM=272114 NNZ(MAT)=19119044\n      SOLVE: REDUCTION RES= 0.14E-12 (INIT. RES= 0.96E+06) NI=    1\n      ETA-ENERGY DIAGRAM    0    0.000E+00    3.182E+02\n      ETA-ENERGY DIAGRAM    1    1.000E+00    2.344E+00\n\n  STEP      4 : DISPLACEMENT NORM =  3.851E-03         TOLERANCE =  1.000E-02\n  STEP      4 : FORCE NORM        =  6.558E+05         TOLERANCE =  1.000E-02\n\n  RELATIVE OUT OF BALANCE FORCE   =  2.708E-01         CHECK = FALSE\n\n      SPARSE: DIM=272114 NNZ(MAT)=19119044\n      SOLVE: REDUCTION RES= 0.44E-14 (INIT. RES= 0.18E+06) NI=    1\n      ETA-ENERGY DIAGRAM    0    0.000E+00    2.239E+00\n      ETA-ENERGY DIAGRAM    1    1.000E+00    1.464E+00\n\n ...\n ...\n\n  RELATIVE DISPLACEMENT VARIATION =  6.156E-03         CHECK = TRUE\n  RELATIVE OUT OF BALANCE FORCE   =  1.722E-01         CHECK = FALSE\n\n  STEP      4 TERMINATED, CONVERGENCE AFTER   2 ITERATIONS\n  EXECUTION STOPPED ON TOTAL LOAD CRITERION\n  CONTINUED ANALYSIS POSSIBLE.\n   TOTAL LOAD FACTOR:  LOADING(12) *   1.000E+00\n\n   PLASTICITY LOGGING SUMMARY\n   GROUP NAME          PLAST, PRV. PL, CRITIC, PLAST NEW, PRV.PL NEW, CRITIC NEW\n   TOTAL MODEL             0        0       0          0           0           0\n   CRACKING LOGGING SUMMARY\n   GROUP NAME               CRACK,     OPEN,   CLOSED,   ACTIVE,   INACTI,   ARISES, RE-OPENS,   CLOSES\n   TOTAL MODEL                698       698         0       694         4       209         0         0\n     CUMULATIVE REACTION:         FORCE X        FORCE Y          FORCE Z\n                                0.89594D-09     0.11246D+02    -0.67820D-08\n\n\n  STEP      5 INITIATED:\n   LOAD INCREMENT:  LOADING( 1) *   2.500E-01\n      SPARSE: DIM=272114 NNZ(MAT)=19119044\n      SOLVE: REDUCTION RES= 0.53E-10 (INIT. RES= 0.11E+06) NI=    1\n\n  STEP      5 : ENERGY NORM       =  7.379E+02         TOLERANCE =  1.000E-04\n\n\n      SPARSE: DIM=272114 NNZ(MAT)=19119044\n      SOLVE: REDUCTION RES= 0.56E-14 (INIT. RES= 0.11E+06) NI=    1\n\n  ...\n  ...\n\n  STEP      5 TERMINATED, CONVERGENCE AFTER  13 ITERATIONS\n   TOTAL LOAD FACTOR:  LOADING( 1) *   2.500E-01\n</code></pre>\n"}, {"tags": ["list", "dictionary", "haskell", "zip", "tuples"], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 2, "last_activity_date": 1505918658, "last_edit_date": 1505918658, "creation_date": 1505917478, "answer_id": 46324699, "question_id": 46324433, "link": "https://stackoverflow.com/questions/46324433/zip-list-with-list-of-a-list-in-haskell/46324699#46324699", "title": "Zip list with list of a list in Haskell", "body": "<p>You will need to map over the list of strings and zip up the list of ints with each string.</p>\n\n<pre><code>Prelude&gt; myzip ints strings = map (zip ints) strings\nPrelude&gt; myzip [1,2,3] [[\"a\", \"b\", \"c\"], [\"d\", \"e\", \"f\"]]\n[[(1,\"a\"),(2,\"b\"),(3,\"c\")],[(1,\"d\"),(2,\"e\"),(3,\"f\")]]\n</code></pre>\n\n<p>Using currying, this can be shortened to </p>\n\n<pre><code>myzip ints = map (zip ints)\n</code></pre>\n\n<p>Which can be then shortened to the following using composition:</p>\n\n<pre><code>myzip = map . zip\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 8622570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/582f23659e7dcea18acadd21019d271a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Maassen", "link": "https://stackoverflow.com/users/8622570/jeroen-maassen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505918715, "creation_date": 1505916729, "last_edit_date": 1505918715, "question_id": 46324433, "link": "https://stackoverflow.com/questions/46324433/zip-list-with-list-of-a-list-in-haskell", "title": "Zip list with list of a list in Haskell", "body": "<p>I want to zip <code>[Int]</code> with <code>[[String]]</code>, so that I get <code>[[(Int, String)]]</code>.\nAn example:</p>\n\n<pre><code>[1,2,3] and\n[[a,b,c],[d,e,f]] becomes\n[[(1,a),(2,b),(3,c)],[(1,d),(2,e),(3,f)]]\n</code></pre>\n\n<p>How could I do this? I have tried a few thing with map, but without success. </p>\n"}, {"tags": ["haskell", "lambda"], "answers": [{"tags": [], "owner": {"reputation": 464, "user_id": 3825556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7ajzp.png?s=128&g=1", "display_name": "Cirquit", "link": "https://stackoverflow.com/users/3825556/cirquit"}, "is_accepted": false, "score": 1, "last_activity_date": 1505918599, "creation_date": 1505918599, "answer_id": 46325132, "question_id": 46324039, "link": "https://stackoverflow.com/questions/46324039/beta-reduction-on-type/46325132#46325132", "title": "beta reduction on type", "body": "<p>You can use a function the same way as you use a value in lambda calculus. Your example with the <code>(+)</code> would look like this:</p>\n\n<pre><code>(\u03bbf. \u03bbx. \u03bby. f x y) (+) 1 2\n~&gt; (\u03bbx. \u03bby. (+) x y)  1 2\n~&gt; (\u03bby. (+) 1 y) 2\n~&gt; ((+) 1 2)\n~&gt; 1 + 2\n~&gt; 3\n</code></pre>\n\n<p>You can substitute your known types, but there to ensure correctness you would have to run the function and see if the types match. </p>\n\n<p>However, in pure lambda calculus you can't encode the type signature, that's what <a href=\"https://en.wikipedia.org/wiki/System_F\" rel=\"nofollow noreferrer\">System F</a> or <a href=\"https://en.wikipedia.org/wiki/Hindley%E2%80%93Milner_type_system\" rel=\"nofollow noreferrer\">Hindley-Milner type system</a> is for. This allows type annotations and you can use a type inference algorithm to check on <em>compile time</em> if everything matches. It narrows the rules for beta reduction by enforcing type substitutions.</p>\n\n<p>A more complete introduction and example code for a type inference algorithm can be found <a href=\"http://dev.stephendiehl.com/fun/006_hindley_milner.html\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505918599, "creation_date": 1505915740, "question_id": 46324039, "link": "https://stackoverflow.com/questions/46324039/beta-reduction-on-type", "title": "beta reduction on type", "body": "<p>When translate the <code>(+)</code> operator into lambda calculus, then it would look like:  </p>\n\n<pre><code>\u03bbx.\u03bby.x + y\n</code></pre>\n\n<p>then do beta reduction</p>\n\n<pre><code>(\u03bbx.\u03bby.x + y) 1 --substitute x through 1\n(\u03bby.1 + y)      \n(\u03bby.1 + y)    2 --substitute y through 2\n1 + 2\n3               --is the normal form \n</code></pre>\n\n<p>Now, I have a function with following type signature:</p>\n\n<pre><code>f :: (t1 -&gt; t) -&gt; t1 -&gt; t\n</code></pre>\n\n<p>My questions are:</p>\n\n<ul>\n<li><p>Can I translate the type signature of function <code>f</code> into lambda\ncalculus(Like I translate the + operator above)?  </p></li>\n<li><p>Can I apply beta reduction principle for type too(know as type<br>\nsubstitution)?</p></li>\n</ul>\n\n<p>With type substitution, I mean as follow:</p>\n\n<pre><code>*Twinplicative&gt; :t id (+)\nid (+) :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>I did substitute the first parameter of <code>id</code>, know as <code>a</code>, with the type signature of <code>(+)</code> operator, then it becomes to <code>Num a =&gt; a -&gt; a -&gt; a</code></p>\n"}, {"tags": ["haskell", "docker", "yesod", "amazon-ses"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 2, "creation_date": 1506185935, "post_id": 46322773, "comment_id": 79722351, "body": "I&#39;m on mobile right now and so I don&#39;t know the exact package name, but you need to install the apt package that provides /etc/protocols"}, {"owner": {"reputation": 1791, "user_id": 550026, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a9808a71e03d9b9602aae53622c64d70?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/550026/will"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1506332309, "post_id": 46322773, "comment_id": 79761304, "body": "Thanks, that gives me somewhere to start looking!"}], "answers": [{"tags": [], "owner": {"reputation": 1791, "user_id": 550026, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a9808a71e03d9b9602aae53622c64d70?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/550026/will"}, "is_accepted": true, "score": 5, "last_activity_date": 1506351287, "creation_date": 1506351287, "answer_id": 46408242, "question_id": 46322773, "link": "https://stackoverflow.com/questions/46322773/yesod-app-in-docker-container-cant-make-network-requests/46408242#46408242", "title": "Yesod app in Docker container can&#39;t make network requests", "body": "<p>Thanks to Michael Snoyman's hint, I found that <code>netbase</code> is the package required to populate <code>/etc/protocols</code>.  After installing that, I got a new error complaining that the SSL cert for Amazon SES was from an unknown certificate authority.</p>\n\n<p>I installed the <code>ca-certificates</code> package, and this went away.  I also came across an error telling me that <code>libstdc++6</code> was not installed - so I installed that. All working now.</p>\n\n<p>My final <code>Dockerfile</code> that works with Yesod, using email auth and Amazon SES to send emails, is as follows (the \"run\" command is the compiled executable from <code>stack build</code>):</p>\n\n<pre><code>FROM ubuntu:17.04\n\nRUN apt-get update &amp;&amp; apt-get install -y libpq-dev libgnutls30 netbase libstdc++6 ca-certificates\n\nWORKDIR /app\n\nADD . /app\n\nEXPOSE 8080\n\nENV PGHOST localhost\n\nCMD \"./run\"\n</code></pre>\n\n<p>Hooray for trial and error :)</p>\n"}], "owner": {"reputation": 1791, "user_id": 550026, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/a9808a71e03d9b9602aae53622c64d70?s=128&d=identicon&r=PG", "display_name": "Will", "link": "https://stackoverflow.com/users/550026/will"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 2, "accepted_answer_id": 46408242, "answer_count": 1, "score": 5, "last_activity_date": 1506351287, "creation_date": 1505912344, "last_edit_date": 1506350735, "question_id": 46322773, "link": "https://stackoverflow.com/questions/46322773/yesod-app-in-docker-container-cant-make-network-requests", "title": "Yesod app in Docker container can&#39;t make network requests", "body": "<p>I have a Yesod app which I am deploying to Heroku in a Docker container.  The app uses Amazon SES to send emails.  When running the app locally using yesod devel this works fine, but in the container on Heroku I get the following error:</p>\n\n<pre><code>HttpExceptionRequest Request {\n  host                 = \"email.eu-west-1.amazonaws.com\"\n  port                 = 443\n  secure               = True\n  requestHeaders       = [(\"Content-Type\",\"application/x-www-form-\nurlencoded\"),(\"Date\",\"Wed, 20 Sep 2017 12:39:49 +0000\"),(\"X-Amzn-\nAuthorization\",\"AWS3-HTTPS AWSAccessKeyId=AKIAIBUN4ZEOKYKOB35A, \nAlgorithm=HmacSHA256, \nSignature=xh3fi4EJOAe0LOZVCng5NRZIw2D+6P++0aO4Q5Dy0gw=\")]\n  path                 = \"/\"\n  queryString          = \"\"\n  method               = \"POST\"\n  proxy                = Nothing\n  rawBody              = False\n  redirectCount        = 10\n  responseTimeout      = ResponseTimeoutDefault\n  requestVersion       = HTTP/1.1\n}\n (ConnectionFailure Network.BSD.getProtocolByName: does not exist (no \nsuch protocol name: tcp))\n</code></pre>\n\n<p>I'm thinking I might need to install some extra packages in the container.  Here's the Dockerfile:</p>\n\n<pre><code>FROM ubuntu:17.04\n\nRUN apt-get update &amp;&amp; apt-get install -y libpq-dev\n\nWORKDIR /app\n\nADD . /app\n\nEXPOSE 8080\n\nENV PGHOST localhost\n\nCMD \"./run\"\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1505910057, "post_id": 46321812, "comment_id": 79604501, "body": "<code>fmap f (Compose fga) = Compose $ fmap (fmap f) fga</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1505922067, "post_id": 46321812, "comment_id": 79613533, "body": "You didn&#39;t actually give a definition of function composition. I suspect that if you had, you could have applied it correctly."}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 3, "last_activity_date": 1505910170, "creation_date": 1505910170, "answer_id": 46322017, "question_id": 46321812, "link": "https://stackoverflow.com/questions/46321812/function-composition-of-fmap/46322017#46322017", "title": "Function composition of fmap", "body": "<p>The function you provide to the leftmost application of <code>fmap</code> should have type <code>g a -&gt; g b</code> while you are providing <code>f</code> which has type <code>a -&gt; b</code>. You can lift a function <code>a -&gt; b</code> to <code>g a -&gt; g b</code> using <code>fmap</code> i.e. <code>fmap f</code>. The second argument to the outer <code>fmap</code> should have type <code>f (g a)</code> which is the type of <code>fga</code>:</p>\n\n<pre><code>instance (Functor f, Functor g) =&gt; Functor (Compose f g) where\n    fmap f (Compose fga) = Compose $ fmap (fmap f) fga\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1505923394, "last_edit_date": 1505923394, "creation_date": 1505923060, "answer_id": 46326728, "question_id": 46321812, "link": "https://stackoverflow.com/questions/46321812/function-composition-of-fmap/46326728#46326728", "title": "Function composition of fmap", "body": "<p>I like Lee's answer, which states clearly how you could implement the <code>Functor</code> instance for <code>Compose</code> yourself from scratch. However, I also thought it worth answering a closely related question, which is: how do I start from the existing instance and mechanically rewrite it to avoid the <code>(.)</code> function composition? Therefore I tackle that question in this answer.</p>\n\n<p>Since <code>(f . g) x = f (g x)</code> is the defining equation of <code>(.)</code>, we conclude <code>(fmap . fmap) f = fmap (fmap f)</code>. Applying both sides of the equation to <code>fga</code>, we get:</p>\n\n<pre><code>(fmap . fmap) f fga = fmap (fmap f) fga\n</code></pre>\n"}], "owner": {"reputation": 25967, "user_id": 1743843, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ea2c1d9051e40332376a07bc166d9d5?s=128&d=identicon&r=PG&f=1", "display_name": "softshipper", "link": "https://stackoverflow.com/users/1743843/softshipper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 1, "accepted_answer_id": 46322017, "answer_count": 2, "score": 2, "last_activity_date": 1505923394, "creation_date": 1505909650, "last_edit_date": 1505910848, "question_id": 46321812, "link": "https://stackoverflow.com/questions/46321812/function-composition-of-fmap", "title": "Function composition of fmap", "body": "<p>The simple definition of function composition is:</p>\n\n<pre><code>f ( g x)\n</code></pre>\n\n<p>or </p>\n\n<pre><code>(f . g) $ x\n</code></pre>\n\n<p>Now I have following example: </p>\n\n<pre><code>  newtype Compose f g a =\n    Compose { getCompose :: f (g a) }\n    deriving (Eq, Show)\n\n  instance (Functor f, Functor g) =&gt; Functor (Compose f g) where\n    fmap f (Compose fga) = Compose $ (fmap . fmap) f fga\n</code></pre>\n\n<p>Then I try to write <code>fmap</code> without composition operator as:</p>\n\n<pre><code>  instance (Functor f, Functor g) =&gt; Functor (Compose f g) where\n    fmap f (Compose fga) = Compose $ fmap f (fmap f fga)\n</code></pre>\n\n<p>and the compiler complains:</p>\n\n<pre><code>* Couldn't match type `b' with `g b'\n  `b' is a rigid type variable bound by\n    the type signature for:\n      fmap :: forall a b. (a -&gt; b) -&gt; Compose f g a -&gt; Compose f g b\n    at D:\\haskell\\chapter25\\src\\Twinplicative.hs:11:5\n  Expected type: f (g b)\n    Actual type: f b\n* In the second argument of `($)', namely `fmap f (fmap f fga)'\n  In the expression: Compose $ fmap f (fmap f fga)\n  In an equation for `fmap':\n      fmap f (Compose fga) = Compose $ fmap f (fmap f fga)\n* Relevant bindings include\n    fga :: f (g a)\n      (bound at D:\\haskell\\chapter25\\src\\Twinplicative.hs:11:21)\n    f :: a -&gt; b\n      (bound at D:\\haskell\\chapter25\\src\\Twinplicative.hs:11:10)\n    fmap :: (a -&gt; b) -&gt; Compose f g a -&gt; Compose f g b\n      (bound at D:\\haskell\\chapter25\\src\\Twinplicative.hs:11:5)\n</code></pre>\n\n<p>How to compose <code>fmap</code> above without composition operator?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 464, "user_id": 3825556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7ajzp.png?s=128&g=1", "display_name": "Cirquit", "link": "https://stackoverflow.com/users/3825556/cirquit"}, "edited": false, "score": 0, "creation_date": 1505895767, "post_id": 46316859, "comment_id": 79595056, "body": "The cardinality of a <a href=\"http://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Set.html#size\" rel=\"nofollow noreferrer\"><code>Data.Set</code></a> is calculated by <code>size</code> not by <code>length</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 464, "user_id": 3825556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7ajzp.png?s=128&g=1", "display_name": "Cirquit", "link": "https://stackoverflow.com/users/3825556/cirquit"}, "edited": false, "score": 0, "creation_date": 1505897034, "post_id": 46316859, "comment_id": 79595834, "body": "@Cirquit, <code>length</code> should work as well."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 5, "last_activity_date": 1505897483, "creation_date": 1505897483, "answer_id": 46317464, "question_id": 46316859, "link": "https://stackoverflow.com/questions/46316859/use-set-fromlist-get-error-prelude-index-too-large/46317464#46317464", "title": "use Set.fromList , get error &quot;Prelude.!!: index too large&quot;", "body": "<p>I believe you are barking up the wrong tree. The definition of <code>length</code> for <code>Data.Set</code> does not use <code>Prelude.!!</code> in any way, directly or indirectly. Neither does the definition of <code>fromList</code>. I believe the definition of the list itself must involve <code>!!</code> in some fashion. Check your source, and don't use <code>!!</code>.</p>\n"}], "owner": {"reputation": 443, "user_id": 4183297, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/UNM2l.jpg?s=128&g=1", "display_name": "Theodora", "link": "https://stackoverflow.com/users/4183297/theodora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505897483, "creation_date": 1505895593, "question_id": 46316859, "link": "https://stackoverflow.com/questions/46316859/use-set-fromlist-get-error-prelude-index-too-large", "title": "use Set.fromList , get error &quot;Prelude.!!: index too large&quot;", "body": "<p>There is a List <code>lc</code></p>\n\n<pre><code>*Main Lib MetaDefinition WHparseCSV WHparseTxT Set&gt; :info lc\nlc :: IO [Int]  -- Defined at &lt;interactive&gt;:2:5\n*Main Lib MetaDefinition WHparseCSV WHparseTxT Set&gt; length &lt;$&gt; lc\n1704399\n</code></pre>\n\n<p>I would like to know the cardinality of this list, so I tried to convert this list to a set by doing:</p>\n\n<pre><code>*Main Lib MetaDefinition WHparseCSV WHparseTxT Set&gt; import Data.Set as Set\n*Main Lib MetaDefinition WHparseCSV WHparseTxT Set&gt; let sc = Set.fromList &lt;$&gt; lc \n</code></pre>\n\n<p>however, when I am trying to calculate the cardinality, I got the error:</p>\n\n<pre><code>*Main Lib MetaDefinition WHparseCSV WHparseTxT Set&gt; length &lt;$&gt; sc\n*** Exception: Prelude.!!: index too large\n</code></pre>\n\n<p>The type of <code>sc</code> is correct:</p>\n\n<pre><code>*Main Lib MetaDefinition WHparseCSV WHparseTxT Set&gt; :info sc\nsc :: IO (Set Int)  -- Defined at &lt;interactive&gt;:19:5\n</code></pre>\n\n<p>and I think <code>length</code> works well when being used to calculate the value of type <code>fromList ::  [Int] -&gt; Set Int</code></p>\n\n<p>I really would like to know what cause this <strong><code>Exception: Prelude.!!: index too large</code></strong>.\nis this because this <code>set</code> is in the <code>IO</code> monad?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1505892846, "post_id": 46315857, "comment_id": 79593236, "body": "Because a <code>class</code> instance does not construct an <code>instance</code> automagically."}, {"owner": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1506319351, "post_id": 46315857, "comment_id": 79754008, "body": "Thanks to @WillemVanOnsem. I should have realised there&#39;s no need to write a <code>where</code> clause for the <code>instance</code> declaration. Just writing <code>instance EQ Int</code> is enough and equipes <code>Int</code> with the default implementation of <code>eq</code>."}], "answers": [{"comments": [{"owner": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "edited": false, "score": 0, "creation_date": 1506283998, "post_id": 46316060, "comment_id": 79746017, "body": "I don&#39;t think your last <code>instance</code> is allowed as the type does not involve a type constructor applied to simple type variables. Please see page 46 of the Haskell 2010 report. It would be allowed if it started with <code>instance Eq a =&gt; EQ [a]</code>, e.g."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "edited": false, "score": 0, "creation_date": 1506537161, "post_id": 46316060, "comment_id": 79865293, "body": "@MarcvanDongen: you are correct that Haskell 2010 does not allow it. But ghc allows it. GHC is a superset of Haskell."}, {"owner": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "edited": false, "score": 0, "creation_date": 1506537247, "post_id": 46316060, "comment_id": 79865349, "body": "Thanks. Please make your answer reflect this and explain this. I&#39;ll accept the answer if you do."}, {"owner": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "edited": false, "score": 0, "creation_date": 1506537948, "post_id": 46316060, "comment_id": 79865726, "body": "Thanks for adding the ghc <code>LANGUAGE</code> pragmas to your last answer, which aren&#39;t proper Haskell (2010)."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "edited": false, "score": 0, "creation_date": 1506537987, "post_id": 46316060, "comment_id": 79865754, "body": "@MarcvanDongen: yeah, I also added a note at the bottom of the answer."}, {"owner": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "edited": false, "score": 0, "creation_date": 1506539429, "post_id": 46316060, "comment_id": 79866533, "body": "Thanks. The note doesn&#39;t make clear this is only ghc compatible. I also suggest you omit the &quot;you probably want to say:&quot; because I was looking for a Haskell solution, not  a Haskell dialect (ghc) solution."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "edited": false, "score": 0, "creation_date": 1506539486, "post_id": 46316060, "comment_id": 79866566, "body": "@MarcvanDongen: welll that we can not know. Everybody is free to construct his/her own compiler (some of my friends did) and they can include/exclude any feature. :)"}, {"owner": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "edited": false, "score": 0, "creation_date": 1506539823, "post_id": 46316060, "comment_id": 79866752, "body": "I disagree. You write &quot;you probably want to say&quot; so how do you know I wish to use ghc (which I do but it&#39;s irrelevant)."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "edited": false, "score": 0, "creation_date": 1506539933, "post_id": 46316060, "comment_id": 79866812, "body": "@MarcvanDongen: I mean that it is not GHC specific. It is not standard Haskell, but that does not mean that it is specific to a single compiler :). It is an N.B. and most part of my answers are irrelevant since these indeed not answer the problem itself, but look for ways of improvement :). It has usually a structure of problem statement - (solution) - remarks. Whether the remarks add value is of course uncertain. Otherwise we would not call this research."}, {"owner": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "edited": false, "score": 0, "creation_date": 1506541978, "post_id": 46316060, "comment_id": 79867908, "body": "All fine but why not improve your answer by making it easier for a novice who knows very little about Haskell by clearly pointing out which of your statements are true (Haskell) and which are ``not&#39;&#39; (dialects)? At the moment it is not clear..."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1506537704, "last_edit_date": 1506537704, "creation_date": 1505893282, "answer_id": 46316060, "question_id": 46315857, "link": "https://stackoverflow.com/questions/46315857/instance-declarations/46316060#46316060", "title": "Instance Declarations", "body": "<p>I think you're definition of a class, is probably more what in Java/C#/... is a <code>class</code>.</p>\n\n<p>If you write:</p>\n\n<pre><code>class Eq a =&gt; EQ a where\n    eq :: a -&gt; a -&gt; Bool\n    eq = (==)\n</code></pre>\n\n<p>You only define a typeclass: a way to add functions to a type class and write restrictions. You have <strong>not</strong> written that every <code>Eq a</code> is an <code>EQ a</code>... You have written that in order to implement <code>EQ a</code>, you have to implement <code>Eq a</code> as well (which is a bit weird here).</p>\n\n<p>Furthermore you have provided a <em>default</em> implementation: <code>eq = (==)</code>, but that is only a default implementation for an <em>instance</em> where you do not specify the implementation.</p>\n\n<p>By writing:</p>\n\n<pre><code>instance EQ Int where\n    eq = (==)\n</code></pre>\n\n<p>you have now defined that <code>Int</code> is an <code>EQ</code>. You can make the instance more useful by writing for instance:</p>\n\n<pre><code>instance Eq a =&gt; EQ a\n</code></pre>\n\n<p>Now you have written than <em>all</em> types <code>a</code> for which <code>Eq a</code> holds, also are a type instance of <code>EQ</code>. If you write that however, you have immediately defined the entire universum of <code>EQ</code> since in your <code>class</code> definition, you restricted <code>a</code> to be an instance of <code>EQ</code>, so that means that now, in the entire Haskell universe, <code>eq</code> is equal to <code>(==)</code>.</p>\n\n<p>You probably want to say:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE UndecidableInstances #-}\n\nclass EQ a where\n    eq :: a -&gt; a -&gt; Bool\n\ninstance Eq a =&gt; EQ a where\n    eq = (==)\n</code></pre>\n\n<p>Now you defined a typeclass <code>EQ</code> and for every type <code>a</code> that is <code>Eq a</code>, we set <code>eq</code> to <code>(==)</code>, but it allows you to define an <code>EQ</code> over other types as well, like <code>data Foo</code> that is not an instance of <code>Eq</code>. Mind that we have to turn on two extensions here. These are compiler specific, and thus are not part of standard Haskell.</p>\n"}], "owner": {"reputation": 524, "user_id": 1494169, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/de56ad5c1aa6d83b60819752b9a44ad1?s=128&d=identicon&r=PG", "display_name": "Marc van Dongen", "link": "https://stackoverflow.com/users/1494169/marc-van-dongen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 710, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1506537704, "creation_date": 1505892721, "last_edit_date": 1505892811, "question_id": 46315857, "link": "https://stackoverflow.com/questions/46315857/instance-declarations", "title": "Instance Declarations", "body": "<p>Bit curious why the instance declaration is needed in the following as a default implementation is provided.</p>\n\n<pre><code>module Example where\n\nclass Eq a =&gt; EQ a where\n    eq :: a -&gt; a -&gt; Bool\n    eq = (==)\n\n-- why is this instance declaration needed?\ninstance EQ Int where\n    eq = (==)\n\nf :: Int -&gt; Int -&gt; Bool\nf = eq\n</code></pre>\n\n<p>If I leave out the instance declaration I get an error. I'm sure it's explained somewhere in the Haskell report but it will take a while to find it.</p>\n"}, {"tags": ["list", "haskell", "uppercase"], "comments": [{"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 4, "creation_date": 1505884678, "post_id": 46313632, "comment_id": 79589135, "body": "A couple of things. <b>1</b> <code>if isUpper x then True else False</code> is the same as <code>isUpper x</code>. <b>2</b> Have a second look at the final case. Where do you get <code>last</code> from? Why is <code>x:xs</code> unused?"}], "answers": [{"tags": [], "owner": {"reputation": 110733, "user_id": 1009479, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/wlrC5.jpg?s=128&g=1", "display_name": "Yu Hao", "link": "https://stackoverflow.com/users/1009479/yu-hao"}, "is_accepted": false, "score": 4, "last_activity_date": 1505884793, "creation_date": 1505884793, "answer_id": 46313843, "question_id": 46313632, "link": "https://stackoverflow.com/questions/46313632/haskell-check-last-item-of-list/46313843#46313843", "title": "Haskell -- check last item of list", "body": "<p>Think recursively. <code>checkLast (x:xs)</code> is just checking <code>checkLast xs</code>:</p>\n\n<pre><code>checkLast :: [Char] -&gt; Bool\ncheckLast [] = False\ncheckLast [x] = isUpper x\ncheckLast (x:xs) = checkLast xs\n</code></pre>\n\n<p>Note that since you are using <code>isUpper</code> to check strings, it makes more sense that the type should be <code>[Char]</code>, not <code>[a]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 5004, "user_id": 327815, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/17f2e18da0338911cd6ea464ff2613d1?s=128&d=identicon&r=PG", "display_name": "Jokester", "link": "https://stackoverflow.com/users/327815/jokester"}, "is_accepted": false, "score": 1, "last_activity_date": 1506319680, "last_edit_date": 1506319680, "creation_date": 1505884821, "answer_id": 46313850, "question_id": 46313632, "link": "https://stackoverflow.com/questions/46313632/haskell-check-last-item-of-list/46313850#46313850", "title": "Haskell -- check last item of list", "body": "<p>A fixed version with comments:</p>\n\n<pre><code>import Data.Char (isUpper)\n\ncheckLast :: [Char] -&gt; Bool      -- it cannot be [a]: use of isUpper already limits possible type to [Char]\ncheckLast [] = False\ncheckLast [x] = isUpper x        -- the if .. can be shorter\ncheckLast (x:xs) = checkLast xs  -- drop first char and look at rest of string\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 0, "creation_date": 1505900928, "post_id": 46315606, "comment_id": 79598454, "body": "I got the impression that it&#39;s an assignment, given the slightly contrived question and the way the OP approached it."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1505932138, "post_id": 46315606, "comment_id": 79619565, "body": "I think it&#39;s better to use total functions than to guard partial functions."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1505893574, "last_edit_date": 1505893574, "creation_date": 1505891952, "answer_id": 46315606, "question_id": 46313632, "link": "https://stackoverflow.com/questions/46313632/haskell-check-last-item-of-list/46315606#46315606", "title": "Haskell -- check last item of list", "body": "<p>You can make use of recursion like the other answers demonstrate. But you can also use builtins to construct such a function.</p>\n\n<p>Two relevant functions here are <code>null :: [a] -&gt; Bool</code> which checks whether a list is empty, and <code>last :: [a] -&gt; a</code> which obtains the last element.</p>\n\n<p>So now we can construct a function:</p>\n\n<pre><code>import Data.Char(isUpper)\n\ncheckLast :: [Char] -&gt; Bool\ncheckLast l = not (null l) &amp;&amp; isUpper (last l)\n</code></pre>\n\n<p>So here we state that <code>checkLast</code> is <code>True</code> if the list <code>l</code> is not empty (<code>not (null l)</code>); and the last element is an uppercase character <code>isUpper (last l)</code>.</p>\n\n<p>This will probably be a bit faster than the recursive functions, since we only test the <code>[]</code> case once (in <code>null</code>). <code>last</code> checks only two cases: <code>[x]</code> and <code>(x:xs)</code> so we save on <code>[]</code> checks.</p>\n\n<p>Of course these functions work with recursion, but it is sometimes useful to look for helper functions such that a function is almost self explaining: here the functions says: \"<em>A list <code>l</code> is <code>checkLast</code> if it is not empty, and the last element is an uppercase</em>\".</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1505931599, "post_id": 46316781, "comment_id": 79619259, "body": "This, however, is a terrible solution. Aside from being complicated, it also builds a reversed string only to look at one element and throw the rest away. It&#39;s terribly inefficient."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1505938651, "post_id": 46316781, "comment_id": 79622972, "body": "@dfeuer How is this code snippet complicated really? This is a very basic pattern in Haskell. As per inefficiency i believe it is not inefficient in time complexity but yes... space wise one could use <code>last</code> in the place of <code>head . reverse</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1505945156, "post_id": 46316781, "comment_id": 79625655, "body": "Using the <code>Applicative</code> instance for functions strikes me as obfuscating more than clarifying in this case."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": -2, "last_activity_date": 1505938649, "last_edit_date": 1505938649, "creation_date": 1505895393, "answer_id": 46316781, "question_id": 46313632, "link": "https://stackoverflow.com/questions/46313632/haskell-check-last-item-of-list/46316781#46316781", "title": "Haskell -- check last item of list", "body": "<p>You may also do as follows without any recursion</p>\n\n<pre><code>import Data.Char\n\ncheckLast :: String -&gt; Bool\ncheckLast = (&amp;&amp;) &lt;$&gt; not . null &lt;*&gt; isUpper . head . reverse\n</code></pre>\n\n<p>The applicative operator, <code>&lt;*&gt;</code> is an ideal tool to feed a common parameter (the input string here) to two different functions like <code>not . null</code> and <code>isUpper . head . reverse</code> and then to make an operation <code>(&amp;&amp;)</code> on their result.</p>\n\n<p>As per @dfeuer's comment I just would like to annex the following solution for a better performance. You don't need to import any other package than <code>Data.Char</code></p>\n\n<pre><code>import Data.Char\n\ncheckLast :: String -&gt; Bool\ncheckLast [] = False\ncheckLast cs = isUpper $ foldr1 seq cs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1505938746, "post_id": 46329313, "comment_id": 79623020, "body": "This is also a terrible solution since you needlessly have to import <code>Data.Maybe</code> package just to implement this simple task. It&#39;s totally not needed. See my annexed answer."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1505945059, "post_id": 46329313, "comment_id": 79625623, "body": "@Redu, the only non-prelude function I used is <code>foldl&#39;</code>. But base imports are benign anyway."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1505932090, "creation_date": 1505932090, "answer_id": 46329313, "question_id": 46313632, "link": "https://stackoverflow.com/questions/46313632/haskell-check-last-item-of-list/46329313#46329313", "title": "Haskell -- check last item of list", "body": "<p>The simplest way to avoid explicit recursion, if you wish to do so, is probably to use a fold:</p>\n\n<pre><code>lastMay :: [a] -&gt; Maybe a\nlastMay = foldl' (\\_ x -&gt; Just x) Nothing\n\ncheckLast = maybe True isUpper . lastMay\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8638529"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1322, "favorite_count": 0, "answer_count": 5, "score": 2, "last_activity_date": 1506319680, "creation_date": 1505883701, "last_edit_date": 1506088925, "question_id": 46313632, "link": "https://stackoverflow.com/questions/46313632/haskell-check-last-item-of-list", "title": "Haskell -- check last item of list", "body": "<p>I need to check if last element of list is uppercase\nFor example <code>\"abc\"</code> -- <code>False</code>, <code>\"abC\"</code> -- <code>True</code></p>\n\n<p>That's what I tried</p>\n\n<pre><code>checkLast :: [a] -&gt; Bool\ncheckLast [] = False\ncheckLast [x] = if isUpper x then True else False\ncheckLast (x:xs) = if isUpper last then True else False\n</code></pre>\n"}, {"tags": ["function", "haskell", "arguments"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1505884558, "post_id": 46313124, "comment_id": 79589101, "body": "If <code>cubicS</code> has type <code>Float -&gt; Float -&gt; Float</code>, you pass it exactly two parameters, both of type <code>Float</code>. Not functions, not integers, not list, not cream cheese bagels."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4293256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5vR1F.jpg?s=128&g=1", "display_name": "Cindy", "link": "https://stackoverflow.com/users/4293256/cindy"}, "edited": false, "score": 0, "creation_date": 1505883167, "post_id": 46313266, "comment_id": 79588649, "body": "Thanks! but I&#39;m restricted to cubicS being cubicS: Float -&gt; Float -&gt; Float. I can&#39;t change it to something like Float -&gt; Float -&gt; Float -&gt; Float -&gt; Float"}, {"owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "reply_to_user": {"reputation": 41, "user_id": 4293256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5vR1F.jpg?s=128&g=1", "display_name": "Cindy", "link": "https://stackoverflow.com/users/4293256/cindy"}, "edited": false, "score": 0, "creation_date": 1505884074, "post_id": 46313266, "comment_id": 79588951, "body": "then you need <code>cureS a b c d =  cubicS q r      where q = cubicQ a b c           r = cubicR a b c d</code>   I hope this helps."}], "tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": false, "score": 3, "last_activity_date": 1505887503, "last_edit_date": 1505887503, "creation_date": 1505881366, "answer_id": 46313266, "question_id": 46313124, "link": "https://stackoverflow.com/questions/46313124/haskell-passing-a-function-as-an-argument/46313266#46313266", "title": "Haskell - Passing a function as an argument", "body": "<p>try this:</p>\n\n<pre><code>cubicQ a b c = (3*a*c - b**2) / (9*a**2)\ncubicR a b c d = (9*a*b*c - 27*(a**2)*d-2*b**3)\ncubicS q r  = (r+ (q**3+r**2)**(1/2))**(1/3)\n\nf a b c d = cubicS (cubicQ a b c) (cubicR a b c d)\n\nmain = do print $   f 1 2 3 4 \n</code></pre>\n\n<hr>\n\n<p>or:</p>\n\n<pre><code>cubicS a b c d  = (r+ (q**3+r**2)**(1/2))**(1/3)\n  where q = cubicQ a b c \n        r = cubicR a b c d\n</code></pre>\n\n<hr>\n\n<p>or:</p>\n\n<pre><code>cubicS a b c d =  \n  let q = cubicQ a b c\n      r = cubicR a b c d\n  in (r+ (q**3+r**2)**(1/2))**(1/3)\n</code></pre>\n\n<p>see:</p>\n\n<pre><code>cubicQ :: Float -&gt; Float -&gt; Float -&gt; Float\ncubicQ a b c = (3*a*c - b**2) / (9*a**2)\n\ncubicR :: Float -&gt; Float -&gt; Float -&gt; Float -&gt; Float \ncubicR a b c d = (9*a*b*c - 27*(a**2)*d-2*b**3)\n\ncubicS :: Float -&gt; Float -&gt; Float -&gt; Float -&gt; Float \ncubicS a b c d =  \n  let q = cubicQ a b c\n      r = cubicR a b c d\n  in \n    (r+ (q**3+r**2)**(1/2))**(1/3)\n\nmain = do print $ cubicS 1.1 2.2 3.3 4.4\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>9.736999e-2\n</code></pre>\n\n<hr>\n\n<p>and if you  restricted to <code>cubicS</code> being <code>cubicS: Float -&gt; Float -&gt; Float</code>: </p>\n\n<pre><code>cubicQ a b c = (3*a*c - b**2) / (9*a**2)\ncubicR a b c d = (9*a*b*c - 27*(a**2)*d-2*b**3)\ncubicS q r  = (r+ (q**3+r**2)**(1/2))**(1/3)\n\ncureS a b c d =  cubicS q r \n    where q = cubicQ a b c\n          r = cubicR a b c d\n\nmain = do print $ cureS 1.1 2.2 3.3 4.4\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4293256, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5vR1F.jpg?s=128&g=1", "display_name": "Cindy", "link": "https://stackoverflow.com/users/4293256/cindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2177, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1505887503, "creation_date": 1505880455, "question_id": 46313124, "link": "https://stackoverflow.com/questions/46313124/haskell-passing-a-function-as-an-argument", "title": "Haskell - Passing a function as an argument", "body": "<p>so in haskell I have the following 2 functions made (they are just performing some math operations)</p>\n\n<pre><code>cubicQ :: Float -&gt; Float -&gt; Float -&gt; Float\ncubicQ a b c = (3*a*c - b**2) / (9*a**2)\n\ncubicR :: Float -&gt; Float -&gt; Float -&gt; Float -&gt; Float \ncubicR a b c d = (9*a*b*c - 27*(a**2)*d-2*b**3)\n</code></pre>\n\n<p>I am to make a third function cubicS that has a requirement that the function be of type Float -> Float -> Float and it calculates its output from q and r, which is the output for cubicQ and cubicR. How would I pass the functions cubicQ and cubicR as arguments q and r in cubicS? Below is what I have tried so far but I am stumped. Any help would be greatly appreciated.</p>\n\n<pre><code>cubicS q r = (r+ (q**3+r**2)**(1/2))**(1/3)\n    where q = (cubicQ a b c d) \n          r = (cubicR a b c)\n</code></pre>\n"}, {"tags": ["haskell", "z3", "sbv"], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 1612614, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1eb300f91a6949bb637dfe98bbb9d11f?s=128&d=identicon&r=PG", "display_name": "Matt Ahrens", "link": "https://stackoverflow.com/users/1612614/matt-ahrens"}, "edited": false, "score": 0, "creation_date": 1505924688, "post_id": 46313140, "comment_id": 79615252, "body": "Thanks I&#39;ll give it a try!"}], "tags": [], "owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "is_accepted": true, "score": 2, "last_activity_date": 1505880547, "creation_date": 1505880547, "answer_id": 46313140, "question_id": 46312808, "link": "https://stackoverflow.com/questions/46312808/exception-from-z3-running-minimize-example-for-data-sbv/46313140#46313140", "title": "Exception from Z3 running minimize example for Data.SBV", "body": "<p>You are most likely using an old version of Z3. Optimization features in SBV rely on some not-yet-officially-released features of Z3. Can you download one from here:</p>\n\n<p><a href=\"https://github.com/Z3Prover/bin/tree/master/nightly\" rel=\"nofollow noreferrer\">https://github.com/Z3Prover/bin/tree/master/nightly</a></p>\n\n<p>and give it a try?</p>\n\n<p>(There's an open ticket for Z3 to have a new release precisely for this problem, but it isn't clear when they'll get around to it: <a href=\"https://github.com/Z3Prover/z3/issues/1231\" rel=\"nofollow noreferrer\">https://github.com/Z3Prover/z3/issues/1231</a>)</p>\n"}], "owner": {"reputation": 119, "user_id": 1612614, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1eb300f91a6949bb637dfe98bbb9d11f?s=128&d=identicon&r=PG", "display_name": "Matt Ahrens", "link": "https://stackoverflow.com/users/1612614/matt-ahrens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 46313140, "answer_count": 1, "score": 1, "last_activity_date": 1505880547, "creation_date": 1505878244, "last_edit_date": 1592644375, "question_id": 46312808, "link": "https://stackoverflow.com/questions/46312808/exception-from-z3-running-minimize-example-for-data-sbv", "title": "Exception from Z3 running minimize example for Data.SBV", "body": "<p>When running the <a href=\"https://hackage.haskell.org/package/sbv-7.3/docs/src/Data.SBV.Examples.Optimization.LinearOpt.html#problem\" rel=\"nofollow noreferrer\">example for the optimize function in the Data.SBV library</a> for Haskell:</p>\n<pre><code>problem :: Goal\nproblem = optimize Lexicographic $  do [x1, x2] &lt;- mapM sReal [&quot;x1&quot;, &quot;x2&quot;]\n\n         constrain $ x1 + x2 .&lt;= 10\n         constrain $ x1 - x2 .&gt;= 3\n         constrain $ 5*x1 + 4*x2 .&lt;= 35\n         constrain $ x1 .&gt;= 0\n         constrain $ x2 .&gt;= 0\n\n         maximize &quot;goal&quot; $ 5 * x1 + 6 * x2\nmain = optimize Lexicographic problem\n</code></pre>\n<p>I get the following error:</p>\n<pre><code>*** Exception: \n*** Data.SBV: Unexpected response from the solver.\n***    Context : set-option\n***    Sent    : (set-option :pp.decimal false)\n***    Expected: success\n***    Received: unsupported\n***              success\n\nCallStack (from HasCallStack):\n  error, called at ./Data/SBV/Control/Utils.hs:590:9 in sbv-7.3-35rX062AGHeFmuyHxSBaTE:Data.SBV.Control.Utils\n</code></pre>\n<p>Similarly the following code:</p>\n<pre><code>test = optimize Lexicographic $ do\n                  x &lt;- sInteger &quot;x&quot;\n                  y &lt;- sInteger &quot;y&quot;\n                  maximize &quot;goal&quot; $ x + 2 * y\n</code></pre>\n<p>Produces the error:</p>\n<pre><code>*** Exception: \n*** Data.SBV: Unexpected response from the solver.\n***    Context : getModel\n***    Sent    : (get-value (s0))\n***    Expected: a value binding for kind: SInteger\n***    Received: unsupported\n***              ((s0 0))\n\nCallStack (from HasCallStack):\n  error, called at ./Data/SBV/Control/Utils.hs:590:9 in sbv-7.3-35rX062AGHeFmuyHxSBaTE:Data.SBV.Control.Utils\n</code></pre>\n<p>This error also occurs with the <code>minimize</code> combinator as the last expression.</p>\n<p>I am using GHC version 8.0.2 with stack version 1.5 and SBV version 7.3\nI am using Z3 as my solver and it is version 4.5.1 64-bit running on MacOS.</p>\n<p>Calling <code>sat</code> and <code>prove</code> work as expected. Any ideas? Thanks!</p>\n"}, {"tags": ["haskell", "parallel-processing", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": false, "score": 6, "last_activity_date": 1505879508, "creation_date": 1505879508, "answer_id": 46313000, "question_id": 46311648, "link": "https://stackoverflow.com/questions/46311648/multicore-parallelism-with-stack-runghc/46313000#46313000", "title": "multicore parallelism with stack runghc", "body": "<p>Thanks for asking this question, I think stack should handle the GHCRTS environment variable specially, and opened this issue <a href=\"https://github.com/commercialhaskell/stack/issues/3444\" rel=\"noreferrer\">https://github.com/commercialhaskell/stack/issues/3444</a> and made this change <a href=\"https://github.com/commercialhaskell/stack/pull/3445\" rel=\"noreferrer\">https://github.com/commercialhaskell/stack/pull/3445</a></p>\n\n<p>Unfortunately, it does not solve this case, because <code>runghc</code> itself (ghc) will process <code>GHCRTS</code>, and it is not built with the threaded runtime.  So the environment variable solution cannot be used.</p>\n\n<p>I think it should be possible to provide <code>-with-rtsopts -N</code> flag to <code>stack script --compile</code>, but that doesn't seem to be working, needs further investigation.   This doesn't work with <code>runghc</code>, because it uses the interpreter.</p>\n"}], "owner": {"reputation": 5774, "user_id": 105137, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/253329f6f7506a5299db1cb608d8defd?s=128&d=identicon&r=PG", "display_name": "kostmo", "link": "https://stackoverflow.com/users/105137/kostmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": 8, "last_activity_date": 1505879508, "creation_date": 1505868459, "question_id": 46311648, "link": "https://stackoverflow.com/questions/46311648/multicore-parallelism-with-stack-runghc", "title": "multicore parallelism with stack runghc", "body": "<p>I had been working on a <a href=\"https://haskell-lang.org/tutorial/stack-script\" rel=\"noreferrer\">script</a> in which I hoped to take advantage of multiple processors in my machine by swapping out <code>mapM</code> with <a href=\"https://hackage.haskell.org/package/async-2.1.1.1/docs/Control-Concurrent-Async.html#v:mapConcurrently\" rel=\"noreferrer\"><code>Async.mapConcurrently</code></a>.</p>\n\n<p>Observing no speed increase in that instance, I wanted to verify that <code>runghc</code> can indeed utilize multiple cores.</p>\n\n<p>Given a file <code>Foo.hs</code>:</p>\n\n<pre><code>import Control.Concurrent\n\nmain = print =&lt;&lt; Control.Concurrent.getNumCapabilities\n</code></pre>\n\n<p>If I compile the file as follows:</p>\n\n<pre><code>stack ghc -- -threaded Foo.hs\n</code></pre>\n\n<p>and then run it as follows:</p>\n\n<pre><code>./Foo\n</code></pre>\n\n<p>it returns the result <code>1</code>.  This is expected, as no RTS options have been supplied.  Running it instead as follows:</p>\n\n<pre><code>./Foo +RTS -N\n</code></pre>\n\n<p>returns the number <code>6</code>, as there are 6 processors in my machine (agreeing with <code>nproc</code>).</p>\n\n<p>However, when I run the script in \"interpreted mode\" like so:</p>\n\n<pre><code>GHCRTS=\"-N\" stack runghc Foo.hs\n</code></pre>\n\n<p>It yields the following error text:</p>\n\n<pre><code>Running /home/kostmo/.stack/programs/x86_64-linux/ghc-nopie-8.0.2/bin/ghc-pkg --no-user-package-db list --global exited with ExitFailure 1\n\nghc-pkg: the flag -N requires the program to be built with -threaded\n</code></pre>\n\n<p>Is it possible to utilize multiple cores with stack \"scripts\"?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 1, "creation_date": 1505854713, "post_id": 46309605, "comment_id": 79581241, "body": "<a href=\"https://www.haskell.org/hoogle/?hoogle=Read+a+%3D%3EIO+a\" rel=\"nofollow noreferrer\">haskell.org/hoogle/?hoogle=Read+a+%3D%3EIO+a</a>"}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "reply_to_user": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 0, "creation_date": 1505854772, "post_id": 46309605, "comment_id": 79581264, "body": "@JoshLee Oh... whoops, I guess I should have checked if adding the <code>Read</code> constraint on hoogle helped. Thanks!"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1505864073, "post_id": 46309605, "comment_id": 79584131, "body": "By the way, usually <code>fmap</code> is preferable to <code>liftM</code>, since it&#39;s more general."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1505864731, "post_id": 46309605, "comment_id": 79584279, "body": "Or infix fmap: <code>read &lt;$&gt; getLine</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1505854821, "post_id": 46309672, "comment_id": 79581278, "body": "Thanks, that&#39;s exactly what I was looking for (can&#39;t accept for another few minutes)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1505854970, "post_id": 46309672, "comment_id": 79581330, "body": "...and this is better than <code>liftM read getLine</code> because it turns parse errors into <code>IO</code> exceptions that happen immediately instead of pure exceptions that are delayed to the use site of the <code>a</code> value."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 5, "last_activity_date": 1505854737, "creation_date": 1505854737, "answer_id": 46309672, "question_id": 46309605, "link": "https://stackoverflow.com/questions/46309605/input-function-of-type-io-a/46309672#46309672", "title": "Input function of type `:: IO a`", "body": "<p>There's <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:readLn\" rel=\"noreferrer\"><code>readLn</code></a>:</p>\n\n<pre><code>readLn :: Read a =&gt; IO a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1505855284, "last_edit_date": 1505855284, "creation_date": 1505855005, "answer_id": 46309716, "question_id": 46309605, "link": "https://stackoverflow.com/questions/46309605/input-function-of-type-io-a/46309716#46309716", "title": "Input function of type `:: IO a`", "body": "<p>Worth noting that <code>readLn</code> calls <code>readIO</code> in order to raise an <code>IO</code> exception instead of undefined.</p>\n\n<pre><code>Prelude&gt; x &lt;- (fmap read getLine) :: IO Integer \nasdf\nPrelude&gt; x\n*** Exception: Prelude.read: no parse\n\nPrelude&gt; x &lt;- (readIO =&lt;&lt; getLine) :: IO Integer \nasdf\n*** Exception: user error (Prelude.readIO: no parse)\n</code></pre>\n"}], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 46309672, "answer_count": 2, "score": 2, "last_activity_date": 1505855284, "creation_date": 1505854436, "question_id": 46309605, "link": "https://stackoverflow.com/questions/46309605/input-function-of-type-io-a", "title": "Input function of type `:: IO a`", "body": "<p>The only \"user input\" functions I know of in the Prelude return <code>String</code>s - but often (I'd say more frequently) we want to read numbers or other types.</p>\n\n<p>Is there a function of type <code>:: IO a</code> or similar, for reading a value of arbitrary type? I've <a href=\"https://www.haskell.org/hoogle/?hoogle=%3A%3A+IO+a\" rel=\"nofollow noreferrer\">searched hoogle</a> for such a function, but either due to it not existing or due to the large number of other functions of similar type, I've not found anything.</p>\n\n<hr>\n\n<p>It seems useful and simple enough that there must be a built-in. The closest I've come is this:</p>\n\n<pre><code>-- Eg.\nget :: Read a =&gt; IO a\nget = (liftM read) getLine\n\nmain = do\n        x &lt;- get\n        print $ x + 5\n</code></pre>\n"}, {"tags": ["regex", "haskell", "pcre"], "comments": [{"owner": {"reputation": 37822, "user_id": 1231450, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b9c98b4ce12bf9fd925d8c35c8861bb2?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/1231450/jan"}, "edited": false, "score": 0, "creation_date": 1505851470, "post_id": 46308779, "comment_id": 79579760, "body": "You need anchors: <a href=\"https://regex101.com/r/ult5dP/1/\" rel=\"nofollow noreferrer\"><b><code>^(foo)-(bar)|(quux)-(quux)(q*u*u*x*)$</code></b></a>"}, {"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "reply_to_user": {"reputation": 37822, "user_id": 1231450, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b9c98b4ce12bf9fd925d8c35c8861bb2?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/1231450/jan"}, "edited": false, "score": 1, "creation_date": 1505851520, "post_id": 46308779, "comment_id": 79579779, "body": "it depends on what I want :) I want <code>&quot;fdoifofoo-bardjfkj&quot;</code> to be matched too :)"}, {"owner": {"reputation": 37822, "user_id": 1231450, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b9c98b4ce12bf9fd925d8c35c8861bb2?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/1231450/jan"}, "edited": false, "score": 0, "creation_date": 1505851715, "post_id": 46308779, "comment_id": 79579860, "body": "I might not get it, but your expression works in the way you describe: <a href=\"https://regex101.com/r/ult5dP/2\" rel=\"nofollow noreferrer\">regex101.com/r/ult5dP/2</a>"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1505851717, "post_id": 46308779, "comment_id": 79579861, "body": "Use <a href=\"http://hackage.haskell.org/package/regex-posix-0.95.2/docs/Text-Regex-Posix-Wrap.html#v:-61--126--126-\" rel=\"nofollow noreferrer\"><code>=~~</code></a> in order to wrap the <code>target</code> in a monad, like <code>Maybe</code>."}, {"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1505854942, "post_id": 46308779, "comment_id": 79581323, "body": "@4castle, can you put your comment as an answer?"}], "answers": [{"comments": [{"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1505862747, "post_id": 46309533, "comment_id": 79583787, "body": "I can write a wrapper to signal unmatched groups with <code>Nothing</code> then. Good job!"}], "tags": [], "owner": {"reputation": 4685, "user_id": 5180989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gxpck.jpg?s=128&g=1", "display_name": "Helder Pereira", "link": "https://stackoverflow.com/users/5180989/helder-pereira"}, "is_accepted": true, "score": 3, "last_activity_date": 1505863227, "last_edit_date": 1505863227, "creation_date": 1505854107, "answer_id": 46309533, "question_id": 46308779, "link": "https://stackoverflow.com/questions/46308779/distinguish-empty-regexp-matches-from-no-matches-in-haskell/46309533#46309533", "title": "Distinguish empty regexp matches from no matches in Haskell", "body": "<p>A way of achieving it is using <code>getAllTextSubmatches</code>:</p>\n\n<pre><code>import Text.Regex.PCRE\n\nmyMatch :: String -&gt; Maybe (String, String, Maybe String)\nmyMatch str = case getAllTextSubmatches $ str =~ \"(foo)-(bar)|(quux)-(quux)(q*u*u*x*)\" :: [String] of\n  []                      -&gt; Nothing\n  [_, g1, g2, \"\", \"\", \"\"] -&gt; Just (g1, g2, Nothing)\n  [_, \"\", \"\", g3, g4, g5] -&gt; Just (g3, g4, Just g5)\n</code></pre>\n\n<p>When <code>getAllTextSubmatches</code> has <code>[String]</code> as return type, it returns an empty list if there is no match, or a list with all capturing groups (where index 0 is the whole match) of the first match.</p>\n\n<p>Alternatively, if a matched group may be empty and you cannot pattern match on the empty string, you can use <code>[(String, (MatchOffset, MatchLength))]</code> as return type of <code>getAllTextSubmatches</code> and pattern match <code>MatchOffset</code> with -1 to identify unmatched groups:</p>\n\n<pre><code>myMatch :: String -&gt; Maybe (String, String, Maybe String)\nmyMatch str = case getAllTextSubmatches $ str =~ \"(foo)-(bar)|(quux)-(quux)(q*u*u*x*)\" :: [(String, (MatchOffset, MatchLength))] of\n  []                                                              -&gt; Nothing\n  [_, (g1, _), (g2, _), (_, (-1, _)), (_, (-1, _)), (_, (-1, _))] -&gt; Just (g1, g2, Nothing)\n  [_, (_, (-1, _)), (_, (-1, _)), (g3, _), (g4, _), (g5, _)]      -&gt; Just (g3, g4, Just g5)\n</code></pre>\n\n<p>Now, if that looks too verbose:</p>\n\n<pre><code>{-# LANGUAGE PatternSynonyms #-}\n\npattern NoMatch = (\"\", (-1, 0))\n\nmyMatch :: String -&gt; Maybe (String, String, Maybe String)\nmyMatch str = case getAllTextSubmatches $ str =~ \"(foo)-(bar)|(quux)-(quux)(q*u*u*x*)\" :: [(String, (MatchOffset, MatchLength))] of\n  []                                               -&gt; Nothing\n  [_, (g1, _), (g2, _), NoMatch, NoMatch, NoMatch] -&gt; Just (g1, g2, Nothing)\n  [_, NoMatch, NoMatch, (g3, _), (g4, _), (g5, _)] -&gt; Just (g3, g4, Just g5)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1505855279, "post_id": 46309607, "comment_id": 79581463, "body": "Will this fail on <code>foo-barfoo-bar</code>? I only need to match once. Is pattern matching on <code>mrSubList &lt;$&gt; x =~~ &quot;(foo)-(bar)|(quux)-(quux)(q*u*u*x*)&quot;</code> any better?"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1505855437, "post_id": 46309607, "comment_id": 79581526, "body": "@nponeccop It&#39;s supposed to just give the first match. I haven&#39;t actually tested my code yet, so I may need to edit it, but hopefully this demonstrates the idea."}, {"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1505860777, "post_id": 46309607, "comment_id": 79583262, "body": "Unfortunately this doesn&#39;t work: the list is always 6 elements long, and unmatched captures are all <code>&quot;&quot;</code>. Here is a short illustration: <code>(.*)foo|(.*)bar</code>. In Perl <code>$1</code> and <code>$2</code> are either <code>&#39;&#39;</code> or <code>undef</code>, so unmatched capture groups can be distinguished from matched but empty ones."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "reply_to_user": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1505861225, "post_id": 46309607, "comment_id": 79583372, "body": "@nponeccop I&#39;ve got it working on my system now. I&#39;m using <code>regex-pcre-builtin</code>. I wish it would be able to distinguish an unmatched capture group better, but <code>&quot;&quot;</code> will work in this case."}], "tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": false, "score": 1, "last_activity_date": 1505860132, "last_edit_date": 1505860132, "creation_date": 1505854438, "answer_id": 46309607, "question_id": 46308779, "link": "https://stackoverflow.com/questions/46308779/distinguish-empty-regexp-matches-from-no-matches-in-haskell/46309607#46309607", "title": "Distinguish empty regexp matches from no matches in Haskell", "body": "<p>To distinguish when there is no match, use <a href=\"http://hackage.haskell.org/package/regex-posix-0.95.2/docs/Text-Regex-Posix-Wrap.html#v:-61--126--126-\" rel=\"nofollow noreferrer\"><code>=~~</code></a> so that it will place the result in a <code>Maybe</code> monad. It will use <code>fail</code> to return <code>Nothing</code> if there are no matches.</p>\n\n<pre><code>myMatch :: String -&gt; Maybe (String, String, Maybe String)\nmyMatch str = do\n    let regex = \"(foo)-(bar)|(quux)-(quux)(q*u*u*x*)\"\n    groups &lt;- getAllTextSubmatches &lt;$&gt; str =~~ regex :: Maybe [String]\n    case groups of\n        [_, g1, g2, \"\", \"\", \"\"] -&gt; Just (g1, g2, Nothing)\n        [_, \"\", \"\", g3, g4, g5] -&gt; Just (g3, g4, Just g5)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 468, "user_id": 1266963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1051036e07e42ee389b4d255645115?s=128&d=identicon&r=PG", "display_name": "Yuri Syro", "link": "https://stackoverflow.com/users/1266963/yuri-syro"}, "is_accepted": false, "score": 0, "last_activity_date": 1509980424, "last_edit_date": 1509980424, "creation_date": 1509977095, "answer_id": 47138743, "question_id": 46308779, "link": "https://stackoverflow.com/questions/46308779/distinguish-empty-regexp-matches-from-no-matches-in-haskell/47138743#47138743", "title": "Distinguish empty regexp matches from no matches in Haskell", "body": "<p>Use <code>regex-applicative</code></p>\n\n<pre><code>myMatch = match re\nre = foobar &lt;|&gt; quuces where\n    foobar = (,,) &lt;$&gt; \"foo\" &lt;* \"-\" &lt;*&gt; \"bar\" &lt;*&gt; pure Nothing\n    quuces = (,,)\n        &lt;$&gt; \"quux\" &lt;* \"-\"\n        &lt;*&gt; \"quux\"\n        &lt;*&gt; (fmap (Just . mconcat) . sequenceA)\n            [many $ sym 'q', many $ sym 'u', many $ sym 'u', many $ sym 'x']\n</code></pre>\n\n<p>or, with ApplicativeDo,</p>\n\n<pre><code>re = foobar &lt;|&gt; quuces where\n    foobar = do\n        foo &lt;- \"foo\"\n        _ &lt;- \"-\"\n        bar &lt;- \"bar\"\n        pure (foo, bar, Nothing)\n    quuces = do\n        quux1 &lt;- \"quux\"\n        _ &lt;- \"-\"\n        quux2 &lt;- \"quux\"\n        quux3 &lt;- fmap snd . withMatched $\n            traverse (many . sym) (\"quux\" :: [Char])\n            -- [many $ sym 'q', many $ sym 'u', many $ sym 'u', many $ sym 'x']\n        pure (quux1, quux2, Just quux3)\n</code></pre>\n"}], "owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 368, "favorite_count": 0, "accepted_answer_id": 46309533, "answer_count": 3, "score": 2, "last_activity_date": 1509980424, "creation_date": 1505850916, "last_edit_date": 1505851460, "question_id": 46308779, "link": "https://stackoverflow.com/questions/46308779/distinguish-empty-regexp-matches-from-no-matches-in-haskell", "title": "Distinguish empty regexp matches from no matches in Haskell", "body": "<p>I'm trying to use <code>regex-pcre</code> but <code>regex-base</code> contains too many overloads for <code>RegexContext</code> so I don't know which one should I use for the task at hand.</p>\n\n<p>I want to match a string against <code>(foo)-(bar)|(quux)-(quux)(q*u*u*x*)</code> regular expression the following way:</p>\n\n<pre><code>myMatch :: String -&gt; Maybe (String, String, Maybe String)\n</code></pre>\n\n<p>Sample output:</p>\n\n<ul>\n<li><p><code>myMatch \"dfjdjk\"</code> should be <code>Nothing</code> as there is no match</p></li>\n<li><p><code>myMatch \"foo-bar\"</code> should be <code>Just (\"foo\", \"bar\", Nothing)</code> as there's no third capture group in the first alternative</p></li>\n<li><p><code>myMatch \"quux-quuxqu\"</code> should be <code>Just (\"quux\", \"quux\", Just \"qu\")</code></p></li>\n<li><p><code>myMatch \"quux-quux\"</code> should be <code>Just (\"quux\", \"quux\", Just \"\")</code> as the third capture group is present but empty</p></li>\n</ul>\n\n<p>It's not an assignment, I'm just baffled with how <a href=\"https://github.com/erantapaa/haskell-regexp-examples/blob/master/RegexExamples.hs\" rel=\"nofollow noreferrer\">https://github.com/erantapaa/haskell-regexp-examples/blob/master/RegexExamples.hs</a> don't contain code paths for situations where there are no matches or no capture groups</p>\n"}, {"tags": ["haskell", "gadt", "continuation-passing", "refinements", "refinement-type"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1505837105, "post_id": 46304713, "comment_id": 79572355, "body": "Same exact way you do it with any other CPS encoded datatype (&#39;Scrott&#39;?) - pass the function corresponding to each case as input to the elimination function. You can write an equivalent <code>unSome</code> as <code>\\k -&gt; runSomeC k (+3) toUpper id</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1505837419, "post_id": 46304713, "comment_id": 79572533, "body": "@user2407038 But where is the magic introduced by <code>(a ~ Int) =&gt;</code>, then? Sorry, I really don&#39;t understand what this constraint is actually doing."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1505837831, "post_id": 46304713, "comment_id": 79572763, "body": "@ftor Note that the user of a <code>SomeC a</code> may choose <code>r</code> to be a type that mentions <code>a</code>; e.g. they will choose <code>r ~ a</code> when writing <code>unSome</code>. Then together with <code>a ~ Int</code> that would mean they can get an <code>Int</code> out of the <code>Int -&gt; r</code> part."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1505838165, "post_id": 46305251, "comment_id": 79572975, "body": "So it&#39;s that simple! The difficulty is obviously more in the definition of the type than in its implementation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1505838247, "post_id": 46305251, "comment_id": 79573024, "body": "So <code>(a ~ Char) =&gt;</code> isn&#39;t an implicit function.  What is it then? Just an assertion of equality?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1505838439, "post_id": 46305251, "comment_id": 79573118, "body": "<code>((a ~ Char) =&gt; a -&gt; r) -&gt; r</code> means &quot;given a function which may assume that <code>a</code> is <code>Char</code> and takes as input <code>a</code> and produces as output <code>r</code>, produce as output <code>r</code>&quot;. It&#39;s just a constraint - same as e.g. <code>(Show a =&gt; a -&gt; r) -&gt; r</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1505838665, "post_id": 46305251, "comment_id": 79573235, "body": "@ftor Yes, it is an assertion of equality. The assertion is checked at compile time, and can be used at compile time to convert terms that are apparently of a type mentioning one side of the equation to terms of a type mentioning the other side. Depending on how far you want to move from &quot;denotational semantics&quot; to &quot;how the implementation of those semantics works&quot;... in GHC it is <i>also</i> an implicit function which takes as an argument evidence that the one type is equal to the other, in the form of a coercion that the compiler can emit when converting terms from one type to the other."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1505839168, "post_id": 46305251, "comment_id": 79573493, "body": "That means I cannot assert that <code>a</code> is an odd integer for instance, because the compiler can&#39;t determine this at compile time?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1505840898, "post_id": 46305251, "comment_id": 79574286, "body": "@ftor <code>a</code> is definitely not an odd integer; it is a type. Integers are values. If you had a type whose inhabitants were odd integers, you could assert that <code>a</code> was that type."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 0, "creation_date": 1505841289, "post_id": 46305251, "comment_id": 79574460, "body": "Yes, of course. Confusion again, sorry. I just though the example above would lead to type families and dependent types. I really have a hard time understanding them. Thanks for your help!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1505837720, "creation_date": 1505837720, "answer_id": 46305251, "question_id": 46304713, "link": "https://stackoverflow.com/questions/46304713/how-to-get-the-value-from-a-scott-encoded-gadt-with-type-equality-constraints/46305251#46305251", "title": "How to get the value from a Scott encoded GADT with type equality constraints?", "body": "<p>You just use the provided function to replace your pattern match, as in:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE RankNTypes #-}\n\nimport Data.Char\n\nnewtype SomeC a =\n    SomeC {\n      runSomeC ::\n          forall r.\n          ((a ~ Int) =&gt; Int -&gt; r) -&gt;\n          ((a ~ Char) =&gt; Char -&gt; r) -&gt;\n          (a -&gt; r) -&gt;\n          r\n    }\n\nunSome :: SomeC a -&gt; a\nunSome (SomeC f) = f (\\x -&gt; x+3) (\\c -&gt; toLower c) (\\x -&gt; x)\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>&gt; unSome (SomeC (\\someInt someChar anything -&gt; someInt 2))\n5\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 1, "accepted_answer_id": 46305251, "answer_count": 1, "score": 2, "last_activity_date": 1505842663, "creation_date": 1505835950, "last_edit_date": 1505842663, "question_id": 46304713, "link": "https://stackoverflow.com/questions/46304713/how-to-get-the-value-from-a-scott-encoded-gadt-with-type-equality-constraints", "title": "How to get the value from a Scott encoded GADT with type equality constraints?", "body": "<p>I am reading <a href=\"https://ocharles.org.uk/blog/guest-posts/2014-12-18-rank-n-types.html\" rel=\"nofollow noreferrer\">the Rank-N-Types section of 24 days of GHC Extensions</a> and came across the following GADT:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n\nimport Data.Char\n\ndata Some :: * -&gt; * where\n    SomeInt  :: Int -&gt; Some Int\n    SomeChar :: Char -&gt; Some Char\n    Anything :: a -&gt; Some a\n\nunSome :: Some a -&gt; a\nunSome (SomeInt x) = x + 3\nunSome (SomeChar c) = toLower c\nunSome (Anything x) = x\n\nunSome (someInt 2) -- 5\n</code></pre>\n\n<p>Although <code>unSome</code> is polymorphic in its type variables one can give the compiler proof that in the <code>SomeInt</code> case for instance, it is safe to add three to the given value. The author calls this type refinement.</p>\n\n<p>Now I was curious whether I can do the same with a Scrott encoded type. Fortunately, there is an example of such encoding. We merely need the Rank-N-Types and Type-Families extensions turned on:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE RankNTypes #-}\n\nnewtype SomeC a =\n    SomeC {\n      runSomeC ::\n          forall r.\n          ((a ~ Int) =&gt; Int -&gt; r) -&gt;\n          ((a ~ Char) =&gt; Char -&gt; r) -&gt;\n          (a -&gt; r) -&gt;\n          r\n    }\n</code></pre>\n\n<p>However, <code>unSome</code> isn't provided in the article. I am not well-versed in Haskell and don't have a clue how to implement this function with Scott encoding. Especially the type equality constraints (e.g. <code>(a ~ Int) =&gt;</code>) confuse me.</p>\n\n<p>Any help or information on other online sources are appreciated.</p>\n"}, {"tags": ["haskell", "recursion", "dynamic-programming", "memoization", "mutual-recursion"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1505838289, "post_id": 46303752, "comment_id": 79573047, "body": "I don&#39;t see any reason why this package wouldn&#39;t allow you to write mutually recursive functions. Something like <code>fun0 = memo $ \\x -&gt; .. fun1 (x-1) ..; fun1 = memo $ \\x -&gt; .. fun0 (x+1) ..</code> should work. For the 2nd question, there&#39;s no reason to expect the output of the function to be saved between different invocations of the function (indeed, this will never occur). This isn&#39;t how memoization of pure functions works."}, {"owner": {"reputation": 199, "user_id": 934983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66d4682b43c7ff70e36f40580a0d156f?s=128&d=identicon&r=PG", "display_name": "aliko", "link": "https://stackoverflow.com/users/934983/aliko"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1505838548, "post_id": 46303752, "comment_id": 79573170, "body": "I did according to tutorial on this page: <a href=\"https://hackage.haskell.org/package/monad-memo\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/monad-memo</a> It is stated there using memo for both functions will not work and suggested approach I copied.  As for execution time. How achieve only one calculation of the memoized table (map) and not recalculate each time function is invoked?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1505847756, "post_id": 46303752, "comment_id": 79577825, "body": "1. A memoized function a la <code>MemoT</code> will reduce computation time for recursive calls.  What you are asking about seems to be memoization in support of independent, non-recursive calls to the function - right?  2. Are you only testing in GHCi?  The interpreter is not for benchmarking, you should compile (with <code>-O2</code>) and measure run times of binaries when performance is of interest."}, {"owner": {"reputation": 199, "user_id": 934983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66d4682b43c7ff70e36f40580a0d156f?s=128&d=identicon&r=PG", "display_name": "aliko", "link": "https://stackoverflow.com/users/934983/aliko"}, "edited": false, "score": 0, "creation_date": 1505849642, "post_id": 46303752, "comment_id": 79578863, "body": "Well i&#39;m happy to have recursive calls memoized and already gained a good boost from it. But I want to have memoization between calls as well because there is no big point to repeat the same calculation. As for correct measurment of performance I would agree with you. But I believe ghci still gives good rough estimation and shows performance difference between implementations."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1505849919, "post_id": 46303752, "comment_id": 79578983, "body": "Stop believing that."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1505851869, "post_id": 46303752, "comment_id": 79579932, "body": "The package doesn&#39;t do anything too terribly weird. There&#39;s no bizarre action at a distance. You can only benefit from memoization within a single call to <code>startEvalMemoT</code>. If you want to chain calls manually for whatever reason, you&#39;ll need to use <code>runMemoT</code> instead, and explicitly pass the cache around. Recursion doesn&#39;t really have anything to do with it."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1505871885, "post_id": 46303752, "comment_id": 79585915, "body": "Since your computations are pure, perhaps you would like a pure memoization package such as <a href=\"https://hackage.haskell.org/package/MemoTrie\" rel=\"nofollow noreferrer\">MemoTrie</a> or <a href=\"https://hackage.haskell.org/package/data-memocombinators\" rel=\"nofollow noreferrer\">data-memocombinators</a>.  These will memoize results between calls even in the pure fragment, as they lean on laziness to do the memoization, so there are no &quot;effects&quot;."}, {"owner": {"reputation": 199, "user_id": 934983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66d4682b43c7ff70e36f40580a0d156f?s=128&d=identicon&r=PG", "display_name": "aliko", "link": "https://stackoverflow.com/users/934983/aliko"}, "edited": false, "score": 0, "creation_date": 1505897004, "post_id": 46303752, "comment_id": 79595812, "body": "Thanks #liqui for suggestion. I added an attempt on data-memcombinators though it gave me not boost but lost of performance."}], "answers": [{"tags": [], "owner": {"reputation": 199, "user_id": 934983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66d4682b43c7ff70e36f40580a0d156f?s=128&d=identicon&r=PG", "display_name": "aliko", "link": "https://stackoverflow.com/users/934983/aliko"}, "is_accepted": true, "score": 0, "last_activity_date": 1505902014, "creation_date": 1505902014, "answer_id": 46319164, "question_id": 46303752, "link": "https://stackoverflow.com/questions/46303752/memoization-with-monad-memo-for-mutual-recursion-in-haskell/46319164#46319164", "title": "Memoization with Monad.Memo for mutual recursion in Haskell", "body": "<p>Finally MemoTrie did the job.\nAt first invocation it works as fast (possibly much faster) than Monad.Memo and at consecutive invocations it take virtually no time!</p>\n\n<p>And tha change in code is trivial compared to monadic approach:</p>\n\n<pre><code>import Data.MemoTrie\n\ntype Pos = (Int, Int)\n\n-- we are moving to (0,0) as we can always shift the world by substituting variables\n-- due to symmetry it is enougth to solve for only positive x and y\n\ndynamic :: Int -&gt; Int -&gt; [Int]\ndynamic x y = lastUnique $ map (fqmem x y) [1 ..]\n    where lastUnique (x0:x1:xs) | x0 == x1  = x0 \n                                | otherwise = lastUnique (x1:xs)\n\nfqmem = memo3 fq\nfvmem = memo3 fv\n\nfq :: Int -&gt; Int -&gt; Int -&gt; [Int]\nfq _ _ 0 = [0, 0, 0, 0]           -- Q at 0 step is 0 in all directions\nfq x y n = (cost (x, y) +) . (uncurry $ fvmem n) &lt;$&gt; neighbours (x, y)\n\nfv :: Int -&gt; Int -&gt; Int -&gt; Int\nfv _ 0 0 = 0               -- V at (0, 0) is 0 at any atep\nfv 0 x y = cost (x, y)     -- V at 0 step is a cost\nfv n x y = minimum $ fqmem x y (n - 1)\n\ncost :: Pos -&gt; Int\ncost (x, y) = abs x + abs y\n\nneighbours :: Pos -&gt; [Pos]\nneighbours (x, y) = [(x-1, y), (x+1, y), (x, y-1), (x, y+1)]\n</code></pre>\n\n<p>Still I would like to know what is the benefits of using Monad.Memo and what are use cases for that? Or it becomes obsolete with MemoTrie?</p>\n\n<p>Why Memocombinators did not worked for me?</p>\n\n<p>What is the rule of thumb on choosing between Monad.Memo, Memocombinators or MemoTrie?</p>\n"}], "owner": {"reputation": 199, "user_id": 934983, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/66d4682b43c7ff70e36f40580a0d156f?s=128&d=identicon&r=PG", "display_name": "aliko", "link": "https://stackoverflow.com/users/934983/aliko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 1, "accepted_answer_id": 46319164, "answer_count": 1, "score": 0, "last_activity_date": 1505902014, "creation_date": 1505833066, "last_edit_date": 1505883304, "question_id": 46303752, "link": "https://stackoverflow.com/questions/46303752/memoization-with-monad-memo-for-mutual-recursion-in-haskell", "title": "Memoization with Monad.Memo for mutual recursion in Haskell", "body": "<p>I'm doing some dynamic programming in Haskell with mutual recursion implementation.</p>\n\n<p>I decided to speed things up using memoization.</p>\n\n<p>Monad.Memo offers MemoT transformer for that exact case. But it uses Map as internal representation for stored values. And while this gave me order of magnitude speed boost it is still not enough.</p>\n\n<p>While lib supports Array-based and Vector-based implementation as internal storage it only works for simple recursion and I did not found any transformers like MemoT to use it for mutual recursion.</p>\n\n<p>What is the best way to do mutual recursion memoization with efficient vector based internal representation (if any)?</p>\n\n<p>My next question is about memoization effect. So I expected my function to take more time during first run and much less during consecutive runs. But what I found running it in ghci the time it takes each time is the same. So no difference between first and second run. I measured time as follows:</p>\n\n<pre><code>timeit $ print $ dynamic (5,5)\n</code></pre>\n\n<p>With dynamic being my function.</p>\n\n<p>The full implementation is as follows:</p>\n\n<pre><code>import Control.Monad.Memo\nimport Control.Monad.Identity\n\ntype Pos = (Int, Int)\n\ntype MemoQ = MemoT (Int, Int, Int) [Int]\ntype MemoV = MemoT (Int, Int, Int) Int\ntype MemoQV = MemoQ (MemoV Identity)\n\n-- we are moving to (0,0) as we can always shift the world by substituting variables\n-- due to symmetry of cost function it is enougth to solve for only positive x and y\ndynamic :: Pos -&gt; [Int]\ndynamic (x, y) = lastUnique $ map (evalQ x y) [1 ..]\n    where lastUnique (x0:x1:xs) | x0 == x1  = x0 \n                                | otherwise = lastUnique (x1:xs)\n\nevalQ :: Int -&gt; Int -&gt; Int -&gt; [Int]\nevalQ x y n = startEvalMemo . startEvalMemoT $ fqmon  x y n\n\nfqmon :: Int -&gt; Int -&gt; Int -&gt; MemoQV [Int]\nfqmon _ _ 0 = return [0,0,0,0]\nfqmon x y n = do\n    let pts = neighbours (x, y)\n    let v = for3 memol1 fvmon n\n    let c = cost (x, y)\n    let q = fmap (c +) . uncurry v\n    traverse q pts\n\nfvmon :: Int -&gt; Int -&gt; Int -&gt; MemoQV Int\nfvmon _ 0 0 = return 0\nfvmon 0 x y = return $ cost (x, y)\nfvmon n x y | limit     = return 1000000\n            | otherwise = liftM minimum $ for3 memol0 fqmon x' y' (n - 1)\n            where x' = abs x\n                y' = abs y\n                limit = x' &gt; 25 || y' &gt; 25\n\ncost :: Pos -&gt; Int\ncost (x, y) = abs x + abs y\n\nneighbours :: Pos -&gt; [Pos]\nneighbours (x, y) = [(x-1, y), (x+1, y), (x, y-1), (x, y+1)]\n</code></pre>\n\n<hr>\n\n<p>Added:</p>\n\n<p>According to #liqui comment I tried memcombinators.</p>\n\n<p>So first is the non memoized initial implementation:</p>\n\n<pre><code>type Pos = (Int, Int)\n\ndynamic :: Int -&gt; Int -&gt; [Int]\ndynamic x y = lastUnique $ map (fq x y) [1 ..]\n    where lastUnique (x0:x1:xs) | x0 == x1  = x0 \n                                | otherwise = lastUnique (x1:xs)\n\nfq :: Int -&gt; Int -&gt; Int -&gt; [Int]\nfq _ _ 0 = [0, 0, 0, 0]           -- Q at 0 step is 0 in all directions\nfq x y n = (cost (x, y) +) . (uncurry $ fv n) &lt;$&gt; neighbours (x, y)\n\nfv :: Int -&gt; Int -&gt; Int -&gt; Int\nfv _ 0 0 = 0               -- V at (0, 0) is 0 at any atep\nfv 0 x y = cost (x, y)     -- V at 0 step is a cost\nfv n x y = minimum $ fq x y (n - 1)\n\ncost :: Pos -&gt; Int\ncost (x, y) = abs x + abs y\n\nneighbours :: Pos -&gt; [Pos]\nneighbours (x, y) = [(x-1, y), (x+1, y), (x, y-1), (x, y+1)]\n</code></pre>\n\n<p>Then my attempt to memization (only changed part):</p>\n\n<pre><code>dynamic :: Int -&gt; Int -&gt; [Int]\ndynamic x y = lastUnique $ map (fqmem x y) [1 ..]\n    where lastUnique (x0:x1:xs) | x0 == x1  = x0 \n                                | otherwise = lastUnique (x1:xs)\n-- memoizing version of fq\nfqmem :: Int -&gt; Int -&gt; Int -&gt; [Int]\nfqmem x y n = fqmem' x y n\n    where fqmem' = memo3 integral integral integral fq\n\n-- memoizing version of fv\nfvmem :: Int -&gt; Int -&gt; Int -&gt; Int\nfvmem n x y = fvmem' n x y\n    where fvmem' = memo3 integral integral integral fv\n\nfq :: Int -&gt; Int -&gt; Int -&gt; [Int]\nfq _ _ 0 = [0, 0, 0, 0]           -- Q at 0 step is 0 in all directions\nfq x y n = (cost (x, y) +) . (uncurry $ fvmem n) &lt;$&gt; neighbours (x, y)\n\nfv :: Int -&gt; Int -&gt; Int -&gt; Int\nfv _ 0 0 = 0               -- V at (0, 0) is 0 at any atep\nfv 0 x y = cost (x, y)     -- V at 0 step is a cost\nfv n x y = minimum $ fqmem x y (n - 1)\n</code></pre>\n\n<p>The result a bit of paradox. It is 3 time slower than non memoized recursive implementation. Memoizing only one function (namely fq) and not touching fv gives results 2 times slower. The more I memoize with memcombinators the slower the computation. And again no difference between first and second invocation.</p>\n\n<p>Also the last question. What is the rationale for choosing between Monad.Memo or memcombinators or MemotTrie? There is a point on using last 2 in comments. What are the situations when Monad.Memo is a better choice?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 1, "creation_date": 1505825218, "post_id": 46300704, "comment_id": 79563960, "body": "My guess is this will become easier if you take out the function you want to filter with and write it separately.  But it would be easier to understand what you&#39;re doing if you give us some example inputs and outputs."}, {"owner": {"reputation": 936, "user_id": 4884579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fca1fac3b94fed8f0291116e9b4ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4884579/erik"}, "edited": false, "score": 0, "creation_date": 1505825226, "post_id": 46300704, "comment_id": 79563968, "body": "Would be helpful if you could explain in words what you were trying to do here."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1505825288, "post_id": 46300704, "comment_id": 79564010, "body": "Please instead of posting some invalid code fragment, first explain <i>what</i> you aim to accomplish. What problem do you want to solve with this <code>filter</code>?"}, {"owner": {"reputation": 51, "user_id": 8168200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-QsHbz8YjcMY/AAAAAAAAAAI/AAAAAAAAACw/jqGmmP79ahk/photo.jpg?sz=128", "display_name": "BaasBartMans", "link": "https://stackoverflow.com/users/8168200/baasbartmans"}, "edited": false, "score": 0, "creation_date": 1505825526, "post_id": 46300704, "comment_id": 79564196, "body": "I have a table, which is a list of lists of strings. The top of the table has names. So for instance, i want to only show all the rows where money is higher than 500, the code would search the location of money in top list, and then would, for every row, check if the value on that spot is higher than 500 and if not, not show the row  So for each &quot;Sublist&quot; i want to check if a word on a certain index is equal to another word, but to check that i need the sublist"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8168200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-QsHbz8YjcMY/AAAAAAAAAAI/AAAAAAAAACw/jqGmmP79ahk/photo.jpg?sz=128", "display_name": "BaasBartMans", "link": "https://stackoverflow.com/users/8168200/baasbartmans"}, "edited": false, "score": 0, "creation_date": 1505832531, "post_id": 46302916, "comment_id": 79569377, "body": "Thanks, for the described scenario it works indeed, but i needed a solution to a more abstract problem. Specificaly what i did in my second edit."}, {"owner": {"reputation": 661, "user_id": 7720738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HccZv.png?s=128&g=1", "display_name": "James Burton", "link": "https://stackoverflow.com/users/7720738/james-burton"}, "reply_to_user": {"reputation": 51, "user_id": 8168200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-QsHbz8YjcMY/AAAAAAAAAAI/AAAAAAAAACw/jqGmmP79ahk/photo.jpg?sz=128", "display_name": "BaasBartMans", "link": "https://stackoverflow.com/users/8168200/baasbartmans"}, "edited": false, "score": 0, "creation_date": 1505833734, "post_id": 46302916, "comment_id": 79570236, "body": "@BaasBartMans You&#39;re welcome, next time it would probably help if you described the abstract problem in the question. Nobody can help you if they don&#39;t know what the problem is."}], "tags": [], "owner": {"reputation": 661, "user_id": 7720738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HccZv.png?s=128&g=1", "display_name": "James Burton", "link": "https://stackoverflow.com/users/7720738/james-burton"}, "is_accepted": true, "score": 1, "last_activity_date": 1505830780, "creation_date": 1505830780, "answer_id": 46302916, "question_id": 46300704, "link": "https://stackoverflow.com/questions/46300704/haskell-accesing-the-sublist-while-filtering-a-list-of-a-list/46302916#46302916", "title": "Haskell accesing the sublist while filtering a list of a list", "body": "<p>Given that you're wanting to compare money and check <code>money &gt; 500</code> it makes much more sense to store it as an <code>Int</code> not a <code>String</code>. Furthermore I would say storing each entry as a tuple and having a list of tuples makes more sense than using a list of lists (this is also required for the Int implementation of money as you can't have a list of different types of lists).</p>\n\n<p>So the table would have type <code>[(String, Int)]</code>.</p>\n\n<p><code>filter</code> goes through the list and checks each element against a condition. In this case the condition is so simple I wouldn't bother making it it's own function (unless you need to reuse it in lots of places).</p>\n\n<p>When given a pair of type <code>(String, Int)</code> we just want to check if that second value is > 500. So the condition is simply <code>snd row &gt; 500</code> where row is the tuple we were given representing a row in the table.</p>\n\n<p>This leaves us with:\n<code>filter (\\row -&gt; snd row &gt; 500) table</code></p>\n\n<p>Testing on <code>[(\"Geoff\", 600), (\"Bill\", 700), (\"Bill Jr.\", 10)]</code> this gives <code>[(\"Geoff\", 600), (\"Bill\", 700)]</code> as expected.</p>\n"}], "owner": {"reputation": 51, "user_id": 8168200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh4.googleusercontent.com/-QsHbz8YjcMY/AAAAAAAAAAI/AAAAAAAAACw/jqGmmP79ahk/photo.jpg?sz=128", "display_name": "BaasBartMans", "link": "https://stackoverflow.com/users/8168200/baasbartmans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 46302916, "answer_count": 1, "score": 0, "last_activity_date": 1505830780, "creation_date": 1505824816, "last_edit_date": 1505828525, "question_id": 46300704, "link": "https://stackoverflow.com/questions/46300704/haskell-accesing-the-sublist-while-filtering-a-list-of-a-list", "title": "Haskell accesing the sublist while filtering a list of a list", "body": "<p>I'm fairly new to Haskell, and try to accomplish the following:</p>\n\n<pre><code>filter (((!!) subList (fromJust (elemIndex String [String]))) == String) [[string]]\n</code></pre>\n\n<p>I replaced the names with their types to make it easier to read. The problem is that i can't do subList, but the (!!) takes a list as argument. So how would i go about writing this? </p>\n\n<p>edit:</p>\n\n<p>I wrote the filtering condition seperately, which works, but the problem is still the same:</p>\n\n<pre><code>findGood :: [String] -&gt; String -&gt; [String] -&gt; String -&gt; Bool\n</code></pre>\n\n<p>but i still need to fill in all the values, though the first [String] is the sublist. All the other values can be entered..</p>\n\n<p>Edit:</p>\n\n<p>I solved it, what i needed to do was put the [String] last, and then i could leave it out in the filter</p>\n\n<p>So </p>\n\n<pre><code>findGood :: String -&gt; [String] -&gt; String -&gt; [String] -&gt; Bool\n            filter (findGood a b c) [[String]]\n</code></pre>\n\n<p>Thats what works, and thats what I wanted. (not needing the D)</p>\n"}, {"tags": ["haskell", "existential-type", "strictness"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1505854975, "post_id": 46300021, "comment_id": 79581333, "body": "It would be very nice to have this optimization. See <a href=\"https://ghc.haskell.org/trac/ghc/wiki/NewtypeOptimizationForGADTS\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/wiki/NewtypeOptimizationForGADTS</a>. Unfortunately, the experts haven&#39;t figured out how to make everything work right yet."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 5, "last_activity_date": 1505949767, "last_edit_date": 1505949767, "creation_date": 1505829739, "answer_id": 46302538, "question_id": 46300021, "link": "https://stackoverflow.com/questions/46300021/existential-data-types-with-a-single-strict-field/46302538#46302538", "title": "Existential data types with a single strict field", "body": "<p><em>Edited</em> to fix some details re: quads being 8 bytes and explaining the static link field.</p>\n\n<p>I think <code>unsafeSizeOf</code> is inaccurate <em>and</em> you're misinterpreting its output.  Note that it is intended to show the memory usage for the top-level closure only, not the total space usage of the object.  What you're seeing, I think, is that <code>q</code> requires 10 bytes in <em>addition</em> to the tuple <code>p</code> (while <code>p</code> requires 10 bytes in <em>addition</em> to the boxed <code>Char</code> and boxed <code>Int</code>).  Moreover, my tests indicate that the top-level constructors actually require 24 bytes each (on a 64-bit architecture), even though <code>unsafeSizeOf</code> reports 10 for me, too. </p>\n\n<p>In particular, if I compile the following test program with <code>stack ghc -- -fforce-recomp -ddump-asm -dsuppress-all -O2 ZeroMemory.hs</code> using GHC 8.0.2:</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n{-# LANGUAGE PolyKinds #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeFamilies #-}\n\nmodule ZeroMemory where\n\ndata Uncurry (a :: i -&gt; j -&gt; *) (z :: (i, j)) =\n  forall x y . z ~ '(x,y) =&gt; Uncurry !(a x y)\n\nq :: Uncurry (,) '(Int, Char)\nq = Uncurry (0, '\\0')\n\nr :: Uncurry (,) '(Int, Char)\nr = Uncurry (1, '\\1')\n</code></pre>\n\n<p>then the memory footprint for the top-level <code>q</code> closure looks like:</p>\n\n<pre><code>q_closure:\n    .quad   Uncurry_static_info\n    .quad   $s$WUncurry_$d~~_closure+1\n    .quad   q1_closure+1\n    .quad   3\n</code></pre>\n\n<p>Note that each <code>.quad</code> here is actually 8 bytes; it's a \"quad\" of old-style 16-bit \"words\".  I believe the final <code>quad</code> here, with value 3, is the \"static link field\" described in <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/HeapObjects\" rel=\"nofollow noreferrer\">the GHC implementation commentary</a> and so doesn't apply to \"typical\" heap allocation objects.</p>\n\n<p>So, ignoring this final field, the total size of the top-level <code>q</code> closure is 24 bytes, and it refers to the <code>q1_closure</code> which represents the contained tuple:</p>\n\n<pre><code>q1_closure:\n    .quad   (,)_static_info\n    .quad   q3_closure+1\n    .quad   q2_closure+1\n    .quad   3\n</code></pre>\n\n<p>for another 24 bytes.</p>\n\n<p>The <code>q2</code> and <code>q3</code> closures are the boxed <code>Int</code> and <code>Char</code> and so take up two quads (16 bytes) each.  So, <code>q</code> takes up a total of 10 quads, or 80 bytes.  (I included <code>r</code> as a sanity check to make sure I wasn't misidentifying any shared info.)</p>\n\n<p>A <code>p</code> tuple by itself would have a memory footprint equivalent to the <code>q1_closure</code>, so 7 quads or 56 bytes.</p>\n"}, {"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 6, "last_activity_date": 1612023296, "last_edit_date": 1612023296, "creation_date": 1505830157, "answer_id": 46302693, "question_id": 46300021, "link": "https://stackoverflow.com/questions/46300021/existential-data-types-with-a-single-strict-field/46302693#46302693", "title": "Existential data types with a single strict field", "body": "<p><code>data</code> is never transformed to <code>newtype</code>. <code>Uncurry</code> does add a new closure, and a pointer for the <code>~</code> dictionary is actually also carted around, as of GHC 8.0.2. Hence, <code>Uncurry</code> has a closure with three words.</p>\n<p><code>unsafeSizeof</code> is incorrect, since <code>Array#</code> stores its size in words, while <code>ByteArray#</code> stores its size in bytes, so <code>sizeofByteArray# (unsafeCoerce# ptrs)</code> returns the number of words rather than the intended  number of bytes. A correct version would look like this on 64 bit systems:</p>\n<pre><code>unsafeSizeof :: a -&gt; Int\nunsafeSizeof !a =\n  case unpackClosure# a of\n    (# x, ptrs, nptrs #) -&gt;\n      I# (8# +# sizeofArray# nptrs *# 8# +# sizeofByteArray# ptrs)\n</code></pre>\n<p>But note that <code>unsafeSizeof</code> only gives us the size of the topmost closure. So, the closure size of any boxed tuple will be <code>24</code>, which coincides with the closure size of <code>Uncurry t</code>, since <code>Uncurry</code> has an info pointer, a useless pointer for <code>~</code>, and a pointer for the tuple field. This coincidence also holds with the previous buggy <code>unsafeSizeof</code> implementation. But the total size of <code>Uncurry t</code> is greater than that of <code>t</code>.</p>\n"}], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 46302693, "answer_count": 2, "score": 5, "last_activity_date": 1612023296, "creation_date": 1505822718, "last_edit_date": 1505824260, "question_id": 46300021, "link": "https://stackoverflow.com/questions/46300021/existential-data-types-with-a-single-strict-field", "title": "Existential data types with a single strict field", "body": "<p>So I have an existential data type with a single strict field:</p>\n\n<pre><code>data Uncurry (a :: i -&gt; j -&gt; *) (z :: (i,j)) =\n  forall x y. z ~ '(x,y) =&gt; Uncurry !(a x y) \n</code></pre>\n\n<p>Experimentation using <code>unsafeSizeof</code> (stolen from <a href=\"https://stackoverflow.com/a/6575209/9859\">this answer</a>) leads me to believe that it can be zero memory-overhead:</p>\n\n<pre><code>\u03bb p = (0, '\\0') :: (Int, Char)\n\u03bb q = Uncurry p\n\u03bb unsafeSizeof p\n10\n\u03bb unsafeSizeof q\n10\n</code></pre>\n\n<p>So it seems like <code>Uncurry</code> is sort of acting like a <code>newtype</code>, being used only at compile time. </p>\n\n<p>This makes sense to me, as the equality assertion doesn't require a dictionary to be carted about.</p>\n\n<p>Is that a valid interpretation?  Do I have any guarantees of that from GHC (or the Haskell report), or did I just luck out?</p>\n"}, {"tags": ["haskell", "typeclass"], "answers": [{"tags": [], "owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "is_accepted": true, "score": 5, "last_activity_date": 1505819054, "last_edit_date": 1505819054, "creation_date": 1505818537, "answer_id": 46298639, "question_id": 46298573, "link": "https://stackoverflow.com/questions/46298573/is-it-possible-to-define-instances-of-data-foldable-with-foldr-where-foldr-takes/46298639#46298639", "title": "Is it possible to define instances of Data.Foldable with foldr where foldr takes arguments of different types?", "body": "<p>The problem isn't that the types are different. The type of your <code>foldr</code> is just not the same as what <code>Foldable</code> requires. It would need to be:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; Tree a -&gt; b\n</code></pre>\n\n<p>And those <code>a</code> and <code>b</code> type parameters must remain as parameters: this has to work <em>for all</em> choices of <code>a</code> and <code>b</code>. You can't constrain them to some other type class and you can't restrict one of them to be a concrete <code>Int</code> type.</p>\n"}, {"tags": [], "owner": {"reputation": 4232, "user_id": 428586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHNYS.jpg?s=128&g=1", "display_name": "Robert Hensing", "link": "https://stackoverflow.com/users/428586/robert-hensing"}, "is_accepted": false, "score": 1, "last_activity_date": 1505822578, "creation_date": 1505822578, "answer_id": 46299970, "question_id": 46298573, "link": "https://stackoverflow.com/questions/46298573/is-it-possible-to-define-instances-of-data-foldable-with-foldr-where-foldr-takes/46299970#46299970", "title": "Is it possible to define instances of Data.Foldable with foldr where foldr takes arguments of different types?", "body": "<p>It seems that what you want can be achieved by using the actual <code>foldr</code> function instead of modifying it. You can not change the signature of a type class method, and in this case, there is no need. Try implementing <code>foldr</code> by providing a sensible implementation of its type and then write a function <code>addSize</code> that can be passed as the first argument to <code>foldr</code>. <code>foldr addSize 0</code> will have the behavior you want.</p>\n"}], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 46298639, "answer_count": 2, "score": 0, "last_activity_date": 1505822578, "creation_date": 1505818369, "question_id": 46298573, "link": "https://stackoverflow.com/questions/46298573/is-it-possible-to-define-instances-of-data-foldable-with-foldr-where-foldr-takes", "title": "Is it possible to define instances of Data.Foldable with foldr where foldr takes arguments of different types?", "body": "<p>The type class <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Foldable.html\" rel=\"nofollow noreferrer\">Data.Foldable</a> has the following definition:</p>\n\n<pre><code>class Foldable t where\n    {-# MINIMAL foldMap | foldr #-}\n    foldMap :: Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m\n    foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b\n    ....\n    &lt;more definitions&gt;\n</code></pre>\n\n<p>The minimal stanza says, that I it's possible to define an instance only with the <em>foldr</em> function.\nIn all the examples I can compile, the foldr function has type <code>a -&gt; a -&gt; a</code>. However I'm unable \nto define something where the <em>foldr</em> function has really type <code>a -&gt; b -&gt; b</code> where the types <code>a</code> and <code>b</code>\nare different.</p>\n\n<p>The following code shows an example, that does NOT compile:</p>\n\n<pre><code>import Data.Foldable\n\ndata Tree a = Tree a a | Leaf a\n\nclass Size a where\n   size :: a -&gt; Int \n\ninstance Size a =&gt; Foldable (Tree a) where\n  foldr :: a -&gt; Int -&gt; Int\n  foldr x n = size x + n\n</code></pre>\n\n<p>Is it possible to define an instance of Foldable with <code>foldr</code>, where the types <code>a</code> and <code>b</code> are really different?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505817423, "post_id": 46298194, "comment_id": 79558533, "body": "<code>let field x y = 0 in field</code>...? So you want to return a function?"}, {"owner": {"reputation": 57, "user_id": 8279308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xBPta.jpg?s=128&g=1", "display_name": "majorTom", "link": "https://stackoverflow.com/users/8279308/majortom"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505817516, "post_id": 46298194, "comment_id": 79558601, "body": "I have to return the field as a whole after the change was made"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1505817575, "post_id": 46298194, "comment_id": 79558645, "body": "But functions in Haskell have no &quot;memory&quot;: you can not &quot;update&quot; pure functions. You probably want to use some sort of state monad."}, {"owner": {"reputation": 186, "user_id": 3246781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8a4df657b8a4d5c9045aa2328276cdb?s=128&d=identicon&r=PG&f=1", "display_name": "Gerard", "link": "https://stackoverflow.com/users/3246781/gerard"}, "edited": false, "score": 0, "creation_date": 1505817747, "post_id": 46298194, "comment_id": 79558770, "body": "It could also be a new type containing a list of key and values"}], "answers": [{"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 5, "last_activity_date": 1505820874, "last_edit_date": 1505820874, "creation_date": 1505818158, "answer_id": 46298502, "question_id": 46298194, "link": "https://stackoverflow.com/questions/46298194/battleships-in-haskell-beginner/46298502#46298502", "title": "Battleships in Haskell (beginner)", "body": "<p>So you're using a higher-order encoding: a field is represented as a function. Let me define some type synonyms to clarify this a little:</p>\n\n<pre><code>type Coords = (Int, Int)\ntype Field = Coords -&gt; Int\n\nfieldA :: Field\nfieldA (1, 1) = 0\nfieldA (1, 2) = 1\nfieldA (1, 3) = 0\nfieldA (2, 1) = 2\nfieldA (2, 2) = 0\nfieldA (2, 3) = 0\nfieldA (3, 1) = 1\nfieldA (3, 2) = 0\nfieldA (3, 3) = 2\nfieldA _ = -1\n</code></pre>\n\n<p>(I've adjusted <code>fieldA</code> to take a tuple of arguments, rather than two curried arguments. I think this makes it easier to see which <code>Int</code>s are which.)</p>\n\n<p>What does it mean to update a function? It means creating a new function which differs from the old function at some of its arguments. In this instance we want to make a new function which returns <code>0</code> at the bombed spot, but delegates to the old field in all other cases.</p>\n\n<pre><code>bombAt :: Coords -&gt; Field -&gt; Field\nbombAt bombCoords oldField = \\coords -&gt;\n    if coords == bombCoords\n    then 0\n    else oldField coords\n</code></pre>\n\n<p>You can clean up this definition slightly by replacing the lambda with a plain old parameter and using guard clauses instead of <code>if</code>.</p>\n\n<pre><code>bombAt :: Coords -&gt; Field -&gt; Field\nbombAt bombCoords oldField coords\n    | bombCoords == coords = 0\n    | otherwise            = oldField coords\n</code></pre>\n\n<p>Hopefully you can see how to adjust this to fit the slightly different (un-tupled) type you were given in the exercise.</p>\n"}], "owner": {"reputation": 57, "user_id": 8279308, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xBPta.jpg?s=128&g=1", "display_name": "majorTom", "link": "https://stackoverflow.com/users/8279308/majortom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 46298502, "answer_count": 1, "score": 2, "last_activity_date": 1505820874, "creation_date": 1505817128, "last_edit_date": 1505817460, "question_id": 46298194, "link": "https://stackoverflow.com/questions/46298194/battleships-in-haskell-beginner", "title": "Battleships in Haskell (beginner)", "body": "<p>we are supposed to write a function that returns the game area after a bomb was droped </p>\n\n<p><code>bombOn x y field -&gt; field(bombed)</code>, a field looks like this:</p>\n\n<pre><code>fieldA :: Int -&gt; Int -&gt; Int\nfieldA 1 1 = 0\nfieldA 1 2 = 1\nfieldA 1 3 = 0\nfieldA 2 1 = 2\nfieldA 2 2 = 0\nfieldA 2 3 = 0\nfieldA 3 1 = 1\nfieldA 3 2 = 0\nfieldA 3 3 = 2\nfieldA _ _ = -1\n</code></pre>\n\n<p>my Idea was this:</p>\n\n<pre><code>bombOn x y field = if field x y == 0 then field else let field x y = 0 in field\n</code></pre>\n\n<p>but this obviously doesn't work because my return (the part after the in) is false, and now the question how do i now return the <strong>whole field</strong> with an exchanged value?</p>\n\n<p>it would be easy with a list of lists or some differently formated field but with this I have no clue thx.</p>\n"}, {"tags": ["haskell", "yesod", "ghci", "servant", "scotty"], "comments": [{"owner": {"reputation": 756, "user_id": 3710751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c92104b92f86f29098c11fa44b6cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Pickering", "link": "https://stackoverflow.com/users/3710751/matthew-pickering"}, "edited": false, "score": 1, "creation_date": 1505831988, "post_id": 46296919, "comment_id": 79568965, "body": "Without the code it is difficult to comment. Please can you share your benchmarks and post an issue on the issue tracker?"}, {"owner": {"reputation": 5267, "user_id": 1102851, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e1866c32c13460429d2f9ba066949bc?s=128&d=identicon&r=PG", "display_name": "bgamari", "link": "https://stackoverflow.com/users/1102851/bgamari"}, "edited": false, "score": 1, "creation_date": 1505835544, "post_id": 46296919, "comment_id": 79571354, "body": "Indeed, this is quite surprising and it would be great to have code to look at."}, {"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "reply_to_user": {"reputation": 756, "user_id": 3710751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c92104b92f86f29098c11fa44b6cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Pickering", "link": "https://stackoverflow.com/users/3710751/matthew-pickering"}, "edited": false, "score": 0, "creation_date": 1505888507, "post_id": 46296919, "comment_id": 79590739, "body": "@MatthewPickering Ok, I will clean up my code and upload it to github."}, {"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "reply_to_user": {"reputation": 5267, "user_id": 1102851, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/0e1866c32c13460429d2f9ba066949bc?s=128&d=identicon&r=PG", "display_name": "bgamari", "link": "https://stackoverflow.com/users/1102851/bgamari"}, "edited": false, "score": 0, "creation_date": 1505890570, "post_id": 46296919, "comment_id": 79591877, "body": "@bgamari here is the link to the github repo, It would be great if you guys could take a look at it.  <a href=\"https://github.com/miladz68/haskell-webframework-comparison\" rel=\"nofollow noreferrer\">github.com/miladz68/haskell-webframework-comparison</a>"}, {"owner": {"reputation": 756, "user_id": 3710751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c92104b92f86f29098c11fa44b6cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Pickering", "link": "https://stackoverflow.com/users/3710751/matthew-pickering"}, "edited": false, "score": 0, "creation_date": 1505897633, "post_id": 46296919, "comment_id": 79596238, "body": "Thanks, see <a href=\"https://ghc.haskell.org/trac/ghc/ticket/14256\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/14256</a>"}, {"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "reply_to_user": {"reputation": 756, "user_id": 3710751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46c92104b92f86f29098c11fa44b6cdd?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Pickering", "link": "https://stackoverflow.com/users/3710751/matthew-pickering"}, "edited": false, "score": 0, "creation_date": 1505899942, "post_id": 46296919, "comment_id": 79597760, "body": "@MatthewPickering Thanks. whell it is only 2x faster not 50x faster :)"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1505936299, "post_id": 46296919, "comment_id": 79621733, "body": "@miladzahedi In case of snap, it is <code>50x</code> faster."}], "answers": [{"comments": [{"owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "edited": false, "score": 0, "creation_date": 1505890597, "post_id": 46298001, "comment_id": 79591890, "body": "I uploaded my code to github. link in the comments."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 3, "last_activity_date": 1505816590, "creation_date": 1505816590, "answer_id": 46298001, "question_id": 46296919, "link": "https://stackoverflow.com/questions/46296919/haskell-webframeworks-speed-ghci-vs-compiled/46298001#46298001", "title": "haskell webframeworks speed, GHCi vs Compiled", "body": "<p>This was a recent issue found out by Harendra Kumar also in this <a href=\"https://ghc.haskell.org/trac/ghc/ticket/14208\" rel=\"nofollow noreferrer\">GHC ticket</a>. You can see the relevant <a href=\"https://mail.haskell.org/pipermail/ghc-devs/2017-September/014617.html\" rel=\"nofollow noreferrer\">ghc-dev mailing list</a> discussion here. See this specific observation from <a href=\"https://mail.haskell.org/pipermail/ghc-devs/2017-September/014624.html\" rel=\"nofollow noreferrer\">Harendra</a>:</p>\n\n<blockquote>\n  <p>While trying to come up with a minimal example I discovered one more\n  puzzling thing. runghc is fastest, ghc is slower, ghc with\n  optimization is slowest. This is completely reverse of the expected\n  order.</p>\n</blockquote>\n\n<p>If possible, I would suggest you to come up with a minimal benchmark for the same and update the ghc ticket with your repository.</p>\n"}], "owner": {"reputation": 777, "user_id": 5303318, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-qykohYXsIz0/AAAAAAAAAAI/AAAAAAAAADc/G9CJWc1s3dM/photo.jpg?sz=128", "display_name": "milad zahedi", "link": "https://stackoverflow.com/users/5303318/milad-zahedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1505816590, "creation_date": 1505813803, "question_id": 46296919, "link": "https://stackoverflow.com/questions/46296919/haskell-webframeworks-speed-ghci-vs-compiled", "title": "haskell webframeworks speed, GHCi vs Compiled", "body": "<p>Today I did little benchmarking on my local machine to compare plain text speed of different Haskell web frameworks, and I noticed something strange. Almost all the frameworks that I tested, performed better when they were run from GHCi compared to compiled version. here are my results</p>\n\n<pre><code>+------------------------------------\n|framework| GHCi rpm   | compiled rpm \n+---------+------------+-------------\n|snap     | 8000       | 150\n+---------+------------+-------------\n|yesod    | 6000       | 2500\n+---------+------------+-------------\n|scotty   | 22000      | 9500\n+---------+------------+-------------\n|servant  | 17000      | 8500\n+---------+------------+-------------\n|spock    | 3300       | 2700\n+---------+------------+-------------\n</code></pre>\n\n<p>I know that these numbers do not reflect on these frameworks speed, since they are not well tuned or optimized, but my question is why are these frameworks performing better when launched from GHCi. Am I doing something wrong ? </p>\n\n<p>in order to build them I simply run <code>stack build</code> </p>\n"}, {"tags": ["haskell", "lambda-calculus"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1505791367, "post_id": 46291232, "comment_id": 79545214, "body": "<a href=\"https://en.wikibooks.org/wiki/Haskell/Pattern_matching\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/Pattern_matching</a>"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1505824646, "post_id": 46291232, "comment_id": 79563550, "body": "<a href=\"https://www.willamette.edu/~fruehr/haskell/evolution.html\" rel=\"nofollow noreferrer\">Tongue in cheek answer</a>"}], "answers": [{"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1506032680, "post_id": 46291979, "comment_id": 79668111, "body": "Don&#39;t forget pattern matching on the <code>Bool</code> from <code>(==)</code>, which is what both guards and if/then/else are sugar for.. (Haskell may have too many special ways to handle Bool)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1505796328, "creation_date": 1505796328, "answer_id": 46291979, "question_id": 46291232, "link": "https://stackoverflow.com/questions/46291232/how-to-write-recursive-factorial-function-in-haskell-without-if-then-else-statme/46291979#46291979", "title": "How to write recursive factorial function in haskell without if then else statment", "body": "<p>Pattern matching and guards are two particularly straightforward ways. Guards are essentially another syntax for if-then-else; they look like this:</p>\n\n<pre><code>fac n | n &lt; 2     = 1\n      | otherwise = n * fac (n-1)\n</code></pre>\n\n<p>Unlike if-then-else, they cleanly support multiple conditions; one could also write, for example,</p>\n\n<pre><code>fac n | n &lt; 0 = error \"nah\"\n      | n == 0 = 1\n      | n == 1 = 1\n      | n &gt; 1 = n * fac (n-1)\n</code></pre>\n\n<p>which would look much less pretty in if-then-else form.</p>\n\n<p>With pattern matching, one would typically write multiple defining equations:</p>\n\n<pre><code>fac 0 = 1\nfac 1 = 1\nfac n = n * fac (n-1)\n</code></pre>\n\n<p>For numbers in particular, this also desugars to essentially an if-then-else; but for data types with less compiler integration often cannot be emulated with if-then-else, and also often leads to very natural-looking code.</p>\n\n<p>Another very nice approach would be to push your recursion into existing Prelude functions; the more you can spot iteration patterns in practice the more bugs you can avoid by not re-implementing the same loops over and over. For this one, you might use <code>product</code> and the special enumeration syntax:</p>\n\n<pre><code>fac n = product [1..n]\n</code></pre>\n\n<p>A more advanced (and significantly worse) technique would be to define a new kind of number; e.g. Church numerals allow the producer of the number to drive the recursion, and the consumer (here, <code>fac</code>) to just supply base cases. In this style, you might see something like this:</p>\n\n<pre><code>fac n = fst (n (1,1) (\\(prod, sum) -&gt; (prod*sum, sum+1)))\n</code></pre>\n\n<p>(But note well that this requires a very special kind of number -- certainly the type of <code>fac</code> is not one of a function that could accept <code>Int</code> or <code>Integer</code>!) This joke is taken to its logical and horrifying conclusion in <a href=\"https://www.willamette.edu/~fruehr/haskell/evolution.html\" rel=\"noreferrer\">The Evolution of a Haskell Programmer</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1505798277, "creation_date": 1505798277, "answer_id": 46292361, "question_id": 46291232, "link": "https://stackoverflow.com/questions/46291232/how-to-write-recursive-factorial-function-in-haskell-without-if-then-else-statme/46292361#46292361", "title": "How to write recursive factorial function in haskell without if then else statment", "body": "<p>If/then/else and guards are actually just syntactic sugar for pattern matching.</p>\n\n<pre><code>if b\n  then c\n  else d\n</code></pre>\n\n<p>desugars to</p>\n\n<pre><code>case b of\n  True -&gt; c\n  False -&gt; d\n</code></pre>\n\n<p>Similarly,</p>\n\n<pre><code>f x\n  | b = c\n  | d = e\nf x = g\n</code></pre>\n\n<p>desugars to</p>\n\n<pre><code>f x = case b of\n        True -&gt; c\n        False -&gt; case d of\n          True -&gt; e\n          False = g\n</code></pre>\n\n<p>So you can always use <code>case</code> directly. However, there's a rather simple optimization you can perform by hand. If you see</p>\n\n<pre><code>case x == p of\n  True -&gt; a\n  False -&gt; b\n</code></pre>\n\n<p>where <code>p</code> is made of constructors and literals, you can replace the whole thing with</p>\n\n<pre><code>case x of\n  p -&gt; a\n  _ -&gt; b\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8841, "user_id": 8208215, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QXD4t.png?s=128&g=1", "display_name": "wasmup", "link": "https://stackoverflow.com/users/8208215/wasmup"}, "is_accepted": false, "score": 3, "last_activity_date": 1505799066, "creation_date": 1505799066, "answer_id": 46292506, "question_id": 46291232, "link": "https://stackoverflow.com/questions/46291232/how-to-write-recursive-factorial-function-in-haskell-without-if-then-else-statme/46292506#46292506", "title": "How to write recursive factorial function in haskell without if then else statment", "body": "<p>try this:</p>\n\n<pre><code>factorial 0 = 1\nfactorial n = n * factorial (n - 1)\n</code></pre>\n\n<hr>\n\n<p>Using tail recursion:</p>\n\n<pre><code>factorial n = f n 1\n\nf 0 acc = acc\nf n acc = f (n-1) (acc*n)\n\nmain = print $ factorial 5\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>120\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8630002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a4f81f0b2096a9d74f0d8007d202eb?s=128&d=identicon&r=PG&f=1", "display_name": "HaskLearner9921", "link": "https://stackoverflow.com/users/8630002/hasklearner9921"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1887, "favorite_count": 0, "accepted_answer_id": 46291979, "answer_count": 3, "score": 1, "last_activity_date": 1505799066, "creation_date": 1505791163, "question_id": 46291232, "link": "https://stackoverflow.com/questions/46291232/how-to-write-recursive-factorial-function-in-haskell-without-if-then-else-statme", "title": "How to write recursive factorial function in haskell without if then else statment", "body": "<pre><code>fac n = if n &lt; 2 then 1 else n * fac (n-1)\n\nmain = do\n\n   putStrLn \"Enter a number: \"  \n   number &lt;- getLine \n   print $ number &gt;&gt;= fac\n</code></pre>\n\n<p>I do not know how to write a recursive factorial function without if statements. Our professor said somethings about lambda calculus.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1505791046, "post_id": 46290887, "comment_id": 79545140, "body": "<code>readLn</code> throws an <code>IO</code> exception if it fails. You can catch it manually, or use the <code>Alternative IO</code> instance: <code>fix $ \\try_again -&gt; readLn &lt;|&gt; (putStrLn &quot;Please try again.&quot; *&gt; try_again)</code>. Alternatively, you can use <code>readMaybe</code> from <code>Text.Read</code>: <code>numberMaybe &lt;- readMaybe; case numberMaybe of {Nothing -&gt; handle the error; Just n -&gt; ....}</code>. To try till you succeed, <code>fix $ \\try_again -&gt; maybe (putStrLn &quot;Please try again.&quot; *&gt; try_again) pure . readMaybe =&lt;&lt; getLine</code>."}], "tags": [], "owner": {"reputation": 335, "user_id": 8387889, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-ytIoDLa0WGg/AAAAAAAAAAI/AAAAAAAAAcg/PoU425sbyWw/photo.jpg?sz=128", "display_name": "Andrew Lei", "link": "https://stackoverflow.com/users/8387889/andrew-lei"}, "is_accepted": true, "score": 1, "last_activity_date": 1505788054, "creation_date": 1505788054, "answer_id": 46290887, "question_id": 46290851, "link": "https://stackoverflow.com/questions/46290851/how-to-print-function-in-haskell/46290887#46290887", "title": "How to print function in haskell", "body": "<p>I don't think you need the (>>=) there. Just </p>\n\n<pre><code>print $ fac number\n</code></pre>\n\n<p>should be enough. However, <code>number</code> needs to be an <code>Int</code> or <code>Integer</code>. So you either need to use <code>read</code>, or, much simpler, instead of using <code>getLine</code>, use <code>readLn</code>, which will do <code>getLine</code> and automatically convert it to an Integral type.</p>\n"}], "owner": {"reputation": 23, "user_id": 8630002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5a4f81f0b2096a9d74f0d8007d202eb?s=128&d=identicon&r=PG&f=1", "display_name": "HaskLearner9921", "link": "https://stackoverflow.com/users/8630002/hasklearner9921"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 46290887, "answer_count": 1, "score": 0, "last_activity_date": 1505788054, "creation_date": 1505787703, "question_id": 46290851, "link": "https://stackoverflow.com/questions/46290851/how-to-print-function-in-haskell", "title": "How to print function in haskell", "body": "<p>Im trying to print the value of a factorial function however it does not work.</p>\n\n<pre><code>fac n = if n &lt; 2 then 1 else n * fac (n-1)\n\nmain = do\n\n    putStrLn \"Enter a number: \"  \n    number &lt;- getLine \n    print $ number &gt;&gt;= fac\n</code></pre>\n"}, {"tags": ["haskell", "ghci", "haskeline"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1505785792, "post_id": 46290504, "comment_id": 79544072, "body": "I&#39;m pretty sure Stack is irrelevant, but you should report the GHC version."}], "answers": [{"comments": [{"owner": {"reputation": 4918, "user_id": 1631106, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42cac823ac4fa7a9c9e91599a0ff528f?s=128&d=identicon&r=PG", "display_name": "ivan", "link": "https://stackoverflow.com/users/1631106/ivan"}, "edited": false, "score": 0, "creation_date": 1505873935, "post_id": 46310328, "comment_id": 79586417, "body": "Perfect, thanks! I&#39;m curious why this never impeded Ctrl-Y yank behavior in Bash. I guess when I&#39;m already in the parent shell, it doesn&#39;t make sense to suspend the current job?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 4918, "user_id": 1631106, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42cac823ac4fa7a9c9e91599a0ff528f?s=128&d=identicon&r=PG", "display_name": "ivan", "link": "https://stackoverflow.com/users/1631106/ivan"}, "edited": false, "score": 1, "creation_date": 1505914552, "post_id": 46310328, "comment_id": 79607824, "body": "Well, Bash contains specific code to prevent Ctrl-Y (or Ctrl-Z) from having an effect at the shell prompt itself.  If it didn&#39;t do this, Bash would suspend like any other process (and would probably just freeze up in the absence of a parent process prepared to handle it)."}, {"owner": {"reputation": 4918, "user_id": 1631106, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42cac823ac4fa7a9c9e91599a0ff528f?s=128&d=identicon&r=PG", "display_name": "ivan", "link": "https://stackoverflow.com/users/1631106/ivan"}, "edited": false, "score": 0, "creation_date": 1505936176, "post_id": 46310328, "comment_id": 79621664, "body": "Makes perfect sense. Thanks for clarifying."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 7, "last_activity_date": 1506944941, "last_edit_date": 1506944941, "creation_date": 1505858271, "answer_id": 46310328, "question_id": 46290504, "link": "https://stackoverflow.com/questions/46290504/haskell-ghci-treats-ctrl-y-like-ctrl-z/46310328#46310328", "title": "Haskell: GHCi treats Ctrl-Y like Ctrl-Z", "body": "<p>Mac OS terminals/ttys have a concept of a \"dsusp\" or \"delayed suspend\" key, and Ctrl-Y is the usual key assigned.  At the tty level, when a <kbd>CTRL</kbd>+<kbd>Y</kbd> is read, it acts a little like <kbd>CTRL</kbd>+<kbd>Z</kbd>.  The difference is that <kbd>CTRL</kbd>+<kbd>Z</kbd> causes an immediate suspend when it's typed; <kbd>CTRL</kbd>+<kbd>Y</kbd> causes the suspend when the underlying process tries to read characters and the <kbd>CTRL</kbd>+<kbd>Y</kbd> marker pops up in the input stream.</p>\n\n<p>(<kbd>CTRL</kbd>+<kbd>V</kbd> is usually assigned to the \"lnext\" key, which skips terminal processing by making the next key \"literal\", which is why <kbd>CTRL</kbd>+<kbd>V</kbd> <kbd>Ctrl</kbd>+<kbd>Y</kbd> works.)</p>\n\n<p>Ideally, GHCi would check for \"dsusp\" functionality (it doesn't exist on Linux, for example) and disable it if it's detected, but it looks like it's not doing this.</p>\n\n<p>In the meantime, you can disable your \"dsusp\" key by running:</p>\n\n<pre><code>stty dsusp undef\n</code></pre>\n\n<p>before you launch GHCi.  Sticking this in your \".bashrc\" and/or \".profile\" is a good idea, since the functionality is largely useless.</p>\n"}], "owner": {"reputation": 4918, "user_id": 1631106, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/42cac823ac4fa7a9c9e91599a0ff528f?s=128&d=identicon&r=PG", "display_name": "ivan", "link": "https://stackoverflow.com/users/1631106/ivan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 3, "accepted_answer_id": 46310328, "answer_count": 1, "score": 12, "last_activity_date": 1506951364, "creation_date": 1505785192, "last_edit_date": 1506951364, "question_id": 46290504, "link": "https://stackoverflow.com/questions/46290504/haskell-ghci-treats-ctrl-y-like-ctrl-z", "title": "Haskell: GHCi treats Ctrl-Y like Ctrl-Z", "body": "<p>According to the haskeline <a href=\"http://trac.haskell.org/haskeline/wiki/KeyBindings\" rel=\"nofollow noreferrer\">documentation</a>, typing <kbd>CTRL</kbd>+<kbd>Y</kbd> should pop the most recent entry from the kill-ring (e.g. the line I just deleted via <kbd>CTRL</kbd>+<kbd>U</kbd>). I'm finding that instead, it suspends the REPL, as if I'd typed <kbd>CTRL</kbd>+<kbd>Z</kbd>.</p>\n\n<p>As a clumsy workaround, I've found that typing <kbd>CTRL</kbd>+<kbd>V</kbd> <kbd>CTRL</kbd>+<kbd>Y</kbd> pops from the kill ring as a plain <kbd>CTRL</kbd>+<kbd>Y</kbd> is supposed to do.</p>\n\n<p>Is this a know bug, or is something else at play? Can I fix it? I'm running GHC version 8.0.2.</p>\n\n<p>Not sure if it matters, but I'm running GHCi via stack (e.g. <code>stack ghci</code>), and I brew installed stack (macOS).</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 960629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a5886db925c18647d38f0c9dff873bd?s=128&d=identicon&r=PG", "display_name": "quyse", "link": "https://stackoverflow.com/users/960629/quyse"}, "edited": false, "score": 0, "creation_date": 1505810959, "post_id": 46289394, "comment_id": 79554178, "body": "As I noted in the question, I tried non-object version of <code>resolver</code> field and it doesn&#39;t work."}, {"owner": {"reputation": 113, "user_id": 960629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a5886db925c18647d38f0c9dff873bd?s=128&d=identicon&r=PG", "display_name": "quyse", "link": "https://stackoverflow.com/users/960629/quyse"}, "edited": false, "score": 0, "creation_date": 1505811173, "post_id": 46289394, "comment_id": 79554301, "body": "The full output of <code>stack --version</code>: <a href=\"https://gist.github.com/quyse/6d752ee482a9749b58d784416a4ebb78\" rel=\"nofollow noreferrer\">gist.github.com/quyse/6d752ee482a9749b58d784416a4ebb78</a>. I&#39;m not sure how stack is built in Arch packages, I&#39;ll try with stack built from sources (tag v1.5.1)."}, {"owner": {"reputation": 113, "user_id": 960629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a5886db925c18647d38f0c9dff873bd?s=128&d=identicon&r=PG", "display_name": "quyse", "link": "https://stackoverflow.com/users/960629/quyse"}, "edited": false, "score": 0, "creation_date": 1505851453, "post_id": 46289394, "comment_id": 79579752, "body": "Well, I downloaded official Linux_x64 static binary of <code>stack</code>, it reports the same version 1.5.1, and has the very same problem with my <code>stack.yaml</code>."}, {"owner": {"reputation": 113, "user_id": 960629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a5886db925c18647d38f0c9dff873bd?s=128&d=identicon&r=PG", "display_name": "quyse", "link": "https://stackoverflow.com/users/960629/quyse"}, "edited": false, "score": 0, "creation_date": 1505982053, "post_id": 46289394, "comment_id": 79637506, "body": "Ok, you&#39;re right, Arch package <code>stack</code> is built from master, not v1.5.1 tag, see commit in <a href=\"https://git.archlinux.org/svntogit/community.git/tree/trunk/PKGBUILD?h=packages/stack\" rel=\"nofollow noreferrer\">git.archlinux.org/svntogit/community.git/tree/trunk/&hellip;</a> . It&#39;s confusing that it reports the same 1.5.1 version, being different from official binary from haskellstack.org (which still works with previous format of custom snapshots). I guess it&#39;s Arch&#39;s issue than. Thanks for answer!"}, {"owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "reply_to_user": {"reputation": 113, "user_id": 960629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a5886db925c18647d38f0c9dff873bd?s=128&d=identicon&r=PG", "display_name": "quyse", "link": "https://stackoverflow.com/users/960629/quyse"}, "edited": false, "score": 1, "creation_date": 1506376513, "post_id": 46289394, "comment_id": 79787426, "body": "Hmm, looks like they are disabling the git version info from their build as well, shouldn&#39;t do that for a release build...  I&#39;ve opened <a href=\"https://bugs.archlinux.org/task/55748\" rel=\"nofollow noreferrer\">bugs.archlinux.org/task/55748</a> and <a href=\"https://github.com/commercialhaskell/stack/issues/3455\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/3455</a> about this"}], "tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": true, "score": 2, "last_activity_date": 1505778760, "last_edit_date": 1505778760, "creation_date": 1505776096, "answer_id": 46289394, "question_id": 46288963, "link": "https://stackoverflow.com/questions/46288963/custom-snapshots-with-stack-1-5-1/46289394#46289394", "title": "Custom snapshots with stack 1.5.1", "body": "<p>The extensible snapshots stuff has been a bit of an experimental feature, but I think it is stabilizing.  See this blog post on the changes - <a href=\"https://www.fpcomplete.com/blog/2017/07/stacks-new-extensible-snapshots\" rel=\"nofollow noreferrer\">https://www.fpcomplete.com/blog/2017/07/stacks-new-extensible-snapshots</a></p>\n\n<p>EDIT: Actually, the changes in that blogpost have not yet been released.  Is it possible that arch is shipping master version of stack??  That would be interesting.. What does \"stack --version\" say?</p>\n\n<p>While not mentioned explicitly, I think it dropped using an object for the resolver, as the \"name\" field wasn't very useful.  So now it is just </p>\n\n<p><code>\nresolver: deps/flaw/integer-simple-snapshot.yaml\n</code></p>\n\n<p>In the future, we should probably try to require \"require-stack-version: ...\" in configs when they rely on new features.  To make things clearer to users, it may be helpful to add</p>\n\n<p><code>\nrequire-stack-version: \"&gt;= 1.5\"\n</code></p>\n\n<p>to your config</p>\n"}], "owner": {"reputation": 113, "user_id": 960629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a5886db925c18647d38f0c9dff873bd?s=128&d=identicon&r=PG", "display_name": "quyse", "link": "https://stackoverflow.com/users/960629/quyse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 46289394, "answer_count": 1, "score": 1, "last_activity_date": 1505778760, "creation_date": 1505773136, "question_id": 46288963, "link": "https://stackoverflow.com/questions/46288963/custom-snapshots-with-stack-1-5-1", "title": "Custom snapshots with stack 1.5.1", "body": "<p>I upgraded to <code>stack-1.5.1</code> from <code>stack-1.4.0</code>, and suddenly it started to refuse my <code>stack.yaml</code> with custom snapshot. Here's the beginning of the <code>stack.yaml</code>:</p>\n\n<pre><code>resolver:\n  name: integer-simple-snapshot\n  location: deps/flaw/integer-simple-snapshot.yaml\n\n...\n</code></pre>\n\n<p>So it uses custom snapshot file located in the subdirectory, which contains the following resolver:</p>\n\n<pre><code>resolver: lts-9.0\n</code></pre>\n\n<p>Now stack prints the following when I try to build anything:</p>\n\n<pre><code>Could not parse '&lt;path to project&gt;/stack.yaml':\nAeson exception:\nError in $.resolver: failed to parse field 'resolver': expected ResolverWith (), encountered Object\nSee http://docs.haskellstack.org/en/stable/yaml_configuration/\n</code></pre>\n\n<p>I tried to use non-object resolver, like <code>resolver: \"deps/flaw/integer-simple-snapshot.yaml\"</code> and other object and non-object variants, but all I can get is various cryptic errors about wrong formats.</p>\n\n<p>I don't see anything changed about resolver's format at <a href=\"http://docs.haskellstack.org/en/stable/yaml_configuration/\" rel=\"nofollow noreferrer\">http://docs.haskellstack.org/en/stable/yaml_configuration/</a>, and the page <a href=\"https://docs.haskellstack.org/en/stable/custom_snapshot/\" rel=\"nofollow noreferrer\">https://docs.haskellstack.org/en/stable/custom_snapshot/</a> still contains an example with custom snapshot. I also looked through a changelog and did not find anything related to snapshots or resolver format.</p>\n\n<p>The project was perfectly buildable with these files before stack upgrade. What has changed? How can I use custom snapshot now?</p>\n\n<p>I use Arch Linux and stack-1.5.1 from standard <code>stack</code> package if that matters.</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1505769649, "post_id": 46288355, "comment_id": 79539908, "body": "Your type signature is wrong. <code>==</code> requires its operands to have the same type, but you have <code>a :: a</code> and <code>x :: b</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1505770486, "post_id": 46288355, "comment_id": 79540232, "body": "And not just any type; <code>a</code> needs to be an instance of the <code>Eq</code> type class: <code>isElement :: Eq a =&gt; a -&gt; [a] -&gt; Bool</code>."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1505782857, "post_id": 46288355, "comment_id": 79543360, "body": "You should always be suspicious when working with <code>True</code> or <code>False</code> near an <code>if</code>. Usually that means the logic could be expressed more directly without an <code>if</code>.  In this case, that&#39;s true. You could write the body of the second equation as <code>(a == x) || isElement a xs</code>."}, {"owner": {"reputation": 1698, "user_id": 4050510, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3123195051caa2f71674df0798284b0?s=128&d=identicon&r=PG", "display_name": "LudvigH", "link": "https://stackoverflow.com/users/4050510/ludvigh"}, "edited": false, "score": 0, "creation_date": 1505817305, "post_id": 46288355, "comment_id": 79558450, "body": "I guess this question is for the sake of learning, but otherwise <code>elem</code> is a good function to know of."}], "answers": [{"tags": [], "owner": {"reputation": 990, "user_id": 2936186, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EOPOx.jpg?s=128&g=1", "display_name": "H&#233;cate", "link": "https://stackoverflow.com/users/2936186/h%c3%a9cate"}, "is_accepted": true, "score": 5, "last_activity_date": 1505770641, "last_edit_date": 1505770641, "creation_date": 1505770486, "answer_id": 46288541, "question_id": 46288355, "link": "https://stackoverflow.com/questions/46288355/determine-if-value-is-an-element-of-a-list-in-haskell/46288541#46288541", "title": "Determine if value is an element of a list in Haskell", "body": "<p>You code technically works. It's the type signature that's giving you trouble here.</p>\n\n<p>First, here's the working code:</p>\n\n<pre><code>isElement :: (Eq a) =&gt; a -&gt; [a] -&gt; Bool\nisElement a [] = False\nisElement a (x:xs) = if a == x then True\n                     else isElement a xs\n</code></pre>\n\n<p>I changed two things:</p>\n\n<ol>\n<li>The first thing to keep in mind when working with Haskell's linked lists (the datatype that uses <code>[]</code>) is that they can only contain elements of the same type. However in your type signature, <code>a \u279e [b]</code> you specify that you require your first element to be of type <code>a</code> and the ones in your list of type <code>b</code>, different from <code>a</code>.</li>\n<li><p>The second thing is to \"enable\" equality checks with generic types <code>a</code> and <code>b</code>, and GHC will give you a warning with the steps to follow in order to fix that:</p>\n\n<pre><code>\u2022 No instance for (Eq a) arising from a use of \u2018=='\n  Possible fix:\n    add (Eq a) to the context of\n      the type signature for:\n        isElement :: a -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>So what it tells us is to specify that the <code>a</code> type can be compared!<br>\nAnd this is fantastic because we can totally do this by giving that clue to the compiler with the <code>(Eq a) =&gt;</code> part in our code, that roughly translates to \"given this property (Eq) of datatype <code>a</code>, [insert type signature here]\". (feel free to correct me here, people of StackOverflow!)</p></li>\n</ol>\n\n<p>Your code works, and reimplementing functions with this kind of explicit recursion is how I learned how it worked in the first place, so don't hesitate to learn by rewriting the stuff you use, then check their sources on Hackage to see how real-world haskellers actually do it.</p>\n\n<p>Have fun learning! </p>\n"}], "owner": {"reputation": 299, "user_id": 8604329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34e9794ad93744d1fcf341dfb763b345?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Robbins", "link": "https://stackoverflow.com/users/8604329/matt-robbins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1952, "favorite_count": 0, "accepted_answer_id": 46288541, "answer_count": 1, "score": 2, "last_activity_date": 1505770641, "creation_date": 1505769447, "question_id": 46288355, "link": "https://stackoverflow.com/questions/46288355/determine-if-value-is-an-element-of-a-list-in-haskell", "title": "Determine if value is an element of a list in Haskell", "body": "<p>I'm trying to write a function that will determine if an element exists in a list, both of which being provided by the user. I think a recursive solution is best. This is what I have:</p>\n\n<pre><code>isElement :: a -&gt; [b] -&gt; Bool\nisElement a [] = False\nisElement a (x:xs) = if a == x then True\n                     else isElement a xs\n</code></pre>\n\n<p>But it can't compile. The error is \"Couldn't match expected type -a' with actual type -b'\".  I don't know what this means or how to fix the problem.</p>\n"}, {"tags": ["c", "haskell"], "comments": [{"owner": {"reputation": 880, "user_id": 3661738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acddd9c3372908d0903c4611aea1a9b7?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/3661738/tyler"}, "edited": false, "score": 0, "creation_date": 1505768256, "post_id": 46288049, "comment_id": 79539307, "body": "Try a switch on y and case &#39;+&#39; do addition and case &#39;*&#39; do multiplication"}, {"owner": {"reputation": 18942, "user_id": 894328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3db17c5296335f63e856be44aa821bf6?s=128&d=identicon&r=PG", "display_name": "Ahmed Masud", "link": "https://stackoverflow.com/users/894328/ahmed-masud"}, "edited": false, "score": 0, "creation_date": 1505770055, "post_id": 46288049, "comment_id": 79540064, "body": "Do you mean to say you want to call it as : <code>foldr(v, 0, &#39;+&#39;)</code> and it would work?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1505770500, "post_id": 46288049, "comment_id": 79540240, "body": "Wow, there&#39;s a lot wrong with this. <code>*v == (int) NULL</code> is almost certainly not what you want. No idea what <code>temp y ((*f)(++v))</code> is supposed to mean. Why is there an <code>int (*)(int*)</code> argument to <code>foldr</code>? Presumably this is supposed to be the function to fold, but doesn&#39;t appear to be a function that takes a list element and an accumulator as is usually the case for <code>foldr</code>. And if <code>f</code> is the function to fold, what is the <code>char y</code> argument supposed to be? In its current state, this appears to me to be just &quot;unclear what you&#39;re asking&quot;."}, {"owner": {"reputation": 31, "user_id": 2672835, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000959682307/picture?type=large", "display_name": "Silas Poulson", "link": "https://stackoverflow.com/users/2672835/silas-poulson"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1505772824, "post_id": 46288049, "comment_id": 79540945, "body": "Sorry @Daniel, I thought I&#39;d made y clear with the snippet of sum as trying to make this foldr to be as generic as possible. int (<i>)(int</i>) comes from the way I was using Null terminated arrays and recursion to build the function. You&#39;re right though I do need to think this through again. Thank you"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1505810024, "post_id": 46288049, "comment_id": 79553608, "body": "You can treat <code>int *</code> as a 0-terminated or (-1)-terminated array-ish, but that would mean that 0 (or -1) can&#39;t be valid data. Consider passing both a pointer and the array length, instead. <code>f</code> should be binary, as it is in <code>foldr</code>. Or, even better, make it ternary, taking an additional <code>void *</code> pointer to emulate closures, mimicking what some C libraries do for callbacks (see e.g. GTK)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1505819696, "post_id": 46288049, "comment_id": 79560105, "body": "(+) and (*) in Haskell are <i>functions</i>, not characters."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2672835, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000959682307/picture?type=large", "display_name": "Silas Poulson", "link": "https://stackoverflow.com/users/2672835/silas-poulson"}, "edited": false, "score": 0, "creation_date": 1505851193, "post_id": 46296013, "comment_id": 79579619, "body": "Thanks for this, it really showed me that I was trying to force C to work like Haskell rather than transposing Haskell code to C as you&#39;ve done."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 31, "user_id": 2672835, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000959682307/picture?type=large", "display_name": "Silas Poulson", "link": "https://stackoverflow.com/users/2672835/silas-poulson"}, "edited": false, "score": 0, "creation_date": 1505904226, "post_id": 46296013, "comment_id": 79600574, "body": "@SilasPoulson Keep in mind that transposing code like this from one language to another does not produce idiomatic code. It can still be interesting. The above approach is not something one would use in everyday C."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1505819274, "last_edit_date": 1505819274, "creation_date": 1505811254, "answer_id": 46296013, "question_id": 46288049, "link": "https://stackoverflow.com/questions/46288049/haskell-foldr-c-implementation/46296013#46296013", "title": "Haskell Foldr C implementation", "body": "<p>I'll show a recursion-based approach. As an exercise, you could turn it into an iterative solution, if you wish.</p>\n\n<p>(Warning: untested)</p>\n\n<p>Haskell:</p>\n\n<pre><code>foldr :: (Int-&gt;Int-&gt;Int) -&gt; Int -&gt; [Int] -&gt; Int\nfoldr f x []     = x                    -- base case\nfoldr f x (v:vs) = f v (foldr f x vs)   -- recursion\n</code></pre>\n\n<p>C:</p>\n\n<pre><code>int foldr(int (*f)(int,int),\n          int x,\n          int *v, size_t length) {\n    // base case\n    if (length == 0) return x;\n    // recursion\n    return f(*v, foldr(f, x, v+1, length-1));\n}\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>int add(int a, int b) {\n   return a+b;\n}\nint main() {\n   int a[] = {1,2,3} ;\n   int res = foldr(add, 0, a, sizeof a/sizeof *a);\n   printf(\"%d\\n\", res);\n   return 0;\n}\n</code></pre>\n\n<p>If you pass a proper function pointer (like <code>add</code>) above, there is not need to pass the character operator <code>'+'</code>.</p>\n\n<hr>\n\n<p>Note that functional programming languages also allow to build closures, as in:</p>\n\n<pre><code>let y = 5\nin foldr (\\x c -&gt; x*y+c) 0 [1..3]\n</code></pre>\n\n<p>Note how the function <code>\\x c -&gt; x*y+c</code> also depends on the value of <code>y</code>. C does not allow to do craft closures, but you can emulate the captured <code>y</code>, if you allow an addition <code>void *</code> argument to the C function.</p>\n\n<pre><code>int foldr(int (*f)(void *, int, int),\n          void *data,\n          int x,\n          int *v, size_t length) {\n    // base case\n    if (length == 0) return x;\n    // recursion\n    return f(data, *v, foldr(f, data, x, v+1, length-1));\n}\n</code></pre>\n\n<p>Test:</p>\n\n<pre><code>int g(void *data, int x, int c) {\n   int y = *(int *)data;\n   return x*y+c;\n}\nint main() {\n   int a[] = {1,2,3} ;\n   int y = 5;\n   int res = foldr(g, &amp;y, 0, a, sizeof a/sizeof *a);\n   printf(\"%d\\n\", res);\n   return 0;\n}\n</code></pre>\n\n<p>In this way you can reuse <code>g</code> with different values of <code>y</code>. If you need to capture more variables, pass a pointer to a suitable <code>struct</code> containing all such variables.</p>\n"}], "owner": {"reputation": 31, "user_id": 2672835, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000959682307/picture?type=large", "display_name": "Silas Poulson", "link": "https://stackoverflow.com/users/2672835/silas-poulson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 581, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505819274, "creation_date": 1505768048, "question_id": 46288049, "link": "https://stackoverflow.com/questions/46288049/haskell-foldr-c-implementation", "title": "Haskell Foldr C implementation", "body": "<p>I'm trying to implement a version of Haskell's foldr function in C but have hit a wall making it generic as I want to make the + or * characters (char y in foldr) work as addition or multiplication. I was thinking of trying a macro but wasn't sure what would work.</p>\n\n<p>Here the code:</p>\n\n<pre><code>int\nfoldr(int *v, int (*f)(int*), int x, char y)\n{\n    int temp;\n    if(*v == (int) NULL) //v is null terminated int array\n        return x;\n    else{\n        temp = *v;\n        return temp y ((*f)(++v));\n    }\n}\n</code></pre>\n\n<p>Main issue is making char y work so I can say:</p>\n\n<pre><code>int\nsum(int *v)\n{\n    return foldr(v, (sum), 0, '+');\n}\n</code></pre>\n\n<p>and it would just work.\nThanks</p>\n"}, {"tags": ["algorithm", "sorting", "haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1505768334, "post_id": 46287718, "comment_id": 79539344, "body": "&quot;I would like to know a better way&quot; - what&#39;s wrong with your way? What element of your code are you looking to improve and how?"}, {"owner": {"reputation": 1247, "user_id": 3169543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7416c0dca5630ff1c31b955e185e955b?s=128&d=identicon&r=PG&f=1", "display_name": "user3169543", "link": "https://stackoverflow.com/users/3169543/user3169543"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1505768624, "post_id": 46287718, "comment_id": 79539496, "body": "@user2407038: This solution looks &quot;imperative&quot;. Was hoping there is a better way which uses Haskell Features (lazy eval etc) and with a Richard Bird elegance. [Pearls of Functional Algorithm Design]"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1505769076, "post_id": 46287718, "comment_id": 79539698, "body": "It looks imperative because you interleaving printing with logic. Write a function <code>ksort :: Ord a =&gt; [a] -&gt; Int -&gt; [a]</code> which sorts an &#39;almost&#39; sorted array; then <code>ksorted xs k = print $ ksort xs k</code>. If the heap approach to sorting is itself too imperative for you, you should adapt your preferred sorting algorithm to an &#39;almost&#39; sorted list (for e.g. insertion sort, this is very easy, since it is already based on swapping elements)."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1505863253, "post_id": 46288756, "comment_id": 79583910, "body": "I&#39;d force the heap in the recursive case. Otherwise, consuming the list lazily and ignoring many of its elements could be bad."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1505772281, "last_edit_date": 1505772281, "creation_date": 1505771749, "answer_id": 46288756, "question_id": 46287718, "link": "https://stackoverflow.com/questions/46287718/haskell-sort-an-almost-sorted-array/46288756#46288756", "title": "Haskell: Sort an almost-sorted array", "body": "<p>I think the main improvement is to separate the production of the sorted list from the printing of the sorted list. So:</p>\n\n<pre><code>import Data.Heap (MinHeap)\nimport qualified Data.Heap as Heap\n\nksort :: Ord a =&gt; Int -&gt; [a] -&gt; [a]\nksort k xs = go (Heap.fromList b) e where\n    (b, e) = splitAt (k-1) xs\n\n    go :: Ord a =&gt; MinHeap a -&gt; [a] -&gt; [a]\n    go heap [] = Heap.toAscList heap\n    go heap (x:xs) = x' : go heap' xs where\n        Just (x', heap') = Heap.view (Heap.insert x heap)\n\nprintKSorted :: (Ord a, Show a) =&gt; Int -&gt; [a] -&gt; IO ()\nprintKSorted k xs = mapM_ print (ksort k xs)\n</code></pre>\n\n<p>If I were feeling extra-special-fancy, I might try to turn <code>go</code> into a <code>foldr</code> or perhaps a <code>mapAccumR</code>, but in this case I think the explicit recursion is relatively readable, too.</p>\n"}], "owner": {"reputation": 1247, "user_id": 3169543, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7416c0dca5630ff1c31b955e185e955b?s=128&d=identicon&r=PG&f=1", "display_name": "user3169543", "link": "https://stackoverflow.com/users/3169543/user3169543"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 1, "accepted_answer_id": 46288756, "answer_count": 1, "score": 0, "last_activity_date": 1505772281, "creation_date": 1505766588, "last_edit_date": 1505767140, "question_id": 46287718, "link": "https://stackoverflow.com/questions/46287718/haskell-sort-an-almost-sorted-array", "title": "Haskell: Sort an almost-sorted array", "body": "<p>I've been learning Haskell in my spare time working through <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">LYAH</a>. Would like to improve upon my Haskell (/ Functional programming) skills by solving some problems from the imperative world. One of the problems from <a href=\"http://elementsofprogramminginterviews.com/\" rel=\"nofollow noreferrer\">EPI</a> is to print an \"<a href=\"http://elementsofprogramminginterviews.com/solutions/python/approximate_sort.py\" rel=\"nofollow noreferrer\">almost sorted array</a>\", in a sorted fashion where it is guaranteed that no element in the array is more than <code>k</code> away from its correct position. The input is a stream of elements and the requirement is to do this in <code>O(n log k)</code> time complexity and <code>O(k)</code> space complexity.</p>\n\n<p>I've attempted to re-implement the imperative solution in Haskell as follows:</p>\n\n<pre><code>import qualified Data.Heap as Heap\n\n    -- print the k-sorted list in a sorted fashion\nksorted :: (Ord a, Show a) =&gt; [a] -&gt; Int -&gt; IO ()\nksorted [] _ = return ()\nksorted xs k = do \n    heap &lt;- ksorted' xs Heap.empty\n    mapM_ print $ (Heap.toAscList heap) -- print the remaining elements in the heap.\n    where \n        ksorted' :: (Ord a, Show a) =&gt; [a] -&gt; Heap.MinHeap a -&gt; IO (Heap.MinHeap a)\n        ksorted' [] h = return h\n        ksorted' (x:xs) h = do let (m, h') = getMinAndBuildHeap h x in\n                                (printMin m &gt;&gt; ksorted' xs h')\n\n        printMin :: (Show a) =&gt; Maybe a -&gt; IO ()\n        printMin m = case m of \n                        Nothing     -&gt; return ()\n                        (Just item) -&gt; print item\n\n        getMinAndBuildHeap :: (Ord a, Show a) =&gt; Heap.MinHeap a -&gt; a -&gt; (Maybe a, Heap.MinHeap a)\n        getMinAndBuildHeap h item= if (Heap.size h) &gt; k \n                                   then ((Heap.viewHead h), (Heap.insert item (Heap.drop 1 h)))\n                                   else (Nothing, (Heap.insert item h))\n</code></pre>\n\n<p>I would like to know a better way of solving this in Haskell. Any inputs would be appreciated.</p>\n\n<p>[Edit 1]: The input is stream, but for now I assumed a list instead (with only a forward iterator/ input iterator in some sense.)</p>\n\n<p>[Edit 2]: added <code>Data.Heap</code> import to the code.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "complex-numbers"], "comments": [{"owner": {"reputation": 1698, "user_id": 4050510, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3123195051caa2f71674df0798284b0?s=128&d=identicon&r=PG", "display_name": "LudvigH", "link": "https://stackoverflow.com/users/4050510/ludvigh"}, "edited": false, "score": 5, "creation_date": 1505768305, "post_id": 46287637, "comment_id": 79539327, "body": "Choosing what root to take when dealing with complex number is not a trivial matter. You probably get the principal root.  Check Wikipedia to understand the matter better. They have an example with (-8)^(1/3) actually. <a href=\"https://en.m.wikipedia.org/wiki/Nth_root\" rel=\"nofollow noreferrer\">en.m.wikipedia.org/wiki/Nth_root</a>"}, {"owner": {"reputation": 1698, "user_id": 4050510, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3123195051caa2f71674df0798284b0?s=128&d=identicon&r=PG", "display_name": "LudvigH", "link": "https://stackoverflow.com/users/4050510/ludvigh"}, "edited": false, "score": 0, "creation_date": 1505768759, "post_id": 46287637, "comment_id": 79539564, "body": "...but the quick solution to your problem is to write a wrapper around the normal library for positive numbers, and checking that you are taking an odd root of the negative number"}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 7, "last_activity_date": 1505784861, "last_edit_date": 1505784861, "creation_date": 1505780658, "answer_id": 46289982, "question_id": 46287637, "link": "https://stackoverflow.com/questions/46287637/data-complex-package-gives-strange-result-for-cube-root-of-8-0i-80/46289982#46289982", "title": "Data.Complex package gives strange result for cube root of -8 + 0i ((-8):+0)", "body": "<p>Well, the answer you got <em>is</em> a cube root of -8, as you can see by cubing it:</p>\n\n<pre><code>&gt; let x = ((-8):+0)**(1/3)\n&gt; x\n1.0 :+ 1.732050807568877\n&gt; x^3\n(-7.9999999999999964) :+ 2.220446049250313e-15\n&gt; x*x*x\n(-7.9999999999999964) :+ 2.220446049250313e-15\n&gt; \n</code></pre>\n\n<p>It just wasn't the cube root you were looking for.</p>\n\n<p>In fact, there are three cube roots of -8.  You can calculate them by calculating the three cube roots of one:</p>\n\n<pre><code>&gt; let j = (-1/2):+sqrt(3)/2   -- a cube root of 1\n&gt; let units = [1,j,j*j]       -- that can generate them all\n</code></pre>\n\n<p>and multiplying them by the value above:</p>\n\n<pre><code>&gt; map (*x) units  -- the cube roots of -8\n[1.0 :+ 1.732050807568877,\n (-1.9999999999999996) :+ 1.1102230246251565e-16,\n 0.9999999999999997 :+ (-1.7320508075688767)]\n&gt; map (^3) $ map (*x) units  -- prove they cube to -8\n[(-7.9999999999999964) :+ 2.220446049250313e-15,\n (-7.999999999999995) :+ 1.3322676295501873e-15,\n (-7.999999999999992) :+ 8.881784197001252e-16]\n&gt;\n</code></pre>\n\n<p>As you've determined, the cube root produced by <code>((-8):+0)**(1/3)</code> is the particular cube root of -8 calculated by:</p>\n\n<pre><code>&gt; exp(log((-8):+0)*(1/3))\n1.0 :+ 1.732050807568877\n&gt; \n</code></pre>\n\n<p>It may be worth noting that (1) the definitions of <code>exp</code> and <code>log</code> in <code>Data.Complex</code>, while they may look strange, are the standard mathematical definitions of these functions for complex numbers; and (2) the definition of <code>x ** y</code> as <code>exp(log(x)*y)</code> for complex numbers makes perfect sense mathematically and ensures that <code>x ** y</code> has all the properties you should expect, including the property that cubing <code>((-8):+0)**(1/3)</code> should give you -8.</p>\n\n<p>As for the definition of <code>magnitude</code> (used in the definition of <code>log</code>), your simpler definition would work too:</p>\n\n<pre><code>&gt; magnitude (-8)\n8.0\n&gt; sqrt (realPart (-8) ^ 2 + imagPart (-8) ^ 2)\n8.0\n&gt;\n</code></pre>\n\n<p>However, the definition of <code>magnitude</code> in <code>Data.Complex</code> has been chosen to provide correct answers in cases where the numbers involved are very large:</p>\n\n<pre><code>&gt; magnitude 1e300\n1.0e300\n&gt; sqrt (realPart 1e300 ^ 2 + imagPart 1e300 ^ 2)\nInfinity\n&gt; \n</code></pre>\n"}], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 46289982, "answer_count": 1, "score": -3, "last_activity_date": 1505784861, "creation_date": 1505766235, "question_id": 46287637, "link": "https://stackoverflow.com/questions/46287637/data-complex-package-gives-strange-result-for-cube-root-of-8-0i-80", "title": "Data.Complex package gives strange result for cube root of -8 + 0i ((-8):+0)", "body": "<p>I have to say, math is not my strong suit. I was hoping to get a decent result for <a href=\"https://stackoverflow.com/q/46264929/4543207\">How to find the cube root of a negative integer such that it does not return NaN?</a> by using the <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Complex.html\" rel=\"nofollow noreferrer\">Data.Complex</a> package but when i do like</p>\n\n<pre><code>*Main&gt; ((-8):+0) ** (1/3)\n1.0 :+ 1.732050807568877\n</code></pre>\n\n<p>I expected to get something like <code>(-2.0):+0</code> where -2 is the real part and 0 is the imaginary part. However the result turns out with a significant imaginary part. I have checked the <code>(**)</code> <code>RealFloat</code> instance of the <code>Complex</code> type where it states;</p>\n\n<pre><code>x ** y = case (x,y) of\n  (_ , (0:+0))  -&gt; 1 :+ 0\n  ((0:+0), (exp_re:+_)) -&gt; case compare exp_re 0 of\n             GT -&gt; 0 :+ 0\n             LT -&gt; inf :+ 0\n             EQ -&gt; nan :+ nan\n  ((re:+im), (exp_re:+_))\n    | (isInfinite re || isInfinite im) -&gt; case compare exp_re 0 of\n             GT -&gt; inf :+ 0\n             LT -&gt; 0 :+ 0\n             EQ -&gt; nan :+ nan\n    | otherwise -&gt; exp (log x * y)\n  where\n    inf = 1/0\n    nan = 0/0\n</code></pre>\n\n<p>So we must be normally looking at the <code>exp (log x * y)</code> part where <code>exp</code> and <code>log</code> instances of <code>Complex</code> looks like;</p>\n\n<pre><code>exp (x:+y)     =  expx * cos y :+ expx * sin y\n                  where expx = exp x\nlog z          =  log (magnitude z) :+ phase z\n</code></pre>\n\n<p>then i moved on to the <code>magnitude</code> which is defined like;</p>\n\n<pre><code>magnitude :: (RealFloat a) =&gt; Complex a -&gt; a\nmagnitude (x:+y) =  scaleFloat k\n                     (sqrt (sqr (scaleFloat mk x) + sqr (scaleFloat mk y)))\n                    where k  = max (exponent x) (exponent y)\n                          mk = - k\n                          sqr z = z * z\n</code></pre>\n\n<p>where i am stuck. I would just simply do like <code>sqrt (realPart z ^ 2 + imagPart z ^ 2)</code>.</p>\n\n<p>What am i doing wrong..?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1505751349, "post_id": 46283830, "comment_id": 79530820, "body": "You just need parens around <code>n+1</code>. As it is, it&#39;s parsed as <code>(positioneven n) + (1 xs)</code> which is clearly not what you intended."}, {"owner": {"reputation": 103, "user_id": 8004182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nxpOa.jpg?s=128&g=1", "display_name": "Mostafa_M", "link": "https://stackoverflow.com/users/8004182/mostafa-m"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1505752139, "post_id": 46283830, "comment_id": 79531292, "body": "Ouh yes ! Thank you, I got it.                                                                  position :: Int -&gt; [a] -&gt; [a] position n [] = [] position n (x:xs) = if even n then x: (position (n+1) xs) else position (n+1) xs"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 8004182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nxpOa.jpg?s=128&g=1", "display_name": "Mostafa_M", "link": "https://stackoverflow.com/users/8004182/mostafa-m"}, "edited": false, "score": 0, "creation_date": 1505752215, "post_id": 46283912, "comment_id": 79531335, "body": "Hey Willem, Thank you !"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1505752361, "post_id": 46283912, "comment_id": 79531417, "body": "You have a number of calls here to <code>evens</code>, which doesn&#39;t exist. Looks like you did a partial rename."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1505755683, "last_edit_date": 1505755683, "creation_date": 1505751194, "answer_id": 46283912, "question_id": 46283830, "link": "https://stackoverflow.com/questions/46283830/how-to-extract-the-elements-of-a-haskell-list-which-are-on-the-even-position/46283912#46283912", "title": "How to extract the elements of a Haskell list which are on the even position", "body": "<p>We can construct a function <code>even_elem :: [a] -&gt; [a]</code> that has as basecase of course an empty list:</p>\n\n<pre><code>even_elem [] = []\n</code></pre>\n\n<p>furthermore if we pass it a list with one element, we return the list with that element:</p>\n\n<pre><code>even_elem [x] = [x]\n</code></pre>\n\n<p>finally in case we have a list with two elements or more <code>(x1:x2:t)</code>, we emit the first element <code>x1</code> and perform recursion on the tail <code>t</code>:</p>\n\n<pre><code>even_elem (x1:_:t) = x1 : even_elem t\n</code></pre>\n\n<p>or putting it together:</p>\n\n<pre><code>even_elem :: [a] -&gt; [a]\neven_elem [] = []\neven_elem [x] = [x]\neven_elem (x1:_:t) = x1 : even_elem t\n</code></pre>\n\n<p>We can simplify this, if we make the assumption that the definition of <code>[]</code> will never change, by reordering the patterns:</p>\n\n<pre><code>even_elem :: [a] -&gt; [a]\neven_elem (x1:_:t) = x1 : even_elem t\neven_elem l = l\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 12, "last_activity_date": 1505762945, "last_edit_date": 1505762945, "creation_date": 1505752114, "answer_id": 46284138, "question_id": 46283830, "link": "https://stackoverflow.com/questions/46283830/how-to-extract-the-elements-of-a-haskell-list-which-are-on-the-even-position/46284138#46284138", "title": "How to extract the elements of a Haskell list which are on the even position", "body": "<p>Two useful functions for the price of one:</p>\n\n<pre><code>evens (x:xs) = x:odds xs\nevens _ = []\n\nodds (_:xs) = evens xs\nodds _ = []\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1505773664, "post_id": 46288990, "comment_id": 79541171, "body": "or a list comprehension <code>evens xs = [ x | (n,x) &lt;- zip [0..] xs, even n ]</code>"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1505826055, "post_id": 46288990, "comment_id": 79564602, "body": "or using a <code>cycle</code>: <code>evens = catMaybes . zipWith ($) (cycle [Just, const Nothing])</code>"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1505831214, "post_id": 46288990, "comment_id": 79568436, "body": "or with <code>ZipList</code> type <code>evens = concat . getZipList . (ZipList (cycle [return, const []]) &lt;*&gt;) . ZipList</code>"}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1505773294, "creation_date": 1505773294, "answer_id": 46288990, "question_id": 46283830, "link": "https://stackoverflow.com/questions/46283830/how-to-extract-the-elements-of-a-haskell-list-which-are-on-the-even-position/46288990#46288990", "title": "How to extract the elements of a Haskell list which are on the even position", "body": "<p>You may also use a <code>foldr</code> with <code>zip</code> like;</p>\n\n<pre><code>evens :: [a] -&gt; [a]    \nevens = foldr (\\t r -&gt; if fst t `mod` 2 == 0 then snd t : r else r) [] . (zip [0..])\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 8004182, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nxpOa.jpg?s=128&g=1", "display_name": "Mostafa_M", "link": "https://stackoverflow.com/users/8004182/mostafa-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 624, "favorite_count": 0, "accepted_answer_id": 46284138, "answer_count": 3, "score": 4, "last_activity_date": 1505773294, "creation_date": 1505750916, "last_edit_date": 1505751545, "question_id": 46283830, "link": "https://stackoverflow.com/questions/46283830/how-to-extract-the-elements-of-a-haskell-list-which-are-on-the-even-position", "title": "How to extract the elements of a Haskell list which are on the even position", "body": "<p>Hello dear Community, </p>\n\n<p>I want to get all elements which are on a even position in a list. It's for the implementation of a Dart game. </p>\n\n<p>e.g. <code>[((3,20),(1,19),(2,17)),((3,20),(2,12),(2,19))] -&gt; [((3,20),(1,19),(2,17))]</code></p>\n\n<p>So far i have tried:</p>\n\n<pre><code>positioneven n [] = []\npositioneven n (x:xs) = if even n\n                          then (x: positioneven n+1 xs)\n                          else     positioneven n+1 xs\n</code></pre>\n\n<p>But this of course didn't work. I would be very glad if someone can suggest me a better solution. </p>\n\n<p>Thank you ! Nazar </p>\n"}, {"tags": ["haskell", "intellij-idea", "cabal", "quickcheck"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1505747796, "post_id": 46282390, "comment_id": 79528508, "body": "Can you post the output when you install quickcheck?"}, {"owner": {"reputation": 3, "user_id": 6343250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09b6681843ffbd9f44de11d58e7fce66?s=128&d=identicon&r=PG&f=1", "display_name": "hjh006", "link": "https://stackoverflow.com/users/6343250/hjh006"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505748063, "post_id": 46282390, "comment_id": 79528713, "body": "@WillemVanOnsem Resolving dependencies... All the requested packages are already installed: QuickCheck-2.10.0.1 Use --reinstall if you want to reinstall anyway."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1505757408, "post_id": 46282390, "comment_id": 79533975, "body": "Does IntelliJ use a cabal sandbox? Also, if it&#39;s building the binary via cabal then the package might be hidden."}, {"owner": {"reputation": 3, "user_id": 6343250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09b6681843ffbd9f44de11d58e7fce66?s=128&d=identicon&r=PG&f=1", "display_name": "hjh006", "link": "https://stackoverflow.com/users/6343250/hjh006"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1505794753, "post_id": 46282390, "comment_id": 79546055, "body": "@ThomasM.DuBuisson I don&#39;t think I&#39;m using a cabal sandbox, I just followed regular instructions to install Haskell platform and cabal"}, {"owner": {"reputation": 1336, "user_id": 794944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b885541101d504bbd39901d5d7fc1766?s=128&d=identicon&r=PG", "display_name": "Jack Henahan", "link": "https://stackoverflow.com/users/794944/jack-henahan"}, "edited": false, "score": 1, "creation_date": 1505847900, "post_id": 46282390, "comment_id": 79577910, "body": "Do you have QuickCheck listed as a build-dependency in your Cabal file?"}, {"owner": {"reputation": 3, "user_id": 6343250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09b6681843ffbd9f44de11d58e7fce66?s=128&d=identicon&r=PG&f=1", "display_name": "hjh006", "link": "https://stackoverflow.com/users/6343250/hjh006"}, "reply_to_user": {"reputation": 1336, "user_id": 794944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b885541101d504bbd39901d5d7fc1766?s=128&d=identicon&r=PG", "display_name": "Jack Henahan", "link": "https://stackoverflow.com/users/794944/jack-henahan"}, "edited": false, "score": 0, "creation_date": 1506269786, "post_id": 46282390, "comment_id": 79741438, "body": "@JackHenahan Yes I have I can see it and it is installed"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 0, "last_activity_date": 1517002363, "creation_date": 1517002363, "answer_id": 48469858, "question_id": 46282390, "link": "https://stackoverflow.com/questions/46282390/could-not-find-module-test-quickcheck-on-mac/48469858#48469858", "title": "Could not find module \u2018Test.QuickCheck\u2019 on Mac", "body": "<p>I think this is another instance of a nasty bug in the full release of the 8.2.1 Haskell-Platform binaries.</p>\n\n<p>The solution is either to force reinstalls of the broken things, or simply to upgrade to the fixed release. More details were provided here: <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2017-October/127979.html\" rel=\"nofollow noreferrer\">https://mail.haskell.org/pipermail/haskell-cafe/2017-October/127979.html</a></p>\n"}], "owner": {"reputation": 3, "user_id": 6343250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09b6681843ffbd9f44de11d58e7fce66?s=128&d=identicon&r=PG&f=1", "display_name": "hjh006", "link": "https://stackoverflow.com/users/6343250/hjh006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1021, "favorite_count": 0, "accepted_answer_id": 48469858, "answer_count": 1, "score": 0, "last_activity_date": 1517002363, "creation_date": 1505746499, "last_edit_date": 1505746600, "question_id": 46282390, "link": "https://stackoverflow.com/questions/46282390/could-not-find-module-test-quickcheck-on-mac", "title": "Could not find module \u2018Test.QuickCheck\u2019 on Mac", "body": "<p>When I try to test my code, IntelliJ gave me this error. However, I have used cabal install QuickCheck to install.</p>\n\n<pre><code>Testing.hs:3:1: error:\n    Could not find module \u2018Test.QuickCheck\u2019\n    Use -v to see a list of the files searched for.\n  |\n3 | import Test.QuickCheck\n  | ^^^^^^^^^^^^^^^^^^^^^^\nFailed, 0 modules loaded.\n</code></pre>\n"}, {"tags": ["haskell", "lambda", "quickcheck"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user3292534"}, "edited": false, "score": 0, "creation_date": 1505745930, "post_id": 46282163, "comment_id": 79527213, "body": "types is there for QuickCheck"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505745968, "post_id": 46282163, "comment_id": 79527235, "body": "@kaboom: that does not matter: quicktest is nothing special: it creates a Haskell executable as well, so it passes through the compiler as well."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3292534"}, "edited": false, "score": 0, "creation_date": 1505746225, "post_id": 46282163, "comment_id": 79527417, "body": "werid, I was under impression it&#39;s required, based off QuickCheck tutorial. Anyway, thanks!"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1505746276, "post_id": 46282163, "comment_id": 79527441, "body": "@kaboom: can you show where this is written in the tutorial?"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1505746195, "last_edit_date": 1505746195, "creation_date": 1505745873, "answer_id": 46282163, "question_id": 46281826, "link": "https://stackoverflow.com/questions/46281826/function-application-with-lambda-in-haskell/46282163#46282163", "title": "function application with lambda in haskell?", "body": "<h1><code>palindromeTest</code></h1>\n\n<p>Your expression:</p>\n\n<pre><code>(\\verb -&gt; verb ++ reverse verb) verb\n</code></pre>\n\n<p>does not make much sense: an equivalent expression would be:</p>\n\n<pre><code>(\\x -&gt; x ++ reverse x) verb\n</code></pre>\n\n<p>since <code>verb</code> in the lambda expression was locally scoped. But you know what <code>x</code> is: it is <code>verb</code>. So you can replace the expression with:</p>\n\n<pre><code>verb ++ reverse verb\n</code></pre>\n\n<p>Or in full:</p>\n\n<pre><code>palindromeTest verb = isPalindrome <b>(verb ++ reverse verb)</b> == True</code></pre>\n\n<p>We can also eliminate the <code>== True</code>, since <code>\\x -&gt; x == True</code> is equivalent to <code>id</code>:</p>\n\n<pre><code>palindromeTest verb = isPalindrome (verb ++ reverse verb)</code></pre>\n\n<p>Finally the <code>where types = verb::String</code> is useless as well: Haskell is statically typed, types are resolved at compile time. So this statement does not adds anything. You can restrict the type of verb in the type signature of the function:</p>\n\n<pre><code><b>palindromeTest :: String -&gt; Bool</b>\npalindromeTest verb = isPalindrome (verb ++ reverse verb)</code></pre>\n\n<h1><code>isPalindrome</code></h1>\n\n<p>Just like in <code>palindromTest</code> it is useless to write <code>== True</code>, there is no reason to write <code>= True</code>, and <code>= False</code> if this is based on a condition: simply return the condition itself:</p>\n\n<pre><code>-- | this function checks if string or list are a palindrome\nisPalindrome :: (Eq a) =&gt; [a] -&gt; Bool\nisPalindrome x = <b>reverse x == x</b></code></pre>\n\n<p>You can make it more compact by using <code>ap</code>:</p>\n\n<pre><code><b>import Control.Monad(ap)</b>\n\n-- | this function checks if string or list are a palindrome\nisPalindrome :: (Eq a) =&gt; [a] -&gt; Bool\nisPalindrome = <b>ap (==) reverse</b></code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3292534"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 46282163, "answer_count": 1, "score": -2, "last_activity_date": 1505746195, "creation_date": 1505744876, "question_id": 46281826, "link": "https://stackoverflow.com/questions/46281826/function-application-with-lambda-in-haskell", "title": "function application with lambda in haskell?", "body": "<p>Having this code to test:</p>\n\n<pre><code>-- | this function checks if string or list are a palindrome\n    isPalindrome :: (Eq a) =&gt; [a] -&gt; Bool\n    isPalindrome x =\n        if reverse x == x\n            then True\n            else False\n</code></pre>\n\n<p>I managed to write this:</p>\n\n<pre><code>-- | how do I remove ugly parentheses our of here?\npalindromeTest verb = isPalindrome ((\\verb -&gt; verb ++ reverse verb) verb )  == True\n    where types = verb::String\n</code></pre>\n\n<p>Parentheses look disgusting, how do I work them out?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1505738350, "post_id": 46279431, "comment_id": 79521825, "body": "<code>performN n-2 m</code> is <code>(performN n) - (2 m)</code>, not <code>performN (n - 2) m</code>. After fixing that, you&#39;ll probably want to drop the <code>m:</code> bit and change to subtracting one. And though I suppose you&#39;re doing this just as an exercise, it&#39;s <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Monad.html#v:replicateM\" rel=\"nofollow noreferrer\"><code>replicateM</code></a>."}, {"owner": {"reputation": 5434, "user_id": 2605733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ZAzTo.jpg?s=128&g=1", "display_name": "Abdul Fatir", "link": "https://stackoverflow.com/users/2605733/abdul-fatir"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1505738584, "post_id": 46279431, "comment_id": 79521992, "body": "@Ryan Sorry, edited the question."}], "answers": [{"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 4, "last_activity_date": 1505738732, "creation_date": 1505738732, "answer_id": 46279637, "question_id": 46279431, "link": "https://stackoverflow.com/questions/46279431/perform-monadic-computation-n-times/46279637#46279637", "title": "Perform Monadic Computation N times", "body": "<p>Too much stuff. <code>n == 1</code>? <code>n-2</code>? Why? Simpler!</p>\n\n<pre><code>performN :: Monad m =&gt; Int -&gt; m t -&gt; m [t]\nperformN 0 _ = return []\nperformN n m =\n  do x  &lt;- m\n     xs &lt;- performN (n-1) m\n     return $ x:xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5434, "user_id": 2605733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ZAzTo.jpg?s=128&g=1", "display_name": "Abdul Fatir", "link": "https://stackoverflow.com/users/2605733/abdul-fatir"}, "edited": false, "score": 0, "creation_date": 1505738936, "post_id": 46279650, "comment_id": 79522256, "body": "Damn! Can&#39;t believe what I was thinking. :| Thanks! :)"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1505740400, "post_id": 46279650, "comment_id": 79523266, "body": "With applicatives: <code>liftA2 (:) m (performN (n - 1) m)</code>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1505752733, "post_id": 46279650, "comment_id": 79531607, "body": "Equivalently, <code>(:) &lt;$&gt; m &lt;*&gt; performN (n - 1)</code> is kinda nice because you don&#39;t need the explicit parens for grouping when the <code>(&lt;*&gt;)</code> operator can implicitly group. And if you use <code>pure</code> instead of <code>return</code>, you can generalize this to Applicative rather than requiring Monad."}, {"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1505753411, "post_id": 46279650, "comment_id": 79531926, "body": "@amalloy: Sure, but if we\u2019re being practical and <code>Applicative</code>, it\u2019d just be <code>replicateM</code> =) See comment on the question."}], "tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 8, "last_activity_date": 1505738785, "creation_date": 1505738785, "answer_id": 46279650, "question_id": 46279431, "link": "https://stackoverflow.com/questions/46279431/perform-monadic-computation-n-times/46279650#46279650", "title": "Perform Monadic Computation N times", "body": "<p>You've got doing something zero times right.</p>\n\n<pre><code>performN :: Monad m =&gt; Int -&gt; m t -&gt; m [t]\nperformN 0 m = return []\n</code></pre>\n\n<p>And you've got the first part of doing something n times right: do it once.</p>\n\n<pre><code>performN n m = do\n  x1 &lt;- m\n</code></pre>\n\n<p>But then all you have to do is do it n \u2212 1 more times. No strange <code>if</code> stuff.</p>\n\n<pre><code>performN n m = do\n  x1 &lt;- m\n  x2 &lt;- performN (n - 1) m\n  return (x1 : x2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 5, "last_activity_date": 1505752860, "creation_date": 1505752860, "answer_id": 46284333, "question_id": 46279431, "link": "https://stackoverflow.com/questions/46279431/perform-monadic-computation-n-times/46284333#46284333", "title": "Perform Monadic Computation N times", "body": "<p>If you need to use this function, rather than needing to implement it for practice, you should just use <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Control-Monad.html#v:replicateM\" rel=\"noreferrer\">Control.Monad.replicateM</a> instead of reimplementing it yourself.</p>\n"}], "owner": {"reputation": 5434, "user_id": 2605733, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ZAzTo.jpg?s=128&g=1", "display_name": "Abdul Fatir", "link": "https://stackoverflow.com/users/2605733/abdul-fatir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 46279650, "answer_count": 3, "score": 2, "last_activity_date": 1505752860, "creation_date": 1505738122, "last_edit_date": 1505738560, "question_id": 46279431, "link": "https://stackoverflow.com/questions/46279431/perform-monadic-computation-n-times", "title": "Perform Monadic Computation N times", "body": "<p>I'm implementing a function to perform a monadic computation N times. I've written the following code.</p>\n\n<pre><code>performN :: Monad m =&gt; Int -&gt; m t -&gt; m [t]\nperformN 0 m = return []\nperformN n m = \n  do x1&lt;- m\n     x2&lt;- if n == 1 then return [] else (m:performN (n-2) m)\n     return (x1:x2)\n</code></pre>\n\n<p>I get the following error.  </p>\n\n<blockquote>\n  <p>:264:44: error:<br>\n      \u2022 Couldn't match type \u2018m\u2019 with \u2018[]\u2019<br>\n        \u2018m\u2019 is a rigid type variable bound by<br>\n          the type signature for:<br>\n            performN :: forall (m :: * -> *) t. Monad m => Int -> m t -> m [t]<br>\n          at :260:13<br>\n        Expected type: [m t]<br>\n          Actual type: m [t]<br>\n      \u2022 In the second argument of \u2018(:)\u2019, namely \u2018performN (n - 2) m\u2019<br>\n        In the expression: (m : performN (n - 2) m)<br>\n        In a stmt of a 'do' block:<br>\n          x2 &lt;- if n == 1 then return [] else (m : performN (n - 2) m)<br>\n      \u2022 Relevant bindings include<br>\n          m :: m t (bound at :262:12)<br>\n          performN :: Int -> m t -> m [t] (bound at :261:1)  </p>\n</blockquote>\n\n<p>I can't seem to figure out what I am doing wrong and how to fix it.</p>\n"}, {"tags": ["haskell", "influxdb"], "comments": [{"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1505783736, "post_id": 46277322, "comment_id": 79543572, "body": "<code>String</code> comes from <code>Data.Aeson</code>"}, {"owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "reply_to_user": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1505899652, "post_id": 46277322, "comment_id": 79597541, "body": "Ah indeed, thanks ! Now I get an empty result to my query .. but at least it compiles"}], "answers": [{"tags": [], "owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1505913288, "creation_date": 1505913288, "answer_id": 46323079, "question_id": 46277322, "link": "https://stackoverflow.com/questions/46277322/query-influxdb-in-haskell/46323079#46323079", "title": "Query influxdb in Haskell", "body": "<p>I don't know what an \"InfluxDB\" is, but I can read Haskell type signatures, so maybe we can start with something like this:</p>\n\n<pre><code>import Data.Aeson\nimport qualified Data.Aeson.Types as A\nimport qualified Data.Vector as V\n\nnewtype GenericRawQueryResults = GenericRawQueryResults Value\n  deriving Show\n\ninstance FromJSON GenericRawQueryResults where\n  parseJSON = pure . GenericRawQueryResults\n\ninstance ToJSON GenericRawQueryResults where\n  toJSON (GenericRawQueryResults v) = v\n\ninstance QueryResults GenericRawQueryResults where\n  parseResults _ val = pure (V.singleton (GenericRawQueryResults val))\n</code></pre>\n\n<p>Then try your queries.</p>\n\n<p>From what I can guess by reading the library's code, results from an influx DB query arrive at <code>parseResults</code> inside a json object that has a key called <code>\"results\"</code> that points to an array of objects, each of which has a key called <code>\"series\"</code> or a key called <code>\"error\"</code>, and the assumption is that you write a parser to turn each element that's pointed to by <code>\"series\"</code> into whatever type you want to read from the db.</p>\n\n<p>Except that there's even more framework going on there that I'd probably understand if I knew more about what an InfluxDB is and what kind of data it returns.</p>\n\n<p>In any case, this should get you as close to the raw results as the library will let you get. One additional thing you might do is install the <code>aeson-pretty</code> package, remove the <code>deriving Show</code> bit and do:</p>\n\n<pre><code>instance Show GenericRawQueryResults where\n  show g = \"decode \" ++ show (encodePretty g)\n</code></pre>\n\n<p>(Or you can keep the derived <code>Show</code> instance and just apply <code>encodePretty</code> to your query results to display them)</p>\n"}], "owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505913288, "creation_date": 1505731354, "last_edit_date": 1505741282, "question_id": 46277322, "link": "https://stackoverflow.com/questions/46277322/query-influxdb-in-haskell", "title": "Query influxdb in Haskell", "body": "<p>I'm thinking of developing an app to query our influxdb servers, I've looked at the influxdb library doc (<a href=\"https://hackage.haskell.org/package/influxdb-1.2.2/docs/Database-InfluxDB.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/influxdb-1.2.2/docs/Database-InfluxDB.html</a>) but as far as I understand it, you need to pre-define some data structure or you can't query anything.\nI just need to be able to let the user query whatever without having to define some data in the sources first.</p>\n\n<p>I imagine I could define something with a time field and a value field, then use something like \"SELECT active as value FROM mem\" to force it to fit that. I think that would work, but it wouldn't be very practical if I need to query two fields later on.\nAny better solutions I'm not seeing ? I'm still very much a beginner in Haskell, I'd appreciate any tips.</p>\n\n<p>EDIT:</p>\n\n<p>Even that doesn't work, since apparently it's missing the \"String\" constructor in that bit :</p>\n\n<pre><code>:{\ndata Test = Test { time :: UTCTime, value :: T.Text }\ninstance QueryResults Test where\n  parseResults prec = parseResultsWith $ \\_ _ columns fields -&gt; do\n    time &lt;- getField \"time\" columns fields &gt;&gt;= parseUTCTime prec\n    String value &lt;- getField \"value\" columns fields\n    return Test {..}\n:}\n</code></pre>\n\n<p>I copied that from the doc and just changed the fields, not sure where the \"String\" is supposed to be declared.</p>\n"}, {"tags": ["list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1505700578, "post_id": 46270429, "comment_id": 79503861, "body": "What do you expect should be the result of <code>zipThree [1, 2, 3] [4, 5, 6] [\u2018a\u2019, \u2018b\u2019, \u2018c\u2019, &#39;d&#39;]</code>? A list of length 3 or 4? What does your implementation do? Does it make sense?"}, {"owner": {"reputation": 89, "user_id": 7783162, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6e62c4e6b65938a046b006528860b30b?s=128&d=identicon&r=PG&f=1", "display_name": "Vic", "link": "https://stackoverflow.com/users/7783162/vic"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1505706446, "post_id": 46270429, "comment_id": 79505052, "body": "we are assuming that every list is the same length and so not handling the case you mention"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1505707059, "post_id": 46270429, "comment_id": 79505196, "body": "@Vic But you have explicit cases for different-length lists, so you <i>are</i> handling it. The question is: are you handling it the way you intended to? (Sounds like no, if you were not intending to handle it!)"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1505712617, "post_id": 46270429, "comment_id": 79506651, "body": "I get the impression that this is a homework-related question, which is fine, but for other people coming by this question in the future, this function is built-in and called <code>zip3</code>. The general case, when you want to combine <i>n</i> lists, can be addressed with the <code>ZipList</code> applicative functor."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1505762196, "post_id": 46271751, "comment_id": 79536363, "body": "I think it would pay to also give an implementation that stops short on uneven lists, like <code>zipWith3</code> in the standard library does."}, {"owner": {"reputation": 661, "user_id": 7720738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HccZv.png?s=128&g=1", "display_name": "James Burton", "link": "https://stackoverflow.com/users/7720738/james-burton"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1505815486, "post_id": 46271751, "comment_id": 79557239, "body": "@dfeuer Good suggestion, I&#39;ve added the definitions to the answer."}], "tags": [], "owner": {"reputation": 661, "user_id": 7720738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HccZv.png?s=128&g=1", "display_name": "James Burton", "link": "https://stackoverflow.com/users/7720738/james-burton"}, "is_accepted": false, "score": 6, "last_activity_date": 1505822081, "last_edit_date": 1505822081, "creation_date": 1505709908, "answer_id": 46271751, "question_id": 46270429, "link": "https://stackoverflow.com/questions/46270429/combining-three-lists-into-a-list-of-3-tuples-in-haskell/46271751#46271751", "title": "Combining three lists into a list of 3-tuples in Haskell", "body": "<p>First of all let's add a type signature. From the question it seems as if the following type signature is appropriate:\n<code>zipThree :: [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]</code></p>\n\n<p>This takes 3 lists (containing possibly different types of objects) and then produces a list of triples.</p>\n\n<p>You handle the empty list case fine:\n<code>zipThree [] [] [] = []</code></p>\n\n<p>Then the problem occurs. As stated in the comments you have cases for the lists having different lengths but that give a different type of output.</p>\n\n<p>I'll annotate the types next to each line so you can see:</p>\n\n<pre><code>zipThree [] [] [x] = [x] :: [c]\nzipThree [] [x] [] = [x] :: [b]\nzipThree [x] [] [] = [x] :: [a]\n</code></pre>\n\n<p>These don't fit with the other two cases that have type <code>[(a, b, c)]</code>.</p>\n\n<p>You mentioned in the comments that you will just presume the lengths are the same size therefore just removing these cases is sufficient. This gives:</p>\n\n<pre><code>zipThree [] [] [] = []\nzipThree (x:xs) (y:ys) (z:zs) = (x, y, z) : zipThree xs ys zs\n</code></pre>\n\n<p>Which provides the correct output (<code>[(1, 4, 'a'),  (2, 5, 'b'), (3, 6, 'c')]</code>) for the input you gave (<code>[1, 2, 3] [4, 5, 6] ['a', 'b', 'c']</code>).</p>\n\n<p>This function of course will fail on inputs where the lists are of different lengths. One way to stop a straight up error and allow you to handle the issue would be to wrap the result in a Maybe.</p>\n\n<p>First we need to change the type to:\n<code>zipThree :: [a] -&gt; [b] -&gt; [c] -&gt; Maybe [(a, b, c)]</code></p>\n\n<p>The Maybe data type can either be a value wrapped in Just so <code>Just a</code> or <code>Nothing</code>.</p>\n\n<p>For the empty list we want to give just the empty list:\n<code>zipThree [] [] [] = Just []</code>.</p>\n\n<p>Naturally you might think that the next case should be:\n<code>zipThree (x:xs) (y:ys) (z:zs) = Just $ (x, y, z) : zipThree xs ys zs</code>.</p>\n\n<p>But this doesn't work. Don't forget <code>zipThree xs ys zs</code> now has type <code>Maybe [(a, b, c)]</code> whereas <code>(x, y, z)</code> has type <code>(a, b, c)</code> so we can't add it to the list.</p>\n\n<p>What we need to do is check the result of <code>zipThree xs ys zs</code> if it failed at some point during the recursion then it will be <code>Nothing</code> so we just want to pass that <code>Nothing</code> along again. If it succeeded and gave us <code>Just as</code> then we want to add our <code>(x, y, z)</code> to that list. We can check which case is relevant using <code>case of</code>:</p>\n\n<pre><code>zipThree (x:xs) (y:ys) (z:zs) = case zipThree xs ys zs of\n    Nothing -&gt; Nothing\n    Just as -&gt; Just $ (x, y, z) : as\n</code></pre>\n\n<p>We will know our lists aren't the same length if at some point during the recursion some lists are empty and others aren't. This doesn't match either pattern we have at the moment <code>[] [] []</code> or <code>(x:xs) (y:ys) (z:zs)</code> so we need one final catch all case to give us that <code>Nothing</code> and prevent the error:</p>\n\n<p><code>zipThree _ _ _ = Nothing</code></p>\n\n<p>This gives a final definition of:</p>\n\n<pre><code>zipThree :: [a] -&gt; [b] -&gt; [c] -&gt; Maybe [(a, b, c)]\nzipThree [] [] [] = Just []\nzipThree (x:xs) (y:ys) (z:zs) = case zipThree xs ys zs of\n    Nothing -&gt; Nothing\n    Just as -&gt; Just $ (x, y, z) : as\nzipThree _ _ _ = Nothing\n</code></pre>\n\n<p>The results for the examples are:</p>\n\n<p><code>zipThree [1, 2, 3] [4, 5, 6] ['a', 'b', 'c', 'd'] = Nothing</code></p>\n\n<p>and</p>\n\n<p><code>zipThree [1, 2, 3] [4, 5, 6] ['a', 'b', 'c'] = Just [(1, 4, 'a'),  (2, 5, 'b'), (3, 6, 'c')]</code>.</p>\n\n<p>Hope this helps, feel free to ask for clarification :)</p>\n\n<p>EDIT: As suggested in the comments the following definitions would stop short in the case the lists are different lengths:</p>\n\n<pre><code>zipThree :: [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]\nzipThree (x:xs) (y:ys) (z:zs) = (x, y, z) : zipThree xs ys zs\nzipThree _ _ _ = []\n\nzipThree :: [a] -&gt; [b] -&gt; [c] -&gt; Maybe [(a, b, c)]\nzipThree (x:xs) (y:ys) (z:zs) = case zipThree xs ys zs of\n    Nothing -&gt; Just [(x, y, z)] -- Change is here\n    Just as -&gt; Just $ (x, y, z) : as\nzipThree _ _ _ = Nothing\n</code></pre>\n\n<p>P.S. Thanks to the guy who added the missing Just in an edit.</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1505750127, "last_edit_date": 1505750127, "creation_date": 1505749761, "answer_id": 46283454, "question_id": 46270429, "link": "https://stackoverflow.com/questions/46270429/combining-three-lists-into-a-list-of-3-tuples-in-haskell/46283454#46283454", "title": "Combining three lists into a list of 3-tuples in Haskell", "body": "<p>There is this <code>ZipList</code> type defined in <code>Control.Applicative</code> module which is in fact exactly thought for this job.</p>\n\n<p><code>ZipList</code> type is derived from the <code>List</code> type like</p>\n\n<pre><code>newtype ZipList a = ZipList { getZipList :: [a] }\n                    deriving ( Show, Eq, Ord, Read, Functor, Foldable\n                             , Generic, Generic1)\n</code></pre>\n\n<p>Unlike normal <code>List</code>s it's <code>Applicative</code> instance does not work on combinations but one to one on corresponding elements like zipping. Hence the name <code>ZipList</code>. This is the <code>Applicative</code> instance of <code>ZipList</code></p>\n\n<pre><code>instance Applicative ZipList where\n    pure x = ZipList (repeat x)\n    liftA2 f (ZipList xs) (ZipList ys) = ZipList (zipWith f xs ys)\n</code></pre>\n\n<p>The advantage of <code>zipList</code> is we chain up indefinitely many lists to zip with. So when <code>zipWith7</code> is not sufficient you may still carry on with a <code>ZipList</code>. So here is the code;</p>\n\n<pre><code>import Control.Applicative\n\nzip'mAll :: [Int] -&gt; [Int] -&gt; String -&gt; [(Int,Int,Char)]\nzip'mAll xs ys cs = getZipList $ (,,) &lt;$&gt; ZipList xs &lt;*&gt; ZipList ys &lt;*&gt; ZipList cs\n\n*Main&gt; zip'mAll [1,2,3] [4,5,6] \"abc\"\n[(1,4,'a'),(2,5,'b'),(3,6,'c')]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13306, "user_id": 162698, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/HnjBG.png?s=128&g=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/162698/rob"}, "edited": false, "score": 0, "creation_date": 1505759467, "post_id": 46285656, "comment_id": 79535015, "body": "What does this do? How does it answer the question? <a href=\"https://stackoverflow.com/help/how-to-answer\">stackoverflow.com/help/how-to-answer</a>"}], "tags": [], "owner": {"reputation": 1, "user_id": 8628295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49b3b7ff7b243b20c17af3ffc575657e?s=128&d=identicon&r=PG&f=1", "display_name": "spark-F", "link": "https://stackoverflow.com/users/8628295/spark-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1505811202, "last_edit_date": 1505811202, "creation_date": 1505758149, "answer_id": 46285656, "question_id": 46270429, "link": "https://stackoverflow.com/questions/46270429/combining-three-lists-into-a-list-of-3-tuples-in-haskell/46285656#46285656", "title": "Combining three lists into a list of 3-tuples in Haskell", "body": "<p>Firstly, we need a type signature, as stated by James Burton, who lists a suitable one also:</p>\n\n<pre><code>zipThree :: [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]\n</code></pre>\n\n<p>Essentially, this type signature says that, given three lists of any type a, b or c, a list of three-value tuples whose type is (a, b, c) shall be produced.</p>\n\n<p>If we disregard the need to handle invalid cases (empty lists, variable-length lists), we next need to implement a valid case which produces the correct tuple from the lists given. Your statement</p>\n\n<pre><code>zipThree (x:xs) (y:ys) (z:zs) = (x, y, z) : zipThree xs ys zs \n</code></pre>\n\n<p>is valid. Therefore, thus far we have:</p>\n\n<pre><code>zipThree :: [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]\nzipThree (x:xs) (y:ys) (z:zs) = (x, y, z) : zipThree xs ys zs \n</code></pre>\n\n<p>The problem occurs when you introduce the cases for your invalid lists:</p>\n\n<pre><code>zipThree [] [] [x] = [x]\nzipThree [] [x] [] = [x]\nzipThree [x] [] [] = [x]\n</code></pre>\n\n<p>When one of these cases is matched, the type attempting to be bound is invalid due to being of type [x], where type (x, y, z) is expected.</p>\n\n<p>You could exhaustively attempt to match base cases before recursively accessing the function again. However, you could also simply declare the case</p>\n\n<pre><code>zipThree _ _ _ = []\n</code></pre>\n\n<p>after, which will end the recursion with invalid input.</p>\n\n<p>Putting this altogether, we are left with:</p>\n\n<pre><code>zipThree :: [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]\nzipThree (x:xs) (y:ys) (z:zs) = (x, y, z) : zipThree xs ys zs\nzipThree _ _ _                = []\n</code></pre>\n\n<p><br>\nWhat's good about this implementation is that the recursion ends when any list is empty, thus stopping short for uneven lists, e.g.</p>\n\n<pre><code>zipThree [1, 2, 3] [4, 5, 6] [7, 8]\n</code></pre>\n\n<p>would produce </p>\n\n<pre><code>[(1, 4, 7), (2, 5, 8)]\n</code></pre>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 89, "user_id": 7783162, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/6e62c4e6b65938a046b006528860b30b?s=128&d=identicon&r=PG&f=1", "display_name": "Vic", "link": "https://stackoverflow.com/users/7783162/vic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1131, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1505822081, "creation_date": 1505698470, "last_edit_date": 1505703135, "question_id": 46270429, "link": "https://stackoverflow.com/questions/46270429/combining-three-lists-into-a-list-of-3-tuples-in-haskell", "title": "Combining three lists into a list of 3-tuples in Haskell", "body": "<p>I am trying to write a function that takes three lists as arguments and creates one list with a triple from each list consecutively. </p>\n\n<p>The example I was given is this: <code>zip3Lists [1, 2, 3] [4, 5, 6] ['a', 'b', 'c']</code> would produce <code>[(1, 4, 'a'),  (2, 5, 'b'), (3, 6, 'c')]</code>.</p>\n\n<p>What I have so far is this: </p>\n\n<pre><code>zipThree [] [] [] = []\nzipThree [] [] [x] = [x]\nzipThree [] [x] [] = [x]\nzipThree [x] [] [] = [x]\nzipThree (x:xs) (y:ys) (z:zs) = (x, y, z) : zipThree xs ys zs\n</code></pre>\n\n<p>and it is giving me this error: </p>\n\n<pre><code>haskell1.hs:32:33: error:\n    \u2022 Occurs check: cannot construct the infinite type: c ~ (c, c, c)\n      Expected type: [c]\n        Actual type: [(c, c, c)]\n    \u2022 In the expression: (x, y, z) : zipThree xs ys zs\n      In an equation for \u2018zipThree\u2019:\n          zipThree (x : xs) (y : ys) (z : zs) = (x, y, z) : zipThree xs ys zs\n    \u2022 Relevant bindings include\n        zs :: [c] (bound at haskell1.hs:32:27)\n        z :: c (bound at haskell1.hs:32:25)\n        ys :: [c] (bound at haskell1.hs:32:20)\n        y :: c (bound at haskell1.hs:32:18)\n        xs :: [c] (bound at haskell1.hs:32:13)\n        x :: c (bound at haskell1.hs:32:11)\n        (Some bindings suppressed; use -fmax-relevant-binds=N or -fno-max-relevant-binds)\n</code></pre>\n"}, {"tags": ["haskell", "purescript"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1505713536, "post_id": 46270237, "comment_id": 79506989, "body": "Why not match it into a variable, and then use <code>name</code> on it? <code>personToString p = name p</code>"}, {"owner": {"reputation": 543, "user_id": 6754526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/60bc5a2322d33e27c6c7cf874a93d234?s=128&d=identicon&r=PG&f=1", "display_name": "M. Walker", "link": "https://stackoverflow.com/users/6754526/m-walker"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1505753682, "post_id": 46270237, "comment_id": 79532055, "body": "Yeah definitely could, but I was using this contrived example to understand what is going on..."}], "answers": [{"tags": [], "owner": {"reputation": 745, "user_id": 176108, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/0c92fe969f853f47588c0683fafdd3e4?s=128&d=identicon&r=PG", "display_name": "Albtzrly", "link": "https://stackoverflow.com/users/176108/albtzrly"}, "is_accepted": false, "score": 6, "last_activity_date": 1505712264, "last_edit_date": 1505712264, "creation_date": 1505711928, "answer_id": 46272055, "question_id": 46270237, "link": "https://stackoverflow.com/questions/46270237/purescript-pattern-match-wildcard-data-constructor/46272055#46272055", "title": "Purescript: Pattern match wildcard data constructor", "body": "<p>I'm not sure exactly why the compiler can't infer that both sum types have <code>{ name :: String }</code> as an argument. I don't think the compiler can do that right now, and I'm not sure it's even possible.</p>\n\n<p>Having said that, there are ways to introspect the types that you use, and you could define the <code>personToString</code> function so it can work on your <code>Person</code> type. Keep in mind that this is delving into a more advanced area of the language, and this is also a new area for me. This is probably going way beyond your question, but it might be helpful to others, and it's good to know what's possible.</p>\n\n<p>First, let's define a typeclass for \"types that have names\".</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class DoesHaveName a where\n  getName :: a -&gt; String\n</code></pre>\n\n<p>Now we need to examine the structure of the <code>Person</code> type. To do that, we can use the <a href=\"https://github.com/purescript/purescript-generics-rep\" rel=\"noreferrer\">purescript-generics-rep</a> package. First we'll tell the compiler to examine the data type and create a general-purpose representation of it. We're going to create an instance of <code>Generic</code> for the <code>Person</code> type.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Generic.Rep (class Generic)\n\nderive instance genericPerson :: Generic Person _\n</code></pre>\n\n<p>We can see all the different ways to represent the type by looking at the constructors in <a href=\"https://pursuit.purescript.org/packages/purescript-generics-rep/5.1.0/docs/Data.Generic.Rep\" rel=\"noreferrer\">Data.Generic.Rep</a>, and we can transform a <code>Person</code> into that structure by using <a href=\"https://pursuit.purescript.org/packages/purescript-generics-rep/5.1.0/docs/Data.Generic.Rep#v:from\" rel=\"noreferrer\">from</a>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Generic.Rep (class Generic, from)\n\npersonToString :: Person -&gt; String\npersonToString a = getName (from a)\n</code></pre>\n\n<p>So now we have to create an instance of <code>DoesHaveName</code> for any one-argument constructor that accepts <code>{ name :: String }</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Generic.Rep (class Generic, to, from, Sum(..), Rec(..), NoConstructors, Constructor(..), Field(..))\nimport Data.Symbol (class IsSymbol, SProxy(..), reflectSymbol)\n\ninstance doesHaveNameConstructor\n  :: (IsSymbol t0, IsSymbol t1)\n  =&gt; DoesHaveName (Constructor t0 (Rec (Field t1 String))) where\n  getName (Constructor (Rec (Field c))) =\n    case (reflectSymbol (SProxy :: SProxy t1)) of\n      \"name\" -&gt; c\n      _ -&gt; \"NoName\"\n</code></pre>\n\n<p>That's a lot to chew on. I'll try and break it down as best I can. <code>t0</code> and <code>t1</code> are Symbols - So they're part of the literal code you write. In this case <code>t0</code> is the name of the Sum type constructor (either Amy or George). <code>t1</code> is the label of the record (in your example it will be \"name\"). So we use <code>reflectSymbol</code> to turn the symbols into strings that we can match on. If the label is \"name\", then we'll return the value inside the field, otherwise we'll return \"NoName\".</p>\n\n<p>The last thing we need to do is create a <code>DoesHaveName</code> instance for the Sum type structure. Sum types contain the Constructors so this instance is basically just handling the outer structure and delegating to the instance we defined above.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance doesHaveNameSum\n  :: (DoesHaveName a, DoesHaveName b)\n  =&gt; DoesHaveName (Sum a b) where\n  getName (Inl a) = getName a\n  getName (Inr b) = getName b\n</code></pre>\n\n<p>Now we can log all sorts of people's names...</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Person\n  = Amy { name :: String  }\n  | George { name :: String  }\n  | Jim { name :: String  }\n\n\n-- Logs \"amy\"\nlog $ personToString (Amy { name: \"amy\" }\n\n-- Logs \"george\"\nlog $ personToString (George { name: \"george\" }\n\n-- Logs \"jim\"\nlog $ personToString (Jim { name: \"jim\" }\n</code></pre>\n\n<p>Demo: <a href=\"http://try.purescript.org/?gist=2fc95ad13963e96dd2a49b41f5703e21\" rel=\"noreferrer\">http://try.purescript.org/?gist=2fc95ad13963e96dd2a49b41f5703e21</a></p>\n"}, {"tags": [], "owner": {"reputation": 216, "user_id": 135763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RKRqA.jpg?s=128&g=1", "display_name": "Sam Thomson", "link": "https://stackoverflow.com/users/135763/sam-thomson"}, "is_accepted": false, "score": 0, "last_activity_date": 1516576739, "creation_date": 1516576739, "answer_id": 48372762, "question_id": 46270237, "link": "https://stackoverflow.com/questions/46270237/purescript-pattern-match-wildcard-data-constructor/48372762#48372762", "title": "Purescript: Pattern match wildcard data constructor", "body": "<p>If the constructor can safely be ignored, that's a smell that the type can be refactored:</p>\n\n<pre><code>data AmyOrGeorge = Amy | George\n\ndata Person = Person AmyOrGeorge { name :: String  }\n\npersonToString (Person _ { name: n }) = n\n</code></pre>\n\n<p>I agree with the language designers' choice to leave this feature out, because working around it actually <em>improves</em> the code.</p>\n"}], "owner": {"reputation": 543, "user_id": 6754526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/60bc5a2322d33e27c6c7cf874a93d234?s=128&d=identicon&r=PG&f=1", "display_name": "M. Walker", "link": "https://stackoverflow.com/users/6754526/m-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 1, "answer_count": 2, "score": 4, "last_activity_date": 1516576739, "creation_date": 1505696438, "question_id": 46270237, "link": "https://stackoverflow.com/questions/46270237/purescript-pattern-match-wildcard-data-constructor", "title": "Purescript: Pattern match wildcard data constructor", "body": "<p>While the example is contrived, why can I not use the wildcard pattern if the data constructor is ignored?</p>\n\n<pre><code>module Main where\n\nimport Prelude\nimport Control.Monad.Eff.Console (log)\n\ndata Person = Amy { name :: String  } | George { name :: String  }\n\n--Implementations Options Below\n\nmain = log $ personToString $ George  { name: \"George\" }\n</code></pre>\n\n<p><strong>No Error</strong></p>\n\n<pre><code>personToString :: Person -&gt; String\npersonToString (Amy { name: n }) = n\npersonToString (George { name: n }) = n\n</code></pre>\n\n<p><strong>Error</strong></p>\n\n<pre><code>personToString :: Person -&gt; String\npersonToString (_ { name: n }) = n\n</code></pre>\n\n<p><a href=\"http://try.purescript.org/?session=a1503b9a-0546-7832-39b0-6321a89ef2e3\" rel=\"nofollow noreferrer\">http://try.purescript.org/?session=a1503b9a-0546-7832-39b0-6321a89ef2e3</a></p>\n\n<pre><code>Unable to parse module:\n  unexpected {\n  expecting ::, operator or )\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1505689972, "post_id": 46269481, "comment_id": 79501871, "body": "Just to make sure, you know about Simon Marlowe&#39;s book parallel and concurrent programming in haskell?"}, {"owner": {"reputation": 1, "user_id": 8623875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ede894c08bdd73a68b92f127ec2a7f0?s=128&d=identicon&r=PG&f=1", "display_name": "FooBarThrow", "link": "https://stackoverflow.com/users/8623875/foobarthrow"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1505690471, "post_id": 46269481, "comment_id": 79501959, "body": "@epsilonhalbe yes I haven&#39;t read it though"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1505703808, "post_id": 46269481, "comment_id": 79504491, "body": "Threadscope has the information necessary to figure this out, though I don&#39;t think it displays that particular bit of information. In any case, the <a href=\"https://wiki.haskell.org/ThreadScope\" rel=\"nofollow noreferrer\">threadscope documentation</a> should provide some pointers."}], "owner": {"reputation": 1, "user_id": 8623875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ede894c08bdd73a68b92f127ec2a7f0?s=128&d=identicon&r=PG&f=1", "display_name": "FooBarThrow", "link": "https://stackoverflow.com/users/8623875/foobarthrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505687715, "creation_date": 1505687715, "question_id": 46269481, "link": "https://stackoverflow.com/questions/46269481/determine-sequential-vs-parallel-execution-proportions", "title": "Determine Sequential vs Parallel execution proportions", "body": "<p>Give some haskell program, is there any way in GHC to determine percentages of sequential vs. parallel execution time ratios? I am aware of <code>rtsopts</code> but as far as I'm aware that does not provide any details other than CPU-time and wall-time.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 0, "creation_date": 1505685263, "post_id": 46267890, "comment_id": 79500952, "body": "&gt; But, I can&#39;t figure out how to get Stack to rewrite my Setup.hs file, to track these local external dependencies.  Hmm, not sure what you mean by this.  When using custom Setup.hs, the cabal file is still consulted.  Dependencies do not go in your custom Setup.hs, but in the &quot;build-depends&quot; section in cabal.  Stack does not automatically update / rewrite either cabal or Setup.hs files (well, there is an exception there with &quot;stack upload --pvp-bounds&quot;, but that can be ignored)."}, {"owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "reply_to_user": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 0, "creation_date": 1505702827, "post_id": 46267890, "comment_id": 79504289, "body": "Thanks! So, two questions:  1. Is this a sufficient Setup.hs for a Custom build-type?:      import Distribution.Simple     main = defaultMain  2. If I touch ../loc_deps/loc_dep1/NeededModule.hs and then &quot;stack build&quot;, should I expect to see ../loc_deps/loc_dep1/NeededModule.hs get recompiled? Currently, I&#39;m not, which is what prompted me to write this question."}, {"owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "reply_to_user": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 0, "creation_date": 1505703249, "post_id": 46267890, "comment_id": 79504381, "body": "Sorry, didn&#39;t realize that formatting doesn&#39;t work in comments. Please, see edited original question. Thanks!"}, {"owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "reply_to_user": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 0, "creation_date": 1505828323, "post_id": 46267890, "comment_id": 79566424, "body": "Hi, @mgsloan, just wondering if you&#39;d had a chance to look at my most recent edits to the original question, and if you had any comments. Thanks!"}, {"owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "edited": false, "score": 0, "creation_date": 1506374648, "post_id": 46267890, "comment_id": 79786697, "body": "That should work, but note that it will have the same behavior as simple build type.  Does NeededModule get recompiled in that case?  I&#39;m guessing it&#39;s not in your list of <code>exposed-modules</code> / <code>other-modules</code>.  If it is indeed a dependency of one of the modules in the package, then stack will warn that it is an unlisted module."}], "owner": {"reputation": 1307, "user_id": 1549736, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LBwQu.jpg?s=128&g=1", "display_name": "dbanas", "link": "https://stackoverflow.com/users/1549736/dbanas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1517002386, "creation_date": 1505675511, "last_edit_date": 1517002386, "question_id": 46267890, "link": "https://stackoverflow.com/questions/46267890/how-to-get-stack-to-rewrite-my-setup-hs-file-after-changing-to-custom-build-typ", "title": "How to get Stack to rewrite my Setup.hs file, after changing to Custom build type?", "body": "<p>My project has local external dependencies.\nSo, I've changed the <em>build-type</em> field, in my *.cabal file, to \"Custom\" and added these sections to my <em>stack.yaml</em> file:</p>\n\n<pre><code>- location: ../loc_deps\n  subdirs:\n  - loc_dep1\n  - loc_dep2\n  extra-dep: true\n\nexplicit-setup-deps:\n  \"*\": true # change the default\n</code></pre>\n\n<p>But, I can't figure out how to get Stack to rewrite my <em>Setup.hs</em> file, to track these local external dependencies.</p>\n\n<p>In response to the first comment, below:</p>\n\n<ol>\n<li><p>Is this a sufficient <em>Setup.hs</em> for a Custom build-type?:</p>\n\n<p>import Distribution.Simple<br>\nmain = defaultMain</p></li>\n<li><p>I'm expecting that if I touch <em>../loc_deps/loc_dep1/NeededModule.hs</em> and then run a \"stack build\", I'll see <em>NeededModule.hs</em> get recompiled, but I'm not seeing that.</p></li>\n</ol>\n\n<p>In response to @mgsloan (first comment below):<br>\nWrt/ this:<br>\n<em>Dependencies do not go in your custom Setup.hs</em><br>\nSo, then, is this verbiage, taken from the <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#explicit-setup-deps\" rel=\"nofollow noreferrer\"><em>stack.yaml</em> fields descriptions page</a>, out of date?:</p>\n\n<blockquote>\n  <p>Decide whether a custom Setup.hs script should be run with an explicit\n  list of dependencies, based on the dependencies of the package itself.\n  It associates the name of a local package with a boolean. When it's\n  true, the Setup.hs script is built with an explicit list of packages.</p>\n</blockquote>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1505676321, "post_id": 46267742, "comment_id": 79498566, "body": "Why do you use <code>lts-6.4</code>? With stack you must choose: either everything old or everything new... with the latter being almost always preferrable. If you want to mix old and new library dependencies, you&#39;ll need to explicitly juggle <code>extra-deps</code>, but at that point you might easier just use good old Cabal-install instead. Or rather, <a href=\"http://blog.ezyang.com/2016/05/announcing-cabal-new-build-nix-style-local-builds/\" rel=\"nofollow noreferrer\">good <i>new</i> Cabal-install</a>..."}], "answers": [{"comments": [{"owner": {"reputation": 1724, "user_id": 3286513, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bc0cef8062401f1b84db320cb56c28bd?s=128&d=identicon&r=PG", "display_name": "Steven L.", "link": "https://stackoverflow.com/users/3286513/steven-l"}, "edited": false, "score": 0, "creation_date": 1505679785, "post_id": 46268049, "comment_id": 79499561, "body": "Sibi, thank you for the comment. The reason that I don&#39;t use a newer resolver is that if I do, I get more errors: <code>In the dependencies for servant-persistent-0.2.0.0:     base-4.9.1.0 must match &gt;=4.7 &amp;&amp; &lt;4.9 (latest applicable is 4.8.2.0)     servant-0.11 must match &gt;=0.7 &amp;&amp; &lt;0.8 (latest applicable is 0.7.1)     servant-js-0.9.3 must match &gt;=0.7 &amp;&amp; &lt;0.8 (latest applicable is 0.7.1)     servant-server-0.11 must match &gt;=0.7 &amp;&amp; &lt;0.8 (latest applicable is 0.7.1)</code>"}, {"owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "reply_to_user": {"reputation": 1724, "user_id": 3286513, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bc0cef8062401f1b84db320cb56c28bd?s=128&d=identicon&r=PG", "display_name": "Steven L.", "link": "https://stackoverflow.com/users/3286513/steven-l"}, "edited": false, "score": 1, "creation_date": 1505685080, "post_id": 46268049, "comment_id": 79500909, "body": "@StevenL. Sounds like your cabal package has constraints that do not match , so they should be modified if you want to use them.  The packages within the resolver are all compatible with each other.  One way to quickly see if things still build when ignoring constraints is to pass <code>--allow-newer</code>, which essentially ignores constraints altogether."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 4, "last_activity_date": 1505676492, "creation_date": 1505676492, "answer_id": 46268049, "question_id": 46267742, "link": "https://stackoverflow.com/questions/46267742/how-to-use-newer-version-of-library-than-stackage-resolver-has-available/46268049#46268049", "title": "How to Use Newer Version of Library Than Stackage Resolver Has Available", "body": "<p>You need to do two things:</p>\n\n<p>1) Modify the cabal constraint to allow newer version of katib i.e:</p>\n\n<pre><code>katip &gt;= 0.5 &amp;&amp; &lt; 0.6\n</code></pre>\n\n<p>2) Modify stack.yaml file to allow it</p>\n\n<pre><code>extra-deps:\n- katip-0.5.0.0\n</code></pre>\n\n<p>That being said, unless you have a strong reason - it is better to always use new stackage resolver. The latest one is <code>lts-9.5</code>.</p>\n"}], "owner": {"reputation": 1724, "user_id": 3286513, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bc0cef8062401f1b84db320cb56c28bd?s=128&d=identicon&r=PG", "display_name": "Steven L.", "link": "https://stackoverflow.com/users/3286513/steven-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 46268049, "answer_count": 1, "score": 2, "last_activity_date": 1505676492, "creation_date": 1505674475, "question_id": 46267742, "link": "https://stackoverflow.com/questions/46267742/how-to-use-newer-version-of-library-than-stackage-resolver-has-available", "title": "How to Use Newer Version of Library Than Stackage Resolver Has Available", "body": "<p>I want to use the <code>katip</code> library, version <code>0.5.0.0</code> in a <code>stack</code>-based project. (The project can be found <a href=\"https://github.com/StevenXL/servant-persistent/tree/add-katip\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>Unfortunately, my <code>stack.yaml</code> file has the resolver <code>lts-6.4</code>which is downloading <code>katip-0.2.0.0</code>. </p>\n\n<p>What is the correct way to use <code>katip-0.5.0.0</code>?</p>\n\n<p>I tried modifying my <code>cabal</code> file to use <code>katip &gt;= 0.5 &amp;&amp; &lt;0.6</code>, but when I did so, I got this errors:</p>\n\n<p><code>In the dependencies for servant-persistent-0.2.0.0:\n    katip-0.2.0.0 must match &gt;=0.5 &amp;&amp; &lt;0.6 (latest applicable is 0.5.0.1)</code></p>\n"}, {"tags": ["string", "list", "haskell", "input"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1505664414, "post_id": 46266112, "comment_id": 79494800, "body": "It is not really clear how you would convert the <code>[String]</code> list into a <code>[[String]]</code> list. Based on what condition? Do you want the &quot;words&quot; of that line?"}, {"owner": {"reputation": 71, "user_id": 8622570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/582f23659e7dcea18acadd21019d271a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Maassen", "link": "https://stackoverflow.com/users/8622570/jeroen-maassen"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505666162, "post_id": 46266112, "comment_id": 79495282, "body": "I have added an example"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1505667251, "last_edit_date": 1505667251, "creation_date": 1505666490, "answer_id": 46266446, "question_id": 46266112, "link": "https://stackoverflow.com/questions/46266112/get-input-to-string-haskell/46266446#46266446", "title": "Get input to [[String]] Haskell", "body": "<p>Haskell has a function <code>words :: String -&gt; [String]</code>. For example:</p>\n\n<pre><code>Prelude&gt; words \"These are random\"\n[\"These\",\"are\",\"random\"]\n</code></pre>\n\n<p>Now we can do this for a list of lines by using <code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code>:</p>\n\n<pre><code>Prelude&gt; map words [\"These are random\",\"Words of text\",\"example example example\"]\n[[\"These\",\"are\",\"random\"],[\"Words\",\"of\",\"text\"],[\"example\",\"example\",\"example\"]]\n</code></pre>\n\n<p>You can combine this with <code>lines</code> to extract the lines of the string first:</p>\n\n<pre><code>Prelude&gt; (map words . lines) \"These are random\\nWords of text\\nexample example example\"\n[[\"These\",\"are\",\"random\"],[\"Words\",\"of\",\"text\"],[\"example\",\"example\",\"example\"]]\n</code></pre>\n\n<p>So if <code>foo</code> has type <code>foo :: [[String]] -&gt; [[String]]</code>, you can use:</p>\n\n<pre><code>main = interact (unlines . map unwords . foo . map words . lines)\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 8622570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/582f23659e7dcea18acadd21019d271a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Maassen", "link": "https://stackoverflow.com/users/8622570/jeroen-maassen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1505667251, "creation_date": 1505664333, "last_edit_date": 1505666285, "question_id": 46266112, "link": "https://stackoverflow.com/questions/46266112/get-input-to-string-haskell", "title": "Get input to [[String]] Haskell", "body": "<p>I want to get my input to be a list of lists.\nEach row of text has to be a list of strings and the full text will be the list of lists. How could I do this? \nI have this as the main:</p>\n\n<pre><code>main :: IO ()\nmain = interact (lines &gt;&gt;&gt; foo &gt;&gt;&gt; unlines)\n</code></pre>\n\n<p>So if this is the input:</p>\n\n<pre><code>These are random\nWords of text\nexample example example\n</code></pre>\n\n<p>The result should be this:</p>\n\n<pre><code>[[These, are, random], [Words, of, text],[example, example, example]]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1505661020, "post_id": 46265578, "comment_id": 79493786, "body": "Install via haskell stack ."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1505689850, "post_id": 46265578, "comment_id": 79501854, "body": "You can try to <code>cabal install ghc-mod --allow-newer</code> though I would also use <code>stack</code> - clone the git repository,  <code>stack init</code> and edit the stack yaml, to allow newer."}], "answers": [{"tags": [], "owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "is_accepted": true, "score": 2, "last_activity_date": 1505713742, "creation_date": 1505713742, "answer_id": 46272352, "question_id": 46265578, "link": "https://stackoverflow.com/questions/46265578/win10-ghc-mod-fails-to-install-ghc-8-2-1/46272352#46272352", "title": "win10 ghc-mod fails to install (ghc 8.2.1)", "body": "<p>According to <a href=\"https://github.com/DanielG/ghc-mod/issues/907\" rel=\"nofollow noreferrer\">this ticket</a> for ghc-mod, </p>\n\n<blockquote>\n  <p>GHC 8.2.1 is not supported yet, hence the base&lt;4.10 constraint.</p>\n</blockquote>\n\n<p>(as of mid-Sept. 2917) and,</p>\n\n<p>the feature support for 8.2.1 is added this to the <a href=\"https://github.com/DanielG/ghc-mod/milestone/8\" rel=\"nofollow noreferrer\">v5.9.0.0 milestone</a>.</p>\n"}], "owner": {"reputation": 23, "user_id": 8622709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84ed1ec4fbb6f4b2090a83378ee2fdb4?s=128&d=identicon&r=PG&f=1", "display_name": "Bryce", "link": "https://stackoverflow.com/users/8622709/bryce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 46272352, "answer_count": 1, "score": 2, "last_activity_date": 1505713742, "creation_date": 1505660964, "last_edit_date": 1505668036, "question_id": 46265578, "link": "https://stackoverflow.com/questions/46265578/win10-ghc-mod-fails-to-install-ghc-8-2-1", "title": "win10 ghc-mod fails to install (ghc 8.2.1)", "body": "<pre><code>cabal: Could not resolve dependencies:\ntrying: ghc-mod-5.8.0.0 (user goal)\nnext goal: base (dependency of ghc-mod-5.8.0.0)\nrejecting: base-4.10.0.0/installed-4.1... (conflict: ghc-mod =&gt; base&lt;4.10 &amp;&amp; &gt;=4.6.0.1)\nrejecting: base-4.10.0.0, base-4.9.1.0, base-4.9.0.0, base-4.8.2.0,\nbase-4.8.1.0, base-4.8.0.0, base-4.7.0.2, base-4.7.0.1, base-4.7.0.0,\nbase-4.6.0.1, base-4.6.0.0, base-4.5.1.0, base-4.5.0.0, base-4.4.1.0,\nbase-4.4.0.0, base-4.3.1.0, base-4.3.0.0, base-4.2.0.2, base-4.2.0.1,\nbase-4.2.0.0, base-4.1.0.0, base-4.0.0.0, base-3.0.3.2, base-3.0.3.1\n(constraint from non-upgradeable package requires installed instance)\nAfter searching the rest of the dependency tree exhaustively, these were the goals I've had most trouble fulfilling: base, ghc-mod, syb\n</code></pre>\n\n<p>What happend? And, what should I do?</p>\n"}, {"tags": ["string", "parsing", "haskell", "types"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1505658311, "post_id": 46265118, "comment_id": 79492971, "body": "But here you do not parse: a <code>Field</code> is a <code>String</code>: you have defined a type alias. So that means that <code>[String]</code> is <code>[Field]</code>. You do not have to do any processing."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1505658472, "creation_date": 1505658472, "answer_id": 46265166, "question_id": 46265118, "link": "https://stackoverflow.com/questions/46265118/how-to-parse-to-custom-type-in-haskell/46265166#46265166", "title": "How to parse to custom type in Haskell", "body": "<blockquote>\n  <p>I have created a new type</p>\n</blockquote>\n\n<p>No you have not. If you write <code>type Foo = ...</code> you define a <strong>type alias</strong>: there is no new type, you only have given a certain (composite) type a new name. From now on, you can use <code>Field</code> and <code>String</code> interleaved. You define new types with <code>data Foo = ...</code> or <code>newtype Foo = ...</code>. Usually <code>type Foo = ...</code> is used to give a more complex type a specific name. Like for instance <code>type NamedStringCollection = (String,[String])</code>.</p>\n\n<p>Since <code>String</code> and <code>Field</code> are the same type, so are <code>[String]</code> and <code>[Field]</code>. As a result you do not need to do any processing. If you have a <code>[String]</code>, this is at the same time a <code>[Field]</code>.</p>\n\n<p>You can write:</p>\n\n<pre><code>parse :: [String] -&gt; [Field]\nparse = <b>id</b>  -- not necessary</code></pre>\n\n<p>But the <code>id</code> simply returns what you give it. So <code>id</code> does not do any work.</p>\n"}], "owner": {"reputation": 71, "user_id": 8622570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/582f23659e7dcea18acadd21019d271a?s=128&d=identicon&r=PG&f=1", "display_name": "Jeroen Maassen", "link": "https://stackoverflow.com/users/8622570/jeroen-maassen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505658472, "creation_date": 1505658191, "question_id": 46265118, "link": "https://stackoverflow.com/questions/46265118/how-to-parse-to-custom-type-in-haskell", "title": "How to parse to custom type in Haskell", "body": "<p>I'm new to haskell and have no idea how to parse. </p>\n\n<p>I have created a new type</p>\n\n<pre><code>type Field = String\n</code></pre>\n\n<p>Now I want parse [String] to [Field], how could I do this?\nI already have this:</p>\n\n<pre><code>parse :: [String] -&gt; [Field]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1505671047, "post_id": 46264929, "comment_id": 79496816, "body": "See <a href=\"https://wiki.haskell.org/Power_function\" rel=\"nofollow noreferrer\">wiki.haskell.org/Power_function</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1505678126, "post_id": 46264929, "comment_id": 79499108, "body": "Both Haskell and Python return the first complex root of <code>-1</code> (~0.5-0.866i) -- I guess most programming languages do that as well, provided one uses a suitable complex type. When using doubles, NaN arises since the result is not real."}], "answers": [{"tags": [], "owner": {"reputation": 216, "user_id": 7158426, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yqhAq.jpg?s=128&g=1", "display_name": "Istvan", "link": "https://stackoverflow.com/users/7158426/istvan"}, "is_accepted": false, "score": 1, "last_activity_date": 1505657386, "creation_date": 1505657386, "answer_id": 46264993, "question_id": 46264929, "link": "https://stackoverflow.com/questions/46264929/how-to-find-the-cube-root-of-a-negative-integer-such-that-it-does-not-return-nan/46264993#46264993", "title": "How to find the cube root of a negative integer such that it does not return NaN?", "body": "<p>I don't know Haskell, but you can do something like this:\nsign(x) * abs(x) ** (1/3)</p>\n"}, {"tags": [], "owner": {"reputation": 3079, "user_id": 7395911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddf10ef16bae6a76e43840f89995c12f?s=128&d=identicon&r=PG&f=1", "display_name": "Bernardo Duarte", "link": "https://stackoverflow.com/users/7395911/bernardo-duarte"}, "is_accepted": false, "score": 1, "last_activity_date": 1505674474, "creation_date": 1505674474, "answer_id": 46267741, "question_id": 46264929, "link": "https://stackoverflow.com/questions/46264929/how-to-find-the-cube-root-of-a-negative-integer-such-that-it-does-not-return-nan/46267741#46267741", "title": "How to find the cube root of a negative integer such that it does not return NaN?", "body": "<p>On ghci I've done something that seems to solve your problem:</p>\n\n<pre><code>let cbrt x = if x &lt; 0 then -((-x) ** (1/3)) else x ** (1/3)\n</code></pre>\n\n<p>A simple cuberoot function.</p>\n\n<p>As I'm still learning I don't know if this is a proper solution, so please let me know if there's something missing or wrong ;)</p>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 5, "last_activity_date": 1505780516, "last_edit_date": 1505780516, "creation_date": 1505678782, "answer_id": 46268374, "question_id": 46264929, "link": "https://stackoverflow.com/questions/46264929/how-to-find-the-cube-root-of-a-negative-integer-such-that-it-does-not-return-nan/46268374#46268374", "title": "How to find the cube root of a negative integer such that it does not return NaN?", "body": "<p>For real numbers, the Haskell operator <code>(**)</code> is only defined for negative base (left-hand side) values when the exponent (right-hand side) is integer-valued.  If this strikes you as strange, note that the C function <code>pow</code> behaves the same way:</p>\n\n<pre><code>printf(\"%f\\n\", pow(-1.0, 1.0/3.0));   // prints \"-nan\", for me\n</code></pre>\n\n<p>and so does Python's <code>**</code> operator:</p>\n\n<pre><code>print((-1.0)**(1.0/3.0)) \n# gives: ValueError: negative number cannot be raised to fractional power\n</code></pre>\n\n<p>The problem is partially a mathematical one.  The \"correct answer\" for raising a negative base to a non-integral power is far from obvious.  See, for example, this <a href=\"https://math.stackexchange.com/questions/317528/how-do-you-compute-negative-numbers-to-fractional-powers\">question on the Mathematics SO</a>.</p>\n\n<p>If you <em>only</em> need a cube root that can handle negative numbers, the other answers given should work fine, except that @Istvan's answer should use <code>signum</code> instead of <code>sign</code>, like this:</p>\n\n<pre><code>cbrt x = signum x * abs x ** (1/3)\n</code></pre>\n\n<p>If you want a more general integral root function for real numbers, be warned that for even <code>n</code>, there are no nth roots of negative numbers that are real, so this is about the best you can do:</p>\n\n<pre><code>-- | Calculate nth root of b\nroot :: (Integral n, RealFloat b) =&gt; n -&gt; b -&gt; b\nroot n b | odd n &amp;&amp; b &lt; 0  = - abs b ** overn\n         | otherwise       = b ** overn\n    where overn = 1 / fromIntegral n\n</code></pre>\n\n<p>This gives:</p>\n\n<pre><code>&gt; root 3 (-8)\n-2.0\n&gt; root 4 (-8)\nNaN      -- correct, as no real root exists\n&gt;\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 8622509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/64ce0a9af573d9ec892fbd05278c43ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Buckley", "link": "https://stackoverflow.com/users/8622509/jack-buckley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 555, "favorite_count": 0, "answer_count": 3, "score": 5, "last_activity_date": 1505780516, "creation_date": 1505657039, "question_id": 46264929, "link": "https://stackoverflow.com/questions/46264929/how-to-find-the-cube-root-of-a-negative-integer-such-that-it-does-not-return-nan", "title": "How to find the cube root of a negative integer such that it does not return NaN?", "body": "<p>In Haskell, I have tried to find the cube root of a negative integer, for example, -1, without success. </p>\n\n<p>I have used (-1) ** (1/3), but this returns a NaN. I thought that this might have something to do with type of the (1/3) fraction, but using (1/3 :: Double) yielded no success either.</p>\n\n<p>As a result, my question is how can one find the cube root of -1 using Haskell so that it doesn't return NaN?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1505862588, "post_id": 46262700, "comment_id": 79583751, "body": "Is there anything unclear in my answer, or do you need a &quot;haskell&quot; solution instead of shell cruft"}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1505862718, "post_id": 46262700, "comment_id": 79583781, "body": "I&#39;d prefer a Haskell solution other than shell cruft. But the shell cruft helps, I&#39;ll dig into &quot;ghc-pkg&quot;s source and see how it does it."}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 2, "last_activity_date": 1505643488, "creation_date": 1505643488, "answer_id": 46262948, "question_id": 46262700, "link": "https://stackoverflow.com/questions/46262700/getting-a-list-of-packagedescriptions-from-the-local-database/46262948#46262948", "title": "Getting a list of `PackageDescriptions` from the local database", "body": "<p>I don't know if there's a \"built-in\"-way of doing this, but I've used this</p>\n\n<pre><code>ghc-pkg list | grep -v \"\\(^/\\|^$\\|(\\)\" | xargs cabal info | grep \"\\(^\\*\\|License\\)\"\n</code></pre>\n\n<p>to extract \"License\" info for all installed packages.</p>\n\n<ol>\n<li>If you use <code>stack</code> or <code>cabal-sandbox</code> - the first command needs to be replaced by either <code>stack exec -- ghc-pkg list</code> or <code>cabal sandbox hc-pkg list</code>.</li>\n<li>the (first) regex removes the path-lines like <code>/opt/ghc/8.0.2/lib/ghc-8.0.2/package.conf.d</code>, empty lines and lines starting with <code>(</code> - somehow the colored lines produced by <code>ghc-pkg</code> like <code>ghc-8.0.2</code> end up with starting <code>(</code> in my terminal when grepping.</li>\n<li>\"map cabal info over all packages\"</li>\n<li>[optional] extracting the package information for the package itself (starting with <code>*</code> and the <code>License</code> field.</li>\n</ol>\n\n<p>I hope this is what you were looking for. Another way, I think, would be writing a haskell program and use <code>Cabal</code> as a library.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505643488, "creation_date": 1505641734, "question_id": 46262700, "link": "https://stackoverflow.com/questions/46262700/getting-a-list-of-packagedescriptions-from-the-local-database", "title": "Getting a list of `PackageDescriptions` from the local database", "body": "<p>Is there anyway, presumably using the <a href=\"https://hackage.haskell.org/package/Cabal\" rel=\"nofollow noreferrer\"><code>Cabal</code></a> package, to get a list of <a href=\"https://hackage.haskell.org/package/Cabal-2.0.0.2/docs/Distribution-PackageDescription.html#t:PackageDescription\" rel=\"nofollow noreferrer\"><code>PackageDesciption</code></a>s in the current local database?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 1979, "user_id": 2789312, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4OgOz.png?s=128&g=1", "display_name": "palik", "link": "https://stackoverflow.com/users/2789312/palik"}, "edited": false, "score": 0, "creation_date": 1505628603, "post_id": 46260461, "comment_id": 79485793, "body": "Stack doesn&#39;t use your os environment. You have just to add <code>direcotry</code> into <code>build-depends</code> section in cabal file."}], "answers": [{"comments": [{"owner": {"reputation": 422, "user_id": 3803703, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dbd161ebe000dc145aaa48c0d2b00cf9?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/3803703/matthew"}, "edited": false, "score": 1, "creation_date": 1505669107, "post_id": 46263051, "comment_id": 79496201, "body": "I looked at <code>ghc-pkg list</code> I guess that is all of the packages that are installed that runhaskell would use? I didn&#39;t realize all of that was there. Thanks!"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 3, "last_activity_date": 1505644118, "creation_date": 1505644118, "answer_id": 46263051, "question_id": 46260461, "link": "https://stackoverflow.com/questions/46260461/i-cant-import-system-directory-when-using-stack/46263051#46263051", "title": "I cant import System.Directory when using stack", "body": "<p>With the information you give, I can only attempt a guess\u2026</p>\n\n<p>I think you have <code>directory</code> (globally) installed with <code>cabal install directory</code> or as a system package - this would explain <code>runhaskell myscript.hs</code> working.</p>\n\n<p>if you use <code>stack</code> you have the following options.</p>\n\n<ol>\n<li><p>make a cabal package, add <code>directory</code> to the build depends section, create a <code>stack.yaml</code> and run <code>stack ghci</code> inside the project directory.</p></li>\n<li><p>use <code>stack ghci --package=directory myscript.hs</code></p></li>\n</ol>\n"}], "owner": {"reputation": 422, "user_id": 3803703, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/dbd161ebe000dc145aaa48c0d2b00cf9?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew", "link": "https://stackoverflow.com/users/3803703/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 1, "accepted_answer_id": 46263051, "answer_count": 1, "score": 4, "last_activity_date": 1505644118, "creation_date": 1505620187, "question_id": 46260461, "link": "https://stackoverflow.com/questions/46260461/i-cant-import-system-directory-when-using-stack", "title": "I cant import System.Directory when using stack", "body": "<p>I am little confused about why this doesn't work.</p>\n\n<p>I have a small program that import System.Directory. When I run it with runhaskell on the command line it compiles and outputs what I expect.</p>\n\n<p>When I use the same program with stack I get a message saying</p>\n\n<blockquote>\n  <p>Failed to load interface for \u2018System.Directory\u2019\n      It is a member of the hidden package \u2018directory-1.3.0.0\u2019.\n      Use -v to see a list of the files searched for.</p>\n</blockquote>\n\n<p>I dont understand why it would work with <code>runhaskell</code> but not when i use <code>stack ghci</code></p>\n"}, {"tags": ["haskell", "chinese-remainder-theorem"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 2, "creation_date": 1505617839, "post_id": 46260241, "comment_id": 79483996, "body": "What did you try so far ? It would be better if you could show your attempt and we then help you at parts where you are stuck."}, {"owner": {"reputation": 1, "user_id": 8620877, "user_type": "registered", "profile_image": "https://graph.facebook.com/1807718112853324/picture?type=large", "display_name": "ale", "link": "https://stackoverflow.com/users/8620877/ale"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1505618036, "post_id": 46260241, "comment_id": 79484027, "body": "if you look at the code picture that is what i have tried so far but im not sure if that&#39;s correct"}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 5, "creation_date": 1505618618, "post_id": 46260241, "comment_id": 79484113, "body": "for future reference, just copy/paste your code, rather than screenshotting it."}], "answers": [{"tags": [], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "is_accepted": false, "score": 4, "last_activity_date": 1505620185, "creation_date": 1505620185, "answer_id": 46260460, "question_id": 46260241, "link": "https://stackoverflow.com/questions/46260241/haskell-chinese-remainder-theorem/46260460#46260460", "title": "Haskell Chinese Remainder theorem", "body": "<p>From <a href=\"https://en.wikipedia.org/wiki/Chinese_remainder_theorem#Systematic_search\" rel=\"nofollow noreferrer\">wikipedia</a>:</p>\n\n<blockquote>\n  <p>It is easy to check whether a value of <code>x</code> is a solution: it suffices to compute the remainder of the Euclidean division of <code>x</code> by each <strong>[<code>m_i</code>]</strong>.</p>\n</blockquote>\n\n<p>If <code>x `mod` m_i /= a_i</code> for any <code>i</code>, then <code>x</code> is not a solution.</p>\n\n<p>This smacks of homework, so rather than give you a one-liner that computes this, I'm going to give you some leading questions for your implementation of <code>crtIsSolution n as ms</code>:</p>\n\n<ul>\n<li>Is <code>n</code> a solution if <code>ms</code> and <code>as</code> are empty?</li>\n<li>If you can compute whether <code>n `mod` m_0 == a_0</code> and whether <code>n</code> is a solution for <code>ms_0</code> and <code>as_0</code>, can you compute whether <code>n</code> is a solution for <code>m_0:ms_0</code> and <code>a_0:as_0</code>?</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 8620877, "user_type": "registered", "profile_image": "https://graph.facebook.com/1807718112853324/picture?type=large", "display_name": "ale", "link": "https://stackoverflow.com/users/8620877/ale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 856, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505670453, "creation_date": 1505617273, "last_edit_date": 1505670453, "question_id": 46260241, "link": "https://stackoverflow.com/questions/46260241/haskell-chinese-remainder-theorem", "title": "Haskell Chinese Remainder theorem", "body": "<p>I understand that in order for this function to work crtHasSolution has to be true first I'm having trouble proving that n could be a solution any ideas or tips in how to write or check that in haskell? </p>\n\n<p>I know that the conditions for N are that it has to be bigger or equal to 0 and smaller then m which is the product of all the mod bases.</p>\n\n<p><a href=\"https://i.stack.imgur.com/olBss.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/olBss.png\" alt=\"notes from where conclusion came from\"></a></p>\n\n<pre><code>crtHasSolution :: [Integer] -&gt; [Integer] -&gt; Bool\ncrtHasSolution as ms = length as &gt; 0 &amp;&amp;\n                       length ms &gt; 0 &amp;&amp;\n                       length as == length ms &amp;&amp;\n                       all (&gt;=0) as &amp;&amp;\n                       all (&gt;=2) ms &amp;&amp;\n                       pairwise_coprime ms\n\n-- Is a given number a solution to a CRT problem?\n-- usage: crtIsSolution n as ms = ans\n-- assures: ans == True, if crtHasSolution as ms == True and n is a solution\n--          ans == False, otherwise\n\ncrtIsSolution :: Integer -&gt; [Integer] -&gt; [Integer] -&gt; Bool\ncrtIsSolution n as ms = crtHasSolution as ms &amp;&amp;\n                        n &gt;= 0 &amp;&amp;\n                        n &lt; m\n                        where m =\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/g7KNl.png\" rel=\"nofollow noreferrer\">code</a></p>\n"}, {"tags": ["regex", "haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1505615168, "post_id": 46259434, "comment_id": 79483627, "body": "If this is for learning Haskell: great! Otherwise it seems like you might just want to throw the standard command line tools at this. <code>grep -o &#39;[0-9]\\+\\.xml&#39; | sed &#39;s&#47;.xml&#47;&#47;&#39;</code> seems to work, and you could probably do it with a single <code>sed</code> command if you don&#39;t mind it looking a bit less comprehensible."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1505615274, "post_id": 46259754, "comment_id": 79483639, "body": "The original regex may have been deliberately chosen, e.g. if they were expecting one possible filename to be <code>foo3bar4.xml</code>."}, {"owner": {"reputation": 661, "user_id": 7720738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HccZv.png?s=128&g=1", "display_name": "James Burton", "link": "https://stackoverflow.com/users/7720738/james-burton"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1505675741, "post_id": 46259754, "comment_id": 79498398, "body": "@DanielWagner If that were the case then the example input.txt file should have included such a case. I just provided something that gave the desired output for the example input."}], "tags": [], "owner": {"reputation": 661, "user_id": 7720738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HccZv.png?s=128&g=1", "display_name": "James Burton", "link": "https://stackoverflow.com/users/7720738/james-burton"}, "is_accepted": true, "score": 1, "last_activity_date": 1505609946, "creation_date": 1505609946, "answer_id": 46259754, "question_id": 46259434, "link": "https://stackoverflow.com/questions/46259434/how-can-i-use-this-regex-in-haskell/46259754#46259754", "title": "How can I use this regex in Haskell?", "body": "<p>First off you only want the number part so we can get rid of the <code>\\\\.xml</code>.</p>\n\n<p>The regex-pcre library defines an instance for <code>RegexContext Regex String String</code> but not <code>RegexContext Regex String [String]</code> hence the error.</p>\n\n<p>So if we change the type signature to <code>String -&gt; String</code> then that error is taken care of.</p>\n\n<p><code>unlines</code> expects [String] so to test what we had at this point I wrote a quick function that wraps its argument in a list (there's probably a nicer way to do that but that's not the point of the question):</p>\n\n<pre><code>toList :: a -&gt; [a]\ntoList a = [a]\n</code></pre>\n\n<p>Running your command with <code>main = interact $ unlines . toList . getID</code> output 0035, so we're almost there.</p>\n\n<p><code>getID</code> is passed a String of the file contents, these are conveniently separated by the <code>\\n</code> character. So we can use <code>splitOn \"\\n\"</code> from the Data.List.Split library to get our list of .xml files.</p>\n\n<p>Then we simply need to map <code>getID</code> over that list (<code>toList</code> is no longer needed).</p>\n\n<p>This gives us:</p>\n\n<pre><code>import Text.Regex.PCRE\nimport Data.List.Split\n\ngetID :: String -&gt; String\ngetID str = str =~ \"([0-9]+)\"\n\nmain :: IO ()\nmain = interact $ unlines . map getID . splitOn \"\\n\"\n</code></pre>\n\n<p>This gives me the desired output when I run your command.</p>\n\n<p>Hopefully this helps :)</p>\n"}], "owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 46259754, "answer_count": 1, "score": 0, "last_activity_date": 1505609946, "creation_date": 1505605599, "question_id": 46259434, "link": "https://stackoverflow.com/questions/46259434/how-can-i-use-this-regex-in-haskell", "title": "How can I use this regex in Haskell?", "body": "<p>I'm trying to make a simple Haskell program that will take any line that looks like <code>someFilenameHere0035.xml</code> and returns <code>0035</code>. My sample input file, input.txt, would look like this: </p>\n\n<pre><code>someFilenameHere0035.xml\nanotherFilenameHere4465.xml\n</code></pre>\n\n<p>And running: <code>cat input.txt | runhaskell getID.hs</code> should return: </p>\n\n<pre><code>0035\n4465\n</code></pre>\n\n<p>I'm having so much difficulty figuring this out. Here's what I have so far: </p>\n\n<pre><code>import Text.Regex.PCRE\n\ngetID :: String -&gt; [String]\ngetID str = str =~ \"([0-9]+)\\\\.xml\" :: [String]\n\nmain :: IO ()\nmain = interact $ unlines . getID\n</code></pre>\n\n<p>But I get an error message I don't understand at all: </p>\n\n<pre><code>\u2022 No instance for (RegexContext Regex String [String])\n arising from a use of \u2018=~\u2019\n\u2022 In the expression: str =~ \"([0-9]+)\\\\.xml\" :: [String]\n   In an equation for \u2018getID\u2019:\n   getID str = str =~ \"([0-9]+)\\\\.xml\" :: [String] (haskell-stack-ghc)\n</code></pre>\n\n<p>I feel like I'm really close, but I don't know where to go from here. What am I doing wrong? </p>\n"}, {"tags": ["function", "haskell", "syntax"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 2, "creation_date": 1505604901, "post_id": 46259379, "comment_id": 79482267, "body": "What is <code>any</code>? Isn&#39;t that a function? Comparing against a function doesn&#39;t make much sense. Also, what are the errors?"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1505604989, "post_id": 46259379, "comment_id": 79482279, "body": "And what&#39;s the <code>take 1</code> at the end meant to do? That will cause a type error since you&#39;re only partially applying <code>take</code>. I&#39;d like to help, but I don&#39;t want to just write the function for you. You&#39;re going to need to narrow your question down, as there&#39;s a few things wrong with this code."}, {"owner": {"reputation": 13, "user_id": 7824152, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-17ZWx3g0ZEQ/AAAAAAAAAAI/AAAAAAAAABA/313mncktaYU/photo.jpg?sz=128", "display_name": "Cheyanne", "link": "https://stackoverflow.com/users/7824152/cheyanne"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1505605865, "post_id": 46259379, "comment_id": 79482429, "body": "I saw that &quot;any&quot; was something you could use to mean any other element in the list."}, {"owner": {"reputation": 13, "user_id": 7824152, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-17ZWx3g0ZEQ/AAAAAAAAAAI/AAAAAAAAABA/313mncktaYU/photo.jpg?sz=128", "display_name": "Cheyanne", "link": "https://stackoverflow.com/users/7824152/cheyanne"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1505605973, "post_id": 46259379, "comment_id": 79482450, "body": "I also saw that take 1 the tutorial i was reading as well. It was supposed to return the first element at the beginning of the list. I could write that a different way, that was just one of the things i tried."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1505605976, "post_id": 46259379, "comment_id": 79482451, "body": "No. Been awhile since I&#39;ve written Haskell, but iirc, <code>any</code> is a function that takes a predicate and a list, and returns whether or not the predicate was true for any of the elements."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1505606009, "post_id": 46259379, "comment_id": 79482454, "body": "And <code>take 1</code> does do that, but you need to give it a list to take the first element of."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1505606067, "post_id": 46259379, "comment_id": 79482463, "body": "Using destructuring syntax would make this a lot cleaner."}, {"owner": {"reputation": 13, "user_id": 7824152, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-17ZWx3g0ZEQ/AAAAAAAAAAI/AAAAAAAAABA/313mncktaYU/photo.jpg?sz=128", "display_name": "Cheyanne", "link": "https://stackoverflow.com/users/7824152/cheyanne"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1505606667, "post_id": 46259379, "comment_id": 79482556, "body": "Okay so if I understand what I&#39;m doing wrong now, this is what I changed my function to:"}, {"owner": {"reputation": 13, "user_id": 7824152, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-17ZWx3g0ZEQ/AAAAAAAAAAI/AAAAAAAAABA/313mncktaYU/photo.jpg?sz=128", "display_name": "Cheyanne", "link": "https://stackoverflow.com/users/7824152/cheyanne"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1505606733, "post_id": 46259379, "comment_id": 79482569, "body": "<code>findMin list = if any (&lt; head list) list then findMin(tail) else take 1 list</code> and this is the error i&#39;m getting now:   haskell1.hs:14:1: error:     \u2022 Couldn&#39;t match type \u2018[a1]\u2019 with \u2018[a] -&gt; [a]\u2019       Expected type: ([a] -&gt; [a]) -&gt; [a1]         Actual type: [a1] -&gt; [a1]     \u2022 Relevant bindings include         findMin :: ([a] -&gt; [a]) -&gt; [a1] (bound at haskell1.hs:14:1)"}, {"owner": {"reputation": 13, "user_id": 7824152, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-17ZWx3g0ZEQ/AAAAAAAAAAI/AAAAAAAAABA/313mncktaYU/photo.jpg?sz=128", "display_name": "Cheyanne", "link": "https://stackoverflow.com/users/7824152/cheyanne"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1505607166, "post_id": 46259379, "comment_id": 79482632, "body": "Never mind. I just needed to give tail a list. Thank you for helping me through learning simple syntax."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1505741385, "post_id": 46259379, "comment_id": 79524006, "body": "Edit your original post rather than posting code in the comments (formatting is not supported in comments)."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1505650001, "post_id": 46259936, "comment_id": 79490655, "body": "+1 for the effort, but please don&#39;t recommend that list-comprehension solution. It&#39;s not idiomatic \u2013 <code>head</code> is shunned because partial...though actually you could get around by keeping the original <code>-&gt; [a]</code> signature and replacing it with <code>take 1</code> \u2013 and more importantly, it&#39;s horribly inefficient: you compare each element with <i>all</i> other elements, i.e. this has <i>O</i> (<i>n</i> &#178;) complexity rather than <i>O</i> (<i>n</i>)."}, {"owner": {"reputation": 661, "user_id": 7720738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HccZv.png?s=128&g=1", "display_name": "James Burton", "link": "https://stackoverflow.com/users/7720738/james-burton"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1505681664, "post_id": 46259936, "comment_id": 79500047, "body": "@leftaroundabout I appreciate the feedback. Just in case you didn&#39;t notice, before the definition using <code>head</code> I mentioned keeping the case for the empty list therefore as far as I&#39;m aware there is no possible way for head to fail here. Is it still bad to use it regardless?  Regarding the complexity, I realise it&#39;s bad but that wasn&#39;t really the point of the answer. I was more looking at the different ways you can think about the problem. If efficiency were relevant and this wasn&#39;t just about learning then there&#39;s no reason not to use the already existing <code>minimum</code> function."}, {"owner": {"reputation": 13, "user_id": 7824152, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-17ZWx3g0ZEQ/AAAAAAAAAAI/AAAAAAAAABA/313mncktaYU/photo.jpg?sz=128", "display_name": "Cheyanne", "link": "https://stackoverflow.com/users/7824152/cheyanne"}, "edited": false, "score": 0, "creation_date": 1505682308, "post_id": 46259936, "comment_id": 79500199, "body": "Thank you James, this was very helpful in explaining some of the basics of Haskell. I appreciate the time you took to show that."}, {"owner": {"reputation": 661, "user_id": 7720738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HccZv.png?s=128&g=1", "display_name": "James Burton", "link": "https://stackoverflow.com/users/7720738/james-burton"}, "reply_to_user": {"reputation": 13, "user_id": 7824152, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-17ZWx3g0ZEQ/AAAAAAAAAAI/AAAAAAAAABA/313mncktaYU/photo.jpg?sz=128", "display_name": "Cheyanne", "link": "https://stackoverflow.com/users/7824152/cheyanne"}, "edited": false, "score": 0, "creation_date": 1505683016, "post_id": 46259936, "comment_id": 79500411, "body": "@Cheyanne You&#39;re welcome, as someone pointed out in the comments, the list comprehension definition isn&#39;t very efficient so shouldn&#39;t really be used. The definition with guards should be ok but the most efficient is probably the definition of the already existing <code>minimum</code> function which is defined using folds."}], "tags": [], "owner": {"reputation": 661, "user_id": 7720738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HccZv.png?s=128&g=1", "display_name": "James Burton", "link": "https://stackoverflow.com/users/7720738/james-burton"}, "is_accepted": true, "score": 5, "last_activity_date": 1505612604, "creation_date": 1505612604, "answer_id": 46259936, "question_id": 46259379, "link": "https://stackoverflow.com/questions/46259379/haskell-syntax-with-functions-specifically-findmin-function/46259936#46259936", "title": "Haskell Syntax with functions, specifically findMin function", "body": "<p>I see that you've got things figured out in the comments but I'll add some things here hopefully to help. I also feel like I should quickly mention that Haskell already has a <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:minimum\" rel=\"noreferrer\"><code>minimum</code></a> function just in case anyone stumbles upon this who isn't just trying to learn the language and actually needs the function for something.</p>\n\n<p>First of all let's talk about types. I would normally expect a <code>findMin</code> style of function to return the minimum value rather than that value inside a list so the type will be:\n<code>findMin :: (Num a, Ord a) =&gt; [a] -&gt; a</code></p>\n\n<p>The things before <code>=&gt;</code> add context to the function type. This restricts all the things that <code>a</code> can be to only be things that have order (otherwise how can we find a minimum). Secondly <code>Num a</code> forces <code>a</code> to be a number, this is necessary because you specified that the case for the empty list should be 0.</p>\n\n<p>I'll explain 2 other ways to write the findMin function, trying to make them more concise than your definition (one of the benefits of Haskell is how concise it can be and I also find it helps when learning to see the multiple possibilities). The first will be using recursion and guards the second will be using a list comprehension.</p>\n\n<p>We can't do much with <code>findMin [] = 0</code> so we'll move onto the lists with stuff in them.</p>\n\n<p>We need to be careful with a recursive definition because eventually we will evaluate <code>findMin []</code> and always get 0 so we need to stop the recursion before that by defining a case for a single value:\n<code>findMin [x] = x</code></p>\n\n<p>When passing a list as an argument to a function you can separate out its elements and give them each a name so <code>(x:xs)</code> means a value <code>x</code> is the first element followed by a list of elements <code>xs</code>.</p>\n\n<p>For this definition we will define the first two elements on their own followed by the rest of the elements:</p>\n\n<pre><code>findMin (x:y:xs)\n    | x &lt; y = findMin (x:xs)\n    | otherwise = findMin (y:xs)\n</code></pre>\n\n<p>The guards allow us to have multiple definitions for the function depending on a condition. If <code>x &lt; y</code> we want to get rid of y as it cannot be the minimum so we find the minimum of <code>x</code> and the remaining elements, <code>xs</code>. If <code>x</code> is not smaller than <code>y</code> then the minimum value is either <code>y</code> or one of the values in <code>xs</code>.</p>\n\n<p>The second way to define this function is using a list comprehension (this is my favourite as it is particularly concise).</p>\n\n<p>We aren't using recursion so we don't need the case for one element we can keep our definition for an empty list and go straight to any list with elements:</p>\n\n<p><code>findMin xs = head [x | x &lt;- xs, all (&gt;= x) xs]</code></p>\n\n<p>So what's going on here? <code>[x | x &lt;- xs]</code> creates a list of <code>x</code> values where <code>x</code> is all the elements from <code>xs</code>. We then add a condition to say we only want those values if <code>all (&gt;= x) xs</code> meaning if all elements of <code>xs</code> are greater than or equal to <code>xs</code>.</p>\n\n<p>This results in a list of the minimum elements. This might have one element if the minimum occurs once or it may have several if it occurs multiple times. Either way they are all the same so we just take the first using <code>head</code>.</p>\n\n<p>Hope this helps and hope you have fun learning Haskell. Feel free to ask if you have any questions :)</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1505686775, "post_id": 46267909, "comment_id": 79501291, "body": "Um... I don&#39;t think SO answers are supposed to beg for feedback, but... here you go: <b>1.</b> don&#39;t use <code>length</code>. It&#39;s very expensive (needs to traverse the entire list). To check whether a list is empty, use <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Foldable.html#v:null\" rel=\"nofollow noreferrer\"><code>null</code></a> instead. But even better is pattern-matching right in the clause for <code>findMin</code>, i.e. seperate <code>findMin [] = ...</code> and <code>findMin (x:xs) = ...</code> <b>2.</b> avoid using <code>if...then...else</code>. Even when the boolean check can&#39;t be replaced with pattern-matching, guards usually look nicer than <code>if</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1505687049, "post_id": 46267909, "comment_id": 79501336, "body": "<b>3.</b> don&#39;t use <code>head</code> nor <code>tail</code>, these are partial functions (don&#39;t work on empty lists), i.e. it&#39;s very easy to make a mistake which will then lead to annoying runtime errors. This wouldn&#39;t be an issue if you had used pattern matching <code>findMin (x:xs) = ...</code>, because then the head/tail parts would simply not be in scope in the places where an empty list was matched. <b>4.</b> <code>findMin</code> is actually more efficient when implemented with <a href=\"https://en.wikipedia.org/wiki/Tail_call\" rel=\"nofollow noreferrer\">tail recursion</a>, but this isn&#39;t that critical."}], "tags": [], "owner": {"reputation": 3079, "user_id": 7395911, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddf10ef16bae6a76e43840f89995c12f?s=128&d=identicon&r=PG&f=1", "display_name": "Bernardo Duarte", "link": "https://stackoverflow.com/users/7395911/bernardo-duarte"}, "is_accepted": false, "score": 0, "last_activity_date": 1505675650, "creation_date": 1505675650, "answer_id": 46267909, "question_id": 46259379, "link": "https://stackoverflow.com/questions/46259379/haskell-syntax-with-functions-specifically-findmin-function/46267909#46267909", "title": "Haskell Syntax with functions, specifically findMin function", "body": "<p>In ghci this function seems to do your trick:</p>\n\n<pre><code>let findMin x = if length x &gt; 1 then min (head x) (findMin (tail x)) else head x\n</code></pre>\n\n<p>I'm learning as I try to answer some questions here, so any feedback would be appreciated.</p>\n"}], "owner": {"reputation": 13, "user_id": 7824152, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-17ZWx3g0ZEQ/AAAAAAAAAAI/AAAAAAAAABA/313mncktaYU/photo.jpg?sz=128", "display_name": "Cheyanne", "link": "https://stackoverflow.com/users/7824152/cheyanne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 46259936, "answer_count": 2, "score": -2, "last_activity_date": 1505675650, "creation_date": 1505604785, "question_id": 46259379, "link": "https://stackoverflow.com/questions/46259379/haskell-syntax-with-functions-specifically-findmin-function", "title": "Haskell Syntax with functions, specifically findMin function", "body": "<p>I'm struggling with the syntax with Haskell. It's very simple, but i'm stuck. </p>\n\n<p>I'm trying to write a findMin function that takes a list and finds the minimum. Here's my code, I have tried so many syntactical things that I'm up for any help I can get.</p>\n\n<pre><code>findMin [] = [0]\nfindMin list = if any &lt; head list then findMin(tail) else take 1\n</code></pre>\n\n<p>And i get all sorts of type errors. What is going wrong??</p>\n\n<p>(if it helps at all i have a background in object oriented programming)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505596596, "post_id": 46258464, "comment_id": 79480590, "body": "Don&#39;t you mean all but the last <i>four</i> elements?"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 7, "last_activity_date": 1505596966, "creation_date": 1505596966, "answer_id": 46258541, "question_id": 46258464, "link": "https://stackoverflow.com/questions/46258464/in-haskell-how-can-get-the-filename-without-the-file-extension/46258541#46258541", "title": "In Haskell, how can get the filename without the file extension?", "body": "<p>In case you want to eliminate the extension, I propose to use a library like <a href=\"http://hackage.haskell.org/package/filepath-1.4.1.2/docs/System-FilePath-Posix.html#v:takeBaseName\" rel=\"noreferrer\"><strong><code>System.FilePath.Posix</code></strong></a>:</p>\n\n<pre><code>import System.FilePath.Posix(takeBaseName)\n</code></pre>\n\n<p>Then you can use the <code>takeBaseName</code> function to obtain the basename of a filename:</p>\n\n<pre><code>Prelude&gt; import System.FilePath.Posix(takeBaseName)\nPrelude System.FilePath.Posix&gt; takeBaseName \"myfile.xml\"\n\"myfile\"\n</code></pre>\n\n<p>This solution works better, since it will also work on <code>\"file.gz\"</code> and <code>\"foo.7z\"</code>.</p>\n"}], "owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 609, "favorite_count": 0, "accepted_answer_id": 46258541, "answer_count": 1, "score": 5, "last_activity_date": 1505658856, "creation_date": 1505596278, "last_edit_date": 1505658856, "question_id": 46258464, "link": "https://stackoverflow.com/questions/46258464/in-haskell-how-can-get-the-filename-without-the-file-extension", "title": "In Haskell, how can get the filename without the file extension?", "body": "<p>Say I have a filename (a list of characters):  </p>\n\n<pre><code>\"myfile.xml\"\n</code></pre>\n\n<p>How can I get: </p>\n\n<pre><code>\"myfile\"\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1505591639, "post_id": 46257773, "comment_id": 79479254, "body": "The issue is more that <code>filter</code> is not monadic..."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505591691, "post_id": 46257773, "comment_id": 79479273, "body": "Write <code>let nonEmptyANames = filter (\\s -&gt; s &#47;= &quot;&quot;) anames</code>"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1505612500, "last_edit_date": 1505612500, "creation_date": 1505591785, "answer_id": 46257923, "question_id": 46257773, "link": "https://stackoverflow.com/questions/46257773/how-can-i-filter-a-list-in-haskell/46257923#46257923", "title": "How can I filter a list in Haskell?", "body": "<p><code>filter</code> has signature:</p>\n\n<pre><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>So it is not monadic. In that case you can use a <code>let</code> expression. You should replace <code>nonEmptyANames &lt;- filter (\\s -&gt; s /= \"\") anames</code> with:</p>\n\n<pre><code>    <b>let</b> nonEmptyANames <b>=</b> filter (\\s -&gt; s /= \"\") anames</code></pre>\n"}], "owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 46257923, "answer_count": 1, "score": 2, "last_activity_date": 1505612500, "creation_date": 1505590704, "question_id": 46257773, "link": "https://stackoverflow.com/questions/46257773/how-can-i-filter-a-list-in-haskell", "title": "How can I filter a list in Haskell?", "body": "<p>I'm a Haskell beginner, so apologies in advance. </p>\n\n<p>I'm parsing out some HTML values (<code>&lt;a name=\"value-to-extract\"&gt;</code>) using <a href=\"http://adit.io/posts/2012-04-14-working_with_HTML_in_haskell.html\" rel=\"nofollow noreferrer\">HXT</a> and haskell. I can get a list of <code>a name=\"\"</code> <code>name</code> values using this: </p>\n\n<pre><code>anames &lt;- runX $ parseHtml contents &gt;&gt;&gt; css \"a\" &gt;&gt;&gt; getAttrValue \"name\"\n</code></pre>\n\n<p>If I do this: </p>\n\n<pre><code>print anames\n</code></pre>\n\n<p>Then it prints this list:</p>\n\n<p><code>[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"2H_4_0001\",\"2HCH0001\",\"2HCH0002\",\"2HCH0003\",\"2HCH0004\",\"2HCH0005\",\"2HCH0006\",\"2HCH0007\",\"2HCH0008\",\"2HCH0009\",\"2HCH0010\",\"2HCH0011\",\"2HCH0012\",\"2HCH0013\",\"2HCH0014\",\"2HCH0015\",\"2HCH0016\",\"2HCH0017\",\"2HCH0018\",\"2HCH0019\",\"2HCH0020\",\"2HCH0021\",\"2HCH0022\",\"2HCH0023\",\"2HCH0024\",\"2HCH0025\",\"2HCH0026\",\"2HCH0027\",\"2HCH0028\",\"2HCH0029\",\"2HCH0030\",\"2HCH0031\",\"2H_4_0033\"]</code></p>\n\n<p>Now I want to remove all the entries that are <code>\"\"</code>. </p>\n\n<p>So I try                </p>\n\n<pre><code>nonEmptyANames &lt;- filter (\\s -&gt; s /= \"\") anames\n</code></pre>\n\n<p>But I get this error: </p>\n\n<pre><code>\u2022 Couldn't match type \u2018[]\u2019 with \u2018IO\u2019\n  Expected type: IO String\n    Actual type: [String]\n\u2022 In a stmt of a 'do' block:\n    nonEmptyANames &lt;- filter (\\ s -&gt; s /= \"\") anames\n</code></pre>\n\n<p>I think this is a typing problem, so I try: </p>\n\n<pre><code>putStrLn (\"type of aname is: \" ++ (show (typeOf anames)))\n</code></pre>\n\n<p>And it tells me that the type of <code>aname</code> is <code>[Char]</code>. If I try the filter command in ghci, it works as expected. What am I missing here? </p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505589930, "post_id": 46257655, "comment_id": 79478782, "body": "No uppercase types are real types. Whereas lowercase types are type variables."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1505654866, "post_id": 46257655, "comment_id": 79491972, "body": "If that&#39;s the actual code, then <code>undefined</code> is, in some sense, the only valid definition for <code>func</code>. <code>B</code> isn&#39;t inhabited, so there is no way to return a value of <code>B</code> from <code>func</code>. (For that matter, there is no way to call <code>func</code> either, since there aren&#39;t any values of <code>A</code> to provide as an argument.)"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1505590277, "creation_date": 1505590277, "answer_id": 46257710, "question_id": 46257655, "link": "https://stackoverflow.com/questions/46257655/haskell-defined-types/46257710#46257710", "title": "Haskell defined types", "body": "<p>No, (concrete) <strong>types start with an Uppercase</strong>. So <code>A -&gt; B</code> means the types <code>A</code> and <code>B</code> you have defined (well not defined here) with your <code>data A = ...</code> expressions, like for instance:</p>\n\n<pre><code>data A = Foo | Bar Int | Qux String A\n</code></pre>\n\n<p>In case the signature contains an identifier with a <strong>lowercase</strong>, it is a <strong>type variable</strong>. For instance <code>foo :: a -&gt; b</code>, means <code>a</code> and <code>b</code> can be substuted by any type. So <code>foo</code> is a function that can be <code>A -&gt; B</code>, but also <code>A -&gt; Int</code>, <code>Char -&gt; B</code>, and <code>Char -&gt; Int</code>.</p>\n\n<p>You can also add <strong>type constraints</strong> to the signature to restrict the types for which for instance <code>a</code> and <code>b</code> can be used. Like <code>foo :: (Show a, Num b) =&gt; a -&gt; b</code> restricts <code>a</code> and <code>b</code>, such that there should exist an <code>instance Show a</code> and <code>instance Num b</code> for the types <code>a</code> and <code>b</code> such that <code>foo</code> is defined over these types.</p>\n"}, {"comments": [{"owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 2, "creation_date": 1505673191, "post_id": 46266610, "comment_id": 79497582, "body": "That doesn&#39;t do what you probably think it does. The <code>a</code> in the <code>where</code> is shadowing the function parameter <code>a</code>. They are different variables with the same name. The <code>a</code> that is the function parameter is of type <code>A</code>, whereas the one defined in the <code>where</code> and returned from the function is of type <code>B</code>. This is because it is defined to evaluate to <code>b</code> which is in turn defined as <code>undefined</code>. And undefined can take on (pretty much) any type. So this is just a fancy way of writing <code>funcAJ a = undefined</code>."}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 0, "creation_date": 1506094046, "post_id": 46266610, "comment_id": 79695993, "body": "Ok. Thanks, but had high hopes I figured it out. I am lost now. Can you pose a function that type-checks and is correct?"}, {"owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 0, "creation_date": 1506231346, "post_id": 46266610, "comment_id": 79731671, "body": "Unless you give your types <code>A</code> and <code>B</code> some data constructors <code>undefined</code> (or other constructs that return bottom) is the only possible implementation for a function of type <code>A -&gt; B</code>."}], "tags": [], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "is_accepted": false, "score": -2, "last_activity_date": 1505667699, "creation_date": 1505667699, "answer_id": 46266610, "question_id": 46257655, "link": "https://stackoverflow.com/questions/46257655/haskell-defined-types/46266610#46266610", "title": "Haskell defined types", "body": "<p>Thanks Willem, Chepner. Your answers helped me out to conjure up:</p>\n\n<pre><code>data A\ndata B\nfuncAJ :: A -&gt; B\nfuncAJ a = a\n       where a = b\n             b = undefined\n</code></pre>\n\n<p>This typechecks as funcAJ :: A -> B, which I understand. Thanks so much!</p>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1505667699, "creation_date": 1505589859, "last_edit_date": 1505589910, "question_id": 46257655, "link": "https://stackoverflow.com/questions/46257655/haskell-defined-types", "title": "Haskell defined types", "body": "<p>Studying Haskell first principles. Absolute beginner in Haskell. \nIf: </p>\n\n<pre><code>data A\ndata B\nfunc :: A -&gt; B\nfunc = undefined\n</code></pre>\n\n<p>What would the actual function be? Worked though load of exercises with great result (also thanks to you) but again I am stuck. Does A -> B indicate two different types like 'String' -> 'Char'? Just trying to wrap my head around it. </p>\n"}, {"tags": ["haskell", "types", "typeclass"], "answers": [{"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 8, "last_activity_date": 1505582240, "creation_date": 1505582240, "answer_id": 46256470, "question_id": 46256367, "link": "https://stackoverflow.com/questions/46256367/haskell-type-confusion-couldnt-match-the-expected-type-despite-either-or-relat/46256470#46256470", "title": "Haskell type confusion; Couldn&#39;t match the expected type despite either/or relationship", "body": "<pre><code>data Command        =   ServerCommand | ClientCommand\n</code></pre>\n\n<p>This doesn't do what you think it does. (Hint: compare with <code>data Bool = True | False</code>, contemplate the difference.)</p>\n\n<p>If you want a data type that can store either a <code>ServerCommand</code> or a <code>ClientCommand</code>, you can use a library type</p>\n\n<pre><code>type Command = Either ServerCommand ClientCommand\n</code></pre>\n\n<p>or create your own</p>\n\n<pre><code>data Command = S ServerCommand | C ClientCommand\n</code></pre>\n\n<p>While we're at it, consider redesigning your data along the lines of</p>\n\n<pre><code>data ClientCommand = SEND String |\n                     DISCONNECT |\n                     CONNECT\n</code></pre>\n\n<p>and dropping the <code>Frame</code> thing altogether.</p>\n"}], "owner": {"reputation": 961, "user_id": 2353196, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65de4e83806a99f3948073a0711c7a9c?s=128&d=identicon&r=PG", "display_name": "wickstopher", "link": "https://stackoverflow.com/users/2353196/wickstopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 46256470, "answer_count": 1, "score": 3, "last_activity_date": 1505582240, "creation_date": 1505581550, "question_id": 46256367, "link": "https://stackoverflow.com/questions/46256367/haskell-type-confusion-couldnt-match-the-expected-type-despite-either-or-relat", "title": "Haskell type confusion; Couldn&#39;t match the expected type despite either/or relationship", "body": "<p>I'm having some trouble figuring out why the below code isn't working. I would expect that since the <code>Command</code> data type is either a <code>ServerCommand</code> or a <code>ClientCommand</code> that any type constructor that is expecting a <code>Command</code> would be able to accept one or the other. I seem to have a fundamental misunderstanding of how these datatypes should be lining up.</p>\n\n<pre><code>data ClientCommand  =   SEND |\n                        DISCONNECT |\n                        CONNECT\n\ndata ServerCommand  =   CONNECTED |\n                        MESSAGE |\n                        RECEIPT |\n                        ERROR\n\ndata Command        =   ServerCommand | ClientCommand\n\ntype Frame          =   (Command, Maybe String)\n\nmakeConnect :: Frame\nmakeConnect = (CONNECT, (Just \"hello!\"))\n</code></pre>\n\n<p>When I try to load this code into ghci, I get the following error: </p>\n\n<pre><code>GHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( Frames.hs, interpreted )\n\nFrames.hs:15:16:\n\n    Couldn't match expected type \u2018Command\u2019\n                with actual type \u2018ClientCommand\u2019\n    In the expression: CONNECT\n    In the expression: (CONNECT, (Just \"hello!\"))\nFailed, modules loaded: none.\n</code></pre>\n"}, {"tags": ["haskell", "c2hs"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1505580843, "post_id": 46256090, "comment_id": 79476054, "body": "What&#39;s the problem? Import it with <code>foreign import</code> as well."}], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 5532935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f9f7776476d9787e71931078a981718?s=128&d=identicon&r=PG&f=1", "display_name": "uuhan", "link": "https://stackoverflow.com/users/5532935/uuhan"}, "edited": false, "score": 0, "creation_date": 1505611158, "post_id": 46257582, "comment_id": 79483186, "body": "Well, <b>getStderr &gt;&gt;= func</b> is another workaround for my need, but I think it would be better to  keep the finalizer and do the dirty work in c functions. I mean, I dont need to import stderr from c, beacuse it seems it is a variable exists in <b>linkage</b> (extern FILE* __stderrp), not just a normal c const, I mean I can not use something like <b>stderr = {#const stderr#}</b>"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 1, "last_activity_date": 1505589367, "creation_date": 1505589367, "answer_id": 46257582, "question_id": 46256090, "link": "https://stackoverflow.com/questions/46256090/haskell-how-to-work-with-extern-file-from-c/46257582#46257582", "title": "Haskell how to work with extern FILE* from c?", "body": "<p>It's not unusual to require some kind of \"shim\" when writing FFI code for Haskell, and I'd encourage you to just write a helper function:</p>\n\n<pre><code>FILE* get_stderr() { return stderr; }\n</code></pre>\n\n<p>and use that (see example at the bottom of this answer).</p>\n\n<p>However, I was able to get the following minimal example to work by using the vanilla FFI's support for static pointers -- it doesn't import <code>stderr</code> directly, but imports a pointer <em>to</em> the <code>stderr</code> pointer.  This kind of import is not directly supported by c2hs, so the interface code is ugly, and I don't think there's any way to avoid having to fetch the <code>stderr</code> pointer value in the IO monad, independent of whether or not you use c2hs.</p>\n\n<pre><code>// file.h\n#include &lt;stdio.h&gt;\nvoid func(FILE*);\n\n// file.c\n#include \"file.h\"\nvoid func(FILE *f) {\n    fputs(\"Output to stderr!\\n\", f);\n}\n\n// File.chs\n\n{-# LANGUAGE ForeignFunctionInterface #-}\n\nmodule Main where\n\nimport Foreign   \n\n#include \"file.h\"    \n{#pointer *FILE as File newtype#}\n{#fun func as ^ { `File' } -&gt; `()'#}\n\nforeign import ccall \"&amp;stderr\" stderr_ptr :: Ptr (Ptr File)    \n\nmain :: IO ()\nmain = do stderr &lt;- File &lt;$&gt; peek stderr_ptr\n          func stderr\n</code></pre>\n\n<p>For comparison, this minimal example with the helper function looks much cleaner at the Haskell level:</p>\n\n<pre><code>// file.h\n#include &lt;stdio.h&gt;\nvoid func(FILE*);\nFILE* get_stderr(void);\n\n// file.c\n#include \"file.h\"\nvoid func(FILE *f) {\n    fputs(\"Output to stderr!\\n\", f);\n}\nFILE* get_stderr(void) {return stderr; }\n\n// File.chs\n{-# LANGUAGE ForeignFunctionInterface #-}\n\nmodule Main where\n\n#include \"file.h\"    \n{#pointer *FILE as File newtype#}\n{#fun func as ^ { `File' } -&gt; `()'#}\n{#fun pure get_stderr as ^ {} -&gt; `File'#}\n\nmain :: IO ()\nmain = func getStderr\n</code></pre>\n\n<p>Note that in both these examples, I removed your <code>fclose</code> finalizer.  You probably don't want Haskell arbitrarily deciding it's a good time to close <code>stderr</code> on you.</p>\n"}, {"tags": [], "owner": {"reputation": 113, "user_id": 5532935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f9f7776476d9787e71931078a981718?s=128&d=identicon&r=PG&f=1", "display_name": "uuhan", "link": "https://stackoverflow.com/users/5532935/uuhan"}, "is_accepted": false, "score": 0, "last_activity_date": 1505619819, "creation_date": 1505619819, "answer_id": 46260430, "question_id": 46256090, "link": "https://stackoverflow.com/questions/46256090/haskell-how-to-work-with-extern-file-from-c/46260430#46260430", "title": "Haskell how to work with extern FILE* from c?", "body": "<p>With c2hs of version 0.28.2, the following code works:</p>\n\n<pre><code>-- lib.chs\n{#pointer *FILE as File newtype#}\nforeign import ccall \"stdio.h &amp;__stderrp\" c_stderr :: Ptr (Ptr File) -- can not just use \"stdio.h &amp;stderr\", this may cause a reference error\n\n-- main.hs\nstderr &lt;- File &lt;$&gt; peek c_stderr\nfunc stderr\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 5532935, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/5f9f7776476d9787e71931078a981718?s=128&d=identicon&r=PG&f=1", "display_name": "uuhan", "link": "https://stackoverflow.com/users/5532935/uuhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "closed_date": 1505838426, "accepted_answer_id": 46257582, "answer_count": 2, "score": 0, "last_activity_date": 1505619819, "creation_date": 1505579656, "last_edit_date": 1505584248, "question_id": 46256090, "link": "https://stackoverflow.com/questions/46256090/haskell-how-to-work-with-extern-file-from-c", "closed_reason": "Needs details or clarity", "title": "Haskell how to work with extern FILE* from c?", "body": "<p>I want to foreign import a function from some c header, but how to deal with the stderr of type FILE* which defined as:</p>\n\n<pre><code>extern FILE* __stderrp;\n#define stderr __stderrp\n</code></pre>\n\n<p>Maybe not precisely. I use c2hs for my ffi work, and already have: </p>\n\n<pre><code>{#pointer *FILE as File foreign finalizer fclose newtype#}\n</code></pre>\n\n<p>but I can not import stderr like this: </p>\n\n<pre><code>foreign import ccall \"stdio.h stderr\" stderr :: File\n</code></pre>\n\n<p>My c function has the signature:</p>\n\n<pre><code>void func(FILE*);\n</code></pre>\n\n<p>I can import func with c2hs:</p>\n\n<pre><code>{#fun func as ^ {`File'} -&gt; `()'#}\n</code></pre>\n\n<p>I need to use stderr to run func:</p>\n\n<pre><code>func(stderr);\n</code></pre>\n\n<p>I am noob with the foreign import mechanism. It seems I can not import stderr in this way.</p>\n\n<p>ps. Maybe I would wrap my func in a new function</p>\n\n<pre><code>void func2(void){func(stderr);}\n</code></pre>\n\n<p>This is a workaround, but seems not clean.</p>\n"}, {"tags": ["haskell", "syntax", "functional-programming"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 9, "creation_date": 1505546231, "post_id": 46250923, "comment_id": 79466167, "body": "Are the <code>&amp;gt;</code> intentional? If not - that is the problem. <code>&amp;gt;</code> is the HTML for <code>&gt;</code>. The type signature should be <code>(RealFloat a) =&gt; a -&gt; a -&gt; a</code>."}, {"owner": {"reputation": 353, "user_id": 5151962, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81e8d7186e57e2ab4dcd4e6dd9dc03de?s=128&d=identicon&r=PG&f=1", "display_name": "soulless", "link": "https://stackoverflow.com/users/5151962/soulless"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1505547946, "post_id": 46250923, "comment_id": 79466583, "body": "oh... you are right, I was reading the pdf version which has retained the html symbols... sorry for my ignorance. Thank you so much"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1505556142, "post_id": 46250923, "comment_id": 79468706, "body": "Fix the HTML syntax with proper <code>=&gt;</code> and <code>-&gt;</code>. Also note that indentation is important, <code>sideArea</code> and <code>topArea</code> must start on the same column, and the whole function body must be more indented."}], "answers": [{"tags": [], "owner": {"reputation": 1698, "user_id": 4050510, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3123195051caa2f71674df0798284b0?s=128&d=identicon&r=PG", "display_name": "LudvigH", "link": "https://stackoverflow.com/users/4050510/ludvigh"}, "is_accepted": true, "score": 2, "last_activity_date": 1505566822, "last_edit_date": 1505566822, "creation_date": 1505565982, "answer_id": 46254067, "question_id": 46250923, "link": "https://stackoverflow.com/questions/46250923/haskell-syntax-confusion-function-type-declaration/46254067#46254067", "title": "haskell syntax confusion -- function type declaration", "body": "<p>HTML character entities are denoted <code>&amp;xxx;</code> where <code>xxx</code> is some valid HTML character code. In specific, <code>&amp;gt;</code> is the code for the character <code>&gt;</code>, since it means \"greater than\". </p>\n\n<p>Assuming there is a HTML mistake in the question, the type declaration becomes </p>\n\n<pre><code>cylinder :: (RealFloat a) =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<blockquote>\n  <p>what does it do?</p>\n</blockquote>\n\n<p>You read it out like \"assuming <code>a</code> is an instance of the type class <code>RealFloat</code>, <code>cylinder</code> takes two values of type <code>a</code> and returns a value of type <code>a</code>.  You might want to look into the term \"currying\" to read these declarations. </p>\n\n<p>What it does is to declare the function type. </p>\n\n<blockquote>\n  <p>why semicolons?</p>\n</blockquote>\n\n<p>There are no semicolons in the actual type declaration. </p>\n"}], "owner": {"reputation": 353, "user_id": 5151962, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/81e8d7186e57e2ab4dcd4e6dd9dc03de?s=128&d=identicon&r=PG&f=1", "display_name": "soulless", "link": "https://stackoverflow.com/users/5151962/soulless"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "closed_date": 1505566813, "accepted_answer_id": 46254067, "answer_count": 1, "score": 0, "last_activity_date": 1505566822, "creation_date": 1505544061, "last_edit_date": 1505556231, "question_id": 46250923, "link": "https://stackoverflow.com/questions/46250923/haskell-syntax-confusion-function-type-declaration", "closed_reason": "Not suitable for this site", "title": "haskell syntax confusion -- function type declaration", "body": "<p>I am trying to learn haskell by going through the learn you a haskell book. I came across a function which confuses me a bit and would like to look for an explanation. This function is rather straightforward. What I don't understand is the first line when declaring the function type. What does ( RealFloat a) =&amp; gt; a -&gt; a -&gt; a do? why are they separated by semicolons?</p>\n\n<p>Thanks a lot in advance.</p>\n\n<pre><code>cylinder :: ( RealFloat a) =&amp; gt; a -&amp;gt; a -&amp;gt; a\ncylinder r h =\n    let sideArea = 2 * pi * r * h\n        topArea = pi * r ^2\n    in sideArea + 2 * topArea\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "stackage", "hoogle"], "answers": [{"comments": [{"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 1, "creation_date": 1505586346, "post_id": 46250855, "comment_id": 79477706, "body": "+1 For answering the second question. But is there a solution besides a manual search, or cloning the repo and using <code>git grep</code>?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "edited": false, "score": 1, "creation_date": 1505599169, "post_id": 46250855, "comment_id": 79481180, "body": "Unfortunately I don&#39;t have any alternative method to suggest."}, {"owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "edited": false, "score": 0, "creation_date": 1505660369, "post_id": 46250855, "comment_id": 79493580, "body": "The general solution is to use the changelog, but unfortunately this package lacks one."}, {"owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "reply_to_user": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "edited": false, "score": 0, "creation_date": 1505667085, "post_id": 46250855, "comment_id": 79495581, "body": "@NeilMitchell I&#39;ll be damned if it isn&#39;t the author of Hoogle. Any chance we could get support for this?"}, {"owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "edited": false, "score": 1, "creation_date": 1505937929, "post_id": 46250855, "comment_id": 79622603, "body": "I suspect a solution would look very similar to <a href=\"https://stackoverflow.com/questions/45970886/hoogle-git-repository\" title=\"hoogle git repository\">stackoverflow.com/questions/45970886/hoogle-git-repository</a>. It&#39;s a shame <a href=\"http://hdiff.luite.com/\" rel=\"nofollow noreferrer\">hdiff.luite.com</a> doesn&#39;t provide something - if it diff&#39;d just the module signatures that might give you what you want."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 3, "last_activity_date": 1505543545, "creation_date": 1505543545, "answer_id": 46250855, "question_id": 46250360, "link": "https://stackoverflow.com/questions/46250360/how-do-you-search-across-library-versions-in-haskell/46250855#46250855", "title": "How do you search across library versions in Haskell?", "body": "<p><code>WindowValue</code> was last seen in <a href=\"https://hackage.haskell.org/package/GLFW-b-0.1.0.5\" rel=\"nofollow noreferrer\">GLFW-b-0.1.0.5</a>.</p>\n\n<p>I don't understand what is up with the version bounds in gloss, they somehow require GLFW-b \u2265 1.4.1, which makes no sense.</p>\n"}], "owner": {"reputation": 1545, "user_id": 2670439, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/wFcPA.jpg?s=128&g=1", "display_name": "SwiftsNamesake", "link": "https://stackoverflow.com/users/2670439/swiftsnamesake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 46250855, "answer_count": 1, "score": 3, "last_activity_date": 1505543545, "creation_date": 1505539280, "question_id": 46250360, "link": "https://stackoverflow.com/questions/46250360/how-do-you-search-across-library-versions-in-haskell", "title": "How do you search across library versions in Haskell?", "body": "<p>How do you find out which version(s) of a particular library includes a given definition? In my case, I noticed that <code>gloss</code> fails to install with the GLFW backend...</p>\n\n<pre><code>Graphics\\Gloss\\Internals\\Interface\\Backend\\GLFW.hs:12:45: error:\n    Module `Graphics.UI.GLFW' does not export `WindowValue(..)'\ncabal: Leaving directory 'C:\\Users\\Jonatan\\AppData\\Local\\Temp\\cabal-tmp-\n22520\\gloss-1.11.1.1'\n</code></pre>\n\n<p>... so I'd like to find out when <code>WindowValue</code> was removed. I've tried Hoogle, Stackage and Hayoo, with no luck.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 6, "creation_date": 1505521296, "post_id": 46248895, "comment_id": 79462090, "body": "You need parentheses <code>Data.Vector.zip (fromList[1..10]) (fromList[2..11])</code> otherwise you&#39;re passing 4 parameters to <code>zip</code> instead of 2."}, {"owner": {"reputation": 429, "user_id": 796557, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/2807764ba0f590416c540c55a960e9a9?s=128&d=identicon&r=PG&f=1", "display_name": "elliptic00", "link": "https://stackoverflow.com/users/796557/elliptic00"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1505521630, "post_id": 46248895, "comment_id": 79462156, "body": "Awesome:), I have scratched my head for an hour."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1505556216, "last_edit_date": 1505556216, "creation_date": 1505555229, "answer_id": 46252493, "question_id": 46248895, "link": "https://stackoverflow.com/questions/46248895/haskell-can-not-resolve-type-issue-data-vector-zip-fromlist1-10-fromlist1/46252493#46252493", "title": "Haskell, can not resolve type issue: Data.Vector.zip fromList[1..10] fromList[1..10]", "body": "<p>First, let's</p>\n\n<pre><code>import qualified Data.Vector as V\n</code></pre>\n\n<p>to avoid having to type out <code>Data.Vector.zip</code>.</p>\n\n<hr>\n\n<p>Haskell's parsing rules often stump beginners, but frankly I think this is more because they're too <em>simple</em> rather than too strange. In brief:</p>\n\n<ol>\n<li>parentheses / brackets <em>only group their contents</em>, they never influence anything outside. So, <code>f(x)</code>, <code>(f)x</code> and <code>(f) (x)</code> are all the same, preferrably written just <code>f x</code>.</li>\n<li>Infix operators<sup>\u2020</sup> bind less tightly than any function application.</li>\n<li>Function application greedily gathers everything from left to right.</li>\n</ol>\n\n<p>How much whitespace you put between two tokens is not considered by the parser at all.</p>\n\n<p>So in your example, we can</p>\n\n<ol>\n<li><p>give the list definitions local names:</p>\n\n<pre><code>l\u2081 = [1..10]\nl\u2082 = [2..11]\nv = V.zip fromList l\u2081 fromList l\u2082\n</code></pre></li>\n<li><p>There are no infix operators here<sup>\u2020</sup>.</p></li>\n<li><p>Greedily gather arguments:</p>\n\n<pre><code>v = (V.zip fromList) l\u2081 fromList l\u2082\n  = ((V.zip fromList) l\u2081) fromList l\u2082\n  = (((V.zip fromList) l\u2081) fromList) l\u2082\n</code></pre>\n\n<p>Un-curried languages would write this as <code>zip(fromList, l\u2081, fromList, l\u2082)</code>, and that's clearly not what you want.</p></li>\n</ol>\n\n<p>The most direct way to get around this is to parenthesise:</p>\n\n<pre><code>v = V.zip (fromList [1..10]) (fromList [2..11])\n</code></pre>\n\n<p>...or give the packed vectors names of their own</p>\n\n<pre><code>v\u2081 = fromList [1..10]\nv\u2082 = fromList [2..11]\nv = V.zip l\u2081 l\u2082\n</code></pre>\n\n<p>...or avoid writing <code>fromList</code> entirely:</p>\n\n<pre><code>{-# LANGUAGE OverloadedLists #-}\n\nv :: V.Vector Int\nv = V.zip [1..10] [2..11]\n</code></pre>\n\n<hr>\n\n<p><sup>\u2020</sup><sub>You may wonder what's up with the <code>.</code> in <code>Data.Vector.zip</code>. That's not the infix operator <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:-46-\" rel=\"nofollow noreferrer\"><code>.</code></a> but the <em>module qualifier symbol</em>. This is one of only two \u201cinfix symbols\u201d with a special parsing rule (the other being the unary minus): anything of the form <code>Foo.bar</code> (with uppercase <code>Foo</code> and no whitespace!) is recognised as a single token <code>bar</code> coming from module <code>Foo</code>.</sub></p>\n"}], "owner": {"reputation": 429, "user_id": 796557, "user_type": "registered", "accept_rate": 5, "profile_image": "https://www.gravatar.com/avatar/2807764ba0f590416c540c55a960e9a9?s=128&d=identicon&r=PG&f=1", "display_name": "elliptic00", "link": "https://stackoverflow.com/users/796557/elliptic00"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1505556216, "creation_date": 1505520972, "last_edit_date": 1505521463, "question_id": 46248895, "link": "https://stackoverflow.com/questions/46248895/haskell-can-not-resolve-type-issue-data-vector-zip-fromlist1-10-fromlist1", "title": "Haskell, can not resolve type issue: Data.Vector.zip fromList[1..10] fromList[1..10]", "body": "<p>When I run</p>\n\n<pre><code>let v = Data.Vector.zip fromList[1..10] fromList[2..11]\n</code></pre>\n\n<p>I got error:</p>\n\n<p>Couldn't match expected type \u2018Vector b0\u2019\n                  with actual type \u2018[Integer]\u2019</p>\n\n<p>Instead I have to do like that:</p>\n\n<pre><code>let v1 = fromList[1..10]\nlet v2 = fromList[2..11]\nlet v = Data.Vector.zip v1 v2\n</code></pre>\n\n<p>fromList is Vector type in Data.Vector</p>\n\n<p>Can anyone explain to me why fromList[1..10] can not be converted to Vector type in Data.Vector? and I have to create v1 and v2?</p>\n"}, {"tags": ["json", "haskell", "functional-programming", "request", "wreq"], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 4, "last_activity_date": 1505487755, "creation_date": 1505487755, "answer_id": 46242584, "question_id": 46242004, "link": "https://stackoverflow.com/questions/46242004/parsing-json-haskell/46242584#46242584", "title": "Parsing JSON haskell", "body": "<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Lens\nimport Network.Wreq\nimport Data.Aeson.Lens\n\nimport Data.HashMap.Lazy (HashMap)\nimport Data.Text (Text)\n\nmain = do\n  r &lt;- asValue =&lt;&lt; get \"https://bittrex.com/api/v1.1/public/getticker?market=BTC-LTC\"\n  let result =\n        (r :: Response Value)\n          -- get the Value out of the Response\n          ^? responseBody\n          -- The Value must be an Object, then unwrap the contained (HashMap Text Value)\n          . _Object\n          -- In the map {\"message\": ..., \"result\": ...}, get the \"result\".\n          . ix \"result\"\n          -- This must be an Object, unwrap the (HashMap Text Value)\n          . _Object\n  print (result :: HashMap Text Value)\n\n-- How types line up:\n--\n-- responseBody . _Object . ix \"result\" . _Object\n--         :: Traversal' (Response Value)                                  (HashMap Text Value)\n\n--\n-- responseBody :: Lens' (Response Value) Value\n-- _Object      ::             Traversal' Value (HashMap Text Value)\n-- ix \"result\"  ::                   Traversal' (HashMap Text Value) Value\n-- _Object      ::                                        Traversal' Value (HashMap Text Value)\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 6651168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2b45f362ea8f2d6346f9008a1df0afff?s=128&d=identicon&r=PG&f=1", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/6651168/jimbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1505487755, "creation_date": 1505485816, "question_id": 46242004, "link": "https://stackoverflow.com/questions/46242004/parsing-json-haskell", "title": "Parsing JSON haskell", "body": "<p>I am trying to access the inner <code>Object</code> in my request. This is my code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\n\nimport Network.Wreq\nimport Control.Lens\nimport Data.Aeson\n\nimport Data.Map as Map\n\ntype Resp = Response (Map String Value)\n\n\nmain = do\n    r &lt;- asJSON =&lt;&lt; get \"https://bittrex.com/api/v1.1/public/getticker?market=BTC-LTC\" :: IO Resp\n    let result = (r ^. responseBody)    \n    print result\n</code></pre>\n\n<p>This is my result:</p>\n\n<pre><code>fromList [(\"message\",String \"\"),(\"result\",Object (fromList [(\"Bid\",Number 1.441e-2),(\"Ask\",Number 1.44101e-2),(\"Last\",Number 1.441e-2)])),(\"success\",Bool True)]\n</code></pre>\n\n<p>I am trying to access the \"result\" key's Object and then access the values inside of there. I'm not sure how to do it, I've messed around with AESON and <code>^?</code> operator that <code>wreq</code> provides but it's not working for me.</p>\n"}, {"tags": ["haskell", "search"], "comments": [{"owner": {"reputation": 464, "user_id": 3825556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7ajzp.png?s=128&g=1", "display_name": "Cirquit", "link": "https://stackoverflow.com/users/3825556/cirquit"}, "edited": false, "score": 1, "creation_date": 1505484382, "post_id": 46239759, "comment_id": 79446894, "body": "In your solution you don&#39;t save any time by precomputing the sum and sorting the lists based on that, because you do it twice anyway (in <code>sortOn (Down . sum)</code> and in your predicate <code>search ((&lt;25) . sum))</code>. I&#39;m guessing that <code>sum</code> is your expensive part of the computation. What do you mean by descending order? The lists sum sorted by descending order?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1505484645, "post_id": 46239759, "comment_id": 79447060, "body": "<code>foldr (\\xs yss -&gt; (:) &lt;$&gt; xs &lt;*&gt; yss) [[]]</code> is more idiomatically spelled <code>sequence</code>."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1505485163, "post_id": 46239759, "comment_id": 79447408, "body": "@DanielWagner Yes, thank you!"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 464, "user_id": 3825556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7ajzp.png?s=128&g=1", "display_name": "Cirquit", "link": "https://stackoverflow.com/users/3825556/cirquit"}, "edited": false, "score": 0, "creation_date": 1505485463, "post_id": 46239759, "comment_id": 79447625, "body": "@Cirquit &gt;&gt; The lists sum sorted by descending order? - Yes! Calculating the sum isn&#39;t a problem for my domain, the real predicate does not compute it, it&#39;s just an example."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 464, "user_id": 3825556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7ajzp.png?s=128&g=1", "display_name": "Cirquit", "link": "https://stackoverflow.com/users/3825556/cirquit"}, "edited": false, "score": 0, "creation_date": 1505485758, "post_id": 46239759, "comment_id": 79447800, "body": "@Cirquit - The predicate calculation is much longer than the sum."}, {"owner": {"reputation": 464, "user_id": 3825556, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/7ajzp.png?s=128&g=1", "display_name": "Cirquit", "link": "https://stackoverflow.com/users/3825556/cirquit"}, "edited": false, "score": 1, "creation_date": 1505486734, "post_id": 46239759, "comment_id": 79448369, "body": "I&#39;m still a little confused by the problem domain. How do you want to have a list in descending order, without sorting it? You want <code>search</code> to traverse the list in descending order based on another predicate (in your case <code>Down . sum</code>), while filtering for the initial predicate <code>(&lt;25 . sum)</code>. If that&#39;s the case, I don&#39;t think that there&#39;s a possibility to do that. If performance is an issue, you might consider to enforce strictness with the pragma <code>{-# LANGUAGE BangPatterns #-}</code>, and try this <code>let !sorted = (sortOn (Down . sum) . sequence) [[10,2], [10,8,6], [8]] in find ((&lt;25) . sum) sorted</code>"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1505491836, "post_id": 46243650, "comment_id": 79451278, "body": "By the way, this was a fun problem! I ended up with at least five or six failed attempts before hitting on this one."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1505497023, "post_id": 46243650, "comment_id": 79453904, "body": "Thank you very much! I&#39;ll try to understand your solution. It&#39;s look like should to work. And, If I want to generalize. Is it enough that the constituent elements are from the set on which the Group or Ring or Field is formed? So, what kind an algebraic structure should be?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1505497981, "post_id": 46243650, "comment_id": 79454373, "body": "@freestyle I think the only thing this algorithm assumes about the structure is what I said in the last paragraph: that <code>x&lt;y</code> implies <code>total+x&lt;total+y</code> (and that <code>0</code> exists, of course)."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1505553431, "post_id": 46243650, "comment_id": 79467885, "body": "if I understand correctly, <code>increasingSums = map snd . go . map sort</code> can be simplify to <code>increasingSums = map snd . go</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1505589537, "post_id": 46243650, "comment_id": 79478654, "body": "@freestyle Oops, yes, I&#39;m doing some redundant sorting. You can either remove the <code>map sort</code> from <code>increasingSums</code> or remove the <code>sortOn (f . head)</code> from <code>mergeOn</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1505493921, "last_edit_date": 1505493921, "creation_date": 1505491496, "answer_id": 46243650, "question_id": 46239759, "link": "https://stackoverflow.com/questions/46239759/reordering-the-search-space/46243650#46243650", "title": "Reordering the search space", "body": "<h1>The exact case described</h1>\n\n<p>In this exact case, there is a clear best element in the space, and if any element matches the predicate then the best one does:</p>\n\n<pre><code>-- I have, over the years, found many uses for ensure\nensure p x = x &lt;$ guard p x\nsearch p = ensure p . map minimum\n</code></pre>\n\n<h1><code>(&lt;25) . sum</code> is a placeholder, but <code>Down . sum</code> is exact</h1>\n\n<p>If your predicate is just an example, but your heuristic is really summing, you can use a priority queue to search through the space. For simplicity, I'll use <code>[(b,a)]</code> as my priority queue with priorities <code>b</code> and values <code>a</code>, maintaining the invariant that the list is sorted by <code>b</code>. Of course you should use a better implementation if you want efficiency.</p>\n\n<p>And now we basically just reimplement <code>sequence</code> to produce its elements in priority order and maintain the sum of the lists it produces as their priority. Introducing the priority queue invariant is a small one-time cost up front.</p>\n\n<pre><code>import Data.List\nimport Data.Ord\n\nincreasingSums :: (Ord a, Num a) =&gt; [[a]] -&gt; [[a]]\nincreasingSums = map snd . go . map sort where\n    go [] = [(0,[])]\n    go (xs:xss) = let recurse = go xss in mergeOn fst\n        [ [ (total+h, h:ts)\n          | (total, ts) &lt;- recurse\n          ]\n        | h &lt;- xs\n        ]\n</code></pre>\n\n<p>The only thing missing is <code>mergeOn</code>, which flattens a collection of priority queues into a single one:</p>\n\n<pre><code>mergeOn :: Ord b =&gt; (a -&gt; b) -&gt; [[a]] -&gt; [a]\nmergeOn f = go . sortOn (f . head) . filter (not . null) where\n    go [] = []\n    go ([x]:xss) = x : go xss\n    go ((x:xs):xss) = x : go (insertBy (comparing (f . head)) xs xss)\n</code></pre>\n\n<p>Testing in <code>ghci</code>, we can see that this expression finishes in a non-stupid amount of time:</p>\n\n<pre><code>&gt; take 10 . increasingSums . replicate 4 $ [1..1000]\n[[1,1,1,1],[2,1,1,1],[1,2,1,1],[1,1,2,1],[1,1,1,2],[2,1,1,2],[1,2,1,2],[1,1,2,2],[1,1,1,3],[2,1,2,1]]\n</code></pre>\n\n<p>Whereas this expression does not:</p>\n\n<pre><code>&gt; take 10 . sortOn sum . sequence . replicate 4 $ [1..1000]\n^C^C^C^COMG how do I quit\n</code></pre>\n\n<p>Meanwhile it is also competitive for producing the complete list of sums in sorted order (at least before compilation, I didn't test whether the optimized versions are also about equal):</p>\n\n<pre><code>&gt; :set +s\n&gt; sum . map sum . increasingSums . replicate 4 $ [1..30]\n50220000\n(1.99 secs, 1,066,135,432 bytes)\n&gt; sum . map sum . sortOn sum . sequence . replicate 4 $ [1..30]\n50220000\n(2.60 secs, 2,226,497,344 bytes)\n</code></pre>\n\n<h1><code>Down . sum</code> is a placeholder</h1>\n\n<p>Finally, if your heuristic is just an example, and you want a fully general solution that will work for all heuristics, you're out of luck. Doing a structured walk through your search space requires knowing something special about that structure to exploit. (For example, above we know that if <code>x&lt;y</code> then <code>total+x&lt;total+y</code>, and we exploit this to cheaply maintain our priority queue.)</p>\n"}], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "accepted_answer_id": 46243650, "answer_count": 1, "score": 2, "last_activity_date": 1505493921, "creation_date": 1505478983, "last_edit_date": 1505485650, "question_id": 46239759, "link": "https://stackoverflow.com/questions/46239759/reordering-the-search-space", "title": "Reordering the search space", "body": "<p>I try to find the first occurrence in the search space ordered by descending which satisfy a some predicate.</p>\n\n<p>This strategy was chosen because calculating the predicate can be quite expensive, and the probability of finding a solution among the former is quite high.</p>\n\n<p>Here is the solution, which first builds a list of all possible solutions, then arranges and produces a linear search.</p>\n\n<pre><code>import Data.Ord\nimport Data.List\n\nsearch :: (Ord a, Num a) =&gt; ([a] -&gt; Bool) -&gt; [[a]] -&gt; Maybe [a]\nsearch p = find p . sortOn (Down . sum) . sequence\n</code></pre>\n\n<h1>Example</h1>\n\n<pre><code>main = print $ search ((&lt;25) . sum) [[10,2], [10,8,6], [8]]\n</code></pre>\n\n<h1>Output</h1>\n\n<pre><code>Just [10,6,8]\n</code></pre>\n\n<h1>Question</h1>\n\n<p>Is there a way to generate elements of this space in descending order without sorting?</p>\n"}, {"tags": ["haskell", "non-exhaustive-patterns"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1505472916, "post_id": 46237064, "comment_id": 79439035, "body": "Enable warnings using <code>-Wall</code>: you&#39;ll discover this at compile time, and GHC will even provide an example of a list which is not covered by your definition."}, {"owner": {"reputation": 17, "user_id": 4224979, "user_type": "registered", "profile_image": "https://graph.facebook.com/575023037/picture?type=large", "display_name": "Anton Fahlgren", "link": "https://stackoverflow.com/users/4224979/anton-fahlgren"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1505476281, "post_id": 46237064, "comment_id": 79441136, "body": "Thanks for the tip!"}], "answers": [{"tags": [], "owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "is_accepted": true, "score": 3, "last_activity_date": 1505472110, "creation_date": 1505472110, "answer_id": 46237684, "question_id": 46237064, "link": "https://stackoverflow.com/questions/46237064/non-exhaustive-pattern-in-function-in-haskell/46237684#46237684", "title": "Non-exhaustive pattern in function in Haskell", "body": "<p>You probably want:</p>\n\n<pre><code>distanceMatrix xs = molseqDistMat xs [] -- &lt;- Line 79\n</code></pre>\n\n<p><code>[a]</code> is a pattern that matches a list of exactly one element.</p>\n"}], "owner": {"reputation": 17, "user_id": 4224979, "user_type": "registered", "profile_image": "https://graph.facebook.com/575023037/picture?type=large", "display_name": "Anton Fahlgren", "link": "https://stackoverflow.com/users/4224979/anton-fahlgren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 46237684, "answer_count": 1, "score": 0, "last_activity_date": 1505472110, "creation_date": 1505470173, "question_id": 46237064, "link": "https://stackoverflow.com/questions/46237064/non-exhaustive-pattern-in-function-in-haskell", "title": "Non-exhaustive pattern in function in Haskell", "body": "<p>I have a class Evol and want an instance of distanceMatrix to be applied on a list of my type MolSeq. The function molseqDistMat works as desired, but I cant understand the error I get when trying to run distanceMatrix [Molseq]. I understand what the error says but I can't find the exception. This is the error.</p>\n\n<pre><code>*F2&gt; distanceMatrix l\n*** Exception: lab2.hs:79:3-43: Non-exhaustive patterns in function \ndistanceMatrix\n</code></pre>\n\n<p>This is the code.</p>\n\n<pre><code>class Evol a where\n  distanceMatrix :: [a] -&gt; [(String, String, Double)]\n\ninstance Evol MolSeq where\n  distanceMatrix [a] = molseqDistMat [a] [] -- &lt;- Line 79\n\nmolseqDistMat :: [MolSeq] -&gt; [(String, String, Double)] -&gt; [(String, \nString, Double)]\nmolseqDistMat todo res\n  | null (tail todo) = res\n  | otherwise = molseqDistMat (tail todo) (res++(doRow (head todo) (tail \ntodo) []))\n\ndoRow :: MolSeq -&gt; [MolSeq] -&gt; [(String, String, Double)] -&gt; [(String, \nString, Double)]\ndoRow mol rest result\n  | null rest = reverse result\n  | otherwise = doRow mol (tail rest) ((name mol, name (head rest), \ndistance mol (head rest)):result)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 6, "creation_date": 1505464235, "post_id": 46234878, "comment_id": 79433513, "body": "Hi Jane. Welcome to SO. Please provide the Haskell code you wrote, and the things that you have tried so far, so as we can correct you."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1505468196, "post_id": 46234878, "comment_id": 79436105, "body": "Yes, pass it as a parameter.  <code>main = do { tuplelist &lt;- makeListOfTuples;  let result = otherFunction tuplelist;  print result }</code>.  Here <code>otherFunction</code> is pure, the IO monad is confined to <code>main</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1505479807, "post_id": 46234878, "comment_id": 79443445, "body": "You don&#39;t need to use a monad to scan a list -- you could, but you should not: it would make a simple thing more complex. Either exploit library functions like <code>elem</code>, or define your own helper pure functions which scan the list using recursion and pattern matching."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1505492010, "post_id": 46234878, "comment_id": 79451368, "body": "@luqui That should be an answer, not a comment! (I admit answering that way is risky given the dearth of details available so far, but if you&#39;re gonna write that particular risky response you might as well put it in the answer box.)"}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 3, "last_activity_date": 1505527716, "last_edit_date": 1505527716, "creation_date": 1505504412, "answer_id": 46246480, "question_id": 46234878, "link": "https://stackoverflow.com/questions/46234878/how-to-access-value-of-a-function-called-in-main/46246480#46246480", "title": "How To Access Value Of A Function Called In Main", "body": "<p>Yes, pass it as a parameter.  For example</p>\n\n<pre><code>otherFunction :: Eq t =&gt; [(t, t)] -&gt; Bool\notherFunction tuplelist = and [ x == y | (x,y) &lt;- tuplelist ]\n\nmain = do\n   tuplelist &lt;- makeListOfTuples\n   let result = otherFunction tuplelist\n   print result\n</code></pre>\n\n<p>Here <code>otherFunction</code> is completely pure, yet it can depends on data that was made in <code>IO</code>.</p>\n"}], "owner": {"reputation": 309, "user_id": 4963700, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/c91555a7687c337980c159209631e29f?s=128&d=identicon&r=PG&f=1", "display_name": "jane", "link": "https://stackoverflow.com/users/4963700/jane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 46246480, "answer_count": 1, "score": 0, "last_activity_date": 1505527716, "creation_date": 1505463386, "question_id": 46234878, "link": "https://stackoverflow.com/questions/46234878/how-to-access-value-of-a-function-called-in-main", "title": "How To Access Value Of A Function Called In Main", "body": "<p>So I'm a beginner from Haskell, I ran a function that outputs a list of tuples in main, is there a way to access that list of tuples without using Monad in another function so I could check if that list of tuples contains certain element? Or do I really need to use Monad for that? Thanks. </p>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 1, "creation_date": 1505459756, "post_id": 46231510, "comment_id": 79430939, "body": "A Num instance could be define for [] to behave like polynoms (ie having a infinite sequence of leading 0) which wouldn&#39;t be awful to write in real code."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1505468514, "post_id": 46231510, "comment_id": 79436316, "body": "<code>abs</code> and <code>signum</code> would be a bit awkward though."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1505477812, "post_id": 46231510, "comment_id": 79442135, "body": "@gallais The definitions don&#39;t need to be useful, just consistent. <code>signum x = [1]</code> and <code>abs = id</code> would probably suffice for most intended uses of such an instance."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 1, "creation_date": 1505478142, "post_id": 46231510, "comment_id": 79442329, "body": "Might as well be <code>undefined</code> in that case, no? At least you&#39;ll get a runtime error if you make the mistake of using these meaningless functions (<code>abs</code> and <code>signum</code> come with laws)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 1, "creation_date": 1505483702, "post_id": 46231510, "comment_id": 79446349, "body": "@mb14 I would argue that doing so would still be terrible; at least use a <code>newtype</code> to cover your shame."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1505496219, "post_id": 46231510, "comment_id": 79453497, "body": "@gallais Why would I want a runtime error? My definition obeys <code>signum x * abs x == x</code>; I claim this is at least consistent with any other instance of <code>Num</code>, whether or not it is useful to a user of such a polynomial encoding."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1505548154, "post_id": 46231510, "comment_id": 79466631, "body": "@david I think words like  awful and shame if not subjective deserve an explanation."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 10, "last_activity_date": 1505448525, "last_edit_date": 1505448525, "creation_date": 1505448165, "answer_id": 46231510, "question_id": 46231446, "link": "https://stackoverflow.com/questions/46231446/why-does-this-expression-have-a-valid-type/46231510#46231510", "title": "Why does this expression have a valid type?", "body": "<p><code>Num [t]</code> is not just possible, it's easy:</p>\n\n<pre><code>import Control.Applicative\nliftA0 = pure -- hobgoblins, simple minds, etc.\nliftA1 = fmap\ninstance Num t =&gt; Num [t] where\n    (+) = liftA2 (+)\n    (-) = liftA2 (-)\n    (*) = liftA2 (*)\n    negate = liftA1 negate\n    abs    = liftA1 abs\n    signum = liftA1 signum\n    fromInteger n = liftA0 (fromInteger n)\n</code></pre>\n\n<p>So it would be awful for GHC to produce an error instead of inferring that your expression could be well typed with an appropriate instance.</p>\n\n<p>Of course, it would also be awful to ever write this instance in real code, but GHC shouldn't be in the business of passing judgment on code like we humans do.</p>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": true, "score": 3, "last_activity_date": 1516129852, "last_edit_date": 1516129852, "creation_date": 1505502864, "answer_id": 46246167, "question_id": 46231446, "link": "https://stackoverflow.com/questions/46231446/why-does-this-expression-have-a-valid-type/46246167#46246167", "title": "Why does this expression have a valid type?", "body": "<p>Let's look at how these constraints come to be to explain the type. </p>\n\n<h2>Numbers</h2>\n\n<p>In Haskell a literal number is replaced with a call to <code>fromInteger</code> (or <code>fromRational</code> if it has a decimal point or an 'e' in it). This way one can write '1' and have it be float or a double or an int or whatever. The type of <code>fromInteger</code> is</p>\n\n<pre><code>fromInteger :: Num a =&gt; a\n</code></pre>\n\n<p>So <code>1</code> gets desugared to <code>fromInteger (1::Integer)</code> which has type <code>Num t =&gt; t</code></p>\n\n<h2>Ranges</h2>\n\n<p>In Haskell the syntax <code>[a..b]</code> is converted into the call <code>enumFromTo a b</code> and the type is <code>enumFromTo :: Enum a =&gt; a -&gt; a -&gt; [a]</code>. Putting these together we get</p>\n\n<pre><code>[1..5] == enumFromTo (fromInteger 1) (fromInteger 5) :: (Enum a, Num a) =&gt; [a]\n</code></pre>\n\n<h2>Putting it all together</h2>\n\n<p>Now the type of <code>(*)</code> is <code>Num b =&gt; b -&gt; b -&gt; b</code> so we combine these all together to get:</p>\n\n<pre><code>(Num t,\nNum a,\nEnum a,\nNum b,\nt~b,\n[a]~b) =&gt; b\n</code></pre>\n\n<p>Note that <code>a~b</code> means the types <code>a</code> and <code>b</code> are the same. Combining these gives the type</p>\n\n<pre><code>(Num a, Enum a, Num [a]) =&gt; [a]\n</code></pre>\n"}], "owner": {"reputation": 4029, "user_id": 3224967, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/963b108f3bcde98ac96d09b04abbf63f?s=128&d=identicon&r=PG&f=1", "display_name": "mherzl", "link": "https://stackoverflow.com/users/3224967/mherzl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 46246167, "answer_count": 2, "score": 3, "last_activity_date": 1516129852, "creation_date": 1505447693, "question_id": 46231446, "link": "https://stackoverflow.com/questions/46231446/why-does-this-expression-have-a-valid-type", "title": "Why does this expression have a valid type?", "body": "<p>Banging around in <code>ghci</code>, I happened to notice that the expression <code>(*) 1 [1..5]</code> apparently has a valid type.</p>\n\n<pre><code>:t (*) 1 [1..5]\n(*) 1 [1..5] :: (Enum t, Num [t], Num t) =&gt; [t]\n</code></pre>\n\n<p>Apparently it is a list with several type constraints, including <code>Num [t]</code> which looks impossible to me, like it should give an error.</p>\n\n<p>How is this the type of the expression? Why does <code>ghci</code>'s <code>:t</code> command not give an error here?</p>\n"}, {"tags": ["haskell", "lambda"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1505438288, "post_id": 46230260, "comment_id": 79424451, "body": "What do you mean by &quot;lambda expression&quot;?"}, {"owner": {"reputation": 13, "user_id": 7514361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/887df732e2b4403d6415fa9745102764?s=128&d=identicon&r=PG&f=1", "display_name": "Megan Fischer", "link": "https://stackoverflow.com/users/7514361/megan-fischer"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1505438528, "post_id": 46230260, "comment_id": 79424502, "body": "We were given this as an example: add x y = x + y and it is add = \\x -&gt; (\\y -&gt; x + y) as a lambda expression"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1505447299, "creation_date": 1505447299, "answer_id": 46231389, "question_id": 46230260, "link": "https://stackoverflow.com/questions/46230260/definition-of-using-lambda-expressions/46231389#46231389", "title": "Definition of (&amp;&amp;) using Lambda Expressions", "body": "<p>Generally, if</p>\n\n<pre><code>foo bar baz = quux\n</code></pre>\n\n<p>then the two definitions</p>\n\n<pre><code>foo = \\bar baz -&gt; quux -- OR\nfoo = \\bar -&gt; \\baz -&gt; quux\n</code></pre>\n\n<p>are essentially identical to the original (up to some language warts that can be worked around by giving an explicit type signature). You can choose whichever one you like better. So,</p>\n\n<pre><code>(&amp;&amp;) a b = if a then b else False\n</code></pre>\n\n<p>can also be written as:</p>\n\n<pre><code>(&amp;&amp;) = \\a b -&gt; if a then b else False\n</code></pre>\n\n<p>Can you work out how to do the other one following this same pattern?</p>\n"}, {"tags": [], "owner": {"reputation": 661, "user_id": 7720738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HccZv.png?s=128&g=1", "display_name": "James Burton", "link": "https://stackoverflow.com/users/7720738/james-burton"}, "is_accepted": false, "score": 2, "last_activity_date": 1505500581, "last_edit_date": 1505500581, "creation_date": 1505480768, "answer_id": 46240331, "question_id": 46230260, "link": "https://stackoverflow.com/questions/46230260/definition-of-using-lambda-expressions/46240331#46240331", "title": "Definition of (&amp;&amp;) using Lambda Expressions", "body": "<p>I won't just straight up write the answer because this seems like an assignment / homework of some sort. So I'll just explain a bit how lambdas work.</p>\n\n<p>Let's take a basic lambda and break it down:\n<code>\\a b -&gt; a</code></p>\n\n<p>To the left side of the arrow (in this case a b) we have the arguments. These are what is passed to the lambda.</p>\n\n<p>On the right side of the arrow we have the output (in this case a). So what this lambda does is takes two values and gives you the first one.</p>\n\n<p>The output could be any expression for example if we restrict a and b to be numbers then we could have <code>myLambda = \\a b -&gt; a + b</code> so <code>myLambda 1 2</code> would output 3.</p>\n\n<p>So to convert your definitions into lambdas just take your <code>if then else</code> statements and have those as the expression after the arrow in the lambda.</p>\n\n<p>You could also use the pattern matching used in the initial definitions you gave and convert that to a lambda with a <code>case of</code> statement. This takes a value between the <code>case</code> and <code>of</code> and then you provide various expressions to be outputted depending on what the value was e.g.</p>\n\n<pre><code>case a of\n    True -&gt; something1\n    False -&gt; something2\n</code></pre>\n\n<p>So to put that in a lambda would give you:</p>\n\n<pre><code>\\a b -&gt; case a of\n    value1 -&gt; something1\n    value2 -&gt; something2\n</code></pre>\n\n<p>For the sake of completeness I will mention that there is a LambdaCase language extension that allows you to simplify:</p>\n\n<pre><code>\\a -&gt; case a of\n    value1 -&gt; something1\n    value2 -&gt; something2\n</code></pre>\n\n<p>to</p>\n\n<pre><code>\\case\n    value1 -&gt; something1\n    value2 -&gt; something2\n</code></pre>\n\n<p>But this is not necessary and I certainly wouldn't worry about it as a beginner.</p>\n\n<p>I hope this helps, feel free to ask for clarification :)</p>\n"}], "owner": {"reputation": 13, "user_id": 7514361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/887df732e2b4403d6415fa9745102764?s=128&d=identicon&r=PG&f=1", "display_name": "Megan Fischer", "link": "https://stackoverflow.com/users/7514361/megan-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1505500581, "creation_date": 1505437850, "last_edit_date": 1505438241, "question_id": 46230260, "link": "https://stackoverflow.com/questions/46230260/definition-of-using-lambda-expressions", "title": "Definition of (&amp;&amp;) using Lambda Expressions", "body": "<p>I was given the following questions:</p>\n\n<p>1.</p>\n\n<pre><code>True &amp;&amp; True = True  \n_ &amp;&amp; _ = False\n</code></pre>\n\n<p>I wrote this as a conditional expression:  </p>\n\n<pre><code>(&amp;&amp;) a b = if a then  \nif b then True else False \nelse False \n</code></pre>\n\n<p>2.</p>\n\n<pre><code>True &amp;&amp; b = b  \nFalse &amp;&amp; _ = False\n</code></pre>\n\n<p>I wrote this as a conditional expression:  </p>\n\n<pre><code>(&amp;&amp;) a b = if a then b else False\n</code></pre>\n\n<p>I am trying to write these two definitions given for (&amp;&amp;) in lambda expression, but I not exactly sure where to start or how to do it.</p>\n"}, {"tags": ["haskell", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 3, "creation_date": 1505432464, "post_id": 46229642, "comment_id": 79423271, "body": "How about <code>Print (Atomic (Const 2))</code>?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1505437370, "post_id": 46229642, "comment_id": 79424252, "body": "It <i>may</i> be convenient to define <code>IsString Atom</code> and <code>Num Atom</code> instances (with the second one only working in the <code>Const</code> case). Then, <code>Print (Atomic 2)</code> would work, and so would <code>Print (Atomic &quot;hi&quot;)</code>."}, {"owner": {"reputation": 1253, "user_id": 2133137, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gsZzC.png?s=128&g=1", "display_name": "Hovestar", "link": "https://stackoverflow.com/users/2133137/hovestar"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1505446471, "post_id": 46229642, "comment_id": 79426130, "body": "@BenjaminHodgson That works. Want to aswer so I can accept it and give you the cred?"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1505447952, "creation_date": 1505447952, "answer_id": 46231484, "question_id": 46229642, "link": "https://stackoverflow.com/questions/46229642/haskell-not-finding-indirect-type/46231484#46231484", "title": "Haskell not finding &quot;indirect&quot; type", "body": "<p><code>Const 2</code> is an <code>Atom</code>, but <code>Print</code> takes an <code>Expr</code> as an argument. Luckily, every <code>Atom</code> can be made into an <code>Expr</code> with the <code>Atomic</code> constructor. So:</p>\n\n<pre><code>main = do\n    let test5 = Print (Atomic (Const 2))\n    print test5\n</code></pre>\n"}], "owner": {"reputation": 1253, "user_id": 2133137, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/gsZzC.png?s=128&g=1", "display_name": "Hovestar", "link": "https://stackoverflow.com/users/2133137/hovestar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 46231484, "answer_count": 1, "score": 1, "last_activity_date": 1505447952, "creation_date": 1505432149, "question_id": 46229642, "link": "https://stackoverflow.com/questions/46229642/haskell-not-finding-indirect-type", "title": "Haskell not finding &quot;indirect&quot; type", "body": "<p>I'm taking a compilers class, and I decided to do it in haskell, but I'm having a hard time setting up the ast. My issue is that I have an <code>Atom</code> class and an <code>Expr</code> class and one instance of the <code>Expr</code> can be an <code>Atom</code>, but when the <code>Expr</code> is immediately an Atom it has an issue. Here is the example:</p>\n\n<pre><code>data Atom -- cannot be reduced farther\n    = Const Int -- int is value\n    | Var String -- string is name\n    deriving (Show) -- So we can print it\n\ndata Expr -- add input and the like\n    = Add Expr Expr -- add is two exprs\n    | USub Expr -- negation\n    | Input -- call to input\n    | Atomic Atom -- or an atomic\n    deriving (Show) -- So we can print it\n\ndata Statement\n    = Print Expr\n    | Discard Expr\n    | Assign String Expr\n    deriving (Show) -- So we can print it\n\n\nmain = do \n    let test5 = Print (Const 2)\n    putStrLn $ show test5\n</code></pre>\n\n<p>The compiler fails on the <code>Print (Const 2)</code> because it expected an Expr. Is there a fix to this, and is there better vocabular for expressing this problem?</p>\n"}, {"tags": ["haskell", "uniplate"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1505421575, "post_id": 46227792, "comment_id": 79419539, "body": "I don&#39;t see why you need anything more than Haskell98 for this. Also, am I reading this correctly in that any application of the third rule will lead to an application of the second rule?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1505454121, "post_id": 46227792, "comment_id": 79428169, "body": "I confess I don&#39;t really understand the question. Can you write the types of the transformations you are hoping to implement? Perhaps that would make things clearer."}, {"owner": {"reputation": 2167, "user_id": 459877, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/QdrXY.jpg?s=128&g=1", "display_name": "beta", "link": "https://stackoverflow.com/users/459877/beta"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1505455680, "post_id": 46227792, "comment_id": 79428834, "body": "@DanielWagner I had tried to simplify the problem, but only ended up making it more fuzzy. Re-phrased the problem now, with concrete examples."}, {"owner": {"reputation": 2167, "user_id": 459877, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/QdrXY.jpg?s=128&g=1", "display_name": "beta", "link": "https://stackoverflow.com/users/459877/beta"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1505455758, "post_id": 46227792, "comment_id": 79428876, "body": "@Alec Rephrased the question now. This can definitely be done with Haskell98, but it gets messy fast, and I just wondered if there is a \u201ctoolkit\u201d I should know about that would make this easier."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505468859, "post_id": 46227792, "comment_id": 79436533, "body": "Shouldn&#39;t you write <code>And [Prop]</code> and <code>Or [Prop]</code> in the data defintion. Right now the modeling is rather weird since the list contains as first element an operator, followed by other <code>Lit</code>s?"}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 1, "last_activity_date": 1505697769, "last_edit_date": 1505697769, "creation_date": 1505692493, "answer_id": 46269921, "question_id": 46227792, "link": "https://stackoverflow.com/questions/46227792/generic-transformations-on-a-set-of-a-given-datatype/46269921#46269921", "title": "Generic transformations on a set of a given datatype", "body": "<p>I assume that your second rule is wrong, and you really meant to say either:</p>\n\n<ul>\n<li>replace <code>[[Or a b],[c]]</code> with <code>[[a],[b],[c]]</code></li>\n</ul>\n\n<p>or else:</p>\n\n<ul>\n<li>replace <code>[[Or a b, c]]</code> with <code>[[a,c],[b,c]]</code></li>\n</ul>\n\n<p>In other words, I assume you're trying to convert a <code>Prop</code> into an alternate representation <code>[[Prop]]</code> where the first-level list is an \"or\" and the second-level lists are \"and\"s, with all terms being either literals or <code>Neg</code>-literals.  So, you're trying to imagine how you could apply a bunch of generic structural rules to make transformations like:</p>\n\n<pre><code>[[And a (Or b c)]]\n[[a, Or b c]]        -- apply \"And\" rule\n[[a,b],[a,c]]        -- apply some kind of \"Or\" distribution rule\n</code></pre>\n\n<p>If so, having generic transformations isn't much use.  With your current datatype, you can only apply these transformations to top-level expressions anyway.  For example, there's no obvious way to apply an <code>Or</code> rule here:</p>\n\n<pre><code>[[And a (And b (Or c d))]]\n</code></pre>\n\n<p>without first applying <code>And</code> rules a couple of times.  If you change your data type to add, say, an <code>L2 [[Prop]]</code> constructor, so you can transform the above expression to:</p>\n\n<pre><code>[[And a (And b (L2 [[c],[d]]))]]   -- apply \"Or\" rule\n</code></pre>\n\n<p>it's not clear what that buys you.</p>\n\n<p>Ultimately, I don't think this is the right approach...</p>\n\n<p>You have a perfectly adequate representation of your prepositional logic in the <code>Prop</code> data type; and you have a desired final representation.  Instead of trying to translate your <code>Prop</code> representation into the final representation using piecemeal generic transformations, transform your <code>Prop</code> representation using standard recursive Prop-to-Prop transformations into a canonical <code>Prop</code> form, and do the translation as the final step.</p>\n\n<p>Here, a reasonable canonical form is:</p>\n\n<pre><code>Or e1 (Or e2 (... (Or e3 e4)))\n</code></pre>\n\n<p>where each <code>ek</code> is of form:</p>\n\n<pre><code>And t1 (And t2 (... (And t3 t4)))\n</code></pre>\n\n<p>and each <code>tk</code> is either a <code>Lit _</code> or a <code>Neg (Lit _)</code>.  Obviously, this canonical form can be translated pretty easily into the desired final representation as a <code>[[Prop]]</code>.</p>\n\n<p>I've included a possible solution below.  I don't see that much opportunity for simplifying things via generic transformations.  Most of the pattern matching seems to be doing non-trivial work.</p>\n\n<h2>Possible Solution</h2>\n\n<p>After a bit of preamble:</p>\n\n<pre><code>import Data.List\n\ndata Prop = Lit String\n          | Neg Prop\n          | And Prop Prop\n          | Or Prop Prop\n          deriving (Eq)\n</code></pre>\n\n<p>then one way to translate an arbitrary <code>Prop</code> into this canonical form is to first push all the <code>Neg</code>s down to the literal terms:</p>\n\n<pre><code>pushNeg :: Prop -&gt; Prop\npushNeg = push False\n  where\n    -- de Morgan's laws\n    push neg (And x y) = (if neg then Or else And) (push neg x) (push neg y)\n    push neg (Or x y)  = (if neg then And else Or) (push neg x) (push neg y)\n    -- handle Neg and Lit\n    push neg (Neg y) = push (not neg) y\n    push neg (Lit l) = if neg then Neg (Lit l) else Lit l\n</code></pre>\n\n<p>then push all the <code>And</code>s down on top of them.  This is tougher to get right, but I think the following is correct, even though it does a bit of unnecessary work in some cases:</p>\n\n<pre><code>pushAnd :: Prop -&gt; Prop\npushAnd (Or x y) = Or (pushAnd x) (pushAnd y)\npushAnd (And x y)\n  = let x' = pushAnd x\n    in  case x' of\n          Or u v -&gt; Or (pushAnd (And u y)) (pushAnd (And v y))\n          _ -&gt; let y' = pushAnd y\n               in case y' of\n                    Or u v -&gt; Or (pushAnd (And x' u)) (pushAnd (And x' v))\n                    _ -&gt; And x' y'\npushAnd x = x\n</code></pre>\n\n<p>and then recursively make all the <code>And</code> and <code>Or</code> clauses right-associative:</p>\n\n<pre><code>rassoc :: Prop -&gt; Prop\nrassoc (Or (Or x y) z)   = rassoc (Or x (Or y z))\nrassoc (Or x        z)   = Or (rassoc x) (rassoc z)\nrassoc (And (And x y) z) = rassoc (And x (And y z))\nrassoc (And x         z) = And x (rassoc z)\nrassoc x = x\n</code></pre>\n\n<p>and finally convert the canonical form to its final representation (dropping the inconsistent clauses and duplicate terms while we're at it):</p>\n\n<pre><code>translate :: Prop -&gt; [[Prop]]\ntranslate = nub . map nub . filter consistent . doOr\n  where\n    doOr x = case x of\n      Or x y -&gt; doAnd x : doOr y\n      x      -&gt; doAnd x : []\n    doAnd x = case x of\n      And x y -&gt; x : doAnd y\n      x       -&gt; x : []\n    consistent lits =\n      let (falses, trues) = partition isNeg lits\n          falses' = map (\\(Neg (Lit l)) -&gt; l) falses\n          trues'  = map (\\     (Lit l)  -&gt; l) trues\n      in null (intersect falses' trues')\n    isNeg (Neg x) = True\n    isNeg _       = False\n</code></pre>\n\n<p>The whole pipeline is:</p>\n\n<pre><code>final :: Prop -&gt; [[Prop]]\nfinal = translate . rassoc . pushAnd . pushNeg\n</code></pre>\n\n<p>and here's some test code:</p>\n\n<pre><code>a = Lit \"a\"\nb = Lit \"b\"\nc = Lit \"c\"\nd = Lit \"d\"\ne = Lit \"e\"\n\n-- Show instance, but only for `final` forms\ninstance Show Prop where\n  show (Lit x) = x\n  show (Neg (Lit x)) = '~':x\n\nmain :: IO ()\nmain = do print $ final (Neg a)\n          print $ final (Or a b)\n          print $ final (Or a a)\n          print $ final (And a b)\n          print $ final (And (Or (And (Or a b) c) d) e)\n          print $ final (And (Or (Or a b) c) (Neg (And a (Or b d))))\n</code></pre>\n\n<p>which outputs:</p>\n\n<pre><code>[[~a]]\n[[a],[b]]\n[[a]]\n[[a,b]]\n[[a,c,e],[b,c,e],[d,e]]\n[[a,~b,~d],[b,~a],[c,~a],[c,~b,~d]]\n</code></pre>\n\n<p>There's still some opportunity for further simplification, as:</p>\n\n<pre><code>final (And a (Or a b))\n</code></pre>\n\n<p>gives final form <code>[[a],[a,b]]</code> instead of just <code>[[a]]</code>.</p>\n"}], "owner": {"reputation": 2167, "user_id": 459877, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/QdrXY.jpg?s=128&g=1", "display_name": "beta", "link": "https://stackoverflow.com/users/459877/beta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1505697769, "creation_date": 1505421125, "last_edit_date": 1505455525, "question_id": 46227792, "link": "https://stackoverflow.com/questions/46227792/generic-transformations-on-a-set-of-a-given-datatype", "title": "Generic transformations on a set of a given datatype", "body": "<p>If I have a datatype representing a subset of propositional logic such as</p>\n\n<pre><code>data Prop = Lit String\n          | Neg Prop\n          | And Prop Prop\n          | Or Prop Prop\n</code></pre>\n\n<p>Are there then easy ways to do generic transformations on <code>[[Prop]]</code>? E.g.</p>\n\n<ul>\n<li>replace <code>[[And a b, c]]</code> with <code>[[a, b, c]]</code></li>\n<li>replace <code>[[Or a b, c]]</code> with <code>[[a], [b], [c]]</code>, or</li>\n<li>removing occurrences of sublists containing both <code>Neg a</code> and <code>a</code>, e.g. turning <code>[[Neg a, x, a], [b]]</code> into <code>[[b]]</code></li>\n</ul>\n\n<p>This feels like something close to what e.g. <a href=\"https://github.com/ndmitchell/uniplate\" rel=\"nofollow noreferrer\">uniplate</a> does, but \u201ctwo levels up\u201d.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 1, "creation_date": 1505420334, "post_id": 46227562, "comment_id": 79418934, "body": "<code>m</code> isn&#39;t the <code>m</code> from the type signature, but a monadic action of type <code>m a</code>."}, {"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1505421110, "post_id": 46227562, "comment_id": 79419337, "body": "Those are literally just the <code>MonadTrans</code> laws adapted for <code>liftIO</code> instead of <code>lift</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505421242, "post_id": 46227562, "comment_id": 79419410, "body": "<code>&gt;&gt;=</code> is a function as well <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:-62--62--61-\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.10.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1505426538, "post_id": 46227562, "comment_id": 79421612, "body": "The variable <code>m</code> is not the one in the signature. Does this alpha-equivalent reformulation help: <code>liftIO (x &gt;&gt;= f) = liftIO x &gt;&gt;= (liftIO . f)</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1505453684, "post_id": 46227562, "comment_id": 79428027, "body": "Or, another way to say what everybody else is saying: there is an implicit quantification at the beginning of the law; strictly speaking, it should say <code>forall m. forall f. liftIO (m &gt;&gt;= f) = liftIO m &gt;&gt;= liftIO . f</code>. This is generally the case for typeclass laws: any identifiers which are not methods of the class (or its superclasses) are implicitly universally quantified."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 1, "last_activity_date": 1505427082, "creation_date": 1505427082, "answer_id": 46228971, "question_id": 46227562, "link": "https://stackoverflow.com/questions/46227562/understanding-the-monadio-laws/46228971#46228971", "title": "Understanding the MonadIO Laws", "body": "<p>As noted in the comments, the <code>m</code> in the law is just a value variable, and is not the same <code>m</code> as the type variable <code>m</code> used in the <code>class</code> definition.</p>\n\n<p>If you rewrite the law as:</p>\n\n<pre><code>liftIO (act &gt;&gt;= f) = liftIO act &gt;&gt;= (liftIO . f)\n</code></pre>\n\n<p>equivalent to:</p>\n\n<pre><code>liftIO $ do x &lt;- act     ===      do x &lt;- liftIO act\n            f x                      liftIO (f x)\n</code></pre>\n\n<p>with the understanding that <code>act</code> is an IO action, then it may be clearer what's going on.  The expression <code>act &gt;&gt;= f</code> represents the composite IO action that, when run, will run the IO action <code>act</code> and pass its return value to <code>f</code> to generate a new IO action (say <code>act2</code>) that will then be run.  </p>\n\n<p>The law just says that lifting this composite IO action into a different monad creates an action that, when run, is equivalent running a lifted version of <code>act</code>, passing its return value to <code>f</code> to generate a new IO action, lifting that action to the other monad, and running that.</p>\n\n<p>As a concrete example, <code>getLine &gt;&gt;= print</code> is the IO action that reads a line and then prints its value in Haskell string syntax.  The law says that you can either lift this directly into another monad:</p>\n\n<pre><code>liftIO $ do x &lt;- getLine\n            print x\n</code></pre>\n\n<p>to get an action that does that, or you can lift the IO action parts separately:</p>\n\n<pre><code>do x &lt;- liftIO getLine\n   liftIO (print x)\n</code></pre>\n\n<p>and get exactly the same action.</p>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 46228971, "answer_count": 1, "score": 1, "last_activity_date": 1505427082, "creation_date": 1505420137, "question_id": 46227562, "link": "https://stackoverflow.com/questions/46227562/understanding-the-monadio-laws", "title": "Understanding the MonadIO Laws", "body": "<p>From <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/src/Control.Monad.IO.Class.html#MonadIO\" rel=\"nofollow noreferrer\">source</a>: </p>\n\n<pre><code>module Control.Monad.IO.Class (\n    MonadIO(..)\n  ) where\n\n-- | Monads in which 'IO' computations may be embedded.\n-- Any monad built by applying a sequence of monad transformers to the\n-- 'IO' monad will be an instance of this class.\n--\n-- Instances should satisfy the following laws, which state that 'liftIO'\n-- is a transformer of monads:\n--\n-- * @'liftIO' . 'return' = 'return'@\n--\n-- * @'liftIO' (m &gt;&gt;= f) = 'liftIO' m &gt;&gt;= ('liftIO' . f)@\n\nclass (Monad m) =&gt; MonadIO m where\n    -- | Lift a computation from the 'IO' monad.\n    liftIO :: IO a -&gt; m a\n\ninstance MonadIO IO where\n    liftIO = id\n</code></pre>\n\n<p>What is meant by</p>\n\n<blockquote>\n<pre><code>liftIO (m &gt;&gt;= f) = liftIO m &gt;&gt;= (liftIO . f)\n</code></pre>\n</blockquote>\n\n<p>And in particular, what is meant by <code>(m &gt;&gt;= f)</code>? Here <code>m</code> is a function on types and <code>f</code> a function on values. So isn't that notation non-sense?</p>\n"}, {"tags": ["haskell", "ghc", "type-families", "injective-function"], "comments": [{"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 4, "creation_date": 1505420563, "post_id": 46227353, "comment_id": 79419040, "body": "Isn&#39;t the problem that <code>ReplaceRet (Int -&gt; Int) Int</code> and <code>ReplaceRet Int (Int -&gt; Int)</code> both resolve to the type <code>Int -&gt; Int</code>, so the type <i>isn&#39;t</i> injective in the second argument?"}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1505420619, "post_id": 46227353, "comment_id": 79419069, "body": "Right, I should go to bed. Want to turn this into an answer I can accept?"}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1505420721, "post_id": 46227353, "comment_id": 79419127, "body": "Sorry, @chi beat you to it (and probably began writing that answer before you commented). Thanks!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1505420842, "post_id": 46227353, "comment_id": 79419188, "body": "IMO, injectivity annotations are <i>very</i> weak in GHC right now. Even if <code>F</code> is declared injective, GHC will still not deduce <code>a ~ b</code> from <code>F a ~ F b</code>. Injectivity seems to only prevent some ambiguous types, as exemplified in the docs. I&#39;d rather turn on <code>AmbiguousTypes</code> and deal with ambiguities using explicit type arguments."}], "answers": [{"comments": [{"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 0, "creation_date": 1505420829, "post_id": 46227673, "comment_id": 79419178, "body": "Well, that is for <code>ReplaceRet</code>. What about <code>Const</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 2, "creation_date": 1505421064, "post_id": 46227673, "comment_id": 79419307, "body": "@SebastianGraf That&#39;s a good point. The issue is that you need to reason inductively on the structure of types to deduce that <code>Const a r</code> is OK. GHC doesn&#39;t go that far. BTW, I remember that in the paper on injectivity annotations the authors show tricky cases that look injective, but are not -- so they had to design GHC to be quite restrictive on what it accepts :-( It could be improved, of course..."}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 0, "creation_date": 1505421122, "post_id": 46227673, "comment_id": 79419345, "body": "Thanks, edit your answer to include that and I&#39;ll accept (again) :)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1505557674, "last_edit_date": 1505557674, "creation_date": 1505420634, "answer_id": 46227673, "question_id": 46227353, "link": "https://stackoverflow.com/questions/46227353/type-families-and-injectivity-in-a-subset-of-indexes/46227673#46227673", "title": "Type families and injectivity in a subset of indexes", "body": "<p>You propose</p>\n\n<pre><code>type family ReplaceRet arr r = ret | ret -&gt; r where\n  ReplaceRet (a -&gt; b) r = a -&gt; ReplaceRet b r\n  ReplaceRet _  r = r\n</code></pre>\n\n<p>but</p>\n\n<pre><code>ReplaceRet (Int -&gt; Bool) Char = Int -&gt; Char\nReplaceRet Bool (Int -&gt; Char) = Int -&gt; Char\n</code></pre>\n\n<p>So, it is not true that given <code>ret</code>, we can deduce <code>r</code>. We can't have the <code>ret -&gt; r</code> dependency.</p>\n\n<p>We could have <code>arr ret -&gt; r</code> instead, but GHC does not (yet?) support this kind of dependencies on type families, as far as I know.</p>\n\n<p><code>Const a b</code> looks as if it respects <code>ret -&gt; b</code>. Detecting that however requires an inductive proof, and GHC is not that smart to deduce that. Deciding injectivity is actually quite tricky: see the <a href=\"http://ics.p.lodz.pl/~stolarek/_media/pl:research:stolarek_peyton-jones_eisenberg_injectivity_extended.pdf\" rel=\"nofollow noreferrer\">awkward cases in the paper</a>, in Sect 4.1 for a few surprises. To overcome these issues, GHC had to be designed to be conservative in what it accepts.</p>\n"}], "owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 46227673, "answer_count": 1, "score": 2, "last_activity_date": 1505557674, "creation_date": 1505419287, "question_id": 46227353, "link": "https://stackoverflow.com/questions/46227353/type-families-and-injectivity-in-a-subset-of-indexes", "title": "Type families and injectivity in a subset of indexes", "body": "<p>I have the following type family:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilyDependencies #-}\n\ntype family Const arr r = ret | ret -&gt; r where\n  Const (_ -&gt; a) r = Const a r\n  Const _  r = r\n</code></pre>\n\n<p>This is just the <code>Const</code> function in disguise, but the injectivity checker of GHC 8.2.1 doesn't recognise it as injective wrt. to its second argument:</p>\n\n<pre><code>    * Type family equation violates injectivity annotation.\n      RHS of injective type family equation cannot be a type family:\n        Const (_ -&gt; a) r = Const a r\n    * In the equations for closed type family `Const'\n      In the type family declaration for `Const'\n  |\n4 |       Const (_ -&gt; a) r = Const a r\n  |       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>If you leave out the first case, it works, which leads me to believe that the functionality is there, but is not really mature yet.</p>\n\n<p>Can I formulate this some other way so that GHC recognises injectivity? It's actually for this marginally more complicated case (so <code>arr</code> is really used):</p>\n\n<pre><code>{-# LANGUAGE TypeFamilyDependencies #-}\n\ntype family ReplaceRet arr r = ret | ret -&gt; r where\n  ReplaceRet (a -&gt; b) r = a -&gt; ReplaceRet b r\n  ReplaceRet _  r = r\n</code></pre>\n"}, {"tags": ["list", "haskell", "sum"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1505418321, "post_id": 46227073, "comment_id": 79417901, "body": "I don&#39;t know how you tested your code, but it doesn&#39;t even handle lists of length 1."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1505420290, "post_id": 46227073, "comment_id": 79418914, "body": "For most exercises, you should forget <code>length,head,tail,!!</code> exist, and go purely using pattern matching and recursion."}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1505419055, "post_id": 46227262, "comment_id": 79418269, "body": "Could be simplified to <code>altSeries xs = sum (zipWith (*) (cycle [1, -1]) xs)</code> or <code>altSeries = sum . zipWith id (cycle [id, negate])</code>."}, {"owner": {"reputation": 1698, "user_id": 4050510, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3123195051caa2f71674df0798284b0?s=128&d=identicon&r=PG", "display_name": "LudvigH", "link": "https://stackoverflow.com/users/4050510/ludvigh"}, "edited": false, "score": 0, "creation_date": 1505419975, "post_id": 46227262, "comment_id": 79418758, "body": "Nice anser on good level of complexity.  Doesn&#39;t need to be more complicated or abstract than that. :)"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1505420050, "post_id": 46227262, "comment_id": 79418789, "body": "@melpomene: Although this evidently works, it introduces a lot of higher level functions and other magic. Based on the question, I don&#39;t think this will improve the level of the OP. But feel free to add an answer :) I will upvote it."}, {"owner": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "edited": false, "score": 2, "creation_date": 1505431278, "post_id": 46227262, "comment_id": 79422952, "body": "These solutions, while correct, are unnecessarily complex.  Try this:  <code>altSeries (x:xs) = x - altSeries xs</code> <code>altSeries _       = 0</code>  This is not only simpler, but almost certainly faster.  Of course, if you want high performance, you&#39;ll want to make this function strict:"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 398, "user_id": 3236033, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/81b29b95c129cec714b31ee157dc47cb?s=128&d=identicon&r=PG", "display_name": "CarlEdman", "link": "https://stackoverflow.com/users/3236033/carledman"}, "edited": false, "score": 1, "creation_date": 1510695543, "post_id": 46227262, "comment_id": 81542478, "body": "@CarlEdman Strictness will make no difference to the speed of that function. In fact any increase in strictness over what you have there will slow it down. If you want better performance you will want a tail recursive function, so <code>altSeries = go 0 1 where go t _ [] = t; go t m (x : xs) = go (t + m * x) (negate m) xs</code>, now then you would want strictness in the numeric arguments, although GHC can hopefully figure that out for you."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1505418965, "creation_date": 1505418965, "answer_id": 46227262, "question_id": 46227073, "link": "https://stackoverflow.com/questions/46227073/alternating-series-using-haskell/46227262#46227262", "title": "Alternating series using Haskell", "body": "<p>I think it is clear that this solution <strong>does not scale</strong>: even if you would write up function up to lists with length thousand, it would break from the moment that someone enters a list with thousand and one elements.</p>\n\n<p>List processing usually is done <strong>recursively</strong>: we process the <em>head</em> (or the first <em>k</em> heads) of a list, and perform recursion on the tail of the list. Furthermore we have a number of <em>basecases</em> (can be one) to terminate recursion.</p>\n\n<p>You already provided a single base case: the empty list:</p>\n\n<pre><code>altSeries [] = 0\n</code></pre>\n\n<p>In case we enter an empty list, it is clear that we should return <code>0</code>. Now we might ask what to do in case we obtain a list of length 1: in that case the list has shape <code>[x]</code>. So in that case we should return <code>x</code>, since we should add <code>x</code>, and can not subtract the second number. So we add:</p>\n\n<pre><code>altSeries [x] = x\n</code></pre>\n\n<p>Now the question is what to do with lists with length two or more. In that case the list has pattern <code>(x1:x2:t)</code> with <code>x1</code> the first element, <code>x2</code> the second element, and <code>t</code> the remaining elements. Based on your description we should caculate <code>x1-x2</code> and add <code>altSeries t</code>:</p>\n\n<pre><code>altSeries (x1:x2:t) = x1 - x2 + altSeries t\n</code></pre>\n\n<p>This works since <code>altSeries</code> will then recursively extract <code>x3</code> and <code>x4</code>, so then it will recurse to:</p>\n\n<pre><code>altSeries [x1,x2,x3,x4,x5] = x1 - x2 + altSeries [x3,x4,x5]\n                           = x1 - x2 + x3 - x4 + altSeries [x5]\n                           = x1 - x2 + x3 - x4 + x5\n</code></pre>\n\n<p>So the full implementation is:</p>\n\n<pre><code>altSeries :: Num n =&gt; [n] -&gt; n\naltSeries [] = 0\naltSeries [x] = x\naltSeries (x1:x2:t) = x1 - x2 + altSeries t\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1505419289, "post_id": 46227297, "comment_id": 79418409, "body": "While we are at it, why not do away with the multiplication? <code>altSum = either id id . foldl (\\e n -&gt; either (Right . (+ n)) (Left . (subtract n)) e) (Left 0)</code>.   :)"}, {"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1505419948, "post_id": 46227297, "comment_id": 79418751, "body": "@Alec <code>foldr (-) 0</code> seems simpler (if you aren&#39;t trying to make it strict)."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1505420055, "post_id": 46227297, "comment_id": 79418792, "body": "@DavidFletcher I was just playing around - my comment wasn&#39;t intended to be serious. Although yes, this would be better with <code>foldl&#39;</code>."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1611800561, "post_id": 46227297, "comment_id": 116569545, "body": "I upvoter this and I like the foldl but Haskell is declarative so  <code>altl ls = [ if even n then (-n) else n | n &lt;- ls]</code>"}], "tags": [], "owner": {"reputation": 853, "user_id": 3645112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QFHGj.jpg?s=128&g=1", "display_name": "Rainbacon", "link": "https://stackoverflow.com/users/3645112/rainbacon"}, "is_accepted": false, "score": 5, "last_activity_date": 1505419094, "creation_date": 1505419094, "answer_id": 46227297, "question_id": 46227073, "link": "https://stackoverflow.com/questions/46227073/alternating-series-using-haskell/46227297#46227297", "title": "Alternating series using Haskell", "body": "<p>What you want is a list that ultimately looks something like this <code>[1,-2,3,-4]</code> which you could sum. </p>\n\n<p>You can make a list of alternating sign <code>[1,-1]</code>. this can be made infinite using the <a href=\"http://hackage.haskell.org/package/base-4.10.0.0/docs/Prelude.html#v:cycle\" rel=\"noreferrer\">cycle</a> function. <code>let alternatingSigns = cycle [1,-1]</code></p>\n\n<p>To transform a list of <code>[1,2,3,4]</code> you can zip the infinite alternating list with your list like this <code>zipWith (*) alternatingSigns input</code></p>\n\n<p>The whole function would look something like this:</p>\n\n<pre><code>altSeries :: Num a =&gt; [a] -&gt; a\naltSeries input = let alternatingSigns = cycle [1,-1]\n                  in sum $ zipWith (*) alternatingSigns input\n</code></pre>\n"}], "owner": {"reputation": 299, "user_id": 8604329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34e9794ad93744d1fcf341dfb763b345?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Robbins", "link": "https://stackoverflow.com/users/8604329/matt-robbins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "accepted_answer_id": 46227262, "answer_count": 2, "score": 2, "last_activity_date": 1505419094, "creation_date": 1505418132, "question_id": 46227073, "link": "https://stackoverflow.com/questions/46227073/alternating-series-using-haskell", "title": "Alternating series using Haskell", "body": "<p>I am trying to use Haskell to read in a list and perform an alternating series, so starting with the first element adding every other and subtracting every other from the second element.  For instance [1, 2, 3, 4] would be 1-2+3-4=-2. I thought I had figured out how to do this for lists of a specific length (I wrote it to accommodate empty lists and lists up to 4 elements long), but it doesn't do what I thought it would.  It just returns the first element from the list. Here is what I have:</p>\n\n<pre><code>altSeries :: Num a =&gt; [a] -&gt; a\naltSeries [] = 0\naltSeries (x:xs) = if length xs == 1 then x\n                   else if length xs == 2 then x\n                   else if length xs == 3 then (x - xs!!1 + xs!!2)\n                   else (x - xs!!1 + xs!!2 - xs!!3)\n</code></pre>\n\n<p>Also, what if I wanted to be able to use any list size?</p>\n"}, {"tags": ["haskell", "mediawiki", "parsec"], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1505421461, "post_id": 46226212, "comment_id": 79419503, "body": "<code>many (char &#39;\\n&#39;)</code> still wouldn&#39;t verify that the header is appearing at the start of a line though, since <code>many</code> can match anywhere by just matching 0 times."}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 1, "last_activity_date": 1505414488, "creation_date": 1505414488, "answer_id": 46226212, "question_id": 46225920, "link": "https://stackoverflow.com/questions/46225920/parsec-start-of-row-pattern/46226212#46226212", "title": "Parsec start-of-row pattern?", "body": "<p>Probably you can use <code>many (char '\\n')</code> instead of just <code>char '\\n'</code>. In parser combinators there's no sense of <em>start of the line</em> because they always run at the start of input. The only thing you can do is to check manually which symbols your input can start from. Using <code>many (char '\\n')</code> ensures that there only zero or more empty lines before header <code>== my header ==</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "is_accepted": true, "score": 2, "last_activity_date": 1505423085, "last_edit_date": 1505423085, "creation_date": 1505420486, "answer_id": 46227637, "question_id": 46225920, "link": "https://stackoverflow.com/questions/46225920/parsec-start-of-row-pattern/46227637#46227637", "title": "Parsec start-of-row pattern?", "body": "<p>You can use <a href=\"https://hackage.haskell.org/package/parsec-3.1.11/docs/Text-Parsec.html#v:getPosition\" rel=\"nofollow noreferrer\"><code>getPosition</code></a> and <a href=\"https://hackage.haskell.org/package/parsec-3.1.11/docs/Text-Parsec.html#v:sourceColumn\" rel=\"nofollow noreferrer\"><code>sourceColumn</code></a> in order to find out the column number that the parser is currently looking at. The column number will be <code>1</code> if the current position is at the start of a line (such as at the start of input or after a <code>\\n</code> or <code>\\r</code> character).</p>\n\n<p>There isn't a built-in combinator for this, but you can easily make it:</p>\n\n<pre><code>import Text.Parsec\nimport Control.Monad (guard)\n\nstartOfLine :: Monad m =&gt; ParsecT s u m ()\nstartOfLine = do\n    pos &lt;- getPosition\n    guard (sourceColumn pos == 1)\n</code></pre>\n\n<p>Now you can write your header parser as:</p>\n\n<pre><code>header = startOfLine *&gt; string \"==\" *&gt; many1 letter &lt;* string \"==\"\n</code></pre>\n"}], "owner": {"reputation": 1698, "user_id": 4050510, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f3123195051caa2f71674df0798284b0?s=128&d=identicon&r=PG", "display_name": "LudvigH", "link": "https://stackoverflow.com/users/4050510/ludvigh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 1, "accepted_answer_id": 46227637, "answer_count": 2, "score": 3, "last_activity_date": 1505423085, "creation_date": 1505413320, "question_id": 46225920, "link": "https://stackoverflow.com/questions/46225920/parsec-start-of-row-pattern", "title": "Parsec start-of-row pattern?", "body": "<p>I am trying to parse mediawiki text using Parsec. Some of the constructs in mediawiki markup can only occur at the start of rows (such as the header markup <code>==header level 2==</code>). In regexp I would use an anchor (such as <code>^</code>) to find the start of a line. </p>\n\n<p>One attempt in GHCi is </p>\n\n<pre><code>Prelude Text.Parsec&gt; parse (char '\\n' *&gt; string \"==\" *&gt; many1 letter &lt;* string \"==\") \"\" \"\\n==hej==\"\nRight \"hej\"\n</code></pre>\n\n<p>but this is not too good since it will fail on the first line of a file. I feel like this should be a solved problem...</p>\n\n<p>What is the most idiomatic \"Start of line\" parsing in Parsec?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 9554, "user_id": 4794308, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a25aee790dd8743107c266f2c3d8850c?s=128&d=identicon&r=PG&f=1", "display_name": "Lifu Huang", "link": "https://stackoverflow.com/users/4794308/lifu-huang"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505405448, "post_id": 46223679, "comment_id": 79410699, "body": "Hi @WillemVanOnsem, thank you for the help. That&#39;s exactly what I am confused about, you mentioned <code>mempty = 1</code>, then what&#39;s the type of the <code>mempty</code> here? I cannot quite understand this because unlike <code>Sum</code> and <code>Product</code>, <code>Int</code> is not of typeclass <code>Monoid</code> AFAIK. Could you please explain a bit more about this? thanks"}, {"owner": {"reputation": 9554, "user_id": 4794308, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a25aee790dd8743107c266f2c3d8850c?s=128&d=identicon&r=PG&f=1", "display_name": "Lifu Huang", "link": "https://stackoverflow.com/users/4794308/lifu-huang"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1505405685, "post_id": 46223679, "comment_id": 79410848, "body": "Hmm, I see, I am new to Haskell, I guess that&#39;s the part I am missing. Thanks a lot :)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1505409340, "post_id": 46223679, "comment_id": 79413090, "body": "Note that this endo trick is pretty advanced, surely not beginner material. Perhaps it&#39;s easier to write a <code>foldl</code> implementation which first converts any foldable to a plain list, using <code>foldMap (\\x -&gt; [x])</code> so that the monoid is simply <code>[a]</code>, and then doing the <code>foldl</code> on the list. It&#39;s less efficient, but probably easier to understand. It could make for a good exercise :)"}], "answers": [{"comments": [{"owner": {"reputation": 9554, "user_id": 4794308, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a25aee790dd8743107c266f2c3d8850c?s=128&d=identicon&r=PG&f=1", "display_name": "Lifu Huang", "link": "https://stackoverflow.com/users/4794308/lifu-huang"}, "edited": false, "score": 0, "creation_date": 1505405960, "post_id": 46223981, "comment_id": 79411029, "body": "I see, I actually found that part of source code, but couldn&#39;t understand the role <code>Endo</code> played as I am new to Haskell, will read more about that. Thank you so much :)"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 9, "last_activity_date": 1505405761, "creation_date": 1505405761, "answer_id": 46223981, "question_id": 46223679, "link": "https://stackoverflow.com/questions/46223679/how-does-foldable-foldl-work-on-num-a-a/46223981#46223981", "title": "How does Foldable.foldl work on Num a =&gt; a", "body": "<p>It's a bit easier to figure out if you consider <code>foldr</code>, which has the type <code>(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b</code>. The 'algebra' function has the type <code>a -&gt; b -&gt; b</code>, which you can view as <code>a -&gt; (b -&gt; b)</code> - that is: a function that takes <code>a</code> as input, and returns <code>b -&gt; b</code> as output.</p>\n\n<p>Now, <code>b -&gt; b</code> is an <em>endomorphism</em>, which is also a monoid, and <code>Data.Monoid</code> defines a type <code>Endo a</code> (or here, it ought perhaps to be <code>Endo b</code>), which is, indeed, a <code>Monoid</code>.</p>\n\n<p><code>foldr</code> simply uses <code>Endo</code> internally to call <code>foldMap</code>:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b\nfoldr f z t = appEndo (foldMap (Endo #. f) t) z\n</code></pre>\n\n<p><code>foldl</code> basically just flips the arguments around in order to do the same trick:</p>\n\n<pre><code>foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\nfoldl f z t = appEndo (getDual (foldMap (Dual . Endo . flip f) t)) z\n</code></pre>\n\n<p>To be clear, I literally copied these two function implementation from the Haskell source. If you go to the <a href=\"https://hackage.haskell.org/package/base-4.10.0.0/docs/Data-Foldable.html\" rel=\"noreferrer\">documentation of Data.Foldable</a>, there are various links to view the source. That's what I did.</p>\n"}], "owner": {"reputation": 9554, "user_id": 4794308, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a25aee790dd8743107c266f2c3d8850c?s=128&d=identicon&r=PG&f=1", "display_name": "Lifu Huang", "link": "https://stackoverflow.com/users/4794308/lifu-huang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 46223981, "answer_count": 1, "score": 8, "last_activity_date": 1505411531, "creation_date": 1505404816, "last_edit_date": 1505411531, "question_id": 46223679, "link": "https://stackoverflow.com/questions/46223679/how-does-foldable-foldl-work-on-num-a-a", "title": "How does Foldable.foldl work on Num a =&gt; a", "body": "<p>In <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids#monoids\" rel=\"nofollow noreferrer\">LYAH</a>, there is a piece of code that looks like this.</p>\n\n<pre><code>data Tree a = Empty | Node a (Tree a) (Tree a) deriving (Show, Read, Eq)  \n\ninstance F.Foldable Tree where  \n    foldMap f Empty = mempty  \n    foldMap f (Node x l r) = F.foldMap f l `mappend`  \n                             f x           `mappend`  \n                             F.foldMap f r  \n\nghci&gt; F.foldl (+) 0 testTree  \n42  \nghci&gt; F.foldl (*) 1 testTree  \n64800  \n</code></pre>\n\n<p>As far as I know, <code>foldMap</code> is of type <code>foldMap :: (Monoid m, Foldable t) =&gt; (a -&gt; m) -&gt; t a -&gt; m</code>, but <code>Num a =&gt; a</code> itself is not of type <code>Monoid</code>, so I am wondering how does <code>Foldable.foldl</code> actually work here? And since <code>foldMap</code> is called internally by <code>Foldable.foldl</code>, what is the type of the <code>Monoid</code>?</p>\n"}, {"tags": ["haskell", "coq", "coq-extraction"], "answers": [{"tags": [], "owner": {"reputation": 14306, "user_id": 2747511, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h6jTZ.jpg?s=128&g=1", "display_name": "Anton Trunov", "link": "https://stackoverflow.com/users/2747511/anton-trunov"}, "is_accepted": true, "score": 3, "last_activity_date": 1505415342, "creation_date": 1505415342, "answer_id": 46226411, "question_id": 46223269, "link": "https://stackoverflow.com/questions/46223269/how-to-set-the-module-name-when-extracting-coq-to-haskell/46226411#46226411", "title": "How to set the module name when extracting Coq to Haskell", "body": "<p>You can use <code>Extraction \"file\"</code> or <code>Extraction Library</code> (or its variants), e.g.</p>\n\n<pre><code>Definition foo := 6*7.\n\nExtraction Language Haskell.\nExtraction \"MyModule\" foo.\n</code></pre>\n\n<p>The above produces <code>MyModule.hs</code> file, which starts with <code>module MyModule where</code>.</p>\n"}], "owner": {"reputation": 20870, "user_id": 40916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/24ac39488e9c4f2833d087a1343707dc?s=128&d=identicon&r=PG", "display_name": "yairchu", "link": "https://stackoverflow.com/users/40916/yairchu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 46226411, "answer_count": 1, "score": 7, "last_activity_date": 1505416046, "creation_date": 1505403551, "last_edit_date": 1505416046, "question_id": 46223269, "link": "https://stackoverflow.com/questions/46223269/how-to-set-the-module-name-when-extracting-coq-to-haskell", "title": "How to set the module name when extracting Coq to Haskell", "body": "<p>When I extract/compile Coq to Haskell using <code>Extraction Language Haskell.</code> in the Coq file and running <code>coqtop -compile mymodule.v &gt; MyModule.hs</code>, I get a Haskell module which starts with <code>module Main where</code>.</p>\n\n<p>Is there an option to set the resulting Haskell module name?</p>\n\n<p>I currently pipe to sed like this -</p>\n\n<pre><code>coqtop -compile mymodule.v | sed s/Main/MyModule/ &gt; MyModule.hs\n</code></pre>\n\n<p>but I'm looking for a cleaner solution.</p>\n"}, {"tags": ["list", "haskell", "list-comprehension"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1505402833, "post_id": 46222785, "comment_id": 79408930, "body": "I suggest you add type signatures to all of your top-level names. The names of some of your values make them look like lists, but they are actually functions."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1505403063, "post_id": 46222785, "comment_id": 79409089, "body": "@4castle: I think the OP actually does not see this as functions, but as variables: the code looks more <i>imperative</i> than <i>declarative</i>."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1505404568, "creation_date": 1505404568, "answer_id": 46223606, "question_id": 46222785, "link": "https://stackoverflow.com/questions/46222785/combining-two-list-comprehensions-haskell/46223606#46223606", "title": "Combining two list comprehensions Haskell", "body": "<p>First of all, your <code>triangleNumbers</code> is a bit weird: it contains <code>Fractional</code>s, instead of <code>Integrals</code>s. This makes it more troublesome to perform accurate division calculations. So we better modify this:</p>\n\n<pre><code>triangleNumbers = [ div (a*(a+1)) 2 | a &lt;- [0..]]\n</code></pre>\n\n<p>Note that we can write the expression in the head of the list comprehension. We also use <code>div</code> over <code>/</code> since <code>div</code> is an integer division. We know for sure that we will not lose data by performing an integer division, since either <code>a</code> or <code>a+1</code> is even, and the multiplication of a number with an even number is always even. This results in the following list:</p>\n\n<pre><code>Prelude&gt; take 10 triangleNumbers \n[0,1,3,6,10,15,21,28,36,45]\n</code></pre>\n\n<p>Now we want a function that maps numbers on the divisors. We can make a generic function:</p>\n\n<pre><code>divisors x = [d | d &lt;- [1..x], mod x d == 0]\n</code></pre>\n\n<p>Now we can use <code>map</code>, to map a list of numbers to a list of lists where each list contains the divisors of the original number. So:</p>\n\n<pre><code>Prelude&gt; map divisors [1,2,3,5,8,13,21]\n[[1],[1,2],[1,3],[1,5],[1,2,4,8],[1,13],[1,3,7,21]]\n</code></pre>\n\n<p>We can however also give the <code>map divisors</code> the (infinite list) of <code>triangleNumbers</code>. For instance for the first 10 <code>triangleNumbers</code>:</p>\n\n<pre><code>Prelude&gt; take 10 $ map divisors $ triangleNumbers \n[[],[1],[1,3],[1,2,3,6],[1,2,5,10],[1,3,5,15],[1,3,7,21],[1,2,4,7,14,28],[1,2,3,4,6,9,12,18,36],[1,3,5,9,15,45]]\n</code></pre>\n\n<p>Now we only need to filter the numbers that have 501 elements or more. We can do this by checking that if we <code>drop 500</code> elements, we still have a list that contains at least one element. So with:</p>\n\n<pre><code>hasAtLeastLength :: Int -&gt; [a] -&gt; Bool\nhasAtLeastLength n = not . null . drop (n-1)\n</code></pre>\n\n<p>So now we can <code>filter</code> all the elements where the <code>hasAtLeastLengh 501 (divisors x)</code> for a number <code>x</code>. This will thus produce the list of all these numbers:</p>\n\n<pre><code>filter (hasAtLeastLength 501 . divisors) triangleNumbers\n</code></pre>\n\n<p>This will produce an infinite list of all triangleNumbers that have at least 501 divisors. We can use <code>head</code> to finally obtain the first element:</p>\n\n<pre><code>head $ filter (hasAtLeastLengh 501 . divisors) triangleNumbers\n</code></pre>\n\n<p>This takes a large amount of time. The code works however quite fast if we work with 10 divisors:</p>\n\n<pre><code>Prelude&gt; filter (hasAtLeastLength 10 . divisors) triangleNumbers\n[120,210,276,300,378,496,528,630,666,780,820,990,1035,1128,1176,1275,1326,1485,1540,1596,1770,1830,1953,2016,2080,2145,2346,2415,2556,2628,2775,2850,2926,3003,3160,3240,3321,3486,3570,3828,3916,4005,4095,4186,4278,4560,4656,4851,4950,5050,5356,5460,5565,5778,5886,6105,6216,6328,6555,6670,6786,6903,7140,7260,7626,7750,7875,8001,8128,8256,8385,8646,8778,9045,9180,9316,9730,9870,10296,10440,10731,10878,11175,11325,11476,11628,11781,11935,12090,12246,12720,12880,13041,13203,13530,13695,14028,14196,14365,14535,14706,15225,15400,15576,16110,16290,16653,16836,17020,17205,17391,17578,17766,17955,18336,18528,18915,19110,19306,19503,19701,19900,20100,20706,20910,21321,21528,21736,21945,22155,22578,23220,23436,24090,24310,24531,24976,25200,25425,25878,26106,26565,26796,27028,27261,27495,27730,27966,28203,28680,28920,29403,29646,29890,30135,30381,30628,30876,31125,31626,31878,32385,32640,32896,33411,33670,33930,34191,34716,34980,35245,35511,35778,36315,36585,36856,37128,37401,37675,37950,38226,38781,39060,39340,40470,40755,41041,41328,41616,41905,42195,42486,43071,43365,43660,43956,44253,44850,45150,46056,46360,46665,46971,47278,47586,47895,48516,48828,49455,49770,50721,51040,51360,51681,52003,52326,52650,...\n</code></pre>\n\n<p>which means that it produces an answer. This means however that you will have to come up with something smarter than simply enumerating.</p>\n"}], "owner": {"reputation": 13, "user_id": 6458952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5d91729d695cb7097a6bd8411f41df?s=128&d=identicon&r=PG&f=1", "display_name": "Athrem", "link": "https://stackoverflow.com/users/6458952/athrem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "accepted_answer_id": 46223606, "answer_count": 1, "score": 1, "last_activity_date": 1505404568, "creation_date": 1505402137, "question_id": 46222785, "link": "https://stackoverflow.com/questions/46222785/combining-two-list-comprehensions-haskell", "title": "Combining two list comprehensions Haskell", "body": "<p>I'm trying to calculate the first triangle number with 501 divisorsin Haskell. I already made two list comprehensions, one listing all the triangle numbers and one listing all divisors of a given number. Now I want to make one big list with all values divisors of each triangle number.\n(e.g. [[1],[1,3],[1,2,3,6],[1,2,5,10] etc..)</p>\n\n<p>How can I use my triangleNumbers list in my divisors list?\nMy code is below.</p>\n\n<pre><code>triangleNumbers = [t | a &lt;- [0..], let t = a*(a+1)/2] \ndivisors triangleNumbers = [d | d &lt;- [1..triangleNumbers], triangleNumbers \n`mod` d == 0]\nnumDivisors = takeWhile(&lt;501) length . divisors\nanswer = divisors !! numDivisors\n</code></pre>\n"}, {"tags": ["haskell", "routes", "yesod", "hamlet"], "answers": [{"tags": [], "owner": {"reputation": 653, "user_id": 781421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b2f2e8c54f13b3be2221299bbfaae61?s=128&d=identicon&r=PG", "display_name": "Charlie", "link": "https://stackoverflow.com/users/781421/charlie"}, "is_accepted": false, "score": 1, "last_activity_date": 1505401599, "creation_date": 1505401599, "answer_id": 46222588, "question_id": 46222578, "link": "https://stackoverflow.com/questions/46222578/route-interpolation-fails-with-type-error-in-yesod-handler/46222588#46222588", "title": "Route Interpolation fails with type error in Yesod Handler", "body": "<p>Change the type signature to <code>getHomeR :: Handler Html</code></p>\n"}, {"tags": [], "owner": {"reputation": 661, "user_id": 7720738, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HccZv.png?s=128&g=1", "display_name": "James Burton", "link": "https://stackoverflow.com/users/7720738/james-burton"}, "is_accepted": true, "score": 1, "last_activity_date": 1505502263, "creation_date": 1505502263, "answer_id": 46246030, "question_id": 46222578, "link": "https://stackoverflow.com/questions/46222578/route-interpolation-fails-with-type-error-in-yesod-handler/46246030#46246030", "title": "Route Interpolation fails with type error in Yesod Handler", "body": "<p>Your type <code>Yesod site =&gt; HandlerT site IO Html</code> allows for site to be any Yesod instance however, the handler function will only work in the site it is created for.</p>\n\n<p>In this case your Yesod instance is called App (I believe this is the default for the scaffolding site). Therefore the correct type would be:\n<code>HandlerT App IO Html</code></p>\n\n<p>Presuming you're using the scaffolding site (due to your answer mentioning <code>Handler</code>) then Yesod creates the type synonym <code>Handler</code> to mean <code>HandlerT App IO</code> so you don't have to keep typing it out.</p>\n\n<p>This is why, as you discovered, <code>Handler Html</code> works and your original version doesn't.</p>\n"}], "owner": {"reputation": 653, "user_id": 781421, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1b2f2e8c54f13b3be2221299bbfaae61?s=128&d=identicon&r=PG", "display_name": "Charlie", "link": "https://stackoverflow.com/users/781421/charlie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 46246030, "answer_count": 2, "score": 1, "last_activity_date": 1505502263, "creation_date": 1505401572, "last_edit_date": 1505403058, "question_id": 46222578, "link": "https://stackoverflow.com/questions/46222578/route-interpolation-fails-with-type-error-in-yesod-handler", "title": "Route Interpolation fails with type error in Yesod Handler", "body": "<p>I have a simple Yesod handler that renders a single Html tag like so:</p>\n\n<pre><code>getHomeR :: Yesod site =&gt; HandlerT site IO Html\ngetHomeR = defaultLayout\n  [whamlet|$newline never\n&lt;h1&gt;Hello!\n|]\n</code></pre>\n\n<p>I would like to print the route, and change the code to use the <code>@{HomeR}</code> route interpolation syntax, like this:</p>\n\n<pre><code>getHomeR :: Yesod site =&gt; HandlerT site IO Html\ngetHomeR = defaultLayout\n  [whamlet|$newline never\n&lt;h1&gt;@{HomeR}\n|]\n</code></pre>\n\n<p>Interpolating routes in my Yesod handler fails with this error:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018site\u2019 with \u2018App\u2019\n  \u2018site\u2019 is a rigid type variable bound by\n    the type signature for:\n      getHomeR :: forall site. Yesod site =&gt; HandlerT site IO Html\n    at Handler/Home.hs:12:13\n  Expected type: WidgetT\n                   site IO (Route App -&gt; [(Text, Text)] -&gt; Text)\n    Actual type: WidgetT\n                   site\n                   IO\n                   (Route (HandlerSite (WidgetT site IO)) -&gt; [(Text, Text)] -&gt; Text)\n</code></pre>\n"}, {"tags": ["haskell", "type-inference"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1505398100, "post_id": 46221316, "comment_id": 79405415, "body": "That depends on if there is a type restriction in the signature matching those symbols. Show the signature in question."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1505398143, "post_id": 46221316, "comment_id": 79405445, "body": "No, if the type variables do not occur in type constraints, these are just variables. The name of these variables is arbitrary. But sometimes a more semantical name can be useful. Like <code>n</code> for number, etc."}, {"owner": {"reputation": 4295, "user_id": 1916893, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/XTlc8.png?s=128&g=1", "display_name": "TobiMcNamobi", "link": "https://stackoverflow.com/users/1916893/tobimcnamobi"}, "edited": false, "score": 3, "creation_date": 1505398760, "post_id": 46221316, "comment_id": 79405904, "body": "Not a complete answer but maybe it helps to know that <code>foldl :: Foldable t =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b</code> is equivalent to <code>foldl :: Foldable x =&gt; (y -&gt; z -&gt; y) -&gt; y -&gt; x z -&gt; y</code> and <code>app :: [t] -&gt; t -&gt; [t]</code> is equivalent to <code>app :: [u] -&gt; u -&gt; [u]</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1505520363, "post_id": 46221316, "comment_id": 79461947, "body": "Strictly speaking, <code>t</code> does not refer to a type; it refers to a type-level function that <i>returns</i> a type."}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 5, "last_activity_date": 1505406770, "creation_date": 1505406770, "answer_id": 46224264, "question_id": 46221316, "link": "https://stackoverflow.com/questions/46221316/what-is-the-difference-between-type-a-and-type-t-in-haskell-type-signature/46224264#46224264", "title": "what is the difference between type &quot;a&quot; and type &quot;t&quot; in Haskell type signature?", "body": "<p>In Haskell type definitions, type names always start with upper-case letters, whereas type variables always start with lower-case letters. These are normally called <code>a</code>, <code>b</code>, and so on, but can also be called <code>f</code>, <code>m</code>, <code>t</code>, and so on.</p>\n\n<p>Often, the letters in the beginning of the alphabet are used for unbounded type variables, whereas you often see more specific type variables denoted with <code>f</code>, <code>m</code>, <code>t</code>, and so on.</p>\n\n<p>In the particular example</p>\n\n<pre><code>foldl :: Foldable t =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\n</code></pre>\n\n<p><code>t</code> is specifically denoted as being an instance of the <code>Foldable</code> type class. <code>t a</code> means any <code>Foldable</code> 'container' that holds values of the type <code>a</code>.</p>\n\n<p>When you look your other example</p>\n\n<pre><code>app :: [t] -&gt; t -&gt; [t]\n</code></pre>\n\n<p>it might as well have said <code>[a] -&gt; a -&gt; [a]</code>, if <code>app</code> is a 'free-standing' function. If, on the other hand, <code>app</code> belongs to a type class, that type class definition could contain a more specific definition of <code>t</code>.</p>\n"}], "owner": {"reputation": 233, "user_id": 4014698, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/eiVGm.jpg?s=128&g=1", "display_name": "alixander", "link": "https://stackoverflow.com/users/4014698/alixander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3183, "favorite_count": 0, "accepted_answer_id": 46224264, "answer_count": 1, "score": 5, "last_activity_date": 1505406770, "creation_date": 1505398044, "last_edit_date": 1505398320, "question_id": 46221316, "link": "https://stackoverflow.com/questions/46221316/what-is-the-difference-between-type-a-and-type-t-in-haskell-type-signature", "title": "what is the difference between type &quot;a&quot; and type &quot;t&quot; in Haskell type signature?", "body": "<p>is there any difference between the two types \"a\" and \"t\" in Haskell type signature or its only a different designation like type \"a\" and type \"b\"?</p>\n\n<p>in <a href=\"https://www.haskell.org/tutorial/goodies.html\" rel=\"noreferrer\">https://www.haskell.org/tutorial/goodies.html</a> type [a] is defined as followed:</p>\n\n<blockquote>\n  <p>[a] is the family of types consisting of, for every type a, the type\n  of lists of a. Lists of integers (e.g. [1,2,3]), lists of characters\n  (['a','b','c']), even lists of lists of integers, etc., are all\n  members of this family. (Note, however, that [2,'b'] is not a valid\n  example, since there is no single type that contains both 2 and 'b'.)</p>\n</blockquote>\n\n<p>is this definition also applied for type \"t\" ?</p>\n\n<p>an example might be :</p>\n\n<pre><code>foldl :: Foldable t =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\n  app :: [t] -&gt; t -&gt; [t]\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1505401094, "post_id": 46220788, "comment_id": 79407690, "body": "What does your stack.yaml file look like? Have you pulled in a new version of Cabal by any chance?"}, {"owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1505402450, "post_id": 46220788, "comment_id": 79408619, "body": "@MichaelSnoyman I updated the question with my <code>stack.yaml</code>. I did not updated Cabal, I still have the 1.24.0.2 version which came down with ghc"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1505405878, "post_id": 46220788, "comment_id": 79410973, "body": "Can you also include the output of <code>stack exec ghc-pkg list Cabal</code>? And what happens if, outside your project, you run <code>stack build --resolver lts-8.23 lens</code>?"}, {"owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1505406472, "post_id": 46220788, "comment_id": 79411351, "body": "@MichaelSnoyman edited again the question with the output of the command you suggested. If I run <code>stack build --resolver lts-8.23 lens</code> on a newly created empty folder, I get the same error"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1505406548, "post_id": 46220788, "comment_id": 79411404, "body": "It looks like you&#39;ve somehow installed Cabal-2.0.0.2 globally. Since lens-4.15.1 does not use a custom-setup stanza in its cabal file, Stack doesn&#39;t know that it is incompatible with Cabal 2. I think your easiest path forward would be to add lens-4.15.4 to your extra-deps."}, {"owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1505408812, "post_id": 46220788, "comment_id": 79412793, "body": "I removed by hand Cabal-2.0.0.2 from <code>~&#47;.stack&#47;programs&#47;x86_64-linux&#47;ghc-8.0.2&#47;lib&#47;ghc-8.0.2&#47;packa&zwnj;&#8203;ge.conf.d</code> and  everything seems to be working fine"}], "owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 227, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1505406378, "creation_date": 1505396541, "last_edit_date": 1505406378, "question_id": 46220788, "link": "https://stackoverflow.com/questions/46220788/haskell-install-error-with-stack", "title": "Haskell - install error with stack", "body": "<p>If I try to run <code>stack install lens</code> I get </p>\n\n<pre><code>lens-4.15.1: configure\n\n--  While building package lens-4.15.1 using:\n      /home/marcosh/.stack/programs/x86_64-linux/ghc-8.0.2/bin/ghc --make -odir /tmp/stack11968/lens-4.15.1/.stack-work/dist/x86_64-linux/Cabal-2.0.0.2/setup -hidir /tmp/stack11968/lens-4.15.1/.stack-work/dist/x86_64-linux/Cabal-2.0.0.2/setup -i -i. -package=Cabal-2.0.0.2 -clear-package-db -global-package-db -package-db=/home/marcosh/.stack/snapshots/x86_64-linux/lts-8.23/8.0.2/pkgdb /tmp/stack11968/lens-4.15.1/Setup.lhs /home/marcosh/.stack/setup-exe-src/setup-shim-mPHDZzAJ.hs -main-is StackSetupShim.mainOverride -o /tmp/stack11968/lens-4.15.1/.stack-work/dist/x86_64-linux/Cabal-2.0.0.2/setup/setup -threaded\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /home/marcosh/.stack/global-project/.stack-work/logs/lens-4.15.1.log\n\n    [1 of 2] Compiling Main             ( /tmp/stack11968/lens-4.15.1/Setup.lhs, /tmp/stack11968/lens-4.15.1/.stack-work/dist/x86_64-linux/Cabal-2.0.0.2/setup/Main.o )\n\n    /tmp/stack11968/lens-4.15.1/Setup.lhs:7:31: error:\n        Module\n        \u2018Distribution.Package\u2019\n        does not export\n        \u2018PackageName(PackageName)\u2019\n</code></pre>\n\n<p>I am using the following version of <code>stack</code></p>\n\n<pre><code>Version 1.5.1, Git revision 600c1f01435a10d127938709556c1682ecfd694e (4861 commits) x86_64 hpack-0.17.1\n</code></pre>\n\n<p>and version <code>8.0.2</code> of <code>GHC</code>.</p>\n\n<p>I also did a <code>stack update</code>.</p>\n\n<p>Do you have any suggestion on how to solve the issue?</p>\n\n<p>--- EDIT ---</p>\n\n<p>My global <code>stack.yaml</code> file looks like</p>\n\n<pre><code>flags: {}\nextra-package-dbs: []\npackages: []\nextra-deps: []\nresolver: lts-8.23\n</code></pre>\n\n<p>I tried to update the resolver to <code>lts-9.4</code> but I still get (other) errors</p>\n\n<p>--- EDIT 2 ---</p>\n\n<p>The output of <code>stack exec ghc-pkg list Cabal</code> is </p>\n\n<pre><code>/home/marcosh/.stack/programs/x86_64-linux/ghc-8.0.2/lib/ghc-8.0.2/package.conf.d\n    Cabal-1.24.2.0\n    Cabal-2.0.0.2\n/home/marcosh/.stack/snapshots/x86_64-linux/lts-8.23/8.0.2/pkgdb\n    (no packages)\n/home/marcosh/.stack/global-project/.stack-work/install/x86_64-linux/lts-8.23/8.0.2/pkgdb\n    (no packages)\n</code></pre>\n"}, {"tags": ["performance", "haskell", "monads", "higher-order-functions"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1505396691, "post_id": 46220709, "comment_id": 79404347, "body": "Can&#39;t reproduce. With <code>ghc-7.10 -O2</code>, I get a timing of 116 ns for both <code>frob</code> and <code>frob&#39;</code>; with <code>-O</code> it&#39;s 125 ns for each. (You <i>did</i> use optimisation flags, right?)"}, {"owner": {"reputation": 12250, "user_id": 2425163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05f4000597865eeaf51c32ed5694479c?s=128&d=identicon&r=PG", "display_name": "tarleb", "link": "https://stackoverflow.com/users/2425163/tarleb"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1505397104, "post_id": 46220709, "comment_id": 79404685, "body": "Yes, I did. GHC 8.0.2."}, {"owner": {"reputation": 12250, "user_id": 2425163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05f4000597865eeaf51c32ed5694479c?s=128&d=identicon&r=PG", "display_name": "tarleb", "link": "https://stackoverflow.com/users/2425163/tarleb"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1505398181, "post_id": 46220709, "comment_id": 79405474, "body": "@leftaroundabout since this seems unreproducible on your machine, could you do me a solid and take a look at <a href=\"https://github.com//jgm/pandoc-types/pull/30\" rel=\"nofollow noreferrer\">github.com//jgm/pandoc-types/pull/30</a>? It&#39;s the actual problem I&#39;m trying to solve here."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1505398721, "post_id": 46220709, "comment_id": 79405866, "body": "Just to be sure: when you turned on the optimisations, you also used <code>-fforce-recomp</code>? Else GHC will not do anything unless the file itself has changed."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1505399139, "post_id": 46220709, "comment_id": 79406221, "body": "You&#39;ll certainly want <code>frobM f = \\n -&gt; ...</code> and  <code>frob f = \\n -&gt; ...</code> so that those can be inlined"}, {"owner": {"reputation": 12250, "user_id": 2425163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05f4000597865eeaf51c32ed5694479c?s=128&d=identicon&r=PG", "display_name": "tarleb", "link": "https://stackoverflow.com/users/2425163/tarleb"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1505399435, "post_id": 46220709, "comment_id": 79406465, "body": "@leftaroundabout that did it! thanks a thousand!"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1505399927, "post_id": 46220709, "comment_id": 79406823, "body": "Common, this has happened to me a good couple of times."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1505400771, "post_id": 46220709, "comment_id": 79407436, "body": "@leftaroundabout Sounds like an answer :)"}], "owner": {"reputation": 12250, "user_id": 2425163, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/05f4000597865eeaf51c32ed5694479c?s=128&d=identicon&r=PG", "display_name": "tarleb", "link": "https://stackoverflow.com/users/2425163/tarleb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1505396366, "creation_date": 1505396366, "question_id": 46220709, "link": "https://stackoverflow.com/questions/46220709/why-is-specializing-a-monadic-function-with-identity-less-efficient-than-writing", "title": "Why is specializing a monadic function with Identity less efficient than writing it manually?", "body": "<p>I have need two higher-order functions, one taking a side-effect free function and the other taking a monadic function as argument:</p>\n\n<pre><code>frobM :: Monad m =&gt; (a -&gt; m a) -&gt; b -&gt; m b\nfrob :: (a -&gt; a) -&gt; b -&gt; b\n</code></pre>\n\n<p>They are very similar, the second function can be expressed using the first:</p>\n\n<pre><code>frob f = runIdentity . frobM (return . f)\n</code></pre>\n\n<p>I'd expect this to be equally efficient as writing <code>frob</code> \u201cby hand\u201d, as <code>Identity</code> is a newtype that should be deleted at compile-time. However, performance still suffers regardless, as is demonstrated by this criterion micro-benchmark:</p>\n\n<pre><code>import Criterion.Main (bench, defaultMain, nf)\nimport Data.Functor.Identity (Identity (runIdentity))\n\nmain :: IO ()\nmain = defaultMain\n       [ bench \"frob\"  $ nf (frob (+23)) 42\n       , bench \"frob'\" $ nf (frob' (+23)) 42\n       ]\n\n-- | Generalized function\nfrobM :: Monad m =&gt; (Int -&gt; m Int) -&gt; Int -&gt; m Int\nfrobM f n = f $ 2^n `mod` 1024\n\n-- | Specialized function based on the general function\nfrob' :: (Int -&gt; Int) -&gt; Int -&gt; Int\nfrob' f = runIdentity . frobM (return . f)\n\n-- | \"Hand written\" specialized function.\nfrob :: (Int -&gt; Int) -&gt; Int -&gt; Int\nfrob f n = f $ 2^n `mod` 1024\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>benchmarking frob\ntime                 676.1 ns   (673.5 ns .. 678.9 ns)\n                     1.000 R\u00b2   (1.000 R\u00b2 .. 1.000 R\u00b2)\nmean                 675.7 ns   (673.3 ns .. 677.3 ns)\nstd dev              6.600 ns   (5.984 ns .. 7.324 ns)\n\nbenchmarking frob'\ntime                 706.2 ns   (705.0 ns .. 707.9 ns)\n                     1.000 R\u00b2   (1.000 R\u00b2 .. 1.000 R\u00b2)\nmean                 705.7 ns   (704.5 ns .. 707.4 ns)\nstd dev              4.630 ns   (3.729 ns .. 6.226 ns)\n</code></pre>\n\n<p>What is causing this? Is there a way to make <code>frob'</code> as efficient as <code>frob</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1505395201, "post_id": 46220254, "comment_id": 79403099, "body": "Because your output is <code>Int</code> and here you make a claim that the type can be <i>any</i> <code>Integral</code> type."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1505395251, "post_id": 46220254, "comment_id": 79403142, "body": "You can use <code>fromIntegral :: (Integral a, Num b) =&gt; a -&gt; b</code> to convert from an <code>Int</code> to any <code>Num</code> (and all <code>Integral</code>s are <code>Num</code>s so that works)."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 1, "last_activity_date": 1505395741, "creation_date": 1505395741, "answer_id": 46220493, "question_id": 46220254, "link": "https://stackoverflow.com/questions/46220254/matching-integral-with-int-haskell/46220493#46220493", "title": "Matching Integral with Int (Haskell)", "body": "<p><code>Int</code> is an instance of integral, but so is, for example, <code>Integer</code>. Your signature is <code>a -&gt; a</code> (where <code>a</code> is an <code>Integral</code>), meaning the type of the result must be the same as the type of the input. So if you apply <code>length'</code> to an <code>Int</code>, the result should be an <code>Int</code> according to your signature, and if you apply it to an <code>Integer</code>, the result should be an <code>Integer</code>.</p>\n\n<p>Since <code>length</code> produces an <code>Int</code> as its result, the result of <code>length'</code> will also always be an <code>Int</code>, which contradicts your signature.</p>\n\n<p>One fix would be to change your signature to <code>Integral a =&gt; a -&gt; Int</code> (or the more general <code>Show a =&gt; a -&gt; Int</code>) or to add a call to <code>fromIntegral</code> to convert your <code>Int</code> to a number of the appropriate type.</p>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 4016250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7M6bY.png?s=128&g=1", "display_name": "Miksu", "link": "https://stackoverflow.com/users/4016250/miksu"}, "edited": false, "score": 0, "creation_date": 1505404706, "post_id": 46220787, "comment_id": 79410154, "body": "Oh, thanks! So in mathematical terms, all Haskell functions must be bijective?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 143, "user_id": 4016250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7M6bY.png?s=128&g=1", "display_name": "Miksu", "link": "https://stackoverflow.com/users/4016250/miksu"}, "edited": false, "score": 0, "creation_date": 1505405080, "post_id": 46220787, "comment_id": 79410441, "body": "@Miksu: no, a bijection guarantees that all input maps to output and all output has one input element. This is not always the case: you can decide to ignore certain patterns (this is however not recommended), and furthermore negative output here has no matching input (given <code>length</code> does not overflow)."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1505396540, "creation_date": 1505396540, "answer_id": 46220787, "question_id": 46220254, "link": "https://stackoverflow.com/questions/46220254/matching-integral-with-int-haskell/46220787#46220787", "title": "Matching Integral with Int (Haskell)", "body": "<p>If you write something like:</p>\n\n<pre><code>length' :: (Integral a) =&gt; a -&gt; a\n</code></pre>\n\n<p>it means that the function will work for <em>any</em> <code>a</code> where <code>Integral a</code> holds. So that means that a programmer that uses <code>length'</code> could decide to use it as: <code>length' :: Integer -&gt; Integer</code>. Since <code>length</code> however does not return an <code>Integer</code> (but an <code>Int</code>), Haskell can not provide such function <code>length'</code>.</p>\n\n<p>Your function has another problem as well: you call <code>show</code> on <code>a</code>. This means that <code>a</code> has to be an instance of the <code>Show</code> class. So you should add a type constraint <code>Show a</code>. There is no need to restrict to <code>Integral a</code>, since you can use the function for everything that is <code>Show</code>. So the type signature should be:</p>\n\n<pre><code><b>length' :: Show a =&gt; a -&gt; Int</b>\nlength' = length . show</code></pre>\n\n<p>If you want to give the user the freedom to use any <code>Num n</code> as output type, you can use the <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v:genericLength\" rel=\"nofollow noreferrer\"><strong><code>genericLength :: Num n =&gt; [a] -&gt; n</code></strong></a> function:</p>\n\n<pre><code><b>import Data.List(genericLength)</b>\n\nlength' :: (Show a, <b>Num n</b>) =&gt; a -&gt; <b>n</b>\nlength' = <b>genericLength</b> . show</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 4016250, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7M6bY.png?s=128&g=1", "display_name": "Miksu", "link": "https://stackoverflow.com/users/4016250/miksu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "accepted_answer_id": 46220787, "answer_count": 2, "score": 3, "last_activity_date": 1505396540, "creation_date": 1505395058, "question_id": 46220254, "link": "https://stackoverflow.com/questions/46220254/matching-integral-with-int-haskell", "title": "Matching Integral with Int (Haskell)", "body": "<p>I'm new to Haskell and I'm trying to get the length of a number in base 10 so I created length' function:</p>\n\n<pre><code>length' :: (Integral a) =&gt; a -&gt; a\nlength' a = length $ show a\n</code></pre>\n\n<p>But Haskell gives me \"Couldn't match type\" error because <code>length</code> returns Int. I don't get why it gives me an error since Int an instance of Integral... </p>\n"}, {"tags": ["haskell", "ghc", "typeclass", "type-families"], "answers": [{"comments": [{"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 0, "creation_date": 1505391504, "post_id": 46217665, "comment_id": 79400271, "body": "Thanks, that was eye-opening! <code>Either</code> doesn&#39;t really work here, though, because it is non-recursive: <code>IsArrow (Int -&gt; Int -&gt; Int) ~ &#39;Left &#39;(Int, Int -&gt; Int))</code>. But this variant works: <a href=\"http://lpaste.net/234466362087440384\" rel=\"nofollow noreferrer\">lpaste.net/234466362087440384</a>. Would you mind editing your answer? I did so earlier, but appearently that&#39;s not why you edit stuff on SO."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "reply_to_user": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 0, "creation_date": 1505392293, "post_id": 46217665, "comment_id": 79400890, "body": "I don&#39;t get it: <code>Either</code> works just fine (all of the code typechecks). I guess the question is whether you want to perform the whole reification ahead of time or whether you&#39;re happy with doing it on demand by making recursive calls via <code>IsArrow</code> as I do."}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 1, "creation_date": 1505392648, "post_id": 46217665, "comment_id": 79401160, "body": "Oh, in fact you&#39;re right! The type error I was experiencing was due to something completely different. I tried <code>collectArgs (\\apply -&gt; apply (+)) 4 5</code> and was thrown off by the type error (<code>No instance for (Num ())</code>) and started digging for the cause, when I hit that strange reduction. But all that was missing to get it running was a type annotation, e.g. <code>collectArgs (\\apply -&gt; apply (+)) 4 5 :: Int</code> evaluates to 9."}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 0, "creation_date": 1505407949, "post_id": 46217665, "comment_id": 79412259, "body": "By the way: Is it possible to completely discharge <code>CollectArgs</code> constraints by defining something like <code>class CollectArgs f (IsArrow f) =&gt; CollectArgs&#39; f</code> and somehow tell GHC that we always have a dictionary for that available? I don&#39;t really want this to leak into user code. I guess what I&#39;m looking for is an elegant way to package all constraints up in a user friendly manner."}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 0, "creation_date": 1505408006, "post_id": 46217665, "comment_id": 79412306, "body": "Ah, that won&#39;t work because of erasure... Still, I wonder how to package this up nicely."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "reply_to_user": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 0, "creation_date": 1505408874, "post_id": 46217665, "comment_id": 79412830, "body": "I&#39;m afraid the error messages will always be horrible: you can wrap the internals in constraint synonyms using <code>{-# LANGUAGE ConstraintKinds        #-}</code> to recover the interface you had in mind to begin with but if there&#39;s an error, they&#39;ll be unfolded in the error message :/"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "reply_to_user": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 1, "creation_date": 1505475909, "post_id": 46217665, "comment_id": 79440882, "body": "By the way, another thing you could do instead is use the notion of <a href=\"https://github.com/agda/agda/blob/master/src/full/Agda/Utils/TypeLevel.hs#L81\" rel=\"nofollow noreferrer\"><code>Domains</code></a> , <a href=\"https://github.com/agda/agda/blob/master/src/full/Agda/Utils/TypeLevel.hs#L69\" rel=\"nofollow noreferrer\"><code>Products</code> and <code>Arrows</code></a>  and <a href=\"https://github.com/agda/agda/blob/master/src/full/Agda/Utils/TypeLevel.hs#L99\" rel=\"nofollow noreferrer\"><code>Currying</code></a> to convert between them. Instead of <code>ReplaceReturnType t r</code> you&#39;d simply write <code>Products (Domains t) -&gt; r</code> or <code>Arrows (Domains t) r</code> if you want the curried form. Hopefully this would lead to clearer error messages for your users."}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 0, "creation_date": 1505490420, "post_id": 46217665, "comment_id": 79450484, "body": "That sounds like the more principled approach. Thanks for that very valuable pointer!"}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 0, "creation_date": 1505491357, "post_id": 46217665, "comment_id": 79451035, "body": "Wow, that file is pure gold. I&#39;m learning so much right now about how to properly do things at the type level in a way that I&#39;m used to."}], "tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 2, "last_activity_date": 1505387826, "creation_date": 1505387826, "answer_id": 46217665, "question_id": 46216699, "link": "https://stackoverflow.com/questions/46216699/inductive-definition-over-closed-type-family/46217665#46217665", "title": "Inductive definition over closed type family", "body": "<p>The standard trick to have these type classes that look like they are overlapping is to add a second parameter to the typeclass which will be distinct in each instance and whose value can be computed from the other ones.</p>\n\n<p>The idea distilled to its very core is as follows (we need some scary extensions like <code>UndecidableInstances</code> but that's fine: we're writing total programs):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DataKinds              #-}\n{-# LANGUAGE KindSignatures         #-}\n{-# LANGUAGE RankNTypes             #-}\n{-# LANGUAGE TypeFamilies           #-}\n{-# LANGUAGE MultiParamTypeClasses  #-}\n{-# LANGUAGE FlexibleContexts       #-}\n{-# LANGUAGE FlexibleInstances      #-}\n{-# LANGUAGE UndecidableInstances   #-}\n\ntype family IsBase arr :: Bool where\n  IsBase (a -&gt; b) = 'False\n  IsBase a        = 'True\n\nclass SillyId a b where\n  sillyId :: IsBase a ~ b =&gt; a -&gt; a\n\ninstance SillyId b (IsBase b) =&gt; SillyId (a -&gt; b) 'False where\n  sillyId f = \\x -&gt; sillyId (f x)\n\ninstance SillyId b 'True where\n  sillyId t = t\n</code></pre>\n\n<p>Now, in your case it's a bit more complicated because you not only want this extra argument to do the dispatch, you also want other type level functions to reduce based on it. The trick is simply... to define these functions in terms of that dispatch!</p>\n\n<p>Of course a type level <code>Bool</code> won't do anymore: you'll need to keep all of the information around. So instead of <code>IsBase</code> you'll have <code>IsArrow</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DataKinds              #-}\n{-# LANGUAGE FlexibleInstances      #-}\n{-# LANGUAGE InstanceSigs           #-}\n{-# LANGUAGE KindSignatures         #-}\n{-# LANGUAGE RankNTypes             #-}\n{-# LANGUAGE TypeFamilies           #-}\n{-# LANGUAGE MultiParamTypeClasses  #-}\n{-# LANGUAGE FlexibleContexts       #-}\n{-# LANGUAGE UndecidableInstances   #-}\n\ntype family IsArrow arr :: Either (*, *) * where\n  IsArrow (a -&gt; b) = 'Left '(a, b)\n  IsArrow a        = 'Right a\n\ntype family ReturnType arr where\n  ReturnType ('Left '(a, b)) = ReturnType (IsArrow b)\n  ReturnType ('Right a)      = a\n\ntype family ReplaceReturnType t r where\n  ReplaceReturnType ('Left '(a, b)) r = a -&gt; ReplaceReturnType (IsArrow b) r\n  ReplaceReturnType _               r = r\n\nclass CollectArgs f (f' :: Either (*, *) *) where\n  collectArgs :: IsArrow f ~ f' =&gt; ((forall r. ReplaceReturnType f' r -&gt; r) -&gt; ReturnType f') -&gt; f\n\ninstance CollectArgs f (IsArrow f) =&gt; CollectArgs (a -&gt; f) ('Left '(a, f)) where\n  collectArgs :: ((forall r. (a -&gt; ReplaceReturnType (IsArrow f) r) -&gt; r) -&gt; ReturnType (IsArrow f)) -&gt; a -&gt; f\n  collectArgs g a = collectArgs (\\ap -&gt; g (\\k -&gt; ap (k a)))\n\ninstance CollectArgs a ('Right a) where\n  collectArgs :: IsArrow a ~ 'Right a =&gt; ((forall r. ReplaceReturnType (IsArrow a) r -&gt; r) -&gt; a) -&gt; a\n  collectArgs f = f id\n</code></pre>\n\n<p>And voil\u00e0. You can of course define type synonyms for <code>ReplaceReturnType (IsArrow a) r</code> to make the notations a bit lighter but that's the gist of it.</p>\n"}], "owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 46217665, "answer_count": 1, "score": 1, "last_activity_date": 1505387826, "creation_date": 1505384994, "last_edit_date": 1505385300, "question_id": 46216699, "link": "https://stackoverflow.com/questions/46216699/inductive-definition-over-closed-type-family", "title": "Inductive definition over closed type family", "body": "<p>This is more or the less the functionality I want to implement:</p>\n\n<pre><code>{-# LANGUAGE DataKinds              #-}\n{-# LANGUAGE FlexibleInstances      #-}\n{-# LANGUAGE GADTs                  #-}\n{-# LANGUAGE InstanceSigs           #-}\n{-# LANGUAGE KindSignatures         #-}\n{-# LANGUAGE PolyKinds              #-}\n{-# LANGUAGE RankNTypes             #-}\n{-# LANGUAGE TypeFamilies           #-}\n{-# LANGUAGE TypeFamilyDependencies #-}\n{-# LANGUAGE TypeInType             #-}\n\ntype family ReturnType arr where\n  ReturnType (a -&gt; b) = ReturnType b\n  ReturnType a = a\n\ntype family ReplaceReturnType t r where\n  ReplaceReturnType (a -&gt; b) r = a -&gt; ReplaceReturnType b r\n  ReplaceReturnType _ r = r\n\nclass CollectArgs f where\n  collectArgs :: ((forall r. ReplaceReturnType f r -&gt; r) -&gt; ReturnType f) -&gt; f\n\ninstance CollectArgs f =&gt; CollectArgs (a -&gt; f) where\n  collectArgs :: ((forall r. (a -&gt; ReplaceReturnType f r) -&gt; r) -&gt; ReturnType f) -&gt; a -&gt; f\n  collectArgs f a = collectArgs (\\ap -&gt; f (\\k -&gt; ap (k a)))\n\ninstance (ReturnType a ~ a, ReplaceReturnType a dummy ~ dummy) =&gt; CollectArgs a where\n  collectArgs :: ((forall r. ReplaceReturnType a r -&gt; r) -&gt; a) -&gt; a\n  collectArgs f = f id\n</code></pre>\n\n<p>What I eventually want to do with this is to write functions which are polymorphic in the number of incoming arguments, while they don't have to be part of a type class definition (which would correspond to <code>printf</code> var args style). So, for example:</p>\n\n<pre><code>wrapsVariadicFunction :: (CollectArgs f) =&gt; f -&gt; Int -&gt; f\nwrapsVariadicFunction f config = collectArgs $ \\apply -&gt; \n  if odd config \n    then error \"odd config... are you nuts?!\"\n    else apply f\n</code></pre>\n\n<p>Only that the return type of <code>f</code> might not coicide with that of <code>wrapsVariadicFunction</code>.</p>\n\n<p>Now, in a perfect world where I can associate a type class with a closed type family (a closed type class, so to speak), this would be easy to implement, because the connection <code>ReplaceReturnType a r ~ r</code> would be clear. </p>\n\n<p>Since I can't state that connection, it is, quite understandably, not clear to GHC 8.2.1:</p>\n\n<pre><code>    * Could not deduce: ReplaceReturnType a r ~ r\n      from the context: (ReturnType a ~ a,\n                         ReplaceReturnType a dummy ~ dummy)\n        bound by the instance declaration\n      `r' is a rigid type variable bound by\n        a type expected by the context:\n          forall r. ReplaceReturnType a r -&gt; r\n      Expected type: ReplaceReturnType a r -&gt; r\n        Actual type: r -&gt; r\n    * In the first argument of `f', namely `id'\n      In the expression: f id\n      In an equation for `collectArgs': collectArgs f = f id\n    * Relevant bindings include\n        f :: (forall r. ReplaceReturnType a r -&gt; r) -&gt; a\n        collectArgs :: ((forall r. ReplaceReturnType a r -&gt; r) -&gt; a) -&gt; a\n   |\n29 |   collectArgs f = f id\n   |\n</code></pre>\n\n<p>A solution here would be universally quantifying over <code>dummy</code> in the instance context, but that's not possible (yet, judging from what I saw at ICFP). Also it's really cumbersome.</p>\n\n<p>So, the actual question here is: How do I associate a value-level definition with a closed type family, much like a closed type class? Or is this impossible because types cannot be erased anymore? If so, is there some other workaround?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1505370570, "post_id": 46211868, "comment_id": 79386870, "body": "Do you know about list comprehension? Or the function <code>map</code> and lambdas <code>\\x -&gt; (isUpper x, isLower x, isDigit x)</code>?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1505370904, "post_id": 46211868, "comment_id": 79387045, "body": "Btw you should change the first part of your type signature to <code>[Char]</code> or <code>String</code>. <code>[a]</code> represents a list of arbitrary elements."}], "answers": [{"tags": [], "owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "is_accepted": true, "score": 8, "last_activity_date": 1505370611, "creation_date": 1505370611, "answer_id": 46212031, "question_id": 46211868, "link": "https://stackoverflow.com/questions/46211868/using-isupper-islower-and-isdigit-in-haskell/46212031#46212031", "title": "Using isUpper, isLower, and isDigit in Haskell", "body": "<p>You need to do check on each element of the list (<code>xs</code>). Usually this kind of task is done by using <code>map</code></p>\n\n<pre><code>import Data.Char\nuppercaseList :: String -&gt; [(Bool, Bool, Bool)]\nuppercaseList xs = map (\\x -&gt; (isUpper x, isLower x, isDigit x)) xs\n</code></pre>\n\n<p>or list comprehension</p>\n\n<pre><code>uppercaseList xs = [ (isUpper x, isLower x, isDigit x) | x &lt;- xs ]\n</code></pre>\n\n<p>or write from scratch</p>\n\n<pre><code>uppercaseList [] = []\nuppercaseList (x:xs) = (isUpper x, isLower x, isDigit x) : uppercaseList xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1505373379, "creation_date": 1505373379, "answer_id": 46212798, "question_id": 46211868, "link": "https://stackoverflow.com/questions/46211868/using-isupper-islower-and-isdigit-in-haskell/46212798#46212798", "title": "Using isUpper, isLower, and isDigit in Haskell", "body": "<p>The problem with your approach:</p>\n\n<pre><code>uppercaseList xs = [(isUpper, isLower, isDigit)]\n</code></pre>\n\n<p>is that it <strong>does not take the list <code>xs</code> into account at all</strong>: it is not mentioned in the body. So that means <code>xs</code> has no impact on the output.</p>\n\n<p>What you have done ihere is constructing a list as output with <em>one</em> element: a tuple that contains <em>three functions</em> (yes these are functions, not <code>Bool</code>s).</p>\n\n<p>In order to inspect the character, you need to <em>call</em> the functions on an element of the list.</p>\n\n<p>Calling a function on a list is done with <code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code>. Map takes as first argument a function <code>f</code>, and as second argument a list of elements (for instance <code>[x1, x2, x3, x4]</code>). It applies the function <code>f</code> on all elements of the input, and generates a list <code>[f x1, f x2, f x3, f x4]</code>). This is done in a lazy manner.</p>\n\n<p>Here we thus need a function <code>f :: Char -&gt; (Bool, Bool, Bool)</code>. Based on the specifications, the function looks like:</p>\n\n<pre><code>import Data.Char(isUpper, isLower, isDigit)\n\nf :: Char -&gt; (Bool, Bool, Bool)\nf x = (isUpper x, isLower x, isDigit x)\n</code></pre>\n\n<p>We can then write:</p>\n\n<pre><code>uppercaseList :: [Char] -&gt; [(Bool, Bool, Bool)]\nuppercaseList = map f\n</code></pre>\n\n<p>Since it is weird to see a function <code>f</code> (we can of course give it a more semantical name), at the top level of a file. We can decide to scope it (or use a <em>lambda expression</em> instead):</p>\n\n<pre><code>uppercaseList :: [Char] -&gt; [(Bool, Bool, Bool)]\nuppercaseList = map f\n    where f x = (isUpper x, isLower x, isDigit x)\n</code></pre>\n"}], "owner": {"reputation": 299, "user_id": 8604329, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/34e9794ad93744d1fcf341dfb763b345?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Robbins", "link": "https://stackoverflow.com/users/8604329/matt-robbins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8064, "favorite_count": 0, "accepted_answer_id": 46212031, "answer_count": 2, "score": 5, "last_activity_date": 1505373379, "creation_date": 1505369906, "question_id": 46211868, "link": "https://stackoverflow.com/questions/46211868/using-isupper-islower-and-isdigit-in-haskell", "title": "Using isUpper, isLower, and isDigit in Haskell", "body": "<p>I am having trouble with how to use isUpper, isLower, and isDigit.  Specifically I am trying to take a string and return a list of tuples for each character in the string containing three Bool values for if the character is an uppercase letter, a lowercase letter, or a digit.  So the string \"Ab2\" would return the list [(True, False, False), (False, True, False), (False, False, True)]. This is what I have:</p>\n\n<pre><code>import Data.Char\nuppercaseList :: [a] -&gt; [(Bool, Bool, Bool)]\nuppercaseList xs = [(isUpper, isLower, isDigit)]\n</code></pre>\n\n<p>I think I need to pass the character of the string into isUpper, isLower, and isDigit, but I don't see how to. I'm sorry if this is a dumb question, but nothing I've found addresses my confusion so far.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "edited": false, "score": 2, "creation_date": 1505370131, "post_id": 46211830, "comment_id": 79386649, "body": "I think you&#39;re looking for the ScopedTypeVariables extension."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1505374641, "post_id": 46211923, "comment_id": 79389150, "body": "Or <code>[minBound .. maxBound :: a]</code>"}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": true, "score": 5, "last_activity_date": 1505370131, "creation_date": 1505370131, "answer_id": 46211923, "question_id": 46211830, "link": "https://stackoverflow.com/questions/46211830/how-can-i-specify-the-polymorphic-type-of-a-sub-expression/46211923#46211923", "title": "How can I specify the polymorphic type of a sub-expression?", "body": "<p>This is the purpose of <a href=\"https://downloads.haskell.org/~ghc/8.2.1/docs/html/users_guide/glasgow_exts.html#lexically-scoped-type-variables\" rel=\"noreferrer\">the <code>ScopedTypeVariables</code> language extension</a>. You need to do two things:</p>\n\n<ol>\n<li><p>Enable <a href=\"https://downloads.haskell.org/~ghc/8.2.1/docs/html/users_guide/glasgow_exts.html#lexically-scoped-type-variables\" rel=\"noreferrer\">the <code>ScopedTypeVariables</code> language extension</a>, probably by adding <code>{-# LANGUAGE ScopedTypeVariables #-}</code> to the top of your file.</p></li>\n<li><p>Bring the type variables into scope in <code>foo</code>\u2019s type signature using <code>forall</code>.<sup>\u2020</sup></p></li>\n</ol>\n\n<p>After making both of those changes, you should end up with this:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nfoo :: forall a. (Bounded a, Enum a) =&gt; a -&gt; Int\nfoo _ = length ([minBound .. maxBound] :: [a])\n</code></pre>\n\n<p>This should compile successfully.</p>\n\n<hr>\n\n<p><sup>\u2020 For information on why this is necessary, see <a href=\"https://stackoverflow.com/a/36989449/465378\">this answer</a>.</sup></p>\n"}], "owner": {"reputation": 1973, "user_id": 1716999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06a58106c9a1013f1ca791c46579d664?s=128&d=identicon&r=PG", "display_name": "rubystallion", "link": "https://stackoverflow.com/users/1716999/rubystallion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 46211923, "answer_count": 1, "score": 2, "last_activity_date": 1505370131, "creation_date": 1505369756, "question_id": 46211830, "link": "https://stackoverflow.com/questions/46211830/how-can-i-specify-the-polymorphic-type-of-a-sub-expression", "title": "How can I specify the polymorphic type of a sub-expression?", "body": "<p>This compiles:</p>\n\n<pre><code>foo :: (Bounded a,Enum a) =&gt; a -&gt; Int\nfoo x = length ([minBound .. x] ++ drop 1 [x .. maxBound])\n</code></pre>\n\n<p>This doesn't compile:</p>\n\n<pre><code>foo :: (Bounded a,Enum a) =&gt; a -&gt; Int\nfoo x = length ([minBound .. maxBound] :: [a])\n</code></pre>\n\n<p>I think the second example doesn't compile because the type <code>a</code> in the type signature is not the same as the one in the sub-expression's type signature. How can I make the sub-expression's type refer to the polymorphic type given above?</p>\n"}, {"tags": ["haskell", "tuples", "discrete-mathematics"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1505353379, "post_id": 46208973, "comment_id": 79381662, "body": "&quot;trying to make the composition of relations&quot;. Can you state the problem clearly in terms of lists? Also presumably <code>funComp</code> is what you have so far but it&#39;s not clear where you&#39;re stuck, it looks like it starts to do something for arguments of length 1. What should it do when <code>b &#47;= c</code>? That&#39;s a start"}, {"owner": {"reputation": 13362, "user_id": 260584, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63f9744d1d903eef5f9954fa31d25a26?s=128&d=identicon&r=PG", "display_name": "erisco", "link": "https://stackoverflow.com/users/260584/erisco"}, "edited": false, "score": 2, "creation_date": 1505354462, "post_id": 46208973, "comment_id": 79381930, "body": "I recommend you start with simpler problems and approach this one later. There are several learning resources at <a href=\"https://wiki.haskell.org/Learning_Haskell\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Learning_Haskell</a>."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 4, "last_activity_date": 1505357742, "creation_date": 1505357742, "answer_id": 46209779, "question_id": 46208973, "link": "https://stackoverflow.com/questions/46208973/composition-of-a-list-of-lists-in-haskell/46209779#46209779", "title": "Composition of a &quot;List of lists&quot; in Haskell", "body": "<p>I've included a full answer below, in the hopes that you might find it helpful.  I agree with @erisco that if you're just starting out, this problem might be a little advanced.  You might want to start with some problems that involve working with only <em>one</em> list/relation instead of combining two.  (For example, how would you make a relation antireflexive by removing all elements of the form <em>x R x</em>?  How would you produce the set of all values <em>y</em> such that <em>x R y</em> for a fixed value <em>x</em>?  Can you solve these problems both with built-in Haskell functions and from scratch?)</p>\n\n<p>Anyway, to start, you may find it helpful, just from the standpoint of making it easier to read, to use tuples to represent the relation elements, so your two example relations would be:</p>\n\n<pre><code>r1 = [(1,1),(1,2),(2,2),(2,3),(3,3),(3,4),(4,4)]\nr2 = [(1,4),(1,4),(2,3),(2,3),(3,2),(3,1),(4,1)]\n</code></pre>\n\n<p>What you are trying to do is construct is a relation consisting of all composite elements created from any ordered pair of elements from <code>r1</code> and <code>r2</code>.  This is the sort of thing a list comprehension is good for:</p>\n\n<pre><code>result = [ combine x y | x &lt;- r1, y &lt;- r2 ]\n</code></pre>\n\n<p>This expression creates a list of the result of running <code>combine x y</code> on each pair <code>x</code>,<code>y</code> from the two relations.  What should <code>combine</code> be?  Well, it takes two elements and generates their composition, so you might first try something like:</p>\n\n<pre><code>combine (a,b) (c,d) | b == c = (a,d)\n</code></pre>\n\n<p>This will type check, but <code>combine</code> is only a partial function -- it has no value for those pairs that don't combine -- so this won't get you too far.  You need a way of writing <code>combine</code> that allows you to return a combination <em>if</em> one exists but return nothing otherwise.</p>\n\n<p>The standard way to do this in Haskell is using the <code>Maybe</code> type:</p>\n\n<pre><code>combine (a,b) (c,d) | b == c = Just (a,d)\n                    | otherwise = Nothing\n</code></pre>\n\n<p>This type checks and runs, but the value of <code>result</code> looks like:</p>\n\n<pre><code>[Just (1,4),Just (1,4),Nothing,Nothing...]\n</code></pre>\n\n<p>Fortunately, there's a function in <code>Data.Maybe</code> called <code>catMaybes</code> that is exactly what we need for this situation -- it drops all the <code>Nothing</code>s and pulls the <code>Just</code> values together while dropping the literal <code>Just</code> constructors:</p>\n\n<pre><code>&gt; catMaybes result\n[(1,4),(1,4),(1,3),...]\n</code></pre>\n\n<p>There are some duplicates that should be removed, so let's remove them using <code>nub</code> from <code>Data.List</code>:</p>\n\n<pre><code>&gt; nub (catMaybes result)\n[(1,4),(1,3),(2,3),(2,2),(2,1),(3,2),(3,1),(4,1)]\n</code></pre>\n\n<p>which looks like the answer you probably wanted, though I think you missed <code>(2,3)</code> in your example output.</p>\n\n<p>The full program, slightly generalized, looks like this:</p>\n\n<pre><code>module Relations where\n\nimport Data.List\nimport Data.Maybe\n\nr1 = [(1,1),(1,2),(2,2),(2,3),(3,3),(3,4),(4,4)]\nr2 = [(1,4),(1,4),(2,3),(2,3),(3,2),(3,1),(4,1)]\n\ncombine (a,b) (c,d) | b == c = Just (a,d)\n                    | otherwise = Nothing\n\nfuncComp r1 r2\n  = nub $ catMaybes [ combine x y | x &lt;- r1, y &lt;- r2 ]\n\nresult = funcComp r1 r2\n</code></pre>\n\n<p>If you haven't already:</p>\n\n<ul>\n<li>get in the habit of at least considering list comprehensions in any situation where you're generating items from one or more existing lists</li>\n<li>read the documentation for key modules like <code>Prelude</code>, <code>Data.List</code>, and <code>Data.Maybe</code> so you familiarize yourself with the functions that are available there</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 0, "last_activity_date": 1505467990, "creation_date": 1505467990, "answer_id": 46236352, "question_id": 46208973, "link": "https://stackoverflow.com/questions/46208973/composition-of-a-list-of-lists-in-haskell/46236352#46236352", "title": "Composition of a &quot;List of lists&quot; in Haskell", "body": "<p>A lot of mathematical definitions in terms of \"set comprehensions\" have fairly direct translations to list comprehensions.  The definition of (left to right) composition of relations is:</p>\n\n<p><em>R;S = { (x,z) | (x,y) \u2208 R, (y,z) \u2208 S }</em></p>\n\n<p>That is, x is related to z in the composite if you can from x to z by hopping to some y through R, then hopping from y to z through S.</p>\n\n<p>You can translate this almost exactly -- we just need to split up the two mentions of y because you can only bind to fresh variables in a pattern.</p>\n\n<pre><code>compose r s = [ (x,z) | (x,y) &lt;- r, (y',z) &lt;- s, y == y' ]\n</code></pre>\n\n<p>To give it a type signature I would make a type synonym, then</p>\n\n<pre><code>type Relation a b = [(a,b)]\ncompose :: Relation a b -&gt; Relation b c -&gt; Relation a c\n</code></pre>\n\n<p>Notice that this is the opposite order from many definitions composition.  I just think with relations as sets of pairs it is particularly clear this direction and confusing the other way round.</p>\n"}], "owner": {"reputation": 9, "user_id": 8606215, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-45P1S9Tu70c/AAAAAAAAAAI/AAAAAAAADyA/QTJE0huPF1A/photo.jpg?sz=128", "display_name": "Diego", "link": "https://stackoverflow.com/users/8606215/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1082, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1522154788, "creation_date": 1505351152, "last_edit_date": 1522154788, "question_id": 46208973, "link": "https://stackoverflow.com/questions/46208973/composition-of-a-list-of-lists-in-haskell", "title": "Composition of a &quot;List of lists&quot; in Haskell", "body": "<p>I'm trying to make the <a href=\"https://en.wikipedia.org/wiki/Composition_of_relations\" rel=\"nofollow noreferrer\">composition of relations</a>.\nThe relations are here represented with lists.</p>\n\n<pre><code>funComp :: Ord a =&gt; [[a,a]] -&gt; [[a,a]] -&gt; [[a,a]]\nfunComp [[a,b]] [[c,d]]\n | b == c = [[a,d]]\n</code></pre>\n\n<p>for example, given:</p>\n\n<pre><code>[[1,1],[1,2],[2,2],[2,3],[3,3],[3,4],[4,4]] \n</code></pre>\n\n<p>and </p>\n\n<pre><code>[[1,4],[1,4],[2,3],[2,3],[3,2],[3,1],[4,1]]\n</code></pre>\n\n<p>should return:</p>\n\n<pre><code>[[1,4],[1,4],[1,3],[2,2],[2,1],[3,2],[3,1],[4,1]]\n</code></pre>\n"}]