[{"tags": ["performance", "haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1520464597, "post_id": 49162717, "comment_id": 85331364, "body": "What is &quot;fast enough&quot;? Can you bundle this with a self timing test?  What is the algorithm? Is changing the algorithm an option?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1520466687, "post_id": 49162717, "comment_id": 85331972, "body": "Just for reference, <code>-O3</code> does not mean &quot;make it <i>even faster</i> than <code>-O</code>&quot;, it means &quot;try some optimizations which might work but also might slow things down&quot;.  <code>-O</code> is often the best bet.  Also I don&#39;t understand how you are able to <code>.&#47;topo2.hs</code> -- was that just a typo, or do you have some binding with <code>runhaskell</code> which I believe runs in interpreted mode?  You should definitely compile to a native executable."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1520466796, "post_id": 49162717, "comment_id": 85331997, "body": "Also, if you can add the non-imperative version that would help."}, {"owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1520467588, "post_id": 49162717, "comment_id": 85332233, "body": "@ThomasM.DuBuisson I added some more info above. I&#39;m currently toying around with profiling."}, {"owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1520467627, "post_id": 49162717, "comment_id": 85332253, "body": "@luqui Thanks for that info. I compiled it to native code using <code>stack ghc -- topo.hs</code> but in that example I&#39;m running it in interpreted mode. The version which doesn&#39;t pass the online judge is definitely compiled."}, {"owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1520467863, "post_id": 49162717, "comment_id": 85332311, "body": "@ThomasM.DuBuisson I don&#39;t know what a purely functional version could look like really, because this algorithm relies on O(1) indexing into an array and in-place updates."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1520470266, "post_id": 49162717, "comment_id": 85332940, "body": "Also on the surface this algorithm looks O(n^2), because <code>getNext</code> does a linear search, and you do it once per output node. I don&#39;t know where the log n would come from, unless there is something subtle going on in the analysis.   Also recursive functions won&#39;t be inlined even if you ask them to."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1520470455, "post_id": 49162717, "comment_id": 85333000, "body": "You could improve the algorithm by keeping a running queue of nodes with indegree 0.  Each time you decrement the indegree of a node, if it has indegree 0 add it to this queue.  That would remove the linear search for such nodes in <code>getNext</code>.  If you use <code>Data.Set</code> for this queue then your sorted requirement will be met and also I believe the algorithm will actually become O(n log n) because set insertion is log n."}, {"owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1520472410, "post_id": 49162717, "comment_id": 85333493, "body": "@luqui Indeed, I made a blunder. Thanks!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1520485400, "post_id": 49162717, "comment_id": 85336821, "body": "@luqui, <code>IntSet</code> is (usually) better than <code>Set</code>. I wonder if it would make sense to store each neighbor list in an <code>IntSet</code>. Would you still need a set for the queue itself then?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1520485645, "post_id": 49162717, "comment_id": 85336904, "body": "Also, <code>-O3</code> isn&#39;t actually a thing for GHC; it just does the same as <code>-O2</code>."}, {"owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1520521239, "post_id": 49162717, "comment_id": 85357465, "body": "@dfeuer using <code>IntSet</code> instead of <code>Set</code> decreased execution time quite dramatically from 2.36 seconds to 1.83 on the example test cases, so it&#39;s now quite close to what the Rust people are getting, although it&#39;s not quite there yet. Thank you for the hint."}], "answers": [{"comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1520486009, "post_id": 49164594, "comment_id": 85337018, "body": "I\u2019d appreciate hearing why you downvoted, so I can improve the answer?"}, {"owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "edited": false, "score": 0, "creation_date": 1520486112, "post_id": 49164594, "comment_id": 85337057, "body": "I can&#39;t see that anyone downvoted this. I just accepted it as the answer to my question. Thank you indeed! I will put my code in a follow up question below."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "edited": false, "score": 0, "creation_date": 1520486891, "post_id": 49164594, "comment_id": 85337345, "body": "Glad you found it helpful! One other person didn\u2019t. Oh well."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1520487012, "post_id": 49164594, "comment_id": 85337381, "body": "I will admit to being the downvoter. I didn&#39;t like the fact that you seemed to point to I/O instinctively, despite the fact that there was an algorithmic complexity problem. I also didn&#39;t particularly appreciate the large piece of code for solving a completely different problem. I&#39;m glad your answer proved helpful to the OP, though."}, {"owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "edited": false, "score": 2, "creation_date": 1520487354, "post_id": 49164594, "comment_id": 85337506, "body": "Very helpful indeed, especially the code snippet. The algorithmic complexity hardly mattered, rather surprisingly."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1520487734, "post_id": 49164594, "comment_id": 85337643, "body": "@dfeuer My experience with profiling other code like this is that the <code>Prelude</code> I/O is extremely slow, dominates the runtime, and always needs to be changed first. And I didn\u2019t want to write a solution myself, but I did want to give a MCVE of a simpler problem. It took me a lot of trial and error to work out that skeleton for fast I/O."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1520488374, "post_id": 49164594, "comment_id": 85337872, "body": "In other words, fast I/O is a necessary but not sufficient condition to solve just about any contest problem in Haskell. And it was not at all obvious to me how to write it."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1520488995, "post_id": 49164594, "comment_id": 85338101, "body": "@dfeuer I think I will cut back on the discussion of the other problem though, and just leave the one example."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": true, "score": 3, "last_activity_date": 1520489029, "last_edit_date": 1520489029, "creation_date": 1520477459, "answer_id": 49164594, "question_id": 49162717, "link": "https://stackoverflow.com/questions/49162717/haskell-performance-topological-sort-is-not-fast-enough/49164594#49164594", "title": "Haskell performance\u2014topological sort is not fast enough", "body": "<p>If you haven\u2019t already, <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/profiling.html\" rel=\"nofollow noreferrer\">profile your program</a> by compiling with <code>-prof -fprof-auto</code> and then executing with the command-line options <code>+RTS -p</code>.  This will generate a profile <code>*.prof</code> that will tell you which functions the program is spending all its time in.  However, I can see immediately where the biggest time-waster is.  Your instincts were right: it\u2019s the I/O.</p>\n\n<p>Having done that a lot, I can guarantee you that you\u2019ll find that it\u2019s spending the vast majority of its time doing I/O.  The first thing you should always do to speed up your program is rewrite it to use fast I/O.  Haskell is a fast language, <em>when you use the right data structures.</em>  The default I/O library in the Prelude uses singly-linked lists with lazily-evaluated thunks where each node holds a single Unicode character.  That would be slow in C, too!</p>\n\n<p>I\u2019ve gotten the best results with <code>Data.ByteString.Lazy.Char8</code> when the input is ASCII, and <code>Data.ByteString.Builder</code> to generate the output.  (An alternative is <code>Data.Text</code>.)  That gets you a lazily-evaluated list of strict character buffers on input (so interactive input and output still works), and fills a single buffer on output.</p>\n\n<p>After you\u2019ve written the skeleton of the program with fast I/O, the next step is to look at your algorithm, and especially your data structures.  Use profiling to see where all the time goes.  But I\u2019d recommend you use a functional algorithm rather than trying to write imperative programs in Haskell with <code>do</code>.</p>\n\n<p>I almost always approach problems like this in Haskell with a more functional style: in particular, my <code>main</code> function is almost always something similar to:</p>\n\n<pre><code>import qualified Data.ByteString.Lazy.Char8 as B8\n\nmain :: IO()\nmain = B8.interact ( output . compute . input )\n</code></pre>\n\n<p>This makes everything except the call to <code>interact</code> a pure function, and isolates the parsing code and the formatting code so the <code>compute</code> part in the middle can be independent of that.</p>\n\n<p>Since this is an assignment and you want to solve the problem yourself, I\u2019ll refrain from refactoring the program for you, but here\u2019s an example I wrote in response to a question on another forum to perform a counting sort.  It should be suitable as a skeleton for other kinds of problems.</p>\n\n<pre><code>import Data.Array.IArray (accumArray, assocs)\nimport Data.Array.Unboxed (UArray)\nimport Data.ByteString.Builder (Builder, char7, intDec, toLazyByteString)\nimport qualified Data.ByteString.Lazy.Char8 as B8\nimport Data.Monoid ((&lt;&gt;))\n\nmain :: IO()\nmain = B8.interact ( output . compute . input ) where\n  input :: B8.ByteString -&gt; [Int]\n  input = map perLine . tail . B8.lines where\n    perLine = decode . B8.readInt\n\n    decode (Just (x, _)) = x\n    decode Nothing = error \"Invalid input: expected integer.\"\n\n  compute :: [Int] -&gt; [Int]\n  compute = concatMap expand . assocs . countingSort . map encode where\n    encode i = (i, 1)\n\n    countingSort :: [(Int, Int)] -&gt; UArray Int Int\n    countingSort = accumArray (+) 0 (lower, upper)\n\n    lower = 0\n    upper = 1000000\n\n    expand (i,c) = replicate c i\n\n  output :: [Int] -&gt; B8.ByteString\n  output = toLazyByteString . foldMap perCase where\n    perCase :: Int -&gt; Builder\n    perCase x = intDec x &lt;&gt; char7 '\\n'\n</code></pre>\n\n<p>At present, this version ran in less than half the time of anyone else\u2019s <a href=\"https://www.codechef.com/status/TSORT?sort_by=Time&amp;sorting_order=asc&amp;language=21&amp;status=15&amp;handle=\" rel=\"nofollow noreferrer\">Haskell solution for the same problem</a>, the same holds true for the actual contest problems I\u2019ve used it for, and <a href=\"https://discuss.codechef.com/questions/38114/is-it-possible-to-solve-tsort-with-haskell\" rel=\"nofollow noreferrer\">the approach generalizes</a>.</p>\n\n<p>So I suggest changing the I/O to be similar to that, first, then profiling, and coming back with the profiling output if that doesn\u2019t make enough of a difference.  This might also be a good Code Review question.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1520487125, "post_id": 49165913, "comment_id": 85337423, "body": "No, that&#39;s not a legit reason to use <code>unsafePerformIO</code>. You should perform your calculation in <code>ST</code> instead (using <code>STArray</code> rather than <code>IOArray</code>) and then just <code>runST</code> it."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1520487149, "post_id": 49165913, "comment_id": 85337428, "body": "Well, you saw what I did instead of <code>unsafePerformIO</code>. This is a great illustration of Amdahl\u2019s Law. You have to optimize the tasks that actually take all the time, and if you profile a program that uses the <code>Prelude</code> I/O functions, you\u2019ll see that that\u2019s what takes so long."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 2, "creation_date": 1520487269, "post_id": 49165913, "comment_id": 85337480, "body": "@Davislor, I don&#39;t <i>think</i> the pure <code>Array</code> interface is going to be sufficient to solve this problem efficiently. The array isn&#39;t just filled and then used read-only; it needs to be mutated throughout as the output list is generated."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1520487307, "post_id": 49165913, "comment_id": 85337492, "body": "The suggestion to use a <code>STArray</code> instead is a good one. (<code>Data.Vector</code> is also good if you have it available.) I would also recommend changing some of those other <code>do</code> blocks of imperative code to functional versions, but that\u2019s more a stylistic choice."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1520487378, "post_id": 49165913, "comment_id": 85337511, "body": "@dfeuer I do have some other code samples online that I can give as an example of <code>STArray</code>, if the OP wants. But, yes, contest problems generally do require mutability so you can\u2019t just use square-root decomposition and the like, and mutable arrays are the data structure Haskell is worst at."}, {"owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1520487639, "post_id": 49165913, "comment_id": 85337610, "body": "<code>unsafePerformIO</code> was actually completely unnecessary... @Davislor, yes I would like to see that!"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1520488238, "post_id": 49165913, "comment_id": 85337818, "body": "Here\u2019s one example: <a href=\"https://www.codechef.com/viewsolution/16169749\" rel=\"nofollow noreferrer\">codechef.com/viewsolution/16169749</a> (Problem statement: <a href=\"https://www.codechef.com/NOV17/problems/CSUBQ/\" rel=\"nofollow noreferrer\">codechef.com/NOV17/problems/CSUBQ</a>). That\u2019s only a partly-accepted solution, because there was a solution with better algorithmic complexity, but it does demonstrate one way to use <code>STArray</code>."}], "tags": [], "owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "is_accepted": false, "score": 2, "last_activity_date": 1520487900, "last_edit_date": 1520487900, "creation_date": 1520486270, "answer_id": 49165913, "question_id": 49162717, "link": "https://stackoverflow.com/questions/49162717/haskell-performance-topological-sort-is-not-fast-enough/49165913#49165913", "title": "Haskell performance\u2014topological sort is not fast enough", "body": "<p>Thanks to @Davislor's suggestions I managed to get it to be <strong>much</strong> faster and I also refactored the code for the better and now I actually have an <em>m</em> log(<em>n</em>) algorithm. Surprisingly this doesn't make that much of a difference\u2014the I/O far outweighed the suboptimal complexity of the algorithm.</p>\n\n<p>EDIT: got rid of <code>unsafePerformIO</code> and it actually runs a teeny-weeny bit faster. Plus adding <code>-XStrict</code> shaves off even more time.</p>\n\n<pre><code>{-# LANGUAGE Strict #-}\n{-# LANGUAGE LambdaCase #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# OPTIONS_GHC -O2 #-}\n\nimport Control.Monad\nimport Data.Array.IO\nimport Data.Int\nimport Data.Set (Set)\nimport qualified Data.Set as Set\nimport Data.ByteString.Builder (Builder, char7, intDec, toLazyByteString)\nimport qualified Data.ByteString.Lazy.Char8 as B8\nimport Data.Monoid ((&lt;&gt;))\n\n\ntype List = []\ntype Node = Int\ntype Edge = (Node, Node)\ntype Indegree = Int\n\nmain = B8.putStrLn =&lt;&lt; topo . map readPair . B8.lines =&lt;&lt; B8.getContents\n\nreadPair :: B8.ByteString -&gt; (Node,Node)\nreadPair str = (x,y)\n  where\n    (Just (x, str')) = B8.readInt str\n    (Just (y, _   )) = B8.readInt (B8.tail str')\n\ntopo :: List Edge -&gt; IO B8.ByteString\ntopo inp = do\n    let (numNodes, _) = head inp\n        edges         = tail inp\n    indegrees &lt;- newArray (1,numNodes) 0 :: IO (IOUArray Node Indegree)\n    neighbours &lt;- newArray (1,numNodes) [] :: IO (IOArray Node (List Node))\n\n    -- setup\n    forM_ edges $ \\(from,to) -&gt; do\n      update indegrees to (+1)\n      update neighbours from (to:)\n\n    zeroes &lt;- collectIndegreeZero [] indegrees =&lt;&lt; getBounds indegrees\n    processQueue (Set.fromList zeroes) [] numNodes indegrees neighbours\n\n  where\n    collectIndegreeZero acc indegrees (lb,ub)\n      | lb &gt; ub = return acc\n      | otherwise = do\n          indegr &lt;- readArray indegrees lb\n          let acc' = if indegr == 0 then (lb:acc) else acc\n          collectIndegreeZero acc' indegrees (lb+1,ub)\n\n    processQueue queue result numNodes indegrees neighbours = do\n        if null queue\n          then if numNodes == 0\n              then return . toLazyByteString . foldMap whitespace . reverse $ result\n              else return \"Sandro fails.\"\n          else do\n            (node,queue) &lt;- return $ Set.deleteFindMin queue\n            ns &lt;- readArray neighbours node\n            queue &lt;- foldM decrIndegrees queue ns\n            processQueue queue (node:result) (numNodes-1) indegrees neighbours\n      where\n        decrIndegrees :: Set Node -&gt; Node -&gt; IO (Set Node)\n        decrIndegrees q n = do\n            i &lt;- readArray indegrees n\n            writeArray indegrees n (i-1)\n            return $ if i == 1 then Set.insert n q else q\n\n        whitespace x = intDec x &lt;&gt; char7 ' '\n\n{-# INLINE update #-}\nupdate a i f = do\n  x &lt;- readArray a i\n  writeArray a i (f x)\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 8732651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/h8U1K.jpg?s=128&g=1", "display_name": "buggymcbugfix", "link": "https://stackoverflow.com/users/8732651/buggymcbugfix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 49164594, "answer_count": 2, "score": 2, "last_activity_date": 1520489029, "creation_date": 1520463902, "last_edit_date": 1520487757, "question_id": 49162717, "link": "https://stackoverflow.com/questions/49162717/haskell-performance-topological-sort-is-not-fast-enough", "title": "Haskell performance\u2014topological sort is not fast enough", "body": "<p>I'm a Haskell beginner and have chosen it to solve a programming task for my class, however my solution is too slow and doesn't get accepted. I'm trying to profile it and was hoping that I could get some pointers from more advanced Haskellers here.</p>\n\n<p>The only other solution in my class that got accepted so far was written in Rust. I'm sure that I should be able to achieve similar performance in Haskell and I wrote horrible imperative code in the hope of improving performance, alas to no avail.</p>\n\n<p>My first suspicion relates to <code>work</code>, where I am using <code>forever</code> to go over the in-degree array until I get an out-of-bounds exception. I was hoping for this to be tail-recursive and to compile to a <code>while (true)</code> style loop.</p>\n\n<p>My second suspicion is that I/O is perhaps slowing things down.</p>\n\n<p>EDIT: The problem has likely to do with my algorithm because I am not keeping a queue of nodes with indegree 0. Thank you @luqui.</p>\n\n<p>EDIT2: It seems that the real bottleneck was I/O, I fixed that thanks to @Davislor.</p>\n\n<p>The task is based on this: <a href=\"http://www.spoj.com/UKCPLAD/problems/TOPOSORT/\" rel=\"nofollow noreferrer\">http://www.spoj.com/UKCPLAD/problems/TOPOSORT/</a> and I am constrained to use only the libraries in the Haskell Platform.</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE LambdaCase #-}\n{-# OPTIONS_GHC -O3 #-}\n\nimport Control.Monad\nimport Data.Array.IO\nimport Data.IORef\nimport Data.Int\nimport Control.Exception\n\ntype List = []\ntype Node = Int32\ntype Edge = (Node, Node)\ntype Indegree = Int32\n\nmain = do\n  (numNodes, _) &lt;- readPair &lt;$&gt; getLine\n  edges &lt;- map readPair . lines &lt;$&gt; getContents\n  topo numNodes edges\n\n-- lower bound\n{-# INLINE lb #-}\nlb = 1\n\ntopo :: Node -&gt; List Edge -&gt; IO ()\ntopo numNodes edges = do\n    result &lt;- newIORef []\n    count &lt;- newIORef 0\n    indegrees &lt;- newArray (lb,numNodes) 0 :: IO (IOUArray Node Indegree)\n    neighbours &lt;- newArray (lb,numNodes) [] :: IO (IOArray Node (List Node))\n    forM_ edges $ \\(from,to) -&gt; do\n      update indegrees to (+1)\n      update neighbours from (to:)\n    let work = forever $ do\n          z &lt;- getNext indegrees\n          modifyIORef' result (z:)\n          modifyIORef' count (+1)\n          ns &lt;- readArray neighbours z\n          forM_ ns $ \\n -&gt; update indegrees n pred\n    work `catch`\n      \\(_ :: SomeException) -&gt; do\n        count &lt;- readIORef count\n        if numNodes == count\n          then (mapM_ (\\n -&gt; putStr (show n ++ \" \")) . reverse) =&lt;&lt; readIORef result\n          else putStrLn \"Sandro fails.\"\n\n\n{-# INLINE update #-}\nupdate a i f = do\n  x &lt;- readArray a i\n  writeArray a i (f x)\n\n{-# INLINE getNext #-}\ngetNext indegrees = getNext' indegrees =&lt;&lt; getBounds indegrees\n\n{-# INLINE getNext' #-}\ngetNext' indegrees (lb,ub) = readArray indegrees lb &gt;&gt;= \\case\n    0 -&gt; writeArray indegrees lb (-1) &gt;&gt; return lb\n    _ -&gt; getNext' indegrees (lb+1,ub)\n\nreadPair :: String -&gt; (Node,Node)\n{-# INLINE readPair #-}\nreadPair = toPair . map read . words\n  where toPair [x,y] = (x,y)\n        toPair _ = error \"Only two entries per line allowed\"\n</code></pre>\n\n<p>Example output</p>\n\n<pre><code>$ ./topo\n8 9\n1 4\n1 2\n4 2\n4 3\n3 2\n5 2\n3 5\n8 2\n8 6\n^D\n1 4 3 5 7 8 2 6\n</code></pre>\n"}, {"tags": ["list", "sorting", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1520463964, "post_id": 49162684, "comment_id": 85331130, "body": "in this case, <code>merge xs ys = sort (xs++ys)</code>."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1520465003, "post_id": 49162684, "comment_id": 85331477, "body": "or indeed <code>merge = (sort .) . (++)</code>"}], "tags": [], "owner": {"reputation": 11, "user_id": 5235646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf561ec6ac077db2614645ee619253b1?s=128&d=identicon&r=PG&f=1", "display_name": "binaryjigsaw", "link": "https://stackoverflow.com/users/5235646/binaryjigsaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1520463761, "creation_date": 1520463761, "answer_id": 49162684, "question_id": 49162241, "link": "https://stackoverflow.com/questions/49162241/ordering-an-ordered-list-function-in-haskell/49162684#49162684", "title": "Ordering an Ordered list Function in Haskell", "body": "<p>So your current solution will return a sorted list if both input lists are sorted. If the input lists aren't sorted, you've got 2 options, sort the input lists individually, then merge them as you are already, or merge them unsorted, and sort the new list.</p>\n\n<p>It seems more reasonable to merge unsorted lists and then sort them as one, so here is the solution. I've used a quick implementation of quicksort, but you could use whatever sorting algorithm you wish.</p>\n\n<pre><code>--takes 2 sorted or unsorted lists, merges them, then sorts them\nmerge :: (Ord a) =&gt; [a] -&gt; [a] -&gt; [a]\nmerge [] [] = []\nmerge x [] = sort x\nmerge [] y = sort y\nmerge x y = sort (x ++ y)\n\n-- where first element of list is pivot\nsort :: (Ord a) =&gt; [a] -&gt; [a]\nsort [] = []\nsort (x:xs) = sort [x'|x'&lt;-xs, x'&lt;=x] ++ [x] ++ sort [x'|x'&lt;-xs, x'&gt;x]\n</code></pre>\n\n<p>There are many ways to do this, and this way has the downside of having to resort the list even if the lists were already sorted. You could get around this by checking if lists are sorted, then sorting them if needed. I hope this answer helps.</p>\n"}, {"tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": false, "score": 3, "last_activity_date": 1520492712, "last_edit_date": 1520492712, "creation_date": 1520464963, "answer_id": 49162914, "question_id": 49162241, "link": "https://stackoverflow.com/questions/49162241/ordering-an-ordered-list-function-in-haskell/49162914#49162914", "title": "Ordering an Ordered list Function in Haskell", "body": "<p>It sounds like what you're actually supposed to implement is <a href=\"https://en.wikipedia.org/wiki/Merge_sort\" rel=\"nofollow noreferrer\">merge sort</a>. </p>\n\n<p>In merge sort you merge two sorted list to get one sorted list, yes. The missing observation is that a list of size 0 or 1 is necessarily already sorted.</p>\n\n<p>This means that if you start applying your function to lists that are of size 0 or 1, then merge the results of that merge, then merge the result of that, eventually you will end up with a fully sorted list.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>-- Your function\nmerge :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nmerge x [] = x\nmerge [] x = x\nmerge (x:xs) (y:ys) = if x &lt; y\n                          then x:(merge xs (y:ys))\n                          else y:(merge (x:xs) ys)\n\n\n-- Arbitrarily split a list into two ~equally sized smaller lists.\n-- e.g. [2,7,1,8,2] -&gt; ([2,7,1], [8,2])\nsplit list = splitAt ((length list) `div` 2) list\n\n-- Split a list into halves until each piece is size 0 or 1,\n-- then 'merge' them back together.\nmergeSort [] = []\nmergeSort [x] = [x]\nmergeSort list =\n    let (firstHalf, secondHalf) = split list\n    in merge (mergeSort firstHalf) (mergeSort secondHalf)\n</code></pre>\n\n<p><code>mergeSort [2,7,1,8,2]</code> will evaluate to <code>[1,2,2,7,8]</code>. Using only your <code>merge</code> function, the list has been sorted.</p>\n"}, {"tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": false, "score": 0, "last_activity_date": 1520479851, "creation_date": 1520479851, "answer_id": 49164920, "question_id": 49162241, "link": "https://stackoverflow.com/questions/49162241/ordering-an-ordered-list-function-in-haskell/49164920#49164920", "title": "Ordering an Ordered list Function in Haskell", "body": "<p>For a problem like merge sort, you want to divide-and-conquer so that your input lists are always ordered.  One way to do this by breaking the input down into singletons, which are always ordered by definition, then making your merge function tail-recursively insert whichever of the two list heads is smaller.  When one input list is finally empty, it appends the other.</p>\n"}], "owner": {"reputation": 67, "user_id": 4729595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153211906528464/picture?type=large", "display_name": "Mike Noel Higgs", "link": "https://stackoverflow.com/users/4729595/mike-noel-higgs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 634, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1520492712, "creation_date": 1520461637, "last_edit_date": 1520476778, "question_id": 49162241, "link": "https://stackoverflow.com/questions/49162241/ordering-an-ordered-list-function-in-haskell", "title": "Ordering an Ordered list Function in Haskell", "body": "<p>for my coursework I have to take two lists of numbers, sort them and then combine them and output the new list in order, this works if the lists are already in order as they are typed but not if say a 9 is at the start of a first list so the trouble I'm having is sorting the list after it's combined, in other languages I'd do this with a for loop, but not sure in Haskell\nhere the code I have: </p>\n\n<pre><code>merge :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nmerge x [] = x\nmerge [] x = x\nmerge (x:xs) (y:ys) = if x &lt; y\n                          then x:(merge xs (y:ys))\n                          else y:(merge (x:xs) ys)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "edited": false, "score": 0, "creation_date": 1520462578, "post_id": 49162125, "comment_id": 85330597, "body": "First, <code>putStrLn</code> take only one argument. If you use <code>++</code>, makes sure to warp the argument. So, write it as <code>putStrLn (...)</code> or <code>putStrLn $ ...</code>. Second, just like <code>putStrLn</code>, <code>head</code> also take only one argument."}, {"owner": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "edited": false, "score": 0, "creation_date": 1520462955, "post_id": 49162125, "comment_id": 85330726, "body": "Don&#39;t forget that <code>head :: [a] -&gt; a</code>. The String is a List of Char. If you take its head, it will be a Char."}, {"owner": {"reputation": 1255, "user_id": 433168, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e257008a27d31126a51c3277a2931518?s=128&d=identicon&r=PG", "display_name": "Jim Wharton", "link": "https://stackoverflow.com/users/433168/jim-wharton"}, "reply_to_user": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "edited": false, "score": 0, "creation_date": 1520463321, "post_id": 49162125, "comment_id": 85330875, "body": "<code>putStrLn (&quot;Biff tossed&quot; ++ head (shuffleM getTosses))</code> does give me a type error like you mention. What is the proper way to print a Char? Do I need to use <code>show</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1255, "user_id": 433168, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e257008a27d31126a51c3277a2931518?s=128&d=identicon&r=PG", "display_name": "Jim Wharton", "link": "https://stackoverflow.com/users/433168/jim-wharton"}, "edited": false, "score": 0, "creation_date": 1520463749, "post_id": 49162625, "comment_id": 85331046, "body": "This works! So to understand better. You&#39;re using a block here, and using the <code>$</code> operator to ensure that the string concatenation is evaluated first. The fact that head of <code>shuffled</code> is a Char doesn&#39;t seem to be causing an issue though..."}, {"owner": {"reputation": 1255, "user_id": 433168, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e257008a27d31126a51c3277a2931518?s=128&d=identicon&r=PG", "display_name": "Jim Wharton", "link": "https://stackoverflow.com/users/433168/jim-wharton"}, "edited": false, "score": 0, "creation_date": 1520463834, "post_id": 49162625, "comment_id": 85331076, "body": "Thank you for that explanation!"}, {"owner": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "reply_to_user": {"reputation": 1255, "user_id": 433168, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e257008a27d31126a51c3277a2931518?s=128&d=identicon&r=PG", "display_name": "Jim Wharton", "link": "https://stackoverflow.com/users/433168/jim-wharton"}, "edited": false, "score": 1, "creation_date": 1520463843, "post_id": 49162625, "comment_id": 85331080, "body": "I&#39;ve edited the answer. Well, you are right. It seems the Char thing I&#39;ve mentioned before not really a problem."}], "tags": [], "owner": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "is_accepted": true, "score": 1, "last_activity_date": 1520558657, "last_edit_date": 1520558657, "creation_date": 1520463468, "answer_id": 49162625, "question_id": 49162125, "link": "https://stackoverflow.com/questions/49162125/how-can-i-print-the-first-value-in-a-shuffled-list/49162625#49162625", "title": "How can I print the first value in a shuffled list?", "body": "<p>Try this.</p>\n\n<pre><code>toss :: IO ()\ntoss = do\n    shuffled &lt;- shuffleM getTosses\n    putStrLn $ \"Biff tossed\" ++ head shuffled\n</code></pre>\n\n<p>The main problem is that <code>shuffleM</code> has kind of type <code>MonadRandom m =&gt; [a] -&gt; m [a]</code>. As you can see, <code>m</code> is a <code>MonadRandom</code>. You can't pass a wrapped value as <em>monad</em> directly to a pure function such as <code>head</code> since <code>head</code> has kind of type <code>[a] -&gt; a</code>. We need to <em>unwrap</em> the <code>MonadRandom</code>. One of many ways to solve this is using <code>&lt;-</code> keyword.</p>\n"}], "owner": {"reputation": 1255, "user_id": 433168, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e257008a27d31126a51c3277a2931518?s=128&d=identicon&r=PG", "display_name": "Jim Wharton", "link": "https://stackoverflow.com/users/433168/jim-wharton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 49162625, "answer_count": 1, "score": 0, "last_activity_date": 1520558657, "creation_date": 1520461092, "last_edit_date": 1520461239, "question_id": 49162125, "link": "https://stackoverflow.com/questions/49162125/how-can-i-print-the-first-value-in-a-shuffled-list", "title": "How can I print the first value in a shuffled list?", "body": "<p>I'm trying to learn the idiomatic Haskell way to shuffle a list and take the first value off the head. I'm not even sure where in my program I should be doing this. So far, I've moved the logic to here:</p>\n\n<pre><code>-- {-# LANGUAGE UnicodeSyntax #-}\nmodule RPS\n    ( toss\n    ) where\n\nimport System.Random.Shuffle\nimport Data.List\n\ntoss :: IO ()\ntoss =\n    -- This doesn't actually work\n    -- but I'd like to shuffle the list returned by\n    -- getTosses and pull the first element out\n    putStrLn \"Biff tossed\" ++ head shuffleM getTosses\n\ngetScissors :: [String]\ngetScissors =\n    scissors where scissors = replicate 10 \"\u2702\ufe0f\"\n\ngetPaper :: [String]\ngetPaper =\n    paper where paper = replicate 10 \"\ud83d\udcdd\"\n\ngetRocks :: [String]\ngetRocks =\n    rocks where rocks = replicate 10 \"\ud83d\uddff\"\n\ngetPossibilities :: [String] -&gt; [String] -&gt; [String] -&gt; [String]\ngetPossibilities rocks paper scissors =\n    rocks ++ paper ++ scissors\n\ngetTosses :: [String]\ngetTosses =\n    getPossibilities getRocks getPaper getScissors\n</code></pre>\n\n<p>While running this module in GHCi, I get</p>\n\n<pre><code>src/RPS.hs:11:36: error:\n    \u2022 Couldn't match expected type \u2018[[String] -&gt; [a1]]\u2019\n                  with actual type \u2018[a0] -&gt; m0 [a0]\u2019\n    \u2022 Probable cause: \u2018shuffleM\u2019 is applied to too few arguments\n      In the first argument of \u2018head\u2019, namely \u2018shuffleM\u2019\n      In the second argument of \u2018(++)\u2019, namely \u2018head shuffleM getTosses\u2019\n      In the expression:\n</code></pre>\n\n<p>The odd thing is, I can run <code>shuffleM getTosses</code> in GHCi just fine... it's only when I try to actually do that in a source file and then load that, that this fails. I've read that the shuffle monad only works in the context of IO, so I can't just shuffle a list in one of my other functions. I'm not sure if there's a better way.</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "edited": false, "score": 0, "creation_date": 1616680417, "post_id": 49161845, "comment_id": 118083057, "body": "I wrote an article describing a better approach here: <a href=\"https://jezenthomas.com/rewriting-routes-in-yesod/\" rel=\"nofollow noreferrer\">jezenthomas.com/rewriting-routes-in-yesod</a>"}], "answers": [{"comments": [{"owner": {"reputation": 685, "user_id": 3222117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uEbIs.jpg?s=128&g=1", "display_name": "Alexandre Lucchesi", "link": "https://stackoverflow.com/users/3222117/alexandre-lucchesi"}, "edited": false, "score": 0, "creation_date": 1520699433, "post_id": 49184282, "comment_id": 85427151, "body": "Thanks for replying! Indeed, a simple redirect is a nice workaround... :)"}], "tags": [], "owner": {"reputation": 111, "user_id": 4143607, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d47998d333f661a50f1fb1d5cbff098?s=128&d=identicon&r=PG", "display_name": "Daniel Campoverde - alx741", "link": "https://stackoverflow.com/users/4143607/daniel-campoverde-alx741"}, "is_accepted": true, "score": 2, "last_activity_date": 1520552059, "creation_date": 1520552059, "answer_id": 49184282, "question_id": 49161845, "link": "https://stackoverflow.com/questions/49161845/how-to-change-the-urls-of-a-subsite-in-yesod/49184282#49184282", "title": "How to change the URLs of a subsite in Yesod?", "body": "<p>Currently the <code>YesodAuth</code> datatype doesn't provide a way to change those routes, so you have two options as far as I know:</p>\n\n<ol>\n<li><p>Have a local copy of <code>yesod-auth</code> and modify it according to your needs (What you're doing right know)</p></li>\n<li><p>Have the routes you want in <code>config/routes</code> and a handler for each of them that will redirect to the <code>yesod-auth</code> routes:</p></li>\n</ol>\n\n<p><strong>config/routes</strong></p>\n\n<pre><code>/entrar MyauthEntrarR GET\n</code></pre>\n\n<p><strong>src/Handler/Myauth</strong></p>\n\n<pre><code>getMyauthEntrar :: Handler Html\n\ngetMyauthEntrar = redirect LoginR\n</code></pre>\n"}], "owner": {"reputation": 685, "user_id": 3222117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uEbIs.jpg?s=128&g=1", "display_name": "Alexandre Lucchesi", "link": "https://stackoverflow.com/users/3222117/alexandre-lucchesi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 49184282, "answer_count": 1, "score": 7, "last_activity_date": 1520552059, "creation_date": 1520459594, "question_id": 49161845, "link": "https://stackoverflow.com/questions/49161845/how-to-change-the-urls-of-a-subsite-in-yesod", "title": "How to change the URLs of a subsite in Yesod?", "body": "<p>Is it possible to rename the endpoints of a subsite in Yesod?</p>\n\n<p>For instance, instead of using the provided <a href=\"https://github.com/yesodweb/yesod/blob/master/yesod-auth/Yesod/Auth/Routes.hs\" rel=\"noreferrer\">/login</a> or <a href=\"https://www.stackage.org/haddock/lts-10.8/yesod-auth-1.4.21/Yesod-Auth-Email.html\" rel=\"noreferrer\">/email/register</a> from <a href=\"https://www.stackage.org/lts-10.8/package/yesod-auth-1.4.21\" rel=\"noreferrer\">yesod-auth</a>, I want to call them \"/entrar\" and \"/cadastrar\" (their PT-BR counterparts, respectively).</p>\n\n<p>The only way I managed to do that was by setting my <code>stack.yaml</code> to use a modified local copy of <code>yesod-auth</code>, but I wonder if there's a better approach.</p>\n"}, {"tags": ["haskell", "visual-studio-code", "cabal"], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1520458617, "post_id": 49161488, "comment_id": 85328883, "body": "N.B. <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#editing-the-cabal-file\" rel=\"nofollow noreferrer\">The docs</a>"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520491514, "post_id": 49161488, "comment_id": 85339038, "body": "I have tried with this solution too but still the same problem."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520522231, "post_id": 49161488, "comment_id": 85358208, "body": "@BercoviciAdrian Could not reproduce. Show us the version of <code>console.cabal</code> that you believe has my proposed fix included but still produces those messages."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520533004, "post_id": 49161488, "comment_id": 85365126, "body": "@BercoviciAdrian You changed two things: you removed your <code>build-depends:</code> line (why??) and you moved the <code>other-modules:</code> line. Don&#39;t do that. Leave the <code>build-depends:</code> line as it was, and <i>only</i> move <code>other-modules</code> into the <code>Executable console</code> stanza."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520533501, "post_id": 49161488, "comment_id": 85365434, "body": "Ok so this should do it?Because if yes it does not."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520533641, "post_id": 49161488, "comment_id": 85365529, "body": "@BercoviciAdrian Works for me. What is the exact error you are getting now? What does <code>tree</code> say?"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520533871, "post_id": 49161488, "comment_id": 85365669, "body": "Ok so now it is funny.When running cabal build it does build.When i am running stack ghci --test --no-load --no-build --main-is TARGET --ghci-options -fprint-evld-with-show in &lt;project path&gt; i get : Failed to load interface for <code>Test&#39;     Use -v to see a list of the files searched for. Failed, modules loaded: none. H&gt;&gt;= :module + *Main &lt;no location info&gt;: error:     Could not find module </code>Main&#39;     It is not a module in the current program, or in any known package."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520534714, "post_id": 49161488, "comment_id": 85366160, "body": "Ok so i now i tried Stack -build and Stack run and it works.But i have to do it manually from the console whereas with VS-Code i was just pressing F5"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520534791, "post_id": 49161488, "comment_id": 85366213, "body": "When pressing &quot;F5&quot; this command is executed which still gives me the dreaded error  : stack ghci --test --no-load --no-build --main-is TARGET --ghci-options -fprint-evld-with-show in C:\\Users\\&lt;path&gt;"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1520536091, "post_id": 49161488, "comment_id": 85366901, "body": "@BercoviciAdrian That sounds like a completely separate question to me. Feel free to open up a fresh post with further details!"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520536516, "post_id": 49161488, "comment_id": 85367122, "body": "I will do that, thank you for helping me,and for your patience!"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1520536740, "post_id": 49161488, "comment_id": 85367217, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/166487/discussion-between-bercovici-adrian-and-daniel-wagner\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1520457994, "creation_date": 1520457994, "answer_id": 49161488, "question_id": 49161463, "link": "https://stackoverflow.com/questions/49161463/haskell-failed-to-load-interface-for-module/49161488#49161488", "title": "Haskell Failed to load interface for module", "body": "<p>The <code>other-modules:</code> directive must go inside the <code>Executable console</code> stanza.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 955, "favorite_count": 0, "accepted_answer_id": 49161488, "answer_count": 1, "score": 2, "last_activity_date": 1520533490, "creation_date": 1520457871, "last_edit_date": 1520533490, "question_id": 49161463, "link": "https://stackoverflow.com/questions/49161463/haskell-failed-to-load-interface-for-module", "title": "Haskell Failed to load interface for module", "body": "<p>Hello i am trying to use a module inside another module but it seems it just won't work.I tried updating the cabal file,stack,i reinstalled the platform,ghc and everything and it just won't let it import modules.I tried adding in the cabal file both other-modules and home-modules section ..to no effect.What could be the problem?</p>\n\n<p>Modules:</p>\n\n<pre><code>module Test where\n\n\n    test::IO()\n    test=do\n        elem&lt;-getLine\n        print elem\n\n\nmodule Main where\n\nimport Test\n\nmain :: IO ()\nmain = do\n  putStrLn \"hello world\"\n</code></pre>\n\n<p>Cabal-build renders this error:</p>\n\n<p>$ cabal build</p>\n\n<pre><code>Resolving dependencies...\nConfiguring console-0.1.0.0...\nWarning: To use the 'default-language' field the package needs to specify at\nleast 'cabal-version: &gt;= 1.10'.\nPreprocessing executable 'console' for console-0.1.0.0..\nBuilding executable 'console' for console-0.1.0.0..\n\n&lt;no location info&gt;: warning: [-Wmissing-home-modules]\n    These modules are needed for compilation but not listed in your .cabal file's other-modules: Test\n\n&lt;no location info&gt;: warning: [-Wmissing-home-modules]\n    These modules are needed for compilation but not listed in your .cabal file's other-modules: Test\n</code></pre>\n\n<p>When i build with Stack i get this error:</p>\n\n<pre><code>C:\\&lt;path&gt;\\Main.hs:4:1: error:\n    Failed to load interface for `Test'\n    Use -v to see a list of the files searched for.\nFailed, modules loaded: none.\nH&gt;&gt;= :module + *Main\n</code></pre>\n\n<p>Cabal file:</p>\n\n<pre><code> name:                console\nversion:             0.1.0.0\n-- synopsis:\n-- description:\nhomepage:            https://github.com/githubuser/console#readme\nlicense:             BSD3\nlicense-file:        LICENSE\nauthor:              Bercovici Adrian Simon\nmaintainer:          example@example.com\ncopyright:           2018 Bercovici Adrian Simon\ncategory:            Web\nbuild-type:          Simple\ncabal-version:       &gt;=1.2\nextra-source-files:  README.md\n\n\nExecutable console\n  hs-source-dirs:      src\n  main-is:             Main.hs\n  default-language:    Haskell2010\n\n  build-depends:       base                  &gt;= 4.7    &amp;&amp; &lt; 5\n  other-modules:       Test\n</code></pre>\n"}, {"tags": ["function", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1520451020, "post_id": 49159691, "comment_id": 85324944, "body": "I&#39;m a bit curious why you have the idea that this would work. It contains some parts that are quite good, but some parts are simply invalid Haskell. So perhaps it is worth isolating the good parts, and trying to rebuild the rest."}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 4729595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153211906528464/picture?type=large", "display_name": "Mike Noel Higgs", "link": "https://stackoverflow.com/users/4729595/mike-noel-higgs"}, "is_accepted": false, "score": 0, "last_activity_date": 1520461705, "creation_date": 1520461705, "answer_id": 49162260, "question_id": 49159691, "link": "https://stackoverflow.com/questions/49159691/haskell-perfect-number-take-a-given-number-check-if-it-is-a-perfect/49162260#49162260", "title": "Haskell Perfect Number - take a given number check if it is a perfect", "body": "<p>solved this as:</p>\n\n<pre><code>perfect :: Integral a =&gt; a -&gt; Bool\nperfect n = n == sum [i | i &lt;- [1..n-1], n `mod` i == 0]\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 4729595, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153211906528464/picture?type=large", "display_name": "Mike Noel Higgs", "link": "https://stackoverflow.com/users/4729595/mike-noel-higgs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1440, "favorite_count": 0, "closed_date": 1520476637, "answer_count": 1, "score": 0, "last_activity_date": 1520461705, "creation_date": 1520450352, "question_id": 49159691, "link": "https://stackoverflow.com/questions/49159691/haskell-perfect-number-take-a-given-number-check-if-it-is-a-perfect", "closed_reason": "Duplicate", "title": "Haskell Perfect Number - take a given number check if it is a perfect", "body": "<p>Really not very good at this language and I need to make a function that can check if a number is perfect, this is what I have so far but it isn't working.</p>\n\n<pre><code>   import System.IO\n\nmain = do\nputStrLn \"Please enter a number: \"\nn &lt;- getLine\nperfectnumber n = let n == sum [i | i &lt;- [1..n-1], n `mod` i == 0]\n</code></pre>\n"}, {"tags": ["haskell", "opengl"], "comments": [{"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 0, "creation_date": 1520453016, "post_id": 49159030, "comment_id": 85326001, "body": "Really cool examples. I&#39;m not an OpenGL expert, but I played with it a while back. iirc, you need to create a shader which involves compiling a bit of code in a special shader language. see Graphics.Rendering.OpenGL.GL.Shaders."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 0, "creation_date": 1520453856, "post_id": 49159030, "comment_id": 85326448, "body": "Thank you @user2297560. I&#39;m not an expert as well and yet I dont know whar are the shaders."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1520456703, "post_id": 49159030, "comment_id": 85327935, "body": "It might be working but just not do what you&#39;re expecting, and might not have any effect in the example scene you&#39;ve created.  Shininess is just about the size of the specular point in lighting, it doesn&#39;t create reflections or anything.  <a href=\"https://www.opengl.org/discussion_boards/showthread.php/128310-Shininess\" rel=\"nofollow noreferrer\">More here</a>"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1520458573, "post_id": 49159030, "comment_id": 85328864, "body": "Thanks @luqui. Unfortunately it&#39;s not easy for me to understand such discussions. .By the way I&#39;m also using the R package rgl which is also a wrapper of OpenGL and I&#39;m wondering how the author deals with the shininess. Unfortuntaly the code is hard.To come back to your comment, I should say that I&#39;m a bit lost with all stuff dealing with the lighting. I often try at random until I reach what I want."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1520461627, "post_id": 49159030, "comment_id": 85330194, "body": "@St&#233;phaneLaurent I don&#39;t think that&#39;s necessarily a bad way -- you can read about the math of lighting but I&#39;m not sure it gives an intuition for what it looks like in practice.  Though it does help to know what the different terms mean.  Might be worth it to read a tutorial specifically about lighting <a href=\"http://www.falloutsoftware.com/tutorials/gl/gl8.htm\" rel=\"nofollow noreferrer\">like this one</a> (I haven&#39;t read it, just skimmed it) to get a structured sense of the different components."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1520462837, "post_id": 49159030, "comment_id": 85330684, "body": "Thanks for the link @luqui. Looks not bad. I agree it&#39;s necessary to read a tuto at a certain step."}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520474978, "post_id": 49163089, "comment_id": 85334067, "body": "Thanks. Ive tried quickly but didn&#39;t see any difference. I will try later on a sphere. I didnt know &quot;model OpenGL&quot;."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520475750, "post_id": 49163089, "comment_id": 85334246, "body": "Sorry but I didn&#39;t manage to get the whiteness. I&#39;ve edited my post to include an example to show what I mean."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520518949, "post_id": 49163089, "comment_id": 85355738, "body": "I added a couple of examples from your code to show the effect."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520523719, "post_id": 49163089, "comment_id": 85359236, "body": "Thanks a lot! Ill try later. That&#39;s very kind."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520606913, "post_id": 49163089, "comment_id": 85397383, "body": "Hmm sorry but I didn&#39;t manage yet. I&#39;ve tried with the horse saddle, which is very curved. Where do you put this code exactly ? Is it ok to put it in the main function ? Or should I put it where I do <code>renderPrimitive</code> ?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520607208, "post_id": 49163089, "comment_id": 85397565, "body": "Oh wait I think I get it now. Thats because I had <code>specular (Light 0) $= black</code>, and I switched to <code>specular (Light 0) $= white</code>. Now I see a difference (slight difference by the way)."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1520519111, "last_edit_date": 1520519111, "creation_date": 1520466129, "answer_id": 49163089, "question_id": 49159030, "link": "https://stackoverflow.com/questions/49159030/shininess-with-haskell-opengl/49163089#49163089", "title": "Shininess with Haskell Opengl", "body": "<p><strong>Update</strong>: Try shininess of 1.0 to see the difference more clearly at low resolutions.</p>\n\n<p>The shininess parameter affects the sharpness of specular lighting, so you need to turn this type of lighting on for your materials by giving them a specular color.  (By default, the specular color is black, so the effect of the shininess parameter will not be visible.)  You'll also want to reduce the shininess value for this scene, because it's too high to be very visible.</p>\n\n<p>Try:</p>\n\n<pre><code>materialSpecular Front $= white\nmaterialShininess Front $= 1.0\n</code></pre>\n\n<p>and you'll start to see white highlights, particularly along the curved edges of your shape.  The flat faces will also reflect some white light, but only when they are nearly perpendicular to a line that's mid-angle between the viewer and the light source -- it's a little complicated.</p>\n\n<p>Note that the specular color of most materials is taken to be some \"multiple\" of white (i.e., somewhere between black for a perfectly dull material to white for the shiniest materials in the scene).  The only materials with tinted specular color would be colored metals, like gold or bronze.</p>\n\n<p>Some additional notes:</p>\n\n<ul>\n<li>You're using old-style OpenGL 2.1 shading, not \"modern OpenGL\", so you don't have to worry so much about the \"shaders\" that @user2297560 is talking about.  OpenGL 2.1 comes with built-in shaders to do basic shading; with modern OpenGL, you have to build everything from scratch.</li>\n<li>As @luqui mentioned, if you're looking for materials that actually <em>reflect</em> other parts of the scenes, this kind of shininess won't help you.</li>\n</ul>\n\n<p>Here is the difference.  Your original code on the left, the settings above on the right, on your \"compoundfivetetrahedra\" example.  It'll look better if you increase the size of the window.</p>\n\n<p><a href=\"https://i.stack.imgur.com/V0De7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/V0De7.png\" alt=\"Original code (left) and with specular=white and shininess=1.0 on right.\"></a></p>\n\n<p>Note that it works better on curved surfaces.  Here's your cylinder example, using:</p>\n\n<pre><code>materialShininess Front $= 5\nmaterialSpecular Front $= white\n</code></pre>\n\n<p>You can see the shininess on the closer sphere.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ASzOp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ASzOp.png\" alt=\"Cylinder example, showing shininess on one end\"></a></p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 1, "accepted_answer_id": 49163089, "answer_count": 1, "score": 3, "last_activity_date": 1520519111, "creation_date": 1520447788, "last_edit_date": 1520475696, "question_id": 49159030, "link": "https://stackoverflow.com/questions/49159030/shininess-with-haskell-opengl", "title": "Shininess with Haskell Opengl", "body": "<p>I have done numerous graphics with Haskell OpenGL. They are in my repo here: <a href=\"https://github.com/stla/opengl-examples\" rel=\"nofollow noreferrer\">opengl-examples</a> (the gallery is not exhaustive). However I have a problem: when I use <code>materialShininess</code> nothing happens. It there something to enable in order to have the shininess ?</p>\n\n<p>Here is an example of one of my prog. It it not complete but I hope it's enough to identify the issue.</p>\n\n<pre><code>module CompoundFiveTetrahedra2\n  where\nimport           CompoundFiveTetrahedra.Data\nimport           Control.Monad                     (when)\nimport qualified Data.ByteString                   as B\nimport           Data.IORef\nimport           Graphics.Rendering.OpenGL.Capture (capturePPM)\nimport           Graphics.Rendering.OpenGL.GL\nimport           Graphics.UI.GLUT\nimport           Text.Printf\nimport           Utils.ConvertPPM\nimport           Utils.OpenGL                      (negateNormal)\nimport           Utils.Prism\n\nblue,red,green,yellow,purple,white,black :: Color4 GLfloat\nblue   = Color4 0   0   1   1\nred    = Color4 1   0   0   1\ngreen  = Color4 0   1   0   1\nyellow = Color4 1   1   0   1\nwhite  = Color4 1   1   1   1\nblack  = Color4 0   0   0   1\npurple = Color4 0.5 0   0.5 1\n\ndisplay :: IORef GLfloat -&gt; IORef GLfloat -&gt; IORef GLfloat -&gt; IORef GLdouble\n        -&gt; IORef GLint -&gt; IORef GLfloat -&gt; DisplayCallback\ndisplay rot1 rot2 rot3 zoom capture angle = do\n  clear [ColorBuffer, DepthBuffer]\n  r1 &lt;- get rot1\n  r2 &lt;- get rot2\n  r3 &lt;- get rot3\n  z &lt;- get zoom\n  a &lt;- get angle\n  i &lt;- get capture\n  loadIdentity\n  (_, size) &lt;- get viewport\n  resize z size\n  rotate a $ Vector3 1 1 1\n  rotate r1 $ Vector3 1 0 0\n  rotate r2 $ Vector3 0 1 0\n  rotate r3 $ Vector3 0 0 1\n  mapM_ (drawEdge blue)   (edges!!0)\n  mapM_ (drawEdge red)    (edges!!1)\n  mapM_ (drawEdge green)  (edges!!2)\n  mapM_ (drawEdge yellow) (edges!!3)\n  mapM_ (drawEdge purple) (edges!!4)\n  mapM_ (drawVertex blue)   vertices1\n  mapM_ (drawVertex red)    vertices2\n  mapM_ (drawVertex green)  vertices3\n  mapM_ (drawVertex yellow) vertices4\n  mapM_ (drawVertex purple) vertices5\n  when (i &gt; 0) $ do\n    let ppm = printf \"tetrahedra%04d.ppm\" i\n        png = printf \"tetrahedra%04d.png\" i\n    (&gt;&gt;=) capturePPM (B.writeFile ppm)\n    convert ppm png True\n    capture $~! (+1)\n  swapBuffers\n\ndrawVertex :: Color4 GLfloat -&gt; Vertex3 GLfloat -&gt; IO ()\ndrawVertex col v =\n  preservingMatrix $ do\n    translate $ toVector v\n    materialDiffuse Front $= col\n    renderObject Solid $ Sphere' 0.03 30 30\n  where\n    toVector (Vertex3 x y z) = Vector3 x y z\n\ndrawEdge :: Color4 GLfloat -&gt; (Vertex3 GLfloat, Vertex3 GLfloat) -&gt; IO ()\ndrawEdge col (v1,v2) = do\n  let cylinder = prism v1 v2 30 0.03\n  renderPrimitive Quads $ do\n    materialDiffuse Front $= col\n    mapM_ drawQuad cylinder\n  where\n    drawQuad ((w1,w2,w3,w4),n) = do\n      normal $ negateNormal n\n      vertex w1\n      vertex w2\n      vertex w3\n      vertex w4\n\nresize :: Double -&gt; Size -&gt; IO ()\nresize zoom s@(Size w h) = do\n  viewport $= (Position 0 0, s)\n  matrixMode $= Projection\n  loadIdentity\n  perspective 45.0 (w'/h') 1.0 100.0\n  lookAt (Vertex3 0 0 (-3 + zoom)) (Vertex3 0 0 0) (Vector3 0 1 0)\n  matrixMode $= Modelview 0\n  where\n    w' = realToFrac w\n    h' = realToFrac h\n\nkeyboard :: IORef GLfloat -&gt; IORef GLfloat -&gt; IORef GLfloat -&gt; IORef GLint\n         -&gt; KeyboardCallback\nkeyboard rot1 rot2 rot3 capture c _ =\n  case c of\n    'r' -&gt; rot1 $~! subtract 1\n    't' -&gt; rot1 $~! (+1)\n    'f' -&gt; rot2 $~! subtract 1\n    'g' -&gt; rot2 $~! (+1)\n    'v' -&gt; rot3 $~! subtract 1\n    'b' -&gt; rot3 $~! (+1)\n    'c' -&gt; capture $~! (+1)\n    'q' -&gt; leaveMainLoop\n    _   -&gt; return ()\n\nmouse :: IORef GLdouble -&gt; MouseCallback\nmouse zoom button keyState _ =\n  case (button, keyState) of\n    (LeftButton, Down)  -&gt; zoom $~! (+0.1)\n    (RightButton, Down) -&gt; zoom $~! subtract 0.1\n    _                   -&gt; return ()\n\nidle :: IORef GLfloat -&gt; IdleCallback\nidle angle = do\n  angle $~! (+ 2)\n  postRedisplay Nothing\n\nmain :: IO ()\nmain = do\n  _ &lt;- getArgsAndInitialize\n  _ &lt;- createWindow \"Five tetrahedra\"\n  initialDisplayMode $= [RGBAMode, DoubleBuffered, WithDepthBuffer]\n  clearColor $= black\n  materialAmbient Front $= black\n  materialShininess Front $= 80 -- THIS DOES NOT WORK\n  lighting $= Enabled\n  light (Light 0) $= Enabled\n  position (Light 0) $= Vertex4 0 0 (-100) 1\n  ambient (Light 0) $= white\n  diffuse (Light 0) $= white\n  specular (Light 0) $= white\n  depthFunc $= Just Lequal\n  depthMask $= Enabled\n  shadeModel $= Smooth\n  rot1 &lt;- newIORef 0.0\n  rot2 &lt;- newIORef 0.0\n  rot3 &lt;- newIORef 0.0\n  zoom &lt;- newIORef 0.0\n  capture &lt;- newIORef 0\n  angle &lt;- newIORef 0.0\n  displayCallback $= display rot1 rot2 rot3 zoom capture angle\n  reshapeCallback $= Just (resize 0)\n  keyboardCallback $= Just (keyboard rot1 rot2 rot3 capture)\n  mouseCallback $= Just (mouse zoom)\n  idleCallback $= Just (idle angle)\n  mainLoop\n</code></pre>\n\n<p>Do I miss something to enable the shininess ? </p>\n\n<h1>EDIT</h1>\n\n<p>Here is an example with the R package <code>rgl</code>, which is also a wrapper to OpenGL. Look at the white part on the spheres. I cannot achieve that with Haskell.</p>\n\n<p><a href=\"https://i.stack.imgur.com/aUS5u.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aUS5u.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["sorting", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1520445564, "post_id": 49158380, "comment_id": 85321730, "body": "And the source lists are already in ascending order?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1520445588, "post_id": 49158380, "comment_id": 85321743, "body": "If all you know about your list is that it was created by your <code>merge</code> function, the best you can do is to just sort the list. If you also know that the two initial lists were sorted and of the same size, you can &quot;unmerge&quot; the list to get the two original lists back and then merge them again with another function that maintains the sortedness."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1520445691, "creation_date": 1520445691, "answer_id": 49158495, "question_id": 49158380, "link": "https://stackoverflow.com/questions/49158380/how-do-i-sort-a-merged-list-into-ascending-order/49158495#49158495", "title": "How do I sort a merged list into ascending order?", "body": "<p>You just need to compare <code>x</code> and <code>y</code> and decide which to add to the result first. Note that you only add <em>one</em> at a time; the next element after <code>x</code> might still come before <code>y</code>.</p>\n\n<p>Note you need the <code>Ord</code> constraint to ensure that <code>&lt;=</code> is defined for <code>a</code>.</p>\n\n<pre><code>merge :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nmerge xs [] = xs\nmerge [] ys = ys\nmerge xs@(x:xs') ys@(y:ys') | x &lt;= y = x : merge xs' ys\n                            | otherwise = y : merge xs ys'\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9458259, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ddf-TroGpuQ/AAAAAAAAAAI/AAAAAAAAAKA/JL2vMYIiFKc/photo.jpg?sz=128", "display_name": "Olojwan Oluzimi", "link": "https://stackoverflow.com/users/9458259/olojwan-oluzimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1520445691, "creation_date": 1520445278, "question_id": 49158380, "link": "https://stackoverflow.com/questions/49158380/how-do-i-sort-a-merged-list-into-ascending-order", "title": "How do I sort a merged list into ascending order?", "body": "<pre><code>merge :: [a] -&gt; [a] -&gt; [a]\n\n merge xs     []     = xs\n merge []     ys     = ys\n merge (x:xs) (y:ys) = x : y : merge xs ys\n</code></pre>\n\n<p>I have got this working but now I need to sort them in ascending order.</p>\n"}, {"tags": ["dictionary", "haskell"], "comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520443654, "post_id": 49156644, "comment_id": 85320616, "body": "However it is here: <a href=\"https://hackage.haskell.org/package/hashmap-1.3.3/docs/Data-HashMap.html#v:assocs\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/hashmap-1.3.3/docs/&hellip;</a>"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520443687, "post_id": 49156644, "comment_id": 85320639, "body": "Ah sorrry you use the Lazy version"}, {"owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520443828, "post_id": 49156644, "comment_id": 85320712, "body": "@St&#233;phaneLaurent yea turns out there is a toLists method in the Lazy version that does the same thing as assocs."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520444218, "post_id": 49156644, "comment_id": 85320923, "body": "Strange. I always called this function &quot;toList&quot;&#39;. I thought you were looking for something else."}, {"owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520449802, "post_id": 49156644, "comment_id": 85324209, "body": "@St&#233;phaneLaurent is ToList and assocs not the same somehow?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 1, "creation_date": 1520449976, "post_id": 49156644, "comment_id": 85324308, "body": "@Jeffreys It seems like one of them preservers the order. I&#39;ve seen that somewhere iin the doc. Otherwise indeed this is the same"}], "answers": [{"comments": [{"owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "edited": false, "score": 0, "creation_date": 1520440701, "post_id": 49156804, "comment_id": 85318695, "body": "I tried importing Data.HashMap but that package doesnt appear to exist even though Data.HashMap.Lazy does exist. So I&#39;m still a bit confused as to how exactly I should fix this. I assume the Lazy version is going to be more efficient so do I need to implement my own assocs method that does the exact same thing?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "edited": false, "score": 0, "creation_date": 1520440904, "post_id": 49156804, "comment_id": 85318837, "body": "If you want to import <code>Data.HashMap</code> then install the package in which it resides - <code>cabal install hashmap</code> (or use your packaging system of choice).  If you want to keep using the modules from unordered-containers, such as <code>Data.HashMap.{Strict,Lazy}</code> then you&#39;ll need to make your own <code>assocs</code> method.  I can&#39;t say if the lazy module will be more efficient for you - that depends on the situation."}, {"owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "edited": false, "score": 0, "creation_date": 1520443777, "post_id": 49156804, "comment_id": 85320683, "body": "So turns out the toList method in the Lazy package does the same thing as assocs. I submited that as my own answer since I feel it more accurately solved the problem then needing to rewrite assocs."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1520440090, "creation_date": 1520440090, "answer_id": 49156804, "question_id": 49156644, "link": "https://stackoverflow.com/questions/49156644/how-to-use-assocs-with-hashmap-in-haskell/49156804#49156804", "title": "How to use assocs with HashMap in Haskell", "body": "<p>Data.HashMap.Lazy, from unordered-containers, does not export an <code>assocs</code> function.</p>\n\n<p>You might be thinking of <code>Data.HashMap</code> from the <code>hashmap</code> package.</p>\n"}, {"tags": [], "owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "is_accepted": true, "score": 1, "last_activity_date": 1520443675, "creation_date": 1520443675, "answer_id": 49157900, "question_id": 49156644, "link": "https://stackoverflow.com/questions/49156644/how-to-use-assocs-with-hashmap-in-haskell/49157900#49157900", "title": "How to use assocs with HashMap in Haskell", "body": "<p>I figured out the answer. In Data.HashMap.Lazy the method <code>toList</code> performs the same function as <code>assocs</code>. As such the following code works.</p>\n\n<pre><code>import qualified Data.HashMap.Lazy as M\ntest = M.fromList [(\"a\", 1), (\"b\", 2)]\nM.toList test\n</code></pre>\n"}], "owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "accepted_answer_id": 49157900, "answer_count": 2, "score": 0, "last_activity_date": 1520443675, "creation_date": 1520439586, "question_id": 49156644, "link": "https://stackoverflow.com/questions/49156644/how-to-use-assocs-with-hashmap-in-haskell", "title": "How to use assocs with HashMap in Haskell", "body": "<p>Currently I'm trying to use the Map's assocs method, but unable to figure out how to get it to work for a HashMap. For a regular Map the following works just fine.</p>\n\n<pre><code>import qualified Data.Map as M\ntest = M.fromList [(\"a\", 1), (\"b\", 2)]\nM.assocs test\n</code></pre>\n\n<p>However when I try the same thing with a HashMap it doesn't work. I tried several variation on the import all fail with different errors. Oddly however most other functions that work on maps work just fine with the below import, for example I have no trouble using <code>M.lookup</code>.</p>\n\n<pre><code>import qualified Data.HashMap.Lazy as M\ntest = M.fromList [(\"a\", 1), (\"b\", 2)]\nM.assocs test\n</code></pre>\n\n<p>In case it is useful the above code gives the following error:</p>\n\n<pre><code>&lt;interactive&gt;:1:1: error:\n    Not in scope: \u2018M.assocs\u2019\n    No module named \u2018M\u2019 is imported.\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1520425281, "post_id": 49151573, "comment_id": 85307803, "body": "Is element order significant in the answer?"}], "answers": [{"tags": [], "owner": {"reputation": 63078, "user_id": 220147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b3881a28fe402dd2d1de44717486cae8?s=128&d=identicon&r=PG", "display_name": "Michael Kohl", "link": "https://stackoverflow.com/users/220147/michael-kohl"}, "is_accepted": false, "score": 6, "last_activity_date": 1520474243, "last_edit_date": 1520474243, "creation_date": 1520426808, "answer_id": 49152340, "question_id": 49151573, "link": "https://stackoverflow.com/questions/49151573/haskell-consecutive-sublist-of-list/49152340#49152340", "title": "Haskell consecutive sublist of list", "body": "<p>It's not exactly elegant, but you can use <code>divvy</code> from <code>Data.List.Split</code>:</p>\n\n<pre><code>xs = [1,2,3]\n[] : concat [ divvy n 1 xs | n &lt;- [1..length xs] ]\n-- [[],[1],[2],[3],[1,2],[2,3],[1,2,3]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 106, "user_id": 5687336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f5e70e820e87c24fb53e4338f49576b?s=128&d=identicon&r=PG&f=1", "display_name": "Anicka Burova", "link": "https://stackoverflow.com/users/5687336/anicka-burova"}, "is_accepted": false, "score": 2, "last_activity_date": 1520438377, "creation_date": 1520438377, "answer_id": 49156242, "question_id": 49151573, "link": "https://stackoverflow.com/questions/49151573/haskell-consecutive-sublist-of-list/49156242#49156242", "title": "Haskell consecutive sublist of list", "body": "<p>The answer by Michael Kohl is not buildable.<br>\nDivvy is already returning [[a]] so the list comprehension is returning [[[a]]]. I would just add a comment, but not enough reputation to do that.\nUse concat.</p>\n\n<pre><code>sublists xs = [] : concat [ divvy n 1 xs | n &lt;- [1..length xs]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "is_accepted": false, "score": 1, "last_activity_date": 1520438387, "creation_date": 1520438387, "answer_id": 49156248, "question_id": 49151573, "link": "https://stackoverflow.com/questions/49151573/haskell-consecutive-sublist-of-list/49156248#49156248", "title": "Haskell consecutive sublist of list", "body": "<p>I'm not sure if you just want the result that you already have, but with a different arrangement of the elements. In that case, one easy and not at all elegant way would be sorting after performing <code>sublists</code>. The function that decides the order of the elements would be:</p>\n\n<pre><code>subCompare x y = case (compare (length x) (length y)) of \n     EQ -&gt; compare x y \n     s -&gt; s \n</code></pre>\n\n<p>This means, compare by length, but if they have the same length, then compare by elements order.\nAnd then:</p>\n\n<pre><code>&gt; sortBy subCompare (sublists [1,2,3])\n[[],[1],[2],[3],[1,2],[1,3],[2,3],[1,2,3]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "is_accepted": false, "score": 1, "last_activity_date": 1520441482, "last_edit_date": 1520441482, "creation_date": 1520440477, "answer_id": 49156941, "question_id": 49151573, "link": "https://stackoverflow.com/questions/49151573/haskell-consecutive-sublist-of-list/49156941#49156941", "title": "Haskell consecutive sublist of list", "body": "<p>This is almost a simple recursion, in that if we want <code>sublists [1,2,3,4]</code> and we already have the sublists of the tail, that is...</p>\n\n<pre><code>[[], [2], [3], [4], [2,3], [3,4], [2,3,4]]\n</code></pre>\n\n<p>...it's fairly obvious that to handle the new element <code>1</code>, the new sublists we need to add are <code>[1]</code>, <code>[1,2]</code>, <code>[1,2,3]</code>, and <code>[1,2,3,4]</code>.  The problem is it isn't obvious where these new\nsublists should be inserted.</p>\n\n<p>To make it easier we can do a slightly different recursion which keeps the sublists of\neach length separate in their own lists, so we'll have</p>\n\n<pre><code>[[[]],\n [[2], [3], [4]],\n [[2,3], [3,4]],\n [[2,3,4]]]\n</code></pre>\n\n<p>Now it's more obvious where to insert the new\nsublists.</p>\n\n<p>The final result will just be the concatenation.</p>\n\n<pre><code>sublists :: [a] -&gt; [[a]]\nsublists = concat . sublists'\n\nsublists' :: [a] -&gt; [[[a]]]\nsublists' [] = [[[]]]\nsublists' (x:xs) = zipWith (++) withX withoutX\n  where\n    ysss = sublists' xs\n    withX = [] : [[x:ys] | ys:_ &lt;- ysss]\n    withoutX = ysss ++ [[]]\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li><p>We need to make withX and withoutX the same length so that the\nzipWith doesn't run out early, and since <code>withoutX</code> already contains\nthe zero-length sublist we need to <em>not</em> include that in withX.</p></li>\n<li><p>I could have written <code>withX</code> using <code>inits (x:xs)</code>, but that would\nmake new lists instead of sharing some of those we have in <code>ysss</code>.\n(Although whether maximal sharing is good sometimes depends on how you\nconsume the result.)</p></li>\n<li><p><code>sublists'</code> can also be written as a <code>foldr</code>.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 1, "last_activity_date": 1520619428, "last_edit_date": 1520619428, "creation_date": 1520442906, "answer_id": 49157676, "question_id": 49151573, "link": "https://stackoverflow.com/questions/49151573/haskell-consecutive-sublist-of-list/49157676#49157676", "title": "Haskell consecutive sublist of list", "body": "<p>Though not in the order you asked for,</p>\n\n<pre><code>import Control.Monad((&lt;=&lt;))\nimport Data.List(inits, tails)\n\n-- inits [x, y, z, ...] = [[], [x], [x, y], [x, y, z], ...]\n-- tails [x, y, z, ...] = [[x, y, z, ...], [y, z, ...], [z, ...], [...], ..., []]\n-- (f &lt;=&lt; g) x = do  y &lt;- g x\n--                   f y\n-- (f . g) x   = let y = g x\n--                in f y\n\nsublists = ([]:) . (tail . inits) &lt;=&lt; tails\n</code></pre>\n\n<p>This uses the fact that the list monad models nondeterminism: <code>tails</code> nondeterministically selects where the sublist begins, <code>inits</code> selects where it ends, there\u2019s some munging to get nicer(?) behavior for empty lists, and the list monad takes care of iterating all possible combinations of start and end.</p>\n"}, {"tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": false, "score": 1, "last_activity_date": 1520443302, "creation_date": 1520443302, "answer_id": 49157785, "question_id": 49151573, "link": "https://stackoverflow.com/questions/49151573/haskell-consecutive-sublist-of-list/49157785#49157785", "title": "Haskell consecutive sublist of list", "body": "<p>I'm not sure to understand the question but if so, you can use <code>combine</code> of the <code>combinat</code> package:</p>\n\n<pre><code>&gt; import Math-Combinat-Sets\n&gt; map (`combine` [1,2,3]) [0..3]\n[[[]],[[1],[2],[3]],[[1,1],[1,2],[1,3],[2,2],[2,3],[3,3]],[[1,1,1],[1,1,2],[1,1,3],[1,2,2],[1,2,3],[1,3,3],[2,2,2],[2,2,3],[2,3,3],[3,3,3]]]\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5143570, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203335308343372/picture?type=large", "display_name": "Laci Feldsam", "link": "https://stackoverflow.com/users/5143570/laci-feldsam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 797, "favorite_count": 0, "answer_count": 6, "score": 4, "last_activity_date": 1520619428, "creation_date": 1520424461, "question_id": 49151573, "link": "https://stackoverflow.com/questions/49151573/haskell-consecutive-sublist-of-list", "title": "Haskell consecutive sublist of list", "body": "<p>Hi I have this little function which finds the powerset of set but i need all the consecutive sublist. <code>[1,2,3] -&gt; [[],[1],[2],[3],[1,2],[2,3],[1,2,3]]</code> and not <code>[[],[3],[2],[2,3],[1],[1,3],[1,2],[1,2,3]]</code></p>\n\n<p>Is there a way to fix this function to do what i want?</p>\n\n<pre><code>sublists :: [a] -&gt; [[a]]\nsublists [] = [[]]\nsublists (x:xs) = sublists xs ++ map (x:) (sublists xs)  \n</code></pre>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520436438, "post_id": 49150063, "comment_id": 85315641, "body": "There is <a href=\"https://www.haskell.org/cabal/release/cabal-2.0.1.1/doc/users-guide/developing-packages.html#generating-dependency-version-bounds\" rel=\"nofollow noreferrer\"><code>cabal gen-bounds</code></a>, though I haven&#39;t used it, and can&#39;t confirm it does what you want right now (I&#39;m having some trouble to use cabal-install through Stack in the provisional, hastily improvised, Windows-based Haskell environment I find myself in right now)."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520436797, "post_id": 49150063, "comment_id": 85315935, "body": "Great! <code>cabal get-bounds</code> seems to be useful here. The way of working I can think of the is: remove all the bounds but <code>base</code> and then let <code>cabal get-bounds</code> find the bounds. You should write this as an answer ;)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520517172, "post_id": 49150063, "comment_id": 85354491, "body": "&quot;You should write this as an answer&quot; -- I would be more comfortable with that if I was sure it worked (or if you&#39;d confirm it does). I suspect there might be some extra steps involved so that cabal-install accounts for the LTS snapshot you are using."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1520519741, "post_id": 49150063, "comment_id": 85356289, "body": "After thinking a little more about this, I have come up with a plan that might be easier to get to work. It involves <a href=\"https://hackage.haskell.org/package/jenga\" rel=\"nofollow noreferrer\">Jenga</a> as an intermediate to retrieve the LTS versions. I&#39;ll get back to you in ~12 hours, hopefully with a verified answer."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 1, "last_activity_date": 1520730477, "last_edit_date": 1520730477, "creation_date": 1520578081, "answer_id": 49188061, "question_id": 49150063, "link": "https://stackoverflow.com/questions/49150063/is-there-a-tool-for-upgrading-the-dependecies-upper-bounds-to-the-latest-versio/49188061#49188061", "title": "Is there a tool for upgrading the dependecies&#39; upper bounds to the latest versions of each dependency?", "body": "<p>Preliminary notes:</p>\n\n<ul>\n<li><em>hierarchy</em>, a dependency of <em>pipes-files</em>, has the same issue you are trying to work around -- it is not in Stackage and has version bounds outdated with respect to the latest LTS. That means you'll first have to get it to build successfully, and then <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#packages-and-extra-deps\" rel=\"nofollow noreferrer\">add your tweaked version of it to the extra-deps in the <code>stack.yaml</code> of <em>pipes-files</em></a>.</li>\n<li><p><a href=\"https://www.haskell.org/cabal/release/cabal-2.0.1.1/doc/users-guide/developing-packages.html#generating-dependency-version-bounds\" rel=\"nofollow noreferrer\"><code>cabal gen-bounds</code></a>, which \"suggest[s] dependency version bounds that conform to Package Versioning Policy\", is, in principle, the right tool for the job. However, getting cabal-install to behave according to the restrictions of a Stack-centric environment is not always straightforward. While this seems enough to run <code>cabal gen-bounds</code> from a bash shell in the absence of a Stack-independent GHC installation...</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>PATH=$PATH:$(stack path --compiler-bin) cabal gen-bounds\n</code></pre>\n\n<p>... I couldn't figure out how to get it to follow the version restrictions of the Stack(age) snapshot -- in particular, the <code>--package-db</code> option, <a href=\"https://groups.google.com/d/msg/haskell-stack/8HJ6DHAinU0/J68U6AXTsasJ\" rel=\"nofollow noreferrer\">which can be helpful with commands such as <code>cabal configure</code></a>, doesn't seem to be accepted by <code>gen-bounds</code>.</p></li>\n</ul>\n\n<p>As I don't know how to make <code>cabal gen-bounds</code> and Stack cooperate, I will suggest a somewhat more convoluted method, but one that doesn't require using cabal-install directly. It uses <a href=\"https://github.com/erikd/jenga\" rel=\"nofollow noreferrer\">Jenga</a>, a tool that can retrieve the version information left implicit by your choice of Stackage snapshot. Jenga is not on Stackage; to install it with Stack, grab the sources from GitHub (or with <code>stack unpack jenga</code>) and then run <code>stack init --solver</code> followed by <code>stack install</code>.</p>\n\n<ol>\n<li><p>Remove all version bounds from the <code>hierarchy.cabal</code> file (or whatever the relevant .cabal file is).</p></li>\n<li><p><code>stack init --solver</code>, to create a <code>stack.yaml</code> file with any extra-deps that might be necessary. (You can use <code>--resolver</code> to explicitly choose the snapshot to be used.)</p></li>\n<li><p><code>stack build</code>, as a sanity check that the package is buildable.</p></li>\n<li><p>In the generated <code>stack.yaml</code>, check whether the <code>extra-deps</code> field is commented out; if so, uncomment it. This is necessary for step #6 to work.</p></li>\n<li><p><code>jenga -i hierarchy.cabal</code>, which will print the exact dependency versions Stack would use to build the package.</p></li>\n<li><p>Paste the versions Jenga gave you into the <code>build-depends</code> of the .cabal file, adjusting then if desired (at a minimum, you'll probably want to relax the minor version bounds for PVP compliance -- e.g. changing <code>base == 4.9.1.0</code> to <code>base == 4.9.*</code>).</p></li>\n</ol>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "accepted_answer_id": 49188061, "answer_count": 1, "score": 2, "last_activity_date": 1520730477, "creation_date": 1520419784, "last_edit_date": 1520569857, "question_id": 49150063, "link": "https://stackoverflow.com/questions/49150063/is-there-a-tool-for-upgrading-the-dependecies-upper-bounds-to-the-latest-versio", "title": "Is there a tool for upgrading the dependecies&#39; upper bounds to the latest versions of each dependency?", "body": "<p>I'm trying to upgrade the dependencies of the <a href=\"https://github.com/jwiegley/pipes-files\" rel=\"nofollow noreferrer\"><code>pipes-files</code></a> package, so that it can be <a href=\"https://stackoverflow.com/q/49090058/2289983\">included in the latest <code>stack</code> LTS</a>. The <code>pipes-files</code> package does not contain a <code>stack.yaml</code> file, and the <code>pipes-files.cabal</code> file contains quite some upper and lower bounds on its dependencies, e.g.:</p>\n\n<pre><code>  base                &gt;=4.7  &amp;&amp; &lt;4.10\n, transformers        &gt;=0.3  &amp;&amp; &lt;0.6\n, transformers-base   &gt;=0.3  &amp;&amp; &lt;0.6\n-- and quite some more ...\n</code></pre>\n\n<p>Is there a tool that I can run to get the latest versions of each of these dependencies? The closest thing I could find was <a href=\"http://packdeps.haskellers.com/\" rel=\"nofollow noreferrer\"><code>packdeps</code></a> but it will require me to search for the dependencies one by one.</p>\n"}, {"tags": ["haskell", "monad-transformers"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1520453694, "post_id": 49151162, "comment_id": 85326364, "body": "Overlapping instances are my least-favorite language extension. I will admit that their problems <i>probably</i> won&#39;t bite in the context of test mockups. One problem is that it&#39;s especially easy to forget to override a default in an instance if you never write the instance; this can lead to people using nonsense instances by mistake. There can also be complications with existentials, and using things like Data.Constraint.Forall."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 5, "last_activity_date": 1520423172, "creation_date": 1520423172, "answer_id": 49151162, "question_id": 49149787, "link": "https://stackoverflow.com/questions/49149787/avoiding-orphan-instances-with-monad-transformers/49151162#49151162", "title": "Avoiding Orphan Instances with Monad Transformers", "body": "<p>You need an instance <code>WeatherT m =&gt; WeatherT (MockCounter m)</code> which just lifts a <code>WeatherT m</code> instance through <code>MockCounter m</code> thanks to the fact that <code>MockCounter</code> is a monad transformer. (The point of the default methods you wrote is to define such instances.)</p>\n\n<p>To avoid orphan instances, one way is to separate <code>Weather</code> and <code>Counter</code> each into <code>Class</code> and <code>Trans</code> modules. <code>Class</code> don't need to depend on each other, while each <code>Trans</code> module may depend on all the <code>Class</code> modules (the other way around is also possible, and is in fact how <code>mtl</code> does it, but IMO <code>Trans</code> depending on <code>Class</code> is better: <code>Class</code> defines the interface, and <code>Trans</code> the implementation).</p>\n\n<p>This is indeed a (known) problem because if you have <code>n</code> transformers and <code>m</code> classes, you potentially need <code>n*m</code> lifting instances. One solution is to define a polymorphic overlappable instance for all transformers <code>(MonadTrans t, WeatherT m) =&gt; WeatherT (t m)</code>. Overlapping instances are often frowned upon but I'm not sure what actual problems there are in this case.</p>\n\n<p>By the way, following the naming convention from <code>mtl</code> and <code>transformers</code> we would have <code>MonadWeather</code> and <code>MonadCounter</code> classes, and <code>WeatherT</code> and <code>CounterT</code> types (monad Transformers).</p>\n"}], "owner": {"reputation": 1747, "user_id": 343761, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cf716ff342bad8a3aa8178ab9b39366d?s=128&d=identicon&r=PG", "display_name": "homam", "link": "https://stackoverflow.com/users/343761/homam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 49151162, "answer_count": 1, "score": 1, "last_activity_date": 1520423172, "creation_date": 1520418983, "last_edit_date": 1520420497, "question_id": 49149787, "link": "https://stackoverflow.com/questions/49149787/avoiding-orphan-instances-with-monad-transformers", "title": "Avoiding Orphan Instances with Monad Transformers", "body": "<p>I have monad transformers corresponding to independent features of my app.</p>\n\n<p>In <strong>Weather module</strong>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Monad m =&gt; WeatherT m where\n  byCity :: String -&gt; m WeatherData\n\nnewtype MockWeather m a = MockWeather { \n  ... \n} deriving (Functor, Applicative, Monad, MonadTrans)\n\n\ninstance Monad m =&gt; WeatherT (MockWeather m) where\n  ...\n</code></pre>\n\n<p>In <strong>Counter module</strong>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Monad m =&gt; CounterT m where\n  increment :: m Int\n  current :: m Int\n\nnewtype MockCounter m a = MockCounter {\n  ...\n} deriving (Functor, Applicative, Monad, MonadTrans)\n\ninstance Monad m =&gt; CounterT (MockCounter m) where\n  ...\n</code></pre>\n\n<p>They both may have multiple instances with different implementations, for example they both have a mock instance that I use here in my main: <code>MockCounter</code> and <code>MockWeather</code>.</p>\n\n<p>In the <strong>Main module</strong> I define <code>MyApp</code> monad as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype MyAppM m a = MyAppM { unMyAppM :: MockCounter (MockWeather m) a }\n  deriving (Functor, Applicative, Monad, CounterT, WeatherT)\n</code></pre>\n\n<p>This definition requires me to make <code>(MockCounter (MockWeather m)</code> an instance of <code>WeatherT</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance Monad m =&gt; WeatherT (MockCounter (MockWeather m))\n</code></pre>\n\n<p>I define this instance in the main module, because I don't want Weather and Counter modules to depend on each others.</p>\n\n<p>But defining this instance in the main module makes it an Orphan instance.</p>\n\n<p>Questions:</p>\n\n<ul>\n<li>Am I on the right track here with <code>CounterT</code>, <code>WeatherT</code> and <code>MyAppM</code>? I want to build my app by composing decoupled and mockable functionalities.</li>\n<li>How can I avoid orphan instances?</li>\n</ul>\n\n<p><a href=\"https://glot.io/snippets/eyxv46rb9l\" rel=\"nofollow noreferrer\">Full code</a>:</p>\n\n<p><strong>Main module</strong></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE FlexibleInstances          #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nmodule Main where\n\nimport          Counter\nimport          Weather\n\nnewtype MyAppM m a = MyAppM { unMyAppM :: MockCounter (MockWeather m) a }\n  deriving (Functor, Applicative, Monad, CounterT, WeatherT)\n\ninstance Monad m =&gt; WeatherT (MockCounter (MockWeather m))\n\nrunMyAppM :: Int -&gt; MyAppM m a -&gt; m (a, Int)\nrunMyAppM i = runMockWeather . (`runMockCounter` i) . unMyAppM\n\nmyApp :: (Monad m, CounterT m , WeatherT m) =&gt; m String\nmyApp = do\n  _ &lt;- increment\n  (WeatherData weather) &lt;- byCity \"Amsterdam\"\n  return weather\n\n-- Testing it:\nmain :: IO ()\nmain = runMyAppM 12 myApp &gt;&gt;= print\n</code></pre>\n\n<hr>\n\n<p><strong>Weather module</strong>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DefaultSignatures          #-}\n{-# LANGUAGE GADTs                      #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nmodule Weather where\n\nimport           Control.Monad.Trans.Class\nimport           Control.Monad.Trans.Identity\n\nnewtype WeatherData = WeatherData String deriving (Show)\n\nclass Monad m =&gt; WeatherT m where\n  byCity :: String -&gt; m WeatherData\n\n  default byCity :: (MonadTrans t, WeatherT m', m ~ t m') =&gt; String -&gt; m WeatherData\n  byCity = lift . byCity\n\n\nnewtype MockWeather m a = MockWeather {\n  unMockWeather :: IdentityT m a\n} deriving (Functor, Applicative, Monad, MonadTrans)\n\nrunMockWeather :: MockWeather f a -&gt; f a\nrunMockWeather = runIdentityT . unMockWeather\n\ninstance Monad m =&gt; WeatherT (MockWeather m) where\n   byCity city = MockWeather $ return $ WeatherData $ \"It is sunny in \" ++ city\n</code></pre>\n\n<hr>\n\n<p><strong>Counter module</strong>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DefaultSignatures          #-}\n{-# LANGUAGE GADTs                      #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nmodule Counter where\n\nimport           Control.Monad.Identity\nimport           Control.Monad.State\nimport           Control.Monad.Trans.Class\n\nclass Monad m =&gt; CounterT m where\n  increment :: m Int\n  current :: m Int\n\n  default increment :: (MonadTrans t, CounterT m', m ~ t m') =&gt; m Int\n  increment = lift increment\n\n  default current :: (MonadTrans t, CounterT m', m ~ t m') =&gt; m Int\n  current = lift current\n\n\nnewtype MockCounter m a = MockCounter {\n  unMockCounter :: StateT Int m a\n} deriving (Functor, Applicative, Monad, MonadTrans, MonadState Int)\n\ndefaultMockCounter :: MockCounter Identity ()\ndefaultMockCounter = MockCounter $ put 0\n\nrunMockCounter :: MockCounter m a -&gt; Int -&gt; m (a, Int)\nrunMockCounter = runStateT . unMockCounter\n\ninstance Monad m =&gt; CounterT (MockCounter m) where\n  increment = MockCounter $ do\n    c &lt;- get\n    let n = c + 1\n    put n\n    return n\n\n  current = MockCounter get\n</code></pre>\n"}, {"tags": ["list", "haskell", "infinite"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1520411848, "post_id": 49147350, "comment_id": 85299343, "body": "Maybe think of how you can turn <code>[1..]</code> into your list just one element at a time. What do all the negative numbers have in common?"}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1520412518, "post_id": 49147390, "comment_id": 85299704, "body": "<code>replicate [1, -1]</code>? Don&#39;t you mean <code>cycle [1, -1]</code>? By the way, I prefer <code>zipWith ($) (cycle [id, negate]) [1..]</code>, but that&#39;s personal preference."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1520412546, "post_id": 49147390, "comment_id": 85299726, "body": "@Zeta: lol, the edit and comment are almost exactly at the same time, what are the odds of a character-equivalent answer :)."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 11, "last_activity_date": 1520412356, "last_edit_date": 1520412356, "creation_date": 1520411855, "answer_id": 49147390, "question_id": 49147350, "link": "https://stackoverflow.com/questions/49147350/haskell-infinite-list-with-alternating-signs/49147390#49147390", "title": "Haskell infinite list with alternating signs", "body": "<p>You can group these as follows:</p>\n\n<pre><code>[[1, -2], [3, -4],..]\n</code></pre>\n\n<p>So we make tuples of <code>i</code> where <code>i</code> makes hops of two, and for such <code>i</code>, we yield <code>i</code> and <code>-i-1</code>:</p>\n\n<pre><code>[ m  | n &lt;- [1,3..], m &lt;- [n, -n-1]]\n</code></pre>\n\n<p>then for example we can yield:</p>\n\n<pre><code>Prelude&gt; take 10 [ m  | n &lt;- [1,3..], m &lt;- [n, -n-1]]\n[1,-2,3,-4,5,-6,7,-8,9,-10]\n</code></pre>\n\n<p>Or we can write it as:</p>\n\n<pre><code>[1, 3..] &gt;&gt;= \\i -&gt; [i, -i-1]\n</code></pre>\n\n<p>We can also work with <code>zipWith</code>:</p>\n\n<pre><code>zipWith (*) [1..] $ cycle [1, -1]\n</code></pre>\n\n<p>Or a solution where we iterate over functions:</p>\n\n<pre><code>zipWith ($) (cycle [id, negate]) [1..]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": false, "score": 1, "last_activity_date": 1520446722, "creation_date": 1520446722, "answer_id": 49158751, "question_id": 49147350, "link": "https://stackoverflow.com/questions/49147350/haskell-infinite-list-with-alternating-signs/49158751#49158751", "title": "Haskell infinite list with alternating signs", "body": "<p>A possibility:</p>\n\n<pre><code>&gt; x = concatMap (\\i -&gt; [i,-i-1]) [i | i &lt;- [0..], even i]\n&gt; take 10 x\n[0,-1,2,-3,4,-5,6,-7,8,-9]\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9300860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d17d0a14f414e21c35453877acd65d00?s=128&d=identicon&r=PG&f=1", "display_name": "black", "link": "https://stackoverflow.com/users/9300860/black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 49147390, "answer_count": 2, "score": 0, "last_activity_date": 1520446722, "creation_date": 1520411719, "last_edit_date": 1520426244, "question_id": 49147350, "link": "https://stackoverflow.com/questions/49147350/haskell-infinite-list-with-alternating-signs", "title": "Haskell infinite list with alternating signs", "body": "<p>I try to generate a infinite list like this:</p>\n\n<pre><code>[1,-2,3,-4..]\n</code></pre>\n\n<p>with this code:</p>\n\n<pre><code>[ m  | n &lt;- [1..],m &lt;- [n, -n]]\n</code></pre>\n\n<p>but this code reduplicate all numbers like this:</p>\n\n<pre><code>[1,-1,2,-2..]\n</code></pre>\n\n<p>So i dont know what to do</p>\n"}, {"tags": ["haskell", "list-comprehension"], "answers": [{"comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 649, "user_id": 2129212, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/p4ojp.png?s=128&g=1", "display_name": "Swapnil B.", "link": "https://stackoverflow.com/users/2129212/swapnil-b"}, "edited": false, "score": 1, "creation_date": 1520438778, "post_id": 49144524, "comment_id": 85317389, "body": "@SwapnilB. as an additional comment I want to add that sometimes it&#39;s better to use <code>ilist</code> package if you do a lot of work with indexes. It defines a lot of indexed versions of functions: <a href=\"https://hackage.haskell.org/package/ilist\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/ilist</a>"}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 15, "last_activity_date": 1520399233, "creation_date": 1520399233, "answer_id": 49144524, "question_id": 49144465, "link": "https://stackoverflow.com/questions/49144465/index-of-current-element-in-haskell-list-comprehension/49144524#49144524", "title": "Index of current element in Haskell list comprehension", "body": "<p>Index each element with an integer using <code>zip</code>:</p>\n\n<pre><code>funcName k = [if i == 2 then ... else ... | (i,x) &lt;- zip [0..] list, x == k]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": false, "score": 3, "last_activity_date": 1520444092, "creation_date": 1520444092, "answer_id": 49158027, "question_id": 49144465, "link": "https://stackoverflow.com/questions/49144465/index-of-current-element-in-haskell-list-comprehension/49158027#49158027", "title": "Index of current element in Haskell list comprehension", "body": "<p>Maybe like this with the <code>ilist</code> library (a very useful library):</p>\n\n<pre><code>import Data.List.Index \n&gt; indexed [i*i | i &lt;- [7,6,5]]\n[(0,49),(1,36),(2,25)]\n</code></pre>\n\n<p>Not sure it's exactly what you want but that should be close I believe.</p>\n"}], "owner": {"reputation": 649, "user_id": 2129212, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/p4ojp.png?s=128&g=1", "display_name": "Swapnil B.", "link": "https://stackoverflow.com/users/2129212/swapnil-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2064, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1520444092, "creation_date": 1520398872, "question_id": 49144465, "link": "https://stackoverflow.com/questions/49144465/index-of-current-element-in-haskell-list-comprehension", "title": "Index of current element in Haskell list comprehension", "body": "<p>Is there any way that I can know the index of current element that x is pointing to in the code below:</p>\n\n<pre><code>funcName k = [&lt;current_index_here&gt; | x &lt;- list, x == k]\n</code></pre>\n\n<p>Any help would be greatly appreciated.. Thanks :)</p>\n"}, {"tags": ["haskell", "types", "infinite", "typechecking", "type-systems"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520393598, "post_id": 49143537, "comment_id": 85292641, "body": "You may be interested in reading about Hindley-Milner type inference. GHC has a form of bidirectional typechecking. When looking at <code>infinity</code>, Haskell will attempt to synthesize <code>infinity :: NaturalNumber</code> (since it is constructed using <code>S :: NaturalNumber -&gt; NaturalNumber</code>) and then check that <code>infinity :: NaturalNumber</code> (since <code>infinity</code> is the argument given to <code>S</code>)."}, {"owner": {"reputation": 33, "user_id": 9454390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1610cd4a6a5347a14987fdd4f77591f5?s=128&d=identicon&r=PG&f=1", "display_name": "H. User", "link": "https://stackoverflow.com/users/9454390/h-user"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520393966, "post_id": 49143537, "comment_id": 85292728, "body": "OK -- so essentially it guesses at types (in some intelligent manner) and then attempts to see if then the types match up? Is there any guarantee of termination (of the type checker) with a correct result then?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9454390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1610cd4a6a5347a14987fdd4f77591f5?s=128&d=identicon&r=PG&f=1", "display_name": "H. User", "link": "https://stackoverflow.com/users/9454390/h-user"}, "edited": false, "score": 0, "creation_date": 1520395916, "post_id": 49143793, "comment_id": 85293215, "body": "Thanks. This explains it, especially the last paragraph."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1520405971, "post_id": 49143793, "comment_id": 85296551, "body": "I think it&#39;s much more precise to say that the type checker tries to prove that the program is well-typed. Discovering a definite error is a special case of failing to type the program."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 8, "last_activity_date": 1531835482, "last_edit_date": 1531835482, "creation_date": 1520394563, "answer_id": 49143793, "question_id": 49143537, "link": "https://stackoverflow.com/questions/49143537/how-does-haskell-type-check-infinite-recursive-values/49143793#49143793", "title": "How does Haskell type-check infinite recursive values?", "body": "<p>Well</p>\n\n<pre><code>S :: NaturalNumber -&gt; NaturalNumber\n</code></pre>\n\n<p>In</p>\n\n<pre><code>infinity = S infinity\n</code></pre>\n\n<p>We start by assuming nothing: we assign <code>infinity</code> some unsolved type <code>_a</code> and try to figure out what it is. We know that we have applied <code>S</code> to <code>infinity</code>, so <code>_a</code> must be whatever is on the left side of the arrow in the constructor\u2019s type, which is <code>NaturalNumber</code>. We know that <code>infinity</code> is the result of an application of <code>S</code>, so <code>infinity :: NaturalNumber</code>, again (if we got two conflicting types for this definition, we\u2019d have to emit a type error).</p>\n\n<p>Similar reasoning holds for the mutually recursive definitions. <code>inf1</code> must be a <code>NaturalNumber</code> because it appears as an argument to <code>S</code> in <code>inf2</code>; <code>inf2</code> must be a <code>NaturalNumber</code> because it is the result of <code>S</code>; etc.</p>\n\n<p>The general algorithm is to assign definitions unknown types (notable exceptions are literals and constructors), and then to create constraints on those types by seeing how every definition is used. E.g. this must be some form of list because it\u2019s being <code>reverse</code>d, and this must be an <code>Int</code> because it\u2019s being used to look up a value from an <code>IntMap</code>, etc.</p>\n\n<p>In the case of</p>\n\n<pre><code>oops = S 'a'\n</code></pre>\n\n<p><code>'a' :: Char</code> as it\u2019s a literal, but, also, we must have <code>'a' :: NaturalNumber</code> because it\u2019s used as an argument to <code>S</code>. We get the obviously bogus constraint that the type of the literal must both be <code>Char</code> and <code>NaturalNumber</code>, which causes a type error.</p>\n\n<p>And in</p>\n\n<pre><code>bottom = bottom\n</code></pre>\n\n<p>We start with <code>bottom :: _a</code>. The only constraint is <code>_a ~ _a</code>, because a value of type <code>_a</code> (<code>bottom</code>) is being used where a value of type <code>_a</code> is expected (on the RHS of the definition of <code>bottom</code>). Since there is nothing to further constrain the type, the unsolved type variable is <em>generalized</em>: it gets bound by a universal quantifier to produce <code>bottom :: forall a. a</code>.</p>\n\n<p>Note how both uses of <code>bottom</code> above have the same type (<code>_a</code>) while inferring the type of <code>bottom</code>. This breaks polymorphic recursion: every occurrence of a value within its definition is taken to be of the same type as the definition itself. E.g.</p>\n\n<pre><code>-- perfectly balanced binary trees\ndata Binary a = Leaf a | Branch (Binary (a, a))\n-- headB :: _a -&gt; _r\nheadB (Leaf x) = x -- _a ~ Binary _r; headB :: Binary _r -&gt; _r\nheadB (Branch bin) = fst (headB bin)\n-- recursive call has type headB :: Binary _r -&gt; _r\n-- but bin :: Binary (_r, _r); mismatch\n</code></pre>\n\n<p>So you need a type signature:</p>\n\n<pre><code>headB :: {-forall a.-} Binary a -&gt; a\nheadB (Leaf x) = x\nheadB (Branch bin) = fst (headB {-@(a, a)-} bin)\n-- knowing exactly what headB's signature is allows for polymorphic recursion\n</code></pre>\n\n<p>So: when something doesn't have a type signature, the type checker tries to assign it a type, and if it comes across a bogus constraint on its way, it rejects the program. When something has a type signature, the type checker descends into it to make sure it's correct (tries to prove it wrong, if you prefer to think of it that way).</p>\n\n<p>Haskell\u2019s type system is not Turing complete because there are heavy syntactic restrictions to prevent e.g. type lambdas (without language extensions), but it doesn\u2019t suffice to make sure all programs run to completion without error because it still allows bottoms (not to mention all the unsafe functions). It provides the weaker guarantee that, if a program runs to completion without using an unsafe function, it will remain type-correct. Under GHC, with sufficient language extensions, the type system does become Turing complete. I don't think it allows ill-typed programs through; I think the most you can do is throw the compiler into an infinite loop.</p>\n"}], "owner": {"reputation": 33, "user_id": 9454390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1610cd4a6a5347a14987fdd4f77591f5?s=128&d=identicon&r=PG&f=1", "display_name": "H. User", "link": "https://stackoverflow.com/users/9454390/h-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 49143793, "answer_count": 1, "score": 3, "last_activity_date": 1531835482, "creation_date": 1520392652, "last_edit_date": 1520394992, "question_id": 49143537, "link": "https://stackoverflow.com/questions/49143537/how-does-haskell-type-check-infinite-recursive-values", "title": "How does Haskell type-check infinite recursive values?", "body": "<p>Define this data type:</p>\n\n<pre><code>data NaturalNumber = Zero | S NaturalNumber\n    deriving (Show)\n</code></pre>\n\n<p>In Haskell (compiled using GHC), this code will run without warning or error:</p>\n\n<pre><code>infinity = S infinity\ninf1 = S inf2\ninf2 = S inf1\n</code></pre>\n\n<p>So both recursive and mutually recursive infinitely deep values pass the type check.</p>\n\n<p>However, the following code gives an error:</p>\n\n<pre><code>j = S 'h'\n</code></pre>\n\n<p>The error states <code>Couldn't match expected type \u2018NaturalNumber\u2019 with actual type 'Char'</code>. The (same) error persists even if I set</p>\n\n<pre><code>j = S (S (S (S ... (S 'h')...)))\n</code></pre>\n\n<p>with a hundred or so nested <code>S</code>'s.</p>\n\n<p>How can Haskell tell that <code>infinity</code> is a valid member of <code>NaturalNumber</code> but <code>j</code> is not?</p>\n\n<p>Interestingly, it also allows:</p>\n\n<pre><code>bottom = bottom\nk = S bottom\n</code></pre>\n\n<p>Does Haskell merely try to prove incorrectness of a program, and if it fails to do so then allows it? Or is Haskell's type system not Turing complete, so if it allows the program then the program is provably (at the type level) correct?</p>\n\n<p>(If the type system (in the formal semantics of Haskell, instead of only the type checker) is Turing complete, then it will either fail to realize some correctly typed programs are correct or some incorrectly typed programs are incorrect, due to the undecidability of the halting problem.)</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1520380217, "post_id": 49141893, "comment_id": 85289302, "body": "The expansion is fun.  <code>foo ~ 1 + foo `div` 10 ~  1 + (1 + foo `div` 10) `div` 10 ~ 1 + (1 + (1 + foo `div` 10) `div` 10) `div` 10 ~ ...</code>"}, {"owner": {"reputation": 1278, "user_id": 1374078, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a96abe3865e9d233197150b1ae83743a?s=128&d=identicon&r=PG", "display_name": "phoxd", "link": "https://stackoverflow.com/users/1374078/phoxd"}, "edited": false, "score": 0, "creation_date": 1520380301, "post_id": 49141893, "comment_id": 85289330, "body": "I just realized that I made mistake for the case when x is 0. How would you account if it&#39;s a single number 0 to be of size 1?"}, {"owner": {"reputation": 1278, "user_id": 1374078, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a96abe3865e9d233197150b1ae83743a?s=128&d=identicon&r=PG", "display_name": "phoxd", "link": "https://stackoverflow.com/users/1374078/phoxd"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1520381098, "post_id": 49141893, "comment_id": 85289568, "body": "@ThomasM.DuBuisson Did you use Trace or something else to print that?"}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 7, "last_activity_date": 1520379998, "creation_date": 1520379998, "answer_id": 49141893, "question_id": 49141797, "link": "https://stackoverflow.com/questions/49141797/why-this-is-not-terminating-1-sizeofint-x-div-10/49141893#49141893", "title": "Why this is not terminating ```1 + (sizeofInt x `div` 10)```?", "body": "<p>Without the brackets you're saying <code>(sizeofInt x) `div` 10</code>, which calls <code>sizeofInt x</code> forever. Application always binds more tightly than any operator.</p>\n"}], "owner": {"reputation": 1278, "user_id": 1374078, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a96abe3865e9d233197150b1ae83743a?s=128&d=identicon&r=PG", "display_name": "phoxd", "link": "https://stackoverflow.com/users/1374078/phoxd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 49141893, "answer_count": 1, "score": 1, "last_activity_date": 1520381015, "creation_date": 1520379422, "last_edit_date": 1520381015, "question_id": 49141797, "link": "https://stackoverflow.com/questions/49141797/why-this-is-not-terminating-1-sizeofint-x-div-10", "title": "Why this is not terminating ```1 + (sizeofInt x `div` 10)```?", "body": "<pre><code>sizeofInt :: Int -&gt; Int\nsizeofInt 0 = 0\nsizeofInt x = 1 + (sizeofInt x `div` 10)\n</code></pre>\n\n<p>Why does this function not terminate unless I put brackets around <code>x `div` 10</code>?</p>\n\n<p><strong>UPDATE</strong>: fixed the case when number is 0</p>\n\n<pre><code>sizeofInt :: Int -&gt; Int\nsizeofInt x = if m == 0 then 1\n  else 1 + sizeofInt m\n  where m = x `div` 10\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "happy", "alex"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1520382517, "post_id": 49141729, "comment_id": 85290002, "body": "Tool output is text. Please include it in your post as text, not as links to images."}, {"owner": {"reputation": 11, "user_id": 7891692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b416ffe05b5f3ab5d6322e91a87614d2?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldor", "link": "https://stackoverflow.com/users/7891692/sheldor"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1520387599, "post_id": 49141729, "comment_id": 85291306, "body": "@Carl I&#39;ve updated my post now with the start of the error message, it was too big to fit into the question."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520392444, "post_id": 49141729, "comment_id": 85292351, "body": "Which version of Happy are you using? I fixed a couple of similar looking bugs in Happy not too long ago. Similar in the errors generated, as well as the setup. Did you know that cabal automatically calls Happy with <code>-agc</code>?"}, {"owner": {"reputation": 11, "user_id": 7891692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b416ffe05b5f3ab5d6322e91a87614d2?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldor", "link": "https://stackoverflow.com/users/7891692/sheldor"}, "edited": false, "score": 0, "creation_date": 1520428967, "post_id": 49141729, "comment_id": 85310328, "body": "I&#39;m using Happy version 1.19.8, and no i wasn&#39;t aware that cabal called it with <code>-agc</code>, thats probably why it&#39;s failing."}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1521329315, "post_id": 49141729, "comment_id": 85686113, "body": "@Sheldor if you have an answer, can you post it so as to resolve this for future readers?"}], "owner": {"reputation": 11, "user_id": 7891692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b416ffe05b5f3ab5d6322e91a87614d2?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldor", "link": "https://stackoverflow.com/users/7891692/sheldor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521330765, "creation_date": 1520379007, "last_edit_date": 1521330765, "question_id": 49141729, "link": "https://stackoverflow.com/questions/49141729/cabal-build-producing-errors-code-seems-fine-manually", "title": "Cabal Build Producing Errors - Code Seems Fine Manually?", "body": "<p>Throughout my development i've been manually running alex/happy to generate my parser files and then running ghci to test the code. This works fine and loads me into GHCI, but whenever I run <code>cabal repl</code> the program throws an error in my <code>Parser.hs</code> file. </p>\n\n<p>The error is a type error: <code>Couldn't match type '[a]' with 'Expression'</code> but whenever I'd been testing this code manually with <code>ghci main</code> the code runs fine?</p>\n\n<p>I'm not sure if I'm not fully understanding how cabal works but I've noticed that the haskell parser generated from happy, and from cabal are quite different.</p>\n\n<p>I've attached the start of the error message for the cabal build command below. </p>\n\n<p><strong>Edit</strong></p>\n\n<p>So as pointed out by Alec whenever cabal build is ran it invokes happy with the <code>-agc</code> flags, I wasn't aware for this and because of it my code needed tweaking.</p>\n\n<p>The solution is to build the Happy parser with the <code>-agc</code> flags and ensure it compiles that way. This may lead to some new errors within your parser as the resultant parsers differ slightly but from my research there is no way for <code>cabal repl</code> to run with happy without the aforementioned flags.</p>\n\n<pre><code>  PS D:\\Documents\\GitHub\\solidiscan&gt; cabal build\n  Preprocessing executable 'solidiscan' for solidiscan-0.1.0.0..\n  Building executable 'solidiscan' for solidiscan-0.1.0.0..\n  [3 of 6] Compiling Solidiscan.Parser ( dist\\build\\solidiscan\\solidiscan-tmp\\Solidiscan\\Parser.hs, dist\\build\\solidiscan\\solidiscan-tmp\\Solidiscan\\Parse\n  r.o )\n\n  dist\\build\\solidiscan\\solidiscan-tmp\\Solidiscan\\Parser.hs:2429:42: error:\n      * Couldn't match type `[a]' with `Expression'\n        Expected type: HappyAbsSyn\n                        [SourceUnit]\n                        SourceUnit\n                        [Char]\n                        [Char]\n                        Token\n                        InheritanceSpec\n                        InheritanceSpecifier\n                        InheritanceSpecifier\n                        [Expression]\n                        Expression\n                        [[Expression]]\n                        [Expression]\n                        [EnumValue]\n                        EnumValue\n                        [[EParameters]]\n                        [EParameters]\n                        EParameters\n                        Token\n                        [[Parameter]]\n                        [Parameter]\n                        Parameter\n                        ReturnParam\n                        [Expression]\n                        Token\n                        Token\n                        PublicKeyword\n                        [a]\n                        [a]\n                        [Expression]\n                        Expression\n                        TypeName\n                        [Expression]\n                        Expression\n                        Expression\n                        Expression\n                        Expression\n                        ElseState\n                        Int\n                        TypeName\n                        ElemType\n                        [Expression]\n                        [ContractConts]\n                        [EParameters]\n                        [Expression]\n                        [FuncMods]\n                        [[Expression]]\n                        [EnumValue]\n                        [InheritanceSpecifier]\n                        [Parameter]\n                        [Expression]\n                        [Token]\n                        [PublicKeyword]\n                        [ElseState]\n                        [[[EParameters]]]\n                        [[EParameters]]\n                        [Expression]\n                        [[Expression]]\n                        [InheritanceSpec]\n                        [Expression]\n                        [[[Parameter]]]\n                        [[Parameter]]\n                        [ReturnParam]\n                        [StorageLocation]\n                        [Expression]\n                        [ContractConts]\n                        [EParameters]\n                        [Expression]\n                        [FuncMods]\n                        [[Expression]]\n                        [EnumValue]\n                        [InheritanceSpecifier]\n                        [Parameter]\n                        [Expression]\n                      -&gt; HappyAbsSyn\n                            [SourceUnit]\n                            SourceUnit\n                            [Char]\n                            [Char]\n                            Token\n                            InheritanceSpec\n                            InheritanceSpecifier\n                            InheritanceSpecifier\n                            [Expression]\n                            Expression\n                            [[Expression]]\n                            [Expression]\n                            [EnumValue]\n                            EnumValue\n                            [[EParameters]]\n                            [EParameters]\n                            EParameters\n                            Token\n                            [[Parameter]]\n                            [Parameter]\n                            Parameter\n                            ReturnParam\n                            [Expression]\n                            Token\n                            TypeName\n                            PublicKeyword\n                            [a]\n                            Expression\n                            [Expression]\n                            Expression\n                            TypeName\n                            [Expression]\n                            Expression\n                            Expression\n                            Expression\n                            Expression\n                            ElseState\n                            Int\n                            TypeName\n                            ElemType\n                            [Expression]\n                            [ContractConts]\n                            [EParameters]\n                            [Expression]\n                            [FuncMods]\n                            [[Expression]]\n                            [EnumValue]\n                            [InheritanceSpecifier]\n                            [Parameter]\n                            [Expression]\n                            [Token]\n                            [PublicKeyword]\n                            [ElseState]\n                            [[[EParameters]]]\n                            [[EParameters]]\n                            [Expression]\n                            [[Expression]]\n                            [InheritanceSpec]\n                            [Expression]\n                            [[[Parameter]]]\n                            [[Parameter]]\n                            [ReturnParam]\n                            [StorageLocation]\n                            [Expression]\n                            [ContractConts]\n                            [EParameters]\n                            [Expression]\n                            [FuncMods]\n                            [[Expression]]\n                            [EnumValue]\n                            [InheritanceSpecifier]\n                            [Parameter]\n                            [Expression]\n          Actual type: HappyAbsSyn\n                        [SourceUnit]\n                        SourceUnit\n                        [Char]\n                        [Char]\n                        Token\n                        InheritanceSpec\n                        InheritanceSpecifier\n                        InheritanceSpecifier\n                        [Expression]\n                        Expression\n                        [[Expression]]\n                        [Expression]\n                        [EnumValue]\n                        EnumValue\n                        [[EParameters]]\n                        [EParameters]\n                        EParameters\n                        Token\n                        [[Parameter]]\n                        [Parameter]\n                        Parameter\n                        ReturnParam\n                        [Expression]\n                        Token\n                        Token\n                        PublicKeyword\n                        [a]\n                        [a]\n                        [Expression]\n                        Expression\n                        TypeName\n                        [Expression]\n                        Expression\n                        Expression\n                        Expression\n                        Expression\n                        ElseState\n                        Int\n                        TypeName\n                        ElemType\n                        [Expression]\n                        [ContractConts]\n                        [EParameters]\n                        [Expression]\n                        [FuncMods]\n                        [[Expression]]\n                        [EnumValue]\n                        [InheritanceSpecifier]\n                        [Parameter]\n                        [Expression]\n                        [Token]\n                        [PublicKeyword]\n                        [ElseState]\n                        [[[EParameters]]]\n                        [[EParameters]]\n                        [Expression]\n                        [[Expression]]\n                        [InheritanceSpec]\n                        [Expression]\n                        [[[Parameter]]]\n                        [[Parameter]]\n                        [ReturnParam]\n                        [StorageLocation]\n                        [Expression]\n                        [ContractConts]\n                        [EParameters]\n                        [Expression]\n                        [FuncMods]\n                        [[Expression]]\n                        [EnumValue]\n                        [InheritanceSpecifier]\n                        [Parameter]\n                        [Expression]\n                      -&gt; HappyAbsSyn\n                            [SourceUnit]\n                            SourceUnit\n                            [Char]\n                            [Char]\n                            Token\n                            InheritanceSpec\n                            InheritanceSpecifier\n                            InheritanceSpecifier\n                            [Expression]\n                            Expression\n                            [[Expression]]\n                            [Expression]\n                            [EnumValue]\n                            EnumValue\n                            [[EParameters]]\n                            [EParameters]\n                            EParameters\n                            Token\n                            [[Parameter]]\n                            [Parameter]\n                            Parameter\n                            ReturnParam\n                            [Expression]\n                            Token\n                            TypeName\n                            PublicKeyword\n                            [a]\n                            Expression\n                            [Expression]\n                            Expression\n                            TypeName\n                            [Expression]\n                            Expression\n                            Expression\n                            Expression\n                            Expression\n                            ElseState\n                            Int\n                            TypeName\n                            ElemType\n                            [Expression]\n                            [ContractConts]\n                            [EParameters]\n                            [Expression]\n                            [FuncMods]\n                            [[Expression]]\n                            [EnumValue]\n                            [InheritanceSpecifier]\n                            [Parameter]\n                            [Expression]\n                            [Token]\n                            [PublicKeyword]\n                            [ElseState]\n                            [[[EParameters]]]\n                            [[EParameters]]\n                            [Expression]\n                            [[Expression]]\n                            [InheritanceSpec]\n                            [[a]]\n                            [[[Parameter]]]\n                            [[Parameter]]\n                            [ReturnParam]\n                            [StorageLocation]\n                            [Expression]\n                            [ContractConts]\n                            [EParameters]\n                            [Expression]\n                            [FuncMods]\n                            [[Expression]]\n                            [EnumValue]\n                            [InheritanceSpecifier]\n                            [Parameter]\n                            [Expression]\n      * In the second argument of `happySpecReduce_1', namely\n          `happyReduction_161'\n        In the expression: happySpecReduce_1 81# happyReduction_161\n        In an equation for `happyReduce_161':\n            happyReduce_161 = happySpecReduce_1 81# happyReduction_161\n      * Relevant bindings include\n          happyReduce_161 :: Happy_GHC_Exts.Int#\n                            -&gt; Token\n                            -&gt; Happy_GHC_Exts.Int#\n                            -&gt; Happy_IntList\n                            -&gt; HappyStk\n                                  (HappyAbsSyn\n                                    [SourceUnit]\n                                    SourceUnit\n                                    [Char]\n                                    [Char]\n                                    Token\n                                    InheritanceSpec\n                                    InheritanceSpecifier\n                                    InheritanceSpecifier\n                                    [Expression]\n                                    Expression\n                                    [[Expression]]\n                                    [Expression]\n                                    [EnumValue]\n                                    EnumValue\n                                    [[EParameters]]\n                                    [EParameters]\n                                    EParameters\n                                    Token\n                                    [[Parameter]]\n                                    [Parameter]\n                                    Parameter\n                                    ReturnParam\n                                    [Expression]\n                                    Token\n                                    TypeName\n                                    PublicKeyword\n                                    [a]\n                                    Expression\n                                    [Expression]\n                                    Expression\n                                    TypeName\n                                    [Expression]\n                                    Expression\n                                    Expression\n                                    Expression\n                                    Expression\n                                    ElseState\n                                    Int\n                                    TypeName\n                                    ElemType\n                                    [Expression]\n                                    [ContractConts]\n                                    [EParameters]\n                                    [Expression]\n                                    [FuncMods]\n                                    [[Expression]]\n                                    [EnumValue]\n                                    [InheritanceSpecifier]\n                                    [Parameter]\n                                    [Expression]\n                                    [Token]\n                                    [PublicKeyword]\n                                    [ElseState]\n                                    [[[EParameters]]]\n                                    [[EParameters]]\n                                    [Expression]\n                                    [[Expression]]\n                                    [InheritanceSpec]\n                                    [Expression]\n                                    [[[Parameter]]]\n                                    [[Parameter]]\n                                    [ReturnParam]\n                                    [StorageLocation]\n                                    [Expression]\n                                    [ContractConts]\n                                    [EParameters]\n                                    [Expression]\n                                    [FuncMods]\n                                    [[Expression]]\n                                    [EnumValue]\n                                    [InheritanceSpecifier]\n                                    [Parameter]\n                                    [Expression])\n                            -&gt; [Token]\n                            -&gt; HappyIdentity\n                                  (HappyAbsSyn\n                                    [SourceUnit]\n                                    SourceUnit\n                                    [Char]\n                                    [Char]\n                                    Token\n                                    InheritanceSpec\n                                    InheritanceSpecifier\n                                    InheritanceSpecifier\n                                    [Expression]\n                                    Expression\n                                    [[Expression]]\n                                    [Expression]\n                                    [EnumValue]\n                                    EnumValue\n                                    [[EParameters]]\n                                    [EParameters]\n                                    EParameters\n                                    Token\n                                    [[Parameter]]\n                                    [Parameter]\n                                    Parameter\n                                    ReturnParam\n                                    [Expression]\n                                    Token\n                                    TypeName\n                                    PublicKeyword\n                                    [a]\n                                    Expression\n                                    [Expression]\n                                    Expression\n                                    TypeName\n                                    [Expression]\n                                    Expression\n                                    Expression\n                                    Expression\n                                    Expression\n                                    ElseState\n                                    Int\n                                    TypeName\n                                    ElemType\n                                    [Expression]\n                                    [ContractConts]\n                                    [EParameters]\n                                    [Expression]\n                                    [FuncMods]\n                                    [[Expression]]\n                                    [EnumValue]\n                                    [InheritanceSpecifier]\n                                    [Parameter]\n                                    [Expression]\n                                    [Token]\n                                    [PublicKeyword]\n                                    [ElseState]\n                                    [[[EParameters]]]\n                                    [[EParameters]]\n                                    [Expression]\n                                    [[Expression]]\n                                    [InheritanceSpec]\n                                    [Expression]\n                                    [[[Parameter]]]\n                                    [[Parameter]]\n                                    [ReturnParam]\n                                    [StorageLocation]\n                                    [Expression]\n                                    [ContractConts]\n                                    [EParameters]\n                                    [Expression]\n                                    [FuncMods]\n                                    [[Expression]]\n                                    [EnumValue]\n                                    [InheritanceSpecifier]\n                                    [Parameter]\n                                    [Expression])\n            (bound at dist\\build\\solidiscan\\solidiscan-tmp\\Solidiscan\\Parser.hs:2429:1)\n      |\n  2429 | happyReduce_161 = happySpecReduce_1  81# happyReduction_161\n      |                                          ^^^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1520377502, "post_id": 49141348, "comment_id": 85288374, "body": "<code>newtype AppM m a = AppM { unAppM :: MockedChatEngine m a } deriving (ChatEngine)</code>? Although I&#39;m not super clear what your question is/where the problem is."}, {"owner": {"reputation": 1747, "user_id": 343761, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cf716ff342bad8a3aa8178ab9b39366d?s=128&d=identicon&r=PG", "display_name": "homam", "link": "https://stackoverflow.com/users/343761/homam"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1520380382, "post_id": 49141348, "comment_id": 85289357, "body": "I may have another feature like Weather: <code>class Monad m =&gt; WeatherAPI m where weatherByCity :: String -&gt; m WeatherData</code> and its mock: <code>newtype MockedWeatherAPI m a...</code>. But this fails: <code>newtype AppM m a = AppM { unAppM :: MockedWeatherAPI (MockedChatEngine m) a } deriving (...,ChatEngine, WeatherAPI)</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1520381047, "post_id": 49141348, "comment_id": 85289549, "body": "At a guess, that fails because you have not made an <code>instance ChatEngine m =&gt; ChatEngine (MockedWeatherAPI m)</code>. But to know for sure I would want to see an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a> and the exact compiler error you get."}, {"owner": {"reputation": 1747, "user_id": 343761, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cf716ff342bad8a3aa8178ab9b39366d?s=128&d=identicon&r=PG", "display_name": "homam", "link": "https://stackoverflow.com/users/343761/homam"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1520419084, "post_id": 49141348, "comment_id": 85303818, "body": "I think it is better to explain my problem a followup question: <a href=\"https://stackoverflow.com/questions/49149787/avoiding-orphan-instances-with-monad-transformers\" title=\"avoiding orphan instances with monad transformers\">stackoverflow.com/questions/49149787/&hellip;</a>"}], "owner": {"reputation": 1747, "user_id": 343761, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cf716ff342bad8a3aa8178ab9b39366d?s=128&d=identicon&r=PG", "display_name": "homam", "link": "https://stackoverflow.com/users/343761/homam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1520376684, "creation_date": 1520376684, "question_id": 49141348, "link": "https://stackoverflow.com/questions/49141348/mockable-functionalities-by-mixing-monad-transformers", "title": "Mockable Functionalities by Mixing Monad Transformers", "body": "<p>How can I build separate functionalities in independent and mockable monads and then put them together in my main app monad?</p>\n\n<p>For example let's assume my app has a chat feature.</p>\n\n<p>I am following <a href=\"https://lexi-lambda.github.io/blog/2017/06/29/unit-testing-effectful-haskell-with-monad-mock/\" rel=\"nofollow noreferrer\">Unit testing effectful Haskell with monad-mock\n</a> and I should be able to easily switch the implementation of a simple chat server in my app.</p>\n\n<p>I tried to model the chat engine by a monad:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Monad m =&gt; ChatEngine m where\n  login :: Username -&gt; m (S.Set User)\n  publish :: Username -&gt; PostBody -&gt; m [Post]\n  allPosts :: m [Post]\n\n  default login :: (MonadTrans t, ChatEngine m', m ~ t m') =&gt; Username -&gt; m (S.Set User)\n  login = lift . login\n\n  default publish :: (MonadTrans t, ChatEngine m', m ~ t m') =&gt; Username -&gt; PostBody -&gt; m [Post]\n  publish u = lift . publish u\n\n  default allPosts :: (MonadTrans t, ChatEngine m', m ~ t m') =&gt; m [Post]\n  allPosts = lift allPosts\n\ninstance ChatEngine m =&gt; ChatEngine (ExceptT e m)\n-- ...\n</code></pre>\n\n<p><code>AppM m</code> is my app monad that can be the underlying monad in a any transformer stack, like a <a href=\"https://stackoverflow.com/questions/48286926/using-readert-transformer-in-scottyt-vs-actiont\">Scotty Web server</a>: <code>type AppM m a = ReaderT AppConfig m a</code>.</p>\n\n<p>I can add <code>StateT</code> or <code>MonadIO</code> to <code>AppM</code> stack and implement <code>ChatEngine</code> interface for <code>AppM</code>. But what if I want to use a default, pre-made instance of <code>ChatEngine</code>? For example this simple mock:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data InMemoryChat = InMemoryChat {\n  users :: S.Set User\n, posts :: [Post]\n}\n\nnewtype MockedChatEngine m a = MockedChatEngine {\n  unMockChatEngine :: StateT InMemoryChat m a\n} deriving (Functor, Applicative, Monad, MonadTrans, MonadIO, MonadError e, MonadReader r, MonadWriter w, MonadState InMemoryChat)\n\ninstance (MonadIO m, Monad m) =&gt; ChatEngine (MockedChatEngine m) where\n  login username = MockedChatEngine $ do\n    now &lt;- liftIO Clock.getCurrentTime\n    users' &lt;- fmap users get\n    return $ S.insert (mkUser username now) users'\n\n  publish username body = MockedChatEngine $ do\n    now &lt;- liftIO Clock.getCurrentTime\n    InMemoryChat users' posts' &lt;- get\n    let posts'' = mkPost username body now : posts'\n    put $ InMemoryChat users' posts''\n    return posts''\n\n  allPosts = MockedChatEngine $ fmap posts get\n</code></pre>\n\n<p>I needed <code>AppM</code> to have a mix of features and functionalities, like having a chat engine.</p>\n\n<p>So I tried this approach:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data AppMState = AppMState {\n  chatEngine :: MockedChatEngine Identity ()\n-- , someOtherFeature ::\n}\n\nnewtype AppM m a = AppM { unAppM :: ReaderT AppMState m a }\n  deriving (Functor, Applicative, Monad, MonadTrans, MonadIO, MonadReader AppMState)\n\ninstance (Monad m, MonadIO m) =&gt; ChatEngine (AppM m) where\n  allPosts = do\n    engine &lt;- fmap chatEngine ask\n    -- now what?\n    undefined\n  publish = undefined\n  login = undefined\n</code></pre>\n\n<p>And I am obviously missing something.</p>\n\n<p>Generally what is the right way of building a larger app by developing independent features with replaceable implementations and putting them together using monad transformers?</p>\n"}, {"tags": ["haskell", "functional-programming", "generic-programming", "fold", "proof"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1520364302, "post_id": 49138464, "comment_id": 85282034, "body": "Actually you <i>can</i> implement <code>dropWhile</code> with the standard <code>fold</code>."}, {"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1520364331, "post_id": 49138464, "comment_id": 85282054, "body": "@WillemVanOnsem can you give an example?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1520364473, "post_id": 49138464, "comment_id": 85282129, "body": "sorry, somehow I mixed <code>takeWhile</code> and <code>dropWhile</code> :)"}, {"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1520364552, "post_id": 49138464, "comment_id": 85282172, "body": "@WillemVanOnsem, yeah. there is no way to implement <code>dropWhile</code>, it can be proven by simple calculation with help of universal property from the OP. in order to implement <code>dropWhile</code> one has to generalize to a pair <code>(rs, ys)</code>, than it&#39;s fine. the problem there is exactly the same: unbound <code>xs</code>."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 2, "creation_date": 1520368177, "post_id": 49138464, "comment_id": 85284087, "body": "I am sorry, but could someone explain for a simple man, what <code>fold</code> is the talk about? Right or left?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1520368394, "post_id": 49138464, "comment_id": 85284205, "body": "@IgnatInsarov It is a right fold -- the canonical way of tearing down a (cons) list."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520368584, "post_id": 49138464, "comment_id": 85284307, "body": "@duplode I am then having trouble reconciling this question with the lengthy treatment of <code>foldr</code> in <a href=\"https://wiki.haskell.org/wikiupload/1/14/TMR-Issue6.pdf\" rel=\"nofollow noreferrer\">The Monad.Reader Issue 6</a>. To my understanding of the article, there are several ways to build a <code>dropWhile</code> from a <code>foldr</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1520369261, "post_id": 49138464, "comment_id": 85284625, "body": "A relevant discussion (for both you and @IgnatInsarov , I guess): <a href=\"https://stackoverflow.com/q/25146643/2751851\"><i>\u201cAny function on finite lists that is defined by pairing the desired result with the argument list can always be redefined in terms of fold\u201d</i></a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1520370913, "post_id": 49138464, "comment_id": 85285420, "body": "For what it is worth: if we flip arguments, we have <code>flip dropWhile = foldr (\\x k p -&gt; if p x then k p else x : k (\\_ -&gt; False)) (\\_ -&gt; [])</code>"}, {"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1520422874, "post_id": 49138464, "comment_id": 85306237, "body": "@chi, wow, pretty unexpected one! now the question is: can it be considered as a valid generalization of fold, or not? Have to think more about it..."}], "answers": [{"comments": [{"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 0, "creation_date": 1520423230, "post_id": 49142960, "comment_id": 85306443, "body": "+1 for you answer, though I have few remarks. First of all, you don&#39;t need &quot;<i>iff</i> <code>g = fold f i</code>. <i>iff</i> is redundant simply because having <code>g</code> guarantees existence of corresponding <code>fold f i</code>, where both <code>f</code> and <code>i</code> completely determined by <code>g</code>&#39;s definition. Please correct me, if I am mistaken here. The other thing is that you showed 2 different ways to implement <code>dropWhile</code>, hence the question &quot;are they both can be accepted as valid generalization?&quot; arises... and I don&#39;t have any answer yet, got no idea how to reason about this particular problem."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 1, "creation_date": 1520430724, "post_id": 49142960, "comment_id": 85311521, "body": "@SerejaBogolubov (1) The iff (or, equivalently, the &lt;=&gt; in your question) is not redundant -- the property is an equivalence, even though the right-to-left direction is trivial. (2) They are both correct implementations of <code>dropWhile</code>, so they are both valid. The follow-up question I would suggest instead would be whether <code>dropWhileFun</code> can be more straightforwardly expressed through some other recursion scheme, similarly to how <code>dropWhilePair</code> can be expressed as a paramorphism."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 4, "last_activity_date": 1522586471, "last_edit_date": 1522586471, "creation_date": 1520388223, "answer_id": 49142960, "question_id": 49138464, "link": "https://stackoverflow.com/questions/49138464/generalizing-fold-such-that-it-becomes-expressive-enough-to-define-any-finite-re/49142960#49142960", "title": "Generalizing fold such that it becomes expressive enough to define any finite recursion?", "body": "<p>It is as you say. The universal property says that <code>g [] = i; g (x:xs) = f x (g xs)</code> iff <code>g = fold f i</code>. This can't apply for a straightforward definition of <code>dropWhile</code>, as the would-be <code>f :: a -&gt; [a] -&gt; [a]</code> depends not just on the element and accumulated value at the current fold step, but also on the whole list suffix left to process (in your words, \"<code>xs</code> emerg[es] as an unbound variable\"). What can be done is twisting <code>dropWhile</code>so that this dependency on the list suffix becomes manifest in the accumulated value, be it through a tuple -- cf. <a href=\"https://stackoverflow.com/q/25146643/2751851\"><code>dropWhilePair</code> from this question</a>, with <code>f :: a -&gt; ([a], [a]) -&gt; ([a], [a])</code> -- or a function -- as in <a href=\"https://stackoverflow.com/questions/49138464/generalizing-fold-such-that-it-becomes-expressive-enough-to-define-any-finite-re#comment85285420_49138464\">chi's implementation</a>...</p>\n\n<pre><code>dropWhileFun = foldr (\\x k -&gt; \\p -&gt; if p x then k p else x : k (const False)) (const [])\n</code></pre>\n\n<p>... with <code>f :: a -&gt; ((a -&gt; Bool) -&gt; [a]) -&gt; ((a -&gt; Bool) -&gt; [a])</code>.</p>\n\n<p>At the end of the day, the universal property is what it is -- a fundamental fact about <code>foldr</code>. It is no accident that not all recursive functions are immediately expressible through <code>foldr</code>. In fact, the tupling workaround your question brings to the table directly reflects the notion of paramorphism (for an explanation of them, see <a href=\"https://stackoverflow.com/q/13317242/2751851\"><em>What are paramorphisms?</em> and its exquisite answer by Conor McBride</a>). At face value, paramorphisms are generalisations of catamorphisms (i.e. a straightforward fold); however, it only takes a slight contortion to implement paramorphisms in terms of catamorphisms. (Additional technical commentary on that might be found, for instance, in Chapter 3 of <a href=\"https://kodu.ut.ee/~varmo/papers/thesis.pdf\" rel=\"nofollow noreferrer\"><em>Categorical Programming With Inductive and Coinductive Types</em>, Varmo Vene's PhD thesis</a>.)</p>\n"}], "owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 1, "accepted_answer_id": 49142960, "answer_count": 1, "score": 8, "last_activity_date": 1522586471, "creation_date": 1520364151, "question_id": 49138464, "link": "https://stackoverflow.com/questions/49138464/generalizing-fold-such-that-it-becomes-expressive-enough-to-define-any-finite-re", "title": "Generalizing fold such that it becomes expressive enough to define any finite recursion?", "body": "<p>So, there is something known as a \"universal property of fold\", stating exactly following:</p>\n\n<p><code>g [] = i; g (x:xs) = f x (g xs)</code> &lt;=> <code>g = fold f i</code></p>\n\n<p>However, as you probably now, there are rare cases like <code>dropWhile</code>, which can not be redefined as <code>fold f i</code> <strong>unless you generalize it</strong>.</p>\n\n<p>The simplest yet obvious way to generalize is to redefine universal property:</p>\n\n<p><code>g' y [] = j y; g' y (x:xs) = h y x xs (g' y xs)</code> &lt;=> <code>g' y = fold (?) l</code></p>\n\n<hr>\n\n<p>At this point I can make my assumption: I assume existence of somewhat function <code>p :: a -&gt; b -&gt; b</code>, which would satisfy the equation <code>g' y = fold p l</code>. Let's try to solve given equation with help of universal property, mention at the very beginning:</p>\n\n<ul>\n<li><code>g' y [] = j y = fold p l [] = l</code> => <code>j y = l</code></li>\n<li><code>g' y (x:xs) = h y x xs (g' y xs) = fold p l (x:xs) = p x (fold p l xs) = p x (g' y xs)</code> => letting <code>rs = (g' y xs)</code>, <strong><code>h y x xs rs = p x rs</code>, which is wrong</strong>: <code>xs</code> occurs freely from the left and thus equality can't hold.</li>\n</ul>\n\n<hr>\n\n<p>Now let me try to interpret result I've came up with and ask question. \nI see that the problem is <code>xs</code> <strong>emerging as unbound variable</strong>; it's true for various situations, including above mentioned <code>dropWhile</code>. Does it mean that the only way that equation can be solved is by \"extending\" <code>rs</code> to a pair of <code>(rs, xs)</code>? In other words, <code>fold</code> accumulates into <strong>tuple rather than a single type</strong> (ignoring the fact that tuple itself is a single type)? Is there any other way to generalize bypassing pairing? </p>\n"}, {"tags": ["haskell", "unicode"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520363567, "post_id": 49137797, "comment_id": 85281661, "body": "With respect to the resource request close votes, I feel there should be some leeway for standard-library-esque things (such as date-and-time or Unicode). I&#39;d also say that is particularly relevant in the specific case of Haskell, whose actual standard library is, relatively speaking, quite narrowly scoped."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 7, "last_activity_date": 1520365105, "last_edit_date": 1520365105, "creation_date": 1520362042, "answer_id": 49137959, "question_id": 49137797, "link": "https://stackoverflow.com/questions/49137797/finding-unicode-script-of-a-char-in-haskell/49137959#49137959", "title": "Finding Unicode script of a Char in Haskell", "body": "<p><a href=\"https://hackage.haskell.org/package/text-icu-0.7.0.1/docs/Data-Text-ICU-Char.html#v:property\" rel=\"nofollow noreferrer\"><code>property</code></a> from <em>text-icu</em>'s <code>Data.Text.ICU.Char</code> seems to fit the bill:</p>\n\n<pre>import Data.Text.ICU.Char\n\nisCyrilic c = property <b><a href=\"https://hackage.haskell.org/package/text-icu-0.7.0.1/docs/Data-Text-ICU-Char.html#t:Block_\" rel=\"nofollow noreferrer\">Block</a></b> c == <b><a href=\"https://hackage.haskell.org/package/text-icu-0.7.0.1/docs/Data-Text-ICU-Char.html#t:BlockCode\" rel=\"nofollow noreferrer\">Cyrillic</a></b>\n</pre>\n"}], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 49137959, "answer_count": 1, "score": 4, "last_activity_date": 1520365105, "creation_date": 1520361438, "question_id": 49137797, "link": "https://stackoverflow.com/questions/49137797/finding-unicode-script-of-a-char-in-haskell", "title": "Finding Unicode script of a Char in Haskell", "body": "<p>I wanted to write a function checking that a <code>Char</code> represents a Cyrillic letter, purely for pedagogical reasons. The simple approximation for Russian is</p>\n\n<pre><code>isCyrillic c = \n    let lc = toLower c \n    in '\u0430' &lt;= lc &amp;&amp; lc &lt;= '\u044f'\n</code></pre>\n\n<p>but I don't like it because it doesn't handle other Cyrillic-using languages. I could hardcode the ranges:</p>\n\n<pre><code>U+0400\u2013U+04FF Cyrillic\nU+0500\u2013U+052F Cyrillic Supplement\nU+2DE0\u2013U+2DFF Cyrillic Extended-A\nU+A640\u2013U+A69F Cyrillic Extended-B\nU+1C80\u2013U+1C8F Cyrillic Extended-C\n</code></pre>\n\n<p>but this doesn't seem good practice either. </p>\n\n<p>Ideally the function would be just</p>\n\n<pre><code>isCyrillic c = unicodeScript c == Cyrillic\n</code></pre>\n\n<p>but this assumes the existence of a type enumerating Unicode scripts (Unicode ranges would do as well). Is there one somewhere?</p>\n"}, {"tags": ["haskell", "io", "arguments"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1520358103, "post_id": 49136863, "comment_id": 85278751, "body": "The code you have shown shouldn&#39;t ever terminate - it is an infinite loop.  How about you show your actual code and how you tried to run it."}, {"owner": {"reputation": 153, "user_id": 5285349, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c6e48d86c74fd1fca638a7ca513297de?s=128&d=identicon&r=PG&f=1", "display_name": "JamalCrawford..", "link": "https://stackoverflow.com/users/5285349/jamalcrawford"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1520358140, "post_id": 49136863, "comment_id": 85278779, "body": "This is my code"}, {"owner": {"reputation": 153, "user_id": 5285349, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c6e48d86c74fd1fca638a7ca513297de?s=128&d=identicon&r=PG&f=1", "display_name": "JamalCrawford..", "link": "https://stackoverflow.com/users/5285349/jamalcrawford"}, "edited": false, "score": 0, "creation_date": 1520358260, "post_id": 49136863, "comment_id": 85278856, "body": "ahhh sorry about that. I see what you are saying"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 2, "creation_date": 1520358371, "post_id": 49136863, "comment_id": 85278928, "body": "That makes much more sense. You&#39;ve bound <code>hello</code> to the result of <code>getMyArgs</code> so now you just need to write <code>hello</code> or <code>print hello</code> in order to see its value."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1520358486, "post_id": 49136863, "comment_id": 85278995, "body": "@ThomasM.DuBuisson: note that <code>getMyArgs</code> calls <code>getArgs</code>, not <code>getMyArgs</code>, so there is no recursion."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1520358519, "post_id": 49136863, "comment_id": 85279015, "body": "@WillemVanOnsem Well now that its been edited that is the case, yes."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 5285349, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c6e48d86c74fd1fca638a7ca513297de?s=128&d=identicon&r=PG&f=1", "display_name": "JamalCrawford..", "link": "https://stackoverflow.com/users/5285349/jamalcrawford"}, "edited": false, "score": 0, "creation_date": 1520358899, "post_id": 49137084, "comment_id": 85279248, "body": "For some reason I thought &quot;hello &lt;- getMyArgs&quot; was providing hello as the argument."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 153, "user_id": 5285349, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c6e48d86c74fd1fca638a7ca513297de?s=128&d=identicon&r=PG&f=1", "display_name": "JamalCrawford..", "link": "https://stackoverflow.com/users/5285349/jamalcrawford"}, "edited": false, "score": 0, "creation_date": 1520358948, "post_id": 49137084, "comment_id": 85279271, "body": "No, <code>hello</code> is a variable name that contains the arguments as a list of String values."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 2, "last_activity_date": 1520358918, "last_edit_date": 1520358918, "creation_date": 1520358746, "answer_id": 49137084, "question_id": 49136863, "link": "https://stackoverflow.com/questions/49136863/input-arguments-using-getargs-returns-nothing/49137084#49137084", "title": "Input arguments using getArgs returns nothing", "body": "<pre><code>getMyArgs :: IO [String]\ngetMyArgs =do\n         x &lt;- getArgs\n         return x\n</code></pre>\n\n<p>The do notation desugars to:</p>\n\n<pre><code>getMyArgs :: IO [String]\ngetMyArgs =  getArgs &gt;&gt;= \\x -&gt; return x\n</code></pre>\n\n<p>Using the right identity we can rewrite this to:</p>\n\n<pre><code>getMyArgs :: IO [String]\ngetMyArgs =  getArgs\n</code></pre>\n\n<p>So you've just defined a new name for <code>getArgs</code>.  Now why does getArgs not show your program arguments? Well it appears you didn't provide any program arguments.  In the interpreter it can be tricky to provide arguments - one way is to <code>:set</code> them:</p>\n\n<pre><code>Prelude&gt; :set args hello world\nPrelude&gt; import System.Environment\nPrelude System.Environment&gt; getArgs\n[\"hello\",\"world\"]\n</code></pre>\n\n<p>EDIT: Oh you might be looking to print the value you bound.  Consider:</p>\n\n<pre><code>Prelude System.Environment&gt; hello &lt;- getArgs\nPrelude System.Environment&gt; print hello\n[\"hello\",\"world\"]\n</code></pre>\n\n<p>Thanks to @4castle for this observation.</p>\n"}, {"tags": [], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "is_accepted": false, "score": 1, "last_activity_date": 1520361333, "creation_date": 1520361333, "answer_id": 49137773, "question_id": 49136863, "link": "https://stackoverflow.com/questions/49136863/input-arguments-using-getargs-returns-nothing/49137773#49137773", "title": "Input arguments using getArgs returns nothing", "body": "<p>Assume your Haskell program is compiled to an executable <code>foo</code>. When you call your program, you want to pass some runtime arguments to your program eg <code>foo param1 param2</code> . Depending on the values of <em>param1</em> and <em>param2</em> you will take different actions in your program.</p>\n\n<p>Now with the <em>getArgs</em> function you get access to these parameters in your Haskell program.</p>\n\n<p>In GHCi this argument passing can be simulated. Either with the <code>:set args paarm1 param2</code> command as shown in the answer of Thomas M. DuBuisson<br>\nor you call your main program in GHCI with <code>:main param1 param2</code> .</p>\n\n<p>In both scenarios <em>getEnv</em> will return <code>IO [\"param1\", \"param2\"]</code> </p>\n"}], "owner": {"reputation": 153, "user_id": 5285349, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c6e48d86c74fd1fca638a7ca513297de?s=128&d=identicon&r=PG&f=1", "display_name": "JamalCrawford..", "link": "https://stackoverflow.com/users/5285349/jamalcrawford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 49137084, "answer_count": 2, "score": 1, "last_activity_date": 1520361333, "creation_date": 1520357846, "last_edit_date": 1520358243, "question_id": 49136863, "link": "https://stackoverflow.com/questions/49136863/input-arguments-using-getargs-returns-nothing", "title": "Input arguments using getArgs returns nothing", "body": "<p>I am trying to understand getArgs but I am getting a weird behavior that I am not understanding.  Here is my program:</p>\n\n<pre><code>getMyArgs :: IO [String]\ngetMyArgs =do\n         x &lt;- getArgs\n         return x\n</code></pre>\n\n<p>I run this and get:</p>\n\n<pre><code>*Main&gt; hello &lt;- getMyArgs\n*Main&gt; \n</code></pre>\n\n<p>Why doesn't it return my argument passed?  I tried to put in a \" show() \" but that turns it into a String instead of a [String]</p>\n"}, {"tags": ["haskell", "ghc", "recursion-schemes"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520352902, "post_id": 49135351, "comment_id": 85275426, "body": "Deforestation ~ fusion. See <a href=\"https://stackoverflow.com/questions/38905369/what-is-fusion-in-haskell/38910170#38910170\" title=\"what is fusion in haskell\">stackoverflow.com/questions/38905369/what-is-fusion-in-haske&zwnj;&#8203;ll/&hellip;</a>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520353005, "post_id": 49135351, "comment_id": 85275491, "body": "TL;DR this doesn&#39;t really happen all that automatically: sometimes GHC&#39;s inlining is enough, but usually you&#39;ll need some rewrite rules."}, {"owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520353213, "post_id": 49135351, "comment_id": 85275636, "body": "@Alec: So every user of the hylo function must write these rewrite rules himself? How are these rewrite rules for my case?"}], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 14, "last_activity_date": 1520354920, "creation_date": 1520354920, "answer_id": 49136026, "question_id": 49135351, "link": "https://stackoverflow.com/questions/49135351/deforestation-in-a-hylomorphism/49136026#49136026", "title": "Deforestation in a Hylomorphism", "body": "<p>The data structure is actually fused away, but the resulting program is not tail recursive. The optimized code basically looks like this (with no <code>Cons</code> or <code>Nil</code> in sight):</p>\n\n<pre><code>h n | n &gt; end = 0\n    | otherwise = n + h (n+1)\n</code></pre>\n\n<p>To evaluate the result you must first evaluate <code>h (n+1)</code> recursively, and then add the result to <code>n</code>. During the recursive call, the value <code>n</code> must remain stored somewhere, hence we observe increased memory usage as <code>end</code> increases.</p>\n\n<p>A tighter loop can be obtained by having the recursive call be in tail position, and carry a constant size accumulator. We want the code to optimize to this instead:</p>\n\n<pre><code>-- with BangPatterns\nh n !acc | n &gt; end = acc\n         | otherwise = h (n+1) (n + acc)\n</code></pre>\n\n<p>In <code>hylosum</code>, the call to <code>(+)</code> happens in <code>alg</code>, and we replace that with a call to a continuation that will be built up by <code>hylo</code>.</p>\n\n<pre><code>alg :: ListF Int (Int -&gt; Int) -&gt; Int -&gt; Int\nalg Nil acc = acc\nalg (Cons n go) !acc = go (n + acc)\n</code></pre>\n\n<p>With that I see a constant 51kB allocated in the heap.</p>\n"}], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "accepted_answer_id": 49136026, "answer_count": 1, "score": 7, "last_activity_date": 1520354920, "creation_date": 1520352741, "question_id": 49135351, "link": "https://stackoverflow.com/questions/49135351/deforestation-in-a-hylomorphism", "title": "Deforestation in a Hylomorphism", "body": "<p>Wikipedia writes about <a href=\"https://en.wikipedia.org/wiki/Hylomorphism_(computer_science)\" rel=\"noreferrer\">Hylomorphism</a>:</p>\n\n<blockquote>\n  <p>In [...] functional programming a hylomorphism is a recursive\n  function,  corresponding to the composition of an anamorphism (which\n  first builds a set of results;  also known as 'unfolding')  followed\n  by a catamorphism (which then folds these results into a final return\n  value).  Fusion of these two recursive computations into a single\n  recursive pattern then <strong>avoids  building the intermediate data\n  structure</strong>. This is an example of deforestation,  a program\n  optimization strategy.</p>\n</blockquote>\n\n<p>(Bold markup by me)</p>\n\n<p>Using the <a href=\"http://hackage.haskell.org/package/recursion-schemes\" rel=\"noreferrer\">recursion-schemes</a> library\nI wrote a very simple hylomorphism:</p>\n\n<pre><code>import Data.Functor.Foldable\nmain :: IO ()\nmain = putStrLn $ show $ hylosum 1000\n\nhylosum :: Int -&gt; Int\nhylosum end = hylo alg coalg 1\n  where \n    -- Create list of Int's from 1 to n\n    coalg :: Int -&gt; ListF Int Int\n    coalg n \n       | n &gt; end = Nil\n       | otherwise = Cons n (n + 1)\n    -- Sum up a list of Int's\n    alg :: ListF Int Int -&gt; Int\n    alg Nil  =  0\n    alg (Cons a x) = a + x\n</code></pre>\n\n<p>In the cabal file I instructed GHC to optimize the code:</p>\n\n<pre><code>name:                Hylo\nversion:             0.1.0.0\nsynopsis:            Hylomorphisms and Deforestation        \nbuild-type:          Simple\ncabal-version:       &gt;=1.10\n\nexecutable             Hylo\n  main-is:             Main.hs\n  ghc-options:         -O2\n  build-depends:       base &gt;=4.10 &amp;&amp; &lt;4.11 , recursion-schemes      \n  default-language:    Haskell2010\n</code></pre>\n\n<p>Using stackage lts-10.0 (GHC 8.2.2) I compile with <code>stack build</code> and run with <code>stack exec Hylo -- +RTS -s</code> and I get:</p>\n\n<pre><code>500500\n      84,016 bytes allocated in the heap\n       3,408 bytes copied during GC\n      44,504 bytes maximum residency (1 sample(s))\n      25,128 bytes maximum slop\n           2 MB total memory in use (0 MB lost due to fragmentation)\n</code></pre>\n\n<p>Now I change <code>hylosum 1000</code> to <code>hylosum 1000000</code>  (1000 times more) and I get: </p>\n\n<pre><code>500000500000\n  16,664,864 bytes allocated in the heap\n      16,928 bytes copied during GC\n  15,756,232 bytes maximum residency (4 sample(s))\n      29,224 bytes maximum slop\n          18 MB total memory in use (0 MB lost due to fragmentation)\n</code></pre>\n\n<p>So heap usage goes up from 84 KB to 16,664 KB. This is 200 times more than before. \nTherefore I think, GHC does not do the deforestation / fusion mentioned in wikipedia! </p>\n\n<p>This is not really a surprise: The anamorphism creates the list items from left to right \n(from 1 to n) and the catamorphism consumes the items the opposite way from right to left\n(from n to 1) and it's difficult to see how the hylomorphism can work \nwithout creating the whole intermediate list.</p>\n\n<p>Questions: \nIs GHC able to perform the deforestation? \nIf <em>yes</em>, what do I have to change in my code or cabal file?\nIf <em>yes</em>, how does it really work? \nif <em>no</em>, where is the issue: in wikipedia, GHC or in the library?</p>\n"}, {"tags": ["haskell", "functional-programming", "ocaml", "compiler-construction", "hindley-milner"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1520353148, "post_id": 49134312, "comment_id": 85275599, "body": "This problem (family of problems?) in general is called <a href=\"https://en.wikipedia.org/wiki/Unification_(computer_science)\" rel=\"nofollow noreferrer\">unification</a>, and there are several known algorithms for solving it. This applies to both types and logical formulas because the two <a href=\"https://en.wikipedia.org/wiki/Curry%E2%80%93Howard_correspondence\" rel=\"nofollow noreferrer\">are quite similar</a>"}, {"owner": {"reputation": 835, "user_id": 5841943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A62rN.png?s=128&g=1", "display_name": "suhdonghwi", "link": "https://stackoverflow.com/users/5841943/suhdonghwi"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1520353898, "post_id": 49134312, "comment_id": 85276087, "body": "@Cubic I didn&#39;t know this problem is related to unification algorithm. Actually, I already implemented <code>unify</code> function, maybe without actually deeply understanding it."}], "answers": [{"comments": [{"owner": {"reputation": 835, "user_id": 5841943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A62rN.png?s=128&g=1", "display_name": "suhdonghwi", "link": "https://stackoverflow.com/users/5841943/suhdonghwi"}, "edited": false, "score": 0, "creation_date": 1520352477, "post_id": 49134462, "comment_id": 85275115, "body": "Thank you very much. However, how does type system add the recursive names to the environment, although it does&#39;t know the actual type of the function yet?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 5, "creation_date": 1520352717, "post_id": 49134462, "comment_id": 85275285, "body": "Typically, it assigns them a fresh type variable and lets the regular unification process take care of the rest.  This is the same way you&#39;d handle a single recursive function."}, {"owner": {"reputation": 835, "user_id": 5841943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A62rN.png?s=128&g=1", "display_name": "suhdonghwi", "link": "https://stackoverflow.com/users/5841943/suhdonghwi"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1520353493, "post_id": 49134462, "comment_id": 85275818, "body": "@K.A.Buhr Thank you. Do I have to assign fresh type variables to all the mutually recursive functions except the function which is directly inferred?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 6, "creation_date": 1520356653, "post_id": 49134462, "comment_id": 85277903, "body": "Ah, but start with the simpler problem of inferring the type of a single recursive function (think <code>factorial</code>).  How will you &quot;directly&quot; infer its type when it depends on a function (namely itself) whose type is unknown to the compiler at the time of definition?  Again, the answer is to assign it a fresh type variable while it&#39;s being defined.  So, for a block of mutually recursive functions (including the special case of a single recursive function), you actually want to assign fresh type variables to all of the functions and then start inferring their types."}, {"owner": {"reputation": 835, "user_id": 5841943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A62rN.png?s=128&g=1", "display_name": "suhdonghwi", "link": "https://stackoverflow.com/users/5841943/suhdonghwi"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1520359919, "post_id": 49134462, "comment_id": 85279826, "body": "@K.A.Buhr I really appreciate your kind help. Thank you very much. Perhaps the last question, what does the word &quot;generalize&quot; mean in the answer? I can find the meaning by searching the term(adding free type variables which do not appear in the current type environment to universal quantification), but I don&#39;t see what does this <i>actually</i> do(why it doesn&#39;t add type variables that appear in the current type environment?) and why this is needed here."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1520362531, "post_id": 49134462, "comment_id": 85281161, "body": "This answer may help: <a href=\"https://stackoverflow.com/a/904715/7203016\">stackoverflow.com/a/904715/7203016</a>.  Note that even though the comments say that answer is wrong, they mean that it&#39;s not the correct answer to the question being asked, but it does address your question (and explains @PatJ&#39;s note about getting the timing of generalisation right). However, this is getting too complicated for comments.  You might want to ask this as a separate question."}], "tags": [], "owner": {"reputation": 5432, "user_id": 3210257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e031a73b4d825b34b8fbcdae03b76f0b?s=128&d=identicon&r=PG", "display_name": "PatJ", "link": "https://stackoverflow.com/users/3210257/patj"}, "is_accepted": true, "score": 3, "last_activity_date": 1520353465, "last_edit_date": 1520353465, "creation_date": 1520350189, "answer_id": 49134462, "question_id": 49134312, "link": "https://stackoverflow.com/questions/49134312/hindley-milner-type-inference-for-mutually-recursive-functions/49134462#49134462", "title": "Hindley Milner type inference for mutually recursive functions", "body": "<p>In OCaml, mutually recursive values are separated by the keyword <code>and</code> instead of another <code>let rec</code>. When the typing system arrives at a recursive definitions, it adds all the recursive names to the environment and then continues pretty much as usual.</p>\n\n<p>UPDATE (thanks to K.A. Buhr):</p>\n\n<p>It is totally possible to create a new variable with type <code>'a</code> (with <code>'a</code> being fresh) and then later unify it. Be sure to generalize your variable at the right place (usually, after the definition).</p>\n"}], "owner": {"reputation": 835, "user_id": 5841943, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/A62rN.png?s=128&g=1", "display_name": "suhdonghwi", "link": "https://stackoverflow.com/users/5841943/suhdonghwi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 778, "favorite_count": 1, "accepted_answer_id": 49134462, "answer_count": 1, "score": 5, "last_activity_date": 1520353465, "creation_date": 1520349811, "question_id": 49134312, "link": "https://stackoverflow.com/questions/49134312/hindley-milner-type-inference-for-mutually-recursive-functions", "title": "Hindley Milner type inference for mutually recursive functions", "body": "<p>I'm making a strongly typed toy functional programming language. It uses the Hindley Milner algorithm as type inference algorithm.</p>\n\n<p>Implementing the algorithm, I have a question on how to infer types of the mutually recursive functions.</p>\n\n<pre><code>let rec f n = if n == 0 then 0 else g (n - 1)\nlet rec g n = if n == 0 then 0 else f (n - 1)\n</code></pre>\n\n<p><code>f</code> and <code>g</code> are mutually recursive functions. Now, when the type checker is inferring the type of function <code>f</code>, it should also be able to infer the type of function <code>g</code>, since it is a subexpression.</p>\n\n<p>But, in that moment, function <code>g</code> is not defined yet. Therefore, the type checker doesn't even know the existence of function <code>g</code>, as well as the type of function <code>g</code>, obviously.</p>\n\n<p>What are some solutions that real world compilers/intepreters use?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1520343726, "post_id": 49132203, "comment_id": 85269143, "body": "What if the input was <code>[&quot;2435&quot;, &quot;136&quot;]</code>. Is the output then <code>[&quot;25&quot;, &quot;16&quot;]</code>?"}, {"owner": {"reputation": 516, "user_id": 4175580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2366046a47437b36ba4d4ad3b85f19ca?s=128&d=identicon&r=PG&f=1", "display_name": "nocturne", "link": "https://stackoverflow.com/users/4175580/nocturne"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1520343861, "post_id": 49132203, "comment_id": 85269230, "body": "I said that the elements will not occur multiple times so the the input will never be <code>[&quot;2435&quot;, &quot;136&quot;]</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1520343950, "post_id": 49132203, "comment_id": 85269284, "body": "that is not really the question. It is more do you want to remove the string (as a substring) or the individual characters?"}, {"owner": {"reputation": 516, "user_id": 4175580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2366046a47437b36ba4d4ad3b85f19ca?s=128&d=identicon&r=PG&f=1", "display_name": "nocturne", "link": "https://stackoverflow.com/users/4175580/nocturne"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1520344014, "post_id": 49132203, "comment_id": 85269327, "body": "individual characters, becuse <code>&#39;3&#39;</code> can occur in first list and <code>&#39;4&#39;</code> can occur in other one"}], "answers": [{"comments": [{"owner": {"reputation": 516, "user_id": 4175580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2366046a47437b36ba4d4ad3b85f19ca?s=128&d=identicon&r=PG&f=1", "display_name": "nocturne", "link": "https://stackoverflow.com/users/4175580/nocturne"}, "edited": false, "score": 0, "creation_date": 1520344429, "post_id": 49132427, "comment_id": 85269594, "body": "but what arguments should I pass to this function? I do not see the second argument which should be the list of lists ?"}, {"owner": {"reputation": 1219, "user_id": 6382398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567598034dbeeb9a87b6685040caa4c0?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan Strate", "link": "https://stackoverflow.com/users/6382398/stephan-strate"}, "reply_to_user": {"reputation": 516, "user_id": 4175580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2366046a47437b36ba4d4ad3b85f19ca?s=128&d=identicon&r=PG&f=1", "display_name": "nocturne", "link": "https://stackoverflow.com/users/4175580/nocturne"}, "edited": false, "score": 1, "creation_date": 1520344533, "post_id": 49132427, "comment_id": 85269671, "body": "In Haskell you can omit arguments as they are passed at the end of the function. I will add it to my answer to avoid confusion"}, {"owner": {"reputation": 516, "user_id": 4175580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2366046a47437b36ba4d4ad3b85f19ca?s=128&d=identicon&r=PG&f=1", "display_name": "nocturne", "link": "https://stackoverflow.com/users/4175580/nocturne"}, "edited": false, "score": 0, "creation_date": 1520344682, "post_id": 49132427, "comment_id": 85269768, "body": "This actually works, thanks I just need a while to process it."}, {"owner": {"reputation": 1219, "user_id": 6382398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567598034dbeeb9a87b6685040caa4c0?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan Strate", "link": "https://stackoverflow.com/users/6382398/stephan-strate"}, "reply_to_user": {"reputation": 516, "user_id": 4175580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2366046a47437b36ba4d4ad3b85f19ca?s=128&d=identicon&r=PG&f=1", "display_name": "nocturne", "link": "https://stackoverflow.com/users/4175580/nocturne"}, "edited": false, "score": 1, "creation_date": 1520344769, "post_id": 49132427, "comment_id": 85269823, "body": "I have added a short and a long version for you, to see the difference"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1520344925, "post_id": 49132427, "comment_id": 85269913, "body": "Your <code>handle</code> is very inefficient (O(m*n^2), m the length of <code>items</code>, n the length of <code>y</code>) compared to the naive idiomatic solution <code>handle = filter (`notElem` items)</code> (O(m*n)) or the efficient solution <code>handle = filter (`S.notMember` S.fromList items)</code> (O((m+n)*log m))."}, {"owner": {"reputation": 1219, "user_id": 6382398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567598034dbeeb9a87b6685040caa4c0?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan Strate", "link": "https://stackoverflow.com/users/6382398/stephan-strate"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1520345112, "post_id": 49132427, "comment_id": 85270051, "body": "@DanielWagner Thanks, you are totally right. I just thought it is easier to understand. Nevertheless I added it to my answer"}], "tags": [], "owner": {"reputation": 1219, "user_id": 6382398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567598034dbeeb9a87b6685040caa4c0?s=128&d=identicon&r=PG&f=1", "display_name": "Stephan Strate", "link": "https://stackoverflow.com/users/6382398/stephan-strate"}, "is_accepted": true, "score": 1, "last_activity_date": 1520345050, "last_edit_date": 1520345050, "creation_date": 1520344259, "answer_id": 49132427, "question_id": 49132203, "link": "https://stackoverflow.com/questions/49132203/remove-elements-from-list-of-lists-haskell/49132427#49132427", "title": "Remove elements from list of lists - haskell", "body": "<p>You can use this:</p>\n\n<pre><code>import Data.List\n\nremoveFromList items list = map handle list where\n    handle y = filter (`notElem` items) y\n</code></pre>\n\n<p>Short version:</p>\n\n<pre><code>removeFromList items = map handle where\n    handle = filter (`notElem` items)\n</code></pre>\n\n<p>Example call: <code>removeFromList \"34\" [\"2345\",\"16\"]</code></p>\n\n<p>What you actaully do is, you map over the whole list, so you have got each list separatly.\nAs next step, you fold this specific list and check every item if it should be removed.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 2, "last_activity_date": 1520346618, "last_edit_date": 1520346618, "creation_date": 1520346145, "answer_id": 49133055, "question_id": 49132203, "link": "https://stackoverflow.com/questions/49132203/remove-elements-from-list-of-lists-haskell/49133055#49133055", "title": "Remove elements from list of lists - haskell", "body": "<p>The top-down way you organised your code is actually quite good; you can use it to guide your implementation. Let's begin with:</p>\n\n<pre><code>removeFromListOfLists :: Eq a =&gt; [a] -&gt; [[a]] -&gt; [[a]]\nremoveFromListOfLists toRemove lol = map (\\list -&gt; removeFromList toRemove list) lol\n</code></pre>\n\n<p>(I have flipped the order of the arguments with respect to your definition, as it usually more idiomatic to have the list you are processing as the last argument, for the sake of easier composition and partial application. Also note I'm mapping over the list of lists, which is arguably the more natural way of expressing this task.)</p>\n\n<p>Now we drill down to <code>removeFromList</code>:</p>\n\n<pre><code>removeFromList :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>As you probably suspect, it can be expressed with <code>filter</code>:</p>\n\n<pre><code>removeFromList toRemove list = filter (\\element -&gt; shouldBeKept element) list\n</code></pre>\n\n<p>We still need to define the <code>shouldBeKept</code> test. It is slightly more convenient to do so through a local definition using <code>where</code>, rather than through a top-level definition:</p>\n\n<pre><code>removeFromList :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]\nremoveFromList toRemove list = filter (\\element -&gt; shouldBeKept element) list\n    where\n    shouldBeKept element = element `notElem` toRemove\n</code></pre>\n\n<p>(This uses the <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:notElem\" rel=\"nofollow noreferrer\"><code>notElem</code></a> function. Alternatively, though with unneeded verbosity, you might define a <code>shouldBeRemoved</code> test with <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:elem\" rel=\"nofollow noreferrer\"><code>elem</code></a> and then use <code>not (shouldBeRemoved element)</code> when calling <code>filter</code>.)</p>\n\n<p>For the sake of completeness, here is how I'd usually phrase these functions, in a more pointfree manner (judiciously \"omit[ting] arguments\", as <a href=\"https://stackoverflow.com/questions/49132203/remove-elements-from-list-of-lists-haskell/49133055#comment85269671_49132427\">Stephan Strate put it in a comment</a>):</p>\n\n<pre><code>removeFromListOfLists :: Eq a =&gt; [a] -&gt; [[a]] -&gt; [[a]]\nremoveFromListOfLists toRemove = map (removeFromList toRemove)\n\nremoveFromList :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]\nremoveFromList toRemove = filter shouldBeKept\n    where\n    shouldBeKept element = element `notElem` toRemove\n</code></pre>\n"}], "owner": {"reputation": 516, "user_id": 4175580, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2366046a47437b36ba4d4ad3b85f19ca?s=128&d=identicon&r=PG&f=1", "display_name": "nocturne", "link": "https://stackoverflow.com/users/4175580/nocturne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1609, "favorite_count": 0, "accepted_answer_id": 49132427, "answer_count": 2, "score": 0, "last_activity_date": 1520346618, "creation_date": 1520343531, "question_id": 49132203, "link": "https://stackoverflow.com/questions/49132203/remove-elements-from-list-of-lists-haskell", "title": "Remove elements from list of lists - haskell", "body": "<p>I need to remove elements stored in <code>[Char]</code> from list of lists <code>[[Char]]</code>. Lets have these elements - <code>\"34\"</code> and list of list like this - <code>[\"2345\",\"16\"]</code>. What I need to do is delete each one element from this list of lists. The elements will not occur multiple times in either of these. So I need result like this - <code>[\"25\",\"16\"]</code>. So far I have come up with this solution which is not working properly: </p>\n\n<pre><code>removeFromListOfLists list toRemove = map (\\element -&gt; removeFromList list element) toRemove\n\nremoveFromList list element = map (\\listPart -&gt; remove listPart element) list\n\nremove listPart element = filter (\\e -&gt; e/=element) listPart\n</code></pre>\n\n<p>But what I get from this is: <code>[[\"245\",\"16\"],[\"235\",\"16\"]]</code></p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 4, "last_activity_date": 1520342505, "last_edit_date": 1520342505, "creation_date": 1520341222, "answer_id": 49131493, "question_id": 49131256, "link": "https://stackoverflow.com/questions/49131256/haskell-if-the-input-fails-validation-i-want-it-to-ask-for-the-same-input-aga/49131493#49131493", "title": "Haskell : If the input fails validation, i want it to ask for the same input again", "body": "<p>Instead of <code>getLine</code> to get the name, you can use a helper function which repeats until a valid name is entered.</p>\n\n<pre><code>getName = do\n  putStrLn \"Enter the name\"\n  name &lt;- getLine\n  if null name  -- Replace with your own validation.\n    then do\n      putStrLn \"Invalid name\"\n      getName\n    else pure name\n</code></pre>\n\n<p>This can also be defined locally in a <code>let</code> binding or <code>where</code> clause. And if you\u2019re going to be performing validation on all these fields, it would pay to abstract the helper to take the prompt and validation function as arguments:</p>\n\n<pre><code>getParameter label valid = loop\n  where\n    loop = do\n      putStrLn $ \"Enter the \" ++ label\n      value &lt;- getLine\n      if valid value\n        then pure value\n        else do\n          putStrLn $ \"Invalid value for \" ++ label\n          loop\n</code></pre>\n\n<p>You can also use <code>do</code> notation to make the definition of <code>registerUser1</code> less noisy and nested\u2014it desugars to the same code you\u2019ve written above.</p>\n\n<pre><code>registerUser1 userDb = do\n  putStrLn \"Enter the email\"\n  email &lt;- getLine\n  putStrLn \"Enter the name\"\n  name &lt;- getName\n  putStrLn \"Enter the password\"\n  password &lt;- getLine\n  putStrLn \"Enter the postal code\"\n  postalcode &lt;- getLine\n  let\n    newuser = MkNewUser\n      { nuserEmail = MkEmail email\n      , nuserFullName = name\n      , nuserPassword = password\n      , nuserPostalCode = postalcode\n      }\n    output = registerUser newuser userDb\n  case output of\n    Left err -&gt; do\n      putStrLn err\n      registerUser1 userDb\n    Right udb -&gt; pure udb\n</code></pre>\n\n<p>With the above helper function:</p>\n\n<pre><code>registerUser1 userDb = do\n  email &lt;- getParameter \"email\" validEmail\n  name &lt;- getParameter \"name\" validName\n  password &lt;- getParameter \"password\" validPassword\n  postalcode &lt;- getParameter \"postal code\" validPostalCode\n  \u2026\n</code></pre>\n"}], "owner": {"reputation": 289, "user_id": 9189009, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e8867132937b784622d8bdc154e230b2?s=128&d=identicon&r=PG&f=1", "display_name": "Alexia Desouza", "link": "https://stackoverflow.com/users/9189009/alexia-desouza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "accepted_answer_id": 49131493, "answer_count": 1, "score": 1, "last_activity_date": 1520351836, "creation_date": 1520340500, "last_edit_date": 1520351836, "question_id": 49131256, "link": "https://stackoverflow.com/questions/49131256/haskell-if-the-input-fails-validation-i-want-it-to-ask-for-the-same-input-aga", "title": "Haskell : If the input fails validation, i want it to ask for the same input again", "body": "<pre><code>registerUser1  userDb =\n  putStrLn \"Enter the email \" &gt;&gt;  getLine &gt;&gt;= \\email -&gt; \n    putStrLn \"Enter the name \" &gt;&gt; getLine &gt;&gt;= \\name -&gt;\n      putStrLn \"Enter the password \" &gt;&gt; getLine &gt;&gt;= \\password -&gt;\n        putStrLn \"Enter the postal code \" &gt;&gt; getLine &gt;&gt;= \\postalcode -&gt; \n          let newuser = MkNewUser{nuserEmail = MkEmail email, nuserFullName = name, nuserPassword = password, nuserPostalCode = postalcode}\n              output =   (registerUser newuser userDb)\n          in case output of\n                Left err -&gt; putStrLn err &gt;&gt; registerUser1 userDb\n                Right udb -&gt; pure udb\n</code></pre>\n\n<p>If i enter a name and if it fails a validate function, i want the user to reenter the name until it passes the validate function. How can i do it?</p>\n"}, {"tags": ["haskell", "nixos", "liquid-haskell"], "comments": [{"owner": {"reputation": 4232, "user_id": 428586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHNYS.jpg?s=128&g=1", "display_name": "Robert Hensing", "link": "https://stackoverflow.com/users/428586/robert-hensing"}, "edited": false, "score": 0, "creation_date": 1520347921, "post_id": 49130389, "comment_id": 85271924, "body": "The last error is actually from bash trying to run your haskell sources as though it were a shell script. Quoting the command should fix that: <code>--run &quot;liquid ~&#47;bin&#47;h&#47;nix.hs&quot;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "edited": false, "score": 0, "creation_date": 1520419799, "post_id": 49134173, "comment_id": 85304326, "body": "Thank you very much.  That seems to work.  As a side note, the use with a cabal2nix package isn&#39;t working for me, because NIX_GHC_LIBDIR isn&#39;t being set - something seems to have changed there."}, {"owner": {"reputation": 4232, "user_id": 428586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHNYS.jpg?s=128&g=1", "display_name": "Robert Hensing", "link": "https://stackoverflow.com/users/428586/robert-hensing"}, "reply_to_user": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "edited": false, "score": 0, "creation_date": 1520432274, "post_id": 49134173, "comment_id": 85312583, "body": "You&#39;re welcome. I didn&#39;t expect that, but it should work on the current unstable channel though: <code>cd someproject; nix-shell -I nixpkgs=https:&#47;&#47;github.com&#47;NixOS&#47;nixpkgs-channels&#47;archive&#47;cc&zwnj;&#8203;4677c36ee8d880e88145&zwnj;&#8203;9ad114fd2224b3ac1c.t&zwnj;&#8203;ar.gz --run &#39;echo NIX_GHC_LIBDIR is $NIX_GHC_LIBDIR&#39;</code>"}, {"owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "edited": false, "score": 0, "creation_date": 1520464528, "post_id": 49134173, "comment_id": 85331340, "body": "cheers.  Actually, it wasn&#39;t the channel that was at fault; I had a rogue shell.nix; I was trynig to fix my default.nix, but blanking that i had a shell.nix that was breaking me."}], "tags": [], "owner": {"reputation": 4232, "user_id": 428586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yHNYS.jpg?s=128&g=1", "display_name": "Robert Hensing", "link": "https://stackoverflow.com/users/428586/robert-hensing"}, "is_accepted": true, "score": 0, "last_activity_date": 1520349876, "last_edit_date": 1520349876, "creation_date": 1520349417, "answer_id": 49134173, "question_id": 49130389, "link": "https://stackoverflow.com/questions/49130389/has-anyone-been-able-to-integrate-liquidhaskell-with-nixos/49134173#49134173", "title": "Has anyone been able to integrate liquidhaskell with nixos?", "body": "<p>The problem seems to be that liquid haskell ignores the ghcWithPackages wrappers, because it uses the GHC API directly. You can work around this as follows, based on <a href=\"https://github.com/ucsd-progsys/liquidhaskell/issues/1099#issuecomment-332012128\" rel=\"nofollow noreferrer\">this thread</a>.</p>\n\n<pre><code>nix-shell -p 'haskellPackages.ghcWithPackages(pkgs:[pkgs.text (pkgs.liquidhaskell)])' -p z3 --run 'liquid --ghc-option=\"-package-db=$(ghc-pkg list | head -n 1)\" ./hellotext.hs'\n</code></pre>\n\n<p>Or somewhat equivalently,</p>\n\n<pre><code>nix-shell -p 'haskellPackages.ghcWithPackages(pkgs:[pkgs.text])' -p z3 -p haskellPackages.liquidhaskell --run 'NIX_GHC_LIBDIR=$(ghc-pkg list | head -n 1)/.. liquid ./hellotext.hs'\n</code></pre>\n\n<p>which suggests that it will work out of the box when you're in a <code>nix-shell</code> based on a <code>cabal2nix</code> package.</p>\n"}], "owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 49134173, "answer_count": 1, "score": 6, "last_activity_date": 1520349876, "creation_date": 1520337821, "last_edit_date": 1520340150, "question_id": 49130389, "link": "https://stackoverflow.com/questions/49130389/has-anyone-been-able-to-integrate-liquidhaskell-with-nixos", "title": "Has anyone been able to integrate liquidhaskell with nixos?", "body": "<p>I'm trying to use liquidhaskell on NixOS.  I can install the package (liquidhaskell-0.8.2.3), though not the cabal integration, because it requires cabal 1.18-1.25, but I have cabal 2.0.1.0 .</p>\n\n<p>I have installed the liquidhaskell package as part of a ghc-with-packages setup:</p>\n\n<pre><code>[~:0]$ readlink $( type -p liquid )\n/nix/store/pdbzl0p6k1klmajx969b6vvwyw9w0s6b-ghc-8.2.2-with-packages/bin/liquid\n</code></pre>\n\n<p>Among many others, the package text also installed in this set:</p>\n\n<pre><code>[proclib:1]$ ls -ld /nix/store/pdbzl0p6k1klmajx969b6vvwyw9w0s6b-ghc-8.2.2-with-packages/lib/ghc-8.2.2/text-1.2.2.2/\ndr-xr-xr-x 3 root root 68 Jan  1  1970 /nix/store/pdbzl0p6k1klmajx969b6vvwyw9w0s6b-ghc-8.2.2-with-packages/lib/ghc-8.2.2/text-1.2.2.2/\n</code></pre>\n\n<p>However, liquid cannot see this:</p>\n\n<pre><code>[proclib:1]$ liquid ~/bin/h/nix.hs \nLiquidHaskell Version 0.8.2.3\nCopyright 2013-18 Regents of the University of California. All Rights Reserved.\n\nliquid: Main: Could not find module \u2018Data.Text\u2019\nPerhaps you meant Data.Set (from containers-0.5.10.2)\nUse -v to see a list of the files searched for.\n</code></pre>\n\n<p>The above is not part of a cabal package (to try to eliminate the cabal thing from the equation).</p>\n\n<p>I've tried playing with nix-shell to make this work, but either nix-shell or liquid break down on language pragmas:</p>\n\n<pre><code>[~:0]$ nix-shell -p myHaskellEnv --run liquid ~/bin/h/nix.hs \n/nix/store/q1cwqhb6v8yx8vy4s5p6sxrq8s0bnqmy-nix.hs: line 5: {-#: command not found\n</code></pre>\n\n<p>Any help gratefully received.</p>\n"}, {"tags": ["haskell", "cryptography", "elliptic-curve"], "answers": [{"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 2, "last_activity_date": 1520335768, "creation_date": 1520335768, "answer_id": 49129792, "question_id": 49129097, "link": "https://stackoverflow.com/questions/49129097/publickeysizeinvalid-error-in-decodepoint-function-output/49129792#49129792", "title": "PublicKeySizeInvalid error in decodePoint function output", "body": "<p>For the X448 curve, as the name suggests, the key size should be 448 bits, or 56 bytes:</p>\n\n<pre><code>-- import ...\n\ncurve = Proxy :: Proxy Curve_X448\n\nseed = Data.ByteString.Char8.replicate 56 'a'\nd = decodePoint curve seed\nd\n</code></pre>\n\n<p>Prints out:</p>\n\n<pre><code>CryptoPassed (PublicKey \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\")\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 4445913, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/943fb55bd9a761c56c17d124d1cc3c61?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uligade", "link": "https://stackoverflow.com/users/4445913/mahesh-uligade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 49129792, "answer_count": 1, "score": 1, "last_activity_date": 1520336198, "creation_date": 1520333667, "last_edit_date": 1520336198, "question_id": 49129097, "link": "https://stackoverflow.com/questions/49129097/publickeysizeinvalid-error-in-decodepoint-function-output", "title": "PublicKeySizeInvalid error in decodePoint function output", "body": "<p>I am trying this function in GHCI,</p>\n\n<pre><code>import Data.ByteString.Char8\nimport Crypto.PubKey.ECIES \nimport Crypto.ECC\nimport Data.Proxy\n\ncurve = Proxy :: Proxy Curve_X448\n\nstr = \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"\nseed = Data.ByteString.Char8.pack str\nd =  decodePoint curve seed\nd\n</code></pre>\n\n<p>but it gives an error  <code>CryptoFailed CryptoError_PublicKeySizeInvalid</code>, what should be the size of <code>str</code>?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 3, "last_activity_date": 1520323164, "creation_date": 1520323164, "answer_id": 49125943, "question_id": 49124843, "link": "https://stackoverflow.com/questions/49124843/text-regex-tdfa-newdfa-engine-hs1333-parse-error-on-input/49125943#49125943", "title": "Text/Regex/TDFA/NewDFA/Engine.hs:13:33: parse error on input \u2018#\u2019", "body": "<blockquote>\n<pre><code>Text/Regex/TDFA/NewDFA/Engine.hs:13:33: parse error on input \u2018#\u2019\n</code></pre>\n</blockquote>\n\n<p>On an initial note, this error points to <a href=\"https://github.com/ChrisKuklewicz/regex-tdfa/blob/f1b671946ee573f86d72484f3ab56487d456e735/Text/Regex/TDFA/NewDFA/Engine.hs\" rel=\"nofollow noreferrer\">a module of the <em>regex-tdfa</em> package</a>, so you should have gotten it when building the package, rather than when building your <code>test.hs</code>, unless you were trying to build <code>test.hs</code> after putting it within the package source tree. In any case, line 13 of the mentioned file is:</p>\n\n<pre><code>import GHC.Prim(MutableByteArray#,RealWorld,Int#,sizeofMutableByteArray#,unsafeCoerce#)\n</code></pre>\n\n<p>The <code>#</code> names require the <a href=\"https://downloads.haskell.org/~ghc/8.2.2-rc1/docs/html/users_guide/glasgow_exts.html#the-magic-hash\" rel=\"nofollow noreferrer\"><code>MagicHash</code> GHC extension</a> to be enabled. As there is no <code>{-# LANGUAGE MagicHash #-}</code> pragma at the beginning of the file, one should assume the extension is enabled through the <code>.cabal</code> file of the package, <a href=\"https://github.com/ChrisKuklewicz/regex-tdfa/blob/f1b671946ee573f86d72484f3ab56487d456e735/regex-tdfa.cabal#L63\" rel=\"nofollow noreferrer\">and that is indeed the case</a>. That being so, your problem seems to be that you are attempting use the package modules straight from the source tree, without using an appropriate build tool such as <a href=\"https://www.haskell.org/cabal/users-guide/intro.html\" rel=\"nofollow noreferrer\">Cabal</a>. (Note that if you did successfully run <code>cabal install regex-tdfa</code> there should be no need of dealing with the source tree: <code>ghc --make -o test test.hs</code> should be enough.)</p>\n\n<p>P.S.: There is an error in your <code>test.hs</code>. The last line should be...</p>\n\n<pre><code> if str =~ regex then putStrLn \"matched\" else putStrLn \"no matches\"\n</code></pre>\n\n<p>(I did manage to run it after this correction.)</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 9386849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997c4413a30c42e0de04a0a0058b3162?s=128&d=identicon&r=PG&f=1", "display_name": "imran7", "link": "https://stackoverflow.com/users/9386849/imran7"}, "edited": false, "score": 0, "creation_date": 1520371728, "post_id": 49139441, "comment_id": 85285767, "body": "<code>@skvadrik</code> Thank you so much, sir. it worked....I mean you know, what ?? I spent lot of times ..but the solution was just to move the <code>test.hs</code> file into other location also needs to have {-# LANGUAGE MagicHash #-} at the beginning of the program. That&#39;s it."}], "tags": [], "owner": {"reputation": 566, "user_id": 815525, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ac16f4513ae5d27116a7680285f1e97d?s=128&d=identicon&r=PG", "display_name": "skvadrik", "link": "https://stackoverflow.com/users/815525/skvadrik"}, "is_accepted": true, "score": 2, "last_activity_date": 1520368049, "creation_date": 1520368049, "answer_id": 49139441, "question_id": 49124843, "link": "https://stackoverflow.com/questions/49124843/text-regex-tdfa-newdfa-engine-hs1333-parse-error-on-input/49139441#49139441", "title": "Text/Regex/TDFA/NewDFA/Engine.hs:13:33: parse error on input \u2018#\u2019", "body": "<p>It looks like you are compiling your program from within Regex-TDFA source code. I am able to reproduce your problem if I do <code>cabal unpack regex-tdfa &amp;&amp; cd regex-tdfa-1.2.2 &amp;&amp; ghc --make test.hs</code>.</p>\n\n<p>The error happens because when GHC finds Regex-TDFA source files in the current directory, it just picks them and tries to compile, as if they were ordinary source files belonging to your project. However, Regex-TDFA cannot be built with simple <code>ghc --make</code>: in order to build it, you have to run cabal first. Cabal will read <code>regex-tdfa.cabal</code> file that contains the list of the necessary GHC extensions.</p>\n\n<p>In particular, parse error happens because GHC extension <code>MagicHash</code> is missing (that's where the hash <code>#</code> comes from).</p>\n\n<p>The \"fix\" is to move your <code>test.hs</code> to some other location: then GHC will use system package for Regex-TDFA.</p>\n"}], "owner": {"reputation": 33, "user_id": 9386849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997c4413a30c42e0de04a0a0058b3162?s=128&d=identicon&r=PG&f=1", "display_name": "imran7", "link": "https://stackoverflow.com/users/9386849/imran7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 49139441, "answer_count": 2, "score": 1, "last_activity_date": 1520368049, "creation_date": 1520318670, "last_edit_date": 1520323639, "question_id": 49124843, "link": "https://stackoverflow.com/questions/49124843/text-regex-tdfa-newdfa-engine-hs1333-parse-error-on-input", "title": "Text/Regex/TDFA/NewDFA/Engine.hs:13:33: parse error on input \u2018#\u2019", "body": "<p>I have been trying to run a simple Haskell program using <code>TDFA</code>. The program is as follows:    </p>\n\n<pre><code>import Control.Monad      \nimport Data.Array  \nimport qualified Data.Text as T  \nimport Text.Regex  \nimport Text.Regex.TDFA      \nimport Text.Regex.Base  \n\nstr = \"abbbbaab\" :: String     \nregex = \"(a+)(b+)\" :: String   \n\nmain = do  \n if str (=~) :: regex then putStrLn \"matched\" else putStrLn \"no matches\"\n</code></pre>\n\n<p>when I try to run the above program using the command like: <code>ghc test.hs -o test</code> and then I am getting the following error (<code>test.hs</code> is the Haskell program which contains the above code):  </p>\n\n<pre><code>Text/Regex/TDFA/NewDFA/Engine.hs:13:33: parse error on input \u2018#\u2019\n</code></pre>\n\n<p>Note that I have the latest version of <code>TDFA</code> installed on my <code>pc</code>. I did it by following ways:</p>\n\n<pre><code>ghc --make -o setup Setup.hs\n</code></pre>\n\n<p>Also, I did the following:</p>\n\n<pre><code>user@user-VirtualBox:~/regex-tdfa-master$ sudo cabal install regex-tdfa    \n[sudo] password for user:    \nResolving dependencies...    \nAll the requested packages are already installed:    \nregex-tdfa-1.2.2\nUse --reinstall if you want to reinstall anyway.\n</code></pre>\n\n<p>I even tried it with the <code>Makefile</code> which I got from <a href=\"https://github.com/ChrisKuklewicz/regex-tdfa\" rel=\"nofollow noreferrer\">TDFA's github repository</a>:</p>\n\n<pre><code>user@user-VirtualBox:~/regex-tdfa-master$ make    \nghc -o setup --make ./Setup.hs\n./setup clean    \ncleaning...    \n./setup configure --prefix=/Users/user/local/devel/trl --enable-library-profiling --user        \nConfiguring regex-tdfa-1.2.2...    \n./setup build    \nBuilding regex-tdfa-1.2.2...    \nPreprocessing` library regex-tdfa-1.2.2...    \n[ 1 of 23] Compiling Text.Regex.TDFA.NewDFA.Uncons ( Text/Regex/TDFA/NewDFA/Uncons.hs, dist/build/Text/Regex/TDFA/NewDFA/Uncons.o )     \n...........(Skipped to make the things short here)..............................    \n[23 of 23] Compiling Text.Regex.TDFA  ( Text/Regex/TDFA.hs, dist/build/Text/Regex/TDFA.o )    \nText/Regex/TDFA.hs:60:8:   \n    Could not find module \u2018Text.Regex.Base\u2019\n    Perhaps you haven't installed the profiling libraries for package \u2018regex-base-0.93.2@regex_47KXx9dLqeO8MNJeizLKhP\u2019?\n    Use -v to see a list of the files searched for.\n\nText/Regex/TDFA/ByteString.hs:24:8:\n    Could not find module \u2018Text.Regex.Base.Impl\u2019\n    Perhaps you haven't installed the profiling libraries for package \u2018regex-base-0.93.2@regex_47KXx9dLqeO8MNJeizLKhP\u2019?\n    Use -v to see a list of the files searched for.\n\nText/Regex/TDFA/CorePattern.hs:37:8:\n   Could not find module \u2018Control.Monad.RWS\u2019\n    Perhaps you haven't installed the profiling libraries for package \u2018mtl-2.2.1@mtl_Aue4leSeVkpKLsfHIV51E8\u2019?\n    Use -v to see a list of the files searched for.\n\nText/Regex/TDFA/ReadRegex.hs:13:8:\n    `Could not find module \u2018Text.ParserCombinators.Parsec\u2019`\n    Perhaps you haven't installed the profiling libraries for package \u2018parsec-3.1.9@parse_EE5NO1mlYLh4J8mgDEshNv\u2019?\n    Use -v to see a list of the files searched for.\n\nText/Regex/TDFA/String.hs:23:8:\n    Could not find module \u2018Text.Regex.Base.RegexLike\u2019`\n    Perhaps you haven't installed the profiling libraries for package \u2018regex-base-0.93.2@regex_47KXx9dLqeO8MNJeizLKhP\u2019?\n    Use -v to see a list of the files searched for.\n\nText/Regex/TDFA/TDFA.hs:10:8:`\n    Could not find module \u2018Control.Monad.State\u2019\n    Perhaps you haven't installed the profiling libraries for package \u2018mtl-2.2.1@mtl_Aue4leSeVkpKLsfHIV51E8\u2019?\n    Use -v to see a list of the files searched for.    \n\nMakefile:16: recipe for target 'build' failed    \nmake: *** [build] Error 1    \nuser@user-VirtualBox:~/regex-tdfa-master$\n</code></pre>\n\n<p>However, nothing worked. Hence, any help would be so appreciated... </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1520318071, "post_id": 49124112, "comment_id": 85254220, "body": "N.B.: While this doesn&#39;t compromise the relevance of this specific question, note that performance testing in GHCi isn&#39;t very realistic, as the code will be unoptimised. You&#39;d usually want to test after compiling with <code>-O2</code> (note that can be done within GHCi <a href=\"https://stackoverflow.com/q/27881725/2751851\">with the help of the <code>-fobject-code</code> option</a>)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1520327187, "post_id": 49124112, "comment_id": 85258518, "body": "<code>xs++[x]</code> needs to scan the whole list <code>xs</code>, making a copy of it, so to add <code>x</code> at the end. Instead, <code>x:xs</code> does not scan or copy anything, and only requires O(1) time instead of O(N)."}], "answers": [{"comments": [{"owner": {"reputation": 20427, "user_id": 2570261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e71068b09fc539447a0cee3e99fc419d?s=128&d=identicon&r=PG&f=1", "display_name": "Haleemur Ali", "link": "https://stackoverflow.com/users/2570261/haleemur-ali"}, "edited": false, "score": 1, "creation_date": 1520346633, "post_id": 49124516, "comment_id": 85270991, "body": "thank you for providing the hand evaluations, the explanation is much clearer with them, and I can use that technique to verify other functions."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 5, "last_activity_date": 1520330692, "last_edit_date": 1520330692, "creation_date": 1520317142, "answer_id": 49124516, "question_id": 49124112, "link": "https://stackoverflow.com/questions/49124112/how-does-enumfromto-work-in-haskell-and-what-optimizations-speed-up-the-ghc-impl/49124516#49124516", "title": "how does enumFromTo work in haskell and what optimizations speed up the GHC implementation vs naive implementations", "body": "<p>The problem with <code>eft</code> is that it still requires the entire list to be built, regardless of your attempt to cut it down with <code>take 10</code>. <a href=\"https://stackoverflow.com/q/3429634/2751851\">Tail recursion is not your friend when you want to build things lazily</a>. What you want is <a href=\"https://stackoverflow.com/a/23977623/2751851\"><em>guarded recursion</em></a> (i.e. recursive calls right behind the relevant constructor, as in <code>foldr</code>, so that they can be left unevaluated when you don't need them):</p>\n\n<pre><code>eft'' :: Enum a =&gt; a -&gt; a -&gt; [a]\neft'' x y\n    | fromEnum y &lt; fromEnum x = []\n    | otherwise = x : eft'' (succ x) y\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; take 10 (eft 1 10000000)\n[1,2,3,4,5,6,7,8,9,10]\n(7.48 secs, 2,160,291,096 bytes)\nGHCi&gt; take 10 (eft'' 1 10000000)\n[1,2,3,4,5,6,7,8,9,10]\n(0.00 secs, 295,752 bytes)\nGHCi&gt; take 10 (enumFromTo 1 10000000)\n[1,2,3,4,5,6,7,8,9,10]\n(0.00 secs, 293,680 bytes)\n</code></pre>\n\n<hr>\n\n<p>As for <code>eft'</code> being worse than <code>eft</code>, that indeed has to do with <code>(++)</code>. For reference, here are definitions for <code>take</code> and <code>(++)</code> (I'm using <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch9.html#x16-1720009.1\" rel=\"nofollow noreferrer\">the Report definitions</a> rather than <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/src/GHC.List.html\" rel=\"nofollow noreferrer\">the GHC ones</a>, but the slight differences don't actually matter here):</p>\n\n<pre><code>take                   :: Int -&gt; [a] -&gt; [a]  \ntake n _      | n &lt;= 0 =  []  \ntake _ []              =  []  \ntake n (x:xs)          =  x : take (n-1) xs \n\n(++) :: [a] -&gt; [a] -&gt; [a]  \n[]     ++ ys = ys  \n(x:xs) ++ ys = x : (xs ++ ys)\n</code></pre>\n\n<p>If you hand-evaluate <code>eft</code>, you get to see how it has to build the entire list before giving you any element:</p>\n\n<pre><code>take 3 (eft 1 5)\ntake 3 (go 1 5 [])\ntake 3 (go 1 4 (5 : []))\ntake 3 (go 1 3 (4 : 5 : []))\n-- etc.\ntake 3 (1 : 2 : 3 : 4 : 5 : [])\n1 : take 2 (2 : 3 : 4 : 5 : [])\n1 : 2 : take 1 (3 : 4 : 5 : [])\n-- etc.\n</code></pre>\n\n<p>At least, though, once you get past the <code>go</code>s the list is ready for consumption. That is not the case with <code>eft'</code> -- the <code>(++)</code> still have to be dealt with, and doing so is linear with respect to the length of the list:</p>\n\n<pre><code>take 3 (eft' 1 5)\ntake 3 (go 1 5 [])\ntake 3 (go 2 5 ([] ++ [1]))\ntake 3 (go 3 5 (([] ++ [1]) ++ [2]))\n-- etc.\ntake 3 ((((([] ++ [1]) ++ [2]) ++ [3]) ++ [4]) ++ [5])\ntake 3 (((([1] ++ [2]) ++ [3]) ++ [4]) ++ [5])\ntake 3 ((((1 : ([] ++ [2])) ++ [3]) ++ [4]) ++ [5])\ntake 3 ((((1 : [2]) ++ [3]) ++ [4]) ++ [5])\ntake 3 (((1 : ([2] ++ [3])) ++ [4]) ++ [5])\n-- etc.\ntake 3 (1 : ((([2] ++ [3]) ++ [4]) ++ [5]))\n1 : take 2 ((([2] ++ [3]) ++ [4]) ++ [5])\n</code></pre>\n\n<p>It gets worse: you have to do it again with the remaining tail of the list for every single element!</p>\n\n<pre><code>1 : take 2 ((([2] ++ [3]) ++ [4]) ++ [5])\n1 : take 2 (((2 : ([] ++ [3])) ++ [4]) ++ [5])\n1 : take 2 (((2 : [3]) ++ [4]) ++ [5])\n1 : take 2 ((2 : ([3] ++ [4])) ++ [5])\n-- etc.\n1 : take 2 (2 : (([3] ++ [4]) ++ [5]))\n1 : 2 : take 1 (([3] ++ [4]) ++ [5])\n-- etc.\n</code></pre>\n\n<p>In fact, the <code>take 10</code> disguises the fact that <code>eft'</code>, unlike <code>eft</code>, is quadratic:</p>\n\n<pre><code>GHCi&gt; last $ eft' 1 10000\n10000\n(1.83 secs, 4,297,217,200 bytes)\nGHCi&gt; last $ eft' 1 20000\n20000\n(7.59 secs, 17,516,804,952 bytes)\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; last $ eft 1 5000000\n5000000\n(3.81 secs, 1,080,282,784 bytes)\nGHCi&gt; last $ eft 1 10000000\n10000000\n(7.51 secs, 2,160,279,232 bytes)\n</code></pre>\n\n<p>For the sake of completeness, here is the corresponding hand-evaluation for <code>eft''</code>:</p>\n\n<pre><code>take 3 (eft'' 1 5)\ntake 3 (1 : eft'' 2 5)\n1 : take 2 (eft'' 2 5) -- No need to evaluate `eft'' 2 5` to get the first element.\n1 : take 2 (2 : eft'' 3 5)\n1 : 2 : take 1 (eft'' 3 5)\n-- etc.\n1 : 2 : 3 : take 0 (eft'' 4 5) -- No need to go further.\n1 : 2 : 3 : []\n</code></pre>\n"}], "owner": {"reputation": 20427, "user_id": 2570261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e71068b09fc539447a0cee3e99fc419d?s=128&d=identicon&r=PG&f=1", "display_name": "Haleemur Ali", "link": "https://stackoverflow.com/users/2570261/haleemur-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 49124516, "answer_count": 1, "score": 3, "last_activity_date": 1520330692, "creation_date": 1520315053, "last_edit_date": 1520315591, "question_id": 49124112, "link": "https://stackoverflow.com/questions/49124112/how-does-enumfromto-work-in-haskell-and-what-optimizations-speed-up-the-ghc-impl", "title": "how does enumFromTo work in haskell and what optimizations speed up the GHC implementation vs naive implementations", "body": "<p>I'm learning haskell, and one of the exercises required that I write a function equivalent to <code>enumFromTo</code>.</p>\n\n<p>I came up with the following two implementations:</p>\n\n<pre><code>eft' :: Enum a =&gt; a -&gt; a -&gt; [a]\neft' x y = go x y []\n  where go a b sequence\n          | fromEnum b &lt; fromEnum a = sequence\n          | otherwise = go (succ a) b (sequence ++ [a])\n\neft :: Enum a =&gt; a -&gt; a -&gt; [a]\neft x y = go x y []\n  where go a b sequence\n          | fromEnum b &lt; fromEnum a = sequence\n          | otherwise = go a (pred b) (b : sequence)\n</code></pre>\n\n<p>I had a hunch that the first version does more work, as it puts each element into a list and concatenates to the existing <code>sequence</code>, while the second version prepends a single element to a list. Is this the main reason for the performance difference or are there other significant factors or is my hunch slightly off the mark? </p>\n\n<p>Testing in ghci with <code>:set +s</code> reveals on my machine (Windows 10, GHC 8.2.2, intel i7-4770HQ):</p>\n\n<pre><code>*Lists&gt; take 10 (eft 1 10000000)\n[1,2,3,4,5,6,7,8,9,10]\n(9.77 secs, 3,761,292,096 bytes)\n*Lists&gt; take 10 (eft' 1 10000000)\n[1,2,3,4,5,6,7,8,9,10]\n(27.97 secs, 12,928,385,280 bytes)\n*Lists&gt; take 10 (enumFromTo 1 10000000)\n[1,2,3,4,5,6,7,8,9,10]\n(0.00 secs, 1,287,664 bytes)\n</code></pre>\n\n<p>My second hunch was that the <code>take 10 (eft 1 10000000)</code> should perform better than <code>take 10 (eft' 10000000)</code> because the latter has to build the list up all the way from 10000000 to 10 before it can return any useful values that we <code>take</code>. Clearly this hunch was wrong, and I'm hoping someone can explain why.</p>\n\n<p>Finally, the ghc implementation is incredibly more efficient than my naive implementations. I am curious to understand other optimizations have been applied to speed it up. The answer to this <a href=\"https://stackoverflow.com/questions/31754011/how-does-enumfromto-work\">similarly titled SO question</a> shares some code that seems to be from the ghc implementation, but doesn't explain how the \"nastiness\" gains efficiency.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1520309720, "post_id": 49123178, "comment_id": 85251833, "body": "Meta question: Are you the author of <a href=\"https://stackoverflow.com/q/49122630/2751851\">this now-deleted question</a>? If so, I would suggest you repost the <code>foldPairs</code> part of it -- there were some rather interesting points to be made about it, and I was about to finish an answer covering them..."}, {"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1520310312, "post_id": 49123178, "comment_id": 85251956, "body": "I was also mid-edit on an answer to your question when you deleted."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1520346988, "post_id": 49123321, "comment_id": 85271233, "body": "A useful identity (I think) is <code>foldl1 f (x:xs) == foldl f x xs</code> (<code>foldl f []</code> being undefined)."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1520350925, "post_id": 49123321, "comment_id": 85273980, "body": "@chepner While that&#39;s a useful identity for an experienced programmer (or mathematician), I think it would be hardly helpful to the OP, judging their skill/knowledge level by their question."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1520351287, "post_id": 49123321, "comment_id": 85274257, "body": "I wasn&#39;t sure if the question was regarding the folding aspect, or <code>foldl1</code> specifically."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 4, "last_activity_date": 1520309952, "creation_date": 1520309952, "answer_id": 49123321, "question_id": 49123178, "link": "https://stackoverflow.com/questions/49123178/haskell-foldl1-how-does-it-work/49123321#49123321", "title": "Haskell foldl1 how does it work?", "body": "<p><code>foldl1</code> first applies the function to the first two elements of the list, then takes the result and applies the function to it and the third element, then takes the result and applies the function to it and the fourth element, then to result and fifth element, then sixth element, and so on until the list ends.</p>\n\n<p>So:</p>\n\n<pre><code>Step 1:  g 4 3 = 4*2 - 3 = 5\nStep 2:  g 5 2 = 5*2 - 2 = 8\nStep 3:  g 8 1 = 8*2 - 1 = 15\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9407511, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-jYuE4fsGHHc/AAAAAAAAAAI/AAAAAAAAFZM/t-SfxAM-Rpc/photo.jpg?sz=128", "display_name": "Han Ben", "link": "https://stackoverflow.com/users/9407511/han-ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1359, "favorite_count": 0, "accepted_answer_id": 49123321, "answer_count": 1, "score": 0, "last_activity_date": 1520311307, "creation_date": 1520308977, "question_id": 49123178, "link": "https://stackoverflow.com/questions/49123178/haskell-foldl1-how-does-it-work", "title": "Haskell foldl1 how does it work?", "body": "<p>I have a code </p>\n\n<pre><code>g :: Int-&gt;Int-&gt;Int\ng x y = x*2 - y\n</code></pre>\n\n<p>then If i call foldl1 g [4,3,2,1] it returns 15, but i don't get how it returns 15, can anyone explain me why this is the case?</p>\n"}, {"tags": ["haskell", "pipe", "pipeline", "bytestring", "haskell-streaming"], "answers": [{"comments": [{"owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "edited": false, "score": 1, "creation_date": 1520321911, "post_id": 49124865, "comment_id": 85255899, "body": "That&#39;s a bit mindblowing. The outer stream originally returned by S.copy is going to drive the inner one?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "edited": false, "score": 0, "creation_date": 1520362367, "post_id": 49124865, "comment_id": 85281074, "body": "@MattJoiner It&#39;s more as if the elements were emitted in lockstep. In fact you can use <code>hoist</code> to work with the inner <code>Stream</code> first: <a href=\"http://hackage.haskell.org/package/streaming-0.2.0.0/docs/Streaming.html#v:hoist\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/streaming-0.2.0.0/docs/&hellip;</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "edited": false, "score": 0, "creation_date": 1520407899, "post_id": 49124865, "comment_id": 85297419, "body": "@MattJoiner, for whatever it&#39;s worth, <code>copy</code> is a special case of <code>expand :: (Monad m, Functor f) =&gt; (forall a b. (g a -&gt; b) -&gt; f a -&gt; h b) -&gt; Stream f m r -&gt; Stream g (Stream h m) r</code>. Maybe that will help your intuition somehow. Certainly, its implementation is much more constrained by its type."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 3, "last_activity_date": 1520362177, "last_edit_date": 1520362177, "creation_date": 1520318756, "answer_id": 49124865, "question_id": 49122127, "link": "https://stackoverflow.com/questions/49122127/how-to-track-progress-through-a-streaming-bytestring/49124865#49124865", "title": "How to track progress through a streaming ByteString?", "body": "<p>What we want is to traverse the <code>Stream (Of ByteString) IO ()</code> in two ways:</p>\n\n<ul>\n<li>One that accumulates the incoming lengths of the <code>ByteString</code>s and prints updates to console.</li>\n<li>One that writes the stream to a file.</li>\n</ul>\n\n<p>We can do that with the help of the <a href=\"http://hackage.haskell.org/package/streaming-0.2.0.0/docs/Streaming-Prelude.html#v:copy\" rel=\"nofollow noreferrer\"><code>copy</code></a> function, which has type:</p>\n\n<blockquote>\n<pre><code>copy :: Monad m =&gt; Stream (Of a) m r -&gt; Stream (Of a) (Stream (Of a) m) r\n</code></pre>\n</blockquote>\n\n<p><code>copy</code> takes a stream and duplicates it into two different monadic layers, where each element of the original stream is emitted by both layers of the new dissociated stream.</p>\n\n<p>(Notice that we are changing the base monad, not the functor. What changing the functor to another <code>Stream</code> does is to <a href=\"http://hackage.haskell.org/package/streaming-0.2.0.0/docs/Streaming-Prelude.html#v:group\" rel=\"nofollow noreferrer\">delimit groups</a> in a single stream, and we aren't interested in that here.)</p>\n\n<p>The following function takes a stream, copies it, accumulates the length of incoming strings with <a href=\"http://hackage.haskell.org/package/streaming-0.2.0.0/docs/Streaming-Prelude.html#v:scan\" rel=\"nofollow noreferrer\"><code>S.scan</code></a>, <a href=\"http://hackage.haskell.org/package/streaming-0.2.0.0/docs/Streaming-Prelude.html#v:mapM_\" rel=\"nofollow noreferrer\">prints them</a>, and returns another stream that you can still work with, for example writing it to a file:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Streaming\nimport qualified Streaming.Prelude as S\nimport qualified Data.ByteString as B\n\ntrack :: Stream (Of B.ByteString) IO r -&gt; Stream (Of B.ByteString) IO r\ntrack stream =\n      S.mapM_ (liftIO . print) -- brings us back to the base monad, here another stream\n    . S.scan (\\s b -&gt; s + B.length b) (0::Int) id\n    $ S.copy stream\n</code></pre>\n\n<p>This will print the <code>ByteString</code>s along with the accumulated lengths:</p>\n\n<pre><code>main :: IO ()\nmain = S.mapM_ B.putStr . track $ S.each [\"aa\",\"bb\",\"c\"]\n</code></pre>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 0, "accepted_answer_id": 49124865, "answer_count": 1, "score": 1, "last_activity_date": 1520362177, "creation_date": 1520300135, "last_edit_date": 1520303135, "question_id": 49122127, "link": "https://stackoverflow.com/questions/49122127/how-to-track-progress-through-a-streaming-bytestring", "title": "How to track progress through a streaming ByteString?", "body": "<p>I'm using the streaming-utils <a href=\"https://hackage.haskell.org/package/streaming-utils-0.1.4.7/docs/Data-ByteString-Streaming-HTTP.html\" rel=\"nofollow noreferrer\">streaming-utils</a> to stream a HTTP response body. I want to track the progress similar to how <a href=\"https://hackage.haskell.org/package/bytestring-progress-1.0.8/docs/Data-ByteString-Lazy-Progress.html\" rel=\"nofollow noreferrer\">bytestring-progress</a> allows with lazy <code>ByteString</code>s. I suspect something like <a href=\"https://hackage.haskell.org/package/streaming-bytestring-0.1.5/docs/Data-ByteString-Streaming.html#g:2\" rel=\"nofollow noreferrer\"><code>toChunks</code></a> would be necessary, then reducing some cumulative bytes read and returning the original stream unmodified. But I cannot figure it out, and the <a href=\"https://hackage.haskell.org/package/streaming\" rel=\"nofollow noreferrer\">streaming</a> documentation is very unhelpful, mostly full of grandiose comparisons to alternative libraries.</p>\n\n<p>Here's some code with my best effort so far. It doesn't include the counting yet, and just tries to print the size of chunks as they stream past (and doesn't compile).</p>\n\n<pre><code>download :: ByteString -&gt; FilePath -&gt; IO ()\ndownload i file = do\n  req &lt;- parseRequest . C.unpack $ i\n  m &lt;- newHttpClientManager\n  runResourceT $ do\n    resp &lt;- http req m\n    lift . traceIO $ \"downloading \" &lt;&gt; file\n    let body = SBS.fromChunks $ mapsM step $ SBS.toChunks $ responseBody resp\n    SBS.writeFile file body\n\nstep bs = do\n  traceIO $ \"got \" &lt;&gt; show (C.length bs) &lt;&gt; \" bytes\"\n  return bs\n</code></pre>\n"}, {"tags": ["haskell", "lr", "happy", "reduce-reduce-conflict"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520291081, "post_id": 49120608, "comment_id": 85247280, "body": "Seems like a bug to me..."}, {"owner": {"reputation": 81, "user_id": 1324614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885f0d954ac7d5a5a00a58102896d3c1?s=128&d=identicon&r=PG", "display_name": "sfogarty", "link": "https://stackoverflow.com/users/1324614/sfogarty"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520455255, "post_id": 49120608, "comment_id": 85327181, "body": "But a bug in Happy, or in my understanding of how %prec works?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520458776, "post_id": 49120608, "comment_id": 85328957, "body": "I think Happy is at fault here."}], "owner": {"reputation": 81, "user_id": 1324614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/885f0d954ac7d5a5a00a58102896d3c1?s=128&d=identicon&r=PG", "display_name": "sfogarty", "link": "https://stackoverflow.com/users/1324614/sfogarty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 1, "answer_count": 0, "score": 8, "last_activity_date": 1520289189, "creation_date": 1520289189, "question_id": 49120608, "link": "https://stackoverflow.com/questions/49120608/happy-order-of-productions-removes-r-r-conflicts", "title": "Happy: Order of Productions Removes R/R Conflicts", "body": "<p>I have a grammar that, depending on the order of productions, happy reports 3 reduce/reduce conflicts or none. The minimal example I can find is:</p>\n\n<pre><code>%tokentype {Token}\n%token\n    int     { Int }\n    '-'     { Neg }\n    both    { Both }\n%nonassoc both\n%left '-'\n%nonassoc NEG\n%%\nE : int                  {IntE}\n  | both E E             {BothE $2 $3}\n  | '-' E %prec NEG      {NegE $2}\n  | E '-' E              {SubE $1 $3}\n{\ndata Token = Int | Neg | Both deriving Show\ndata Expr = BothE Expr Expr | IntE | SubE Expr Expr | NegE Expr deriving Show\n}\n</code></pre>\n\n<p>This has 3 reduce-reduce conflicts, based around the inability to distinguish \"<code>both 7 -3</code>\" and \"<code>both 7-3 2</code>\". Fair enough!</p>\n\n<p>However, if you swap the last two productions for E (<code>'-' E %prec NEG</code> and <code>E '-' E</code>), the reduce/reduce conflicts disappear. More puzzling, if you then remove the <code>%prec NEG</code> directive, they return. I am quite confused as to what is happening here: why would the order matter? </p>\n"}, {"tags": ["haskell", "visual-studio-code", "haskell-stack"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520284160, "post_id": 49119117, "comment_id": 85244467, "body": "Are you using GTK in your project? (If not, you don&#39;t actually need <code>gtk2hs-buildtools</code>; either way, as far as I can see your issue isn&#39;t related to that.)"}], "answers": [{"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520283824, "post_id": 49119394, "comment_id": 85244320, "body": "So you add all new created modules in the yaml file and that&#39;s it ? From there on it knows which go where depending on your module dependencies? I mean the .yaml file is like a global dump where all created modules must be found?"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520284003, "post_id": 49119394, "comment_id": 85244392, "body": "I added the stack.yaml file to the question."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520284159, "post_id": 49119394, "comment_id": 85244466, "body": "Please see my update. I couldn&#39;t write it quite quickly enough."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520284496, "post_id": 49119394, "comment_id": 85244629, "body": "Ok so i posted my cabal file .I have to create a section entitled &quot;exposed-modules&quot;?And if yes i just dump the names there?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520284598, "post_id": 49119394, "comment_id": 85244673, "body": "@BercoviciAdrian Note that Fyodor Soikin points you to <code>package.yaml</code> (or, if you don&#39;t have one, the <code>.cabal</code> file), and not to <code>stack.yaml</code>."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520284737, "post_id": 49119394, "comment_id": 85244740, "body": "Thank you for pointing me out.I don&#39;t seem to have a package.yaml but i have a .cabal although without the &quot;exposed-modules&quot; or &quot;other-modules&quot;  section."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1520285211, "post_id": 49119394, "comment_id": 85244962, "body": "Just add those sections there."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1520450149, "post_id": 49119394, "comment_id": 85324421, "body": "Ok so i do not have those sections in the cabal file.But i added them and it is the same problem.I ran cabal build and i get the following:no location info&gt;: warning: [-Wmissing-home-modules]     These modules are needed for compilation but not listed in your .cabal file&#39;s other-modules: Test"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1520450222, "post_id": 49119394, "comment_id": 85324471, "body": "Do you mean that you receive the same error message? Do you have the correct file structure? Can you show it? Can you show your <code>.cabal</code> file?"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 9, "last_activity_date": 1520284133, "last_edit_date": 1520284133, "creation_date": 1520283670, "answer_id": 49119394, "question_id": 49119117, "link": "https://stackoverflow.com/questions/49119117/can-not-import-modules-in-haskell/49119394#49119394", "title": "Can not import modules in Haskell", "body": "<p><strong>First, <code>stack install</code> is a bit of a misnomer</strong>. Unlike <code>npm install</code> or <code>bower install</code>, it doesn't download anything or \"add\" anything to your project. Under <code>stack</code>, all packages are (potentially, logically) downloaded and installed all the time. <code>stack</code> will build a package on first use, but there is no need to explicitly ask <code>stack</code> to download it.</p>\n\n<p>What <code>stack install</code> actually does, it builds the package and, if the package contains any executables, it puts them in a special place on the file system that is on your <code>PATH</code>, so that now you can run those executables. Seeing how you can always run executables with <code>stack exec package</code> without installing them, using <code>stack install</code> is generally discouraged unless you're really sure it's necessary.</p>\n\n<p><strong>To add a package to your project</strong>, you need to include it in your <code>.cabal</code> file in <code>build-depends</code> section or in your <code>package.yaml</code> file in the <code>dependencies</code> section (whichever one you're using). <a href=\"https://github.com/commercialhaskell/stack/blob/master/package.yaml#L36\" rel=\"noreferrer\">Here is an example of a <code>package.yaml</code></a>, and <a href=\"https://github.com/nick8325/quickcheck/blob/master/QuickCheck.cabal#L63\" rel=\"noreferrer\">here's an example of a <code>.cabal</code> file</a>.</p>\n\n<p>But what you're trying to do, it seems, is to <strong>reference <em>your own modules</em></strong>, not external dependencies. For that, <code>stack install</code> is even further from the truth.</p>\n\n<p>To reference your own modules, you need two things: (1) correct file system structure and (2) add them to <code>.cabal</code> or <code>package.yaml</code>.</p>\n\n<p><strong>File system structure</strong>: in Haskell (or, more precisely, in GHC), modules must be located in a place on the file system that matches their hierarchical name. For example, module <code>Main</code> would be located in <code>./Main.hs</code>, and module <code>Client</code> would be located in <code>./Client.hs</code>, or, say, module <code>Client.Internals</code> would be located in <code>./Client/Internals.hs</code>. A bit annoying, yes. But this is the way Haskell is.</p>\n\n<p><strong>Cabal file</strong>: all modules in a package/library must be listed in the <code>.cabal</code> file, either under <code>exposed-modules</code> or under <code>other-modules</code>. Just add them there, and the compiler will see them.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3228, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1520284453, "creation_date": 1520282555, "last_edit_date": 1520284453, "question_id": 49119117, "link": "https://stackoverflow.com/questions/49119117/can-not-import-modules-in-haskell", "title": "Can not import modules in Haskell", "body": "<p>Hello i am trying to use Haskell with vscode and if i try to use a module inside another i get the following error:</p>\n\n<pre><code>Failed to load interface for **Client**\nUse -v to see a list of the files searched for.\n</code></pre>\n\n<p>First Module:</p>\n\n<pre><code>module Main where \n\nimport qualified Client as Cl\n\nmain ::IO ()\nmain = do\nname&lt;- getLine\nsp\n</code></pre>\n\n<p>Second module:</p>\n\n<pre><code>    module Client \n    (sp)where\n\n    sp::IO()\n    sp=print \"SecondModule\"\n</code></pre>\n\n<p>After some reading i tried updating stack and installing the build tools at which point i get the following error:</p>\n\n<pre><code>   $ stack install gtk2hs-buildtools\n    \u2190[0mprimitive-0.6.3.0: using precompiled package\u2190[0m\n    \u2190[0mCabal-2.0.1.1: using precompiled package\u2190[0m\n    \u2190[0mmtl-2.2.1: using precompiled package\u2190[0m\n    \u2190[0mrandom-1.1: using precompiled package\u2190[0m\n    \u2190[0mtext-1.2.2.2: using precompiled package\u2190[0m\n    \u2190[0mvector-0.12.0.1: using precompiled package\u2190[0m\n    \u2190[0mtf-random-0.5: configure\u2190[0m\n    \u2190[0mhashable-1.2.6.1: using precompiled package\u2190[0m\n    \u2190[0mhappy-1.19.9: download\u2190[0m\n    \u2190[0mtf-random-0.5: build\u2190[0m\n    \u2190[0mhashtables-1.2.2.1: download\u2190[0m\n    \u2190[0mhashtables-1.2.2.1: configure\u2190[0m\n    \u2190[0mhashtables-1.2.2.1: build\u2190[0m\n    \u2190[0mhappy-1.19.9: configure\u2190[0m\n    \u2190[0mtf-random-0.5: copy/register\u2190[0m\n    \u2190[0mQuickCheck-2.10.1: download\u2190[0m\n    \u2190[0mhappy-1.19.9: build\u2190[0m\n    \u2190[0mQuickCheck-2.10.1: configure\u2190[0m\n    \u2190[0mQuickCheck-2.10.1: build\u2190[0m\n    \u2190[0mhashtables-1.2.2.1: copy/register\u2190[0m\n    \u2190[0mQuickCheck-2.10.1: copy/register\u2190[0m\n    \u2190[0malex-3.2.3: download\u2190[0m\n    \u2190[0malex-3.2.3: configure\u2190[0m\n    \u2190[0malex-3.2.3: build\u2190[0m\n    \u2190[0mhappy-1.19.9: copy/register\u2190[0m\n    \u2190[0malex-3.2.3: copy/register\u2190[0m\n    \u2190[0mgtk2hs-buildtools-0.13.3.1: download\u2190[0m\n    \u2190[0mgtk2hs-buildtools-0.13.3.1: configure\u2190[0m\n    \u2190[0mgtk2hs-buildtools-0.13.3.1: build\u2190[0m\n    \u2190[0mgtk2hs-buildtools-0.13.3.1: copy/register\u2190[0m\n    Completed 13 action(s).\n    removeDirectoryRecursive:removeContentsRecursive:removePathRecursive:removeContentsRecursive:removePathRecursive:removeContentsRecursive:removePathRecursive:removeContentsRecursive:removePathRecursive:removeContentsRecursive:removePathRecursive:removeContentsRecursive:removePathRecursive:DeleteFile \"C:\\\\Users\\\\aita\\\\AppData\\\\Local\\\\Temp\\\\stack7744\\\\gtk2hs-buildtools-0.13.3.1\\\\.stack-work\\\\dist\\\\5c8418a7\\\\build\\\\gtk2hsC2hs\\\\gtk2hsC2hs.exe\": permission denied (The process cannot access the file because it is being used by another process.)\n</code></pre>\n\n<p>I was careful not to have any other process use this folder but i don't get why the error.</p>\n\n<p>Here is my <strong>stack.yaml</strong> file:</p>\n\n<pre><code># This file was automatically generated by 'stack init'\n#\n# Some commonly used options have been documented as comments in this file.\n# For advanced use and comprehensive documentation of the format, please see:\n# https://docs.haskellstack.org/en/stable/yaml_configuration/\n\n# Resolver to choose a 'specific' stackage snapshot or a compiler version.\n# A snapshot resolver dictates the compiler version and the set of packages\n# to be used for project dependencies. For example:\n#\n# resolver: lts-3.5\n# resolver: nightly-2015-09-21\n# resolver: ghc-7.10.2\n# resolver: ghcjs-0.1.0_ghc-7.10.2\n# resolver:\n#  name: custom-snapshot\n#  location: \"./custom-snapshot.yaml\"\nresolver: lts-10.7\n\n# User packages to be built.\n# Various formats can be used as shown in the example below.\n#\n# packages:\n# - some-directory\n# - https://example.com/foo/bar/baz-0.0.2.tar.gz\n# - location:\n#    git: https://github.com/commercialhaskell/stack.git\n#    commit: e7b331f14bcffb8367cd58fbfc8b40ec7642100a\n# - location: https://github.com/commercialhaskell/stack/commit/e7b331f14bcffb8367cd58fbfc8b40ec7642100a\n#   extra-dep: true\n#  subdirs:\n#  - auto-update\n#  - wai\n#\n# A package marked 'extra-dep: true' will only be built if demanded by a\n# non-dependency (i.e. a user package), and its test suites and benchmarks\n# will not be run. This is useful for tweaking upstream packages.\npackages:\n- .\n# Dependency packages to be pulled from upstream that are not in the resolver\n# (e.g., acme-missiles-0.3)\n# extra-deps: []\n\n# Override default flag values for local packages and extra-deps\n# flags: {}\n\n# Extra package databases containing global packages\n# extra-package-dbs: []\n\n# Control whether we use the GHC we find on the path\n# system-ghc: true\n#\n# Require a specific version of stack, using version ranges\n# require-stack-version: -any # Default\n# require-stack-version: \"&gt;=1.6\"\n#\n# Override the architecture used by stack, especially useful on Windows\n# arch: i386\n# arch: x86_64\n#\n# Extra directories used by stack for building\n# extra-include-dirs: [/path/to/dir]\n# extra-lib-dirs: [/path/to/dir]\n#\n# Allow a newer minor version of GHC than the snapshot specifies\n# compiler-check: newer-minor\nMain\nClient\n</code></pre>\n\n<p><strong>Cabal File.</strong></p>\n\n<pre><code>name:                Hworld\nversion:             0.1.0.0\n-- synopsis:\n-- description:\nhomepage:            https://github.com/githubuser/Hworld#readme\nlicense:             BSD3\nlicense-file:        LICENSE\nauthor:              Author name here\nmaintainer:          example@example.com\ncopyright:           2018 Author name here\ncategory:            Web\nbuild-type:          Simple\ncabal-version:       &gt;=1.10\nextra-source-files:  README.md\n\nexecutable Hworld\n  hs-source-dirs:      src\n  main-is:             Main.hs\n  default-language:    Haskell2010\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n</code></pre>\n"}, {"tags": ["haskell", "dependent-type"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1520282749, "post_id": 49118438, "comment_id": 85243782, "body": "You just have to make the induction explicit: <code>instance Fold (Vector (S n) a) where</code> should be <code>instance Fold (Vector n a) =&gt; Fold (Vector (S n) a) where</code>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520327300, "post_id": 49118438, "comment_id": 85258600, "body": "I totally missed the actual juice of your question. Rereading it, I realize that you were actually asking more about <code>IsList</code> than anything else. Please comment if you feel the answer to the question I marked this as a duplicate of doesn&#39;t address your question."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520331806, "post_id": 49118438, "comment_id": 85261447, "body": "@Alec I was specifically interested in the possibility of approaching the <code>IsList</code> functionality as much as possible <i>without</i> resorting to &quot;advanced&quot; techniques such as singletons. There is a gap in my understanding that I want to bridge, rather than jump over: I must first see classical techniques reach their edge, in order to appreciate the cunning modern inventions. Before I opened this question, I had found several similar questions on Stack Overflow, but they all appeal to singletons, and that I specifically wanted to not get into yet."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520350374, "post_id": 49118438, "comment_id": 85273554, "body": "Reopened. The point of the duplicates was just to say that what you want is fundamentally impossible in today&#39;s Haskell. The closest you can get is either with something where you specify the expected output length (but risk a runtime error if the list isn&#39;t long enough), or where you have an existential wrapper over the length type variable."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520356592, "post_id": 49118438, "comment_id": 85277872, "body": "@Alec I find this link very useful. I see it&#39;s pinned in the right bar now; that is good."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 3, "last_activity_date": 1520283335, "creation_date": 1520283335, "answer_id": 49119317, "question_id": 49118438, "link": "https://stackoverflow.com/questions/49118438/can-i-convert-a-list-to-a-length-indexed-vector-with-a-class/49119317#49119317", "title": "Can I convert a list to a length indexed vector with a class?", "body": "<p>The compiler is informing you of two different problems.</p>\n\n<blockquote>\n  <p>In essence, it talks about the element types of vectors of different length not being equal:</p>\n</blockquote>\n\n<p>Spot on! You have two approaches here. If you want to keep the <code>Elem</code> family as part of the typeclass, you'll have to add an extra constraint to the inductive case basically telling GHC \"my element types are equal\":</p>\n\n<pre><code>instance (Elem (Vector n a) ~ a) =&gt; Fold (Vector (S n) a) where\n    type Elem (Vector (S n) a) = a\n    fold (x:xs) = put x (fold xs)\n</code></pre>\n\n<p>Alternately, you could make that type family completely separate and have only one (more sensible) instance:</p>\n\n<pre><code>type family Elem xs :: *\ntype instance Elem (Vector n x) = x\n\nclass Fold a where\n  fold :: [Elem a] -&gt; a\n</code></pre>\n\n<p>Up to you!</p>\n\n<blockquote>\n  <p>This saddens me because it must mean my inductive instance does not iterate.</p>\n</blockquote>\n\n<p>Sure it doesn't \"iterate\", because you haven't told GHC to go find a recursive subproblem! Just add that subproblem to your constraint for the inductive case.</p>\n\n<pre><code>-- If you decided to keep the type family associated\ninstance (Elem (Vector n a) ~ a, Fold (Vector n a)) =&gt; Fold (Vector (S n) a) where\n  type Elem (Vector (S n) a) = a\n  fold (x:xs) = put x (fold xs)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>-- If you decided not to keep the type family associated\ninstance Fold (Vector n a) =&gt; Fold (Vector (S n) a) where\n  fold (x:xs) = put x (fold xs)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1520311809, "post_id": 49120144, "comment_id": 85252279, "body": "You are wrong in the final part. <code>fold</code> works with your definition of <code>Vector</code>, if I just redefine: <code>put = (:%:)</code> and <code>v0 = VNil</code>."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1520349510, "post_id": 49120144, "comment_id": 85273009, "body": "Sorry, I meant a <i>total</i> function."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 1, "last_activity_date": 1520350758, "last_edit_date": 1520350758, "creation_date": 1520286946, "answer_id": 49120144, "question_id": 49118438, "link": "https://stackoverflow.com/questions/49118438/can-i-convert-a-list-to-a-length-indexed-vector-with-a-class/49120144#49120144", "title": "Can I convert a list to a length indexed vector with a class?", "body": "<blockquote>\n  <p>Can I obtain [an <code>IsList</code> instance] at all?</p>\n</blockquote>\n\n<p>No. <code>IsList a</code> implies a function <code>[Elem a] -&gt; a</code>. This is impossible for length-indexed vectors, because the signature demands the ouput type not depend on the input length. The closest you can get is the following:</p>\n\n<pre><code>data VecSomeLen a = forall (n :: Nat). VecSomeLen (Vector n a)\ninstance IsList (VecSomeLen a) where ...\n-- and also\ninstance IsList (Maybe (Vector n a)) where ...\n</code></pre>\n\n<p>It\u2019s not entirely useless, because it lifts a list with no size into one with unknown but manipulatable size/checks whether a list has a given length, but it\u2019s pretty useless when you consider it\u2019s usually used when the size is known.</p>\n\n<p>I\u2019d just use varargs.</p>\n\n<pre><code>-- untested but *should* compile\nclass MkVector n a n' r | r -&gt; n a n' where\n  mkVector :: (Vector n a -&gt; Vector n' a) -&gt; r\ninstance MkVector Z a n (Vector n a) where\n  mkVector f = f $ Vector []\ninstance (MkVector n a n' r) =&gt; MkVector (S n) a n' (a -&gt; r) where\n  mkVector f x = mkVector $ \\(Vector xs) -&gt; f $ Vector $ x:xs\n\nvector :: MkVector n a n r =&gt; r\nvector = mkVector id\n\n-- vector 1 5 3 :: Vector (S(S(S(Z)))) Int\n</code></pre>\n\n<p>Now, the thing is that your <code>Fold</code> class, though it can compile with @Alec\u2019s change, is totally the wrong thing to do. Look at the type of the function you\u2019ll create:</p>\n\n<pre><code>fold :: forall n. [a] -&gt; Vector n a\n</code></pre>\n\n<p>That\u2019s no good! Given a list of elements, you can make a sized list, except the new size is not related in any way to the input list. You seem to be getting around that with non-totality, which is just a terrible idea. Furthermore, if anyone comes by and tries to make <code>fold</code> total, it\u2019s easy to break the <code>Vector</code> invariants by accident. Honestly, your definiton of <code>Vector</code> is somewhat odd. It\u2019s easy to break its invariants because the backing data is not as strongly typed as its interface. I\u2019d redefine it:</p>\n\n<pre><code>data Vector (n :: Nat) a where\n  (:%:) :: a -&gt; Vector n a -&gt; Vector (S n) a\n  VNil  :: Vector Z a\ninfixr 5 :%:\n-- infixr 5 :\n</code></pre>\n\n<p>Which makes it impossible to write a total <code>fold</code> (and that\u2019s good, because its existence is a bug). However, you can no longer (safely) coerce to a normal list because this is no longer a newtype (but I believe they have the same representation anyway and can still be <code>unsafeCoerce</code>'d).</p>\n\n<p>A better idea would be to encode the partiality with <code>Maybe</code>. Additionally, you can abstract out a certain pattern from the <code>Fold</code> class to make writing similar functions easier.</p>\n\n<pre><code>-- can\u2019t match on types so match on SNat representatives\ndata SNat (n :: Nat) where\n  SZ :: SNat Z\n  SS :: SNat n -&gt; SNat (S n)\n-- pass SNats around implicitly\nclass KNat (n :: Nat) where kNat :: SNat n\ninstance KNat Z where kNat = SZ\ninstance KNat n =&gt; KNat (S n) = SS kNat\nfromList' :: SNat n -&gt; [a] -&gt; Maybe (Vector n a)\nfromList' (SS n) (x:xs) = (x :%:) &lt;$&gt; fromList' n xs\nfromList' SZ [] = return VNil\nfromList' _ _ = Nothing\nfromList :: KNat n =&gt; [a] -&gt; Maybe (Vector n a)\nfromList = fromList' kNat\n</code></pre>\n"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1520350758, "creation_date": 1520279857, "question_id": 49118438, "link": "https://stackoverflow.com/questions/49118438/can-i-convert-a-list-to-a-length-indexed-vector-with-a-class", "title": "Can I convert a list to a length indexed vector with a class?", "body": "<p>To avoid ragged matrices, I want to design a type wrapper for lists that holds length in type. <em>(Please correct me if I should not call it a \"length-indexed vector\".)</em> I would like to provide it as an abstract type with smart constructors, among which would be an <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.10.1.0/GHC-Exts.html#t:IsList\" rel=\"nofollow noreferrer\"><code>IsList</code></a> instance or something similar in spirit.</p>\n\n<p>This is where I am:</p>\n\n<pre><code>data Nat = Z | S Nat\n\ndata Vector (n :: Nat) a = Vector [a] deriving Show\n\nv0 :: Vector Z a\nv0 = Vector [ ]\n\nput :: a -&gt; Vector n a -&gt; Vector (S n) a\nput x (Vector xs) = Vector (x:xs)\n\nclass Fold a where\n    type Elem a\n    fold :: [Elem a] -&gt; a\n\ninstance Fold (Vector Z a) where\n    type Elem (Vector Z a) = a\n    fold [ ] = v0\n\ninstance Fold (Vector (S n) a) where\n    type Elem (Vector (S n) a) = a\n    fold (x:xs) = put x (fold xs)\n</code></pre>\n\n<p>The <code>Fold</code> typeclass is supposed to take elements from a list one by one and <code>put</code> them to the vector. The instances I intend to represent the base case and the inductive case for structural induction along the <code>Nat</code>urals.</p>\n\n<p>However, the code I posted does not work, and I cannot sort the errors out. In essence, it talks about the element types of vectors of different length not being equal:</p>\n\n<pre><code>...\n  Expected type: [Elem (Vector n a)]\n    Actual type: [Elem (Vector ('S n) a)]\n...\n     fold (x:xs) = put x (fold xs)\n                               ^^\n</code></pre>\n\n<p>If I assume the magical coercion function:</p>\n\n<pre><code>    fold (x:xs) = put x (fold $ undefined xs)                                                        \n</code></pre>\n\n<p>\u2212 I will then reach another error:</p>\n\n<pre><code>    \u2022 No instance for (Fold (Vector n a)) arising from a use of \u2018fold\u2019\n...\n     fold (x:xs) = put x (fold $ undefined xs)\n                          ^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>This saddens me because it must mean my inductive instance does not iterate.</p>\n\n<p>I need help with this.</p>\n\n<ul>\n<li>Can I obtain an <code>IsList</code> instance this way?</li>\n<li>Can I obtain it at all?</li>\n<li>The point of dependent typing does not seem to get through to me. Do I think in the right direction at all? How can I tell what is doable with dependent types and what is not, so that I can judge the tractability of this particular case, and other cases that I may face in the future, by myself?</li>\n</ul>\n"}, {"tags": ["haskell", "types", "type-alias", "type-synonyms"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 5, "creation_date": 1520276795, "post_id": 49117602, "comment_id": 85240697, "body": "You should use <code>newtype</code> instead lf <code>type</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1520277086, "post_id": 49117602, "comment_id": 85240851, "body": "@Shersh To answer a question, use the Post Your Answer button, Comments are for requesting clarification or suggesting improvements to the question."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1520279516, "post_id": 49117602, "comment_id": 85242078, "body": "But it&#39;s impossible to get achievement for many comments with <code>5+</code> upvotes otherwise... StackOverflow policy encourages me to write such comments instead of answers!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 1, "creation_date": 1520279681, "post_id": 49117602, "comment_id": 85242154, "body": "@Shersh That&#39;s no excuse. Part of the challenge is writing <i>appropriate</i> comments that get up-voted."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1520292442, "post_id": 49117602, "comment_id": 85247714, "body": "@amalloy, sometimes one can write a comment (like Shersh&#39;s) in a few seconds and help the OP out. But one may not be able to write a proper answer in that time. The above comment would likely not be well received if it posed as an answer."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1520293578, "post_id": 49117602, "comment_id": 85248029, "body": "@dfeuer Yes, I&#39;m aware that&#39;s the idea, but I don&#39;t think that&#39;s something to encourage. Something that can easily be answered in a seven-word comment will quickly have a real Answer, too - in this case, a thorough answer came in just two minutes after the comment &quot;answer&quot;. I would rather we get a real Answer, and the presence of a comment like this discourages posting an Answer, because &quot;OP&#39;s already been helped&quot;."}, {"owner": {"reputation": 500, "user_id": 6030440, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-3k0aSh3Ojgs/AAAAAAAAAAI/AAAAAAAAACg/Yn_hyfPJonk/photo.jpg?sz=128", "display_name": "Austin Garrett", "link": "https://stackoverflow.com/users/6030440/austin-garrett"}, "edited": false, "score": 0, "creation_date": 1520433037, "post_id": 49117602, "comment_id": 85313079, "body": "From <a href=\"https://wiki.haskell.org/Newtype\" rel=\"nofollow noreferrer\">wiki.haskell.org/Newtype</a>:  &quot;Data can only be replaced with newtype if the type has exactly one constructor with exactly one field inside it.&quot; I suppose I could just do <code>newtype Vector a = Vector (a, a)</code> though."}], "answers": [{"tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 6, "last_activity_date": 1520276939, "creation_date": 1520276939, "answer_id": 49117767, "question_id": 49117602, "link": "https://stackoverflow.com/questions/49117602/getting-haskell-to-distinguish-type-synonyms/49117767#49117767", "title": "Getting Haskell to Distinguish Type Synonyms", "body": "<p><code>newtype</code> is likely what you want, or at any rate, the best we've got.  Like <code>type</code>, it defines a new name for an existing type, and the runtime representation will be the same.  Unlike <code>type</code> (but like <code>data</code>), they are considered different during type checking, and there is a new data constructor.</p>\n\n<p>So you might have code like:</p>\n\n<pre><code>newtype Position = Position (Vector Float)\np :: Position\np = Position (Vec 0 0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1520292283, "post_id": 49118082, "comment_id": 85247667, "body": "I think it&#39;s more common these days to say that a type constructor has one or more phantom parameters than to say it&#39;s a phantom type."}, {"owner": {"reputation": 500, "user_id": 6030440, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-3k0aSh3Ojgs/AAAAAAAAAAI/AAAAAAAAACg/Yn_hyfPJonk/photo.jpg?sz=128", "display_name": "Austin Garrett", "link": "https://stackoverflow.com/users/6030440/austin-garrett"}, "edited": false, "score": 0, "creation_date": 1520433262, "post_id": 49118082, "comment_id": 85313229, "body": "I believe I saw a similar solution for C++. Unfortunately not as elegant as I was hoping (especially since it can&#39;t be applied to datatypes that are defined in imported libraries), but useful nonetheless."}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 6, "last_activity_date": 1520278325, "creation_date": 1520278325, "answer_id": 49118082, "question_id": 49117602, "link": "https://stackoverflow.com/questions/49117602/getting-haskell-to-distinguish-type-synonyms/49118082#49118082", "title": "Getting Haskell to Distinguish Type Synonyms", "body": "<p>You could make <code>Vector</code> a <a href=\"https://wiki.haskell.org/Phantom_type\" rel=\"noreferrer\">phantom type</a> as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Vector t a = Vec a a\n\ndata Pos\ndata Vel\n\ntype Position = Vector Pos Float\ntype Velocity = Vector Vel Float\n</code></pre>\n\n<p>Now, you can define instances of <code>Position</code> and <code>Velocity</code> like you'd normally do:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>p :: Position\np = Vec 0.0 0.0\n\nv :: Velocity\nv = Vec 1.0 1.0\n</code></pre>\n\n<p>However, it won't allow you to use them interchangeably:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>type Time = Float\n\nstep :: Position -&gt; Velocity -&gt; Time -&gt; Position\nstep p v dt = p + v*dt -- you might have to change this definition\n\np' = step v p 0.01 -- won't compile\n</code></pre>\n\n<p>You can also make things more precise by using <code>DataKinds</code> and <code>KindSignatures</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE KindSignatures #-}\n\ndata VectorType = Pos | Vel\n\ndata Vector (t :: VectorType) a = Vec a a\n\ntype Position = Vector Pos Float\ntype Velocity = Vector Vel Float\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 500, "user_id": 6030440, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-3k0aSh3Ojgs/AAAAAAAAAAI/AAAAAAAAACg/Yn_hyfPJonk/photo.jpg?sz=128", "display_name": "Austin Garrett", "link": "https://stackoverflow.com/users/6030440/austin-garrett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 49118082, "answer_count": 2, "score": 3, "last_activity_date": 1520280615, "creation_date": 1520276286, "last_edit_date": 1520280615, "question_id": 49117602, "link": "https://stackoverflow.com/questions/49117602/getting-haskell-to-distinguish-type-synonyms", "title": "Getting Haskell to Distinguish Type Synonyms", "body": "<p>I like the idea of Haskell type synonyms, because they allow for distinguishing between abstract datatypes that share underlying representations. Unfortunately, when I write a program like</p>\n\n<pre><code>data Vector a = Vec a a\n\n-- Some definitions here about (+) and (*) for Vector ...\n\ntype Position = Vector Float\ntype Velocity = Vector Float\ntype Time = Float\n\nstep :: Position -&gt; Velocity -&gt; Time -&gt; Position\nstep p v dt = p + v*dt\n\np :: Position\np = Vec 0.0 0.0\n\nv :: Velocity\nv = Vec 1.0 1.0\n\np' = step v p 0.01\n</code></pre>\n\n<p>This is perfectly valid Haskell code, despite <code>v</code> and <code>p</code> being in the wrong spots. I would like to strengthen the distinction between type synonyms, such that they still share underlying representation, but are not accepted as each other in function application. Is this possible?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1520274461, "post_id": 49117075, "comment_id": 85239482, "body": "Wel functions are in fact data. But I do not really understand your question I&#39;m afraid."}], "answers": [{"comments": [{"owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "edited": false, "score": 0, "creation_date": 1520275564, "post_id": 49117152, "comment_id": 85240050, "body": "In Python, the function is clearly a behavior of the data. But in Haskell, the function seems more mixed up with the data type itself."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "edited": false, "score": 1, "creation_date": 1520277965, "post_id": 49117152, "comment_id": 85241271, "body": "Not really; <code>StateT</code> really is just a wrapper around a function. <code>runStateT (StateT foo) &quot;bar&quot; == foo &quot;bar&quot;</code>. Since Haskell is statically typed, you can (and must) be specific about exactly which types of functions you can wrap, whereas Python doesn&#39;t even enforce that the argument to <code>StateT.__init__</code> is a function, regardless of the <i>intention</i> for it to do so. (Although you can provide a type hint for static analysis, even if it is ignored at run time.)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 7, "last_activity_date": 1520274911, "last_edit_date": 1520274911, "creation_date": 1520274534, "answer_id": 49117152, "question_id": 49117075, "link": "https://stackoverflow.com/questions/49117075/haskell-function-as-data-type/49117152#49117152", "title": "Haskell: Function as Data type", "body": "<p>It's just a wrapper <em>around</em> a function. </p>\n\n<pre><code>foo :: String -&gt; [(Int, String)]\nfoo xs = zip [1..] (map pure xs)\n\nfooState :: StateT String [] Int\nfooState = StateT foo\n</code></pre>\n\n<p>The data constructor <code>StateT</code> takes a single argument, a function of type <code>s -&gt; m (a, s)</code>, and returns a value of type <code>StateT s m a</code>. Here, we have</p>\n\n<ul>\n<li><code>s ~ String</code></li>\n<li><code>m ~ []</code></li>\n<li><code>a ~ Int</code></li>\n</ul>\n\n<p>due to the declare type of <code>foo</code>.</p>\n\n<hr>\n\n<p>It's really not very different from a function reference in a language like Python.  (Note that <code>foo</code> has a slightly different type here than in the Haskell example, but the idea of passing a <em>reference</em> to <code>foo</code> to <code>StateT.__init__</code> is the important thing to note).</p>\n\n<pre><code>class StateT:\n   def __init__(self, f):\n       self.runStateT = f\n\ndef foo(xs):\n    return enumerate(xs)\n\nx = StateT(foo)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 2, "last_activity_date": 1520276013, "creation_date": 1520276013, "answer_id": 49117535, "question_id": 49117075, "link": "https://stackoverflow.com/questions/49117075/haskell-function-as-data-type/49117535#49117535", "title": "Haskell: Function as Data type", "body": "<p>Functions, like any other value, have types and, as you say, can be passed as arguments. Fields of data types can also store functions, which again is no different from how other values can be used:</p>\n\n<pre><code>GHCi&gt; :t (\"foo\", \"bar\")\n(\"foo\", \"bar\") :: ([Char], [Char])\nGHCi&gt; :t (reverse, drop 2)\n(reverse, drop 2) :: ([a1] -&gt; [a1], [a2] -&gt; [a2])\n</code></pre>\n\n<p>From this point of view, there is no essential difference between...</p>\n\n<pre><code>newtype MyInt = MyInt { getMyInt :: Int }\n</code></pre>\n\n<p>... and:</p>\n\n<pre><code>newtype StateT s m a = StateT { runStateT :: s -&gt; m (a,s) }\n</code></pre>\n\n<blockquote>\n  <p>will this bring expressiveness to Haskell type system?</p>\n</blockquote>\n\n<p>Here are two of the ways in which it does so. Firstly, wrappers and type synonyms for function types allow writing less cluttered type signatures. This, for example...</p>\n\n<pre><code>withStateT :: (s -&gt; s) -&gt; StateT s m a -&gt; StateT s m a\n</code></pre>\n\n<p>... reads quite a bit nicer than:</p>\n\n<pre><code>withStateT :: (s -&gt; s) -&gt; (s -&gt; m (a, s)) -&gt; (s -&gt; n (a, s))\n</code></pre>\n\n<p>Secondly, newtype wrappers make it feasible to write class instances for function types -- without them, for instance, we wouldn't have the crucially important instances that <code>StateT</code> has (<code>Functor</code>, <code>Applicative</code>, <code>Monad</code>, <code>MonadTrans</code>, etc.).</p>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 0, "accepted_answer_id": 49117152, "answer_count": 2, "score": 0, "last_activity_date": 1520276013, "creation_date": 1520274255, "question_id": 49117075, "link": "https://stackoverflow.com/questions/49117075/haskell-function-as-data-type", "title": "Haskell: Function as Data type", "body": "<p>I feel one of the mind hurdles in learning haskell is that <code>data</code> sometimes defines functions as data.</p>\n\n<pre><code>data Person = Person {\n  name :: String,\n  age  :: Int\n}\n</code></pre>\n\n<p>This is intuitive and resembles other languages. But in</p>\n\n<pre><code>newtype StateT s m a = StateT {\n  runStateT :: s -&gt; m (a,s)\n}\n</code></pre>\n\n<p>This is basically calling a function <code>s-&gt;m (a,s)</code> \"data\"</p>\n\n<p>I can readily understand that in higher order functions, \"functions\" are indeed passed around as data. But in type definitions, using functions to define types, that's quite surprising.</p>\n\n<p>So my question is: will this bring expressiveness to Haskell type system? What is the theory behind all this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1520273877, "post_id": 49116843, "comment_id": 85239179, "body": "Closely related: <a href=\"https://stackoverflow.com/q/13915923/2751851\"><i>Combining multiple states in StateT</i></a>; <a href=\"https://stackoverflow.com/q/40523355/2751851\"><i>How do I avoid referring to all state variables when updating only a few?</i></a>; <a href=\"https://stackoverflow.com/q/39813675/2751851\"><i>Simulating interacting stateful objects in Haskell</i></a>; <a href=\"https://stackoverflow.com/q/33935835/2751851\"><i>Mix and match stateful computations within the State monad</i></a>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520359290, "post_id": 49116843, "comment_id": 85279470, "body": "To wrap things up, I closed this as a duplicate. I chose as &quot;official&quot; targets <a href=\"https://stackoverflow.com/questions/40523355/how-do-i-avoid-referring-to-all-state-variables-when-updating-only-a-few\">the one which has the best balance between conciseness and comprehensiveness in the answers</a> and <a href=\"https://stackoverflow.com/questions/39813675/simulating-interacting-stateful-objects-in-haskell\">Davislor&#39;s pick</a>."}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "closed_date": 1520358927, "answer_count": 0, "score": 1, "last_activity_date": 1520358950, "creation_date": 1520273332, "last_edit_date": 1520273672, "question_id": 49116843, "link": "https://stackoverflow.com/questions/49116843/haskell-state-management", "closed_reason": "Duplicate", "title": "Haskell State Management", "body": "<p>Imagine in a game, I have to manage the states of several entities.\nA typical way of managing one state is to:</p>\n\n<pre><code>data WorldState = WorldState {\n  temperature :: Double,\n  season      :: Season\n}\n\n\n\nnewtype App a = App {\n  unApp :: StateT WorldState IO a\n} deriving (Functor, Applicative, Monad, MonadState WorldState, MonadIO)\n</code></pre>\n\n<p>What about when I have to manage several states, ex: I have a character state:</p>\n\n<pre><code>data PersonState = PersonState {\n  name :: String,\n  age  :: Int,\n  clothing :: ClothingStyle\n}\n</code></pre>\n\n<p>Do I have to create a wrapped version with newtype for each state?\nWhat if all those states inter-connect with each other?\nHow can I update one state according to the information of other states?\nFor example, I want to update a person's clothingstyle according to the world status of temperature.</p>\n\n<p>Or should I just create one gigantique state that includes all possible states together?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 406, "user_id": 1738086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44ffd4d27d01bce9b3425f88d83975a3?s=128&d=identicon&r=PG", "display_name": "Simon Courtenage", "link": "https://stackoverflow.com/users/1738086/simon-courtenage"}, "edited": false, "score": 0, "creation_date": 1520271800, "post_id": 49116200, "comment_id": 85238047, "body": "There is also <code>&lt;**&gt; ::  Applicative f =&gt; f a -&gt; f (a -&gt; b) -&gt; f b</code> if that helps"}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 10, "last_activity_date": 1520271891, "creation_date": 1520271891, "answer_id": 49116463, "question_id": 49116200, "link": "https://stackoverflow.com/questions/49116200/wheres-the-equivalent-of-dual-for-applicative/49116463#49116463", "title": "Where&#39;s the equivalent of Dual for Applicative?", "body": "<p>You are looking for <code>Backwards</code>, from <a href=\"https://hackage.haskell.org/package/transformers-0.5.5.0/docs/Control-Applicative-Backwards.html\" rel=\"noreferrer\"><em>transformers</em>' <code>Control.Applicative.Backwards</code></a>:</p>\n\n<pre><code>-- | The same functor, but with an 'Applicative' instance that performs\n-- actions in the reverse order.\nnewtype Backwards f a = Backwards { forwards :: f a }\n\n-- etc.\n\n-- | Apply @f@-actions in the reverse order.\ninstance (Applicative f) =&gt; Applicative (Backwards f) where\n    pure a = Backwards (pure a)\n    {-# INLINE pure #-}\n    Backwards f &lt;*&gt; Backwards a = Backwards (a &lt;**&gt; f)\n    {-# INLINE (&lt;*&gt;) #-}\n</code></pre>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Control-Applicative.html#v:-60--42--42--62-\" rel=\"noreferrer\"><code>(&lt;**&gt;)</code></a>, from <code>Control.Applicative</code>, is, as you'd expect:</p>\n\n<pre><code>-- | A variant of '&lt;*&gt;' with the arguments reversed.\n(&lt;**&gt;) :: Applicative f =&gt; f a -&gt; f (a -&gt; b) -&gt; f b\n(&lt;**&gt;) = liftA2 (\\a f -&gt; f a)\n</code></pre>\n"}], "owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 49116463, "answer_count": 1, "score": 4, "last_activity_date": 1520271891, "creation_date": 1520270887, "question_id": 49116200, "link": "https://stackoverflow.com/questions/49116200/wheres-the-equivalent-of-dual-for-applicative", "title": "Where&#39;s the equivalent of Dual for Applicative?", "body": "<p><a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Monoid.html#t:Dual\" rel=\"nofollow noreferrer\"><code>Dual</code></a> is a newtype-wrapper that just reverses the order of <code>mappend</code> for the wrapped type's <code>Monoid</code> instance:</p>\n\n<pre><code>&gt;&gt;&gt; \"hello\" &lt;&gt; \" \" &lt;&gt; \"world\"\n\"hello world\"\n&gt;&gt;&gt; getDual $ Dual \"hello\" &lt;&gt; Dual \" \" &lt;&gt; Dual \"world\"\n\"world hello\"\n</code></pre>\n\n<p>Equivalently, one could define a newtype-wrapper <code>Swap</code> that reverses the order of <code>&lt;*&gt;</code> for the wrapped type's <code>Applicative</code> instance:</p>\n\n<pre><code>newtype Swap f a = Swap { getSwap :: f a } deriving Functor\ninstance Applicative f =&gt; Applicative (Swap f) where\n  pure = Swap . pure\n  Swap mf &lt;*&gt; Swap ma = Swap $ (\\a f -&gt; f a) &lt;$&gt; ma &lt;*&gt; mf\n\n&gt;&gt;&gt; (\"hello\", replicate) &lt;*&gt; (\" \", 5) &lt;*&gt; (\"world\", ())\n(\"hello world\", [(),(),(),(),()])\n&gt;&gt;&gt; getSwap $ Swap (\"hello\", replicate) &lt;*&gt; Swap (\" \",5) &lt;*&gt; Swap (\"world\", ())\n(\"world hello\", [(),(),(),(),()])\n</code></pre>\n\n<p>I could have sworn there was an equivalent to <code>Swap</code> in <code>base</code>, but I can't seem to find it. Is there an commonly-used equivalent in some other package?</p>\n"}, {"tags": ["haskell", "printing", "gtk2hs"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1520342789, "post_id": 49114750, "comment_id": 85268521, "body": "@PaulJohnson That&#39;s great, and I applaud that action. But in the interest of transparency: I expect if this is a feature you need, it&#39;s going to be up to you to make it happen."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1520266273, "creation_date": 1520266273, "answer_id": 49114750, "question_id": 49113597, "link": "https://stackoverflow.com/questions/49113597/how-do-i-render-a-cairo-drawing-to-a-printer-in-haskell-gtk2hs/49114750#49114750", "title": "How do I render a Cairo drawing to a printer in Haskell gtk2hs", "body": "<p>Hah, whoops, that's embarrassing! It seems the bindings are just a little incomplete in this department.</p>\n\n<p>Luckily it should be pretty easy to update them. Taking a look at the definition of the <code>Render</code> monad:</p>\n\n<pre><code>newtype Render m = Render { runRender :: ReaderT Cairo IO m }\n</code></pre>\n\n<p>We can see that the <code>Cairo</code> object you get from <code>printContextGetCairoContext</code> is just what you need to do something useful with a <code>Render</code> action. The implementation of the <code>renderWith</code> function gives you a clue about what cleanup actions you should take:</p>\n\n<pre><code>renderWith surface (Render m) = liftIO $\n  bracket (Internal.create surface)\n          (\\context -&gt; do status &lt;- Internal.status context\n                          Internal.destroy context\n                          unless (status == StatusSuccess) $\n                            fail =&lt;&lt; Internal.statusToString status)\n          (\\context -&gt; runReaderT m context)\n</code></pre>\n\n<p>I think one of two patches would be sensible here:</p>\n\n<ol>\n<li>Expose a <code>renderWith</code>-alike that consumes a <code>Cairo</code>. Let the user connect up <code>printContextGetCairoContext</code> with the new <code>renderWith</code>-alike.</li>\n<li><p>Don't expose <code>printContextGetCairoContext</code> at all; replace it with</p>\n\n<pre><code>printContextRender :: PrintContextClass self =&gt; self -&gt; Render a -&gt; IO a\n</code></pre>\n\n<p>and have <code>printContextRender</code> merge the call to <code>printContextGetCairoContext</code> with the <code>renderWith</code>-style cleanup.</p></li>\n</ol>\n\n<p>I like option (1) for its clean backwards-compatibility story; but I like (2) a lot better from the API-design side of things. Since this module probably hasn't seen much use for the reasons you're describing, I'd lean towards patch (2).</p>\n\n<p>I'd also note that you may want to look into the gtk documentation a bit to check whether the Cairo context cleanup is somebody else's responsibility (the PrintOperation's, for example).</p>\n\n<p>Happy hacking!</p>\n"}], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 49114750, "answer_count": 1, "score": 1, "last_activity_date": 1520266273, "creation_date": 1520262917, "question_id": 49113597, "link": "https://stackoverflow.com/questions/49113597/how-do-i-render-a-cairo-drawing-to-a-printer-in-haskell-gtk2hs", "title": "How do I render a Cairo drawing to a printer in Haskell gtk2hs", "body": "<p>I'm using the <a href=\"https://hackage.haskell.org/package/gtk-0.14.7\" rel=\"nofollow noreferrer\">GTK3 build of gtk2hs</a>. I have a Cairo drawing in the <a href=\"https://hackage.haskell.org/package/cairo-0.13.4.1/docs/Graphics-Rendering-Cairo.html#t:Render\" rel=\"nofollow noreferrer\"><code>Render</code> monad</a> and I want to send it to a printer.</p>\n\n<p>I see that there is a <code>Surface</code> type which encapsulates the Cairo back end. For example it is possible to create an SVG surface using <a href=\"https://hackage.haskell.org/package/cairo-0.13.4.1/docs/Graphics-Rendering-Cairo.html#g:13\" rel=\"nofollow noreferrer\"><code>withSVGSurface</code></a>, and there are similar functions for PDF, Postscript and PNG. Once you have a <code>Surface</code> you can apply a <code>Render</code> action (i.e. actually draw on it) using <a href=\"https://hackage.haskell.org/package/cairo-0.13.4.1/docs/Graphics-Rendering-Cairo.html#v:renderWith\" rel=\"nofollow noreferrer\"><code>renderWith</code></a>. This is perfectly straightforward, and I can see how to use these functions to export drawings as files.</p>\n\n<p>However printing does not seem to work this way. The <a href=\"https://hackage.haskell.org/package/gtk-0.14.7/docs/Graphics-UI-Gtk-Printing-PrintOperation.html#v:printOptDrawPage\" rel=\"nofollow noreferrer\"><code>printOptDrawPage</code></a> signal provides its callback with a <a href=\"https://hackage.haskell.org/package/gtk-0.14.7/docs/Graphics-UI-Gtk-Printing-PrintContext.html\" rel=\"nofollow noreferrer\"><code>printContext</code></a> value. This has a function <code>printContextGetCairoContext</code> which returns a Cairo <code>Context</code>. However the library documentation doesn't have an entry for this <code>Context</code> type, and I can't find any functions that use it. </p>\n\n<p>It looks like there ought to be <code>printContextGetSurface</code> function, or else a way to convert a <code>Context</code> into a <code>Surface</code>. Am I missing something?</p>\n"}, {"tags": ["haskell", "gadt", "existential-type"], "answers": [{"comments": [{"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1520277616, "post_id": 49112892, "comment_id": 85241106, "body": "I did look at the GADT section as well as the existentially quantified constructor section before asking, but unfortunately not at this one."}], "tags": [], "owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "is_accepted": false, "score": 4, "last_activity_date": 1520260705, "last_edit_date": 1592644375, "creation_date": 1520260705, "answer_id": 49112892, "question_id": 49112756, "link": "https://stackoverflow.com/questions/49112756/is-this-use-of-gadts-fully-equivalent-to-existential-types/49112892#49112892", "title": "Is this use of GADTs fully equivalent to existential types?", "body": "<p>From <a href=\"https://downloads.haskell.org/%7Eghc/latest/docs/html/users_guide/glasgow_exts.html#declaring-data-types-with-explicit-constructor-signatures\" rel=\"nofollow noreferrer\">the documentation</a>:</p>\n<blockquote>\n<p>Notice that GADT-style syntax generalises existential types (Existentially quantified data constructors). For example, these two declarations are equivalent:</p>\n<pre><code>data Foo = forall a. MkFoo a (a -&gt; Bool)\ndata Foo' where { MKFoo :: a -&gt; (a-&gt;Bool) -&gt; Foo' }\n</code></pre>\n</blockquote>\n<p>(emphasis on the word equivalent)</p>\n"}, {"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 4, "last_activity_date": 1520261354, "creation_date": 1520261354, "answer_id": 49113085, "question_id": 49112756, "link": "https://stackoverflow.com/questions/49112756/is-this-use-of-gadts-fully-equivalent-to-existential-types/49113085#49113085", "title": "Is this use of GADTs fully equivalent to existential types?", "body": "<p>The latter isn't actually a GADT - it's an existentially quantified data type declared with GADT syntax. As such, it is identical to the former.</p>\n\n<p>The reason it's not a GADT is that there is no type variable that gets refined based on the choice of constructor. That's the key new functionality added by GADTs.  If you have a GADT like this:</p>\n\n<pre><code>data Foo a where\n    StringFoo :: String -&gt; Foo String\n    IntFoo :: Int -&gt; Foo Int\n</code></pre>\n\n<p>Then pattern-matching on each constructor reveals additional information that can be used inside the matching clause.  For instance:</p>\n\n<pre><code>deconstructFoo :: Foo a -&gt; a\ndeconstructFoo (StringFoo s) = \"Hello! \" ++ s ++ \" is a String!\"\ndeconstructFoo (IntFoo i)    = i * 3 + 1\n</code></pre>\n\n<p>Notice that something very interesting is happening there, from the point of view of the type system.  <code>deconstructFoo</code> promises it will work for <em>any</em> choice of <code>a</code>, as long as it's passed a value of type <code>Foo a</code>. But then the first equation returns a <code>String</code>, and the second equation returns an <code>Int</code>.</p>\n\n<p>This is what you cannot do with a regular data type, and the new thing GADTs provide. In the first equation, the pattern match adds the constraint <code>(a ~ String)</code> to its context.  In the second equation, the pattern match adds <code>(a ~ Int)</code>.</p>\n\n<p>If you haven't created a type where pattern-matching can cause type refinement, you don't have a GADT.  You just have a type declared with GADT syntax.  Which is fine - in a lot of ways, it's a better syntax than the basic data type syntax. It's just more verbose for the easiest cases.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 9, "last_activity_date": 1520265396, "last_edit_date": 1520265396, "creation_date": 1520261733, "answer_id": 49113206, "question_id": 49112756, "link": "https://stackoverflow.com/questions/49112756/is-this-use-of-gadts-fully-equivalent-to-existential-types/49113206#49113206", "title": "Is this use of GADTs fully equivalent to existential types?", "body": "<p>They are nearly equivalent, albeit not completely so, depending on which extensions you turn on.</p>\n\n<p>First of all, note that you don't need to enable the <code>GADTs</code> extension to use the <code>data .. where</code> syntax for existential types. It suffices to enable the following lesser extensions.</p>\n\n<pre><code>{-# LANGUAGE GADTSyntax #-}\n{-# LANGUAGE ExistentialQuantification #-}\n</code></pre>\n\n<p>With these extensions, you can compile</p>\n\n<pre><code>data U where\n    U :: a -&gt; (a -&gt; String) -&gt; U\n\nfoo :: U -&gt; String\nfoo (U x f) = f x\n\ng x = let h y = const y x\n      in  (h True, h 'a')\n</code></pre>\n\n<p>The above code also compiles if we replace the extensions and the type definition with</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\ndata U = forall a . U a (a -&gt; String)\n</code></pre>\n\n<p>The above code, however, does <em>not</em> compile with the <code>GADTs</code> extension turned on! This is because <code>GADTs</code> also turns on the <code>MonoLocalBinds</code> extension, which prevents the above definition of <code>g</code> to compile. This is because the latter extension prevents <code>h</code> to receive a polymorphic type.</p>\n"}], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "accepted_answer_id": 49113206, "answer_count": 3, "score": 4, "last_activity_date": 1520265396, "creation_date": 1520260287, "question_id": 49112756, "link": "https://stackoverflow.com/questions/49112756/is-this-use-of-gadts-fully-equivalent-to-existential-types", "title": "Is this use of GADTs fully equivalent to existential types?", "body": "<p><a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#existentially-quantified-data-constructors\" rel=\"nofollow noreferrer\">Existentially quantified data constructors</a> like</p>\n\n<pre><code>data Foo = forall a. MkFoo a (a -&gt; Bool)\n         | Nil\n</code></pre>\n\n<p>can be easily translated to GADTs:</p>\n\n<pre><code>data Foo where \n    MkFoo :: a -&gt; (a -&gt; Bool) -&gt; Foo\n    Nil :: Foo\n</code></pre>\n\n<p>Are there any differences between them: code which compiles with one but not another, or gives different results?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 406, "user_id": 1738086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44ffd4d27d01bce9b3425f88d83975a3?s=128&d=identicon&r=PG", "display_name": "Simon Courtenage", "link": "https://stackoverflow.com/users/1738086/simon-courtenage"}, "edited": false, "score": 3, "creation_date": 1520252454, "post_id": 49110398, "comment_id": 85225739, "body": "or just checkString a b = take 3 a == take 3 b"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1520252500, "post_id": 49110398, "comment_id": 85225770, "body": "There is no reason to write <code>if &lt;expr&gt; then True else False</code>, you can rewrite it to <code>&lt;expr&gt;</code>."}], "tags": [], "owner": {"reputation": 33, "user_id": 8856672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ccc80fa8e0a32743c2b0e176a455521?s=128&d=identicon&r=PG&f=1", "display_name": "A Loakes", "link": "https://stackoverflow.com/users/8856672/a-loakes"}, "is_accepted": false, "score": 2, "last_activity_date": 1520252423, "creation_date": 1520252423, "answer_id": 49110398, "question_id": 49110197, "link": "https://stackoverflow.com/questions/49110197/haskell-take-3-form-a-and-b-return-true-if-match-false-if-no-match-haskell/49110398#49110398", "title": "Haskell take 3 form a and b, return True if match, False if no match, haskell", "body": "<p>That was easier than I thought</p>\n\n<pre><code>checktring :: String -&gt; String -&gt; Bool\ncheckstring a b = if take 3 a == take 3 b then True\n                else False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1520257317, "creation_date": 1520257317, "answer_id": 49111821, "question_id": 49110197, "link": "https://stackoverflow.com/questions/49110197/haskell-take-3-form-a-and-b-return-true-if-match-false-if-no-match-haskell/49111821#49111821", "title": "Haskell take 3 form a and b, return True if match, False if no match, haskell", "body": "<p>You can write it as:</p>\n\n<pre><code>import Data.Function(on)\n\ncheckstring :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\ncheckstring = on (==) (take 3)\n</code></pre>\n\n<p>Here we make use of the <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Function.html#v:on\" rel=\"nofollow noreferrer\"><strong><code>on :: (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c</code></strong></a> function. This function takes input a function <code>b -&gt; b -&gt; c</code> (here <code>(==)</code>) and a function <code>a -&gt; b</code> (here <code>take 3</code>).</p>\n\n<p>The function we then produce takes two values (both <code>a</code>s). It applies the second function to both of the values, and then it calls the first function with the results of the two function calls.</p>\n\n<p>So <code>on</code> is defined as:</p>\n\n<pre><code>on :: (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c\non f g x y = f (g x) (g y)\n</code></pre>\n\n<p>Note that the <code>checkstring</code> function is more generic than only processing <code>String</code>s: it can process any type of list <code>[a]</code> as long as <code>Eq a</code> holds.</p>\n\n<p>I would advice you to rename the function to something that better describes what it does. For example <code>samefirst3</code>:</p>\n\n<pre><code>import Data.Function(on)\n\nsamefirst3 :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\nsamefirst3 = on (==) (take 3)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8856672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ccc80fa8e0a32743c2b0e176a455521?s=128&d=identicon&r=PG&f=1", "display_name": "A Loakes", "link": "https://stackoverflow.com/users/8856672/a-loakes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1520257949, "creation_date": 1520251750, "last_edit_date": 1520257949, "question_id": 49110197, "link": "https://stackoverflow.com/questions/49110197/haskell-take-3-form-a-and-b-return-true-if-match-false-if-no-match-haskell", "title": "Haskell take 3 form a and b, return True if match, False if no match, haskell", "body": "<p>Here is where I've got up to, I can't figure out how to use <code>take 3</code> to take the first 3 characters in a and b before comparing them.</p>\n\n<pre><code>   checkstring :: String -&gt; String -&gt; Bool\n   checkstring a b = if a == b then True\n                     else False\n</code></pre>\n"}, {"tags": ["haskell", "list-comprehension", "take"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1520251763, "post_id": 49110195, "comment_id": 85225280, "body": "Why would you use list comprehension for this? Yes it is strictly speaking possible, but it is rather inelegant to do so here."}, {"owner": {"reputation": 41, "user_id": 7773522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15d0a2851773674f8ba30e9cbe2368b?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/7773522/michi"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1520251849, "post_id": 49110195, "comment_id": 85225331, "body": "for practice and curiosity :)"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 7, "last_activity_date": 1520258656, "last_edit_date": 1520258656, "creation_date": 1520252278, "answer_id": 49110352, "question_id": 49110195, "link": "https://stackoverflow.com/questions/49110195/implement-the-take-function-with-list-comprehension/49110352#49110352", "title": "Implement the take function with list comprehension", "body": "<p>We can use a <code>zip</code> approach here, and enumerate over both the elements, and indices, like:</p>\n\n<pre><code>take2 :: (Num i, Enum i) =&gt; i -&gt; [a] -&gt; [a]\ntake2 n xs = [x | (x, _) &lt;- zip xs [1..n]]\n</code></pre>\n\n<p>Or with the <code>ParallelListComp</code> extension:</p>\n\n<pre><code>{-# LANGUAGE ParallelListComp #-}\n\ntake2 :: (Num i, Enum i) =&gt; i -&gt; [a] -&gt; [a]\ntake2 n xs = [x | x &lt;- xs | _ &lt;- [1..n]]\n</code></pre>\n\n<p>But actually <code>take</code> is probably not a function that is a good fit for list comprehension in the first place.</p>\n"}, {"tags": [], "owner": {"reputation": 9895, "user_id": 452775, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/88963e7cc58eabf150447e7b78a24793?s=128&d=identicon&r=PG", "display_name": "Lii", "link": "https://stackoverflow.com/users/452775/lii"}, "is_accepted": true, "score": 8, "last_activity_date": 1520427557, "last_edit_date": 1520427557, "creation_date": 1520253036, "answer_id": 49110572, "question_id": 49110195, "link": "https://stackoverflow.com/questions/49110195/implement-the-take-function-with-list-comprehension/49110572#49110572", "title": "Implement the take function with list comprehension", "body": "<p>The fundamental reason why list comprehensions are not a good fit for the <code>take</code> function is this:</p>\n\n<p>The <code>take</code> function <strong>stops the evaluation</strong> of the argument list after <code>n</code> elements.</p>\n\n<p>But lists comprehensions <strong>always evaluate all elements</strong> of the list in the generator. There is no break-statement in Haskell.</p>\n\n<hr>\n\n<p>You can use some trick to truncate the list before or after using it in the list comprehension, but there is no real point of doing so. That would be similar to first using normal <code>take</code> to truncate the list, then using a list comprehension just to return the result.</p>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 5296639, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52fd1c4f39c933f36852098165bcb37d?s=128&d=identicon&r=PG&f=1", "display_name": "Damilare", "link": "https://stackoverflow.com/users/5296639/damilare"}, "is_accepted": false, "score": 0, "last_activity_date": 1568158443, "creation_date": 1568158443, "answer_id": 57879350, "question_id": 49110195, "link": "https://stackoverflow.com/questions/49110195/implement-the-take-function-with-list-comprehension/57879350#57879350", "title": "Implement the take function with list comprehension", "body": "<p>Without List Comprehension</p>\n\n<pre><code>take' :: Int -&gt; [Int] -&gt; [Int]\ntake' _ [] = []\ntake' _ [x] = [x]\ntake' n all@(x : xs)\n        | (n &gt; length all) = error \"Index too large\"\n        | (n == length all) = all\n        | (n == 0) = []\n        | (n &lt; length all) =  x : [] ++ (take' (n-1) xs)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2691, "user_id": 3115822, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/djEOC.png?s=128&g=1", "display_name": "borchvm", "link": "https://stackoverflow.com/users/3115822/borchvm"}, "edited": false, "score": 1, "creation_date": 1580453994, "post_id": 59997806, "comment_id": 106109833, "body": "Code-only answers are considered low quality: make sure to provide an explanation what your code does and how it solves the problem. It will help the asker and future readers both if you can add more information in your post. See also Explaining entirely code-based answers: <a href=\"https://meta.stackexchange.com/questions/114762/explaining-entirely-code-based-answers\" title=\"explaining entirely code based answers\">meta.stackexchange.com/questions/114762/&hellip;</a>"}], "tags": [], "owner": {"reputation": 11, "user_id": 11506525, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1D_B2HjcbNA/AAAAAAAAAAI/AAAAAAAAAX8/dnB5tzdZ6GI/photo.jpg?sz=128", "display_name": "Javier Enr&#237;quez Mendoza", "link": "https://stackoverflow.com/users/11506525/javier-enr%c3%adquez-mendoza"}, "is_accepted": false, "score": 0, "last_activity_date": 1580444484, "creation_date": 1580444484, "answer_id": 59997806, "question_id": 49110195, "link": "https://stackoverflow.com/questions/49110195/implement-the-take-function-with-list-comprehension/59997806#59997806", "title": "Implement the take function with list comprehension", "body": "<pre><code>take' :: Int -&gt; [a] -&gt; [a]\ntake' n xs = [xs !! i | i &lt;- [0..n-1]]\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7773522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15d0a2851773674f8ba30e9cbe2368b?s=128&d=identicon&r=PG&f=1", "display_name": "Michi", "link": "https://stackoverflow.com/users/7773522/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1042, "favorite_count": 0, "accepted_answer_id": 49110572, "answer_count": 4, "score": 2, "last_activity_date": 1580444484, "creation_date": 1520251735, "last_edit_date": 1520427504, "question_id": 49110195, "link": "https://stackoverflow.com/questions/49110195/implement-the-take-function-with-list-comprehension", "title": "Implement the take function with list comprehension", "body": "<p>How would you implement <code>take</code> with a list comprehension?</p>\n\n<p>My approach so far:</p>\n\n<pre><code>take2 :: (Num i, Ord i) =&gt; i -&gt; [a] -&gt; [a]\ntake2 n xs = [x | x &lt;- xs, [x..n]]\n</code></pre>\n"}, {"tags": ["csv", "haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "is_accepted": true, "score": 3, "last_activity_date": 1520245361, "creation_date": 1520245361, "answer_id": 49108177, "question_id": 49107446, "link": "https://stackoverflow.com/questions/49107446/haskell-type-mismatch-with-csv-parsing/49108177#49108177", "title": "Haskell type mismatch with csv parsing", "body": "<p><code>decode</code> has the type <code>FromRecord a =&gt; HasHeader -&gt; ByteString-&gt; Either String (Vector a)</code> based on the <a href=\"https://hackage.haskell.org/package/cassava-0.5.1.0/docs/Data-Csv.html#v:decode\" rel=\"nofollow noreferrer\">documentation</a> for cassava.<br>\nSo the correct pattern would be <code>Right v</code> instead of <code>Right (_, v)</code>.  </p>\n\n<p>Another problem in the code, is that <code>length</code> is a function, and you didn't apply it to anything, in the guard <code>| length == 2 = ...</code>. I believe the correct code should instead be <code>| length r == 2 = ...</code>  </p>\n\n<p>Here's the complete code after those changes:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Applicative\nimport qualified Data.ByteString.Lazy as BL\nimport Data.Csv\nimport qualified Data.Vector as V\nimport Control.Monad (mzero)\n\ndata Demand = Demand\n    { name     :: !String\n    , amount   :: !Int\n    } deriving Show\n\ninstance FromRecord Demand where\n    parseRecord r \n         | length r == 2 = Demand &lt;$&gt; r .! 0\n                                &lt;*&gt; r .! 1\n         | otherwise = mzero\n\nmain :: IO ()\nmain = do\n    csvData &lt;- BL.readFile \"demand.csv\"\n    case decode HasHeader csvData of\n        Left err -&gt; putStrLn err\n        Right v -&gt; V.forM_ v $ \\ p -&gt;\n            putStrLn $ (name p) ++ \" amount \" ++ show (amount p)\n</code></pre>\n"}], "owner": {"reputation": 919, "user_id": 1819186, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/71b04413070a897f1c5c7055ae281f02?s=128&d=identicon&r=PG", "display_name": "Anthony W", "link": "https://stackoverflow.com/users/1819186/anthony-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "accepted_answer_id": 49108177, "answer_count": 1, "score": 0, "last_activity_date": 1520245361, "creation_date": 1520243254, "question_id": 49107446, "link": "https://stackoverflow.com/questions/49107446/haskell-type-mismatch-with-csv-parsing", "title": "Haskell type mismatch with csv parsing", "body": "<p>I'm trying to parse a csv file where I want to ignore the first line and the last line, as in:</p>\n\n<pre><code>Someheader\nfoo, 1000,\nbah, 2000,\nsomefooter\n</code></pre>\n\n<p>I wrote some Haskell using the cassava library:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Control.Applicative\nimport qualified Data.ByteString.Lazy as BL\nimport Data.Csv\nimport qualified Data.Vector as V\nimport Control.Monad (mzero)\n\ndata Demand = Demand\n    { name     :: !String\n    , amount   :: !Int\n    } deriving Show\n\ninstance FromRecord Demand where\n    parseRecord r \n         | length == 2 = Demand &lt;$&gt; r .! 0\n                                &lt;*&gt; r .! 1\n         | otherwise = mzero\n\nmain :: IO ()\nmain = do\n    csvData &lt;- BL.readFile \"demand.csv\"\n    case decode HasHeader csvData of\n        Left err -&gt; putStrLn err\n        Right (_, v) -&gt; V.forM_ v $ \\ p -&gt;\n            putStrLn $ (name p) ++ \" amount \" ++ show (amount p)\n</code></pre>\n\n<p>When I run this get a type mismatch, that I can't figure out:</p>\n\n<pre><code>parser.hs:34:15: error:\n    \u2022 Couldn't match expected type \u2018V.Vector a2\u2019\n                  with actual type \u2018(a1, V.Vector Demand)\u2019\n    \u2022 In the pattern: (_, v)\n      In the pattern: Right (_, v)\n</code></pre>\n\n<p>My guess is that I haven't unpacked the Vector in the record correctly? Any help, gratefully received. </p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1520247486, "post_id": 49107224, "comment_id": 85222558, "body": "Company proxy would indeed be one of the first things I suspect - I suppose it&#39;s also possible stackage was down when you tried this though. In any case, this seems more like a networking issue rather than a programming problem?"}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1520251645, "post_id": 49107224, "comment_id": 85225207, "body": "Well i thought that it has to do with the package manager,but thinking about it now it seems it is a networking issue."}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520263513, "creation_date": 1520242515, "last_edit_date": 1520263513, "question_id": 49107224, "link": "https://stackoverflow.com/questions/49107224/error-when-trying-to-download-haskell-project-template", "title": "Error when trying to download haskell project template", "body": "<p>I am trying to create a new haskell project with visual studio code  using the \"simple \" template and the template project is not downloaded and i get an error message.</p>\n\n<p>So i run the following command:</p>\n\n<pre><code>$ stack new **fs** simple\n</code></pre>\n\n<p>And i get the following response:</p>\n\n<pre><code>?[0mDownloading template \"simple\" to create project \"fs\" in fs\\ ...?[0m\n?[0m\n?[93mWarning:?[0m Retry number 0 after a total delay of 0 us\n         If you see this warning and stack fails to download, but running the command again solves\n         the problem, please report here: https://github.com/commercialhaskell/stack/issues/3510?[0m\n?[0m\n?[93mWarning:?[0m Retry number 1 after a total delay of 100000 us\n         If you see this warning and stack fails to download, but running the command again solves\n         the problem, please report here: https://github.com/commercialhaskell/stack/issues/3510?[0m\n?[0m\n?[93mWarning:?[0m Retry number 2 after a total delay of 200000 us\n         If you see this warning and stack fails to download, but running the command again solves\n         the problem, please report here: https://github.com/commercialhaskell/stack/issues/3510?[0m\n?[0m\n?[93mWarning:?[0m Retry number 3 after a total delay of 300000 us\n         If you see this warning and stack fails to download, but running the command again solves\n         the problem, please report here: https://github.com/commercialhaskell/stack/issues/3510?[0m\nHttpExceptionRequest Request {\n  host                 = \"raw.githubusercontent.com\"\n  port                 = 443\n  secure               = True\n  requestHeaders       = []\n  path                 = \"/commercialhaskell/stack-templates/master/simple.hsfiles\"\n  queryString          = \"\"\n  method               = \"GET\"\n  proxy                = Nothing\n  rawBody              = False\n  redirectCount        = 10\n  responseTimeout      = ResponseTimeoutDefault\n  requestVersion       = HTTP/1.1\n}\n (ConnectionFailure Network.Socket.sendBuf: does not exist (No such file or directory))\n</code></pre>\n\n<p>Could there be a problem since I am running through company proxy?</p>\n"}, {"tags": ["haskell", "ghc", "ghc-mod"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1520254495, "post_id": 49104079, "comment_id": 85226959, "body": "Have you tried all of the potential ways to resolve this? If so, what was the result?"}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1520262061, "post_id": 49104079, "comment_id": 85231534, "body": "I think it&#39;s because ghc-mod doesn&#39;t support 8.2.1 yet. Here is the issue <a href=\"https://github.com/DanielG/ghc-mod/issues/900\" rel=\"nofollow noreferrer\">github.com/DanielG/ghc-mod/issues/900</a>"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 849, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1520228273, "creation_date": 1520228273, "question_id": 49104079, "link": "https://stackoverflow.com/questions/49104079/cannot-install-ghc-mod-locally", "title": "cannot install ghc-mod locally", "body": "<p>I have ghc 8.2.1 installed on my MacOS. But my global <code>ghc-mod</code> is still using 8.0.2, as I recently upgrade ghc to 8.2.1. I wanted to upgrade <code>ghc-mod</code>. I tried the following command, it returned errors as below:</p>\n\n<pre><code>\u25b8 ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 8.2.1\n\n\u25b8 ghc-mod --version\nghc-mod version 5.7.0.0 compiled by GHC 8.0.2\n\n\u25b8 stack build --copy-compiler-tool ghc-mod hoogle weeder\n\nError: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for ghc-mod-5.8.0.0:\n    Cabal-2.0.1.1 from stack configuration does not match &gt;=1.18 &amp;&amp; &lt;1.25 (latest matching version is 1.24.2.0)\n    base-4.10.1.0 from stack configuration does not match &gt;=4.6.0.1 &amp;&amp; &lt;4.10 (latest matching version is 4.9.1.0)\n    cabal-helper must match &lt;0.8 &amp;&amp; &gt;=0.7.3.0, but the stack configuration has no specified version (latest matching version is 0.7.3.0)\n    extra-1.6.2 from stack configuration does not match &lt;1.6 &amp;&amp; &gt;=1.4 (latest matching version is 1.5.3)\n    ghc-8.2.2 from stack configuration does not match &gt;=7.6 &amp;&amp; &lt;8.2\n    monad-journal-0.8.1 from stack configuration does not match &lt;0.8 &amp;&amp; &gt;=0.4 (latest matching version is 0.7.2)\n    optparse-applicative-0.14.0.0 from stack configuration does not match &gt;=0.13.0.0 &amp;&amp; &lt;0.14 (latest matching version is 0.13.2.0)\nneeded since ghc-mod is a build target.\n\nSome potential ways to resolve this:\n\n  * Recommended action: try adding the following to your extra-deps in /Users/leo/zhangchiqing/hello/stack.yaml:\n\n- Cabal-1.24.2.0\n- base-4.9.1.0\n- cabal-helper-0.7.3.0\n- extra-1.5.3\n- monad-journal-0.7.2\n- optparse-applicative-0.13.2.0\n\n  * Set 'allow-newer: true' to ignore all version constraints and build anyway.\n\n  * You may also want to try using the 'stack solver' command.\n\nPlan construction failed.\n</code></pre>\n"}, {"tags": ["haskell", "alex"], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 2, "last_activity_date": 1520228730, "creation_date": 1520228730, "answer_id": 49104166, "question_id": 49103694, "link": "https://stackoverflow.com/questions/49103694/how-do-you-install-alex-on-haskell-platform/49104166#49104166", "title": "How do you install Alex on Haskell Platform?", "body": "<p><code>alex</code> is an executable program, to be run from command line, not a library to be invoked from GHCi.</p>\n\n<p>To run <code>alex</code> via <code>stack</code> (which is what you have installed), type:</p>\n\n<pre><code>stack exec alex H.x\n</code></pre>\n\n<p>(assuming you actually have a file named <code>H.x</code> lying around)</p>\n\n<p>The first time you run it like this, <code>stack</code> will build <code>alex</code>, which will take a few minutes. This will happen one time only, subsequent runs will be quick.</p>\n\n<p>If you want to run <code>alex</code> without <code>stack</code>, you can ask <code>stack</code> to put <code>alex</code> on your <code>PATH</code>. To do that, type:</p>\n\n<pre><code>stack install alex\n</code></pre>\n\n<p>After that, you can execute <code>alex</code> without prepending <code>stack exec</code> every time:</p>\n\n<pre><code>alex H.x\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 4397162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44a2f7aea6a0ee61359f985e5171c58e?s=128&d=identicon&r=PG&f=1", "display_name": "johnsmith", "link": "https://stackoverflow.com/users/4397162/johnsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1520228730, "creation_date": 1520225779, "question_id": 49103694, "link": "https://stackoverflow.com/questions/49103694/how-do-you-install-alex-on-haskell-platform", "title": "How do you install Alex on Haskell Platform?", "body": "<p>I have Haskell Platform 8.2.2 installed on Windows. When I run <code>ghci</code> and type <code>alex H.x</code> after <code>Prelude&gt;</code>, I get</p>\n\n<pre><code>&lt;interactive&gt;:3:6: error:\n    Not in scope: `H.x'\n    No module named `H' is imported.\n</code></pre>\n\n<p>When I type just <code>alex</code>, I get</p>\n\n<pre><code>&lt;interactive&gt;:6:1: error:\n    * Variable not in scope: alex\n    * Perhaps you meant `lex' (imported from Prelude).\n</code></pre>\n\n<p>I looked in <code>Haskell Platform\\8.2.2\\lib</code> and I can see a folder called <code>Cabal-2.0.1.0</code> but nothing for <code>alex</code>.</p>\n\n<p>How do I get Alex installed?</p>\n"}, {"tags": ["haskell", "functional-programming", "functor"], "answers": [{"comments": [{"owner": {"reputation": 3483, "user_id": 62029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/678af400241c37d1492f8e2e992f1d73?s=128&d=identicon&r=PG", "display_name": "AgentLiquid", "link": "https://stackoverflow.com/users/62029/agentliquid"}, "edited": false, "score": 0, "creation_date": 1520223991, "post_id": 49103432, "comment_id": 85212053, "body": "Excellent, thank you. As a noob, how would I have known that the function instance of Functor defines fmap as (.) ? Doing &quot;:i Functor&quot; gives a subtle hint - instance Functor ((-&gt;) r) -- Defined in \u2018GHC.Base\u2019 , but that&#39;s not really enough."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3483, "user_id": 62029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/678af400241c37d1492f8e2e992f1d73?s=128&d=identicon&r=PG", "display_name": "AgentLiquid", "link": "https://stackoverflow.com/users/62029/agentliquid"}, "edited": false, "score": 2, "creation_date": 1520224655, "post_id": 49103432, "comment_id": 85212211, "body": "@AgentLiquid The <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#t:Functor\" rel=\"nofollow noreferrer\">documentation for <code>Functor</code></a> includes a list of instances; click &quot;Source&quot; next to the <code>-&gt;</code> instance in that list."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3483, "user_id": 62029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/678af400241c37d1492f8e2e992f1d73?s=128&d=identicon&r=PG", "display_name": "AgentLiquid", "link": "https://stackoverflow.com/users/62029/agentliquid"}, "edited": false, "score": 0, "creation_date": 1520242797, "post_id": 49103432, "comment_id": 85219530, "body": "@AgentLiquid If <code>fmap length Just</code> type checks, this means that <code>Just</code> is seen as a value in some functor so <code>Just :: f a</code> for some functor <code>f</code> and type <code>a</code>. Since <code>Just</code> is a function, the functor must be <code>(-&gt;) b</code> for some <code>b</code>, and <code>a</code> must be <code>Maybe b</code>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 12, "last_activity_date": 1520223574, "creation_date": 1520223574, "answer_id": 49103432, "question_id": 49103372, "link": "https://stackoverflow.com/questions/49103372/confused-about-fmap-length-just-1-1-1-1-vs-fmap-length-just-1-1-1-1/49103432#49103432", "title": "Confused about (fmap length Just) [1,1,1,1] vs. fmap length $ Just [1,1,1,1]", "body": "<p>In the first case, you are getting the function instance of <code>Functor</code>, for which <code>fmap = (.)</code>, so:</p>\n\n<pre><code>fmap length Just [1,2,3]\n=\n(length . Just) [1,2,3]\n=\nlength (Just [1,2,3])\n</code></pre>\n\n<p>The <code>Foldable</code> instance for <code>Maybe</code> says that <code>Nothing</code>s have a length of <code>0</code> and <code>Just</code>s have a length of <code>1</code> -- which is quite sensible if you think of <code>Maybe a</code> as a bit like a collection of <code>a</code>s that has at most one <code>a</code> in it.</p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 8311124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/288a957cbd8141a33d2d27cd730903d9?s=128&d=identicon&r=PG", "display_name": "Naveen", "link": "https://stackoverflow.com/users/8311124/naveen"}, "is_accepted": false, "score": 0, "last_activity_date": 1596955605, "creation_date": 1596955605, "answer_id": 63323304, "question_id": 49103372, "link": "https://stackoverflow.com/questions/49103372/confused-about-fmap-length-just-1-1-1-1-vs-fmap-length-just-1-1-1-1/63323304#63323304", "title": "Confused about (fmap length Just) [1,1,1,1] vs. fmap length $ Just [1,1,1,1]", "body": "<hr />\nTL;DR\n<ol>\n<li><code>fmap</code> can only be applied to two arguments, so first let's focus mostly on <code>fmap length Just</code></li>\n<li>The <code>fmap</code> instance on function is <code>(.)</code> <em>i.e a function composition</em>, so the expression basically is <code>(length . Just) [1,2,3]</code></li>\n<li>The above expression is equivalent to <code>length (Just [1,2,3])</code></li>\n<li>Note that we are applying <code>length</code> to a <code>Maybe</code> value, which depends on the <code>Foldable</code> instance of Maybe. <code>Foldable</code> is a typeclass on type constructors, not types (just like <code>Functor</code>), so instances don't have different behaviour according to the type of the argument that type constructor take (i.e the <code>a</code> in <code>Maybe a</code>). The the list <code>[1, 2, 3]</code> is just a distraction since lenght can only consult the outermost layerm so the expression is same as <code>length (Just ())</code>.</li>\n<li>A <code>Maybe</code> value can only ever contain 0 or 1 values, and <code>Just</code> contains 1. So the answer is <code>1</code>.</li>\n</ol>\n<hr />\n<p>Adding to what Daniel said, I would like to explain a little bit in detail as to how we come across this.</p>\n<p>The given expression is <code>fmap length Just [1,2,3]</code> which can be further written as <code>((fmap length) Just) [1,2,3]</code></p>\n<p>Let us see the type definition of all the three functions that we have</p>\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; :t fmap\n fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n\n&gt; :t length\n length :: Foldable t =&gt; t a -&gt; Int\n\n&gt; :t Just\n Just :: a -&gt; Maybe a\n</code></pre>\n<p>Now let's substitute the type into <code>fmap</code> and see what we get.</p>\n<pre class=\"lang-hs prettyprint-override\"><code>fmap :: (a    -&gt;  b) -&gt;  f a      -&gt; f b\n         t a     Int -&gt;  f (t a)  -&gt; f Int\n</code></pre>\n<p>Confirming this with ghci</p>\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; :t fmap length\nfmap length :: (Functor f, Foldable t) =&gt; f (t a) -&gt; f Int\n</code></pre>\n<p>It is safe to say that <code>Functions</code> are also <code>Functors</code> (<em>More on this later</em>).</p>\n<p>That means we can say that  <code>f</code> above is <code> -&gt; a</code> and <code>(t a)</code> is <code>Maybe a</code> this is okay, because <code>Maybe</code> has a foldable instance define. i.e\n<code> f (t a)</code> can be written as <code> (-&gt; a) (Maybe a)</code>  which can be written as  <code> a -&gt; Maybe a</code> which is the type of <code>Just</code>.</p>\n<p>Similiary <code>f Int</code> can be written as  <code> (-&gt; a) Int</code> which is similar to <code> a -&gt; Int</code></p>\n<p>Hence the type definition for <code>fmap lenght Just</code> is</p>\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; :t fmap length Just\nfmap length Just :: a -&gt; Int\n</code></pre>\n<p>But that did not exactly clear my confusion,  Now I know that we get an <code>Int</code> with this, but why?? Something is worrying me hear. Lookin at the types above, The only way this would have been possible was if somehow the value from Just got fed into the length.</p>\n<p>Okieee! Feeding data into another function reminds me of soemthing. Ahahh! It's something like <code>Function composition</code>, I mean if we have something like:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>fmap length Just [1,2,3] == (length . Just) [1,2,3] == (length (Just [1,2,3])\n</code></pre>\n<p>That might explain this. But why are we composing the functions here. Something's not fitting the bill here.</p>\n<p>It looks as if fmap for two functions is equivalent to the composition of them. Is that even possible?</p>\n<hr />\n<p>Let's go-ahead and clear up this doubt. There are two questions we need to ask ourselves:</p>\n<ol>\n<li>Can Function be an instance of Functor?</li>\n<li>If functions are an instance of Functor what is their fmap implementation?</li>\n</ol>\n<hr />\n<ol>\n<li>Can Function be an instance of Functor?</li>\n</ol>\n<p>A little digging later, I found that yes - Function can be an instance of functor. Any function can be written as <code> a -&gt; b</code>, which can be further written as  <code> (-&gt;) a b</code>,  because <code>-&gt;</code> is nothing but a type constructor which takes in two arguments.</p>\n<p>Now we know that <code>Functors</code> can accepts types which have the kind  <code>* -&gt; *</code>, but <code>(-&gt;)</code>  has a kind of <code>* -&gt; * -&gt; *</code> which we cannot use, but.. What about <code> (-&gt;) a</code> it has a kind of  <code>* -&gt; *</code>, we can use this to make an instance of Functor.</p>\n<hr />\n<ol start=\"2\">\n<li>If functions are an instance of Functor what is their fmap implementation?</li>\n</ol>\n<p>Now that we know that functions can be an instance of Functor, it's time for their implementation. Digging <a href=\"https://hackage.haskell.org/package/base-4.14.0.0/docs/src/GHC.Base.html#line-969\" rel=\"nofollow noreferrer\">into the source</a>, I indeed found an functor instance for <code>(-&gt;)</code></p>\n<pre class=\"lang-hs prettyprint-override\"><code>instance  Functor ((-&gt;) r) where\n    fmap = (.)\n</code></pre>\n<p>Let's see how we came to that implementation:</p>\n<p>The type of <code>fmap</code> is:</p>\n<pre><code>fmap :: (a  -&gt;  b) -&gt;  f a -&gt; f b\n</code></pre>\n<p>Substituting <code>(-&gt;) a</code> for <code>f</code> since, functions can also be a functor:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>fmap :: (a  -&gt;  b) -&gt;  f a          -&gt; f b\n                       ( (-&gt;) r a)  -&gt; f ( (-&gt;) r b) \n</code></pre>\n<p>which can  be simplified as:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>fmap :: (a  -&gt;  b) -&gt;  f a        -&gt; f b\n                      ( r -&gt; a)  -&gt; ( r -&gt; b) \n</code></pre>\n<p>So the final type definiton of fmap with a function as functor is:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>fmap :: (a  -&gt;  b) -&gt; ( r -&gt; a) -&gt; (r -&gt; b)\n</code></pre>\n<p>Ahah! If we look closely, what we see is that , it looks exactly like the type of  <code> function composition (.)</code> , where the output from <code>r -&gt; a</code> is fed as the input to the first argument <code>a -&gt; b</code> which gives us the results <code>(r -&gt; b)</code></p>\n<p>That mean, we can safely say that</p>\n<pre class=\"lang-hs prettyprint-override\"><code>instance  Functor ((-&gt;) r) where\n    fmap = (.)\n</code></pre>\n<hr />\n<p>Thus this proves the point, that when we have fmap over the function as a functor, the instance of fmap is function composition.</p>\n<p>Looking back at our question:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>((fmap length) Just) [1,2,3]\n</code></pre>\n<p>This can be seen as:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>fmap length Just [1,2,3] == (length . Just) [1,2,3] == (length (Just [1,2,3])\n</code></pre>\n<p>The answer of:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; (length (Just [1,2,3]) == 1\n</code></pre>\n<p>A Maybe can ever contain two values <code>0</code> and <code>1</code>, and since <code>Just</code> contains something, we get <code>Just a</code> as <code>1</code></p>\n"}], "owner": {"reputation": 3483, "user_id": 62029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/678af400241c37d1492f8e2e992f1d73?s=128&d=identicon&r=PG", "display_name": "AgentLiquid", "link": "https://stackoverflow.com/users/62029/agentliquid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 49103432, "answer_count": 2, "score": 5, "last_activity_date": 1596955605, "creation_date": 1520223071, "question_id": 49103372, "link": "https://stackoverflow.com/questions/49103372/confused-about-fmap-length-just-1-1-1-1-vs-fmap-length-just-1-1-1-1", "title": "Confused about (fmap length Just) [1,1,1,1] vs. fmap length $ Just [1,1,1,1]", "body": "<p>I understand that the parens force a different order of operations, but I don't quite understand the first result:</p>\n\n<pre><code>&gt;&gt; (fmap length Just) [1, 2, 3]\n1\n</code></pre>\n\n<p>Whereas the following makes perfect sense - we are lifting the length function over the Just structure, so we should get \"Just [length of list]\":</p>\n\n<pre><code>&gt;&gt; fmap length $ Just [1, 2, 3]\nJust 3\n</code></pre>\n\n<p>What's going on in the first case?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 4, "creation_date": 1520217739, "post_id": 49102496, "comment_id": 85210661, "body": "FYI: There is never a good reason to use \u201c(== [])\u201d. Never. Always pattern match on \u201c[]\u201d directly or use \u201cnull\u201d if you actually need a \u201cBool\u201d. \u201c(==)\u201d induces an \u201cEq\u201d constraint, so e.g \u201c[not] == []\u201d is a compile error, not \u201cFalse\u201d, because there is no \u201cEq (Bool -&gt; Bool)\u201d. It makes no difference here because \u201cEq Int\u201d, but it\u2019s a bad habit."}], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520216666, "post_id": 49102608, "comment_id": 85210429, "body": "FYI, bird style code blocks don&#39;t work on SO - you just have to bite the bullet and indent. :)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520216709, "post_id": 49102608, "comment_id": 85210439, "body": "@Alec There&#39;s no bullet-biting about this, just use ctrl+k."}, {"owner": {"reputation": 432, "user_id": 8402427, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6377f77c32066029c46eed228e1e71e4?s=128&d=identicon&r=PG&f=1", "display_name": "DrJessop", "link": "https://stackoverflow.com/users/8402427/drjessop"}, "edited": false, "score": 0, "creation_date": 1520217028, "post_id": 49102608, "comment_id": 85210504, "body": "I tried doing something something similar  royaltyCount :: Royalty -&gt; Int royaltyCount (MakeRoyalty name royalList)     | royalList == [] = 1     | otherwise = sum map royaltyCount royalList  This however doesn&#39;t work, so there is something I am still missing here."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 432, "user_id": 8402427, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6377f77c32066029c46eed228e1e71e4?s=128&d=identicon&r=PG&f=1", "display_name": "DrJessop", "link": "https://stackoverflow.com/users/8402427/drjessop"}, "edited": false, "score": 0, "creation_date": 1520217451, "post_id": 49102608, "comment_id": 85210591, "body": "@DrJessop just your order of operations. Function application associates left, so <code>sum map f xs</code> tries to do <code>sum map</code>, which of course fails (since <code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code>, and <code>sum</code> is expecting a value of type <code>Num a =&gt; [a]</code>)"}], "tags": [], "owner": {"reputation": 31, "user_id": 7186929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b566f357c4e3395a284fc4f3de7831f9?s=128&d=identicon&r=PG&f=1", "display_name": "Enderperson1010", "link": "https://stackoverflow.com/users/7186929/enderperson1010"}, "is_accepted": false, "score": 1, "last_activity_date": 1520216645, "last_edit_date": 1520216645, "creation_date": 1520216618, "answer_id": 49102608, "question_id": 49102496, "link": "https://stackoverflow.com/questions/49102496/how-to-apply-a-function-to-all-of-the-children-in-haskell/49102608#49102608", "title": "How to Apply a Function to all of the Children in Haskell", "body": "<p>The function you are looking for is</p>\n\n<pre><code>sum :: [Int] -&gt; Int\n</code></pre>\n\n<p>For example, <code>sum [1,2,3] = 6</code>.</p>\n\n<p>You can then use this to accumulate your list together (<code>sum</code> it after <code>map</code>ing <code>countPeople</code> over it).</p>\n\n<p>Here's a more general guide that I found helpful. <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">http://learnyouahaskell.com/chapters</a></p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1520220655, "post_id": 49102684, "comment_id": 85211284, "body": "What goes wrong if you omit the &quot;person with no children&quot; clause?"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1520222598, "post_id": 49102684, "comment_id": 85211710, "body": "@DanielWagner Hrm, actually nothing (since <code>map _ [] = []</code> and <code>sum (map _ []) = 0</code>), though I still prefer the explicit base case."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 2, "last_activity_date": 1520217242, "creation_date": 1520217242, "answer_id": 49102684, "question_id": 49102496, "link": "https://stackoverflow.com/questions/49102496/how-to-apply-a-function-to-all-of-the-children-in-haskell/49102684#49102684", "title": "How to Apply a Function to all of the Children in Haskell", "body": "<p>You can think about this as getting the count of each child, summing those together, and adding one.</p>\n\n<pre><code>countChildren :: Person -&gt; Int\ncountChildren (MakePerson _ []) = 1  -- a person with no children\ncountChildren (MakePerson _ xs) = 1 + sum (map countChildren xs)\n</code></pre>\n"}], "owner": {"reputation": 432, "user_id": 8402427, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6377f77c32066029c46eed228e1e71e4?s=128&d=identicon&r=PG&f=1", "display_name": "DrJessop", "link": "https://stackoverflow.com/users/8402427/drjessop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 49102684, "answer_count": 2, "score": 0, "last_activity_date": 1520217242, "creation_date": 1520215404, "last_edit_date": 1520216148, "question_id": 49102496, "link": "https://stackoverflow.com/questions/49102496/how-to-apply-a-function-to-all-of-the-children-in-haskell", "title": "How to Apply a Function to all of the Children in Haskell", "body": "<p>I am having an incredibly hard time with recursive data types in Haskell. I am trying some practice problems before I do the actual assignment, but I am finding one problem that is continuously keeping me from figuring out some of these problems.\nWe have </p>\n\n<pre><code>data Person = MakePerson String [Person]\n</code></pre>\n\n<p>Say I want to count all of the number of people in </p>\n\n<pre><code>charles = MakePerson \"Charles\" [MakePerson \"Charlotte\" [], \nMakePerson \"Phil\" [MakePerson \"Tom\" []]]\n</code></pre>\n\n<p>This is what I have so far</p>\n\n<pre><code>countPeople :: Person -&gt; Int\ncountPeople (MakePerson a b)\n    | b == [] = 1\n    | otherwise = 1 + countPeople (head b)\n</code></pre>\n\n<p>I however don't know how to apply this function to every single element in the list of people, only to the head of the list. I was thinking about using map, but I'm not 100% sure how to use it to apply the function to all of the elements of the list and return a sum.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1520206432, "post_id": 49101565, "comment_id": 85208486, "body": "You really make it terribly complex and unreadable by using <code>head</code> everywhere instead of proper pattern matching :("}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1520211356, "post_id": 49101565, "comment_id": 85209394, "body": "Issues with <code>head</code>/<code>tail</code> (which should almost never be used) aside, make sure you always use type signatures and think about code in terms of <i>types of subexpressions</i>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1520220871, "post_id": 49101565, "comment_id": 85211320, "body": "In the future, include the compiler errors in the question."}], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 3, "last_activity_date": 1520206859, "last_edit_date": 1520206859, "creation_date": 1520206523, "answer_id": 49101644, "question_id": 49101565, "link": "https://stackoverflow.com/questions/49101565/haskell-parentheses/49101644#49101644", "title": "Haskell parentheses", "body": "<p><code>findMinMaxRec head myList head myList tail myList</code> means \u201ccall <code>findMinMaxRec</code> with 6 arguments: <code>head</code>, <code>myList</code>, <code>head</code>, <code>myList</code>, <code>tail</code>, and <code>myList</code>\u201d. You want:</p>\n\n<pre><code>findMinMaxRec (head myList) (head myList) (tail myList)\n</code></pre>\n\n<p>However, it would be best to avoid <code>head</code> and <code>tail</code> here with pattern matching\u2014here\u2019s a slight improvement:</p>\n\n<pre><code>findMinMaxRec smallest largest [] = [smallest, largest]\nfindMinMaxRec smallest largest (x:xs)\n  | x &lt; smallest &amp;&amp; x &gt; largest = findMinMaxRec x x xs\n  | x &lt; smallest = findMinMaxRec x largest xs\n  | x &gt; largest = findMinMaxRec smallest x xs\n  | otherwise = findMinMaxRec smallest largest xs\n</code></pre>\n\n<p>Likewise, when you write:</p>\n\n<pre><code>findMinMax [] = []\nfindMinMax [x] = findMinMaxRec head [x] head [x] [x]\n</code></pre>\n\n<p>This means <code>findMinMax</code> is only defined on 0-element (<code>[]</code>) and 1-element (<code>[x]</code>) lists; and it has the same problem with parentheses. Another small adjustment:</p>\n\n<pre><code>findMinMax [] = []\nfindMinMax (x:xs) = findMinMaxRec x x xs\n</code></pre>\n\n<p>Finally, since <code>findMinMaxRec</code> always returns a two-element list, a tuple would be preferable for the return type; then <code>findMinMax</code> can return a <code>Maybe</code>.</p>\n"}], "owner": {"reputation": 342, "user_id": 3283657, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh3.googleusercontent.com/-NeuYaFC4klU/AAAAAAAAAAI/AAAAAAAAAr8/tfoO1ce_5N8/photo.jpg?sz=128", "display_name": "Marco Montalto M.", "link": "https://stackoverflow.com/users/3283657/marco-montalto-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 49101644, "answer_count": 1, "score": 0, "last_activity_date": 1520212994, "creation_date": 1520205659, "last_edit_date": 1520212994, "question_id": 49101565, "link": "https://stackoverflow.com/questions/49101565/haskell-parentheses", "title": "Haskell parentheses", "body": "<p>Could anyone help me correcting and understanding why the syntax of the following is <strong>not</strong> working? I suppose it's a problem of parentheses.</p>\n\n<pre><code>findMinMaxRec smallest largest myList\n  | myList == [] = [smallest, largest]\n  | head myList &lt; smallest &amp;&amp; head myList &gt; largest = findMinMaxRec head myList head myList tail myList \n  | head myList &lt; smallest = findMinMaxRec head myList largest tail myList \n  | head myList &gt; largest = findMinMaxRec smallest head myList tail myList \n  | otherwise = findMinMaxRec smallest largest tail myList\n\nfindMinMax [] = []\nfindMinMax [x] = findMinMaxRec head [x] head [x] [x]\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1520201301, "post_id": 49100956, "comment_id": 85207244, "body": "Post the real code and the full error."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1520201495, "post_id": 49100956, "comment_id": 85207298, "body": "Looks like you might just be missing an equals sign after the second line of <code>oldest</code>.  Hard to tell without looking at the full code though."}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 2, "creation_date": 1520202094, "post_id": 49100956, "comment_id": 85207492, "body": "What line # is the parse error occurring on?"}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1520203362, "post_id": 49100956, "comment_id": 85207840, "body": "I only ask because the error message seems to refer to something that isn&#39;t found on the code sample you pasted."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1520202040, "last_edit_date": 1520202040, "creation_date": 1520201507, "answer_id": 49101031, "question_id": 49100956, "link": "https://stackoverflow.com/questions/49100956/parse-error-in-pattern-haskell-xyz/49101031#49101031", "title": "Parse Error In Pattern Haskell - x:y:z", "body": "<p>One of the simpler things to do is to define a function that compares two people by age, then use <code>Data.List.maximumBy</code> to get the oldest.</p>\n\n<pre><code>compareByAge :: Person -&gt; Person -&gt; Ordering\ncompareByAge (MakePerson _ a1 _) (MakePerson _ a2 _) = compare a1 a2\n\ngetName :: Person -&gt; String\ngetName (MakePerson name _ _) = name\n\noldest :: [Person] -&gt; String\noldest people = (getName . maximumBy compareByAge) people\n-- or just oldest =  getName . maximumBy compareByAge\n</code></pre>\n\n<p>Try to avoid explicit recursive functions where possible, as there is often a predefined function available that abstracts the necessary recursion.</p>\n"}, {"tags": [], "owner": {"reputation": 145, "user_id": 8980763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a283b39e20315447aa452b298277103e?s=128&d=identicon&r=PG&f=1", "display_name": "teolandon", "link": "https://stackoverflow.com/users/8980763/teolandon"}, "is_accepted": true, "score": 1, "last_activity_date": 1520201516, "creation_date": 1520201516, "answer_id": 49101034, "question_id": 49100956, "link": "https://stackoverflow.com/questions/49100956/parse-error-in-pattern-haskell-xyz/49101034#49101034", "title": "Parse Error In Pattern Haskell - x:y:z", "body": "<p>I assume your strategy is to compare the first two elements of the list and then recurse on the rest of the list. That strategy doesn't work. Take for example the following list (I will only be writing ages as the elements of the list to simplify things):</p>\n\n<pre><code>23:25:21\n</code></pre>\n\n<p>If you pattern match this list, you'll get the second case, where you take <code>23:25:g</code>, where <code>g</code> is the rest of the list. You compare 23 and 25, you see that 25 is the older one, and then compare that to the oldest one of the rest of the list, <code>g</code>. But <code>g</code> now only has one element. It's not an empty list, and it's not a list with two elements of type <code>Person</code>. So the program will fail.</p>\n\n<p>Instead, you have to approach this in a simpler, more pure recursive manner. If the list is empty, raise and error. If the list is of just 1 Person, return that Person's age, since they are the oldest by default. If the list is anything else, compare the head of the list's age to the oldest person of <strong>the rest of the list</strong>. This way, the function will pick off the PersonS one by one, and compare them to get the oldest one.</p>\n"}, {"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1520202365, "post_id": 49101066, "comment_id": 85207583, "body": "<code>\\p1 p1 -&gt; compare (getHeight p1) (getHeight p2)</code> can also be written as <code>comparing getHeight</code> (<code>comparing</code> from <code>Data.Ord</code>) = <code>compare `on` getHeight</code> (<code>on</code> from <code>Data.Function</code>)"}], "tags": [], "owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "is_accepted": false, "score": 3, "last_activity_date": 1520202657, "last_edit_date": 1520202657, "creation_date": 1520201690, "answer_id": 49101066, "question_id": 49100956, "link": "https://stackoverflow.com/questions/49100956/parse-error-in-pattern-haskell-xyz/49101066#49101066", "title": "Parse Error In Pattern Haskell - x:y:z", "body": "<p>Record syntax will make your life easier. Checkout the <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#record-syntax\" rel=\"nofollow noreferrer\">relevant LYAH chapter</a>.</p>\n\n<pre><code>import Data.List(maximumBy)\nimport Data.Function(on)\n\ndata Person = MakePerson {getName :: String, getAge :: Int, getHeight :: Float}\noldest = getName . maximumBy (compare `on` getHeight)\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>Prelude Data.List&gt; l = [(MakePerson \"Alice\" 30 5.90), (MakePerson \"Bob\" 40 5.55), (MakePerson \"Claire\" 25 6.05)]\nPrelude Data.List&gt; oldest l\n\"Claire\"\n</code></pre>\n\n<p><strong>Edit</strong>:</p>\n\n<pre><code>Updated the comparison function per @JonPurdy's comment.\n</code></pre>\n"}], "owner": {"reputation": 432, "user_id": 8402427, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6377f77c32066029c46eed228e1e71e4?s=128&d=identicon&r=PG&f=1", "display_name": "DrJessop", "link": "https://stackoverflow.com/users/8402427/drjessop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 49101034, "answer_count": 3, "score": 0, "last_activity_date": 1520202657, "creation_date": 1520200899, "last_edit_date": 1520201585, "question_id": 49100956, "link": "https://stackoverflow.com/questions/49100956/parse-error-in-pattern-haskell-xyz", "title": "Parse Error In Pattern Haskell - x:y:z", "body": "<p>I am working on a practice quiz and one of the questions makes you work with </p>\n\n<pre><code>data Person = MakePerson String Int Float \n</code></pre>\n\n<p>where String is the name, Int is the age, Float is the height. I must create a function that takes in a list of persons and returns the oldest person (know strict rules on if there are n oldest people, just pick one of them.\nI wrote this</p>\n\n<pre><code>oldest :: [Person] -&gt; String\noldest [] = error(\"Empty list\")\noldest ((MakePerson a b c):(MakePerson d e f):g)\n    | (b &gt;= e) &amp;&amp; (g == []) = a\n    | (b &gt;= e) = oldest (MakePerson a b c):g\n    | (b &lt; e) &amp;&amp; (g == []) = d\n    | otherwise = oldest (MakePerson d e f):g\n</code></pre>\n\n<p>However, I am getting a parse error. I don't know how to create this function without having this double pattern since I need to always compare b and e and I have no other way of accessing their ages. How would I be able to write out this pattern for my parameters?</p>\n\n<p>Parse Error in pattern: oldest \noldest (MakePerson a b c):(MakePerson d e f):g</p>\n"}, {"tags": ["haskell", "exception-handling"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1520199710, "post_id": 49100566, "comment_id": 85206778, "body": "What error message do you get?"}], "answers": [{"tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": false, "score": 5, "last_activity_date": 1520203326, "last_edit_date": 1520203326, "creation_date": 1520202915, "answer_id": 49101229, "question_id": 49100566, "link": "https://stackoverflow.com/questions/49100566/how-to-use-handlers-that-dont-have-someexception-as-their-argument-type/49101229#49101229", "title": "How to use Handlers that don&#39;t have SomeException as their argument type", "body": "<p>The behavior you are seeing is from the type signature of <code>throwM</code>:</p>\n\n<pre><code>throwM :: (Exception e, MonadThrow m) =&gt; e -&gt; m a\n</code></pre>\n\n<p>And the instance for <code>Either</code>, which is essentially:</p>\n\n<pre><code>MonadThrow (Either SomeException)\n</code></pre>\n\n<p>This makes <code>throwM</code>:</p>\n\n<pre><code>throwM :: (Exception e) =&gt; e -&gt; Either SomeException a\n</code></pre>\n\n<p><code>throwM</code> for <code>Either SomeException</code> can take any <code>Exception e</code>.</p>\n\n<p>However, <strong>there is no MonadThrow instance</strong> for <code>Either ExitCode</code>, or for <code>forall e. Exception e =&gt; Either e</code>.</p>\n\n<p>The problem is that there isn't really a way to write an instance that's polymorphic for all <code>e</code>.  Imagine having an instance</p>\n\n<pre><code>Exception q =&gt; MonadThrow (Either q)\n</code></pre>\n\n<p>This would make <code>throwM</code>:</p>\n\n<pre><code>throwM :: (Exception e, Exception q) =&gt; e -&gt; Either q a\n</code></pre>\n\n<p>which means you have to be able to take <em>any</em> <code>e</code> and convert it into <em>any</em> <code>q</code>, which <strong>is not possible</strong> using the <code>Exception</code> typeclass alone.</p>\n\n<p>Imagine also if there was a <code>MonadThrow</code> instance for <code>Either ExitCode</code>.  That would make the type signature for <code>throwM</code>:</p>\n\n<pre><code>throwM :: Exeption e =&gt; e -&gt; Either ExitCode a\n</code></pre>\n\n<p>which you can probably see is clearly nonsensical, since there are many instances of <code>Exception</code> that cannot be coerced to an <code>ExitCode</code>. (Try writing a function with that type signature if you don't believe me!)</p>\n\n<p><em>If you just want</em> short-circuting exception behavior for <code>Either</code>, consider:</p>\n\n<ol>\n<li>Just use <code>Left</code> instead of <code>throwM</code>, and pattern matching for <code>catch</code>.  If you <em>really</em> want to use <code>Exception</code> still, you can use <code>fromException</code> to attempt to coerce a <code>SomeException</code> into an <code>Exception</code> instance of your choice.</li>\n<li>You can use the <em>exceptions</em> package, and catching will still work as long as you must assume that the exception could be any instance (<code>SomeException</code>)</li>\n<li>Use <code>MonadError</code> and <code>ExceptT</code> from <em>mtl</em>, if you want some sort of polymorphic interface with catching ability</li>\n</ol>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1520203326, "creation_date": 1520198074, "last_edit_date": 1520201011, "question_id": 49100566, "link": "https://stackoverflow.com/questions/49100566/how-to-use-handlers-that-dont-have-someexception-as-their-argument-type", "title": "How to use Handlers that don&#39;t have SomeException as their argument type", "body": "<p>When using <code>Control.Monad.Throw</code> (i.e. <code>exceptions</code> package), something that confuses me that it seem that all my my throwing and catching has to work with <code>SomeException</code>.</p>\n\n<p>E.g.</p>\n\n<pre><code>value :: Either ExitCode String\nvalue = throwM $ ExitFailure 23\n</code></pre>\n\n<p>This looks to me like it should compile, because <code>throwM :: (Exception e, MonadThrow m) =&gt; e -&gt; m a</code>, and <code>ExitCode</code> has an instance of Exception. Even this doesn't compile:</p>\n\n<pre><code>value :: Exception e =&gt; Either e String\nvalue = throwM $ ExitFailure 23\n</code></pre>\n\n<p>In fact, it only compiles when I change the signature to <code>SomeException</code>. I know the <code>Exception</code> type class has a special place re</p>\n\n<p>In the <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Control-Exception.html\" rel=\"nofollow noreferrer\">documentation for Control.Exception</a> I could see examples where they use <code>catches</code> with handlers of signature <code>ArithException -&gt; m a</code> or similiar. I tested it and it worked.</p>\n\n<p>Is this not possible when using <code>exceptions</code>?</p>\n\n<p>EDIT\nThe error messages are either:</p>\n\n<blockquote>\n  <p>Couldn't match type <code>ExitCode</code> with <code>SomeException</code> arising from a use of <code>throwM</code></p>\n</blockquote>\n\n<p>or</p>\n\n<blockquote>\n  <p>Couldn't match type <code>e</code> with <code>SomeException</code> arising from a use of <code>throwM</code></p>\n</blockquote>\n"}, {"tags": ["function", "haskell", "haskell-prelude"], "comments": [{"owner": {"reputation": 115, "user_id": 9217097, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c849a7e5846d6dce36221d4a5083dca4?s=128&d=identicon&r=PG&f=1", "display_name": "sergeantSalty", "link": "https://stackoverflow.com/users/9217097/sergeantsalty"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1520193171, "post_id": 49099661, "comment_id": 85204658, "body": "I do not quite understand how I can use the function. for example: If I have the String &quot;123&quot;, how can I cast it into an Integer ? And more general, can &#39;a&#39;  be any type (list, integer, pair...), or are their limited possibilities to typecast the String?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1520193248, "post_id": 49099661, "comment_id": 85204677, "body": "Well the type signature already explains it: it can convert a <code>String</code> in any type <code>a</code> where <code>Read a</code> holds. You can explicitly specify the type, for example <code>read &quot;123&quot; :: Int</code>."}, {"owner": {"reputation": 115, "user_id": 9217097, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c849a7e5846d6dce36221d4a5083dca4?s=128&d=identicon&r=PG&f=1", "display_name": "sergeantSalty", "link": "https://stackoverflow.com/users/9217097/sergeantsalty"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1520193701, "post_id": 49099661, "comment_id": 85204831, "body": "short and clear, thank you @WillemVanOnsem !"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 9217097, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c849a7e5846d6dce36221d4a5083dca4?s=128&d=identicon&r=PG&f=1", "display_name": "sergeantSalty", "link": "https://stackoverflow.com/users/9217097/sergeantsalty"}, "edited": false, "score": 0, "creation_date": 1520195371, "post_id": 49099821, "comment_id": 85205383, "body": "Thank you, that was a good explanation. I&#180;ve played around with read now and it become clear to me."}], "tags": [], "owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "is_accepted": true, "score": 10, "last_activity_date": 1520196249, "last_edit_date": 1520196249, "creation_date": 1520193729, "answer_id": 49099821, "question_id": 49099661, "link": "https://stackoverflow.com/questions/49099661/haskells-read-function-explanation/49099821#49099821", "title": "Haskell&#39;s read function explanation", "body": "<p><code>Read a =&gt; String -&gt; a</code> means that <code>a</code> can be any type that is an instance of the <code>Read</code> class. For a type to satisfy that requirement, it has to at the very least have an implementation of either of <code>Read</code>'s <code>readPrec</code> or <code>readsPrec</code> functions. Many built in types aready supply an implementation, and you can use <code>deriving</code> to generate an implementation for your own custom <code>data</code> types. </p>\n\n<p>To specify what you want to <code>read</code> the string as, you can type annotate the call directly:</p>\n\n<pre><code>read \"1\" :: Int\n</code></pre>\n\n<p>Or give the function enclosing the call to <code>read</code> a signature so the compiler can figure out what you want:</p>\n\n<pre><code>myFunc :: String -&gt; Int\nmyFunc s = read s\n</code></pre>\n\n<p>The signature says that the function returns an Int, so the compiler can infer what type to <code>read</code> <code>s</code> as since <code>myFunc</code> returns whatever the call to <code>read</code> evaluated to. </p>\n"}], "owner": {"reputation": 115, "user_id": 9217097, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c849a7e5846d6dce36221d4a5083dca4?s=128&d=identicon&r=PG&f=1", "display_name": "sergeantSalty", "link": "https://stackoverflow.com/users/9217097/sergeantsalty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6376, "favorite_count": 0, "accepted_answer_id": 49099821, "answer_count": 1, "score": 7, "last_activity_date": 1520196249, "creation_date": 1520192735, "last_edit_date": 1520192935, "question_id": 49099661, "link": "https://stackoverflow.com/questions/49099661/haskells-read-function-explanation", "title": "Haskell&#39;s read function explanation", "body": "<p>I wonder if someone is familiar with the Prelude\u00b4s <code>read</code> function in Haskell. </p>\n\n<p>The type of this function is following.</p>\n\n<pre><code>Read a =&gt; String -&gt; a\n</code></pre>\n\n<p>Can someone explain me  with a few examples how this function can be used and into what types the String can be cast ?</p>\n\n<p>Thank you</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1520189773, "post_id": 49099107, "comment_id": 85203548, "body": "Why did you delete your last question about this instead of editing it?"}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1520189953, "post_id": 49099107, "comment_id": 85203618, "body": "Because my question ultimately changed. I figured out one half of the problem, but this is what is really the essence of it."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 1, "last_activity_date": 1520190729, "creation_date": 1520190729, "answer_id": 49099339, "question_id": 49099107, "link": "https://stackoverflow.com/questions/49099107/how-do-you-write-exception-handlers-in-haskell/49099339#49099339", "title": "How do you write exception handlers in Haskell", "body": "<p>The <code>Exception</code> class offers a method for this:</p>\n\n<pre><code>fromException :: SomeException -&gt; Maybe e\n</code></pre>\n\n<p>You can use this to recover the exception.</p>\n\n<pre><code>valHandler :: Exc.SomeException -&gt; Either Exc.SomeException String\nvalHandler e\n  | Just (ExitFailure code) &lt;- fromException e\n  = Right ...\n  | otherwise = Left e\n</code></pre>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 49099339, "answer_count": 1, "score": 0, "last_activity_date": 1520190729, "creation_date": 1520189462, "question_id": 49099107, "link": "https://stackoverflow.com/questions/49099107/how-do-you-write-exception-handlers-in-haskell", "title": "How do you write exception handlers in Haskell", "body": "<p>Say I have an exception like <code>ExitFailure</code>. How can I match against the different values of <code>ExitFailure</code> in my handler?</p>\n\n<pre><code>import System.Exit (ExitCode(..))\nimport Control.Monad.Catch as Exc\n\nvalue :: Either Exc.SomeException String\nvalue = Exc.throwM . ExitFailure $ 23\n\nvalHandler :: Exc.SomeException -&gt; Either Exc.SomeException String\nvalHandler e = ??\n\nmain = print $ Exc.catch value valHandler\n</code></pre>\n\n<p>I know <code>valHandler e = someValue</code> would match against any kind of exception, but I've never seen an example, where it matches against the kind of exception.</p>\n\n<p>I can't use pattern matching, because I have <code>SomeException</code> at my hands, and I can't use equality checks, because <code>SomeException</code> doesn't have an <code>Eq</code> instance?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 0, "creation_date": 1520188465, "post_id": 49098827, "comment_id": 85203059, "body": "I doubt I can explain this well enough, but at least here&#39;s a site that surely can: <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow noreferrer\">learnyouahaskell.com/making-our-own-types-and-typeclasses</a>"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1520188612, "post_id": 49098827, "comment_id": 85203105, "body": "<code>Lexer</code> is not a type, <code>Lexer Char</code> is a type. It seems that you have skipped ahead a fair bit past the Haskell fundamentals."}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 3, "creation_date": 1520188693, "post_id": 49098827, "comment_id": 85203137, "body": "Since you know Java, <code>Lexer Char</code> is the Haskell equivalent of Java&#39;s <code>Lexer&lt;Char&gt;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8003943, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/952512b4c22797a1483c3852e6758c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Emigsfd", "link": "https://stackoverflow.com/users/8003943/emigsfd"}, "edited": false, "score": 0, "creation_date": 1520195518, "post_id": 49098961, "comment_id": 85205444, "body": "Thans for explanation, it helped me a lot. But i&#39;m still not sure how is should define Lexer from mine example."}, {"owner": {"reputation": 41, "user_id": 8003943, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/952512b4c22797a1483c3852e6758c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Emigsfd", "link": "https://stackoverflow.com/users/8003943/emigsfd"}, "edited": false, "score": 0, "creation_date": 1520195523, "post_id": 49098961, "comment_id": 85205447, "body": "item :: Lexer Char  item =  Lexer Char (Parser (Loc &quot;f&quot; 1 2) &quot;aaa&quot;) &#39;a&#39;"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1520188746, "creation_date": 1520188746, "answer_id": 49098961, "question_id": 49098827, "link": "https://stackoverflow.com/questions/49098827/what-does-such-notation-mean-in-haskell/49098961#49098961", "title": "What does such notation mean in haskell?", "body": "<p>No, it is <em>not</em> a tuple, types can be <em>parameterized</em> as well. In imperative languages like Java, this concept is usually know as <em>generic types</em> (although there is no one-on-one mapping of the two concepts).</p>\n\n<p>In Java for instance you have classes like:</p>\n\n<pre><code>class LinkedList&lt;E&gt; {\n\n    // ...\n\n}\n</code></pre>\n\n<p>Now here we can see <code>LinkedList</code> as a function that takes as input a parameter <code>E</code>, and then returns a real type (for example <code>LinkedList&lt;String&gt;</code> is a linked list that stores <code>String</code>s). So we can see such abstract type as a function.</p>\n\n<p>This is a concept that is used in Haskell as well. We have for instance the <code>Maybe</code> type:</p>\n\n<pre><code>data Maybe a = Nothing | Just a\n</code></pre>\n\n<p>Notice the <code>a</code> here. This is a type parameter that we need to fill in. A function can not return a <code>Maybe</code>, it can only return a <code>Maybe a</code> where <code>a</code> is filled in. For example a <code>Maybe Char</code>: a <code>Maybe</code> type that is a <code>Nothing</code>, or a <code>Just x</code> with <code>x</code> a <code>Char</code>.</p>\n"}], "owner": {"reputation": 41, "user_id": 8003943, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/952512b4c22797a1483c3852e6758c5a?s=128&d=identicon&r=PG&f=1", "display_name": "Emigsfd", "link": "https://stackoverflow.com/users/8003943/emigsfd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1520191874, "creation_date": 1520187968, "last_edit_date": 1520191874, "question_id": 49098827, "link": "https://stackoverflow.com/questions/49098827/what-does-such-notation-mean-in-haskell", "title": "What does such notation mean in haskell?", "body": "<pre><code>function :: Type1 Type2\n</code></pre>\n\n<p>Are <code>Type1</code> and <code>Type2</code> return values (tuples)? </p>\n\n<pre><code>data Loc = Loc String Int Int \n\ndata Parser b a = P (b -&gt; [(a, b)])\n\nparse :: Parser b a -&gt; b -&gt; [(a, b)]\nparse (P p) inp = p inp\n\ntype Lexer a = Parser (Loc, String) a\n\nitem :: Lexer Char\nitem = ????\n</code></pre>\n\n<p>How should I return <code>Lexer</code> and <code>Char</code> from item function? \nCould you please give me some simple example.</p>\n"}, {"tags": ["python", "haskell"], "comments": [{"owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "edited": false, "score": 0, "creation_date": 1520188053, "post_id": 49098806, "comment_id": 85202899, "body": "Do the numbers need to remain ordered?"}, {"owner": {"reputation": 536, "user_id": 4934344, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/Ww937.jpg?s=128&g=1", "display_name": "Rankinstudio", "link": "https://stackoverflow.com/users/4934344/rankinstudio"}, "edited": false, "score": 0, "creation_date": 1520188070, "post_id": 49098806, "comment_id": 85202906, "body": "Well, it shouldn&#39;t be too hard as the order of the numbers matters. You&#39;ll just have to split out the numbers, then run them through each possible combination of possible equations and see if any of them equal 0"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9183739"}, "reply_to_user": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "edited": false, "score": 0, "creation_date": 1520188571, "post_id": 49098806, "comment_id": 85203089, "body": "It doesn&#39;t matter @Alex"}], "answers": [{"tags": [], "owner": {"reputation": 1431, "user_id": 9348376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a9bd3db9f0d23a0fdaccdbe32380136?s=128&d=identicon&r=PG&f=1", "display_name": "Sean Breckenridge", "link": "https://stackoverflow.com/users/9348376/sean-breckenridge"}, "is_accepted": false, "score": 0, "last_activity_date": 1520195959, "last_edit_date": 1520195959, "creation_date": 1520194415, "answer_id": 49099931, "question_id": 49098806, "link": "https://stackoverflow.com/questions/49098806/get-zeros-with-car-plates/49099931#49099931", "title": "Get zeros with car plates", "body": "<p>This isn't the best implementation, because there are quite a lot of repeats, but does get a result.</p>\n\n<p>Using <a href=\"https://docs.python.org/3.4/library/itertools.html\" rel=\"nofollow noreferrer\">itertools</a>, I generated every different state (permutation) that the numbers and operations could be in, e.g.:</p>\n\n<p><code>[('1', '2', '3', '4'), ('1', '2', '4', '3'), ('1', '3', '2', '4'), ('1', '3', '4', '2'), ('1', '4', '2', '3'),  ....... ('4', '1', '3', '2'), ('4', '2', '1', '3'), ('4', '2', '3', '1'), ('4', '3', '1', '2'), ('4', '3', '2', '1')]</code> </p>\n\n<p><code>[('+', '-', '*'), ('+', '*', '-') ......  ('/', '-', '*'), ('/', '*', '-')]</code></p>\n\n<p>...then, I made a function that adds brackets to every possible state of the calculation:</p>\n\n<p><code>[1,'+',2,'-',3,'*',4]</code> becomes:</p>\n\n<pre><code>1 + 2 - 3 * 4\n( 1 + 2 ) - ( 3 * 4 )\n( 1 + 2 - 3 ) * 4\n1 + ( 2 - 3 * 4 )\n( 1 + 2 ) - 3 * 4\n1 + 2 - ( 3 * 4 )\n1 + ( 2 - 3 ) * 4 \n</code></pre>\n\n<p>... and then, evaluated each different possibility, and if it was zero I printed it out.</p>\n\n<p>Heres all the code:</p>\n\n<pre><code>from itertools import permutations, combinations, chain\nimport sys\n\noperations = ['+', '-', '*', '/'] # basic operations\n\n# add every combination of brackets to the calculation\ndef addBrackets(calc):\n    possibilities = []\n    possibilities.append(\" \".join(calc))\n    possibilities.append(\" \".join(str(s) for s in list(chain([\"(\"], calc[:3], [\")\"], [calc[3]], [\"(\"], calc[4:], [\")\"]))))\n    possibilities.append(\" \".join(str(s) for s in list(chain([\"(\"], calc[:-2], [\")\"], calc[-2:]))))\n    possibilities.append(\" \".join(str(s) for s in list(chain(calc[:2], [\"(\"], calc[2:], [\")\"]))))\n    possibilities.append(\" \".join(str(s) for s in list(chain([\"(\"], calc[:3], [\")\"], calc[3:]))))\n    possibilities.append(\" \".join(str(s) for s in list(chain(calc[:4], [\"(\"], calc[4:], [\")\"]))))\n    return possibilities\n\ndef getZero(n): # 2491\n    nums = [x for x in str(n)] # [2, 4, 9, 1]\n    while len(nums) &lt; 4:\n        nums = ['0'] + nums # add zeroes if the input was less than 1000 e.g. [5, 3, 1] -&gt; [0, 5, 3, 1]\n    possible_number_order = list(permutations(nums)) # get every number order\n    possible_op_order = list(combinations(operations, 3)) # get combinations of 3 of the operations\n    possible_op_permutations = list(chain(list(permutations(p)) for p in possible_op_order)) # chain together all the permutations of each combination\n    possible_op_order = []\n    for perms in possible_op_permutations: \n        possible_op_order.extend(perms) # add all the lists into one\n    for n in possible_number_order: # for each number order\n        for op in possible_op_order: # for each operation order\n            calculation = [n[0],op[0],n[1],op[1],n[2],op[2],n[3]] # create a list with the order of the operation\n            for calc in addBrackets(calculation): # for each bracket position\n                try:\n                    result = eval(calc) # evaluate\n                    if abs(result) &lt;= 0.001: # to check for float comparison\n                        print(\"{} = {}\".format(calc, 0))\n                except: # ZeroDivisionError\n                    continue\n\nif __name__ == \"__main__\":\n    for user_input in [int(n) for n in sys.argv[1:]]:\n        print(\"-------{0:04}-------\".format(user_input)) # print 0 padded output\n        getZero(user_input)\n</code></pre>\n\n<p>Enter the input as command line arguments:</p>\n\n<pre><code>$ python3.6 zerogame.py 2491 2591\n-------2491-------\n( 2 * 4 - 9 ) + 1 = 0\n( 2 * 4 ) - 9 + 1 = 0\n( 2 * 4 ) + ( 1 - 9 ) = 0\n( 2 * 4 + 1 ) - 9 = 0\n( 2 * 4 ) + 1 - 9 = 0\n2 * 4 + ( 1 - 9 ) = 0\n2 + ( 1 - 9 ) / 4 = 0\n( 4 * 2 - 9 ) + 1 = 0\n( 4 * 2 ) - 9 + 1 = 0\n( 4 * 2 ) + ( 1 - 9 ) = 0\n( 4 * 2 + 1 ) - 9 = 0\n( 4 * 2 ) + 1 - 9 = 0\n4 * 2 + ( 1 - 9 ) = 0\n4 + ( 1 - 9 ) / 2 = 0\n9 - ( 2 * 4 + 1 ) = 0\n9 - ( 4 * 2 + 1 ) = 0\n9 - ( 1 + 2 * 4 ) = 0\n9 - ( 1 + 4 * 2 ) = 0\n( 1 + 2 * 4 ) - 9 = 0\n1 + ( 2 * 4 - 9 ) = 0\n1 + ( 2 * 4 ) - 9 = 0\n( 1 + 4 * 2 ) - 9 = 0\n1 + ( 4 * 2 - 9 ) = 0\n1 + ( 4 * 2 ) - 9 = 0\n( 1 - 9 ) + ( 2 * 4 ) = 0\n( 1 - 9 ) + 2 * 4 = 0\n1 - 9 + ( 2 * 4 ) = 0\n( 1 - 9 ) / 2 + 4 = 0\n( 1 - 9 ) + ( 4 * 2 ) = 0\n( 1 - 9 ) + 4 * 2 = 0\n1 - 9 + ( 4 * 2 ) = 0\n( 1 - 9 ) / 4 + 2 = 0\n-------2591-------\n( 2 * 5 ) - ( 9 + 1 ) = 0\n2 * 5 - ( 9 + 1 ) = 0\n( 2 * 5 ) - ( 1 + 9 ) = 0\n2 * 5 - ( 1 + 9 ) = 0\n2 - ( 9 + 1 ) / 5 = 0\n2 - ( 1 + 9 ) / 5 = 0\n( 5 * 2 ) - ( 9 + 1 ) = 0\n5 * 2 - ( 9 + 1 ) = 0\n( 5 * 2 ) - ( 1 + 9 ) = 0\n5 * 2 - ( 1 + 9 ) = 0\n5 - ( 9 + 1 ) / 2 = 0\n5 - ( 1 + 9 ) / 2 = 0\n( 9 - 2 * 5 ) + 1 = 0\n9 - ( 2 * 5 ) + 1 = 0\n( 9 - 5 * 2 ) + 1 = 0\n9 - ( 5 * 2 ) + 1 = 0\n( 9 + 1 ) - ( 2 * 5 ) = 0\n9 + ( 1 - 2 * 5 ) = 0\n( 9 + 1 ) - 2 * 5 = 0\n9 + 1 - ( 2 * 5 ) = 0\n( 9 + 1 ) / 2 - 5 = 0\n( 9 + 1 ) - ( 5 * 2 ) = 0\n9 + ( 1 - 5 * 2 ) = 0\n( 9 + 1 ) - 5 * 2 = 0\n9 + 1 - ( 5 * 2 ) = 0\n( 9 + 1 ) / 5 - 2 = 0\n( 1 - 2 * 5 ) + 9 = 0\n1 - ( 2 * 5 ) + 9 = 0\n( 1 - 5 * 2 ) + 9 = 0\n1 - ( 5 * 2 ) + 9 = 0\n( 1 + 9 ) - ( 2 * 5 ) = 0\n1 + ( 9 - 2 * 5 ) = 0\n( 1 + 9 ) - 2 * 5 = 0\n1 + 9 - ( 2 * 5 ) = 0\n( 1 + 9 ) / 2 - 5 = 0\n( 1 + 9 ) - ( 5 * 2 ) = 0\n1 + ( 9 - 5 * 2 ) = 0\n( 1 + 9 ) - 5 * 2 = 0\n1 + 9 - ( 5 * 2 ) = 0\n( 1 + 9 ) / 5 - 2 = 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 1, "last_activity_date": 1520272215, "last_edit_date": 1520272215, "creation_date": 1520230844, "answer_id": 49104554, "question_id": 49098806, "link": "https://stackoverflow.com/questions/49098806/get-zeros-with-car-plates/49104554#49104554", "title": "Get zeros with car plates", "body": "<p>This is probably off topic but a fun toy puzzle.</p>\n\n<p>An easy way to think of the issue is in perhaps four separate parts:</p>\n\n<ol>\n<li>Boring plumbing for the arguments and printing the results</li>\n<li>Construct all possible expressions of binary operations of the given numbers.</li>\n<li>Interpret these expressions to obtain a numeric literal and drop any result that is not zero.</li>\n<li>Pretty print the expression.</li>\n</ol>\n\n<p>We could perform extra steps, such as filtering out duplicates based on algebraic rules (<code>a + b</code> and <code>b + a</code> are morally the same), but I skipped that.</p>\n\n<p><strong>The boring plumbing</strong> is just getting our plate numbers (one for each argument), breaking those down into digits, running our computation, and printing the solution.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Foldable\nimport Data.List\nimport System.Environment\n\nmain :: IO ()\nmain =\n  do ns &lt;- getArgs\n     for_ ns $ \\n -&gt; do\n        let digitList = map (read . (:[])) (n :: String) :: [Int]\n        putStrLn $ \"---------- \" ++ show n ++ \" ----------\"\n        putStrLn $ unlines (map render (solutions digitList))\n</code></pre>\n\n<p><strong>Construction</strong> The real fun is in this construction of a binary tree of operations and leafs with the literals.  First we define our expression language:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Expr = Add Expr Expr\n          | Sub Expr Expr\n          | Mul Expr Expr\n          | Div Expr Expr\n          | Lit Int\n        deriving (Eq, Ord, Show)\n</code></pre>\n\n<p>And we can use these expressions along with a Haskell list monad to build all possible expressions (assuming a non-empty list as input):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>operations :: [Expr -&gt; Expr -&gt; Expr]\noperations = [Add, Sub, Mul, Div]\n\nexprsOf :: [Expr] -&gt; [Expr]\nexprsOf [term] = [term]\nexprsOf xs =\n  do x &lt;- xs\n     y &lt;- (delete x xs)\n     o &lt;- operations\n     exprsOf (o x y : delete y (delete x xs))\n</code></pre>\n\n<p>That is, <code>x</code> is one of the elements in the original set of expressions.  <code>y</code> is another element (but not x).  <code>o</code> is one of our legal operations (addition, subtraction, etc).  And we recursively reduce this list size till we are left with the top level expression (variable name <code>term</code>).  If you don't understand the operation that's OK - specific parts that confuse you would make a fine (on topic) question.</p>\n\n<p><strong>Interpretation</strong> With the expressions built we can now interpret them and filter out any that don't result in zero.</p>\n\n<p>The interpreter is just using addition (<code>+</code>) when we see our <code>Add</code> constructor and same for the other operations.  I lifted everything into the Maybe Applicative because I didn't want division by zero or with a remainder to show up in our results.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>interp :: Expr -&gt; Maybe Int\ninterp (Lit n) = Just n\ninterp (Add a b) = (+) &lt;$&gt; interp a &lt;*&gt; interp b\ninterp (Sub a b) = (-) &lt;$&gt; interp a &lt;*&gt; interp b\ninterp (Mul a b) = (*) &lt;$&gt; interp a &lt;*&gt; interp b\ninterp (Div a b) | interp b == Just 0 = Nothing\n                 | interp b == Nothing = Nothing\n                 | otherwise          =\n        case divMod &lt;$&gt; interp a &lt;*&gt; interp b of\n            Nothing -&gt; Nothing\n            Just (x,0) -&gt; Just x\n            _ -&gt; Nothing -- Ignore uneven division\n</code></pre>\n\n<p>Applying this interpretation is just a matter of filtering for <code>Just 0</code>:</p>\n\n<pre><code>solutions :: [Int] -&gt; [Expr]\nsolutions xs = filter ((== Just 0) . interp) $ exprsOf (map Lit xs)\n</code></pre>\n\n<p><strong>Rendering</strong> Finally, there's a pretty ugly render function just to emit the proper parenthesis so we see the right order of operations:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>render :: Expr -&gt; String\nrender (Lit n) = show n\nrender (Add a b) = \"(\" ++ render a ++ \" + \" ++ render b ++ \")\"\nrender (Sub a b) = \"(\" ++ render a ++ \" - \" ++ render b ++ \")\"\nrender (Mul a b) = \"(\" ++ render a ++ \" * \" ++ render b ++ \")\"\nrender (Div a b) = \"(\" ++ render a ++ \" / \" ++ render b ++ \")\"\n</code></pre>\n\n<p><strong>Example Run</strong></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>*Main&gt; :main 2591\n---------- \"2591\" ----------\n(((2 * 5) - 9) - 1)\n(1 - ((2 * 5) - 9))\n(((2 * 5) - 1) - 9)\n(9 - ((2 * 5) - 1))\n((9 - (2 * 5)) + 1)\n(1 + (9 - (2 * 5)))\n((9 + 1) - (2 * 5))\n((2 * 5) - (9 + 1))\n((1 - (2 * 5)) + 9)\n(9 + (1 - (2 * 5)))\n((1 + 9) - (2 * 5))\n((2 * 5) - (1 + 9))\n(((5 * 2) - 9) - 1)\n(1 - ((5 * 2) - 9))\n(((5 * 2) - 1) - 9)\n(9 - ((5 * 2) - 1))\n((9 - (5 * 2)) + 1)\n(1 + (9 - (5 * 2)))\n((9 + 1) - (5 * 2))\n((5 * 2) - (9 + 1))\n((1 - (5 * 2)) + 9)\n(9 + (1 - (5 * 2)))\n((1 + 9) - (5 * 2))\n((5 * 2) - (1 + 9))\n(((9 + 1) / 2) - 5)\n(5 - ((9 + 1) / 2))\n(((9 + 1) / 5) - 2)\n(2 - ((9 + 1) / 5))\n((2 * 5) - (9 + 1))\n((9 + 1) - (2 * 5))\n((5 * 2) - (9 + 1))\n((9 + 1) - (5 * 2))\n(((1 + 9) / 2) - 5)\n(5 - ((1 + 9) / 2))\n(((1 + 9) / 5) - 2)\n(2 - ((1 + 9) / 5))\n((2 * 5) - (1 + 9))\n((1 + 9) - (2 * 5))\n((5 * 2) - (1 + 9))\n((1 + 9) - (5 * 2))\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9183739"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1520272215, "creation_date": 1520187873, "last_edit_date": 1520195638, "question_id": 49098806, "link": "https://stackoverflow.com/questions/49098806/get-zeros-with-car-plates", "title": "Get zeros with car plates", "body": "<p>When I was little, I played the next game with my cousins:  </p>\n\n<p>\"Zero in the car's license plates\": by using the numbers in the car's license plate numbers and using the elementary operations (sum, subtraction, product and division) once each, you had to find an order that equaled 0.</p>\n\n<p>For example, if we have the following license plate: </p>\n\n<p><code>2591 --&gt;  (2*5)-(9+1) = 0</code></p>\n\n<p><code>2491 --&gt;  (2*4)+1 -9  = 0</code></p>\n\n<p>I would like to make a program in Haskell or Python that it is able to play this game, and print the steps that gives a result of 0.</p>\n\n<pre><code>getZero 2491 =  2*4+1-9\ngetZero 2591 =  2*5-9+1\n</code></pre>\n\n<p>Maybe its impossible to make this; I hope that you can help me.</p>\n"}, {"tags": ["datetime", "haskell"], "comments": [{"owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "edited": false, "score": 0, "creation_date": 1520187223, "post_id": 49098666, "comment_id": 85202597, "body": "As in seconds since the epoch?"}, {"owner": {"reputation": 341, "user_id": 6436616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0808fbba3e3cd9d518a297d070dc1e03?s=128&d=identicon&r=PG&f=1", "display_name": "rjpj1998", "link": "https://stackoverflow.com/users/6436616/rjpj1998"}, "reply_to_user": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "edited": false, "score": 0, "creation_date": 1520187312, "post_id": 49098666, "comment_id": 85202624, "body": "Yes. Seconds as in unix time"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1520189760, "post_id": 49098666, "comment_id": 85203543, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/40541247/haskell-how-to-pretty-print-number-of-seconds-as-a-date-and-time\">Haskell: How to pretty print number of seconds as a date and time?</a>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520218886, "post_id": 49098666, "comment_id": 85210898, "body": "Nitpicking: you mean &quot;How do I get a value&quot;, rather than &quot;How do I get an instance&quot;."}, {"owner": {"reputation": 341, "user_id": 6436616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0808fbba3e3cd9d518a297d070dc1e03?s=128&d=identicon&r=PG&f=1", "display_name": "rjpj1998", "link": "https://stackoverflow.com/users/6436616/rjpj1998"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520219365, "post_id": 49098666, "comment_id": 85211002, "body": "@duplode noted."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520218808, "post_id": 49099345, "comment_id": 85210878, "body": "Nitpicking: &quot;convert the double to a fractional&quot; might be a somewhat confusing way of putting it to someone new to the language, as <code>Double</code> is a type while <code>Fractional</code> isn&#39;t, and also because <code>Double</code> is already a <code>Fractional</code>."}], "tags": [], "owner": {"reputation": 406, "user_id": 1738086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44ffd4d27d01bce9b3425f88d83975a3?s=128&d=identicon&r=PG", "display_name": "Simon Courtenage", "link": "https://stackoverflow.com/users/1738086/simon-courtenage"}, "is_accepted": true, "score": 1, "last_activity_date": 1520218517, "last_edit_date": 1520218517, "creation_date": 1520190747, "answer_id": 49099345, "question_id": 49098666, "link": "https://stackoverflow.com/questions/49098666/converting-a-double-to-utctime/49099345#49099345", "title": "Converting a double to UTCTime", "body": "<p>You need to convert the double to a fractional in order for it to be understood as a <code>NominalDiffTime</code> value (which is an instance of <code>Fractional</code>).  Once it is understood as a <code>NominalDiffTime</code> value, then <code>posixSecondsToUTCTime</code> will handle the conversion (<code>POSIXTime</code> being a type synonym of <code>NominalDiffTime</code>).</p>\n\n<pre><code>import Data.Time.Clock\nimport Data.Time.Clock.POSIX(posixSecondsToUTCTime)\n\ndoubleToUTCTime d = posixSecondsToUTCTime $ realToFrac d\n</code></pre>\n"}], "owner": {"reputation": 341, "user_id": 6436616, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0808fbba3e3cd9d518a297d070dc1e03?s=128&d=identicon&r=PG&f=1", "display_name": "rjpj1998", "link": "https://stackoverflow.com/users/6436616/rjpj1998"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 49099345, "answer_count": 1, "score": 0, "last_activity_date": 1520218517, "creation_date": 1520187094, "last_edit_date": 1520187334, "question_id": 49098666, "link": "https://stackoverflow.com/questions/49098666/converting-a-double-to-utctime", "title": "Converting a double to UTCTime", "body": "<p>The title is all it is.</p>\n\n<p>Assume I have a double:</p>\n\n<pre><code>let d = 11241241.10124012 :: Double\n</code></pre>\n\n<p>How do I get an instance of <code>UTCTime</code> corresponding to d, d as in unix seconds?</p>\n"}, {"tags": ["haskell", "math", "primes"], "answers": [{"comments": [{"owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "edited": false, "score": 0, "creation_date": 1520188698, "post_id": 49098878, "comment_id": 85203142, "body": "This feels like the right answer. Some ideas are new to me so I need to play with it to confirm. So unless i find an issue or a better answer comes along I will probably accept this as the answer shortly."}, {"owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "edited": false, "score": 0, "creation_date": 1520190096, "post_id": 49098878, "comment_id": 85203663, "body": "so Applicatives, &lt;**&gt; and &lt;$&gt; are all weird to me and i dont understand what they are. If I learn about applicatives will that also cover whatever those other two things are?"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "edited": false, "score": 2, "creation_date": 1520203715, "post_id": 49098878, "comment_id": 85207945, "body": "@JeffreyPhillipsFreeman: <code>&lt;$&gt;</code> is infix <code>fmap :: (a -&gt; b) -&gt; f a -&gt; f b</code>, a.k.a. <code>map</code> on lists (<code>f</code>=<code>[]</code>). So <code>(6*) &lt;$&gt; [1..]</code> = <code>[6,12,18,\u2026]</code>. <code>&lt;**&gt;</code> is a flipped version of <code>(&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b</code>\u2014here, applying a list of functions to a list of operands. This answer uses <code>&lt;**&gt;</code> instead of the (more common) <code>&lt;*&gt;</code> because they give different orderings: <code>[pred,succ] &lt;*&gt; [10,20,30] == [9,19,29,11,21,31]</code> (all <code>pred</code>s then all <code>succ</code>s) while <code>[10,20,30] &lt;**&gt; [pred,succ] == [9,11,19,21,29,31]</code> (<code>pred</code> and <code>succ</code> of each). Just a shorter version of <code>\u2026 &gt;&gt;= \\x -&gt; [pred x, succ x]</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1520188229, "creation_date": 1520188229, "answer_id": 49098878, "question_id": 49098467, "link": "https://stackoverflow.com/questions/49098467/how-can-i-make-this-prime-check-function-more-succinct-in-haskell/49098878#49098878", "title": "How can I make this prime check function more succinct in Haskell?", "body": "<p>The thing I'd consider most unidiomatic here are the equality comparisons. In Haskell, we generally prefer pattern matching, which you can directly apply to the first three cases:</p>\n\n<pre><code>prime 1 = False\nprime 2 = True\nprime 3 = True\nprime x\n    | ...\n</code></pre>\n\n<p>(The difference is cosmetic in this example, but often pattern matching makes code much safer, more succinct and sometimes also significantly more performant.)</p>\n\n<p>Next, you're using both a list comprehension and <code>concatMap</code>. Both constructs do largely the same thing, and are equivalent to monadic binds. But <strong>a)</strong> it's usually benefitial to use only <em>one</em> of these syntaxes in a place, <strong>b)</strong> monad is actually stronger than necessary: <em>applicative</em> will do as well, and can be written quite nicely here.</p>\n\n<pre><code>import Control.Applicative\n...\n       (6*) &lt;$&gt; [1..] &lt;**&gt; [pred, succ]\n</code></pre>\n\n<p>Then, I find this <code>((&lt;=) . floor . sqrt . fromIntegral $ z)</code> awkward. More natural would be in flipped form:</p>\n\n<pre><code>    takeWhile (&gt;= floor (sqrt $ fromIntegral z)) ...\n</code></pre>\n\n<p>...but generally speaking, better yet is to avoid the square root entirely:</p>\n\n<pre><code>    takeWhile ((&gt;=z) . (^2)) ...\n</code></pre>\n\n<p>The reason being, square-root is pretty expensive and has floating-point inaccuracies, so it's often better to square the other side of the equation instead. Unfortunately, this is actually not reliable here, because the squaring might lead to <code>Int</code> overflows, and <code>Integer</code> would make the performance probably <em>worse</em> than with float-sqrt, because it's done for every element of the list rather than just once. So, a square-root is actually sensible here.</p>\n\n<p>The <code>dividends</code> function is actually superfluous since you only ever call it with <code>x</code> as the argument. (It might be argued that it's sensible to still give this a <em>name</em>, but at any rate you don't need to give it an <em>argument</em>.)</p>\n\n<p>The predicate for the <code>all</code> is something I <em>would</em> consider making point-free.</p>\n\n<p>Final version would then be:</p>\n\n<pre><code>prime :: Int -&gt; Bool\nprime 1 = False\nprime 2 = True\nprime 3 = True\nprime x\n    | x `mod` 2 == 0 = False\n    | x `mod` 3 == 0 = False\n    | otherwise = all ((/= 0) . (x`mod`))\n                 . takeWhile (&gt;= floor (sqrt $ fromIntegral x))\n                 $ (6*) &lt;$&gt; [1..]\n                        &lt;**&gt; [pred, succ]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1520276143, "last_edit_date": 1520276143, "creation_date": 1520197449, "answer_id": 49100457, "question_id": 49098467, "link": "https://stackoverflow.com/questions/49098467/how-can-i-make-this-prime-check-function-more-succinct-in-haskell/49100457#49100457", "title": "How can I make this prime check function more succinct in Haskell?", "body": "<p>So I modified @leftaroundabout 's answer slightly and am using this. Just putting it up here in case anyone winds up using it.</p>\n\n<pre><code>import Control.Applicative\n\nprime'' :: Int -&gt; Bool\nprime'' 1 = False\nprime'' 2 = True\nprime'' 3 = True\nprime'' x\n    | x `mod` 2 == 0 = False\n    | x `mod` 3 == 0 = False\n    | otherwise = all\n                     -- check if x is not divisibile by the divisors\n                     ((/=  0) . (x `mod`))\n\n                     -- only take divisors less than or equal to sqrt(x)\n                     . takeWhile (&lt;=(floor . sqrt . fromIntegral $ x))\n\n                     -- generate divisors as an infinite list 6n +/- 1\n                     $ [6,12..] &lt;**&gt; [(-1+), (1+)]\n</code></pre>\n"}], "owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 49098878, "answer_count": 2, "score": 1, "last_activity_date": 1520276143, "creation_date": 1520185977, "last_edit_date": 1520186397, "question_id": 49098467, "link": "https://stackoverflow.com/questions/49098467/how-can-i-make-this-prime-check-function-more-succinct-in-haskell", "title": "How can I make this prime check function more succinct in Haskell?", "body": "<p>So I spent the last hour or so trying to write up an effecient haskell function that checks if a number is prime or not. I came up with this algorithm that I'm rather happy with:</p>\n\n<pre><code>prime :: Int -&gt; Bool\nprime x\n    | x == 1 = False\n    | x == 2 = True\n    | x == 3 = True\n    | x `mod` 2 == 0 = False\n    | x `mod` 3 == 0 = False\n    | otherwise = all (\\y -&gt; x `mod` y /= 0) $ dividends x\n    where\n        dividends z =\n            takeWhile ((&lt;=) . floor . sqrt . fromIntegral $ z)\n                $ concatMap (\\x -&gt; [x-1, x+1]) [6 * x | x &lt;- [1..]]\n</code></pre>\n\n<p>I also uploaded a notebook that checks the run time of the algorithm and compares it to the sieve method in case anyone is interested that is here: <a href=\"https://anaconda.org/freemo/primes/notebook\" rel=\"nofollow noreferrer\">https://anaconda.org/freemo/primes/notebook</a></p>\n\n<p>My question is, as someone new to haskell how can I make this algorithm more idomatic. I have a feeling the anonymous functions I used can be eliminated, and there are probably other ways I can make it more concise without having a negative effect on the run time. How can I write this in an more idiomatic haskell way?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 148712, "user_id": 19750, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/13b41b2620da0b1e630715e0c91a0b03?s=128&d=identicon&r=PG", "display_name": "Josh Lee", "link": "https://stackoverflow.com/users/19750/josh-lee"}, "edited": false, "score": 1, "creation_date": 1520184296, "post_id": 49098148, "comment_id": 85201565, "body": "<code>[_]</code> represents a list with one element."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1520184311, "post_id": 49098148, "comment_id": 85201572, "body": "By writing <code>_</code> instead of <code>[_]</code>, <code>[_]</code> means a list of <i>one</i> element. But using <code>==</code> is already the problem here, you should pattern match, not use <code>==</code>."}], "answers": [{"tags": [], "owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "is_accepted": true, "score": 4, "last_activity_date": 1520184470, "creation_date": 1520184470, "answer_id": 49098188, "question_id": 49098148, "link": "https://stackoverflow.com/questions/49098148/how-to-pattern-match-with-algebraic-types-in-haskell/49098188#49098188", "title": "How to Pattern Match With Algebraic Types in Haskell", "body": "<p>You should checkout the <a href=\"http://learnyouahaskell.com/syntax-in-functions\" rel=\"nofollow noreferrer\">function syntax chapter</a> in <strong>Learn You A Haskell</strong> (particularly the first section on pattern matching).</p>\n\n<p>This is how you do pattern matching in Haskell for this example:</p>\n\n<pre><code>test :: Trie -&gt; Bool\ntest (MakeTrie '.' _) = True\ntest _ = False\n</code></pre>\n\n<p>Testing:</p>\n\n<pre><code>Prelude&gt; test (MakeTrie '.' [])\nTrue\nPrelude&gt; test (MakeTrie 'a' [])\nFalse\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1520184485, "creation_date": 1520184485, "answer_id": 49098190, "question_id": 49098148, "link": "https://stackoverflow.com/questions/49098148/how-to-pattern-match-with-algebraic-types-in-haskell/49098190#49098190", "title": "How to Pattern Match With Algebraic Types in Haskell", "body": "<p>There are two problems here:</p>\n\n<ol>\n<li>if you write <code>[_]</code>, this is a pattern that says \"<em>a list of one element, regardless what that element is</em>\"; and</li>\n<li>you can not do pattern matching with <code>(==)</code>.</li>\n</ol>\n\n<p>Indeed <code>(==)</code> is a function that compares two objects. But it is not said that if two objects are equal, that these share the same constructor, etc. <code>(==)</code> can implement an arbitrary equivalence relation.</p>\n\n<p>We can write the function as:</p>\n\n<pre><code>test :: Trie -&gt; Bool\ntest (MakeTrie '.' _) = True\ntest _ = False\n</code></pre>\n\n<p>So here the first clause checks if the input matches the pattern <code>MakeTrie '.' _</code>, so it checks if it is the <code>MakeTrie</code> data constructor where the first parameter is a <code>'.'</code>, the second parameter can by anything.</p>\n\n<p>The second clause matches everything, and returns <code>False</code> in that case.</p>\n"}], "owner": {"reputation": 432, "user_id": 8402427, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6377f77c32066029c46eed228e1e71e4?s=128&d=identicon&r=PG&f=1", "display_name": "DrJessop", "link": "https://stackoverflow.com/users/8402427/drjessop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 49098188, "answer_count": 2, "score": 0, "last_activity_date": 1520184485, "creation_date": 1520184192, "question_id": 49098148, "link": "https://stackoverflow.com/questions/49098148/how-to-pattern-match-with-algebraic-types-in-haskell", "title": "How to Pattern Match With Algebraic Types in Haskell", "body": "<p>The goal of the assignment I am working on is to create a bunch of different functions that involve searching a data type called a Trie, in which the constructor is defined as </p>\n\n<pre><code>data Trie = MakeTrie Char [Trie] deriving Eq\n</code></pre>\n\n<p>I am tying to first build simple functions so I can figure out how to descend this Trie, but it seems like pattern matching is not working.</p>\n\n<pre><code>test :: Trie -&gt; Bool\ntest t\n    | t == MakeTrie '.' [_] = True\n    | otherwise = False\n</code></pre>\n\n<p>I get an error stating that a hole was found and that relevant bindings include t :: Trie. How can I let the interpreter know that [_] represents a list of Tries? The reason I am doing this is because I have no idea how else do go ahead descending my Trie later if I don't use pattern matching.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1520180688, "post_id": 49097523, "comment_id": 85200205, "body": "Hetrogenous lists in Haskell are not possible (at least not with default lists). You can however make a list <code>[Either String Int]</code>, and then for instance use <code>[Left &quot;a&quot;, Right 2, Right 4, Left &quot;b&quot;]</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1520180916, "post_id": 49097523, "comment_id": 85200297, "body": "First ask yourself why you <i>need</i> strings and integers in the same list."}, {"owner": {"reputation": 115, "user_id": 5033241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3644efeb172840e310cc145def1a0982?s=128&d=identicon&r=PG&f=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/5033241/prometheus"}, "edited": false, "score": 1, "creation_date": 1520181034, "post_id": 49097523, "comment_id": 85200348, "body": "chepner: I don&#39;t know :(  I got this task from my school."}, {"owner": {"reputation": 115, "user_id": 5033241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3644efeb172840e310cc145def1a0982?s=128&d=identicon&r=PG&f=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/5033241/prometheus"}, "edited": false, "score": 0, "creation_date": 1520181076, "post_id": 49097523, "comment_id": 85200365, "body": "Willem: It works, thank you! :)"}], "answers": [{"comments": [{"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "edited": false, "score": 0, "creation_date": 1520268282, "post_id": 49097602, "comment_id": 85235795, "body": "Also explored <code>Dynamic</code> a bit: <a href=\"https://gist.github.com/borkdude/8ef26e016824f59e526d5b31e329bcf1\" rel=\"nofollow noreferrer\">gist.github.com/borkdude/8ef26e016824f59e526d5b31e329bcf1</a>"}], "tags": [], "owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "is_accepted": false, "score": 4, "last_activity_date": 1520180996, "creation_date": 1520180996, "answer_id": 49097602, "question_id": 49097523, "link": "https://stackoverflow.com/questions/49097523/in-haskell-how-can-i-create-a-list-with-multiple-types/49097602#49097602", "title": "In Haskell, how can I create a list with multiple types?", "body": "<pre><code>data StringOrInt\n  = MyString String\n  | MyInt Int\n  deriving (Eq, Show)\n\nx :: [StringOrInt]\nx = [MyString \"a\", MyInt 2]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 5033241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3644efeb172840e310cc145def1a0982?s=128&d=identicon&r=PG&f=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/5033241/prometheus"}, "edited": false, "score": 0, "creation_date": 1520181266, "post_id": 49097619, "comment_id": 85200445, "body": "Thank you, guys! Which solution is the most recommended?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "edited": false, "score": 0, "creation_date": 1520181579, "post_id": 49097619, "comment_id": 85200560, "body": "@MichielBorkent yes, and using something standard has the benefit of being standard, i.e. familiar to most programmers."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 7, "last_activity_date": 1520181064, "creation_date": 1520181064, "answer_id": 49097619, "question_id": 49097523, "link": "https://stackoverflow.com/questions/49097523/in-haskell-how-can-i-create-a-list-with-multiple-types/49097619#49097619", "title": "In Haskell, how can I create a list with multiple types?", "body": "<p>That would be <code>[Either String Integer]</code>.</p>\n\n<p>Note this is not a list that can contain strings and integers, this is a list of \"eithers\" where each \"either\" can contain either a string or an integer (there are two levels of containment). There are various other ways to approximate \"a list which can contain strings and integers\" but they are not recommended </p>\n"}], "owner": {"reputation": 115, "user_id": 5033241, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/3644efeb172840e310cc145def1a0982?s=128&d=identicon&r=PG&f=1", "display_name": "Prometheus", "link": "https://stackoverflow.com/users/5033241/prometheus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1520181064, "creation_date": 1520180515, "question_id": 49097523, "link": "https://stackoverflow.com/questions/49097523/in-haskell-how-can-i-create-a-list-with-multiple-types", "title": "In Haskell, how can I create a list with multiple types?", "body": "<p>I have a task to generate a list which can contains strings and integers too. How can I solve this problem in Haskell?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "edited": false, "score": 2, "creation_date": 1520182774, "post_id": 49095695, "comment_id": 85201024, "body": "<a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids\" rel=\"nofollow noreferrer\">Recommended LYAH reading</a>."}, {"owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "reply_to_user": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "edited": false, "score": 0, "creation_date": 1520183179, "post_id": 49095695, "comment_id": 85201167, "body": "@Alex Thats what I was reading, though i didnt get to the chapter you suggested. I was still confused as to how to effectively use the Maybe type class. Took me a while to even get the snippet of code I showed to work, and when i did it seemed &quot;silly&quot; and useless. But now i know better :)"}, {"owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "reply_to_user": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "edited": false, "score": 1, "creation_date": 1520183624, "post_id": 49095695, "comment_id": 85201345, "body": "@JeffreyPhillipsFreeman <code>Maybe</code> is a workhorse in that book... more functionality (e.g. applicative functor/monad uses) are shown in even later chapters."}, {"owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "reply_to_user": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "edited": false, "score": 0, "creation_date": 1520183976, "post_id": 49095695, "comment_id": 85201465, "body": "@Alex Thanks, looking forward to it. Though I think they could have done a better job at introducing Maybe by at least showing  a bit more basic usage. But hey the book has been golden up until this point so its a minor critique. I&#39;m sure things will make more sense as I continue."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "edited": false, "score": 0, "creation_date": 1520187401, "post_id": 49095695, "comment_id": 85202655, "body": "@JeffreyPhillipsFreeman You are basically asking &quot;Why didn&#39;t they talk about functors before they introduced functors?&quot; There&#39;s very little to <code>Maybe</code> beyond what you correctly used in your question without learning about the type classes of which <code>Maybe</code> is an instance of."}, {"owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1520187567, "post_id": 49095695, "comment_id": 85202720, "body": "@chepner Well wasnt the functor part i was expecting so much. Simply that they introduced Maybe without showing how a function could take Maybe as an argument and use it in some way. I have no issue with the idea that functors themselves came much later."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1520189591, "post_id": 49095695, "comment_id": 85203482, "body": "I feel like <code>Maybe</code>&#39;s reputation preceded it for you. LYAH gives an example of how to pattern match on a custom data type immediately after introducing the <code>data</code> keyword. In the case of <code>Maybe</code>, you just extend that to <code>betterDouble Nothing = Nothing</code> and <code>betterDouble (Just y) = Just (y * 2)</code>. (The pair of preceding definitions is just syntactic sugar, by the way, for the solution you came up with.)"}, {"owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1520190478, "post_id": 49095695, "comment_id": 85203799, "body": "@chepner Yea I see that now. What had confused me at the time was the Nothing. Once I realized how to do it (from the previous hints in the book) it made sense. But for a minute there it was very confusing and was struggling to figure it out. I think its just the case that a noobie for the language is much more easily confused than makes sense for someone who understands it. For now the whole thing feels counter intuitive but im sure with time that will change, I&#39;m just used to other languages."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 7, "last_activity_date": 1520168605, "creation_date": 1520168605, "answer_id": 49095695, "question_id": 49095680, "link": "https://stackoverflow.com/questions/49095680/is-there-a-more-succinct-way-to-write-this-simple-snippet/49095695#49095695", "title": "Is there a more succinct way to write this simple snippet?", "body": "<p>Because <code>Maybe</code> is a Functor, you can use <code>fmap</code> to map over its contents:</p>\n\n<pre><code>betterDouble = fmap (* 2)\n</code></pre>\n"}], "owner": {"reputation": 815, "user_id": 5028702, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/kzikN.jpg?s=128&g=1", "display_name": "Jeffrey Phillips Freeman", "link": "https://stackoverflow.com/users/5028702/jeffrey-phillips-freeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 49095695, "answer_count": 1, "score": 1, "last_activity_date": 1520168605, "creation_date": 1520168528, "question_id": 49095680, "link": "https://stackoverflow.com/questions/49095680/is-there-a-more-succinct-way-to-write-this-simple-snippet", "title": "Is there a more succinct way to write this simple snippet?", "body": "<p>So I am trying to learn haskell and when playing with the Maybe type I came up with this simple code snippet</p>\n\n<pre><code>import Data.Maybe\nbetterDouble :: Maybe Int -&gt; Maybe Int\nbetterDouble x =\n    case x of\n         Just y -&gt; Just (y * 2)\n         Nothing -&gt; Nothing\n</code></pre>\n\n<p>This seems clunky and verbose. I cant help but feel there is a more succinct way of writing this in haskell. What is an idiomatic or succinct way I could rewrite that code block?</p>\n"}, {"tags": ["haskell", "combinatorics"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1520133005, "post_id": 49090939, "comment_id": 85188441, "body": "Oh dear. I suspect the <code>dropQuals</code> function which is intended to discard module names, e.g. turning <code>Math.Combinatorics.Species.Set</code> into just <code>Set</code>, is malfunctioning and turning the type constructor <code>:.:</code> into just <code>:</code>. What happens if you use <code>S.enumerate S.partition [1,2,3] :: [(S.Set S.:.: S.Set) I.Int]</code>?"}, {"owner": {"reputation": 41, "user_id": 8064494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd9f057e367fd620a7b8edb0e9aa998?s=128&d=identicon&r=PG&f=1", "display_name": "vamsikal", "link": "https://stackoverflow.com/users/8064494/vamsikal"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1520135562, "post_id": 49090939, "comment_id": 85188889, "body": "Thanks a bunch! It worked!! =====&gt; <code>vamsi@vamsi-laptop:~&#47;learn&#47;project_euler&#47;257_to_384&#47;problem_&zwnj;&#8203;259$ ghci -XNoImplicitPrelude -XTypeOperators</code> <code>GHCi, version 8.0.2: http:&#47;&#47;www.haskell.org&#47;ghc&#47;  :? for help</code> <code>&gt; import qualified Math.Combinatorics.Species as S</code> <code>S&gt; import qualified Data.Int as I</code> <code>S I&gt; S.enumerate S.partition [1,2,3] :: [(S.Set S.:.: S.Set) I.Int]</code> <code>[{{1,2,3}},{{2,3},{1}},{{2},{1,3}},{{3},{1,2}},{{3},{2},{1}}&zwnj;&#8203;]</code>"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1520152583, "post_id": 49090939, "comment_id": 85192138, "body": "@DanielWagner Could you be bothered to open an <a href=\"https://github.com/byorgey/species/issues\" rel=\"nofollow noreferrer\">issue</a> so that everyone benefits from this discovery?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1520170305, "post_id": 49090939, "comment_id": 85196824, "body": "@IgnatInsarov No need to get aggressive. I just wanted to make sure I had the right solution before taking action. Normally I do that by installing the appropriate packages into a sandbox and testing myself, but I wasn&#39;t in a position where I could do that last night."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1520251103, "post_id": 49090939, "comment_id": 85224846, "body": "@DanielWagner I did not mean to be aggressive at all; I&#39;m sorry if it sounded so. English is my second language; I must have missed some nuance."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1520265155, "post_id": 49090939, "comment_id": 85233707, "body": "@IgnatInsarov Oh, great! Sorry I read that into your message, then. Cheers!"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1520170237, "creation_date": 1520170237, "answer_id": 49095952, "question_id": 49090939, "link": "https://stackoverflow.com/questions/49090939/using-haskell-math-combinatorics-species-to-enumerate-partitions/49095952#49095952", "title": "Using Haskell Math.Combinatorics.Species to enumerate partitions", "body": "<p>Seems this is a bug in the pretty-printer used by <code>structureType</code>. I've reported the problem <a href=\"https://github.com/byorgey/species/issues/3\" rel=\"nofollow noreferrer\">here</a>; in the meantime, you should probably use <code>:.:</code> any time you see just <code>:</code> as a type constructor. So, like this:</p>\n\n<pre><code>S I&gt; S.enumerate S.partition [1,2,3] :: [(S.Set S.:.: S.Set) I.Int]\n[{{1,2,3}},{{2,3},{1}},{{2},{1,3}},{{3},{1,2}},{{3},{2},{1}}]\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 8064494, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd9f057e367fd620a7b8edb0e9aa998?s=128&d=identicon&r=PG&f=1", "display_name": "vamsikal", "link": "https://stackoverflow.com/users/8064494/vamsikal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520170237, "creation_date": 1520125803, "question_id": 49090939, "link": "https://stackoverflow.com/questions/49090939/using-haskell-math-combinatorics-species-to-enumerate-partitions", "title": "Using Haskell Math.Combinatorics.Species to enumerate partitions", "body": "<p>The following interaction shows how to enumerate the subsets of a set using the latest (version 0.4) of the Math.Combinatorics.Species library available for Haskell. I would like to figure out how to use the same library to enumerate partitions of a set, but I cannot understand and fix the type errors I get. More specifically, I do not understand the structureType of partition, what does \": Set Set\" mean?</p>\n\n<pre><code>vamsi@vamsi-laptop:~/learn/project_euler$ ghci -XNoImplicitPrelude\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\n&gt; import qualified Math.Combinatorics.Species as S\nS&gt; import qualified Data.Int as I\nS I&gt; S.structureType S.subset\n\"Set\"\nS I&gt; S.enumerate S.subset [1,2,3] :: [S.Set I.Int]\n[{},{3},{2},{2,3},{1},{1,3},{1,2},{1,2,3}]\nS I&gt; S.structureType S.partition\n\": Set Set\"\nS I&gt; S.enumerate S.partition [1,2,3] :: [S.Set (S.Set I.Int)]\n\n&lt;interactive&gt;:6:26: error:\n    \u2022 No instance for (GHC.Num.Num (S.Set I.Int))\n      arising from the literal \u20181\u2019\n    \u2022 In the expression: 1\n      In the second argument of \u2018S.enumerate\u2019, namely \u2018[1, 2, 3]\u2019\n      In the expression:\n      S.enumerate S.partition [1, 2, 3] :: [S.Set (S.Set I.Int)]\nS I&gt; S.enumerate S.partition [1,2,3] :: [(S.Set I.Int)]\n[{*** Exception: Structure type mismatch.\nExpected: Set Int\nInferred: : Set Set Int\nCallStack (from HasCallStack):\n  error, called at ./Math/Combinatorics/Species/Enumerate.hs:176:33 in \n  species-0.4-DcNHk9r6nze3hHzRydgNb3:Math.Combinatorics.Species.Enumerate\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "is_accepted": false, "score": 2, "last_activity_date": 1520117554, "creation_date": 1520117554, "answer_id": 49090084, "question_id": 49090033, "link": "https://stackoverflow.com/questions/49090033/how-to-generate-cabal-file-from-package-yml/49090084#49090084", "title": "How to generate .cabal file from package.yml", "body": "<p>Never mind, I figured out. It should be <code>package.yaml</code> instead of <code>package.yml</code></p>\n"}, {"tags": [], "owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "is_accepted": false, "score": 5, "last_activity_date": 1577541622, "creation_date": 1577541622, "answer_id": 59511556, "question_id": 49090033, "link": "https://stackoverflow.com/questions/49090033/how-to-generate-cabal-file-from-package-yml/59511556#59511556", "title": "How to generate .cabal file from package.yml", "body": "<p>Since this is the top result on DuckDuckGo for \"How to generate .cabal file from package.yml\" I'm going to answer the question literally (since I was just wondering):</p>\n\n<p>You run <code>hpack</code> in the directory containing the <code>package.yaml</code>.</p>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 674, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1577541622, "creation_date": 1520117186, "last_edit_date": 1520126904, "question_id": 49090033, "link": "https://stackoverflow.com/questions/49090033/how-to-generate-cabal-file-from-package-yml", "title": "How to generate .cabal file from package.yml", "body": "<p>I removed package.yml file to use .cabal file instead. Now I'd like to try defining everything in package.yml, and let stack to generate .cabal file auatomatically. </p>\n\n<p>But when I manually converted .cabal file to package.yml and delete .cabal file and ran <code>stack build</code>, it shows me this error:</p>\n\n<pre><code>Stack looks for packages in the directories configured in the 'packages' variable defined in your stack.yaml\nThe current entry points to /Users/leo/zhangchiqing/hello/ but no .cabal file could be found there.\n</code></pre>\n\n<p>How can I generate the .cabal file from package.yml?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1520109363, "post_id": 49088883, "comment_id": 85183376, "body": "Though one possible answer uses higher order functions, there are also solutions that do not. I have removed that tag, and several others like it that describe only a subset of possible solutions (hence are not inherent to the question)."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1520112247, "post_id": 49089155, "comment_id": 85184253, "body": "According to preference, it can also be written as a list comprehension <code>calcList v xs = [xLogX | x &lt;- xs, x &gt; 0, let xLogX = x * log x, xLogX &gt; v]</code> or in <code>do</code> notation <code>calcList v xs = do { x &lt;- xs; guard (x &gt; 0); let xLogX = x * log x; guard (xLogX &gt; v); pure v }</code>. I like your version with composition the best, though, because it\u2019s slightly more flexible for future modification and factoring."}, {"owner": {"reputation": 61, "user_id": 6937852, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/o4F14.jpg?s=128&g=1", "display_name": "Tony Stark", "link": "https://stackoverflow.com/users/6937852/tony-stark"}, "edited": false, "score": 0, "creation_date": 1522108688, "post_id": 49089155, "comment_id": 86008884, "body": "What would this Haskell code look like as a python list comprehension?"}, {"owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "reply_to_user": {"reputation": 61, "user_id": 6937852, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/o4F14.jpg?s=128&g=1", "display_name": "Tony Stark", "link": "https://stackoverflow.com/users/6937852/tony-stark"}, "edited": false, "score": 1, "creation_date": 1522170517, "post_id": 49089155, "comment_id": 86042947, "body": "@AnthonyParker <code>[a for a in [x * np.log(x) for x in xs if x &gt; 0] if a &gt; v]</code>."}], "tags": [], "owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "is_accepted": false, "score": 5, "last_activity_date": 1520113810, "last_edit_date": 1520113810, "creation_date": 1520110745, "answer_id": 49089155, "question_id": 49088883, "link": "https://stackoverflow.com/questions/49088883/haskell-numeric-list-processing/49089155#49089155", "title": "Haskell numeric list processing", "body": "<p>So it looks like there are 3 steps.</p>\n\n<ol>\n<li>Get rid of elements &lt;= 0 (<code>filter</code>)</li>\n<li>Multiply each remaining elements by its natural log (<code>map</code>)</li>\n<li>Get rid of elements &lt;= <code>v</code> (<code>filter</code>)</li>\n</ol>\n\n<p>Instead of applying these each to an input, we can compose the functions using <code>(.)</code> (since<code>f.g == \\x -&gt; f (g x)</code>).</p>\n\n<pre><code>calcList = \\v -&gt; filter (&gt;v) . map (\\x -&gt; x*log x) . filter (&gt;0)\n</code></pre>\n\n<p>You should checkout the docs on <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:filter\" rel=\"nofollow noreferrer\"><code>filter</code></a> and <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:map\" rel=\"nofollow noreferrer\"><code>map</code></a>. Also <a href=\"http://learnyouahaskell.com/higher-order-functions\" rel=\"nofollow noreferrer\">this chapter</a> from <strong>Learn You A Haskell</strong> would be a good read.</p>\n"}, {"comments": [{"owner": {"reputation": 61, "user_id": 6937852, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/o4F14.jpg?s=128&g=1", "display_name": "Tony Stark", "link": "https://stackoverflow.com/users/6937852/tony-stark"}, "edited": false, "score": 0, "creation_date": 1520115859, "post_id": 49089189, "comment_id": 85185205, "body": "I am unfamiliar with the use of brackets and semicolons in Haskell."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1520123300, "post_id": 49089189, "comment_id": 85186927, "body": "I think it would be much more idiomatic to write something like <code>if positive x &amp;&amp; calcValue x &gt; v then ... else ...</code>."}], "tags": [], "owner": {"reputation": 3627, "user_id": 3695939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d75f41bcfc1d3f20c084ec7e87d82012?s=128&d=identicon&r=PG&f=1", "display_name": "moondaisy", "link": "https://stackoverflow.com/users/3695939/moondaisy"}, "is_accepted": false, "score": 0, "last_activity_date": 1520110992, "creation_date": 1520110992, "answer_id": 49089189, "question_id": 49088883, "link": "https://stackoverflow.com/questions/49088883/haskell-numeric-list-processing/49089189#49089189", "title": "Haskell numeric list processing", "body": "<p>Another approach could be</p>\n\n<pre><code>calcList :: Double -&gt; [Double] -&gt; [Double]\ncalcList v [] = []\ncalcList v (x:xs) = case (positive x) of {\n                   False -&gt; calcList v xs;\n                   True -&gt; case ((calcValue x) &gt; v) of {\n                            False -&gt; calcList v xs;\n                            True -&gt; (calcValue x):(calcList v xs);\n                   };\n}\n</code></pre>\n\n<p>In each of the <code>cases</code> you check for one of the conditions, plus you add the numbers at the beginning of the list so the order will be the same.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1520115057, "creation_date": 1520115057, "answer_id": 49089765, "question_id": 49088883, "link": "https://stackoverflow.com/questions/49088883/haskell-numeric-list-processing/49089765#49089765", "title": "Haskell numeric list processing", "body": "<p>We can use an approach where we use functions like <code>filter</code>, and <code>map</code>. An equivalent solution can be obtained with <em>list comprehension</em>:</p>\n\n<pre><code>calcList :: (Ord d, Floating d) =&gt; d -&gt; [d] -&gt; [d]\ncalcList v xs = [xlogx | x &lt;- xs, x &gt; 0, let xlogx = x * log x, xlogx &gt; v]\n</code></pre>\n\n<p>We thus here use <code>x &lt;- xs</code> to iterate over the elements in <code>xs</code>, by using <code>x &gt; 0</code> we filter values such that only values where <code>x &gt; 0</code> are considered. Next we define a variable <code>xlogx</code> as <code>let xlogx = x * log x</code>, and then we have an extra filter that checks if <code>xlogx &gt; v</code>.</p>\n\n<p>The yield part of the list comprehension (the part before the pipe char <code>|</code>) specifies that we add <code>xlogx</code> to the list.</p>\n"}], "owner": {"reputation": 61, "user_id": 6937852, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/o4F14.jpg?s=128&g=1", "display_name": "Tony Stark", "link": "https://stackoverflow.com/users/6937852/tony-stark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1520115057, "creation_date": 1520108798, "last_edit_date": 1520112520, "question_id": 49088883, "link": "https://stackoverflow.com/questions/49088883/haskell-numeric-list-processing", "title": "Haskell numeric list processing", "body": "<p>I am having trouble finishing this problem. Any hints to a possible solution will be appreciated.</p>\n\n<p>Given a <code>Double</code> value <code>v</code> and a list of <code>Double</code> values <code>xs</code>, <code>calcList</code> returns a list of <code>Double</code>s\naccording to the following rules:</p>\n\n<ol>\n<li><p>For each value <code>x</code> in <code>xs</code>, if <code>x</code> is not positive, there will be no corresponding value in the output list.</p></li>\n<li><p>Otherwise, the corresponding output value will be <code>x * ln x</code>.</p></li>\n<li><p>However, this value will be in the output list if and only if its value is greater than <code>v</code>.</p></li>\n<li><p>The order of the corresponding output values (if present) should be the same as the input\nvalues.</p></li>\n</ol>\n\n<p>The followings are some examples:</p>\n\n<pre><code>calcList 1.0 [] = []\ncalcList 1.0 [3.0] = [3.2958]\ncalcList 1.0 [-1.0, 1.0, 3.0, 5.0, 7.0, 9.0] = [3.2958, 8.0472, 13.6214, 19.7750]\ncalcList 100.0 [1.0 .. 40.0] = [102.0359, 106.4536, 110.9035, 115.3847, 119.8963, 124.4372, 129.0067, 133.6040, 138.2283, 142.8789, 147.5552]\n</code></pre>\n\n<p>This what I have so far:</p>\n\n<pre><code>positive :: Double -&gt; Bool\npositive x = x &gt; 0.0\n\ncalcValue :: Double -&gt; Double\ncalcValue x = log x * x\n\ncalcList :: Double -&gt; [Double] -&gt; [Double]\ncalcList v xs = []\ncalcList v xs\n</code></pre>\n"}, {"tags": ["haskell", "category-theory"], "answers": [{"comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1520108496, "post_id": 49088664, "comment_id": 85183113, "body": "This is very helpful! Do you know of any other use of this <code>(-&gt;)</code> type constructor? And what stopped the masterminds behind it from making it infix-readable after they already made it infix-showable?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1520108599, "post_id": 49088664, "comment_id": 85183151, "body": "@IgnatInsarov I don&#39;t understand your comment. You use <code>-&gt;</code> every time you write a function type. And what do you mean by infix-readable / infix-showable?"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1520109141, "post_id": 49088664, "comment_id": 85183299, "body": "Oh, right. I can use <code>-&gt;</code> infix, but I can&#39;t use it as an infix section. My question, then, is whether there are any other uses of a partially applied <code>-&gt;</code> type constructor out there, because I never saw one."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 2, "creation_date": 1520109420, "post_id": 49088664, "comment_id": 85183397, "body": "@IgnatInsarov, it is used without arguments in <code>instance Category (-&gt;)</code> and <code>instance Arrow (-&gt;)</code>."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 1, "creation_date": 1520110045, "post_id": 49088664, "comment_id": 85183596, "body": "@IgnatInsarov A partially applied <code>(-&gt;)</code> can be used as the functor parameter to <code>Cofree</code>, resulting in a Moore machine: <a href=\"http://hackage.haskell.org/package/free-5/docs/Control-Comonad-Cofree.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/free-5/docs/&hellip;</a>"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 4, "last_activity_date": 1520107367, "creation_date": 1520107367, "answer_id": 49088664, "question_id": 49088510, "link": "https://stackoverflow.com/questions/49088510/how-does-an-environment-happen-to-be-a-partially-applied-function-and-even-a-ho/49088664#49088664", "title": "How does an environment happen to be a partially applied function, and even a hom functor?", "body": "<p>I can't answer all of your questions, but let's start with the easy ones:</p>\n\n<blockquote>\n  <p><code>(-&gt;) r</code> (why not just write <code>(r -&gt;)</code>?)</p>\n</blockquote>\n\n<p>Because the latter is a syntax error in Haskell. You can't use this section syntax on types.</p>\n\n<hr>\n\n<blockquote>\n  <p>... claiming that it is a <em>partially applied function</em>.</p>\n</blockquote>\n\n<p>That's not what it's saying. The quote is:</p>\n\n<blockquote>\n  <p>the partially applied function type <code>(-&gt;) r</code> is a simple reader monad</p>\n</blockquote>\n\n<p>It's a partially applied <em>type</em>, not a partially applied function. Or in other words, it's parsed like this: ((partially applied) (function type))</p>\n\n<p>The type constructor for function types in Haskell is spelled <code>-&gt;</code>.</p>\n\n<p>A fully applied function type looks like <code>r -&gt; a</code> (or equivalently <code>(-&gt;) r a</code>), where <code>r</code> is the argument type and <code>a</code> the result type.</p>\n\n<p>Thus <code>(-&gt;) r</code> is a partial application of <code>-&gt;</code> (the function type).</p>\n\n<hr>\n\n<p>If we ignore monad transformers and <code>ReaderT</code>, the straightforward definition of <code>Reader</code> is:</p>\n\n<pre><code>newtype Reader r a = Reader (r -&gt; a)\n\nrunReader :: Reader r a -&gt; r -&gt; a\nrunReader (Reader f) x = f x\n-- or rather:\nrunReader :: Reader r a -&gt; (r -&gt; a)\nrunReader (Reader f) = f\n</code></pre>\n\n<p>or equivalently:</p>\n\n<pre><code>newtype Reader r a = Reader{ runReader :: r -&gt; a }\n</code></pre>\n\n<p>That is, <code>Reader</code> is just a newtype for <code>-&gt;</code> (a very thin wrapper), with <code>runReader</code> for unwrapping.</p>\n\n<p>You can even make <code>-&gt;</code> an instance of <code>MonadReader</code> just by copying the instance for <code>Reader</code> and removing all the <code>Reader</code> / <code>runReader</code> wrapping/unwrapping.</p>\n"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1520107367, "creation_date": 1520106448, "question_id": 49088510, "link": "https://stackoverflow.com/questions/49088510/how-does-an-environment-happen-to-be-a-partially-applied-function-and-even-a-ho", "title": "How does an environment happen to be a partially applied function, and even a hom functor?", "body": "<p>I have seen <code>Reader</code> being used to major benefit many times in the wild. <em>(One notable example would be <code>stack</code>, <a href=\"https://www.fpcomplete.com/blog/2017/07/the-rio-monad\" rel=\"nofollow noreferrer\">built around</a> a straightforward derivative of <code>Reader</code> that can inform the user of the sufficiency of its contents on the type level.)</em> After some thinking, I arrived to an understanding that this benefit is merely on the level of code structure, and, in a sense, all that <code>Reader</code> does is supply a parameter, in many places, to a complicated wiring of functions. That is, I came to believe we can always replace a reader that holds some <code>x</code> with a lambda abstraction of form <code>\u03bbx. ... x ... x ...</code>. This seems to align with the <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Reader.html#t:MonadReader\" rel=\"nofollow noreferrer\">official explanations</a> that claim:</p>\n\n<blockquote>\n  <p>... the partially applied function type (->) r is a simple reader monad ...</p>\n</blockquote>\n\n<p>However, there is a long way from noting that <code>Reader</code> is a way to write down a lambda abstraction piecewise, to claiming that it is a <em>partially applied function</em>.</p>\n\n<ol>\n<li><p>Is there a function that is applied, but not partially? It would simply be a value:</p>\n\n<pre><code>\u03bb :t id 1\nid 1 :: Num a =&gt; a\n\u03bb :t 1\n1 :: Num a =&gt; a\n</code></pre></li>\n<li><p>Is there a function that is not even partially applied? We'll never know:</p>\n\n<pre><code>\u03bb :t fromMaybe\nfromMaybe :: a -&gt; Maybe a -&gt; a\n\u03bb :t flip maybe id\nflip maybe id :: b -&gt; Maybe b -&gt; b\n</code></pre></li>\n</ol>\n\n<p>Even ignoring this as nitpicking, I would not take on faith that <code>(-&gt;) r</code> <em>(why not just write <code>(r -&gt;)</code>?)</em> is exactly and singularly a <code>Reader</code> monad. Maybe I could write an instance that typechecks. Maybe it would even obey the laws. As long as I do not <em>think</em> of my functions as <code>Reader</code>s, as long as I do not have the right intuition, the vision of it, it is as useful to me as the first proof of the Four Colour Theorem. On the other hand, how can I be sure this is the only way of defining a monad on functions? There are several <code>Monoid</code>s on <code>Num</code>, at least two <code>Applicative</code>s on <code>List</code>s \u2212 would it not be too reckless to consider a function a <code>Reader</code> monad alone?</p>\n\n<p>The predicament does not end here. Once I go searching for an answer, I stumble upon an <a href=\"https://stackoverflow.com/q/6702169/2108477\">even more puzzling</a> note: <code>Reader</code> happens to be the <code>hom</code> functor now, or even a representable functor in general. And the folks from the other end of the spectrum actually know ahead of time that there would be such a construct in Haskell, and even spell its type, the same as it is spelled in the aforementioned official explanations. Now, this is way over my head, but I can parse the definition of <code>hom</code> functor from Mac Lane. With some imagination, it can be seen that, granted a function <code>a -&gt; b</code> as a morphism in the (supposed) category <strong>Hask</strong>, we may compose it with <code>id</code> to obtain... a function <code>a -&gt; b</code> again, this time as an element of the set <code>hom(a, b)</code>.</p>\n\n<p>Does this connect in any way with some of these morphisms being <em>partially applied</em>? Or with the use of <code>Reader</code> as option store in <code>stack</code>? Can I actually be shown the object and arrow functions of the hom functor <strong>Hask</strong> -> <strong>Set</strong>? <em>(I shall take an endofunctor <strong>Hask</strong> -> <strong>Hask</strong> as a reasonable approximation.)</em> Would that be my trusty fellows <code>pure</code> and <code>fmap</code>?</p>\n\n<p>And, well, how do I actually use <code>Reader</code>, after that?</p>\n"}, {"tags": ["haskell", "transform", "combinations"], "comments": [{"owner": {"reputation": 7185, "user_id": 4949918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49ebe74084d2bf2feab20ec74c7b05ba?s=128&d=identicon&r=PG&f=1", "display_name": "Axnyff", "link": "https://stackoverflow.com/users/4949918/axnyff"}, "edited": false, "score": 2, "creation_date": 1520097237, "post_id": 49086884, "comment_id": 85179179, "body": "It seems like [1, -2] and [3, -4] are missing in your example"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1520097379, "post_id": 49086884, "comment_id": 85179231, "body": "Did you try anything yourself? It is furthermore not really clear to me why the output has type <code>[[n]]</code>, instead of <code>[[[n]]]</code>."}, {"owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "edited": false, "score": 2, "creation_date": 1520097464, "post_id": 49086884, "comment_id": 85179255, "body": "Are the sublists always of length 2?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 7185, "user_id": 4949918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49ebe74084d2bf2feab20ec74c7b05ba?s=128&d=identicon&r=PG&f=1", "display_name": "Axnyff", "link": "https://stackoverflow.com/users/4949918/axnyff"}, "edited": false, "score": 0, "creation_date": 1520097642, "post_id": 49086884, "comment_id": 85179317, "body": "You are right @Axnyff, they are missing."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1520098228, "post_id": 49086884, "comment_id": 85179523, "body": "This looks like two operations at once: 1) Generate all possible sign variations for a single list. 2) Apply the operation from #1 to a list of inputs and collect the results. Operation #2 is <code>map</code> / <code>concatMap</code>."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "edited": false, "score": 0, "creation_date": 1520098506, "post_id": 49086884, "comment_id": 85179633, "body": "@Alex no, the lists are of length 4 usually."}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520099517, "post_id": 49087193, "comment_id": 85180062, "body": "Looks good. Thanks a lot. I will test on my real case and surely upvote and accept later."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1520108956, "post_id": 49087193, "comment_id": 85183250, "body": "<code>signs = mapM (\\x -&gt; [x,-x])</code>"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1520110042, "post_id": 49087193, "comment_id": 85183595, "body": "There&#39;s one issue with your code Csongor: the case of 0. <code>signsAll [[0,2],[2,3]] [[0,2],[0,-2],[0,2],[0,-2],[2,3],[2,-3],[-2,3],[-2,-3]]</code>. You see the duplicates ? I&#39;m too tired this evening to fix that."}, {"owner": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1520113219, "post_id": 49087193, "comment_id": 85184526, "body": "@DanielWagner there&#39;s the zero issue."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 20860, "user_id": 2034787, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/78471a5b1bfa8b48d2056ff99a875f50?s=128&d=identicon&r=PG", "display_name": "\u05d2\u05dc\u05e2\u05d3 \u05d1\u05e8\u05e7\u05df", "link": "https://stackoverflow.com/users/2034787/%d7%92%d7%9c%d7%a2%d7%93-%d7%91%d7%a8%d7%a7%d7%9f"}, "edited": false, "score": 1, "creation_date": 1520120402, "post_id": 49087193, "comment_id": 85186327, "body": "@\u05d2\u05dc\u05e2\u05d3\u05d1\u05e8\u05e7\u05df No problem, <code>signs = mapM (\\x -&gt; nub [x,-x])</code>."}], "tags": [], "owner": {"reputation": 675, "user_id": 485482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aIf9p.png?s=128&g=1", "display_name": "Csongor Kiss", "link": "https://stackoverflow.com/users/485482/csongor-kiss"}, "is_accepted": true, "score": 6, "last_activity_date": 1520098828, "creation_date": 1520098828, "answer_id": 49087193, "question_id": 49086884, "link": "https://stackoverflow.com/questions/49086884/generate-all-changes-of-signs/49087193#49087193", "title": "Generate all changes of signs", "body": "<p>The problem can be broken down to 2 steps:</p>\n\n<ol>\n<li>For a given list of numbers, generate all the possible signs</li>\n<li>For the list of lists, apply the function from (1) to each list, then concat the results.</li>\n</ol>\n\n<p>For 1. you can write a simple recursive function that first processes the tail of the list, then for each resulting combination, it generates two versions for the two signs.</p>\n\n<pre><code>signs :: [Int] -&gt; [[Int]]\nsigns [] = [[]]\nsigns (x : xs)\n  = let ps = signs xs\n    in map (x :) ps ++ map ((-x) :) ps\n</code></pre>\n\n<p>For 2. simply map the <code>signs</code> function over the input, and concat them. This is what the <code>concatMap</code> function does:</p>\n\n<pre><code>signsAll :: [[Int]] -&gt; [[Int]]\nsignsAll = concatMap signs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "is_accepted": false, "score": 4, "last_activity_date": 1520112295, "creation_date": 1520112295, "answer_id": 49089353, "question_id": 49086884, "link": "https://stackoverflow.com/questions/49086884/generate-all-changes-of-signs/49089353#49089353", "title": "Generate all changes of signs", "body": "<p>I tried to use an applicative here, because it looks like you are almost there</p>\n\n<pre><code>[id,negate] &lt;*&gt; [3,4]\n</code></pre>\n\n<p>but it turned out that I need <code>sequence</code> and <code>map</code>, which, in this case, can be combined into a <code>traverse</code>:</p>\n\n<pre><code>traverse (\\x-&gt;[x,-x]) [3,4]\n[[3,4],[3,-4],[-3,4],[-3,-4]]\n</code></pre>\n\n<p>As others mentioned, now you need <code>concatMap</code> for your function:</p>\n\n<pre><code>concatMap (traverse (\\x-&gt;[x,-x])) [[3,4],[1,2]]\n[[3,4],[3,-4],[-3,4],[-3,-4],[1,2],[1,-2],[-1,2],[-1,-2]]\n</code></pre>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 49087193, "answer_count": 2, "score": 2, "last_activity_date": 1520112295, "creation_date": 1520097106, "last_edit_date": 1520098445, "question_id": 49086884, "link": "https://stackoverflow.com/questions/49086884/generate-all-changes-of-signs", "title": "Generate all changes of signs", "body": "<p>I have many lists. Say for short <code>[[1,2],[3,4]]</code>. \nI need to generate all changes of signs of each element. Thus, for the short example, the result would be </p>\n\n<pre><code>[[1,2],[3,4],[-1,2],[1,-2],[-1,-2],[-3,4],[3,-4],[-3,-4]]\n</code></pre>\n\n<p>Is there a package to perform such an operation ? Otherwise what algorithm could I use ? (I confess I have not thought a lot about it ...). </p>\n\n<p>It this can help, all my lists have the same length.</p>\n\n<h1>Edit</h1>\n\n<p>Hmm.. maybe an idea like that:</p>\n\n<pre><code>x = [[2*i,2*j] | i &lt;- [1, -1], j &lt;- [-1,1]]\nx\n[[2,-2],[2,2],[-2,-2],[-2,2]]\n</code></pre>\n"}, {"tags": ["haskell", "union-types"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1520090105, "post_id": 49085635, "comment_id": 85176624, "body": "It is a <i>data constructor</i>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1520091583, "post_id": 49085635, "comment_id": 85177148, "body": "It is worth noting that the <i>type</i> constructor here is <code>Maybe</code> (as opposed to <code>Nothing</code> and <code>Just</code>)."}, {"owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "edited": false, "score": 0, "creation_date": 1520094767, "post_id": 49085635, "comment_id": 85178325, "body": "<code>Maybe</code> is a type constructor... Give <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#type-parameters\" rel=\"nofollow noreferrer\">this LYAH page</a> a read."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1520102736, "post_id": 49085635, "comment_id": 85181217, "body": "Keep in mind that when you see a declaration like e.g. <code>data T a = X a | Y Int | Z</code>, that <code>T</code> <i>only</i> ever appears in type signatures, while <code>X</code>, <code>Y</code> and <code>Z</code> <i>only</i> appear in code (i.e. at the term level). The syntax involves a lot of punning, and is quite confusing imo; e.g. <code>Y Int</code> in the declaration mixes type and term-level things in order to express &quot;Y takes a single <code>Int</code>-type argument&quot;, yet in code it&#39;s used like <code>Y 42</code> or <code>Y (someNumber + 1)</code>. It&#39;s obviously never applied to a <i>type</i>"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 10, "last_activity_date": 1520090259, "creation_date": 1520090259, "answer_id": 49085664, "question_id": 49085635, "link": "https://stackoverflow.com/questions/49085635/in-haskell-if-maybe-is-a-type-or-an-union-type-how-do-you-call-nothing/49085664#49085664", "title": "In Haskell, if Maybe is a Type or an Union Type, how do you call `Nothing`?", "body": "<p>It is a <a href=\"https://wiki.haskell.org/Constructor#Data_constructor\" rel=\"noreferrer\"><strong>data constructor</strong></a>. Since it has no arguments, it is also called a <strong>constant</strong> and <strong>nullary data constructor</strong>.</p>\n\n<p>These data constructors group values (well here there are no values) together, together with a <em>tag</em>: some sort of identifier that identifies that it is a <code>Nothing</code>, and not a <code>Just</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 4, "last_activity_date": 1520218190, "last_edit_date": 1520218190, "creation_date": 1520106884, "answer_id": 49088584, "question_id": 49085635, "link": "https://stackoverflow.com/questions/49085635/in-haskell-if-maybe-is-a-type-or-an-union-type-how-do-you-call-nothing/49088584#49088584", "title": "In Haskell, if Maybe is a Type or an Union Type, how do you call `Nothing`?", "body": "<p><code>Nothing</code> is also called a \"case\" of the \"variant\" (or \"variant type\") <code>Maybe a</code>. This terminology is used more frequently in OCaml than in Haskell, e.g., <a href=\"https://realworldocaml.org/v1/en/html/variants.html\" rel=\"nofollow noreferrer\">Real World OCaml chapter of variants</a> (I don't know what is common in other languages).</p>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 447, "favorite_count": 0, "accepted_answer_id": 49085664, "answer_count": 2, "score": 2, "last_activity_date": 1520218190, "creation_date": 1520090067, "question_id": 49085635, "link": "https://stackoverflow.com/questions/49085635/in-haskell-if-maybe-is-a-type-or-an-union-type-how-do-you-call-nothing", "title": "In Haskell, if Maybe is a Type or an Union Type, how do you call `Nothing`?", "body": "<p>In Haskell, a <code>Maybe</code> type can be either a <code>Nothing</code> or a <code>Just a</code></p>\n\n<pre><code>data Maybe = Nothing | Just a\n</code></pre>\n\n<p>If we call <code>Maybe</code> Union Type, what is <code>Nothing</code> then? a <code>Type</code>? No, it's not a type, you can't declare a variable to be <code>Nothing</code> type. </p>\n\n<p>Maybe you would say type constructor, true, but I want to express the fact that <code>Nothing</code> and <code>Just</code> are different cases.</p>\n\n<p>a type value? a type instance? a type case?</p>\n"}, {"tags": ["haskell", "pattern-matching", "typing", "gadt"], "answers": [{"comments": [{"owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "edited": false, "score": 1, "creation_date": 1520090167, "post_id": 49085602, "comment_id": 85176645, "body": "That does it indeed! Thanks for the nice explanation. In hindsight, I guess this is kind of obvious, but I&#39;m still really new to GADTs and still trying to wrap my head around their use. Thanks again :)"}], "tags": [], "owner": {"reputation": 675, "user_id": 485482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aIf9p.png?s=128&g=1", "display_name": "Csongor Kiss", "link": "https://stackoverflow.com/users/485482/csongor-kiss"}, "is_accepted": true, "score": 6, "last_activity_date": 1520089838, "creation_date": 1520089838, "answer_id": 49085602, "question_id": 49085341, "link": "https://stackoverflow.com/questions/49085341/dynamically-pattern-matching-nested-gadt-back-out-of-a-wrapper/49085602#49085602", "title": "Dynamically pattern matching nested GADT back out of a wrapper", "body": "<p>In order to implement a function with the signature\n<code>extractThingWithTKind :: TKind a -&gt; SomeThing -&gt; Either String (Thing a)</code>, we need to be able to decide that what's inside <code>SomeThing</code> is a <code>TKind a</code> or not. GADT constructors are witnesses of such type equalities, but they need to be explicitly pattern-matched on to \"unwrap\" these assumptions in the function's local scope.</p>\n\n<pre><code>extractThingWithTKind :: TKind a -&gt; SomeThing -&gt; Either String (Thing a)\nextractThingWithTKind Foo (SomeThing t@(Thing Foo)) = Right t\nextractThingWithTKind Bar (SomeThing t@(Thing Bar)) = Right t\nextractThingWithTKind _ _ = Left \"nope\"\n</code></pre>\n\n<p>Pattern matching on the first argument gives rise to the assumption that <code>a ~ TFoo</code> (in the first case), and further pattern matching on the second argument proves that the thing inside <code>SomeThing</code> is also a <code>TFoo</code>. Crucially, the individual cases have to be spelled out one by one, as it's the constructors themselves that provide the evidence.</p>\n"}], "owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 49085602, "answer_count": 1, "score": 4, "last_activity_date": 1520089838, "creation_date": 1520088262, "question_id": 49085341, "link": "https://stackoverflow.com/questions/49085341/dynamically-pattern-matching-nested-gadt-back-out-of-a-wrapper", "title": "Dynamically pattern matching nested GADT back out of a wrapper", "body": "<p>I recently asked how to make a homogenous list of GADT instances: <a href=\"https://stackoverflow.com/questions/49078017/function-returning-result-of-any-constructor-of-a-gadt\">Function returning result of any constructor of a GADT</a></p>\n\n<p>tl;dr</p>\n\n<pre><code>{-#LANGUAGE GADTs, EmptyDataDecls #-}\nmodule Main where\n\n-- Define a contrived GADT\ndata TFoo\ndata TBar\ndata Thing a where\n  Foo :: Int -&gt; Thing TFoo\n  Bar :: String -&gt; Thing TBar\n\ndata SomeThing = forall a. SomeThing (Thing a)\n\ncombine :: [SomeThing]\ncombine = [Something $ Foo 1, SomeThing $ Bar \"abc\"]\n</code></pre>\n\n<p>Now, I'm having some trouble dynamically \"unwrapping\" them. Let's say we have this (still contrived, but closer to my real use case) code:</p>\n\n<pre><code>{-#LANGUAGE GADTs, EmptyDataDecls #-}\nmodule Main where\n\n-- Define a contrived GADT\ndata Thing a where\n  Thing :: TKind a -&gt; Thing a\n\ndata TFoo\ndata TBar\ndata TKind a where\n  Foo :: TKind TFoo\n  Bar :: TKind TBar\n\ndata SomeThing = forall a. SomeThing (Thing a)\n\nexample :: SomeThing\nexample = SomeThing $ Thing Foo\n\nextractThingWithTKind :: TKind a -&gt; SomeThing -&gt; Either String (Thing a)\nextractThingWithTKind k st = case st of\n                               SomeThing t@(Thing k) -&gt; Right t\n                               _                     -&gt; Left \"nope\"\n</code></pre>\n\n<p>The above doesn't work because the <code>t</code> in <code>Right t</code> doesn't have the type <code>Thing a</code>. Intrinsically, I understand why this doesn't work. Pattern matching on the <code>k</code> doesn't do what I want (only match if the <code>k</code> is the same as the one passed in). But this is my best stab at approximating what I want. I tried <code>instance</code>ing <code>Eq</code> on <code>TKind a</code>, but because <code>(==) :: a -&gt; a -&gt; Bool</code>, this won't work (the equality depends on potentially disparate types at runtime). I could wrap <code>TKind</code> like I did <code>Thing</code>, but then I'd just be pushing the problem lower.</p>\n\n<p>Removing the dynamism, I tried just pattern matching out a <code>Thing TFoo</code> explicitly:</p>\n\n<pre><code>extractThingWithFoo :: SomeThing -&gt; Either String (Thing TFoo)\nextractThingWithFoo st = case st of\n                            SomeThing t@(Thing Foo) -&gt; Right t\n                            _                       -&gt; Left \"nope\" \n</code></pre>\n\n<p>And that works! But does this mean that I can't do the dynamic matching? It would be a real pain to have to duplicate the above method for each kind <code>TKind</code> (in the non-contrived version, there are many). The only other solution I see is changing <code>SomeThing</code> to be a sum type that has one wrapper for each <code>TKind</code>, but then you're just moving the duplicated code to a different place (and forcing all uses of <code>SomeThing</code> to pattern match each).</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 8, "last_activity_date": 1520088301, "creation_date": 1520088301, "answer_id": 49085345, "question_id": 49085310, "link": "https://stackoverflow.com/questions/49085310/how-does-haskell-know-xs-is-a-list-in-the-function-definition/49085345#49085345", "title": "how does Haskell know `xs` is a list in the function definition?", "body": "<p>You are calling <code>null</code> and <code>tail</code> on <code>xs</code>.</p>\n\n<pre><code>null :: [a] -&gt; Bool\ntail :: [a] -&gt; [a]\n</code></pre>\n\n<p>The arguments to both are lists, so Haskell can infer that, if you are calling <code>null xs</code> or <code>tail xs</code>, the type of <code>xs</code> must be <code>[a]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1520090797, "post_id": 49085455, "comment_id": 85176836, "body": "There are some problems with this answer: (a) Haskell&#39;s type system is <i>not</i> lazy, (b) <code>null</code> returns a <code>Bool</code>, not a list, (c) it does not find these things out at runtime (there are languages that do that, for instance there are Prolog environments that perform abstract compilation). Otherwise I could have constructed a program where I wrote <code>foo = myDrop 3 1</code>, and the compiler would only error in case I indeed called <code>foo</code>, but the compiler will proactively error."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1520095141, "post_id": 49085455, "comment_id": 85178471, "body": "It&#39;s still wrong. Haskell absolutely does know that <code>xs</code> is a list, even if <code>myDrop</code> is never used."}], "tags": [], "owner": {"reputation": 808, "user_id": 482808, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a3d639e38dd5ee07bb6881a6e662eb14?s=128&d=identicon&r=PG", "display_name": "pal", "link": "https://stackoverflow.com/users/482808/pal"}, "is_accepted": false, "score": 0, "last_activity_date": 1520091118, "last_edit_date": 1520091118, "creation_date": 1520088884, "answer_id": 49085455, "question_id": 49085310, "link": "https://stackoverflow.com/questions/49085310/how-does-haskell-know-xs-is-a-list-in-the-function-definition/49085455#49085455", "title": "how does Haskell know `xs` is a list in the function definition?", "body": "<p>It doesn't. Haskell doesn't know that <code>xs</code> is a list until it tries to compile the invocation.</p>\n\n<p>When you call <code>myDrop 3 someList</code> Haskell knows that <code>null someList</code> can accept <code>someList</code>, and that <code>tail someList</code> can be called on <code>someList</code> and returns a list. Haskell's (magical) type system can infer (at compile time) how to compile <code>myDrop n xs</code> with what it already knows.</p>\n\n<p>In theory, if you made some \"not-list\" things that worked for <code>tail</code> and <code>null</code> you could call <code>myDrop 3 notList</code> and get sensible results.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 10, "last_activity_date": 1520089588, "creation_date": 1520089588, "answer_id": 49085565, "question_id": 49085310, "link": "https://stackoverflow.com/questions/49085310/how-does-haskell-know-xs-is-a-list-in-the-function-definition/49085565#49085565", "title": "how does Haskell know `xs` is a list in the function definition?", "body": "<h1>Type inference</h1>\n\n<p>You write:</p>\n\n<pre><code>myDrop n xs = if n &lt;= 0 || null xs\n              then xs\n              else myDrop (n - 1) (tail xs)\n</code></pre>\n\n<p>So Haskell first assumes that the function has type <code>myDrop :: a -&gt; (b -&gt; c)</code> (it first does not make any assumptions regarding the types). So in memory we store:</p>\n\n<pre><code>myDrop :: a -&gt; b -&gt; c\nn :: a\nxs :: b\n</code></pre>\n\n<p>But now it will start deriving types.</p>\n\n<p>We see for instance <code>n &lt;= 0</code>. Now the function <code>(&lt;=)</code> has signature <code>(&lt;=) :: Ord d =&gt; d -&gt; d -&gt; Bool</code>. So that means that <code>0 :: d</code>, and we now that for number <em>literals</em>, it holds that <code>0 :: Num e =&gt; e</code>. So we can add <code>Num a</code> to the type constraint.</p>\n\n<p>We also see <code>null xs</code>, <code>null</code> has signature <code>null :: [f] -&gt; Bool</code>, so that means that <code>a ~ [f]</code> (here <code>~</code> means type equality). We also have to check that the expression <code>n &lt;= 0 || null xs</code> results in a <code>Bool</code> (since it is the condition of the <code>if</code>-<code>then</code>-<code>else</code>. Since <code>(||)</code> has as type <code>(||) :: Bool -&gt; Bool -&gt; Bool</code>, it means that <code>n &lt;= 0</code> and <code>null xs</code> should return <code>Bool</code>s. This holds: since <code>(&lt;=)</code> has type <code>Ord d -&gt; d -&gt; Bool</code>, and <code>null :: [f] -&gt; Bool</code>. So after type inference of the first line, we have:</p>\n\n<pre><code>myDrop :: (Num a, Ord a) =&gt; a -&gt; [f] -&gt; c\nn :: (Num a, Ord a) =&gt; a\nxs :: [f]\n</code></pre>\n\n<p>Now we still need to typecheck the second and third line. In an <code>if</code>-<code>then</code>-<code>else</code> clause, the <code>then</code> expression, and <code>else</code> expression need to have the same type, so we now that the type of <code>xs</code> is the same as <code>myDrop (n-1) (tail xs)</code>. So even without knowing the signature of <code>myDrop (n-1) (tail xs)</code> we know already that it needs to have type <code>myDrop :: g -&gt; h -&gt; [f]</code> (here we currently do not know the type of <code>g</code> and <code>h</code>.</p>\n\n<p>Since we are deriving the type of <code>myDrop</code>, we can check the type we have constructed thus far, with the one we are calling, so we compare it like:</p>\n\n<pre><code>myDrop :: (Num a, Ord a) =&gt; a -&gt; [f] -&gt; c  -- currently derived\nmyDrop ::                   g -&gt; h   -&gt; [f] -- called\n</code></pre>\n\n<p>So we derive that: <code>a ~ g</code>, and <code>c ~ h ~ [f]</code>. So now we know that <code>myDrop</code> has type:</p>\n\n<pre><code>myDrop :: (Num a, Ord a) =&gt; a -&gt; [f] -&gt; [f]\n</code></pre>\n\n<p>We now still need to typecheck the arguments. We see for instance that the first argument in the call is <code>n - 1</code>, the signature of <code>(-)</code> is <code>(-) :: Num i =&gt; i -&gt; i -&gt; i</code>, and <code>1</code> is a number literal, so <code>1 :: Num j =&gt; j</code>, so we derive that in this specific context <code>i ~ j ~ a</code>, and as a result <code>n - 1 :: a</code>, thus holds with the derived type for the function.</p>\n\n<p>We also know that <code>tail</code> has signature <code>tail :: [k] -&gt; [k]</code>. Since we call it with <code>xs :: [f]</code>, we know that <code>f ~ k</code>, and thus <code>tail xs :: [f]</code>, this again holds. We did not had to derive <code>a</code> or <code>f</code>, further, so we can set the type as:</p>\n\n<pre><code>myDrop n xs :: (Num a, Ord a) =&gt; a -&gt; [f] -&gt; [f]\n</code></pre>\n\n<h1>Improving the function</h1>\n\n<p>The above function works, and it will work regardless what input we provide. But I would call it a bit \"unsafe\" in the sense that it works because we work with contracts the function we call (<code>tail</code> and <code>null</code>). For example <code>tail</code> will error in case we provide it an empty list. Yes, this can never happen, since <code>null</code> checks this. But we thus have to reason about that ourselves. It is usually better to work only with <em>total</em> functions: functions that <em>always</em> return valid output.</p>\n\n<p>We can here perform pattern matching in the head of the function. A Haskell compiler can derive that we are missing patterns, so if we turn on that feature, then we can validate that all the cases are covered.</p>\n\n<p>We can write it as:</p>\n\n<pre><code>myDrop :: (Num a, Ord a) =&gt; a -&gt; [f] -&gt; [f]\nmyDrop _ [] = []\nmyDrop n xa@(_:xs) | n &lt;= 0 = xa\n                   | otherwise = myDrop (n-1) xs\n</code></pre>\n\n<p>So here the first line convers the case where the list is empty (regardless what <code>n</code> is, we return an empty list). In case the list is not empty, it has as pattern <code>(_:xs)</code> (and we also keep a reference to <code>xa</code>, the entire list. In case <code>n &lt;= 0</code>, we return <code>xa</code>, otherwise we decrement <code>n</code>, and make a recursive call on the tail.</p>\n"}], "owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 481, "favorite_count": 0, "accepted_answer_id": 49085565, "answer_count": 3, "score": 2, "last_activity_date": 1520091118, "creation_date": 1520088019, "question_id": 49085310, "link": "https://stackoverflow.com/questions/49085310/how-does-haskell-know-xs-is-a-list-in-the-function-definition", "title": "how does Haskell know `xs` is a list in the function definition?", "body": "<p>In <a href=\"http://book.realworldhaskell.org/read/types-and-functions.html\" rel=\"nofollow noreferrer\">book.realworldhaskell.org</a>, types and functions part under <em>Conditional evaluation</em> section, it is given the following example:</p>\n\n<pre><code> -- file: ch02/myDrop.hs\n myDrop n xs = if n &lt;= 0 || null xs\n               then xs\n               else myDrop (n - 1) (tail xs)\n</code></pre>\n\n<p>I did understand the implementation of the function, but my question is that how does Haskell know <code>xs</code> is a <strong>list</strong> ?</p>\n"}, {"tags": ["haskell", "division", "modulo"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1520106253, "last_edit_date": 1520106253, "creation_date": 1520088359, "answer_id": 49085354, "question_id": 49085289, "link": "https://stackoverflow.com/questions/49085289/whats-the-division-rules-of-negative-int-numbers-in-haskell/49085354#49085354", "title": "What&#39;s the division rules of negative int numbers in haskell?", "body": "<p>Usually it a good idea to first look at the documentation. For the <code>mod</code> function, we see:</p>\n\n<blockquote>\n  <p><a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:mod\" rel=\"nofollow noreferrer\"><strong><code>mod :: a -&gt; a -&gt; a</code></strong></a></p>\n  \n  <p>integer modulus, satisfying</p>\n\n<pre><code>(x `div` y)*y + (x `mod` y) == x\n</code></pre>\n</blockquote>\n\n<p>So <code>x `mod` y</code> is calculated as:</p>\n\n<pre><code>mod x y = x - y * (div x y) -- logically equivalent definition\n</code></pre>\n\n<p>And:</p>\n\n<blockquote>\n  <p><a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:div\" rel=\"nofollow noreferrer\"><strong><code>div :: a -&gt; a -&gt; a</code></strong></a></p>\n  \n  <p>integer division truncated <strong>toward negative infinity</strong>.</p>\n</blockquote>\n\n<p>So in case the division is <code>-3.5</code>, the <code>div</code> will return <code>-4</code>.</p>\n\n<p>So:</p>\n\n<pre><code>mod 7 2       = 7 - 2*(div 7 2)         = 7 - 2 * 3       = 7 - 6    = 1\nmod 7 (-2)    = 7 - (-2)*(div 7 (-2))   = 7 - (-2) * (-4) = 7 - 8    = -1\nmod (-7) 2    = (-7) - 2 * (div (-7) 2) = (-7) - 2 * (-4) = (-7) + 8 = 1\nmod (-7) (-2) = (-7) - (-2) * (div (-7) (-2)) = -7 - (-2) * 3 = -7 + 6 = -1\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 5448549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55e09f85241547a3d2332a1c53862be9?s=128&d=identicon&r=PG&f=1", "display_name": "wxw", "link": "https://stackoverflow.com/users/5448549/wxw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 49085354, "answer_count": 1, "score": 1, "last_activity_date": 1520106253, "creation_date": 1520087894, "last_edit_date": 1520088473, "question_id": 49085289, "link": "https://stackoverflow.com/questions/49085289/whats-the-division-rules-of-negative-int-numbers-in-haskell", "title": "What&#39;s the division rules of negative int numbers in haskell?", "body": "<p>In GHCI, I get these results:</p>\n\n<pre><code>div (-7) ( 2) = -4\ndiv ( 7) (-2) = -4\ndiv (-7) (-2) =  3\n\nmod ( 7)  ( 2) =  1\nmod ( 7)  (-2) = -1\nmod (-7)  ( 2) =  1\nmod (-7)  (-2) = -1\n</code></pre>\n\n<p>and <code>div 4 (-3)</code> is <code>-2</code>, and <code>mod 4 (-3)</code> is <code>-2</code>.</p>\n\n<p>I can't understand how to get those results. Is there some laws or rules?\n And what are right calculation steps ?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520085595, "post_id": 49084805, "comment_id": 85175093, "body": "Closely related: <a href=\"https://stackoverflow.com/q/26416323/2751851\"><i>Function to Calculate `log` of Integer</i></a> (make sure to also read <a href=\"https://stackoverflow.com/a/45155332/2751851\">the second answer</a> there)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520087327, "post_id": 49084805, "comment_id": 85175661, "body": "@duplode Ok so if I as an example put i as 5, the code around logBase would look like <code>[logBase x (5 :: Integer) | x &lt;- [2..10]]</code> because logBase is expecting floating/fractional, this should fix it <code>[logBase x (fromIntegral (5 :: Integer)) | x &lt;- [2..10]]</code>. And it works in ghci but compiler still throws the same error. To be more precise <code>[((logBase x (fromIntegral (5 :: Integer))), x) | x &lt;- [2..10]]</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520088371, "post_id": 49084805, "comment_id": 85176045, "body": "Although that did fix first arg of filter <code>filter (\\(x, _) -&gt; floor (fromIntegral x) == x)</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1520091413, "post_id": 49084805, "comment_id": 85177077, "body": "It seems you&#39;d still need, at a minimum, to floor the results of <code>filter</code>. Also note that <code>floor (fromIntegral x) == x</code> will always succeed. Trying to make an useful test out of <code>floor x == x</code> forces you to fight against floating-point arithmetic -- while you might manage to work your way around that, you are probably better off with not using floating-point in the first place (eg. by using integer log functions, as the answer I linked to suggests)."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "edited": false, "score": 0, "creation_date": 1520226143, "post_id": 49096428, "comment_id": 85212610, "body": "Thanks for taking time and answering in detail. I did manage to get successful run using integer - log functions as you mentioned in your last comment. This answer clarifies a lot more."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 0, "last_activity_date": 1520262575, "last_edit_date": 1520262575, "creation_date": 1520173389, "answer_id": 49096428, "question_id": 49084805, "link": "https://stackoverflow.com/questions/49084805/haskell-from-generic-to-integer-no-instance-for-realfrac-integer-arising-f/49096428#49096428", "title": "Haskell - From generic to Integer | No instance for (RealFrac Integer) arising from a use of \u2018floor\u2019", "body": "<p>So you tried:</p>\n\n<pre><code>perfectList :: Integer -&gt; [(Integer, Integer)]\nperfectList i = filter (\\(x, _) -&gt; floor x == x) [(logBase x i, x) | x &lt;- [2 .. (i - 1)]]\n</code></pre>\n\n<p>(I'm going to deal with <code>perfectList</code> here for the sake of brevity. Note, though, that the conversion to <code>Maybe</code> in <code>isPerfectPowerOf</code> is perhaps redundant, as the nothingness of the <code>Maybe</code> result is equivalent to the emptiness of the list.)</p>\n\n<p>That results in the two type errors you quoted. The first one arises because the argument to <code>floor</code> must be of some <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#t:RealFrac\" rel=\"nofollow noreferrer\"><code>RealFrac</code></a> type, and <code>Integral</code> isn't one of them. Similarly, the second error arises because <code>logBase</code> takes and returns values of some <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#t:Floating\" rel=\"nofollow noreferrer\"><code>Floating</code></a> type (and so you need to not only convert the arguments to floating-point but also convert the result back to <code>Integer</code>). Performing these adjustments results in:</p>\n\n<pre><code>perfectList :: Integer -&gt; [(Integer, Integer)]\nperfectList i = fmap (\\(k, x) -&gt; (floor k, x))\n    . filter (\\(k, _) -&gt; fromIntegral (floor k) == k)\n    $ [(logBase (fromIntegral x) (fromIntegral i), x) | x &lt;- [2 .. (i - 1)]]\n</code></pre>\n\n<p>(Note that I have renamed your log variable, for the sake of clarity; you might also want to swap the order of the elements in the pairs.)</p>\n\n<p>Since you are using a list comprehension already, it is easier to shift the <code>fmap</code> and the <code>filter</code> into it:</p>\n\n<pre><code>perfectList :: Integer -&gt; [(Integer, Integer)]\nperfectList i = [(k', x) | x &lt;- [2 .. (i - 1)]\n    , let k = logBase (fromIntegral x) (fromIntegral i), let k' = floor k\n    , fromIntegral k' == k\n    ]\n</code></pre>\n\n<p>On a final note, using <code>floor</code> to check whether a floating-point number is \"really\" a round number isn't fully reliable:</p>\n\n<pre><code>GHCi&gt; fromIntegral (floor (logBase 2 (2**29))) == logBase 2 (2**29)\nFalse\n</code></pre>\n\n<p>That being so, an ultimately sounder approach would be switching to an algorithm that finds perfect powers using integer arithmetic throughout, thus avoiding floating-point altogether. (While I suspect you'd want to implement that yourself, for an off-the-shelf solution check the <a href=\"https://hackage.haskell.org/package/arithmoi-0.6.0.1/docs/Math-NumberTheory-Powers.html\" rel=\"nofollow noreferrer\"><code>Math.NumberTheory.Powers</code> module from the <em>arithmoi</em> package</a>.)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 49096428, "answer_count": 1, "score": 0, "last_activity_date": 1520262575, "creation_date": 1520084733, "last_edit_date": 1592644375, "question_id": 49084805, "link": "https://stackoverflow.com/questions/49084805/haskell-from-generic-to-integer-no-instance-for-realfrac-integer-arising-f", "title": "Haskell - From generic to Integer | No instance for (RealFrac Integer) arising from a use of \u2018floor\u2019", "body": "<p>I'm learning haskell.</p>\n<p>I'm trying to solve a problem in which you're given a number (n) and you have to find a pair (m, k) where m^k would make n a perfect power.</p>\n<blockquote>\n<p>n is a perfect power if there exist natural numbers m &gt; 1, and k &gt; 1\nsuch that m^k = n.</p>\n</blockquote>\n<p>This is what I came up with so far</p>\n<pre><code>module Test where\n\nisPerfectPowerOf :: (Floating p, Enum p, RealFrac p) =&gt; p -&gt; Maybe [(p, p)]\nisPerfectPowerOf i\n        | null perfectList = Nothing\n        | otherwise = Just perfectList\n        where perfectList = filter (\\(x, _) -&gt; floor x == x) [(logBase x i, x) | x &lt;- [2 .. (i - 1)]]\n</code></pre>\n<p>and it works.\nBut as you can see, with very generic types. What I want is for it to work with</p>\n<pre><code>isPerfectPowerOf :: Integer -&gt; Maybe [(Integer, Integer)]\n</code></pre>\n<p>So for debugging purposes I placed this signature over the code which gave me these errors</p>\n<pre><code>severity: 'Error'\nmessage: '    \u2022 No instance for (RealFrac Integer) arising from a use of \u2018floor\u2019\n    \u2022 In the first argument of \u2018(==)\u2019, namely \u2018floor x\u2019\n      In the expression: floor x == x\n      In the first argument of \u2018filter\u2019, namely\n        \u2018(\\ (x, _) -&gt; floor x == x)\u2019\n\nseverity: 'Error'\nmessage: '    \u2022 No instance for (Floating Integer)\n        arising from a use of \u2018logBase\u2019\n    \u2022 In the expression: logBase x i\n      In the expression: (logBase x i, x)\n      In the second argument of \u2018filter\u2019, namely\n        \u2018[(logBase x i, x) | x &lt;- [2 .. (i - 1)]]\u2019\n</code></pre>\n<p>So if I'm not completely off the mark I'll need to somehow typecast floor's and logBase's inputs properly.</p>\n<blockquote>\n<p><code>floor :: (RealFrac a, Integral b) =&gt; a -&gt; b</code></p>\n<p><code>logBase :: Floating a =&gt; a -&gt; a -&gt; a</code></p>\n</blockquote>\n<p>How should I go about doing it?\nOr if it isn't the problem what could be?</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 4, "last_activity_date": 1520083496, "creation_date": 1520083496, "answer_id": 49084616, "question_id": 49084482, "link": "https://stackoverflow.com/questions/49084482/where-is-class-ord-defined-in-ghc-library/49084616#49084616", "title": "Where is class Ord defined in GHC library?", "body": "<p><code>Ord</code> (and <code>Eq</code>) are defined in the <a href=\"http://hackage.haskell.org/package/ghc-prim\" rel=\"nofollow noreferrer\"><code>GHC.Classes</code></a> module (which is imported by <code>GHC.Base</code>) from the <a href=\"http://hackage.haskell.org/package/ghc-prim-0.5.1.1/src/GHC/Classes.hs\" rel=\"nofollow noreferrer\"><em>ghc-prim</em></a> package (which is a dependency of <em>base</em>).</p>\n"}], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 49084616, "answer_count": 1, "score": 3, "last_activity_date": 1520083496, "creation_date": 1520082567, "question_id": 49084482, "link": "https://stackoverflow.com/questions/49084482/where-is-class-ord-defined-in-ghc-library", "title": "Where is class Ord defined in GHC library?", "body": "<p>Source for <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/src/GHC.Base.html\" rel=\"nofollow noreferrer\"><code>GHC.Base</code></a> has the note at the beginning saying in part</p>\n\n<pre><code>The overall structure of the GHC Prelude is a bit tricky...\nSo the rough structure is as follows, in (linearised) dependency order\n\n\nGHC.Prim        Has no implementation.  It defines built-in things, and\n                by importing it you bring them into scope.\n                The source file is GHC.Prim.hi-boot, which is just\n                copied to make GHC.Prim.hi\n\nGHC.Base        Classes: Eq, Ord, Functor, Monad\n                Types:   list, (), Int, Bool, Ordering, Char, String\n</code></pre>\n\n<p>But while <code>Ordering</code> is defined in that source file, <code>Ord</code> isn't. And the Prelude doc page doesn't have a source link for <code>Ord</code>. Where is it actually defined?</p>\n"}, {"tags": ["haskell", "syntax", "indentation", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1520076279, "creation_date": 1520076279, "answer_id": 49083605, "question_id": 49081158, "link": "https://stackoverflow.com/questions/49081158/debug-explicit-characters-due-to-indentation/49083605#49083605", "title": "Debug explicit characters due to indentation", "body": "<pre class=\"lang-none prettyprint-override\"><code>$ cat &gt;&gt; Hello.hs\nmain = do\n    putStr \"Hello, \"\n    putStrLn \"World!\"\n\n$ ghc -ddump-ds Hello.hs   # ds for \"desugar\"\n[1 of 1] Compiling Main             ( Hello.hs, Hello.o )\n\n==================== Desugar (after optimization) ====================\nResult size of Desugar (after optimization)\n  = {terms: 18, types: 9, coercions: 0, joins: 0/0}\n\n-- RHS size: {terms: 8, types: 3, coercions: 0, joins: 0/0}\nmain :: IO ()\n[LclIdX]\nmain\n  = &gt;&gt;\n      @ IO\n      GHC.Base.$fMonadIO\n      @ ()\n      @ ()\n      (putStr (GHC.CString.unpackCString# \"Hello, \"#))\n      (putStrLn (GHC.CString.unpackCString# \"World!\"#))\n\n-- RHS size: {terms: 2, types: 1, coercions: 0, joins: 0/0}\n:Main.main :: IO ()\n[LclIdX]\n:Main.main = GHC.TopHandler.runMainIO @ () main\n\n-- RHS size: {terms: 5, types: 0, coercions: 0, joins: 0/0}\nMain.$trModule :: GHC.Types.Module\n[LclIdX]\nMain.$trModule\n  = GHC.Types.Module\n      (GHC.Types.TrNameS \"main\"#) (GHC.Types.TrNameS \"Main\"#)\n</code></pre>\n\n<p>I suspect that's a bit <em>too</em> expanded for your taste, but it certainly doesn't have the block-indentation anymore.</p>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1520080629, "creation_date": 1520056405, "last_edit_date": 1520080629, "question_id": 49081158, "link": "https://stackoverflow.com/questions/49081158/debug-explicit-characters-due-to-indentation", "title": "Debug explicit characters due to indentation", "body": "<p>Haskell <a href=\"https://en.wikibooks.org/wiki/Haskell/Indentation#Explicit_characters_in_place_of_indentation\" rel=\"nofollow noreferrer\">automatically inserts</a> semicolons and braces due to indentation. In <a href=\"https://stackoverflow.com/a/48991448/149482\">this answer</a>, a type error is used to have <code>ghci</code> print the code with the semicolons and braces explicitly shown. How can I view code after these insertions without an error? I expect there should be something like <code>gcc</code>'s <code>-E</code> flag, which shows code after macro preprocessing.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1520231763, "post_id": 49080119, "comment_id": 85214417, "body": "If you update the question but don&#39;t comment on an answer I have no way of knowing that the question has changed."}], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1520176969, "post_id": 49080183, "comment_id": 85198881, "body": "The OP has updated their question to use <code>Control.Monad.State.Strict</code>, but the results are still similar."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": true, "score": 6, "last_activity_date": 1520231724, "last_edit_date": 1520231724, "creation_date": 1520045881, "answer_id": 49080183, "question_id": 49080119, "link": "https://stackoverflow.com/questions/49080119/why-is-statet-faster-in-this-example/49080183#49080183", "title": "Why is StateT faster in this example?", "body": "<p>The benchmark is benchmarking a lot of things other than \u201chow fast can you update a variable\u201d. The main problem here is Haskell\u2019s laziness. Something as simple as <code>updateRecordPure</code> does not quite behave as expected:</p>\n\n<pre><code>updateRecordPure :: Record -&gt; Record\nupdateRecordPure !r = r { ra = ra r + 1 }\n</code></pre>\n\n<p>It forces <code>r</code> to weak head normal form, sure. But the <code>ra</code> field is <em>not</em> evaluated and we can prove this easily enough:</p>\n\n<pre><code>-- This just evaluates to (), it doesn't diverge.\nupdateRecordPure Record {} `seq` ()\n</code></pre>\n\n<p>So what is happening here is that <code>updateRecordPure</code> is creating a <code>Record</code> with a thunk in it. This problem in general (accumulating thunks) is a common problem with optimizing Haskell programs, and the other benchmarks suffer from this problem as well.</p>\n\n<p>There is an easy experiment that we can run to see if something else is happening besides incrementing a variable. All of these updates should take constant time and constant space, unless they are accumulating thunks in memory. Try adjusting the 10000 to 100000\u2026 you will find that the runtime increases by more than 10x!</p>\n\n<p>I have made a modified and cleaned-up version of the benchmark in a <a href=\"https://gist.github.com/depp/15514215cbd9f07eef319a0b1647d419\" rel=\"nofollow noreferrer\">Gist</a> which takes as a command-line argument the number of iterations. It makes some other changes like eliminating the list and using <code>replicateM_</code>, which is a bit more idiomatic. On my system, going from 10000 to 100000 iterations has the following effects:</p>\n\n<ul>\n<li>Pure/update takes 80x as long,</li>\n<li>IORef record/update takes 30x as long,</li>\n<li>IORef record/modify takes 23x as long,</li>\n<li>MyStateT/identity takes 1x as long, and</li>\n<li>MyStateT/io takes 13x as long.</li>\n</ul>\n\n<p>The <code>MyStateT/identity</code> benchmark is just <code>MyStateT</code> applied to the <code>Identity</code> monad. Somehow, GHC is able to completely optimize this case away and the runtime for this case is 14 ns... no matter how many iterations you use!</p>\n\n<p>But for the others, because increasing the number of iterations 10x increased the runtime by more than 10x, we know that something is going on here other than just incrementing an integer and allocating a record.</p>\n\n<h2>Fixing the Benchmark</h2>\n\n<p>The lazy way to fix the benchmark is to make the record field strict.</p>\n\n<pre><code>data Record = Record\n    { ra :: !Int\n    , rb :: String\n    , rc :: Int\n    , rd :: Int\n    } deriving (Show)\n</code></pre>\n\n<p>With this change, going from 10000 to 100000 iterations increases the runtime by about 10x for Pure/update, IORef record/modify, and MyStateT/io. IORef record/update is still slow as expected because it is constructing a chain of 10000 or 100000 chunks on the heap and then evaluating them at the end (this behavior is well known and documented in the <code>modifyIORef</code> documentation, although it still catches many Haskell programmers by surprise).</p>\n\n<p>On my anemic VPS, the new version with strict <code>ra</code> field has the following times with 10000 iterations, ranked from fastest to slowest:</p>\n\n<ol>\n<li>MyStateT/identity: 13.67 ns</li>\n<li>Pure/update: 72.72 \u03bcs</li>\n<li>IORef record/modify: 664.2 \u03bcs</li>\n<li>MyStateT/io: 1.170 ms</li>\n<li>IORef record/update: 16.84 ms</li>\n</ol>\n\n<p>With these changes, the <code>MyStateT/identity</code> benchmark still somehow triggers some GHC optimization which eliminates the loop. From the other implementations, the pure one is the fastest, which is expected, and adding additional complications (using an IORef, then using IO + StateT) make the benchmark slower. Finally, <code>readIORef</code> + <code>writeIORef</code> is the slowest because it creates a large number of thunks.</p>\n\n<p>Note that the pure implementation takes only 7 ns per iteration.</p>\n\n<p>Compiling without <code>-threads</code> drastically reduces the runtime, bringing Pure/update, IORef record/modify, and MyStateT/io within 25% of each other. So we can conclude that the differences are due to some kind of synchronization necessary for using IO in multithreaded programs, or perhaps a difference in code generation for multithreaded programs that prevents certain types of optimizations from optimizing our benchmark.</p>\n"}], "owner": {"reputation": 67, "user_id": 9341175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/105c6aa16f689099e18a3ec34952131b?s=128&d=identicon&r=PG&f=1", "display_name": "Bob", "link": "https://stackoverflow.com/users/9341175/bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 49080183, "answer_count": 1, "score": 2, "last_activity_date": 1520231724, "creation_date": 1520045165, "last_edit_date": 1520049153, "question_id": 49080119, "link": "https://stackoverflow.com/questions/49080119/why-is-statet-faster-in-this-example", "title": "Why is StateT faster in this example?", "body": "<p>I am trying to benchmark performance differences of updating fields between non-monadic a -> a functions, StateT, and IORef. My benchmark code is below:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE BangPatterns #-}\n\nmodule Main where\n\nimport Control.Monad.State.Strict\nimport Criterion.Main\nimport Data.IORef\nimport Data.List\n\nnewtype MyStateT s m a = MyStateT { unMyStateT :: StateT s m a }\n    deriving (Functor, Applicative, Monad, MonadState s)\n\nrunMyStateT = runStateT . unMyStateT\n\ndata Record = Record\n    { ra :: Int\n    , rb :: String\n    , rc :: Int\n    , rd :: Int\n    } deriving (Show)\n\nnewRecord :: IO (IORef Record)\nnewRecord = newIORef Record\n    { ra = 0\n    , rb = \"string\"\n    , rc = 20\n    , rd = 30\n    }\n\nupdateRecordPure :: Record -&gt; Record\nupdateRecordPure !r = r { ra = ra r + 1 }\n\nupdateRecord :: IORef Record -&gt; IO ()\nupdateRecord ref = do\n    r &lt;- readIORef ref\n    writeIORef ref $ r { ra = ra r + 1 }\n\nmodifyRecord :: IORef Record -&gt; IO ()\nmodifyRecord ref = modifyIORef' ref (\\r -&gt; r { ra = ra r + 1 })\n\nupdateRecordM :: (MonadState Record m) =&gt; m ()\nupdateRecordM = modify' $ \\r -&gt; r { ra = ra r + 1 }\n\nnumCycles :: [Int]\nnumCycles = [1..10000]\n\nrunUpdateRecordPure :: Record -&gt; Record\nrunUpdateRecordPure rec = foldl' update rec numCycles\n  where\n    update !r _ = updateRecordPure r\n\nrunUpdateRecord :: IO ()\nrunUpdateRecord = do\n    r &lt;- newRecord\n    mapM_ (\\_ -&gt; updateRecord r) numCycles\n\nrunModifyRecord :: IO ()\nrunModifyRecord = do\n    r &lt;- newRecord\n    mapM_ (\\_ -&gt; modifyRecord r) numCycles\n\nrunModifyRecordStateM :: (MonadState Record m) =&gt; m ()\nrunModifyRecordStateM = mapM_ (const updateRecordM) numCycles\n\nmain = defaultMain\n    [ bgroup \"Pure\"\n        [ bench \"update\" $ whnf runUpdateRecordPure rec\n        ]\n    , bgroup \"IORef record\"\n        [ bench \"update\" $ whnfIO runUpdateRecord\n        , bench \"modify\" $ whnfIO runModifyRecord\n        ]\n    , bgroup \"MyStateT\"\n        [ bench \"modify\" $ whnfIO (snd &lt;$&gt; runMyStateT runModifyRecordStateM rec)\n        ]\n    ]\n  where\n    rec = Record\n        { ra = 0\n        , rb = \"string\"\n        , rc = 20\n        , rd = 30\n        }\n</code></pre>\n\n<p>The benchmark results are:</p>\n\n<pre><code>benchmarking Pure/update\ntime                 124.9 \u03bcs   (123.6 \u03bcs .. 126.2 \u03bcs)\n                     0.999 R\u00b2   (0.998 R\u00b2 .. 0.999 R\u00b2)\nmean                 124.5 \u03bcs   (123.0 \u03bcs .. 126.1 \u03bcs)\nstd dev              5.039 \u03bcs   (4.054 \u03bcs .. 6.350 \u03bcs)\nvariance introduced by outliers: 40% (moderately inflated)\n\nbenchmarking IORef record/update\ntime                 70.14 \u03bcs   (69.48 \u03bcs .. 70.99 \u03bcs)\n                     0.998 R\u00b2   (0.998 R\u00b2 .. 0.999 R\u00b2)\nmean                 70.40 \u03bcs   (69.53 \u03bcs .. 71.51 \u03bcs)\nstd dev              3.141 \u03bcs   (2.634 \u03bcs .. 3.866 \u03bcs)\nvariance introduced by outliers: 47% (moderately inflated)\n\nbenchmarking IORef record/modify\ntime                 131.9 \u03bcs   (130.1 \u03bcs .. 133.4 \u03bcs)\n                     0.999 R\u00b2   (0.998 R\u00b2 .. 0.999 R\u00b2)\nmean                 131.0 \u03bcs   (129.5 \u03bcs .. 132.8 \u03bcs)\nstd dev              5.712 \u03bcs   (4.667 \u03bcs .. 7.476 \u03bcs)\nvariance introduced by outliers: 44% (moderately inflated)\n\nbenchmarking MyStateT/modify\ntime                 31.95 \u03bcs   (31.65 \u03bcs .. 32.28 \u03bcs)\n                     0.999 R\u00b2   (0.998 R\u00b2 .. 0.999 R\u00b2)\nmean                 32.06 \u03bcs   (31.72 \u03bcs .. 32.49 \u03bcs)\nstd dev              1.243 \u03bcs   (985.4 ns .. 1.564 \u03bcs)\nvariance introduced by outliers: 44% (moderately inflated)\n</code></pre>\n\n<p>From the results it looks like the StateT version is almost four times faster than the non-monadic version and two times faster than the IORef version.</p>\n\n<p>The code was compiled with -O2, -threaded, and -fno-full-laziness (the results didn't change much from adding -fno-full-laziness). I tried switching from <code>whnf</code>/<code>whnfIO</code> to <code>nf</code>/<code>nfIO</code> but the only thing that changed was the non-monadic version becoming even slower.</p>\n\n<p>Can someone explain why the StateT version in this example is so much more performant than the other versions?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 10, "creation_date": 1520038789, "post_id": 49079255, "comment_id": 85165069, "body": "Have you tried making your proposed modification and seeing what happens?"}], "answers": [{"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 4, "last_activity_date": 1520036138, "creation_date": 1520036138, "answer_id": 49079295, "question_id": 49079255, "link": "https://stackoverflow.com/questions/49079255/why-would-you-write-haskell-like-this/49079295#49079295", "title": "Why would you write Haskell like this?", "body": "<p>In the first sample, <code>good</code>, <code>w</code> and <code>i</code> are locally defined parameters to the lambda expression. In the second sample, they are free variables. I would expect the second sample to fail with an error saying that those identifiers are not in scope. <code>Result</code> apparently is a type that contains information about how to use given data and handlers. <code>ok</code> says to take the data and apply the handler indicating a good outcome to it. In the second sample, it is not clear that one is even refering to the arguments available to what <code>Result</code> wraps, or which names refer to which arguments.</p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 6053118, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Y9Y01.jpg?s=128&g=1", "display_name": "Quentin Liu", "link": "https://stackoverflow.com/users/6053118/quentin-liu"}, "edited": false, "score": 0, "creation_date": 1520122024, "post_id": 49079545, "comment_id": 85186665, "body": "Since you could write <code>CPSMaybe</code> with either <code>forall</code> or the normal <code>newtype CPSMaybe a r</code>, what would be the difference? My understanding of the way you wrote it is that it wouldn&#39;t bother you when you are writing the type signature but the compiler is still able to infer the exact type of <code>r</code>. Is that correct?"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 16, "last_activity_date": 1520111843, "last_edit_date": 1520111843, "creation_date": 1520038632, "answer_id": 49079545, "question_id": 49079255, "link": "https://stackoverflow.com/questions/49079255/why-would-you-write-haskell-like-this/49079545#49079545", "title": "Why would you write Haskell like this?", "body": "<p>This is <a href=\"https://en.wikipedia.org/wiki/Continuation-passing_style\" rel=\"nofollow noreferrer\"><em>continuation passing style</em></a> or \"CPS\". </p>\n\n<p>So first off, your alternative example doesn't make sense.  <code>good</code>, <code>i</code>, and <code>w</code> are not known at the point they are used, and you will get an error.  </p>\n\n<p>The basic idea of continuation passing style is that instead of returning the relevant information, you instead call a function that you are given (in this case <code>good</code>), passing it your intended result as an argument.  Presumably (based on the naming) the ignored argument <code>_</code> would have been called <code>bad</code>, and it is a function that you would call in the case of failure.  </p>\n\n<p>If you are the <code>ok</code> function, it's like the difference between asking you to </p>\n\n<blockquote>\n  <p>Bake me a batch of cookies.</p>\n</blockquote>\n\n<p>(where I have the intention of giving the cookies to Dave), and </p>\n\n<blockquote>\n  <p>Bake a batch of cookies and then give it to Dave.</p>\n</blockquote>\n\n<p>which accomplishes the same thing but now I don't have to be a middleman anymore.  There are often performance advantages to cutting me out as a middleman, and also it means you can do more things, for example if the batch of cookies is really good you might decide to give it to your mom instead of Dave (thus aborting whatever Dave would have done with them), or bake two batches and give them both to Dave (duplicating what Dave would have done).  Sometimes you want this ability and other times you don't, it depends on context. (N.B. in the below examples the types are sufficiently general to disallow these possibilities)</p>\n\n<p>Here is a very simple example of continuation passing style.  Say you have a program</p>\n\n<pre><code>pred :: Integer -&gt; Maybe Integer\npred n = if n &gt; 0 then Just (n-1) else Nothing\n</code></pre>\n\n<p>which subtracts 1 from a number and returns it (in a <code>Just</code> constructor), unless it would become negative then it returns <code>Nothing</code>.  You might use it like this:</p>\n\n<pre><code>main = do\n    x &lt;- readLn\n    case x of\n        Just predx -&gt; putStrLn $ \"The predecessor is \" ++ show predx\n        Nothing -&gt; putStrLn \"Can't take the predecessor\"\n</code></pre>\n\n<p>We can encode this in continuation passing style by, instead of returning <code>Maybe</code>, have <code>pred</code> take an argument for what to do in each case:</p>\n\n<pre><code>pred :: Integer -&gt; (Integer -&gt; r) -&gt; r -&gt; r\n--                 ^^^^^^^^^^^^^^    ^\n--                   Just case       |\n--                              Nothing case\npred n ifPositive ifNegative = \n    if n &gt; 0 \n        then ifPositive (n-1) \n        else ifNegative\n</code></pre>\n\n<p>And the usage becomes:</p>\n\n<pre><code>main = do\n    x &lt;- readLn\n    pred x (\\predx -&gt; putStrLn $ \"The predecessor is \" ++ show predx)\n           (putStrLn \"Can't take the predecessor)\n</code></pre>\n\n<p>See how that works? -- doing it the first way we got the result and then did case analysis; in the second way each case became an argument to the function.  And in the process the call to <code>pred</code> became a <a href=\"https://en.wikipedia.org/wiki/Tail_call\" rel=\"nofollow noreferrer\">tail call</a>, eliminating the need for a stack frame and the intermediate <code>Maybe</code> data structure.</p>\n\n<p>The only remaining problem is that the <code>pred</code>'s signature is kind of confusing.  We can make it a bit clearer by wrapping the CPS stuff in its own type constructor:</p>\n\n<pre><code>newtype CPSMaybe a = CPSMaybe (forall r. (a -&gt; r) -&gt; r -&gt; r)\n\npred :: Integer -&gt; CPSMaybe Integer\npred n = CPSMaybe $ \\ifPositive ifNegative -&gt; \n    if n &gt; 0\n        then ifPositive (n-1)\n        else ifNegative\n</code></pre>\n\n<p>which has a signature that looks more like the first one but with code that looks like the second (except for the <code>CPSMaybe</code> newtype wrapper, which has no effect at runtime). And now maybe you can see the connection to the code in your question.</p>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 2950659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EiUGU.png?s=128&g=1", "display_name": "jamyspex", "link": "https://stackoverflow.com/users/2950659/jamyspex"}, "edited": false, "score": 1, "creation_date": 1520039611, "post_id": 49079601, "comment_id": 85165223, "body": "Another great answer, and yes that was what was causing the confusion."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 7, "last_activity_date": 1520039164, "creation_date": 1520039164, "answer_id": 49079601, "question_id": 49079255, "link": "https://stackoverflow.com/questions/49079255/why-would-you-write-haskell-like-this/49079601#49079601", "title": "Why would you write Haskell like this?", "body": "<p>Well, the <code>Result</code> type apparently wraps a function, so a lambda is the natural thing to use here. If you wanted to avoid a lambda, you could use a local definition instead using <code>let</code> or <code>where</code>, e.g.:</p>\n\n<pre><code>ok a = let\n  proceed i w _ good = good i w a\n  in Result proceed\n\n-- or --\n\nok a = Result proceed\n  where\n    proceed i w _ good = good i w a\n</code></pre>\n\n<p>Writing this won\u2019t work because the variables <code>i</code>, <code>w</code>, and <code>good</code> are not in scope:</p>\n\n<pre><code>ok :: a -&gt; Result i w e a\nok a =\n    Result $ good i w a\n</code></pre>\n\n<p>I wonder if the source of your confusion is the fact that <code>i</code> and <code>w</code> are also used as <em>type variables</em> in the signature of <code>ok</code>, but they\u2019re <em>different</em> variables that happen to have the same names. It\u2019s just as if you\u2019d written something like this:</p>\n\n<pre><code>ok :: a -&gt; Result i w e a\nok value =\n    Result $ continue index writer value\n</code></pre>\n\n<p>Here it should be obvious that the <code>continue</code>, <code>index</code>, and <code>writer</code> variables aren\u2019t defined.</p>\n"}], "owner": {"reputation": 67, "user_id": 2950659, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EiUGU.png?s=128&g=1", "display_name": "jamyspex", "link": "https://stackoverflow.com/users/2950659/jamyspex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 0, "accepted_answer_id": 49079545, "answer_count": 3, "score": 3, "last_activity_date": 1520111843, "creation_date": 1520035707, "question_id": 49079255, "link": "https://stackoverflow.com/questions/49079255/why-would-you-write-haskell-like-this", "title": "Why would you write Haskell like this?", "body": "<p>I've been reading some Haskell code and keep seeing functions that look something like this:</p>\n\n<pre><code>ok :: a -&gt; Result i w e a\nok a =\n    Result $ \\i w _ good -&gt;\n\u00a0\u00a0\u00a0\u00a0    good i w a\n</code></pre>\n\n<p>Why is a lambda used? Why wouldn't you just write the following?:</p>\n\n<pre><code>ok :: a -&gt; Result i w e a\nok a =\n    Result $ good i w a\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1520030510, "post_id": 49078418, "comment_id": 85162982, "body": "Related question: how would you simplify <code>if x &gt; 100 then True else False</code> to not use redundant branching?"}], "answers": [{"comments": [{"owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "edited": false, "score": 0, "creation_date": 1520036396, "post_id": 49078488, "comment_id": 85164578, "body": "You may want to add why the OP&#39;s code failed (using a function in a guard)."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 5, "last_activity_date": 1520036933, "last_edit_date": 1520036933, "creation_date": 1520030496, "answer_id": 49078488, "question_id": 49078418, "link": "https://stackoverflow.com/questions/49078418/using-guards-and-sectioning/49078488#49078488", "title": "Using guards and sectioning", "body": "<p>Your function without sectioning is too complicated, and is causing you trouble. It should be</p>\n\n<pre><code>f5 x = x &gt; 100\n</code></pre>\n\n<p>Because</p>\n\n<pre><code>(&gt;) :: Ord a =&gt; a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>already produces a <code>Bool</code>. There is no need to use guards on top. Think about it: if <code>x &gt; 100</code> is <code>True</code>, then you take the first branch of your guard and return <code>True</code>, and if it's <code>False</code> you take the second branch and return <code>False</code>. You can just eliminate the extra branching without losing anything.</p>\n\n<p>Then you just need to punch out the <code>x</code>:</p>\n\n<pre><code>f5 = (&gt; 100)\n</code></pre>\n\n<hr>\n\n<p>Your original fails because</p>\n\n<pre><code>(&gt; 100) :: (Ord a, Num a) =&gt; a -&gt; Bool\n</code></pre>\n\n<p>is a function that eventually gives a <code>Bool</code>, not a <code>Bool</code> itself. Thus, it explodes when you try to use it in a guard, where an ordinary <code>Bool</code> is expected.</p>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1520047327, "post_id": 49079443, "comment_id": 85166414, "body": "For the sake of argument?  I disagree!"}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 1, "last_activity_date": 1520037626, "creation_date": 1520037626, "answer_id": 49079443, "question_id": 49078418, "link": "https://stackoverflow.com/questions/49078418/using-guards-and-sectioning/49079443#49079443", "title": "Using guards and sectioning", "body": "<p>The accepted answer is the right way. But for the sake of argument, there is another way to pointfree a guard: using view patterns.</p>\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\n\n-- Don't ever do this :)\nf5 ((&gt; 100) -&gt; True) =  True\nf5 _                 = False\n</code></pre>\n\n<p>It has the effect that you're looking for, \"abstracting\" the variable out of the guard. It's just that we turned the guard into a pattern to do so.</p>\n"}], "owner": {"reputation": 43, "user_id": 9436295, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63709e19f85b237cf9eb33e819883627?s=128&d=identicon&r=PG&f=1", "display_name": "Sc00rpY", "link": "https://stackoverflow.com/users/9436295/sc00rpy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 49078488, "answer_count": 2, "score": 4, "last_activity_date": 1520037626, "creation_date": 1520030044, "question_id": 49078418, "link": "https://stackoverflow.com/questions/49078418/using-guards-and-sectioning", "title": "Using guards and sectioning", "body": "<p>I'm beginner at Haskell, for my homework I have to write fuctions in 2 versions: with and without using sectioning. One of this function should return True if argument is greater than 100, and False otherwise. </p>\n\n<p>The function without sectioning works well:</p>\n\n<pre><code>f5 x | x&gt;100 = True\n     | otherwise = False\n</code></pre>\n\n<p>But the second version does not:</p>\n\n<pre><code>f5' | (&gt;100) = True\n    | otherwise = False\n</code></pre>\n\n<p>Can you tell me how to write this function properly?</p>\n"}, {"tags": ["haskell", "typing", "gadt"], "comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1520028261, "post_id": 49078017, "comment_id": 85162121, "body": "I think your problem is that lists must be homogeneous. Like you noted, you can have <code>[Thing]</code>, but you can&#39;t but two different <code>Thing a</code>&#39;s in the same list."}, {"owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "reply_to_user": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1520028376, "post_id": 49078017, "comment_id": 85162170, "body": "@jkeuhlen Right. That makes sense for clearly disparate types like <code>[1, &quot;a&quot;]</code>, but I&#39;m a little confused with the parity between GADTs and sum types. Is <code>Thing a</code> not the &quot;final return type&quot; of <code>Foo</code> and <code>Bar</code>. Is there any type that encompass the result of both <code>Foo 1</code> and <code>Bar &quot;abc&quot;</code>?"}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 1, "creation_date": 1520028667, "post_id": 49078017, "comment_id": 85162270, "body": "No, <code>Thing a</code> is <i>not</i> the final return type of your constructors. They explicitly create a <code>Thing TFOO</code> and a <code>Thing TBar</code>."}], "answers": [{"comments": [{"owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "edited": false, "score": 0, "creation_date": 1520029192, "post_id": 49078165, "comment_id": 85162492, "body": "Wow! Fantastic answer. Thank you so much. That works perfectly. It&#39;s a bit unfortunate that to get the benefit of GADTs (insofar as you can limit which &quot;children?&quot; are passed into other functions) you now can&#39;t use them homogeneously without wrapping. Do you know if <code>exists</code> is something that could exist in Haskell in the future or is wrapping just the accepted approach the everyone uses?"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "edited": false, "score": 0, "creation_date": 1520029650, "post_id": 49078165, "comment_id": 85162677, "body": "@BaileyParker The accepted approach is just wrapping. Another approach is higher-rankedly-typed continuations (<code>forall ret. (forall a. Thing a -&gt; ret) -&gt; ret</code>) (<a href=\"https://stackoverflow.com/a/46186356/5684257\">e.g. this is how you must do it in Typescript</a>), but it&#39;s a lot more painful than this wrapping (and you still need wrapping because of impredicativity). I don&#39;t think there are plans to add <code>exists</code> to Haskell because having both <code>exists</code> and <code>forall</code> would probably make the typechecker too complicated."}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1520096859, "post_id": 49078165, "comment_id": 85179045, "body": "What you call <code>exist</code> is called <code>forall</code> in a number of attempts to add impredicative polymorphism. All is not lost with the latest proposal on <i>guarded instantiation</i>, but implementation is still far from finish, more on this here: <a href=\"https://mail.haskell.org/pipermail/ghc-devs/2018-February/015407.html\" rel=\"nofollow noreferrer\">mail.haskell.org/pipermail/ghc-devs/2018-February/015407.htm&zwnj;&#8203;l</a>"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1520098412, "post_id": 49078165, "comment_id": 85179599, "body": "@ArtemPelenitsyn Sorry, what? <code>exists</code> and <code>forall</code> are literally opposites. <code>[forall a. Show a =&gt; a]</code> means a list of things where each thing can be of any type that satisfies <code>Show</code>. The only values of that type are <code>[]</code>, <code>[undefined]</code>, etc. <code>[exists a. Show a =&gt; a]</code> means a list of things where each thing has some <code>Show</code>able type. This has many values, e.g. <code>[5, &quot;abc&quot;, &#39;a&#39;, [10]]</code>. For some arbitrary type <code>A</code> with <code>Show A</code>, <code>[forall a. Show a =&gt; a]</code> is a subtype of <code>[A]</code> is a subtype of <code>[exists a. Show a =&gt; a]</code>."}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1520099751, "post_id": 49078165, "comment_id": 85180149, "body": "@HTNW don&#39;t you know that even ExistentialTypes extensions in GHC use <code>forall</code> keyword?"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1520100080, "post_id": 49078165, "comment_id": 85180255, "body": "@ArtemPelenitsyn Yes, I mention that in my answer. But having impredicative polymorphism with <code>forall</code> will still not solve the problem. You&#39;d be allowed a <code>[forall ret. (forall a. Thing a -&gt; ret) -&gt; ret]</code>, which is isomorphic to <code>[exists. a Thing a]</code> and removes the need for a wrapper <code>data</code> type, but it is <i>still</i> not as simple as just having <code>exists</code> as a primitive."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1520100579, "post_id": 49078165, "comment_id": 85180422, "body": "@ArtemPelenitsyn Or, in other words: <code>ExistentialTypes</code> allows for  <i>non-primitive</i> existential quantification by using <i>universal</i> quantification (thus <code>forall</code>) plus some identities between the two. <code>forall</code> does not directly cause existential quantification. <code>forall</code> always causes universal quantification. It&#39;s just that <code>ExistentialTypes</code> allows you to use universal quantification in a place where it can be turned inside out to cause existential quantification. But it&#39;s not primitive. <code>forall a. Thing a</code> is a subtype of <code>Thing TFoo</code>, but <code>Thing TFoo</code> is not a subtype of <code>SomeThing</code>."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 3, "last_activity_date": 1520028696, "creation_date": 1520028696, "answer_id": 49078165, "question_id": 49078017, "link": "https://stackoverflow.com/questions/49078017/function-returning-result-of-any-constructor-of-a-gadt/49078165#49078165", "title": "Function returning result of any constructor of a GADT", "body": "<p>You've got your quantifiers mixed up.</p>\n\n<pre><code>combine :: [Thing a]\n</code></pre>\n\n<p>means (the <code>forall</code> is implicit in the syntax)</p>\n\n<pre><code>combine :: forall a. [Thing a]\n</code></pre>\n\n<p>Essentially, <code>combine</code> needs to be a <code>[Thing a]</code> no matter what <code>a</code> is, because <code>a</code> is chosen by the code that calls <code>combine</code>. Or, in another sense,</p>\n\n<pre><code>-- psuedo-Haskell\ncombine :: (a :: *) -&gt; [Thing a]\n</code></pre>\n\n<p><code>combine</code> is a function that takes a type as argument and promises to construct a list of <code>Things</code> of that type. The only possible definition of <code>combine</code> with this type signature is <code>combine = []</code>, plus a bunch of dumb ones like <code>[undefined]</code>, etc. E.g. <code>combine = [Foo 1]</code> would not work either, because <code>a</code> is not being inferred, because it's not <code>combine</code> that sets <code>a</code>; it's the user.</p>\n\n<p>You want</p>\n\n<pre><code>-- psuedo-Haskell\ncombine :: [exists a. Thing a]\n</code></pre>\n\n<p>which means \"<code>combine</code> is a list of things, and each thing is a <code>Thing</code> of some unknown type\" (and every <code>Thing</code> can be of a different type). The <code>exists</code> quantifier is the flipside of <code>forall</code>. It means the definition of <code>combine</code> can set whatever type it wants and the user will have to deal with it. Haskell doesn't support <code>exists</code> out-of-the-box, so you need to define an intermediate data type:</p>\n\n<pre><code>data SomeThing = forall a. SomeThing (Thing a)\n</code></pre>\n\n<p>The syntax is a bit backwards for using the universal quantifier to create existential quantification, but the idea is that you get</p>\n\n<pre><code>SomeThing :: forall a. Thing a -&gt; SomeThing\n</code></pre>\n\n<p>which essentially erases the knowledge of what <code>a</code> is.</p>\n\n<p>You can then have</p>\n\n<pre><code>combine :: [SomeThing]\ncombine = [SomeThing $ Foo 1, SomeThing $ Bar \"abc\"]\n</code></pre>\n"}], "owner": {"reputation": 14585, "user_id": 568785, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/88c6371f6a47841abde4c60dd8a2f964?s=128&d=identicon&r=PG", "display_name": "Bailey Parker", "link": "https://stackoverflow.com/users/568785/bailey-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 49078165, "answer_count": 1, "score": 2, "last_activity_date": 1520028696, "creation_date": 1520027925, "question_id": 49078017, "link": "https://stackoverflow.com/questions/49078017/function-returning-result-of-any-constructor-of-a-gadt", "title": "Function returning result of any constructor of a GADT", "body": "<p>I'm currently having a fight with the typechecker when I try to create a function returning <code>Thing a</code> (where <code>Thing</code> is a GADT). A minimal contrived example:</p>\n\n<pre><code>{-#LANGUAGE GADTs, EmptyDataDecls #-}\nmodule Main where\n\n-- Define a contrived GADT\ndata TFoo\ndata TBar\ndata Thing a where\n  Foo :: Int -&gt; Thing TFoo\n  Bar :: String -&gt; Thing TBar\n\ncombine :: [Thing a]\ncombine = [Foo 1, Bar \"abc\"]\n\nmain :: IO ()\nmain = undefined\n</code></pre>\n\n<p>The typechecker gets unhappy that <code>a</code> doesn't match <code>TBar</code>. Presumably this is because it has already inferred that <code>a</code> is <code>TFoo</code>. But, this is surprising, because with regular sum types you can do:</p>\n\n<pre><code>data Thing = Foo Int | Bar String\n\ncombine :: [Thing]\ncombine = [Foo 1, Bar \"abc\"]\n</code></pre>\n\n<p>Is there anyway to return a type parametric over the GADT parameter?</p>\n\n<p>Outside of the context of the contrived examples, I need GADTs so I can type certain functions to only take a <code>Foo</code>, but before that I need to also be able to just return a list of <code>Thing</code>s.</p>\n"}, {"tags": ["sql", "postgresql", "haskell", "persistent"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1520039256, "post_id": 49077722, "comment_id": 85165155, "body": "This question would be greatly improved by an <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1520063444, "post_id": 49077722, "comment_id": 85169241, "body": "@DanielWagner Done, thanks!"}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 1, "creation_date": 1523860111, "post_id": 49077722, "comment_id": 86716098, "body": "I think the API added here solves this problem <a href=\"https://github.com/yesodweb/persistent/pull/791\" rel=\"nofollow noreferrer\">github.com/yesodweb/persistent/pull/791</a>"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1524020927, "post_id": 49077722, "comment_id": 86796762, "body": "@MaxGabriel Thanks! Only thing is that it&#39;s non trivial to figure out where library dependencies end up on the file system, so I really need a way to <code>import</code> the tables I am building foreign keys too, not just read from a text file at compile time. This is because the dependencies of the package actually create their own tables that I need to migrate and create foreign keys to."}], "owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 186, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1520137957, "creation_date": 1520026282, "last_edit_date": 1520137957, "question_id": 49077722, "link": "https://stackoverflow.com/questions/49077722/how-to-have-inter-module-inter-package-foreign-key-constraints-in-persistent", "title": "How to have inter-module / inter-package foreign key constraints in Persistent", "body": "<p>Since there are a lot of models in our DB, many of which operate fairly independently, we decided to define them in different modules. We then have a single <code>migrateAll</code> function that runs every migration in serial. It appears as though us doing this causes Persistent to not create foreign key constraints between the models, but I would really like those constraints to be there.</p>\n\n<p>As a partial fix we could put them all into the same module, but we also have a separate package that depends on this first package that creates more models on top, again with some foreign keys. It would really hurt for us to have to merge those packages into one, when there is truly only a one-directional dependency between them.</p>\n\n<p>Is there any way for foreign key constraints to still be created across modules? Perhaps by making it so that if you migrate a model with external foreign key constraints, the foreign model's migration is also ran. To avoid needing to order the migrations in dependency order.</p>\n\n<p>It is also possible that the reason foreign keys are not being created is unrelated to this setup, but I can't seem to find anyone else running into the same issue, so I am assuming the above is the cause.</p>\n\n<p>For an MCVE:</p>\n\n<pre><code>module Foo where\n\nshare [mkPersist sqlSettings, mkMigrate \"migrateFoo\"] [persistLowerCase|\nFoo\n    name String\n|]\n</code></pre>\n\n\n\n<pre><code>module Bar where\n\nimport Foo\n\nshare [mkPersist sqlSettings, mkMigrate \"migrateBar\"] [persistLowerCase|\nBar\n    name String\n    foo FooId\n|]\n</code></pre>\n\n\n\n<pre><code>module Models where\n\nimport Foo\nimport Bar\n\nmigrateAll :: Migration\nmigrateAll = migrateFoo *&gt; migrateBar\n</code></pre>\n\n<p>Running <code>migrateAll</code> does everything I want except for create a foreign key constraint on the <code>Bar.foo</code> field. How do I go about getting that foreign key constraint while still keeping the modularity I want?</p>\n"}, {"tags": ["javascript", "haskell", "ghcjs", "ghcjs-dom"], "answers": [{"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 3, "last_activity_date": 1575091938, "last_edit_date": 1575091938, "creation_date": 1520025853, "answer_id": 49077643, "question_id": 49077219, "link": "https://stackoverflow.com/questions/49077219/removing-the-current-listener-from-within-eventm/49077643#49077643", "title": "removing the current listener from within EventM", "body": "\n\n<p>Use <code>fixIO</code></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>fixIO $ \\rec -&gt; newListener _eventm\n</code></pre>\n\n<p>Fill <code>_eventm</code> with your <code>EventM</code>, and you will be able to access the event listener that will eventually be created through the name <code>rec</code>. <code>rec</code> will be the result of the <code>newListener</code> call, but it can be \"used\" before that is executed. I say \"used,\" because trying to force it with <code>seq</code> or anything stronger will cause an infinite loop, but you should be fine doing what you're doing.</p>\n\n<hr>\n\n<p><code>fixIO</code> is a generalization of <code>fix</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- the essence of recursion\nfix :: (a -&gt; a) -&gt; a\nfix f = let x = f x in x\n-- equivalent but less performant and less relevant\nfix f = f (fix f)\n\n-- if you have used JS's \"named anonymous functions\"\n-- this will seem very familiar\n(fix (\\fact n -&gt;\n  if n &lt;= 1 then 1 else n * fact (n - 1)\n)) 3 = 6\n-- JS:\n-- (function fact(n) {\n--   if(n &lt;= 1) { return 1; } else { return n * fact(n - 1); }\n-- })(3) === 6\n\n-- but this has more power\nrepeat = fix . (:)\nrepeat 1 = fix (1:) = \n   let x = 1:x in x = 1:fix (1:) = [1,1,1,1,1,1,1,1,1,1,1,1,1,1...]\n\nfix id = let x = id x in x = let x = x in x = _|_ -- oops!\n\nfixIO :: (a -&gt; IO a) -&gt; IO a\nfixIO f = _ -- horrendous, unsafe code\n\nfixIO (\\xs -&gt; return $ 1:xs) = return [1,1,1,1,1,1,1,1,1,1...]\n\nfixIO return = fixIO (return . id) = return $ fix id = return _|_ -- oops!\n</code></pre>\n\n<p>The idea of <code>fix</code> is making a function's eventual result available to it before it is actually created.<br/>\nThe idea of <code>fixIO</code> is making an <code>IO</code> function's eventual result available to it before it is actually created <em>while also carrying out some <code>IO</code> actions</em>. Also, <code>fixIO</code> only carries out these actions <em>once</em>, which is why the first definition of <code>fix</code> (that only calls <code>f</code> once) is more relevant than the second.</p>\n\n<p><code>fixIO</code>, in turn, is a specialization of <code>mfix :: MonadFix m =&gt; (a -&gt; m a) -&gt; m a</code>, where <code>MonadFix</code> is the class of monads (including <code>IO</code>, with <code>mfix = fixIO</code>) that admit such knot-tying semantics. GHC supports \"recursive <code>do</code>\" notation for any <code>MonadFix</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE RecursiveDo #-}\nsomeCode = mdo ...\n               listener &lt;- newListener _eventm -- can access listener in definition\n               ...\n-- or\nsomeCode = do ...\n              rec listener &lt;- newListener _eventm\n              ...\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 6257921, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vMSb-u_jr9Q/AAAAAAAAAAI/AAAAAAAABLk/0-qCDsnM1MY/photo.jpg?sz=128", "display_name": "Graham Leach-Krouse", "link": "https://stackoverflow.com/users/6257921/graham-leach-krouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 49077643, "answer_count": 1, "score": 0, "last_activity_date": 1575091938, "creation_date": 1520023965, "last_edit_date": 1575091919, "question_id": 49077219, "link": "https://stackoverflow.com/questions/49077219/removing-the-current-listener-from-within-eventm", "title": "removing the current listener from within EventM", "body": "\n\n<p>Suppose I want to create, using ghcjs-dom, an event listener which responds to a click, and then removes itself.</p>\n\n<p>I have</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>addListener :: (IsEventTarget t, IsEvent e)\n            =&gt; t -&gt; EventName t e -&gt; SaferEventListener t e -&gt; Bool -&gt; IO ()\n</code></pre>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>removeListener :: (IsEventTarget t, IsEvent e)\n            =&gt; t -&gt; EventName t e -&gt; SaferEventListener t e -&gt; Bool -&gt; IO ()\n</code></pre>\n\n<p>to add and remove, and </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newListener :: (IsEvent e) =&gt; EventM t e () -&gt; IO (SaferEventListener t e)\n</code></pre>\n\n<p>to construct the listener out of an <code>EventM</code>. How can I access the <code>SaferEventListener</code> (which I will only later construct) from within the <code>EventM</code>, in order to remove it when the event occurs?</p>\n\n<p>In JavaScript, you use a named function expression as your callback to <code>addEventListener</code>, and then apply <code>removeEventListener</code> to that name from within the callback. But nothing analogus seems to be possible here. Or am I missing something?</p>\n"}, {"tags": ["haskell", "tuples"], "comments": [{"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "edited": false, "score": 0, "creation_date": 1520024158, "post_id": 49077102, "comment_id": 85160325, "body": "I think you&#39;d get really messy code for getting the <code>nth</code> element, and you&#39;d probably need some custom types or typeclasses to do that. (see for example <a href=\"http://hackage.haskell.org/package/tuple-0.3.0.2/docs/Data-Tuple-Select.html\" rel=\"nofollow noreferrer\">here</a>). Why don&#39;t you just define your own type instead of (ab-)using tuples?"}, {"owner": {"reputation": 277, "user_id": 380252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f0999e58687b0d2153c594616ceafc5c?s=128&d=identicon&r=PG", "display_name": "blue scorpion", "link": "https://stackoverflow.com/users/380252/blue-scorpion"}, "reply_to_user": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "edited": false, "score": 0, "creation_date": 1520024878, "post_id": 49077102, "comment_id": 85160673, "body": "Even if I define my own type, it must be capable to grow with more types (akin to variadic templates in C++). So, in essence an extensible tuple type. Again, the goal for this is being generic. I don&#39;t want to limit to a predefined number of elements in a tuple or predefined types."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1520028455, "post_id": 49077102, "comment_id": 85162194, "body": "@bluescorpion If you use the record syntax, it&#39;s super easy to extend."}, {"owner": {"reputation": 3969, "user_id": 187261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/994de0373c6a35a5f7108b274d0b1cb9?s=128&d=identicon&r=PG", "display_name": "Nazarii Bardiuk", "link": "https://stackoverflow.com/users/187261/nazarii-bardiuk"}, "edited": false, "score": 0, "creation_date": 1520037930, "post_id": 49077102, "comment_id": 85164890, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/5844347/haskell-accessing-a-specific-element-in-a-tuple\">Haskell - Accessing a Specific Element in a Tuple</a>"}, {"owner": {"reputation": 3969, "user_id": 187261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/994de0373c6a35a5f7108b274d0b1cb9?s=128&d=identicon&r=PG", "display_name": "Nazarii Bardiuk", "link": "https://stackoverflow.com/users/187261/nazarii-bardiuk"}, "edited": false, "score": 0, "creation_date": 1520038021, "post_id": 49077102, "comment_id": 85164904, "body": "have a look at answer with lens package <a href=\"https://stackoverflow.com/a/23860744/187261\">stackoverflow.com/a/23860744/187261</a>"}, {"owner": {"reputation": 277, "user_id": 380252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f0999e58687b0d2153c594616ceafc5c?s=128&d=identicon&r=PG", "display_name": "blue scorpion", "link": "https://stackoverflow.com/users/380252/blue-scorpion"}, "edited": false, "score": 0, "creation_date": 1520045746, "post_id": 49077102, "comment_id": 85166147, "body": "@ Nazarii Bardiuk: This is different than <a href=\"https://stackoverflow.com/questions/5844347/haskell-accessing-a-specific-element-in-a-tuple\" title=\"haskell accessing a specific element in a tuple\">stackoverflow.com/questions/5844347/&hellip;</a>. This is not about accessing an a-priori known element from a tuple of a-priori known length. It&#39;s about accessing an element given by a variable index in an variable tuple (of length and type unknown a-priori). The former implies a fixed definition of a lambda accessor <code>((_,_,x,_,_) -&gt; x)</code> where both position of interest in tuple and tuple length are known a-priori. While my question does not make any such a-priori known assumptions."}], "answers": [{"tags": [], "owner": {"reputation": 3969, "user_id": 187261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/994de0373c6a35a5f7108b274d0b1cb9?s=128&d=identicon&r=PG", "display_name": "Nazarii Bardiuk", "link": "https://stackoverflow.com/users/187261/nazarii-bardiuk"}, "is_accepted": false, "score": 1, "last_activity_date": 1520024216, "creation_date": 1520024216, "answer_id": 49077273, "question_id": 49077102, "link": "https://stackoverflow.com/questions/49077102/extracting-n-th-element-from-tuple-in-haskell-where-n-and-tuple-are-given-argum/49077273#49077273", "title": "Extracting n-th element from tuple in Haskell (where n and tuple are given arguments)", "body": "<p>It is impossible to implement in general because each element in tuple has different type</p>\n\n<p>Take for example tuple of 3 items. It is impossible to determine type of output in compile time</p>\n\n<pre><code> nth :: (a,b,c) =&gt; Int -&gt; (a,b,c) -&gt; ???\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 277, "user_id": 380252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f0999e58687b0d2153c594616ceafc5c?s=128&d=identicon&r=PG", "display_name": "blue scorpion", "link": "https://stackoverflow.com/users/380252/blue-scorpion"}, "edited": false, "score": 0, "creation_date": 1520045882, "post_id": 49079819, "comment_id": 85166172, "body": "Thank you, HTNW. I need some time to digest all these, but it looks like this is the answer."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 2, "last_activity_date": 1520041489, "creation_date": 1520041489, "answer_id": 49079819, "question_id": 49077102, "link": "https://stackoverflow.com/questions/49077102/extracting-n-th-element-from-tuple-in-haskell-where-n-and-tuple-are-given-argum/49079819#49079819", "title": "Extracting n-th element from tuple in Haskell (where n and tuple are given arguments)", "body": "<p>The tried-and-true <code>HList</code> seems to match your use case.</p>\n\n<pre><code>{-# LANGUAGE DataKinds, ExplicitForAll, GADTs, PolyKinds,\n             TypeFamilies, TypeOperators, UndecidableInstances\n#-}\nimport GHC.TypeLits(TypeError(..), ErrorMessage(..))\n\n-- HList takes a list of types and creates a type that contains one value of each\ndata HList (ts :: [*]) where\n  (:^:) :: t -&gt; !(HList ts) -&gt; HList (t:ts)\n  -- strictness removes extra bottoms compared to tuples\n  HNil  :: HList '[]\ninfixr 5 :^:\n\n-- natural numbers are either zero or the successor of another\ndata Nat = Zero | Succ Nat\n-- singletons\ndata SNat (n :: Nat) where\n  SZero :: SNat Zero\n  SSucc :: SNat n -&gt; SNat (Succ n)\n\n-- index into a normal list\ntype family IndexL (i :: Nat) (xs :: [k]) :: k where\n  IndexL Zero (x:xs) = x\n  IndexL (Succ n) (x:xs) = IndexL n xs\n  IndexL i xs = TypeError (Text \"Cannot index \"\n                      :&lt;&gt;: ShowType i\n                      :&lt;&gt;: Text \" into the list \"\n                      :&lt;&gt;: ShowType xs\n                          )\n\n-- index into an HList\nindex :: forall (i :: Nat) xs. SNat i -&gt; HList xs -&gt; IndexL i xs\nindex SZero (x :^: _) = x\nindex (SSucc n) (_ :^: xs) = index n xs\n-- despite appearances, this function is total\n-- you'll get a compiler error if you try to add an HNil case.\n</code></pre>\n\n<p>There are a bunch of instances (e.g. <code>Read</code>, <code>Eq</code>) to write/derive to make this somewhat useable.</p>\n\n<pre><code>main = do let test = 1 :^: \"abc\" :^: (7 :^: Zero :^: HNil) :^: HNil\n          print $ index SZero test + 2\n          print $ ord &lt;$&gt; index (SSucc$SZero) test\n          print $ index SZero $ index (SSucc$SSucc$SZero) test\n</code></pre>\n\n<p>Inserting elements involves the addition of a <code>type family Inject (x :: k) (i :: Nat) (xs :: [k]) :: [k] where ...</code> on the type level and corresponding function on the values. Writing a function of type <code>Applicative f =&gt; HList [f a, f b, ...] -&gt; f (HList [a, b, ...])</code> is harder (in the sense of more typing, not conceptually), but doable.</p>\n\n<p>You don't get the nice numeric literals, but that's really just \"meh\". You can use TH to rectify that.</p>\n"}], "owner": {"reputation": 277, "user_id": 380252, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/f0999e58687b0d2153c594616ceafc5c?s=128&d=identicon&r=PG", "display_name": "blue scorpion", "link": "https://stackoverflow.com/users/380252/blue-scorpion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "accepted_answer_id": 49079819, "answer_count": 2, "score": 1, "last_activity_date": 1520046231, "creation_date": 1520023440, "last_edit_date": 1520046231, "question_id": 49077102, "link": "https://stackoverflow.com/questions/49077102/extracting-n-th-element-from-tuple-in-haskell-where-n-and-tuple-are-given-argum", "title": "Extracting n-th element from tuple in Haskell (where n and tuple are given arguments)", "body": "<p>Is there a way to write the following function in Haskell:</p>\n\n<pre><code>get_nth_element :: Int-&gt;(???)-&gt;(???)\nget_nth_element n tpl = ...\n</code></pre>\n\n<p>I'm interested in a solution for tuples, not lists, for which the solution is trivial. The reason being that tuples can aggregate different types, of course. </p>\n\n<p>The intermediate goal is to be able to write a function that given a tuple and a value it returns a tuple that adds the given value to the given tuple. The ultimate goal is to write a generic Cartesian product function that, given a tuple of n (potentially different types of) lists, returns the Cartesian product list of all the resulting n-dimensional tuples (using, say, applicative operators <code>&lt;$&gt;, &lt;*&gt;</code>).</p>\n\n<p>This can be achieved in C++ (using variadic templates and SFINAE), so I assume there should be a way to do it in Haskell.</p>\n\n<p>[Update]\nC++ (11 and above) has <code>std::get&lt;i&gt;(tuple)</code> and <code>std::tuple_cat</code>. For example this compiles and runs just as expected:</p>\n\n<pre><code>#include &lt;iostream&gt;\n#include &lt;tuple&gt;\n\ntemplate&lt;typename T, typename ...Args&gt;\nstd::tuple&lt;T,Args...&gt; grow_tuple(T v, std::tuple&lt;Args...&gt; t)\n{\n  return std::tuple_cat(std::make_tuple(v), t);\n}\n\nint main(void)\n{\n  std::tuple&lt;int, std::string&gt; t1{1, \"Howdy!\"};\n\n  int i = 13;\n  auto t2 = grow_tuple(i, t1);\n\n  std::cout&lt;&lt;\"(\"&lt;&lt;std::get&lt;0&gt;(t2)\n       &lt;&lt;\",\"&lt;&lt;std::get&lt;1&gt;(t2)\n       &lt;&lt;\",\"&lt;&lt;std::get&lt;2&gt;(t2)&lt;&lt;\")\\n\";\n\n  std::cout&lt;&lt;\"Done!\"&lt;&lt;std::endl;\n}\n</code></pre>\n\n<p>Essentially, a mechanism is needed here to handle a variadic list of types. I can hardly believe Haskell does not have that.</p>\n\n<p>[Update] Note: this is not about accessing an a-priori known element from a tuple of a-priori known length. It's about accessing an element given by a variable index in an variable tuple (of length and type unknown a-priori). The former implies a fixed definition of a lambda accessor <code>((_,_,x,_,_) -&gt; x)</code> where both position of interest in tuple and tuple length are known a-priori. While my question does not make any such a-priori known assumptions. The function signature I am looking for does not take such lambda accessor, but an integer argument for the positional index inside the tuple and a generic tuple argument (generic meaning of unknown length and contained types). Hence this question is different than <a href=\"https://stackoverflow.com/questions/5844347/haskell-accessing-a-specific-element-in-a-tuple\">Haskell - Accessing a Specific Element in a Tuple</a>.</p>\n"}, {"tags": ["haskell", "type-families", "type-variables"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520018477, "post_id": 49075663, "comment_id": 85157735, "body": "What did you change the last line to? Isn&#39;t <code>bar :: Bar a</code> just what it was from the start? typo?"}, {"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1520018552, "post_id": 49075663, "comment_id": 85157765, "body": "@Alec, whoops, yes, thanks, corrected."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1520018563, "post_id": 49075663, "comment_id": 85157772, "body": "This has nothing to do with scope. From the <a href=\"https://downloads.haskell.org/~ghc/8.2.1/docs/html/users_guide/glasgow_exts.html#ambiguous-types-and-the-ambiguity-check\" rel=\"nofollow noreferrer\">GHC docs</a>, &quot;a type <code>ty</code> is ambiguous if and only if <code>((undefined :: ty) :: ty)</code> would fail to typecheck&quot;. In your case, as the error message suggests, <code>ty</code> is <code>forall a. Foo2 a =&gt; Bar a</code>. A more interesting question might be: <i>why</i> does GHC report an error for what it calls &quot;ambiguous type variables&quot;. For an answer to that, check out <a href=\"https://stackoverflow.com/a/45664950/3072788\">stackoverflow.com/a/45664950/3072788</a>."}], "answers": [{"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1520019116, "post_id": 49075969, "comment_id": 85158013, "body": "Specifically, <code>bar :: Bool</code> incurs the constraint <code>Bar a ~ Bool</code>, but now you have <code>(Bar a ~ Bool) =&gt; Bool</code> with an <code>a</code> on the left and not on the right, and the non-injectivity of <code>Bar</code> means that the constraint is unsolvable as-is. The other possible solution is to bring <code>Bar</code> out of the class as its own type family <code>type family Bar a = r | r -&gt; a</code> where the <code>TypeFamilyDependency</code> notation <code>| r -&gt; a</code> (like a fundep) means that <code>Bar</code> is injective."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1520019390, "post_id": 49075969, "comment_id": 85158145, "body": "The crucial part of the error message is <code>NB: \u2018Bar\u2019 is a type function, and may not be injective</code>, i.e. given the result of <code>Bar a</code>, you can&#39;t determine <code>a</code>."}, {"owner": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "edited": false, "score": 0, "creation_date": 1520020930, "post_id": 49075969, "comment_id": 85158820, "body": "You don&#39;t need to bring <code>Bar</code> out of the class for that, I&#39;ve added it to the answer"}], "tags": [], "owner": {"reputation": 3603, "user_id": 165806, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c889e0a95a3bb07f90ab28ad442f1127?s=128&d=identicon&r=PG", "display_name": "Iceland_jack", "link": "https://stackoverflow.com/users/165806/iceland-jack"}, "is_accepted": true, "score": 6, "last_activity_date": 1520088720, "last_edit_date": 1520088720, "creation_date": 1520018441, "answer_id": 49075969, "question_id": 49075663, "link": "https://stackoverflow.com/questions/49075663/why-is-this-type-variable-ambiguous-although-it-should-be-in-scope/49075969#49075969", "title": "Why is this type variable ambiguous, although it should be in scope?", "body": "<p>Imagine you make two <code>Foo</code> instances with the same associated type, and then defined</p>\n\n<pre><code>..\n{-# LANGUAGE InstanceSigs        #-}\n{-# LANGUAGE AllowAmbiguousTypes #-}\n{-# LANGUAGE TypeApplications    #-}\n..\n\ninstance Foo Int   where type Bar Int   = Bool\ninstance Foo Float where type Bar Float = Bool\n\ninstance Foo2 Int where\n  bar :: Bool\n  bar = False\n\ninstance Foo2 Float where\n  bar :: Bool\n  bar = True\n</code></pre>\n\n<p>This means that the type of <code>bar</code> is not enough to decide between the <code>Foo2 Int</code> and <code>Foo2 Float</code> instances.</p>\n\n<pre><code>bar :: Foo2 a =&gt; Bar a\n</code></pre>\n\n<p>GHC will attempt to infer the type <code>a</code> for you but if you ask for</p>\n\n<pre><code>bar :: Bool\n</code></pre>\n\n<p>it has no way to pick between <code>Int</code> / <code>Float</code> or any other instance that may come later. You must explicitly specify the type with <code>-XTypeApplications</code></p>\n\n<pre><code>&gt;&gt;&gt; :set -XTypeApplications\n&gt;&gt;\n&gt;&gt; bar @Int\nFalse\n&gt;&gt; bar @Float\nTrue\n</code></pre>\n\n<hr>\n\n<p><strong>Edit</strong>: If every instance of <code>Foo</code> is a different type (<code>Foo</code> is injective) you can specify that the result determines the instance type with this syntax <code>.. = res | res -&gt; a</code></p>\n\n<pre><code>..\n{-# Language TypeFamilyDependencies #-}\n\nclass Foo a where\n  type Bar a = res | res -&gt; a\n</code></pre>\n\n<p>You can't define <code>Bar Int</code> and <code>Bar Float</code> both equal to <code>Bool</code>. If we only define <code>Foo Int</code> and <code>Foo2 Int</code> then <code>bar :: Bool</code> is enough to let GHC know you're looking for <code>bar @Int = False</code>.</p>\n"}], "owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 49075969, "answer_count": 1, "score": 1, "last_activity_date": 1520088720, "creation_date": 1520017136, "last_edit_date": 1520018515, "question_id": 49075663, "link": "https://stackoverflow.com/questions/49075663/why-is-this-type-variable-ambiguous-although-it-should-be-in-scope", "title": "Why is this type variable ambiguous, although it should be in scope?", "body": "<p>Consider the following code:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE ScopedTypeVariables #-}\nclass Foo a where\n  type Bar a\n\nclass Foo a =&gt; Foo2 a where\n  bar :: Bar a\n</code></pre>\n\n<p>It gives the following error message in GHC 8.2:</p>\n\n<pre><code> error:\n    \u2022 Couldn't match expected type \u2018Bar a\u2019 with actual type \u2018Bar a0\u2019\n      NB: \u2018Bar\u2019 is a type function, and may not be injective\n      The type variable \u2018a0\u2019 is ambiguous\n    \u2022 In the ambiguity check for \u2018bar\u2019\n      To defer the ambiguity check to use sites, enable AllowAmbiguousTypes\n      When checking the class method: bar :: forall a. Foo2 a =&gt; Bar a\n      In the class declaration for \u2018Foo2\u2019\n  |\n7 |   bar :: Bar a\n  |   ^^^^^^^^^^^^\n</code></pre>\n\n<p>What's the problem? Why does it universally quantify over <code>a</code>? If I change the last line to</p>\n\n<pre><code>  bar :: a\n</code></pre>\n\n<p>the problem vanishes. Why doesn't it have the type variable <code>a</code> in scope otherwise?</p>\n\n<p>(I looked through all \"ambiguous type variable\" questions now, but nothing seems to help.)</p>\n"}, {"tags": ["haskell", "type-families", "type-level-computation"], "comments": [{"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1520009138, "post_id": 49073150, "comment_id": 85152913, "body": "<code>ExtractType X a = ...</code>?"}, {"owner": {"reputation": 1094, "user_id": 1080014, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/302a4e07bfa2c3c09d6a2b68825ca180?s=128&d=identicon&r=PG", "display_name": "Leander", "link": "https://stackoverflow.com/users/1080014/leander"}, "reply_to_user": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1520009184, "post_id": 49073150, "comment_id": 85152938, "body": "Too many parameters to ExtractType:         a is unexpected;"}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1520009290, "post_id": 49073150, "comment_id": 85152995, "body": "Well in that case I don\u2019t know. Perhaps you could expand on an example of what <code>X</code> might be? And then what you would want <code>ExtractType X</code> to be? Does this class come from some package where you might be able to find a nontrivial instance?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1520009708, "post_id": 49073150, "comment_id": 85153247, "body": "What is <code>Type</code>? There are several definitions in common libraries, and of course there&#39;s no guarantee you haven&#39;t created it yourself, so at the moment the question isn&#39;t really complete."}, {"owner": {"reputation": 1094, "user_id": 1080014, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/302a4e07bfa2c3c09d6a2b68825ca180?s=128&d=identicon&r=PG", "display_name": "Leander", "link": "https://stackoverflow.com/users/1080014/leander"}, "edited": false, "score": 0, "creation_date": 1520009772, "post_id": 49073150, "comment_id": 85153298, "body": "Type is just <code>*</code>"}, {"owner": {"reputation": 1094, "user_id": 1080014, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/302a4e07bfa2c3c09d6a2b68825ca180?s=128&d=identicon&r=PG", "display_name": "Leander", "link": "https://stackoverflow.com/users/1080014/leander"}, "edited": false, "score": 0, "creation_date": 1520010196, "post_id": 49073150, "comment_id": 85153563, "body": "I have updated the question"}], "answers": [{"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1520011597, "post_id": 49073816, "comment_id": 85154395, "body": "Perhaps an explanation for why \u201ctype instance ExtractType X a = ...\u201d fails is in order?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1520013907, "post_id": 49073816, "comment_id": 85155655, "body": "@HTNW It is a syntactic restriction; I expect this restriction is backed by a solid foundational motivation, but I&#39;ve never looked into what it is."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 3, "creation_date": 1520019014, "post_id": 49073816, "comment_id": 85157974, "body": "@HTNW TO allow it would give us a type-level lambda by the back door."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1520016017, "last_edit_date": 1520016017, "creation_date": 1520009855, "answer_id": 49073816, "question_id": 49073150, "link": "https://stackoverflow.com/questions/49073150/type-family-returning-a-type/49073816#49073816", "title": "Type Family returning (a -&gt; Type)", "body": "<p>Here is an example:</p>\n\n<pre><code>instance C X where\n    type instance ExtractType X = Proxy\n</code></pre>\n\n<p>Given your update, I expect you will need to change the class to say <code>type ExtractType g (x :: a) :: Type</code> (and turn on <code>ScopedTypeVariables</code>). Then <code>type ExtractType X (sym, ty) = ty</code> should work fine.</p>\n"}, {"tags": [], "owner": {"reputation": 675, "user_id": 485482, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aIf9p.png?s=128&g=1", "display_name": "Csongor Kiss", "link": "https://stackoverflow.com/users/485482/csongor-kiss"}, "is_accepted": true, "score": 3, "last_activity_date": 1520095608, "creation_date": 1520095608, "answer_id": 49086642, "question_id": 49073150, "link": "https://stackoverflow.com/questions/49073150/type-family-returning-a-type/49086642#49086642", "title": "Type Family returning (a -&gt; Type)", "body": "<p>Contrast the two signatures:</p>\n\n<pre><code>type ExtractType g :: a -&gt; Type\ntype ExtractType g (x :: a) :: Type\n</code></pre>\n\n<p>It may seem like merely a syntactic difference, but there's more to it than that.</p>\n\n<p>Both definitions yield the same kind signature:</p>\n\n<pre><code>ghci&gt; :kind ExtractType\nExtractType :: ([a] -&gt; *) -&gt; a -&gt; *\n</code></pre>\n\n<p>So what's the difference?</p>\n\n<p>The first definition declares that <code>ExtractType</code> is a type family (type function) that takes a single argument, and returns something of kind <code>a -&gt; Type</code>.</p>\n\n<p>The second one says that <code>ExtractType</code> is a type family of two arguments, returning something of kind <code>Type</code>. Using our intuition from the term-level, these two may sound equivalent, but that equivalence relies on partial application: the ability to pass around functions without fully saturating their arguments first. However, this is not allowed for type families: they must always be fully saturated.</p>\n\n<p>More concretely, your example would look like</p>\n\n<pre><code>type family Snd (t :: (a, b)) :: b where\n  Snd '(_, b) = b\n\n...\ninstance C NHList where\n  type ExtractType NHList = Snd\n                            ^^^\n</code></pre>\n\n<p>Here, <code>Snd</code> is unsaturated, because it takes one argument, but it is given none.</p>\n\n<p>The solution is simple: saturate <code>Snd</code>. To do this, we adopt the second version:</p>\n\n<pre><code>class C (g :: [a] -&gt; Type) where\n  type ExtractType g (x :: a) :: Type\n\ninstance C NHList where\n  type ExtractType NHList a = Snd a\n                              ^^^^^\n</code></pre>\n\n<h3>Unsaturated type families</h3>\n\n<p>Now, I said that type families must always be fully saturated - but why is this? There are a few reasons, here's one of them.</p>\n\n<p>The constraint solver used in GHC's type system makes the following assumption:</p>\n\n<p>Given a known equality <code>f a ~ g b</code>, we can deduce that <code>f ~ g</code> and <code>a ~ b</code>.</p>\n\n<pre><code>fancyId :: f a ~ g b =&gt; a -&gt; b\nfancyId = id -- `a` must be the same as `b`\n</code></pre>\n\n<p>A type can be in the form <code>f a</code> when <code>f</code> is a type constructor, like <code>Maybe</code>, like <code>Maybe Int</code>. What if <code>f</code> could be a type family?</p>\n\n<pre><code>type family Dumb a b where\n  Dumb _ b = b\n</code></pre>\n\n<p>With partial application, we could have something like <code>Dumb Int ~ Dumb String</code>, and GHC would readily derive <code>Int ~ String</code>. With the restriction that type families must be fully saturated, we can't even write down that equality, getting us away from the problem. Instead, <code>Dumb Int String ~ Dumb String a</code> now relates two fully saturated families, so they can first be reduced to <code>String ~ a</code>, and we're good.</p>\n\n<h3>Unsaturated type constructors</h3>\n\n<p><em>Type constructors</em>, like <code>Maybe</code> or <code>Either</code> are allowed to be partially applied, however. That's because they have certain properties (namely generativity and injectivity) that allow us to deduce the equalities above.</p>\n\n<p>Given <code>Either Int ~ Either a</code>, we can learn that <code>Int ~ a</code>, because <code>Either</code> is injective. <code>Snd</code> is not injective: <code>Snd '(Int, String) ~ Snd '(Char, String)</code> holds, but that doesn't mean <code>'(Int, String) ~ '(Char, String)</code>.</p>\n\n<p>Summarising the above, the signature</p>\n\n<pre><code>type ExtractType g :: a -&gt; Type\n</code></pre>\n\n<p>really means that <code>ExtractType</code> takes a single argument, and return a <em>type constructor</em>. A valid definition, albeit not a very useful one, would be</p>\n\n<pre><code>data Proxy (a :: k) = Proxy\n...\ntype ExtractType g = Proxy\n</code></pre>\n\n<h3>Type-lambdas</h3>\n\n<p>So what would happen if this restriction was lifted? As @pigworker mentioned, this would allow us to have type-level lambdas (well, not necessarily lambdas for us to use, but it would bring about the same problems as if we had lambdas):</p>\n\n<p>Currently, if we know that for some <code>g</code> and <code>h</code>, <code>ExtractType g</code> and <code>ExtractType h</code> are the same, it must mean that they return the same type constructor, such as <code>Proxy</code> above (this is using the first definition). The equational theory here is pretty straightforward because we can easily decide when two type constructors are definitionally equal. Things get more complicated when <code>ExtractType g</code> is allowed to return any old type function: when are two type functions equal? </p>\n\n<p>We could use definitional equality for the lambda terms, that is reducing them to their normal forms, and then using alpha-equivalence, but short of a strong normalisation property, this notion equality is undecidable. That's not necessarily a problem, but this is not something GHC does (yet).</p>\n"}], "owner": {"reputation": 1094, "user_id": 1080014, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/302a4e07bfa2c3c09d6a2b68825ca180?s=128&d=identicon&r=PG", "display_name": "Leander", "link": "https://stackoverflow.com/users/1080014/leander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 1, "accepted_answer_id": 49086642, "answer_count": 2, "score": 1, "last_activity_date": 1520095608, "creation_date": 1520007513, "last_edit_date": 1520010275, "question_id": 49073150, "link": "https://stackoverflow.com/questions/49073150/type-family-returning-a-type", "title": "Type Family returning (a -&gt; Type)", "body": "<p>I have a class:</p>\n\n<pre><code>class C (g :: [a] -&gt; Type) where\n   type ExtractType g :: a -&gt; Type\n</code></pre>\n\n<p>But I am not sure how to write the type family instance</p>\n\n<pre><code>instance C X where\n   type ExtractType X = ???\n</code></pre>\n\n<p><code>Type</code> is <code>*</code> from <code>GHC.Types</code>.\nFor example, lets say I have an named <code>NHList (ts::[(Symbol,Type)])</code>, then <code>ExtractType NHList</code> should return <code>(Symbol,Type) -&gt; Type</code> and be equivalent to <code>Snd</code>.</p>\n"}, {"tags": ["haskell", "docker", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": false, "score": 1, "last_activity_date": 1520029027, "creation_date": 1520029027, "answer_id": 49078217, "question_id": 49072552, "link": "https://stackoverflow.com/questions/49072552/building-a-docker-container-with-stack-and-custom-options/49078217#49078217", "title": "Building a Docker container with stack and custom options", "body": "<p>Not 100% sure, but I don't think this can be configured in <code>stack.yaml</code>.  I think the solution would be to have your own Dockerfile that generates an image, and then point to this image as the base for your generated docker containers.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1520029027, "creation_date": 1520005521, "question_id": 49072552, "link": "https://stackoverflow.com/questions/49072552/building-a-docker-container-with-stack-and-custom-options", "title": "Building a Docker container with stack and custom options", "body": "<p>There are instructions in the \"Docker\" section of the <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#docker\" rel=\"nofollow noreferrer\"><code>stack</code> guide</a> on how to build a Docker container using <code>stack</code>. However, I need to supply additional options in the container, namely:</p>\n\n<pre><code>RUN mkdir -p /code\nVOLUME /code\nWORKDIR /code\n\nRUN useradd app --uid 9000\nUSER app\n\n# Reset fpco/stack-run's dumb ENTRYPOINT\nENTRYPOINT []\nCMD [\"/usr/bin/engine\"]\n</code></pre>\n\n<p>Can these options be configured in the <code>stack.yaml</code> file. Note that I don't want to build from a container, but build one from my development environment.</p>\n"}, {"tags": ["haskell", "jupyter-notebook"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1519999333, "post_id": 49070620, "comment_id": 85146482, "body": "How did you install IHaskell?"}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 2, "creation_date": 1520013678, "post_id": 49070620, "comment_id": 85155531, "body": "This very question is discussed on the IHaskell home page <a href=\"https://github.com/gibiansky/IHaskell/blob/master/README.md#where-are-my-packages-ihaskell--stack\" rel=\"nofollow noreferrer\">github.com/gibiansky/IHaskell/blob/master/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 357, "user_id": 2356643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XFRug.jpg?s=128&g=1", "display_name": "Woodstock", "link": "https://stackoverflow.com/users/2356643/woodstock"}, "is_accepted": false, "score": 0, "last_activity_date": 1581565703, "creation_date": 1581565703, "answer_id": 60200183, "question_id": 49070620, "link": "https://stackoverflow.com/questions/49070620/jupyter-and-haskell-packages/60200183#60200183", "title": "Jupyter and Haskell - packages", "body": "<p>The textbook solution is noted above, on the iHaskell github page.</p>\n\n<p>However, a \"quick and dirty\" solution is to just install the module while in the notebook using GHCi-style shell commands, as detailed here: <a href=\"https://github.com/jamesdbrock/ihaskell-notebook#stack-global-project\" rel=\"nofollow noreferrer\">https://github.com/jamesdbrock/ihaskell-notebook#stack-global-project</a></p>\n\n<p>In this case, to install Text.CSV, you would simply run\n<code>:!stack install csv</code></p>\n\n<p>Note that when you use this quick &amp; dirty method, you will have to restart your iHaskell kernel. You only have to install it once, it will be available the next time you wish to load/import the module (no need to install it twice).</p>\n"}], "owner": {"reputation": 29, "user_id": 9434305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e65c4c1fa6d6422aac37117ef3c678?s=128&d=identicon&r=PG&f=1", "display_name": "zoff", "link": "https://stackoverflow.com/users/9434305/zoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 484, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1581565703, "creation_date": 1519999098, "question_id": 49070620, "link": "https://stackoverflow.com/questions/49070620/jupyter-and-haskell-packages", "title": "Jupyter and Haskell - packages", "body": "<p>I am working in Linux Ubuntu 16.04, my question is when I open in Jupyter new Haskell notebook, I want to import i.e. Text.CSV package that was previously installed through terminal with cabal, but I get an error that Jupyter can not find a module named... So my question is, do I have to / or how can I install packages through Jupyter, or must I sync Haskell under Jupyter somehow with 'original' Haskell programm?</p>\n\n<p>I am new to Haskell and Jupyter notebook. Thank you very much.</p>\n"}, {"tags": ["haskell", "code-climate"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1519996897, "post_id": 49069941, "comment_id": 85144977, "body": "It does not seem to support Haskell: <a href=\"https://docs.codeclimate.com/docs/supported-languages-for-maintainability\" rel=\"nofollow noreferrer\">docs.codeclimate.com/docs/&hellip;</a>"}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1519997409, "post_id": 49069941, "comment_id": 85145300, "body": "Not out of the box, but we are using it with <code>hlint</code>. Since there are off-the-shelf tools to count the lines of codes of any language (like <a href=\"https://www.npmjs.com/package/sloc\" rel=\"nofollow noreferrer\"><code>sloc</code></a>) I was wondering if there was some tweak we could use. But indeed, the fact that Haskell is not officially supported gives me little hope :/"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519996753, "creation_date": 1519996753, "question_id": 49069941, "link": "https://stackoverflow.com/questions/49069941/how-to-configure-code-climate-to-count-the-lines-of-code-in-a-haskell-project", "title": "How to configure code climate to count the lines of code in a Haskell project", "body": "<p>Code climate counts the lines of code in our project, but it seems to ignore Haskell files (only Java files are counted). Is there a way to configure code climate to change this behavior?</p>\n"}, {"tags": ["haskell", "composition"], "comments": [{"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1520197222, "post_id": 49069768, "comment_id": 85206007, "body": "It is a reverse tail like init. inita = (reverse . tail . reverse)    -- parameters are superflous in eta converted expressions"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1520001437, "last_edit_date": 1520001437, "creation_date": 1519996423, "answer_id": 49069857, "question_id": 49069768, "link": "https://stackoverflow.com/questions/49069768/an-error-about-haskell-composition/49069857#49069857", "title": "An error about haskell composition", "body": "<p>No, operators have a lower precedence than functions, so that means that your expression:</p>\n\n<pre><code>inita xs =  reverse  .  (drop 1) (reverse xs)\n</code></pre>\n\n<p>Is equal to:</p>\n\n<pre><code>inita xs = (reverse) . ((drop 1) (reverse xs))\n</code></pre>\n\n<p>or in a more canonical form:</p>\n\n<pre><code>inita xs = (.) (reverse) ((drop 1) (reverse xs))\n</code></pre>\n\n<p>Now <code>(.)</code> is defined as:</p>\n\n<pre><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n(.) f g x = f (g x)\n</code></pre>\n\n<p>So in this context, <code>f = reverse</code>, and <code>g = ((drop 1) (reverse xs))</code>, so we have basically written:</p>\n\n<pre><code>inita xs = \\x -&gt; reverse ((drop 1) (reverse xs) x)\n</code></pre>\n\n<p>or we can move the <code>x</code> parameter to the head of the function:</p>\n\n<pre><code>inita xs x = reverse ((drop 1) (reverse xs) x)\n</code></pre>\n\n<p>So you are missing the <code>x</code> here in your rewrite. We can rewrite the code to:</p>\n\n<pre><code>inita = (reverse .) . drop 1 . reverse\n</code></pre>\n\n<p>since:</p>\n\n<pre><code>   inita xs = (.) reverse ((drop 1) (reverse xs))\n-&gt; inita xs = ((.) reverse) ((drop 1) (reverse xs))\n-&gt; inita xs = ((.) reverse) ((.) (drop 1) reverse xs)\n-&gt; inita = ((.) reverse) . ((.) (drop 1) reverse)\n-&gt; inita = ((.) reverse) . (drop 1 . reverse)\n-&gt; inita = ((.) reverse) . drop 1 . reverse\n-&gt; inita = (reverse .) . (drop 1 . reverse)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1519997235, "last_edit_date": 1519997235, "creation_date": 1519996733, "answer_id": 49069933, "question_id": 49069768, "link": "https://stackoverflow.com/questions/49069768/an-error-about-haskell-composition/49069933#49069933", "title": "An error about haskell composition", "body": "<p><code>reverse ( (drop 1) (reverse xs) )</code> is equal to <code>(reverse . drop 1) (reverse xs)</code>. But that's not what <code>reverse . (drop 1) (reverse xs)</code> is parsed as, because infix operators have lower precedence than function application. For this reason, what it's actually parsed as is instead <code>reverse . ((drop 1) (reverse xs))</code>, but that doesn't make any sense (i.e. doesn't typecheck), because <code>(drop 1) (reverse xs)</code> is not a function but a list.</p>\n\n<p>The preferred way to write such a function is</p>\n\n<pre><code>inita xs = reverse . drop 1 $ reverse xs\n</code></pre>\n\n<p>Here, I've replaced the high-precedence plain function application with the low-precedence <code>$</code> operator (which does nothing else but apply a function, but due to the low precedence it's actually this right composition-function).</p>\n\n<p>Actually though, you don't need that, because you only pass in <code>xs</code> once at the end. So you might as well make <code>reverse</code> part of the composition chain too:</p>\n\n<pre><code>inita xs = reverse . drop 1 . reverse $ xs\n</code></pre>\n\n<p>...which can simply be \u03b7-reduced to</p>\n\n<pre><code>inita = reverse . drop 1 . reverse\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 5448549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/55e09f85241547a3d2332a1c53862be9?s=128&d=identicon&r=PG&f=1", "display_name": "wxw", "link": "https://stackoverflow.com/users/5448549/wxw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 49069933, "answer_count": 2, "score": 1, "last_activity_date": 1520001437, "creation_date": 1519996100, "last_edit_date": 1519996424, "question_id": 49069768, "link": "https://stackoverflow.com/questions/49069768/an-error-about-haskell-composition", "title": "An error about haskell composition", "body": "<p>I wrote a function:</p>\n\n<pre><code>inita xs = reverse . (drop 1) (reverse xs)\n</code></pre>\n\n<p>I thought it equals:</p>\n\n<pre><code>inita xs = reverse (  (drop 1) (reverse xs)  )\n</code></pre>\n\n<p>But I had errors:</p>\n\n<pre><code> Couldn't match expected type \u2018a -&gt; [a1]\u2019 with actual type \u2018[a2]\u2019\n    Relevant bindings include\n      xs :: [a2] (bound at ch2.hs:1:7)\n      init1 :: [a2] -&gt; a -&gt; [a1] (bound at ch2.hs:1:1)\n    Possible cause: \u2018drop\u2019 is applied to too many arguments\n    In the second argument of \u2018(.)\u2019, namely \u2018(drop 1) (reverse xs)\u2019\n    In the expression: reverse . (drop 1) (reverse xs)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>So what's wrong with that composition expression?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 0, "last_activity_date": 1520048205, "creation_date": 1520048205, "answer_id": 49080372, "question_id": 49065348, "link": "https://stackoverflow.com/questions/49065348/simple-prime-number-challenge-haskell-code-gives-incorrect-answer/49080372#49080372", "title": "Simple prime number challenge haskell code gives incorrect answer", "body": "<p>Your method generates duplicates:</p>\n\n<pre><code>ghci&gt; ep87 150\n[28,93,47,112,145,33,98,52,117,150,49,114,68,133,73,138,92,145]\n              ^^^                                          ^^^\n</code></pre>\n"}], "owner": {"reputation": 478, "user_id": 4079111, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e4775c2984de42fca587c03065107de1?s=128&d=identicon&r=PG&f=1", "display_name": "doofin", "link": "https://stackoverflow.com/users/4079111/doofin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 49080372, "answer_count": 1, "score": 1, "last_activity_date": 1520048205, "creation_date": 1519979502, "question_id": 49065348, "link": "https://stackoverflow.com/questions/49065348/simple-prime-number-challenge-haskell-code-gives-incorrect-answer", "title": "Simple prime number challenge haskell code gives incorrect answer", "body": "<p>the code below tries to solve <a href=\"https://projecteuler.net/problem=87\" rel=\"nofollow noreferrer\">https://projecteuler.net/problem=87</a></p>\n\n<pre><code>import Math.NumberTheory.Primes.Sieve -- from package arithmoi\n\ngen::[Integer]-&gt;Integer-&gt;[Integer]-- time complexity : n! , n = numberofprimes\ngen pmlist limit=filter (\\x-&gt;x&lt;=limit) prelist\n  where prelist=do\n          let ls1=filter (\\(x::Integer)-&gt;(x^2)&lt;=limit) pmlist\n          a&lt;-ls1\n          let ls2=filter (\\(x::Integer)-&gt;(x^3)&lt;=limit) ls1\n          b&lt;-ls2\n          c&lt;-filter (\\(x::Integer)-&gt;(x^4)&lt;=limit) ls2\n  --  guard $ (b&gt;=a)&amp;&amp;(c&gt;=b)\n          let res=(a^2+b^3+c^4)\n          return res\nmain=do\n  print \"euler proj\" -- other's answer:1097343 , my : 1139575\n\n  print $ length  $ ep87 limit_1\n--  print $  ep87\n\nprimesUnder i = takeWhile (\\x-&gt;x&lt;=i) primes -- library function\nlimit_1::Integer\nlimit_1=50000000\nlimit_2=1000000000\nlimit_3=10000000000\n\nep87 lmt =  gen (primesUnder lmt) lmt \n</code></pre>\n\n<p>The other's answer:1097343 , but this code snippet gives 1139575 , what could possibly be the culprit?</p>\n"}, {"tags": ["string", "list", "haskell", "filter"], "comments": [{"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 3, "creation_date": 1519962665, "post_id": 49062451, "comment_id": 85130251, "body": "Is your function to delete only leading whitespace from a string, or to delete leading whitespace from an array of strings?  If it&#39;s the latter, you could do a map (dropWhile (\\c -&gt; c == &#39; &#39;))"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1519983481, "post_id": 49062451, "comment_id": 85137755, "body": "Do you only see spaces <code>&#39; &#39;</code> as whitespace? What about tabs, new lines, etc? Usually regexes see whitespaces as a space, new line, tab, carriage return, vertical tab, and form feed."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1520004911, "post_id": 49062451, "comment_id": 85150294, "body": "You ask about deleting leading whitespace from a single string, but your example has you deleting leading whitespace from a list of strings. Which do you want to do?"}], "answers": [{"comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 5, "creation_date": 1519972359, "post_id": 49062582, "comment_id": 85132763, "body": "Shouldn&#39;t the second example be <code>map deleteLeadingWhitespace</code>?"}, {"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1519988932, "post_id": 49062582, "comment_id": 85140745, "body": "Absolutely should.  Fixed!"}], "tags": [], "owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "is_accepted": false, "score": 2, "last_activity_date": 1519988920, "last_edit_date": 1519988920, "creation_date": 1519962972, "answer_id": 49062582, "question_id": 49062451, "link": "https://stackoverflow.com/questions/49062451/haskell-deleting-white-space-from-a-list-of-strings/49062582#49062582", "title": "Haskell: Deleting white space from a list of strings", "body": "<p>The question you asked, on how to delete leading whitespace from a string, you can do by simply doing dropWhile on a string:</p>\n\n<pre><code>deleteLeadingWhitespace = dropWhile (\\c -&gt; c == ' ')\n</code></pre>\n\n<p>though you should be more clever if you consider other things \"whitespace\".  You could use the \"isSpace\" function defined in Data.Char for example.</p>\n\n<p>From your sample data, it looks like you are really trying to do this for a list of strings, in which case you can map the dropWhile over your array:</p>\n\n<pre><code>map deleteLeadingWhitespace\n</code></pre>\n\n<p>The filter approach you are taking is a little bit dangerous, because even if you had it doing what you think it should, it would be deleting all the spaces, not just the leading ones.</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 9301564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a9f1505cec5669873e68f463059234?s=128&d=identicon&r=PG&f=1", "display_name": "Alowishious", "link": "https://stackoverflow.com/users/9301564/alowishious"}, "edited": false, "score": 1, "creation_date": 1519973849, "post_id": 49063835, "comment_id": 85133286, "body": "Drop while was the best way to do this, doing it with the filter was a pain and must more difficult than using dropWhile. Thank you for the help your explanation was very helpful!"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 5, "last_activity_date": 1519972039, "creation_date": 1519972039, "answer_id": 49063835, "question_id": 49062451, "link": "https://stackoverflow.com/questions/49062451/haskell-deleting-white-space-from-a-list-of-strings/49063835#49063835", "title": "Haskell: Deleting white space from a list of strings", "body": "<p>The reason the OP <code>cutWhitespace</code> function only works on the first string, is that due to operator precedence, it's actually this function:</p>\n\n<pre><code>cutWhitespace (x:xs) = (filter (\\xs -&gt; (xs /=' ')) x) : xs\n</code></pre>\n\n<p>Here, I've put brackets around most of the body to make it clear how it evaluates. The <code>filter</code> is only applied on <code>x</code>, and <code>x</code> is the first element of the input list; in the example input <code>\" x\"</code>.</p>\n\n<p>If you filter <code>\" x\"</code> as given, you get <code>\"x\"</code>:</p>\n\n<pre><code>Prelude&gt; filter (\\xs -&gt; (xs /=' ')) \" x\"\n\"x\"\n</code></pre>\n\n<p>The last thing <code>cutWhitespace</code> does, then, is to take the rest of the list (<code>[\" y\", \" z\"]</code>) and cons it on <code>\"x\"</code>, so that it returns <code>[\"x\",\" y\",\" z\"]</code>.</p>\n\n<p>In order to address the problem, you could write the function with the realisation that a list of strings is a nested list of characters, i.e. <code>[[Char]]</code>.</p>\n\n<p>As a word of warning, pattern-matching on <code>(x:xs)</code> without also matching on <code>[]</code> is dangerous, as it'll fail on empty lists.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1519984882, "creation_date": 1519984882, "answer_id": 49066816, "question_id": 49062451, "link": "https://stackoverflow.com/questions/49062451/haskell-deleting-white-space-from-a-list-of-strings/49066816#49066816", "title": "Haskell: Deleting white space from a list of strings", "body": "<p>Instead of writing a custom function that checks if a character is whitespace, I would advice to use <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Char.html#v:isSpace\" rel=\"nofollow noreferrer\"><strong><code>isSpace :: Char -&gt; Bool</code></strong></a>. This function does not only returns <code>True</code> for a space (<code>' '</code>), but for a new line (<code>'\\n'</code>), a carriage return (<code>'\\r'</code>), a tab (<code>'\\t'</code>), a vertical tab (<code>'\\v'</code>) and form feed (<code>'\\f'</code>) as well. Usually it is better to work with such functions since the odds of forgetting certain cases is lower.</p>\n\n<p>We can thus remove the spacing of a single string with:</p>\n\n<pre><code>dropWhile isSpace\n</code></pre>\n\n<p>Where we thus <code>dropWhile</code> in such way that all chacters where <code>isSpace</code>.</p>\n\n<p>We can then perform a mapping with this filter to filter the spaces out of all the strings, like:</p>\n\n<pre><code>import Data.Char(isSpace)\n\ncutWhitespace = map (dropWhile isSpace)\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 9301564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a9f1505cec5669873e68f463059234?s=128&d=identicon&r=PG&f=1", "display_name": "Alowishious", "link": "https://stackoverflow.com/users/9301564/alowishious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2909, "favorite_count": 0, "accepted_answer_id": 49063835, "answer_count": 3, "score": 4, "last_activity_date": 1519988920, "creation_date": 1519961744, "last_edit_date": 1519972112, "question_id": 49062451, "link": "https://stackoverflow.com/questions/49062451/haskell-deleting-white-space-from-a-list-of-strings", "title": "Haskell: Deleting white space from a list of strings", "body": "<p>The question is: Write a function that will delete leading white\nspace from a string. Example: <code>cutWhitespace [\" x\",\"y\",\" z\"]</code> Expected answer: <code>[\"x\",\"y\",\"z\"]</code></p>\n\n<p>Heres what I have:</p>\n\n<pre><code>cutWhitespace (x:xs) = filter (\\xs -&gt; (xs /=' ')) x:xs\n</code></pre>\n\n<p>This returns <code>[\"x\", \" y\",\" z\"]</code> when the input is <code>[\" x\",\" y\", \" z\"]</code>. Why is it ignoring the space in the second and third string and how do I fix it?</p>\n\n<p>We are allowed to use higher-order functions which is why I implemented filter.</p>\n"}, {"tags": ["reactjs", "haskell", "npm", "material-design", "ghcjs"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 5031129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebc8958cd7106edd52dae59dc4c1bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Feng", "link": "https://stackoverflow.com/users/5031129/steven-feng"}, "is_accepted": true, "score": 0, "last_activity_date": 1520118215, "creation_date": 1520118215, "answer_id": 49090155, "question_id": 49061589, "link": "https://stackoverflow.com/questions/49061589/ghcjs-how-to-use-a-js-library-that-is-intended-to-be-used-with-npm/49090155#49090155", "title": "GHCJS: How to use a JS library that is intended to be used with npm", "body": "<p>In the <a href=\"https://github.com/mui-org/material-ui/blob/6fe39e056d1202db59eb41e16e6777f862ac9d85/package.json\" rel=\"nofollow noreferrer\">package.json</a> of material-ui, scripts <code>build:umd:prod</code> and <code>build:umd:dev</code> can be used to build UMD bundles of the package. So you can use the <a href=\"https://unpkg.com/material-ui@1.0.0-beta.35/umd/material-ui.development.js\" rel=\"nofollow noreferrer\">CDN link</a> provided by <a href=\"https://unpkg.com\" rel=\"nofollow noreferrer\">unpkg</a>.</p>\n\n<p>Even though <code>material-ui</code> doesn't declare a peer dependency on <code>react-transition-group</code>, it expects <code>react-transition-group/TransitionGroup</code> to be present. So we have to add the following code <strong>before</strong> the link to <code>material-ui</code></p>\n\n<pre><code>&lt;script crossorigin=\"anonymous\" src=\"https://unpkg.com/react-transition-group@2.2.1/dist/react-transition-group.js\"&gt;&lt;/script&gt;\n&lt;script&gt;\n    window[\"react-transition-group/TransitionGroup\"] = ReactTransitionGroup.TransitionGroup;\n&lt;/script&gt;\n</code></pre>\n\n<p>I created a issue on <code>material-ui</code>'s github repository, see <a href=\"https://github.com/mui-org/material-ui/issues/10507\" rel=\"nofollow noreferrer\">that issue</a> for more details.</p>\n"}], "owner": {"reputation": 51, "user_id": 5031129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ebc8958cd7106edd52dae59dc4c1bc1?s=128&d=identicon&r=PG&f=1", "display_name": "Steven Feng", "link": "https://stackoverflow.com/users/5031129/steven-feng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "accepted_answer_id": 49090155, "answer_count": 1, "score": 1, "last_activity_date": 1520118215, "creation_date": 1519955470, "question_id": 49061589, "link": "https://stackoverflow.com/questions/49061589/ghcjs-how-to-use-a-js-library-that-is-intended-to-be-used-with-npm", "title": "GHCJS: How to use a JS library that is intended to be used with npm", "body": "<p>I'm using <code>ghcjs-0.2.0.9006030_ghc-7.10.3</code> with stack <code>lts-6.30</code> to build a frontend app. Inspired by <a href=\"http://blog.wuzzeb.org/full-stack-web-haskell/client.html\" rel=\"nofollow noreferrer\">this post</a>, I decided to use <code>react-flux</code> and <code>material-ui</code>. I added React's CDN link to my index.html, and <a href=\"https://gist.github.com/fizruk/fb5bad8a08a4b788764851c11ebbadf8\" rel=\"nofollow noreferrer\">configured</a> GHCJSi to use a custom <code>index-dev.html</code> when working with the repl.(React's CDN link is also included in <code>index-dev.html</code>)</p>\n\n<p>However, with <a href=\"https://material-ui-next.com/\" rel=\"nofollow noreferrer\">material-ui-next</a>, the <a href=\"https://material-ui-next.com/getting-started/installation/\" rel=\"nofollow noreferrer\">official installation method</a> is to use NPM. They provide no CDN link. So how to use this library in a GHCJS project? I think one of the following should work:</p>\n\n<ul>\n<li>Use the <a href=\"https://cdn.jsdelivr.net/npm/material-ui-next@1.0.0-beta.34/index.js\" rel=\"nofollow noreferrer\">CDN link</a> provided by jsDelivr. (Though this link doesn't work)</li>\n<li>Find some way to bundle <code>material-ui-next</code> and put it in <code>js-sources</code> field in cabal, so that it can be linked with our app at build time.</li>\n</ul>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["haskell", "fold", "type-signature"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1519933554, "post_id": 49057524, "comment_id": 85119690, "body": "Are you just asking what <code>t a</code> means? Do you understand what the <code>Foldable t =&gt;</code> part means?"}, {"owner": {"reputation": 1278, "user_id": 1374078, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a96abe3865e9d233197150b1ae83743a?s=128&d=identicon&r=PG", "display_name": "phoxd", "link": "https://stackoverflow.com/users/1374078/phoxd"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1519934137, "post_id": 49057524, "comment_id": 85120006, "body": "No, I have no idea."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1519934232, "post_id": 49057524, "comment_id": 85120055, "body": "Near duplicate of <a href=\"https://stackoverflow.com/q/49036437/1126841\">stackoverflow.com/q/49036437/1126841</a> asked just yesterday."}], "answers": [{"comments": [{"owner": {"reputation": 1278, "user_id": 1374078, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a96abe3865e9d233197150b1ae83743a?s=128&d=identicon&r=PG", "display_name": "phoxd", "link": "https://stackoverflow.com/users/1374078/phoxd"}, "edited": false, "score": 0, "creation_date": 1519936715, "post_id": 49057863, "comment_id": 85121364, "body": "I did not know that you could write type signature for lists like this <code>[] a</code> instead of <code>[a]</code>. Is this similar to <code>Foldable</code>?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 1278, "user_id": 1374078, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a96abe3865e9d233197150b1ae83743a?s=128&d=identicon&r=PG", "display_name": "phoxd", "link": "https://stackoverflow.com/users/1374078/phoxd"}, "edited": false, "score": 0, "creation_date": 1519938639, "post_id": 49057863, "comment_id": 85122348, "body": "<code>[a]</code> is just syntactic sugar for <code>[] a</code> (and I think <code>[]</code> is special-cased to be a valid name for a type constructor). <code>Foldable</code> is just a generalization for the various folds, allowing you to use <code>foldl</code> et al. on container types other than lists."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 2, "last_activity_date": 1519934760, "creation_date": 1519934760, "answer_id": 49057863, "question_id": 49057524, "link": "https://stackoverflow.com/questions/49057524/fold-type-signature-with-foldable-type-constraint/49057863#49057863", "title": "Fold type signature with `Foldable` type constraint", "body": "<p>The type class <code>Foldable</code> defines a number of functions in addition to <code>foldl</code>.</p>\n\n<pre><code>class Foldable t where\n    foldMap :: Monoid m =&gt; t m -&gt; m\n    foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b\n    foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\n    -- ...\n</code></pre>\n\n<p>We can define an <em>instance</em> of <code>Foldable</code> for a type constructor <code>t</code> by defining at least <code>foldMap</code> or <code>foldr</code> for the type. (<code>foldl</code> has a default definition in terms of some of the others, so you get it for \"free\" as long as you supply the minimum definition).</p>\n\n<pre><code>instance Foldable [] where\n    foldr f b [] = b\n    foldr f b (x:xs) = f x : foldr f b xs\n\ninstance Foldable Maybe where\n    foldr f b Nothing = b\n    foldr f b (Just a) = f b a\n</code></pre>\n\n<p>The <code>t</code> in the type signature just means that as long as a type constructor has a <code>Foldable</code> instance for it defined, you can use <code>foldl</code> with a value of the appropriate type. For example:</p>\n\n<pre><code>Prelude&gt; foldl (+) 0 [1,2,3]\n6\nPrelude&gt; foldl (+) 0 []\n0\nPrelude&gt; foldl (+) 0 Nothing\n0\nPrelude&gt; foldl (+) 0 (Just 3)\n3\n</code></pre>\n\n<p>In the first two cases, we use the <code>[]</code> instance because the arguments corresponding to <code>t a</code> are lists, meaning <code>t</code> is <em>unified</em> with <code>[]</code>, written <code>t ~ []</code>. In the second two, we use the <code>Maybe</code> instance because the arguments corresponding to <code>t a</code> are <code>Maybe</code> values, so <code>t ~ Maybe</code>.</p>\n"}], "owner": {"reputation": 1278, "user_id": 1374078, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a96abe3865e9d233197150b1ae83743a?s=128&d=identicon&r=PG", "display_name": "phoxd", "link": "https://stackoverflow.com/users/1374078/phoxd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "accepted_answer_id": 49057863, "answer_count": 1, "score": 0, "last_activity_date": 1519934760, "creation_date": 1519933470, "question_id": 49057524, "link": "https://stackoverflow.com/questions/49057524/fold-type-signature-with-foldable-type-constraint", "title": "Fold type signature with `Foldable` type constraint", "body": "<p>On my <code>GHCi</code> <code>foldr</code> and <code>foldl</code> have this signature:</p>\n\n<pre><code>Prelude&gt; :t foldr\nfoldr :: Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b\nPrelude&gt; :t foldl\nfoldl :: Foldable t =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\n</code></pre>\n\n<p>What is the difference between the alternative type signature of fold, specifically <code>t a</code> part?</p>\n\n<pre><code>fr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\n</code></pre>\n"}, {"tags": ["haskell", "tree"], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1519939893, "post_id": 49057209, "comment_id": 85122960, "body": "Extra credit: use <code>Data.DList</code> instead of list append for an asymptotically faster traversal."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1519940385, "post_id": 49057209, "comment_id": 85123205, "body": "@luqui: I don&#39;t think we need to pass <code>DLists</code> per se, we can emulate that with recursively passing a future tail."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1519945782, "post_id": 49057209, "comment_id": 85125407, "body": "yeah same diff.   I like DList because it is clearer to me what&#39;s going on -- we&#39;re just using a different representation of a list.  That parameter could be anything; <code>go (go tl r) l</code> is just a way of saying &quot;append&quot; but it&#39;s rather obfuscated."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1519978216, "last_edit_date": 1519978216, "creation_date": 1519932097, "answer_id": 49057209, "question_id": 49056982, "link": "https://stackoverflow.com/questions/49056982/extracting-specific-types-from-a-tree/49057209#49057209", "title": "Extracting specific types from a tree", "body": "<p>Although other approaches exist, probable the easiest one is to use recursion. Here the base cases are <code>Empty</code> and <code>Leaf</code>. In case of an <code>Empty</code>, we return an empty list, in case of a <code>Leaf</code>, we can return a list with <em>one</em> element: the one wrapped in the leaf, so:</p>\n\n<pre><code>leave_elements :: Tree a -&gt; [a]\nleave_elements Empty = []\nleave_elements (Leaf x) = [x]\nleave_elements (Branch ...) = ...\n</code></pre>\n\n<p>We still need to fill in the <code>Branch</code> case, here we see three elements in the constructor: <code>a</code>, which we can ignore, and the two subtrees. We can recursively call the <code>leave_elements</code> recursively on the subtrees, and append the lists of the data of the leaves of the subtrees. For example:</p>\n\n<pre><code>leave_elements :: Tree a -&gt; [a]\nleave_elements Empty = []\nleave_elements (Leaf x) = [x]\nleave_elements (Branch _ l r) = leave_elements l ++ leave_elements r\n</code></pre>\n\n<p>For your given sample tree, this produces:</p>\n\n<pre><code>Prelude&gt; leave_elements (Branch [] (Branch [0] (Leaf [0,1]) (Branch [0] (Leaf [0,2]) (Branch [0] (Leaf [0,3]) (Leaf [0])))) (Branch [] (Branch [1] (Leaf [1,2]) (Branch [1] (Leaf [1,3]) (Leaf [1]))) (Branch [] (Branch [2] (Leaf [2,3]) (Leaf [2])) (Branch [] (Leaf [3]) (Leaf [])))))\n[[0,1],[0,2],[0,3],[0],[1,2],[1,3],[1],[2,3],[2],[3],[]]\n</code></pre>\n\n<p>We can also boost performance by using for instance a tail we pass recursively:</p>\n\n<pre><code>leave_elements :: Tree a -&gt; [a]\nleave_elements = go []\n    where go tl Empty = tl\n          go tl (Leaf x) = (x:tl)\n          go tl (Branch _ l r) = go (go tl r) l\n</code></pre>\n\n<p>Or we can work with <code>Data.DList</code>:</p>\n\n<pre><code>import Data.DList\n\nleave_elements :: Tree a -&gt; [a]\nleave_elements = toList . go\n    where go Empty = empty\n          go (Leaf x) = singleton x\n          go (Branch _ l r) = append (go l) (go r)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 1, "last_activity_date": 1520037995, "last_edit_date": 1520037995, "creation_date": 1519988592, "answer_id": 49067834, "question_id": 49056982, "link": "https://stackoverflow.com/questions/49056982/extracting-specific-types-from-a-tree/49067834#49067834", "title": "Extracting specific types from a tree", "body": "<p>A more advanced technique, which saves you the effort of writing and maintaining recursive functions by hand, is to use a generic programming library such as <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\"><code>lens</code></a>'s <a href=\"https://hackage.haskell.org/package/lens-4.16/docs/Control-Lens-Plated.html\" rel=\"nofollow noreferrer\"><code>Plated</code> module</a>.</p>\n\n<p>Here's how <code>Plated</code> works: you describe how to identify a value's <em>children</em> - immediate substructures having the same type as the value itself - by writing an instance of the <a href=\"https://hackage.haskell.org/package/lens-4.16/docs/Control-Lens-Plated.html#t:Plated\" rel=\"nofollow noreferrer\"><code>Plated</code> class</a>, and the library's various higher-order functions take care of recursively finding the children's children and so on. In the case of your <code>Tree</code> datatype, only the <code>Branch</code> constructor has children (the left and right children), so those are the only places we apply <code>f</code>.</p>\n\n<pre><code>instance Plated (Tree a) where\n    plate f (Branch x l r) = Branch x &lt;$&gt; f l &lt;*&gt; f r\n    plate f t = pure t\n</code></pre>\n\n<p>(If you're willing to derive <code>Data</code> then you don't even have to write <code>plate</code>.)</p>\n\n<p><code>Plated</code>'s <a href=\"https://hackage.haskell.org/package/lens-4.16/docs/Control-Lens-Plated.html#v:universe\" rel=\"nofollow noreferrer\"><code>universe</code></a> function can now recursively search a tree's children, and the children's children, and so on, returning a lazy list which yields every node in the tree. It works roughly like this:</p>\n\n<pre><code>universe :: Plated a =&gt; a -&gt; [a]\nuniverse t = t : [descendant | child &lt;- toListOf plate t, descendant &lt;- universe child]\n</code></pre>\n\n<p>So to find all the leaves, you just have to filter this list to search for <code>Leaf</code> constructors.</p>\n\n<pre><code>leaves :: Tree a -&gt; [a]\nleaves t = [x | Leaf x &lt;- universe t]\n</code></pre>\n\n<p>Job done!</p>\n"}, {"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1520038243, "post_id": 49077928, "comment_id": 85164959, "body": "I downvoted this answer because it is not a good example of a <code>Foldable</code> instance. While it\u2019s not law-breaking per se (because <code>Foldable</code> doesn\u2019t have any laws to speak of), it\u2019s widely agreed upon that a <code>Foldable t</code> instance should pick <i>all</i> of the <code>a</code>s out of a <code>t a</code>, not just some of them. Since <code>Tree</code> as written can be made an instance of <code>Traversable</code>, this <code>Foldable</code> instance wouldn\u2019t agree with such a <code>Traversable</code> instance."}, {"owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1520038897, "post_id": 49077928, "comment_id": 85165094, "body": "@BenjaminHodgson Thanks for the feedback - I&#39;m new to Haskell. What&#39;s the downside of creating a type that only allows access to some of its data? Wouldn&#39;t the <code>Traversable</code> implementation do the same thing (traverse only the leaves)? In other languages data structures that hide some of their data may be unorthodox sometimes but not necessarily a bad idea."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1520039140, "post_id": 49077928, "comment_id": 85165134, "body": "That\u2019s a good question. The <code>Traversable</code> instance <i>cannot</i> leave any of the <code>a</code>s where they are because of the type of <code>traverse :: (Traversable t, Applicative f) =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)</code>. All of the <code>a</code>s in the <code>t</code> must be transformed into <code>b</code>s."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1520039328, "post_id": 49077928, "comment_id": 85165171, "body": "Generally speaking, the notion of data hiding is not a bad thing at all. It allows you freedom of choice in the way your datatype is implemented. Haskell programmers use data hiding just as much as the next guy. However hiding values whose type is chosen by the user just doesn\u2019t make sense as an engineering decision: such data must have been supplied by the user in the first place so why hide it?"}, {"owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1520043094, "post_id": 49077928, "comment_id": 85165760, "body": "@BenjaminHodgson Good point... Also for the <code>Tree</code> to be traversable it must be a functor, and if it only traversed its leaves it would violate the functor identity law. I&#39;m going to make note of your comments and leave the answer up for posterity. Thanks for the intel!"}], "tags": [], "owner": {"reputation": 15126, "user_id": 1953800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4173076e5187c82e74379de9aeb00aa4?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/1953800/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1520043473, "last_edit_date": 1520043473, "creation_date": 1520027404, "answer_id": 49077928, "question_id": 49056982, "link": "https://stackoverflow.com/questions/49056982/extracting-specific-types-from-a-tree/49077928#49077928", "title": "Extracting specific types from a tree", "body": "<p>As @BenjaminHodgson notes in the comments the following solution is valid, but cannot have a consistent implementation across other typeclasses. For example making <code>Tree</code> an instance of <code>Traversable</code> would result in an implementation of the <code>traverse</code> function that necessarily touches all elements of the <code>Tree</code>. I am leaving this up for learning purposes, but don't use this solution.</p>\n\n<p>Using the <a href=\"http://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Foldable.html\" rel=\"nofollow noreferrer\"><code>Foldable</code> typeclass</a>:</p>\n\n<pre><code>import qualified Data.Foldable as F\n\ninstance F.Foldable Tree where\n    foldMap f Empty = mempty\n    foldMap f (Branch x l r) = foldMap f l `mappend`\n                               foldMap f r\n    foldMap f (Leaf x) = f x\n</code></pre>\n\n<p>For your <code>tree</code>:</p>\n\n<pre><code>Prelude&gt; foldr (\\x acc -&gt; x: acc) [] tree\n[[0,1],[0,2],[0,3],[0],[1,2],[1,3],[1],[2,3],[2],[3],[]]\n</code></pre>\n"}], "owner": {"reputation": 232, "user_id": 5202572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b90339fcc33f2a548a97397f861151d1?s=128&d=identicon&r=PG&f=1", "display_name": "hisoka", "link": "https://stackoverflow.com/users/5202572/hisoka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 49057209, "answer_count": 3, "score": 6, "last_activity_date": 1520043473, "creation_date": 1519931160, "last_edit_date": 1519932209, "question_id": 49056982, "link": "https://stackoverflow.com/questions/49056982/extracting-specific-types-from-a-tree", "title": "Extracting specific types from a tree", "body": "<p>I have built a tree from which I want to collect all the Leaf types:</p>\n\n<pre><code>Branch [] (Branch [0] (Leaf [0,1]) (Branch [0] (Leaf [0,2]) (Branch\n[0] (Leaf [0,3]) (Leaf [0])))) (Branch [] (Branch [1] (Leaf [1,2])\n(Branch [1] (Leaf [1,3]) (Leaf [1]))) (Branch [] (Branch [2] (Leaf\n[2,3]) (Leaf [2])) (Branch [] (Leaf [3]) (Leaf []))))\n</code></pre>\n\n<p>What I get as a type in GHCI (<code>:t</code>) of the above variable is :</p>\n\n<pre><code>Tree [Int]\n</code></pre>\n\n<p>The data structure is the following:</p>\n\n<pre><code>data Tree a = Empty | Leaf a | Branch a (Tree a) (Tree a)\n</code></pre>\n\n<p>I am trying to isolate <em>ONLY</em> the leaves such that I would obtain :</p>\n\n<pre><code>[ [0,1], [0,2] .. [3], [] ]\n</code></pre>\n\n<p>I've been trying to run a <code>filter</code> on the results, however that doesn't work. I've tried to using the function <code>Data.Foldable.toList</code>, however it pulls all the branches in as well and results in a large list of lists with multiple duplicates and no possibility to tell whether it's a branch or a leaf.</p>\n"}, {"tags": ["haskell", "io", "arguments"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 1, "creation_date": 1519927875, "post_id": 49055999, "comment_id": 85116712, "body": "args are supplied to the command line when invoking the program e.g. <code>prog arg1 arg2 ...</code>"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1519927954, "post_id": 49055999, "comment_id": 85116757, "body": "You don&#39;t provide any argument to the program."}, {"owner": {"reputation": 153, "user_id": 5285349, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c6e48d86c74fd1fca638a7ca513297de?s=128&d=identicon&r=PG&f=1", "display_name": "JamalCrawford..", "link": "https://stackoverflow.com/users/5285349/jamalcrawford"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1519928075, "post_id": 49055999, "comment_id": 85116821, "body": "As in if I do myFunFunction &quot;hello&quot; It should work? @freestyle"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1519928376, "post_id": 49055999, "comment_id": 85116972, "body": "@JamalCrawford, from doc: &quot;Computation <code>getArgs</code> returns a list of the program&#39;s command line arguments (not including the program name).&quot;"}, {"owner": {"reputation": 153, "user_id": 5285349, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c6e48d86c74fd1fca638a7ca513297de?s=128&d=identicon&r=PG&f=1", "display_name": "JamalCrawford..", "link": "https://stackoverflow.com/users/5285349/jamalcrawford"}, "edited": false, "score": 0, "creation_date": 1519928538, "post_id": 49055999, "comment_id": 85117060, "body": "I can read a doc.  I am clearly having a disconnect.  Thats why I am asking on here"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1519928998, "post_id": 49055999, "comment_id": 85117312, "body": "Use <code>withArgs [&quot;test&quot;] myFunFunction</code>"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 11, "creation_date": 1519928997, "post_id": 49056302, "comment_id": 85117310, "body": "Also possibly of interest: when testing things in ghci, just running <code>main</code> won&#39;t set up the argument list in any special way, but <code>:main foo bar baz</code> will."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 5, "last_activity_date": 1519928638, "creation_date": 1519928638, "answer_id": 49056302, "question_id": 49055999, "link": "https://stackoverflow.com/questions/49055999/how-does-getargs-work/49056302#49056302", "title": "How does getArgs work?", "body": "<p>The type of <code>getArgs</code> is <code>IO [String]</code>. When you bind it with <code>&lt;-</code>, as in the OP, the bound symbol (<code>args</code>) gets the type <code>[String]</code>, i.e. a list of strings.</p>\n\n<p>The <code>head</code> function returns the first element in a list; it has the type <code>[a] -&gt; a</code>. It's (in)famous for being unsafe, in the sense that if you apply it to an empty list, it'll crash:</p>\n\n<pre><code>Prelude System.Environment&gt; head []\n*** Exception: Prelude.head: empty list\n</code></pre>\n\n<p>That's what's happening here. <code>getArgs</code> gives you the arguments you supplied at the command line when you ran the program. If you don't supply any arguments at the command line, then the returned list will be empty.</p>\n\n<p>The <code>getArgs</code> function isn't interactive. It'll just return the arguments supplied from the command line, if any were supplied.</p>\n"}], "owner": {"reputation": 153, "user_id": 5285349, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c6e48d86c74fd1fca638a7ca513297de?s=128&d=identicon&r=PG&f=1", "display_name": "JamalCrawford..", "link": "https://stackoverflow.com/users/5285349/jamalcrawford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3721, "favorite_count": 0, "accepted_answer_id": 49056302, "answer_count": 1, "score": 2, "last_activity_date": 1519928679, "creation_date": 1519927403, "last_edit_date": 1519928679, "question_id": 49055999, "link": "https://stackoverflow.com/questions/49055999/how-does-getargs-work", "title": "How does getArgs work?", "body": "<p>I am trying to understand <code>getArgs</code> in Haskell. Here is what I have:</p>\n\n<pre><code>import System.Environment\n\nmyFunFunction = do\n     args &lt;- getArgs\n     return $ head args\n</code></pre>\n\n<p>What I am getting when I run the function is </p>\n\n<pre><code> *Main&gt; myFunFunction\n *** Exception: Prelude.head: empty list\n</code></pre>\n\n<p>Does this not work the same way as <code>getLine</code>?  Why does it not ask for a command line argument? </p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1519927415, "post_id": 49055647, "comment_id": 85116473, "body": "Have you added the module to your <code>.cabal</code> file?"}], "answers": [{"tags": [], "owner": {"reputation": 554, "user_id": 1146898, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/413b69be81046e5a73b343424248ce73?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/1146898/ben"}, "is_accepted": true, "score": 1, "last_activity_date": 1519955974, "creation_date": 1519955974, "answer_id": 49061644, "question_id": 49055647, "link": "https://stackoverflow.com/questions/49055647/yesod-could-not-find-module-yesod-auth-account/49061644#49061644", "title": "Yesod: Could not find module `Yesod.Auth.Account&#39;", "body": "<p>That comes from the <a href=\"https://hackage.haskell.org/package/yesod-auth-account\" rel=\"nofollow noreferrer\">yesod-auth-account</a> package which <a href=\"https://www.stackage.org/lts-10.7/hoogle?q=yesod-auth-account\" rel=\"nofollow noreferrer\">doesn't seem to be on Stackage</a>. This means you must add it to the <code>extra-deps</code> stanza of your <code>stack.yaml</code> file. <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#packages-and-extra-deps\" rel=\"nofollow noreferrer\">Docs here</a>.</p>\n\n<p>Probably something like this:</p>\n\n<pre><code>extra-deps:\n- yesod-auth-account-1.4.3\n</code></pre>\n\n<p>You may also want to use the <code>stack solver</code> command.</p>\n"}], "owner": {"reputation": 73, "user_id": 9414418, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-p7jD4FCoE7c/AAAAAAAAAAI/AAAAAAAACkk/KPBQusRwRPk/photo.jpg?sz=128", "display_name": "Giulio De Stasio", "link": "https://stackoverflow.com/users/9414418/giulio-de-stasio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 49061644, "answer_count": 1, "score": 1, "last_activity_date": 1519955974, "creation_date": 1519926084, "question_id": 49055647, "link": "https://stackoverflow.com/questions/49055647/yesod-could-not-find-module-yesod-auth-account", "title": "Yesod: Could not find module `Yesod.Auth.Account&#39;", "body": "<p>I'm developing a website with scaffolded Yesod (stack) and I have to import <strong>Yesod.Auth.Account</strong> to use internals accounts instead openid or others. But when i try import this module i've this output:</p>\n\n<pre><code>/usr/home/giulio/Lavori/karmen/src/Foundation.hs:27:1: error:\n    Could not find module `Yesod.Auth.Account'\n    Use -v to see a list of the files searched for.\n   |\n27 | import Yesod.Auth.Account\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>I tried to install the module, build, use <code>stack clean</code> and <code>stack build</code> but\nnothing work.</p>\n"}, {"tags": ["haskell", "functional-programming", "gtk2hs"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1519923772, "post_id": 49054641, "comment_id": 85114514, "body": "Not familiar with gtk2hs, but can&#39;t you just pass the label you want to change as a parameter to <code>openPressed</code>, and then use <code>openPressed label</code> instead of <code>openPressed</code> for your callback?"}, {"owner": {"reputation": 438, "user_id": 6371869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mUzus.jpg?s=128&g=1", "display_name": "Shadasviar", "link": "https://stackoverflow.com/users/6371869/shadasviar"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1519924672, "post_id": 49054641, "comment_id": 85115044, "body": "@Cubic, openPressed is callback for signal, it is called by signal, not from main."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1519942652, "post_id": 49054641, "comment_id": 85124159, "body": "Right... but you&#39;re setting this to be the callback at some point. Wherever you&#39;re doing that, you can just pass <code>openPressed label</code> instead of <code>openPressed</code>."}, {"owner": {"reputation": 438, "user_id": 6371869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mUzus.jpg?s=128&g=1", "display_name": "Shadasviar", "link": "https://stackoverflow.com/users/6371869/shadasviar"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1519947023, "post_id": 49054641, "comment_id": 85125828, "body": "@Cubic, does it mean that i should initialize callback from other function, not in the global scope of file?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1519949040, "post_id": 49054641, "comment_id": 85126416, "body": "You can still write the callback in the global filescope, just add a parameter and pass it where you&#39;re setting the callback."}], "owner": {"reputation": 438, "user_id": 6371869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mUzus.jpg?s=128&g=1", "display_name": "Shadasviar", "link": "https://stackoverflow.com/users/6371869/shadasviar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1519922627, "creation_date": 1519922627, "question_id": 49054641, "link": "https://stackoverflow.com/questions/49054641/change-gtk-window-state-from-callback", "title": "Change gtk window state from callback", "body": "<p>I have a simple GTK window with menu bar which has <code>Open</code> item. It gets filename inside callback of <code>menuItemActivate</code>:</p>\n\n<pre><code>openPressed = do\n    chooser &lt;- fileChooserDialogNew\n\n...\n    filename &lt;- performResponse res chooser\n        widgetHide chooser\n        where\n            performResponse ResponseCancel _ = return (\"\")\n            performResponse ResponseOk chooser = do\n                Just fname &lt;- fileChooserGetFilename chooser\n                putStrLn fname \n                --how can i put filename in label inside MainForm from here?\n                return fname\n</code></pre>\n\n<p>How can I put filename to label located in my main window if <code>openPressed</code> is not nested in the main function which initialize main window?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1519916818, "post_id": 49052493, "comment_id": 85109692, "body": "Look at the type and definition of <code>divisibleBy</code>, and identify when it can <i>ever</i> return <code>0</code> (instead of <code>True</code> or <code>False</code>). Haskell <code>Bool</code> is just as distinct from <code>Int</code> as it is from <code>IO Char</code> or any other type."}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1519917144, "post_id": 49052493, "comment_id": 85109916, "body": "Put <code>isEven x = mod x 2 == 0</code>, erase the rest."}], "answers": [{"comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1519917000, "post_id": 49052618, "comment_id": 85109805, "body": "For <code>isEven x = flip divisibleBy 2</code>, you just need <code>isEven = ...</code> right?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1519917032, "post_id": 49052618, "comment_id": 85109834, "body": "@Code-Apprentice: correct, thanks for spotting this :)"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1519917060, "post_id": 49052618, "comment_id": 85109852, "body": "Even so, I prefer the previous version. It is clearer to read and less characters to type."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1519917156, "post_id": 49052618, "comment_id": 85109925, "body": "@Code-Apprentice: yeah. like the French say: &quot;<i>les go&#251;ts et les couleurs ne se discutent pas</i>&quot; :)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1519917180, "post_id": 49052618, "comment_id": 85109945, "body": "It actually makes more sense for <code>divisibleBy</code> to take its arguments in the other order. Then <code>divisibleBy 2</code> is, in fact, a function that tests if its argument is divisible by 2, rather than a function that tests if 2 is divisible by its argument."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1519917242, "post_id": 49052618, "comment_id": 85109988, "body": "@chepner: correct, usually Haskell uses the opposite order of arguments than with for instance objected oriented programming. Whereas in OO, one would write <code>x.foo(bar, qux)</code>, usually in Haskell it is <code>foo bar qux x</code>."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1519917298, "post_id": 49052618, "comment_id": 85110026, "body": "@chepner Alternatively, you can write <code>x `divisibleBy` 2</code> which reads better than <code>divisibleBy x 2</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1519917515, "post_id": 49052618, "comment_id": 85110193, "body": "Although using it as an infix operator is a strong argument for the original order :)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1519917572, "post_id": 49052618, "comment_id": 85110239, "body": "Moral of the story: naming things is hard."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1519975722, "last_edit_date": 1519975722, "creation_date": 1519916831, "answer_id": 49052618, "question_id": 49052493, "link": "https://stackoverflow.com/questions/49052493/no-instance-for-num-bool-arising-from-the-literal-0/49052618#49052618", "title": "No instance for (Num Bool) arising from the literal \u20180\u2019", "body": "<p>Well the error message already says this. You write:</p>\n\n<pre><code>isEven :: Int -&gt; Bool\nisEven x\n    <b>| (divisibleBy x 2) == 0 = True</b>\n    | otherwise = False</code></pre>\n\n<p>Now if we typecheck this, we see that <code>(divisibleBy x 2)</code> will return a <code>Bool</code>, and you cannot perform a <code>(==)</code> with a <code>Bool</code> and a number (a <code>Bool</code> is in Haskell <em>not</em> a number).</p>\n\n<p>Why you write this with <code>== 0</code> is not really clear for me, we can write it as:</p>\n\n<pre><code>isEven :: Int -&gt; Bool\nisEven x\n    <b>| (divisibleBy x 2) = True</b>\n    | otherwise = False</code></pre>\n\n<p>But now it is still inelegant: we do not have to check if a condition holds to return <code>True</code> and otherwise <code>False</code>, we can simply return the definition, so:</p>\n\n<pre><code>isEven :: Int -&gt; Bool\nisEven x = divisibleBy x 2</code></pre>\n\n<p>Or we can omit the <code>x</code> parameter, by using <code>flip :: (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c</code>:</p>\n\n<pre><code>isEven :: Int -&gt; Bool\nisEven = flip divisibleBy 2</code></pre>\n\n<p>The same holds for the <code>divisibleBy</code> function, we can rewrite it to:</p>\n\n<pre><code>divisibleBy :: Int -&gt; Int -&gt; Bool\ndivisibleBy x y = mod x y == 0</code></pre>\n\n<p>Or without parameters:</p>\n\n<pre><code>divisibleBy :: Int -&gt; Int -&gt; Bool\ndivisibleBy = ((0 ==) .) . mod</code></pre>\n\n<h1>Swapping the parameters of <code>divisableBy</code></h1>\n\n<p>It looks however more <em>Haskell</em> to <em>swap</em> the parameters of the function, so we can write it as:</p>\n\n<pre><code>divisibleBy :: Int -&gt; Int -&gt; Bool\ndivisibleBy x y = mod y x == 0</code></pre>\n\n<p>Since now we can define a function <code>divisibleBy 2</code>, that will check for any parameter whether that number is divisible by two.</p>\n\n<p>In that case, the <code>isEven</code> function, looks like:</p>\n\n<pre><code>isEven :: Int -&gt; Bool\nisEven = divisibleBy 2</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6919691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87969563eaea780c3e5134ecb0b8f083?s=128&d=identicon&r=PG&f=1", "display_name": "Coldog", "link": "https://stackoverflow.com/users/6919691/coldog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1094, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1519975722, "creation_date": 1519916482, "last_edit_date": 1519916641, "question_id": 49052493, "link": "https://stackoverflow.com/questions/49052493/no-instance-for-num-bool-arising-from-the-literal-0", "title": "No instance for (Num Bool) arising from the literal \u20180\u2019", "body": "<p>My code:</p>\n\n<pre><code>divisibleBy :: Int -&gt; Int -&gt; Bool\ndivisibleBy x y\n    | mod x y == 0 = True\n    | otherwise = False\n\nisEven :: Int -&gt; Bool\nisEven x\n    | (divisibleBy x 2) == 0 = True\n    | otherwise = False\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>practical1.hs:30:28: error:\n    \u2022 No instance for (Num Bool) arising from the literal \u20180\u2019\n    \u2022 In the second argument of \u2018(==)\u2019, namely \u20180\u2019\n      In the expression: (divisibleBy x 2) == 0\n      In a stmt of a pattern guard for\n                     an equation for \u2018isEven\u2019:\n        (divisibleBy x 2) == 0\n   |\n30 |     | (divisibleBy x 2) == 0 = True    |  \n</code></pre>\n\n<p>The <code>divisibleBy</code> function works, but the <code>isEven</code> one doesn't. What am I doing wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1519913734, "post_id": 49051522, "comment_id": 85107583, "body": "Your data definition is, as far as I know, not valid Haskell: types should start with uppercase, and properties/functions with lowercase. Can you please first rewrite the question, as well as explain (in natural language) what you im to solve?"}, {"owner": {"reputation": 135, "user_id": 9425001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66f9931cc1ba87e96931428c76511173?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell-newb", "link": "https://stackoverflow.com/users/9425001/haskell-newb"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1519914028, "post_id": 49051522, "comment_id": 85107773, "body": "@WillemVanOnsem Yeah ofc , first i changed the data like you said , and my question is what is the correct syntax for me to implement a function with this : st :: Ord v =&gt; Setup v -&gt; v -&gt; Status"}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 9425001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66f9931cc1ba87e96931428c76511173?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell-newb", "link": "https://stackoverflow.com/users/9425001/haskell-newb"}, "edited": false, "score": 0, "creation_date": 1519915156, "post_id": 49051740, "comment_id": 85108508, "body": "Thanks i like the idea with the <code>Maybe</code> it helped me a lot , by the way what do you suggest for  a function <code>isHere :: Ord v =&gt; Setup v -&gt; v -&gt; Bool</code> i tought about using <code>Map.member</code> but i always fail with the syntax, the function should check if the element at key has the correct status"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 135, "user_id": 9425001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66f9931cc1ba87e96931428c76511173?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell-newb", "link": "https://stackoverflow.com/users/9425001/haskell-newb"}, "edited": false, "score": 0, "creation_date": 1519915990, "post_id": 49051740, "comment_id": 85109094, "body": "@Haskell-newb try <code>Map.member e (setupMap c)</code>"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1519914138, "creation_date": 1519914138, "answer_id": 49051740, "question_id": 49051522, "link": "https://stackoverflow.com/questions/49051522/haskell-extract-element-with-the-key/49051740#49051740", "title": "Haskell extract element with the key", "body": "<p>This should work.</p>\n\n<pre><code>data Setup v = Setup {\n    setupMap   :: Map.Map v Status,\n    setupGraph :: Graph v\n}\n\nst :: Ord v =&gt; Setup v -&gt; v -&gt; Status\nst c e = setupMap c Map.! e\n</code></pre>\n\n<p>Note that <code>Map.!</code> will crash your program when the key is not present. You should return <code>Maybe Status</code> instead and use <code>Map.!?</code> which is safe.</p>\n"}], "owner": {"reputation": 135, "user_id": 9425001, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/66f9931cc1ba87e96931428c76511173?s=128&d=identicon&r=PG&f=1", "display_name": "Haskell-newb", "link": "https://stackoverflow.com/users/9425001/haskell-newb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1519914138, "creation_date": 1519913524, "last_edit_date": 1519913753, "question_id": 49051522, "link": "https://stackoverflow.com/questions/49051522/haskell-extract-element-with-the-key", "title": "Haskell extract element with the key", "body": "<p>Hi i have a little bit issue with Haskell, i'm new to the language so here is the problem , i have : </p>\n\n<pre><code>data Setup v = Setup {\n    SetupMap   :: Map.Map v Status,\n    SetupGraph :: Graph v\n}\n</code></pre>\n\n<p>and i want to implement this function :</p>\n\n<pre><code>st :: Ord v =&gt; Setup v -&gt; v -&gt; Status\n</code></pre>\n\n<p>it should return the status of the key map ,i tried a couple things but didn't compile such as :</p>\n\n<pre><code>st c e = Map.fromList(Map.keys . SetupMap c ) Map.! e\n</code></pre>\n\n<p>i'm stuck and lack of ideas . thanks</p>\n"}, {"tags": ["performance", "haskell", "optimization"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1519912921, "post_id": 49050900, "comment_id": 85107079, "body": "Which module(s) have you imported as <code>V</code>? Switching from boxed to unboxed vectors is very closely analogous to switching from <code>data State = State Double Double</code> to <code>data State = State {-# UNPACK #-} !Double {-# UNPACK #-} !Double</code>."}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1519916050, "post_id": 49050900, "comment_id": 85109147, "body": "To answer your question, <code>import qualified Data.Vector.Storable as V</code>, see <a href=\"https://github.com/masterdezign/dde/blob/48cf99a109467c2515bf2a8f5d8fdfeaf1cca1fc/dde/Numeric/DDE.hs#L71\" rel=\"nofollow noreferrer\">github.com/masterdezign/dde/blob/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1519922597, "post_id": 49053693, "comment_id": 85113779, "body": "Thank you for the elegant answer! I will definitely take it into account."}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1521575116, "post_id": 49053693, "comment_id": 85787352, "body": "It took me a while to implement this: Haskell type system appears to be quite complicated. So here is the new version <a href=\"https://github.com/masterdezign/dde/tree/dev\" rel=\"nofollow noreferrer\">github.com/masterdezign/dde/tree/dev</a>. The code is more elegant now, however there is no visible speedup. The simplest way to compare is <code>stack build &amp;&amp; time stack exec mackey-glass &gt; &#47;dev&#47;null</code>"}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1521575276, "post_id": 49053693, "comment_id": 85787441, "body": "Moreover, due to some reason the results of master and dev branch are not identical. I am curious to know why."}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1521575690, "post_id": 49053693, "comment_id": 85787645, "body": "First, the results differ slightly and then, naturally, they diverge. But not more than 1e-13. Is it a double precision rounding problem because of a different evaluation order?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1521575846, "post_id": 49053693, "comment_id": 85787730, "body": "I&#39;ll look into it; what need I execute to see the behaviour you&#39;re describing?"}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1521578439, "post_id": 49053693, "comment_id": 85789147, "body": "For comparison, <code>git checkout master &amp;&amp; stack build &amp;&amp; time stack exec mackey-glass &gt; v1</code>, <code>git checkout dev &amp;&amp; stack build &amp;&amp; time stack exec mackey-glass &gt; v2</code>. However, that minor differences are not critical. I would appreciate any advice regarding computing speed. Thanks!"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1521579322, "post_id": 49053693, "comment_id": 85789559, "body": "Yeah, those differences are definitely in the range you need always expect when doing numerical stuff with floating-point numbers. \u2014 As for performance \u2013 I get <code>real\t0m0.382s</code> with the <code>master</code> version, but only <code>real\t0m0.092s</code> with the dev version. Are you specifically unhappy with that, or do you just generally ask for ideas what might still be improvable?"}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1521579431, "post_id": 49053693, "comment_id": 85789619, "body": "On my machine, average (over 10 runs) times almost do not differ (even though there is a slight improvement). Do you use default compilation settings or some custom ghc flags? Have you tried to run several times for statistics?"}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1521579798, "post_id": 49053693, "comment_id": 85789806, "body": "I may need to use Criterion for precision, but let me find the older (faster) version, for completeness."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1521579946, "post_id": 49053693, "comment_id": 85789878, "body": "Ah, I had the terminal output on with the <code>master</code> version, that made it so slow. Frankly, even when piping to a file I&#39;m dubious that that the timing has much to say about numerical performance \u2013 you&#39;ll mostly be timing output-formatting performance. Yeah, criterion would make timings much clearer. Or, just make the test <i>much longer but with only every 100th step shown</i>, or something like that."}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1521580151, "post_id": 49053693, "comment_id": 85789979, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/167211/discussion-between-penkovsky-and-leftaroundabout\">continue this discussion in chat</a>."}, {"owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "edited": false, "score": 0, "creation_date": 1521581579, "post_id": 49053693, "comment_id": 85790627, "body": "For the reference, here is the fast version <a href=\"https://raw.githubusercontent.com/masterdezign/aivika-experiment-dde-test/master/src/MackeyGlass.lhs\" rel=\"nofollow noreferrer\">raw.githubusercontent.com/masterdezign/&hellip;</a>. To compile, <code>cabal exec ghc -- -O2 MackeyGlass.lhs</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1519920599, "last_edit_date": 1519920599, "creation_date": 1519919858, "answer_id": 49053693, "question_id": 49050900, "link": "https://stackoverflow.com/questions/49050900/how-to-optimize-the-speed-of-a-numerical-library-in-haskell/49053693#49053693", "title": "How to optimize the speed of a numerical library in Haskell", "body": "<p>I wouldn't use any particular vector implementation. Variable-length types like <code>Data.Vector</code> are a bad choice not only because the extra length information is a considerable overhead when the dimension of the space is low, also because you lose any type-system guarantee that the dimensions match.</p>\n\n<p>Instead, you should make everything <em>parametric</em> on the choice of vector space. I.e, you effectively make the dimension a compile-time variable, plus you allow vector types with some meaningfully-named subvariables.</p>\n\n<pre><code>import Data.VectorSpace\nimport Data.AdditiveGroup\n\nnewtype Stepper1 state = Stepper1 {\n  _stepper\n    ::  Double\n    -&gt; RHS state   -- parameterised in a similar way\n    -&gt; state\n    -&gt; (Double, Double)\n    -&gt; (Double, Double)\n    -&gt; state\n  }\n\nrk\u2084 :: VectorSpace v =&gt; Stepper1 v\nrk\u2084 = Stepper1 _rk4\n where _rk4 hStep rhs' y\u2080 ... = y\u2080 ^+^ (h/6)*^(k\u2081 ^+^ 2*^k\u2082 ^+^ 2*^k\u2083 ^+^ k\u2084)\n         where k\u2081 = rhs' (y\u2080, ...)\n               k\u2082 = rhs' (y\u2080 ^+^ (h/2)*^k\u2081, ...)\n               k\u2083 = rhs' (y\u2080 ^+^ (h/2)*^k\u2082, ...)\n               k\u2084 = rhs' (y\u2080 ^+^ h*^k\u2083, ...)\n</code></pre>\n\n<p>Then, what particular implementation it will be can be chosen by the user. For a 2-dimensional vector, a standard choice is <a href=\"http://hackage.haskell.org/package/linear-1.20.7/docs/Linear-V2.html\" rel=\"nofollow noreferrer\"><code>V2</code></a> from the <code>linear</code> package; it is re-exported with <code>VectorSpace</code> instances from <a href=\"http://hackage.haskell.org/package/free-vector-spaces-0.1.4.0/docs/Data-VectorSpace-Free.html\" rel=\"nofollow noreferrer\">free-vector-spaces</a>. But for testing, you could also just use plain old tuples, which have a <code>VectorSpace</code> instance right in <a href=\"http://hackage.haskell.org/package/vector-space\" rel=\"nofollow noreferrer\">vector-space</a>. Of course, wrapping around the types from <code>hmatrix</code> would also be possible, but this would really not be good for performance \u2013 better just convert the final results, if necessary.</p>\n\n<p>To get the best performance, you may need to use some <code>{-# INLINE #-}</code> pragmas. Bang patterns OTOH don't usually bring much performance advantage \u2013 most important is that the <em>types</em> are strict, and unboxed. It's certainly no use to pre-emptively put a bang before every variable definition \u2013 those won't have any effect anyway, because a CAF is only evaluated when it's used.</p>\n\n<p>I would be excited to hear about the performance you get in the end! If it's notably worse than your original <code>State {-# UNPACK #-} !Double {-# UNPACK #-} !Double</code>, that's something we should investigate.</p>\n"}], "owner": {"reputation": 724, "user_id": 558254, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/80a95b8f45a1ecf04e61017cc1c597ea?s=128&d=identicon&r=PG&f=1", "display_name": "penkovsky", "link": "https://stackoverflow.com/users/558254/penkovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 3, "accepted_answer_id": 49053693, "answer_count": 1, "score": 3, "last_activity_date": 1519920599, "creation_date": 1519911471, "question_id": 49050900, "link": "https://stackoverflow.com/questions/49050900/how-to-optimize-the-speed-of-a-numerical-library-in-haskell", "title": "How to optimize the speed of a numerical library in Haskell", "body": "<p>I have released a small numerical library for solving delay differential equations: <a href=\"http://github.com/masterdezign/dde\" rel=\"nofollow noreferrer\">http://github.com/masterdezign/dde</a></p>\n\n<p>The main technical constraints:</p>\n\n<ol>\n<li>Make the library flexible with respect to the number of dynamical variables (x(t), y(t),...), i.e. a <code>State</code> of the dynamical system for a given moment of time.</li>\n<li>Easily integrate with libraries that exploit Data.Vector.Storable (e.g.  <code>hmatrix</code>). Therefore, as input/output I extensively employ Data.Vector.Storable.</li>\n</ol>\n\n<p>As a result, unlike in this solution:\n<a href=\"https://stackoverflow.com/questions/33596474/how-do-i-optimize-numerical-integration-performance-in-haskell-with-example\">How do I optimize numerical integration performance in Haskell (with example)</a>,\n <code>newtype State = State { _state :: V.Vector Double }</code> is used\ninstead of <code>data State = State {-# UNPACK #-} !Double {-# UNPACK #-} !Double</code>. However, the library runs twice slower now.</p>\n\n<p>The question: is there any way to bring both the speed of <code>data State = State {-# UNPACK #-}...</code> and the flexibility of <code>newtype State = State { _state :: V.Vector Double }</code> for unspecified number of variables? Shall I consider Template Haskell to create <code>data UNPACK</code>-like structures during the compilation time?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 5, "creation_date": 1519910757, "post_id": 49050558, "comment_id": 85105699, "body": "You want a <a href=\"https://hackage.haskell.org/package/mono-traversable-1.0.8.1/docs/Data-MonoTraversable.html#t:MonoFunctor\" rel=\"nofollow noreferrer\">different</a> class"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1519911089, "post_id": 49050558, "comment_id": 85105901, "body": "Often (albeit not always) the wrapping/unwrapping can be suppressed using <a href=\"https://www.stackage.org/haddock/lts-10.7/base-4.10.1.0/Data-Coerce.html\" rel=\"nofollow noreferrer\">safe coercions</a>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1519911550, "post_id": 49050558, "comment_id": 85106175, "body": "It does not make sense to do that: a functor is a higher order type."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1519911968, "post_id": 49050558, "comment_id": 85106446, "body": "A third option is <a href=\"https://hackage.haskell.org/package/lens-4.16/docs/Control-Lens-Setter.html#v:over\" rel=\"nofollow noreferrer\"><code>over</code></a> from <i>lens</i> (or similar packages): given a lens for your field called <code>unWidth</code>, <code>over unWidth</code> does what you want (i.e. it lets you work with a monomorphic functor)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1519911979, "post_id": 49050558, "comment_id": 85106457, "body": "The problem is not with newtype. Say <code>data Width</code> or <code>newtype Box a</code> and nothing changes (except laziness which is not important here)."}, {"owner": {"reputation": 2375, "user_id": 101186, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8a21b168169dd51660caa58f3c8925ce?s=128&d=identicon&r=PG", "display_name": "Bobby Eickhoff", "link": "https://stackoverflow.com/users/101186/bobby-eickhoff"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1519913659, "post_id": 49050558, "comment_id": 85107532, "body": "@n.m.  Understood.  I tried to title this question to match future searches.  I don&#39;t anticipate any new Haskell users searching for &quot;how to write a functor for a monomorphic container&quot;.  Any suggestions on how to amend the title or content for both (1) accuracy, and (2) searchability?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1519914365, "post_id": 49050558, "comment_id": 85108012, "body": "&quot;Functor-like instance for simple type&quot; might work."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 10, "last_activity_date": 1519975872, "last_edit_date": 1519975872, "creation_date": 1519917852, "answer_id": 49052977, "question_id": 49050558, "link": "https://stackoverflow.com/questions/49050558/haskell-functor-instance-for-newtype/49052977#49052977", "title": "Haskell: Functor instance for newtype", "body": "<p>First note that <code>newtype</code> is no hurdle here \u2013 you can parameterise these just as well as <code>data</code>, and then you have an ordinary functor. Like</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\nnewtype WidthF a = Width  { unWidth  :: a } deriving (Show, Functor)\ntype Width = WidthF Int\n</code></pre>\n\n<p>I wouldn't consider that a good idea, though. <code>Width</code> <em>shouldn't be</em> a functor; it doesn't make sense to store non-number types in it.</p>\n\n<p>One option as user2407038 suggests is to make it a \u201cmonomorphic functor\u201d</p>\n\n<pre><code>import Data.MonoTraversable (MonoFunctor(..))\n\nnewtype Width = Width  { unWidth  :: Int } deriving (Show)\n\ninstance MonoFunctor Width where\n  omap f (Width w) = Width $ f w\n</code></pre>\n\n<p>That too doesn't seem sensible to me \u2013 if you map number operations thus in <em>one generic way</em>, then you might just as well give <code>Width</code> instances for <code>Num</code> etc. and use these directly. But then you hardly have better type-system guarantees than a simple</p>\n\n<pre><code>type Width = Int\n</code></pre>\n\n<p>which can easily be modified <em>without any help</em>, the flip side being that it can easily be mishandled without any type system safeguards.</p>\n\n<p>Instead, I think what you want is probably this:</p>\n\n<pre><code>import Control.Lens\n\ndata Box = Box {\n   width, height :: Int }\n\nwidthInPx, heightInPx :: Lens' Box Int\nwidthInPx f (Box w h) = (`Box`h) &lt;$&gt; f w\nheightInPx f (Box w h) = (Box w) &lt;$&gt; f h\n</code></pre>\n\n<p>Then you can do</p>\n\n<pre><code>&gt; Box 3 4 &amp; widthInPx %~ (*2)\nBox 6 4\n&gt; Box 4 2 &amp; heightInPx %~ succ\nBox 4 3\n</code></pre>\n"}], "owner": {"reputation": 2375, "user_id": 101186, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8a21b168169dd51660caa58f3c8925ce?s=128&d=identicon&r=PG", "display_name": "Bobby Eickhoff", "link": "https://stackoverflow.com/users/101186/bobby-eickhoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1555944105, "creation_date": 1519910272, "last_edit_date": 1555944105, "question_id": 49050558, "link": "https://stackoverflow.com/questions/49050558/haskell-functor-instance-for-newtype", "title": "Haskell: Functor instance for newtype", "body": "<p>To level set, here's a simple functor:</p>\n\n<pre><code>data Box a = Box a deriving (Show)\n\ninstance Functor Box where\n  fmap f (Box x) = Box (f x)\n</code></pre>\n\n<p>This allows us to operate \"inside the box\":</p>\n\n<pre><code>&gt; fmap succ (Box 1)\nBox 2\n</code></pre>\n\n<p><em>How do I achieve this same syntactic convenience with a newtype?</em>  Let's say I have the following:</p>\n\n<pre><code>newtype Width  = Width  { unWidth  :: Int } deriving (Show)\nnewtype Height = Height { unHeight :: Int } deriving (Show)\n</code></pre>\n\n<p>This is a bit clunky:</p>\n\n<pre><code>&gt; Width $ succ $ unWidth (Width 100)\nWidth {unWidth = 101}\n</code></pre>\n\n<p>This would be nice:</p>\n\n<pre><code>&gt; fmap succ (Width 100)   -- impossible?\nWidth {unWidth = 101}\n</code></pre>\n\n<p>Of course, I can't make Width or Height an instance of a Functor since neither has kind <code>* -&gt; *</code>.  Although, syntactically they <em>feel</em> no different than Box, and so it seems like it should be possible to operate on the underlying value without all of the manual wrapping and unwrapping.</p>\n\n<p>Also, it isn't satisfying to create n functions like this because of the repetition with every new newtype:</p>\n\n<pre><code>fmapWidth  :: (Int -&gt; Int) -&gt; Width  -&gt; Width\nfmapHeight :: (Int -&gt; Int) -&gt; Height -&gt; Height\n</code></pre>\n\n<p>How do I lift a function on Ints to be a function on Widths?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1519898187, "post_id": 49045898, "comment_id": 85098466, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/15330899/listing-the-paths-to-leaves-in-a-tree\">Listing the paths to leaves in a tree</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1519903439, "post_id": 49045898, "comment_id": 85101399, "body": "Your <code>Node a (x:xs)</code> clause doesn&#39;t use <code>a</code>. You probably also want <code>[[]]</code> as your base case in the other clause... or perhaps <code>[[a]]</code> with <code>a</code> the value of the <code>Node</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3969, "user_id": 187261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/994de0373c6a35a5f7108b274d0b1cb9?s=128&d=identicon&r=PG", "display_name": "Nazarii Bardiuk", "link": "https://stackoverflow.com/users/187261/nazarii-bardiuk"}, "is_accepted": true, "score": 0, "last_activity_date": 1519916498, "creation_date": 1519916498, "answer_id": 49052504, "question_id": 49045898, "link": "https://stackoverflow.com/questions/49045898/need-help-folding-a-tree/49052504#49052504", "title": "Need help folding a tree", "body": "<p>In base case you need to return node value</p>\n\n<p>In recursive case - prepend node value to each of children paths</p>\n\n<pre><code>getAllPaths :: Unigraph a -&gt; [[a]]\ngetAllPaths (Node a []) = [[a]]\ngetAllPaths (Node a children) = map (a:) (concatMap getAllPaths children)\n</code></pre>\n"}], "owner": {"reputation": 11693, "user_id": 858962, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/5f16ec0395b1710fd529b01602de66ca?s=128&d=identicon&r=PG", "display_name": "dopatraman", "link": "https://stackoverflow.com/users/858962/dopatraman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 1, "accepted_answer_id": 49052504, "answer_count": 1, "score": 0, "last_activity_date": 1519916498, "creation_date": 1519894332, "question_id": 49045898, "link": "https://stackoverflow.com/questions/49045898/need-help-folding-a-tree", "title": "Need help folding a tree", "body": "<p>I'm trying to walk a tree and turn each path into a list. Here is my structure. I've called it <code>Unigraph</code> because its a unidirectional graph. Apologies if I'm using incorrect terminology.</p>\n\n<pre><code>data Unigraph a = Node a [Unigraph a] deriving (Show)\n</code></pre>\n\n<p>Basically, I'm trying to describe a structure like this:</p>\n\n<pre><code>       1\n     / | \\\n    2  3  4\n   / \\  \\\n  3   4  4\n</code></pre>\n\n<p>I have the following function:</p>\n\n<pre><code>comboGraph :: [a] -&gt; Int -&gt; [Unigraph a]\ncomboGraph _ 0 = []\ncomboGraph [] _ = []\ncomboGraph (x:xs) n =\n    buildEdge x xs : (comboGraph xs n)\n    where   buildEdge h t = Node h (comboGraph t (n-1))\n</code></pre>\n\n<p>for a given list and integer <code>n</code>, I can create a <code>Unigraph</code> with <code>n</code> depths.</p>\n\n<p>So the above graph can be created by running</p>\n\n<pre><code>let ug = head $ comboGraph [1..4] 3\n</code></pre>\n\n<p>Here's the problem I'm trying to solve. I want to convert a given <code>Unigraph</code> into a list of paths, i.e. <code>[[1,2,3], [1,2,4], [1,3,4], [1,4]]</code>. </p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>getAllPaths :: Unigraph a -&gt; [[a]]\ngetAllPaths (Node _ []) = []\ngetAllPaths (Node a (x:xs)) =\n    getAllPaths x ++ getAllPaths' xs\n    where   getAllPaths' (y:ys) = getAllPaths y ++ getAllPaths' ys\n            getAllPaths' [] = []\n</code></pre>\n\n<p>but this function does not account for the value of the node anywhere! I'm getting stuck here. How do I do this?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1519910523, "post_id": 49046057, "comment_id": 85105544, "body": "You&#39;re missing a <code>-&gt;</code> in the type for <code>fmap</code>."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1519911015, "post_id": 49046057, "comment_id": 85105859, "body": "@ArtemPelenitsyn - Thanks, fixed."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 3, "last_activity_date": 1519910985, "last_edit_date": 1519910985, "creation_date": 1519894845, "answer_id": 49046057, "question_id": 49045880, "link": "https://stackoverflow.com/questions/49045880/splitting-a-line-read-from-input-with-and-without-fmap-in-haskell/49046057#49046057", "title": "Splitting a line read from input with and without fmap in haskell", "body": "<p><code>getLine</code> returns an <code>IO String</code>, so <code>words getLine</code> is a type error. <code>fmap</code> has type</p>\n\n<pre><code>Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>and <code>IO</code> has a functor instance so <code>fmap</code> for <code>IO</code> has type <code>(a -&gt; b) -&gt; IO a -&gt; IO b</code>. <code>fmap words</code> therefore has type <code>IO String -&gt; IO [String]</code>, and applying this to the result of <code>getLine</code> results in an <code>IO [String]</code>.</p>\n\n<p>In ghci, <code>IO</code> actions are executed an their results printed, which is why you see the result list displayed.</p>\n"}], "owner": {"reputation": 377, "user_id": 8140404, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f1c26015079511b622e275f01e7e105a?s=128&d=identicon&r=PG&f=1", "display_name": "plx", "link": "https://stackoverflow.com/users/8140404/plx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 1, "accepted_answer_id": 49046057, "answer_count": 1, "score": 0, "last_activity_date": 1519910985, "creation_date": 1519894299, "question_id": 49045880, "link": "https://stackoverflow.com/questions/49045880/splitting-a-line-read-from-input-with-and-without-fmap-in-haskell", "title": "Splitting a line read from input with and without fmap in haskell", "body": "<p>I found out that <code>words</code> is the appropriate function to split a <code>String</code>:</p>\n\n<p><code>words :: String -&gt; [String]</code></p>\n\n<p>What's special about <code>fmap</code> that makes this code work:</p>\n\n<pre><code>Prelude&gt; fmap words getLine\nabc def ghi\n[\"abc\",\"def\",\"ghi\"]\n</code></pre>\n\n<p>and it's omission results in a error:</p>\n\n<pre><code>Prelude&gt; words getLine\n\n&lt;interactive&gt;:10:7: error:\n    \u2022 Couldn't match type \u2018IO String\u2019 with \u2018[Char]\u2019\n      Expected type: String\n        Actual type: IO String\n    \u2022 In the first argument of \u2018words\u2019, namely \u2018getLine\u2019\n      In the expression: words getLine\n      In an equation for \u2018it\u2019: it = words getLine \n</code></pre>\n\n<p>I know that <code>fmap</code> works with <code>Functors</code> but I don't know about <code>Functors</code> yet. Is it related to that?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 8, "last_activity_date": 1519889188, "creation_date": 1519889188, "answer_id": 49044619, "question_id": 49044362, "link": "https://stackoverflow.com/questions/49044362/haskell-strict-fields/49044619#49044619", "title": "Haskell Strict fields", "body": "<p>Because <code>let</code> itself defines a lazy binding -- <code>let</code> never evaluates anything by itself (unless <code>BangPatterns</code> are used).</p>\n\n<pre><code>ghci&gt; let x = undefined\nghci&gt; x\n*** Exception: Prelude.undefined\n</code></pre>\n\n<p>You can tell the difference between the strict and lazy constructors like so:</p>\n\n<pre><code>ghci&gt; T undefined `seq` ()\n()\nghci&gt; X undefined `seq` ()\n*** Exception: Prelude.undefined\n</code></pre>\n"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 49044619, "answer_count": 1, "score": 4, "last_activity_date": 1519889188, "creation_date": 1519888198, "question_id": 49044362, "link": "https://stackoverflow.com/questions/49044362/haskell-strict-fields", "title": "Haskell Strict fields", "body": "<p>When defining a lazy field, there is no exception, until you print it.</p>\n\n<pre><code>&gt; data T = T Int deriving (Show)\n&gt; let t = T undefined\n&gt; t\nT *** Exception: Prelude.undefined\nCallStack (from HasCallStack):\n  error, called at libraries/base/GHC/Err.hs:79:14 in base:GHC.Err\n  undefined, called at &lt;interactive&gt;:3:7 in interactive:Ghci3\n</code></pre>\n\n<p>With strict field (<code>!Int</code>), I thought <code>undefined</code> would be evaluated right away, which will cause exception, but actually, it's still no evaluated until you print it. Why is that?</p>\n\n<pre><code>&gt; data X = X !Int deriving (Show)\n&gt; let x = X undefined\n&gt; x\n*** Exception: Prelude.undefined\nCallStack (from HasCallStack):\n  error, called at libraries/base/GHC/Err.hs:79:14 in base:GHC.Err\n  undefined, called at &lt;interactive&gt;:6:11 in interactive:Ghci5\n</code></pre>\n"}]