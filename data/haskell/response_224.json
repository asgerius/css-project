[{"tags": ["haskell", "machine-learning", "neural-network", "boolean-logic", "perceptron"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "edited": false, "score": 0, "creation_date": 1556227810, "post_id": 55852441, "comment_id": 98377010, "body": "Suppose I want to replicate the And and Or for data on Boolean valued inputs. the geometric picture remains the same. (w1 = w2 = 1/2, and the intercept is 1/2 its original value). However, the data has been both scaled (by 1/2) and translated (by (1/2,1/2)) and we now learn the wrong function. (<a href=\"http://www.cs.cmu.edu/~tom/10601_fall2012/hw/hw3_solutions.pdf\" rel=\"nofollow noreferrer\">cs.cmu.edu/~tom/10601_fall2012/hw/hw3_solutions.pdf</a>)<code>andData = map (1:) [[x,y] | x &lt;- [0,1], y &lt;- [0,1]]  </code>andData = map (1:) [[x,y] | x &lt;- [0,1], y &lt;- [0,1]] <code>andOuts = [0,0,0,1] </code>orOuts = [0,1,1,1] <code>oor = map (dotProd [-0.5,1,1]) andData </code>aand = map (dotProd [-1.5,1,1]) andData"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1556204807, "creation_date": 1556204807, "answer_id": 55852441, "question_id": 55838580, "link": "https://stackoverflow.com/questions/55838580/how-do-you-properly-implement-and-verify-a-perceptron-gradient-descent-to-lear/55852441#55852441", "title": "How do you properly implement and verify a perceptron &amp; gradient descent to learn basic Boolean functions in Haskell?", "body": "<p>I suspect there's a typo in the book: the threshold for OR should be 0.3, not -0.3. After I make that change, I verify that the perceptrons are correct this way:</p>\n\n<pre><code>&gt; map signum aand == andOuts\nTrue\n&gt; map signum oor == orOuts\nTrue\n&gt; map signum ans1 == andOuts\nTrue\n&gt; map signum ans2 == orOuts\nTrue\n</code></pre>\n\n<p>The first two verify that the fixed version of the book's weights are suitable; the latter two verify that the weights you learned by gradient descent are suitable.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 129, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1556227578, "creation_date": 1556140125, "last_edit_date": 1556227578, "question_id": 55838580, "link": "https://stackoverflow.com/questions/55838580/how-do-you-properly-implement-and-verify-a-perceptron-gradient-descent-to-lear", "title": "How do you properly implement and verify a perceptron &amp; gradient descent to learn basic Boolean functions in Haskell?", "body": "<p>I'm trying to construct a perceptron unit in Haskell to learn the Boolean And and Or functions, as in Mitchell's book. </p>\n\n<p>I'm pretty sure my gradient descent is correct, but I'm struggling to verify whether it actually learns the alrogithm.  I have three questions, posted in between the code below.</p>\n\n<p>(i) Is my implementation of gradient descent correct?</p>\n\n<p>(ii) If so, is it learing the \"best\" weights?  </p>\n\n<p>(iii) How do you verify the weights are learned correctly.  oor and aand are values when you plug in the boolean pairs into the weights given in the book, but I thought the sgn threshold would apply to these values?  If this was the correct evaluation hypothesis, then Mitchells solution guesses the same and and or function.  Are my learned <em>and</em> and  <em>or</em> functions (evaluated in ans1, ans2) are incorrect?</p>\n\n<pre><code>import System.Random\n\n-- for generating random initial weights\nrandomList :: Int -&gt; [Double]\nrandomList seed = randoms (mkStdGen seed) :: [Double]\n\ndotProd x y = foldr (+) 0 $ zipWith (*) x y\n\ngdHelper [] _ del_w _ _ = del_w\ngdHelper (x:xs) (t:ts) y@(weight:weights) w nu = gdHelper xs ts del_w w nu\n  where del_w = zipWith (+) y (map (*asdf) x)\n        asdf = nu * (t - o) \n        o = dotProd w x\n\ngd _  _  _  w _  0 = w\ngd xs ts ws w nu n = gd xs ts [0,0,0] w2 nu (n-1)\n  where w2 = zipWith (+) w delW\n        delW = gdHelper xs ts ws w nu\n\n-- initial weights\nw = map (/20) $ take 3 $ randomList 30\n\ntrainingData = [([1,1],1),([1,-1],-1),([-1,1],-1),([-1,-1],-1)]\nandData = map (1:) (map fst trainingData) \nandOuts = map snd trainingData\norOuts = [1,1,1,-1]\n\ngdand = gd andData andOuts [0,0,0] w 0.02 10000\ngdor = gd andData orOuts [0,0,0] w 0.01 10000\n\nans1 = map (dotProd gdand) andData \nans2 = map (dotProd gdor) andData \n\n-- trying to verify this from the book\naand = map (dotProd [-0.8,0.5,0.5]) andData \noor = map (dotProd [-0.3,0.5,0.5]) andData \n</code></pre>\n\n<p>From Mitchell:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pN2l0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pN2l0.png\" alt=\"[1]: https://i.stack.imgur.com/XVRAn.png\"></a></p>\n\n<p>Edit: \nFollowing up, suppose I want to replicate the new Boolean and and Or for data on Boolean valued inputs.  Replace the following code, and the geometric picture remains the same. (w1 = w2 = 1/2, and the intercept is 1/2 its original value).  However, because the data has been both scaled (by 1/2) and translated (by (1/2,1/2)) and my algorithm now learns the wrong function.  `andData = map (1:) [[x,y] | x &lt;- [0,1], y &lt;- [0,1]]</p>\n\n<pre><code>andData = map (1:) [[x,y] | x &lt;- [0,1], y &lt;- [0,1]]\nandOuts = [0,0,0,1]\norOuts = [0,1,1,1]\noor = map (dotProd [-0.5,1,1]) andData\naand = map (dotProd [-1.5,1,1]) andData\n</code></pre>\n"}, {"tags": ["haskell", "tuples", "variable-assignment", "record"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1556137628, "creation_date": 1556137628, "answer_id": 55838063, "question_id": 55837998, "link": "https://stackoverflow.com/questions/55837998/how-to-modify-just-one-field-of-a-record-without-rewriting-it-completely/55838063#55838063", "title": "How to modify just one field of a record without rewriting it completely?", "body": "<p>You can write such update as:</p>\n\n<pre><code>oldrecord { somefield = newvalue }\n</code></pre>\n\n<p>so in your case, you can write it like:</p>\n\n<pre><code>let incrementCounter cs@(CurrentState{bar=<b>b</b>}) = <b>cs {bar = b+1}</b></code></pre>\n\n<p>You can also make use of <a href=\"http://hackage.haskell.org/package/lens\" rel=\"noreferrer\"><em><code>lens</code></em></a> for more advanced updates.</p>\n"}], "owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1556138914, "accepted_answer_id": 55838063, "answer_count": 1, "score": 2, "last_activity_date": 1556139550, "creation_date": 1556137376, "question_id": 55837998, "link": "https://stackoverflow.com/questions/55837998/how-to-modify-just-one-field-of-a-record-without-rewriting-it-completely", "closed_reason": "Duplicate", "title": "How to modify just one field of a record without rewriting it completely?", "body": "<p>It's the second time I'm tackling this problem... <sub>And for the second time this is while working with the <code>State</code> monad, apparently a state likes to consist of many fields, not just one</sub></p>\n\n<p>I have a tuple:</p>\n\n<pre><code>type CurrentState = (Int, Int, String, [Int], CustType1, CustType2, CustType3 )\n</code></pre>\n\n<p>Assume a simple transformation of this tuple is needed... The second <code>Int</code> is a sort of counter, it needs to be incremented:</p>\n\n<pre><code>let incrementCounter currState@(foo, bar, baz, fizz, buzz, blah, yadda) =\n    ( foo, bar+1, baz, fizz, buzz, blah, yadda )\n</code></pre>\n\n<p>Wow. Lots of typing. Now since incrementing the counter is not the only possible operation of this tuple, then clearly there will be many more functions of this kind... The clutter soon becomes annoying.</p>\n\n<p>And what if we change the tuple to a record?</p>\n\n<pre><code>data CurrentState = CurrentState { foo :: Int, bar :: Int, baz :: String,\n                                   fizz :: [Int], buzz :: CustType1,\n                                   blah :: CustType2, yadda :: CustType 3 }\n</code></pre>\n\n<p>Incrementing the counter is now even worse!</p>\n\n<pre><code>let incrementCounter currState =\n    CurrentState { foo = foo currState, bar = (bar currState) + 1,\n                   baz = baz currState, fizz = fizz currState,\n                   buzz = buzz currState, blah = blah currState,\n                   yadda = yadda currState }\n</code></pre>\n\n<p>This is kind of amazing. All I want to do is what I'd write in an imperative language as <code>currState.bar += 1;</code>. What is the typical Haskell solution for this kind of problems? Is there any way that would allow me to not rewrite all fields that don't change?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1556128405, "post_id": 55835635, "comment_id": 98336222, "body": "Just add another branch to <code>value</code> that handles the <code>If</code> case. Did you encounter any specific problems with that? Also, why did you duplicate the code between <code>num</code> and <code>value</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1556128587, "post_id": 55835635, "comment_id": 98336287, "body": "It&#39;s technically two sections of code. What is the syntax for incorporating the <code>If</code> statement? My confusion is on the actual syntax. I&#39;m unsure how to include an <code>If</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1556128592, "post_id": 55835635, "comment_id": 98336291, "body": "Did you implement @melpomene&#39;s excellent <a href=\"https://stackoverflow.com/a/55820564/8475054\">answer</a> to your similar question yesterday? If you&#39;ve done that, handling the <code>If</code> case as well should be almost trivial."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1556129401, "post_id": 55835635, "comment_id": 98336631, "body": "They did an awesome job. My confusion was in how to treat cases of <code>If</code> which I thought had to be handled differently but I was way overthinking it."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1556128566, "creation_date": 1556128566, "answer_id": 55835943, "question_id": 55835635, "link": "https://stackoverflow.com/questions/55835635/evaluating-nested-boolean-data-type/55835943#55835943", "title": "Evaluating nested boolean data type", "body": "<p>You can proceed with your approach, adding a suitable equation:</p>\n\n<pre><code>value (If cond e1 e2) = ifHelper (eval cond) (value e1) (value e2)\n</code></pre>\n\n<p>Then, you need to define your helper:</p>\n\n<pre><code>ifHelper :: Bool -&gt; Maybe Int -&gt; Maybe Int -&gt; Maybe Int\nifHelper True  m1 m2 = ...\nifHelper False m1 m2 = ...\n</code></pre>\n\n<p>By the way, it is usually recommended to define the type of any function before starting to write the function itself. This helps both the programmer (who can reason about what type are the arguments) and the compiler (which can produce better error messages if something goes wrong).</p>\n\n<p>Turning on warnings with the <code>-Wall</code> flag is also a good idea, since warnings can spot several potential errors.</p>\n"}, {"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1556139795, "post_id": 55835996, "comment_id": 98341007, "body": "I think it&#39;s a bit nicer to extract out the repeated <code>num</code> call: <code>num (If b x y) = num $ if eval b then x else y</code>"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 2, "last_activity_date": 1556128719, "creation_date": 1556128719, "answer_id": 55835996, "question_id": 55835635, "link": "https://stackoverflow.com/questions/55835635/evaluating-nested-boolean-data-type/55835996#55835996", "title": "Evaluating nested boolean data type", "body": "<p>The evaluator functions currently have incomplete pattern matches:</p>\n\n<pre><code>*Q55835635&gt; :l 55835635.hs\n[1 of 1] Compiling Q55835635        ( 55835635.hs, interpreted )\n\n55835635.hs:22:1: warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for `num': Patterns not matched: (If _ _ _)\n   |\n22 | num (Val n)          = n\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^...\nOk, one module loaded.\n</code></pre>\n\n<p>Just add the missing pattern to <code>num</code>:</p>\n\n<pre><code>num :: Expr -&gt; Int\nnum (Val n)          = n\nnum (Add e1 e2)      = num e1 + num e2\nnum (Sub e1 e2)      = num e1 - num e2\nnum (Mul e1 e2)      = num e1 * num e2\nnum (Div e1 e2)      = num e1 `div` num e2\nnum (If b e1 e2)     = if (eval b) then num e1 else num e2\n</code></pre>\n\n<p>You can now evaluate expressions, including those with <code>If</code> expressions:</p>\n\n<pre><code>*Q55835635&gt; num $ Add (Val 40) (If (Lit True) (Val 2) (Val 0))\n42\n</code></pre>\n\n<p>The rest of the functions aren't necessary.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 55835996, "answer_count": 2, "score": 1, "last_activity_date": 1556129339, "creation_date": 1556127216, "last_edit_date": 1556129339, "question_id": 55835635, "link": "https://stackoverflow.com/questions/55835635/evaluating-nested-boolean-data-type", "title": "Evaluating nested boolean data type", "body": "<p>The <code>If</code> data constructor (<code>If BoolType Expr Expr</code>) should evaluate the Boolean expression (first argument) and return the value of the second argument if it is true or return the third argument. I can construct an evaluation of the expression <code>Expr</code> but I don't understand how to incorporate the nested expression <code>BoolType</code> in order to evaluate an expression. A bit too twisty, I can't get my head around it.</p>\n\n<p>Here's two data types:</p>\n\n<pre><code>data Expr = Val Int\n          | Add Expr Expr\n          | Sub Expr Expr\n          | Mul Expr Expr\n          | Div Expr Expr\n          | If BoolType Expr Expr\n\ndata BoolType = Lit Bool\n          | Or BoolType BoolType\n          | EqualTo Expr Expr\n          | LessThan Expr Expr\n</code></pre>\n\n<p>I wrote an expression that evaluates the type:</p>\n\n<pre><code>eval :: BoolType -&gt; Bool\neval (Lit n)      = n\neval (Or e1 e2)       = eval e1 || eval e2\neval (EqualTo e1 e2)  = num e1 == num e2\neval (LessThan e1 e2) = num e1 &lt; num e2\n\nnum :: Expr -&gt; Int\nnum (Val n)          = n\nnum (Add e1 e2)      = num e1 + num e2\nnum (Sub e1 e2)      = num e1 - num e2\nnum (Mul e1 e2)      = num e1 * num e2\nnum (Div e1 e2)      = num e1 `div` num e2\n</code></pre>\n\n<p>It should evaluate out to any normal equation but how do I even incorporate an <code>If</code> boolean data type into the total equation?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1556125074, "post_id": 55835048, "comment_id": 98334699, "body": "Haskell is white-space sensitive, but your code does not look properly indented. The three lines under <code>rndFib</code> and the four lines under <code>printOneRndInt</code> should be indented. This could be contributing to your problem."}, {"owner": {"reputation": 137, "user_id": 10185954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rAd5FZ0AJ9E/AAAAAAAAAAI/AAAAAAAAC1M/TFmP3mGWV9s/photo.jpg?sz=128", "display_name": "Stephan Pillhofer", "link": "https://stackoverflow.com/users/10185954/stephan-pillhofer"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1556125207, "post_id": 55835048, "comment_id": 98334765, "body": "@crockeea thx, they are properly indented, I messed up when pasting it in Stackoverflow. So this is sadly not the problem. Fixed it now"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 10185954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rAd5FZ0AJ9E/AAAAAAAAAAI/AAAAAAAAC1M/TFmP3mGWV9s/photo.jpg?sz=128", "display_name": "Stephan Pillhofer", "link": "https://stackoverflow.com/users/10185954/stephan-pillhofer"}, "edited": false, "score": 0, "creation_date": 1556125478, "post_id": 55835184, "comment_id": 98334894, "body": "Ah, I understand. Makes totally sense. Sadly I get the following error now:  <code>Couldn&#39;t match type \u2018IO\u2019 with \u2018[]\u2019       Expected type: [()]         Actual type: IO ()</code>"}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 2, "creation_date": 1556125935, "post_id": 55835184, "comment_id": 98335075, "body": "<code>map printOneRndInt fibNumbers</code> has type <code>[IO ()]</code>, so you&#39;ll need to <code>sequence</code> it to pull out the IO."}, {"owner": {"reputation": 137, "user_id": 10185954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rAd5FZ0AJ9E/AAAAAAAAAAI/AAAAAAAAC1M/TFmP3mGWV9s/photo.jpg?sz=128", "display_name": "Stephan Pillhofer", "link": "https://stackoverflow.com/users/10185954/stephan-pillhofer"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1556126032, "post_id": 55835184, "comment_id": 98335111, "body": "@crockeea thx, worked. I need to check out what sequence does."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1556126098, "post_id": 55835184, "comment_id": 98335138, "body": "Thanks @crockeea, you got there before I could :)"}, {"owner": {"reputation": 137, "user_id": 10185954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rAd5FZ0AJ9E/AAAAAAAAAAI/AAAAAAAAC1M/TFmP3mGWV9s/photo.jpg?sz=128", "display_name": "Stephan Pillhofer", "link": "https://stackoverflow.com/users/10185954/stephan-pillhofer"}, "edited": false, "score": 0, "creation_date": 1556126520, "post_id": 55835184, "comment_id": 98335326, "body": "@RobinZigmond Do you mind giving me a simple explenation what sequence does? Or do you have a link where it is explained? I&#39;m still a bit confused. ^^"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 137, "user_id": 10185954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rAd5FZ0AJ9E/AAAAAAAAAAI/AAAAAAAAC1M/TFmP3mGWV9s/photo.jpg?sz=128", "display_name": "Stephan Pillhofer", "link": "https://stackoverflow.com/users/10185954/stephan-pillhofer"}, "edited": false, "score": 1, "creation_date": 1556126616, "post_id": 55835184, "comment_id": 98335367, "body": "@StephanPillhofer while it actually has a more general type, in this context it takes a list of IO actions and makes a single action which runs each action in the list in turn. (And has a result consisting of a list of the individual results. Since your results here are all the &quot;boring&quot; <code>()</code>, that isn&#39;t relevant here.)"}, {"owner": {"reputation": 137, "user_id": 10185954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rAd5FZ0AJ9E/AAAAAAAAAAI/AAAAAAAAC1M/TFmP3mGWV9s/photo.jpg?sz=128", "display_name": "Stephan Pillhofer", "link": "https://stackoverflow.com/users/10185954/stephan-pillhofer"}, "edited": false, "score": 0, "creation_date": 1556126725, "post_id": 55835184, "comment_id": 98335424, "body": "@RobinZigmond Thx. Helped a lot :)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1556128034, "post_id": 55835184, "comment_id": 98336049, "body": "Just to correct my comment above, it&#39;s not true that <code>sequence . map</code> is the same as <code>mapM</code>. I expressed the relationship incorrectly. What I meant was that, for any <code>f</code> of type <code>a -&gt; IO b</code>, <code>sequence . (map f)</code>  is the same as <code>mapM f</code>. (The two statements look similar but actually mean different things.)"}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 2, "last_activity_date": 1556125327, "creation_date": 1556125327, "answer_id": 55835184, "question_id": 55835048, "link": "https://stackoverflow.com/questions/55835048/putstrln-etc-not-showing-because-of-using-map-with-a-function-which-uses-io-mon/55835184#55835184", "title": "putStrLn etc. not showing because of using map with a function which uses IO Monads?", "body": "<p>You've defined an IO action under the name <code>bla</code> - but you never use it subsequently. So all your action <code>rndFib</code> actually does is print \"all done\".</p>\n\n<p>To fix it, just put <code>bla</code> on a line of its own in the <code>do</code> block. And since this is a bit redundant, I would simply drop the <code>let bla =</code> from your version. This will also work as intended.</p>\n"}], "owner": {"reputation": 137, "user_id": 10185954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rAd5FZ0AJ9E/AAAAAAAAAAI/AAAAAAAAC1M/TFmP3mGWV9s/photo.jpg?sz=128", "display_name": "Stephan Pillhofer", "link": "https://stackoverflow.com/users/10185954/stephan-pillhofer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1556125327, "creation_date": 1556124803, "last_edit_date": 1556125279, "question_id": 55835048, "link": "https://stackoverflow.com/questions/55835048/putstrln-etc-not-showing-because-of-using-map-with-a-function-which-uses-io-mon", "title": "putStrLn etc. not showing because of using map with a function which uses IO Monads?", "body": "<p>I want to write a function which returns ten random numbers. The length of each random number corresponds to the nth Fibonacci number.</p>\n\n<p>This is my code:</p>\n\n<pre><code>rndFib = do\n   let fibNumbers = map fib [0..9]\n   let bla = map printOneRndInt fibNumbers\n   putStrLn \"All done\"\n\nfib 0 = 0\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n\nprintOneRndInt n = do\n   gen &lt;- newStdGen\n   let randomInts = randomRs ('0','9') gen\n       (firstn, _) = splitAt n randomInts    \n   putStrLn firstn\n</code></pre>\n\n<p>When I call <code>rndFib</code>, all I get is <code>All done</code> and none of the <code>putStrLn</code>lines are shown. I looks like they are returned into bla, but I just want them to be written out.</p>\n\n<p>Any ideas are very welcome :)</p>\n"}, {"tags": ["haskell", "accelerate-haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1556124358, "post_id": 55834523, "comment_id": 98334343, "body": "Wouldn&#39;t it be something like <code>toComplex = lift1 (:+ 0)</code>?"}, {"owner": {"reputation": 61, "user_id": 11406386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5hohy44SAM4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf5pZ3XsMnyHqhFE7pRC2Fqj_YRZw/mo/photo.jpg?sz=128", "display_name": "Phillip Seeber", "link": "https://stackoverflow.com/users/11406386/phillip-seeber"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1556181402, "post_id": 55834523, "comment_id": 98352425, "body": "You are right, i overlooked this lift function. <code>toComplex = lift (:+ (constant 0))</code> solved my problem. Thanks!"}], "owner": {"reputation": 61, "user_id": 11406386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5hohy44SAM4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf5pZ3XsMnyHqhFE7pRC2Fqj_YRZw/mo/photo.jpg?sz=128", "display_name": "Phillip Seeber", "link": "https://stackoverflow.com/users/11406386/phillip-seeber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 6, "last_activity_date": 1556122670, "creation_date": 1556122670, "question_id": 55834523, "link": "https://stackoverflow.com/questions/55834523/real-complex-type-conversion-within-exp-acc", "title": "Real-Complex type conversion within Exp / Acc", "body": "<p>I need to convert a real numerical value within the <code>Exp</code> or <code>Acc</code> type of the  <a href=\"http://hackage.haskell.org/package/accelerate\" rel=\"noreferrer\">Accelerate library</a> to its corresponding <code>Complex</code> value, e.g.:</p>\n\n<pre><code>toComplex :: Exp Double -&gt; Exp (Complex Double)\ntoComplex' :: Acc (Vector Double) -&gt; Acc (Vector (Complex Double))\n</code></pre>\n\n<p>I tried to pattern match like</p>\n\n<pre><code>toComplex :: Exp Double -&gt; Exp (Complex Double)\ntoComplex a = (\\(r, i) -&gt; constant $ r :+ i) $ (a, constant 0)\n</code></pre>\n\n<p>and suspect that <code>lift</code> or <code>unlift</code> as in <a href=\"https://www.acceleratehs.org/examples/mandelbrot.html\" rel=\"noreferrer\">https://www.acceleratehs.org/examples/mandelbrot.html</a> might somehow solve this problem but can't figure out correct application of those. </p>\n\n<p>For my attempt <code>ghc</code> complains that </p>\n\n<pre><code>\u2022 Couldn't match type \u2018Exp Double\u2019 with \u2018Double\u2019\n      Expected type: Exp (Complex Double)\n        Actual type: Exp (Complex (Exp Double))\n</code></pre>\n"}, {"tags": ["haskell", "io", "main", "io-monad", "do-notation"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1556123625, "post_id": 55834106, "comment_id": 98334004, "body": "That&#39;s not a function; it&#39;s an IO action."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1556123747, "post_id": 55834106, "comment_id": 98334062, "body": "@chepner Sure, but I don&#39;t think that&#39;s really a helpful perspective to have for someone who doesn&#39;t already know what it means and is struggling to do IO at all."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 1, "creation_date": 1556128125, "post_id": 55834106, "comment_id": 98336091, "body": "&quot;From some reading around online I have discovered that it is possible through a &#39;main&#39; function.&quot; <code>main</code> is the <i>entrypoint</i> of your program, just like the <code>public static void main()</code> function in Java. It&#39;s not the only place where you can do IO, you can make as many IO functions as you want and name them whatever you&#39;d like. It&#39;s just, if those functions are going to be used, eventually they&#39;ll need to be called (directly or indirectly) by <code>main</code>."}], "answers": [{"tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": true, "score": 5, "last_activity_date": 1556124819, "last_edit_date": 1556124819, "creation_date": 1556122289, "answer_id": 55834408, "question_id": 55834106, "link": "https://stackoverflow.com/questions/55834106/can-i-have-separate-functions-for-reading-and-writing-to-a-txt-file-in-haskell/55834408#55834408", "title": "Can I have separate functions for reading and writing to a txt file in Haskell, without using a &#39;main&#39; function?", "body": "<blockquote>\n  <p>I'm aware of the complexities surrounding IO in Haskell.</p>\n</blockquote>\n\n<p>It's actually not <em>that</em> complex. It might seem a little intimidating at first but you'll quickly get the hang of it.</p>\n\n<blockquote>\n  <p>How can I also implement a write function?</p>\n</blockquote>\n\n<p>The same way</p>\n\n<blockquote>\n  <p>Or can I separate it?</p>\n</blockquote>\n\n<p>Yes</p>\n\n<blockquote>\n  <p>Also, is there a way of me being able to name the functions load/save?</p>\n</blockquote>\n\n<p>Yes, for example you could do your loading like this:</p>\n\n<pre><code>load :: IO String\nload = readFile \"Test.txt\"\n</code></pre>\n\n<p>All Haskell programs <em>start</em> inside main, but they don't have to <em>stay</em> there, so you can use it like this:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  contents &lt;- load -- notice we're using the thing we just defined above\n  putStrLn contents\n</code></pre>\n\n<p>Note the <code>main</code> is always what your program does; But your <code>main</code> doesn't only have to do a single thing. It could just as well do many things, including for instance reading a value and then deciding what to do; Here's a more complicated (complete) example - I expect you'll not understand all parts of it right off the bat, but it at least should give you something to play around with:</p>\n\n<pre><code>data Choice = Save | Load\n\npickSaveOrLoad :: IO Choice\npickSaveOrLoad = do\n   putStr \"Do you want to save or load? \"\n   answer &lt;- getLine\n   case answer of\n     \"save\" -&gt; return Save\n     \"load\" -&gt; return Load\n     _      -&gt; do\n       putStrLn \"Invalid choice (must pick 'save' or 'load')\"\n       pickSaveOrLoad\n\nsave :: IO ()\nsave = do\n  putStrLn \"You picked save\"\n  putStrLn \"&lt;put your saving stuff here&gt;\"\n\nload :: IO ()\nload = do\n  putStrLn \"You picked load\"\n  putStrLn \"&lt;put your loading stuff here&gt;\"\n\nmain :: IO ()\nmain = do\n  choice &lt;- pickSaveOrLoad\n  case choice of\n    Save -&gt; save\n    Load -&gt; load\n</code></pre>\n\n<p>Of course it's a bit odd to want to do <em>either</em> save or load, most programs that can do these things want to do <em>both</em>, but I don't know what exactly you're going for so I kept it generic.</p>\n"}], "owner": {"reputation": 1096, "user_id": 6748145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hladU.jpg?s=128&g=1", "display_name": "SuperHanz98", "link": "https://stackoverflow.com/users/6748145/superhanz98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 55834408, "answer_count": 1, "score": 0, "last_activity_date": 1556124819, "creation_date": 1556121272, "last_edit_date": 1556123104, "question_id": 55834106, "link": "https://stackoverflow.com/questions/55834106/can-i-have-separate-functions-for-reading-and-writing-to-a-txt-file-in-haskell", "title": "Can I have separate functions for reading and writing to a txt file in Haskell, without using a &#39;main&#39; function?", "body": "<p>I'm making a program using Haskell that requires simple save and load functions. When I call the save function, I need to put a string into a text file. When I call load, I need to pull the string out of the text file.</p>\n\n<p>I'm aware of the complexities surrounding IO in Haskell. From some reading around online I have discovered that it is possible through a 'main' function. However, I seem to only be able to implement either save, or load... not both.</p>\n\n<p>For example, I have the following function at the moment for reading from the file.</p>\n\n<pre><code>main = do  \n contents &lt;- readFile \"Test.txt\"  \n putStrLn contents  \n</code></pre>\n\n<p>How can I also implement a write function? Does it have to be within the same function? Or can I separate it? Also, is there a way of me being able to name the functions load/save? Having to call 'main' when I actually want to call 'load' or 'save' is rather annoying.</p>\n\n<p>I can't find any examples online of someone implementing both, and any implementations I've found of either always go through a main function.</p>\n\n<p>Any advice will be greatly appreciated.</p>\n"}, {"tags": ["regex", "haskell", "pcre"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1556120617, "post_id": 55833344, "comment_id": 98332368, "body": "Why are you calling <code>show</code> on Strings?"}, {"owner": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1556120823, "post_id": 55833344, "comment_id": 98332486, "body": "How about: <code>&quot;^\\$&quot;</code>?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1556120825, "post_id": 55833344, "comment_id": 98332488, "body": "You don&#39;t really need a regular expression for this. <code>&quot;$100.00&quot; !! 0 == &#39;$&#39;</code> will suffice, as long as you know you don&#39;t have an empty string."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 82895, "user_id": 372239, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/2twLb.jpg?s=128&g=1", "display_name": "Toto", "link": "https://stackoverflow.com/users/372239/toto"}, "edited": false, "score": 0, "creation_date": 1556124598, "post_id": 55833344, "comment_id": 98334471, "body": "@Toto, &quot;^\\$&quot; produces <code>Parse error (line 9, column 30): lexical error in string&#47;character literal at character &#39;$&#39;</code>"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1556124832, "post_id": 55833344, "comment_id": 98334588, "body": "@chepner, I&#39;m using this in a block with other more complicated expressions that do require regex, so I&#39;m trying to keep my expression matching consistently regex.  Aside from that, I&#39;m generally confused about this error, and would like to know the answer.  &quot;^&quot; should mean start and &quot;\\\\$&quot; should mean dollar sign literal."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1556125056, "post_id": 55833344, "comment_id": 98334693, "body": "@Carl, in my context, it&#39;s actually a Text not a string, so I&#39;m using <code>show</code> to convert it.  I&#39;ll update my question."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1556126768, "post_id": 55833344, "comment_id": 98335450, "body": "@Mittenchops Try calling <code>length (show (&quot;$100.00&quot; :: Text))</code>. Does it produce the result you expected?"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1556131420, "post_id": 55833344, "comment_id": 98337547, "body": "@amalloy, no length produces an error: <code>Ambiguous occurrence \u2018length\u2019</code>"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1556132321, "post_id": 55833344, "comment_id": 98337931, "body": "@amalloy, I think you are implying I should not use show, but as you can see in update 3, that throws an error."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1556132919, "post_id": 55833344, "comment_id": 98338204, "body": "Hint: My question contains the answer to your question."}], "answers": [{"tags": [], "owner": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "is_accepted": false, "score": 3, "last_activity_date": 1556134207, "creation_date": 1556134207, "answer_id": 55837254, "question_id": 55833344, "link": "https://stackoverflow.com/questions/55833344/start-of-expression-in-haskell-pcre/55837254#55837254", "title": "Start of expression in haskell PCRE", "body": "<p>You want to use <code>unpack</code> to convert <code>Text</code> to <code>String</code>, not <code>show</code>. <code>show x</code> adds quotes, which prevent your regex from matching.</p>\n"}, {"tags": [], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "is_accepted": true, "score": 0, "last_activity_date": 1556169704, "creation_date": 1556169704, "answer_id": 55842298, "question_id": 55833344, "link": "https://stackoverflow.com/questions/55833344/start-of-expression-in-haskell-pcre/55842298#55842298", "title": "Start of expression in haskell PCRE", "body": "<p><code>Data.Text.unpack</code> is the function that works.</p>\n\n<pre><code>import Data.Text as T\n\nlet x = \"$100.00\" :: Text\nprint $ (T.unpack x)\nprint $ IHaskellPrelude.length (T.unpack x)\nlet m = ((T.unpack x) =~ \"^\\\\$\" :: Bool)\nprint m\n</code></pre>\n\n<p>Produces</p>\n\n<pre><code>\"$100.00\"\n7\nTrue\n</code></pre>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 55842298, "answer_count": 2, "score": 0, "last_activity_date": 1556169704, "creation_date": 1556118673, "last_edit_date": 1556125825, "question_id": 55833344, "link": "https://stackoverflow.com/questions/55833344/start-of-expression-in-haskell-pcre", "title": "Start of expression in haskell PCRE", "body": "<p>I am trying to look for a dollar sign at the start of an expression.\nI would expect this to be <code>\"^\\\\$\"</code>, in that I have to escape the dollar sign to avoid it being seen as the end of line.  However, I'm seeing the following results:</p>\n\n<pre><code>import Text.Regex.PCRE\n\nlet x = \"$100.00\" :: Text\n\nlet m = show x =~ \"$\" :: Bool\nprint m\n\nlet m = show x =~ \"^$\" :: Bool\nprint m\n\nlet m = show x =~ \"^\\\\$\" :: Bool\nprint m\n</code></pre>\n\n<p>Yielding:    </p>\n\n<pre><code>True\nFalse\nFalse\n</code></pre>\n\n<p>What am I missing?</p>\n\n<h2>Update 1</h2>\n\n<p>If I try escaping to fewer or more \"\\\" characters:</p>\n\n<pre><code>let m = show x =~ \"^\\$\" :: Bool\nprint m\n\nlet m = show x =~ \"^\\\\\\$\" :: Bool\nprint m\n</code></pre>\n\n<p>Both produce</p>\n\n<pre><code>Parse error (line 13, column 30): lexical error in string/character literal at character '$'\n</code></pre>\n\n<h2>Update 2</h2>\n\n<pre><code>let y = \"1$00.00\" :: Text\nlet m = show y =~ \"$\" :: Bool\nprint m\nTrue\n</code></pre>\n\n<p>Which is why I want <code>^\\\\$</code> rather than just <code>$</code></p>\n\n<h2>Update 3</h2>\n\n<p>When I don't use <code>show</code></p>\n\n<pre><code>let m = x =~ \"^\\\\$\" :: Bool\nprint m\n</code></pre>\n\n<p>Produces</p>\n\n<pre><code>&lt;interactive&gt;:1:9: error:\n    \u2022 No instance for (RegexLike Regex Text) arising from a use of \u2018=~\u2019\n    \u2022 In the expression: x =~ \"^\\\\$\" :: Bool\n      In an equation for \u2018m\u2019: m = x =~ \"^\\\\$\" :: Bool\n</code></pre>\n"}, {"tags": ["haskell", "jupyter", "ihaskell", "haskell-prelude"], "comments": [{"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1556115666, "post_id": 55831783, "comment_id": 98329272, "body": "Answer for update: <code>instance ToJSON R3 where   toJSON = genericToJSON defaultOptions {              fieldLabelModifier = IHaskellPrelude.map C.toLower . L.drop 3 } </code>"}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1556115710, "post_id": 55831783, "comment_id": 98329310, "body": "Or also <code>instance ToJSON R3 where   toJSON = genericToJSON defaultOptions {              fieldLabelModifier = L.map C.toLower . L.drop 3 } </code>"}], "answers": [{"comments": [{"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1556115533, "post_id": 55832198, "comment_id": 98329184, "body": "Ahhhh. I didn&#39;t realize that was where Prelude got it.  Interesting."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1556115206, "creation_date": 1556115206, "answer_id": 55832198, "question_id": 55831783, "link": "https://stackoverflow.com/questions/55831783/where-is-ihaskellprelude-coming-from-in-this-error/55832198#55832198", "title": "Where is IHaskellPrelude coming from in this error?", "body": "<p>It doesn't matter if it's <code>IHaskellPrelude.drop</code> or <code>Data.List.drop</code>: they're <em>the same thing</em>. Both the standard Prelude and the IHaskell one simply re-exports the list <code>drop</code> function. GHC notices that, and thus apparently decides to inform you about the more \u201cbasic\u201d import-path, i.e. the one from the prelude. (I don't know how the heuristic works, but usually GHC is quite good at showing the most convenient import qualifier-name for a binding.)</p>\n\n<p>The problem is that your <code>toJSON</code> is just not type correct, because <code>toLower</code> only works on a <code>Char</code>, not on a <code>String</code>. This can easily be solved by using <code>map toLower</code>.</p>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 55832198, "answer_count": 1, "score": 0, "last_activity_date": 1556115606, "creation_date": 1556114025, "last_edit_date": 1556115606, "question_id": 55831783, "link": "https://stackoverflow.com/questions/55831783/where-is-ihaskellprelude-coming-from-in-this-error", "title": "Where is IHaskellPrelude coming from in this error?", "body": "<p>I'm working in an ihaskell jupyter notebook, so I know the obvious answer to this.</p>\n\n<p>But I'm also using an explicit import from Data.List where it shows this error</p>\n\n<pre><code>import qualified Data.List as L\n</code></pre>\n\n<p>So I am actually confused about the line that quotes IHaskellPrelude is involved instead\nof my explicit import from Data.List which is not prelude.  (This is a more specific question following from <a href=\"https://stackoverflow.com/questions/55818022/functionally-changing-key-names-in-serialization-to-aeson-with-text-keys\">this one</a>)</p>\n\n<p>My error message:</p>\n\n<pre><code>&lt;interactive&gt;:14:35: error:\n    \u2022 Couldn't match type \u2018Char\u2019 with \u2018String\u2019\n      Expected type: String -&gt; String\n        Actual type: String -&gt; Char\n    \u2022 In the \u2018fieldLabelModifier\u2019 field of a record\n      In the first argument of \u2018genericToJSON\u2019, namely \u2018defaultOptions {fieldLabelModifier = Data.Char.toLower . IHaskellPrelude.drop 3}\u2019\n      In the expression: genericToJSON defaultOptions {fieldLabelModifier = Data.Char.toLower . IHaskellPrelude.drop 3}\n&lt;interactive&gt;:14:47: error:\n    \u2022 Couldn't match type \u2018String\u2019 with \u2018Char\u2019\n      Expected type: String -&gt; Char\n        Actual type: String -&gt; String\n    \u2022 In the second argument of \u2018(.)\u2019, namely \u2018IHaskellPrelude.drop 3\u2019\n      In the \u2018fieldLabelModifier\u2019 field of a record\n      In the first argument of \u2018genericToJSON\u2019, namely \u2018defaultOptions {fieldLabelModifier = Data.Char.toLower . IHaskellPrelude.drop 3}\u2019\n</code></pre>\n\n<p>See the line about the fieldLabelModifier?  It calls IHaskellPrelude.drop.  But if you look below, my code calls L.drop:  </p>\n\n<p>Full code:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric,  OverloadedStrings, RankNTypes, KindSignatures #-}\n:ext DeriveGeneric OverloadedStrings FlexibleContexts RankNTypes KindSignatures DataKinds\n\n-- stack overflow question\nimport GHC.Generics\nimport Data.Aeson \nimport Data.Aeson.Encode.Pretty \nimport Data.Time\n-- every dumb library working with any text in haskell requires\nimport Data.Text as T\nimport Text.Show.Pretty\nimport Data.Char(toLower)\nimport qualified Data.List as L\nimport qualified Data.Char as C\nimport Data.ByteString as BS\nimport Data.Aeson.Text (encodeToLazyText)\nimport Data.Text.Lazy.IO as I\n--\nimport Text.Regex.PCRE\n(.=) = (Data.Aeson..=)\n\ntype Code = Text\ntype Value = Float\n\n-- currency parser\n-- Sample\ncurrency = \"100.01\"\n\n-- -- Value part\nvparse :: T.Text -&gt; Float\nvparse raw = (read ((T.unpack raw) =~ (\"[\\\\d].*\") :: String) :: Float)\n\n\ndata R3 = R3 { recCode :: Code \n             , recValue :: Value} deriving (Show, Generic)\n\n\nmakeR3 rawcode rawval = R3 code value where\n                                     code = rawcode\n                                     value = vparse rawval\n\n\ninstance ToJSON R3 where\n  toJSON = genericToJSON defaultOptions {\n             fieldLabelModifier = C.toLower . L.drop 3 }\n-- this says L.drop not prelude!  \n\n\ninstance FromJSON R3 where\n  parseJSON = withObject \"R3\" $ \\r -&gt;\n      R3 &lt;$&gt; r .: \"code\"\n         &lt;*&gt; r .: \"value\"\n\nr3 = makeR3 \"TD\" \"100.42\"\nas_json = encode r3\n\n\nmain = do\n    let out = encodeToLazyText r3\n    I.putStrLn out\n    I.writeFile \"./so2.json\" out\n    return ()\n\nmain\n</code></pre>\n\n<p>I am working in a new session, new terminal, have only run this.  I don't understand why the error message quoted to me is using a function sourced from IHaskellPrelude.drop rather than the L.drop I am explicitly calling.</p>\n\n<h2>Update</h2>\n\n<p>From suggestion in answer, when I try:</p>\n\n<pre><code>instance ToJSON R3 where\n  toJSON = genericToJSON defaultOptions {\n             fieldLabelModifier = map toLower . L.drop 3 }\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>&lt;interactive&gt;:14:35: error:\n    Ambiguous occurrence \u2018map\u2019\n    It could refer to either \u2018BS.map\u2019, imported from \u2018Data.ByteString\u2019\n                          or \u2018T.map\u2019, imported from \u2018Data.Text\u2019\n                          or \u2018IHaskellPrelude.map\u2019, imported from \u2018Prelude\u2019 (and originally defined in \u2018GHC.Base\u2019)\n&lt;interactive&gt;:14:39: error:\n    Ambiguous occurrence \u2018toLower\u2019\n    It could refer to either \u2018Data.Char.toLower\u2019, imported from \u2018Data.Char\u2019 at &lt;interactive&gt;:1:18-24 (and originally defined in \u2018GHC.Unicode\u2019)\n                          or \u2018T.toLower\u2019, imported from \u2018Data.Text\u2019\n</code></pre>\n\n<p>Which combination of these is compatible with what Prelude is asking for?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1556113676, "post_id": 55831130, "comment_id": 98327845, "body": "1. The error occurs because you need a space before the <code>=</code>, it&#39;s parsing <code>[]=</code> as a single unit. 2) You should also demonstrate some effort at the aggregation yourself."}, {"owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1556114683, "post_id": 55831130, "comment_id": 98328554, "body": "@A Tayler the same error occured ...Haskell is really difficult"}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1556114974, "post_id": 55831130, "comment_id": 98328752, "body": "I fixed up some of the code layout to be more consistent. However, there may be actual code indentation problems that are causing your errors. Read up on Haskell indentation rules."}, {"owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "edited": false, "score": 0, "creation_date": 1556115713, "post_id": 55831130, "comment_id": 98329316, "body": "@ Bob Dalgleish I have corrected the program. Aber there are more errors..."}, {"owner": {"reputation": 32458, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1563188598, "post_id": 55831130, "comment_id": 100604617, "body": "Consider accepting the answer if it helped you, the same with all your other questions"}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1556208822, "post_id": 55834468, "comment_id": 98368849, "body": "@dfeuer thanks for the edit! (I wanted more eyeballs and so was delaying  doing it myself... theory being, when ppl see &quot;modified&quot; next to my name they are less inclined to check it out :) )."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1556127230, "last_edit_date": 1556127230, "creation_date": 1556122485, "answer_id": 55834468, "question_id": 55831130, "link": "https://stackoverflow.com/questions/55831130/aggregation-and-grouping/55834468#55834468", "title": "Aggregation and grouping", "body": "<p><code>_</code> on the left hand side of <code>=</code> definitions is a <em>wild card</em>,  part of a pattern. It matches anything and remembers nothing.</p>\n\n<p><code>_</code> on the right hand side of <code>=</code> definitions does not denote a value; it is a signal to compiler \"I don't have anything, just want to see what type should go there!\". </p>\n\n<p>And this is what the compiler is telling you. It's not so much an error, as it is a message:</p>\n\n<pre><code>    * Found hole: _ :: [(Int, [Int])]\n</code></pre>\n\n<p>I.e. you need to put there something with the above type (<code>::</code> is read: \"has type\").</p>\n\n<p>This <code>_</code> is known as a <em>typed hole</em>. Each <code>_</code> is different, unique. They are used in <em>type-driven development</em>. </p>\n"}], "owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1556127230, "creation_date": 1556112180, "last_edit_date": 1556115651, "question_id": 55831130, "link": "https://stackoverflow.com/questions/55831130/aggregation-and-grouping", "title": "Aggregation and grouping", "body": "<p>For example:</p>\n\n<p><code>db = [(1,20),(1,12),(1,28),(2,13),(2,37),(4,11),(4,4),(4,5),(4,10)]</code> is given.</p>\n\n<p>the result: </p>\n\n<pre><code>groupandagg db (+) [(1,60),(2,50),(4,30)]\n</code></pre>\n\n<p>We must get the following list through a function at fist:</p>\n\n<pre><code>[ (1[201228]) (2[1337]) (4[114510]) ]\n</code></pre>\n\n<p>I have finished the first program: </p>\n\n<pre><code>main :: IO ()    -- This says that main is an IO action.\nmain = return () -- This tells main to do nothing\n\nmakekgrl :: [(Int,Int)]-&gt;[(Int,[Int])]\nmakekgrl []= []\nmakekgrl (a,c):[] = [(a,c)]\nmakekgrl ((a,c):(b,d):_)\n     | a==b  = makekgrl ([(a,c:d:[]):_)\n     | otherwiese = (a,c):makekgrl((b,d):_)\n</code></pre>\n\n<p>But one error occurred in this line:</p>\n\n<pre><code> makekgrl []= []\n</code></pre>\n\n<p>the error</p>\n\n<pre><code>\nE:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:8:13: error:\n    parse error on input `='\n    Perhaps you need a 'let' in a 'do' block?\n    e.g. 'let x = 5' instead of 'x = 5'\n  |\n8 |  makekgrl []= []\n\n  |             ^\n[Finished in 0.5s]\n</code></pre>\n\n<p>I do have two questions:</p>\n\n<ol>\n<li>Why did the error occur?</li>\n<li>How to use the program i have finished to get the result in the very above?</li>\n</ol>\n\n<p>after correction:</p>\n\n<pre><code>main :: IO ()    -- This says that main is an IO action.\nmain = return () -- This tells main to do nothing\n\n--the second primnumer Function from leture\n\n\nmakekgrl :: [(Int,Int)]-&gt;[(Int,[Int])]\nmakekgrl [] = []\nmakekgrl [(a,c)] = [(a,c)]\nmakekgrl ((a,c):(b,d):_)\n    |a==b = makekgrl ((a,c:d:[]):_)\n    |otherwiese = [(a,c)] ++ makekgrl((b,d):_)\n</code></pre>\n\n<p>error</p>\n\n<pre><code>E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:11:34: error:\n    * Found hole: _ :: [(Int, [Int])]\n    * In the second argument of `(:)', namely `_'\n      In the first argument of `makekgrl', namely `((a, c : d : []) : _)'\n      In the expression: makekgrl ((a, c : d : []) : _)\n    * Relevant bindings include\n        d :: Int\n          (bound at E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:10:20)\n        b :: Int\n          (bound at E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:10:18)\n        c :: Int\n          (bound at E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:10:14)\n        a :: Int\n          (bound at E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:10:12)\n        makekgrl :: [(Int, Int)] -&gt; [(Int, [Int])]\n          (bound at E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:8:1)\n      Valid hole fits include\n        mempty :: forall a. Monoid a =&gt; a\n          with mempty @[(Int, [Int])]\n          (imported from `Prelude' at E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:1:1\n           (and originally defined in `GHC.Base'))\n   |\n11 |     |a==b = makekgrl ((a,c:d:[]):_)\n\n   |                                  ^\n\nE:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:12:6: error:\n    * Variable not in scope: otherwiese :: Bool\n    * Perhaps you meant `otherwise' (imported from Prelude)\n   |\n12 |     |otherwiese = [(a,c)] ++ makekgrl((b,d):_)\n\n   |      ^^^^^^^^^^\n\nE:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:12:45: error:\n    * Found hole: _ :: [(Int, Int)]\n    * In the second argument of `(:)', namely `_'\n      In the first argument of `makekgrl', namely `((b, d) : _)'\n      In the second argument of `(++)', namely `makekgrl ((b, d) : _)'\n    * Relevant bindings include\n        d :: Int\n          (bound at E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:10:20)\n        b :: Int\n          (bound at E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:10:18)\n        c :: Int\n          (bound at E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:10:14)\n        a :: Int\n          (bound at E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:10:12)\n        makekgrl :: [(Int, Int)] -&gt; [(Int, [Int])]\n          (bound at E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:8:1)\n      Valid hole fits include\n        mempty :: forall a. Monoid a =&gt; a\n          with mempty @[(Int, Int)]\n          (imported from `Prelude' at E:\\Haskell\\Uebungsblatt_2_Aufgabe_1_(from_reddit).hs:1:1\n           (and originally defined in `GHC.Base'))\n   |\n12 |     |otherwiese = [(a,c)] ++ makekgrl((b,d):_)\n\n   |                                             ^\n[Finished in 0.7s]\n</code></pre>\n"}, {"tags": ["haskell", "foldable", "modal-logic"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1556124751, "post_id": 55831077, "comment_id": 98334558, "body": "Side note: use <code>disjoint l r</code> instead of <code>null (intersection l r)</code> to improve performance. The former doesn&#39;t have to build a result set."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1556124958, "post_id": 55831077, "comment_id": 98334641, "body": "I don&#39;t really understand what you&#39;re asking. You seem to have a problem and a solution. What remains?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1556127045, "post_id": 55831077, "comment_id": 98335586, "body": "Also, you should include a comment explaining that making the <code>AllDifferent</code> constructor lazy avoids taking the last union when it&#39;s not necessary, which can save a significant amount of time when folding over large trees that are pretty balanced at their roots. Defend your code against careless &quot;optimization&quot;!"}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1556135907, "post_id": 55831077, "comment_id": 98339411, "body": "@dfeuer Thank for the suggestions; I&#39;ve just modified the code. My question is a theoretical question about the kind of this modal operators. Are true modal operator like: Necessity - Possibility; Obligatory - Permissible; ecc. ?"}], "answers": [{"comments": [{"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 0, "creation_date": 1556176978, "post_id": 55839994, "comment_id": 98350133, "body": "Wheh you write (liftA2 (,) xs&#39; xs&#39;) you intend  (liftA2 (,) (init xs&#39;) (tail xs&#39;)?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 0, "creation_date": 1556188897, "post_id": 55839994, "comment_id": 98356784, "body": "@AlbertoCapitani Not really. If you wanted to exploit transitivity, you might write <code>zip (drop 1 xs&#39;) xs&#39;</code> (note that is a different list applicative). My implementation above, though, is merely illustrative, and in any case if we were concerned about performance we would have to generate the pairs in a single pass through <code>xs</code> (otherwise memory retention woes await).  On a mostly unrelated note, an analogous implementation of <code>allDifferent</code> wouldn&#39;t be quite as straightforward, as <code>(&#47;=)</code> is neither reflexive nor transitive."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1556149856, "creation_date": 1556149856, "answer_id": 55839994, "question_id": 55831077, "link": "https://stackoverflow.com/questions/55831077/new-modal-operators-for-foldable/55839994#55839994", "title": "(New?) Modal Operators for Foldable", "body": "<p>I'd say that your functions form a square of oppositions because they express quantification -- more specifically, quantification of a certain predicate over pairs of elements from the foldable container [note 1]. From this point of view, there being squares of oppositions involving modal operators reflects how modalities can be understood as forms of local quantification. I don't see a more direct link from your functions to the traditional modalities.</p>\n\n<p>On a broader note, most approaches towards expressing modality in Haskell that I know of are mediated, on a theoretical level, by the Curry-Howard isomorphism -- see <a href=\"https://stackoverflow.com/q/49262771/2751851\"><em>Interesting operators in Haskell that obey modal axioms</em></a> for a few references on that. I have never heard about attempts to think about properties of data structures in terms of modalities; however, I don't think it is impossible for that to make sense somehow [note 2].</p>\n\n<hr>\n\n<p><strong>Note 1:</strong> I say \"pairs of elements\" from the vantage point that regards relations as sets of pairs. In concrete terms, I'm thinking of this out-of-competition implementation of <code>allEq</code>...</p>\n\n<pre><code>allEq :: (Foldable f, Eq a) =&gt; f a -&gt; Bool\nallEq xs = all (uncurry (==)) (liftA2 (,) xs' xs')\n    where\n    xs' = toList xs\n</code></pre>\n\n<p>... in which we check whether a certain property, namely <code>uncurry (==)</code>, holds for all pairs of elements of <code>xs</code>.</p>\n\n<p><strong>Note 2:</strong> For one, possible world semantics can be worked with using graphs, as vividly illustrated in <a href=\"https://rkirsling.github.io/modallogic/\" rel=\"nofollow noreferrer\">this demo</a>.</p>\n"}], "owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 1, "accepted_answer_id": 55839994, "answer_count": 1, "score": 2, "last_activity_date": 1563229672, "creation_date": 1556112012, "last_edit_date": 1563229672, "question_id": 55831077, "link": "https://stackoverflow.com/questions/55831077/new-modal-operators-for-foldable", "title": "(New?) Modal Operators for Foldable", "body": "<p>This post follows in a sense <a href=\"https://stackoverflow.com/q/55815807/2751851\">my previous one</a>. HTNW, <a href=\"https://stackoverflow.com/a/55816153/2751851\">in their answer there</a>, defined the data type <code>Same</code> and the function <code>allEq</code>. So I thought that by defining the data type <code>AllDifferent</code>, the function <code>allDiff</code> and the derived ones <code>someEq</code> and <code>someDiff</code>, I would have obtained <a href=\"https://plato.stanford.edu/entries/square/\" rel=\"nofollow noreferrer\">a kind of modal square</a> for <code>Foldable</code> structures.</p>\n\n<p>If the result of my work is correct, how can one appropriately characterise this set of data types and functions?</p>\n\n<pre><code>import qualified Data.Set as S\nimport qualified Data.Matrix as MT  -- only for exemplification\n\n-- EXAMPLES --\n-- allEq    $ MT.fromLists [\"aaa\",\"aaa\"] -&gt; True\n-- allEq    $ MT.fromLists [\"aaa\",\"daa\"] -&gt; False\n-- someEq   $ MT.fromLists [\"abc\",\"dea\"] -&gt; True\n-- someEq   $ MT.fromLists [\"abc\",\"def\"] -&gt; False\n-- allDiff  $ MT.fromLists [\"abc\",\"def\"] -&gt; True\n-- allDiff  $ MT.fromLists [\"abc\",\"dea\"] -&gt; False\n-- someDiff $ MT.fromLists [\"aaa\",\"daa\"] -&gt; True\n-- someDiff $ MT.fromLists [\"aaa\",\"aaa\"] -&gt; False\n\n-- ====================== allEq ======================\n-- produced by HTNW in response to my previous post.\n\ndata Same a = Vacuous | Fail | Same a\ninstance Eq a =&gt; Semigroup (Same a) where\n    Vacuous    &lt;&gt; x       = x\n    Fail       &lt;&gt; _       = Fail\n    s@(Same l) &lt;&gt; Same r  = if l == r then s else Fail\n    x          &lt;&gt; Vacuous = x\n    _          &lt;&gt; Fail    = Fail\n\ninstance Eq a =&gt; Monoid (Same a) where\n    mempty = Vacuous\nallEq :: (Foldable f, Eq a) =&gt; f a -&gt; Bool\nallEq xs = case foldMap Same xs of\n                Fail -&gt; False\n                _    -&gt; True\n\n-- ====================== allDiff ======================\n\ndata AllDifferent a = VacuousAD | FailAD | AllDifferent (S.Set a)\n--  The lazy construction avoids taking the last union when it's not necessary, which can \n-- save a significant amount of time when folding over large trees that are \n-- pretty balanced at their roots.\n\ninstance (Eq a, Ord a) =&gt; Semigroup (AllDifferent a) where\n    VacuousAD      &lt;&gt; x       = x\n    FailAD         &lt;&gt; _       = FailAD\n    AllDifferent l &lt;&gt; AllDifferent r  = if S.disjoint l r \n                                        then AllDifferent (S.union l r)\n                                        else FailAD\n    x              &lt;&gt; VacuousAD = x\n    _              &lt;&gt; FailAD    = FailAD\n\ninstance (Eq a, Ord a) =&gt; Monoid (AllDifferent a) where\n    mempty = VacuousAD\nallDiff :: (Foldable f, Eq a, Ord a) =&gt; f a -&gt; Bool\nallDiff xs = case foldMap (AllDifferent . S.singleton)  xs of\n                FailAD -&gt; False\n                _    -&gt; True\n\n-- ====================== someEq ======================\n\nsomeEq :: (Foldable f, Eq a, Ord a) =&gt; f a -&gt; Bool\nsomeEq = not . allDiff\n\n -- ====================== someDiff ======================\n\nsomeDiff :: (Foldable f, Eq a) =&gt; f a -&gt; Bool \nsomeDiff = not . allEq\n</code></pre>\n"}, {"tags": ["haskell", "memory", "timeout", "quickcheck"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1556147761, "post_id": 55830621, "comment_id": 98343206, "body": "I&#39;m not an expert (this sounds like a question for Simon Marlow or maybe Ben Gamari) but I&#39;m not optimistic. Some of the necessary information can be captured by the profiler, but I don&#39;t know about being able to get the sort of access you need. Maybe. I think you&#39;re likely better off writing your QuickCheck generators more carefully."}, {"owner": {"reputation": 2281, "user_id": 884682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c30403d77047cd6ff49f2c1b78352e8?s=128&d=identicon&r=PG", "display_name": "Warbo", "link": "https://stackoverflow.com/users/884682/warbo"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1556194905, "post_id": 55830621, "comment_id": 98360138, "body": "@dfeuer I&#39;m dealing with arbitrary, user-supplied code. The generators are auto-generated from the types and seem <i>mostly</i> fine; the main problem is functions with pathologically large output (or intermediate values), e.g. an <code>exp</code> function for Peano naturals. In most situations generating a Peano-encoded 10 would be reasonable; but <code>exp 10 10</code> isn&#39;t good. I basically want a &quot;sandbox&quot; for user-supplied code, to prevent a few &quot;bad&quot; expressions from  freezing/OOM-killing the whole program. (I ignore safety for now; if a user throws <code>unsafePerformIO</code> into QuickCheck that&#39;s their fault!)"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1556207927, "post_id": 55830621, "comment_id": 98368379, "body": "Of course, there&#39;s a GHC switch to limit the maximum possible heap size. (I <i>believe</i> it throws some kind of exception when the limit is reached, which you could conceivably catch. Unsure how easy it is to proceed once all available memory is exhausted...)"}], "owner": {"reputation": 2281, "user_id": 884682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c30403d77047cd6ff49f2c1b78352e8?s=128&d=identicon&r=PG", "display_name": "Warbo", "link": "https://stackoverflow.com/users/884682/warbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 146, "favorite_count": 0, "answer_count": 0, "score": 12, "last_activity_date": 1556508084, "creation_date": 1556110727, "question_id": 55830621, "link": "https://stackoverflow.com/questions/55830621/abort-evaluating-haskell-expression-if-memory-limit-reached", "title": "Abort evaluating Haskell expression if memory limit reached", "body": "<p>I'm using QuickCheck to test automatically-generated properties (similar to <a href=\"https://hackage.haskell.org/package/quickspec\" rel=\"noreferrer\">QuickSpec</a>) but one common problem I'm running into is exhausting the memory, either due to naive recursive generators or very large function outputs (e.g. one failure was caused by an exponential function for Peano numerals, which generated huge nested structures).</p>\n\n<p>I'm wondering if there's a way to abandon evaluation if a (resident) memory limit is reached. It seems <a href=\"https://stackoverflow.com/questions/20752083/haskell-time-limit-on-evaluation\">we can do this for timeouts</a>, but memory seems to be trickier. This way, if we use too much memory, that test can be discarded (as if a <code>==&gt;</code> precondition had failed).</p>\n\n<p>I can see how to measure the whole program's memory usage, by looking at the source of the <code>weigh</code> package. This would be workable, but it would be much nicer (and robust) to measure it for one particular expression (perhaps by getting the memory used by one thread, or something?).</p>\n\n<p>For my purposes it would be enough to fully-normalise the expression, since I don't need to worry about recursive structures (I can apply this to the test results, which are effectively booleans).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3516, "user_id": 1057102, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9f1412fdce8dc8873cf8b5590501faf7?s=128&d=identicon&r=PG&f=1", "display_name": "sleblanc", "link": "https://stackoverflow.com/users/1057102/sleblanc"}, "edited": false, "score": 0, "creation_date": 1556110600, "post_id": 55830466, "comment_id": 98325765, "body": "Where is your definition of the function <code>dice</code>, in <code>let rolled = dice gen</code>?"}, {"owner": {"reputation": 137, "user_id": 10185954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rAd5FZ0AJ9E/AAAAAAAAAAI/AAAAAAAAC1M/TFmP3mGWV9s/photo.jpg?sz=128", "display_name": "Stephan Pillhofer", "link": "https://stackoverflow.com/users/10185954/stephan-pillhofer"}, "reply_to_user": {"reputation": 3516, "user_id": 1057102, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9f1412fdce8dc8873cf8b5590501faf7?s=128&d=identicon&r=PG&f=1", "display_name": "sleblanc", "link": "https://stackoverflow.com/users/1057102/sleblanc"}, "edited": false, "score": 0, "creation_date": 1556110715, "post_id": 55830466, "comment_id": 98325835, "body": "@sleblanc thank you, forgot that. I edited my post. I know <code>dice</code> is more complicated than it needs to be, but I just recycled the function"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 1, "creation_date": 1556110938, "post_id": 55830466, "comment_id": 98325970, "body": "if your dice only have integers on their faces, it should probably be <code>rollDice :: Int -&gt;  Int -&gt; IO ()</code>, which should make the type error go away too..."}, {"owner": {"reputation": 3516, "user_id": 1057102, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9f1412fdce8dc8873cf8b5590501faf7?s=128&d=identicon&r=PG&f=1", "display_name": "sleblanc", "link": "https://stackoverflow.com/users/1057102/sleblanc"}, "edited": false, "score": 0, "creation_date": 1556110969, "post_id": 55830466, "comment_id": 98325986, "body": "You set your variable <code>amount</code> to be an instance of the typeclass Random, I cannot understand why."}, {"owner": {"reputation": 137, "user_id": 10185954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rAd5FZ0AJ9E/AAAAAAAAAAI/AAAAAAAAC1M/TFmP3mGWV9s/photo.jpg?sz=128", "display_name": "Stephan Pillhofer", "link": "https://stackoverflow.com/users/10185954/stephan-pillhofer"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1556111290, "post_id": 55830466, "comment_id": 98326208, "body": "@mb21 thanks that worked! I just wrote what GHCi told me when I typed :t rollDice."}], "answers": [{"comments": [{"owner": {"reputation": 3516, "user_id": 1057102, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9f1412fdce8dc8873cf8b5590501faf7?s=128&d=identicon&r=PG&f=1", "display_name": "sleblanc", "link": "https://stackoverflow.com/users/1057102/sleblanc"}, "edited": false, "score": 0, "creation_date": 1556231959, "post_id": 55830822, "comment_id": 98378215, "body": "Also, you need to either use the <code>randomR</code> function and keep passing back the new generator you obtained from applying the function, OR use <code>randomRs</code> and retrieve a bunch of results (asking for 100 would guarantee having enough rolls to reach 100) then discard the rolls once your sum is past 100. The way you wrote your code, no state is kept between rolls of the RNG, so <a href=\"https://www.xkcd.com/221/\" rel=\"nofollow noreferrer\">you keep getting the same die roll over and over again.</a>"}], "tags": [], "owner": {"reputation": 3516, "user_id": 1057102, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9f1412fdce8dc8873cf8b5590501faf7?s=128&d=identicon&r=PG&f=1", "display_name": "sleblanc", "link": "https://stackoverflow.com/users/1057102/sleblanc"}, "is_accepted": true, "score": 2, "last_activity_date": 1556232185, "last_edit_date": 1556232185, "creation_date": 1556111302, "answer_id": 55830822, "question_id": 55830466, "link": "https://stackoverflow.com/questions/55830466/why-does-calling-a-function-with-io-as-a-return-value-result-in-an-ambiguous/55830822#55830822", "title": "Why does calling a function with IO () as a return value result in an ambiguous type error?", "body": "<p>Get rid of the Random typeclass constraint, it seems superfluous.</p>\n\n<pre><code>rollDice :: (Ord t, Show a, Num a, Num t) =&gt; t -&gt; a -&gt; IO ()\n</code></pre>\n\n<p>Also, you need to either use the <code>randomR</code> function and keep passing back the new generator you obtained from applying the function, OR use <code>randomRs</code> as you do but retrieve a bunch of results (asking for 100 would guarantee having enough rolls to reach 100) then discard the rest of the rolls once your sum is past 100.</p>\n\n<p>The way you wrote your code, no state is kept between rolls of the RNG, so you keep getting the same die roll over and over again. <a href=\"https://www.xkcd.com/221/\" rel=\"nofollow noreferrer\">That is to say, if the first time you rolled the die, you got 4, then you will keep getting the number 4</a> until you reach a sum of 100.</p>\n\n<p>As it is, your function would have an equal chance of printing the values 16, 20, 25, 33, 50 and 100. Can you confirm this?</p>\n"}, {"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 3, "last_activity_date": 1556112724, "creation_date": 1556112724, "answer_id": 55831314, "question_id": 55830466, "link": "https://stackoverflow.com/questions/55830466/why-does-calling-a-function-with-io-as-a-return-value-result-in-an-ambiguous/55831314#55831314", "title": "Why does calling a function with IO () as a return value result in an ambiguous type error?", "body": "<p>The problem with your code is that GHC can find a number of types that could be used for <code>t</code>. It has to be something that is an instance of <code>Ord</code>, <code>Random</code> and <code>Num</code>. Unfortunately there are quite a few types that fit the bill. In fact most instances of <code>Num</code> are also <code>Random</code> and <code>Ord</code> (<code>Complex</code> is probably the only exception).</p>\n\n<p>At this point GHC either has to guess or admit defeat. Having the compiler guess what you meant is generally considered a bad thing, so it reports the problem.</p>\n\n<p>When you encounter an error like this you need to find somewhere in your code to tie down the exact type you want to use. As a rule this should be as far up the call stack as possible, which in this case is the type of <code>rollDice</code>.</p>\n"}], "owner": {"reputation": 137, "user_id": 10185954, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rAd5FZ0AJ9E/AAAAAAAAAAI/AAAAAAAAC1M/TFmP3mGWV9s/photo.jpg?sz=128", "display_name": "Stephan Pillhofer", "link": "https://stackoverflow.com/users/10185954/stephan-pillhofer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 55830822, "answer_count": 2, "score": 0, "last_activity_date": 1556232185, "creation_date": 1556110187, "last_edit_date": 1556110685, "question_id": 55830466, "link": "https://stackoverflow.com/questions/55830466/why-does-calling-a-function-with-io-as-a-return-value-result-in-an-ambiguous", "title": "Why does calling a function with IO () as a return value result in an ambiguous type error?", "body": "<p>I have these two function and my first functions calls the second one. The first one only acts as a kickstarter. Sadly I'm getting the following error. </p>\n\n<pre><code>runTo100 = rollDice 0 0 \n\nrollDice :: (Ord t, Show a, Random t, Num a, Num t) =&gt; t -&gt; a -&gt; IO ()\nrollDice amount n = do\ngen &lt;- newStdGen\nif amount &lt;= 100\n    then do\n        let rolled = dice gen\n        rollDice (amount + rolled) (n + 1)\n    else do\n        putStrLn (\"Rolls needed to reach 100: \" ++ show n)\n\n\ndice :: (Random a, RandomGen g, Num a) =&gt; g -&gt; a\ndice gen = head (take 1 $ randomRs (1, 6) gen)\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>Ambiguous type variable \u2018t0\u2019 arising from a use of \u2018rollDice\u2019\n  prevents the constraint \u2018(Ord t0)\u2019 from being solved.\n  Probable fix: use a type annotation to specify what \u2018t0\u2019 should be.\n  These potential instances exist:\n    instance (Ord a, Ord b) =&gt; Ord (Either a b)\n      -- Defined in \u2018Data.Either\u2019\n    instance Ord Ordering -- Defined in \u2018GHC.Classes\u2019\n    instance Ord Integer\n      -- Defined in \u2018integer-gmp-1.0.2.0:GHC.Integer.Type\u2019\n    ...plus 23 others\n    ...plus 89 instances involving out-of-scope types\n    (use -fprint-potential-instances to see them all)\n\u2022 In the expression: rollDice 0 0\n  In an equation for \u2018runTo100\u2019: runTo100 = rollDice 0 0\n|\n119 | runTo100 = rollDice 0 0      |            ^^^^^^^^^^^^\n</code></pre>\n\n<p>Why does this result in an ambiguous type error. I know that I have to specify a type somewhere, but I'm new to haskell and I don't fully understand what's going on. I looked at various posts but couldn't find any which helped me.</p>\n\n<p>Thank you in advance for any help. :)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1556105137, "post_id": 55828576, "comment_id": 98322501, "body": "I have no idea what <code>rank</code> is - it&#39;s certainly not a standard Haskell function. You should ask your professor."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1556106423, "post_id": 55828576, "comment_id": 98323291, "body": "Type signature for <code>reconstruct</code> doesn&#39;t match the number of arguments provided. If the input is two lists, then perhaps <code>reconstruct :: [Int] -&gt; [Int] -&gt; IntTree</code>. I think you have function binding precedence wrong in your head - <code>f a (b) c = f a b c</code> not <code>f (a b) c</code> (note <code>f (a) = f a</code>, <code>f (a b) &#47;= f a b</code>). From the description, <code>rank</code> is just standard Haskell <code>find</code>. You might benefit from using <code>splitAt</code> rather than <code>drop</code>, <code>take</code>."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "edited": false, "score": 0, "creation_date": 1556107417, "post_id": 55829581, "comment_id": 98323857, "body": "Thanks a lot. I try to understand it"}, {"owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "edited": false, "score": 0, "creation_date": 1556108452, "post_id": 55829581, "comment_id": 98324470, "body": "@A Tayler <code>ghci&gt; span (&#47;=4) [1,2,3,4,5,6,7] ([1,2,3],[4,5,6,7])</code> I have found the example of the function &quot;span&quot;. But I don&#39;t see what &quot;(l,<i>:r)&quot; and &quot;&quot;(l,</i>:r)&quot;&quot; mean? Can I use the fst und sec to get the lists?"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "edited": false, "score": 0, "creation_date": 1556108934, "post_id": 55829581, "comment_id": 98324773, "body": "<code>(l, _:r)</code> binds a tuple, the second element of which is a non-empty list. <code>l</code> becomes the first element, <code>r</code> becomes the <code>tail</code> of the second element. You could write <code>p = span ...</code> <code>l = fst p</code> <code>r = tail . snd $ p</code> but as you can see, it&#39;s much more verbose. <code>_</code> says we&#39;re ignoring the <code>head</code> of the list in the right-half of the tuple - technically because we &quot;know&quot; it&#39;s <code>x</code>, this replicates the <code>+1</code> in your code that drops the <code>x</code>."}, {"owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "edited": false, "score": 0, "creation_date": 1556108989, "post_id": 55829581, "comment_id": 98324801, "body": "I am new in Haskell bro"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "edited": false, "score": 0, "creation_date": 1556109321, "post_id": 55829581, "comment_id": 98325013, "body": "Try writing <code>ghci &gt; (l,_:r) = span (&#47;=4) [1,2,3,4,5,6,7]</code> then examining the values of <code>l</code>,<code>r</code>."}, {"owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "edited": false, "score": 0, "creation_date": 1556110442, "post_id": 55829581, "comment_id": 98325680, "body": "@  A Tayler I have tried...but my professor don&#39;t allow us to use the knowledge that we haven&#39;t lerned. And I have correted the program but one error exists still .... The corrected program is in the above...."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "reply_to_user": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "edited": false, "score": 0, "creation_date": 1556112251, "post_id": 55829581, "comment_id": 98326937, "body": "@LeonhardFelix as I said in an earlier comment, you have misunderstood how function application precedence works. You wrote <code>f a (b c d) e</code> instead of <code>f (a (b c) d) e</code>, they are completely different (here <code>f</code> is <code>reconstruct</code>, <code>a</code> is <code>take</code>/<code>drop</code>, <code>b</code> is <code>length</code>, etc.)"}], "tags": [], "owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "is_accepted": false, "score": 1, "last_activity_date": 1556109261, "last_edit_date": 1556109261, "creation_date": 1556107219, "answer_id": 55829581, "question_id": 55828576, "link": "https://stackoverflow.com/questions/55828576/reconstruct-the-binary-tree-with-two-lists-after-preorder-and-inorder/55829581#55829581", "title": "reconstruct the binary tree with two lists after preorder and inorder", "body": "<pre><code>reconstruct :: [Int] -&gt; [Int] -&gt; IntTree\nreconstruct [] [] = Empty\nreconstruct (x:xs) y = let (l,_:r) = span (x /=) y\n                           (l',r') = splitAt (length l) xs\n                       in Branch (reconstruct l' l) x (reconstruct r' r)\nreconstruct _ _ = error \"incomplete pattern\"\n</code></pre>\n\n<p>This seemed to work on the single testcase I tried, and is pretty much what you intended to write (I think). It runs into issues if nodes can have left-descendants with equal contents to themselves (?). I think it might traverse <code>l</code> twice (due to <code>length</code>), you could solve this with a <code>zip</code>and some extra logic if desired.</p>\n"}, {"tags": [], "owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "is_accepted": false, "score": 0, "last_activity_date": 1556164539, "creation_date": 1556164539, "answer_id": 55841583, "question_id": 55828576, "link": "https://stackoverflow.com/questions/55828576/reconstruct-the-binary-tree-with-two-lists-after-preorder-and-inorder/55841583#55841583", "title": "reconstruct the binary tree with two lists after preorder and inorder", "body": "<blockquote>\n  <p>The function `reconstruct' is applied to three arguments, but its type `[Int] -> [Int] -> IntTree' has only two</p>\n</blockquote>\n\n<pre><code>(reconstruct take (length (fst p) xs) (fst p))\n</code></pre>\n\n<p>You apply the <code>reconstruct</code> functions to 3 arguments, as stated in the error message: <code>take</code>, <code>(length (fst p) xs)</code> and <code>(fst p)</code>.</p>\n\n<p>Similar error is with length application: you pass 2 arguments to it.</p>\n\n<p>Maybe you meant to pass <code>FUNCTION(ARGUMENT)</code> as single argumetn to next function. It does not work like this, it would be considered as 2 arguments: <code>FUNCTION</code> and <code>(ARGUMENT)</code>. Instead you should use <code>(FUNCTION ARGUMENT)</code>, or <code>(FUNCTION (ARGUMENT))</code> if the ARGUMENT is complex.</p>\n\n<p>Also, you should not group arguments to functions separately from the function: <code>take (length ... LIST)</code>. This is considered as single argument <code>(length ... LIST)</code>. They should be on same bracket level with the function.</p>\n\n<p>So your first reconstruct call would rather look like:</p>\n\n<pre><code>(reconstruct (take (length (fst p)) xs) (fst p))\n</code></pre>\n\n<p>And probably the rest of the expression have similar issues</p>\n"}], "owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1556164539, "creation_date": 1556103837, "last_edit_date": 1556110244, "question_id": 55828576, "link": "https://stackoverflow.com/questions/55828576/reconstruct-the-binary-tree-with-two-lists-after-preorder-and-inorder", "title": "reconstruct the binary tree with two lists after preorder and inorder", "body": "<p>--Two lists are given, one sorted by preorder, the other sorted by inorder. And the two lists are from the same binary tree. With the two lists the binary tree is --reconstructed.</p>\n\n<p>-- I haven't found the function \"rank\" online. My professor told us that the function \"rank\" can output the position of one element in a list.</p>\n\n<p>The error occured in the following line where the function \"rank\" were used.</p>\n\n<p>So I have two questions.</p>\n\n<ol>\n<li>How ist the function \"rank\"?</li>\n<li>Is the expression  \"reconstruct :: [Int]->IntTree\" correct ? I am not sure. </li>\n</ol>\n\n<pre><code>main :: IO ()    -- This says that main is an IO action.\nmain = return () -- This tells main to do nothing\n\ndata IntTree = Empty | Branch IntTree Int IntTree deriving (Show, Eq)\n\nreconstruct :: [Int]-&gt;IntTree\n--  Pattern matching \nreconstruct (x:xs) y = Branch (reconstruct take((rank x y) xs) take ((rank x y) y)) x x (reconstruct drop ((rank x y)+1 xs) drop ((rank x y)+1 y)) \n</code></pre>\n\n<p>after correction</p>\n\n<pre><code>import Data.List\n\n\nmain :: IO ()    -- This says that main is an IO action.\nmain = return () -- This tells main to do nothing\n\ndata IntTree = Empty | Branch IntTree Int IntTree deriving (Show, Eq)\n\n--Two lists are given, one sorted by preorder, the other sorted by inorder. \n-- And the two lists are from the same binary tree. With the two lists the binary tree is reconstructed.\n\nreconstruct :: [Int]-&gt;[Int]-&gt;IntTree\n--  Pattern matching \nreconstruct [] [] = Empty\nreconstruct (x:xs) y = Branch (reconstruct take (length (fst p) xs) (fst p)) x (reconstruct drop (length (fst p) xs) (snd p))\n    where p = span (x/=) y \n\nreconstruct _ _ = error \"incomplete pattern\"\n\n</code></pre>\n\n<p>the error</p>\n\n<pre><code>\nE:\\Haskell\\Uebungsblatt_2_Aufgabe_1.hs:15:32: error:\n    * Couldn't match expected type `[Int] -&gt; IntTree'\n                  with actual type `IntTree'\n    * The function `reconstruct' is applied to three arguments,\n      but its type `[Int] -&gt; [Int] -&gt; IntTree' has only two\n      In the first argument of `Branch', namely\n        `(reconstruct take (length (fst p) xs) (fst p))'\n      In the expression:\n        Branch\n          (reconstruct take (length (fst p) xs) (fst p))\n          x\n          (reconstruct drop (length (fst p) xs) (snd p))\n   |\n15 | reconstruct (x:xs) y = Branch (reconstruct take (length (fst p) xs) (fst p)) x (reconstruct drop (length (fst p) xs) (snd p))\n\n   |                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nE:\\Haskell\\Uebungsblatt_2_Aufgabe_1.hs:15:44: error:\n    * Couldn't match expected type `[Int]'\n                  with actual type `Int -&gt; [a0] -&gt; [a0]'\n    * Probable cause: `take' is applied to too few arguments\n      In the first argument of `reconstruct', namely `take'\n      In the first argument of `Branch', namely\n        `(reconstruct take (length (fst p) xs) (fst p))'\n      In the expression:\n        Branch\n          (reconstruct take (length (fst p) xs) (fst p))\n          x\n          (reconstruct drop (length (fst p) xs) (snd p))\n   |\n15 | reconstruct (x:xs) y = Branch (reconstruct take (length (fst p) xs) (fst p)) x (reconstruct drop (length (fst p) xs) (snd p))\n\n   |                                            ^^^^\n\nE:\\Haskell\\Uebungsblatt_2_Aufgabe_1.hs:15:50: error:\n    * Couldn't match expected type `[Int] -&gt; [Int]'\n                  with actual type `Int'\n    * The function `length' is applied to two arguments,\n      but its type `[Int] -&gt; Int' has only one\n      In the second argument of `reconstruct', namely\n        `(length (fst p) xs)'\n      In the first argument of `Branch', namely\n        `(reconstruct take (length (fst p) xs) (fst p))'\n   |\n15 | reconstruct (x:xs) y = Branch (reconstruct take (length (fst p) xs) (fst p)) x (reconstruct drop (length (fst p) xs) (snd p))\n\n   |                                                  ^^^^^^^^^^^^^^^^^\n\nE:\\Haskell\\Uebungsblatt_2_Aufgabe_1.hs:15:81: error:\n    * Couldn't match expected type `[Int] -&gt; IntTree'\n                  with actual type `IntTree'\n    * The function `reconstruct' is applied to three arguments,\n      but its type `[Int] -&gt; [Int] -&gt; IntTree' has only two\n      In the third argument of `Branch', namely\n        `(reconstruct drop (length (fst p) xs) (snd p))'\n      In the expression:\n        Branch\n          (reconstruct take (length (fst p) xs) (fst p))\n          x\n          (reconstruct drop (length (fst p) xs) (snd p))\n   |\n15 | reconstruct (x:xs) y = Branch (reconstruct take (length (fst p) xs) (fst p)) x (reconstruct drop (length (fst p) xs) (snd p))\n\n   |                                                                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nE:\\Haskell\\Uebungsblatt_2_Aufgabe_1.hs:15:93: error:\n    * Couldn't match expected type `[Int]'\n                  with actual type `Int -&gt; [a1] -&gt; [a1]'\n    * Probable cause: `drop' is applied to too few arguments\n      In the first argument of `reconstruct', namely `drop'\n      In the third argument of `Branch', namely\n        `(reconstruct drop (length (fst p) xs) (snd p))'\n      In the expression:\n        Branch\n          (reconstruct take (length (fst p) xs) (fst p))\n          x\n          (reconstruct drop (length (fst p) xs) (snd p))\n   |\n15 | reconstruct (x:xs) y = Branch (reconstruct take (length (fst p) xs) (fst p)) x (reconstruct drop (length (fst p) xs) (snd p))\n\n   |                                                                                             ^^^^\n\nE:\\Haskell\\Uebungsblatt_2_Aufgabe_1.hs:15:99: error:\n    * Couldn't match expected type `[Int] -&gt; [Int]'\n                  with actual type `Int'\n    * The function `length' is applied to two arguments,\n      but its type `[Int] -&gt; Int' has only one\n      In the second argument of `reconstruct', namely\n        `(length (fst p) xs)'\n      In the third argument of `Branch', namely\n        `(reconstruct drop (length (fst p) xs) (snd p))'\n   |\n15 | reconstruct (x:xs) y = Branch (reconstruct take (length (fst p) xs) (fst p)) x (reconstruct drop (length (fst p) xs) (snd p))\n\n   |                                                                                                   ^^^^^^^^^^^^^^^^^\n[Finished in 0.5s]\n\n</code></pre>\n"}, {"tags": ["haskell", "memory", "iterator", "binary-tree"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1556079180, "post_id": 55822008, "comment_id": 98310209, "body": "To write an actual answer would require a ton more details; this can&#39;t be the entire problem, can it? By &quot;at most 100 nodes in memory,&quot; do they mean &quot;at most 100 nodes reachable by GC&quot; (because the rest will be deallocated as needed) or is it more harsh? In the worst case, I suppose, you can just mutate an array in-place to avoid allocation?"}, {"owner": {"reputation": 674, "user_id": 7478655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UL7XU.jpg?s=128&g=1", "display_name": "vrom911", "link": "https://stackoverflow.com/users/7478655/vrom911"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1556082862, "post_id": 55822008, "comment_id": 98311066, "body": "I don&#39;t require to write the answer to the concrete problem (which is, of course, I don&#39;t mind). I&#39;m more interested in the approaches that could be used to work with the memory limits and allocations on demand in Haskell.   And answering your question this is the whole task and no more details were given to me."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1556089739, "post_id": 55822008, "comment_id": 98313690, "body": "It feels strange because (being a GCd language) you don&#39;t have precise control over when / where memory is (de)allocated. There is some capacity for manual memory management, particularly for use with FFI eg. <a href=\"https://ro-che.info/articles/2017-08-06-manage-allocated-memory-haskell\" rel=\"nofollow noreferrer\">ro-che.info/articles/2017-08-06-manage-allocated-memory-hask&zwnj;&#8203;ell</a>. As your traversal in particular is possible with (depth) nodes in memory, then you could write your own stack-based traversal with manual allocation (I suppose) which would fulfil your requirements."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1556099579, "post_id": 55822008, "comment_id": 98319248, "body": "The question is IMHO ill-posed. Suppose a tree is stored on disk as a text file in-order. Then I don&#39;t even need to keep more than one node at a time in main memory, I just copy the file as is. Now if it is stored as a pre-order or a post-order, how would you do what is asked in any language?"}], "answers": [{"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 3, "last_activity_date": 1567760350, "last_edit_date": 1567760350, "creation_date": 1556103056, "answer_id": 55828337, "question_id": 55822008, "link": "https://stackoverflow.com/questions/55822008/how-to-iterate-over-tree-with-memory-limit-in-haskell/55828337#55828337", "title": "How to iterate over tree with memory limit in Haskell?", "body": "<p>If the iterator loads part of the tree each time it is incremented then there are two options:</p>\n\n<ol>\n<li><p>It exists in the IO monad and works just like in an imperative language.</p></li>\n<li><p>It is exploiting laziness and interleaved IO. This is the approach taken by functions like <code>readFile</code> which give you the entire contents of a file as one lazy list. The actual file is read on-demand as your application traverses the list.</p></li>\n</ol>\n\n<p>The latter option is the interesting one here.</p>\n\n<p>The tricky part of lazy lists is retainers. Suppose your file contains a list of numbers. If you compute the sum like this</p>\n\n<pre><code>nums &lt;- map read . lines &lt;$&gt; readFile \"numbers.txt\"\nputStrLn $ \"The total is \" &lt;&gt; show (sum nums)\n</code></pre>\n\n<p>then the program will run in constant space. But if you want the average:</p>\n\n<pre><code>putStrLn $ \"The average is \" &lt;&gt; show (sum nums / fromIntegral (length nums))\n</code></pre>\n\n<p>then the program will load the entire file into memory. This is because it has to traverse the list twice, once to compute the sum and once to compute the length. It can only do this by holding the entire list.</p>\n\n<p>(The solution is to compute the sum and length in parallel within one pass. But that's beside the point here).</p>\n\n<p>The challenge for the tree problem you pose is to come up with an approach to iteration which avoids retaining the tree.</p>\n\n<p>Lets assume that each node in the file contains offsets in the file for the left and right child nodes. We can write a function in the IO monad which seeks to an offset and reads the node there.</p>\n\n<pre><code>data MyNode = MyNode Int Int .....  -- Rest of data to be filled in.\n\nreadNodeData :: Handle -&gt; Int -&gt; IO MyNode\n</code></pre>\n\n<p>From there it would be simple to write a function which traverses the entire file to create a <code>Tree MyNode</code>. If you implement this using <a href=\"https://en.wikipedia.org/wiki/Futures_and_promises\" rel=\"nofollow noreferrer\"><code>unsafeInterleaveIO</code></a> then you can get a tree which is read lazily as you traverse it.</p>\n\n<p><code>unsafeInterleaveIO</code> is unsafe because you don't know when the IO will be done. You don't even know what order it will happen in, because it only happens when the value is forced during evaluation. In this way its like the \"<a href=\"https://en.wikipedia.org/wiki/Futures_and_promises\" rel=\"nofollow noreferrer\">promise</a>\" structures you get in some other languages. In this particular case this isn't a problem because we can assume the file doesn't change during the evaluation.</p>\n\n<p>Unfortunately this doesn't solve the problem because the entire tree will be held in memory by the time you finish. Your traversal <em>has</em> to retain the root, at least as long as its traversing the left side, and as long as it does so it will retain the whole of the rest of the tree.</p>\n\n<p>The solution is to rewrite the IO part to return a list instead of a tree, something like this:</p>\n\n<pre><code>readNode :: Handle -&gt; Int -&gt; IO [MyNode]\nreadNode _ (-1) = return []      -- Null case for empty child.\nreadNode h pos = unsafeInterleaveIO $ do\n    n &lt;- readNodeData h pos   -- Needs to be defined elsewhere.\n    lefts &lt;- readNode (leftChild n)\n    rights &lt;- readNode (rightChild n)\n    return $ lefts ++ [n] ++ rights\n</code></pre>\n\n<p>This returns the entire tree as a lazy list. As you traverse the list the relevant nodes will be read on demand. As long as you don't retain the list (see above) your program will not need to hold anything more than the current node and its parents.</p>\n"}], "owner": {"reputation": 674, "user_id": 7478655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/UL7XU.jpg?s=128&g=1", "display_name": "vrom911", "link": "https://stackoverflow.com/users/7478655/vrom911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1567760350, "creation_date": 1556076717, "last_edit_date": 1592644375, "question_id": 55822008, "link": "https://stackoverflow.com/questions/55822008/how-to-iterate-over-tree-with-memory-limit-in-haskell", "title": "How to iterate over tree with memory limit in Haskell?", "body": "<p>I know that there is a solution for iterating through the <code>Tree</code> using <code>Zipper</code>s (see details <a href=\"http://learnyouahaskell.com/zippers\" rel=\"nofollow noreferrer\">here</a>). Though it is not clear for me whether it is possible to apply memory constraints to this approach.</p>\n<h2>Context</h2>\n<p>I was given the following problem to solve in Haskell:</p>\n<blockquote>\n<p>Design an iterator that will iterate through a binary tree in-order.</p>\n<p>Assume the binary tree is stored on disk and can contain up to 10 levels, and therefore can contain up to (2^10 - 1) nodes, and we can store at most 100 nodes in memory at any given time.</p>\n<p>The goal of this iterator is to load a small fraction of the binary tree from disk to memory each time it's incremented, so that we don't need to load the entire tree into\nmemory all at once.</p>\n</blockquote>\n<p>I assumed that the memory part is not possible to represent in Haskell, but I was told that it is not true.</p>\n<p><strong>Question:</strong> what can be used in Haskell to achieve that memory behaviour? Any suggestions, approaches and directions are appreciated. This is just out of curiosity, I've already failed at solving this problem.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 9, "creation_date": 1556069559, "post_id": 55821151, "comment_id": 98308407, "body": "It doesn&#39;t really boil down to <code>Nothing + 3</code> because you aren&#39;t passing directly <code>Nothing</code> to the lambda (as in <code>(\\x -&gt; Just $ x + 3) Nothing</code>). You have to consider what <code>&gt;&gt;=</code> does with <code>Maybe</code>-values."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1556102009, "post_id": 55821151, "comment_id": 98320628, "body": "IOW, because <code>=&lt;&lt;</code> is not <code>$</code>."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1556109216, "post_id": 55821208, "comment_id": 98324940, "body": "Perhaps more clearly, the <code>Nothing</code> case can be written as <code>Nothing &gt;&gt;= _ = Nothing</code> to emphasize that the right-hand operand is ignored."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1556117655, "post_id": 55821208, "comment_id": 98330635, "body": "@chepner I have considered that, but decided that it may actually prove confusing, because now I also need to explain what an underscore means, and that it&#39;s not part of the magic."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 20, "last_activity_date": 1556079200, "last_edit_date": 1556079200, "creation_date": 1556069935, "answer_id": 55821208, "question_id": 55821151, "link": "https://stackoverflow.com/questions/55821151/how-does-haskell-know-to-retain-nothing-as-nothing-when-passed-to-a-lambda-that/55821208#55821208", "title": "How does Haskell know to retain Nothing as nothing when passed to a lambda that returns Just x?", "body": "<p>When you write <code>Nothing &gt;&gt;= (\\x -&gt; Just $ x + 3)</code>, this is not at all the same as <code>Just $ Nothing + 3</code>. You're not actually passing <code>Nothing</code> as the value of <code>x</code>. </p>\n\n<p>Instead, you're calling operator <code>&gt;&gt;=</code>, and you're passing into it two arguments: <code>Nothing</code> on the left and the lambda expression on the right.</p>\n\n<p>Therefore, the result of this expression would be determined by the definition of operator <code>&gt;&gt;=</code>. Let's take a look at <a href=\"https://www.stackage.org/haddock/lts-13.18/base-4.12.0.0/src/GHC-Base.html#line-854\" rel=\"noreferrer\">how it is defined for <code>Maybe</code></a>:</p>\n\n<pre><code>(Just x) &gt;&gt;= f  =  f x\nNothing  &gt;&gt;= f  =  Nothing\n</code></pre>\n\n<p>As you can see, when passed <code>Nothing</code> as left argument, operator <code>&gt;&gt;=</code> simply returns <code>Nothing</code> right away, and doesn't even bother with the function that is passed as right argument.</p>\n"}], "owner": {"reputation": 1185, "user_id": 3228230, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/m9lny.jpg?s=128&g=1", "display_name": "paperduck", "link": "https://stackoverflow.com/users/3228230/paperduck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 55821208, "answer_count": 1, "score": 4, "last_activity_date": 1556079200, "creation_date": 1556069233, "question_id": 55821151, "link": "https://stackoverflow.com/questions/55821151/how-does-haskell-know-to-retain-nothing-as-nothing-when-passed-to-a-lambda-that", "title": "How does Haskell know to retain Nothing as nothing when passed to a lambda that returns Just x?", "body": "<p>I'm just trying to understand why this doesn't error:</p>\n\n<pre><code>Prelude&gt; Nothing &gt;&gt;= (\\x -&gt; Just $ x + 3)\nNothing\n</code></pre>\n\n<p>If I break the lambda down into individual steps:</p>\n\n<pre><code>Prelude&gt; Nothing + 3\n\n&lt;interactive&gt;:8:1: error:\n    \u2022 Non type-variable argument in the constraint: Num (Maybe a)\n      (Use FlexibleContexts to permit this)\n    \u2022 When checking the inferred type\n        it :: forall a. Num (Maybe a) =&gt; Maybe a\n</code></pre>\n\n<p>and</p>\n\n<pre><code>Prelude&gt; Just Nothing\nJust Nothing\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1556060468, "post_id": 55820450, "comment_id": 98307252, "body": "<code>True &amp;&amp; True</code> is the same as just <code>True</code>. A guard expression of <code>| True</code> always succeeds; it&#39;s like having no guard at all: <code>eval (Or e1 e2) = True</code>."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1556060697, "post_id": 55820450, "comment_id": 98307291, "body": "I&#39;m unclear what <code>SecondExpr</code> is for. You probably want eg. <code>eval (Or e1 e2) = eval e1 || eval e2</code> rather than what you&#39;ve written, which is constant <code>True</code>. For <code>EqualTo</code>, you&#39;ll need an <code>eval&#39;</code> on <code>Expr</code> to some equatable type, then just <code>eval (EqualTo e1 e2) = eval&#39; e1 == eval&#39; e2</code> (and you can see how to easily adapt that for <code>LessThan</code>). This also solves the issue of combinatorial explosion you observed, though as I said the overall design seems questionable but hard to be more helpful without more context."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 5, "last_activity_date": 1556062524, "last_edit_date": 1556062524, "creation_date": 1556061029, "answer_id": 55820564, "question_id": 55820450, "link": "https://stackoverflow.com/questions/55820450/evaluating-a-nested-data-type/55820564#55820564", "title": "Evaluating a nested data type", "body": "<p>You're going to need two evaluation functions:</p>\n\n<pre><code>evalNum :: Expr -&gt; Int\n</code></pre>\n\n<p>and</p>\n\n<pre><code>evalBool :: SecondExpr -&gt; Bool\n</code></pre>\n\n<p>Neither of them should use any guards (<code>| ...</code>).</p>\n\n<p>For example, <code>evalBool</code> would look like this:</p>\n\n<pre><code>evalBool (Lit n) = n\nevalBool (Or e1 e2) = evalBool e1 || evalBool e2\nevalBool (EqualTo e1 e2) = evalNum e1 == evalNum e2\nevalBool (LessThan e1 e2) = evalNum e1 &lt; evalNum e2\n</code></pre>\n\n<p>Subexpressions are evaluated recursively with their corresponding <code>eval</code> functions, and the results are combined using appropriate Haskell operators (such as <code>||</code>, <code>==</code>, <code>&lt;</code>).</p>\n\n<p>Implementing <code>evalNum</code> is left as an exercise for the reader.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 55820564, "answer_count": 1, "score": 1, "last_activity_date": 1556062524, "creation_date": 1556060085, "last_edit_date": 1556062345, "question_id": 55820450, "link": "https://stackoverflow.com/questions/55820450/evaluating-a-nested-data-type", "title": "Evaluating a nested data type", "body": "<p>I'm trying to write a function that evaluates a nested boolean data type. My issue comes from comparing a data type within a data type. The first two (Lit and Or) compile fine but I don't understand how to incorporate the first type into the function of the SecondExpr. As I type it out, I feel like I'm taking the longest way possible when something shorter works.</p>\n\n<p>Here are the two data types.</p>\n\n<pre><code>data Expr = Val Int\n          | Add Expr Expr\n          | Sub Expr Expr\n          | Mul Expr Expr\n          | Div Expr Expr\n          | If SecondExpr Expr Expr\n\ndata SecondExpr = Lit Bool\n                | Or SecondExpr SecondExpr \n                | EqualTo Expr Expr\n                | LessThan Expr Expr\n</code></pre>\n\n<p>(Another issue I'm having is creating examples of SecondExpr to test because, conceptually, I see every Expr as the 6 different types of Expr. That means, for every Expr Expr there would be hundreds of guards.)</p>\n\n<p>Below is the code so far:</p>\n\n<pre><code>eval :: SecondExpr -&gt; Bool\neval (Lit n)                   = n\neval (Or e1 e2)\n  | True &amp;&amp; True               = True\n  | True &amp;&amp; False              = True\n  | False &amp;&amp; True              = True\n  | otherwise                  = False\neval (EqualTo e1 e2)\n  | (Add e1 e2) == (Add e1 e2) = True\n  | (Sub e1 e2) == (Sub e1 e2) = True\n  | (Mul e1 e2) == (Mul e1 e2) = True\n  | (Div e1 e2) == (Div e1 e2) = True\n  | otherwise                  = False\neval (LessThan e1 e2)\n  | (Add e1 e2) == (Add e1 e2) = True\n  | (Sub e1 e2) == (Sub e1 e2) = True\n  | (Mul e1 e2) == (Mul e1 e2) = True\n  | (Div e1 e2) == (Div e1 e2) = True\n  | otherwise                  = False\n</code></pre>\n\n<p>This is the error I get:</p>\n\n<pre><code>    * No instance for (Eq Expr) arising from a use of `=='\n    * In the expression: (Add e1 e2) == (Add e1 e2)\n      In a stmt of a pattern guard for\n                     an equation for `eval':\n        (Add e1 e2) == (Add e1 e2)\n      In an equation for `eval':\n          eval (EqualTo e1 e2)\n            | (Add e1 e2) == (Add e1 e2) = True\n            | (Sub e1 e2) == (Sub e1 e2) = True\n            | (Mul e1 e2) == (Mul e1 e2) = True\n            | (Div e1 e2) == (Div e1 e2) = True\n            | otherwise = False\n   |\n24 |   | (Add e1 e2)       == (Add e1 e2) = True\n   |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>So I know my syntax is wrong but how do you substitute an Expression within the function of an Expression?</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 3085, "user_id": 4040600, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/B4ER6.png?s=128&g=1", "display_name": "&#201;amonn Olive", "link": "https://stackoverflow.com/users/4040600/%c3%89amonn-olive"}, "edited": false, "score": 0, "creation_date": 1556060047, "post_id": 55820419, "comment_id": 98307148, "body": "Doesn&#39;t your python code (and your haskell code for that matter), put every entry in the result twice?  For example outputting <code>[2,2,3,3]</code> instead of <code>[2,3]</code>.  Wouldn&#39;t it be better to just check if the <code>x</code> appears in <code>xs</code> exactly once to avoid duplication?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1556060067, "post_id": 55820419, "comment_id": 98307152, "body": "Please add your <code>occursTwice</code> function (both the Python and Haskell versions) to your question."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1556060301, "post_id": 55820419, "comment_id": 98307209, "body": "I believe your Haskell version should have <code>checksTwice</code> to the right of the equals sign in both the last 2 lines, instead of <code>occursTwice</code>"}, {"owner": {"reputation": 105, "user_id": 11091357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22dccf8dd26dd3508969d61a30f4646f?s=128&d=identicon&r=PG&f=1", "display_name": "SadisticSardines", "link": "https://stackoverflow.com/users/11091357/sadisticsardines"}, "edited": false, "score": 0, "creation_date": 1556060347, "post_id": 55820419, "comment_id": 98307217, "body": "I chose occursTwice just as an example for over here. I just want to know how to iterate over the list and call a function passing each element as well as the list as argument.  Assume it to be occursOnce to make it simpler. Then the first one will result in a result if i check x in xs."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1556060519, "post_id": 55820419, "comment_id": 98307262, "body": "&quot;passing the same argument twice is redundant&quot; - this is not true, because the first argument of <code>checksTwice</code> changes and the second does not. The two arguments serve different purposes, and you do different things with them; it just so happens they have the same value at the top-level call. Another way to write <code>checksTwice</code> is <code>\\lst -&gt; filter (flip occursTwice lst) lst</code>. Why are you compelled to make your Haskell code &quot;like&quot; (i.e. superficially similar to) your Python code?"}, {"owner": {"reputation": 105, "user_id": 11091357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22dccf8dd26dd3508969d61a30f4646f?s=128&d=identicon&r=PG&f=1", "display_name": "SadisticSardines", "link": "https://stackoverflow.com/users/11091357/sadisticsardines"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1556060530, "post_id": 55820419, "comment_id": 98307263, "body": "Thanks @RobinZigmond for catching that. I wrote that on the fly above for stackoverflow and missed that."}, {"owner": {"reputation": 105, "user_id": 11091357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22dccf8dd26dd3508969d61a30f4646f?s=128&d=identicon&r=PG&f=1", "display_name": "SadisticSardines", "link": "https://stackoverflow.com/users/11091357/sadisticsardines"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1556060911, "post_id": 55820419, "comment_id": 98307336, "body": "@user2407038 I agree it doesn&#39;t mean that it is redundant. However, passing the same argument twice just doesn&#39;t feel right to me internally. The reasoning behind wanting it to be similar is that it will help me grasp haskell better. I wanted to use my own logic to solve the question.  So I am to assume that there is no way to achieve <code>for x in lst: fun(x,lst)</code> with just lst as argument easily? If not, that&#39;s a bummer. I just wanted to reduce the extra helper function call that i am making."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1556061700, "post_id": 55820419, "comment_id": 98307513, "body": "@SyedShariqAli The core of the problem is viewing this function call as &quot;extra&quot;. Haskell has no iteration, only recursion. Furthermore, a recursive function with a starting condition is implemented by having a helper function to which you pass the initial value. Note that in both Haskell and Python this function can be implemented with code in which <code>input</code> syntactically appears exactly twice. You given code in both languages which does this."}], "answers": [{"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 3, "last_activity_date": 1556060617, "creation_date": 1556060617, "answer_id": 55820511, "question_id": 55820419, "link": "https://stackoverflow.com/questions/55820419/how-do-i-achieve-x-if-funcx-lst-for-x-in-list-in-haskell/55820511#55820511", "title": "How do i achieve [x if func(x,lst) for x in list] in haskell?", "body": "<p>The simplest, and probably most idiomatic, way to write this function in Haskell would be to use <code>filter</code>:</p>\n\n<pre><code>checksTwice :: (Eq a) =&gt; [a] -&gt; [a] -- you can keep it as [Int] -&gt; [Int] if you like, but this more general type signature is better because the function works on any type that can be compared for equality\nchecksTwice xs = filter (\\x -&gt; occursTwice x xs) xs\n</code></pre>\n\n<p>Or if you prefer (although the gain is debatable), rewriting the lambda in \"point-free\" style:</p>\n\n<pre><code>checksTwice :: (Eq a) =&gt; [a] -&gt; [a]\nchecksTwice xs = filter (flip occursTwice xs) xs\n</code></pre>\n\n<p>(Which is exactly the answer suggested in the comments by @user2407038 - apologies for \"stealing\" your answer)</p>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 11091357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22dccf8dd26dd3508969d61a30f4646f?s=128&d=identicon&r=PG&f=1", "display_name": "SadisticSardines", "link": "https://stackoverflow.com/users/11091357/sadisticsardines"}, "edited": false, "score": 0, "creation_date": 1556061134, "post_id": 55820516, "comment_id": 98307384, "body": "Can you explain the code a bit as well? This seems cool. I&#39;ll check list comprehensions out. Thanks"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 105, "user_id": 11091357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22dccf8dd26dd3508969d61a30f4646f?s=128&d=identicon&r=PG&f=1", "display_name": "SadisticSardines", "link": "https://stackoverflow.com/users/11091357/sadisticsardines"}, "edited": false, "score": 0, "creation_date": 1556062265, "post_id": 55820516, "comment_id": 98307639, "body": "Is there something particular you&#39;d like me to talk about? They are both anonymous functions (lambdas) that take two variables: the predicate, which you called <code>f</code>; and the list, which I am calling <code>xs</code> in the Haskell tradition."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 105, "user_id": 11091357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22dccf8dd26dd3508969d61a30f4646f?s=128&d=identicon&r=PG&f=1", "display_name": "SadisticSardines", "link": "https://stackoverflow.com/users/11091357/sadisticsardines"}, "edited": false, "score": 2, "creation_date": 1556092451, "post_id": 55820516, "comment_id": 98315064, "body": "@SadisticSardines <code>[x | x &lt;- lst, func x lst]</code> is the direct translation of Python&#39;s <code>[x if func(x,lst) for x in list]</code>. <code>&lt;-</code> takes the place of <code>for...in</code>, and conditions are written without an <code>if</code>."}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 6, "last_activity_date": 1556060643, "creation_date": 1556060643, "answer_id": 55820516, "question_id": 55820419, "link": "https://stackoverflow.com/questions/55820419/how-do-i-achieve-x-if-funcx-lst-for-x-in-list-in-haskell/55820516#55820516", "title": "How do i achieve [x if func(x,lst) for x in list] in haskell?", "body": "<p>Haskell has list comprehensions, so you can do:</p>\n\n<pre><code>\\f xs -&gt; [x | x &lt;- xs, f x xs]\n</code></pre>\n\n<p>You can also do this with a filter:</p>\n\n<pre><code>\\f xs -&gt; filter (\\x -&gt; f x xs) xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1556060713, "creation_date": 1556060713, "answer_id": 55820528, "question_id": 55820419, "link": "https://stackoverflow.com/questions/55820419/how-do-i-achieve-x-if-funcx-lst-for-x-in-list-in-haskell/55820528#55820528", "title": "How do i achieve [x if func(x,lst) for x in list] in haskell?", "body": "<p>Well just like you did in your Python you'd want to have the variable <code>lst</code> only visible to the function <code>checksTwice</code> and not a parameter.  Haskell throws some people for a loop what with it's lack of looping primitives - the solution is usually a helper function of a higher order function.</p>\n\n<pre><code>checksOnce :: [Int] -&gt;  [Int]\nchecksOnce xs = go xs xs\n  where go [] _ = []\n        go (x:xs) lst\n          | occursOnce x lst = x : go xs lst\n          | otherwise = go xs lst\n</code></pre>\n\n<p>But this pattern, including <code>x</code> if and only if <code>f x</code> is just a filter so...</p>\n\n<pre><code>checksOnce x = filter (`occursOnce` lst) xs\n</code></pre>\n\n<p>As @RobinZigmond noted, this still has a bug vs the behavior you desire.</p>\n"}], "owner": {"reputation": 105, "user_id": 11091357, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22dccf8dd26dd3508969d61a30f4646f?s=128&d=identicon&r=PG&f=1", "display_name": "SadisticSardines", "link": "https://stackoverflow.com/users/11091357/sadisticsardines"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 55820516, "answer_count": 3, "score": 0, "last_activity_date": 1556060713, "creation_date": 1556059805, "last_edit_date": 1556060461, "question_id": 55820419, "link": "https://stackoverflow.com/questions/55820419/how-do-i-achieve-x-if-funcx-lst-for-x-in-list-in-haskell", "title": "How do i achieve [x if func(x,lst) for x in list] in haskell?", "body": "<p>Okay so I come from a python background and am new with haskell and doing an assignment. I am done with the question itself but my logic/code looks ugly and wanted to know of ways to improve it. What I want to do is iterate over a list with that list as argument to call another function.</p>\n\n<p>Assuming that I want to achieve the following in haskell.</p>\n\n<pre><code>input = [1,2,2,3,3,4,5]\noutput = [1,4,5] #occurs Once\n</code></pre>\n\n<p>so i want to go from <code>x-&gt;y</code></p>\n\n<p>normally how I'd do it would be</p>\n\n<pre><code>def checksOnce(input):\n  lst = []\n  for val in input:\n    if occursOnce(val,input):\n      lst.append(val)\n  print(lst)\n</code></pre>\n\n<p>How do i do that iterating in haskell? I have a function that works fine for occursOnce which takes a value and list and returns a bool just like python. </p>\n\n<pre><code>checksOnce :: [Int] -&gt; [Int] -&gt; [Int]\nchecksOnce [] lst = []\nchecksOnce (x:xs) lst\n  | occursOnce x lst = [x] ++ checksOnce xs lst\n  | otherwise = checksOnce xs lst\n</code></pre>\n\n<p>and something like <code>mainFunc lst = checksOnce lst lst</code> to call the above function.</p>\n\n<p>The above works fine and is sufficient as far as my hw goes, but passing the same argument Once is redundant! How do i go from <code>checksOnce :: [Int] -&gt; [Int] -&gt; [Int]</code> to <code>checksOnce :: [Int] -&gt; [Int]</code> and use just one list to iterate over like the above python code instead of passing the same list Once to the function?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "cabal", "ghci"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1556056606, "post_id": 55819935, "comment_id": 98306285, "body": "Using <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">stack</a> is probably a good idea here. It acts a bit like a virtual environment like Python, but actually it does more since you also specify the &quot;build plan&quot;, etc."}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1556057502, "post_id": 55819935, "comment_id": 98306548, "body": "If you&#39;re building with cabal, you can specify package version in the .cabal file eg. see <a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html\" rel=\"nofollow noreferrer\">haskell.org/cabal/users-guide/developing-packages.html</a> section 3.1.4"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1556059635, "post_id": 55819935, "comment_id": 98307076, "body": "The recommended ways of managing packages nowadays are either through Stack (see @WillemVanOnsem &#39;s comment above) or through <a href=\"https://www.haskell.org/cabal/users-guide/nix-local-build-overview.html\" rel=\"nofollow noreferrer\">cabal-install&#39;s set of <code>new-*</code> commands</a> (as opposed to the old commands like <code>cabal build</code>, which I guess you have been using up to now). Given that you are on Windows, Stack might be the easier option to set up."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1556060162, "post_id": 55819935, "comment_id": 98307178, "body": "As for your concrete problem, since Win32 is a core GHC library it cannot be easily replaced. That being so, you&#39;ll probably want to start using Stack (or, alternatively, remove the 2.3.1.1 version and start using the cabal-install <code>new-*</code> commands) and specify that you want to use 2.3.1.1 in your specific project only. Another possibility is doing what @ATayler alludes to: depending on your own version of <code>Clipboard</code> that accepts Win32-2.6 (both Stack and recent versions cabal-install have support for that)."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1556092835, "post_id": 55819935, "comment_id": 98315293, "body": "I haven&#39;t reproduce your error but, recently, I have install Clipboard-2.3.2.0 using stack <code>lts-12.14</code> and It worked fine. Recall that this <code>lts</code> works with <code>ghc-8.4.3</code>. you might be using another version of <code>ghc</code>"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1570862637, "creation_date": 1570862637, "answer_id": 58351594, "question_id": 55819935, "link": "https://stackoverflow.com/questions/55819935/resolving-i-found-a-duplicate-for-symbol/58351594#58351594", "title": "Resolving &#39;I found a duplicate for symbol...&#39;", "body": "<p>The best approach is to update the library yourself to work with a newer version of <code>Win32</code> or to ask the author to do so for you.</p>\n"}], "owner": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570862637, "creation_date": 1556056435, "question_id": 55819935, "link": "https://stackoverflow.com/questions/55819935/resolving-i-found-a-duplicate-for-symbol", "title": "Resolving &#39;I found a duplicate for symbol...&#39;", "body": "<p>I'm trying to install System.Clipboard (<a href=\"http://hackage.haskell.org/package/Clipboard-2.3.2.0\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/Clipboard-2.3.2.0</a>) which has a dependency of Win32 >=2.2.0.0 &amp;&amp; &lt;2.4. I've successfully installed it but when trying to utilise the library im hit with the error message of duplicate symbol.</p>\n\n<p>After reading about it I've learnt that only one of the libraries should be installed; namely, Win32-2.3.1.1 and Win32-2.6.1.0 are installed. If I remove 2.6.1.0, it will break multitudes of libraries (ghci, cabal, pretty much everything), but if I remove 2.3.1.1 I can't use the library. </p>\n\n<p>I've also read about sandboxes, however if I install the library into a sandbox I can no longer import it into and use in my project. </p>\n\n<p>My question is, is there any way I can specify that I want to utilise the 2.3.1.1 library? Or what can I do in this case?</p>\n\n<p>Im on Windows</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1556048891, "post_id": 55818077, "comment_id": 98303198, "body": "The fragments are mostly correct. It looks like the desired <code>countElem</code> just got interleaved with something like <code>filter</code>."}, {"owner": {"reputation": 1378, "user_id": 2778405, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/704439289/picture?type=large", "display_name": "Jamie Marshall", "link": "https://stackoverflow.com/users/2778405/jamie-marshall"}, "edited": false, "score": 1, "creation_date": 1556049689, "post_id": 55818077, "comment_id": 98303517, "body": "This seems a little broad to me and doesn&#39;t really display a basic understanding of Haskell.  I&#39;m wondering if a tutorial sight might be a better resource for you than StackOverflow at the moment.  Best of luck."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1556051246, "post_id": 55818077, "comment_id": 98304233, "body": "Well, <code>fre1 == fre3</code> is wrong, since <code>fre1 :: Int</code> and <code>fre3 :: [Int]</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1556051536, "post_id": 55818077, "comment_id": 98304339, "body": "@HTNW: no, the fragment is wrong several times. For example the code hints that the result should be an <code>Int</code>, but the first line returns a list <code>[]</code>. As for the second line, that hints that <code>fre3</code> should be a list as well, but if we take a look to the body, we check if <code>fre1 == fre3</code>, hence we check if the elements are the same, etc."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1556052853, "post_id": 55818077, "comment_id": 98304934, "body": "@WillemVanOnsem I was writing an answer before @n.m. posted theirs, and as I saw it, it seemed like the second argument was omitted in the first equation because it was ignored, and <code>[]</code> returned because it and <code>0</code> are both &quot;empty&quot;. The LHSs demonstrated an understanding of pattern-matching, and they seemed to know about recursion and how to consume lists. Yes, the code and formatting was rather borked, but there was a clear specification and the code made a lot more sense with it. It&#39;s a lot better than some of the other&#39;s beginners&#39; questions under this tag, and it does us well to be nice."}, {"owner": {"reputation": 13760, "user_id": 10795151, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eazk7.png?s=128&g=1", "display_name": "S.S. Anne", "link": "https://stackoverflow.com/users/10795151/s-s-anne"}, "edited": false, "score": 0, "creation_date": 1556054807, "post_id": 55818077, "comment_id": 98305711, "body": "What&#39;s the error?"}], "answers": [{"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 3, "last_activity_date": 1556051844, "last_edit_date": 1556051844, "creation_date": 1556049815, "answer_id": 55818622, "question_id": 55818077, "link": "https://stackoverflow.com/questions/55818077/using-lists-in-haskell/55818622#55818622", "title": "Using lists in Haskell", "body": "<p>Here is a possible definition explained item by item.</p>\n\n<p>I will omit the type. You <em>can</em> give this function the type of <code>[Int]-&gt;[Int]-&gt;Int</code> if you want, but it's not the best possible type. The compiler is able to infer the best type for you.</p>\n\n<p>There are two parts in the definition, one for the empty list and one for non-empty lists.</p>\n\n<p>How many elements are in an empty list? Zero. How many of those are equal to any given value? Also zero.</p>\n\n<pre><code>lefgNLista [] _ = 0\n--         []             \u21d2 the empty list\n--            _           \u21d2 \"any given element\", we are not looking at it, hence no name\n--              =         \u21d2 \"is defined as\"\n--                0       \u21d2 that's zero\n</code></pre>\n\n<p>OK now let's look at a non-empty list. This part has two further cases. We look at the first element of the list. Either it equals to what we are counting, or not.</p>\n\n<pre><code>lefgNLista (x:xs) y | x == y = 1 + lefgNLista xs y\n                    | otherwise =  lefgNLista xs y\n--         (x:xs)                                  \u21d2 A customary way to name a list pattern\n--                y                                \u21d2 The value we want to count\n--                  |                              \u21d2 Pronounced \"when\"\n--                    x == y                       \u21d2 Self evident\n--                           =                     \u21d2 \"is defined as\"\n--                             1 + lefgNLista xs y \u21d2 Compute for the rest of list and add 1\u00a0\n--                  | otherwise =                  \u21d2 Self evident\n--                                 lefgNLista xs y \u21d2 Just compute for the rest of list\n</code></pre>\n\n<p>So what is the type of this inferred by Haskell?</p>\n\n<pre><code>Prelude \u03bb :t lefgNLista\nlefgNLista :: (Num p, Eq t) =&gt; [t] -&gt; t -&gt; p\n</code></pre>\n\n<p>This is not as intimidating as it seems. You can read this as \"when <code>p</code> is some kind of number, and <code>t</code> is some kind of stuff you can check for equality, the type is <code>[t] -&gt; t -&gt; p</code>\". So this function works for <code>Int</code>, <code>Double</code>, <code>(Int, Int)</code> or any other type you can compare \u2014 even for other lists!</p>\n\n<pre><code>Prelude \u03bb lefgNLista [[1,2], [3,5], [1,2]] [1,2]\n2\n</code></pre>\n\n<p>What about <code>Num p</code>? <code>Int</code> is not the only type you can count with. You may need <code>Integer</code> if your lists are <em>extremely</em> long, or you may want to use your own fancy number-like type, but this is probably way too advanced at this point.</p>\n"}], "owner": {"reputation": 43, "user_id": 11401522, "user_type": "registered", "profile_image": "https://graph.facebook.com/2370529442965418/picture?type=large", "display_name": "Freyre Gonzalez", "link": "https://stackoverflow.com/users/11401522/freyre-gonzalez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1556051844, "creation_date": 1556047299, "last_edit_date": 1556050307, "question_id": 55818077, "link": "https://stackoverflow.com/questions/55818077/using-lists-in-haskell", "title": "Using lists in Haskell", "body": "<p>I'm trying to learn list in Haskell but I have a error that I don't understand</p>\n\n<p>I've been trying to definition arguments, but honestly I don't understand too much of haskell yet.</p>\n\n<pre><code>lefgNLista:: [Int]-&gt;[Int]-&gt;Int\nlefgNLista []=[]\nlefgNLista (fre1:fre2) fre3  = if fre1 == fre3 then 1+lefgNLista else fre1 : lefgNLista fre2\n</code></pre>\n\n<p>Also tried like this but got another error</p>\n\n<pre><code>lefgNLista []=[]=0\n</code></pre>\n\n<p>I expect the function to count the amount of N numbers in the list, e.g. </p>\n\n<pre><code>ghci&gt; lefgNLista [1,3,5,7,8,8,2,3,8] 8 \n3\n</code></pre>\n"}, {"tags": ["json", "haskell", "text", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1556050087, "post_id": 55818243, "comment_id": 98303701, "body": "Thank you.  This gives me <code>&lt;interactive&gt;:8:35: error:     Ambiguous occurrence \u2018toLower\u2019</code>  What is the customary alias given to the import of Data.Char?  I have Prelude, Data.Text, Data.ByteString as BS, Data.Text.Lazy.IO as I. Half a dozen other string conversions.  I am still learning, but I have yet to find a problem that hasn&#39;t required me to import and juggle every string library possible, unfortunately."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1556050244, "post_id": 55818243, "comment_id": 98303781, "body": "@Mittenchops: you can just hide the <code>toLower</code> of your <code>Text</code>, for example with <code>import Data.Text hiding (toLower)</code>."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1556050336, "post_id": 55818243, "comment_id": 98303821, "body": "But that would prevent me from using it, right? I am using it in other places of my program."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 1, "creation_date": 1556050381, "post_id": 55818243, "comment_id": 98303842, "body": "@Mittenchops: well you can define two import statements: <code>import Data.Text hiding (toLower)</code> and <code>import qualified Data.Text as T</code> for example. Or just import the <code>Data.Char</code> in a qualified way."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1556171872, "post_id": 55818243, "comment_id": 98347935, "body": "Thank you.  This is very helpful.  I&#39;m confused by this <code>Note: As for the smart constructor, you can simplify this expression to:      makeR3 = R3</code> My understanding was that making functions that create data types was preferable to just using the naked data type itself.  Is that not the case?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 1, "creation_date": 1556176110, "post_id": 55818243, "comment_id": 98349707, "body": "@Mittenchops: a smart constructor is typically used to (a) prevent exporting the data constructor, and thus preventing a user of the module to <i>unpack</i> a constructor, which here is still done, and (b) to do pre-processing an validation, but here you did not write any pre-processing or validation logic. Hence we can define the <code>makeR3</code> function as <code>makeR3 = R3</code>. But we can not use this function to <i>unpack</i> data."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1556208218, "post_id": 55818243, "comment_id": 98368535, "body": "Thank you!  This is helpful!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1556050949, "last_edit_date": 1556050949, "creation_date": 1556048107, "answer_id": 55818243, "question_id": 55818022, "link": "https://stackoverflow.com/questions/55818022/functionally-changing-key-names-in-serialization-to-aeson-with-text-keys/55818243#55818243", "title": "Functionally changing key names in serialization to aeson with Text keys", "body": "<p>You compose two function <code>T.toLower</code> and <code>drop 3</code>, but the types do not match. Indeed, if we lookup the types, we see <a href=\"https://hackage.haskell.org/package/text-1.2.3.1/docs/Data-Text.html#v:toLower\" rel=\"nofollow noreferrer\"><strong><code>toLower :: Text -&gt; Text</code></strong></a> and <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:drop\" rel=\"nofollow noreferrer\"><strong><code>drop :: Int -&gt; [a] -&gt; [a]</code></strong></a>. A <code>String</code> is a list of <code>Char</code>s, but <code>Text</code> is not: a <code>Text</code> can be seen as a packed \"block\" of characters.</p>\n\n<p>We can however compose a function of type <code>String -&gt; String</code>, the type of the field <a href=\"http://hackage.haskell.org/package/aeson-1.4.2.0/docs/src/Data.Aeson.Types.Internal.html#fieldLabelModifier\" rel=\"nofollow noreferrer\"><code>fieldLabelModifier :: String -&gt; String</code></a>:</p>\n\n<pre><code>import Data.Char(toLower)\n\ninstance ToJSON R3 where\n    toJSON = genericToJSON defaultOptions {\n            fieldLabelModifier = <b>map toLower</b> . drop 3\n        }</code></pre>\n\n<p>We thus use the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Char.html#v:toLower\" rel=\"nofollow noreferrer\"><strong><code>toLower :: Char -&gt; Char</code></strong></a> function of the <code>Data.Char</code> module, and perform a <code>map</code>ping, such that all characters in the string are mapped.</p>\n\n<p>Note that if you simply want to derive <code>FromJson</code> and <code>ToJSON</code> with different options, you can make use of <em>template Haskell</em>, like:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric, TemplateHaskell #-}\n\nimport Data.Char(toUpper)\nimport Data.Aeson.TH(deriveJSON, defaultOptions, Options(fieldLabelModifier))\n\ndata Test = Test { attribute :: String } deriving Show\n\n$(deriveJSON defaultOptions {fieldLabelModifier = map toUpper . drop 3} ''Test)</code></pre>\n\n<p>In that case the template Haskell part will implement the <code>FromJSON</code> and <code>ToJSON</code> instances.</p>\n\n<blockquote><b>Note</b>: We can use qualified imports in order to make it more clear what function we use, for example:\n\n<pre><code>import <b>qualified</b> Data.List as <b>L</b>\nimport <b>qualified</b> Data.Char as <b>C</b>\n\ninstance ToJSON R3 where\n    toJSON = genericToJSON defaultOptions {\n            fieldLabelModifier = map <b>C.</b>toLower . <b>L.</b>drop 3\n        }</code></pre></blockquote>\n\n<blockquote>\n  <p><strong>Note</strong>: As for the smart constructor, you can simplify this expression to:</p>\n\n<pre><code>makeR3 = R3\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1556050154, "post_id": 55818245, "comment_id": 98303731, "body": "This seems to conflict with the Data.Text I am importing."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 1, "creation_date": 1556051243, "post_id": 55818245, "comment_id": 98304229, "body": "So import it as qualified then?"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 3, "last_activity_date": 1556048114, "creation_date": 1556048114, "answer_id": 55818245, "question_id": 55818022, "link": "https://stackoverflow.com/questions/55818022/functionally-changing-key-names-in-serialization-to-aeson-with-text-keys/55818245#55818245", "title": "Functionally changing key names in serialization to aeson with Text keys", "body": "<p>You seem to be using <code>toLower</code> from <code>Data.Text</code>, which works with <code>Text</code>, not with <code>String</code>, so quite naturally, it doesn't fit there.</p>\n\n<p>Instead, you could use <a href=\"https://www.stackage.org/haddock/lts-13.18/base-4.12.0.0/Data-Char.html#v:toLower\" rel=\"nofollow noreferrer\"><code>toLower</code> from <code>Data.Char</code></a> and <code>map</code> it over the <code>String</code>:</p>\n\n<pre><code>fieldLabelModifier = map toLower . drop 3\n</code></pre>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 55818243, "answer_count": 2, "score": 2, "last_activity_date": 1556050949, "creation_date": 1556047091, "last_edit_date": 1556050474, "question_id": 55818022, "link": "https://stackoverflow.com/questions/55818022/functionally-changing-key-names-in-serialization-to-aeson-with-text-keys", "title": "Functionally changing key names in serialization to aeson with Text keys", "body": "<p>I have a json object with a manually crafted ToJSON instance.  I would like to  replace this with a function that does not require my explicit enumeration of the key names.</p>\n\n<p>I am using \"rec*\" as a prefix I would like to strip, and my fields start out as Text rather than string.</p>\n\n<p>Starting with minimal data:</p>\n\n<pre><code>data R3 = R3 { recCode :: Code \n             , recValue :: Value} deriving (Show, Generic)\n</code></pre>\n\n<p>And smart constructor function:    </p>\n\n<pre><code>makeR3 rawcode rawval = R3 code value where\n                                     code = rawcode\n                                     value = rawval\n</code></pre>\n\n<p>This implementation works fine:</p>\n\n<pre><code>instance ToJSON R3 where\n   toJSON (R3 recCode recValue) = object [ \"code\" .= recCode, \"value\" .= recValue]\n</code></pre>\n\n<p>But as you can imagine, typing out every key name by hand from \"code\" to \"recCode\" is not something I want to do.</p>\n\n<pre><code>tmp_r3 = makeR3 \"TD\" \"100.42\"\nas_json = encode tmp_r3\n\nmain = do\n    let out = encodeToLazyText tmp_r3\n    I.putStrLn out\n    I.writeFile \"./so.json\" out\n    return ()\n</code></pre>\n\n<p>Output is correct:</p>\n\n<pre><code>{\"value\":100.42,\"code\":\"TD\"}\n-- not recValue and recCode, correct!\n</code></pre>\n\n<p>However, when I try this function, it becomes unable to convert the text to string as it had automatically before.</p>\n\n<pre><code>instance ToJSON R3 where\n  toJSON = genericToJSON defaultOptions {\n             fieldLabelModifier = T.toLower . IHaskellPrelude.drop 3 }\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&lt;interactive&gt;:8:35: error:\n    \u2022 Couldn't match type \u2018Text\u2019 with \u2018String\u2019\n      Expected type: String -&gt; String\n        Actual type: String -&gt; Text\n    \u2022 In the \u2018fieldLabelModifier\u2019 field of a record\n      In the first argument of \u2018genericToJSON\u2019, namely \u2018defaultOptions {fieldLabelModifier = toLower . IHaskellPrelude.drop 3}\u2019\n      In the expression: genericToJSON defaultOptions {fieldLabelModifier = toLower . IHaskellPrelude.drop 3}\n&lt;interactive&gt;:8:47: error:\n    \u2022 Couldn't match type \u2018String\u2019 with \u2018Text\u2019\n      Expected type: String -&gt; Text\n        Actual type: String -&gt; String\n    \u2022 In the second argument of \u2018(.)\u2019, namely \u2018IHaskellPrelude.drop 3\u2019\n      In the \u2018fieldLabelModifier\u2019 field of a record\n      In the first argument of \u2018genericToJSON\u2019, namely \u2018defaultOptions {fieldLabelModifier = toLower . IHaskellPrelude.drop 3}\u2019\n</code></pre>\n\n<p>The error itself is clear enough that Text doesn't work, but what should I change to strip my prefixes from keynames functionally in json output \nand also correctly convert text to string?</p>\n\n<p>I am also a little confused that I didn't change my input, it was Text type in both instances, but the first implementation was OK to work with it, while the second was not.</p>\n\n<p>I am working in an ihaskell jupyter notebook.</p>\n\n<h2>Update</h2>\n\n<p>When I use the Data.Char recommended in answers below:</p>\n\n<pre><code>import Data.Char(toLower)\n</code></pre>\n\n<p>In:</p>\n\n<pre><code>instance ToJSON R3 where\n  toJSON = genericToJSON defaultOptions {\n             fieldLabelModifier = Data.Char.toLower . IHaskellPrelude.drop 3 }\n</code></pre>\n\n<p>I get:</p>\n\n<pre><code>&lt;interactive&gt;:8:35: error:\n    \u2022 Couldn't match type \u2018Char\u2019 with \u2018String\u2019\n      Expected type: String -&gt; String\n        Actual type: String -&gt; Char\n    \u2022 In the \u2018fieldLabelModifier\u2019 field of a record\n      In the first argument of \u2018genericToJSON\u2019, namely \u2018defaultOptions {fieldLabelModifier = Data.Char.toLower . IHaskellPrelude.drop 3}\u2019\n      In the expression: genericToJSON defaultOptions {fieldLabelModifier = Data.Char.toLower . IHaskellPrelude.drop 3}\n&lt;interactive&gt;:8:55: error:\n    \u2022 Couldn't match type \u2018String\u2019 with \u2018Char\u2019\n      Expected type: String -&gt; Char\n        Actual type: String -&gt; String\n    \u2022 In the second argument of \u2018(.)\u2019, namely \u2018IHaskellPrelude.drop 3\u2019\n      In the \u2018fieldLabelModifier\u2019 field of a record\n      In the first argument of \u2018genericToJSON\u2019, namely \u2018defaultOptions {fieldLabelModifier = Data.Char.toLower . IHaskellPrelude.drop 3}\u2019\n</code></pre>\n\n<p>And when I try a naked \"drop\" rather than an IHaskellPrelude drop, I get:</p>\n\n<pre><code>instance ToJSON R3 where\n  toJSON = genericToJSON defaultOptions {\n             fieldLabelModifier = Data.Char.toLower . drop 3 }\n\n&lt;interactive&gt;:8:55: error:\n    Ambiguous occurrence \u2018drop\u2019\n    It could refer to either \u2018BS.drop\u2019, imported from \u2018Data.ByteString\u2019\n                          or \u2018IHaskellPrelude.drop\u2019, imported from \u2018Prelude\u2019 (and originally defined in \u2018GHC.List\u2019)\n                          or \u2018T.drop\u2019, imported from \u2018Data.Text\u2019\n</code></pre>\n"}, {"tags": ["haskell", "threepenny-gui"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1556042740, "post_id": 55816872, "comment_id": 98300675, "body": "<a href=\"https://github.com/HeinrichApfelmus/threepenny-gui/blob/master/samples/Buttons.hs\" rel=\"nofollow noreferrer\">github.com/HeinrichApfelmus/threepenny-gui/blob/master/sampl&zwnj;&#8203;es/&hellip;</a>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1556054360, "post_id": 55816872, "comment_id": 98305548, "body": "@MichaelLitchard I&#39;d say that is harsh. The OP clearly did some research (and not noticing a samples folder is something that can happen to anyone), and usage of Threepenny&#39;s layout combinators, as nice as they are, isn&#39;t exactly self-explanatory."}, {"owner": {"reputation": 11, "user_id": 11401252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2442424fbd13be79c8e018338ae7d8?s=128&d=identicon&r=PG&f=1", "display_name": "AR1981", "link": "https://stackoverflow.com/users/11401252/ar1981"}, "edited": false, "score": 0, "creation_date": 1556057195, "post_id": 55816872, "comment_id": 98306454, "body": "Thank you for your answers. I had looked through all the sample files, including the one in the link, but I did not find any example where the size or position of buttons was modified. Looking at it again, I still do not see any example of this. I do think that I have found an answer to my question now, but if I understand correctly, I am supposed to post that as an answer instead of a comment, so I will do that."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1556057301, "post_id": 55816872, "comment_id": 98306483, "body": "@AR1981 Yup, self-answering is the right thing to do if you solved it yourself."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1556057721, "post_id": 55816872, "comment_id": 98306610, "body": "@duplode fair enough, downvote removed."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1556058462, "post_id": 55820162, "comment_id": 98306784, "body": "I suggest adding enough of the surrounding code to the question, so that folks reading this can see clearly what you have fixed."}], "tags": [], "owner": {"reputation": 11, "user_id": 11401252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2442424fbd13be79c8e018338ae7d8?s=128&d=identicon&r=PG&f=1", "display_name": "AR1981", "link": "https://stackoverflow.com/users/11401252/ar1981"}, "is_accepted": false, "score": 0, "last_activity_date": 1556058342, "last_edit_date": 1556058342, "creation_date": 1556058023, "answer_id": 55820162, "question_id": 55816872, "link": "https://stackoverflow.com/questions/55816872/how-to-change-button-layout-and-position-in-threepenny-gui/55820162#55820162", "title": "How to change button layout and position in Threepenny GUI?", "body": "<p>I think my misunderstanding that I had was that my problem was not actually related to threepenny-gui but is instead a question about HTML. This link helped my find the answer I was looking for: <a href=\"https://www.geeksforgeeks.org/html-attributes/\" rel=\"nofollow noreferrer\">https://www.geeksforgeeks.org/html-attributes/</a></p>\n\n<p>Just in case anyone else is struggling with this as well, this line (mostly) solves it:</p>\n\n<pre><code># set UI.style [(\"text-align\", \"center\"),(\"color\",\"red\"),(\"font-size\",\"30px\")]\n</code></pre>\n\n<p>(The UI in UI.style comes from: <code>import qualified Graphics.UI.Threepenny as UI</code>)</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11401252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2442424fbd13be79c8e018338ae7d8?s=128&d=identicon&r=PG&f=1", "display_name": "AR1981", "link": "https://stackoverflow.com/users/11401252/ar1981"}, "edited": false, "score": 0, "creation_date": 1556087349, "post_id": 55820323, "comment_id": 98312646, "body": "Thank you for this answer, I&#39;ll look into this. I do not know any HTML, therefore did not see the connection and did not understand that I had to google for HTML attributes instead of threepenny-gui attributes."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 0, "last_activity_date": 1556059149, "creation_date": 1556059149, "answer_id": 55820323, "question_id": 55816872, "link": "https://stackoverflow.com/questions/55816872/how-to-change-button-layout-and-position-in-threepenny-gui/55820323#55820323", "title": "How to change button layout and position in Threepenny GUI?", "body": "<p>Threepenny UI element combinators translate more or less directly to HTML, and so you should think in terms of HTML when doing layout with it:</p>\n\n<ul>\n<li><p>The attributes from <code>Graphics.UI.Threepenny.Attributes</code> you mention are HTML attributes. Modifying them while defining your initial layout is typically done with <a href=\"http://hackage.haskell.org/package/threepenny-gui-0.8.3.0/docs/Graphics-UI-Threepenny-Core.html#v:set\" rel=\"nofollow noreferrer\"><code>set</code></a>. (By the way, if you need a reference for looking up what things like HTML attributes do, you can't do wrong with <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes\" rel=\"nofollow noreferrer\">MDN</a>.)</p></li>\n<li><p>For CSS styling, you can use the <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes\" rel=\"nofollow noreferrer\"><code>(#.)</code> combinator</a>.</p></li>\n<li><p>As for layout, the basic tools are <a href=\"http://hackage.haskell.org/package/threepenny-gui-0.8.3.0/docs/Graphics-UI-Threepenny-Core.html#v:-35--43-\" rel=\"nofollow noreferrer\"><code>(#+)</code></a> to nest HTML elements, and <a href=\"http://hackage.haskell.org/package/threepenny-gui-0.8.3.0/docs/Graphics-UI-Threepenny-Core.html#g:6\" rel=\"nofollow noreferrer\"><code>grid</code>, <code>row</code> and <code>column</code></a> to arrange <code>div</code>-based grids.</p></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 11401252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc2442424fbd13be79c8e018338ae7d8?s=128&d=identicon&r=PG&f=1", "display_name": "AR1981", "link": "https://stackoverflow.com/users/11401252/ar1981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1556059149, "creation_date": 1556042091, "last_edit_date": 1556056273, "question_id": 55816872, "link": "https://stackoverflow.com/questions/55816872/how-to-change-button-layout-and-position-in-threepenny-gui", "title": "How to change button layout and position in Threepenny GUI?", "body": "<p>How do I change the size and position of buttons or other UI elements in a GUI created with the threepenny-gui package?</p>\n\n<p>The <a href=\"http://hackage.haskell.org/package/threepenny-gui-0.8.3.0/docs/Graphics-UI-Threepenny-Attributes.html\" rel=\"nofollow noreferrer\">documentation of <code>Graphics.UI.Threepenny.Attributes</code></a> lists some functions which are probably useful, such as <code>coords :: WriteAttr Element String</code>. However, I don't understand how to use them. Specifically, I don't understand what the <code>String</code> argument is supposed to be.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1556039892, "post_id": 55816312, "comment_id": 98299428, "body": "Hint: use a <code>map</code>ping."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1556040179, "post_id": 55816312, "comment_id": 98299568, "body": "Start by writing a pair of helper functions with types <code>[(String, [Int], Int)] -&gt; ([[Int]], [Int])</code> and <code>([[Int]], [Int]) -&gt; [Int])</code>. (And the first one might benefit from <i>another</i> helper with type <code>(String, [Int], Int) -&gt; ([Int], Int)</code>. Don&#39;t be afraid to define lots and lots of small functions.)"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1556040462, "post_id": 55816312, "comment_id": 98299665, "body": "What does &quot;I have a function like this: <code>&#39;[(String, [Int], Int)]&#39;</code>&quot; mean?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1556042465, "post_id": 55816312, "comment_id": 98300547, "body": "The thing you are calling <code>function</code> <i>isn&#39;t</i> a function; it&#39;s just list of tuples."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1556046530, "post_id": 55816312, "comment_id": 98302221, "body": "<a href=\"https://mathinsight.org/definition/function\" rel=\"nofollow noreferrer\">mathinsight.org/definition/function</a>"}, {"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1556046997, "post_id": 55816312, "comment_id": 98302421, "body": "Could you elaborate how the <code>Int</code> extraction should work? It&#39;s not immediately clear from the example you&#39;ve given, at first I thought that you just want to take the <code>[Int]</code> components of each tuple, maybe concatenate them, but it doesn&#39;t appear to agree with the output you&#39;ve posted."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 0, "creation_date": 1556049540, "post_id": 55816312, "comment_id": 98303466, "body": "@Michail It looks like it&#39;s supposed to be sorted after concatenation."}, {"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1556055951, "post_id": 55816312, "comment_id": 98306073, "body": "@amalloy And then deduplicated; also, the third element of the tuple may or may not be involved somehow. Too much guesswork, really."}], "answers": [{"tags": [], "owner": {"reputation": 785, "user_id": 5478942, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-E0u3n2mQxTk/AAAAAAAAAAI/AAAAAAAABUI/1PPJs1QQ7BU/photo.jpg?sz=128", "display_name": "Solomon Bothwell", "link": "https://stackoverflow.com/users/5478942/solomon-bothwell"}, "is_accepted": false, "score": 1, "last_activity_date": 1556234311, "creation_date": 1556234311, "answer_id": 55858808, "question_id": 55816312, "link": "https://stackoverflow.com/questions/55816312/a-haskell-function-that-receives-a-list-with-different-types-and-returns-only-an/55858808#55858808", "title": "A Haskell function that receives a List with different types and returns only an Integer List", "body": "<p>First thing I like to do is lay out all the type signatures I think I'll need:</p>\n\n<pre><code>-- Something to use with fmap to get rid of the Strings\nf :: (String, [Int], Int) -&gt; ([Int], Int)\n\n-- Something to cons the list with the Int\ng :: ([Int], Int) -&gt; [Int]\n\n-- Our final goal:\nconvert :: [(String, [Int], Int)] -&gt; [Int]\n</code></pre>\n\n<p>Now I like to think about how I can compose these together to get my final result:</p>\n\n<pre><code>fmap g . fmap f :: [(String, [Int], Int)] -&gt; [[Int]]\n</code></pre>\n\n<p>And thanks to the <a href=\"https://www.stackage.org/haddock/lts-13.18/base-4.12.0.0/Prelude.html#t:Functor\" rel=\"nofollow noreferrer\">functor laws</a> you can actually rewrite that as:</p>\n\n<pre><code>fmap (g . f) :: [(String, [Int], Int)] -&gt; [[Int]]\n</code></pre>\n\n<p>Thats pretty close, but we have two nested lists instead of one. Luckily list is a <a href=\"https://www.stackage.org/haddock/lts-13.18/base-4.12.0.0/Prelude.html#t:Monoid\" rel=\"nofollow noreferrer\">monoid</a> which means that we can use <code>mconcat :: [a] -&gt; a</code> to fold it. Thats a little confusing because <code>mconcat</code> operates on a list of monoidal <code>a</code> values. The more concrete signature for <code>mconcat</code> in our case would be:</p>\n\n<pre><code>mconcat :: [[Int]] -&gt; [Int]\n</code></pre>\n\n<p>Where the <code>monoid</code> we are <code>mappending</code> is the inner list.</p>\n\n<p>Regardless, what that allows us to do is write this:</p>\n\n<pre><code>mconcat . fmap (g . f) :: [(String, [Int], Int)] -&gt; [Int]\n</code></pre>\n\n<p>Which is exactly the function we are trying to implement:</p>\n\n<pre><code>convert :: [(String, [Int], Int)] -&gt; [Int]\nconvert = mconcat . fmap g . fmap f\n    where f = undefined\n          g = undefined\n</code></pre>\n\n<p>Now we just need to implement <code>f</code> and <code>g</code>:</p>\n\n<pre><code>f :: (String, [Int], Int) -&gt; ([Int], Int)\nf (_, xs, x) = (xs, x)\n\ng :: ([Int], Int) -&gt; [Int] \ng (xs, x) = x:xs\n\ng' :: ([Int], Int) -&gt; [Int] \ng' (xs, x) = xs ++ [x]\n</code></pre>\n\n<p>Depending what position you want <code>x</code> to go in you can use <code>g</code> or <code>g'</code>.</p>\n\n<p>Then your final implementation would be something like (<a href=\"https://www.stackage.org/haddock/lts-13.18/base-4.12.0.0/Data-List.html#v:sort\" rel=\"nofollow noreferrer\">sort</a> added to the composition to match your example result):</p>\n\n<pre><code>convert :: [(String, [Int], Int)] -&gt; [Int]\nconvert = sort . mconcat . fmap g . fmap f\n    where f (_, xs, x) = (xs, x)\n          g (xs, x) = x:xs\n</code></pre>\n\n<p>Looking back at your question, it looks like the 3rd element of the triple is always a member of the second element? If thats the case, this function becomes even simpler:</p>\n\n<pre><code>convert :: [(String, [Int], Int)] -&gt; [Int]\nconvert = sort . mconcat . fmap f\n    where f (_, xs, ) = xs\n</code></pre>\n\n<p>If you are worried about performance due to the final sort step, you could combine it with the concatenation by using <code>foldr</code> to rather then <code>mconcat</code> and do the sorting in the <code>a -&gt; b -&gt; b</code>. </p>\n"}], "owner": {"reputation": 31, "user_id": 11401076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35643e09bb3aae729bec711020440229?s=128&d=identicon&r=PG&f=1", "display_name": "Gabriel Ribeiro Carneiro", "link": "https://stackoverflow.com/users/11401076/gabriel-ribeiro-carneiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1556234311, "creation_date": 1556039699, "last_edit_date": 1556044652, "question_id": 55816312, "link": "https://stackoverflow.com/questions/55816312/a-haskell-function-that-receives-a-list-with-different-types-and-returns-only-an", "title": "A Haskell function that receives a List with different types and returns only an Integer List", "body": "<p>I have a function like this: </p>\n\n<pre><code>[(String, [Int], Int)]\n</code></pre>\n\n<p>I desire a function that just returns a list of [Int].</p>\n\n<p>Input example:</p>\n\n<pre><code>[(\"R1\",[6,10,14],6),(\"R2\",[8,10,14],8),(\"R3\",[11,15,24],11)]\n</code></pre>\n\n<p>Output example (the behavior that I want of the output): </p>\n\n<pre><code>[6,8,10,11,14,15,24]\n</code></pre>\n\n<p>I've been thinking to create a function of input, like this: </p>\n\n<pre><code>function :: [(String, [Int], Int)]\nfunction = [(\"R1\",[6,10,14],6),(\"R2\",[8,10,14],8),(\"R3\",[11,15,24],11)]\n</code></pre>\n\n<p>And another to convert to what I desire, like this :</p>\n\n<pre><code>convert :: [(String, [Int], Int)] -&gt; [Int]\nconvert [] = []\n...\n</code></pre>\n\n<p>How can I develop the function <code>convert</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 1, "creation_date": 1556040957, "post_id": 55815807, "comment_id": 98299891, "body": "Of course, you can always do <code>allElementsEqualF = allElementsEqualL . toList</code>."}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1556044350, "post_id": 55815807, "comment_id": 98301388, "body": "@AlexeyRomanov I recently thought of this solution, but I thought it could be very expensive from the point of view of conversion between types. If instead everything happened in a &quot;lazy&quot; way, maybe it would be the most convenient and fastest solution. Is it correct?"}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "reply_to_user": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1556044714, "post_id": 55815807, "comment_id": 98301510, "body": "@AlexeyRomanov I thought also a mixed solution: allElementsEqualF2 xs   -- | F.null xs = True   -- | otherwise = all (== x) xs     -- where     -- x = head $ F.toList xs     --- so if goList is lazy, the test is carried out upon the original type (with all)."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1556050534, "post_id": 55815807, "comment_id": 98303904, "body": "I decided it was worth a separate answer after all :)"}], "answers": [{"tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 7, "last_activity_date": 1556038565, "creation_date": 1556038565, "answer_id": 55816050, "question_id": 55815807, "link": "https://stackoverflow.com/questions/55815807/test-if-all-elements-of-a-foldable-are-the-same/55816050#55816050", "title": "Test if all elements of a Foldable are the same", "body": "<p>The convenient thing about your first function that doesn't exist in your second is that we have a convenient way of getting the \"head\" of a list. Fortunately, we can do the same for a <code>Foldable</code>. Let's write a <code>head'</code> that works on any <code>Foldable</code> (and for the sake of type safety we'll have our <code>head'</code> return a <code>Maybe</code>)</p>\n\n<pre><code>head' :: (Foldable t, Eq a) =&gt; t a -&gt; Maybe a\nhead' = foldr (\\a _ -&gt; Just a) Nothing\n</code></pre>\n\n<p>Now we can write basically the same code as the list case for the general one.</p>\n\n<pre><code>allElementsEqualF :: (Foldable t, Eq a) =&gt; t a -&gt; Bool\nallElementsEqualF f = case head' f of\n                        Nothing -&gt; True\n                        Just a -&gt; all (== a) f\n</code></pre>\n\n<p>Syntactically, it looks different, but it's the exact same thing you did in your list case: check if the structure is empty and, if it's not, then see if every element is equal to the first.</p>\n\n<p>Note that, technically, this is not <em>quite</em> equivalent to the code you posted, as it compares the first element against itself. So if your <code>==</code> operator is for some reason not reflexive, you'll get different results (try running my code and yours on the list <code>[read \"NaN\" :: Double]</code>)</p>\n"}, {"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1556039226, "post_id": 55816153, "comment_id": 98299136, "body": "I think <code>Same</code> is isomorphic to <code>Success a</code> from the <a href=\"http://hackage.haskell.org/package/zero-0.1.4/docs/Data-Zero.html\" rel=\"nofollow noreferrer\">zero</a> package."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1556039333, "post_id": 55816153, "comment_id": 98299182, "body": "@ReinHenrichs I kind of doubt it. <code>Same a</code> has two extra constructors compared to <code>a</code>, whereas <code>Success a</code> has just one. Now it might be <code>Success (Maybe a)</code> or something... but at that point I would say having a custom type is more readable."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1556039486, "post_id": 55816153, "comment_id": 98299257, "body": "It is, however, true that <code>Zero (Same a)</code> with <code>zero = Fail</code>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1556039521, "post_id": 55816153, "comment_id": 98299271, "body": "<code>Same a</code> has <code>n + 2</code> elements. <code>Success a</code> <i>is</i> <code>Maybe (Maybe a)</code>, which also has <code>n + 2</code> elements. (Ignoring bottoms.)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1556039590, "post_id": 55816153, "comment_id": 98299303, "body": "@ReinHenrichs Hm. When I follow your link, I see <code>newtype Success a = Success { getSuccess :: Maybe a }</code>, which has just one <code>Maybe</code> wrapper, not two."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1556039618, "post_id": 55816153, "comment_id": 98299311, "body": "Ah, you&#39;re right. Whoops! You do need to track the elements plus one extra bit of information (whether you&#39;ve seen an element and failed to match, or whether you&#39;ve just not seen an element yet.) So the structure you&#39;re looking for should have <code>n + 2</code> elements."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1556060348, "post_id": 55816153, "comment_id": 98307218, "body": "I love those bring-your-own-monoid solutions :)"}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 0, "creation_date": 1556089806, "post_id": 55816153, "comment_id": 98313726, "body": "@HTNW I appreciate your solution. I would like to ask you a question that is a little off the subject. The Same semigroup is commutative; Given this, is there a way to indicate this property and to make Haskell (or GHC) automatically expand the symmetrical part?"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 0, "creation_date": 1556090839, "post_id": 55816153, "comment_id": 98314223, "body": "@AlbertoCapitani Do you want a catch-all equation <code>x &lt;&gt; y = y &lt;&gt; x</code>?"}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 0, "creation_date": 1556096819, "post_id": 55816153, "comment_id": 98317619, "body": "@HTNW Yes, it would be fine. Ex. ::Com (Vacuous  &lt;&gt; x  = x) should be interpreted (expanded) (by GHC?) as: Vacuous  &lt;&gt; x  = x;   x &lt;&gt; Vacuous = x."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 0, "creation_date": 1556103075, "post_id": 55816153, "comment_id": 98321215, "body": "@AlbertoCapitani No, I mean you can literally replace the last two equations with <code>x &lt;&gt; y = y &lt;&gt; x</code> and have it work, right?"}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 0, "creation_date": 1556109979, "post_id": 55816153, "comment_id": 98325390, "body": "@HTNW Why if I replace the two Vacuous occurences in (Semigroup(Same)&#39;s instance  with 1 line: &quot;Vacuous  &lt;&gt; x  =  x &lt;&gt; Vacuous&quot; the compiler give me an error? (&quot;Non-exhaustive patterns in function &lt;&gt;&quot;)"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 0, "creation_date": 1556120159, "post_id": 55816153, "comment_id": 98332106, "body": "@AlbertoCapitani Because the patterns aren&#39;t exhaustive if you write it like that? This is not something you can be clever with. The LHSs need to cover all patterns, period, no matter what the RHSs are. You can write <code>Vacuous &lt;&gt; x = x; Fail &lt;&gt; x = Fail; s@(Same l) &lt;&gt; Same r  = if l == r then s else Fail; x &lt;&gt; y = y &lt;&gt; x</code> if you want to show commutativity. That&#39;s the best I can think up."}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 0, "creation_date": 1556121682, "post_id": 55816153, "comment_id": 98332976, "body": "@HTNW Thank you very much."}, {"owner": {"reputation": 1750, "user_id": 3929481, "user_type": "registered", "accept_rate": 12, "profile_image": "https://i.stack.imgur.com/3ZrH1.jpg?s=128&g=1", "display_name": "mcmayer", "link": "https://stackoverflow.com/users/3929481/mcmayer"}, "edited": false, "score": 0, "creation_date": 1604995205, "post_id": 55816153, "comment_id": 114510105, "body": "One issue with this is that <code>allEqTo $ 2 : (cycle [1])</code> does not terminate - a rather exotic case, though."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 14, "last_activity_date": 1556059626, "last_edit_date": 1556059626, "creation_date": 1556039020, "answer_id": 55816153, "question_id": 55815807, "link": "https://stackoverflow.com/questions/55815807/test-if-all-elements-of-a-foldable-are-the-same/55816153#55816153", "title": "Test if all elements of a Foldable are the same", "body": "<p>I don't know about less complicated, but I think this is the \"cleanest\" way to do it. By \"clean,\" I mean it's one traversal over the structure using a single, special <code>Monoid</code>.</p>\n\n<pre><code>data Same a = Vacuous | Fail | Same a\ninstance Eq a =&gt; Semigroup (Same a) where\n    Vacuous    &lt;&gt; x       = x\n    Fail       &lt;&gt; _       = Fail\n    s@(Same l) &lt;&gt; Same r  = if l == r then s else Fail\n    x          &lt;&gt; Vacuous = x\n    _          &lt;&gt; Fail    = Fail\ninstance Eq a =&gt; Monoid (Same a) where\n    mempty = Vacuous\n\nallEq :: (Foldable f, Eq a) =&gt; f a -&gt; Bool\nallEq xs = case foldMap Same xs of\n                Fail -&gt; False\n                _    -&gt; True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1556039184, "post_id": 55816195, "comment_id": 98299108, "body": "I think this is the same as my answer?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1556039210, "post_id": 55816195, "comment_id": 98299124, "body": "@HTNW Yep! Seems we overlapped in answering."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1556039327, "post_id": 55816195, "comment_id": 98299177, "body": "It doesn&#39;t necessarily do two traversals. For structures where <code>foldr</code> can implement guarded recursion, it may only look at the top-most constructor the first time."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1556039357, "post_id": 55816195, "comment_id": 98299197, "body": "@ReinHenrichs Good point. I&#39;ll amend my answer appropriately."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1556039443, "last_edit_date": 1556039443, "creation_date": 1556039149, "answer_id": 55816195, "question_id": 55815807, "link": "https://stackoverflow.com/questions/55815807/test-if-all-elements-of-a-foldable-are-the-same/55816195#55816195", "title": "Test if all elements of a Foldable are the same", "body": "<p>Silvio's answer is syntactically small and easy to understand; however, it may do extra work associated with doing two folds if the <code>Foldable</code> instance can't compute <code>head'</code> cheaply. In this answer I will discuss how to perform the calculation in just one pass whether the underlying <code>Foldable</code> can compute <code>head'</code> cheaply or not.</p>\n\n<p>The basic idea is this: instead of tracking just \"are all the elements equal so far\", we'll also track what they're all equal to. So:</p>\n\n<pre><code>data AreTheyEqual a\n    = Empty\n    | Equal a\n    | Inequal\n    deriving Eq\n</code></pre>\n\n<p>This is a <code>Monoid</code>, with <code>Empty</code> as the unit and <code>Inequal</code> as an absorbing element.</p>\n\n<pre><code>instance Eq a =&gt; Semigroup (AreTheyEqual a) where\n    Empty &lt;&gt; x = x\n    x &lt;&gt; Empty = x\n    Equal a &lt;&gt; Equal b | a == b = Equal a\n    _ &lt;&gt; _ = Inequal\n\ninstance Eq a =&gt; Monoid (AreTheyEqual a) where\n    mempty = Empty\n</code></pre>\n\n<p>Now we can use <code>foldMap</code> to summarize an entire <code>Foldable</code>, like so:</p>\n\n<pre><code>allElementsEqual :: (Eq a, Foldable f) =&gt; f a -&gt; Bool\nallElementsEqual = (Inequal /=) . foldMap Equal\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1557669676, "post_id": 55818769, "comment_id": 98834803, "body": "There are types (such as snoc-lists, or any other type with heavily left-biased trees) where this will do significantly more work than HTNW&#39;s and my solution."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1557756274, "post_id": 55818769, "comment_id": 98861602, "body": "I considered them, but thought it ends up being the same because foldMap is still required to iterate over them in order and can&#39;t take advantage of your monoids being commutative. No?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1557757284, "post_id": 55818769, "comment_id": 98862196, "body": "Hmmm. The answer is... trickier than I was thinking it was before. <code>foldMap</code> may iterate in any order it likes (because monoids are required to be associative), but the implementation of <code>mappend</code> and in particular which order it forces its arguments in may affect how many elements are actually &quot;visited&quot;. Reviewing my and HTNW&#39;s answer, both our <code>mappend</code> implementations are strict in their first argument, which probably forces all the work to be done left-to-right. Rats! Okay, I no longer endorse my previous comment."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 4, "last_activity_date": 1556055098, "last_edit_date": 1556055098, "creation_date": 1556050486, "answer_id": 55818769, "question_id": 55815807, "link": "https://stackoverflow.com/questions/55815807/test-if-all-elements-of-a-foldable-are-the-same/55818769#55818769", "title": "Test if all elements of a Foldable are the same", "body": "<p>A rather trivial option, and I would generally prefer one of the other answers, is reusing <code>allElementsEqualL</code>:</p>\n\n<pre><code>allElementsEqualF = allElementsEqualL . toList\n</code></pre>\n\n<p>or after inlining</p>\n\n<pre><code>allElementsEqualF xs = case toList xs of\n                         [] -&gt; True\n                         x:xs' -&gt; all (== x) xs'\n</code></pre>\n\n<p>It's laziness which makes it reasonable. The <code>all</code> call doesn't demand the entire <code>xs'</code>, but only until it finds the first one different from <code>x</code>. So <code>toList</code> will also not demand the entire <code>xs</code>. And at the same time, already examined elements don't need to be kept in memory.</p>\n\n<p>You could write a <code>Foldable</code> instance for which <code>toList</code> is less lazy than necessary, but except for those cases I think it should do exactly as much work as Daniel Wagner's and HTNW's answer (with slight overhead not depending on input size).</p>\n\n<blockquote>\n  <p>I thought also a mixed solution: </p>\n\n<pre><code>allElementsEqualF2 xs | F.null xs = True \n                      | otherwise = all (== x) xs \n    where x = head $ F.toList xs \n</code></pre>\n  \n  <p>so if goList is lazy, the test is carried out upon the original type (with all).</p>\n</blockquote>\n\n<p>This does slightly more work in the non-empty case than Silvio's answer, because <code>F.null</code> duplicates exactly as much of <code>F.toList</code>'s work as <code>head'</code> does. So Silvio's code has to get to the first element 2 times (one for <code>head'</code> and another inside <code>all</code>), and yours does it 3 times (<code>null</code>, <code>head $ toList xs</code> and <code>all</code> again). </p>\n"}], "owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 2, "accepted_answer_id": 55816153, "answer_count": 4, "score": 11, "last_activity_date": 1556059626, "creation_date": 1556037425, "question_id": 55815807, "link": "https://stackoverflow.com/questions/55815807/test-if-all-elements-of-a-foldable-are-the-same", "title": "Test if all elements of a Foldable are the same", "body": "<p>I built a function that verifies that all elements of a foldable structure are equal.</p>\n\n<p>Compared to a similar function on the lists, it seems to me that the more general function is disproportionately complex, but I have not been able to simplify it.</p>\n\n<p>Do you have any suggestions?</p>\n\n<pre><code>import Data.Monoid\nimport Data.Sequence as SQ\nimport Data.Matrix as MT\n\nallElementsEqualL :: Eq a =&gt; [a] -&gt; Bool\nallElementsEqualL [] = True\nallElementsEqualL (x:ns) = all (== x) ns\n-- allElementsEqualL [1,1,1] -&gt; True\n\nallElementsEqualF :: (Foldable t, Eq a) =&gt; t a -&gt; Bool\nallElementsEqualF xs = case (getFirst . foldMap (First . Just) $ xs) of\n                        Nothing -&gt; True\n                        Just x  -&gt; all (== x) xs\n\n-- allElementsEqualF [1,1,1] -&gt; True\n\n-- allElementsEqualF $ SQ.fromList [1,1,1] -&gt; True\n\n-- allElementsEqualF $ MT.fromLists [[1,1],[1,1]] -&gt; True\n</code></pre>\n"}, {"tags": ["haskell", "overriding"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1556037465, "post_id": 55815794, "comment_id": 98298274, "body": "That&#39;s the idea behind <i>typeclasses</i>: <a href=\"http://learnyouahaskell.com/types-and-typeclasses\" rel=\"nofollow noreferrer\">learnyouahaskell.com/types-and-typeclasses</a> it is used for &quot;ad-hoc polymorphism&quot;."}, {"owner": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1556037969, "post_id": 55815794, "comment_id": 98298532, "body": "as far as I understand this article, typeclasses allow you to work with different datatypes in the same function, but not actually override the function definition itself?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1556038078, "post_id": 55815794, "comment_id": 98298592, "body": "well you define your <code>jumpTo</code> in a typeclass <code>class JumpTo a</code> as <code>jumpTo :: a -&gt; [String] -&gt; [String]</code>, and then you declare two instances: <code>instance JumpTo Int</code>, and <code>instance JumpTo String</code>. For each <code>instance</code> you can provide a different implementation. In fact that is how <code>show</code> works for example: every type defines its specific way of <code>show</code>."}], "answers": [{"comments": [{"owner": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "edited": false, "score": 0, "creation_date": 1556039201, "post_id": 55815965, "comment_id": 98299119, "body": "thank you, this makes sense now! On compile I&#39;m getting illegal instance declaration for the String instance, rewriting it to [] Char doesnt help either. I&#39;ve tried &quot;promising&quot; haskell that I wont define any overlapping instances, however by using the functions I get errors thrown at me saying that its too ambigious. :[ how does one go about using String then?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "edited": false, "score": 3, "creation_date": 1556040776, "post_id": 55815965, "comment_id": 98299799, "body": "@peterxz You will need to turn on <code>TypeSynonymInstances</code> and <code>FlexibleInstances</code>. Your code as written still won&#39;t compile after you&#39;ve done this, but that&#39;s an unrelated problem."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 4, "last_activity_date": 1556038204, "creation_date": 1556038204, "answer_id": 55815965, "question_id": 55815794, "link": "https://stackoverflow.com/questions/55815794/overriding-functions-for-different-data-types/55815965#55815965", "title": "Overriding functions for different data types", "body": "<p>This is exactly the idea behind type classes: you define your function (or a group of functions) not by itself, but as belonging to a type class, which is tagged with a type variable (or several). Then you define one or more instances of the type class with different types substituted for that type variable, and you define separate bodies for the function in each instance. The end effect is that the function has different body depending on the types of its arguments or result.</p>\n\n<p>In your example:</p>\n\n<pre><code>class JumpTo a where\n    jumpTo :: a -&gt; [String] -&gt; [String]\n\ninstance JumpTo Int where\n    jumpTo index t = do \n        let (x,y) = splitAt index t\n        init x ++ [last x ++ \"QQ\"] ++ y\n\ninstance JumpTo String where\n    jumpTo string t = do \n        pos &lt;- [fromJust (findWord string t)]\n        let (x,y) = splitAt pos a\n        init x ++ [last x ++ \"QQ\"] ++ y\n</code></pre>\n"}], "owner": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 55815965, "answer_count": 1, "score": 1, "last_activity_date": 1556038204, "creation_date": 1556037372, "question_id": 55815794, "link": "https://stackoverflow.com/questions/55815794/overriding-functions-for-different-data-types", "title": "Overriding functions for different data types", "body": "<p>Im trying to define a function which I want to behave slightly differently depending on what datatype is passed in as the argument, strings and integers. How would one go about doing this? Or are there any changes you could suggest to somehow compose these two into one function. Ive read that trying to validate the datatype is not very haskell like so I thought overriding might be the way to go to do this but the compiler doesnt like the duplicate :( </p>\n\n<pre><code>jumpTo :: Int -&gt; [String] -&gt; [String]\njumpTo index t = do \n    let (x,y) = splitAt index t\n    init x ++ [last x ++ \"QQ\"] ++ y\n\njumpTo :: String -&gt; [String] -&gt; [String]\njumpTo string t = do \n    pos &lt;- [fromJust (findWord string t)]\n    let (x,y) = splitAt pos a\n    init x ++ [last x ++ \"QQ\"] ++ y\n</code></pre>\n\n<p>In words, I want a function <code>jumpTo</code> which can either be passed a <code>String</code> or <code>Int</code> as its first argument; if its a string, I find it in the list, and for an integer I do the operations with the index straight away. It just seems more elegant to have the same function doing this.</p>\n"}, {"tags": ["haskell", "exception", "functional-programming"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 3, "creation_date": 1556032938, "post_id": 55814298, "comment_id": 98295809, "body": "Isn&#39;t there something about <code>readFile</code> doing lazy IO - reading the file only after they returned the string? Try forcing the string to be evaluated within the <code>handle</code>."}, {"owner": {"reputation": 438, "user_id": 6371869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mUzus.jpg?s=128&g=1", "display_name": "Shadasviar", "link": "https://stackoverflow.com/users/6371869/shadasviar"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1556033006, "post_id": 55814298, "comment_id": 98295858, "body": "@Bergi, I run this code in ghci so result is forced immediately"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1556033198, "post_id": 55814298, "comment_id": 98295973, "body": "@Shadasviar That doesn&#39;t mean Bergi&#39;s diagnosis is wrong, it actually supports the guess.   1. Run readFile, getting some bytes (or perhaps none yet!)  2. Return a (lazy) <code>String</code> so now no longer in <code>handle</code>.  3. Try to print on the REPL the whole string, thus forcing it all to be read.  4. Encounter error and throw the exception."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 5, "last_activity_date": 1556033478, "creation_date": 1556033478, "answer_id": 55814676, "question_id": 55814298, "link": "https://stackoverflow.com/questions/55814298/handle-with-someexception-is-ignored/55814676#55814676", "title": "handle with SomeException is ignored", "body": "<p>You can force the entire string to be read within the scope of the catch:</p>\n\n<pre><code>Control.Exception.handle\n      ((\\_ -&gt; return \"ERR\") :: Control.Exception.SomeException -&gt; IO String)\n      (Prelude.readFile \"file.txt\" &gt;&gt;= \\res -&gt; res `deepseq` (pure res))\n\"ERR\"\n</code></pre>\n"}], "owner": {"reputation": 438, "user_id": 6371869, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mUzus.jpg?s=128&g=1", "display_name": "Shadasviar", "link": "https://stackoverflow.com/users/6371869/shadasviar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 55814676, "answer_count": 1, "score": 4, "last_activity_date": 1556033478, "creation_date": 1556032251, "last_edit_date": 1556032761, "question_id": 55814298, "link": "https://stackoverflow.com/questions/55814298/handle-with-someexception-is-ignored", "title": "handle with SomeException is ignored", "body": "<p>I have a usual haskell code which reads file and handle any exception:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>handle ((\\_-&gt;return \"ERROR\") :: SomeException -&gt; IO String) $ readFile \"file.txt\"\n</code></pre>\n\n<p>When I try to read bad encoded file I always get error:</p>\n\n<pre><code>*** Exception: file.txt: hGetContents: invalid argument (invalid byte sequence)\n</code></pre>\n\n<p>and program is not going to enter to the my exception handle function. I also tried to use <code>IOError</code> and <code>IOException</code> types instead of <code>SomeException</code> but it changes nothing.</p>\n\n<p>If I open similar file with by handle and read it with code:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>handle ((\\_-&gt;return \"ERROR\") :: SomeException -&gt; IO String) (hGetContents myHandle)\n</code></pre>\n\n<p>works fine.</p>\n\n<p>How to catch exceptions thrown by <code>hGetContents</code> passed by <code>readFile</code> right way?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1556028667, "post_id": 55812871, "comment_id": 98293094, "body": "Add more explicit type signatures, and use <code>Integer</code> instead of <code>Int</code> (since eventually your prime numbers will grow beyond what an <code>Int</code> can hold). However, the problem is that you are calling <code>primfactor</code> with a list <code>(m&#47;head primnumber):[]</code>, not an <code>Int</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1556032215, "post_id": 55812871, "comment_id": 98295323, "body": "A question which I hope will help you find one of your many bugs: for what inputs do you expect <code>npf</code> to return something other than <code>True</code>? Does GHC agree?"}, {"owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1556037523, "post_id": 55812871, "comment_id": 98298301, "body": "@Daniel Wagner I have corrected the program after your tipp. But one error appeared still in the program i have corrected..."}, {"owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1556037694, "post_id": 55812871, "comment_id": 98298386, "body": "@Daniel Wagner Could u give me some other tipps ?"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "edited": false, "score": 0, "creation_date": 1556029745, "post_id": 55813251, "comment_id": 98293739, "body": "` primfactor :: Integer -&gt; [Integer] primfactor 1 = [] primfactor m      |npf m primnumber == True = [head primnumber] ++ (primfactor (m / head primnumber):[]) npf n (x:xs)     |n <code>mod</code> x == 0 = True     |otherwise = npf n xs `                                                                                               I have corrected the line. But one error exists still...I don&#39;t see why. I have all day for that...mgd @Fyodor Soikin"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1556032141, "post_id": 55813251, "comment_id": 98295275, "body": "There&#39;s also the <code>(&#47;)</code> vs <code>div</code> error. And then there&#39;s a bunch of logical errors that type-checking won&#39;t/can&#39;t catch..."}, {"owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "edited": false, "score": 0, "creation_date": 1556037654, "post_id": 55813251, "comment_id": 98298368, "body": "@Fyodor Soikin There is still one error I can&#39;t take away... plz give me some advices ..."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1556038038, "post_id": 55813251, "comment_id": 98298569, "body": "You have a missing parenthesis at the very end"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 3, "last_activity_date": 1556028833, "creation_date": 1556028833, "answer_id": 55813251, "question_id": 55812871, "link": "https://stackoverflow.com/questions/55812871/one-error-in-my-programm-to-get-the-primfactor-from-a-primnumber/55813251#55813251", "title": "one error in my programm to get the primfactor from a primnumber", "body": "<pre><code>primnumber :: [Int]     -- a list of numbers\nhead primnumber :: Int  -- a single number\n(++) :: [Int] -&gt; [Int] -&gt; [Int]\n</code></pre>\n\n<p><code>head primnumber</code> cannot be first (left) argument of operator <code>(++)</code>, because it is of the wrong type: the operator expects a list (in this case, <code>[Int]</code>), but you're providing an <code>Int</code>.</p>\n\n<p>It is not entirely clear from your code what it's supposed to be doing in the first place, so I can't tell you how to fix it exactly. If you meant to \"prepend\" <code>head primfactor</code> to the list, then you could wrap it in a list like this:</p>\n\n<pre><code>[head primnumber] ++ (primfactor (m / head primnumber):[])\n</code></pre>\n\n<p>Or, better yet, use the <code>(:)</code> constructor directly:</p>\n\n<pre><code>(head primnumber) : (primfactor (m / head primnumber):[])\n</code></pre>\n\n<p>If you wanted to do something else, please specify what it was.</p>\n"}], "owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1556037310, "creation_date": 1556027635, "last_edit_date": 1556037310, "question_id": 55812871, "link": "https://stackoverflow.com/questions/55812871/one-error-in-my-programm-to-get-the-primfactor-from-a-primnumber", "title": "one error in my programm to get the primfactor from a primnumber", "body": "<p>Through the part of program under the imaginary line all the primfactors from a primnumber is calculated and outputed. The Part of program over the imaginary line gets  out the primnumber from 2 to infinity.</p>\n\n<p>the error occured in the following line</p>\n\n<pre><code>   |npf m primnumber == True = head primnumber ++ (primfactor (m / head primnumber):[])\n\n</code></pre>\n\n<p>The warning was shown as: </p>\n\n<pre><code>E:\\Haskell\\Uebungsblatt_2_Aufgabe_1.hs:17:33: error:\n    * Couldn't match expected type `[[Int]]' with actual type `Int'\n    * In the first argument of `(++)', namely `head primnumber'\n      In the expression:\n        head primnumber ++ (primfactor (m / head primnumber) : [])\n      In an equation for `primfactor':\n          primfactor m\n            | npf m primnumber == True\n            = head primnumber ++ (primfactor (m / head primnumber) : [])\n   |\n17 |     |npf m primnumber == True = head primnumber ++ (primfactor (m / head primnumber):[])\n\n   |                                 ^^^^^^^^^^^^^^^\n\nE:\\Haskell\\Uebungsblatt_2_Aufgabe_1.hs:17:33: error:\n    * Couldn't match type `[Int]' with `Int'\n      Expected type: [Int]\n        Actual type: [[Int]]\n    * In the expression:\n        head primnumber ++ (primfactor (m / head primnumber) : [])\n      In an equation for `primfactor':\n          primfactor m\n            | npf m primnumber == True\n            = head primnumber ++ (primfactor (m / head primnumber) : [])\n   |\n17 |     |npf m primnumber == True = head primnumber ++ (primfactor (m / head primnumber):[])\n\n   |                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n[Finished in 2.8s]\n</code></pre>\n\n<p>I have been checking the expressions in the line for many times. But I can't get the reason. </p>\n\n<pre><code>\nimport Data.List\n\nmain :: IO ()    -- This says that main is an IO action.\nmain = return () -- This tells main to do nothing\n\n--the second primnumer Function from leture\nprimnumber = 2: [n| n&lt;-[3..], prim n primnumber]\nprim n (p:xs) \n    |p*p &gt; n = True\n    |n `mod` p == 0 = False\n    |otherwise = prim n xs\n\n-------------------------------------------------------\n\nprimfactor :: Int -&gt; [Int]\nprimfactor m \n    |npf m primnumber == True = head primnumber ++ (primfactor (m / head primnumber):[])\n\nnpf n (x:xs)\n    |n `mod` x == 0 = True\n    |otherwise = npf n xs \n\n\n</code></pre>\n\n<p>after correction</p>\n\n<pre><code>import Data.List\n\nmain :: IO ()    -- This says that main is an IO action.\nmain = return () -- This tells main to do nothing\n\n--the second primnumer Function from leture\n\nprimnumber = 2: [n| n&lt;-[3..], prim n primnumber]\nprim n (p:xs) \n    |p*p &gt; n = True\n    |n `mod` p == 0 = False\n    |otherwise = prim n xs\n\n-------------------------------------------------------\nnpf :: Integer-&gt;[Integer]-&gt;Integer\nnpf n (x:xs)\n    |n `mod` x == 0 = x \n    |n `mod` x == 1 = 1\n    |otherwise = npf n xs \n\nprimfactor :: Integer -&gt; [Integer]\nprimfactor 1 = []\nprimfactor m = [npf m primnumber] ++ ((primfactor (m `div` (npf m primnumber)):[])\n</code></pre>\n\n<p>the error</p>\n\n<pre><code>\nE:\\Haskell\\Uebungsblatt_2_Aufgabe_1.hs:23:83: error:\n    parse error (possibly incorrect indentation or mismatched brackets)\n   |\n23 | primfactor m = [npf m primnumber] ++ ((primfactor (m `div` (npf m primnumber)):[])\n   |                                                                                   ^\n[Finished in 0.5s with exit code 1]\n[shell_cmd: runhaskell \"E:\\Haskell\\Uebungsblatt_2_Aufgabe_1.hs\"]\n[dir: E:\\Haskell]\n[path: C:\\Program Files\\Haskell\\bin;E:\\8.6.3\\lib\\extralibs\\bin;E:\\8.6.3\\bin;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;E:\\matlab\\bin;E:\\8.6.3\\mingw\\bin;C:\\Users\\HuFengXiang\\AppData\\Roaming\\cabal\\bin;C:\\Users\\HuFengXiang\\AppData\\Roaming\\local\\bin]\n\n</code></pre>\n"}, {"tags": ["haskell", "optimization", "parallel-processing", "quicksort"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1556027512, "post_id": 55810774, "comment_id": 98292361, "body": "Closely related: <a href=\"https://stackoverflow.com/q/19752983/745903\">stackoverflow.com/q/19752983/745903</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1556031339, "post_id": 55810774, "comment_id": 98294739, "body": "<code>force</code> is not doing what you think it&#39;s doing: it only forces the spine of the list it&#39;s given, not the contents. For random number generation, forcing the contents is what actually does the work. Additionally, <code>force result `seq` result</code> doesn&#39;t do what you might hope it does. Try putting <code>evaluate (last input)</code> in <code>main</code> before you start timing and you&#39;ll immediately see the difference. I also recommend using <code>mkStdGen 0</code> (or some other constant) instead of <code>getStdGen</code> to make your timings more consistent. (Neither of these address your actual problem, though.)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1556031518, "post_id": 55810774, "comment_id": 98294863, "body": "As for your actual problem: you&#39;re probably creating waaaay too many sparks, and the spark-tracking overhead is dominating the runtime. You might try a simpler strategy: split the list into some small number of chunks, say, 60, or perhaps the number passed to <code>-N</code>, sorting each in parallel, then merging the results. Haven&#39;t tested it myself, so I won&#39;t write this as an answer as I can&#39;t be sure it&#39;s right, but I would bet that will behave better."}, {"owner": {"reputation": 35084, "user_id": 585411, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/xvEpe.jpg?s=128&g=1", "display_name": "btilly", "link": "https://stackoverflow.com/users/585411/btilly"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1556036571, "post_id": 55810774, "comment_id": 98297798, "body": "@DanielWagner I second that.  &quot;Fine grained parallelism&quot; almost always implies &quot;waaay too much overhead&quot;.  The trick is to divide work into reasonable chunks such that messaging and synchronization overhead doesn&#39;t kill you.  And for sorting specifically, the best parallel algorithms involve merge sort."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1556041426, "post_id": 55810774, "comment_id": 98300115, "body": "One of the problems with parallelizing quicksort is that it does not build balanced sublists. You might get a better result from parallelizing mergesort, which balances on the way in and sorts on the way out."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1556062007, "post_id": 55810774, "comment_id": 98307579, "body": "@DanielWagner I think all of that should be properly discussed in an answer. I added a bounty over on the old question."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1556062080, "post_id": 55810774, "comment_id": 98307597, "body": "@ReinHenrichs yeah, quicksort isn&#39;t great for parallelisation, but it should still be possible to get <i>some</i> performance boost even despite bad balancing, especially with a completely random-number list."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1556062356, "post_id": 55810774, "comment_id": 98307660, "body": "@leftaroundabout Yeah, there are ofc issues here that prevent it from parallelizing properly at all."}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1556091153, "post_id": 55810774, "comment_id": 98314368, "body": "@DanielWagner,  Thank you for your comments. I followed your advice and rewrote the parSort function on parSort2. Did you mean it?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1556095453, "post_id": 55810774, "comment_id": 98316762, "body": "You can use <code>Data.Map.Internal</code> (maps representing bags) to sort in parallel. Break up the list into chunks. Use <code>fromListWith</code> in parallel to convert each into a map. Then take unions in pairs. You&#39;ll have to parallelize the union algorithm (in the obvious way) in order to use all capabilities in each round of merges. I offer no performance guarantees, but see Blelloch et al, &quot;Just Join for Parallel Ordered Sets&quot;."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1556108560, "post_id": 55810774, "comment_id": 98324538, "body": "@Vasiliy No. <code>parSort2 60</code> will spawn up to 2^60 sparks, so you&#39;re almost certainly still spawning way too many sparks."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 2, "creation_date": 1556136659, "post_id": 55810774, "comment_id": 98339729, "body": "All sorting algorithms can be parallelized. Just chunk up the unordered array into thread many chunks and get them sorted in parallel. Once you have all sorted chunks merge them two by two on new parallel jobs up until you are left with only two chunks. Then merge them in the current thread. The best <i>base</i> sorting algorithm available is <code>Data.List.sort</code> so it&#39;s better to use that instead o an ineficient sort algorithm to start with."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1556221901, "post_id": 55810774, "comment_id": 98374792, "body": "@Redu, if you&#39;re starting and ending with Haskell lists, then there&#39;s exactly one linear-time part that&#39;s <i>fundamentally</i> sequential: breaking up the list into chunks. As far as I can tell, it&#39;s possible to fully parallelize everything else. Your algorithm, however, adds a sequential merge, and reduces the number of capabilities used as the merging process proceeds and the merges get more expensive. That doesn&#39;t sound like a great way to parallelize to me, but I&#39;m no expert."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1556298987, "post_id": 55810774, "comment_id": 98404469, "body": "@Redu, ah, I guess you can use a binary search to parallelize the merges, much like the tree sorting algorithm."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1556302890, "post_id": 55810774, "comment_id": 98406010, "body": "@dfeuer Suppose you have 64 threads at hand. Make 64 chunks from your list and assign one chunk per thread to be sorted. Once you have 64 sorted chunks then merge them 2 by 2 (<i>yes in a binary tree style so that each chunk takes the merging process minimum times</i>) in a separate thread. Initially you will need 32 threads and then 16 of them and so on up until you are left with 2 chunks which you merge in the main thread. This should be eficient but the magnificent Haskell list sort algorithm (which isnt standard mergesort as we know it) might even render this inefficient for not very big lists."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1556304013, "post_id": 55810774, "comment_id": 98406497, "body": "@Redu, what I&#39;m suggesting is that the merges be parallelized too. When merging <code>xs</code> and <code>ys</code>, break <code>xs</code> into <code>k</code> roughly equal portions <code>xs_1</code> to <code>xs_k</code>. Use binary searches in <code>ys</code> to break it up into corresponding (uneven) pieces <code>ys_1</code> to <code>ys_k</code>, so that elements of <code>xs_i</code> are never greater than those of <code>ys_{i+1}</code> and vice versa. Then the corresponding pieces can be merged, in separate threads, into a fresh array. As the number of pieces to merge goes down, the number of threads used for each can go up, to keep using the same number of capabilities."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1556308353, "post_id": 55810774, "comment_id": 98408061, "body": "@dfeuer Yeah well hmm.. Mergins jobs are already being done in parallel but you are left with increasing number of free threads to utilize for parallel mergers though.. I can not make sure about the efficiency on those binary searches to further simplifying the merging task to <code>xs_i ++ ys_i+?</code> even if they are done concurrently. But... interesting."}], "answers": [{"comments": [{"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1556369659, "post_id": 55862382, "comment_id": 98420194, "body": "Can we have some benchmark to see if this has actually lead to an increase in performance from parellelisation?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 1, "creation_date": 1556386570, "post_id": 55862382, "comment_id": 98424787, "body": "@DanRobertson, I did a bit of informal benchmarking and it does seem to work (<code>pSort 2</code> is quite a bit faster than <code>pSort 1</code> on a list like <code>[1,-1,2,-2,...,2*10^6]</code>), but I just have a medium-wimpy laptop ill-suited to that sort of thing. Threadscope seems to suggest a pretty well-balanced load, but I&#39;ve never used it before so I can&#39;t guarantee I&#39;m interpreting the results correctly."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 1, "creation_date": 1556389677, "post_id": 55862382, "comment_id": 98425621, "body": "@DanRobertson, it seems to scale well to at least 4 cores with pseudorandom input. I suspect there&#39;s more tweaking to be done (it might be better to use the finer parallelism controls available through <code>monad-par</code> than to rely on the built-in spark pool, for example), but the general approach seems to be good."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1556340613, "last_edit_date": 1556340613, "creation_date": 1556262078, "answer_id": 55862382, "question_id": 55810774, "link": "https://stackoverflow.com/questions/55810774/how-can-i-optimize-parallel-sorting-to-improve-temporal-performance/55862382#55862382", "title": "How can I optimize parallel sorting to improve temporal performance?", "body": "<p>Here's one idea you can play around with, using <code>Data.Map</code>. For simplicity and performance, I assume substitutivity for the element type, so we can count occurrences rather than storing lists of elements. I'm confident that you can get better results using some fancy array algorithm, but this is simple and (essentially) functional.</p>\n\n<p>When writing a parallel algorithm, we want to minimize the amount of work that must be done sequentially. When sorting a list, there's one thing that we really can't avoid doing sequentially: splitting up the list into pieces for multiple threads to work on. We'd like to get that done with as little effort as possible, and then try to work mostly in parallel from then on.</p>\n\n<p>Let's start with a simple sequential algorithm.</p>\n\n<pre><code>{-# language BangPatterns, TupleSections #-}\nimport qualified Data.Map.Strict as M\nimport Data.Map (Map)\nimport Data.List\nimport Control.Parallel.Strategies\n\ntype Bag a = Map a Int\n\nssort :: Ord a =&gt; [a] -&gt; [a]\nssort xs =\n  let m = M.fromListWith (+) $ (,1) &lt;$&gt; xs\n  in concat [replicate c x | (x,c) &lt;- M.toList m]\n</code></pre>\n\n<p>How can we parallelize this? First, let's break up the list into pieces. There are various ways to do this, none of them great. Assuming a small number of capabilities, I think it's reasonable to let each of them walk the list itself. Feel free to experiment with other approaches.</p>\n\n<pre><code>-- | Every Nth element, including the first\neveryNth :: Int -&gt; [a] -&gt; [a]\neveryNth n | n &lt;= 0 = error \"What you doing?\"\neveryNth n = go 0 where\n  go !_ [] = []\n  go 0 (x : xs) = x : go (n - 1) xs\n  go k (_ : xs) = go (k - 1) xs\n\n-- | Divide up a list into N pieces fairly. Walking each list in the\n-- result will walk the original list.\nsplatter :: Int -&gt; [a] -&gt; [[a]]\nsplatter n = map (everyNth n) . take n . tails\n</code></pre>\n\n<p>Now that we have pieces of list, we spark threads to convert them to bags.</p>\n\n<pre><code>parMakeBags :: Ord a =&gt; [[a]] -&gt; Eval [Bag a]\nparMakeBags xs = \n  traverse (rpar . M.fromListWith (+)) $ map (,1) &lt;$&gt; xs\n</code></pre>\n\n<p>Now we can repeatedly merge pairs of bags until we have just one.</p>\n\n<pre><code>parMergeBags_ :: Ord a =&gt; [Bag a] -&gt; Eval (Bag a)\nparMergeBags_ [] = pure M.empty\nparMergeBags_ [t] = pure t\nparMergeBags_ q = parMergeBags_ =&lt;&lt; go q where\n  go [] = pure []\n  go [t] = pure [t]\n  go (t1:t2:ts) = (:) &lt;$&gt; rpar (M.unionWith (+) t1 t2) &lt;*&gt; go ts\n</code></pre>\n\n<p>But ... there's a problem. In each round of merges, we use only half as many capabilities as we did in the previous one, and perform the final merge with just one capability. Ouch! To fix this, we'll need to parallelize <code>unionWith</code>. Fortunately, this is easy!</p>\n\n<pre><code>import Data.Map.Internal (Map (..), splitLookup, link)\n\nparUnionWith\n  :: Ord k\n  =&gt; (v -&gt; v -&gt; v)\n  -&gt; Int -- Number of threads to spark\n  -&gt; Map k v\n  -&gt; Map k v\n  -&gt; Eval (Map k v)\nparUnionWith f n t1 t2 | n &lt;= 1 = rseq $ M.unionWith f t1 t2\nparUnionWith _ !_ Tip t2 = rseq t2\nparUnionWith _ !_ t1 Tip = rseq t1\nparUnionWith f n (Bin _ k1 x1 l1 r1) t2 = case splitLookup k1 t2 of\n  (l2, mb, r2) -&gt; do\n    l1l2 &lt;- parEval $ parUnionWith f (n `quot` 2) l1 l2\n    r1r2 &lt;- parUnionWith f (n `quot` 2) r1 r2\n    case mb of\n      Nothing -&gt; rseq $ link k1 x1 l1l2 r1r2\n      Just x2 -&gt; rseq $ link k1 fx1x2 l1l2 r1r2\n        where !fx1x2 = f x1 x2\n</code></pre>\n\n<p>Now we can fully parallelize bag merging:</p>\n\n<pre><code>-- Uses the given number of capabilities per merge, initially,\n-- doubling for each round.\nparMergeBags :: Ord a =&gt; Int -&gt; [Bag a] -&gt; Eval (Bag a)\nparMergeBags !_ [] = pure M.empty\nparMergeBags !_ [t] = pure t\nparMergeBags n q = parMergeBags (n * 2) =&lt;&lt; go q where\n  go [] = pure []\n  go [t] = pure [t]\n  go (t1:t2:ts) = (:) &lt;$&gt; parEval (parUnionWith (+) n t1 t2) &lt;*&gt; go ts\n</code></pre>\n\n<p>We can then implement a parallel merge like this:</p>\n\n<pre><code>parMerge :: Ord a =&gt; [[a]] -&gt; Eval [a]\nparMerge xs = do\n  bags &lt;- parMakeBags xs\n  -- Why 2 and not one? We only have half as many\n  -- pairs as we have lists (capabilities we want to use)\n  -- so we double up.\n  m &lt;- parMergeBags 2 bags\n  pure $ concat [replicate c x | (x,c) &lt;- M.toList m]\n</code></pre>\n\n<p>Putting the pieces together,</p>\n\n<pre><code>parSort :: Ord a =&gt; Int -&gt; [a] -&gt; Eval [a]\nparSort n = parMerge . splatter n\n\npSort :: Ord a =&gt; Int -&gt; [a] -&gt; [a]\npSort n = runEval . parMerge . splatter n\n</code></pre>\n\n<hr>\n\n<p>There's just one sequential piece remaining that we can parallelize: converting the final bag to a list. Is it worth parallelizing? I'm pretty sure that in practice it is not. But let's do it anyway, just for fun! To avoid considerable extra complexity, I'll assume that there aren't large numbers of equal elements; repeated elements in the result will lead to some work (thunks) remaining in the result list.</p>\n\n<p>We'll need a basic partial list spine forcer:</p>\n\n<pre><code>-- | Force the first n conses of a list\nwalkList :: Int -&gt; [a] -&gt; ()\nwalkList n _ | n &lt;= 0 = ()\nwalkList _ [] = ()\nwalkList n (_:xs) = walkList (n - 1) xs\n</code></pre>\n\n<p>And now we can convert the bag to a list in parallel chunks <em>without</em> paying for concatenation:</p>\n\n<pre><code>-- | Use up to the given number of threads to convert a bag\n-- to a list, appending the final list argument.\nparToListPlus :: Int -&gt; Bag k -&gt; [k] -&gt; Eval [k]\nparToListPlus n m lst | n &lt;= 1 = do\n  rseq (walkList (M.size m) res)\n  pure res\n  -- Note: the concat and ++ should fuse away when compiling with\n  -- optimization.\n  where res = concat [replicate c x | (x,c) &lt;- M.toList m] ++ lst\nparToListPlus _ Tip lst = pure lst\nparToListPlus n (Bin _ x c l r) lst = do\n  r' &lt;- parEval $ parToListPlus (n `quot` 2) r lst\n  res &lt;- parToListPlus (n `quot` 2) l $ replicate c x ++ r'\n  rseq r' -- make sure the right side is finished\n  pure res\n</code></pre>\n\n<p>And then we modify the merger accordingly:</p>\n\n<pre><code>parMerge :: Ord a =&gt; Int -&gt; [[a]] -&gt; Eval [a]\nparMerge n xs = do\n  bags &lt;- parMakeBags xs\n  m &lt;- parMergeBags 2 bags\n  parToListPlus n m []\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 1, "accepted_answer_id": 55862382, "answer_count": 1, "score": 10, "last_activity_date": 1556340613, "creation_date": 1556020830, "last_edit_date": 1556091074, "question_id": 55810774, "link": "https://stackoverflow.com/questions/55810774/how-can-i-optimize-parallel-sorting-to-improve-temporal-performance", "title": "How can I optimize parallel sorting to improve temporal performance?", "body": "<p>I have an algorithm for parallel sorting a list of a given length:</p>\n\n<pre><code>import Control.Parallel (par, pseq)\nimport Data.Time.Clock (diffUTCTime, getCurrentTime)\nimport System.Environment (getArgs)\nimport System.Random (StdGen, getStdGen, randoms)\n\n\nparSort :: (Ord a) =&gt; [a] -&gt; [a]\nparSort (x:xs)    = force greater `par` (force lesser `pseq`\n                                         (lesser ++ x:greater))\n    where lesser  = parSort [y | y &lt;- xs, y &lt;  x]\n          greater = parSort [y | y &lt;- xs, y &gt;= x]\nparSort _         = []\n\nsort :: (Ord a) =&gt; [a] -&gt; [a]\nsort (x:xs) = lesser ++ x:greater\n    where lesser  = sort [y | y &lt;- xs, y &lt;  x]\n          greater = sort [y | y &lt;- xs, y &gt;= x]\nsort _ = []\n\nparSort2 :: (Ord a) =&gt; Int -&gt; [a] -&gt; [a]\nparSort2 d list@(x:xs)\n  | d &lt;= 0     = sort list\n  | otherwise = force greater `par` (force lesser `pseq`\n                                     (lesser ++ x:greater))\n      where lesser      = parSort2 d' [y | y &lt;- xs, y &lt;  x]\n            greater     = parSort2 d' [y | y &lt;- xs, y &gt;= x]\n            d' = d - 1\nparSort2 _ _              = []\n\nforce :: [a] -&gt; ()\nforce xs = go xs `pseq` ()\n    where go (_:xs) = go xs\n          go [] = 1\n\n\nrandomInts :: Int -&gt; StdGen -&gt; [Int]\nrandomInts k g = let result = take k (randoms g)\n                 in force result `seq` result\n\ntestFunction = parSort\n\nmain = do\n  args &lt;- getArgs\n  let count | null args = 500000\n            | otherwise = read (head args)\n  input &lt;- randomInts count `fmap` getStdGen\n  start &lt;- getCurrentTime\n  let sorted = testFunction input\n  putStrLn $ \"Sort list N = \" ++ show (length sorted)\n  end &lt;- getCurrentTime\n  putStrLn $ show (end `diffUTCTime` start) \n</code></pre>\n\n<p>I want to get the time to perform parallel sorting on 2, 3 and 4 processor cores less than 1 core.\nAt the moment, this result I can not achieve.\nHere are my program launches:</p>\n\n<pre><code>1. SortList +RTS -N1 -RTS 10000000\ntime = 41.2 s\n2.SortList +RTS -N3 -RTS 10000000\ntime = 39.55 s\n3.SortList +RTS -N4 -RTS 10000000\ntime = 54.2 s\n</code></pre>\n\n<p>What can I do?</p>\n\n<p><strong>Update 1:</strong></p>\n\n<pre><code>testFunction = parSort2 60\n</code></pre>\n"}, {"tags": ["csv", "haskell", "conduit"], "comments": [{"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1556013592, "post_id": 55808396, "comment_id": 98284775, "body": "The question could be somewhat improved cf. <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>. You mention dropping 4 rows or 4 columns, which is it? <code>intoCSV</code> should do the hard work of constructing your custom type, you just need to unwrap it with <code>getNamed</code>."}, {"owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "reply_to_user": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 0, "creation_date": 1556013699, "post_id": 55808396, "comment_id": 98284827, "body": "sorry 4 &quot;rows&quot;!! csv taken over my brain"}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 0, "last_activity_date": 1556232015, "creation_date": 1556232015, "answer_id": 55858504, "question_id": 55808396, "link": "https://stackoverflow.com/questions/55808396/remove-rows-with-conduit-csv/55858504#55858504", "title": "Remove rows with conduit-csv", "body": "<p>Because <code>intoCSV</code> expects to stream in the whole file, rather than read a stream of lines, you'll want to use a conduit that can parse and drop lines directly from an input bytestring stream, rather than trying to work with a list of lines.</p>\n\n<p>Something like the following should work:</p>\n\n<pre><code>parsePowerCsv bs = do\n  runConduit $\n      bs\n      .| (replicateM_ 4 (lineAsciiC sinkNull) &gt;&gt;\n          intoCSV defCSVSettings)\n      .| sinkList -- (dropC 4 &gt;&gt; sinkList)\n</code></pre>\n"}], "owner": {"reputation": 1598, "user_id": 1905334, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/oy40i.png?s=128&g=1", "display_name": "cmdv", "link": "https://stackoverflow.com/users/1905334/cmdv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1556232015, "creation_date": 1556012565, "last_edit_date": 1556034564, "question_id": 55808396, "link": "https://stackoverflow.com/questions/55808396/remove-rows-with-conduit-csv", "title": "Remove rows with conduit-csv", "body": "<p>trying to consume a csv file and remove the first 4 rows then continue with my parsing:</p>\n\n<pre><code>parsePowerCsv\n  :: MonadThrow m\n  =&gt; ConduitT () ByteString m () -&gt; m [PowerFields]\nparsePowerCsv bs = do\n  runConduit $\n       bs\n      .| CL.consume\n      .| (dropC 4 &gt;&gt; intoCSV defCSVSettings)\n\n</code></pre>\n\n<p>So I'm able to produce a list of <code>Text</code> but want to be able to convert to my <code>PowerFields</code> type easily since I have <code>From/To NamedRecord</code> instances but I want to remove those first 4 rows.</p>\n\n<p>so after <code>dropC</code> I am not able to parse the <code>[Text]</code>to the  <code>[PowerFields]</code></p>\n\n<pre><code>data PowerFields =\n  PowerFields\n    { VA_avg         :: Maybe Double\n    , A_avg          :: Maybe Double\n    , Wh_sum         :: Maybe Double\n    ...\n    } deriving (Eq, Show, Read)\n</code></pre>\n"}, {"tags": ["haskell", "preorder"], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1556005736, "post_id": 55806472, "comment_id": 98280743, "body": "Aw darn you added a question 1 section.  I liked our univocal double-answer."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1556006090, "post_id": 55806472, "comment_id": 98280882, "body": "@luqui I realized there was a question 1 after I answered question 2, so I first marked the answer as Q2-only and I started to edit to complete the answer. Yes, the &quot;split&quot; answers looked better, in some aesthetic way :)"}, {"owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1556010900, "post_id": 55806472, "comment_id": 98283361, "body": "Just now I have corrected it after your tipps. But there is still one error  in the following line:  <code>preorder Empty = []</code>. The error is <code>E:\\Haskell\\Uebungsblatt_2_Aufgabe_2_a.hs:8:1: error:     Equations for `preorder&#39; have different numbers of arguments       E:\\Haskell\\Uebungsblatt_2_Aufgabe_2_a.hs:8:1-19       E:\\Haskell\\Uebungsblatt_2_Aufgabe_2_a.hs:9:1-35   | 8 | preorder Empty = []    | ^^^^^^^^^^^^^^^^^^^^... [Finished in 0.5s]</code> @chi @luqui"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "edited": false, "score": 0, "creation_date": 1556022083, "post_id": 55806472, "comment_id": 98289114, "body": "@LeonhardFelix You need more parentheses: <code>preorder Branch a l r = ...</code> is a function which takes 4 arguments, while what you want is <code>preorder (Branch a l r) = ...</code>. I edited my answer accordingly."}, {"owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "edited": false, "score": 0, "creation_date": 1556025901, "post_id": 55806472, "comment_id": 98291339, "body": "@chi   Thanks a lot"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1556021990, "last_edit_date": 1556021990, "creation_date": 1556005465, "answer_id": 55806472, "question_id": 55806328, "link": "https://stackoverflow.com/questions/55806328/with-preorder-to-traverse-inttree/55806472#55806472", "title": "with Preorder to traverse IntTree", "body": "<p>For question 1: the signature</p>\n\n<pre><code>preorder :: (IntTree c) =&gt; c-&gt;[a]\n</code></pre>\n\n<p>is wrong: <code>IntTree</code> is not a typeclass, it is a plain type, so we can use it as it is.</p>\n\n<pre><code>preorder :: IntTree -&gt; [Int]\n</code></pre>\n\n<p>The final type must be <code>Int</code>, since we are producing a list of integers, and not a  list of <code>[a]</code> for any <code>a</code>.</p>\n\n<p>For question 2:\n<code>:</code> prepends an <em>element</em> to a <em>list</em>, it has type</p>\n\n<pre><code>(:) :: a -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>Hence, it does not concatenate two lists. For that, use instead</p>\n\n<pre><code>(++) :: [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>as in</p>\n\n<pre><code>preorder (Branch a l r) = l : preorder a ++ preorder r\n</code></pre>\n\n<p>(There is no need to use <code>++ []</code> at the end)</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 2, "last_activity_date": 1556005642, "creation_date": 1556005642, "answer_id": 55806512, "question_id": 55806328, "link": "https://stackoverflow.com/questions/55806328/with-preorder-to-traverse-inttree/55806512#55806512", "title": "with Preorder to traverse IntTree", "body": "<p>For question 1:</p>\n\n<pre><code>preorder :: (IntTree c) =&gt; c-&gt;[a]\n</code></pre>\n\n<p>You are confusing classes and data types.  <code>IntTree</code> was declared with <code>data</code>, so it is not a typeclass but a regular data type, such as <code>Bool</code> or <code>Int</code>.  It is used the same way:</p>\n\n<pre><code>preorder :: IntTree -&gt; [a]\n</code></pre>\n\n<p>The second thing is that you are not returning a list of any type <code>a</code> (lowercase letters are type <em>variables</em>), you are returning specifically a list of <code>Int</code>s, because that's what the tree contains.  So you must say so:</p>\n\n<pre><code>preorder :: IntTree -&gt; [Int]\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 11398222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mdyJg.png?s=128&g=1", "display_name": "Leonhard Felix", "link": "https://stackoverflow.com/users/11398222/leonhard-felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1556021990, "creation_date": 1556004839, "question_id": 55806328, "link": "https://stackoverflow.com/questions/55806328/with-preorder-to-traverse-inttree", "title": "with Preorder to traverse IntTree", "body": "<p>I am trying to create a preorder Function to traverse a IntTree. </p>\n\n<p>The Tree class is as following</p>\n\n<pre><code>data IntTree = Empty | Branch IntTree Int IntTree deriving (Show, Eq)\n</code></pre>\n\n<p>I have two questions\n1. I get errors as shown below.</p>\n\n<pre><code>E:\\Haskell\\Uebungsblatt_2_Aufgabe_2_a.hs:7:14: error:\n    * Expected kind `* -&gt; Constraint', but `IntTree' has kind `*'\n    * In the type signature: preorder :: (IntTree c) =&gt; c -&gt; [a]\n  |\n7 | preorder :: (IntTree c) =&gt; c-&gt;[a]\n\n  |              ^^^^^^^^^\n[Finished in 0.5s]\n</code></pre>\n\n<p>I don't see why. They occured at this following line</p>\n\n<pre><code>preorder :: (IntTree c) =&gt; c-&gt;[a]\n</code></pre>\n\n<ol start=\"2\">\n<li><p>I think that the following line is not right. I think I need to write other expressions instead of \" l : preorder a : preorder r:[] \"</p></li>\n</ol>\n\n<pre><code>preorder Branch a l r = l : preorder a : preorder r:[]\n</code></pre>\n\n<p>I thank you for the help in advance!!</p>\n\n<pre><code>main :: IO ()    -- This says that main is an IO action.\nmain = return () -- This tells main to do nothing\n\ndata IntTree = Empty | Branch IntTree Int IntTree deriving (Show, Eq)\n\n\npreorder :: (IntTree c) =&gt; c-&gt;[a]\npreorder Empty = []\npreorder Branch Empty x Empty = [x]\npreorder Branch a l r = l : preorder a : preorder r:[]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1555997407, "post_id": 55804770, "comment_id": 98277515, "body": "You are probably looking for <a href=\"http://hackage.haskell.org/package/streaming-bytestring\" rel=\"nofollow noreferrer\"><i>streaming-bytestring</i></a> and <a href=\"http://hackage.haskell.org/package/streaming-binary\" rel=\"nofollow noreferrer\"><i>streaming-binary</i></a>. See also: <a href=\"https://packdeps.haskellers.com/reverse/streaming\" rel=\"nofollow noreferrer\">reverse dependencies of <i>streaming</i></a>."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1556000370, "post_id": 55804770, "comment_id": 98278506, "body": "There&#39;s also pipes-bytestring <a href=\"http://hackage.haskell.org/package/pipes-bytestring\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/pipes-bytestring</a> and conduit <a href=\"http://hackage.haskell.org/package/conduit-1.3.1.1/docs/Conduit.html#v:sourceFile\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/conduit-1.3.1.1/docs/&hellip;</a>"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1556029370, "post_id": 55804770, "comment_id": 98293535, "body": "Why&#39;d you think <code>streaming</code> would make your program faster? Packages like that are mostly meant to make dealing with data streams <i>more convenient</i>, not to make them <i>faster</i>."}, {"owner": {"reputation": 1185, "user_id": 3228230, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/m9lny.jpg?s=128&g=1", "display_name": "paperduck", "link": "https://stackoverflow.com/users/3228230/paperduck"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1556069519, "post_id": 55804770, "comment_id": 98308400, "body": "@Cubic In my case, speed is important."}], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 3, "last_activity_date": 1556042348, "last_edit_date": 1556042348, "creation_date": 1556000012, "answer_id": 55805303, "question_id": 55804770, "link": "https://stackoverflow.com/questions/55804770/fastest-way-to-read-large-binary-file-in-haskell/55805303#55805303", "title": "Fastest way to read large binary file in Haskell?", "body": "<p>With only <em>streaming</em> and <em>bytestring</em>, one can write something like:</p>\n\n<pre><code>import           Data.ByteString\nimport           Streaming\nimport qualified Streaming.Prelude as S\nimport           System.IO\n\nfromHandle :: Int -&gt; Handle -&gt; Stream (Of ByteString) IO ()\nfromHandle chunkSize h = \n    S.untilRight $ do bytes &lt;- Data.ByteString.hGet h chunkSize\n                      pure $ if Data.ByteString.null bytes then Right ()\n                                                           else Left bytes\n</code></pre>\n\n<p>Using <a href=\"http://hackage.haskell.org/package/bytestring-0.10.8.2/docs/Data-ByteString.html#v:hGet\" rel=\"nofollow noreferrer\"><code>hGet</code></a>, <a href=\"http://hackage.haskell.org/package/bytestring-0.10.8.2/docs/Data-ByteString.html#v:null\" rel=\"nofollow noreferrer\"><code>null</code></a> from <em>bytestring</em>, and <a href=\"http://hackage.haskell.org/package/streaming-0.2.2.0/docs/Streaming-Prelude.html#v:untilRight\" rel=\"nofollow noreferrer\"><code>untilRight</code></a> from <em>streaming</em>. You will need to use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/System-IO.html#v:withFile\" rel=\"nofollow noreferrer\"><code>withFile</code></a> to get the <code>Handle</code>, and consume the <code>Stream</code> within the callback:</p>\n\n<pre><code>dump :: FilePath -&gt; IO ()\ndump file = withFile file ReadMode go\n where\n   go :: Handle -&gt; IO ()\n   go = S.mapM_ (Data.ByteString.hPut stdout) . fromHandle 4096 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 4, "last_activity_date": 1556033463, "creation_date": 1556033463, "answer_id": 55814664, "question_id": 55804770, "link": "https://stackoverflow.com/questions/55804770/fastest-way-to-read-large-binary-file-in-haskell/55814664#55814664", "title": "Fastest way to read large binary file in Haskell?", "body": "<p>To elaborate on @Cubic's comment, while there's a general consensus that lazy I/O should be avoided in production code and replaced with a streaming approach, this is <strong>not</strong> directly related to performance.  If you're writing a program to do some one-off processing of a large file, as long as you have a lazy I/O version running fine now, there's  probably no good <em>performance</em> reason to convert it over to a streaming package.</p>\n\n<p>In fact, streaming is more likely to add some overhead, so I suspect that a well optimized lazy I/O solution would out-perform a well optimized streaming solution, in most cases.</p>\n\n<p>The main reasons for avoiding Lazy I/O have been <a href=\"https://stackoverflow.com/questions/5892653/whats-so-bad-about-lazy-i-o\">previously discussed on SO</a>.  In a nutshell, lazy I/O makes it difficult to consistently manage resources (e.g., file handles and network sockets), makes it hard to reason about space usage (e.g., a small program change can cause your memory usage to explode), and is occasionally \"unsafe\" if the timing and ordering of the I/O in question matters (usually not a problem if you're just reading in one set of files and/or writing out another set of files).</p>\n\n<p>Short-running utility programs for reading and/or writing large files are probably good candidates to be written in a lazy I/O style.  As long as they don't have any obvious space leaks when they're run, they're probably fine.</p>\n"}], "owner": {"reputation": 1185, "user_id": 3228230, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/m9lny.jpg?s=128&g=1", "display_name": "paperduck", "link": "https://stackoverflow.com/users/3228230/paperduck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 2, "accepted_answer_id": 55814664, "answer_count": 2, "score": 8, "last_activity_date": 1556042348, "creation_date": 1555996783, "last_edit_date": 1555997437, "question_id": 55804770, "link": "https://stackoverflow.com/questions/55804770/fastest-way-to-read-large-binary-file-in-haskell", "title": "Fastest way to read large binary file in Haskell?", "body": "<p>I want to process a binary file that is too large to read into memory. Currently I use <a href=\"http://hackage.haskell.org/package/bytestring-0.10.8.2/docs/Data-ByteString-Lazy.html\" rel=\"noreferrer\">ByteString.Lazy.readFile</a> to stream the bytes. I thought it would be a good idea to use the <a href=\"http://hackage.haskell.org/package/streaming-0.2.2.0\" rel=\"noreferrer\">streaming</a> package to make my program faster. However, the <a href=\"http://hackage.haskell.org/package/streaming-0.2.2.0/docs/Streaming-Prelude.html\" rel=\"noreferrer\">documentation</a> for <code>readFile</code> says:</p>\n\n<blockquote>\n  <p><code>readFile :: FilePath -&gt; (Stream (Of String) IO () -&gt; IO a) -&gt; IO a</code></p>\n  \n  <p>Read the lines of a file, using a function of the type: 'Stream (Of String) IO () -> IO a' to turn the stream into a value of type 'IO a'.</p>\n</blockquote>\n\n<p>So the <code>streaming</code> package only reads ASCII text files? Can I use this package to read a binary file as bytes?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1555992774, "post_id": 55804177, "comment_id": 98276374, "body": "What you have written already requires all of your <code>-- something</code> placeholders to return the same type, so your objection to <code>case</code> doesn&#39;t really apply."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1555992982, "post_id": 55804177, "comment_id": 98276429, "body": "(1) &quot;that would require all my cases to return the same type and is therefore not as general (correct me if I&#39;m wrong)&quot; -- you also have to return the same type in both branches of an if-expression. Other than syntax, there is essentially no difference between an if-expression and a case-expression on <code>Bool</code>. (2) &quot;I have also tried considering using guards here, but I don&#39;t know how to make this work in a do statement&quot; -- You can&#39;t use guards within a do-block; if-expressions are indeed the right thing to reach for."}, {"owner": {"reputation": 181, "user_id": 3186072, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54637aeab7e6de256d7d4dac5efc1edb?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeySeeMonkeyCode", "link": "https://stackoverflow.com/users/3186072/monkeyseemonkeycode"}, "edited": false, "score": 0, "creation_date": 1555994610, "post_id": 55804177, "comment_id": 98276793, "body": "Sorry, I misspoke in my original question, it is not the <code>-- something</code> placeholders returning the same type that I am trying to avoid, it is the conditions (<code>a</code>, <code>b</code> and <code>c</code>). I&#39;ve edited my answer."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 3186072, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54637aeab7e6de256d7d4dac5efc1edb?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeySeeMonkeyCode", "link": "https://stackoverflow.com/users/3186072/monkeyseemonkeycode"}, "edited": false, "score": 0, "creation_date": 1555994976, "post_id": 55804452, "comment_id": 98276887, "body": "Thank you! This is <i>exactly</i> what I was looking for as an answer. Sorry for my typo in my original question. Haskell is great fun so far!"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 181, "user_id": 3186072, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54637aeab7e6de256d7d4dac5efc1edb?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeySeeMonkeyCode", "link": "https://stackoverflow.com/users/3186072/monkeyseemonkeycode"}, "edited": false, "score": 1, "creation_date": 1555995085, "post_id": 55804452, "comment_id": 98276921, "body": "@Utagai You&#39;re welcome, and worry not -- if you only knew how many typos I make in my posts... :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 181, "user_id": 3186072, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54637aeab7e6de256d7d4dac5efc1edb?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeySeeMonkeyCode", "link": "https://stackoverflow.com/users/3186072/monkeyseemonkeycode"}, "edited": false, "score": 3, "creation_date": 1555995235, "post_id": 55804452, "comment_id": 98276960, "body": "@Utagai, if you don&#39;t want to use <code>MultiWayIf</code>, you can use <code>case () of _ | ...</code>. Uglier, but standard."}, {"owner": {"reputation": 181, "user_id": 3186072, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54637aeab7e6de256d7d4dac5efc1edb?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeySeeMonkeyCode", "link": "https://stackoverflow.com/users/3186072/monkeyseemonkeycode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1555995425, "post_id": 55804452, "comment_id": 98277006, "body": "Thanks @dfeuer, didn&#39;t realize I could use a <code>case</code> like that but reading it, I see why it works. Thank you!"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 10, "last_activity_date": 1555994644, "creation_date": 1555994644, "answer_id": 55804452, "question_id": 55804177, "link": "https://stackoverflow.com/questions/55804177/handling-nested-if-else-then-in-do-blocks-in-haskell/55804452#55804452", "title": "Handling nested if-else-then in do blocks in Haskell", "body": "<p>To begin with, it is worth noting that if-expressions do not actually require extra indentation (if-within-do used to be an exception, but Haskell 2010 eliminated that). That means you might collapse all the extra indentation:</p>\n\n<pre><code>test = do\n    len &lt;- length &lt;$&gt; getLine\n    if len &lt; 4\n    then putStrLn \"Short\"\n    else if len &gt; 6\n    then putStrLn \"Long\"\n    else putStrLn \"Mid\"\n</code></pre>\n\n<p>Personally, though, I don't find that too pleasing aesthetically, as I feel <em>some</em> indentation makes if-expressions easier to follow. A nice alternative is using <a href=\"https://downloads.haskell.org/~ghc/8.6.4/docs/html/users_guide/glasgow_exts.html#multi-way-if-expressions\" rel=\"noreferrer\">the <code>MultiWayIf</code> extension</a>:</p>\n\n<pre><code>{-# LANGUAGE MultiWayIf #-}\n\ntest = do\n    len &lt;- length &lt;$&gt; getLine\n    if | len &lt; 4 -&gt; putStrLn \"Short\"\n       | len &gt; 6 -&gt; putStrLn \"Long\"\n       | otherwise -&gt; putStrLn \"Mid\"\n</code></pre>\n\n<p>On a final note, nested if-expressions getting unwieldy might reveal a good occasion for breaking things down in separate definitions, or otherwise reorganising your code. See also: <a href=\"https://stackoverflow.com/q/33005903/2751851\"><em>How do I deal with many levels of indentation?</em></a></p>\n"}], "owner": {"reputation": 181, "user_id": 3186072, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54637aeab7e6de256d7d4dac5efc1edb?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeySeeMonkeyCode", "link": "https://stackoverflow.com/users/3186072/monkeyseemonkeycode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 55804452, "answer_count": 1, "score": 4, "last_activity_date": 1555994731, "creation_date": 1555992464, "last_edit_date": 1555994731, "question_id": 55804177, "link": "https://stackoverflow.com/questions/55804177/handling-nested-if-else-then-in-do-blocks-in-haskell", "title": "Handling nested if-else-then in do blocks in Haskell", "body": "<p>I've found that I don't know how to handle nested <code>if-else-then</code> in <code>do</code>-blocks in Haskell.</p>\n\n<p>I know already that I can use a <code>case</code>, but that would require all my conditions (<code>a</code>, <code>b</code> and <code>c</code>) to return the same type (<code>Bool</code>, so there are only two cases, but I need three distinct ones) and is therefore not as general (correct me if I'm wrong). I have also tried considering using guards here, but I don't know how to make this work in a <code>do</code> statement, especially if the <code>-- something</code> expressions are meant to be of type <code>IO ()</code>.</p>\n\n<p>Suppose I have the following code that is inside a <code>do</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>if a then\n     -- something\nelse \n    if b then\n        -- something\n    else\n        if c then\n            -- something\n        else\n            -- something\n</code></pre>\n\n<p>How do I create the equivalent logic but without all the indenting?</p>\n"}, {"tags": ["haskell", "algebraic-data-types"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9227001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b8c6a7a237f5cd46296e765aa2d2a1f?s=128&d=identicon&r=PG&f=1", "display_name": "Nicekor", "link": "https://stackoverflow.com/users/9227001/nicekor"}, "edited": false, "score": 0, "creation_date": 1556032750, "post_id": 55803222, "comment_id": 98295690, "body": "Thank you very much! Bit of a dumb question but i&#39;m a rookie in Haskell :)"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 5, "last_activity_date": 1555984167, "creation_date": 1555984167, "answer_id": 55803222, "question_id": 55803072, "link": "https://stackoverflow.com/questions/55803072/algebraic-types-haskell/55803222#55803222", "title": "Algebraic Types - Haskell", "body": "<p>You need to pattern match on data constructors (like <code>Circle</code> and <code>Rectangle</code>), not on type constructors as you're trying to do now (like <code>Shape</code>). For <code>PositionedShape</code>, they happen to have the same name, although you completely forgot the match on this one (and in fact, you don't need to care about the inner <code>Shape</code> at all except to copy it through). Also, <code>move</code> is meant to move the shape by the given distances, not to move it to a new given position;.</p>\n"}, {"tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": false, "score": 3, "last_activity_date": 1555993054, "creation_date": 1555993054, "answer_id": 55804244, "question_id": 55803072, "link": "https://stackoverflow.com/questions/55803072/algebraic-types-haskell/55804244#55804244", "title": "Algebraic Types - Haskell", "body": "<p>You need to use the <code>PositionedShape</code> constructor to break apart a <code>PositionedShape</code>  You have used the <code>Shape</code> constructor instead.</p>\n\n<p>Try starting with:</p>\n\n<p>move (PositionedShape shape (Point old_x old_y)) [...]</p>\n"}, {"tags": [], "owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "is_accepted": false, "score": 2, "last_activity_date": 1556002730, "creation_date": 1556002730, "answer_id": 55805854, "question_id": 55803072, "link": "https://stackoverflow.com/questions/55803072/algebraic-types-haskell/55805854#55805854", "title": "Algebraic Types - Haskell", "body": "<p>How about</p>\n\n<pre><code>move (PointedShape s (Point x y)) dx dy = PointedShape s (Point (x+dx) (y+dy))\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 9227001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b8c6a7a237f5cd46296e765aa2d2a1f?s=128&d=identicon&r=PG&f=1", "display_name": "Nicekor", "link": "https://stackoverflow.com/users/9227001/nicekor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 55803222, "answer_count": 3, "score": 3, "last_activity_date": 1556023726, "creation_date": 1555982658, "last_edit_date": 1556023726, "question_id": 55803072, "link": "https://stackoverflow.com/questions/55803072/algebraic-types-haskell", "title": "Algebraic Types - Haskell", "body": "<p>I am working around with algebraic types in Haskell, doing some exercises from a worksheet. I got the following exercises:</p>\n\n<blockquote>\n  <ol>\n  <li>Define an algebraic type Point for representing (the coordinates of) points in twodimensional space.</li>\n  </ol>\n</blockquote>\n\n<p><strong>My code for this exercise:</strong></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Point = Point Float Float\n  deriving (Show)\n</code></pre>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Using Point, define a modified version PositionedShape of the Shape data type which\n  includes the centre point of a shape, in addition to its dimensions.</li>\n  </ol>\n</blockquote>\n\n<p><strong>Shape data previously defined:</strong></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Shape = Circle Float |\n             Rectangle Float Float\n             deriving (Show)\n</code></pre>\n\n<p><strong>My code for this exercise:</strong></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data PositionedShape = PositionedShape Shape Point\n  deriving (Show)\n</code></pre>\n\n<p><strong>Now my question comes in this one:</strong></p>\n\n<blockquote>\n  <p>Define a function:</p>\n  \n  <p><code>haskell move :: PositionedShape -&gt; Float -&gt; Float -&gt; PositionedShape</code></p>\n  \n  <p>which moves a shape by the given x and y distances</p>\n</blockquote>\n\n<p><strong>My implementation for this was the following:</strong></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>move :: PositionedShape -&gt; Float -&gt; Float -&gt; PositionedShape\nmove (Shape (Point x y)) newX newY = Shape (Point newX newY)\n</code></pre>\n\n<p><strong>This is returning me this error:</strong></p>\n\n<blockquote>\n  <p>Week8.hs:103:7: error: Not in scope: data constructor \u2018Shape\u2019\n  Failed, modules loaded: none.</p>\n</blockquote>\n\n<p>Can someone please explain me why this error and how can I solve it? I am getting a bit confused with algebraic types, I tried a lot of things but it just seems I can't get a solution.</p>\n"}, {"tags": ["haskell", "monads", "state-machine"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1556031822, "post_id": 55802920, "comment_id": 98295056, "body": "Continuing the &quot;indexed monad&quot; intuition, I suppose you might consider including something like <code>bind :: IState a b v -&gt; (v -&gt; IState b c v&#39;) -&gt; IState a c v&#39;</code>, no? But then <code>bind redToGreen (\\_ -&gt; greenToBlue)</code> is well-typed and changes from <code>Red</code> to <code>Blue</code>. Should the compiler reject that, too?"}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1556219729, "post_id": 55802920, "comment_id": 98373783, "body": "@DanielWagner To address your comment below, the main interaction would be <code>step :: s -&gt; i -&gt; s&#39;</code>, (moore version). My goal is to separate the definition of the state machine (its structure, which states are adjacent to each-other) from the implementation of the state transitions (<code>step</code>s). If <code>f :: Red -&gt; Green</code>, <code>g :: Green -&gt; Blue</code>, <code>h :: Blue -&gt; Red</code> are all my transition functions, then <code>step</code> should be defined in such a way that it NEVER goes <code>Red -&gt; Blue</code>, if it does warn me. So <code>bind redToGreen (\\_ -&gt; greenToBlue)</code> should be rejected. Perhaps the indexed monad is not what I want."}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1556220922, "post_id": 55802920, "comment_id": 98374317, "body": "I should have posted the working code (basically what you answered, though not as concise), then asked how can I make the compiler warn me if <code>colorChange Red _ = Green</code> accidentally gets changed to <code>colorChange Red _ = Blue</code>. Or any change that would break the structure <code>Red -&gt; Green -&gt; Blue -&gt; Red</code> and so on. Instead I muddied the water with an indexed monad."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1556221542, "post_id": 55802920, "comment_id": 98374623, "body": "But your code already breaks that structure: <code>colorChange _ False</code> does e.g. a transition <code>Red -&gt; Red</code>..."}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1556222025, "post_id": 55802920, "comment_id": 98374840, "body": "Sorry, my example was poor. In this case I would also have identity transitions for each state, <code>idRed :: Red -&gt; Red</code>, <code>idGreen :: Green -&gt; Green</code>,  <code>idBlue :: Blue -&gt; Blue</code>. Along with  <code>f :: Red -&gt; Green</code>, <code>g :: Green -&gt; Blue</code>, <code>h :: Blue -&gt; Red</code>."}, {"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1556222496, "post_id": 55802920, "comment_id": 98375021, "body": "furthermore, invalid transitions are: <code>Red -&gt; Blue</code>, <code>Green -&gt; Red</code>, <code>Blue -&gt; Green</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1555982597, "post_id": 55802985, "comment_id": 98274509, "body": "This is what I am currently using in my project and it works great for this specific example. However, if I change <code>colorChange Red _ = Green</code> to <code>colorChange Red _ = Blue</code> the compiler doesn&#39;t warn me that the structure of the state machine has changed, because <code>Green</code> and <code>Blue</code> are the same type. Thats the issue I have started to encounter as machine complexity increases and was hoping Indexed monads could help solve. Kind of like an added sanity check that the overall state machine structure is still preserved as I add more changes."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "edited": false, "score": 0, "creation_date": 1556029784, "post_id": 55802985, "comment_id": 98293762, "body": "@dopamane Okay. Then I don&#39;t understand the question. The types you&#39;ve proposed in the question don&#39;t enforce anything like that (even after fixing up your <code>colorChange</code> type errors). Perhaps it would help if you talked a little bit about what interactions with the state machine you want to make available. Running it, I suppose? What else? What things are illegal in what states, or what interactions do you want to rule out, or... just generally what is it exactly you&#39;re trying to do?"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1555981822, "creation_date": 1555981822, "answer_id": 55802985, "question_id": 55802920, "link": "https://stackoverflow.com/questions/55802920/how-to-use-indexed-monad-as-fsm/55802985#55802985", "title": "How to use indexed monad as FSM?", "body": "<p>I recommend keeping it simple.</p>\n\n<pre><code>data Color = Red | Green | Blue\n\ncolorChange :: Color -&gt; Bool -&gt; Color\ncolorChange s     False = s\ncolorChange Red   _     = Green\ncolorChange Green _     = Blue\ncolorChange Blue  _     = Red\n</code></pre>\n"}], "owner": {"reputation": 1197, "user_id": 4051020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42660a4e623fd8d2c850081291bcb585?s=128&d=identicon&r=PG&f=1", "display_name": "dopamane", "link": "https://stackoverflow.com/users/4051020/dopamane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555985203, "creation_date": 1555981245, "last_edit_date": 1555985203, "question_id": 55802920, "link": "https://stackoverflow.com/questions/55802920/how-to-use-indexed-monad-as-fsm", "title": "How to use indexed monad as FSM?", "body": "<p>I am trying to create a simple state machine that changes color state when input is valid: \n<code>Red</code> -> <code>Green</code> -> <code>Blue</code> -> <code>Red</code> ...</p>\n\n<p>I want to be able to explicitly define the state transitions. After reading <a href=\"https://stackoverflow.com/questions/28690448/what-is-indexed-monad\">What is indexed monad?</a> and Stephen Diehl's <a href=\"http://dev.stephendiehl.com/hask/#indexed-monads\" rel=\"nofollow noreferrer\">What I Wish I Knew</a>, the indexed monad seems to be what I need. So far I have the following code:</p>\n\n<pre><code>import Prelude hiding ( return )\n\nnewtype IState i o a = IState { runIState :: i -&gt; (a, o) }\n\nexecIState :: IState i o a -&gt; i -&gt; o\nexecIState st i = snd $ runIState st i\n\nreturn :: a -&gt; IState s s a\nreturn a = IState $ \\s -&gt; (a,s)\n\nput :: o -&gt; IState i o ()\nput o = IState $ const ((), o)\n\ndata Red   = Red\ndata Green = Green\ndata Blue  = Blue\n\nblueToRed :: IState Blue Red ()\nblueToRed = put Red\n\nredToGreen :: IState Red Green ()\nredToGreen = put Green\n\ngreenToBlue :: IState Green Blue ()\ngreenToBlue = put Blue\n\nnewtype Color a = Color a\n\ncolorChange\n  :: Color a\n  -&gt; Bool\n  -&gt; Color a\ncolorChange s@(Color c) valid = Color $ flip execIState c $ case s of\n  (Color Red)   | valid -&gt; redToGreen\n  (Color Green) | valid -&gt; greenToBlue\n  (Color Blue)  | valid -&gt; blueToRed\n  _ -&gt; return ()\n</code></pre>\n\n<p>This code gives the error:</p>\n\n<pre><code>Couldn't match type `Blue' with `Green'\n      Expected type: IState a Green ()\n        Actual type: IState Green Blue ()\n    * In the expression: greenToBlue\n      In a case alternative: (Color Green) | valid -&gt; greenToBlue\n      In the second argument of `($)', namely\n        `case s of\n           (Color Red) | valid -&gt; redToGreen\n           (Color Green) | valid -&gt; greenToBlue\n           (Color Blue) | valid -&gt; blueToRed\n           _ -&gt; return ()'\n   |\n39 |   (Color Green) | valid -&gt; greenToBlue\n\n\nCouldn't match type `Red' with `Green'\n      Expected type: IState a Green ()\n        Actual type: IState Blue Red ()\n    * In the expression: blueToRed\n      In a case alternative: (Color Blue) | valid -&gt; blueToRed\n      In the second argument of `($)', namely\n        `case s of\n           (Color Red) | valid -&gt; redToGreen\n           (Color Green) | valid -&gt; greenToBlue\n           (Color Blue) | valid -&gt; blueToRed\n           _ -&gt; return ()'\n   |\n40 |   (Color Blue)  | valid -&gt; blueToRed\n</code></pre>\n\n<p>I understand that the types <code>Red</code>, <code>Green</code>, and <code>Blue</code> are different. But the errors do not make sense to me, why would the compiler expect <code>IState a Green ()</code> when <code>greenToBlue :: IState Green Blue ()</code>? It seems to me it is expecting all types to \"match\" the first <code>case</code> pattern <code>redToGreen</code>. How do I work around this to create my state transfer function? The \"What is indexed monad?\" post used GADTs, so I thought maybe that would help, but I could not get the example in that post working and I have not used GADTs before, just read about them. </p>\n\n<p>Note this is very simple for debugging and learning purposes, I plan to use this when complexity of my FSMs increase. </p>\n\n<p><strong>Clarification</strong>: I want the compiler to give an error if the state transfer function does not preserve the state machine structure. Say I define the state machine structure as: <code>Red</code> -> <code>Green</code> -> <code>Blue</code> -> <code>Red</code> ... but if I accidentally change my <code>colorChange</code> function so <code>Red</code> -> <code>Blue</code>, the compiler should issue an error as this violates the state machine structure where <code>Green</code> must follow <code>Red</code>. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1555975937, "post_id": 55801749, "comment_id": 98273273, "body": "I suspect your code is actually ok as-is. The naming requirement is, unfortunately, obscuring things. Try something: Add in the function <code>showInt :: Int -&gt; String; showInt = Prelude.show</code> and then rewrite your <code>show</code> so that it is named <code>myShow</code> instead and use <code>showInt</code>. Also, remove <code>deriving Show</code> from your <code>data</code> definition. I think doing this could help clarify things."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1555971962, "post_id": 55801834, "comment_id": 98272370, "body": "Can you explain your second answer a bit? It isn&#39;t written in main, the code is exactly as it looks."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1556033816, "post_id": 55801834, "comment_id": 98296319, "body": "The point is that you need a qualified name to distinguish <i>your</i> <code>show</code> function from the method provided by the Prelude via the <code>Show</code> class. It might not be <code>Main</code>, and you might need to actually <i>define</i> a module so that there is a qualified name to use."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1555971599, "creation_date": 1555971599, "answer_id": 55801834, "question_id": 55801749, "link": "https://stackoverflow.com/questions/55801749/turn-a-data-type-into-a-string-for-display-without-show/55801834#55801834", "title": "Turn a data type into a String for display without `show`", "body": "<p>You can either disable the <code>show</code> method defined by <code>Show</code>:</p>\n\n<pre><code>import Prelude hiding (show)\n</code></pre>\n\n<p>or you can explicitly refer to <code>show</code> defined in your module. Assuming it is defined in <code>Main</code>,</p>\n\n<pre><code>main = putStrLn $ Main.show (Val 3)\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1555971877, "post_id": 55801836, "comment_id": 98272347, "body": "That&#39;s great but there&#39;s no way that&#39;s an allowable answer for this; he wants us to figure out a way to show them with...something. A function helper? I have no idea. Is this legitimately the only way to display it? Usually we&#39;re not allowed to import something unless specified."}, {"owner": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "edited": false, "score": 1, "creation_date": 1555972248, "post_id": 55801836, "comment_id": 98272457, "body": "Can you go into more detail about these constraints you&#39;re working under? How much of this code is yours to modify and how much is the instructor&#39;s?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1555972374, "post_id": 55801836, "comment_id": 98272495, "body": "<code>show :: Math -&gt; String</code> is the teachers, with: write a function that displays a String of the type. Really, I can use some library calls but I know that importing something to go around his question won&#39;t be what he wants."}, {"owner": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "edited": false, "score": 0, "creation_date": 1555972482, "post_id": 55801836, "comment_id": 98272511, "body": "In the base library, the only way to get the string representation of an <code>Int</code> is to call <code>show</code> from Prelude, one way or another."}, {"owner": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "edited": false, "score": 1, "creation_date": 1555972550, "post_id": 55801836, "comment_id": 98272522, "body": "Is it possible that you&#39;re supposed to be implementing the <code>Show</code> <i>class</i> by hand instead of letting GHC do it with <code>deriving Show</code>? That would also involve implementing a <code>show :: Math -&gt; String</code>, just inside an instance definition."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1555972735, "post_id": 55801836, "comment_id": 98272569, "body": "I did add <code>deriving Show</code> to the data type myself but I could define it with the function myself instead of using it in the data type?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1555973085, "post_id": 55801836, "comment_id": 98272630, "body": "@Francis In this answer, the only place that the builtin <code>show</code> is being is the very first line of the <code>show</code> definition (<code>show (Val n) = ...</code>) and it is only being used to <code>show</code> an <code>Int</code>. The other <code>show</code> calls are recursive calls to the newly defined <code>show</code>. I imagine that would be allowed."}, {"owner": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "edited": false, "score": 0, "creation_date": 1555973606, "post_id": 55801836, "comment_id": 98272747, "body": "If you aren&#39;t permitted to fiddle with imports in any way, then defining an instance of <code>Show</code> by hand (instead of adding <code>deriving Show</code>) is the only solution that makes sense to me (see edited answer). It&#39;s also what anyone would do in real life in most normal circumstances, and is much less confusing to read\u2014assuming you&#39;ve been taught how to think about classes and instances in Haskell."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1556056439, "post_id": 55801836, "comment_id": 98306236, "body": "I just want to thank you so much. The answer was literally staring me in the face and you went above and beyond! From the bottom of my heart, you saved me so much effort - thank you!"}], "tags": [], "owner": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "is_accepted": true, "score": 3, "last_activity_date": 1555972983, "last_edit_date": 1555972983, "creation_date": 1555971625, "answer_id": 55801836, "question_id": 55801749, "link": "https://stackoverflow.com/questions/55801749/turn-a-data-type-into-a-string-for-display-without-show/55801836#55801836", "title": "Turn a data type into a String for display without `show`", "body": "<p>You're almost there! To keep <code>show</code> from the Prelude from interfering, add</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Prelude hiding (show)\n</code></pre>\n\n<p>to the top of your file.</p>\n\n<p>But then, you'll need access to Prelude's <code>show</code> after all, so that you can show the <code>Int</code> inside your <code>Val</code>. So <em>also</em> add this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import qualified Prelude (show)\n</code></pre>\n\n<p>With those two lines, you can write:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>show :: Math -&gt; String\nshow (Val n)        = Prelude.show n\nshow (Add e1 e2)    = show e1 ++ \" + \" ++ show e2\nshow (Sub e1 e2)    = show e1 ++ \" - \" ++ show e2\nshow (Mult e1 e2)   = show e1 ++ \" * \" ++ show e2\nshow (Div e1 e2)    = show e1 ++ \" / \" ++ show e2\n</code></pre>\n\n<p>and you should have what you want.</p>\n\n<hr>\n\n<p>Alternatively, if you want to be implementing <code>Show</code> the class instead of a standalone, identically (and confusingly) named <code>show</code> function, the code you have for <code>show</code> works as-is. You just need to put it inside an instance definition, like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance Show Math where\n    show (Val n)        = show n\n    -- etc...\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 55801836, "answer_count": 2, "score": 3, "last_activity_date": 1555972983, "creation_date": 1555971007, "last_edit_date": 1555972726, "question_id": 55801749, "link": "https://stackoverflow.com/questions/55801749/turn-a-data-type-into-a-string-for-display-without-show", "title": "Turn a data type into a String for display without `show`", "body": "<p>This question has me absolutely puzzled. The goal is to take a specific data type and use it to create a string. The data type is:</p>\n\n<pre><code>data Math = Val Int\n           | Add Math Math\n           | Sub Math Math\n           | Mult Math Math\n           | Div Math Math\n    deriving Show\n</code></pre>\n\n<p>This example:</p>\n\n<pre><code>ex1 :: Math\nex1 = Add1 (Val1 2) (Val1 3)\n</code></pre>\n\n<p>should output <code>\"2 + 3\"</code> with the correct code.</p>\n\n<p>I wrote the following code and realized I was having two issues:</p>\n\n<pre><code>show :: Math -&gt; String\nshow (Val n)        = show n\nshow (Add e1 e2)    = show e1 ++ \" + \" ++ show e2\nshow (Sub e1 e2)    = show e1 ++ \" - \" ++ show e2\nshow (Mult e1 e2)   = show e1 ++ \" * \" ++ show e2\nshow (Div e1 e2)    = show e1 ++ \" / \" ++ show e2\n</code></pre>\n\n<p>The curve ball is that the function MUST be named <code>show</code>, as it is - so calling <code>show</code> from Prelude won't work. My first thought it to create a helper that turns every value into a literal but, again, I have no idea how to do that without <code>show</code> for a data type. I legitimately have no idea what direction to head in.</p>\n"}, {"tags": ["csv", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1555966539, "creation_date": 1555966539, "answer_id": 55801026, "question_id": 55800573, "link": "https://stackoverflow.com/questions/55800573/cassava-skip-or-ignore-columns/55801026#55801026", "title": "Cassava Skip or Ignore Columns", "body": "<p>You can write your own <code>FromRecord</code> instance for this.  You just need to write a <code>parseRecord</code> method that takes a <code>Record</code> (which is type <code>Vector Field</code>), extracts the desired columns at indexes 1 and 4, and loads them into your data type.</p>\n\n<p>Something like the following will work:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Data.Csv\nimport qualified Data.Vector as V\nimport Data.Text (Text)\n\ndata SomeFields = SomeFields Text Text deriving (Show)\ninstance FromRecord SomeFields where\n  parseRecord r = SomeFields &lt;$&gt; parseField (r V.! 1) &lt;*&gt; parseField (r V.! 4)\n\nmain = do\n  print $ (decode NoHeader \"1,2,3,4,5,6,7\\na,b,c,d,e,f,g\\n\"\n           :: Either String (V.Vector SomeFields))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2082, "user_id": 2002580, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/b2d16135241bda360d9fe3bfbfe08b0d?s=128&d=identicon&r=PG", "display_name": "BWStearns", "link": "https://stackoverflow.com/users/2002580/bwstearns"}, "is_accepted": false, "score": 0, "last_activity_date": 1556036501, "creation_date": 1556036501, "answer_id": 55815534, "question_id": 55800573, "link": "https://stackoverflow.com/questions/55800573/cassava-skip-or-ignore-columns/55815534#55815534", "title": "Cassava Skip or Ignore Columns", "body": "<p>Ended up solving it this way.</p>\n\n<pre><code>data ThingAtoThinBMapping = ThingAtoThinBMapping {\n      thingA :: Text\n    , thingB :: Text\n} deriving (Eq, Show, Read)\n\ninstance FromNamedRecord ThingAtoThinBMapping where\n    parseNamedRecord r = ThingAtoThinBMapping \n        &lt;$&gt; r .: \"thing_a\"\n        &lt;*&gt; r .: \"thing_b\"\n\nprintABMap = do\n    csvData &lt;- BL.readFile \"reallywide.csv\"\n    case decodeByNameWith decodeOpts csvData of\n        Left err -&gt; putStrLn err\n        Right (h, v) -&gt; do\n            putStrLn $ show h\n            V.forM_ v $ \\ m -&gt;\n                putStrLn $ show (thingA m, thingB m)\n</code></pre>\n"}], "owner": {"reputation": 2082, "user_id": 2002580, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/b2d16135241bda360d9fe3bfbfe08b0d?s=128&d=identicon&r=PG", "display_name": "BWStearns", "link": "https://stackoverflow.com/users/2002580/bwstearns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 55801026, "answer_count": 2, "score": 2, "last_activity_date": 1556036501, "creation_date": 1555964284, "last_edit_date": 1555965974, "question_id": 55800573, "link": "https://stackoverflow.com/questions/55800573/cassava-skip-or-ignore-columns", "title": "Cassava Skip or Ignore Columns", "body": "<p>So I have a decent grasp on Cassava for simple use cases but I have this one .csv that has 25 columns, and I only care about the 2nd and 5th columns. Is there any way to do a partial parse of each line or do I need to make 20 <code>_ :: Text</code> parameter declarations in the labmda declaration like below?</p>\n\n<pre><code>Right v -&gt; V.forM_ v $ \\ (_ :: Text, thingA :: Text, _ :: Text,  _ :: Text,  _ :: Text, thingB :: Text,,  _ :: Text,  _ :: Text,  _ :: Text ..... etc\n</code></pre>\n\n<p>Edit: Also just discovered there's no instance for a 25 column CSV anyhow so even my ridiculous 336 character signature can't work.</p>\n\n<p>Edit': Seems that one solution might be named records (suggested <a href=\"http://haskell.1045720.n5.nabble.com/Loading-a-csv-file-with-200-columns-into-Haskell-Record-tp5865153p5865195.html\" rel=\"nofollow noreferrer\">here</a> as a fix for dealing with super wide documents] )</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 4, "creation_date": 1555963172, "post_id": 55800132, "comment_id": 98269571, "body": "<code>if</code> needs to be indented further to the right. But after that you&#39;re going to have other problems, because you&#39;ve specified return type as <code>String</code>, but trying to return <code>x</code>, which is a <code>Char</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1555970764, "post_id": 55800132, "comment_id": 98272076, "body": "Haskell has <code>Char</code> literals: <code>if x == &#39;+&#39;</code>, e.g."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1555970806, "post_id": 55800132, "comment_id": 98272084, "body": "This is also simpler to define piecewise: <code>convert1 &#39;+&#39; = &quot;+&quot;</code>, <code>convert &#39;*&#39; = &quot;*&quot;</code>, etc."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1555971084, "creation_date": 1555971084, "answer_id": 55801762, "question_id": 55800132, "link": "https://stackoverflow.com/questions/55800132/how-do-i-convert-specific-chars-with-my-function-without-parsing-errors/55801762#55801762", "title": "How do I convert specific chars with my function without parsing errors?", "body": "<p>Rather than a heavily nested <code>if</code> expression, just define the function piecewise. (This saves you from having to worry about indentation, although the whole body has to be indented at least one more space for it to be considered a continuation of the definition started by <code>convert1 x =</code>.)</p>\n\n<pre><code>convert1 :: Char -&gt; String\nconvert1 '+' = \"+\"\nconvert1 '*' = \"*\"\nconvert1 '^' = \"^\"\nconvert1 x = menge (read [x])\n</code></pre>\n\n<p>If <code>menge</code> has the type <code>Int -&gt; String</code>, you \ndon't need to provide the type for <code>read</code> explicitly; the compiler can infer it from the fact that <code>menge</code> expects an <code>Int</code>.</p>\n"}], "owner": {"reputation": 7, "user_id": 7723660, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ft77tWICOnw/AAAAAAAAAAI/AAAAAAAACTI/rX42D3KmSFc/photo.jpg?sz=128", "display_name": "MateInTwo", "link": "https://stackoverflow.com/users/7723660/mateintwo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1555971084, "creation_date": 1555961943, "last_edit_date": 1555970079, "question_id": 55800132, "link": "https://stackoverflow.com/questions/55800132/how-do-i-convert-specific-chars-with-my-function-without-parsing-errors", "title": "How do I convert specific chars with my function without parsing errors?", "body": "<p>I want to convert Chars to Strings with a certain function, but it keeps outputting errors</p>\n\n<p>This is my code:</p>\n\n<pre><code>convert1 :: Char -&gt; String\nconvert1 x = \nif [x] == \"+\"\n    then x\n    else if [x] == \"*\"\n        then x\n        else if [x] == \"^\"\n            then x\n            else menge ((read [x]) :: Int)\n</code></pre>\n\n<p>menge is a function that takes Integers and outputs Strings - I know this isn't that nice, but the chars this will get will always be the three characters above or a number.\nI'm getting the result</p>\n\n<pre><code>operations.hs:12:1: error:\n    parse error (possibly incorrect indentation or mismatched brackets)\n   |\n12 | if [x] == \"+\"\n   | ^\n</code></pre>\n\n<p>Thanks a lot in advance!</p>\n"}, {"tags": ["haskell", "monads", "applicative", "reader-monad"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1555949655, "post_id": 55797418, "comment_id": 98263790, "body": "No, it is <i>not</i> equivalent to <code>f (fa x) (fb x) (fc x) (fd x)</code>. The <code>do</code> notation is syntactical sugar, it means that you wrote <code>fa &gt;&gt;= \\a -&gt; fb &gt;&gt;= \\b -&gt; fc &gt;&gt;= \\c -&gt; fd &gt;&gt;= \\d -&gt; return (f a b c d)</code>. Note that the <code>&gt;&gt;=</code> depending on the monad does something different."}, {"owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 6, "creation_date": 1555949750, "post_id": 55797418, "comment_id": 98263831, "body": "@WillemVanOnsem Yes, I know that the do notation is synctatical sugar to what you wrote; however, having filled an A4 sheet of paper, I&#39;m reasonably sure that IN THE CASE OF THE READER MONAD (not any monad) <code>fa &gt;&gt;= \\a -&gt; fb &gt;&gt;= \\b -&gt; fc &gt;&gt;= \\c -&gt; fd &gt;&gt;= \\d -&gt; return (f a b c d)</code> actually is equivalent to <code>f (fa x) (fb x) (fc x) (fd x)</code>"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1555949838, "post_id": 55797418, "comment_id": 98263874, "body": "It&#39;s a fair question, but you could ask the same about many monads - some of what you can do with a monad can also be done with an applicative. But quite a bit can&#39;t (sadly I don&#39;t have a good example off the top of my head with Reader, but I&#39;m sure someone more expert than me will), and it&#39;s unfortunate that LYAH chooses an example which could be done in applicative notation instead."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1555949882, "post_id": 55797418, "comment_id": 98263897, "body": "The <code>Reader a</code> monad and the <code>(-&gt;) a</code> monad are isomorphic. The difference between them is only a wrapping constructor. You can choose either according to &quot;taste&quot;, so to speak. I guess <code>Reader a</code> is more used since it has a name, and the wrapping helps understanding what is thought as monadic and what is a regular function."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 4, "creation_date": 1555951142, "post_id": 55797418, "comment_id": 98264475, "body": "While in general <code>Monad</code> is more powerful than <code>Applicative</code> (as explained in chepner&#39;s answer), the <code>Reader</code>/function functor is a very special case in which the <code>Monad</code> and <code>Applicative</code> instances happen to be equivalent -- see the second part of <a href=\"https://stackoverflow.com/a/40136614/2751851\">this answer of mine</a>. (Cc. @RobinZigmond     )"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1555952725, "post_id": 55797418, "comment_id": 98265221, "body": "Thanks @duplode, that&#39;s a nice explanation of something which I didn&#39;t know and which is far from obvious."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1555957646, "post_id": 55797418, "comment_id": 98267354, "body": "Ah cool <code>m &gt;&gt;= f = flip f &lt;*&gt; m</code>"}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1555951278, "post_id": 55797596, "comment_id": 98264549, "body": "It is worth noting that <code>Reader</code> is a special case in which <a href=\"https://stackoverflow.com/a/40136614/2751851\">the instances are actually equivalent</a>."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1555976730, "post_id": 55797596, "comment_id": 98273430, "body": "This does a good job at explaining why the <code>do</code> notation is more useful than the applicative notation, but it doesn&#39;t touch on why the applicative notation is more useful than the &quot;non-fancy&quot; notation."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1555978976, "post_id": 55797596, "comment_id": 98273878, "body": "I didn&#39;t have anything more terribly intelligent (or less punny) to say on the matter other than &quot;it&#39;s terser when applicable&quot;."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 11, "last_activity_date": 1556012673, "last_edit_date": 1556012673, "creation_date": 1555950265, "answer_id": 55797596, "question_id": 55797418, "link": "https://stackoverflow.com/questions/55797418/what-can-the-reader-monad-do-that-applicative-functions-cannot/55797596#55797596", "title": "What can the Reader monad do that applicative functions cannot?", "body": "<p>The monadic version lets you add additional logic <em>between</em> the calls to the functions found in the context, or even decide not to call them at all.</p>\n\n<pre><code>do\n    a &lt;- fa\n    if a == 3 \n      then  return (f a 1 1 1)\n      else  do\n          b &lt;- fb\n          c &lt;- fc\n          d &lt;- fd\n          return (f a b c d)\n</code></pre>\n\n<p>In your original <code>do</code> expression, it's true that you aren't doing anything that the <code>Applicative</code> instance couldn't do, and in fact, the compiler can determine that. If you use the <code>ApplicativeDo</code> extension, then </p>\n\n<pre><code>do\n    a &lt;- fa\n    b &lt;- fb\n    c &lt;- fc\n    d &lt;- fd\n    return (f a b c d)\n</code></pre>\n\n<p>would indeed desugar to <code>f &lt;$&gt; fa &lt;*&gt; fb &lt;*&gt; fc &lt;*&gt; fd</code> instead of <code>fa &gt;&gt;= \\a -&gt; fb &gt;&gt;= \\b -&gt; fc &gt;&gt;= \\c -&gt; fd &gt;&gt;= \\d -&gt; return (f a b c d)</code>.</p>\n\n<hr>\n\n<p>This all holds for other types as well, for example</p>\n\n<ul>\n<li><p><code>Maybe</code>:</p>\n\n<pre><code>f &lt;$&gt; (Just 3) &lt;*&gt; (Just 5)\n  == Just (f 3 5)\n  == do\n      x &lt;- Just 3\n      y &lt;- Just 5\n      return (f 3 5)\n</code></pre></li>\n<li><p><code>[]</code>:</p>\n\n<pre><code>f &lt;$&gt; [1,2] &lt;*&gt; [3,4]\n  == [f 1 3, f 1 4, f 2 3, f 2 4]\n  == do\n      x &lt;- [1,2]\n      y &lt;- [3,4]\n      return (f x y)\n</code></pre></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 542, "user_id": 4440871, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/8gHuC.jpg?s=128&g=1", "display_name": "Fabian Schneider", "link": "https://stackoverflow.com/users/4440871/fabian-schneider"}, "edited": false, "score": 2, "creation_date": 1556056072, "post_id": 55804125, "comment_id": 98306118, "body": "@FabianSchneider I rewrote your edit because I feel that, as far as the flow of the text goes, part of the answer isn&#39;t very well suited for a long-ish digression of that sort. The idea of adding a more concrete illustration there was good; thanks for that. (On another note: applicative expressions can have effects, or even side effects if we&#39;re talking about <code>IO</code>-like things. I&#39;d rather describe the key difference in terms of monads allowing effects to depend on results of computations.)"}, {"owner": {"reputation": 542, "user_id": 4440871, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/8gHuC.jpg?s=128&g=1", "display_name": "Fabian Schneider", "link": "https://stackoverflow.com/users/4440871/fabian-schneider"}, "edited": false, "score": 0, "creation_date": 1556091399, "post_id": 55804125, "comment_id": 98314487, "body": "Seems reasonable; true, they can have effects; i should have mentioned that too in the longer version of the text :)      That is indeed a very nice description of the difference."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 5, "last_activity_date": 1556120479, "last_edit_date": 1556120479, "creation_date": 1555992051, "answer_id": 55804125, "question_id": 55797418, "link": "https://stackoverflow.com/questions/55797418/what-can-the-reader-monad-do-that-applicative-functions-cannot/55804125#55804125", "title": "What can the Reader monad do that applicative functions cannot?", "body": "<p>Before getting to your main question about <code>Reader</code>, I will start with a few remarks about applicative-versus-monad in general. While this applicative style expression...</p>\n\n<pre><code>g &lt;$&gt; fa &lt;*&gt; fb\n</code></pre>\n\n<p>... is indeed equivalent to this do-block...</p>\n\n<pre><code>do\n    x &lt;- fa\n    y &lt;- fb\n    return (g x y)\n</code></pre>\n\n<p>... switching from <code>Applicative</code> to <code>Monad</code> makes it possible to make decisions about which computations to perform based on results of other computations, or, in other words, to have effects that depend on previous results (see also <a href=\"https://stackoverflow.com/a/55797596/2751851\">chepner's answer</a>):</p>\n\n<pre><code>do\n    x &lt;- fa\n    y &lt;- if x &gt;= 0 then fb else fc\n    return (g x y)\n</code></pre>\n\n<p>While <code>Monad</code> is more powerful than <code>Applicative</code>, I suggest not thinking of it as if one were more useful than the other. Firstly, because there are applicative functors that aren't monads; secondly, because not using more power than you actually need tends to make things simpler overall. (In addition, such simplicity can sometimes bring tangible benefits, such as <a href=\"http://simonmar.github.io/bib/papers/haxl-icfp14.pdf\" rel=\"nofollow noreferrer\">an easier time dealing with concurrency</a>.)</p>\n\n<hr>\n\n<p>A parenthetical note: when it comes to applicative-versus-monad, <code>Reader</code> is a special case, in that the <code>Applicative</code> and <code>Monad</code> instances <a href=\"https://stackoverflow.com/a/40136614/2751851\">happen to be equivalent</a>. For the function functor (that is, <code>((-&gt;) r)</code>, which is <code>Reader r</code> without the newtype wrapper), we have <code>m &gt;&gt;= f = flip f &lt;*&gt; m</code>. That means if take the second do-block I wrote just above (or the analogous one in chepner's answer, etc) <em>and</em> assume the monad being used is <code>Reader</code>, we can translate it into applicative style.</p>\n\n<hr>\n\n<p>Still, with <code>Reader</code> ultimately being such a simple thing, why should we even bother with any of the above in this specific case? Here go a few suggestions.</p>\n\n<p>To begin with, Haskellers are often wary of the bare function functor, <code>((-&gt;) r)</code>, and quite understandably so: it can easily lead to unnecessarily cryptic code when compared to \"non-fancy expression[s]\" in which functions are applied directly. Still, in a few select cases it can be handy to use. For a tiny example, consider these two functions from <code>Data.Char</code>:</p>\n\n<pre><code>isUpper :: Char -&gt; Bool\nisDigit :: Char -&gt; Bool\n</code></pre>\n\n<p>Now let's say we want to write a function that checks if a character is either an upper case letter or an ASCII digit. The straightforward thing to do is something along the lines of:</p>\n\n<pre><code>\\c -&gt; isUpper c &amp;&amp; isDigit c\n</code></pre>\n\n<p>Using the applicative style, though, we can write it immediately in terms of the two functions -- or, I'm inclined to say, the two <em>properties</em> -- without having to note where the eventual argument goes:</p>\n\n<pre><code>(&amp;&amp;) &lt;$&gt; isUpper &lt;*&gt; isDigit\n</code></pre>\n\n<p>With an example as tiny as this one, whether to write it in this way is not a big deal, and largely up to taste -- I quite like it; others can't stand it. The point, though, is that sometimes we aren't particularly concerned about a certain value being a function, because we happen to be thinking of it as something else -- in this case, as a property -- and the fact it is ultimately a function can appear to us as a mere implementation detail.</p>\n\n<p>A quite compelling example of this perspective shift involves application-wide configuration parameters: if every single function across some layer of your program takes some <code>Config</code> value as an argument, chances are you will find it more comfortable treating its availability as a background assumption, rather than passing it around explicitly everywhere. It turns out that is the main use case for the reader monad.</p>\n\n<hr>\n\n<p>In any case, your suspicions about the usefulness of <code>Reader</code> are somewhat vindicated in at least one manner. It turns out that <code>Reader</code> itself, the functions-but-wrapped-in-a-fancy-newtype functor, isn't actually used all that often in the wild. What <em>is</em> extremely common are monadic stacks that incorporate the functionality of <code>Reader</code>, typically through the means of <a href=\"http://hackage.haskell.org/package/mtl-2.2.2/docs/Control-Monad-Reader.html#t:ReaderT\" rel=\"nofollow noreferrer\"><code>ReaderT</code></a> and/or the <a href=\"http://hackage.haskell.org/package/mtl-2.2.2/docs/Control-Monad-Reader.html#t:MonadReader\" rel=\"nofollow noreferrer\"><code>MonadReader</code></a> class. Discussing monad transformers at length would be a digression too far for the space of this answer, so I will just note that you can work with, for example, <code>ReaderT r IO</code> much like you would with <code>Reader r</code>, except that you can also slip in <code>IO</code> computations along the way. It is not unusual to see some variant of <code>ReaderT</code> over <code>IO</code> as the core type of the outer layer of a Haskell application.</p>\n\n<hr>\n\n<p>On a final note, you might find it interesting to see what <code>join</code> from <code>Control.Monad</code> does for the function functor, and then work out why that makes sense. (A solution can be found in <a href=\"https://stackoverflow.com/q/32323680/2751851\">this Q&amp;A</a>.)</p>\n"}], "owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 3, "answer_count": 2, "score": 9, "last_activity_date": 1556120479, "creation_date": 1555949524, "question_id": 55797418, "link": "https://stackoverflow.com/questions/55797418/what-can-the-reader-monad-do-that-applicative-functions-cannot", "title": "What can the Reader monad do that applicative functions cannot?", "body": "<p>Having read <a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids#applicative-functors\" rel=\"noreferrer\">http://learnyouahaskell.com/functors-applicative-functors-and-monoids#applicative-functors</a> , I can provide an example of the use of functions as applicative functors:</p>\n\n<p>Let's say <code>res</code> is a function of 4 arguments and <code>fa</code>, <code>fb</code>, <code>fc</code>, <code>fd</code> are all functions that take a single argument. Then, if I'm not mistaken, this applicaive expression:</p>\n\n<pre><code>f &lt;$&gt; fa &lt;*&gt; fb &lt;*&gt; fc &lt;*&gt; fd $ x\n</code></pre>\n\n<p>Means the same as this non-fancy expression:</p>\n\n<pre><code>f (fa x) (fb x) (fc x) (fd x)\n</code></pre>\n\n<p>Ugh. Took me quite a bit of time to understand why this is the case, but - with the help of a sheet of paper with my notes - I should be able to prove this.</p>\n\n<p>Then I read <a href=\"http://learnyouahaskell.com/for-a-few-monads-more#reader\" rel=\"noreferrer\">http://learnyouahaskell.com/for-a-few-monads-more#reader</a> . And we're back at this stuff again, this time in the monadic syntax:</p>\n\n<pre><code>do\n    a &lt;- fa\n    b &lt;- fb\n    c &lt;- fc\n    d &lt;- fd\n    return (f a b c d)\n</code></pre>\n\n<p>While another A4 sheet of notes was needed for me to prove this, I'm now pretty confident that this, again, means the same:</p>\n\n<pre><code>    f (fa x) (fb x) (fc x) (fd x)\n</code></pre>\n\n<p>I'm confused. Why? What's the use of this?</p>\n\n<p>Or, to be more precise: This seems to me to just duplicate the functionality of functions as applicatives, but with a more verbose syntax.</p>\n\n<p>So, could you give me an example of can the Reader monad do that functions as applicatives cannot?</p>\n\n<p><sup>Actually, I would also like to ask what's the use of any of these two: applicative functions OR the Reader monad - because while being able to apply the same argument to four functions (<code>fa</code>, <code>fb</code>, <code>fc</code>, <code>fd</code>) without repeating this argument four times does reduce some repetitiveness, I'm not sure if this minute improvement justifies this level of complexity; so I must be missing something prominent, I think; but this is worthy of a separate question</sup></p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1555948175, "post_id": 55796657, "comment_id": 98263147, "body": "I find it very hard to understand what you&#39;re trying to do with this - in particular what you mean by <code>return</code> and <code>maybe</code>. They are both standard functions in Haskell, but I strongly suspect neither does what you think it does. (In particular by <code>return maybe 0</code> I <i>think</i> you just mean <code>Just 0</code>)"}], "answers": [{"comments": [{"owner": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "edited": false, "score": 0, "creation_date": 1555953107, "post_id": 55797104, "comment_id": 98265393, "body": "thank you for your answer, however the question wasnt to find the index of the substring within the string, but to find the index of the string item IF the substring is present in that list element. by taking away the unneccessary returns and using Just 0 in the first valid case, it now compiles properly, but doesnt actually find the suitable String within a list. this is why im trying to use the entire list regardless of the state of recursion with the elemIndex function, because I want to know the index of the string in context of the entire list. but Im still clueless about that part."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "edited": false, "score": 0, "creation_date": 1555953195, "post_id": 55797104, "comment_id": 98265435, "body": "Oh! Sorry, I conflated <code>[String]</code> to <code>String</code> in my mind."}, {"owner": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "edited": false, "score": 0, "creation_date": 1555953737, "post_id": 55797104, "comment_id": 98265652, "body": "Could you advise how I might want to change the recursive part for this? Regardless of what list I try the answer is either Just 0 or Nothing, even if &#39;HU&#39; is really present at index 6. Really infuriating because in my head it makes perfect sense in this stage"}, {"owner": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "edited": false, "score": 0, "creation_date": 1555954358, "post_id": 55797104, "comment_id": 98265950, "body": "I think my solution seems to be OK at this point, but I cant find anything about how I can use the entire list as an argument to elemIndex (or to other functions for that matter)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "edited": false, "score": 1, "creation_date": 1555954638, "post_id": 55797104, "comment_id": 98266100, "body": "See my update; you don&#39;t need <code>elemIndex</code> at all, because the only place you look (or find) the string <code>&quot;HU&quot;</code> is in the head of the list. By the time you call <code>inFixOf</code>, there is no &quot;whole&quot; list to look in; you only have the list received by the current call. That said, you can also contrive a definition that <i>does</i> use <code>elemIndex</code>."}, {"owner": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "edited": false, "score": 0, "creation_date": 1555955319, "post_id": 55797104, "comment_id": 98266394, "body": "Thank you! Last question, what is the difference between &#39; and &#39;&#39; after the function name?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "edited": false, "score": 1, "creation_date": 1555955605, "post_id": 55797104, "comment_id": 98266526, "body": "Just the obvious one, namely, that they are two different strings; I just wanted to give that version a new name."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 2, "last_activity_date": 1555954621, "last_edit_date": 1555954621, "creation_date": 1555948185, "answer_id": 55797104, "question_id": 55796657, "link": "https://stackoverflow.com/questions/55796657/finding-the-index-of-a-string-that-contains-a-substring-recursively/55797104#55797104", "title": "Finding the index of a string that contains a substring recursively", "body": "<p>First, <code>maybe</code> is a function by itself; what it does isn't relevant to the question. Suffice to say, <code>return 0</code> does what you want: it returns <code>Just 0</code> from the function:</p>\n\n<pre><code>find' :: [String] -&gt; Maybe Int\nfind' [] = Nothing\nfind' [x] = return 0 -- equivalent to find' [x] = Just 0\n</code></pre>\n\n<p>(Note the use of <code>Nothing</code>; if you are going to raise an error, there's no reason to use <code>Maybe Int</code> instead of <code>Int</code> as the return type. Also, there's no reason to use <code>return</code> over <code>Just</code>, since you aren't trying to support an arbitrary monad here.)</p>\n\n<p>Further, <code>elemIndex</code> <em>already</em> returns a value of type <code>Maybe Int</code>; you don't need to use the <code>return</code> function, which wraps the value in another layer, producing a <code>Maybe (Maybe Int)</code> value, which is not what you want.</p>\n\n<pre><code>find' (x:xs)\n    | \"HU\" `isInfixOf` x = elemIndex x (x:xs)\n    | otherwise = find' xs\n</code></pre>\n\n<p>One last problem: if <code>\"HU\"</code> isn't present in the first element of the list, you are correct to simply call <code>find'</code> on the tail of the list. However, you need to add 1 to that return value to compensate for passing a shorter argument. (This also means you don't need <code>elemIndex</code>, since you always find <code>\"HU\"</code> in the head of the <em>current</em> list.)</p>\n\n<pre><code>find' (x:xs)\n    | \"HU\" `inInfixOf` x = Just 0\n    | otherwise = fmap (1+) (find' xs)\n</code></pre>\n\n<p>You need to use <code>fmap</code>; <code>find'</code> returns a <code>Maybe Int</code>, not an <code>Int</code>, so <code>1 + find' xs</code> by itself won't work.</p>\n\n<p>This also means you can drop the special case for <code>[x]</code>, since it follows from finding the search string in the head of the list. The entire function is just</p>\n\n<pre><code>find' :: [String] -&gt; Maybe Int\nfind' [] = Nothing\nfind' (x:xs)\n    | \"HU\" `isInfixOf` x = Just 0\n    | otherwise = fmap (1+) (find' xs)\n</code></pre>\n\n<hr>\n\n<p>One way that works with the entire list is to search the entire list at once, then find the (first) occurrence of True in the resulting list of booleans.</p>\n\n<pre><code>find'' :: [String] -&gt; Maybe Int\nfind'' xs = elemIndex True (map (\"HU\" `inInfixOf`) xs)\n-- or find'' = elemIndex True . map (\"HU\" `inInfixOf`)\n-- or find'' = findIndex (\"HU\" `inInfixOf`)\n</code></pre>\n"}], "owner": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 55797104, "answer_count": 1, "score": -1, "last_activity_date": 1555954621, "creation_date": 1555946083, "question_id": 55796657, "link": "https://stackoverflow.com/questions/55796657/finding-the-index-of-a-string-that-contains-a-substring-recursively", "title": "Finding the index of a string that contains a substring recursively", "body": "<p>Im trying to find the index of a string in the context of a list that contains a certain substring, with no avail. Im unsure how one may pass the entirety of the untouched array as an argument to another function in a recursive function. Here is my approach:</p>\n\n<pre><code>find' :: [String] -&gt; Maybe Int\nfind' [] = error \"List is empty\"\nfind' [x] = return maybe 0\nfind' (x:xs)\n    | \"HU\" `isInfixOf` x = return elemIndex x (x:xs)\n    | otherwise = checkTail\n    where checkTail = find' xs\n</code></pre>\n\n<p>The error is namely:</p>\n\n<pre><code> * Couldn't match type `[[String]] -&gt; Maybe Int' with `Maybe Int'\n  Expected type: String -&gt; [String] -&gt; Maybe Int\n    Actual type: String -&gt; [String] -&gt; [[String]] -&gt; Maybe Int\n* The function `return' is applied to three arguments,\n  but its type `([String] -&gt; [[String]] -&gt; Maybe Int)\n                -&gt; String -&gt; [String] -&gt; [[String]] -&gt; Maybe Int'\n  has only four\n  In the expression: return elemIndex x (x : xs)\n  In an equation for find':\n      find' (x : xs)\n        | \"HU\" `isInfixOf` x = return elemIndex x (x : xs)\n        | otherwise = checkTail\n        where\n            checkTail = find' xs\n\n   | \"HU\" `isInfixOf` x = return elemIndex x (x:xs)\n                      ^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>I dont really understand the error and why it doesnt match, because in both cases im returning a maybe int. However as I've mentioned im not sure if (x:xs) actually means the entire list for the argument.\nJust to clarify, im trying to find the index of the string from a list of strings.</p>\n"}, {"tags": ["performance", "haskell", "coq"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1555945674, "post_id": 55796487, "comment_id": 98262080, "body": "FYI, Haskell has <code>Numeric.Natural.Natural</code>, which is basically exactly <code>Integer</code> but unsigned."}], "answers": [{"comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1555964973, "post_id": 55800032, "comment_id": 98270221, "body": "&quot;What&#39;s incredible here is that Coq&#39;s evaluation of isPrime 330 only takes 30 seconds instead of, say, 30 years.&quot;  Arithmetic with this representation of integers is slow, sure, but not <i>that</i> slow! The algorithm still has to work with only a couple of <i>fairly</i> short lists in the end."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1555965288, "post_id": 55800032, "comment_id": 98270345, "body": "Yes, I was exaggerating...  ;)"}, {"owner": {"reputation": 3208, "user_id": 1809211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf049ef367dd9aa5f7e3220f4bec3ad3?s=128&d=identicon&r=PG", "display_name": "Yves", "link": "https://stackoverflow.com/users/1809211/yves"}, "edited": false, "score": 0, "creation_date": 1556000728, "post_id": 55800032, "comment_id": 98278652, "body": "To predict computation times, you need to fix the execution model.  Most of the time, you can&#39;t describe it formally so that you can only apply rules of thumb.  Peano arithmetic is one problem, but order of execution also matters: remember that call-by-value and call-by-name differ greatly, and Haskell is not applying call-by-name either, since lazy evaluation includes some sort of memoisation."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1555961403, "creation_date": 1555961403, "answer_id": 55800032, "question_id": 55796487, "link": "https://stackoverflow.com/questions/55796487/predict-running-times-of-extracted-coq-code-to-haskell/55800032#55800032", "title": "Predict running times of extracted Coq code to Haskell", "body": "<p>Your Coq code is using a Peano encoding of the naturals.  The evaluation of <code>mult 2 2</code> literally proceeds by the reduction:</p>\n\n<pre><code>mult (S (S 0)) (S (S 0)))\n= (S (S 0)) + mult (S 0) (S (S 0)))\n= (S (S 0)) + ((S (S 0)) + mult 0 (S (S 0)))\n= (S (S 0)) + ((S (S 0)) + 0)\n= (S (S 0)) + ((S 0) + (S 0))\n= (S (S 0)) + (0 + (S (S 0))\n= (S (S 0)) + (S (S 0))\n= (S 0) + (S (S (S 0)))\n= 0 + (S (S (S (S 0)))\n= (S (S (S (S 0))))\n</code></pre>\n\n<p>and then checking the equality <code>mult 2 2 =? 5</code> proceeds by the further reduction:</p>\n\n<pre><code>(S (S (S (S 0)))) =? (S (S (S (S (S 0)))))\n(S (S (S 0))) =? (S (S (S (S 0))))\n(S (S 0)) =? (S (S (S 0)))\n(S 0) =? (S (S 0))\n0 =? (S 0)\nfalse\n</code></pre>\n\n<p>Meanwhile, on the Haskell side, the evaluation of <code>2 * 2 == 5</code> proceeds by multiplying two <code>Integers</code> and comparing them to another <code>Integer</code>.  This is somewhat faster.  ;)</p>\n\n<p>What's incredible here is that Coq's evaluation of <code>isPrime 330</code> only takes 30 seconds instead of, say, 30 years.</p>\n\n<p>I don't know what to say about predicting the speed of extracted code, except to say that primitive operations on Peano numbers will be massively accelerated, and other code will probably be modestly faster, simply because a lot of work has gone into making GHC generate fast code, and performance hasn't been an emphasis in Coq's development.</p>\n"}], "owner": {"reputation": 3212, "user_id": 3357352, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/nfb7n.jpg?s=128&g=1", "display_name": "OrenIshShalom", "link": "https://stackoverflow.com/users/3357352/orenishshalom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 55800032, "answer_count": 1, "score": 0, "last_activity_date": 1555961403, "creation_date": 1555945290, "question_id": 55796487, "link": "https://stackoverflow.com/questions/55796487/predict-running-times-of-extracted-coq-code-to-haskell", "title": "Predict running times of extracted Coq code to Haskell", "body": "<p>I have the following version of <code>isPrime</code> written (and proved) in Coq.</p>\n\n<ul>\n<li>It takes around <code>30</code> seconds for <code>Compute (isPrime 330)</code>\nto finish on my machine.</li>\n<li>The extracted Haskell code takes around <code>1</code> second to verify that <code>9767</code> is prime.</li>\n</ul>\n\n<p>According to a comment in <a href=\"https://stackoverflow.com/questions/55229385/extracting-coq-to-haskell\">this post</a>,\nthe timing difference means nothing, but I wonder why is that?\nand is there any other way to predict performance when extracting Coq code? after all, sometimes performance <em>does</em> matter, and it's quite hard to change Coq source once you labored to prove it's correct.\nHere is my Coq code:</p>\n\n<pre><code>(***********)\n(* IMPORTS *)\n(***********)\nRequire Import Coq.Arith.PeanoNat.\n\n(************)\n(* helper'' *)\n(************)\nFixpoint helper' (p m n : nat) : bool :=\n  match m with\n  | 0 =&gt; false\n  | 1 =&gt; false\n  | S m' =&gt; (orb ((mult m n) =? p) (helper' p m' n))\n  end.\n\n(**********)\n(* helper *)\n(**********)\nFixpoint helper (p m : nat) : bool :=\n  match m with\n  | 0 =&gt; false\n  | S m' =&gt; (orb ((mult m m) =? p) (orb (helper' p m' m) (helper p m')))\n  end.\n\n(***********)\n(* isPrime *)\n(***********)\nFixpoint isPrime (p : nat) : bool :=\n  match p with\n  | 0 =&gt; false\n  | 1 =&gt; false\n  | S p' =&gt; (negb (helper p p'))\n  end.\n\n(***********************)\n(* Compute isPrime 330 *)\n(***********************)\nCompute (isPrime 330).\n\n(********************************)\n(* Extraction Language: Haskell *)\n(********************************)\nExtraction Language Haskell.\n\n(***************************)\n(* Use Haskell basic types *)\n(***************************)\nRequire Import ExtrHaskellBasic.\n\n(****************************************)\n(* Use Haskell support for Nat handling *)\n(****************************************)\nRequire Import ExtrHaskellNatNum.\nExtract Inductive Datatypes.nat =&gt; \"Prelude.Integer\" [\"0\" \"succ\"]\n\"(\\fO fS n -&gt; if n Prelude.== 0 then fO () else fS (n Prelude.- 1))\".\n\n(***************************)\n(* Extract to Haskell file *)\n(***************************)\nExtraction \"/home/oren/GIT/CoqIt/FOLDER_2_PRESENTATION/FOLDER_2_EXAMPLES/EXAMPLE_03_PrintPrimes_Performance_Haskell.hs\" isPrime.\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1555934761, "post_id": 55794072, "comment_id": 98257131, "body": "The problem is that you are trying to call the <code>expression</code> function recursively, but it doesn&#39;t have the right return type - <code>Just (expression e1)</code> actually has type <code>Maybe (Maybe Int)</code>, because <code>expression</code> returns a <code>Maybe Int</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1555934801, "post_id": 55794072, "comment_id": 98257147, "body": "Although you do have precedence issues too: <code>Just (expression e1) + (expression e2)</code> is parsed as <code>(Just (expression e1)) + (expression e2)</code> which I&#39;m assuming is not how you meant it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1555935168, "post_id": 55794072, "comment_id": 98257301, "body": "The second issue is just a typo, I think. It isn&#39;t in my code. For the first, how would I recursively call a Maybe (Maybe Int)? Do use some form of <code>Just (Maybe expression e1)</code> or <code>Maybe (Just expression e1)</code>. I&#39;ve been toying with the syntax and can&#39;t get it to work."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "edited": false, "score": 0, "creation_date": 1555935335, "post_id": 55794243, "comment_id": 98257375, "body": "Is there a way to do it without library functions? I&#39;m trying to show the operation so elegance isn&#39;t really an issue."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1555935422, "post_id": 55794243, "comment_id": 98257414, "body": "@Francis: sure, <code>liftM2</code> iss nothing special, basically it just uses pattern matching to see if the two parameters are <code>Just</code>s and then unwrap the value, pass it through a function, and wrap it in a <code>Just</code>, if the two are not both <code>Just</code>s, then it returns <code>Nothing</code>, so you can implement this quite straightforward."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1555935508, "post_id": 55794243, "comment_id": 98257460, "body": "note that you can use <code>liftA2</code> instead of <code>liftM2</code> (it&#39;s the same function, but <code>liftA2</code> works for more types - they both work here since <code>Maybe</code> is a monad but I prefer to do eg. <code>liftA2 (+) (expression e1) (expression e2)</code>, or even <code>(+) &lt;$&gt; expression e1 &lt;*&gt; expression e2</code>, just because I don&#39;t see the point of using Monad-specific functions if you don&#39;t actually need them."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1555935665, "last_edit_date": 1555935665, "creation_date": 1555935193, "answer_id": 55794243, "question_id": 55794072, "link": "https://stackoverflow.com/questions/55794072/maybe-int-expression-using-unique-data-type/55794243#55794243", "title": "Maybe Int expression using unique data type", "body": "<p>There are two problems here:</p>\n\n<pre><code> Just (expression e1)  + (expression e2)\n</code></pre>\n\n<p>is interpreted as:</p>\n\n<pre><code>(Just (expression e1)) + (expression e2)\n</code></pre>\n\n<p>So that means that you have wrapped the left value in a <code>Just</code>, whereas the other one is not, and this will not make much sense.</p>\n\n<p>Secondly, both <code>expression e1</code> and <code>expression e2</code> have type <code>Maybe Int</code>, hence that means that you can not add these two together. We can perform pattern matching.</p>\n\n<p>Fortunately there is a more elegant solution: we can make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html#v:liftM2\" rel=\"nofollow noreferrer\"><strong><code>liftM2 :: Monad m =&gt; (a -&gt; b -&gt; c) -&gt; m a -&gt; m b -&gt; m c</code></strong></a> for <em>most</em> of the patterns. For <code>Maybe</code> the <code>liftM2</code> will take a function <code>f :: a -&gt; b -&gt; c</code> and two <code>Maybe</code>s, and if both are <code>Just</code>s it will call the function on the values that are wrapped in the <code>Just</code>s and then wrap the result in a <code>Just</code> as well.</p>\n\n<p>As for the division case, we will first have to obtain the result of the denominator with the <code>expression</code> function, and if that is a <code>Just</code> that is <em>not</em> equal to zero, then we can <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:fmap\" rel=\"nofollow noreferrer\"><strong><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code></strong></a> function to map a value in a <code>Just</code> (that of the numerator) given of course the numerator is a <code>Just</code>:</p>\n\n<pre><code>import Control.Monad(liftM2)\n\nexpression :: Math -&gt; Maybe Int\nexpression (Val n)  = Just n\nexpression (Add e1 e2) = liftM2 (+) (expression e1) (expression e2)\nexpression (Sub e1 e2) = liftM2 (-) (expression e1) (expression e2)\nexpression (Mult e1 e2) = liftM2 (*) (expression e1) (expression e2)\nexpression (Div e1 e2) | Just v2 &lt;- expression e2, v2 /= 0 = fmap (`div` v2) (expression e1)\n                       | otherwise = Nothing</code></pre>\n\n<p>or we can, like @RobinZigmond says, use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-60--36--62-\" rel=\"nofollow noreferrer\"><strong><code>(&lt;$&gt;) :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code></strong></a> and <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-60--42--62-\" rel=\"nofollow noreferrer\"><strong><code>(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt;  f b</code></strong></a>:</p>\n\n<pre><code>expression :: Math -&gt; Maybe Int\nexpression (Val n)  = Just n\nexpression (Add e1 e2) = (+) &lt;$&gt; expression e1 &lt;*&gt; expression e2\nexpression (Sub e1 e2) = (-) &lt;$&gt; expression e1 &lt;*&gt; expression e2\nexpression (Mult e1 e2) = (*) &lt;$&gt; expression e1 &lt;*&gt; expression e2\nexpression (Div e1 e2) | Just v2 &amp;lt;- expression e2, v2 /= 0 = (`div` v2) &lt;$&gt; expression e1\n                       | otherwise = Nothing</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "is_accepted": true, "score": 7, "last_activity_date": 1555935539, "creation_date": 1555935539, "answer_id": 55794309, "question_id": 55794072, "link": "https://stackoverflow.com/questions/55794072/maybe-int-expression-using-unique-data-type/55794309#55794309", "title": "Maybe Int expression using unique data type", "body": "<p>So the first issue is precedence. Instead of writing:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Just (expression e1) * (expression e2)\n</code></pre>\n\n<p>You probably want:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Just (expression e1 * expression e2)\n</code></pre>\n\n<p>The second issue is the <em>types</em>. Take a look at the type of (*), for instance:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt;&gt;&gt; :t (*)\n(*) :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>It says, for some type <code>a</code> that is a <code>Num</code>, it takes two <code>a</code>s and returns one <code>a</code>. Specialised to <code>Int</code>, that would be:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(*) :: Int -&gt; Int -&gt; Int\n</code></pre>\n\n<p>But <code>expression</code> returns a <code>Maybe Int</code>! So we need some way to multiply with <code>Maybe</code>s. Let's write the function ourselves:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>multMaybes :: Maybe Int -&gt; Maybe Int -&gt; Maybe Int\nmultMaybes Nothing _ = Nothing\nmultMaybes _ Nothing = Nothing\nmultMaybes (Just x) (Just y) = Just (x * y)\n</code></pre>\n\n<p>So if either side of the multiplication has failed (i.e. you found a divide-by-zero), the whole thing will fail. Now, we need to do this once for every operator:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>addMaybes Nothing _ = Nothing\naddMaybes _ Nothing = Nothing\naddMaybes (Just x) (Just y) = Just (x + y)\n\nsubMaybes Nothing _ = Nothing\nsubMaybes _ Nothing = Nothing\nsubMaybes (Just x) (Just y) = Just (x - y)\n</code></pre>\n\n<p>And so on. But we can see there's a lot of repetition here. Luckily, there's a function that does this pattern already: <code>liftA2</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>multMaybes = liftA2 (*)\naddMaybes  = liftA2 (+)\nsubMaybes  = liftA2 (-)\n</code></pre>\n\n<p>Finally, there are two more small problems. First, you say:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>expression (Div e1 e2)\n  | e2 /= 0               = Just (expression e1) `div` (expression e2)\n</code></pre>\n\n<p>But <code>e2</code> isn't an <code>Int</code>! It's the expression type. You probably want to check if the result of the recursive call is 0.</p>\n\n<p>The second problem is that you're unnecessarily wrapping things in <code>Just</code>: we can remove one layer.</p>\n\n<p>After all of that, we can write your function like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>expression :: Math -&gt; Maybe Int\nexpression (Val n)        = Just n\nexpression (Add e1 e2)    = liftA2 (+) (expression e1) (expression e2)\nexpression (Sub e1 e2)    = liftA2 (-) (expression e1) (expression e2)\nexpression (Mult e1 e2)   = liftA2 (*) (expression e1) (expression e2)\nexpression (Div e1 e2)\n  | r2 /= Just 0          = liftA2 div (expression e1) r2\n  | otherwise             = Nothing\n  where r2 = expression e2\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11340751"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 55794309, "answer_count": 2, "score": 1, "last_activity_date": 1555935665, "creation_date": 1555934373, "question_id": 55794072, "link": "https://stackoverflow.com/questions/55794072/maybe-int-expression-using-unique-data-type", "title": "Maybe Int expression using unique data type", "body": "<p>I'm wrote a unique data type to express basic math (addition, mult, etc.) and it works - however, when I try to turn it into a Maybe statement, none of the math works. I believe it's a syntax error but I've tried extra parenthesis and so on and I can't figure it out. Usually Maybe statements are easy but I don't understand why it keeps throwing an issue.</p>\n\n<p>This is the data type I created (with examples):</p>\n\n<pre><code>data Math = Val Int\n           | Add Math Math\n           | Sub Math Math\n           | Mult Math Math\n           | Div Math Math\n    deriving Show\n\nex1 :: Math\nex1 = Add1 (Val1 2) (Val1 3)\n\nex2 :: Math\nex2 = Mult (Val 2) (Val 3)\n\nex3 :: Math\nex3 = Div (Val 3) (Val 0)\n</code></pre>\n\n<p>Here is the code. The only Nothing return should be a division by zero.</p>\n\n<pre><code>expression :: Math -&gt; Maybe Int\nexpression (Val n)        = Just n\nexpression (Add e1 e2)    = Just (expression e1) + (expression e2)\nexpression (Sub e1 e2)    = Just (expression e1) - (expression e2)\nexpression (Mult e1 e2)   = Just (expression e1) * (expression e2)\nexpression (Div e1 e2)\n  | e2 /= 0               = Just (expression e1) `div` (expression e2)\n  | otherwise             = Nothing\n</code></pre>\n\n<p>I get the same error for every individual mathematical equation, even if I delete the others, so I'm certain it's syntax. The error makes it seem like a Maybe within a Maybe but when I do that <code>e1 /= 0 &amp;&amp; e2 /= 0 = Just (Just (expression e1)</code>div<code>(expression e2))</code>, I get the same error:</p>\n\n<pre><code> * Couldn't match type `Int' with `Maybe Int'\n    Expected type: Maybe (Maybe Int)\n      Actual type: Maybe Int\n * In the second argument of `div', namely `(expression e2)'\n    In the expression: Just (expression e1) `div` (expression e2)\n    In an equation for `expression':\n      expression (Div e1 e2)\n        | e1 /= 0 &amp;&amp; e2 /= 0 = Just (expression e1) `div` (expression e2)\n        | otherwise = Nothing\n   |\n56 |   | e1 /= 0 &amp;&amp; e2 /= 0 = Just (expression e1) `div` (expression e2)\n   |                                        ^^^^^^^^^\n</code></pre>\n\n<p>What am I missing? It's driving me crazy.</p>\n"}, {"tags": ["haskell", "ghc", "ghci"], "comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1555941115, "post_id": 55794071, "comment_id": 98259854, "body": "The editor, Vim in your case, queries the backend parser by analyzing the strings returned by the backend, looking for any error messages. Unless you want to re-write the editor package, don&#39;t change the prompt string."}, {"owner": {"reputation": 2153, "user_id": 6330511, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SEM44.jpg?s=128&g=1", "display_name": "gmolau", "link": "https://stackoverflow.com/users/6330511/gmolau"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 1, "creation_date": 1555941920, "post_id": 55794071, "comment_id": 98260223, "body": "I know that I could simply stop using one or the other, but GHCI and hdevtools are two the most widely used Haskell development tools out there, surely there must be a way to get them to work together, especially on something as simple as a custom prompt string, right?"}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1555942065, "post_id": 55794071, "comment_id": 98260286, "body": "As I said, you will have to re-write the ALE code to not choke on the changed prompt. When you have a good, working solution, you can submit the change to the ALE developers."}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 1, "creation_date": 1555942526, "post_id": 55794071, "comment_id": 98260517, "body": "Maybe you can configure `hdevtools to pass <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ghci.html#ghc-flag--ignore-dot-ghci\" rel=\"nofollow noreferrer\">--ignore-dot-ghci</a> to ghci?  I haven&#39;t tried this, and it&#39;s too coarse if you have other config in .ghci."}, {"owner": {"reputation": 2153, "user_id": 6330511, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SEM44.jpg?s=128&g=1", "display_name": "gmolau", "link": "https://stackoverflow.com/users/6330511/gmolau"}, "reply_to_user": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "edited": false, "score": 0, "creation_date": 1555973405, "post_id": 55794071, "comment_id": 98272712, "body": "@bergey That seems to be the best solution for now, thanks for the tip!"}], "owner": {"reputation": 2153, "user_id": 6330511, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/SEM44.jpg?s=128&g=1", "display_name": "gmolau", "link": "https://stackoverflow.com/users/6330511/gmolau"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 108, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1555934372, "creation_date": 1555934372, "question_id": 55794071, "link": "https://stackoverflow.com/questions/55794071/setting-a-custom-prompt-in-ghci-leads-to-lots-of-error-messages-on-standard-type", "title": "Setting a custom prompt in GHCI leads to lots of error messages on standard types", "body": "<p>I'm currently learning some Haskell using hdevtools via ALE in Vim. It appears that setting a custom GHCI prompt leads hdevtools to report errors even on trivial type declarations.</p>\n\n<p>My <code>.ghci</code> file consists of only the custom prompt:</p>\n\n<pre><code>:set prompt \"\u03bb&gt; \"\n</code></pre>\n\n<p>With that this snippet...</p>\n\n<pre><code>hello :: String\nhello = \"Hello world\"\n</code></pre>\n\n<p>...is highlighted as an error:</p>\n\n<pre><code>[hdevtools] Not in scope: type constructor or class \u2018String\u2019 [Error]\n</code></pre>\n\n<p>This really is caused by the custom prompt, turning it off removes the error message. It seems that <a href=\"https://github.com/data61/fp-course/issues/79\" rel=\"nofollow noreferrer\">others</a> have had the same problem, but didn't really give a solution. I would obviously like to keep using both the custom prompt and hdevtools, so what is the intended way here to make this work?</p>\n\n<p>(Versions are 8.6.3 for GHC and 0.1.8.0 for hdevtools.)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1555931541, "post_id": 55792959, "comment_id": 98255781, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/55784752/how-to-change-the-value-of-a-function-in-haskell-avoiding-non-exhaustive-patter\">How to change the value of a function in Haskell, avoiding non-exhaustive patterns (duplicates)</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1555945282, "post_id": 55792959, "comment_id": 98261902, "body": "Why are you trying to avoid lists?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11394265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fec5c8d01e84fe7b81d2840e77863fd?s=128&d=identicon&r=PG&f=1", "display_name": "Napkin", "link": "https://stackoverflow.com/users/11394265/napkin"}, "edited": false, "score": 0, "creation_date": 1555942549, "post_id": 55795375, "comment_id": 98260530, "body": "Thanks a lot. Do you have any advice on practising recursive methodes? I am not very experienced with this technique of programming."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "reply_to_user": {"reputation": 13, "user_id": 11394265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fec5c8d01e84fe7b81d2840e77863fd?s=128&d=identicon&r=PG&f=1", "display_name": "Napkin", "link": "https://stackoverflow.com/users/11394265/napkin"}, "edited": false, "score": 2, "creation_date": 1555954377, "post_id": 55795375, "comment_id": 98265962, "body": "@Napkin implement <code>map</code>, <code>filter</code>, <code>foldl</code>, and <code>foldr</code>."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 1, "creation_date": 1555954602, "post_id": 55795375, "comment_id": 98266079, "body": "Implement <code>init</code>, <code>last</code>, <code>(++)</code> and <code>reverse</code>, too.  Most of the functions in <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html\" rel=\"nofollow noreferrer\">Data.List</a> can be implemented recursively.  The <a href=\"https://wiki.haskell.org/H-99:_Ninety-Nine_Haskell_Problems\" rel=\"nofollow noreferrer\">Ninety-Nine Haskell Problems</a> include lots of recursion practice, too."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 2, "last_activity_date": 1555940655, "creation_date": 1555940655, "answer_id": 55795375, "question_id": 55792959, "link": "https://stackoverflow.com/questions/55792959/is-it-possible-to-calculate-the-height-and-width-of-the-following-labyrinth-with/55795375#55795375", "title": "Is it possible to calculate the height and width of the following labyrinth without using list functions or list synthax", "body": "<p>You can do it using a recursive function:</p>\n\n<pre><code>type Labyrinth = Int -&gt; Int -&gt; Char\nwidth :: Labyrinth -&gt; Int\nwidth l = width' 1\n  where width' n | l 1 n == 'O' = n-1\n                 | otherwise    = width' (n+1)\n</code></pre>\n\n<p>This is a relatively standard recursive technique.  The function <code>width</code> uses a helper function <code>width'</code> which takes the current column index (starting with <code>1</code> when first called by <code>width</code>).  It checks if the labyrinth function returns <code>'O'</code> at that column with a \"pattern guard\".  If it does, it returns the index of the column just before the <code>'O'</code>.  If it doesn't, it recursively calls itself to check the next column.</p>\n"}], "owner": {"reputation": 13, "user_id": 11394265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fec5c8d01e84fe7b81d2840e77863fd?s=128&d=identicon&r=PG&f=1", "display_name": "Napkin", "link": "https://stackoverflow.com/users/11394265/napkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1556278620, "creation_date": 1555929168, "last_edit_date": 1556278620, "question_id": 55792959, "link": "https://stackoverflow.com/questions/55792959/is-it-possible-to-calculate-the-height-and-width-of-the-following-labyrinth-with", "title": "Is it possible to calculate the height and width of the following labyrinth without using list functions or list synthax", "body": "<p>My goal is to write a function that calculates the width and height of a labyrinth by using following code. So far i only found approaches that include using list functions or list syntax, but i want to find a alternative solution without using list syntax. I am a Haskell beginner and very new to programming in general.</p>\n\n<pre><code>showLabyrinth labyrinth =\n   putStrLn $ unlines $ [[labyrinth j i | i &lt;- [1..dimH]] | j &lt;- [1..dimV]]\n where\n   dimH = length . takeWhile (/='O') $ [labyrinth 1 i | i &lt;- [1..]]\n   dimV = length . takeWhile (/='O') $ [labyrinth i 1 | i &lt;- [1..]]\n\nlabyrinthA 9 _  = 'O'\nlabyrinthA _ 16 = 'X'\nlabyrinthA _ 17 = 'O'\nlabyrinthA 1 _  = 'X'\nlabyrinthA 2 1  = 'X'\nlabyrinthA 2 8  = 'X'\nlabyrinthA 2 12 = 'X'\nlabyrinthA 2 _  = ' '\nlabyrinthA 3 1  = 'X'\nlabyrinthA 3 3  = 'X'\nlabyrinthA 3 5  = 'X'\nlabyrinthA 3 6  = 'X'\nlabyrinthA 3 8  = 'X'\nlabyrinthA 3 9  = 'X'\nlabyrinthA 3 10 = 'X'\nlabyrinthA 3 12 = 'X'\nlabyrinthA 3 14 = 'M'\nlabyrinthA 3 _  = ' '\nlabyrinthA 4 1  = 'X'\nlabyrinthA 4 2  = 'X'\nlabyrinthA 4 3  = 'X'\nlabyrinthA 4 5  = 'X'\nlabyrinthA 4 6  = 'X'\nlabyrinthA 4 12 = 'X'\nlabyrinthA 4 _  = ' '\nlabyrinthA 5 1  = 'X'\nlabyrinthA 5 5  = 'X'\nlabyrinthA 5 8  = 'X'\nlabyrinthA 5 9  = 'X'\nlabyrinthA 5 10 = 'X'\nlabyrinthA 5 12 = 'X'\nlabyrinthA 5 13 = 'X'\nlabyrinthA 5 15 = 'X'\nlabyrinthA 5 _  = ' '\nlabyrinthA 6 1  = 'X'\nlabyrinthA 6 3  = 'X'\nlabyrinthA 6 4  = 'X'\nlabyrinthA 6 5  = 'X'\nlabyrinthA 6 7  = 'X'\nlabyrinthA 6 8  = 'X'\nlabyrinthA 6 10 = 'X'\nlabyrinthA 6 _  = ' '\nlabyrinthA 7 1  = 'X'\nlabyrinthA 7 6  = 'T'\nlabyrinthA 7 9  = 'X'\nlabyrinthA 7 10 = 'X'\nlabyrinthA 7 11 = 'X'\nlabyrinthA 7 12 = 'X'\nlabyrinthA 7 13 = 'X'\nlabyrinthA 7 14 = 'X'\nlabyrinthA 7 15 = 'X'\nlabyrinthA 7 _  = ' '\nlabyrinthA 8 6  = 'E'\nlabyrinthA 8 _  = 'X'\n\nlabyrinthB 7 6  = '.'\nlabyrinthB 6 6  = '.'\nlabyrinthB 5 6  = '.'\nlabyrinthB 5 7  = '.'\nlabyrinthB 4 7  = '.'\nlabyrinthB 4 8  = '.'\nlabyrinthB 4 9  = '.'\nlabyrinthB 4 10 = '.'\nlabyrinthB 4 11 = '.'\nlabyrinthB 5 11 = '.'\nlabyrinthB 6 11 = '.'\nlabyrinthB 6 12 = '.'\nlabyrinthB 6 13 = '.'\nlabyrinthB 6 14 = '.'\nlabyrinthB 5 14 = '.'\nlabyrinthB 4 14 = 'T'\nlabyrinthB x y  = labyrinthA x y\n\nlabyrinthC 3 14 = ' '\nlabyrinthC 4 14 = ' '\nlabyrinthC x y  = labyrinthB x y\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 1069, "user_id": 4299824, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LKWkrlvV9UE/AAAAAAAAAAI/AAAAAAAABYQ/OWKjHFpdGGs/photo.jpg?sz=128", "display_name": "YAMAMOTO Yuji", "link": "https://stackoverflow.com/users/4299824/yamamoto-yuji"}, "is_accepted": true, "score": 4, "last_activity_date": 1555922732, "creation_date": 1555922732, "answer_id": 55791621, "question_id": 55791262, "link": "https://stackoverflow.com/questions/55791262/best-way-to-include-forked-and-unpublished-version-of-a-hackage-published-librar/55791621#55791621", "title": "Best way to include forked and unpublished version of a Hackage-published library in my own project", "body": "<p>You can specify Git repositories (and its revision) in <code>extra-deps</code> of stack.yaml.</p>\n\n<p>Here's an example from <a href=\"https://docs.haskellstack.org/en/stable/yaml_configuration/#git-and-mercurial-repos\" rel=\"nofollow noreferrer\">the document</a>:</p>\n\n<pre><code>extra-deps:\n- git: git@github.com:yesodweb/wai\n  commit: 2f8a8e1b771829f4a8a77c0111352ce45a14c30f\n  subdirs:\n  - auto-update\n  - wai\n</code></pre>\n\n<p>Note <code>subdirs</code> is only required when the repository contains several packages (like yesodweb).</p>\n"}, {"tags": [], "owner": {"reputation": 1010, "user_id": 267916, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d630bf06a192014619dd8c9a75c7ade2?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/267916/jeremy"}, "is_accepted": false, "score": 1, "last_activity_date": 1555978137, "creation_date": 1555978137, "answer_id": 55802593, "question_id": 55791262, "link": "https://stackoverflow.com/questions/55791262/best-way-to-include-forked-and-unpublished-version-of-a-hackage-published-librar/55802593#55802593", "title": "Best way to include forked and unpublished version of a Hackage-published library in my own project", "body": "<p>In addition to the correct and accurate answer by yuji-yamamoto, I discovered that I could also make a symbolic link from the <code>otherlib</code> directory directly into the base directory of my own project, and add its name into the <code>packages</code> in <code>stack.yaml</code>. Specifically, the modified section then reads:</p>\n\n<pre><code>packages:\n- .\n- otherlib-0.9.1\n</code></pre>\n\n<p>..with the directory itself also called <code>otherlib-0.9.1</code>.</p>\n\n<p>This solution would work in cases where otherlib is not yet available anywhere outside of the local filesystem.</p>\n"}], "owner": {"reputation": 1010, "user_id": 267916, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d630bf06a192014619dd8c9a75c7ade2?s=128&d=identicon&r=PG", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/267916/jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 55791621, "answer_count": 2, "score": 1, "last_activity_date": 1555992341, "creation_date": 1555920882, "last_edit_date": 1555992341, "question_id": 55791262, "link": "https://stackoverflow.com/questions/55791262/best-way-to-include-forked-and-unpublished-version-of-a-hackage-published-librar", "title": "Best way to include forked and unpublished version of a Hackage-published library in my own project", "body": "<p>I am building a project in Haskell using <code>stack</code>, and needed to update one of the libraries on which my project depends--let's call that <code>otherlib</code>.</p>\n\n<p>I've forked <code>otherlib</code> and made the required changes, incremented the version number (let's call my version 0.9.1), built it using <code>cabal</code> (which is what that project uses), and run <code>cabal install otherlib</code> to put my modified version into the local cache. Now I'd like to include it in my own project as reasonably as possible.</p>\n\n<p>The changes I've made to <code>otherlib</code> are (IMO) pretty reasonable and stand a chance of being accepted by the maintainer once I create a PR. But in the meantime, I have a version which isn't in <code>stack</code>'s solution set.</p>\n\n<p>Including <code>otherlib-0.9.1</code> in my <code>package.yaml</code> dependencies doesn't work, nor does adding it to my <code>stack.yaml</code>'s <code>extra-deps</code>.</p>\n\n<p>Is there a good way of setting this up?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "edited": false, "score": 1, "creation_date": 1555918015, "post_id": 55790684, "comment_id": 98250922, "body": "<code>map (\\index -&gt; ...get element by index here) indexes</code>? To provide errors, consider <code>Either</code> as a &quot;return&quot; type."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1555944910, "post_id": 55790684, "comment_id": 98261712, "body": "<a href=\"https://softwareengineering.meta.stackexchange.com/questions/6166/open-letter-to-students-with-homework-problems\" title=\"open letter to students with homework problems\">softwareengineering.meta.stackexchange.com/questions/6166/&hellip;</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1555954691, "post_id": 55790684, "comment_id": 98266124, "body": "Can the indices be out of order? What should <code>subList [4,3,0] [1,2,3,4,5,6,7,8]</code> be? How about <code>subList [0,0,0] [1,2,3,4,5,6,7,8]</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1555921667, "post_id": 55791231, "comment_id": 98252197, "body": "Please avoid giving the solution away without a proper discussion for homework-related questions. It&#39;s likely that a beginner does not understand the code above, so the above answer only allows them to copy and submit it as the assignment solution, without learning much. The code might look so obvious that it needs no explanation, but when the OP is a beginner this might not be the case."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1555922002, "post_id": 55791231, "comment_id": 98252307, "body": "@chi, yeah, let me explain it a bit better!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1555954817, "post_id": 55791231, "comment_id": 98266183, "body": "The requested custom error message isn&#39;t present. The OP wasn&#39;t clear about what should happen if the indices aren&#39;t strictly increasing, but if they want to be able to jump around, that will be different."}], "tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": true, "score": 3, "last_activity_date": 1555922623, "last_edit_date": 1555922623, "creation_date": 1555920768, "answer_id": 55791231, "question_id": 55790684, "link": "https://stackoverflow.com/questions/55790684/a-function-that-it-takes-corresponding-elements-from-the-second-list-based-on-th/55791231#55791231", "title": "A function that it takes corresponding elements from the second list based on the first lists of indexes", "body": "<p>You can use a list comprehension:</p>\n\n<pre><code>Prelude&gt; let subList lst1 lst2 = [x | (i, x) &lt;- zip [0..] lst2, i `elem` lst1]\nPrelude&gt; subList [0,3,4] [1,2,3,4,5,6,7,8]\n[1,4,5]\n</code></pre>\n\n<p>Lets analize the code a bit.\nWe want all the values <code>x</code> present in the second list <code>lst2</code> whose indexes <code>i</code> are present in the other list <code>lst1</code>.</p>\n\n<p>In the comprehension we have three main blocks:</p>\n\n<ul>\n<li>Before <code>|</code> is the value we will capture for each \"iteration\" (we want <code>x</code>, which will be the values present in <code>lst2</code>)</li>\n<li>The second block is were we declare from where we will be taking the values.\n\n<ul>\n<li>In this case we want the values and their indexex. With this <code>zip [0..] lst2</code> we are building a list of tuples where the first value of the tuples are the indexes and the second values are the values taken from <code>lst2</code> (something like <code>[(0, 1), (1, 2)...]</code>).</li>\n<li>Then we take them one by one and we pattern match those tuples with <code>(i, x) &lt;- ...</code> where <code>i</code> will be each of the indexes and <code>x</code> each of the values in those tuples explained before.</li>\n</ul></li>\n<li>The last block, <code>i elem lst1</code> calls the elem function from <code>Data.List</code> wich checks if a value is present in a list. This third block is expecting a boolean and as well as the other is evaluated once for each taken values from the expresion in the comprehension. In this case it will only evaluate to <code>True</code> when the value <code>i</code> (our indexes) are present in<code>lst1</code> .</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1555977614, "post_id": 55802441, "comment_id": 98273612, "body": "Another exercise for the reader: when the list of indices has more than one or two elements, use an <code>IntMap</code> or <code>HashMap</code> to improve efficiency."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1555976486, "creation_date": 1555976486, "answer_id": 55802441, "question_id": 55790684, "link": "https://stackoverflow.com/questions/55790684/a-function-that-it-takes-corresponding-elements-from-the-second-list-based-on-th/55802441#55802441", "title": "A function that it takes corresponding elements from the second list based on the first lists of indexes", "body": "<p>Here's a very simple solution. So as to not completely spoil your homework, the custom error portion is left as an exercise to the reader.</p>\n\n<pre><code>subList lst1 lst2 = map (lst2 !!) lst1\n</code></pre>\n\n<p><code>map</code> applies a function to all elements of a list, returning the results in a new list, and <code>!!</code> gets an element from a list at a given index.</p>\n"}], "owner": {"reputation": 11, "user_id": 11280341, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb52cc2dd8af1b36c5a71d270ab98b5?s=128&d=identicon&r=PG&f=1", "display_name": "Zarathustra Van Bommel", "link": "https://stackoverflow.com/users/11280341/zarathustra-van-bommel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 55791231, "answer_count": 2, "score": 0, "last_activity_date": 1555976486, "creation_date": 1555917812, "last_edit_date": 1555927128, "question_id": 55790684, "link": "https://stackoverflow.com/questions/55790684/a-function-that-it-takes-corresponding-elements-from-the-second-list-based-on-th", "title": "A function that it takes corresponding elements from the second list based on the first lists of indexes", "body": "<p>I need help with this assigned problem for my programming class.</p>\n\n<blockquote>\n  <p>You need to implement a function subList such that it takes corresponding elements from the second list based on the first lists of indexes.</p>\n</blockquote>\n\n<p>For example, if the input is <code>subList [0,3,4] [1,2,3,4,5,6,7,8]</code>, the answer should be <code>[1,4,5]</code></p>\n\n<pre><code>subList :: [Int] -&gt; [Int] -&gt; [Int]\nsubList lst1 lst2\n</code></pre>\n\n<p>I am very new to programming in general so this is all i have so far...</p>\n\n<p>I also need an error function if there are no similar elements in either list. e.g, input=<code>[0,9]</code> and <code>[1,2,3]</code>, the output should equal a custom error string... e.g \"Input index is out of the boundaries\"</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 53, "user_id": 11373911, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fo6azdYkKmo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezTtiHXp1bJaYBmtCbK0qrNAfl0g/mo/photo.jpg?sz=128", "display_name": "Guilherme Lima", "link": "https://stackoverflow.com/users/11373911/guilherme-lima"}, "edited": false, "score": 0, "creation_date": 1555895431, "post_id": 55787938, "comment_id": 98246413, "body": "@duplode if there is just one tuple , that tuple is ignored . if there&#39;s more than 2 tuples with the same int value like in your exampe it would give [&quot;adx&quot;, &quot;ady&quot;,&quot;adz&quot;,&quot;aex&quot;,&quot;aey&quot;,&quot;ayz&quot;,&quot;afx&quot;,&quot;afy&quot;,&quot;afz&quot;,&quot;bex&quot;,&quot;bey&quot;.&zwnj;&#8203;..]"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1555895512, "post_id": 55787938, "comment_id": 98246425, "body": "That&#39;s fine -- I had looked only at your example, and didn&#39;t notice you were already fine with using <code>sequence</code> for the permutations."}, {"owner": {"reputation": 53, "user_id": 11373911, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fo6azdYkKmo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezTtiHXp1bJaYBmtCbK0qrNAfl0g/mo/photo.jpg?sz=128", "display_name": "Guilherme Lima", "link": "https://stackoverflow.com/users/11373911/guilherme-lima"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1555895619, "post_id": 55787938, "comment_id": 98246440, "body": "yeah it is cycling ok but i still can&#39;t find a way of filtering the permutations with other tuples rather than those with the same int value"}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1555898428, "post_id": 55788182, "comment_id": 98246796, "body": "there&#39;s also <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:sortOn\" rel=\"nofollow noreferrer\"><code>sortOn</code></a> now. I wonder if it&#39;s smart enough to not do the whole decorate-undecorate thing for such simple accessors as <code>fst</code>, though. Probably not."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1555898698, "post_id": 55788182, "comment_id": 98246826, "body": "@WillNess Last time I tried to use <code>sortOn</code> here, <a href=\"https://stackoverflow.com/questions/53491403/is-there-a-short-lambda-expression-for-a-a-ordering/53572182#comment94656383_53491426\">dfeuer told us</a> that performance-wise it is only worth using if the projection function you give to it is expensive. (As you note in your edited comment.)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1555898834, "post_id": 55788182, "comment_id": 98246854, "body": "yeah, thought of it in the mean time. :) that&#39;s unfortunate; the more detail a programmer needs to concern  themself with, the worse. I&#39;m a radical here; I&#39;d like to see a language with e.g. sequences, where the compiler itself would choose lists or trees or arrays or whatever, as needed. (I&#39;m not building it though...:) )."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1555899804, "post_id": 55788182, "comment_id": 98247019, "body": "@WillNess Unfortunate indeed. I kind of feel the &quot;sortOn&quot; name is too inviting for such a special-purpose function..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1555900987, "post_id": 55788182, "comment_id": 98247196, "body": "@WillNess, duplode, there is a function that does the job, but it&#39;s buried in <code>GHC.Exts</code>: <code>sortWith</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1555901415, "post_id": 55788182, "comment_id": 98247267, "body": "@dfeuer Thanks for the pointer. And there is a sorting <code>groupWith</code> there as well!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1555917500, "post_id": 55788182, "comment_id": 98250743, "body": "@dfeuer, duplode thanks. but, when an accessor is heavy, the decorate-sort-undecorate transform is too important to forgo for a few keystrokes. turns out <code>groupWith</code> uses <code>sortWith</code>, which is just a shorter way to key in <code>sortBy . comparing</code>."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1555900372, "last_edit_date": 1555900372, "creation_date": 1555896458, "answer_id": 55788182, "question_id": 55787938, "link": "https://stackoverflow.com/questions/55787938/how-to-generate-the-cartesian-join-of-a-list-of-tuples-based-on-their-first-valu/55788182#55788182", "title": "How to generate the cartesian join of a list of tuples based on their first value?", "body": "<p>You can use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:groupBy\" rel=\"nofollow noreferrer\"><code>groupBy</code></a> to keep the groups of tuples apart:</p>\n\n<pre><code>import Data.Function (on)\nimport Data.Ord (comparing)\nimport Data.List\n\npossible_keys :: Ord k =&gt; [(k, [c])] -&gt; [[c]]\npossible_keys = concat . fmap sequenceA . fmap (fmap snd)\n    . groupBy ((==) `on` fst) . sortBy (comparing fst)\n</code></pre>\n\n<p>(I'm assuming the input list isn't necessarily sorted. I'm sorting by the keys alone to make it minimally invasive. <code>comparing fst</code> is the same as <code>compare `on` fst</code>; unfortunately there isn't an analogous <code>equating</code> in the standard library yet. <code>sequenceA</code> is the same as <code>sequence</code>, <a href=\"https://stackoverflow.com/a/40181158/2751851\">only more general</a>.)</p>\n\n<p>This can be slimmed down a bit. The second functor law allows us to combine consecutive uses of <code>fmap</code>:</p>\n\n<pre><code>possible_keys :: Ord k =&gt; [(k, [c])] -&gt; [[c]]\npossible_keys = concat . fmap (sequenceA . fmap snd)\n    . groupBy ((==) `on` fst) . sortBy (comparing fst)\n</code></pre>\n\n<p><code>fmap</code> followed by <code>sequenceA</code> is <code>traverse</code>:</p>\n\n<pre><code>possible_keys :: Ord k =&gt; [(k, [c])] -&gt; [[c]]\npossible_keys = concat . fmap (traverse snd)\n    . groupBy ((==) `on` fst) . sortBy (comparing fst)\n</code></pre>\n\n<p>Finally, <code>fmap</code> followed by <code>concat</code> on a list is <code>concatMap</code> (or <code>(=&lt;&lt;)</code>, but that would be a little too cryptic here): </p>\n\n<pre><code>possible_keys :: Ord k =&gt; [(k, [c])] -&gt; [[c]]\npossible_keys = concatMap (traverse snd)\n    . groupBy ((==) `on` fst) . sortBy (comparing fst)\n</code></pre>\n\n<p>Note that this will generate strings of length one for keys with just one tuple -- <code>sequenceA [\"abc\"]</code> is <code>[\"a\",\"b\",\"c\"]</code>. If you don't want that, you can <code>filter</code> the groups of tuples immediately after the <code>groupBy</code> to get rid of those with just one tuple.</p>\n"}], "owner": {"reputation": 53, "user_id": 11373911, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Fo6azdYkKmo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezTtiHXp1bJaYBmtCbK0qrNAfl0g/mo/photo.jpg?sz=128", "display_name": "Guilherme Lima", "link": "https://stackoverflow.com/users/11373911/guilherme-lima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "closed_date": 1555902221, "answer_count": 1, "score": 0, "last_activity_date": 1555902357, "creation_date": 1555893001, "last_edit_date": 1555897442, "question_id": 55787938, "link": "https://stackoverflow.com/questions/55787938/how-to-generate-the-cartesian-join-of-a-list-of-tuples-based-on-their-first-valu", "closed_reason": "Duplicate", "title": "How to generate the cartesian join of a list of tuples based on their first value?", "body": "<p>I have a list of tuple of type <code>(Int,String)</code> and i want to generate a list of type <code>[String]</code> in which each string is a cartesian join permutation of second elements of the tuples that have the same <code>Int</code> value. For example:</p>\n\n<p>input: <code>[(1,\"abc\"),(1,\"def\"),(2,\"ghi\"),(2,\"kl\")]</code></p>\n\n<p>output: <code>[\"ad\", \"ae\", \"af\", \"bd\", \"be\", \"bf\", \"cd\", \"ce\", \"cf\", \"gk\", \"gl\", \"hk\", \"hl\", \"ik\", \"il\"]</code></p>\n\n<p>I tried this but i can't find a way of just permuting the tuples with the same <code>Int</code> value: </p>\n\n<pre><code>possible_keys :: [(Int,String)] -&gt; [String]\npossible_keys subkeys = [ key | keysize &lt;- keysizes, key&lt;-keys]\n  where keysizes = map (fst) subkeys\n        keys = sequence (map (snd) subkeys)\n</code></pre>\n\n<p>Any hint?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1555883699, "post_id": 55786595, "comment_id": 98244662, "body": "Try to put an exception transformer &quot;above&quot; the writer transformer: <code>ExceptT e (WriterT w m) a</code>, and you would need to run the exception before the writer: <code>runWriterT (runExceptT ...)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 3, "last_activity_date": 1555890689, "creation_date": 1555890689, "answer_id": 55787739, "question_id": 55786595, "link": "https://stackoverflow.com/questions/55786595/is-it-possible-to-access-writerts-partially-collected-tells-in-case-of-exce/55787739#55787739", "title": "Is it possible to access `WriterT`&#39;s partially collected `tell`s in case of exception?", "body": "<p>Well, your code uses <code>error</code>. Morally speaking, all bets are off with <code>error</code>, because it signifies a bug in your program more than anything else. The fact that <code>IO</code> can catch the exceptions produced by it is really just an interesting quirk. Therefore, if you need this behavior, it's really best to use a proper exception monad transformer, like @Li-yaoXia recommends.</p>\n\n<pre><code>-- see Control.Monad.Except\naction :: (MonadExcept String m, MonadWriter String m) =&gt;\n          m ()\naction = do tell \"a\"\n            tell \"b\"\n            throwError \"c\"\n            tell \"d\"\n\n-- run action and massage it into your format\nyourOutput :: (Maybe String, String)\nyourOutput = runWriter $ fmap (either Just (const Nothing)) $ runExceptT actions\n</code></pre>\n\n<p>As to why <code>error</code> can't really work (at least, in a nice way), consider what <code>error _ :: WriterT w m a</code> actually means. <code>error _ :: Int</code> means \"there is supposed to be a number here, but instead there's just a mistake.\" <code>WriterT w m a</code> is a type of program; the type of programs that keep of a log of type <code>w</code>, do some other stuff (<code>m</code>), and return <code>a</code>. Therefore, <code>error _ :: WriterT w m a</code> does not mean \"a program that throws a recoverable error, preserving the log of type <code>w</code>,\" it means \"there is supposed to be a program here, but instead there's just a mistake.\" Metaphorically speaking, the <code>action</code> psuedo-code you posted abruptly <em>runs out of program</em>, even though the type didn't mention that your program was allowed to suddenly terminate, and you should (metaphorically) thank your lucky stars that you are allowed to set up a replacement program (with <code>try</code>) rather than being properly chastised for the error!</p>\n\n<p>With the ivory-towertop preaching out of the way, let's assume that we really do have</p>\n\n<pre><code>action :: MonadWriter String m =&gt; m ()\naction = do tell \"a\"\n            tell \"b\"\n            error \"c\"\n            tell \"d\"\n</code></pre>\n\n<p>and we just have to deal with it. Assuming you use the lazy version of <code>Writer</code>, you'll be happy to note that</p>\n\n<pre><code>runWriter action =\n  ( ()\n  , \"a\" ++ \"b\" ++ (case error \"c\" of (_, c) -&gt; c) ++ \"d\"\n  )\n</code></pre>\n\n<p>There exists this function that \"salvages\" a list by catching an impure exception (the immoral, \"there is literally no program\" kind I said <code>error</code> was) if it occurs while evaluating the spine.</p>\n\n<pre><code>-- can be recast as Free (a,) () -&gt; IO (Free (a,) (Maybe e))\n-- essentially, that type encodes the intuition that a list may end in [] (nil)\n-- or in an error\nsalvageList :: Exception e =&gt; [a] -&gt; IO ([a], Maybe e)\nsalvageList xs = catch (do xs' &lt;- evaluate xs\n                           case xs' of\n                                [] -&gt; return ([], Nothing)\n                                (x : tl) -&gt; do (tl', e) &lt;- salvageList tl\n                                               return (x : tl', e)\n                       ) (\\e -&gt; return ([], Just e))\n</code></pre>\n\n<p>Which works:</p>\n\n<pre><code>-- we get the return value, too! that makes me feel... surprisingly weirded out!\nyourOutputPlus :: IO ((), Maybe String, String)\nyourOutputPlus = do let (val, log) = runWriter action\n                    (realLog, error) &lt;- salvageList log\n                    return (val, fmap (\\(ErrorCall msg) -&gt; msg) error, realLog)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 2, "last_activity_date": 1555910447, "creation_date": 1555910447, "answer_id": 55789483, "question_id": 55786595, "link": "https://stackoverflow.com/questions/55786595/is-it-possible-to-access-writerts-partially-collected-tells-in-case-of-exce/55789483#55789483", "title": "Is it possible to access `WriterT`&#39;s partially collected `tell`s in case of exception?", "body": "<p>If you want state to survive a runtime exception like this, your best bet is to use mutable variables. This is the approach we use inside Yesod, for example. The <code>rio</code> library has a <code>MonadWriter</code> instance based on mutable references that works this way:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-13.17 script\n{-# LANGUAGE NoImplicitPrelude #-}\nimport Test.Hspec\nimport RIO\nimport RIO.Writer\n\nmain = hspec $ it \"writer and exceptions\" $ do\n  ref &lt;- newSomeRef \"\"\n  result &lt;- tryAny $ runRIO ref $ do\n    tell \"a\"\n    tell \"b\"\n    error \"c\"\n    tell \"d\"\n  case result of\n    Left _ -&gt; pure ()\n    Right () -&gt; error \"it should have failed!!!\"\n\n  written &lt;- readSomeRef ref\n  written `shouldBe` \"ab\"\n</code></pre>\n\n<p>I touch on this (and related points) in my talk \"Everything you didn't want to know about monad transformer state\":</p>\n\n<ul>\n<li>Slides: <a href=\"https://www.snoyman.com/reveal/monad-transformer-state\" rel=\"nofollow noreferrer\">https://www.snoyman.com/reveal/monad-transformer-state</a></li>\n<li>Video: <a href=\"https://www.youtube.com/watch?v=KZIN9f9rI34\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=KZIN9f9rI34</a></li>\n</ul>\n"}], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1555910447, "creation_date": 1555879382, "question_id": 55786595, "link": "https://stackoverflow.com/questions/55786595/is-it-possible-to-access-writerts-partially-collected-tells-in-case-of-exce", "title": "Is it possible to access `WriterT`&#39;s partially collected `tell`s in case of exception?", "body": "<p>Is it possible to have a WriterT monad that is able to share its partially collected <code>tell</code>s in case of an exception? If I <code>try</code> outside of <code>runWriterT</code> the <code>w</code> seems to be discarded. If I try to <code>try</code> inside, I seem to need <code>MonadUnliftIO</code>. <code>MonadUnliftIO</code> sounds like it could help me, but that package says that it is only able to unlift monadic contexts and not monadic state which I guess Writer is. Has anyone done this with Writer or something similar?</p>\n\n<p>Example pseudocode:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>x &lt;- runWriterT $ do\n  result &lt;- try $ do\n    tell \"a\"\n    tell \"b\"\n    error \"c\"\n    tell \"d\"\n  case result of\n    Left e -&gt; Just e\n    Right a -&gt; Nothing\n\nx `shouldBe` (Just \"c\", \"ab\")\n</code></pre>\n"}, {"tags": ["haskell", "variable-assignment"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1555871460, "post_id": 55785558, "comment_id": 98241734, "body": "You specified here that <code>changeBin 0 3</code> returns a function <code>binNew</code>, and that <code>binNew</code> asks for two new variables."}, {"owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "edited": false, "score": 1, "creation_date": 1555871510, "post_id": 55785558, "comment_id": 98241747, "body": "Also, <code>binNew w z</code>, <code>binNew x y</code> and <code>binNew hello world</code> are the same thing definitions."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1555871573, "post_id": 55785558, "comment_id": 98241771, "body": "Note that <code>0</code> and <code>3</code> do not appear anywhere in the definition of <code>changeBin</code> that doesn&#39;t work."}, {"owner": {"reputation": 263, "user_id": 9654804, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HaskellPlease", "link": "https://stackoverflow.com/users/9654804/haskellplease"}, "edited": false, "score": 0, "creation_date": 1555871817, "post_id": 55785558, "comment_id": 98241851, "body": "How do I pass the two integers to binNew without asking for new variables and the 0 and 3 are just example numbers in the next I want to change 0 and 2 and then 0 and 4"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1555871867, "post_id": 55785558, "comment_id": 98241864, "body": "@HaskellPlease: like <code>changeBin w z = binNew w z where ...</code>, but it makes the <code>where</code> clause rather &quot;useless&quot;."}, {"owner": {"reputation": 263, "user_id": 9654804, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HaskellPlease", "link": "https://stackoverflow.com/users/9654804/haskellplease"}, "edited": false, "score": 0, "creation_date": 1555872010, "post_id": 55785558, "comment_id": 98241899, "body": "doing it like that doesnt duplicate the other numbers of <code>bin</code> right"}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 7, "last_activity_date": 1555876662, "creation_date": 1555876662, "answer_id": 55786256, "question_id": 55785558, "link": "https://stackoverflow.com/questions/55785558/haskell-integer-not-acting-as-integer/55786256#55786256", "title": "Haskell Integer not acting as Integer", "body": "<pre><code>1 changeBin w z = binNew where \n2                 binNew w z = '1'\n3                 binNew x y = bin x y\n</code></pre>\n\n<p>The <code>w</code> on line 1 and the <code>w</code> on line 2 are different variables.  <code>w</code> on line 2 does not become a pattern that only matches when it has the same value as the <code>w</code> given on line one \u2013\u2013 instead it defines a new variable that shadows the old one.  You need to explicitly compare:</p>\n\n<pre><code>changeBin w z = binNew\n    where\n    binNew w' z' \n        | w' == w &amp;&amp; z' == z = '1'\n        | otherwise = bin x y\n</code></pre>\n"}], "owner": {"reputation": 263, "user_id": 9654804, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HaskellPlease", "link": "https://stackoverflow.com/users/9654804/haskellplease"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 55786256, "answer_count": 1, "score": 1, "last_activity_date": 1555878310, "creation_date": 1555871309, "last_edit_date": 1555871631, "question_id": 55785558, "link": "https://stackoverflow.com/questions/55785558/haskell-integer-not-acting-as-integer", "title": "Haskell Integer not acting as Integer", "body": "<p>So I'm defining a variable/function that takes two inputs and displays a series of 1's and 0's</p>\n\n<pre><code>bin 0 0 = '0'\nbin 0 1 = '1'\nbin 0 2 = '1'\nbin 0 3 = '0'\nbin 0 4 = '1'\n</code></pre>\n\n<p>now I want to create a duplicate of the bin variable except that at 0 3 there should be a 1 so I tried to achieve this in a new function</p>\n\n<pre><code>changeBin w z = binNew where \n                binNew w z = '1'\n                binNew x y = bin x y\n</code></pre>\n\n<p>yet if I do it like this it gives me a pattern match redundant warning and when I call changeBin 0 3 it gets into a loop but when I change the function to</p>\n\n<pre><code>changeBin w z = binNew where \n                binNew 0 3 = '1'\n                binNew x y = bin x y\n</code></pre>\n\n<p>this works but I want to do it the first way so I can change it anytime without writing a whole function but I dont know why it gives me a redundant error when I write the same just with the numbers it works </p>\n\n<p>I am new to haskell bear with me thanks</p>\n\n<p>any help is appreciated on what my error is on the first function</p>\n"}, {"tags": ["haskell", "functional-programming", "non-exhaustive-patterns"], "comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 4, "creation_date": 1555865751, "post_id": 55784752, "comment_id": 98240315, "body": "The error is because your patterns don\u2019t cover every possible case. (There might be other bugs in your code; I haven\u2019t tested.) An exhaustive pattern is one that returns a result for any possible input. For example, what should be the value of <code>labrynthA 10 1</code>?"}, {"owner": {"reputation": 13, "user_id": 10592398, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-P5i-4A0jecQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsvCn_wX1tQZyQl5fgnXy-oB5vJw/mo/photo.jpg?sz=128", "display_name": "that-cs-dude", "link": "https://stackoverflow.com/users/10592398/that-cs-dude"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1555865879, "post_id": 55784752, "comment_id": 98240337, "body": "The labyrinth setup was already given, i don&#180;t know too much about haskell yet. So if i limit the labyrinth it should work?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1555865929, "post_id": 55784752, "comment_id": 98240350, "body": "You said &quot;<i>the string value of one char element</i>&quot;. What do you mean by the string value of a char element? And element of what?"}, {"owner": {"reputation": 13, "user_id": 10592398, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-P5i-4A0jecQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsvCn_wX1tQZyQl5fgnXy-oB5vJw/mo/photo.jpg?sz=128", "display_name": "that-cs-dude", "link": "https://stackoverflow.com/users/10592398/that-cs-dude"}, "edited": false, "score": 0, "creation_date": 1555866424, "post_id": 55784752, "comment_id": 98240469, "body": "I want the labyrinth cell of the &#39;T&#39; (labyrinth 7 6) to be &#39;moving&#39;, meaning i want to write a function that can change labyrinth 7 6 to &#39; &#39; and labyrinth 8 6 to &#39;T&#39;. T is representing a charakter &#39;walking&#39; the labyrinth"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1555866531, "post_id": 55784752, "comment_id": 98240496, "body": "Good luck with that. Your <code>labyrinthA</code> is a function. You can&#39;t modify functions at runtime (not even in imperative languages)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1555866666, "post_id": 55784752, "comment_id": 98240523, "body": "You probably want to represent a labyrinth as a list of lists, rather than a partial function of type <code>Int -&gt; Int -&gt; Char</code>. If you use a function, something as simple as <code>labyrinthA _ _ = error &quot;no such position in labyrinth&quot;</code> at the end of the definition would fix the non-exhaustive pattern problem."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1555870367, "post_id": 55784752, "comment_id": 98241427, "body": "<code>showLabyrinth labyrinthA</code> does not produce the exception you&#39;re describing. What is the exact command you run that produces that exception?"}, {"owner": {"reputation": 13, "user_id": 10592398, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-P5i-4A0jecQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsvCn_wX1tQZyQl5fgnXy-oB5vJw/mo/photo.jpg?sz=128", "display_name": "that-cs-dude", "link": "https://stackoverflow.com/users/10592398/that-cs-dude"}, "edited": false, "score": 0, "creation_date": 1555871000, "post_id": 55784752, "comment_id": 98241580, "body": "For example, i want to be able to write &quot;*&gt; let labyrhintA 1 1 = &#39;T&#39;&quot; to give the labyrhint cell the value &#39;T&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1555866715, "post_id": 55784892, "comment_id": 98240539, "body": "&quot;<i>the logic error will now crash the program with a debug message</i>&quot; - That&#39;s what&#39;s already happening. The compiler already inserts such a catch-all clause, only the error message is different: It says &quot;non-exhaustive patterns&quot; instead of &quot;domain error&quot;."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1555866818, "post_id": 55784892, "comment_id": 98240565, "body": "@melpomene Right, so the error message becomes more useful (giving the specific values that crashed the program) and occurs at runtime, not compile time. If the program logic is sound, and the function never can be called with values outside its domain, it would now run without error."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1555866848, "post_id": 55784892, "comment_id": 98240574, "body": "You&#39;re missing the point. It already is a runtime error."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1555867187, "post_id": 55784892, "comment_id": 98240662, "body": "@melpomene In GHC, with a bit of boilerplate added to make the code snippet compile at all, it is a compile-time error, not runtime. <code>labryinthA</code> is never even called. (That\u2019s probably a bug.)"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1555867365, "post_id": 55784892, "comment_id": 98240703, "body": "The code compiles and runs fine without adding anything: <a href=\"https://ideone.com/aBiVEj\" rel=\"nofollow noreferrer\">ideone.com/aBiVEj</a> (no errors)"}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1555867534, "post_id": 55784892, "comment_id": 98240744, "body": "@melpomene That\u2019s not the same code in the question. It needs at least one extra line of boilerplate."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1555868493, "post_id": 55784892, "comment_id": 98240980, "body": "@melpomene Clarified to explain why this will remove the compile-time warning and help with debugging the runtime error."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1555869183, "post_id": 55784892, "comment_id": 98241120, "body": "If you&#39;re referring to <code>main = ...</code>, that&#39;s not needed to compile the code (as in <code>ghc -c</code>). I only put it in because ideone doesn&#39;t let me pass custom compiler flags."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1555869312, "post_id": 55784892, "comment_id": 98241149, "body": "@melpomene Okay. I revised my answer to give a couple more constructive questions."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1555869632, "post_id": 55784892, "comment_id": 98241235, "body": "I needed to add a <code>module</code> declaration to get it to compile with <code>ghc -c</code>, either, but this probably isn\u2019t relevant to the question. What matters here is that the question does not contain a MCVE that reproduces the bug. Some other part of the program is making a call to <code>labyrinthA</code> with invalid arguments."}], "tags": [], "owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "is_accepted": true, "score": 2, "last_activity_date": 1555871341, "last_edit_date": 1555871341, "creation_date": 1555866556, "answer_id": 55784892, "question_id": 55784752, "link": "https://stackoverflow.com/questions/55784752/how-to-implement-a-function-to-change-array-cells-avoiding-non-exhaustive-patter/55784892#55784892", "title": "How to implement a function to change array cells avoiding non-exhaustive pattern errors in haskell?", "body": "<p>The error you\u2019re getting is because the patterns don\u2019t cover every case.  An <strong>exhaustive</strong> pattern is one that exhausts all the possibilities, that is, returns a result for every potential input value.</p>\n\n<p>Here, what would happen if you called, for example, <code>labyrinthA 10 1</code>? Or <code>labyrinthA 0 0</code>?  If your compiler is not warning you about this bug at compile time, you might want to compile with the <code>-Wall</code> flag to turn warnings on.</p>\n\n<p>If the program logic makes it impossible to call the function with any other values (in which case it should probably be a local function that can only be called from one place), there is a quick fix.  Add a line like this to the bottom of your function:</p>\n\n<pre><code>labyrinthA x y = error $ \"Domain error: labyrinthA \" ++ show x ++\n                         \" \" ++ show y\n</code></pre>\n\n<p>This adds a catch-all clause matching any patterns that haven\u2019t been covered already, satisfying the compiler.  If the function does get called with \u201cimpossible\u201d values, the logic error will now crash the program with a more-informative debug message.</p>\n\n<p>In your case, some other part of your program that you haven\u2019t shown us calls your function with values outside its domain, which is giving you a runtime crash.  Unfortunately, we cannot help you without being able to see the code, but tracing what sequence of calls led to the crash would be a good first step.</p>\n\n<p>In this specific instance, you probably don\u2019t want to update the map of your labyrinth every time the player takes a step.  That\u2019s not a very efficient or elegant operation in a functional language.  You might, instead, store the immutable map and then update the position of your player, to draw on top of it.  The (X,Y) coordinates could be another parameter or part of program-state data that you pass around.</p>\n\n<p>This doesn\u2019t answer your question about modifying a function after it\u2019s been defined.  I think that\u2019s an XY problem, but here\u2019s a literal answer to that part of the question.  You cannot do this with the <code>String</code> type.  There are ways to get mutable state in Haskell, such as a mutable <code>Data.Vector.MVector</code> with the <code>ST</code> type, but that\u2019s not your immediate problem.</p>\n"}], "owner": {"reputation": 13, "user_id": 10592398, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-P5i-4A0jecQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbDsvCn_wX1tQZyQl5fgnXy-oB5vJw/mo/photo.jpg?sz=128", "display_name": "that-cs-dude", "link": "https://stackoverflow.com/users/10592398/that-cs-dude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "closed_date": 1555886496, "accepted_answer_id": 55784892, "answer_count": 1, "score": 0, "last_activity_date": 1555941990, "creation_date": 1555865511, "last_edit_date": 1555941990, "question_id": 55784752, "link": "https://stackoverflow.com/questions/55784752/how-to-implement-a-function-to-change-array-cells-avoiding-non-exhaustive-patter", "closed_reason": "Needs details or clarity", "title": "How to implement a function to change array cells avoiding non-exhaustive pattern errors in haskell?", "body": "<p>My goal is to write a function called walk, which switches the value of a labyrinth cell with its neighbour.\nFor example calling walk 0 labyrinthA should move the T one cell to the left.<a href=\"https://i.stack.imgur.com/KjMMP.png\" rel=\"nofollow noreferrer\">Here i tried to change a value of a labyrinth cell in ghci.</a></p>\n\n<pre><code>showLabyrinth labyrinth =\n   putStrLn $ unlines $ [[labyrinth j i | i &lt;- [1..dimH]] | j &lt;- [1..dimV]]\n where\n   dimH = length . takeWhile (/='O') $ [labyrinth 1 i | i &lt;- [1..]]\n   dimV = length . takeWhile (/='O') $ [labyrinth i 1 | i &lt;- [1..]]\n\nlabyrinthA 9 _  = 'O'\nlabyrinthA _ 16 = 'X'\nlabyrinthA _ 17 = 'O'\nlabyrinthA 1 _  = 'X'\nlabyrinthA 2 1  = 'X'\nlabyrinthA 2 8  = 'X'\nlabyrinthA 2 12 = 'X'\nlabyrinthA 2 _  = ' '\nlabyrinthA 3 1  = 'X'\nlabyrinthA 3 3  = 'X'\nlabyrinthA 3 5  = 'X'\nlabyrinthA 3 6  = 'X'\nlabyrinthA 3 8  = 'X'\nlabyrinthA 3 9  = 'X'\nlabyrinthA 3 10 = 'X'\nlabyrinthA 3 12 = 'X'\nlabyrinthA 3 14 = 'M'\nlabyrinthA 3 _  = ' '\nlabyrinthA 4 1  = 'X'\nlabyrinthA 4 2  = 'X'\nlabyrinthA 4 3  = 'X'\nlabyrinthA 4 5  = 'X'\nlabyrinthA 4 6  = 'X'\nlabyrinthA 4 12 = 'X'\nlabyrinthA 4 _  = ' '\nlabyrinthA 5 1  = 'X'\nlabyrinthA 5 5  = 'X'\nlabyrinthA 5 8  = 'X'\nlabyrinthA 5 9  = 'X'\nlabyrinthA 5 10 = 'X'\nlabyrinthA 5 12 = 'X'\nlabyrinthA 5 13 = 'X'\nlabyrinthA 5 15 = 'X'\nlabyrinthA 5 _  = ' '\nlabyrinthA 6 1  = 'X'\nlabyrinthA 6 3  = 'X'\nlabyrinthA 6 4  = 'X'\nlabyrinthA 6 5  = 'X'\nlabyrinthA 6 7  = 'X'\nlabyrinthA 6 8  = 'X'\nlabyrinthA 6 10 = 'X'\nlabyrinthA 6 _  = ' '\nlabyrinthA 7 1  = 'X'\nlabyrinthA 7 6  = 'T'\nlabyrinthA 7 9  = 'X'\nlabyrinthA 7 10 = 'X'\nlabyrinthA 7 11 = 'X'\nlabyrinthA 7 12 = 'X'\nlabyrinthA 7 13 = 'X'\nlabyrinthA 7 14 = 'X'\nlabyrinthA 7 15 = 'X'\nlabyrinthA 7 _  = ' '\nlabyrinthA 8 6  = 'E'\nlabyrinthA 8 _  = 'X'\n</code></pre>\n\n<p>Now i tried to let the 'T' walk to the left with walk 0 labyrinthA</p>\n\n<pre><code>walk direction labyrinth | direction == 0 = let labyrinth (yKoord 'T') \n(xKoord 'T') = ' ' &amp;&amp; let labyrinth (yKoord) ((xKoord+1)) = 'T'\n                          | direction == 1 = undefined\n                          | direction == 2 = undefined\n                          | direction == 3 = undefined \n</code></pre>\n\n<p>Where as yKoord and xKoord are integers.<br>\n<a href=\"https://i.stack.imgur.com/mhytJ.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["haskell", "optparse-applicative"], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1555982890, "post_id": 55783646, "comment_id": 98274577, "body": "I usually write these things with <code>Options.Applicative.eitherReader</code>, which is a small wrapper for this pattern of binding the result of <code>readerAsk</code> and calling <code>fail</code> or <code>return</code> accordingly: <code>nonEmptyStr = eitherReader \\case { &quot;&quot; -&gt; Left &quot;\u2026&quot;; x -&gt; Right $ fromString x }</code> (with <code>BlockArguments</code> too)"}], "tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": true, "score": 2, "last_activity_date": 1555857266, "creation_date": 1555857266, "answer_id": 55783646, "question_id": 55782362, "link": "https://stackoverflow.com/questions/55782362/optparse-applicative-non-empty-string-argument/55783646#55783646", "title": "optparse-applicative non empty string argument", "body": "<pre><code>import Data.String\nimport Data.Text\nimport Options.Applicative.Types (ReadM, readerAsk)\n\nnonEmptystr :: IsString s =&gt; ReadM s\nnonEmptystr = do\n  readerAsk &gt;&gt;= \\case\n    \"\" -&gt; fail \"Invalid argument: Empty string\"\n    x -&gt; pure $ fromString x\n\nf :: Parser Text\nf = argument nonEmptystr (metavar \"task\") \n</code></pre>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 55783646, "answer_count": 1, "score": 1, "last_activity_date": 1555857266, "creation_date": 1555846731, "question_id": 55782362, "link": "https://stackoverflow.com/questions/55782362/optparse-applicative-non-empty-string-argument", "title": "optparse-applicative non empty string argument", "body": "<p>How can I implement a non empty string argument?</p>\n\n<pre><code>parserStart :: Parser String\nparser = strArgument (metavar \"EXAMPLE\") \n</code></pre>\n\n<p>How can prevent it from successfully parsing an empty string - <code>\"\"</code>?</p>\n\n<p>Having previous experience with Parsec/Attoparsec, I assume I could write my own parser or possibly use something applicative to inspect the value and <code>fail</code> if it's an empty string (I think this won't be possible as I need a Monad for this)?</p>\n"}, {"tags": ["haskell", "deriving"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1555870669, "post_id": 55781223, "comment_id": 98241502, "body": "What will go wrong if you do not have <code>Data</code> or <code>Generic</code> instances for this type?"}, {"owner": {"reputation": 3024, "user_id": 152436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bca96b092fc9b1e74c7342f98f51cf0c?s=128&d=identicon&r=PG", "display_name": "Gareth Stockwell", "link": "https://stackoverflow.com/users/152436/gareth-stockwell"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1555926284, "post_id": 55781223, "comment_id": 98253910, "body": "@DanielWagner as it tuns out, nothing.  MyRecord is the payload of a Data.Tree.  Based on examples of using that type, I had assumed that the payload had to be an instance of Data and Generic.  But, having removed those from the declaration of MyRecord, my application still compiles."}], "answers": [{"comments": [{"owner": {"reputation": 11066, "user_id": 147057, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/cf9d83a95db2460ccb18f311fa8a766c?s=128&d=identicon&r=PG", "display_name": "max taldykin", "link": "https://stackoverflow.com/users/147057/max-taldykin"}, "edited": false, "score": 0, "creation_date": 1555837536, "post_id": 55781349, "comment_id": 98233675, "body": "Can you please elaborate a bit on how to implement <code>Data</code> instance without having <code>Digest</code> constructors visible?"}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 1, "last_activity_date": 1555837408, "creation_date": 1555837408, "answer_id": 55781349, "question_id": 55781223, "link": "https://stackoverflow.com/questions/55781223/how-to-write-deriving-instance-declaration/55781349#55781349", "title": "How to write &quot;deriving instance&quot; declaration?", "body": "<p>To derive a <code>Data</code> instance for your type, all types it contains should also have that instance.</p>\n\n<p>Make <code>Digest MD5</code> an instance of <code>Data</code> too.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1555945555, "creation_date": 1555945555, "answer_id": 55796544, "question_id": 55781223, "link": "https://stackoverflow.com/questions/55781223/how-to-write-deriving-instance-declaration/55796544#55796544", "title": "How to write &quot;deriving instance&quot; declaration?", "body": "<p>One choice would be to skip the <code>Data</code> and <code>Generic</code> instances until they're definitely needed; then at that point learn enough about <code>Data</code> and <code>Generic</code> to implement them by hand.</p>\n"}], "owner": {"reputation": 3024, "user_id": 152436, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bca96b092fc9b1e74c7342f98f51cf0c?s=128&d=identicon&r=PG", "display_name": "Gareth Stockwell", "link": "https://stackoverflow.com/users/152436/gareth-stockwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1555945555, "creation_date": 1555836083, "last_edit_date": 1555836520, "question_id": 55781223, "link": "https://stackoverflow.com/questions/55781223/how-to-write-deriving-instance-declaration", "title": "How to write &quot;deriving instance&quot; declaration?", "body": "<p>I'm trying to store a crypto hash as a field in a record type, but the compiler complains:</p>\n\n<pre><code>HashTest.hs:13:1: error:\n\u2022 No instance for (Data (Digest MD5))\n    arising from the second field of \u2018MyRecord\u2019 (type \u2018Digest MD5\u2019)\n  Possible fix:\n    use a standalone 'deriving instance' declaration,\n      so you can specify the instance context yourself\n\u2022 When deriving the instance for (Data MyRecord)\n   |\n13 |                          } deriving (Show, Eq, Data, Generic)\n   |                                                ^^^^\n</code></pre>\n\n<p>Here is the code:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric         #-}\n{-# LANGUAGE DeriveDataTypeable    #-}\n\nmodule Playpen.HashTest.HashTest where\n\nimport Data.Generics (Data, Typeable)\nimport GHC.Generics (Generic)\n\nimport Crypto.Hash\n\ndata MyRecord = MyRecord { idx :: Int\n                         , sig :: Digest MD5\n                         } deriving (Show, Eq, Generic)\n</code></pre>\n\n<p>If I write a standalone \"deriving instance\" clause as follows ...</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric         #-}\n{-# LANGUAGE DeriveDataTypeable    #-}\n{-# LANGUAGE StandaloneDeriving    #-}\n\nmodule Playpen.HashTest.HashTest where\n\nimport Data.Generics (Data, Typeable)\nimport GHC.Generics (Generic)\n\nimport Crypto.Hash\n\ndata MyRecord = MyRecord { idx :: Int\n                         , sig :: Digest MD5\n                         } deriving (Show, Eq, Generic)\n\nderiving instance Data MyRecord\n</code></pre>\n\n<p>... then the error becomes</p>\n\n<pre><code>HashTest.hs:16:1: error:\n    \u2022 No instance for (Data (Digest MD5)) arising from a use of \u2018k\u2019\n    \u2022 In the expression: ((z MyRecord `k` a1) `k` a2)\n      In an equation for \u2018Data.Data.gfoldl\u2019:\n          Data.Data.gfoldl k z (MyRecord a1 a2)\n            = ((z MyRecord `k` a1) `k` a2)\n      When typechecking the code for \u2018Data.Data.gfoldl\u2019\n        in a derived instance for \u2018Data MyRecord\u2019:\n        To see the code I am typechecking, use -ddump-deriv\n      In the instance declaration for \u2018Data MyRecord\u2019\n   |\n16 | deriving instance Data MyRecord\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nHashTest.hs:16:1: error:\n    \u2022 No instance for (Data (Digest MD5)) arising from a use of \u2018k\u2019\n    \u2022 In the expression: k (k (z MyRecord))\n      In an equation for \u2018Data.Data.gunfold\u2019:\n          Data.Data.gunfold k z _ = k (k (z MyRecord))\n      When typechecking the code for \u2018Data.Data.gunfold\u2019\n        in a derived instance for \u2018Data MyRecord\u2019:\n        To see the code I am typechecking, use -ddump-deriv\n      In the instance declaration for \u2018Data MyRecord\u2019\n   |\n16 | deriving instance Data MyRecord\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Can anyone help me to understand this error and how to fix it?</p>\n"}, {"tags": ["haskell", "haskell-stack", "happstack"], "owner": {"reputation": 93, "user_id": 5448706, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a40f1bd31874914cf156c80e99bc0f99?s=128&d=identicon&r=PG&f=1", "display_name": "Gera", "link": "https://stackoverflow.com/users/5448706/gera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 5, "last_activity_date": 1555810915, "creation_date": 1555810915, "question_id": 55779190, "link": "https://stackoverflow.com/questions/55779190/how-to-resolve-dependency-tree-with-different-version-ranges-of-same-packages", "title": "How to resolve dependency tree with different version ranges of same packages?", "body": "<p>I'm trying to set up a <em>happstack-lite</em> application using <em>stack</em>.</p>\n\n<p>I initialized project with these commands:</p>\n\n<pre><code>stack new my-happstack\ncd my-happstack\nstack setup\n</code></pre>\n\n<p>I changed <strong>package.yaml</strong> so it contains:</p>\n\n<pre><code>dependencies:\n- base &gt;= 4.7 &amp;&amp; &lt; 5\n- happstack-lite &gt;= 7.3\n</code></pre>\n\n<p>Then I ran <strong>stack build</strong> several times and changed <strong>extra-deps</strong> in <strong>stack.yaml</strong> in project directory according to recommendations (added dependencies, such as <em>happstack-server</em>).</p>\n\n<p>Apparently, I was asked to add to <strong>extra-deps</strong> the packages already listed there, with different version bounds and one with the same (<em>template-haskell-2.11.1.0</em>):</p>\n\n<p><strong>stack.yaml</strong> content:</p>\n\n<pre><code>extra-deps:\n- happstack-lite-7.3.6\n- happstack-server-7.4.6.4\n- Win32-2.2.2.0@sha256:10ed55dd31315f386910c121c1d1d442df83bd2ee92090a753cd65300735a8ca\n- network-2.6.3.6@sha256:1ca79d81af02d7acd6032d5e6c9bde4618a8fdcfbe19bd42b49d420183975df0\n- template-haskell-2.11.1.0@sha256:f90d6ab73ad35c749e8547ca132e7ab5d32d2f8e7bb2e2ff6d597be26b58e061\n- transformers-compat-0.5.1.4@sha256:1b4bfa8589afb1ca0e719129ab261bd90ef0cc3e6c0b9963f94970c082b61250\n</code></pre>\n\n<p>output from <strong>stack build</strong>:</p>\n\n<pre><code>F:\\Projects\\Haskell\\my-happstack&gt;stack build\n\nError: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for Cabal-2.4.1.0:\n    Win32-2.2.2.0 from stack configuration does not match &gt;=2.3.0.0 &amp;&amp; &lt;2.9  (latest matching\n                  version is 2.8.3.0)\nneeded due to my-happstack-0.1.0.0 -&gt; Cabal-2.4.1.0\n\nIn the dependencies for happstack-server-7.4.6.4:\n    template-haskell-2.14.0.0 from stack configuration does not match &lt;2.12  (latest matching\n                              version is 2.11.1.0)\nneeded due to my-happstack-0.1.0.0 -&gt; happstack-server-7.4.6.4\n\nIn the dependencies for transformers-base-0.4.5.2:\n    transformers-compat-0.5.1.4 from stack configuration does not match &gt;=0.6.1  (latest matching\n                                version is 0.6.4)\nneeded due to my-happstack-0.1.0.0 -&gt; transformers-base-0.4.5.2\n\nSome different approaches to resolving this:\n\n  * Set 'allow-newer: true' in C:\\sr\\config.yaml to ignore all version constraints and build anyway.\n\n  * Consider trying 'stack solver', which uses the cabal-install solver to attempt to find some\n    working build configuration. This can be convenient when dealing with many complicated\n    constraint errors, but results may be unpredictable.\n\n  * Recommended action: try adding the following to your extra-deps\n    in F:\\Projects\\Haskell\\my-happstack\\stack.yaml:\n\nWin32-2.8.3.0@sha256:58fa6f52e8a0d455a74bb19445c177f2cc79a0975cae5fd96e2334bd38a516d4\ntemplate-haskell-2.11.1.0@sha256:f90d6ab73ad35c749e8547ca132e7ab5d32d2f8e7bb2e2ff6d597be26b58e061\ntransformers-compat-0.6.4@sha256:d298cd9d1bb7b05160229e244436bae825b53660865e3d5fd695ea0fafec1e6f\n\nPlan construction failed.\n\n</code></pre>\n\n<p>I've tried these steps:</p>\n\n<p>1) Set <strong>'allow-newer: true'</strong> in <strong>C:\\sr\\config.yaml</strong>. In this case, I'm getting error about wrong types usage from inside one of the dependent packages (can paste error output upon request, if needed).</p>\n\n<p>2) Run <strong>stack solver</strong>. I've got the error from cabal planner (error output upon request).</p>\n\n<p>So, I expect <em>stack</em> to resolve dependencies the way <em>npm</em> does - each package dependencies are resolved independently from other's packages needs. Any advice of how I can solve this particular problem will be helpful, though (including manual dependencies resolving).</p>\n"}, {"tags": ["macos", "haskell"], "comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 1, "creation_date": 1555808821, "post_id": 55779046, "comment_id": 98229702, "body": "Open your terminal and type <code>cabal install</code>? It seems that you have missing dependencies."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 8459132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4072f088e142b9cf787e5d29b6b68e83?s=128&d=identicon&r=PG&f=1", "display_name": "Flying Spaghetti", "link": "https://stackoverflow.com/users/8459132/flying-spaghetti"}, "edited": false, "score": 0, "creation_date": 1555855501, "post_id": 55779235, "comment_id": 98237616, "body": "Thank you. This helped me a bit, but now I am running into issues with finding &#39;pkg-config&#39;. I receive this error <code>setup: The program &#39;pkg-config&#39; version &gt;=0.9.0 is required but it could not     be found.</code> while configuring both <code>glib-0.13.4.1</code> and <code>cairo-0.13.3.1</code>. Edited post likewise."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1555863387, "post_id": 55779235, "comment_id": 98239675, "body": "Please do not use the comments for new questions."}, {"owner": {"reputation": 39, "user_id": 8459132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4072f088e142b9cf787e5d29b6b68e83?s=128&d=identicon&r=PG&f=1", "display_name": "Flying Spaghetti", "link": "https://stackoverflow.com/users/8459132/flying-spaghetti"}, "edited": false, "score": 0, "creation_date": 1556064330, "post_id": 55779235, "comment_id": 98308067, "body": "Finally figured it out... first <code>brew install program</code> whatever program came up as missing, and then override OS X&#39;s tendency to not automatically configure symlinks by using <code>export  PKG_CONFIG_PATH=path:path:path</code> for every <code>pkgconfig</code> folder I found in my cellar. More here: <a href=\"https://github.com/JustinTulloss/zeromq.node/issues/283#issuecomment-51431863\" rel=\"nofollow noreferrer\">github.com/JustinTulloss/zeromq.node/issues/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1156, "user_id": 119603, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db98f64d33aebb1e4433ea6e6fd5d9b6?s=128&d=identicon&r=PG", "display_name": "Damien Ayers", "link": "https://stackoverflow.com/users/119603/damien-ayers"}, "is_accepted": false, "score": 4, "last_activity_date": 1555811469, "creation_date": 1555811469, "answer_id": 55779235, "question_id": 55779046, "link": "https://stackoverflow.com/questions/55779046/how-to-run-complete-haskell-program/55779235#55779235", "title": "How to run complete Haskell program", "body": "<p>This project uses <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">Haskell Stack</a> for managing dependencies. It can be installed with <code>brew install stack</code> if you're using homebrew, or by following the instructions in the Stack documentation.</p>\n\n<p>Once installed, you can run the shell scripts, eg <code>./build-and-ghci.sh</code>, which will use Stack to download ghc, the project dependencies, and then start ghci.</p>\n"}], "owner": {"reputation": 39, "user_id": 8459132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4072f088e142b9cf787e5d29b6b68e83?s=128&d=identicon&r=PG&f=1", "display_name": "Flying Spaghetti", "link": "https://stackoverflow.com/users/8459132/flying-spaghetti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555856805, "creation_date": 1555808621, "last_edit_date": 1555856805, "question_id": 55779046, "link": "https://stackoverflow.com/questions/55779046/how-to-run-complete-haskell-program", "title": "How to run complete Haskell program", "body": "<p>I'm new to Haskell and understand how to run a short script. However, I'm trying to run this program: <a href=\"https://github.com/bollu/cellularAutomata\" rel=\"nofollow noreferrer\">https://github.com/bollu/cellularAutomata</a>. This program has an app folder with Main.hs, a source folder, and some shell scripts. </p>\n\n<p>How do you run this from terminal? </p>\n\n<p>Currently firing up GHCi, loading Main.hs and not being able to run it.</p>\n\n<p>This is the error I get right now when I load Main straight from the app. </p>\n\n<pre><code>Prelude&gt; :cd /Users/name/Downloads/code library/cellularAutomata-master/app\nPrelude&gt; :load Main\n[1 of 8] Compiling Cyclic1D         ( Cyclic1D.hs, interpreted )\n\nCyclic1D.hs:7:1: error:\n    Could not find module \u2018Cellular\u2019\n    Use -v to see a list of the files searched for.\n  |\n7 | import Cellular\n  | ^^^^^^^^^^^^^^^\n\n</code></pre>\n\n<p>In total, it can't find 6 modules.</p>\n\n<p>--EDIT--</p>\n\n<p>After installing cabal and stack and running</p>\n\n<p><code>stack build</code></p>\n\n<p>I receive this error halfway through the build:</p>\n\n<pre><code>setup: The program 'pkg-config' version &gt;=0.9.0 is required but it could not be found.\n</code></pre>\n\n<p>Ideas? Originally I thought pkg-config came with cairo, so I spent time putting symlinks to that, but now I believe perhaps pkg-config should come with either stack or the original project.</p>\n\n<p>Looking through the error logs this error shows while trying to compile StackSetupShim for both <code>cairo-0.13.3.1</code> and <code>glib-0.13.4.1</code>, sample one for the latter below:</p>\n\n<pre><code>      /private/var/folders/1l/0993c3212tg_93l0d4ypfk1m0000gn/T/stack-215ef039e4c6f639/glib-0.13.4.1/.stack-work/dist/x86_64-osx/Cabal-1.24.2.0/setup/setup [...] --dependency=utf8-string=utf8-string-1.0.1.1-1DpjxLeTvGg7ttZZojxJR5\n    Process exited with code: ExitFailure 1\n    Logs have been written to: /Users/name/stack/cellularAutomata/.stack-work/logs/glib-0.13.4.1.log\n\n    [1 of 2] Compiling Main             ( /private/var/folders/1l/0993c3212tg_93l0d4ypfk1m0000gn/T/stack-215ef039e4c6f639/glib-0.13.4.1/Setup.hs, /private/var/folders/1l/0993c3212tg_93l0d4ypfk1m0000gn/T/stack-215ef039e4c6f639/glib-0.13.4.1/.stack-work/dist/x86_64-osx/Cabal-1.24.2.0/setup/Main.o )\n    [2 of 2] Compiling StackSetupShim   ( /Users/name/.stack/setup-exe-src/setup-shim-mPHDZzAJ.hs, /private/var/folders/1l/0993c3212tg_93l0d4ypfk1m0000gn/T/stack-215ef039e4c6f639/glib-0.13.4.1/.stack-work/dist/x86_64-osx/Cabal-1.24.2.0/setup/StackSetupShim.o )\n    Linking /private/var/folders/1l/0993c3212tg_93l0d4ypfk1m0000gn/T/stack-215ef039e4c6f639/glib-0.13.4.1/.stack-work/dist/x86_64-osx/Cabal-1.24.2.0/setup/setup ...\n    Configuring glib-0.13.4.1...\n    setup: The program 'pkg-config' version &gt;=0.9.0 is required but it could not\n    be found.```\n</code></pre>\n"}, {"tags": ["list", "dictionary", "haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1555807866, "post_id": 55778972, "comment_id": 98229602, "body": "did you <code>import</code> the function from <code>Data.List</code>? <a href=\"https://hoogle.haskell.org/?hoogle=isInfixOf\" rel=\"nofollow noreferrer\">hoogle.haskell.org/?hoogle=isInfixOf</a>"}, {"owner": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1555808160, "post_id": 55778972, "comment_id": 98229638, "body": "too tired! thanks. my logic with this still seems to be wrong though, so edited"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1555814996, "post_id": 55778972, "comment_id": 98230405, "body": "You don&#39;t need the semicolons."}], "answers": [{"comments": [{"owner": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "edited": false, "score": 0, "creation_date": 1555809643, "post_id": 55779077, "comment_id": 98229798, "body": "informative &amp; great answer, thank you! a quick which, what does the `&#39;s around isInfixOf mean/do?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "edited": false, "score": 1, "creation_date": 1555809929, "post_id": 55779077, "comment_id": 98229843, "body": "The backticks just allow you to use it in &quot;infix form&quot; - between the 2 arguments, rather than before them. You can do this with any function of 2 arguments, but there are some where it reads much better in infix form, and in my opinion <code>isInfixOf</code> and friends fall clearly into that category"}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 2, "last_activity_date": 1555851571, "last_edit_date": 1555851571, "creation_date": 1555809102, "answer_id": 55779077, "question_id": 55778972, "link": "https://stackoverflow.com/questions/55778972/remove-characters-from-a-string-in-all-elements-of-a-list/55779077#55779077", "title": "Remove characters from a string in all elements of a list", "body": "<p>To answer the revised question (when <code>isInfixOf</code> has been <code>import</code>ed correctly):</p>\n\n<pre><code>cleanUpChars = map(\\w -&gt; if isInfixOf \"**\" w then map(\\c -&gt;  if c == \"*\" then \"\"; else c); else w)\n</code></pre>\n\n<p>The most obvious thing wrong here is that <code>c</code> in the inner parentheses will be a <code>Char</code> (since it's the input to a function which is <code>map</code>ped over a <code>String</code>) - and characters use single quotes, not double quotes. This isn't just a case of a typo or wrong syntax, however - <code>\"\"</code> works fine as an empty string (and is equivalent to <code>[]</code> since Strings are just lists), but there is no such thing as an \"empty character\".</p>\n\n<p>If, as it seems, your aim is to remove all <code>*</code>s from each string in the list that contains <code>**</code>, then the right tool is <code>filter</code> rather than <code>map</code>:</p>\n\n<pre><code>Prelude Data.List&gt; cleanUpChars = map(\\w -&gt; if isInfixOf \"**\" w then filter (/= '*') w; else w)\nPrelude Data.List&gt; cleanUpChars [\"th**is\", \"is\", \"a*\", \"t**es*t\"]\n[\"this\",\"is\",\"a*\",\"test\"]\n</code></pre>\n\n<p>(Note that in the example I made up, it removes all asterisks from <code>t**es*t</code>, even the single one. This may not be what you actually wanted, but it's what your logic in the faulty version implied - you'll have to be a little more sophisticated to only remove pairs of consecutive <code>*</code>'s.)</p>\n\n<p>PS I would certainly never write the function like that, with the semicolon - it really doesn't gain you anything. I would also use the infix form of <code>isInfixOf</code>, which makes it much clearer which string you are looking for inside the other:</p>\n\n<pre><code>cleanUpChars :: [String] -&gt; [String]\ncleanUpChars = map (\\w -&gt; if \"**\" `isInfixOf` w then filter (/= '*') w else w)\n</code></pre>\n\n<p>I'm still not particularly happy with that for readability - there's probably some nice way to tidy it up that I'm overlooking for now. But even if not, it helps readability imo to give the function a local name (hopefully you can come up with a more concise name than my version!):</p>\n\n<pre><code>cleanUpChars :: [String] -&gt; [String]\ncleanUpChars = map possiblyRemoveAsterisks\n    where possiblyRemoveAsterisks w = if \"**\" `isInfixOf` w then filter (/= '*') w else w\n</code></pre>\n"}], "owner": {"reputation": 740, "user_id": 7691338, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/f4b2de6527387c39909be02577dc5910?s=128&d=identicon&r=PG&f=1", "display_name": "peterxz", "link": "https://stackoverflow.com/users/7691338/peterxz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 55779077, "answer_count": 1, "score": 0, "last_activity_date": 1555851571, "creation_date": 1555807567, "last_edit_date": 1555808125, "question_id": 55778972, "link": "https://stackoverflow.com/questions/55778972/remove-characters-from-a-string-in-all-elements-of-a-list", "title": "Remove characters from a string in all elements of a list", "body": "<p>Im trying to replace all strings which contain a substring by itself, in a list.\nI've tried it by using the <code>map</code> function:</p>\n\n<pre><code>cleanUpChars = map(\\w -&gt; if isInfixOf \"**\" w then map(\\c -&gt;  if c == \"*\" then \"\"; else c); else w)\n</code></pre>\n\n<p>To me this reads as: map elements in a list, such that if a character of a word contains * replace it with nothing</p>\n\n<p>To Haskell: \"Couldnt match expected type [[Char]] -> [[Char]] with actual type [Char] in the expression: w\" (and the last w is underlined)</p>\n\n<p>Any help is appreciated</p>\n"}, {"tags": ["list", "haskell", "tuples"], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1555803098, "post_id": 55778501, "comment_id": 98228982, "body": "I feel the <code>init</code>-less solution is tidier, especially because <code>init</code>, unlike <code>tail</code>, involves going through the whole list. In fact, I find it tempting to go even further style-wise and write <code>differences xs@(_:ys) = zipWith (-) ys xs</code>."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 5, "creation_date": 1555806901, "post_id": 55778501, "comment_id": 98229457, "body": "Using <code>drop 1</code> instead of <code>tail</code> would also eliminate the need to have a separate case for the empty list."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1555812309, "post_id": 55778501, "comment_id": 98230107, "body": "@4castle I suggest posting that as an answer."}], "tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 3, "last_activity_date": 1555801478, "creation_date": 1555801478, "answer_id": 55778501, "question_id": 55778450, "link": "https://stackoverflow.com/questions/55778450/calculate-the-differences-of-list-elements-using-zipwith/55778501#55778501", "title": "Calculate the differences of list elements using zipWith", "body": "<p>You're nearly there - but <code>zipWith</code> itself returns a list, so you don't want to put that inside a list comprehension unless you want the result to be a list of lists (which you don't, here).</p>\n\n<p><code>zipWith (-)</code> is absolutely the right idea here - it takes 2 lists and gives a new list given by taking the difference between corresponding elements of the given lists. Your output list, in your case, is intended to be 1 element shorter than the one input list, and you want to use <code>zipWith (-)</code> on 2 lists which consist of:</p>\n\n<ul>\n<li>all elements of the given list, other than the first</li>\n<li>all elements of the given list, other than the last</li>\n</ul>\n\n<p>Haskell already gives us convenient functions for these, namely <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:tail\" rel=\"nofollow noreferrer\">tail</a> and <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:init\" rel=\"nofollow noreferrer\">init</a>.</p>\n\n<p>So the function you're looking for is:</p>\n\n<pre><code>differences xs = zipWith (-) (tail xs) (init xs)\n</code></pre>\n\n<p>Note that this isn't ideal, because both <code>init</code> and <code>tail</code> will crash your program with an ugly runtime error if <code>xs</code> is empty. It makes sense to output an empty list if you present an empty list to this function (although you could argue it doesn't, since you will get an empty list from a singleton list), so you can avoid a runtime crash by defining the function via pattern matching to explicitly cater for the empty list:</p>\n\n<pre><code>differences [] = []\ndifferences xs = zipWith (-) (tail xs) (init xs)\n</code></pre>\n\n<p>While personally I think this is fine, and very explicit, you don't actually need to use both <code>init</code> and <code>tail</code> - <code>zipWith</code> works just fine if presented with lists of unequal length, when it will simply trim the larger one down to size. So <code>differences xs = zipWith (-) (tail xs) xs</code> is a viable, and slightly terser, alternative.</p>\n"}, {"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1555807474, "post_id": 55778683, "comment_id": 98229549, "body": "Nice - especially as I actually tried to simplify it in exactly this way with <code>&lt;*&gt;</code>, but for some reason couldn&#39;t see how to get it in the correct form. (Admittedly I didn&#39;t think about it for too long...)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1555804559, "last_edit_date": 1555804559, "creation_date": 1555803789, "answer_id": 55778683, "question_id": 55778450, "link": "https://stackoverflow.com/questions/55778450/calculate-the-differences-of-list-elements-using-zipwith/55778683#55778683", "title": "Calculate the differences of list elements using zipWith", "body": "<p>Building off <a href=\"https://stackoverflow.com/a/55778501/1126841\">Robin Zigmond's answer</a>, the <code>Applicative</code> instance for functions works well here:</p>\n\n<pre><code>(f &lt;*&gt; g) xs == f xs (g xs)\n</code></pre>\n\n<p>so</p>\n\n<pre><code>differences = zipWith subtract &lt;*&gt; tail\n</code></pre>\n\n<p>(where <code>subtract = flip (-)</code>.)</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 0, "last_activity_date": 1555899602, "creation_date": 1555899602, "answer_id": 55788438, "question_id": 55778450, "link": "https://stackoverflow.com/questions/55778450/calculate-the-differences-of-list-elements-using-zipwith/55788438#55788438", "title": "Calculate the differences of list elements using zipWith", "body": "<p><a href=\"https://stackoverflow.com/questions/55778450/calculate-the-differences-of-list-elements-using-zipwith#comment98229457_55778501\">As 4castle suggests</a>, using <code>drop 1</code> instead of <code>tail</code> in <a href=\"https://stackoverflow.com/a/55778501/2751851\">Robin Zigmond's second, <code>init</code>-less solution</a> means we can omit the <code>[]</code> case, as <code>drop 1 [] = []</code> (unlike <code>tail []</code>, which leads to a runtime error):</p>\n\n<pre><code>differences xs = zipWith (-) (drop 1 xs) xs\n</code></pre>\n\n<p>To contrast with this solution with no explicit pattern deconstruction, I will mention a spelling using none of <code>init</code>, <code>tail</code> and <code>drop</code>:</p>\n\n<pre><code>differences xs@(_:ys) = zipWith (-) ys xs\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 11248089, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HvqPECHw034/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rda3KbdXlEBYuEdWw0eSbzfv3gQhQ/mo/photo.jpg?sz=128", "display_name": "xentaquadrin", "link": "https://stackoverflow.com/users/11248089/xentaquadrin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 55778501, "answer_count": 3, "score": 0, "last_activity_date": 1555899602, "creation_date": 1555800901, "last_edit_date": 1555807272, "question_id": 55778450, "link": "https://stackoverflow.com/questions/55778450/calculate-the-differences-of-list-elements-using-zipwith", "title": "Calculate the differences of list elements using zipWith", "body": "<p>I have to make a function called differences, where I calculate the difference of every pair with <code>zipWith</code> and put it in a list.</p>\n\n<p>For example <code>differences [1..5] == [1, 1, 1, 1]</code>.</p>\n\n<p>So <code>[2-1, 3-2, 4-3, 5-4] == [1, 1, 1, 1]</code>.</p>\n\n<p>I thought of making list of tuples, like this:</p>\n\n<pre><code>[1..5] = [(1,2), (2,3), (3,4), (4,5)]\n</code></pre>\n\n<p>Then use list comprehesion like this: </p>\n\n<pre><code>[zipWith (-) a b | a &lt;- y, b &lt;- x]\n</code></pre>\n\n<p>where x is the first element of the tuple and y is the second.</p>\n\n<p>The functions type is <code>differences :: Num a =&gt; [a] -&gt; [a]</code>.</p>\n"}, {"tags": ["haskell", "cartesian-product", "applicative"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1555794133, "post_id": 55777670, "comment_id": 98227412, "body": "The context (in this case <code>[]</code>) does not contain functions. It contains <code>Maybe</code>s. So trying to apply the functions in the context is a type error. This is why the error says that it expected a function but actually got a <code>Maybe</code> instead. Try <code>[(+1), (+2)] &lt;*&gt; [1,2]</code> instead."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1555794273, "post_id": 55777670, "comment_id": 98227445, "body": "You here have two levels of functors: a list, and a <code>Maybe</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1555794933, "post_id": 55777670, "comment_id": 98227574, "body": "Are you deliberately trying to compose the two applicatives <code>[]</code> and <code>Maybe</code>? If so, then this won&#39;t work by default because GHC doesn&#39;t understand you&#39;re working with a composition. You need to make a new type for the composition, either with <a href=\"https://hackage.haskell.org/package/transformers-0.4.1.0/docs/Data-Functor-Compose.html\" rel=\"nofollow noreferrer\">Compose</a> or &quot;by hand&quot; with something like <code>newtype MaybeList a = [Maybe a]</code> (and then supply your own <code>Applicative</code> instance for <code>MaybeList</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1555826616, "post_id": 55777813, "comment_id": 98231829, "body": "Can you elaborate how does <code>&lt;$&gt;</code> work in this case? You have a <code>f g (k::a-&gt;a)</code> and <code>f g a</code> .So you have two functors <code>f</code> and <code>g</code>. You have an <code>a</code> and a <code>a-&gt;a</code>.I do not understand how you  unwrap the functors using <code>(&lt;*&gt;) &lt;$&gt;</code> in the first case."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1555829193, "post_id": 55777813, "comment_id": 98232213, "body": "@BercoviciAdrian In this example, the first list is <code>[Maybe (Integer -&gt; Integer)]</code>. <code>(&lt;$&gt;)</code> maps through the list layer (but not the <code>Maybe</code> one). We have <code>(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt; b) -&gt; (f a -&gt; f b)</code>, so the first <code>(&lt;*&gt;)</code> specialises to <code>Maybe (Integer -&gt; Integer) -&gt; (Maybe Integer -&gt; Maybe Integer)</code> -- we&#39;re (partially) applying <code>(&lt;*&gt;)</code> to the <code>Maybe</code>values in the first list. That being so, <code>(&lt;*&gt;) &lt;$&gt; [Just (+1),Just (+2)]</code> ends up being <code>[Maybe Integer -&gt; Maybe Integer]</code>, which is what you need to use with the second <code>(&lt;*&gt;)</code> (which, like the <code>(&lt;$&gt;)</code>, uses the list <code>Applicative</code>)."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1555829963, "post_id": 55777813, "comment_id": 98232338, "body": "But i do not understand then why you can&#39;t unwrap without using the <code>&lt;$&gt;</code>.I mean <code>(&lt;*&gt;) [Just (+1)]</code> would mean you bind the first argument , and then you can just supply the value one. Your generic argument becomes <code>a</code>=<code>Maybe a</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1555830351, "post_id": 55777813, "comment_id": 98232398, "body": "@BercoviciAdrian For that to work, <code>Just (+1)</code> would have to be a function, but it isn&#39;t one (it is a <code>Maybe</code>-value that holds a function). <code>(&lt;*&gt;)</code> can only work through one applicative layer; that&#39;s why we need a second <code>(&lt;*&gt;)</code>. (The alternative is using <code>Compose</code> to handle the two layers as one.)"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 13, "last_activity_date": 1555794954, "creation_date": 1555794954, "answer_id": 55777813, "question_id": 55777670, "link": "https://stackoverflow.com/questions/55777670/cartesian-product-not-working-for-applicative/55777813#55777813", "title": "Cartesian product not working for applicative", "body": "<p>There are two applicative layers involved here (<code>[]</code> and <code>Maybe</code>), so <code>(&lt;*&gt;)</code> itself must be applied applicatively:</p>\n\n<pre><code>GHCi&gt; (&lt;*&gt;) &lt;$&gt; [Just (+1),Just (+2)] &lt;*&gt; [Just 1 ,Just 2]\n[Just 2,Just 3,Just 3,Just 4]\n</code></pre>\n\n<p>This use case is captured by the <code>Compose</code> newtype. <a href=\"https://stackoverflow.com/a/53681134/2751851\">Nesting any two applicative functors gives rise to another applicative</a>:</p>\n\n<pre><code>GHCi&gt; import Data.Functor.Compose\nGHCi&gt; Compose [Just (+1),Just (+2)] &lt;*&gt; Compose [Just 1 ,Just 2]\nCompose [Just 2,Just 3,Just 3,Just 4]\n</code></pre>\n\n<p>.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 55777813, "answer_count": 1, "score": 1, "last_activity_date": 1555794954, "creation_date": 1555793842, "question_id": 55777670, "link": "https://stackoverflow.com/questions/55777670/cartesian-product-not-working-for-applicative", "title": "Cartesian product not working for applicative", "body": "<p>I was trying to understand applicative and how i  can use it as a cartesian product between <code>K</code> functions and <code>N</code> parameters ,and i can't comprehend why i can't do the following:</p>\n\n<p><code>[Just (+1),Just (+2)] &lt;*&gt; [Just 1 ,Just 2]</code> renders</p>\n\n<p><strong>Error</strong></p>\n\n<pre><code>* Couldn't match expected type `Maybe Integer -&gt; b'\n                  with actual type `Maybe (Integer -&gt; Integer)'\n    * Possible cause: `Just' is applied to too many arguments      In the expression: Just (+ 1)      In the first argument of `(&lt;*&gt;)', namely `[Just (+ 1), Just (+ 2)]'\n      In the expression: [Just (+ 1), Just (+ 2)] &lt;*&gt; [Just 1, Just 2]\n</code></pre>\n\n<p>I do not understand since from the definition it is supposed to take the functions out of the context, take the values and apply all combinations.</p>\n\n<p>I have also tried :</p>\n\n<p><code>:t [pure (+1),pure (+2)] &lt;*&gt; [Just 1 ,Just 2] :: Num a =&gt; [a -&gt; a]</code> and i can't understand why the resulting type is not a list of values (and not <code>a-&gt;a</code>) ,since all operators expect only one argument,and i am  already supplying that.</p>\n\n<p>Can someone shed some light?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1555791925, "post_id": 55777414, "comment_id": 98226975, "body": "Would <code>mkSample = flip Sample &quot;test&quot;</code> be better?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1555791986, "post_id": 55777414, "comment_id": 98226994, "body": "Fundamentally, you can&#39;t <i>not</i> provide an argument, because every function takes exactly one argument, and calling a function without an argument simply isn&#39;t possible in Haskell."}], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "edited": false, "score": 0, "creation_date": 1555866686, "post_id": 55777578, "comment_id": 98240529, "body": "Thanks this works great, I tried it out, But i think ill go ahead an implement the solution above ,as it works slightly better for my code"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 2, "last_activity_date": 1555802874, "last_edit_date": 1555802874, "creation_date": 1555792951, "answer_id": 55777578, "question_id": 55777414, "link": "https://stackoverflow.com/questions/55777414/how-to-create-default-values-for-data-structures-in-haskell/55777578#55777578", "title": "How to create default values for data structures in haskell", "body": "<p><code>Maybe</code> is pretty much made for this kind of situation:</p>\n\n<pre><code>mkSample :: Maybe String -&gt; Maybe String -&gt; Sample\nmkSample ma mb = Sample (maybe \"default a\" id ma) (maybe \"default b\" id mb)\n-- NB: maybe :: b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b\n</code></pre>\n\n<p>This way you can just provide a <code>Nothing</code> if there's no available string:</p>\n\n<pre><code>\u03bb&gt; mkSample Nothing (Just \"World!\")\nSample \"default a\" \"World!\"\n\u03bb&gt; mkSample (Just \"Hello,\") Nothing\nSample \"Hello,\" \"default b\"\n\u03bb&gt; mkSample Nothing Nothing\nSample \"default a\" \"default b\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 6, "last_activity_date": 1555799348, "creation_date": 1555799348, "answer_id": 55778297, "question_id": 55777414, "link": "https://stackoverflow.com/questions/55777414/how-to-create-default-values-for-data-structures-in-haskell/55778297#55778297", "title": "How to create default values for data structures in haskell", "body": "<pre><code>data Sample = Sample { a :: String , b :: String } \ndefaultSample :: Sample\ndefaultSample = Sample \"test\" \"value_b\"\n</code></pre>\n\n<p>Then you can use record syntax:</p>\n\n<pre><code>let mySample = defaultSample { b = \"custom value\" }\n...\n</code></pre>\n"}], "owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 55778297, "answer_count": 2, "score": 0, "last_activity_date": 1555802874, "creation_date": 1555791611, "question_id": 55777414, "link": "https://stackoverflow.com/questions/55777414/how-to-create-default-values-for-data-structures-in-haskell", "title": "How to create default values for data structures in haskell", "body": "<p>I have a data structure like so </p>\n\n<pre><code>data Sample = Sample { a :: String , b :: String } \n</code></pre>\n\n<p>and a function </p>\n\n<pre><code>mkSample :: String -&gt; String -&gt; Sample\nmkSample a b = Sample a b \n</code></pre>\n\n<p>I would like to provide some default values for a ,b in case the calling function does not provide them ,something like </p>\n\n<pre><code>mkSample :: String -&gt; Sample\nmkSample a = Sample a \"test\"\n</code></pre>\n\n<p>1) I dont find this solution elegant , what other alternatives do I have.\n2) How do I create a mkSample for b ,as the type would be the same as the one for a .</p>\n"}, {"tags": ["haskell", "typeclass", "monad-transformers"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1555795880, "post_id": 55777301, "comment_id": 98227769, "body": "Why do you need a more generic type for the callback? In your use case, is there any specific difficulty with supplying a function that returns <code>Kafkamonad (Either Error Result)</code>?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1555797787, "post_id": 55777301, "comment_id": 98228145, "body": "I think you just want a type <i>alias</i>: <code>type CallbackType = ConsumerRecord (Maybe ByteString) (Maybe ByteString) -&gt; Kafkamonad (Either Error Result)</code>. Then <code>getMessages :: CallbackType -&gt; Kafkamonad (Either Error Result)</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1555803171, "post_id": 55777301, "comment_id": 98228998, "body": "You may do this, your getmessages just needs to produce the <code>Either Error Result</code> itself since the callback no longer provides it.  Thus the callback no longer has control over whether an error is thrown or what result is produced. This may or may not be acceptable in your situation."}, {"owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1555865246, "post_id": 55777301, "comment_id": 98240184, "body": "@duplode , So rigth now ,this works fine ,I was just anticipating for the the future , like maybe a case in which I need to write the records to a file . Maybe a return type of Kafkamonad ( Either FileError Bool)"}, {"owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1555865274, "post_id": 55777301, "comment_id": 98240189, "body": "@luqui I didnt quite understand the statement ."}, {"owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1555865335, "post_id": 55777301, "comment_id": 98240202, "body": "@chepner , No I basically need a generalised type for the Callback , I dont think a type declaration would be able to help me with that ?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1555865481, "post_id": 55777301, "comment_id": 98240242, "body": "Well, how is it supposed to be generalized? What specific examples <i>other</i> than <code>ConsumerRecord (Maybe ByteString) (Maybe ByteString) -&gt; Kafkamonad (Either Error Result)</code> do you have in mind? <code>type Callback a = ConsumerRecord (Maybe ByteString) (Maybe ByteString) -&gt; Kafkamonad a</code> would seem to allow <code>a</code> to be either <code>Either Error Result</code> or <code>Either FileError Bool</code>."}, {"owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1555865681, "post_id": 55777301, "comment_id": 98240293, "body": "@chepner ,That is What I want to do , have the type as onsumerRecord (Maybe ByteString) (Maybe ByteString) -&gt; Kafkamonad a , But if I keep this it gives me an error ,so I was just wondering is there a class constraint I can add to resolve this ?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1555865797, "post_id": 55777301, "comment_id": 98240319, "body": "What error are you getting?"}], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "edited": false, "score": 0, "creation_date": 1555867715, "post_id": 55784822, "comment_id": 98240791, "body": "this is what i am getting  Error: \u2022 Couldn&#39;t match type \u2018a\u2019 with \u2018Either Error b0\u2019 \u2018a\u2019 is a rigid type variable bound by the type signature for: getMessages :: forall a. Callback a -&gt; KafkaMonad a at src/Kafka/Consume.hs:48:17  Expected type: KafkaMonad (Either KafkaError b0)  Actual type: KafkaMonad a If this isn&#39;t sufficient let me know , I will try to add the code for the specific functions in the contex"}, {"owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "edited": false, "score": 0, "creation_date": 1555871229, "post_id": 55784822, "comment_id": 98241655, "body": "added some of the details to the question."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1555868725, "last_edit_date": 1555868725, "creation_date": 1555866014, "answer_id": 55784822, "question_id": 55777301, "link": "https://stackoverflow.com/questions/55777301/how-to-use-generic-type-for-functions-in-haskell/55784822#55784822", "title": "How to use generic type for functions in haskell", "body": "<p>You can define a type alias parameterized over the type wrapped by <code>Kafkamonad</code>:</p>\n\n<pre><code>type CallbackType a = ConsumerRecord (Maybe ByteString) (MaybeByteString) -&gt; Kafkamonad a\n</code></pre>\n\n<p>Then you can define <code>getMesagages</code> using this type as well. </p>\n\n<pre><code>getMessages :: CallbackType a -&gt; KafkaMonad (Either Error ())\n</code></pre>\n\n<p>Note that this type annotation dictates what the definition of <code>getMessages</code> can be; you can't make <em>any</em> assumptions about what <code>a</code> might be. If there are any restrictions (imposed by <code>Kafkamonad</code> or by a required definition of <code>getMessages</code>), you'll need to specify those in your question.</p>\n\n<p>Based on your error message, you have unstated assumptions about what what type is wrapped by <code>Kafkamonad</code> which prevents your from fully parameterizing the callback type. Try</p>\n\n<pre><code>type CallbackType a = ConsumerRecord (Maybe ByteString) (MaybeByteString) -&gt; Kafkamonad (Either KafkaError a)\n</code></pre>\n\n<p>or modify your definition to remove the assumptions.</p>\n"}], "owner": {"reputation": 505, "user_id": 6621898, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/10204980448310749/picture?type=large", "display_name": "Tanmay Bhattacharya", "link": "https://stackoverflow.com/users/6621898/tanmay-bhattacharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555871159, "creation_date": 1555790807, "last_edit_date": 1555871159, "question_id": 55777301, "link": "https://stackoverflow.com/questions/55777301/how-to-use-generic-type-for-functions-in-haskell", "title": "How to use generic type for functions in haskell", "body": "<p>I have some code which reads data from a queue . I want the function to be such that it takes a callback function as a parameter , the callback function basically contains code on what to do with the data that is extracted from the queue . The type for the getMessages fucntion is like so </p>\n\n<pre><code>getMessages ::  (ConsumerRecord (Maybe ByteString) (Maybe ByteString) -&gt; Kafkamonad (Either Error Result)) -&gt; KafkaMonad (Either Error ())\n</code></pre>\n\n<p>so the callback function needs to be always of the type </p>\n\n<pre><code>(ConsumerRecord (Maybe ByteString) (Maybe ByteString) -&gt; Kafkamonad (Either Error Result))\n</code></pre>\n\n<p>although this code works I would like to have a more generic type for the get messages function ,something like </p>\n\n<pre><code>getmessages ::(ConsumerRecord (Maybe ByteString) (Maybe ByteString) -&gt; Kafkamonad a) -&gt; KafkaMonad (Either Error ())\nor \ngetMessages ::  f -&gt; KafkaMonad (Either Error ())\n</code></pre>\n\n<p>When I try to use the mentioned Types ,like Kafkamonad a it throws me the error </p>\n\n<pre><code>Couldn't match type \u2018a\u2019 with \u2018Either Error b0\u2019 \u2018a\u2019 is a rigid type variable bound by the type signature for: \ngetMessages :: forall a. Callback a -&gt; KafkaMonad a at src/Kafka/Consume.hs:48:17 \nExpected type: KafkaMonad (Either KafkaError b0) \nActual type: KafkaMonad a \n</code></pre>\n\n<p>The related functions are as follows </p>\n\n<pre><code>type Callback a = ConsumerRecord (Maybe ByteString) (Maybe ByteString) -&gt; KafkaMonad a\ngetMessages ::  Callback a -&gt; KafkaMonad a\ngetMessages callback = do\n       let ....\n       runHandler(Right kc)  = processMessages kc callback\n    bracket mkConsumer clConsumer runHandler\n\nprocessMessages :: Kc -&gt; Callback a -&gt; KafkaMonad a\nprocessMessages k callback=     mapM_ (\\_ -&gt; do\n                    ecr &lt;- pollMessage k (Timeout 1000)\n                    case ecr of\n                      Right cr -&gt;  do\n                                   err &lt;- commitAllOffsets OffsetCommit k\n                                   case err of\n                                        Nothing  -&gt; callback cr\n                                        Just err -&gt; throwIO err \n                      Left err -&gt; return $ Left $ KafkaError \"Procesing Stopped\"  \n\n            ) [0 :: Integer .. ]\n    return $ Right ()\n</code></pre>\n\n<p>What sort of Class constraints can I use to achieve this ? Or any other solution would be great too . </p>\n"}, {"tags": ["haskell", "io"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1555784424, "post_id": 55776393, "comment_id": 98225193, "body": "You&#39;ll need to show enough of the program (and the way you are using it) to include the part that generates the error, which you are not currently doing. Specifically, none of your code includes the use of <code>print</code> that is causing the error. Try to create a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1555784511, "post_id": 55776393, "comment_id": 98225213, "body": "Also, please try to use the code formatting tools. Indentation in Haskell is significant and it may be impossible to know whether your code is correct without seeing how it is actually indented. I&#39;ve gone ahead and done this for you this time."}, {"owner": {"reputation": 21, "user_id": 7009382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaa248d4850500eae633044f0f5d1955?s=128&d=identicon&r=PG&f=1", "display_name": "Julius S", "link": "https://stackoverflow.com/users/7009382/julius-s"}, "edited": false, "score": 0, "creation_date": 1555873729, "post_id": 55776393, "comment_id": 98242346, "body": "To clarify, there is no use of &quot;print&quot; in my program, that&#39;s why the error confused me. The code I have included is completely isolated from any other code in the program."}], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 3, "last_activity_date": 1555784926, "creation_date": 1555784926, "answer_id": 55776535, "question_id": 55776393, "link": "https://stackoverflow.com/questions/55776393/trying-to-write-haskell-function-to-take-string-parameter-and-append-to-file/55776535#55776535", "title": "Trying to write Haskell function to take string parameter and append to file", "body": "<p>Did you attempt to write something like <code>appendText</code> or <code>print appendText</code> in GHCi? If so, it\u2019s attempting to <code>Show</code> the function, which is a type error since function types don\u2019t have a <code>Show</code> instance. You need to invoke it with an argument, being the particular <code>String</code> that you want to append to <code>testfile.txt</code>:</p>\n\n<pre><code>appendText \"test text\"\n</code></pre>\n\n<p>The type of this is <code>IO ()</code>, so it\u2019s an action that can be executed, and after running it you ought to see the text appear in the file.</p>\n\n<p>Your function can also be written more simply as:</p>\n\n<pre><code>appendText x = appendFile \"testfile.txt\" x\n</code></pre>\n\n<p>Or in point-free form:</p>\n\n<pre><code>appendText = appendFile \"testfile.txt\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7009382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaa248d4850500eae633044f0f5d1955?s=128&d=identicon&r=PG&f=1", "display_name": "Julius S", "link": "https://stackoverflow.com/users/7009382/julius-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1555796680, "creation_date": 1555796680, "answer_id": 55778017, "question_id": 55776393, "link": "https://stackoverflow.com/questions/55776393/trying-to-write-haskell-function-to-take-string-parameter-and-append-to-file/55778017#55778017", "title": "Trying to write Haskell function to take string parameter and append to file", "body": "<p>So to be clear, removing the second line allowed the function to work:</p>\n\n<p>appendText :: String -> IO ()</p>\n\n<p>appendText = appendFile \"testfile.txt\"</p>\n\n<p>I'm not sure why this fixed the problem, that line was there for error handling purposes but apparently wasn't needed. It works though, thanks for the help.</p>\n"}], "owner": {"reputation": 21, "user_id": 7009382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaa248d4850500eae633044f0f5d1955?s=128&d=identicon&r=PG&f=1", "display_name": "Julius S", "link": "https://stackoverflow.com/users/7009382/julius-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1555796680, "creation_date": 1555783851, "last_edit_date": 1555796412, "question_id": 55776393, "link": "https://stackoverflow.com/questions/55776393/trying-to-write-haskell-function-to-take-string-parameter-and-append-to-file", "title": "Trying to write Haskell function to take string parameter and append to file", "body": "<p>I am trying to write a function that takes a string as input and appends it to a file. the file is the same file every time. the function compiles correctly but gives the error</p>\n\n<p>\"No instance for (Show (String -> IO ()))\n        arising from a use of `print'\". </p>\n\n<p>The code is:</p>\n\n<pre><code>appendText :: String -&gt; IO ()\n\nappendText [] = return ()\n\nappendText x = appendFile \"testfile.txt\" x \n</code></pre>\n\n<p>I understand the problem is something to do with types and the Show type but I'm having trouble understanding the problem and how to correct it. Any help would be great.</p>\n\n<p>Edit: I am calling it as a function, e.g. appendFile \"random text\"</p>\n"}, {"tags": ["haskell", "functional-programming", "monads", "maybe"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 3, "creation_date": 1555783160, "post_id": 55776086, "comment_id": 98224858, "body": "That paper was written back in 2006, and at that time <code>lookup</code> was <a href=\"http://hackage.haskell.org/package/containers-0.1.0.0/docs/Data-Map.html\" rel=\"nofollow noreferrer\">indeed defined like this</a>"}, {"owner": {"reputation": 294, "user_id": 6822857, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/304b98bc09f62d97145b44885d46ccb9?s=128&d=identicon&r=PG&f=1", "display_name": "guser", "link": "https://stackoverflow.com/users/6822857/guser"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1555783464, "post_id": 55776086, "comment_id": 98224946, "body": "oh thanks, such a simple explanation"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1555784767, "post_id": 55776086, "comment_id": 98225273, "body": "I really, really wish one of the authors would write an update. There are now a few different things in that (truly excellent) tutorial that don&#39;t quite work as written in modern Haskell."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1555785191, "post_id": 55776086, "comment_id": 98225380, "body": "You can recover the old behaviour with a wrapper like <code>mapLookup k m = case Map.lookup k m of { Just v -&gt; pure v; Nothing -&gt; fail &quot;Data.Map.lookup: Key not found&quot; }</code>\u2014in pointfree form: <code>mapLookup = fmap (maybe (fail &quot;\u2026&quot;) pure) . Map.lookup</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1555785288, "post_id": 55776086, "comment_id": 98225403, "body": "@JonPurdy, that will very soon require a (long-overdue) shift from <code>Monad</code> to <code>MonadFail</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1555800023, "post_id": 55776086, "comment_id": 98228495, "body": "@JonPurdy (and dfeuer): I have added the compatibility wrapper to my answer to the target question."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1555824825, "post_id": 55776086, "comment_id": 98231551, "body": "@dfuer it already does require <code>MonadFail</code>, since GHC 8.6.1"}], "owner": {"reputation": 294, "user_id": 6822857, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/304b98bc09f62d97145b44885d46ccb9?s=128&d=identicon&r=PG&f=1", "display_name": "guser", "link": "https://stackoverflow.com/users/6822857/guser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "closed_date": 1555784227, "answer_count": 0, "score": 1, "last_activity_date": 1555781810, "creation_date": 1555781810, "question_id": 55776086, "link": "https://stackoverflow.com/questions/55776086/map-lookup-is-defined-to-work-within-any-monad", "closed_reason": "Duplicate", "title": "Map.lookup is defined to work within any monad", "body": "<p>So I am learning some Haskell, and while reading \"Monad Transformers Step by Step\" by Martin Grabm\u00fcller I came across to the following example. \n<a href=\"https://i.stack.imgur.com/7MXyW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7MXyW.png\" alt=\"excerpt from the paper\"></a></p>\n\n<p>These are the imports used in the given code. </p>\n\n<pre><code>import Control.Monad.Identity\nimport Control.Monad.Error\nimport Control.Monad.Reader\nimport Control.Monad.State\nimport Control.Monad.Writer\nimport Data.Maybe\nimport qualified Data.Map as Map\n</code></pre>\n\n<p>I don't really understand how the line <code>eval1 env (Var n) = Map.lookup n env</code> should work. In the explanation it is written that the function <code>Map.lookup</code> works with every monad, while the return type is clearly defined as <code>Maybe a</code></p>\n\n<pre><code>Map.lookup :: Ord k =&gt; k -&gt; Map.Map k a -&gt; Maybe a \n</code></pre>\n\n<p>Neither I am able to compile the code,nor I understand the explanation. So am I missing something? Can anyone give a better explanation for the code? </p>\n\n<p>P.S. Link to the paper \n<a href=\"https://page.mi.fu-berlin.de/scravy/realworldhaskell/materialien/monad-transformers-step-by-step.pdf\" rel=\"nofollow noreferrer\">https://page.mi.fu-berlin.de/scravy/realworldhaskell/materialien/monad-transformers-step-by-step.pdf</a></p>\n"}, {"tags": ["haskell", "existential-type", "rank-n-types"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1555784638, "post_id": 55775989, "comment_id": 98225241, "body": "FYI, switching between <code>newtype</code> and <code>data</code> has no hope of helping you solve any type errors, unless the type declaration itself produces an error."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1555787535, "post_id": 55775989, "comment_id": 98225962, "body": "Are you sure you don&#39;t want <code>runYield :: Yield i a -&gt; i -&gt; (forall a2 . Yield i a2 -&gt; a2) -&gt; a</code> ? With your signature it looks incorrect to me -- you need the rank-2 type."}, {"owner": {"reputation": 4008, "user_id": 81557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c89ce60c117454b3476c382d0439c4c1?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/81557/scott"}, "edited": false, "score": 0, "creation_date": 1555788740, "post_id": 55775989, "comment_id": 98226207, "body": "This seems to produce the same error as in the first scenario."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1555788799, "post_id": 55775989, "comment_id": 98226222, "body": "Am I being dense? I don&#39;t see any existential variables. <code>data Await i = Await i (Await i)</code> and <code>newtype Yield i a = Yield (Await i -&gt; a)</code> if you remove all the CPS, no? It&#39;s rank-1 universal quantification all the way through?"}, {"owner": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1555789844, "post_id": 55775989, "comment_id": 98226473, "body": "I retract my answer; @chi&#39;s comment is the way to go, I think. You might need to rewrite <code>runYield</code> in pointful form to make it work."}, {"owner": {"reputation": 4008, "user_id": 81557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c89ce60c117454b3476c382d0439c4c1?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/81557/scott"}, "edited": false, "score": 0, "creation_date": 1555791671, "post_id": 55775989, "comment_id": 98226924, "body": "Did the trick! Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 4008, "user_id": 81557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c89ce60c117454b3476c382d0439c4c1?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/81557/scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1555794587, "creation_date": 1555794587, "answer_id": 55777764, "question_id": 55775989, "link": "https://stackoverflow.com/questions/55775989/having-it-both-ways-with-rank-n-types/55777764#55777764", "title": "Having it both ways with rank-n-types", "body": "<p>I ran into the same problem once I tried to define the <code>yield</code> function; i had to remove the extra type variable from <code>yield</code> and it wouldn't typecheck.</p>\n\n<p>The solution turned out to be to redefine the types as such:</p>\n\n<pre><code>newtype Await i = Await { unAwait :: forall b. Yield' i b -&gt; b }     \nnewtype Yield i = Yield { unYield :: forall b. i -&gt; Await' i b -&gt; b }\n\ntype Await' i a = Yield i -&gt; a                                       \ntype Yield' i a = i -&gt; Await i -&gt; a                                  \n</code></pre>\n\n<p>This way, there's no additional constructor to swallow type variables in <code>await</code>:</p>\n\n<pre><code>await :: Piped (Await i, y) i                  \nawait = Piped $                                \n  \\(Await a, y) f -&gt; a $ \\i a' -&gt; f (a', y) i\n</code></pre>\n"}], "owner": {"reputation": 4008, "user_id": 81557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c89ce60c117454b3476c382d0439c4c1?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/81557/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1555794587, "creation_date": 1555781130, "last_edit_date": 1555785116, "question_id": 55775989, "link": "https://stackoverflow.com/questions/55775989/having-it-both-ways-with-rank-n-types", "title": "Having it both ways with rank-n-types", "body": "<p>I'm playing with a ConduitT style monad that uses existential quantification, and I'm playing whack-a-mole trying to get the types to unify. There's two versions of this scenario:</p>\n\n<p>Here, <code>Await i</code> has an existentially quantified <code>a</code>, which allows the <code>await</code> method to pass it whatever type of <code>i -&gt; Await i -&gt; a</code> that it wants. </p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nnewtype Piped r a = Piped { unPiped :: forall b. r -&gt; (r -&gt; a -&gt; b) -&gt; b }\n\ninstance Functor (Piped r) where                              \n  fmap f (Piped c) = Piped $ \\r rest -&gt; c r (\\r -&gt; rest r . f)\n\nrunPiped :: Piped r a -&gt; r -&gt; a      \nrunPiped (Piped p) r = p r $ \\_ -&gt; id\n\nnewtype Await i = Await { unAwait :: forall a. Yield i a -&gt; a }           \nnewtype Yield i a = Yield { unYield :: i -&gt; Await i -&gt; a }                \n\nrunAwait :: Await i -&gt; (i -&gt; Await i -&gt; a) -&gt; a                           \nrunAwait (Await await) = await . Yield                                    \n\nrunYield :: Yield i a -&gt; i -&gt; (Yield i a -&gt; a) -&gt; a                       \nrunYield (Yield yield) i = yield i . Await\n                     -- broke        ^^^^^\n                     -- because Await swallows the type of `a`                                \n\nawait :: forall i a y. Piped (Await i, y) i                               \nawait = Piped $                                                           \n  \\(a, y) f -&gt; runAwait a $ \\i a' -&gt; f (a', y) i \n</code></pre>\n\n<p>Fails with:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018Yield i a -&gt; a\u2019\n                 with \u2018forall a1. Yield i a1 -&gt; a1\u2019\n  Expected type: (Yield i a -&gt; a) -&gt; Await i\n    Actual type: (forall a. Yield i a -&gt; a) -&gt; Await i\n\u2022 In the second argument of \u2018(.)\u2019, namely \u2018Await\u2019\n</code></pre>\n\n<p>The <code>runYield</code> method is broken because it can't unify the existentially qualified type parameter in <code>Await i</code> with <code>a</code>.</p>\n\n<p>Second scenario:</p>\n\n<p>In order to fix <code>runYield</code>, <code>Await</code> now specifies <code>a</code>, which unifies <code>Await i a</code> with <code>Yield i a</code>. However, now that <code>a</code> is specified, <code>yield</code> can't pass it an <code>Yield i b</code> with any value of <code>b</code> that it pleases:</p>\n\n<pre><code>newtype Piped r a = Piped { unPiped :: forall b. r -&gt; (r -&gt; a -&gt; b) -&gt; b }\nnewtype Await i a = Await { unAwait :: Yield i a -&gt; a }                   \nnewtype Yield i a = Yield { unYield :: i -&gt; Await i a -&gt; a }              \n\nrunAwait :: Await i a -&gt; (i -&gt; Await i a -&gt; a) -&gt; a                       \nrunAwait (Await await) = await . Yield                                    \n\nrunYield :: Yield i a -&gt; i -&gt; (Yield i a -&gt; a) -&gt; a                       \nrunYield (Yield yield) i = yield i . Await                                \n\nawait :: Piped (Await i a, y) i                                           \nawait = Piped $                                                           \n  \\(a, y) f -&gt; runAwait a $ \\i a' -&gt; f (a', y) i                          \n-- ^^^^^^\n</code></pre>\n\n<p>Fails with:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018b\u2019 with \u2018a\u2019\n  \u2018b\u2019 is a rigid type variable bound by\n    a type expected by the context:\n      forall b. (Await i a, y) -&gt; ((Await i a, y) -&gt; i -&gt; b) -&gt; b\n  Expected type: (Await i a, y)\n    Actual type: (Await i b, y)\n</code></pre>\n\n<p>So I appear to need it both ways, existentially quantified sometimes and concrete other times. I've tried creating wrappers to hide the extra type parameter, switching <code>newtype</code> for <code>data</code>, and it also occurred to me that if i could define a function <code>Await i a -&gt; Await i b</code> that might also solve the issue but I'm a bit out of my depth here. Any ideas?</p>\n"}, {"tags": ["haskell", "type-mismatch", "io-monad", "do-notation"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1555779434, "post_id": 55775735, "comment_id": 98223787, "body": "You should <code>fmap quicksort (randomList 10)</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 5, "creation_date": 1555779591, "post_id": 55775735, "comment_id": 98223847, "body": "you should include type signatures for all top-level names in your program. if you don&#39;t know them, load the file and ask GHCi: <code>Main&gt; :t randomList</code>. Then copy-paste it to the file (or specialize it first, as you see fit). Place the type signature above the name it describes."}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1555780247, "post_id": 55775735, "comment_id": 98224036, "body": "@WillemVanOnsem,  Yes, great, it works that way."}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1555781480, "post_id": 55775924, "comment_id": 98224408, "body": "When compiling, I get an error in this line: &quot;randomList :: (System.Random.Random t, Num t) =&gt; Int -&gt; IO [t]&quot;  Not in scope: type constructor or class \u2018System.Random.Random\u2019"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1555781559, "post_id": 55775924, "comment_id": 98224429, "body": "do <code>import System</code> as a whole, without the <code>(randomRIO)</code>."}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1555782419, "post_id": 55775924, "comment_id": 98224661, "body": "Can I do the following afterwards? <code>sort n = do</code> \t<code>list &lt;- randomList n</code> \t<code>let res = sortRandom list</code> \t<code>return res </code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 1, "creation_date": 1555784732, "post_id": 55775924, "comment_id": 98225263, "body": "no. follow the types! (that&#39;s the general slogan of Haskell). go one by one, slowly, write down the types: <code>randomList n :: IO [Int]</code>; hence, <code>list :: [Int]</code>; <code>sortRandom :: (Monad m) =&gt; m [Int] -&gt; m [Int]</code>, or specifically for <code>IO</code>, <code>sortRandom :: IO [Int] -&gt; IO [Int]</code>. this means it is a function that expects <code>IO [Int]</code>, not just <code>[Int]</code>. So <code>list :: [Int]</code> can&#39;t be its argument. but we have <code>quicksort</code> which can accept the <code>[Int]</code> argument, so for <code>let res = quicksort list</code>, <code>res :: [Int]</code>. and so <code>return res :: IO [Int]</code>. I&#39;ll search for a link to an explanation of <code>do</code> shortly..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1555785159, "post_id": 55775924, "comment_id": 98225370, "body": "@Vasiliy, if you&#39;re working in <code>IO</code>, and with randomness, you should really use a genuine quicksort instead of that fake one! The only tricky thing is that you&#39;ll have to switch from lists to arrays. Of course, if you&#39;re not dedicated to quicksort, you should almost certainly use a different algorithm instead: bottom-up mergesort is very nice in Haskell, and heapsort is all right too."}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1555787988, "post_id": 55775924, "comment_id": 98226052, "body": "@ WillNess, While there is no clear understanding of how this works. But you are helping me great! Thank you!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1555831745, "post_id": 55775924, "comment_id": 98232641, "body": "@Vasiliy I try to explain the do notation <a href=\"https://stackoverflow.com/a/44728131/849891\">here</a>. also check out <a href=\"https://stackoverflow.com/search?q=%5Bdo-notation%5D+user%3A849891\">my other answers</a> in the <a href=\"https://stackoverflow.com/questions/tagged/do-notation\">do-notation</a> tag."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1555835598, "post_id": 55775924, "comment_id": 98233321, "body": "@Vasiliy also, <a href=\"https://stackoverflow.com/a/50815136/849891\">this</a>. so with do notation, the stuff to the right of <code>&lt;-</code> lives in some monad <code>M</code> -- It can be <code>M a</code>,<code>M b</code> etc., but with the same <code>M</code> for every line in <code>do</code>. and if there&#39;s an <code>M a</code> type value to the right of <code>&lt;-</code>, the value to its left has type <code>a</code>. that&#39;s the main thing. also, <code>do</code>s can be nested and unnested freely: `do { A ; B ; C } == do { A ; do {B ; C}} == do { do { A; B }; C }.  if you have a question, don&#39;t hesitate to ask."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 3, "last_activity_date": 1555781778, "last_edit_date": 1555781778, "creation_date": 1555780640, "answer_id": 55775924, "question_id": 55775735, "link": "https://stackoverflow.com/questions/55775735/why-cant-i-call-a-function-quicksort-randomlist-10/55775924#55775924", "title": "Why can&#39;t I call a function quicksort (randomList 10)?", "body": "<p>You should include type signatures for all top-level names in your program. if you don't know them, load the file and ask GHCi: <code>Main&gt; :t randomList</code>. Then copy-paste it to the file (or specialize it first, as you see fit). Place the type signature above the name it describes.</p>\n\n<p>GHCi says</p>\n\n<pre><code>randomList ::\n  (System.Random.Random t, Num t, Num a, Eq a) =&gt; a -&gt; IO [t]\n</code></pre>\n\n<p>but you most probably meant</p>\n\n<pre><code>randomList :: (System.Random.Random t, Num t) =&gt; Int -&gt; IO [t]\nrandomList 0 = return []\nrandomList n = do\n  r  &lt;- randomRIO (1,6)    -- randomRIO (1,6) :: IO t  , r :: t\n  rs &lt;- randomList (n-1)   --             rs :: [t]\n  return (r:rs)            --    r :: t , rs :: [t] \n</code></pre>\n\n<p>In general,</p>\n\n<pre><code>randomRIO (1,6) :: (System.Random.Random a, Num a) =&gt; IO a\n</code></pre>\n\n<p>You cast a 6-sided die <code>n</code> times and collect the results in a list. By the way the same thing is done by</p>\n\n<pre><code>sequence $ replicate n (randomRIO (1,6))\n===\nreplicateM n (randomRIO (1,6))\n\n&gt; :t \\n -&gt; replicateM n (randomRIO (1,6))\n           :: (System.Random.Random a, Num a) =&gt; Int -&gt; IO [a]\n</code></pre>\n\n<p>Then, GHCi also tells us that</p>\n\n<pre><code> quicksort :: Ord t =&gt; [t] -&gt; [t]\n</code></pre>\n\n<p>But <code>randomList n</code> is  <code>IO [t]</code>, not <code>[t]</code>. To get to the <code>[t]</code> value living inside the <code>IO [t]</code>, you need to do it <em>on the inside</em>:</p>\n\n<pre><code>sortRandom :: (Ord t, Monad m) =&gt; m [t] -&gt; m [t]\nsortRandom randomlist = do\n    xs &lt;- randomlist        -- randomlist :: IO [t] , xs :: [t]\n    let ys = quicksort xs\n    return ys\n</code></pre>\n\n<p>The above can be abbreviated to</p>\n\n<pre><code>sortRandom :: (Ord t, Monad m) =&gt; m [t] -&gt; m [t]\nsortRandom = liftM quicksort     -- for monads\n</code></pre>\n\n<p>or</p>\n\n<pre><code>sortRandom :: (Ord t, Functor f) =&gt; f [t] -&gt; f [t]\nsortRandom = fmap quicksort      -- for functors\n</code></pre>\n\n<p>whichever you prefer. Both work with <code>IO</code> which is a monad, and any monad is also a functor. So in the end you can define</p>\n\n<pre><code>foo :: Int -&gt; IO [Int]\nfoo n = liftM quicksort $ replicateM n (randomRIO (1,6))\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 55775924, "answer_count": 1, "score": 2, "last_activity_date": 1555781778, "creation_date": 1555779354, "last_edit_date": 1555781204, "question_id": 55775735, "link": "https://stackoverflow.com/questions/55775735/why-cant-i-call-a-function-quicksort-randomlist-10", "title": "Why can&#39;t I call a function quicksort (randomList 10)?", "body": "<p>I have the following code:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Array\nimport Control.Monad\nimport Data.Functor \nimport System.Random (randomRIO)\n\nrandomList 0 = return []\nrandomList n = do\n  r  &lt;- randomRIO (1,6)\n  rs &lt;- randomList (n-1)\n  return (r:rs) \n\nquicksort [] = []  \nquicksort (x:xs) =   \n    let smallerSorted = quicksort [a | a &lt;- xs, a &lt;= x]  \n        biggerSorted = quicksort [a | a &lt;- xs, a &gt; x]  \n    in  smallerSorted ++ [x] ++ biggerSorted  \n</code></pre>\n\n<ol>\n<li>randomList - creates a list of a given length and populates it with random values;</li>\n<li>quicksort  - quickly sorts the list.</li>\n</ol>\n\n<p>I need to apply sorting to the created array:\n<code>quicksort (randomList 10)</code>, but an error occurs: </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\"Couldn't match expected type\u2018 [a] \u2019with actual type IO [Int]\u2019\"\n</code></pre>\n"}, {"tags": ["haskell", "unique"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1555777889, "post_id": 55775412, "comment_id": 98223337, "body": "(1) Would strengthening the constraint from <code>Eq</code> to <code>Ord</code> be a problem? If it wouldn&#39;t, you might find use in  <code>Ord</code>-exploiting nub functions like <a href=\"https://hackage.haskell.org/package/containers-0.6.0.1/docs/Data-Containers-ListUtils.html\" rel=\"nofollow noreferrer\">these ones</a>. (2) I suggest adding your mutable vector implementation, in case you want folks to have a look at it."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1555778169, "post_id": 55775412, "comment_id": 98223407, "body": "@duplode Code added. In my situation, <code>vs</code> is a list of triplets of doubles, so I think <code>Ord</code> is nice. I take a look at your link, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1555784176, "post_id": 55775894, "comment_id": 98225144, "body": "This is probably better than any <code>nubOrd</code> solution (cf. <a href=\"https://stackoverflow.com/questions/55775412/unique-elements-of-a-list-and-corresponding-indices?noredirect=1#comment98223337_55775412\">my comment above</a>), as it only does a single pass through the input list, and therefore doesn&#39;t require holding it in memory."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1555786828, "post_id": 55775894, "comment_id": 98225792, "body": "Or <code>bimap (x:) (i:)</code>, which you can get from <code>Data.Bifunctor</code> along with <code>first</code> and <code>second</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1555787126, "post_id": 55775894, "comment_id": 98225859, "body": "As for <code>insertLookupWithKey</code> ... that&#39;s a mess of a function. I think it&#39;s better to guide people toward the more general <code>alterF</code> interface."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1555828577, "post_id": 55775894, "comment_id": 98232127, "body": "Thank you, it works well. Could you explain why the <code>Ord</code> constraint is needed? I don&#39;t see."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1555845311, "post_id": 55775894, "comment_id": 98235397, "body": "Oh I see this is required for the keys of the map."}], "tags": [], "owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "is_accepted": true, "score": 3, "last_activity_date": 1555780398, "creation_date": 1555780398, "answer_id": 55775894, "question_id": 55775412, "link": "https://stackoverflow.com/questions/55775412/unique-elements-of-a-list-and-corresponding-indices/55775894#55775894", "title": "Unique elements of a list and corresponding indices", "body": "<p>It's helpful for things like these to focus on what state you actually need to maintain, and then encode that as an extra parameter to your recursive function. For this case, you need:</p>\n\n<ul>\n<li>The elements you've seen so far (and their positions).</li>\n<li>The position in the output list you're at.</li>\n</ul>\n\n<p>The first of those can be encapsulated with <code>Map</code>, and the second with an <code>Int</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>uniqInds :: Ord a =&gt; [a] -&gt; ([a], [Int])\nuniqInds = go 0 Map.empty\n  where\n    go i m [] = ([],[])\n    go i m (x:xs) = case Map.insertLookupWithKey (\\_ _ j -&gt; j) x i m of\n        (Nothing, m') -&gt; first (x:) (second (i:) (go (i+1) m' xs))\n        (Just j , m') -&gt;             second (j:) (go i     m' xs)\n</code></pre>\n\n<p><code>Map.insertLookupWithKey</code> is a function that lets us do the lookup and alter at the same time. <code>first</code> and <code>second</code> map a function over the first and second elements in a tuple, respectively. You can actually rewrite this function as a fold:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>uniqInds :: Ord a =&gt; [a] -&gt; ([a], [Int])\nuniqInds xs = foldr f (\\_ _ -&gt; ([],[])) xs 0 Map.empty\n  where\n    f x xs i m = case Map.insertLookupWithKey (\\_ _ j -&gt; j) x i m of\n        (Nothing, m') -&gt; first (x:) (second (i:) (xs (i+1) m'))\n        (Just j , m') -&gt;             second (j:) (xs i     m') \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 1, "creation_date": 1555828657, "post_id": 55777058, "comment_id": 98232138, "body": "Thank you,this is instructive. I have benchmarked and it seems that oisdk&#39;s solution is slightly faster (really slightly). But I have not tested many situations."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 1, "creation_date": 1555863542, "post_id": 55777058, "comment_id": 98239722, "body": "@St&#233;phaneLaurent, it&#39;s not surprising that would sometimes be the case. But at what point do clarity and the mental cost of learning a bunch of specialized functions overtake performance?"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1555792171, "last_edit_date": 1555792171, "creation_date": 1555788989, "answer_id": 55777058, "question_id": 55775412, "link": "https://stackoverflow.com/questions/55775412/unique-elements-of-a-list-and-corresponding-indices/55777058#55777058", "title": "Unique elements of a list and corresponding indices", "body": "<p>This is a variation of oisdk's solution that uses <code>alterF</code> instead of the older, less powerful, and stranger <code>insertLookupWithKey</code>.</p>\n\n<pre><code>import qualified Data.Map.Strict as M\nimport Data.Bifunctor\n\nuniqInds :: Ord a =&gt; [a] -&gt; ([a], [Int])\nuniqInds = go 0 M.empty\n  where\n    go i m [] = ([],[])\n    go i m (x:xs) = case M.alterF chg x m of\n       Right m' -&gt; bimap (x:) (i:) (go (i+1) m' xs)\n       Left j -&gt; second (j:) (go i m xs)\n      where\n        -- The value wasn't found. Insert its index.\n        chg Nothing = Right (Just i)\n        -- The value was found. Return its index.\n        chg (Just j) = Left j\n</code></pre>\n\n<p>This uses <code>alterF</code> with the <code>Either Int</code> functor. At each step, you <em>either</em> get the stored index <em>or</em> you get a new map.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 55775894, "answer_count": 2, "score": 2, "last_activity_date": 1555792171, "creation_date": 1555777070, "last_edit_date": 1555778096, "question_id": 55775412, "link": "https://stackoverflow.com/questions/55775412/unique-elements-of-a-list-and-corresponding-indices", "title": "Unique elements of a list and corresponding indices", "body": "<p>Given a list <code>vs</code>, I want to get the list <code>vs'</code> of the unique elements of <code>vs</code>, as well as the indices of the elements of <code>vs</code> in <code>vs'</code>. For example, if <code>vs = [7, 8, 7, 8, 9]</code> I want to get <code>[7,8,9]</code> (the unique elements) and <code>[0,1,0,1,2]</code> (the indices).</p>\n\n<p>An easy implementation is:</p>\n\n<pre><code>import           Data.List\nimport           Data.Maybe\n\nunique :: Eq a =&gt; [a] -&gt; ([a], [Int])\nunique vs = (vsnub, indices)\n  where\n  vsnub = nub vs\n  indices = map (\\v -&gt; fromJust $ elemIndex v vsnub) vs\n</code></pre>\n\n<p>Is there a more efficient option?</p>\n\n<p>I've done an implementation of the following pseudo-code (saying that <code>vs</code> is a list of numbers) with the help of mutable vectors, but this is slow:</p>\n\n<pre><code>n = length of vs\nidx = list of n integers (to store the indices)\nvisited = [false, false, ..., false] (n elements)\nnvs = list of n numbers (to store the unique elements)\ncount = 0 \nfor(i = 0; i &lt; n; ++i)\n{\n  if(not visited[i])\n  {\n    nvs[count] = vs[i]\n    idx[i] = count\n    visited[i] = true\n    for(j = i+1; j &lt; n; ++j)\n    {\n      if(vs[j] = vs[i])\n      {\n        visited[j] = true\n        idx[j] = count\n      }\n    }\n    count ++\n  }\n}\nnvs = first 'count' elements of nvs\n</code></pre>\n\n<h1>EDIT</h1>\n\n<p>Here is my code using mutable vectors (slow):</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\nimport           Control.Monad               ((&gt;&gt;=))\nimport           Data.Vector.Unboxed         (Unbox, Vector, freeze, (!))\nimport           Data.Vector.Unboxed.Mutable (IOVector, new, write)\nimport qualified Data.Vector.Unboxed.Mutable as VM\n\nunique' :: forall a . (Unbox a, Eq a) =&gt; [a] -&gt; IO (Vector a, Vector Int)\nunique' vs = do\n  let n = length vs\n  idx &lt;- VM.replicate n 0 :: IO (IOVector Int)\n  visited &lt;- VM.replicate n False :: IO (IOVector Bool)\n  nvs &lt;- new n :: IO (IOVector a)\n  let inner :: Int -&gt; Int -&gt; Int -&gt; IO ()\n      inner i j count | j == n = return ()\n                      | otherwise =\n                        if vs !! i == vs !! j\n                          then do\n                            write visited j True\n                            write idx j count\n                            inner i (j+1) count\n                          else inner i (j+1) count\n  let go :: Int -&gt; Int -&gt; IO (IOVector a)\n      go i count | i == n = return $ VM.take count nvs\n                 | otherwise = do\n                   vst &lt;- VM.read visited i\n                   if not vst\n                     then do\n                       write nvs count (vs !! i)\n                       write idx i count\n                       write visited i True\n                       _ &lt;- inner i (i+1) count\n                       go (i+1) (count + 1)\n                     else go (i+1) count\n  nvs' &lt;- go 0 0 &gt;&gt;= freeze\n  idx' &lt;- freeze idx\n  return (nvs', idx')\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "ghci"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1555773846, "post_id": 55774780, "comment_id": 98222278, "body": "Are they different versions?"}, {"owner": {"reputation": 500, "user_id": 3965949, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002388130233/picture?type=large", "display_name": "Finn", "link": "https://stackoverflow.com/users/3965949/finn"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1555777582, "post_id": 55774780, "comment_id": 98223236, "body": "Both are version 8.6.4"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1555784159, "post_id": 55774780, "comment_id": 98225138, "body": "What do <code>which ghc</code> and <code>which ghci</code> show? I imagine you may have two copies of haskell installed, one of which is broken."}, {"owner": {"reputation": 500, "user_id": 3965949, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002388130233/picture?type=large", "display_name": "Finn", "link": "https://stackoverflow.com/users/3965949/finn"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1555785244, "post_id": 55774780, "comment_id": 98225393, "body": "@amalloy both are in <code>&#47;usr&#47;bin&#47;</code>. How could I figure out if/where/how I have two copies of Haskell installed?"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1555820429, "post_id": 55779368, "comment_id": 98231053, "body": "To avoid breakage, you might want to specify the same version of the package that&#39;s already installed."}, {"owner": {"reputation": 500, "user_id": 3965949, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002388130233/picture?type=large", "display_name": "Finn", "link": "https://stackoverflow.com/users/3965949/finn"}, "edited": false, "score": 0, "creation_date": 1555851696, "post_id": 55779368, "comment_id": 98236703, "body": "You&#39;re spot-on that <code>Random.dyn_hi</code> exists but <code>Random.hi</code> doesn&#39;t. I ran the command <code>cabal install --force-reinstall random</code>, and now I&#39;m able to compile files that import <code>System.Random</code> using the <code>ghc</code> command. However, now when I run <code>ghc-pkg field random import-dirs</code>, I two lines of output: <code>import-dirs: &#47;home&#47;finn&#47;.cabal&#47;lib&#47;x86_64-linux-ghc-8.6.4&#47;random-1.1-3ypV&zwnj;&#8203;4EIycgb35PKjTYYr5q</code> and <code>import-dirs: &#47;usr&#47;lib&#47;ghc-8.6.4&#47;site-local&#47;random-1.1</code>. Is it a problem that it now exists in two places? Should I uninstall one of them?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1555864444, "post_id": 55779368, "comment_id": 98239970, "body": "It looks like this is an Arch Linux peculiarity.  I&#39;ve updated my answer."}, {"owner": {"reputation": 500, "user_id": 3965949, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002388130233/picture?type=large", "display_name": "Finn", "link": "https://stackoverflow.com/users/3965949/finn"}, "edited": false, "score": 0, "creation_date": 1555875397, "post_id": 55779368, "comment_id": 98242762, "body": "Thank you! I didn&#39;t realize that Arch was relevant, which is why I didn&#39;t even mention it, so I&#39;m impressed that you were able to identify the issue despite my incomplete information. I couldn&#39;t ask for a better answer, and in the future, I&#39;ll use dynamic linking."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1555864445, "last_edit_date": 1555864445, "creation_date": 1555813355, "answer_id": 55779368, "question_id": 55774780, "link": "https://stackoverflow.com/questions/55774780/why-does-ghci-understand-imports-that-ghc-doesnt/55779368#55779368", "title": "Why does GHCi understand imports that GHC doesn&#39;t?", "body": "<p><em>Update:</em>  It looks like this is an Arch Linux peculiarity, not a corrupt package.  I've updated my answer accordingly.</p>\n\n<p>GHCi loads \"dynamic\" versions of modules.  By default, GHC links with \"static\" versions of modules.  In particular, when you run:</p>\n\n<pre><code>&gt; import System.Random\n</code></pre>\n\n<p>under GHCi, it tries to access the file <code>Random.dyn_hi</code> to get interface information for the module.  In contrast, when you compile a file with that import statement in it, GHC tries to access the file <code>Random.hi</code>.</p>\n\n<p>You can verify this is the issue by running <code>ghc-pkg field random import-dirs</code> and peeking in the resulting directory.  There should be a <code>System</code> subdirectory that usually has two files in it:  <code>System.hi</code> and <code>System.dyn_hi</code>.  If the former is missing, that's your problem.</p>\n\n<p>Now, it looks like you're probably using Arch Linux.  As documented on the Arch <a href=\"https://wiki.archlinux.org/index.php/Haskell\" rel=\"nofollow noreferrer\">Haskell wiki page</a> in the section \"Problems with linking\", the Arch Haskell community packages (including <code>haskell-random</code>) intentionally omit the static versions of interface files and libraries.</p>\n\n<p>There are several of workarounds given there:</p>\n\n<ul>\n<li>You can use dynamic linking when compiling with GHC.  When using GHC directly, this just means passing the <code>-dynamic</code> flag.  For Cabal-based projects, instructions are given on that page for modifying your <code>~/.cabal/config</code> to use dynamic linking for all projects.</li>\n<li>You can install the <code>ghc-static</code> and <code>ghc-pristine</code> packages and set up your path and/or Cabal to use the compiler in <code>/usr/share/ghc-pristine/bin/ghc</code> which will maintain its own separate package database that won't interfere with globally installed Haskell community packages, like <code>haskell-random</code>.</li>\n<li>You can install <code>ghc-static</code> to get static versions of the base libraries and then run <code>cabal install --force-reinstalls somepackage</code> for all the non-base packages you need.  Note that the Wiki notes that this can be tedious and complicated, since you have to manually determine all the package dependencies.</li>\n</ul>\n\n<p>Now, it looks like you already had <code>ghc-static</code> installed, or when invoking GHC you would have <em>also</em> gotten an error about missing files in the <code>base</code> package.  You ran <code>cabal install --force-reinstalls random</code>, though as @dfeuer notes, it might have been safer to run:</p>\n\n<pre><code>$ cabal install --force-reinstalls random-1.1\n</code></pre>\n\n<p>to ensure that the same version was reinstalled.</p>\n\n<p>Anyway, this installed an additional copy of <code>random</code> in your user-specific package directory.  If you run:</p>\n\n<pre><code>$ ghc-pkg list\n</code></pre>\n\n<p>you'll see that <code>random-1.1</code> is listed both under the global database and user database:</p>\n\n<pre><code>/usr/lib/ghc-8.6.4/package.conf.d\n    ...\n    random-1.1\n    ...\n/home/xxxx/.ghc/x86_64-linux-8.6.4/package.conf.d\n    random-1.1\n</code></pre>\n\n<p>and if you run:</p>\n\n<pre><code>$ ghc-pkg describe random\n</code></pre>\n\n<p>you'll see that it lists the two separate installed versions which is why you now get duplicate fields with <code>ghc-pkg field random import-dirs</code>.</p>\n\n<p>There shouldn't be anything wrong with this.  Your user database will take precedence over the global database, so your newly installed version of <code>random</code> will be used when you run GHCi or GHC.</p>\n\n<p>Note that, if you change your mind and want to back out this reinstallation (and maybe try one of the other solutions suggested on the Wiki), you should be able to run:</p>\n\n<pre><code>$ ghc-pkg unregister --user random\n</code></pre>\n\n<p>Technically, this won't actually remove the package (as the compiled version will still be there under <code>~/.cabal/lib</code>), but it should otherwise put things back the way they were.</p>\n"}], "owner": {"reputation": 500, "user_id": 3965949, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002388130233/picture?type=large", "display_name": "Finn", "link": "https://stackoverflow.com/users/3965949/finn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 0, "accepted_answer_id": 55779368, "answer_count": 1, "score": 4, "last_activity_date": 1555864445, "creation_date": 1555772676, "last_edit_date": 1555785169, "question_id": 55774780, "link": "https://stackoverflow.com/questions/55774780/why-does-ghci-understand-imports-that-ghc-doesnt", "title": "Why does GHCi understand imports that GHC doesn&#39;t?", "body": "<p>I'm pretty new to Haskell, and I think I have a fundamental misunderstanding somewhere. When I'm in GHCi (using the <code>ghci</code> command), I can type <code>import System.Random</code>, and it works. I can then generate random numbers.</p>\n\n<p>Next, I make a file called <code>test.hs</code> that contains nothing but one line: <code>import System.Random</code>. I then call the command <code>ghc test.hs</code> and get the following error message:</p>\n\n<pre><code>test.hs:1:1: error:\n    Could not find module \u2018System.Random\u2019\n    There are files missing in the \u2018random-1.1\u2019 package,\n    try running 'ghc-pkg check'.\n    Use -v to see a list of the files searched for.\n  |\n1 | import System.Random\n  | ^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>However, if I go back to GHCi, I can type <code>:load test.hs</code>. This works, and allows me to generate random numbers.</p>\n\n<p>When I run <code>ghc-pkg check</code>, I get only warnings about missing haddock interface files: <a href=\"https://pastebin.com/6a9f0nYZ\" rel=\"nofollow noreferrer\">https://pastebin.com/6a9f0nYZ</a>. From what I understand, this isn't related to the current issue.</p>\n\n<p>Also, when I run <code>ghc-pkg list</code>, <code>random-1.1</code> is in the list, so <code>random</code> should be installed.</p>\n\n<p>A couple of questions:</p>\n\n<ul>\n<li>Why would GHC and GHCi have access to different imports? Why is the system set up that way? Maybe I just don't understand the relationship between GHC and GHCi.</li>\n<li>According to the error message, there are \"files missing.\" How can I figure out which files?</li>\n<li>How can I make it so that I can compile Haskell files that use <code>System.Random</code>?</li>\n</ul>\n\n<hr>\n\n<p>Edit: Both GHC and GHCi are the same version.</p>\n\n<pre><code>$ ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 8.6.4\n$ ghci --version\nThe Glorious Glasgow Haskell Compilation System, version 8.6.4\n</code></pre>\n\n<hr>\n\n<p>Edit: Both <code>ghc</code> and <code>ghci</code> are in <strong>/usr/bin/</strong></p>\n\n<pre><code>$ which ghc\n/usr/bin/ghc\n$ which ghci\n/usr/bin/ghci\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1555770531, "post_id": 55774286, "comment_id": 98221369, "body": "I actually think this is quite elegant\u2014the only issue is readability. Maybe putting the commas at the start of the line would help?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1555770707, "post_id": 55774286, "comment_id": 98221414, "body": "You may also want to look at <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Maybe.html#v:mapMaybe\" rel=\"nofollow noreferrer\"><code>mapMaybe</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 3, "last_activity_date": 1555771029, "creation_date": 1555771029, "answer_id": 55774499, "question_id": 55774286, "link": "https://stackoverflow.com/questions/55774286/how-to-elegantly-create-a-list-of-optional-values/55774499#55774499", "title": "How to elegantly create a list of optional values?", "body": "<p>As @AJFarmar notes, just cleaning it up would help:</p>\n\n<pre><code>annotate :: AST -&gt; [MetaInfo]\nannotate (ArgDecl name nameReq maybeVal)\n  = concat\n    [ [m [Name] name]\n    , if nameReq\n        then [m [Operator] \"!\"]\n        else []\n    , case maybeVal of\n        Just v -&gt; [annotate1 v]\n        Nothing -&gt; []\n    ]\n</code></pre>\n\n<p>It may also make it clearer to switch from singleton/empty-set to Just/Nothing with the help of <code>catMaybes</code> from <code>Data.Maybe</code>:</p>\n\n<pre><code>annotate' :: AST -&gt; [MetaInfo]\nannotate' (ArgDecl name nameReq maybeVal)\n  = catMaybes\n    [ Just (m [Name] name)\n    , if nameReq\n        then Just (m [Operator] \"!\")\n        else Nothing\n    , annotate1 &lt;$&gt; maybeVal\n    ]\n</code></pre>\n\n<p>Finally, you could consider creating some helper functions and using <code>&lt;&gt;</code> if you prefer this syntax:</p>\n\n<pre><code>annotate'' :: AST -&gt; [MetaInfo]\nannotate'' (ArgDecl name nameReq maybeVal)\n  =    always (m [Name] name)\n    &lt;&gt; whenever nameReq (m [Operator] \"!\")\n    &lt;&gt; sometimes (annotate1 &lt;$&gt; maybeVal)\n</code></pre>\n\n<p>with helpers:</p>\n\n<pre><code>always :: a -&gt; [a]\nalways = (:[])\nsometimes :: Maybe a -&gt; [a]\nsometimes = maybeToList\nwhenever :: Bool -&gt; a -&gt; [a]\nwhenever b a = if b then [a] else []\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 3, "last_activity_date": 1555771235, "creation_date": 1555771235, "answer_id": 55774537, "question_id": 55774286, "link": "https://stackoverflow.com/questions/55774286/how-to-elegantly-create-a-list-of-optional-values/55774537#55774537", "title": "How to elegantly create a list of optional values?", "body": "<p>When I end up with gangly code like that, I usually clean it up by naming the pieces:</p>\n\n<pre><code>annotate :: AST -&gt; [MetaInfo]\nannotate (ArgDecl name nameReq maybeVal) \n    = concat [name, bang, annotation]\n    where\n        name = [m [Name] name]\n\n        bang | nameReq = [m [Operator] \"!\"]]\n             | otherwise = []\n\n        annotation = case maybeVal of\n          Just v  -&gt; [annotate v]\n          Nothing -&gt; []\n</code></pre>\n\n<p>Considering that you have a <code>Maybe</code> in there, I might also go for <code>catMaybes</code> to simplify the <code>annotation</code> definition:</p>\n\n<pre><code>annotate :: AST -&gt; [MetaInfo]\nannotate (ArgDecl name nameReq maybeVal) \n    = catMaybes [name, bang, annotation]\n    where\n        name = Just $ m [Name] name\n\n        bang | nameReq = Just $ m [Operator] \"!\"\n             | otherwise = Nothing\n\n        annotation = annotate &lt;$&gt; maybeVal\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1555773613, "creation_date": 1555773613, "answer_id": 55774896, "question_id": 55774286, "link": "https://stackoverflow.com/questions/55774286/how-to-elegantly-create-a-list-of-optional-values/55774896#55774896", "title": "How to elegantly create a list of optional values?", "body": "<p>I would tend to generalize the list to any <code>Alternative</code>, and exploit the related functions. I find <code>guard condition *&gt; ...</code> to be pretty nice in this scenario.</p>\n\n<pre><code>annotate :: Alternative f =&gt; AST -&gt; f MetaInfo\nannotate (ArgDecl name nameReq maybeVal) =\n   pure (m [Name] name)\n   &lt;|&gt;\n   guard nameReq *&gt; pure (m [Operator] \"!\")\n   &lt;|&gt;\n   maybe empty (pure . annotate) maybeVal\n</code></pre>\n\n<p>Alternatively, even with plain lists, using list comprehensions looks nice.</p>\n\n<pre><code>annotate :: AST -&gt; [MetaInfo]\nannotate (ArgDecl name nameReq maybeVal) =\n   [m [Name] name]\n   ++\n   [ m [Operator] \"!\" | nameReq ]\n   ++\n   [ annotate v | Just v &lt;- maybeVal ]\n</code></pre>\n"}], "owner": {"reputation": 2090, "user_id": 1499066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35bb8eaa9c809c52774aef01d19afa3?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1499066/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1555773613, "creation_date": 1555769166, "question_id": 55774286, "link": "https://stackoverflow.com/questions/55774286/how-to-elegantly-create-a-list-of-optional-values", "title": "How to elegantly create a list of optional values?", "body": "<p>Consider the following function</p>\n\n<pre><code>annotate :: AST -&gt; [MetaInfo]\nannotate (ArgDecl name nameReq maybeVal) \n    = concat [\n      [m [Name] name],\n      if nameReq\n        then [m [Operator] \"!\"]]\n        else [],\n      case maybeVal of\n                      Just v  -&gt; [annotate v]\n                      Nothing -&gt; []\n    ]\n...\n</code></pre>\n\n<p>This seems little elegant. Is there a better way of creating lists of values that might or might not be in it than using <code>concat</code> in conjunction with empty lists?</p>\n"}, {"tags": ["haskell", "maybe"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 5, "creation_date": 1555767969, "post_id": 55774103, "comment_id": 98220697, "body": "That&#39;s simply <code>fmap</code>, using the standard <code>Functor</code> instance for <code>Maybe</code>. (See  <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#the-functor-typeclass\" rel=\"nofollow noreferrer\">learnyouahaskell.com/&hellip;</a> for a good introduction, including the <code>Maybe</code> instance.) So yes, it&#39;s an integral part of the standard library."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1555771431, "post_id": 55774103, "comment_id": 98221605, "body": "It&#39;s unfortunate @RobinZigmond&#39;s comment is being upvoted, because it&#39;s a terrible comment.  On the other hand it&#39;s a good <b>ANSWER</b>, so maybe it should have been entered down below, where <b>ANSWERS</b> go.  Seriously, comments are for seeking clarification.  Answering questions in the comments leaves a bunch of half-open questions around that diminish the value of the site.  If you don&#39;t think a question warrants a real answer, then <b>don&#39;t answer it.</b>  Let someone else do it.  If you have an answer, treat it as a real answer and put it where answers belong."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1555772529, "post_id": 55774103, "comment_id": 98221928, "body": "Sorry @K.A.Buhr, I tend to comment rather than answer if it&#39;s something I can say quickly, particularly when I&#39;m pushed for time (was watching over the kids at a party, while browsing SO on my mobile). I view quick simple things like this as more worthy of comments than full answers, which would give me reputation that I consider not really deserved (as almost anyone else reading this would be capable of giving the same answer)."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1555772988, "post_id": 55774103, "comment_id": 98222037, "body": "But I&#39;m still relatively new to contributing on SO, if there&#39;s some rule that says things like this have to be an answer, I&#39;ll try to do that in future."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1555773448, "post_id": 55774103, "comment_id": 98222165, "body": "@RobinZigmond, note the instructions that appear in a comment box when you start writing a comment:  &quot;Use comments to ask for more information or suggest improvements.  Avoid answering questions in comments.&quot;  It&#39;s also been discussed in Meta (<a href=\"https://meta.stackoverflow.com/questions/253045/answerers-who-only-use-comments\" title=\"answerers who only use comments\">meta.stackoverflow.com/questions/253045/&hellip;</a>).  If you feel bad getting &quot;undeserved rep&quot;, then leave the question for a low-rep user to answer!"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1555773529, "post_id": 55774103, "comment_id": 98222195, "body": "...like @DanielWagner.  He&#39;s been trying to find a question simple enough for him to answer for years! ;)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 1, "creation_date": 1555783298, "post_id": 55774103, "comment_id": 98224895, "body": "@K.A.Buhr ...and I think I may have finally found one! =D That said, I&#39;m as guilty as any of occasionally answering in the comments. It&#39;s incredibly tempting, especially when the answer is one word long."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1555771399, "creation_date": 1555771399, "answer_id": 55774567, "question_id": 55774103, "link": "https://stackoverflow.com/questions/55774103/is-there-a-b-maybe-a-maybe-b-converter-in-standard-library/55774567#55774567", "title": "Is there (a -&gt; b) -&gt; ((Maybe a) -&gt; (Maybe b)) converter in standard library?", "body": "<p>Yes, this is <code>fmap</code>. You can discover this kind of thing for yourself in the future by dumping the type of your function <a href=\"https://hoogle.haskell.org/?hoogle=%28a+-&gt;+b%29+-&gt;+Maybe+a+-&gt;+Maybe+b\" rel=\"noreferrer\">into Hoogle</a>, which gives <code>fmap</code> as its first result for your proposed type.</p>\n"}], "owner": {"reputation": 9968, "user_id": 312725, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/9GV9q.jpg?s=128&g=1", "display_name": "Max Yankov", "link": "https://stackoverflow.com/users/312725/max-yankov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 55774567, "answer_count": 1, "score": 1, "last_activity_date": 1555771399, "creation_date": 1555767744, "question_id": 55774103, "link": "https://stackoverflow.com/questions/55774103/is-there-a-b-maybe-a-maybe-b-converter-in-standard-library", "title": "Is there (a -&gt; b) -&gt; ((Maybe a) -&gt; (Maybe b)) converter in standard library?", "body": "<p>I'm just learning Haskell and I found myself writing this piece of code for homework assignment:</p>\n\n<pre><code>eval :: ExprT -&gt; Integer\neval (Lit x)    = x\neval (Add x y)  = (eval x) + (eval y)\neval (Mul x y)  = (eval x) * (eval y)\n\nevalMayBe :: Maybe ExprT -&gt; Maybe Integer\nevalMayBe Nothing   = Nothing\nevalMayBe (Just x)  = Just (eval x)\n</code></pre>\n\n<p>The second function seemed a bit redundant, so I wrote a converter:</p>\n\n<pre><code>toMayBe :: (a -&gt; b) -&gt; Maybe a -&gt; Maybe b\ntoMayBe _ Nothing   = Nothing\ntoMayBe f (Just x)  = Just (f x)\n</code></pre>\n\n<p>And rewrote the function just as</p>\n\n<pre><code>evalMayBe :: Maybe ExprT -&gt; Maybe Integer\nevalMayBe = toMayBe eval\n</code></pre>\n\n<p>But then I thought that this converter seemed to be so useful for so many different situations that it must be in the standard library somewhere - however, I wasn't able to find it.</p>\n\n<p>Is it in the standard library? And what is the \"right\" way to write code like this, where you must chain a function on values in a chain where these values might be a Maybe?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1555765860, "post_id": 55773779, "comment_id": 98220196, "body": "Use recursion: pattern match on the list, and check if the first element ends in a vowel."}], "answers": [{"comments": [{"owner": {"reputation": 2090, "user_id": 1499066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35bb8eaa9c809c52774aef01d19afa3?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1499066/john-smith"}, "edited": false, "score": 0, "creation_date": 1555768695, "post_id": 55773933, "comment_id": 98220859, "body": "I like the monadic version, but my guess is it&#39;s a bit slower than the recursive one too... well you simply have to guard against the empty string using a case statement maybe?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 2090, "user_id": 1499066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35bb8eaa9c809c52774aef01d19afa3?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1499066/john-smith"}, "edited": false, "score": 1, "creation_date": 1555769503, "post_id": 55773933, "comment_id": 98221069, "body": "@JohnSmith I would be surprised if the monadic version was too much lower. Also yes, you can guard against that case using <code>case</code>. I might be inclined to write a seperate function at that point, however."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1555787178, "post_id": 55773933, "comment_id": 98225874, "body": "I&#39;d rather see this written with <code>foldr</code>, and for it to move the common <code>x :</code> outside of the <code>if</code>, like this: <code>foldr (\\x acc -&gt; x:if last x `elem` &quot;aeiou&quot; then &quot;\\n&quot;:acc else acc) []</code>"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 3, "last_activity_date": 1555766498, "creation_date": 1555766498, "answer_id": 55773933, "question_id": 55773779, "link": "https://stackoverflow.com/questions/55773779/how-to-conditionally-insert-elements-into-list/55773933#55773933", "title": "How to conditionally insert elements into list?", "body": "<p>One way of doing this would be using <code>do</code>-notation. <code>do</code>-notation on the list monad is a lot like list comprehension, but it also allows you to 'return' multiple elements. Here's my implementation:</p>\n\n<pre><code>solution1 :: [String] -&gt; [String]\nsolution1 strings = do\n    str &lt;- strings   -- Go through each element of the list\n    if last str `elem` \"aeiou\"\n        then [str, \"\\n\"]   -- 'Replace' that element with the element then a newline\n        else [str]         -- Do nothing.\n</code></pre>\n\n<p>But this is a bit of a weird way of going about things, especially if you're a beginner. The usual way would be recursion, so let's do that instead:</p>\n\n<pre><code>solution2 :: [String] -&gt; [String]\nsolution2 []     = [] -- Base case: empty list.\nsolution2 (x:xs) =    -- Inductive case: non-empty list.\n    if last x `elem` \"aeiou\"\n        then x : \"\\n\" : solution2 xs -- Recur, reconstructing as we go.\n        else x : solution2 xs        -- Recur, this time with no extra newline.\n</code></pre>\n\n<p>In reality though, these do basically the same thing\u2014<code>do</code>-notation on lists is basically just an abstraction of the second method.</p>\n\n<p><strong>Something to consider:</strong> I used the <code>last</code> function, but this will fail on empty strings. How could you fix that?</p>\n"}], "owner": {"reputation": 2090, "user_id": 1499066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35bb8eaa9c809c52774aef01d19afa3?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1499066/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 55773933, "answer_count": 1, "score": -1, "last_activity_date": 1555766498, "creation_date": 1555765485, "question_id": 55773779, "link": "https://stackoverflow.com/questions/55773779/how-to-conditionally-insert-elements-into-list", "title": "How to conditionally insert elements into list?", "body": "<p>Say I have a list of Strings</p>\n\n<pre><code>[\"hello\", \"xbox\", \"blue\"]\n</code></pre>\n\n<p>And now I want to \"insert\" (as in create a new immutable list) linefeed characters into the list, but only if the word before ends on a vowel, e.g. a function that creates the following list:</p>\n\n<pre><code>[\"hello\", \"\\n\", \"xbox\", \"blue\", \"\\n\"]\n</code></pre>\n\n<p>What's the most elegant/direct way of doing this in haskell?</p>\n"}, {"tags": ["haskell", "types", "constructor", "return-type"], "answers": [{"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 3, "last_activity_date": 1556183114, "last_edit_date": 1556183114, "creation_date": 1555761899, "answer_id": 55773341, "question_id": 55773290, "link": "https://stackoverflow.com/questions/55773290/haskell-type-signatur-for-returning-type-constructor/55773341#55773341", "title": "haskell type signatur for returning type constructor", "body": "<p>I simply entered your code into GHCi and asked it to tell me the type:</p>\n\n<pre><code>Prelude&gt; :{\nPrelude|     data Letter a =\nPrelude|           A a\nPrelude|         | B a\nPrelude|         | C String\nPrelude|         deriving (Show)\nPrelude| :}\nPrelude&gt; :{\nPrelude|     getConstructor x\nPrelude|         | x == \"a\"  = A\nPrelude|         | x == \"b\"  = B\nPrelude|         | otherwise = C\nPrelude| :}\nPrelude&gt; :t getConstructor\ngetConstructor :: [Char] -&gt; String -&gt; Letter String\n</code></pre>\n\n<p>This makes sense, because it takes a <code>[Char]</code> (aka a <code>String</code> - that's the <code>x</code> argument) and returns one of <code>A</code>, <code>B</code> and <code>C</code>, which are the constructors for <code>Letter</code>. Being constructors they are also functions - in the case of <code>C</code> the type is clearly <code>String -&gt; Letter a</code>, while <code>A</code> and <code>B</code> have type <code>a -&gt; Letter a</code>. Since these are all possible return values of <code>getConstructor</code>, they must be the same type - the only way for that to happen is if <code>a</code> is always <code>String</code>. This gives us the type of <code>getConstructor</code> as <code>String -&gt; (String -&gt; Letter String)</code>, which is exactly what GHCi says above (with some minor rewriting).</p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 4, "last_activity_date": 1555761909, "creation_date": 1555761909, "answer_id": 55773344, "question_id": 55773290, "link": "https://stackoverflow.com/questions/55773290/haskell-type-signatur-for-returning-type-constructor/55773344#55773344", "title": "haskell type signatur for returning type constructor", "body": "<p>Let's take a look:</p>\n\n<pre><code>getConstructor x\n    | x == \"a\"  = A\n    | x == \"b\"  = B\n    | otherwise = C -- &lt;= Let's inspect this line\n</code></pre>\n\n<p>That line returns <code>C :: String -&gt; Letter a</code>. The previous line returns <code>B :: a -&gt; Letter a</code>. These types must be equal, so <code>a ~ String</code>. Hence, the function becomes:</p>\n\n<pre><code>getConstructor :: String -&gt; (String -&gt; Letter String)\n</code></pre>\n\n<p>There is no way to dynamically choose the type at runtime with a function like this, since in Haskell, all types are known at compile-time. Hence, it's restricted to working on <code>String</code>s only.</p>\n"}], "owner": {"reputation": 774, "user_id": 6034245, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n3qwA.jpg?s=128&g=1", "display_name": "chrisheyn", "link": "https://stackoverflow.com/users/6034245/chrisheyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 55773344, "answer_count": 2, "score": 0, "last_activity_date": 1556183114, "creation_date": 1555761494, "question_id": 55773290, "link": "https://stackoverflow.com/questions/55773290/haskell-type-signatur-for-returning-type-constructor", "title": "haskell type signatur for returning type constructor", "body": "<p>Is it possible to give a type signature for this <code>getConstructor</code> function?\nThe function works but i can't find out the way to write the return type.</p>\n\n<pre><code>module Main where\n\n    data Letter a =\n          A a\n        | B a\n        | C String\n        deriving (Show)\n\n    -- getConstructor :: String -&gt; (a -&gt; Letter ?) -- &lt;== \n    getConstructor x\n        | x == \"a\"  = A\n        | x == \"b\"  = B\n        | otherwise = C\n\n\n    main = print $ theType\n        where theType = (getConstructor \"b\") \"its b!\"\n</code></pre>\n\n<p>Main prints <code>B \"its b!\"</code></p>\n"}, {"tags": ["haskell", "bounded-types"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 5, "creation_date": 1555752786, "post_id": 55772069, "comment_id": 98217143, "body": "<code>deriving Bounded</code> doesn&#39;t mean that <code>Product a</code> automatially becomes <code>Bounded</code> for all <code>a</code>, it just means it does <i>if <code>a</code> is</i>"}, {"owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1555752821, "post_id": 55772069, "comment_id": 98217154, "body": "@RobinZigmond Ah. Didn&#39;t know this. Thank you."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1555752969, "post_id": 55772069, "comment_id": 98217194, "body": "There&#39;s nothing special about <code>Bounded</code> here fwiw. You&#39;re deriving <code>Eq</code> as well, but nothing stops you making a type <code>Product (Int -&gt; String)</code> for example, which it makes no sense to compare for equality (since you can&#39;t do that with functions). Again, the derived instance only exists if the base type <code>a</code> is already an instance. Deriving instances does no &quot;magic&quot;, it&#39;s just an automated way to &quot;do the obvious thing&quot; and save you some boilerplate."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 7, "last_activity_date": 1555753368, "creation_date": 1555753368, "answer_id": 55772228, "question_id": 55772069, "link": "https://stackoverflow.com/questions/55772069/why-is-product-bounded/55772228#55772228", "title": "Why is Product Bounded?", "body": "<p><code>Product</code> is not an instance of <code>Bounded</code> (that would be a kind error, anyway). You're missing what <code>deriving</code> actually does.</p>\n\n<p>There is <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch11.html#x18-18200011\" rel=\"noreferrer\">a formal specification of derived instances</a> in the Haskell report:</p>\n\n<blockquote>\n  <p>If <em>T</em> is an algebraic datatype declared by:</p>\n  \n  <p><code><pre>data <em>cx</em> => <em>T</em> <em>u<sub>1</sub></em> \u2026 <em>u<sub>k</sub></em> = <em>K<sub>1</sub></em> <em>t<sub>11</sub></em> \u2026 <em>t<sub>1k<sub>1</sub></sub></em> | \u22c5\u22c5\u22c5 | <em>K<sub>n</sub></em> <em>t<sub>n1</sub></em> \u2026 <em>t<sub>nk<sub>n</sub></sub></em>\n                     deriving (<em>C<sub>1</sub></em>, \u2026, <em>C<sub>m</sub></em>)</pre></code></p>\n  \n  <p>(where <em>m \u2265 0</em> and the parentheses may be omitted if <em>m = 1</em>) then a derived instance declaration is possible for a class <em>C</em> if these conditions hold:</p>\n  \n  <ol>\n  <li><em>C</em> is one of <code>Eq</code>, <code>Ord</code>, <code>Enum</code>, <code>Bounded</code>, <code>Show</code>, or <code>Read</code>.</li>\n  <li>There is a context <em>cx\u2032</em> such that <em>cx\u2032  \u21d2  C t<sub>ij</sub></em> holds for each of the constituent types <em>t<sub>ij</sub></em>.</li>\n  </ol>\n  \n  <p>[...]</p>\n  \n  <p>Each derived instance declaration will have the form: <code>instance (<em>cx</em>, <em>cx\u2032</em>) => <em>C<sub>i</sub></em> (<em>T</em> <em>u<sub>1</sub></em> \u2026 <em>u<sub>k</sub></em>) where { <em>d</em> }</code> [...]</p>\n</blockquote>\n\n<p>This means class constraints are automatically distributed to type parameters.</p>\n\n<p>As explained in <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch11.html#x18-18500011.3\" rel=\"noreferrer\">the section on <code>Bounded</code></a>:</p>\n\n<blockquote>\n  <p>The <code>Bounded</code> class introduces the class methods <code>minBound</code> and <code>maxBound</code>, which define the minimal and maximal elements of the type. For an enumeration, the first and last constructors listed in the <code>data</code> declaration are the bounds. For a type with a single constructor, the constructor is applied to the bounds for the constituent types. For example, the following datatype:</p>\n\n<pre><code>data  Pair a b = Pair a b deriving Bounded\n</code></pre>\n  \n  <p>would generate the following <code>Bounded</code> instance:</p>\n\n<pre><code>instance (Bounded a,Bounded b) =&gt; Bounded (Pair a b) where  \n  minBound = Pair minBound minBound  \n  maxBound = Pair maxBound maxBound\n</code></pre>\n</blockquote>\n\n<p>For <code>Product</code>, this means <code>Product a</code> is only an instance of <code>Bounded</code> if <code>a</code> is.</p>\n"}], "owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1555753368, "creation_date": 1555752042, "question_id": 55772069, "link": "https://stackoverflow.com/questions/55772069/why-is-product-bounded", "title": "Why is Product Bounded?", "body": "<p><a href=\"http://learnyouahaskell.com/functors-applicative-functors-and-monoids\" rel=\"nofollow noreferrer\">http://learnyouahaskell.com/functors-applicative-functors-and-monoids</a> :</p>\n\n<blockquote>\n  <p><code>Product</code> is defined like this:</p>\n\n<pre><code>newtype Product a =  Product { getProduct :: a }  \n    deriving (Eq, Ord, Read, Show, Bounded)\n</code></pre>\n</blockquote>\n\n<p>Why is <code>Product</code> forced to be <code>Bounded</code>?</p>\n\n<p>From the same book, a few paragraphs below:</p>\n\n<blockquote>\n  <p>Its instance for <code>Monoid</code> goes a little something like this:</p>\n\n<pre><code>instance Num a =&gt; Monoid (Product a) where  \n    mempty = Product 1  \n    Product x `mappend` Product y = Product (x * y)\n</code></pre>\n</blockquote>\n\n<p>Eh? The only constraint is <code>Num a</code>! But <code>Num</code> in particular means <code>Integer</code>, and this is not bounded (unlike <code>Int</code>), AFAIK.</p>\n\n<p>Let's test it then:</p>\n\n<pre><code>import Data.Monoid\n\nnumbers :: [Integer]\nnumbers = [1..100]\n\nmain = print (getProduct . mconcat . map Product $ numbers)\n</code></pre>\n\n<p>Let's see this code in action:</p>\n\n<pre><code>m@m-X555LJ:~$ runhaskell wtf.hs\n93326215443944152681699238856266700490715968264381621468592963895217599993229915608941463976156518286253697920827223758251185210916864000000000000000000000000\nm@m-X555LJ:~$ \n</code></pre>\n\n<p>Works. Doesn't fail.</p>\n\n<p>So what's the bound of <code>Product</code>? Is there any bound of <code>Product</code>? </p>\n\n<p>Let's play again:</p>\n\n<pre><code>m@m-X555LJ:~$ ghci\nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; minBound :: Int\n-9223372036854775808\nPrelude&gt; maxBound :: Int\n9223372036854775807\nPrelude&gt; import Data.Monoid\nPrelude Data.Monoid&gt; maxBound :: (Product Integer)\n\n&lt;interactive&gt;:4:1: error:\n    \u2022 No instance for (Bounded Integer)\n        arising from a use of \u2018maxBound\u2019\n    \u2022 In the expression: maxBound :: Product Integer\n      In an equation for \u2018it\u2019: it = maxBound :: Product Integer\nPrelude Data.Monoid&gt; maxBound :: Product\n\n&lt;interactive&gt;:5:13: error:\n    \u2022 Expecting one more argument to \u2018Product\u2019\n      Expected a type, but \u2018Product\u2019 has kind \u2018* -&gt; *\u2019\n    \u2022 In an expression type signature: Product\n      In the expression: maxBound :: Product\n      In an equation for \u2018it\u2019: it = maxBound :: Product\nPrelude Data.Monoid&gt; maxBound :: (Product Int)\nProduct {getProduct = 9223372036854775807}\nPrelude Data.Monoid&gt; \nLeaving GHCi.\nm@m-X555LJ:~$ \n</code></pre>\n\n<p>It doesn't seem that <code>Product</code> is, by itself, <code>Bounded</code>. <code>Int</code> is; but <code>maxBound :: (Product Integer)</code> throws! IIUC <code>Product deriving Bounded</code> is a promise that <code>maxBound</code> is well-defined on <code>Product</code>. Apparently, not always.</p>\n\n<p>So why is <code>Product</code> an instance of <code>Bounded</code>?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 507, "user_id": 515276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eec8691200732875d9d0a619ea1be7ca?s=128&d=identicon&r=PG", "display_name": "Labbekak", "link": "https://stackoverflow.com/users/515276/labbekak"}, "edited": false, "score": 0, "creation_date": 1555766472, "post_id": 55772685, "comment_id": 98220341, "body": "Thanks, great answer! I was hoping there would be a more efficient way to do addition, but I guess primitive recursion is the problem here? Would structural recursion allow for a more efficient algorithm? What about general recursion?"}, {"owner": {"reputation": 507, "user_id": 515276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eec8691200732875d9d0a619ea1be7ca?s=128&d=identicon&r=PG", "display_name": "Labbekak", "link": "https://stackoverflow.com/users/515276/labbekak"}, "edited": false, "score": 0, "creation_date": 1556103963, "post_id": 55772685, "comment_id": 98321717, "body": "To answer my own comment, using structural/general recursion you can do much better."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 3, "last_activity_date": 1555759886, "last_edit_date": 1555759886, "creation_date": 1555756876, "answer_id": 55772685, "question_id": 55772053, "link": "https://stackoverflow.com/questions/55772053/addition-for-binary-natural-numbers-using-primitive-recursion/55772685#55772685", "title": "Addition for binary natural numbers using primitive recursion", "body": "<p>Idea: To compute <code>a + b</code>, we need to increment <code>b</code> <code>a</code> times. So:</p>\n\n<pre><code>0 + b = b\n1 + b = succ b\n2 + b = succ (succ b)\n3 + b = succ (succ (succ b))\n...\n</code></pre>\n\n<p>We might start out by writing</p>\n\n<pre><code>plus a b = foldBNat a b (\\m r -&gt; ...\n</code></pre>\n\n<p>But here we get stuck: <code>m</code> represents half of <code>a</code> (since <code>a = T m</code> here, i.e. <code>a = 2 * m</code>) and <code>r</code> is the result of incrementing <code>b</code> <code>m</code> times (i.e. <code>m + b</code>). There's nothing useful we can do with that. What we want is <code>a + b = 2*m + b</code>, which we can't directly obtain from <code>m + b</code>. Applying <code>T</code> would only give us <code>2 * (m + b) = 2*m + 2*b</code>, which is too big, and according to the rules we can't directly recurse on <code>plus</code> to compute <code>m + (m + b) = 2*m + b</code>.</p>\n\n<p>What we need is a more direct way of manipulating the number of <code>succ</code> operations.</p>\n\n<p>Idea: Don't compute a number directly; instead compute a function (that increments its argument a certain number of times). So:</p>\n\n<pre><code>incBy 0 = id\nincBy 1 = succ\nincBy 2 = succ . succ\nincBy 3 = succ . succ . succ\n...\n</code></pre>\n\n<p>We can implement that directly:</p>\n\n<pre><code>incBy :: BNat -&gt; (BNat -&gt; BNat)\nincBy n = foldBNat n id (\\_ r -&gt; r . r) (\\_ r -&gt; succ . r . r)\n</code></pre>\n\n<p>Here <code>r . r</code> gives us a function that increments a number twice as often as <code>r</code> does (by applying <code>r</code> twice).</p>\n\n<p>Now we can simply define addition as:</p>\n\n<pre><code>plus :: BNat -&gt; BNat -&gt; BNat\nplus n m = (incBy n) m\n</code></pre>\n\n<p>(which happens to be redundant because <code>plus = incBy</code>).</p>\n"}], "owner": {"reputation": 507, "user_id": 515276, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/eec8691200732875d9d0a619ea1be7ca?s=128&d=identicon&r=PG", "display_name": "Labbekak", "link": "https://stackoverflow.com/users/515276/labbekak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 55772685, "answer_count": 1, "score": 3, "last_activity_date": 1555759886, "creation_date": 1555751911, "question_id": 55772053, "link": "https://stackoverflow.com/questions/55772053/addition-for-binary-natural-numbers-using-primitive-recursion", "title": "Addition for binary natural numbers using primitive recursion", "body": "<p>Given binary natural numbers, with a zero case a \"twice\" case and a \"twice plus one\" case. How can one express addition using primitive recursion (using only the function <code>foldBNat</code>)?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- zero | n * 2 | n * 2 + 1\ndata BNat = Z | T BNat | TI BNat\n  deriving (Show)\n\nfoldBNat :: BNat -&gt; t -&gt; (BNat -&gt; t -&gt; t) -&gt; (BNat -&gt; t -&gt; t) -&gt; t\nfoldBNat n z t ti =\n  case n of\n    Z -&gt; z\n    T m -&gt; t m (foldBNat m z t ti)\n    TI m -&gt; ti m (foldBNat m z t ti)\n\ndiv2 :: BNat -&gt; BNat\ndiv2 n = foldBNat n Z (\\m _ -&gt; m) (\\m _ -&gt; m)\n\npred :: BNat -&gt; BNat\npred n = foldBNat n Z (\\_ r -&gt; TI r) (\\m _ -&gt; T m)\n\nsucc :: BNat -&gt; BNat\nsucc n = foldBNat n (TI Z) (\\m _ -&gt; TI m) (\\_ r -&gt; T r)\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "sequence", "lazy-evaluation"], "answers": [{"comments": [{"owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "edited": false, "score": 0, "creation_date": 1555752345, "post_id": 55772068, "comment_id": 98217058, "body": "OK... asked all 3 questions, reading the asnwers now :) Yes, you said in your previous answer that <code>getLine</code> is not lazy. I get it. But I have feeling what I&#39;m asking in this Q is not precisely what I was asking in the first Q. The problem here is that: given how <code>sequence</code> is defined (recursion on a list of <code>getLines</code>), why is the <i>list</i> not evaluated lazily? (Not: why is any particular <code>getLine</code> not evaluated lazily?) Ie - why is the second <code>getLine</code> evaluated immediately after the first <code>getLine</code>, and not only when needed? See my example with recursion producing an infinite list."}, {"owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "edited": false, "score": 0, "creation_date": 1555752663, "post_id": 55772068, "comment_id": 98217120, "body": "Seen your edit. Can&#39;t address it in the comment; too long. I&#39;ll edit my Q to adress your edit, if I might."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "edited": false, "score": 0, "creation_date": 1555753049, "post_id": 55772068, "comment_id": 98217210, "body": "@gaazkam <code>a &gt;&gt; b</code> for <code>IO</code> results in an IO action that first executes first <code>a</code> then <code>b</code> by definition. <code>sequence as</code> produces an IO action that looks like this <code>as !! 0 &gt;&gt; as !! 1 &gt;&gt; ... &gt;&gt; as !! (length as - 1)</code> (it also puts the result in a list, I omitted that part here because it&#39;s not important). It doesn&#39;t matter if <code>as</code> or <code>sequence</code> is lazy or not, the resultant value is still the same, just the same as <code>sum [1,2,3]</code> is always <code>6</code> regardless of how lazy <code>[1, 2, 3]</code> is evaluated."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "edited": false, "score": 0, "creation_date": 1555753849, "post_id": 55772068, "comment_id": 98217385, "body": "@gaazkam I&#39;m not 100% sure which part confuses you, I&#39;ve addressed your edit as best I could."}], "tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": false, "score": 6, "last_activity_date": 1555753765, "last_edit_date": 1555753765, "creation_date": 1555752034, "answer_id": 55772068, "question_id": 55771942, "link": "https://stackoverflow.com/questions/55771942/why-is-sequence-getline-getline-getline-not-evaluated-lazily/55772068#55772068", "title": "Why is sequence [getLine, getLine, getLine] not evaluated lazily?", "body": "<p><code>getContents</code> is lazy, <code>getLine</code> isn't. Lazy IO isn't a feature of Haskell per se, it's a feature of some particular IO actions.</p>\n\n<blockquote>\n  <p>I'm confused. I don't need to perform ALL IO actions to get the results of just one.</p>\n</blockquote>\n\n<p>Yes you do! That is one of the most important features of <code>IO</code>, that if you write <code>a &gt;&gt; b</code> or equivalently,</p>\n\n<pre><code>do a\n   b\n</code></pre>\n\n<p>then you can be sure that <code>a</code> is definitely \"run\" before <code>b</code> (see footnote). <code>getContents</code> is actually the same, it \"runs\" before whatever comes after it... but the <em>result</em> it returns is a sneaky result that sneakily does <em>more</em> IO when you try to evaluate it. <em>That</em> is actually the surprising bit, and it can lead to some very <em>interesting</em> results in practice (like the file you're reading the contents of being deleted or changed while you're processing the results of <code>getContents</code>), so in practical programs you probably shouldn't be using it, it mostly exists for convenience in programs where you don't care about such things (Code Golf, throwaway scripts or teaching for instance).</p>\n\n<hr>\n\n<p>As to <em>why</em> it is important that IO actions are run in order regardless of the results: Imagine an action <code>createFile :: IO ()</code> and <code>writeToFile :: IO ()</code>. When I do a <code>sequence [createFile, writeToFile]</code> I'd hope that they're <em>both</em> done and in order, even though I don't care about their actual results (which are both the very boring value <code>()</code>) at all!</p>\n\n<hr>\n\n<p>Addressing the edit:</p>\n\n<blockquote>\n  <p>should detoriate to something like this:</p>\n\n<pre><code>do\n    input &lt;- do\n       input &lt;- concat ( map (fmap (:[])) [getLine, getLine, getLine] )\n       return input\n    mapM_ print input\n</code></pre>\n</blockquote>\n\n<p>No, it actually turns into something like this:</p>\n\n<pre><code>do \n  input &lt;- do\n    x &lt;- getLine\n    y &lt;- getLine\n    z &lt;- getLine\n    return [x,y,z]\n  mapM_ print input\n</code></pre>\n\n<p>(the actual definition of <code>sequence</code> is more or less this:</p>\n\n<pre><code>sequence [] = return []\nsequence (a:as) = do\n  x &lt;- a\n  fmap (x:) $ sequence as\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1555753740, "last_edit_date": 1555753740, "creation_date": 1555752875, "answer_id": 55772160, "question_id": 55771942, "link": "https://stackoverflow.com/questions/55771942/why-is-sequence-getline-getline-getline-not-evaluated-lazily/55772160#55772160", "title": "Why is sequence [getLine, getLine, getLine] not evaluated lazily?", "body": "<p>Technically, in</p>\n\n<pre><code>sequenceA (x:xs) = (:) &lt;$&gt; x &lt;*&gt; sequenceA xs\n</code></pre>\n\n<p>we find <code>&lt;*&gt;</code>, which first runs the action on the left, then the action on the right, and finally applies their result together. This is what makes the first effect in the list to be occur first, and so on.</p>\n\n<p>Indeed, on monads, <code>f &lt;*&gt; x</code> is equivalent to</p>\n\n<pre><code>do theF &lt;- f\n   theX &lt;- x\n   return (theF theX)\n</code></pre>\n\n<p>More in general, note that all the IO actions are generally executed in order, first to last (see below for a few rare exceptions). Doing IO in a completely lazy way would be a nightmare for the programmer. For instance, consider:</p>\n\n<pre><code>do let aX = print \"x\" &gt;&gt; return 4\n       aY = print \"y\" &gt;&gt; return 10\n   x &lt;- aX\n   y &lt;- aY\n   print (x+y)\n</code></pre>\n\n<p>Haskell guarantees that the output is <code>x y 14</code>, in that order. If we had completely lazy IO we could also get <code>y x 14</code>, depending on which argument is forced first by <code>+</code>. In such case, we would need to know exactly the order in which the lazy thunks are demanded by every operation, which is something the programmer definitely does not want to care about. Under such detailed semantics, <code>x + y</code> is no longer equivalent to <code>y + x</code>, breaking equational reasoning in many cases.</p>\n\n<p>Now, if we wanted to force IO to be lazy we could use one of the forbidden functions, e.g.</p>\n\n<pre><code>do let aX = unsafeInterleaveIO (print \"x\" &gt;&gt; return 4)\n       aY = unsafeInterleaveIO (print \"y\" &gt;&gt; return 10)\n   x &lt;- aX\n   y &lt;- aY\n   print (x+y)\n</code></pre>\n\n<p>The above code makes <code>aX</code> and <code>aY</code> lazy IO actions, and the order of the output is now at the whim of the compiler and the library implementation of <code>+</code>. This is in general dangerous, hence the <code>unsafe</code>ness of lazy IO.</p>\n\n<p>Now, about the exceptions. Some IO actions which only <em>read</em> from the environment, like <code>getContents</code> were implemented with lazy IO (<code>unsafeInterleaveIO</code>). The designers felt that for such reads, lazy IO can be acceptable, and that the precise timing of the reads is not that important in many cases.</p>\n\n<p>Nowadays, this is <a href=\"https://stackoverflow.com/questions/5892653/whats-so-bad-about-lazy-i-o\">controversial</a>. While it can be convenient, lazy IO can be too unpredictable in many cases. For instance, we can't know where the file will be closed, and that could matter if we're reading from a socket. We also need to be very careful not to force the reads too early: that often leads to a deadlock when reading from a pipe. Today, it is usually preferred to avoid lazy IO, and resort to some library like <code>pipes</code> or <code>conduit</code> for \"streaming\"-like operations, where there is no ambiguity.</p>\n"}], "owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 1, "answer_count": 2, "score": 9, "last_activity_date": 1555753765, "creation_date": 1555750912, "last_edit_date": 1555753177, "question_id": 55771942, "link": "https://stackoverflow.com/questions/55771942/why-is-sequence-getline-getline-getline-not-evaluated-lazily", "title": "Why is sequence [getLine, getLine, getLine] not evaluated lazily?", "body": "<pre><code>main = do\n  input &lt;- sequence [getLine, getLine, getLine]\n  mapM_ print input\n</code></pre>\n\n<p>Let's see this program in action:</p>\n\n<pre><code>m@m-X555LJ:~$ runhaskell wtf.hs\nasdf\njkl\npowe\n\"asdf\"\n\"jkl\"\n\"powe\"\n</code></pre>\n\n<p>Surprisingly to me, there seems to be no laziness here. Instead, all 3 <code>getLine</code>s are evaluated eagerly, the read values are stored in memory and then, not before, all are printed.</p>\n\n<p>Compare to this:</p>\n\n<pre><code>main = do\n  input &lt;- fmap lines getContents\n  mapM_ print input\n</code></pre>\n\n<p>Let's see this in action:</p>\n\n<pre><code>m@m-X555LJ:~$ runhaskell wtf.hs\nasdf\n\"asdf\"\nlkj\n\"lkj\"\npower\n\"power\"\n</code></pre>\n\n<p>Totally different stuff. Lines are read one by one and printed one by one. Which is odd to me because I don't really see any differences between these two programs.</p>\n\n<p>From LearnYouAHaskell:</p>\n\n<blockquote>\n  <p>When used with I/O actions, <code>sequenceA</code> is the same thing as <code>sequence</code>!\n  It takes a list of I/O actions and returns an I/O action that will\n  perform each of those actions and have as its result a list of the\n  results of those I/O actions. That's because to turn an <code>[IO a]</code> value\n  into an <code>IO [a]</code> value, to make an I/O action that yields a list of\n  results when performed, all those I/O actions have to be sequenced so\n  that they're then performed one after the other when evaluation is\n  forced. You can't get the result of an I/O action without performing\n  it.</p>\n</blockquote>\n\n<p>I'm confused. I don't need to perform ALL IO actions to get the results of just one.</p>\n\n<p>A few paragraphs earlier the book shows a definition of <code>sequence</code>:</p>\n\n<blockquote>\n<pre><code>sequenceA :: (Applicative f) =&gt; [f a] -&gt; f [a]  \nsequenceA [] = pure []  \nsequenceA (x:xs) = (:) &lt;$&gt; x &lt;*&gt; sequenceA xs\n</code></pre>\n</blockquote>\n\n<p>Nice recursion; nothing here hints me that this recursion should not be lazy;just like in any other recursion, to get the head of the returned list Haskell doesn't have to go down through ALL steps of recursion!</p>\n\n<p>Compare:</p>\n\n<pre><code>rec :: Int -&gt; [Int]\nrec n = n:(rec (n+1))\n\nmain = print (head (rec 5))\n</code></pre>\n\n<p>In action:</p>\n\n<pre><code>m@m-X555LJ:~$ runhaskell wtf.hs\n5\nm@m-X555LJ:~$\n</code></pre>\n\n<p>Clearly, the recursion here is performed lazily, not eagerly.</p>\n\n<p>Then why is the recursion in the <code>sequence [getLine, getLine, getLine]</code> example performed eagerly?</p>\n\n<hr>\n\n<blockquote>\n  <p>As to <em>why</em> it is important that IO actions are run in order\n  regardless of the results: Imagine an action <code>createFile :: IO ()</code> and\n  <code>writeToFile :: IO ()</code>. When I do a <code>sequence [createFile,\n  writeToFile]</code> I'd hope that they're <em>both</em> done and in order, even\n  though I don't care about their actual results (which are both the\n  very boring value <code>()</code>) at all!</p>\n</blockquote>\n\n<p>I'm not sure how this applies to this Q.</p>\n\n<p>Maybe I'll word my Q this way...</p>\n\n<p>In my mind this:</p>\n\n<pre><code>do\n    input &lt;- sequence [getLine, getLine, getLine]\n    mapM_ print input\n</code></pre>\n\n<p>should detoriate to something like this:</p>\n\n<pre><code>do\n    input &lt;- do\n       input &lt;- concat ( map (fmap (:[])) [getLine, getLine, getLine] )\n       return input\n    mapM_ print input\n</code></pre>\n\n<p>Which, in turn, should detoriate to something like this (pseudocode, sorry):</p>\n\n<pre><code>do\n    [ perform print on the result of getLine,\n      perform print on the result of getLine,\n      perform print on the result of getLine\n    ] and discard the results of those prints since print was applied with mapM_ which discards the results unlike mapM\n</code></pre>\n"}, {"tags": ["haskell", "io", "main"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1555786270, "post_id": 55771922, "comment_id": 98225644, "body": "I think it&#39;s kind of nice that I can write <code>main :: IO a</code> or (equivalently) <code>main :: IO Void</code> to indicate explicitly that <code>main</code> does <i>not</i> terminate by falling off the end but rather performs an explicit exit, dies by exception, or runs indefinitely. It doesn&#39;t really matter in practice, but it feels right."}], "tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": true, "score": 6, "last_activity_date": 1555785974, "last_edit_date": 1555785974, "creation_date": 1555750744, "answer_id": 55771922, "question_id": 55771820, "link": "https://stackoverflow.com/questions/55771820/whats-the-use-of-main-returning-io-something-rather-than-io/55771922#55771922", "title": "What&#39;s the use of main returning IO Something rather than IO()?", "body": "<p>This is actually multiple questions, but in order:</p>\n\n<ol>\n<li>The 'result' of <code>main</code> doesn't have a meaning, that is why it <em>can</em> be <code>()</code> or anything else. It's not used at all.</li>\n<li>The reason types other than <code>IO ()</code> are allowed for main is for convenience; Otherwise you'd always have to do something like <code>main = void $ realMain</code> to discard results (you may well want to have an action that could return a result which you don't care about as the last thing that happens) which is a bit tedious. IMHO silently discarding things is bad and so I'd prefer if <code>main</code> was forced to be <code>:: IO ()</code>, but you can always get that effect by just supplying the type signature yourself so it's not really a problem in practice.</li>\n<li>Side point: If you want to exit with a specific exit code, use <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/System-Exit.html\" rel=\"nofollow noreferrer\"><code>System.Exit</code></a></li>\n<li>The reason <code>fmap read getLine</code> consumes output and <code>getContents</code> doesn't is because <code>getContents</code> is lazy and <code>getLine</code> isn't - i.e. <code>getLine</code> does read a line of text where you'd think it does, whereas <code>getContents</code> only does any actual IO if the result is \"needed\" in the Haskell world; Since the result of <code>IO</code> isn't used for anything that means it doesn't do anything if <code>getContents</code> is your whole <code>main</code>.</li>\n</ol>\n"}], "owner": {"reputation": 6365, "user_id": 4385532, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/0573709d0b88e4b50af0e28c3e96873b?s=128&d=identicon&r=PG&f=1", "display_name": "gaazkam", "link": "https://stackoverflow.com/users/4385532/gaazkam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 55771922, "answer_count": 1, "score": 4, "last_activity_date": 1555785974, "creation_date": 1555749932, "question_id": 55771820, "link": "https://stackoverflow.com/questions/55771820/whats-the-use-of-main-returning-io-something-rather-than-io", "title": "What&#39;s the use of main returning IO Something rather than IO()?", "body": "<p>I'm reading <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">http://learnyouahaskell.com/</a> ... And something surprised me:</p>\n\n<blockquote>\n  <p>Because of that, <code>main</code> always has a type signature of <code>main :: IO something</code>, where <code>something</code> is some concrete type.</p>\n</blockquote>\n\n<p>? So <code>main</code> doesn't have to be of type <code>IO()</code>, but rather can be <code>IO(String)</code> or <code>IO(Int)</code>? But what's the use of this?</p>\n\n<p>I did some playing...</p>\n\n<pre><code>m@m-X555LJ:~$ cat wtf.hs\nmain :: IO Int\nmain = fmap (read :: String -&gt; Int) getLine\nm@m-X555LJ:~$ runhaskell wtf.hs\n1\nm@m-X555LJ:~$ echo $?\n0\nm@m-X555LJ:~$\n</code></pre>\n\n<p>Hmm. So my first hypothesis is disproven. I thought this was a way for a Haskell program to return exit status to the shell, much like a C program starts from <code>int main()</code> and reports the exit status with <code>return 0</code> or <code>return 1</code>.</p>\n\n<p>But nope: the above program consumes the <code>1</code> from input and then does nothing, and in particular doesn't seem to return this <code>1</code> to the shell.</p>\n\n<p>One more test:</p>\n\n<pre><code>m@m-X555LJ:~$ cat wtf.hs\nmain = getContents\nm@m-X555LJ:~$ runhaskell wtf.hs\nm@m-X555LJ:~$ \n</code></pre>\n\n<p>Wow. This time I tried returning <code>IO String</code>. For reasons unknown to me, this time Haskell doesn't <em>even</em> wait for input, as it did when I was returning <code>IO Int</code>. The program seems to simply do nothing.</p>\n\n<p>This hints that the value is really not returned anywhere: apparently, since the results of <code>getContents</code> are nowhere used, the whole instruction was skipped due to laziness. But if this was the case, why was returning <code>IO Int</code> not skipped? Well yes: I did <code>fmap read</code> on the <code>IO</code> action; but same stuff seems to apply, computing the <code>read</code> is only necessary if the result of the action is used, which - as the <code>main = getContents</code> example seems to hint - is not used, so laziness should also skip the <code>read</code> and hence also the <code>getLine</code>, right? Well, wrong - but I'm confused why.</p>\n\n<p>What's the use of returning <code>IO Something</code> from <code>main</code> rather than only <code>IO ()</code>?</p>\n"}, {"tags": ["parsing", "haskell", "grammar"], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": true, "score": 3, "last_activity_date": 1555864512, "creation_date": 1555864512, "answer_id": 55784622, "question_id": 55771390, "link": "https://stackoverflow.com/questions/55771390/when-would-a-parser-append-its-input-string/55784622#55784622", "title": "When would a parser append its input string?", "body": "<p>Here are a couple of cases where it is convenient to inject tokens into the input stream. (How this is actually integrated into the parsing pipeline is another question.)</p>\n\n<ol>\n<li><p>Macro expansion, in the style of the C/C++ preprocessing phase. This is arguably not the best model for macro expansion; hygienic macros would more likely be expanded using a tree transformation, as with C++ template resolution. But the token-oriented preprocessor is not going away soon. Since it is not tightly coupled with the language syntax, the easiest implementation is to substitute the macro (and arguments if applicable) with the tokens from its expansion.</p></li>\n<li><p>Ecmascript-style automatic semi-colon insertion (ASI). The language syntax requires a semi-colon to be inserted into the token stream under certain precisely-defined circumstances, which are difficult (at least) to incorporate in a CFG. Since ASI is only possible if the next token in the input stream cannot be shifted (and done other conditions), it can certainly be integrated into the parser loop.</p></li>\n<li><p>Similarly, indentation-aware block syntax (as in Haskell and Python, for example) can certainly be implemented by replacing leading whitespace with an injected INDENT token or some number of injected DEDENTs. Since this substitution is dependent on parse context (it isn't done inside parentheses, for example), injection inside the parser could be a reasonable approach.</p></li>\n</ol>\n\n<p>That's not an exhaustive list, but it might be at least indicative. Not all of those cases necessarily involve context-sensitivity (I believe ASI could, in theory, be handled with a context-free grammar although I have no intention of trying) and not all instances of context-sensitivity necessarily require token injection (the ambiguity in C between type and variable names only requires selecting the correct token).</p>\n"}], "owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 55784622, "answer_count": 1, "score": 2, "last_activity_date": 1555864512, "creation_date": 1555746146, "last_edit_date": 1555837861, "question_id": 55771390, "link": "https://stackoverflow.com/questions/55771390/when-would-a-parser-append-its-input-string", "title": "When would a parser append its input string?", "body": "<p>Given a parser</p>\n\n<pre><code>newtype Parser a = Parser { parse :: String -&gt; [(a,String)] }\n\n(&gt;&gt;=) :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\np &gt;&gt;= f = Parser $ \\s -&gt; concat [ parse (f a) s' | (a, s') &lt;- parse p s ]\n\nreturn :: a -&gt; Parser a\nreturn a = Parser (\\s -&gt; [(a,s)])\n\nitem :: Parser Char\nitem = Parser $ \\s -&gt; case cs of\n                         \"\"     -&gt; []\n                         (c:cs) -&gt; [(c,cs)]\n</code></pre>\n\n<p>We can see that <code>item</code> consumes part of the input string given to it (<code>\"abc\" -&gt; [('a', \"bc\")]</code>). Is there ever a case where a parser would produce additional string output or replace/modify it (e.g. <code>Parser $ \\s -&gt; [((), 'a':s)]</code>)? I suspect that this might be the case with context-sensitive grammars but have trouble coming up with a sensible example.</p>\n\n<p>Is there a reason why it would make sense to do this for a real-world problem?</p>\n\n<h1>References</h1>\n\n<ul>\n<li><a href=\"http://www.cs.nott.ac.uk/~pszgmh/pearl.pdf\" rel=\"nofollow noreferrer\">Monadic Parsing in Haskell</a></li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1555742342, "post_id": 55770849, "comment_id": 98215115, "body": "<code>(Output a1 AnsiDark)</code> is a constraint. The compiler is trying to match that to an instance for <code>Output</code>, so that it knows how to implement <code>out</code>. You appear to have no instances at all. What do you expect <code>out ast</code> to produce if you haven&#39;t given an equation for it?"}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1555742664, "post_id": 55770849, "comment_id": 98215175, "body": "The message you&#39;d get from the Hugs compiler would be <code>Unresolved overloading</code>. Would that be a better explanation? This is not a &quot;complex type related problem&quot;. (GHC&#39;s messages in general expect that you&#39;re trying to do something really fancy. They&#39;re rather too full of giddy type theory for newbies IMO.)"}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 8, "last_activity_date": 1555742613, "creation_date": 1555742613, "answer_id": 55770996, "question_id": 55770849, "link": "https://stackoverflow.com/questions/55770849/why-cant-haskell-deduce-this-multi-parameter-type-class/55770996#55770996", "title": "Why can&#39;t haskell deduce this multi parameter type class?", "body": "<pre><code>nl :: (Output a AnsiDark) =&gt; [a] -&gt; AnsiDark\n...\n    where\n    doAddIf :: a -&gt; AnsiDark\n    ...\n</code></pre>\n\n<p>The <code>a</code>s that appear on these two lines are <em>not the same</em>.  It is as if you had written:</p>\n\n<pre><code>nl :: (Output x AnsiDark) =&gt; [x] -&gt; AnsiDark\n...\n    where\n    doAddIf :: y -&gt; AnsiDark\n    ...\n</code></pre>\n\n<p>Since you are using <code>out</code> in <code>doAddif</code> you need to add the <code>Output</code> constraint to its signature (I believe it will work if you remove the signature, since the correct signature will be inferred).</p>\n\n<p>You might also be interested in the <code>ScopedTypeVariables</code> extension.  With this enabled, if you write</p>\n\n<pre><code>nl :: forall a. (Output a AnsiDark) =&gt; [a] -&gt; AnsiDark\n</code></pre>\n\n<p>then you can refer to <em>that</em> <code>a</code> in signatures in the <code>where</code> clause as well as in type applications like the <code>out @a @AnsiDark</code> you tried.</p>\n"}], "owner": {"reputation": 2090, "user_id": 1499066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35bb8eaa9c809c52774aef01d19afa3?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1499066/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 55770996, "answer_count": 1, "score": 3, "last_activity_date": 1555742613, "creation_date": 1555741110, "question_id": 55770849, "link": "https://stackoverflow.com/questions/55770849/why-cant-haskell-deduce-this-multi-parameter-type-class", "title": "Why can&#39;t haskell deduce this multi parameter type class?", "body": "<p>I have two typeclasses</p>\n\n<pre><code>class Concatable a where\n  empty :: a\n  (&lt;+&gt;) :: a -&gt; a -&gt; a\n\nclass Concatable b =&gt; Output a b where\n  out :: a -&gt; b\n</code></pre>\n\n<p>and the following function</p>\n\n<pre><code>nl :: (Output a AnsiDark) =&gt; [a] -&gt; AnsiDark\nnl a = foldr addNl empty a\n  where\n    addNl :: a -&gt; AnsiDark -&gt; AnsiDark\n    addNl ast org = doAddIf ast &lt;+&gt; org\n    doAddIf :: a -&gt; AnsiDark\n    doAddIf ast = if out ast == sDedent\n                      then out ast\n                      else out ast &lt;+&gt; sNewline\n</code></pre>\n\n<p>(<code>AnsiDark</code> implements <code>Concatable</code>, <code>sDedent</code> is a constant of type <code>AnsiDark</code>)</p>\n\n<p>as well as the following language extensions enabled (which might not even relate to the problem, I'm fairly new to these complex type related problems)</p>\n\n<pre><code>{-# LANGUAGE TypeApplications #-}\n{-# LANGUAGE AllowAmbiguousTypes #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n</code></pre>\n\n<p>and I get the following error: </p>\n\n<pre><code>../src-hs/ANSITerm.hs:65:22: error:\n    \u2022 Could not deduce (Output a1 AnsiDark) arising from a use of \u2018out\u2019\n      from the context: Output a AnsiDark\n        bound by the type signature for:\n                   nl :: forall a. Output a AnsiDark =&gt; [a] -&gt; AnsiDark\n        at ../src-hs/ANSITerm.hs:59:1-44\n    \u2022 In the first argument of \u2018(==)\u2019, namely \u2018out ast\u2019\n      In the expression: out ast == sDedent\n      In the expression:\n        if out ast == sDedent then out ast else out ast &lt;+&gt; sNewline\n</code></pre>\n\n<p>I don't quite get why haskell isn't able to deduce <code>a</code>... I would have resorted to using type annotations with <code>out</code> like so </p>\n\n<pre><code>out @a @AnsiDark\n</code></pre>\n\n<p>but type annotations don't seem to work with type variables. So... what exactly is my problem here? And how could I solve it?</p>\n"}, {"tags": ["haskell", "lisp", "template-haskell", "quasiquotes"], "comments": [{"owner": {"reputation": 67968, "user_id": 584192, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YBSIc.png?s=128&g=1", "display_name": "Samuel Liew", "link": "https://stackoverflow.com/users/584192/samuel-liew"}, "edited": false, "score": 1, "creation_date": 1555974826, "post_id": 55767876, "comment_id": 98273036, "body": "Comments are not for extended discussion; this conversation has been <a href=\"https://chat.stackoverflow.com/rooms/192240/discussion-on-question-by-grepcake-haskell-analog-of-lisp-backquoting\">moved to chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2158, "user_id": 7190191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80c97da8e6a0d7784317a81a3e8539ca?s=128&d=identicon&r=PG&f=1", "display_name": "grepcake", "link": "https://stackoverflow.com/users/7190191/grepcake"}, "edited": false, "score": 1, "creation_date": 1556214375, "post_id": 55850388, "comment_id": 98371335, "body": "Thank you for the excellent answer, but you are focusing completely on semi-evaluation feature of backquoting, which is somewhat trivial in Haskell. However, the most interesting part is splicing. I mentioned it the discussion, but I guess I&#39;ll edit the question to clarify."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1557182701, "post_id": 55850388, "comment_id": 98671409, "body": "If that is backquoting, then Lisp without backquote also has backquoting. Look!   <code>(make-node id (make-node (+ id 1) left-tree &#39;leaf) (make-node (+ id 2) ...) ...)</code>."}, {"owner": {"reputation": 48201, "user_id": 1250772, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/633e1f643d2c9b043231b4a32b078907?s=128&d=identicon&r=PG", "display_name": "Kaz", "link": "https://stackoverflow.com/users/1250772/kaz"}, "edited": false, "score": 0, "creation_date": 1557182747, "post_id": 55850388, "comment_id": 98671421, "body": "&gt; <i>Node and Leaf constructors represent the quoted parts ..</i>  Not as <b>symbols</b>, though."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 1, "creation_date": 1557183572, "post_id": 55850388, "comment_id": 98671573, "body": "This looks like the beginning of long, painful &quot;discussion in the comments&quot;, so consider this clarifying remark my absolute last word on the subject.  IMHO, Haskell constructors and functions are quite different objects, even though they have some superficial similarities, and that&#39;s the point I was making.  A constructor is more like a (quoted) Lisp symbol than a Lisp function -- think of it as a &quot;self-quoting&quot; symbol.  So, in Haskell, you get back-quoting &quot;for free&quot; because there is a syntactic distinction between self-quoting symbols and functions."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 3, "last_activity_date": 1556199662, "last_edit_date": 1556199662, "creation_date": 1556198794, "answer_id": 55850388, "question_id": 55767876, "link": "https://stackoverflow.com/questions/55767876/haskell-analog-of-lisp-backquoting-and-splicing/55850388#55850388", "title": "Haskell analog of lisp backquoting and splicing", "body": "<p>It seems like the discussion in the comments kind of went off the rails.  Anyway, I have a different take on this, so let me offer an answer.</p>\n\n<p>I would say that Haskell already has a feature analogous to backquoting, and you've probably used it extensively in your own Haskell programming without realizing it.</p>\n\n<p>You've drawn a parallel between Lisp lists and Haskell lists, but in Lisp, S-expression (i.e., \"pairs with atoms\", especially with atomic symbols) are a flexible and ubiquitous data structure, used not only for representing Lisp code, but also as the go-to representation that's at least the first consideration for any complex, structured data.  As such, most Lisp programs spend a lot of time generating and manipulating these structures, and so S-expression \"literals\" are common in Lisp code.  And, S-expression \"almost literals\", where a few sub-expressions need to be calculated, are more conveniently written using the backquoting mechanism than trying to build up the expression with smaller literal and evaluated pieces using functions like <code>cons</code>, <code>list</code>, <code>append</code>, etc.</p>\n\n<p>Contrast that with Haskell --  Haskell lists are certainly popular in Haskell code, and are a go-to structure for representing homogeneous sequences, but they provide only a small fraction of the flexibility of S-expressions.  Instead, the corresponding ubiquitous data structure in Haskell is the Algebraic Data Type (ADT).</p>\n\n<p>Well, just like Lisp with its S-expressions, Haskell programs spend a lot of time generating and manipulating ADTs, and Haskell also has a convenient syntax for ADT literals and \"almost literals\".  They are unified into a single \"function application\" syntax with literal and evaluated parts differentiated by the use of constructors (identifiers with an initial uppercase letter or infix operators starting with a colon) versus non-constructors (identifiers with an initial lowercase letter or infix operators without an initial colon).  There is, of course, some additional syntax for certain constructors (lists and tuples).</p>\n\n<p>For example, compare the following backquoted expressions in Lisp and Haskell:</p>\n\n<pre><code>;; Lisp\n(setq baz `(node ,id\n                 (node ,(+ id 1) ,left-tree leaf)\n                 (node ,(+ id 2) leaf ,right-tree)))\n-- Haskell\nbaz = Node id (Node (id + 1) left_tree Leaf) (Node (id + 2) Leaf right_tree)\n</code></pre>\n\n<p>In the Haskell version of this \"almost literal\", the <code>Node</code> and <code>Leaf</code> constructors represent the quoted parts; the <code>left-tree</code>, <code>right-tree</code>, and <code>+</code> infix expression represent the evaluated parts, and they are syntactically distinguishable by the usual rules for constructors and non-constructors.</p>\n\n<p>Of course, completely separate from this, there's a Template Haskell mechanism that directly manipulates snippets of Haskell code at compile time.  While the code is represented as an ADT that could, in principle, be written using the same \"almost literal\" syntax used for other ADTs, the ADT in question is quite cumbersome and looks nothing like the underlying Haskell code.  So, Template Haskell provides a more classic sort of backquoting syntax.</p>\n"}], "owner": {"reputation": 2158, "user_id": 7190191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/80c97da8e6a0d7784317a81a3e8539ca?s=128&d=identicon&r=PG&f=1", "display_name": "grepcake", "link": "https://stackoverflow.com/users/7190191/grepcake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1556214590, "creation_date": 1555708063, "last_edit_date": 1556214590, "question_id": 55767876, "link": "https://stackoverflow.com/questions/55767876/haskell-analog-of-lisp-backquoting-and-splicing", "title": "Haskell analog of lisp backquoting and splicing", "body": "<p>In some lisps (e.g. <a href=\"https://www.gnu.org/software/emacs/manual/html_node/elisp/Backquote.html#Backquote\" rel=\"nofollow noreferrer\">elisp</a>, <a href=\"http://cl-cookbook.sourceforge.net/macros.html\" rel=\"nofollow noreferrer\">common lisp</a>) there is a feature called backquoting.</p>\n\n<p>It allows to construct a list while evaluating or splicing into it some elements. For example:</p>\n\n<pre class=\"lang-lisp prettyprint-override\"><code> `(1 2 (3 (+ 4 5))) \n  \u21d2 (1 2 (3 (+ 4 5)))  ; just quoted unevaluated list\n\n `(1 2 (3 ,(+ 4 5)))\n  \u21d2 (1 2 (3 9))     ; (+ 4 5) has been evaluated\n\n `(1 2 ,@(list 3 (+ 4 5)))\n  \u21d2 (1 2 3 9)       ; (3 9) has been spliced into the list\n</code></pre>\n\n<p>I guess, in Haskell some subset of backquoting could look like this:</p>\n\n<pre><code> [backquote| 1, 2, @$(replicate 2 3), 2 + 2 |]\n \u21d2 [1, 2, 3, 3, 4]\n</code></pre>\n\n<p>I wonder, if splicing into list like this is possible and if it has been implemented.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 12, "creation_date": 1555698901, "post_id": 55766253, "comment_id": 98206880, "body": "Where is the <code>in</code> accompanying the <code>let</code>?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 5, "creation_date": 1555699434, "post_id": 55766253, "comment_id": 98207079, "body": "There&#39;s no such thing as a function without parameters. <code>outfits1</code> is just a list."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1555704379, "post_id": 55766491, "comment_id": 98208796, "body": "<code>mixAndMatch = liftA3 (,,)</code>, which might be more palatable to inline even if you don&#39;t like applicative style."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 1, "creation_date": 1555704721, "post_id": 55766491, "comment_id": 98208909, "body": "or just <a href=\"https://hackage.haskell.org/package/base/docs/Prelude.html#v:zip3\" rel=\"nofollow noreferrer\"><code>zip3</code></a>. Jumping into applicative for someone who&#39;s still learning the syntax might be a bit much."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 0, "creation_date": 1555709267, "post_id": 55766491, "comment_id": 98210329, "body": "@rampion <code>zip3</code> doesn&#39;t compute a cross product of the three lists."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 7, "last_activity_date": 1555703622, "last_edit_date": 1555703622, "creation_date": 1555699972, "answer_id": 55766491, "question_id": 55766253, "link": "https://stackoverflow.com/questions/55766253/parse-error-when-creating-function-without-parameters-in-haskell/55766491#55766491", "title": "Parse error when creating function without parameters in Haskell", "body": "<p>Without the <code>let</code> expression, you would simply write</p>\n\n<pre><code>outfits = [ (x, y, z) | z &lt;- [\"jeans\", \"khaki\", \"leggings\"], y &lt;- [\"white shirt\", \"grey turtleneck\", \"pink polo\", \"green hoodie\"], x &lt;- [\"brogues\", \"converse\", \"sandals\", \"adidas\"] ]\n</code></pre>\n\n<p>A <code>let</code> expression requires two parts: the local bindings immediately following the keyword <code>let</code>, and the expression which uses those bindings, following the keyword <code>in</code>:</p>\n\n<pre><code>outfits = let pants = [\"jeans\", \"khaki\", \"leggings\"]\n              shirts = [\"white shirt\", \"grey turtleneck\", \"pink polo\", \"green hoodie\"]\n              shoes = [\"brogues\", \"converse\", \"sandals\", \"adidas\"]\n          in [ (x, y, z) | z &lt;- pants, y &lt;- shirts, x &lt;- shoes ]\n</code></pre>\n\n<p>Alternately, you can write this using a <code>where</code> clause, which puts the \"main\" expression first:</p>\n\n<pre><code>outfits = [ (x, y, z) | z &lt;- pants, y &lt;- shirts, x &lt;- shoes ]\n              where pants = [\"jeans\", \"khaki\", \"leggings\"]\n                    shirts = [\"white shirt\", \"grey turtleneck\", \"pink polo\", \"green hoodie\"]\n                    shoes = [\"brogues\", \"converse\", \"sandals\", \"adidas\"]\n</code></pre>\n\n<hr>\n\n<h2><code>Applicative</code> instead of list comprehension</h2>\n\n<p>I would write this using the <code>Applicative</code> instance for lists instead, using the 3-tuple constructor <code>(,,)</code>, which lets you do away with boilerplate variables <code>x</code>, <code>y</code>, and <code>z</code>. </p>\n\n<pre><code>outfits = (,,) &lt;$&gt; [\"jeans\", \"khaki\", \"leggings\"]\n               &lt;*&gt; [\"white shirt\", \"grey turtleneck\", \"pink polo\", \"green hoodie\"]\n               &lt;*&gt; [\"brogues\", \"converse\", \"sandals\", \"adidas\"]\n</code></pre>\n\n<p>You can still use either a <code>let</code> expression or a <code>where</code> clause to provide names for each component of an outfit:</p>\n\n<pre><code>outfits = let pants = [\"jeans\", \"khaki\", \"leggings\"]\n              shirts = [\"white shirt\", \"grey turtleneck\", \"pink polo\", \"green hoodie\"]\n              shoes = [\"brogues\", \"converse\", \"sandals\", \"adidas\"]\n          in (,,) &lt;$&gt; pants &lt;*&gt; shirts &lt;*&gt; shoes\n</code></pre>\n\n<p>or</p>\n\n<pre><code>outfits = (,,) &lt;$&gt; pants &lt;*&gt; shirts &lt;*&gt; shoes\n              where pants = [\"jeans\", \"khaki\", \"leggings\"]\n                    shirts = [\"white shirt\", \"grey turtleneck\", \"pink polo\", \"green hoodie\"]\n                    shoes = [\"brogues\", \"converse\", \"sandals\", \"adidas\"]\n</code></pre>\n\n<hr>\n\n<p>If <code>... &lt;$&gt; ... &lt;*&gt; ... &lt;*&gt; ...</code> looks too esoteric, you can give the pattern a more descriptive name:</p>\n\n<pre><code>outfits = mixAndMatch pants shirts shoes\n           where pants = [\"jeans\", \"khaki\", \"leggings\"]\n                 shirts = [\"white shirt\", \"grey turtleneck\", \"pink polo\", \"green hoodie\"]\n                 shoes = [\"brogues\", \"converse\", \"sandals\", \"adidas\"]\n                 mixAndMatch a b c = (,,) &lt;$&gt; a &lt;*&gt; b &lt;*&gt; c\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11385416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/362ff5bfa6c3fbe8facf58d20e90ba06?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe", "link": "https://stackoverflow.com/users/11385416/chloe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1555721950, "creation_date": 1555698800, "last_edit_date": 1555721950, "question_id": 55766253, "link": "https://stackoverflow.com/questions/55766253/parse-error-when-creating-function-without-parameters-in-haskell", "title": "Parse error when creating function without parameters in Haskell", "body": "<p>I am trying to create a function without parameters that create a list comprehension. When I try to run the code, I get a parse error and it fails to compile and I have no idea why.</p>\n\n<p>I keep trying to run it on the terminal but it won't work.</p>\n\n<p>This is my code:</p>\n\n<pre><code>outfits = let pants = [\"jeans\", \"khaki\", \"leggings\"]\n              shirts = [\"white shirt\", \"grey turtleneck\", \"pink polo\", \"green hoodie\"]\n              shoes = [\"brogues\", \"converse\", \"sandals\", \"adidas\"]\n\noutfits1 = [ (x, y, z) | z &lt;- pants, y &lt;- shirts, x &lt;- shoes ]\n</code></pre>\n\n<p>This is the error that comes up:</p>\n\n<pre><code>warmup.hs:7:11: error: parse error on input \u2018outfits1\u2019\n  |\n7 |           outfits1 = [ (x, y, z) | z &lt;- pants, y &lt;- shirts, x &lt;- shoes ]\n  |           ^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "cabal-install", "xmonad"], "comments": [{"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1555718499, "post_id": 55765994, "comment_id": 98212061, "body": "It looks like there are somehow two different <code>xmonad</code> packages in scope. How have you installed <code>xmonad</code>?"}, {"owner": {"reputation": 2447, "user_id": 2061783, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5fc1d7081d9f24bd0307795baea57d56?s=128&d=identicon&r=PG", "display_name": "danbroooks", "link": "https://stackoverflow.com/users/2061783/danbroooks"}, "reply_to_user": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1555756000, "post_id": 55765994, "comment_id": 98217847, "body": "I have recently done <code>cabal new-install xmonad</code>, but looking through <code>history</code> I have previously installed <code>xmonad</code> using <code>apt-get</code>, removing <code>xmonad</code> through <code>apt-get remove</code> has removed the xmonad login option (in Ubuntu), though I can still run the xmonad command, still resulting in the same error"}, {"owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1555757811, "post_id": 55765994, "comment_id": 98218310, "body": "What does <code>ghc-pkg list xmonad</code> show?"}, {"owner": {"reputation": 2447, "user_id": 2061783, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5fc1d7081d9f24bd0307795baea57d56?s=128&d=identicon&r=PG", "display_name": "danbroooks", "link": "https://stackoverflow.com/users/2061783/danbroooks"}, "reply_to_user": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "edited": false, "score": 0, "creation_date": 1555764385, "post_id": 55765994, "comment_id": 98219834, "body": "I&#39;ve added that output to the bottom of the question"}], "answers": [{"tags": [], "owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "is_accepted": false, "score": 1, "last_activity_date": 1555804849, "creation_date": 1555804849, "answer_id": 55778758, "question_id": 55765994, "link": "https://stackoverflow.com/questions/55765994/vague-couldnt-match-expected-type-error-when-trying-to-use-managerdocks-in-xm/55778758#55778758", "title": "Vague &#39;Couldn&#39;t match expected type&#39; error when trying to use ManagerDocks in Xmonad", "body": "<p>This error indicates that your build somehow depended on two different <code>xmonad</code> Cabal packages. When compiling anything, GHC stores, along with the type name itself (e.g. <code>Prelude.Maybe</code>) the <em>package</em> it came from (in the case of <code>Prelude</code>, <code>base</code>). You can see a list of packages available to GHC with <code>ghc-pkg list</code>.</p>\n\n<p>The error message says that <code>docks</code> produced a value of type <code>XMonad.Core.XConfig</code> from <code>xmonad-0.14.2@xmonad-0.14.2-50ceb56c2be27c58b715ff1418342ea50324c61ceef6f33afc6bf382abd08795</code> package (I'll refer to it as \"xmonad 50\" further for brevity). Note that <code>docks</code> itself is part of the <code>xmonad-contrib</code> package. However, the value expected by <code>xmonad</code> is of type <code>XMonad.Core.XConfig</code> from <code>xmonad-0.14.2@xmonad-0.14.2-8c611bf8742b1b94190ab2fa494cb2a1cd3f8666db2ba536c81ae848ea043a6b</code> package (\"xmonad 8\" further on).</p>\n\n<p>This is the dependency graph of your build:</p>\n\n<ul>\n<li>your build\n\n<ul>\n<li>xmonad 8</li>\n<li>xmonad-contrib\n\n<ul>\n<li>xmonad 50</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>Speculation of how this came to be:</p>\n\n<ul>\n<li>You installed <code>xmonad-contrib</code> and/or <code>xmonad</code> somehow, either from your OS repositories or by compiling manually. Your package database now contains xmonad 50 and <code>xmonad-contrib</code>.</li>\n<li>You installed <code>xmonad</code> again, and this created a different package version (xmonad 8). However, <code>xmonad-contrib</code> available to you is still from the earlier installation, compiled against xmonad 50.</li>\n</ul>\n\n<p>This problem is known as <a href=\"https://stackoverflow.com/questions/50925938/what-is-cabal-hell\">Cabal Hell</a> (<a href=\"https://stackoverflow.com/a/25870174/288201\">another explanation</a>).</p>\n\n<p>What you can do next:</p>\n\n<ul>\n<li>Check that you don't somehow have two GHC versions installed. <code>/opt/ghc</code> is a nonstandard installation path, there might be other versions in your distribution's standard path.</li>\n<li>Investigate where the two <code>xmonad</code> libraries and one <code>xmonad-contrib</code> are installed. <code>ghc-pkg list</code> and <code>ghc-pkg list --user</code> might help here, or failing that, using <a href=\"https://unix.stackexchange.com/questions/420011/tools-for-showing-which-files-are-accessed-by-a-program\"><code>strace</code> or similar tools</a> to see where <code>xmonad</code> looks while recompiling.</li>\n<li>Remove and reinstall packages so that you only have one <code>xmonad</code> and one <code>xmonad-contrib</code> depending on that. If you found the extra versions in the previous step, you can try <code>ghc-pkg unregister</code> them, and if not, removing the full package database(s) and reinstalling the needed packages again (together!) can help.</li>\n</ul>\n\n<p>In the future, try not to install packages related to XMonad from different sources, and if you want to use new-style Cabal builds, check a tutorial specifically about new-style builds and XMonad (I am not using that so unfortunately cannot suggest any.)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14535380, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/3a0ea2b284d5cdd68a9d3d94cc39d8e1?s=128&d=identicon&r=PG", "display_name": "supermario9590", "link": "https://stackoverflow.com/users/14535380/supermario9590"}, "is_accepted": false, "score": -1, "last_activity_date": 1603885434, "creation_date": 1603885434, "answer_id": 64572148, "question_id": 55765994, "link": "https://stackoverflow.com/questions/55765994/vague-couldnt-match-expected-type-error-when-trying-to-use-managerdocks-in-xm/64572148#64572148", "title": "Vague &#39;Couldn&#39;t match expected type&#39; error when trying to use ManagerDocks in Xmonad", "body": "<p>Your main function needs to be something like</p>\n<pre><code>main = do\n  xmonad $ docks def\n</code></pre>\n"}], "owner": {"reputation": 2447, "user_id": 2061783, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/5fc1d7081d9f24bd0307795baea57d56?s=128&d=identicon&r=PG", "display_name": "danbroooks", "link": "https://stackoverflow.com/users/2061783/danbroooks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1603885434, "creation_date": 1555697395, "last_edit_date": 1556012826, "question_id": 55765994, "link": "https://stackoverflow.com/questions/55765994/vague-couldnt-match-expected-type-error-when-trying-to-use-managerdocks-in-xm", "title": "Vague &#39;Couldn&#39;t match expected type&#39; error when trying to use ManagerDocks in Xmonad", "body": "<p>I am trying to add the <code>docks</code> command to my <code>.xmonad</code> config, but adding it results in a somewhat confusing type error:</p>\n\n<pre><code>Error detected while loading xmonad configuration file: /home/dan/.xmonad/xmonad.hs\n\nxmonad.hs:11:11: error:\n    \u2022 Couldn't match expected type \u2018XConfig l0\u2019\n                  with actual type \u2018xmonad-0.14.2@xmonad-0.14.2-50ceb56c2be27c58b715ff1418342ea50324c61ceef6f33afc6bf382abd08795:XMonad.Core.XConfig\n                                      (xmonad-0.14.2@xmonad-0.14.2-50ceb56c2be27c58b715ff1418342ea50324c61ceef6f33afc6bf382abd08795:XMonad.Layout.Choose\n                                         xmonad-0.14.2@xmonad-0.14.2-50ceb56c2be27c58b715ff1418342ea50324c61ceef6f33afc6bf382abd08795:XMonad.Layout.Tall\n                                         (xmonad-0.14.2@xmonad-0.14.2-50ceb56c2be27c58b715ff1418342ea50324c61ceef6f33afc6bf382abd08795:XMonad.Layout.Choose\n                                            (xmonad-0.14.2@xmonad-0.14.2-50ceb56c2be27c58b715ff1418342ea50324c61ceef6f33afc6bf382abd08795:XMonad.Layout.Mirror\n                                               xmonad-0.14.2@xmonad-0.14.2-50ceb56c2be27c58b715ff1418342ea50324c61ceef6f33afc6bf382abd08795:XMonad.Layout.Tall)\n                                            xmonad-0.14.2@xmonad-0.14.2-50ceb56c2be27c58b715ff1418342ea50324c61ceef6f33afc6bf382abd08795:XMonad.Layout.Full))\u2019\n      NB: \u2018xmonad-0.14.2@xmonad-0.14.2-50ceb56c2be27c58b715ff1418342ea50324c61ceef6f33afc6bf382abd08795:XMonad.Core.XConfig\u2019\n            is defined in \u2018XMonad.Core\u2019\n                in package \u2018xmonad-0.14.2@xmonad-0.14.2-50ceb56c2be27c58b715ff1418342ea50324c61ceef6f33afc6bf382abd08795\u2019\n          \u2018XConfig\u2019\n            is defined in \u2018XMonad.Core\u2019\n                in package \u2018xmonad-0.14.2@xmonad-0.14.2-8c611bf8742b1b94190ab2fa494cb2a1cd3f8666db2ba536c81ae848ea043a6b\u2019\n    \u2022 In the first argument of \u2018xmonad\u2019, namely \u2018(docks def)\u2019\n      In the expression: xmonad (docks def)\n      In an equation for \u2018main\u2019: main = xmonad (docks def)\n\nPlease check the file for errors.\n</code></pre>\n\n<p>Here is my config file:</p>\n\n<pre><code>import           XMonad\nimport           XMonad.Hooks.ManageDocks (docks)\n\nmain :: IO ()\nmain =\n  xmonad (docks def)\n</code></pre>\n\n<p>I'm not sure what exactly has gone wrong here, and think perhaps I have messed something up during install.. though I'm not sure how to troubleshoot.</p>\n\n<hr>\n\n<p>Output of <code>ghc-pkg list xmonad</code>:</p>\n\n<pre><code>/opt/ghc/8.0.2/lib/ghc-8.0.2/package.conf.d\n    (no packages)\n/home/dan/.ghc/x86_64-linux-8.0.2/package.conf.d\n    (no packages)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1555692395, "post_id": 55764653, "comment_id": 98204647, "body": "Would you please add the specific error you receive and a description of how you\u2019re running the code? (Are you loading it in GHCi? Are you getting to a point where you can call <code>solutions&#39;</code>, but it fails on the specific inputs you used? What are they? &amp;c.)"}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1555696862, "post_id": 55764653, "comment_id": 98206212, "body": "@JonPurdy I have added it. Is what I tried to do correct?"}, {"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1555699252, "post_id": 55764653, "comment_id": 98207023, "body": "Not an expert on the parallel package but - shouldn&#39;t the <code>m == n</code> filtering be outside of the parallel part?  At the moment it seems like you&#39;re parallelizing over a list of things that are already known to be successes, and most of the work on the elements must have already been done."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1555699695, "post_id": 55764653, "comment_id": 98207188, "body": "@DavidFletcher yes maybe. However at the moment, there seems to be something wrong with my Instances or how I am trying to run <code>deepseq</code> on the list because, the program does not complete. I would imagine if it was just a case of  the <code>m==n</code> then I would at least have a working program that does not have any parallel processes ?"}], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1555759384, "post_id": 55768403, "comment_id": 98218629, "body": "Thanks. With your changes, it now runs. 1957 sparks (all converted). I pulled the filter out of the <code>using</code> too. Program runs slower than before. Also the comments in your code are extremely helpful and educational"}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 1, "last_activity_date": 1555714398, "last_edit_date": 1555714398, "creation_date": 1555712190, "answer_id": 55768403, "question_id": 55764653, "link": "https://stackoverflow.com/questions/55764653/haskell-parallel-list-computation/55768403#55768403", "title": "Haskell : parallel list computation", "body": "<p>Ok, so I just clicked at a random timestamp in the video, and by sheer luck I got a slide that describes what's wrong.</p>\n\n<blockquote>\n  <p>For our example, only about 5 million of the 33 million possible expressions are valid.</p>\n</blockquote>\n\n<p>So, this means that you are evaluating</p>\n\n<pre><code>_fiveMillionList `using` parList rdeepseq\n</code></pre>\n\n<p>Now, the way <code>(`using` parList _strat)</code> works is that it immediately forces the entire spine of the list. When you begin evaluating your expression, <code>parList</code> forces all the cells of the list to exist. Further, as @DavidFletcher notes, your parallelism is actually useless. Because the filtration is underneath the <code>using</code>, forcing the entire spine of the list also forces all 33 million <code>Expr</code>s to exist, because you need to know how many elements passed the <code>(==)</code> test, so you need to create the <code>Expr</code>s to test them. They don't need to <em>all</em> exist simultaneously, but, in the end, 5 million of them (not counting the <code>Expr</code>s recursively contained in them), plus 5 million <code>(:)</code> constructors, will be held in memory. To add insult to injury, you proceed to create 5 million more objects in the form of dud sparks. And, all of this is being orchestrated by 5 million calls to the <code>Eval</code> monad's <code>(&gt;&gt;=)</code> function. I'm not sure which one of these exactly is sitting resident in memory for long enough to cause a stack overflow, but I'm fairly sure that <code>parList</code> is the culprit.</p>\n\n<p>Perhaps try a more reasonable <code>Strategy</code>. I think you are pretty much forced into using <code>parBuffer</code>, because you need laziness. Using <code>parBuffer n strat</code>, if you evaluate a <code>(:)</code>-cell, then the strategy ensures that the next <code>n - 1</code> elements have been sparked. So, essentially, it \"runs ahead\" of any consumer that starts at the head of the list, maintaining a buffer of parallely-evaluated elements. Something like <code>parBuffer 1000 rdeepseq</code> should be fine.</p>\n\n<hr/>\n\n<p>Your <code>NFData</code> instances could use some work. They aren't the problem, but they don't really demonstrate a sound understanding of how evaluation works. I'll just leave them here:</p>\n\n<pre><code>instance NFData Op where\n  -- (seq/deepseq) x y is defined by\n  -- \"if you want to evaluate (seq/deepseq) x y to WHNF, then you must\n  -- evaluate x to WHNF/NF, then evaluate y to WHNF.\"\n  -- but e.g. Add is already in WHNF and NF, so seq Add and deeqseq Add are no-ops\n  -- the actual evaluation is already finished by the case in rnf's equations\n  -- you could even write rnf x = x `seq` (), but I think it's best to be explicit\n  rnf Add = ()\n  rnf Sub = ()\n  rnf Mul = ()\n  rnf Div = ()\n\ninstance NFData Expr where\n  rnf (Val a)     = a `deepseq` ()\n  -- rnf o, rnf l :: ()\n  -- WHNF and NF are the same thing for the type (); all constructors are nullary\n  -- therefore (deepseq (rnf x) y) = seq (rnf x) y\n  -- but then seq (rnf x) y = deepseq x y {by definition}\n  rnf (App o l r) = o `deepseq` l `deepseq` rnf r\n</code></pre>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 55768403, "answer_count": 1, "score": 0, "last_activity_date": 1555714398, "creation_date": 1555690088, "last_edit_date": 1555701361, "question_id": 55764653, "link": "https://stackoverflow.com/questions/55764653/haskell-parallel-list-computation", "title": "Haskell : parallel list computation", "body": "<p>I am trying to follow the implementation of the countdown problem shown in this video (<a href=\"https://www.youtube.com/watch?v=rlwSBNI9bXE&amp;\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=rlwSBNI9bXE&amp;</a>) and I thought it would be a good problem to try and run in parallel?</p>\n\n<pre><code>data Op =\n    Add\n  | Sub\n  | Mul\n  | Div deriving (Eq)\n\ndata Expr = \n    Val Int \n  | App Op Expr Expr\n\n--{ helper functions }  \n\nsolutions' :: [Int] -&gt; Int -&gt; [Expr]\nsolutions' ns n =\n  [e | ns' &lt;- choices ns, (e, m) &lt;- results ns', m == n]\n</code></pre>\n\n<p>I tried following some other posts on how to do this and came up with something like this</p>\n\n<pre><code>instance NFData Op where\n  rnf Add = Add `deepseq` ()\n  rnf Sub = Sub `deepseq` ()\n  rnf Mul = Mul `deepseq` ()\n  rnf Div = Div `deepseq` ()\n\ninstance NFData Expr where\n  rnf (Val a)     = a `deepseq` ()\n  rnf (App o l r) = (rnf  o) `deepseq` (rnf l) `deepseq` (rnf r)\n\nsolutions' :: [Int] -&gt; Int -&gt; [Expr]\nsolutions' ns n =\n  ([e | ns' &lt;- choices ns, (e, m) &lt;- results ns', m == n]\n    `using` parList rdeepseq)\n</code></pre>\n\n<p>It compiles but the program crashes when i try and run it. To be honest I was really just guessing on what I wrote.</p>\n\n<p>How do I get this to run in parallel?</p>\n\n<p>when I run in GHCI</p>\n\n<pre><code>&gt;\u03bb= r = (solutions' [1,3,7,10,25,50] 765)\n(0.00 secs, 0 bytes)\n&gt;\u03bb= mapM_ print r\n*** Exception: stack overflow\n&gt;\u03bb=\n</code></pre>\n\n<p>if i compile with\n<code>ghc ./Countdown.hs +RTS -N8 -s</code></p>\n\n<p>and then run the executable, it does not terminate.</p>\n"}, {"tags": ["string", "parsing", "haskell", "character", "point"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1555679441, "post_id": 55762363, "comment_id": 98199297, "body": "You might want to read about parsers, particularly the <code>parsec</code> library."}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 10628180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7bTVQYf2k74/AAAAAAAAAAI/AAAAAAAADCM/l_PdWAySHfg/photo.jpg?sz=128", "display_name": "Osa", "link": "https://stackoverflow.com/users/10628180/osa"}, "edited": false, "score": 0, "creation_date": 1555681161, "post_id": 55762561, "comment_id": 98199995, "body": "Thank you. How can i return a pix instead of printing it and how do i read its values back once Pix created ? EDIT : I&#39;m not actually really getting it. Does this function create a Pix ? What is ReadS ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 109, "user_id": 10628180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7bTVQYf2k74/AAAAAAAAAAI/AAAAAAAADCM/l_PdWAySHfg/photo.jpg?sz=128", "display_name": "Osa", "link": "https://stackoverflow.com/users/10628180/osa"}, "edited": false, "score": 0, "creation_date": 1555681355, "post_id": 55762561, "comment_id": 98200100, "body": "<a href=\"https://hoogle.haskell.org/?hoogle=ReadS\" rel=\"nofollow noreferrer\">LMHTFY</a>. Basically, the result of <code>ReadS</code> is a list that either contains one valid parsed element, or nothing (if the parser failed)."}, {"owner": {"reputation": 109, "user_id": 10628180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7bTVQYf2k74/AAAAAAAAAAI/AAAAAAAADCM/l_PdWAySHfg/photo.jpg?sz=128", "display_name": "Osa", "link": "https://stackoverflow.com/users/10628180/osa"}, "edited": false, "score": 0, "creation_date": 1555681707, "post_id": 55762561, "comment_id": 98200257, "body": "So the first element of the returned value is a Pix ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 109, "user_id": 10628180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7bTVQYf2k74/AAAAAAAAAAI/AAAAAAAADCM/l_PdWAySHfg/photo.jpg?sz=128", "display_name": "Osa", "link": "https://stackoverflow.com/users/10628180/osa"}, "edited": false, "score": 0, "creation_date": 1555681876, "post_id": 55762561, "comment_id": 98200336, "body": "Yes. The other is just <i>the remaining part of the string</i> (if any)."}, {"owner": {"reputation": 109, "user_id": 10628180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7bTVQYf2k74/AAAAAAAAAAI/AAAAAAAADCM/l_PdWAySHfg/photo.jpg?sz=128", "display_name": "Osa", "link": "https://stackoverflow.com/users/10628180/osa"}, "edited": false, "score": 0, "creation_date": 1555681915, "post_id": 55762561, "comment_id": 98200351, "body": "Then how can i get a single Pix, not in a list ? Or how do i extract it of the list ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 109, "user_id": 10628180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7bTVQYf2k74/AAAAAAAAAAI/AAAAAAAADCM/l_PdWAySHfg/photo.jpg?sz=128", "display_name": "Osa", "link": "https://stackoverflow.com/users/10628180/osa"}, "edited": false, "score": 2, "creation_date": 1555682070, "post_id": 55762561, "comment_id": 98200414, "body": "Like with any other list: by pattern-matching, <code>case ... of ((Pix pt color, _):_) -&gt; ...</code>, or you can fold it, or <code>mapM_</code> over it, etc. etc.."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1555680174, "creation_date": 1555680174, "answer_id": 55762561, "question_id": 55762363, "link": "https://stackoverflow.com/questions/55762363/how-to-parse-ints-out-of-string-in-haskell/55762561#55762561", "title": "How to parse ints out of string in Haskell", "body": "<p>An easy hack for this particular task:</p>\n\n<pre><code>data Pix = Pix (Int,Int) (Int,Int,Int)\n deriving (Read, Show)\n\nparsePix :: ReadS Pix\nparsePix s = reads $ \"Pix \"++s\n</code></pre>\n\n<pre><code>*Main> parsePix \"(1,2) (3,4,5)\"<br>[(Pix (1,2) (3,4,5),\"\")]</code></pre>\n\n<p>In general, you should look into proper parser-combinator libraries though, I recommend <a href=\"http://hackage.haskell.org/package/megaparsec\" rel=\"noreferrer\">megaparsec</a>.</p>\n"}], "owner": {"reputation": 109, "user_id": 10628180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7bTVQYf2k74/AAAAAAAAAAI/AAAAAAAADCM/l_PdWAySHfg/photo.jpg?sz=128", "display_name": "Osa", "link": "https://stackoverflow.com/users/10628180/osa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 55762561, "answer_count": 1, "score": 0, "last_activity_date": 1555680255, "creation_date": 1555679179, "last_edit_date": 1555680255, "question_id": 55762363, "link": "https://stackoverflow.com/questions/55762363/how-to-parse-ints-out-of-string-in-haskell", "title": "How to parse ints out of string in Haskell", "body": "<p>I'm trying to parse strings of the format:</p>\n\n<pre><code>(x,y) (r,g,b)\n</code></pre>\n\n<p>My file contains this kind of string on each line.\nI already extracted the lines, now i wanna extract its values, but i couldn't find something satisfying.\nI wanted to do something like :</p>\n\n<pre><code>case str of\n['(', x, ',', y, ')', ' ', '(', r, ',', g, ',', b, ')'] -&gt; The rest\n</code></pre>\n\n<p>I know it doesn't work, I'm new to Haskell so i keep encountering errors i don't understand.\nHow can i make it ?</p>\n\n<p>EDIT :\nI have created this before, but i don't know how to really use it once the variable has been created :</p>\n\n<pre><code>data Points = Point Coords Colors\ndata Colors = Color Float Float Float\ndata Coords = Coord Int Int\n</code></pre>\n\n<p>Numbers are not limited to one digit, r, g and b range from 0 to 255.</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 1, "creation_date": 1555671338, "post_id": 55760501, "comment_id": 98196181, "body": "I think you forgot to use <code>`</code> in <code>`rem`</code>, and this do not provide the expected output."}, {"owner": {"reputation": 66, "user_id": 11380548, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cFaiP.jpg?s=128&g=1", "display_name": "mdasilva", "link": "https://stackoverflow.com/users/11380548/mdasilva"}, "edited": false, "score": 0, "creation_date": 1555673548, "post_id": 55760501, "comment_id": 98196976, "body": "Thank you a lot but this code generate the following list ``` [1,4,5,8,9,12,13,16,17] ```"}, {"owner": {"reputation": 1610, "user_id": 11257715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7ef71a9bfa4abd30cb98cbb290b909?s=128&d=identicon&r=PG", "display_name": "moonGoose", "link": "https://stackoverflow.com/users/11257715/moongoose"}, "edited": false, "score": 1, "creation_date": 1555677358, "post_id": 55760501, "comment_id": 98198412, "body": "<code>[ x | x &lt;- [1..18], y &lt;- [1,2], x `mod` 4 == y]</code> is close to the original comprehension"}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1555740794, "post_id": 55760501, "comment_id": 98214855, "body": "Fixed my solution."}], "tags": [], "owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "is_accepted": false, "score": 3, "last_activity_date": 1555740763, "last_edit_date": 1555740763, "creation_date": 1555670082, "answer_id": 55760501, "question_id": 55760469, "link": "https://stackoverflow.com/questions/55760469/generate-a-list-in-haskell-using-comprehensions-by-filtering-sequences-each-two/55760501#55760501", "title": "Generate a list in Haskell using comprehensions by filtering sequences each two numbers", "body": "<p>Try this </p>\n\n<pre><code>[x | x &lt;- [1..18], x rem 4 &lt; 2]\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>correct solution is</p>\n\n<pre><code> [x + 1 | x &lt;- [0..17], x `rem` 4 &lt; 2]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 66, "user_id": 11380548, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cFaiP.jpg?s=128&g=1", "display_name": "mdasilva", "link": "https://stackoverflow.com/users/11380548/mdasilva"}, "edited": false, "score": 0, "creation_date": 1555673684, "post_id": 55760581, "comment_id": 98197030, "body": "Yes! That&#39;s it! Thank yout a lot. Now I&#39;m trying to undestand why your code works (Newbie in Haskell)"}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "reply_to_user": {"reputation": 66, "user_id": 11380548, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cFaiP.jpg?s=128&g=1", "display_name": "mdasilva", "link": "https://stackoverflow.com/users/11380548/mdasilva"}, "edited": false, "score": 2, "creation_date": 1555697482, "post_id": 55760581, "comment_id": 98206424, "body": "@mdasilva <code>x</code> is being taken from the list <code>[1, 5, 9, 13, 17]</code>, and <code>y</code> is being taken from the list <code>[0, 1]</code>. Since the result is <code>x+y</code> for each pair of <code>x</code> and <code>y</code>, the final list is <code>[1+0, 1+1, 5+0, 5+1, 9+0, 9+1, 13+0, 13+1, 17+0, 17+1]</code>."}], "tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": true, "score": 5, "last_activity_date": 1555670493, "creation_date": 1555670493, "answer_id": 55760581, "question_id": 55760469, "link": "https://stackoverflow.com/questions/55760469/generate-a-list-in-haskell-using-comprehensions-by-filtering-sequences-each-two/55760581#55760581", "title": "Generate a list in Haskell using comprehensions by filtering sequences each two numbers", "body": "<p>You may want this:</p>\n\n<pre><code>Prelude&gt; [x+y | x &lt;- [1, 5..18], y &lt;- [0..1]]\n[1,2,5,6,9,10,13,14,17,18]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1555676847, "last_edit_date": 1555676847, "creation_date": 1555673901, "answer_id": 55761244, "question_id": 55760469, "link": "https://stackoverflow.com/questions/55760469/generate-a-list-in-haskell-using-comprehensions-by-filtering-sequences-each-two/55761244#55761244", "title": "Generate a list in Haskell using comprehensions by filtering sequences each two numbers", "body": "<p>Ignoring the list comprehension, it's just</p>\n\n<pre><code>-- [1,2,5,6,9,10,13,14,17,18] == [1,2] ++ [5,6] ++ [9,10] ++ ...\n--                            == [1+0,1+1] ++ [5+0,5+1] ++ [9+0,9+1] ++ ...\nconcatMap (\\x -&gt; [x, x+1]) [1,5..18]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>[1,5..18] &gt;&gt;= \\x -&gt; [x, x+1]\n</code></pre>\n\n<p>Translating back to a list comprehension, you get <a href=\"https://stackoverflow.com/a/55760581/1126841\">@NetWave's answer</a> (via <code>[1,5..18] &gt;&gt;= \\x -&gt; [0..1] &gt;&gt;= \\y -&gt; [x + y]</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1611972775, "last_edit_date": 1611972775, "creation_date": 1555706002, "answer_id": 55767551, "question_id": 55760469, "link": "https://stackoverflow.com/questions/55760469/generate-a-list-in-haskell-using-comprehensions-by-filtering-sequences-each-two/55767551#55767551", "title": "Generate a list in Haskell using comprehensions by filtering sequences each two numbers", "body": "<p>It's repeating additions of 1 and 3 to previous values so perhaps list comprehension is not the best solution. You've already got perfect answers.</p>\n<p>This is also lazy which is usually way more useful.</p>\n<pre><code>scanl (+) 1 $ cycle [1,3]\n\ntake 25 $ scanl (+) 1 $ cycle [1,3]\n</code></pre>\n<p>[1,2,5,6,9,10,13,14,17,18,21,22,25,26,29,30,33,34,37,38,41,42,45,46,49]</p>\n<p><strong>1.29.2021 A list comprehension version</strong></p>\n<p>Formulas can do just about anything. They supersede logic, even.\nThis formula amazed me as I cam upon it. I want to generalize it for other purposes. I have been reading the last year about how to survive covid with hundreds of papers and micro-biology and immunology books. I am fascinated.\nHere's the list comprehension version.</p>\n<pre><code>[ ((n*2)+(mod n 2))-2 | n &lt;- [1..26] ]\n</code></pre>\n<p>[1,2,5,6,9,10,13,14,17,18,21,22,25,26,29,30,33,34,37,38,41,42,45,46,49,50]</p>\n<p>The length of the output list is 26, the final value is almost exactly twice 26.</p>\n"}], "owner": {"reputation": 66, "user_id": 11380548, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cFaiP.jpg?s=128&g=1", "display_name": "mdasilva", "link": "https://stackoverflow.com/users/11380548/mdasilva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 55760581, "answer_count": 4, "score": 3, "last_activity_date": 1611972775, "creation_date": 1555669938, "question_id": 55760469, "link": "https://stackoverflow.com/questions/55760469/generate-a-list-in-haskell-using-comprehensions-by-filtering-sequences-each-two", "title": "Generate a list in Haskell using comprehensions by filtering sequences each two numbers", "body": "<p>I'd like to perform the following list in haskell using comprehensions:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[1,2,5,6,9,10,13,14,17,18]\n</code></pre>\n\n<p>I've tried this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[x | x &lt;- [1..18], y &lt;- [1..4], y &lt; 3]\n</code></pre>\n\n<p>but I get this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18]\n</code></pre>\n\n<p>I don't know if I could use some Enum function to get the list, but I wonder if there is some way to do it with list comprehensions. I can see I'm getting one x for each y value, but I only want the y values to the filter, not for the first list generation.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1555668141, "post_id": 55760073, "comment_id": 98194992, "body": "are the values always ordered?"}, {"owner": {"reputation": 117, "user_id": 4502721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-lrJuzGlmiPc/AAAAAAAAAAI/AAAAAAAAABA/DblLhIv7y1c/photo.jpg?sz=128", "display_name": "Amrita Deb", "link": "https://stackoverflow.com/users/4502721/amrita-deb"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1555668242, "post_id": 55760073, "comment_id": 98195034, "body": "not necessarily"}, {"owner": {"reputation": 117, "user_id": 4502721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-lrJuzGlmiPc/AAAAAAAAAAI/AAAAAAAAABA/DblLhIv7y1c/photo.jpg?sz=128", "display_name": "Amrita Deb", "link": "https://stackoverflow.com/users/4502721/amrita-deb"}, "reply_to_user": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1555668282, "post_id": 55760073, "comment_id": 98195056, "body": "[0,2,2,0,2,5,0,2] == [(0,3),(2,4),(5,1)]. This might be a better example"}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1555668517, "post_id": 55760073, "comment_id": 98195160, "body": "You can always look for definitions of  <code>toList</code> and <code>fromList</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1555679234, "post_id": 55760073, "comment_id": 98199220, "body": "Given that <code>(+)</code> is <i>also</i> a predefined function, it&#39;s not clear what the arbitrary restriction covers."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1555672889, "post_id": 55760331, "comment_id": 98196754, "body": "You can omit the 2nd and 3rd <code>ins x ((fk, fv): fs)</code> and instead use <code>ins x ((fk, fv): fs) | x == fk = ... | x &lt; fk = ... | otherwise = ...</code>. Also, it&#39;s always a good idea to add a short explanation of the code to beginners, since giving the solution away does not help them (unless they simply want to avoid doing some homework)."}, {"owner": {"reputation": 117, "user_id": 4502721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-lrJuzGlmiPc/AAAAAAAAAAI/AAAAAAAAABA/DblLhIv7y1c/photo.jpg?sz=128", "display_name": "Amrita Deb", "link": "https://stackoverflow.com/users/4502721/amrita-deb"}, "edited": false, "score": 0, "creation_date": 1555685220, "post_id": 55760331, "comment_id": 98201732, "body": "true. i would really appreciate some assistance with the code @talex provided."}, {"owner": {"reputation": 117, "user_id": 4502721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-lrJuzGlmiPc/AAAAAAAAAAI/AAAAAAAAABA/DblLhIv7y1c/photo.jpg?sz=128", "display_name": "Amrita Deb", "link": "https://stackoverflow.com/users/4502721/amrita-deb"}, "edited": false, "score": 0, "creation_date": 1555693354, "post_id": 55760331, "comment_id": 98205019, "body": "i dont quite understand what fv is. I changed the code to understand as follows:  ins x ((fk, fv): fs) | x == fk = (fk, fv + 4): fs so fr a matrix [8,8,9,7,7] we get [(7,5),(8,5),(9,1)]"}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 0, "creation_date": 1555741372, "post_id": 55760331, "comment_id": 98214954, "body": "I extended my answer a little."}], "tags": [], "owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "is_accepted": false, "score": 2, "last_activity_date": 1555741349, "last_edit_date": 1555741349, "creation_date": 1555669269, "answer_id": 55760331, "question_id": 55760073, "link": "https://stackoverflow.com/questions/55760073/count-frequency-of-every-element-in-a-list-using-just-comparison-operators/55760331#55760331", "title": "Count frequency of every element in a list using just comparison operators", "body": "<p>Try this one</p>\n\n<pre><code>freq:: (Ord a) =&gt; [a] -&gt; [(a, Int)]\nfreq []      = []\nfreq (x: xs) = ins x (freq xs)\n   where \n      ins :: (Ord a) =&gt; a -&gt; [(a, Int)] -&gt; [(a, Int)]\n      ins x ((fk, fv): fs) | x == fk = (fk, fv + 1): fs \n      ins x ((fk, fv): fs) | x &lt;  fk = (x, 1): (fk, fv): fs       \n      ins x ((fk, fv): fs)           = (fk, fv): ins x fs             \n      ins x []                       = (x, 1): []             \n</code></pre>\n\n<p><code>ins</code> function insert single element in map.\nit is recursively goes thru the map.</p>\n\n<p>If current element is equal to key it increment the value.</p>\n\n<pre><code>ins x ((fk, fv): fs) | x == fk = (fk, fv + 1): fs \n</code></pre>\n\n<p>If current element is less then key it insert new entry in the map.</p>\n\n<pre><code>ins x ((fk, fv): fs) | x &lt;  fk = (x, 1): (fk, fv): fs\n</code></pre>\n\n<p>Otherwise (if element is greater) it tries to insert element in tail of the map.</p>\n\n<pre><code>ins x ((fk, fv): fs)           = (fk, fv): ins x fs\n</code></pre>\n\n<p>Last part is simply handle case when map is empty.</p>\n"}], "owner": {"reputation": 117, "user_id": 4502721, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-lrJuzGlmiPc/AAAAAAAAAAI/AAAAAAAAABA/DblLhIv7y1c/photo.jpg?sz=128", "display_name": "Amrita Deb", "link": "https://stackoverflow.com/users/4502721/amrita-deb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555741349, "creation_date": 1555668052, "last_edit_date": 1555669462, "question_id": 55760073, "link": "https://stackoverflow.com/questions/55760073/count-frequency-of-every-element-in-a-list-using-just-comparison-operators", "title": "Count frequency of every element in a list using just comparison operators", "body": "<p>I am new to Haskell and I have to count the frequencies of elements in a list and return it in a list of key value pair, where key is the element in the list and value is the number of times it has occurred in the list. For example:</p>\n\n<p>for input <code>[0,2,2,0,2,5,0,2]</code> the output should be <code>[(0,3),(2,4),(5,1)]</code></p>\n\n<p>The catch here is we have to do it <strong>without using any predefined functions except comparisons</strong>.</p>\n\n<pre><code>import Data.Map (fromListWith, toList)\n\nfrequency :: (Ord a) =&gt; [a] -&gt; [(a, Int)]\nfrequency xs = toList (fromListWith (+) [(x, 1) | x &lt;- xs])\n</code></pre>\n\n<p>This works but toList and fromListWith classifies as predefined functions. Is there any way to do this without using any Data.Map functions?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1555689938, "post_id": 55760059, "comment_id": 98203711, "body": "Irks that code is horrible. <a href=\"https://wiki.haskell.org/Data_declaration_with_constraint\" rel=\"nofollow noreferrer\">Data constraints??</a> Not to mention the capitalisation crimes. Anyway... could you fix the indentation, so this is actually testable?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1555695494, "post_id": 55760059, "comment_id": 98205746, "body": "The best way by far to handle a datatype context is to delete it."}, {"owner": {"reputation": 203, "user_id": 9952780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2469a9716383b916f6db1205853858?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Browne", "link": "https://stackoverflow.com/users/9952780/patrick-browne"}, "edited": false, "score": 0, "creation_date": 1555700750, "post_id": 55760059, "comment_id": 98207552, "body": "@ leftaroundabout I am aware that data constraints are depreciated. But for research purposes I need to get my code as near to the original as possible."}], "answers": [{"tags": [], "owner": {"reputation": 1555, "user_id": 11228628, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c463de7cfe16792a210e3531fef5ccb5?s=128&d=identicon&r=PG&f=1", "display_name": "user11228628", "link": "https://stackoverflow.com/users/11228628/user11228628"}, "is_accepted": true, "score": 3, "last_activity_date": 1555691035, "creation_date": 1555691035, "answer_id": 55764809, "question_id": 55760059, "link": "https://stackoverflow.com/questions/55760059/can-this-haskell-code-be-compiled-as-written/55764809#55764809", "title": "Can this Haskell code be compiled as written?", "body": "<p>You need to tell the compiler to expect that the <code>affordance</code> parameter in classes <code>QUALITIES</code> and <code>AFFORDANCES</code> is a type constructor\u2014in other words, has kind <code>* -&gt; *</code> and not <code>*</code>.</p>\n\n<p>If you add <code>{-# LANGUAGE KindSignatures #-}</code> to your extensions, you can then annotate <code>QUALITIES</code> with that kind signature and the rest will follow:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE MultiParamTypeClasses, DatatypeContexts, FlexibleInstances, KindSignatures #-}\n\ndata Step = Step   \nclass PHYSICAL_ENDURANTS physicalEndurant where   \nclass PHYSICAL_OBJECTS physicalEndurant where   \nclass QUALITIES (affordance :: * -&gt; *) physicalEndurant where \n\ninstance PHYSICAL_ENDURANTS Step where   \n\n\nclass ( QUALITIES affordance physicalEndurant\n      , PHYSICAL_ENDURANTS physicalEndurant\n      ) =&gt; AFFORDANCES affordance physicalEndurant\n\ndata PHYSICAL_OBJECTS step =&gt; Climbability step = Climbability step    \n\ninstance QUALITIES Climbability Step      \ninstance AFFORDANCES Climbability Step    \n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 9952780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2469a9716383b916f6db1205853858?s=128&d=identicon&r=PG&f=1", "display_name": "Patrick Browne", "link": "https://stackoverflow.com/users/9952780/patrick-browne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 1, "accepted_answer_id": 55764809, "answer_count": 1, "score": -1, "last_activity_date": 1555701461, "creation_date": 1555667980, "last_edit_date": 1555701461, "question_id": 55760059, "link": "https://stackoverflow.com/questions/55760059/can-this-haskell-code-be-compiled-as-written", "title": "Can this Haskell code be compiled as written?", "body": "<p>I am trying to compile some Haskell code from a <a href=\"https://www.researchgate.net/publication/221235046_Affordances_as_Qualities\" rel=\"nofollow noreferrer\">paper</a>.\nThe relevent textual description and listing from the <a href=\"https://www.researchgate.net/publication/221235046_Affordances_as_Qualities\" rel=\"nofollow noreferrer\">paper</a> are as follows.</p>\n\n<p><strong>Textual description</strong></p>\n\n<p>\"<em>We introduce AFFORDANCES as subclass of QUALITIES and exemplarily model\nClimbability as a type of AFFORDANCES which inheres in a Step. The constructor of QUALITIES requires a quality like climbability to always be defined with its host. The implementation of AFFORDANCES and Climbability is shown in Listing 1. .... The class AFFORDANCES, as specified in Listing 1 provides the specification\nhow to write an affordance in Haskell. Climbability implements this specification.</em>\"</p>\n\n<p><strong>Listing 1</strong></p>\n\n<pre><code>class (QUALITIES affordance physicalEndurant, PHYSICAL_ENDURANTS physicalEndurant) =&gt; AFFORDANCES affordance physicalEndurant\n\ndata PHYSICAL_OBJECTS step =&gt; Climbability step = Climbability step\n\ninstance QUALITIES  Climbability Step\ninstance AFFORDANCES Climbability Step\n</code></pre>\n\n<p>As it stands <strong>Listing 1</strong> is missing some definitions, which I have added to the code in <strong>Listing 2</strong>.</p>\n\n<p><strong>Listing 2</strong></p>\n\n<pre><code>{-#  LANGUAGE  MultiParamTypeClasses, DatatypeContexts,FlexibleInstances #-}\ndata Step =  Step\nclass  PHYSICAL_ENDURANTS physicalEndurant where\nclass  PHYSICAL_OBJECTS physicalEndurant where\nclass  QUALITIES affordance physicalEndurant where\n\ninstance  PHYSICAL_ENDURANTS (Climbability Step) where\ninstance  PHYSICAL_ENDURANTS Step where\n\nclass (QUALITIES affordance physicalEndurant,PHYSICAL_ENDURANTS physicalEndurant) =&gt; AFFORDANCES affordance physicalEndurant\n\ndata PHYSICAL_OBJECTS step =&gt; Climbability step = Climbability step\n-- extra arguments\ninstance QUALITIES  (Climbability Step) Step\ninstance AFFORDANCES (Climbability Step) Step\n</code></pre>\n\n<p>But to get <strong>Listing 2</strong> to compile I had to alter <strong>Listing 1</strong>, by adding extra arguments to the QUALITIES and AFFORDANCES instances. Am I missing some way to get the original code from the paper to compile?</p>\n"}, {"tags": ["haskell", "file-io", "io", "html-parsing", "lazy-evaluation"], "comments": [{"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "edited": false, "score": 1, "creation_date": 1555664435, "post_id": 55759120, "comment_id": 98193581, "body": "You need your <code>allEvents</code> have type <code>IO (Maybe [Url]) -&gt; IO ()</code>"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 11233868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b35236d2d69ac8929d874cbd8616bf8?s=128&d=identicon&r=PG&f=1", "display_name": "fata", "link": "https://stackoverflow.com/users/11233868/fata"}, "edited": false, "score": 0, "creation_date": 1555668843, "post_id": 55759372, "comment_id": 98195288, "body": "Thanks, this works and is actually also more intuitive and much simpler. I don&#39;t know why I didn&#39;t come up with this first. Instead of monadically composing the functions I thought just flushing the results of <code>allUrls</code> into <code>allEvents</code> should be fine. And also I thought it would be ok to build a list of IO actions and then force them to be evaluated."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 77, "user_id": 11233868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b35236d2d69ac8929d874cbd8616bf8?s=128&d=identicon&r=PG&f=1", "display_name": "fata", "link": "https://stackoverflow.com/users/11233868/fata"}, "edited": false, "score": 0, "creation_date": 1555669027, "post_id": 55759372, "comment_id": 98195356, "body": "That&#39;s a really fundamental thing to familiarise in Haskell: evaluating an IO action does <i>not</i> execute it; only monadically binding it to <code>main</code> does."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1555665042, "creation_date": 1555665042, "answer_id": 55759372, "question_id": 55759120, "link": "https://stackoverflow.com/questions/55759120/haskel-how-to-force-evaluation-of-functions-and-write-to-a-file-sequentially/55759372#55759372", "title": "Haskel: how to force evaluation of functions and write to a file sequentially?", "body": "<p>This is <em>not</em> a problem of lazy IO. Lazy IO is when you read a lazy string from a file, but don't evaluate it \u2013 the runtime will in this case defer the actual reading <em>until</em> you evaluate it.</p>\n\n<p>The problem is actually that you <em>don't do any IO</em> in <code>allEvents</code> \u2013 you're merely shoving around values in the <code>IO</code> <em>functor</em>. Those values happen to be <code>IO</code> actions themselves, but that doesn't matter. Specifally, <code>a &gt;&gt;= return . f</code> is always the same as just <code>fmap f a</code>, by the monad laws. And fmapping in IO does not bind actions.</p>\n\n<p>This problem is already observed in the type signature: <code>-&gt; IO (Maybe (IO [()]))</code> says that the function yields IO actions that you could then later execute. But in this case, you want to execute everything when you execute <code>allEvents</code>. So the signature could be</p>\n\n<pre><code>allEvents :: IO (Maybe [Url]) -&gt; IO ()\n</code></pre>\n\n<p>(or perhaps <code>-&gt; IO (Either EventExecError ())</code>, if you want to properly handle failure).</p>\n\n<p>This is probably still not what you want: why do you <em>take</em> an <code>IO</code> action as the argument? That means <code>allEvents</code> would itself need to execute that action to first fetch the URLs, before doing any work of its own. That could have its own side-effects and give different results for different calls, do you <em>want</em> that?</p>\n\n<p>I guess not, so really it should be</p>\n\n<pre><code>allEvents :: Maybe [Url] -&gt; IO ()\n</code></pre>\n\n<p>Now you start out with a plain <code>Maybe</code> value, which you can easily pattern-match on:</p>\n\n<pre><code>allEvents Nothing = ?  -- perhaps simply `return ()`\nallEvents (Just urls) = mapM_ doThings urls\n</code></pre>\n\n<p>To then use that in your program, you need to monadically bind the url-fetching to the event-executing:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  urlq &lt;- allUrls\n  allEvents urlq\n</code></pre>\n\n<p>...or short <code>allUrls &gt;&gt;= allEvents</code>.</p>\n"}], "owner": {"reputation": 77, "user_id": 11233868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b35236d2d69ac8929d874cbd8616bf8?s=128&d=identicon&r=PG&f=1", "display_name": "fata", "link": "https://stackoverflow.com/users/11233868/fata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 55759372, "answer_count": 1, "score": 3, "last_activity_date": 1555668862, "creation_date": 1555663803, "last_edit_date": 1555668862, "question_id": 55759120, "link": "https://stackoverflow.com/questions/55759120/haskel-how-to-force-evaluation-of-functions-and-write-to-a-file-sequentially", "title": "Haskel: how to force evaluation of functions and write to a file sequentially?", "body": "<p>I have a problem with lazy IO in Haskell. Despite reading other questions in that field, I couldn't figure out how to solve my specific case.</p>\n\n<p>I'm using the scalpel package to parse html. The usecase is simple: One site contains links to other sites which describe some kind of event. So I wrote the following structures (I left out some of the implementations here):</p>\n\n<pre><code>type Url = String\n\n-- function that parses all urls\nallUrls :: Url -&gt; IO (Maybe [Url])\n\ndata Event = Event { ... }\n\n-- function that parses an event\nparseEvent :: Url -&gt; IO (Maybe Event)\n\n-- function that writes the event to a file\ndoThings :: Url -&gt; IO ()\ndoThings url = return url &gt;&gt;= parseEvent &gt;&gt;= (appendFile \"/tmp/foo.txt\" . show)\n\n-- function that should take all urls and write their events to a file\nallEvents :: IO (Maybe [Url]) -&gt; IO (Maybe (IO [()]))\nallEvents urls = urls &gt;&gt;= return . liftM (mapM doThings)\n\n-- or alternatively:\n\n-- function that takes all urls and returns all events\nallEvents :: IO (Maybe [Url]) -&gt; IO (Maybe (IO [Maybe Event]))\nallEvents urls = urls &gt;&gt;= return . liftM (mapM parseEvent)\n\n-- some function that writes all events to a file\nallEventsToFile :: IO (Maybe (IO [Maybe Event])) -&gt; IO()\n??? \n</code></pre>\n\n<p>The doThings function works as expected. Given a url, it parses the corresponding event and writes it to the file. But allEvents does absolutely nothing because of laziness. How can I force the evaluation inside allEvents?</p>\n"}, {"tags": ["haskell", "function-call"], "answers": [{"comments": [{"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1555659030, "post_id": 55755903, "comment_id": 98191793, "body": "@RobinZigmond, I mentioned it in the comment, I just wanted to point that if he need to transform the input string it can be done there. Just to show the OP an example with 3 main points. 1, a funtion that does some operation, 2, the main loop and 3, the entry point."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1555659351, "post_id": 55755903, "comment_id": 98191892, "body": "Sorry @NetWave, I noticed that after posting, so deleted my current. But I still think it&#39;s confusing to a beginner - you say it &quot;wraps&quot; <code>getLine</code>, without defining what you mean by &quot;wraps&quot;, when it&#39;s in fact exactly the same."}], "tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": true, "score": 4, "last_activity_date": 1555659689, "last_edit_date": 1555659689, "creation_date": 1555641380, "answer_id": 55755903, "question_id": 55755738, "link": "https://stackoverflow.com/questions/55755738/haskell-how-do-you-make-a-loop-that-has-getline-within-it/55755903#55755903", "title": "Haskell - how do you make a loop that has getLine within it?", "body": "<p>You have to use the IO monad for your funtions, for making a loop you can just make a <strong>recursive call</strong>, check this example:</p>\n\n<pre><code>-- This just wraps the getLine funtion but you could operate over the input before return the final result\nprocessInput :: IO String\nprocessInput = do\n    line &lt;- getLine\n    return $ map toUpper line\n\n\n-- This is our main loop, it handles when to exit\nloop :: IO ()\nloop = do\n    line &lt;- processInput\n    putStrLn line\n    case line of\n        \"quit\"    -&gt; return ()\n        otherwise -&gt; loop\n\n-- main is the program entry point\nmain :: IO ()\nmain = do\n    putStrLn \"Welcome to the haskel input example\"\n    loop\n</code></pre>\n\n<p>Here you have the <a href=\"https://repl.it/repls/ViolentMotherlyFonts\" rel=\"nofollow noreferrer\">live example</a></p>\n"}], "owner": {"reputation": 41, "user_id": 11142287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_V3JaN-civg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rclLChAshnC_jXT58sSTSm6MKsN7w/mo/photo.jpg?sz=128", "display_name": "Faffy", "link": "https://stackoverflow.com/users/11142287/faffy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "accepted_answer_id": 55755903, "answer_count": 1, "score": 1, "last_activity_date": 1555659689, "creation_date": 1555639795, "last_edit_date": 1555640633, "question_id": 55755738, "link": "https://stackoverflow.com/questions/55755738/haskell-how-do-you-make-a-loop-that-has-getline-within-it", "title": "Haskell - how do you make a loop that has getLine within it?", "body": "<p>I want to create a loop which will take user input i.e. getLine, during each iteration of the loop. Is this possible within the main or by using the getLine function within a parameter pass or not at all? I'm relatively new to Haskell and I've gotten my head around most of it but this I'm not certain about. Obviously pattern matching will be used to exit it, but how could I get the user input. I've attempted to figure this out myself but each time failing. Thanks in advance.</p>\n"}, {"tags": ["haskell", "typeclass", "type-constraints", "higher-kinded-types"], "answers": [{"comments": [{"owner": {"reputation": 769, "user_id": 6155692, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0e4ef26e040c1b1fbc5f10777e5b0649?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/6155692/zac"}, "edited": false, "score": 0, "creation_date": 1555608544, "post_id": 55750994, "comment_id": 98178745, "body": "Well the reason I introduced the type parameter was initially so I could make it an instance of <code>Foldable</code>. But it&#39;s used elsewhere (e.g. another function: <code>toList :: Integral a =&gt; PrimeSet a -&gt; [a]</code>), though this isn&#39;t actually needed because it would work just as well on an unparameterised <code>PrimeSet</code> type. The reason the type is declared as <code>P Integer</code> isn&#39;t because the set itself stores an integer, but in fact because the <code>Integer</code> value actually encodes a set of any amount of <code>Integral</code> values, if that makes sense."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 769, "user_id": 6155692, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0e4ef26e040c1b1fbc5f10777e5b0649?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/6155692/zac"}, "edited": false, "score": 1, "creation_date": 1555608637, "post_id": 55750994, "comment_id": 98178784, "body": "Ok. Well, ditch the <code>a</code> parameter then and make it simply <code>instance MonoFoldable PrimeSet</code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1555608516, "last_edit_date": 1555608516, "creation_date": 1555608212, "answer_id": 55750994, "question_id": 55750523, "link": "https://stackoverflow.com/questions/55750523/is-it-possible-to-enforce-a-type-constraint-on-a-class-instance-for-a-higher-kin/55750994#55750994", "title": "Is it possible to enforce a type constraint on a class instance for a higher-kinded type?", "body": "<p>No, this is not possible. The whole point of higher-kinded types is to work over <em>any</em> parameter type. Whereas <code>PrimeSet</code> isn't really parametric at all \u2013 basically, it's <em>always</em> <code>PrimeSet Integer</code>. Why do you have that <code>a</code> parameter at all?</p>\n\n<p>There is however a different class for types that are \u201ckinda containers\u201d, but not for arbitrary types: <a href=\"http://hackage.haskell.org/package/mono-traversable\" rel=\"nofollow noreferrer\">MonoTraversable</a>, or actually <a href=\"http://hackage.haskell.org/package/mono-traversable-1.0.11.0/docs/Data-MonoTraversable.html#t:MonoFoldable\" rel=\"nofollow noreferrer\">MonoFoldable</a> in this case.</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, TypeFamilies #-}\n\nimport Data.MonoTraversable\n\ntype instance Element (PrimeSet a) = a\n-- or, if `PrimeSet` is not parameterised,\n-- type instance Element PrimeSet = Integer\n\ninstance (Integral a) =&gt; MonoFoldable (PrimeSet a) where\n  otoList = YourImplementation.toList\n</code></pre>\n\n<p>An alternative would be that you do use parameterised types, functors in fact, but not in the normal <strong>Hask</strong> category of <em>all</em> Haskell types but only in the subcategory whose type<del>s</del> <del>are</del>is <code>Integer</code>. I have such a class <a href=\"http://hackage.haskell.org/package/constrained-categories-0.3.1.1/docs/Data-Foldable-Constrained.html\" rel=\"nofollow noreferrer\">in my constrained-categories package</a>. But, especially for this type you have, this really doesn't seem to make any sense.</p>\n"}, {"tags": [], "owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "is_accepted": false, "score": 2, "last_activity_date": 1555614272, "creation_date": 1555614272, "answer_id": 55752339, "question_id": 55750523, "link": "https://stackoverflow.com/questions/55750523/is-it-possible-to-enforce-a-type-constraint-on-a-class-instance-for-a-higher-kin/55752339#55752339", "title": "Is it possible to enforce a type constraint on a class instance for a higher-kinded type?", "body": "<p>You can use a GADT to constrain the parameter type:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE GADTs #-}\n\ndata PrimeSet a where\n    PrimeSet :: Integral a =&gt; Integer -&gt; PrimeSet a\n\ninstance Foldable PrimeSet where\n    foldr f b (PrimeSet x) = f (fromInteger x) b\n</code></pre>\n\n<p>You could generalise a little with ConstraintKinds (and the monofoldable class):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Monomorphic f c a where\n    Monomorphic :: c a =&gt; f -&gt; Monomorphic f c a\n\ninstance (item ~ Item f, MonoFoldable f) =&gt; Foldable (Monomorphic f ((~) item)) where\n    foldr f b (Monomorphic xs) = ofoldr f b xs\n\ndata PrimeSet = PrimeSet Integer\n\ninstance Foldable (Monomorphic PrimeSet Integral) where\n    foldr f b (Monomorphic (PrimeSet i)) = f (fromInteger i) b\n</code></pre>\n"}], "owner": {"reputation": 769, "user_id": 6155692, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0e4ef26e040c1b1fbc5f10777e5b0649?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/6155692/zac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 55750994, "answer_count": 2, "score": 3, "last_activity_date": 1555614272, "creation_date": 1555606084, "question_id": 55750523, "link": "https://stackoverflow.com/questions/55750523/is-it-possible-to-enforce-a-type-constraint-on-a-class-instance-for-a-higher-kin", "title": "Is it possible to enforce a type constraint on a class instance for a higher-kinded type?", "body": "<p>I have a type defined like this:</p>\n\n<pre><code>newtype PrimeSet a = P Integer\n    deriving Eq\n</code></pre>\n\n<p>I have also defined a function which converts a prime set to a list, given that its type parameter is an <code>Integral</code>.</p>\n\n<pre><code>toList :: Integral a =&gt; PrimeSet a -&gt; [a]\n</code></pre>\n\n<p>I now what to give <code>PrimeSet</code> a <code>Foldable</code> instance, so this was my first attempt (after importing <code>fold</code> from <code>Data.Foldable</code>):</p>\n\n<pre><code>instance Foldable PrimeSet where\n    foldMap f = fold . map f . toList\n</code></pre>\n\n<p>This didn't work, however, and the compiler told me that it <code>Could not deduce (Integral a) arising from a use of \u2018toList\u2019</code>. My understanding of this message is that <code>toList</code> requires its argument to be an <code>Integral a =&gt; PrimeSet a</code> type, but this isn't necessarily the case in the <code>Foldable</code> instance.</p>\n\n<p>The message also said that a possible fix would be to add <code>Integral a</code> to the context of the type signature for my <code>foldMap</code> implementation, but of course I was then told that I'm not allowed to provide my own type definitons for class methods unless I use <code>InstanceSigs</code>, so I tried that but that didn't seem to work either.</p>\n\n<p>So my question is this: is it possible to add a type constraint to a class instance if the type parameter of the type I'm writing the class instance for is hidden - or, to reiterate, can I do something like this?</p>\n\n<pre><code>instance (Integral a) =&gt; Foldable (PrimeSet a) where\n</code></pre>\n\n<p>(This of course doesn't work because <code>PrimeSet a</code> has the kind <code>*</code> whereas <code>Foldable</code> requires <code>* -&gt; *</code>)</p>\n"}, {"tags": ["list", "sorting", "haskell", "merge"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1555599381, "post_id": 55748612, "comment_id": 98174169, "body": "please include your code for merging <i>two</i> sorted lists, so it can be used as a starting point."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 4, "creation_date": 1555599475, "post_id": 55748612, "comment_id": 98174230, "body": "Why do you need a merge for three sorted lists?"}, {"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 1, "creation_date": 1555599650, "post_id": 55748612, "comment_id": 98174340, "body": "This is not exhaustive, you miss when exactly one list is empty, e.g. <code>merge [] (y:ys) (z:zs)</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 3, "creation_date": 1555601200, "post_id": 55748612, "comment_id": 98175227, "body": "@WillNess, I think it&#39;s a tad early for that, especially considering this is a new person."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1555601241, "post_id": 55748612, "comment_id": 98175259, "body": "<code>mergeThreeLists x y z = mergeTwoLists x (mergeTwoLists y z)</code>"}, {"owner": {"reputation": 1, "user_id": 11331591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f0830842771df1810c60e250145ed83?s=128&d=identicon&r=PG&f=1", "display_name": "Math askers510520", "link": "https://stackoverflow.com/users/11331591/math-askers510520"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1555601367, "post_id": 55748612, "comment_id": 98175326, "body": "@AJFarmar can u give me more details?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1555601385, "post_id": 55748612, "comment_id": 98175342, "body": "@Cubic cf. <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2007-July/029391.html\" rel=\"nofollow noreferrer\">mail.haskell.org/pipermail/haskell-cafe/2007-July/029391.htm&zwnj;&#8203;l</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1555601500, "post_id": 55748612, "comment_id": 98175400, "body": "@AJFarmar just gave you the whole code. I&#39;m not sure how to make that more detailed."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1555601535, "post_id": 55748612, "comment_id": 98175417, "body": "@Mathaskers510520 There are no more details to give\u2014I have shown you the full implementation."}, {"owner": {"reputation": 1, "user_id": 11331591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f0830842771df1810c60e250145ed83?s=128&d=identicon&r=PG&f=1", "display_name": "Math askers510520", "link": "https://stackoverflow.com/users/11331591/math-askers510520"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1555601719, "post_id": 55748612, "comment_id": 98175545, "body": "@WillNess Thanks for the website, it helps!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1555601745, "post_id": 55748612, "comment_id": 98175560, "body": "@dfeuer OK. undv&#39;ed."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1555601446, "post_id": 55749262, "comment_id": 98175377, "body": "... and <i>only then</i>, inline, fuse and optimize! :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1555601577, "post_id": 55749262, "comment_id": 98175441, "body": "@WillNess, yeah, sure. But that seems like overkill for this exercise."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1555601291, "creation_date": 1555601291, "answer_id": 55749262, "question_id": 55748612, "link": "https://stackoverflow.com/questions/55748612/haskell-how-to-continue-to-code-merge-sorted-a-three-lists/55749262#55749262", "title": "Haskell - How to continue to code &quot;merge Sorted&quot; a three lists", "body": "<p>You know how to merge two sorted lists. Now just do it twice.</p>\n"}], "owner": {"reputation": 1, "user_id": 11331591, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f0830842771df1810c60e250145ed83?s=128&d=identicon&r=PG&f=1", "display_name": "Math askers510520", "link": "https://stackoverflow.com/users/11331591/math-askers510520"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1555603494, "creation_date": 1555599076, "last_edit_date": 1555603494, "question_id": 55748612, "link": "https://stackoverflow.com/questions/55748612/haskell-how-to-continue-to-code-merge-sorted-a-three-lists", "title": "Haskell - How to continue to code &quot;merge Sorted&quot; a three lists", "body": "<p>I know how to merge two sorted lists in Haskell, however, I have no idea how to merge three sorted lists. I wrote some code, what should I do next?</p>\n\n<p>I am really new for Haskell programming, I watched the \"Learn You a Haskell for Great Good!\" as a start to learn Haskell. I've tried to follow the format of two sorted lists merge:</p>\n\n<pre><code>mergeS :: (Ord a) =&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]\nmergeS [] [] [] = []\nmergeS (x:xs) [] [] = (x:xs)\nmergeS [] (y:ys) [] = (y:ys)\nmergeS [] [] (z:zs) = (z:zs)\nmergeS (x:xs) (y:ys) (z:zs) -- I do not know how to write from here\n</code></pre>\n\n<p>The correct answer will be somethinig like:</p>\n\n<p>mergeS :: (Ord a) => [a] -> [a] -> [a] -> [a]</p>\n\n<p>mergeTwoLists :: Ord a => [a] -> [a] -> [a]</p>\n\n<p>...</p>\n\n<p>mergeS x y z = mergeTwoLists x (mergeTwoLists y z)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1555606560, "post_id": 55747551, "comment_id": 98177880, "body": "What about <code>foo (Proxy @Char)</code> and <code>foo (Proxy @&#39;True)</code>? There <code>k</code> should be inferred correctly. I don&#39;t think there&#39;s a way to leave some type arguments inplicit and some explicit in functions like we can instead do for constructors (like <code>Proxy</code>, which is polykinded but leaves <code>k</code> implicit, AFAICS). In Coq/Agda the implicit/explicit stuff can be controlled more easily, but in Haskell we don&#39;t have the same tools."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1555607038, "post_id": 55747551, "comment_id": 98178126, "body": "@chi That would work, but make my actual API more cumbersome to use. I have invocations like <code>insertI @&quot;name&quot; 5</code>."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 2, "creation_date": 1555635801, "post_id": 55747551, "comment_id": 98186938, "body": "Due to GHC Proposal #26: &quot;Explicit Specificity&quot;, you should be able to write <code>class Foo (a :: k) where { foo&#39; :: Int }; foo :: forall {k :: Type} (a :: k). Foo a =&gt; Int; foo = foo&#39; @k @a</code> at some point in the future. Not making this an answer as it doesn&#39;t work in current GHC Haskell. Fun fact, the signature of <code>foo</code> looks uncannily like the one given as an example in the <a href=\"https://github.com/ghc-proposals/ghc-proposals/blob/master/proposals/0026-explicit-specificity.rst\" rel=\"nofollow noreferrer\">proposal itself</a>."}], "answers": [{"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1555599861, "post_id": 55748623, "comment_id": 98174461, "body": "Thanks. However,  my real use case relies on <code>-XAllowAmbiguousTypes</code>\u2014type applications are required for all methods. Having to add <code>@_</code> to each invocation would greatly hamper usability."}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 3, "last_activity_date": 1555599120, "creation_date": 1555599120, "answer_id": 55748623, "question_id": 55747551, "link": "https://stackoverflow.com/questions/55747551/controlling-type-application-order-in-poly-kinded-typeclasses/55748623#55748623", "title": "Controlling type application order in poly-kinded typeclasses", "body": "<p>You can write <code>@_</code> and let GHC infer the kind argument: <code>foo @_ @True Proxy</code></p>\n\n<p>I believe the order of type applications is always the order that type variables appear in the output of <code>:t</code>.  </p>\n\n<p>For example, <code>:t foo</code> gives <code>foo :: forall k (a :: k). Foo a =&gt; Proxy a -&gt; Int</code>, where <code>k</code> appears in the <code>forall</code> before the first <code>a</code>.</p>\n"}], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1555608862, "creation_date": 1555595651, "last_edit_date": 1555608862, "question_id": 55747551, "link": "https://stackoverflow.com/questions/55747551/controlling-type-application-order-in-poly-kinded-typeclasses", "title": "Controlling type application order in poly-kinded typeclasses", "body": "<p>I'm using GHC 8.4.2. I have this typeclass:</p>\n\n<pre><code>{-# LANGUAGE DataKinds, PolyKinds, TypeApplications #-}\nimport Data.Kind (Type)\nimport Data.Proxy\n\nclass Foo (a :: k) where\n    foo :: Proxy a -&gt; Int\n\ninstance Foo True where\n    foo _ = 0\n\ninstance Foo Char where\n    foo _ = 0\n</code></pre>\n\n<p>It's a much simplified version of the real case, which needs to be poly-kinded.</p>\n\n<p>When I try to use <code>TypeApplications</code> with the <code>foo</code> method, turns out that I need to specify the kind <code>k</code> as the first type parameter, otherwise it won't work:</p>\n\n<pre><code>ghci&gt; :t foo @Type @Char\nfoo @Type @Char :: Proxy Char -&gt; Int\n\nghci&gt; :t foo @Bool @True\nfoo @Bool @True :: Proxy 'True -&gt; Int\n</code></pre>\n\n<p>Having to specify the kind as the first type parameter is quite annoying for my real use-case. The kind is determined by the second type parameter anyway.</p>\n\n<p>Is there a way of not having to supply the kind first, or even of not having to supply it at all, while still remaining poly-kinded?</p>\n\n<p>Additionally, is there a way of knowing the correct order of type applications for a class method, when using ghci?</p>\n\n<p><strong>Edit.</strong> The extra argument disappears when I don't explicitly name the kind, for example:</p>\n\n<pre><code>class Foo (a :: k) where\n    foo :: Proxy a -&gt; Int\n\n*Main&gt; :set -fprint-explicit-foralls\n*Main&gt; :t +v foo\nfoo :: forall k (a :: k). Foo a =&gt; Proxy a -&gt; Int\n\nclass Foo a where\n    foo :: Proxy a -&gt; Int\n\n*Main&gt; :set -fprint-explicit-foralls\n*Main&gt; :t +v foo\nfoo :: forall {k} (a :: k). Foo a =&gt; Proxy a -&gt; Int\n</code></pre>\n\n<p>In this last version we only need to provide a single type argument. <code>{k}</code> seems to mean that the kind is inferred.</p>\n\n<p>Alas, I need to name the kind because in my real signatures I need to say \"this type has the same kind as this other type, whatever that is\".</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1555594618, "post_id": 55747113, "comment_id": 98171281, "body": "A full answer will take longer than I have at the moment (but I&#39;m sure someone else will provide one soon). But your parse error in Attempt 2 is because you have an <code>if ... then</code> statement with no <code>else</code>"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1555594665, "creation_date": 1555594665, "answer_id": 55747248, "question_id": 55747113, "link": "https://stackoverflow.com/questions/55747113/haskell-function-on-list-of-tuples/55747248#55747248", "title": "Haskell function on list of tuples", "body": "<p>You are currently trying to iterate over your return value as if it were an argument. You need to make the recursive call first, <em>then</em> update that result</p>\n\n<pre><code>simplify [] = []\nsimplify (x:xs) = let recursive_result = simplify xs\n                      update n pairs = ...\n                  in update x recursive_result\n</code></pre>\n\n<p>where <code>...</code> is where you try to find and replace the pair which already contains <code>x</code>, or add a new pair.</p>\n\n<p>Hint: the builtin <code>lookup</code> function would help, if you can convince your teacher to let you use it.</p>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 11372625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26f5fb2bbbe8f1060006686c1d94fe5?s=128&d=identicon&r=PG&f=1", "display_name": "mushishi", "link": "https://stackoverflow.com/users/11372625/mushishi"}, "is_accepted": true, "score": 0, "last_activity_date": 1556121496, "creation_date": 1556121496, "answer_id": 55834171, "question_id": 55747113, "link": "https://stackoverflow.com/questions/55747113/haskell-function-on-list-of-tuples/55834171#55834171", "title": "Haskell function on list of tuples", "body": "<p>First of all, thanks to all respondents. I will answer all my questions here and at the end of the answer provide a (spoiler) sample solution.</p>\n\n<blockquote>\n  <ol>\n  <li>What is the correct syntax to iterate over tuples in a list? </li>\n  </ol>\n</blockquote>\n\n<p>Lists should not be iterated over. To write a function on such a data structure, </p>\n\n<blockquote>\n  <p>function_name ((element1, element2, ..., elementN):some_list) = <em>result</em></p>\n</blockquote>\n\n<p>My error was that I disregarded the binding priority of the list creation constructor : and function application.</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Can you explain why I get both parser errors?</li>\n  </ol>\n</blockquote>\n\n<p>Answered already. </p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Why does Haskell forbid code like the following:</li>\n  </ol>\n</blockquote>\n\n<p>Explained by chepner. </p>\n\n<blockquote>\n  <ol start=\"4\">\n  <li>Which case(s) am I missing?</li>\n  </ol>\n</blockquote>\n\n<p>The case that there are 1-element-lists. </p>\n\n<blockquote>\n  <ol start=\"5\">\n  <li>Is it possible to catch the error at compile time?</li>\n  </ol>\n</blockquote>\n\n<p>Possible by using <a href=\"https://hackage.haskell.org/package/HTF\" rel=\"nofollow noreferrer\">HTF</a>.  </p>\n\n<p>SPOILER ALERT\nAnd here comes my <strong>Attempt 5</strong>:</p>\n\n<pre><code>simplify :: [ Int ] -&gt; [( Int , Int )]\nsimplify [] = []\nsimplify (x:xs) = let recursive_result = simplify xs\n                  update n [] = [(n, 1)]\n                  update n ((a, b):pairs) = \n                      if n == a then ((a, b + 1):pairs)\n                      else (a, b):(update n pairs)\n              in update x recursive_result\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 11372625, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c26f5fb2bbbe8f1060006686c1d94fe5?s=128&d=identicon&r=PG&f=1", "display_name": "mushishi", "link": "https://stackoverflow.com/users/11372625/mushishi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1135, "favorite_count": 0, "accepted_answer_id": 55834171, "answer_count": 2, "score": 0, "last_activity_date": 1556121496, "creation_date": 1555594211, "last_edit_date": 1555940704, "question_id": 55747113, "link": "https://stackoverflow.com/questions/55747113/haskell-function-on-list-of-tuples", "title": "Haskell function on list of tuples", "body": "<p>Task (home assignment) : Given a list of integers, return a list of tuples where each tuple in the list has the form (int_val, val_freq). No built-in functions are allowed. Allowed operators: :, ++.</p>\n\n<p>Attempt 1: </p>\n\n<pre><code>simplify :: [ Int ] -&gt; [( Int , Int )]\nsimplify [] = []\nsimplify ((x:xs) ++ [(a, b)]) = \n  if x == a then (simplify xs ++ [(x, b + 1)])\n  else  (simplify xs ++ [(x, 0)])\n</code></pre>\n\n<p>Attempt 2: </p>\n\n<pre><code>naive_enumerate :: [ Int ] -&gt; [( Int , Int )]\nnaive_enumerate [] = []\nnaive_enumerate x:xs = \n  if x == y then [(y, 1)] ++ naive_enumerate xs\n\nenumerate_tuple_list :: [( Int , Int )] -&gt; [( Int , Int )]\nenumerate_tuple_list [] = []\nenumerate_tuple_list ((a, b):(c, d):rest) = \n  if (a == c) then (a, b+d):(enumerate_tuple_list rest)\n  else (a, b+d):(enumerate_tuple_list rest)\n\n\nsimplify :: [ Int ] -&gt; [( Int , Int )]\nsimplify some_list = enumerate_tuple_list (naive_enumerate some_list)\n</code></pre>\n\n<p>Expected: For e.g. input of [1, 2, 2, 3] an output of [(1,1), (2, 2), (3,1)]. \nActual result: in attempt 1, I got an error at </p>\n\n<blockquote>\n  <p>simplify ((x:xs) ++ [(a, b)]) = </p>\n</blockquote>\n\n<p>In attempt 2, my parse error occurs at </p>\n\n<blockquote>\n  <p>enumerate_tuple_list :: [( Int , Int )] -> [( Int , Int )]</p>\n</blockquote>\n\n<p>Questions: </p>\n\n<ol>\n<li><p>What is the correct syntax to iterate over tuples in a list? </p></li>\n<li><p>Can you explain why I get both parser errors?</p></li>\n<li><p>Why does Haskell forbid code like the following:</p>\n\n<p>naive_enumerate x:xs = [(x, 1)] ++ naive_enumerate xs</p></li>\n</ol>\n\n<p><strong>Update: Attempt 3:</strong> Thanks to the suggestions so far, I now have</p>\n\n<pre><code>simplify :: [ Int ] -&gt; [( Int , Int )]\nsimplify [] = []\nsimplify (x:xs) = let recursive_result = simplify xs\n                  update n ((a, b):pairs) = \n                      if n == a then ((a, b + 1):pairs)\n                      else ((n, 1):pairs)\n                  in update x recursive_result\n</code></pre>\n\n<p>Now the code compiles, but I get the following error: </p>\n\n<blockquote>\n  <p>Exception: ... Non-exhaustive patterns in function update</p>\n</blockquote>\n\n<p>Hence the additional questions: </p>\n\n<ol start=\"4\">\n<li><p>Which case(s) am I missing? </p></li>\n<li><p>Is it possible to catch the error at compile time (debug/verbose options don't do the trick)?  </p></li>\n</ol>\n"}, {"tags": ["haskell", "functional-programming", "lambda-calculus"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1555586558, "post_id": 55744881, "comment_id": 98166672, "body": "<code>beta (Apply (Lambda x m) n) = .... ++ [(Apply (Lambda x n) m) | m &lt;- beta m] ++ ...</code> looks wrong to me. You swapped <code>n</code> with <code>m</code>? The rest of the line suffers form the same problem."}, {"owner": {"reputation": 17, "user_id": 5380134, "user_type": "registered", "profile_image": "https://graph.facebook.com/634477866654806/picture?type=large", "display_name": "Jack Barber", "link": "https://stackoverflow.com/users/5380134/jack-barber"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1555587417, "post_id": 55744881, "comment_id": 98167117, "body": "Didn&#39;t clock that at all, thanks!"}], "owner": {"reputation": 17, "user_id": 5380134, "user_type": "registered", "profile_image": "https://graph.facebook.com/634477866654806/picture?type=large", "display_name": "Jack Barber", "link": "https://stackoverflow.com/users/5380134/jack-barber"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 527, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1555586272, "creation_date": 1555586272, "question_id": 55744881, "link": "https://stackoverflow.com/questions/55744881/unable-to-get-a-fully-complete-beta-reduction-in-haskell", "title": "Unable to get a fully complete beta reduction in Haskell", "body": "<p>I'm currently trying to implement beta reduction in Haskell, and I'm having a small problem. I've managed to figure out the majority of it, however as it is now I'm getting one small error when I test and I can't figure out how to fix it.</p>\n\n<p>The code uses a custom datatype, Term and a substitution function which I defined beforehand, both of these will be below.</p>\n\n<pre><code>--Term datatype\ndata Term = Variable Var | Lambda Var Term | Apply Term Term\n\n--Substitution function\nsubstitute :: Var -&gt; Term -&gt; Term -&gt; Term\nsubstitute x n (Variable m)\n    |(m == x) = n\n    |otherwise = (Variable m)\nsubstitute x n (Lambda m y)\n    |(m == x) = (Lambda m y)\n    |otherwise = (Lambda z (substitute x n (rename m z y)))\n    where z = fresh (merge(merge(used y) (used n)) ([x]))\nsubstitute x n (Apply m y) = Apply (substitute x n m) (substitute x n y)\n\n--Beta reduction\nbeta :: Term -&gt; [Term]\nbeta (Variable x) = []\nbeta (Lambda x y) =  map (Lambda x) (beta y)\nbeta (Apply (Lambda x m) n) = [(substitute x n m)] ++ [(Apply (Lambda x n) m) | m &lt;- beta m] ++ [(Apply (Lambda x z) m) | z &lt;- beta n]\nbeta (Apply x y) = [Apply x' y | x' &lt;- beta x] ++ (map (Apply x) (beta y))\n</code></pre>\n\n<p>The expected outcome is as follows:</p>\n\n<pre><code>*Main&gt; Apply example (numeral 1)\n(\\a. \\x. (\\y. a) x b) (\\f. \\x. \\f. x)\n*Main&gt; beta it\n[\\c. (\\b. \\f. \\x. \\f. x) c b,(\\a. \\x. a b) (\\f. \\x. f x)]\n</code></pre>\n\n<p>However this is my outcome:</p>\n\n<pre><code>*Main&gt; Apply example (numeral 1)\n(\\a. \\x. (\\y. a) x b) (\\f. \\x. \\f. x)\n*Main&gt; beta it\n[\\c. (\\b. \\f. \\x. \\f. x) c b,(\\a. \\f. \\x. \\f. x) (\\x. a b)]\n</code></pre>\n\n<p>Any help would be much appreciated.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 685, "user_id": 4961930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dca9291fdc7f227e71e0ee6b0127ce7?s=128&d=identicon&r=PG&f=1", "display_name": "duyue", "link": "https://stackoverflow.com/users/4961930/duyue"}, "edited": false, "score": 0, "creation_date": 1555577068, "post_id": 55741958, "comment_id": 98161486, "body": "Could you provide full error logs?"}, {"owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "reply_to_user": {"reputation": 685, "user_id": 4961930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dca9291fdc7f227e71e0ee6b0127ce7?s=128&d=identicon&r=PG&f=1", "display_name": "duyue", "link": "https://stackoverflow.com/users/4961930/duyue"}, "edited": false, "score": 0, "creation_date": 1555577662, "post_id": 55741958, "comment_id": 98161838, "body": "illegal instruction is the full error log, it&#39;s not a compile time error"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1555581751, "post_id": 55741958, "comment_id": 98164118, "body": "It looks as if the compiler used some CPU instruction which is available on your first machine but not the other one. If those are linux, you could compare <code>cat &#47;proc&#47;cpuinfo</code> and observe that some flags are different, pointing to some missing instruction. Also try <code>file yourExecutable</code> to confirm it&#39;s really a <code>ELF 64-bit LSB executable, x86-64</code>. I don&#39;t know how to create a more generic binary, however. Maybe you need some llvm flags (if ghc is going through llvm)."}, {"owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "edited": false, "score": 0, "creation_date": 1555584024, "post_id": 55741958, "comment_id": 98165318, "body": "Yes, my local cpu is much more recent than the server&#39;s one. I did check with file that the binary is a regular 64 bit executable, it is, I just have no idea how to tell cabal build to use -march=generic -mtune=generic basically, as I would do in C"}, {"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1555594654, "post_id": 55741958, "comment_id": 98171306, "body": "You would need to build GHC compiler and library for the target environment. There is a fair amount of information if you search for &quot;cross-compiling Haskell&quot;."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1555602911, "post_id": 55741958, "comment_id": 98176182, "body": "Can you try to locate the illegal instruction? You can use <a href=\"https://stackoverflow.com/a/40223712/5684257\">this procedure</a>, maybe."}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 0, "last_activity_date": 1555595119, "creation_date": 1555595119, "answer_id": 55747388, "question_id": 55741958, "link": "https://stackoverflow.com/questions/55741958/illegal-instruction-haskell/55747388#55747388", "title": "Illegal instruction - haskell", "body": "<p>Unlike with GCC, the GHC compiler has only a handful of options to tune instruction sets, and they're <em>all off by default.</em>  The complete list is:</p>\n\n<pre><code>-msse -msse2 -msse3 -msse4 -msse4.2 -mbmi -mbmi2 -mavx -mavx2\n-mavx512cd -mavx512er -mavx512f -mavx512pf\n</code></pre>\n\n<p>but there's no corresponding <code>-mno-sse</code> or similar options to turn them off because, like I say, they're off by default.  (Well, actually, on the x86_64 architecture, the <code>-msse</code> and <code>-msse2</code> flags are technically forced on and can't be disabled.) </p>\n\n<p>So, the problem is probably something else, most likely an incompatible or corrupt library.  It might be helpful to run under <code>gdb</code> to get a backtrace and see if you can spot a suspicious library or other obvious cause.</p>\n"}], "owner": {"reputation": 825, "user_id": 962828, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/78c370f00a14fb3bd59dc334082378cd?s=128&d=identicon&r=PG", "display_name": "Ulrar", "link": "https://stackoverflow.com/users/962828/ulrar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1555595119, "creation_date": 1555575876, "question_id": 55741958, "link": "https://stackoverflow.com/questions/55741958/illegal-instruction-haskell", "title": "Illegal instruction - haskell", "body": "<p>I am building using the regular <code>cabal build</code> on my local machine, and the binary works fine. But when I copy the binary to another server for tests (same architecture : x86_64 and same glic and so on, as afar as I can tell) I get illegal instruction when I try to run it.</p>\n\n<p>Is there some flag I should pass to cabal to make it compile a more generic binary maybe ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 2, "creation_date": 1555572049, "post_id": 55740973, "comment_id": 98159113, "body": "Do you mean like <code>traverse_</code>, <code>mapM_</code>, etc.?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 4, "creation_date": 1555572477, "post_id": 55740973, "comment_id": 98159294, "body": "It&#39;s briefly mentioned under &quot;naming conventions&quot; here:  <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.12.0.0/docs/&hellip;</a> Essentially it&#39;s used to mean that the &quot;result&quot; of a monadic value/action is ignored, the action being used purely for its &quot;side effects&quot;. (Quotes are because this is strictly true only for IO, where I think the distinction is easier to understand - for other, &quot;pure&quot; Monads/Applicatives, it&#39;s more of an analogy.)"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1555574606, "post_id": 55740973, "comment_id": 98160275, "body": "@RobinZigmond I wouldn&#39;t call it an analogy, so much as a generalization. It means &quot;for its Applicative effects&quot;, where for IO that effect is often called a side effect."}], "answers": [{"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 3, "creation_date": 1555638890, "post_id": 55741086, "comment_id": 98187395, "body": "Returning <code>()</code> is also sometimes &quot;easier&quot;. <code>traverse_</code>, for example, only requires a <code>Foldable</code> collection, because the collection does not need to be rebuilt in the new context, even though <code>traverse</code> requires <code>Traversable</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1566706797, "post_id": 55741086, "comment_id": 101737692, "body": "It can also have a substantial performance impact. <code>traverse</code> has to hold on to the pieces it needs to build the result, while <code>traverse_</code> can just throw them away as it goes."}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 12, "last_activity_date": 1566640051, "last_edit_date": 1566640051, "creation_date": 1555572406, "answer_id": 55741086, "question_id": 55740973, "link": "https://stackoverflow.com/questions/55740973/what-does-underscore-at-the-end-of-the-function-mean-in-haskell/55741086#55741086", "title": "What does underscore at the end of the function mean in Haskell?", "body": "<p>It's just a naming convention in the Prelude. Generally, the functions without an underscore (e.g. <code>traverse</code>, <code>sequence</code>, <code>mapM</code>) return some meaningful 'aggregate' value, whereas the counterparts with an underscore (e.g. <code>traverse_</code>, <code>sequence_</code>, <code>mapM_</code>) return <code>()</code>. Usually you would use the first set of functions, but if you don't care about the return value then you would use the second set of functions. The reason for this is that these functions are usually monadic; if you use a function returning <code>()</code> in a monadic context but ignore the return value, GHC does not give a warning (since it will always return <code>()</code>), but GHC does warn you if the function does give a meaningful return value which you ignore. So e.g. <code>do { sequence [print 1,print 2,print 3]; putStrLn \"ignoring prev value\" }</code> will give a warning, but <code>do { sequence_ [print 1,print 2,print 3]; putStrLn \"ignoring prev value\" }</code> will not.</p>\n"}], "owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 55741086, "answer_count": 1, "score": 2, "last_activity_date": 1566640051, "creation_date": 1555571976, "last_edit_date": 1555574793, "question_id": 55740973, "link": "https://stackoverflow.com/questions/55740973/what-does-underscore-at-the-end-of-the-function-mean-in-haskell", "title": "What does underscore at the end of the function mean in Haskell?", "body": "<p>I noticed some function names ending with <code>_</code> in Haskell (e.g. <code>mapM_</code>, <code>traverse_</code>).</p>\n\n<p>What does it mean?</p>\n"}]