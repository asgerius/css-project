[{"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1573748300, "post_id": 58847402, "comment_id": 103993469, "body": "That&#39;s cool. But is there a way to do a <code>case</code> on the output of a function?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1573748520, "post_id": 58847402, "comment_id": 103993603, "body": "@Jonathan Bind it into a variable with <code>&lt;-</code> and then case-match on said variable."}, {"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1573750112, "post_id": 58847402, "comment_id": 103994633, "body": "I updated my question with the code I have so far. I think maybe it&#39;s not working because I need to do error handling first? Or there&#39;s something else wrong."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1573753821, "post_id": 58847402, "comment_id": 103996667, "body": "@Jonathan Try the new <code>translate</code> function that I just edited into my answer."}, {"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1573754068, "post_id": 58847402, "comment_id": 103996800, "body": "Awesome. Could you say what the <code>&lt;$&gt;</code> is doing here?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1573754335, "post_id": 58847402, "comment_id": 103996926, "body": "@Jonathan It&#39;s also known as <code>fmap</code>, which is an operation on functors. It does something slightly different for every functor. I&#39;m using it on the <code>Maybe</code> functor here, for which it lets you apply a function to the inside if it&#39;s <code>Just</code>. It&#39;s looking at what <code>response</code> is, and changing it to <code>Just (lineToText x)</code> if it&#39;s <code>Just x</code>, or leaving it as <code>Nothing</code> if it&#39;s <code>Nothing</code>."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1573753802, "last_edit_date": 1573753802, "creation_date": 1573689390, "answer_id": 58847402, "question_id": 58847196, "link": "https://stackoverflow.com/questions/58847196/in-turtle-haskell-how-can-i-get-the-output-of-a-command-and-do-something-wit/58847402#58847402", "title": "In Turtle (Haskell), how can I get the output of a command, and do something with it?", "body": "<p>You can use <code>inshell</code> to run a command and capture its output.</p>\n\n<pre><code>inshell \"my-command -option 1 -option 2\" empty\n</code></pre>\n\n<p>Note that that assumes you're in the <code>Shell</code> monad, not the <code>IO</code> monad. If you're in the latter, you'd need to consume it somehow, <a href=\"https://hackage.haskell.org/package/turtle-1.5.15/docs/Turtle-Tutorial.html#g:11\" rel=\"nofollow noreferrer\">such as by folding</a>:</p>\n\n<pre><code>import qualified Control.Foldl as Fold\nfold (inshell \"echo abc\\necho def\" empty) Fold.list\n</code></pre>\n\n<p>Edit: Your attempt with <code>translate</code> was close. Try like this:</p>\n\n<pre><code>translate :: Maybe Line -&gt; String\ntranslate response = case lineToText &lt;$&gt; response of\n Just \"-1\" -&gt; \"Got nothin\"\n otherwise -&gt; show response\n</code></pre>\n"}], "owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 58847402, "answer_count": 1, "score": 1, "last_activity_date": 1573753802, "creation_date": 1573687919, "last_edit_date": 1573750014, "question_id": 58847196, "link": "https://stackoverflow.com/questions/58847196/in-turtle-haskell-how-can-i-get-the-output-of-a-command-and-do-something-wit", "title": "In Turtle (Haskell), how can I get the output of a command, and do something with it?", "body": "<p>I'm a Haskell beginner, trying to translate a shell script into a Turtle script, just as an exercise. In BASH, I'd get the output of some command like so: <code>cmdoutput=$(my-command -option 1 -option 2</code> and then I could do a <code>case</code> switch in BASH to echo out different messages or run different actions, depending on the value of <code>cmdoutput</code>. How can I achieve that in Haskell Turtle? </p>\n\n<p>Edit: here's the shell script I'm trying to translate: </p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>#!/usr/bin/bash\n\nexport CLOCKSTRING=$(emacsclient --eval '(if (org-clocking-p)(org-clock-get-clock-string) -1)' 2&gt;&amp;1 )\n\ncase \"$CLOCKSTRING\" in\n    \"-1\")\n        echo \"Off!\" ;;\n    *\"server-start\"*)\n        echo \"Off!\" ;;\n    *\"ERROR\"*)\n        echo \"No clock!\" ;;\n    *)\n        echo ${CLOCKSTRING:3:30} ;\nesac\n</code></pre>\n\n<p>And here's what I have so far with Turtle: </p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport Turtle\nimport qualified Control.Foldl as Fold\n\ntranslate :: Text -&gt; Text\ntranslate response = case response of\n \"-1\" -&gt; \"Got nothin\"\n otherwise -&gt; response\n\nmain = do\n  let cmd2 = \"emacsclient --eval '(if (org-clocking-p)(org-clock-get-clock-string) -1)'\"\n\n  emacsOut &lt;- fold (inshell cmd2 empty) Fold.head\n  print $ translate $ emacsOut\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1054, "user_id": 6629736, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sjz49.png?s=128&g=1", "display_name": "jeremye", "link": "https://stackoverflow.com/users/6629736/jeremye"}, "edited": false, "score": 2, "creation_date": 1573682481, "post_id": 58846205, "comment_id": 103966223, "body": "This question might be more suited for <a href=\"https://cstheory.stackexchange.com\">cstheory.stackexchange.com</a>. Also you might want to consider rephrasing your question as how can I calculate the time complexity of this divide and conquer algorithm, and less like can someone give me the correct multiple choice answer."}, {"owner": {"reputation": 70549, "user_id": 4785185, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChR5h.jpg?s=128&g=1", "display_name": "Prune", "link": "https://stackoverflow.com/users/4785185/prune"}, "edited": false, "score": 1, "creation_date": 1573683881, "post_id": 58846205, "comment_id": 103966767, "body": "When asking about homework (1) <b>Be aware of your school policy</b>: asking here for help may constitute cheating. (2) Specify that the question is homework. (3) <b>Make a good faith attempt</b> to solve the problem yourself first (include your code in your question). (4) <b>Ask about a specific problem</b> with your existing implementation; see <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal, complete, verifiable example</a>. Also, <a href=\"https://meta.stackoverflow.com/questions/334822/how-do-i-ask-and-answer-homework-questions\">here</a> is guidance on asking homework questions."}], "answers": [{"tags": [], "owner": {"reputation": 359, "user_id": 8501464, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aFpwl.jpg?s=128&g=1", "display_name": "Yi\u011fit Aras Tunal\u0131", "link": "https://stackoverflow.com/users/8501464/yi%c4%9fit-aras-tunal%c4%b1"}, "is_accepted": false, "score": 1, "last_activity_date": 1573683415, "last_edit_date": 1573683415, "creation_date": 1573683088, "answer_id": 58846406, "question_id": 58846205, "link": "https://stackoverflow.com/questions/58846205/the-divide-and-conquer-problem-algorithms/58846406#58846406", "title": "The divide and conquer problem algorithms", "body": "<p>Essentially your problem is a recurrence relationship like this;</p>\n\n<p><code>T(n) = 5*T(n/3) + Theta(n^2)</code></p>\n\n<p>You can use what is called the <a href=\"https://en.wikipedia.org/wiki/Master_theorem_(analysis_of_algorithms)\" rel=\"nofollow noreferrer\">Master Theorem</a>\nto get an answer for this. </p>\n\n<p>Your parameters are: <code>a:=3 b:=5 and f(n):=n^2</code>. I'm sure from here you can solve your question and get your answer.</p>\n"}], "owner": {"reputation": 83, "user_id": 12325447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406948378ae5a4cbee9767d646911587?s=128&d=identicon&r=PG&f=1", "display_name": "mgt", "link": "https://stackoverflow.com/users/12325447/mgt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1573722897, "creation_date": 1573682034, "last_edit_date": 1573722897, "question_id": 58846205, "link": "https://stackoverflow.com/questions/58846205/the-divide-and-conquer-problem-algorithms", "title": "The divide and conquer problem algorithms", "body": "<p>a - O(n^(log_3 4))<br>\nb - Theta(n log n)<br>\nc - Theta(n^2).</p>\n\n<p>d - O(n)</p>\n\n<p>e - Theta(n^(log_4 3))</p>\n"}, {"tags": ["haskell", "aws-lambda", "aws-api-gateway", "serverless", "servant"], "comments": [{"owner": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 1, "creation_date": 1573683657, "post_id": 58846163, "comment_id": 103966669, "body": "What happens when you test with a local instance of your server, running on your own development machine?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573684315, "post_id": 58846163, "comment_id": 103966923, "body": "what does <code>updateItem</code> do? I think we need to see this function. Could that be some long-running process? (Edit: same with <code>checkForExistingItem</code>, now I&#39;ve read the code more carefully.)"}, {"owner": {"reputation": 327, "user_id": 6651168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2b45f362ea8f2d6346f9008a1df0afff?s=128&d=identicon&r=PG&f=1", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/6651168/jimbo"}, "reply_to_user": {"reputation": 7666, "user_id": 1241193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0331e5e748a0ac3860b68f6cac130ef1?s=128&d=identicon&r=PG", "display_name": "Bob Dalgleish", "link": "https://stackoverflow.com/users/1241193/bob-dalgleish"}, "edited": false, "score": 0, "creation_date": 1573690954, "post_id": 58846163, "comment_id": 103968677, "body": "@BobDalgleish I can use the functions directly to update my Postgres db in amazon RDS. When going through the api gateway is when it times out."}, {"owner": {"reputation": 327, "user_id": 6651168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2b45f362ea8f2d6346f9008a1df0afff?s=128&d=identicon&r=PG&f=1", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/6651168/jimbo"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573690977, "post_id": 58846163, "comment_id": 103968684, "body": "@RobinZigmond I just updated my question with the code"}], "owner": {"reputation": 327, "user_id": 6651168, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2b45f362ea8f2d6346f9008a1df0afff?s=128&d=identicon&r=PG&f=1", "display_name": "Jimbo", "link": "https://stackoverflow.com/users/6651168/jimbo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1573690847, "creation_date": 1573681826, "last_edit_date": 1573690847, "question_id": 58846163, "link": "https://stackoverflow.com/questions/58846163/json-payload-post-request-always-timing-out-aws-apigateway", "title": "JSON Payload POST request always timing out AWS ApiGateway", "body": "<p>I have gotten POST and GET requests to work when the parameters are entered in the URL. However posting a JSON payload results in my endpoint timing out and the api gateway logs are useless to debug what's going on. This is my API in servant:</p>\n\n<pre><code>type ItemApi = \"updateitem\" :&gt; ReqBody '[JSON] UpdateItem :&gt; Post '[JSON] String\n\ndata UpdateItem = UpdateItem {itmId :: String}\n\ninstance FromJSON UpdateItem where\n  parseJSON = withObject \"UpdateItem\" $ \\v -&gt; do\n    id &lt;- v .: \"itmId\"\n    return $ UpdateItem id\n\nupdateItemHandler :: UpdateItem -&gt; Handler String\nupdateItemHandler (UpdateItem _) = do\n  liftIO $ updateItem 3 999\n  mItem &lt;- liftIO $ checkForExistingItem 3\n  liftIO $ print \"Updated\"\n  liftIO $ print $ show mItem\n  return \"Return Updated\"\n\nupdateItem :: Int -&gt; Int -&gt; IO ()\nupdateItem itemId amt = do\n conn &lt;- connect connectIn\n mItem &lt;- checkForExistingItem itemId\n case mItem of\n  Just itm -&gt;  do runBeamPostgres conn $ runUpdate $ save (_shoppingItem shoppingCartDb)\n                     $ itm { _itemAmount = amt }\n                  mItem &lt;- checkForExistingItem itemId\n                  print $ show mItem\n                  close conn\n  Nothing -&gt; do print $ \"Item id: \" &lt;&gt; show itemId &lt;&gt; \" does not exist\"\n                close conn\n\ncheckForExistingItem :: Int -&gt; IO (Maybe Item)\ncheckForExistingItem id = do\n  conn &lt;- liftIO $ connect connectIn\n  mTalEntry &lt;-\n    runBeamPostgres conn\n      $ runSelectReturningOne\n      $ select\n      $ checkForExistingItemExpression id\n  close conn\n  return mTalEntry\n\ncheckForExistingItemExpression\n  :: Int -&gt; Q Postgres ShoppingCartDb s (ItemT (QExpr Postgres s))\ncheckForExistingItemExpression id =\n  filter_ (\\item -&gt; _itemId item ==. (val_ id))\n    $ all_ (_shoppingItem shoppingCartDb)\n\n\n</code></pre>\n\n<p>I'm using Postman to test my request with the following payload:\n<code>{ \"itmId\": \"test\" }</code></p>\n\n<p>This is my serverless.yml file:</p>\n\n<pre><code>service: serverless-minimal-example-final\n\nprovider:\n  name: aws\n  runtime: haskell\n  region: us-east-1\n  timeout: 30\n\nfunctions:\n  apigw:\n    handler: serverless-haskell-example.apigw\n    events:\n      - http:\n          path: updateitem\n          method: post\n\nplugins:\n  - serverless-haskell\n  - serverless-offline\n</code></pre>\n"}, {"tags": ["loops", "haskell", "recursion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1573665792, "post_id": 58842377, "comment_id": 103958812, "body": "You here iterate over both lists &quot;concurrently&quot;. But in a declarative language you should not think in terms of &quot;loops&quot;."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 3, "creation_date": 1573666573, "post_id": 58842377, "comment_id": 103959179, "body": "what should <code>helplist [0,2] [(0,&quot;a&quot;),(0,&quot;b&quot;)]</code> return?"}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 10709678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd5e4701f662b32082bebba0472c2b7?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10709678/kevin"}, "edited": false, "score": 0, "creation_date": 1573666436, "post_id": 58842493, "comment_id": 103959133, "body": "What does the Eq a =&gt; do here? wouldnt it work without it?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 131, "user_id": 10709678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd5e4701f662b32082bebba0472c2b7?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10709678/kevin"}, "edited": false, "score": 1, "creation_date": 1573666518, "post_id": 58842493, "comment_id": 103959166, "body": "@Kevin: it is a type constraint that says that <code>a</code> should be an instance of the <code>Eq</code> typeclass. It is necessary to perform an <code>x == i</code>. An <code>Int</code> for example is an instance of the <code>Eq</code> typeclass, hence for <code>[Int] -&gt; [(Int, Char)] -&gt; [Char]</code>, this will work. But it will thus work for more types than just <code>Int</code>s (<code>String</code>s, <code>Char</code>s, <code>Integer</code>s, etc.)."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1573666532, "last_edit_date": 1573666532, "creation_date": 1573665961, "answer_id": 58842493, "question_id": 58842377, "link": "https://stackoverflow.com/questions/58842377/double-for-loop-in-haskell/58842493#58842493", "title": "Double for loop in haskell", "body": "<p>You can use <em>list comprehension</em> here:</p>\n\n<pre><code>helplist :: Eq a =&gt; [a] -&gt; [(a, b)] -&gt; [b]\nhelplist xs gs = [ g | x &lt;- xs, (i, g) &lt;- gs, x == i ]</code></pre>\n\n<p>Or you can try to filter the list based on the value of another list, like:</p>\n\n<pre><code>helplist :: (Foldable f, Eq a) =&gt; f a -&gt; [(a, b)] -&gt; [b]\nhelplist xs gs = concatMap (\\x -&gt; map snd (filter (\\(i, _) -&gt; x == i) gs)) xs</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1573672494, "post_id": 58842849, "comment_id": 103961843, "body": "Wouldn&#39;t <code>Just [&quot;a&quot;, &quot;c&quot;]</code> be a very resonable result in this particular case? So <code>sequence</code> could be a handy function here."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1573674359, "post_id": 58842849, "comment_id": 103962684, "body": "In this case, there wouldn&#39;t be a clear difference in meaning between <code>Just []</code> and <code>Nothing</code>, so there seems little reason to have a return type of <code>Maybe [a]</code> instead of <code>[a]</code>."}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1573682405, "post_id": 58842849, "comment_id": 103966187, "body": "Vote for this answer, love answer that not try to reinvent the wheel"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 7, "last_activity_date": 1573667425, "creation_date": 1573667425, "answer_id": 58842849, "question_id": 58842377, "link": "https://stackoverflow.com/questions/58842377/double-for-loop-in-haskell/58842849#58842849", "title": "Double for loop in haskell", "body": "<p>Haskell already has a function for looking up a <em>single</em> value in an association list:</p>\n\n<pre><code>lookup :: Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b\n</code></pre>\n\n<p>All you need to do is map that (appropriately applied to your list) over your keys.</p>\n\n<pre><code>&gt; helpList keys table = map (\\x -&gt; lookup x table) keys\n&gt; helpList [0,2] [(0,\"a\"),(3,\"x\"),(5,\"y\"),(1,\"b\"),(2,\"c\")]\n[Just \"a\",Just \"c\"]\n</code></pre>\n\n<p>Well, almost. This gives you back a list of <code>Maybe String</code> values. If you are sure each lookup will succeed (or simply don't care about lookups that fail), you can use the <code>catMaybes</code> function from <code>Data.Maybe</code> to drop the <code>Nothing</code> responses and extract the actual values from their <code>Just</code> wrappers.</p>\n\n<pre><code>&gt; import Data.Maybe\n&gt; helpList keys table = catMaybes $ map (\\x -&gt; lookup x table) keys\n&gt; helpList [0,2] [(0,\"a\"),(3,\"x\"),(5,\"y\"),(1,\"b\"),(2,\"c\")]\n[\"a\",\"c\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": false, "score": 3, "last_activity_date": 1573667911, "creation_date": 1573667911, "answer_id": 58842964, "question_id": 58842377, "link": "https://stackoverflow.com/questions/58842377/double-for-loop-in-haskell/58842964#58842964", "title": "Double for loop in haskell", "body": "<p>It's possible to write Java in Haskell, but you don't get any benefits from Haskell or functional programming that way. For comparison with the other answer, here's Haskell with a strong Java accent, the way you initially imagined:</p>\n\n<pre><code>helplist :: [Int] -&gt; [(Int,Char)] -&gt; [Char]\n-- For each thing to find\nhelplist (x:xs) gs = findOne x gs ++ helplist xs gs\n  where\n    findOne :: Int -&gt; [(Int,Char)] -&gt; [Char]\n    -- For each element in the list\n    findOne x ((i,g):gs) | (x == i) = g : findOne x gs\n    findOne x (_:gs) = findOne x gs\n    findOne _ _ = []\nhelplist _ _ = []\n</code></pre>\n\n<p>It does the job:</p>\n\n<pre><code>*Main&gt; helplist [0,2] [(0,'a'),(3,'x'),(5,'y'),(1,'b'),(2,'c')]\n\"ac\"\n</code></pre>\n\n<p>But since this approach is a bad fit for Haskell, it ends up being both longer, more awkward to write, and harder to follow than the equivalent Java code.</p>\n\n<p>My suggestion for the most straight forward Haskell implementation is instead to say \"I want to find (<code>filter</code>) all tuples where the first element is in a list (<code>elem</code>), and for each of them (<code>map</code>) pick the second element (<code>snd</code>):</p>\n\n<pre><code>helplist targets tuples = map snd $ filter (\\(x, _) -&gt; x `elem` targets) tuples\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 10709678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cd5e4701f662b32082bebba0472c2b7?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin", "link": "https://stackoverflow.com/users/10709678/kevin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 58842493, "answer_count": 3, "score": 1, "last_activity_date": 1573667911, "creation_date": 1573665503, "last_edit_date": 1573667612, "question_id": 58842377, "link": "https://stackoverflow.com/questions/58842377/double-for-loop-in-haskell", "title": "Double for loop in haskell", "body": "<p>I'm trying to make a new list with the 2nd number of a tuple of if the first number is in the first list, here a example <code>helplist [0,2] [(0,\"a\"),(3,\"x\"),(5,\"y\"),(1,\"b\"),(2,\"c\")] = [\"a\",\"c\"]</code></p>\n\n<p>I've tryed so many combinations but without success, here my code:</p>\n\n<pre><code>helplist :: [Int] -&gt; [(Int,Char)] -&gt; [Char]\nhelplist (x:xs) ((i,g):gs) | (x == i) = g : helplist xs gs\nhelplist _ _ = []\n\n</code></pre>\n\n<p>In java I'd done a 2x for loop but in haskell I just know recursion.</p>\n"}, {"tags": ["haskell", "types", "logic", "liquid-haskell"], "answers": [{"tags": [], "owner": {"reputation": 353, "user_id": 6471510, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/bac79f1fe5544d00e5d2f94bf0b383d9?s=128&d=identicon&r=PG&f=1", "display_name": "trpnd", "link": "https://stackoverflow.com/users/6471510/trpnd"}, "is_accepted": true, "score": 2, "last_activity_date": 1573684969, "last_edit_date": 1573684969, "creation_date": 1573682657, "answer_id": 58846324, "question_id": 58839191, "link": "https://stackoverflow.com/questions/58839191/expressive-power-of-liquid-haskell/58846324#58846324", "title": "Expressive power of Liquid Haskell", "body": "<p>I believe that LH will <em>let</em> you write arbitrary arithmetic constraints. But only the theory of linear integer arithmetic is decidable (via presburger arithmetic) by the backend solver, so as soon as you start writing non-linear expressions you lose any guarantee that the solver will actually verify your code. Additionally, SMT solvers only support first-order logic, so you can't quantify over relations. </p>\n"}], "owner": {"reputation": 393, "user_id": 2176528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136af1bfd8b8c1582d2e56ac08bfcd94?s=128&d=identicon&r=PG", "display_name": "kishlaya", "link": "https://stackoverflow.com/users/2176528/kishlaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 58846324, "answer_count": 1, "score": 5, "last_activity_date": 1573684969, "creation_date": 1573654814, "question_id": 58839191, "link": "https://stackoverflow.com/questions/58839191/expressive-power-of-liquid-haskell", "title": "Expressive power of Liquid Haskell", "body": "<p>Following up from my recent <a href=\"https://stackoverflow.com/questions/58806748/how-to-write-a-log2-function-in-liquid-haskell\">question</a>, I have been pondering over the following:</p>\n\n<p>We can create some new amazing types in LH, particularly, express some non-trivial subsets of Integers. For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-@ type Nat = {v:Int | v&gt;=0 } @-}\n{-@ type grtN N = {v:Int | v&gt;N } @-}\n{-@ type Even = {v:Int | v mod 2 == 0 } @-}\n</code></pre>\n\n<p>But now what other non-trivial subsets can I express in LH?</p>\n\n<p>Can I create a type in LH which consists of only powers of 2? Which is what my last question was about and it seems like the answer is negative.</p>\n\n<p>So a natural question which arises is what kind of subsets (of Integers) can I express?\nIs there a nice characterization?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 6, "creation_date": 1573650417, "post_id": 58837372, "comment_id": 103949904, "body": "<code>zipWith</code> is definitely a useful function to know about. As the above commenters say, both <code>zipWith ($)</code> and <code>zipWith id</code> will do what you want. They&#39;re the same because <code>($)</code> is actually the same as <code>id</code>, just restricted to functions (that&#39;s a little mind blowing at first, but it&#39;s true and I would encourage you to work out why) - for this reason I prefer using <code>($)</code> because it&#39;s more obvious you&#39;re talking about function application."}], "answers": [{"tags": [], "owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "is_accepted": true, "score": 7, "last_activity_date": 1573659274, "last_edit_date": 1573659274, "creation_date": 1573654537, "answer_id": 58839107, "question_id": 58837372, "link": "https://stackoverflow.com/questions/58837372/haskell-function-that-applies-a-list-of-functions-to-a-list-of-inputs/58839107#58839107", "title": "Haskell function that applies a list of functions to a list of inputs?", "body": "<p>As commented your recursion fails to recurse in the second argument, so the definition would be </p>\n\n<pre><code>apply (f:fs) (x:xs) = (f x) : (apply fs xs) \napply _      _      = []\n</code></pre>\n\n<p>You can go point-free with </p>\n\n<pre><code>apply = zipWith ($) -- zipWith id works too as @Redu commented\n</code></pre>\n\n<p>Or even more interesting, you can go applicativelly-crazy with <code>ZipList</code> </p>\n\n<pre><code>import Control.Applicative\napply f x = getZipList $ ZipList f &lt;*&gt; ZipList x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 2, "last_activity_date": 1573677378, "creation_date": 1573677378, "answer_id": 58845233, "question_id": 58837372, "link": "https://stackoverflow.com/questions/58837372/haskell-function-that-applies-a-list-of-functions-to-a-list-of-inputs/58845233#58845233", "title": "Haskell function that applies a list of functions to a list of inputs?", "body": "<p>It's interesting  that in two comments are two totally valid answers:</p>\n\n<pre><code>applyAll' :: [b -&gt; c] -&gt; [b] -&gt; [c]\napplyAll = zipWith ($)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>applyAll :: [a -&gt; c] -&gt; [a] -&gt; [c]\napplyAll' = zipWith id\n</code></pre>\n\n<p>It's also interesting that Haskell, due to <a href=\"https://stackoverflow.com/questions/58285479/how-do-i-determine-type-of-haskell-functions\">its way to pick types</a> (type inference), changes a little bit its signature, obviously they are equivalent.\n <code>id</code> and <code>$</code> functions are equivalents when <code>id</code> is restricted to functions. (As Robin pointed out in his comment).</p>\n"}], "owner": {"reputation": 357, "user_id": 12117801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50f0b1a5a3f823ef8adbd669c294bee1?s=128&d=identicon&r=PG&f=1", "display_name": "erdostamasa", "link": "https://stackoverflow.com/users/12117801/erdostamasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 58839107, "answer_count": 2, "score": 6, "last_activity_date": 1573677378, "creation_date": 1573648847, "question_id": 58837372, "link": "https://stackoverflow.com/questions/58837372/haskell-function-that-applies-a-list-of-functions-to-a-list-of-inputs", "title": "Haskell function that applies a list of functions to a list of inputs?", "body": "<p>I need a Haskell function that takes a list of functions and a list of elements and applies the functions to the elements like this: the first function to the first element, the second function to the second element, etc. If any of the lists stop, I want the fuction to stop.\nThe difinition I came up with is this:</p>\n\n<pre><code>apply :: [(a -&gt; b)] -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>I would like it to work something like this:</p>\n\n<pre><code>apply [(+1), (*3), (^2)] [1,2,3] == [2,6,9]\napply [even, odd] [1..] == [False, False]\n</code></pre>\n\n<p>Things I tried so far:</p>\n\n<pre><code>apply :: [(a -&gt; b)] -&gt; [a] -&gt; [b]\napply [] _ = []\napply (f:fs) x = (f x) : (apply fs x)\n</code></pre>\n"}, {"tags": ["haskell", "generator"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1573645943, "creation_date": 1573645943, "answer_id": 58836537, "question_id": 58836393, "link": "https://stackoverflow.com/questions/58836393/haskell-pointfree-catch-one-argument-two-times/58836537#58836537", "title": "haskell - pointfree catch one argument two times", "body": "<p>What you here constructed is a 2-tuple where each element is a function. That is all. A 2-tuple is not a function, so you can not just use it and apply an argument to it.</p>\n\n<p>You can here make use of the fact that a function is an <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#t:Applicative\" rel=\"noreferrer\"><strong><code>Applicative</code></strong></a> instance, and thus work with:</p>\n\n<pre><code>x :: Num a =&gt; a -&gt; (a, a)\nx = (,) &lt;$&gt; (1+) &lt;*&gt; (2+)</code></pre>\n\n<p>or by using <code>liftA2</code> which does the same thing:</p>\n\n<pre><code>import Control.Applicative(<b>liftA2</b>)\n\nx :: Num a =&gt; a -&gt; (a, a)\nx = <b>liftA2</b> (,) (1+) (2+)</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 12272695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0a414504bdd4670e6a3c869e58c54d?s=128&d=identicon&r=PG&f=1", "display_name": "bratpiorka", "link": "https://stackoverflow.com/users/12272695/bratpiorka"}, "edited": false, "score": 0, "creation_date": 1573646724, "post_id": 58836554, "comment_id": 103947976, "body": "thanks, I this using liftM2 is less readable than simple (a + 1, a + 2)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 21, "user_id": 12272695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0a414504bdd4670e6a3c869e58c54d?s=128&d=identicon&r=PG&f=1", "display_name": "bratpiorka", "link": "https://stackoverflow.com/users/12272695/bratpiorka"}, "edited": false, "score": 2, "creation_date": 1573653625, "post_id": 58836554, "comment_id": 103951801, "body": "@bratpiorka <code>liftM2</code> (or the more general applicative-functor versions in <a href=\"https://stackoverflow.com/a/58836537/1126841\">stackoverflow.com/a/58836537/1126841</a>) are useful when you need to combine arbitrary functions (that you, say, receive as arguments), rather than expressions that you can construct yourself. After a while, you get used to the idiom and it becomes more readable."}], "tags": [], "owner": {"reputation": 6633, "user_id": 392025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac8fa292707d21768f9ebe17de4b523?s=128&d=identicon&r=PG", "display_name": "Aurel B&#237;l&#253;", "link": "https://stackoverflow.com/users/392025/aurel-b%c3%adl%c3%bd"}, "is_accepted": true, "score": 6, "last_activity_date": 1573645993, "creation_date": 1573645993, "answer_id": 58836554, "question_id": 58836393, "link": "https://stackoverflow.com/questions/58836393/haskell-pointfree-catch-one-argument-two-times/58836554#58836554", "title": "haskell - pointfree catch one argument two times", "body": "<p>This part of the error explains the gist of it:</p>\n\n<blockquote>\n  <p>The function <code>x</code> is applied to one argument,\n  but its type <code>(Integer -&gt; Integer, Integer -&gt; Integer)</code> has none</p>\n</blockquote>\n\n<p>When you write a function point-free, you write it in such a way that, given more arguments after the expression, it will evaluate to the desired result. For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>x a = 1 + a\n-- same as:\nx' = (1+)\n-- because when you use it:\nx 3 == 1 + 3 == 4\nx' 3 == (1+) 3 == 4\n</code></pre>\n\n<p>This is not the case with how you wrote your tuple function, because Haskell doesn't know that you want a tuple of functions to be used as a function.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>x a = (1 + a, 2 + a)\n-- not the same as:\nx' = ((1+), (2+))\n-- because:\nx 1 == (1 + 1, 2 + 1) == (2, 3)\nx' 1 == ((1+), (2+)) 1 == ???\n</code></pre>\n\n<p>You can check <a href=\"http://pointfree.io/\" rel=\"noreferrer\">pointfree.io</a>, which translates your function to:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>x = liftM2 (,) (1 +) (2 +)\n</code></pre>\n\n<p>Which uses the fact that tuples are monads (and is better described in the other answer), but is arguably less readable.</p>\n"}], "owner": {"reputation": 21, "user_id": 12272695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d0a414504bdd4670e6a3c869e58c54d?s=128&d=identicon&r=PG&f=1", "display_name": "bratpiorka", "link": "https://stackoverflow.com/users/12272695/bratpiorka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 58836554, "answer_count": 2, "score": 1, "last_activity_date": 1573645993, "creation_date": 1573645518, "question_id": 58836393, "link": "https://stackoverflow.com/questions/58836393/haskell-pointfree-catch-one-argument-two-times", "title": "haskell - pointfree catch one argument two times", "body": "<p>this code works in Haskell:</p>\n\n<pre><code>x a = (a + 1, a + 2)\nx 2 -- returns (3, 4)\n</code></pre>\n\n<p>while this not:</p>\n\n<pre><code>x = ((+1), (+2))\n\n&lt;interactive&gt;:935:1: error:\n* Couldn't match expected type `Integer -&gt; t'\n              with actual type `(Integer -&gt; Integer, Integer -&gt; Integer)'\n* The function `x' is applied to one argument,\n  but its type `(Integer -&gt; Integer, Integer -&gt; Integer)' has none\n  In the expression: x 2\n  In an equation for `it': it = x 2\n* Relevant bindings include it :: t (bound at &lt;interactive&gt;:935:1)\n</code></pre>\n\n<p>Can someone explain me why?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1573645297, "post_id": 58836320, "comment_id": 103947255, "body": "Great function! What is not working with your attempt?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1573656176, "post_id": 58836320, "comment_id": 103953314, "body": "Hint: list comprehensions are your friends."}], "answers": [{"comments": [{"owner": {"reputation": 189, "user_id": 12118780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1672f667ef2e09d09ff3f4d20079fce?s=128&d=identicon&r=PG&f=1", "display_name": "Beszteri", "link": "https://stackoverflow.com/users/12118780/beszteri"}, "edited": false, "score": 0, "creation_date": 1573659376, "post_id": 58836836, "comment_id": 103955137, "body": "Thanks it helps for me!"}], "tags": [], "owner": {"reputation": 1148, "user_id": 11619101, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Pgyla3H7sk4/AAAAAAAAAAI/AAAAAAAAABc/XQ20NuIAEmM/photo.jpg?sz=128", "display_name": "Yuri Kovalenko", "link": "https://stackoverflow.com/users/11619101/yuri-kovalenko"}, "is_accepted": true, "score": 5, "last_activity_date": 1573649596, "last_edit_date": 1573649596, "creation_date": 1573647005, "answer_id": 58836836, "question_id": 58836320, "link": "https://stackoverflow.com/questions/58836320/filtermap-function-define/58836836#58836836", "title": "FilterMap function define", "body": "<p>It seems like you forgot to point out the problem itself with your attempts on this.</p>\n\n<p>However, here are some versions of what you are looking for:</p>\n\n<ul>\n<li>simple version, use filter and map directly:</li>\n</ul>\n\n<pre><code>filterMap :: (a-&gt;b) -&gt; (a -&gt; Bool) -&gt; [a] -&gt; [b]\nfilterMap mapping pred lst = map mapping (filter pred lst)\n</code></pre>\n\n<ul>\n<li>version without parentheses:</li>\n</ul>\n\n<pre><code>filterMap mapping pred lst = map mapping $ filter pred $ lst\n</code></pre>\n\n<ul>\n<li>composition version:</li>\n</ul>\n\n<pre><code>filterMap mapping pred = map mapping . filter pred\n</code></pre>\n\n<p>Here we've got rid of an argument on both sides (so called <a href=\"https://wiki.haskell.org/Pointfree\" rel=\"nofollow noreferrer\">point-free style</a>) and say that our function is a sequence of filtering with <code>pred</code> and mapping with, well, <code>mapping</code>.</p>\n"}], "owner": {"reputation": 189, "user_id": 12118780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1672f667ef2e09d09ff3f4d20079fce?s=128&d=identicon&r=PG&f=1", "display_name": "Beszteri", "link": "https://stackoverflow.com/users/12118780/beszteri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 58836836, "answer_count": 1, "score": -2, "last_activity_date": 1573649596, "creation_date": 1573645251, "question_id": 58836320, "link": "https://stackoverflow.com/questions/58836320/filtermap-function-define", "title": "FilterMap function define", "body": "<p>I am trying to get a program, which first filters out the elements that match the condition from the list, then maps the elements based on a function that is also received as a parameter.</p>\n\n<pre><code>filterMap :: (a -&gt; b) -&gt; (a -&gt; Bool) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>For instance:</p>\n\n<pre><code>filterMap (+1) even [1..10] == [3,5,7,9,11]\nfilterMap (2^) (/=0) [0,1,0,2] == [2,4]\n</code></pre>\n"}, {"tags": ["haskell", "liquid-haskell"], "answers": [{"tags": [], "owner": {"reputation": 1152, "user_id": 729775, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70ec20c66713dc2fe7ce050263961685?s=128&d=identicon&r=PG", "display_name": "Ranjit Jhala", "link": "https://stackoverflow.com/users/729775/ranjit-jhala"}, "is_accepted": true, "score": 3, "last_activity_date": 1573693948, "creation_date": 1573693948, "answer_id": 58847962, "question_id": 58830570, "link": "https://stackoverflow.com/questions/58830570/defining-measures-in-liquid-haskell/58847962#58847962", "title": "Defining measures in Liquid Haskell", "body": "<p>This is because LH expects measures to be declared via the second syntax (not the first). However, unfortunately, LH currently <em>does not</em> give an error message with the first, it appears to just silently ignore the measure definition (or rather, treat it as \"uninterpreted\"). </p>\n\n<p>We will fix the code so that when there is an actual definition, it tells you about it.</p>\n\n<p>In short: this is an unfortunate consequence of our syntax choices, my apologies!</p>\n"}], "owner": {"reputation": 393, "user_id": 2176528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136af1bfd8b8c1582d2e56ac08bfcd94?s=128&d=identicon&r=PG", "display_name": "kishlaya", "link": "https://stackoverflow.com/users/2176528/kishlaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 58847962, "answer_count": 1, "score": 5, "last_activity_date": 1573693948, "creation_date": 1573621175, "question_id": 58830570, "link": "https://stackoverflow.com/questions/58830570/defining-measures-in-liquid-haskell", "title": "Defining measures in Liquid Haskell", "body": "<p>Here's a simple function to calculate average of the numbers in a given list.</p>\n\n<pre><code>{-@ type NonZero = {v:Int | v/=0 } @-}\n\n{-@ divide :: Int -&gt; NonZero -&gt; Int @-}\ndivide :: Int -&gt; Int -&gt; Int\ndivide n d = div n d\n\n{-@ measure nonEmpty :: [a] -&gt; Bool @-}\nnonEmpty [] = False\nnonEmpty _ = True\n\n{-@ size :: xs:[a] -&gt; {v:Nat | nonEmpty xs =&gt; v&gt;0 } @-}\nsize :: [a] -&gt; Int\nsize [] = 0\nsize (_:xs) = 1 + size xs\n\n{-@ type NEList a = {v:[a] | nonEmpty v} @-}\n\n{-@ avg :: NEList Int -&gt; Int @-}\navg xs = divide (sum xs) (size xs)\n</code></pre>\n\n<p>Unfortunately this code doesn't typecheck.</p>\n\n<p>But if I declare <code>nonEmpty</code> to be a measure after I define the function, it works: </p>\n\n<pre><code>{-@ type NonZero = {v:Int | v/=0 } @-}\n\n{-@ divide :: Int -&gt; NonZero -&gt; Int @-}\ndivide :: Int -&gt; Int -&gt; Int\ndivide n d = div n d\n\n{-@ nonEmpty :: [a] -&gt; Bool @-}\nnonEmpty [] = False\nnonEmpty _ = True\n{-@ measure nonEmpty @-}\n\n{-@ size :: xs:[a] -&gt; {v:Nat | nonEmpty xs =&gt; v&gt;0 } @-}\nsize :: [a] -&gt; Int\nsize [] = 0\nsize (_:xs) = 1 + size xs\n\n{-@ type NEList a = {v:[a] | nonEmpty v} @-}\n\n{-@ avg :: NEList Int -&gt; Int @-}\navg xs = divide (sum xs) (size xs)\n</code></pre>\n\n<p>So can somebody explain why is it so?</p>\n"}, {"tags": ["haskell", "tuples"], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 3, "last_activity_date": 1573616876, "creation_date": 1573616876, "answer_id": 58830047, "question_id": 58830026, "link": "https://stackoverflow.com/questions/58830026/trying-to-return-tuple/58830047#58830047", "title": "Trying to return tuple", "body": "<p><code>foldr</code> takes 3 arguments, but in <code>target = foldr (^) board</code>, you're only giving it 2. You can't then compare it with <code>if target &lt; x</code> because it's not a number yet, but still a function waiting for one more argument.</p>\n"}], "owner": {"reputation": 75, "user_id": 12364311, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mADGNjfKns7RhNk5XKWqkU5TKQCfSko3o3ZZtUE=k-s128", "display_name": "Sondre Lindaas Gjesdal", "link": "https://stackoverflow.com/users/12364311/sondre-lindaas-gjesdal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 58830047, "answer_count": 1, "score": 0, "last_activity_date": 1573629614, "creation_date": 1573616744, "last_edit_date": 1573629614, "question_id": 58830026, "link": "https://stackoverflow.com/questions/58830026/trying-to-return-tuple", "title": "Trying to return tuple", "body": "<p>So I'm trying to make game of nim while playing against the computer in haskell as part of an assignment, but I'm struggling with the computer part. what i wish to do is return a tuple containing the heap number(row) and number to remove. So far I've got this:</p>\n\n<pre><code>ai board [] = []\nai board (x:xs) = \n    do\n       let target = foldr (^) board\n       if target &lt; x then do\n          let num = x-target   \n          return (x, num)\n       else\n          ai board xs\n</code></pre>\n\n<p>which raises this error:</p>\n\n<pre><code>Oblig3.hs:75:1: error:\n    * Non type-variable argument in the constraint: Ord (t b -&gt; b)\n      (Use FlexibleContexts to permit this)\n    * When checking the inferred type\n        ai :: forall (t :: * -&gt; *) b.\n              (Ord (t b -&gt; b), Foldable t, Integral b, Num (t b -&gt; b)) =&gt;\n              b -&gt; [t b -&gt; b] -&gt; [(t b -&gt; b, t b -&gt; b)]\n   |\n75 | ai board [] = []\n</code></pre>\n\n<p>PS board is a list of ints showing how many elements is left in the heap and the computer algorithm is based on the one found on <a href=\"https://en.wikipedia.org/wiki/Nim?fbclid=IwAR2IkFXSE67kg9NLQacD6MG7xnvYCCMMEkTLSyAWMd1yGAgaJZQr0DphigY#Example_implementation\" rel=\"nofollow noreferrer\">Nim's wikipedia</a> </p>\n"}, {"tags": ["haskell", "functional-programming", "maybe"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573598339, "post_id": 58827732, "comment_id": 103931871, "body": "There are a number of mistakes here (don&#39;t worry, we all make them, especially when first learning). I&#39;m curious what you were trying to achieve here with the <code>| otherwise = Nothing</code> though."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1573605609, "post_id": 58827732, "comment_id": 103933587, "body": "Seconded. I made this exact mistake with guards. You&#39;ll get it."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1573598879, "post_id": 58827755, "comment_id": 103932055, "body": "Also, note the parentheses around <code>(Just x)</code> are required; otherwise, <code>func Just x = ...</code> would interpreted as matching against the literal argument <code>Just</code> and an irrefutable pattern <code>x</code> matching any second argument."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1573607909, "post_id": 58827755, "comment_id": 103934105, "body": "May be useful to say that the separator between equations is a semicolon <code>;</code>, not a <code>|</code>. <code>func (Just x) = Just (x + 1); func Nothing = Nothing</code>. Putting the equations on separate lines inserts a virtual semicolon via layout. <code>|</code> is for <i>guards</i>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 9, "last_activity_date": 1573598961, "last_edit_date": 1573598961, "creation_date": 1573598334, "answer_id": 58827755, "question_id": 58827732, "link": "https://stackoverflow.com/questions/58827732/func-maybeint-maybeint/58827755#58827755", "title": "func :: Maybe(Int) -&gt; Maybe(Int)", "body": "<p>You pattern match on the two possible cases. A <code>Maybe a</code> has two data constructors: a <code>Nothing</code>, and a <code>Just &hellip;</code> with <code>&hellip;</code> the value it wraps. There is no <code>| otherwise</code> part when you do pattern matching. The pipe character (<code>|</code>) is used for <a href=\"http://learnyouahaskell.com/syntax-in-functions#guards-guards\" rel=\"noreferrer\"><em>guards</em> [lyah]</a>.</p>\n\n<p>So you can for example increment the value in a <code>Just</code> with:</p>\n\n<pre><code>func :: Maybe Int -&gt; Maybe Int\nfunc <b>(Just x)</b> = Just (x+1)\nfunc <b>Nothing</b> = Nothing</code></pre>\n\n<p>The brackets around <code>Just x</code> are required here, as <a href=\"https://stackoverflow.com/questions/58827732/func-maybeint-maybeint-haskell/58827755?noredirect=1#comment103932055_58827755\">@chepner says</a>. Otherwise it will be parsed as if <code>Just</code> is the first parameter, and <code>x</code> is a second parameter.</p>\n\n<p>Since <code>Maybe</code> is an instance of the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#t:Functor\" rel=\"noreferrer\"><strong><code>Functor</code></strong> typeclass</a>, you can make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:fmap\" rel=\"noreferrer\"><strong><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code></strong></a> here:</p>\n\n<pre><code>func :: Maybe Int -&gt; Maybe Int\nfunc = <b>fmap</b> (1+)</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9566161"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1573634195, "creation_date": 1573598193, "last_edit_date": 1573634195, "question_id": 58827732, "link": "https://stackoverflow.com/questions/58827732/func-maybeint-maybeint", "title": "func :: Maybe(Int) -&gt; Maybe(Int)", "body": "<p>I've done some research but couldn't find anything. I don't understand how a function like this works:</p>\n\n<pre><code>func :: Maybe (Int) -&gt; Maybe (Int)\n</code></pre>\n\n<p>How am I supposed to do the pattern matching? I've tried this but it didn't work:</p>\n\n<pre><code>func Just a  = Just a | otherwise = Nothing\nfunc Nothing = Just Nothing | otherwise = Nothing\n</code></pre>\n\n<p>How can I make this work?</p>\n\n<p>Error message: </p>\n\n<blockquote>\n<pre><code>exercises6.hs:83:22: error: parse error on input \u2018|\u2019\n   |\n83 | func Just a = Just a | otherwise = Nothing\n   |                      ^\n</code></pre>\n</blockquote>\n"}, {"tags": ["list", "haskell", "nested-lists"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1573594966, "post_id": 58827023, "comment_id": 103930723, "body": "I think you make things too hard. Try first to sole the problem for a simple list of <code>Int</code>s. Try to work with small patterns."}, {"owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573595959, "post_id": 58827023, "comment_id": 103931025, "body": "I kinda managed to do it for a single list. However, I need to also add +1 to <code>Int</code>s in the next list."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573597694, "post_id": 58827023, "comment_id": 103931635, "body": "take a look at <code>zipWith</code>."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1573597995, "post_id": 58827023, "comment_id": 103931736, "body": "This can actually work. In a sense, you are creating a gigantic pattern and move it along the minefield."}, {"owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573599196, "post_id": 58827023, "comment_id": 103932134, "body": "I cannot figure out how I should utilize <code>zipWith</code>. Could you describe what you have in mind?"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1573601296, "post_id": 58827023, "comment_id": 103932650, "body": "I honestly tried to write this up, but it gets very messy. The investment of effort to make it right this way is not worth it."}, {"owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573627668, "post_id": 58827023, "comment_id": 103938618, "body": "got an idea, how about spliting the function to two adders where each will work with one list? And conditions in first will affect the second."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1573639968, "post_id": 58827023, "comment_id": 103944489, "body": "Can you explain your problem better? <code>&#39;10&#39;:[[...</code> is not even haskell sintax. Give us a simple example. What whould be the output of <code>adder [[0, 0, 10, 0, 0]]</code>?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1573640273, "post_id": 58827023, "comment_id": 103944651, "body": "@lsmor the OP wants to (+1) every cell surrounding every 10 in the input matrix, as in the game minesweeper."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1573641039, "post_id": 58827023, "comment_id": 103945061, "body": "@WillNess oh!, isn&#39;t this kind of the same question as in <a href=\"https://stackoverflow.com/questions/58793029/minesweeper-board-labels-beginner-level\" title=\"minesweeper board labels beginner level\">stackoverflow.com/questions/58793029/&hellip;</a> Is the same PO but changing the board settup"}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1573658100, "post_id": 58836108, "comment_id": 103954393, "body": "this will add 1 to the (&gt;=10) cells, but OP wanted to add 1 to their surrounding cells."}], "tags": [], "owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "is_accepted": false, "score": 0, "last_activity_date": 1573644495, "creation_date": 1573644495, "answer_id": 58836108, "question_id": 58827023, "link": "https://stackoverflow.com/questions/58827023/how-to-make-my-function-move-through-two-lists-at-once/58836108#58836108", "title": "How to make my function move through two lists at once?", "body": "<p>I think it's rather easy, as long as the data structure stays as <code>[[Int]]</code>. See the below example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>addIf10 :: Int -&gt; Int\naddIf10 x = if x &gt;= 10 then x + 1 else x\n\n-- The first map \"unpacks\" the list to form an [Int]\n-- Second map runs the addIf10 function on the [Int]\nadder :: [[Int]] -&gt; [[Int]]\nadder = map (map addIf10)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "is_accepted": true, "score": 0, "last_activity_date": 1573647377, "creation_date": 1573647377, "answer_id": 58836932, "question_id": 58827023, "link": "https://stackoverflow.com/questions/58827023/how-to-make-my-function-move-through-two-lists-at-once/58836932#58836932", "title": "How to make my function move through two lists at once?", "body": "<p>I see how you arrived at this idea. In a sense, you are creating a gigantic pattern and move it\nalong the minefield. It can work. But it is not an easy way.</p>\n\n<pre><code>adder :: [[Int]] -&gt; [[Int]]\nadder [ ] = [ ]\nadder [x] = [x]\nadder t@[  [_, _],   [_, _]    ] = t\nadder   (u@[_, _]: v@[_, _]: us) = u: v: adder us\nadder t = afterPass !! 0: adder (afterPass !! 1: us)\n  where\n    t' = applyHalfStencil t\n\n    (  (x: xs)\n     : (y: ys)\n     : us\n     ) = t'\n\n    xys = [xs, ys]\n\n    afterPass = [x: adder xys !! 0, y: adder xys !! 1]\n\napplyHalfStencil\n      s@( (xa: xb: xc: xs)\n        : (ya: yb: yc: ys)\n        : us\n        )\n    | xb &gt; 9 =\n        ( (xa    : xb    : xc + 1: xs)\n        : (ya + 1: yb + 1: yc + 1: ys)\n        : us\n        )\n    | otherwise = s\n</code></pre>\n\n<p>Of course, you have to also pad your field with <code>-20</code>s above and below. By the way, one layer of\n<code>-20</code> is enough. Sample:</p>\n\n<pre><code>sampleInput :: [[Int]]\nsampleInput = [ [-20 , -20 , -20 , -20 , -20 , -20]\n              , [-20 , 10  , 0   , 0   , 0   , -20]\n              , [-20 , 0   , 10  , 10  , 10  , -20]\n              , [-20 , 0   , 10  , 0   , 10  , -20]\n              , [-20 , 0   , 10  , 10  , 10  , -20]\n              , [-20 , -20 , -20 , -20 , -20 , -20] ]\n</code></pre>\n\n<p>While we are at it, nothing stops us from applying the whole stencil at once, not just the lower\nright half of it.</p>\n\n<pre><code>adder :: [[Int]] -&gt; [[Int]]\nadder [ ] = [ ]\nadder [x] = [x]\nadder [x, y] = [x, y]\nadder t@[  [_, _], _, _    ] = t\nadder   (u@[_, _]: v: w: us) = u: v: w: adder us\nadder t = afterPass !! 0: adder (afterPass !! 1: afterPass !! 2: us)\n  where\n    t' = applyStencil t\n\n    (  (x: xs)\n     : (y: ys)\n     : (z: zs)\n     : us\n     ) = t'\n\n    xyzs = [xs, ys, zs]\n\n    afterPass = [x: adder xyzs !! 0, y: adder xyzs !! 1, z: adder xyzs !! 2]\n\napplyStencil\n      s@( (xa: xb: xc: xs)\n        : (ya: yb: yc: ys)\n        : (za: zb: zc: zs)\n        : us\n        )\n    | yb &gt; 9 =\n        ( (xa + 1: xb + 1: xc + 1: xs)\n        : (ya + 1: yb    : yc + 1: ys)\n        : (za + 1: zb + 1: zc + 1: zs)\n        : us\n        )\n    | otherwise = s\n</code></pre>\n\n<p>So, here we are, another solution. It is probably more efficient.  It is also good that you put\ncreative force into the problem.</p>\n\n<hr>\n\n<p>To the future reader, for context: this question and answer continue <a href=\"https://stackoverflow.com/q/58793029\">the line of inquiry started\nin our previous cooperation with Jakub</a>.</p>\n"}], "owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 58836932, "answer_count": 2, "score": 0, "last_activity_date": 1573647377, "creation_date": 1573594388, "last_edit_date": 1573640156, "question_id": 58827023, "link": "https://stackoverflow.com/questions/58827023/how-to-make-my-function-move-through-two-lists-at-once", "title": "How to make my function move through two lists at once?", "body": "<p>I'm trying to make a function that will take a list of lists of <code>Int</code>s as an input, and adds +1 every time it runs into a number bigger or equal to 10. I added -20 on each side so <code>xc</code> can start at 0.\nExample what should happen after the function runs into first '10':</p>\n\n<pre><code>     [[-20,-20, 0, 0, 0, 0, 0, 0, 0,-20,-20],\n      [-20,-20, 0,10, 1, 0, 0, 0, 0,-20,-20],\n      [-20,-20, 1, 1, 1, 0,10, 0, 0,-20,-20],\n      [-20,-20, 0, 0, 0,10, 0, 0, 0,-20,-20],\n      [-20,-20, 0, 0, 0, 0, 0, 0,10,-20,-20],\n      [-20,-20,10,10,10, 0, 0, 0, 0,-20,-20],\n      [-20,-20,10, 0,10, 0, 0, 0, 0,-20,-20],\n      [-20,-20,10,10,10, 0, 0, 0, 0,-20,-20]]\n\nSampleInput = [[-20,-20, 0, 0, 0, 0, 0, 0, 0,-20,-20],\n               [-20,-20, 0,10, 0, 0, 0, 0, 0,-20,-20],\n               [-20,-20, 0, 0, 0, 0,10, 0, 0,-20,-20],\n               [-20,-20, 0, 0, 0,10, 0, 0, 0,-20,-20],\n               [-20,-20, 0, 0, 0, 0, 0, 0,10,-20,-20],\n               [-20,-20,10,10,10, 0, 0, 0, 0,-20,-20],\n               [-20,-20,10, 0,10, 0, 0, 0, 0,-20,-20],\n               [-20,-20,10,10,10, 0, 0, 0, 0,-20,-20]]\n\nadder::[[Int]] -&gt; [[Int]]\nadder ((xa:xb:xc:xd:xe):(ya:yb:yc:yd:ye)) \n    | xc &gt;= 10  = adder ((xb:xc:(xd+1):xe):((yb+1):(yc+1):(yd+1):ye))\n    | otherwise = adder ((xb:xc:xd:xe):(yb:yc:yd:ye)) \n</code></pre>\n\n<p>I also dont know how to apply <code>xa : adder</code>... which we could do fairly easily if it was a single list. Any ideas how to fix this code?\nAlso, you can replace -20 with anything up to 10 if needed, its just for orientation, since I plan to delete these -20s after the function is applied to the list.</p>\n\n<p>I will want to run function second time on a reversed list, you can see why if you imagine minesweeper where 10s are mines</p>\n"}, {"tags": ["string", "list", "haskell"], "comments": [{"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 1, "creation_date": 1573578944, "post_id": 58823367, "comment_id": 103923982, "body": "It seems that you want to add your new element x at the end of the list. In Haskell, it is much more efficient to add it at the beginning of the list, this is just expression <code>(x:list)</code>. This is because the Haskell runtime system maintains only a pointer to the beginning of the list. Remember, lists can be unlimited, so in general you cannot maintain a pointer to the end of the list."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1573586132, "post_id": 58823367, "comment_id": 103927158, "body": "Appending to a list like this can produce a list that is very inefficient to iterate over. Consider using a different data structure (such as a <a href=\"https://wiki.haskell.org/Difference_list\" rel=\"nofollow noreferrer\">difference list</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1573584186, "post_id": 58823485, "comment_id": 103926351, "body": "FWIW, I would not recommend the pointfree version to a beginner who does not know how to append an element to a list. The last one is shorter and obvious, the former required me to stop and think for a while."}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": true, "score": 5, "last_activity_date": 1573579559, "last_edit_date": 1573579559, "creation_date": 1573578589, "answer_id": 58823485, "question_id": 58823367, "link": "https://stackoverflow.com/questions/58823367/how-to-add-new-string-element-to-a-list-of-strings/58823485#58823485", "title": "How to add new string element to a list of strings?", "body": "<p>You want to add an element of type string at the end, so, you can concat that element wrapped into a list and use the existing <code>(++)</code> function:</p>\n\n<pre><code>(++) :: [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>so you will have to take your element and put it inside a list, like this:</p>\n\n<pre><code>AddToLS [\"one\", \"two\"] \"three\"\n</code></pre>\n\n<p>will be:</p>\n\n<pre><code>[\"one\", \"two\"] ++ [\"three\"]\n</code></pre>\n\n<p>but you can define your own <code>concat</code> only for list of strings, as I can see, the arguments are flipped:</p>\n\n<pre><code>AddToLS :: [String] -&gt; String -&gt; [String]\naddToLS = flip $ (++) . (:[]) \n</code></pre>\n\n<p>that's equivalent to:</p>\n\n<pre><code>AddToLS :: [String] -&gt; String -&gt; [String]\naddToLS ss s = ss ++ [s]\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8215123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/498b063694552ee0fa4765a9f2931bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Dodande", "link": "https://stackoverflow.com/users/8215123/dodande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 58823485, "answer_count": 1, "score": 2, "last_activity_date": 1573579559, "creation_date": 1573578079, "question_id": 58823367, "link": "https://stackoverflow.com/questions/58823367/how-to-add-new-string-element-to-a-list-of-strings", "title": "How to add new string element to a list of strings?", "body": "<p>In my homework, I want to write a function which adds a string to a list of strings, but I have no idea how to do it.</p>\n\n<p>I thought it would be something like this:</p>\n\n<pre><code>AddToLS :: [String] -&gt; String -&gt; [String]\nAddToLS ls s = (ls : s)\n</code></pre>\n\n<p>But this code doesn't even compile.</p>\n\n<p>It should work like this:</p>\n\n<pre><code>AddToLS [] \"one\" =[\"one\"]\nAddToLS [\"one\"] \"two\" =[\"one\",\"two\"]\nAddToLS [\"one\",\"two\"] \"there\" =[\"one\",\"two\",\"there\"]\n</code></pre>\n"}, {"tags": ["haskell", "pattern-matching", "list-comprehension"], "comments": [{"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 1, "creation_date": 1573563218, "post_id": 58818919, "comment_id": 103915611, "body": "To me it appears that as currently written, <code>matchChars</code> can only produce lists of length 2.  It seems quite similar to <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:zip\" rel=\"nofollow noreferrer\">zip</a> , except that it returns a list of short lists instead of a list of pairs. Is this what you want ?"}, {"owner": {"reputation": 77, "user_id": 9846020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047f8fe7686d13943599f64329e5a976?s=128&d=identicon&r=PG&f=1", "display_name": "T.Naz", "link": "https://stackoverflow.com/users/9846020/t-naz"}, "reply_to_user": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1573563588, "post_id": 58818919, "comment_id": 103915807, "body": "@jpmarinier I didn&#39;t use zip because it doesnt match each element with each element and only zips the elements on the same index."}, {"owner": {"reputation": 77, "user_id": 9846020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047f8fe7686d13943599f64329e5a976?s=128&d=identicon&r=PG&f=1", "display_name": "T.Naz", "link": "https://stackoverflow.com/users/9846020/t-naz"}, "reply_to_user": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1573563785, "post_id": 58818919, "comment_id": 103915903, "body": "@RobinZigmond I thought about that, but I don&#39;t want to remove stringy from x and y before they were matched, because I may loose valid pairings this way, if I remove strings of the length minor 7."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573563923, "post_id": 58818919, "comment_id": 103915976, "body": "@T.Naz sorry, I deleted my comment as I realised I&#39;d misread what you were trying to achieve."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1573564079, "post_id": 58818919, "comment_id": 103916072, "body": "You want to <code>filter</code> the resulting list (<code>takeWhile</code> stops taking when the condition fails, even if later elements fulfil it again). The predicate you use should take a list <code>[a, b]</code> and check the combined length of the two strings. Is that enough of a hint?"}], "answers": [{"tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": true, "score": 3, "last_activity_date": 1573568467, "last_edit_date": 1573568467, "creation_date": 1573564260, "answer_id": 58819494, "question_id": 58818919, "link": "https://stackoverflow.com/questions/58818919/filtering-through-a-list-of-lists-of-strings-to-get-a-list-of-lists-of-strings-w/58819494#58819494", "title": "Filtering through a list of lists of strings to get a list of lists of strings with a certain length", "body": "<p>In your case, I think that <code>filter</code> is more appropriate than <code>takeWhile</code>, just like Robin.\nLike this:</p>\n\n<pre><code> \u03bb&gt; \n \u03bb&gt; myFilter = filter (\\[ls1, ls2] -&gt; (7 &gt; (length ls1 + length ls2)))\n \u03bb&gt; \n \u03bb&gt; myFilter  [[\"aaa\", \"bbbb\"],[\"c\", \"dd\"]]\n [[\"c\",\"dd\"]]\n \u03bb&gt; \n</code></pre>\n\n<p>Function <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:takeWhile\" rel=\"nofollow noreferrer\">takeWhile</a> is solely for getting an initial and <strong>contiguous</strong> segment of items that satisfy your predicate.</p>\n"}], "owner": {"reputation": 77, "user_id": 9846020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047f8fe7686d13943599f64329e5a976?s=128&d=identicon&r=PG&f=1", "display_name": "T.Naz", "link": "https://stackoverflow.com/users/9846020/t-naz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58819494, "answer_count": 1, "score": 1, "last_activity_date": 1573568467, "creation_date": 1573562261, "last_edit_date": 1573563117, "question_id": 58818919, "link": "https://stackoverflow.com/questions/58818919/filtering-through-a-list-of-lists-of-strings-to-get-a-list-of-lists-of-strings-w", "title": "Filtering through a list of lists of strings to get a list of lists of strings with a certain length", "body": "<p>I've got the following function, which takes two lists and matches each element with each element and returns a list of lists of strings.</p>\n\n<pre><code>matchChars:: [t] -&gt; [t] -&gt; [[t]]\nmatchChars x y = [[a,b] | a&lt;-x, b &lt;-y]\n</code></pre>\n\n<p>Now I want to modify the function, so that the strings in the list of lists don't overcome a certain length. \nFor example: lets say <code>matchChars</code> produces the Output <code>[[\"aaa\", \"bbbb\"],[\"c\", \"dd\"]]</code>. I want to filter out all the sublists where the two strings together have a length of 7 or higher. So in this example <code>[\"aaa\", \"bbbb\"]</code> would be filtered out.</p>\n\n<p>I already tried:</p>\n\n<pre><code>matchChars:: [t] -&gt; [t] -&gt; [[t]]\nmatchChars x y = takeWhile ((&lt;= 7) . length) [[a,b] | a&lt;-x, b &lt;-y]\n</code></pre>\n\n<p>But this doesn't work as it iterates over the length of the sublists and not over the string length. Does anybody have an idea how to solve my problem?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1573559080, "post_id": 58818027, "comment_id": 103913369, "body": "To avoid passing the <code>f</code> each time."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573559226, "post_id": 58818027, "comment_id": 103913456, "body": "@WillemVanOnsem That&#39;s a quick answer!. Can you elaborate a little bit more? It doesn&#39;t seem obvious since <code>go</code> is actually passed, and <code>go</code> contains <code>f</code> in its definition.... isn&#39;t it?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1573559846, "post_id": 58818027, "comment_id": 103913760, "body": "&quot;More natural&quot; is in the eye of the beholder. To me <code>go</code> is very natural. It zips its two list arguments. Zips with what? With something it knows about. That &quot;something&quot; is irrelevant to the rcursive machinery of zipping."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1573565005, "post_id": 58818027, "comment_id": 103916552, "body": "@n.&#39;pronouns&#39;m. There is nothing subjective to Occam&#39;s razor. <code>go</code> is a new entity, and there is no concept underlying it \u2014 they did not even come up with a real name. So it is an elaboration, and it is, denotationally, extraneous \u2014 <i>unnatural</i>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1573567656, "post_id": 58818027, "comment_id": 103917743, "body": "You don&#39;t even have the most readable version of <code>go</code>. Define <code>go (x:xs) (y:ys)</code> first, then the other two base cases reduce to the single case <code>go _ _ = []</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1573567778, "post_id": 58818027, "comment_id": 103917817, "body": "@IgnatInsarov <code>go</code> is a closure over <code>f</code>; I&#39;d say that&#39;s pretty conceptual."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573570568, "post_id": 58818027, "comment_id": 103919364, "body": "@chepner Closure is <a href=\"https://stackoverflow.com/a/33307944\">such a wide term</a> that your sentence substantiates <code>go</code> no more than if you said <i>&quot;<code>go</code> is a function&quot;</i>. Besides, <i>&quot;closure&quot;</i> is quite an extraneous concept itself \u2014 an implementation detail! Then again, I do not think people use this concept of closure in the context of Haskell programming so often. So, if <code>go</code> is nothing but a closure, it hardly deserves a name, and your argument fortifies mine: the definition without <code>go</code> is indeed objectively more natural."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1573570809, "post_id": 58818027, "comment_id": 103919498, "body": "@IgnatInsarov Fine, pick whatever precisely defined term you want."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573571712, "post_id": 58818027, "comment_id": 103920040, "body": "@chepner I did not mean to sound abrasive. My point though is exactly that no precise definition for the role of <code>go</code> in <code>zipWith</code> has come up so far, and moreover that it is not clear whether it needs to be there at all."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1573571942, "post_id": 58818027, "comment_id": 103920180, "body": "@IgnatInsarov I always say, be careful with sharp tools, you can cut yourself."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1573572764, "post_id": 58818027, "comment_id": 103920647, "body": "@n.&#39;pronouns&#39;m. Occam&#39;s razor does not cut humans, only ideas."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1573576867, "post_id": 58818027, "comment_id": 103922954, "body": "A <code>NOINLINE[1]</code> pragma doesn&#39;t mean &quot;don&#39;t inline at all.&quot; It means &quot;don&#39;t inline until the first optimization round stabilizes.&quot; This is important for making sure it has an opportunity to participate in <code>foldr</code>/<code>build</code> fusion before simple inlining is tried. <code>foldr</code> itself not having the inlining delay suggests something about the order in which optimizations are applied, but I&#39;m not totally sure what."}], "answers": [{"comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1573570692, "post_id": 58820292, "comment_id": 103919431, "body": "Is <code>zipWith</code> with <code>go</code> self-recursive though?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1573572006, "post_id": 58820292, "comment_id": 103920218, "body": "It&#39;s 100% about performance of compiled code. Making the top-level definition non-recursive allows it to be inlined, which results in <code>go</code> being defined someplace where <code>f</code> is in scope, which means that if <code>f</code> is known it will get inlined into the recursive part. This reduces the use of indirect function calls for potentially significant speedups."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1573572455, "post_id": 58820292, "comment_id": 103920463, "body": "You say it&#39;s not about performance, but it actually is. If you make a closure as in GHC&#39;s Prelude, you copy the pointer to <code>f</code>&#39;s thunk once, then look it up in the closure once per list element you produce. If you don&#39;t, as in the proposed alternative implementation, you copy the pointer to <code>f</code>&#39;s thunk once per list element you produce, plus then still have to look it up in the newly created closure. GHC is smart enough to <i>sometimes</i> eliminate this latter cost, so these days this technique is only faster when multiple arguments are read-only, but it wasn&#39;t always so."}, {"owner": {"reputation": 1780, "user_id": 5886238, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6-9qKyv9RFM/AAAAAAAAAAI/AAAAAAAAAeY/hvJfgvauxDk/photo.jpg?sz=128", "display_name": "Andrew Ray", "link": "https://stackoverflow.com/users/5886238/andrew-ray"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1573572485, "post_id": 58820292, "comment_id": 103920474, "body": "@Carl, that&#39;s a fair point; I didn&#39;t consider <code>zipWith</code> itself being inlined."}, {"owner": {"reputation": 1780, "user_id": 5886238, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6-9qKyv9RFM/AAAAAAAAAAI/AAAAAAAAAeY/hvJfgvauxDk/photo.jpg?sz=128", "display_name": "Andrew Ray", "link": "https://stackoverflow.com/users/5886238/andrew-ray"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1573572693, "post_id": 58820292, "comment_id": 103920607, "body": "@DanielWagner, I had thought that that was optimized away in any case, but I&#39;ll defer to your expertise on that one."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1573574670, "post_id": 58820292, "comment_id": 103921696, "body": "Hi @AndrewRay. Thanks for answering, but <code>zipWith</code> is marked with <code>NOINLINE [1] zipWith</code> pragma, which makes me hesitate about your point. Check for the edit if you will"}, {"owner": {"reputation": 1780, "user_id": 5886238, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6-9qKyv9RFM/AAAAAAAAAAI/AAAAAAAAAeY/hvJfgvauxDk/photo.jpg?sz=128", "display_name": "Andrew Ray", "link": "https://stackoverflow.com/users/5886238/andrew-ray"}, "edited": false, "score": 0, "creation_date": 1573574812, "post_id": 58820292, "comment_id": 103921795, "body": "@Ismor, that indicates that <code>zipWith</code> should not be inlined itself. The point about inlining <code>f</code> in the definition of <code>go</code> still stands unless I&#39;m misunderstanding the pragma statement."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1573576116, "post_id": 58820292, "comment_id": 103922508, "body": "@AndrewRay In the question linked in the edit, the accepted answer says that <code>f</code> is inlined in the definition of <code>go</code> when <code>foldr</code> is inlined. I am not trying to argue against you and you&#39;re probably right, but this is somehow contradictory information. (@Carl&#39;s comment actually is about inlining <code>zipWith</code> so <code>f</code> can be inlined too)"}], "tags": [], "owner": {"reputation": 1780, "user_id": 5886238, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6-9qKyv9RFM/AAAAAAAAAAI/AAAAAAAAAeY/hvJfgvauxDk/photo.jpg?sz=128", "display_name": "Andrew Ray", "link": "https://stackoverflow.com/users/5886238/andrew-ray"}, "is_accepted": false, "score": 4, "last_activity_date": 1573574870, "last_edit_date": 1573574870, "creation_date": 1573567494, "answer_id": 58820292, "question_id": 58818027, "link": "https://stackoverflow.com/questions/58818027/why-are-some-prelude-functions-defined-in-terms-of-a-locally-defined-function/58820292#58820292", "title": "Why are some Prelude functions defined in terms of a locally defined function?", "body": "<p>As Willem Van Onsem mentioned in his comment, this means that <code>f</code> doesn't need to be passed in each recursive call. </p>\n\n<p>Your version of the function uses the recursive call <code>zipWith f xs ys</code>. Because <code>f</code> is an argument of <code>zipWith</code>, it has to get passed repeatedly. This means that it isn't obvious from looking at <code>zipWith</code> that <code>f</code> never changes from one level of recursion to the next.</p>\n\n<p>The <code>Prelude</code> version uses the recursive call <code>go xs ys</code>, which immediately signals that every recursive call to <code>go</code> makes use of the same <code>f</code>. Being able to immediately notice invariants like this helps us reason logically about our code.</p>\n\n<p><strong>EDIT</strong>: I had previously believed that inlining wasn't relevant here, but  Carl and Daniel Wagner both point out that the thunk <code>f</code> only needs to be evaluated once and substituted in the definition of <code>go</code>, rather than being reevaluated for every recursion as would be the case in your definition of <code>zipWith</code>.</p>\n\n<p>You also mention loop-fusion, which is the process of merging adjacent traversal functions into a single traversal. Since this is already a single traversal, that doesn't apply here either.</p>\n"}], "owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "closed_date": 1573572275, "answer_count": 1, "score": 9, "last_activity_date": 1573574870, "creation_date": 1573559053, "last_edit_date": 1573574553, "question_id": 58818027, "link": "https://stackoverflow.com/questions/58818027/why-are-some-prelude-functions-defined-in-terms-of-a-locally-defined-function", "closed_reason": "Duplicate", "title": "Why are some Prelude functions defined in terms of a locally defined function?", "body": "<p>I was taking a look at some prelude functions to teach a workmate about recursion and I found that some are written in rather a <em>weird</em> way. Example:</p>\n\n<pre><code>{-# NOINLINE [1] zipWith #-}\nzipWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\nzipWith f = go\n  where\n    go [] _ = []\n    go _ [] = []\n    go (x:xs) (y:ys) = f x y : go xs ys\n</code></pre>\n\n<p>Why is it written as a call to <code>go</code> where <code>go</code> is defined right afterwards? IMO a more <em>natural</em> way to define it is: </p>\n\n<pre><code>zipWith :: (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]\nzipWith _ [] _ = []\nzipWith _ _ [] = [] \nzipWith f (x:xs) (y:ys) = f x y : zipWith f xs ys\n</code></pre>\n\n<p>I guess it is due to some <em>inline / loop-fusion / lazy / whatever-feature</em> that allow <code>GHC</code> to optimize better, but this is the point in which Haskell becomes quite obscure to me. Can anyone explain (as easier as possible) the reason for such a function definition, if there is any.</p>\n\n<h2>Edits</h2>\n\n<p>Many comments, @AndrewRay's answer and in this <a href=\"https://stackoverflow.com/questions/26243014/why-does-foldr-use-a-helper-function\">question</a>, point in the direction of inlining as the reason for such an auxiliar local function. Nevertheless, <code>zipWith</code> is marked with the pragma <code>NOINLINE [1] zipWith</code>, which, up to <a href=\"https://downloads.haskell.org/~ghc/7.0.3/docs/html/users_guide/pragmas.html#noinline-pragma\" rel=\"nofollow noreferrer\">GHC's user guide: 7.13.5.5. Phase control</a>, means to <strong>not</strong> inline before first phase and maybe inline afterwards (for whatever this means). In the linked question, the PO refers to <code>foldr</code> which is implemented using the same trick but without any PRAGMA. I'd argue that the author is avoiding inlining but my knowledge in this is small.</p>\n\n<h2>Edit 2</h2>\n\n<p>added link to <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.List.html#zipWith\" rel=\"nofollow noreferrer\">source</a> definition of <code>zipWith</code></p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 6, "creation_date": 1573555111, "post_id": 58816877, "comment_id": 103911391, "body": "What about <code>lst = replicate n v</code>. Note that even if <code>n</code> is gigantic, due to laziness, it will not construct the list, unless really necessary."}, {"owner": {"reputation": 5417, "user_id": 987187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASnN.jpg?s=128&g=1", "display_name": "joel76", "link": "https://stackoverflow.com/users/987187/joel76"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573562602, "post_id": 58816877, "comment_id": 103915288, "body": "It is for an exercice, the list will be printed"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 2, "creation_date": 1573565713, "post_id": 58816877, "comment_id": 103916936, "body": "<code>replicate</code> is the proper way however you may also do like <code>take n $ cycle [v]</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1573573100, "post_id": 58816877, "comment_id": 103920831, "body": "What have you done to determine that this is the performance bottleneck? (With 80% confidence: nothing yet, and if you do anything, you will discover it isn&#39;t.)"}, {"owner": {"reputation": 5417, "user_id": 987187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASnN.jpg?s=128&g=1", "display_name": "joel76", "link": "https://stackoverflow.com/users/987187/joel76"}, "edited": false, "score": 0, "creation_date": 1573580602, "post_id": 58816877, "comment_id": 103924780, "body": "There were 10 tests, 3 failed because my code was too slow. I&#39;m a newbie in Haskell and I was wondering how to improve the speed of the code. With <b>replicate</b>, it was still too slow, The major modification which solve the problem, was to put the result of replicate at the beginning of the list result instead of appending it at the end of the result, and to reverse the final result."}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1573584497, "post_id": 58816877, "comment_id": 103926491, "body": "You could use Difference Lists for efficient appending if you have an append heavy work. <a href=\"https://stackoverflow.com/a/13879693/4543207\">stackoverflow.com/a/13879693/4543207</a>"}, {"owner": {"reputation": 5417, "user_id": 987187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASnN.jpg?s=128&g=1", "display_name": "joel76", "link": "https://stackoverflow.com/users/987187/joel76"}, "edited": false, "score": 0, "creation_date": 1573586401, "post_id": 58816877, "comment_id": 103927270, "body": "Well, I used difference_lists in Prolog, i didn&#39;t know their existence in Haskell. Thank you for the link !"}], "answers": [{"comments": [{"owner": {"reputation": 5417, "user_id": 987187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASnN.jpg?s=128&g=1", "display_name": "joel76", "link": "https://stackoverflow.com/users/987187/joel76"}, "edited": false, "score": 1, "creation_date": 1573565498, "post_id": 58816988, "comment_id": 103916818, "body": "After improving the rest of the code  <b>replicate</b> help me to solve the exercice !, thank you."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1573555417, "creation_date": 1573555417, "answer_id": 58816988, "question_id": 58816877, "link": "https://stackoverflow.com/questions/58816877/faster-way-to-create-a-list/58816988#58816988", "title": "Faster way to create a list", "body": "<p>You can work with <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:replicate\" rel=\"noreferrer\"><strong><code>replicate :: Int -&gt; a -&gt; [a]</code></strong></a> which might be a bit faster:</p>\n\n<pre><code>let lst = <b>replicate</b> n v</code></pre>\n\n<p>but regardless how large <code>n</code> is, you here do not construct a list. Haskell is lazy, so that means that you it simply will store an \"expression\" to construct a list. If you are only interested in the second element, then it will not construct the rest of the list.</p>\n\n<p>Note that due to <a href=\"https://downloads.haskell.org/~ghc/8.0-latest/docs/html/users_guide/glasgow_exts.html#how-rules-interact-with-class-methods\" rel=\"noreferrer\"><em>list fusion</em> [ghc-doc]</a>, the compiler can sometimes rewrite the expression, such that the list is never constructed, and immediately consumed.</p>\n"}], "owner": {"reputation": 5417, "user_id": 987187, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EASnN.jpg?s=128&g=1", "display_name": "joel76", "link": "https://stackoverflow.com/users/987187/joel76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 58816988, "answer_count": 1, "score": 0, "last_activity_date": 1573557561, "creation_date": 1573555040, "last_edit_date": 1573557561, "question_id": 58816877, "link": "https://stackoverflow.com/questions/58816877/faster-way-to-create-a-list", "title": "Faster way to create a list", "body": "<p>I have to create a list of length <code>n</code> with the value <code>v</code> so I write</p>\n\n<pre><code>let lst = [v | _ &lt;- [1..n]]\n</code></pre>\n\n<p>Is there a faster way because <code>n</code> may be huge?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1573553901, "post_id": 58816368, "comment_id": 103910811, "body": "Character literals are written with single quotes, so look for the literal <code>&#39;c&#39;</code>. You could, for example, use pattern matching: <code>delete &#39;c&#39; s = ...</code>"}, {"owner": {"reputation": 21, "user_id": 10508647, "user_type": "registered", "profile_image": "https://graph.facebook.com/222564241853181/picture?type=large", "display_name": "Poor Standard", "link": "https://stackoverflow.com/users/10508647/poor-standard"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1573554651, "post_id": 58816368, "comment_id": 103911174, "body": "See my edit. I don&#39;t want to delete actual c&#39;s, but whatever char given."}, {"owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "edited": false, "score": 0, "creation_date": 1573555364, "post_id": 58816368, "comment_id": 103911499, "body": "In the LHS use a different name for pattern matching (say <code>a</code>). In the RHS of the pattern match use <code>if a == c then ...</code>"}], "owner": {"reputation": 21, "user_id": 10508647, "user_type": "registered", "profile_image": "https://graph.facebook.com/222564241853181/picture?type=large", "display_name": "Poor Standard", "link": "https://stackoverflow.com/users/10508647/poor-standard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1573555024, "answer_count": 0, "score": 1, "last_activity_date": 1573554579, "creation_date": 1573553381, "last_edit_date": 1573554579, "question_id": 58816368, "link": "https://stackoverflow.com/questions/58816368/pattern-matching-using-placeholders", "closed_reason": "Duplicate", "title": "Pattern matching: using placeholders", "body": "<p>I wrote this code to make a function removing every character <code>c</code> in string <code>s</code>.</p>\n\n<pre><code>delete :: Char -&gt; String -&gt; String\ndelete c s =\n    case s of\n        (\"\") -&gt; \"\"\n        (c:t) -&gt; delete c t \n        (a:t) -&gt; a : delete c t\n</code></pre>\n\n<p>I understand that <code>c</code> is just a placeholder for any Char, not the actual <code>c</code> given as first arg.</p>\n\n<p>Is there a way I can use the <code>c</code> argument provided in <code>delete c s</code> in the <code>case</code> construct ?</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 0, "last_activity_date": 1573634979, "creation_date": 1573634979, "answer_id": 58833315, "question_id": 58814553, "link": "https://stackoverflow.com/questions/58814553/how-does-haskell-compile-the-large-numbers/58833315#58833315", "title": "How does Haskell compile the large numbers?", "body": "<p>GHC-compiled executables implement <code>Integer</code> using GMP.</p>\n\n<blockquote>\n  <p>an executable compiled by GHC does not have a third-party GMP library to carry</p>\n</blockquote>\n\n<p>If by that you mean that GHC-compiled executables don't link against GMP, you're mistaken. They do.</p>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1573750560, "creation_date": 1573750560, "answer_id": 58862027, "question_id": 58814553, "link": "https://stackoverflow.com/questions/58814553/how-does-haskell-compile-the-large-numbers/58862027#58862027", "title": "How does Haskell compile the large numbers?", "body": "<p>If you take the program:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  x &lt;- readLn :: IO Integer\n  print $ x + 1\n</code></pre>\n\n<p>and compile it on a Linux machine with the <code>-v</code> flag:</p>\n\n<pre><code>$ ghc -v AddOne.hs\n</code></pre>\n\n<p>then you'll find near the end of the verbose output the <code>gcc</code> command that's used to link the executable together:</p>\n\n<pre><code>*** Linker:\ngcc -fno-stack-protector -DTABLES_NEXT_TO_CODE '-fuse-ld=gold' ...\n</code></pre>\n\n<p>It's a really long line, but if you search through it, you should find (probably near the end) a set of external libraries being linked in:</p>\n\n<pre><code>...  -lHSrts -lCffi -lgmp -lm -lrt -ldl -lpthread\n</code></pre>\n\n<p>That <code>-lgmp</code> there is linking in the GMP library.</p>\n\n<p>You can also use the <code>ldd</code> command to show that there's a dependency on the system GMP library in the executable:</p>\n\n<pre><code>$ ldd AddOne\n...\n        libgmp.so.10 =&gt; /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007fc0da1fa000)\n...\n</code></pre>\n\n<p>At least, this is the case on my system with a recent version of GHC running under Stack.  If you find that on your system there is no GMP dependency, it's probably just because things have been configured to statically link the required GMP code into the executable instead of dynamically linking at runtime.  (For example, I think on Windows, GMP code is statically linked by default.)</p>\n\n<p>To make things slightly more complicated, it is possible to use an <a href=\"https://gitlab.haskell.org/ghc/ghc/wikis/replacing-gmp-notes\" rel=\"nofollow noreferrer\">integer library other than GMP</a>, though this needs to be done at the time GHC itself is compiled.  One alternative mentioned in that link is the <code>integer-simple</code> library, which is a Haskell implementation of large integer operations that's part of the GHC source tree.  So, in that particular case, the executable would be using its own implementation of large number manipulations.  I don't think you're likely to find a standard, pre-compiled GHC that uses something other than GMP, though.</p>\n"}], "owner": {"reputation": 792, "user_id": 9382127, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EMHsr.png?s=128&g=1", "display_name": "Foxy", "link": "https://stackoverflow.com/users/9382127/foxy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 58862027, "answer_count": 2, "score": -1, "last_activity_date": 1573750560, "creation_date": 1573546566, "last_edit_date": 1573657174, "question_id": 58814553, "link": "https://stackoverflow.com/questions/58814553/how-does-haskell-compile-the-large-numbers", "title": "How does Haskell compile the large numbers?", "body": "<p>I would just like to know how it works at compilation time. GHC, for its interpreter, uses the GMP library to generate and manipulate very large numbers, but an executable compiled by GHC does not have a third-party GMP library to carry. So how does the compiler keep the same accuracy? Does the executable have its own implementations of large number manipulations?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 3, "last_activity_date": 1573533408, "creation_date": 1573533408, "answer_id": 58812083, "question_id": 58812056, "link": "https://stackoverflow.com/questions/58812056/concatenating-custom-list-wrapper-data-type/58812083#58812083", "title": "Concatenating custom list wrapper data type", "body": "<p>You can only use <code>++</code> on regular Haskell lists, not on the custom thing you made. Instead of <code>List [Elem x] ++ List [fromList xs]</code>, do <code>List ([Elem x] ++ [fromList xs])</code>. Or since that's just two elements, simplify it as <code>List [Elem x, fromList xs]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "is_accepted": true, "score": 6, "last_activity_date": 1573534046, "creation_date": 1573534046, "answer_id": 58812177, "question_id": 58812056, "link": "https://stackoverflow.com/questions/58812056/concatenating-custom-list-wrapper-data-type/58812177#58812177", "title": "Concatenating custom list wrapper data type", "body": "<p>++ is defined only for [a].  You can:</p>\n\n<pre><code>fromList :: [a] -&gt; NestedList a\nfromList [a] = Elem a\nfromList x = List $ fmap Elem x\n</code></pre>\n\n<p>Though I do not know why you want a special case for only one element list.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 4, "last_activity_date": 1573544543, "last_edit_date": 1573544543, "creation_date": 1573540354, "answer_id": 58813209, "question_id": 58812056, "link": "https://stackoverflow.com/questions/58812056/concatenating-custom-list-wrapper-data-type/58813209#58813209", "title": "Concatenating custom list wrapper data type", "body": "<p>You have already specified what you need quite well with your equation</p>\n\n<pre><code>fromList [5, 6, 7] == List [Elem 5, Elem 6, Elem 7]\n</code></pre>\n\n<p>If we just abstract</p>\n\n<pre><code>fromList xs = List (xs but with Elem applied to each element)\n</code></pre>\n\n<p>that is,</p>\n\n<pre><code>fromList xs = List (map Elem xs)\n</code></pre>\n"}], "owner": {"reputation": 2490, "user_id": 4967929, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fc9ad15bcbdaeb1aeed830f1ad21cc7a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4967929/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 58812177, "answer_count": 3, "score": 2, "last_activity_date": 1573544554, "creation_date": 1573533092, "last_edit_date": 1573544554, "question_id": 58812056, "link": "https://stackoverflow.com/questions/58812056/concatenating-custom-list-wrapper-data-type", "title": "Concatenating custom list wrapper data type", "body": "<p>I have the following data type.</p>\n\n<pre><code>data NestedList a = Elem a | List [NestedList a]\n</code></pre>\n\n<p>Unfortunately, creating samples of this datatype is quite unwieldy.</p>\n\n<pre><code>List [Elem 5, Elem 6, Elem 7, List [Elem 8, Elem 9, Elem 10]]\n</code></pre>\n\n<p>I would like to create a helper <code>fromList</code> that will take a flat array of any type and give back a NestedList which is also flat but contains the same data. So I could make the sample above (excluding the part where it begins to nest) using the helper in this way:</p>\n\n<pre><code>fromList [5, 6, 7] == List [Elem 5, Elem 6, Elem 7]\n</code></pre>\n\n<p>This is what I have so far.</p>\n\n<pre><code>fromList :: [a] -&gt; NestedList a\nfromList [] = List[]\nfromList [a] = Elem a\nfromList (x:xs) = List [Elem x] ++ List [fromList xs]\n</code></pre>\n\n<p>The error messages are:</p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018[a0]\u2019 with actual type \u2018NestedList a\u2019\n\u2022 In the first argument of \u2018(++)\u2019, namely \u2018List [Elem x]\u2019\n\n\n\u2022 Couldn't match expected type \u2018NestedList a\u2019 with actual type \u2018[a0]\u2019\n\u2022 In the expression: List [Elem x] ++ List [fromList xs]\n</code></pre>\n\n<p>I'm not sure why it's telling me that I'm not returning a <code>NestedList</code>. I guess Haskell does not know how to natively concat my new type <code>NestedList</code>? Any help is appreciated!</p>\n"}, {"tags": ["haskell", "traversal", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1573554506, "post_id": 58810721, "comment_id": 103911102, "body": "<code>over</code> is as high level as it gets. What I meant by <i>&quot;low level&quot;</i> is something like <a href=\"https://hackage.haskell.org/package/lens-4.18.1/docs/Control-Lens-Internal-Indexed.html#t:Indexing\" rel=\"nofollow noreferrer\">this</a>:      &gt;&gt;&gt; &quot;cat&quot; ^@.. indexing (folded &lt;&gt; folded)     [(0,&#39;c&#39;),(1,&#39;a&#39;),(2,&#39;t&#39;),(3,&#39;c&#39;),(4,&#39;a&#39;),(5,&#39;t&#39;)]  When I look at <code>folded</code> and <code>traversed</code>, it is <code>indexed</code> and <code>conjoined</code> all over again:      folded = conjoined (foldring foldr) (ifoldring ifoldr)     traversed = conjoined traverse (indexing traverse)  And I am still not grasping what it means. Maybe another question is in order?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1573699169, "post_id": 58810721, "comment_id": 103970467, "body": "@IgnatInsarov it doesn&#39;t <i>mean</i> anything. It&#39;s an implementation detail, not a denotation. <code>conjoined</code> is roughly &quot;here&#39;s the totally separate implementations for when using this traversal indexed or non-indexed, with all the necessary machinery to make GHC inline the correct version when it has enough information to determine which that is.&quot;"}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 2, "last_activity_date": 1573523555, "last_edit_date": 1573523555, "creation_date": 1573521847, "answer_id": 58810721, "question_id": 58809850, "link": "https://stackoverflow.com/questions/58809850/how-does-lens-internal-indexed-connect-to-keyed-containers/58810721#58810721", "title": "How does Lens.Internal.Indexed connect to keyed containers?", "body": "<p><code>Indexable i p</code> really just means \"<code>p</code> is either <code>(-&gt;)</code> or <code>Indexed i</code> (<code>Indexed i a b = i -&gt; a -&gt; b</code>)\". The <code>lens</code> package is built on a tower of very abstract classes that makes everything very general. Specifically, instead of working with functions, it tries to work with general profunctors, but trying to deal with indices basically causes the whole thing to collapse down (very noisily, as you've seen) to just \"the profunctor is either <code>(-&gt;)</code> or <code>Indexed i</code>\".</p>\n\n<p>In any case, you don't care about <code>Indexable</code>. The \"index\" you're talking about is the argument to <code>element</code>. The \"index\" in <code>IndexedTraversable</code> is a \"result\", each element returned by an <code>IndexedTraversable</code> also has its index associated with it. Here, it just returns the argument you passed in again, in case something else wants to get it. You don't. To recover <code>updateAt</code>, simply pass <code>element</code>'s return value to <code>over</code>, specializing <code>p</code> to <code>(-&gt;)</code> and throwing away the duplicated index:</p>\n\n<pre><code>updateAt :: Traversable t =&gt; Int -&gt; (a -&gt; a) -&gt; t a -&gt; t a\nupdateAt = over . element\n-- updateAt i f = over (element i) f\n-- \"over element i do f\"\n</code></pre>\n\n<p>I'd say <code>over</code> is pretty \"low-level\"</p>\n\n<pre><code>-- basically\nover :: ((a -&gt; Identity b) -&gt; (s -&gt; Identity t)) -&gt; (a -&gt; b) -&gt; (s -&gt; t)\nover setter f = runIdentity . setter (Identity . f)\n-- I think even over = coerce would be valid\n-- meaning it's actually just an identity function\n-- and that updateAt = element (but with the type changed)\n</code></pre>\n\n<p>In general, I suppose the \"portal\" to \"operations on <code>Traversable</code> with indices\" is <code>traversed</code>, which basically \"is\" <code>traverse</code> (when you specialize its <code>p</code> to <code>(-&gt;)</code>). <code>elements = elementsOf traverse = elementsOf traversed</code> and <code>element = elementOf traverse = elementsOf traversed</code> just filter for specific indices. </p>\n"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 58810721, "answer_count": 1, "score": 0, "last_activity_date": 1573523555, "creation_date": 1573513815, "question_id": 58809850, "link": "https://stackoverflow.com/questions/58809850/how-does-lens-internal-indexed-connect-to-keyed-containers", "title": "How does Lens.Internal.Indexed connect to keyed containers?", "body": "<p><a href=\"https://stackoverflow.com/a/58574861\">A traversable may be labelled.</a> To take this idea one step further, one may apply a function to any element of a traversable by its index.</p>\n\n<pre><code>import Control.Monad.State\n\nupdateAt :: forall a. Int -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]\nupdateAt i f = flip evalState [0..] . traverse g\n  where\n    g :: a -&gt; State [Int] a\n    g x = do\n        js &lt;- get\n        case js of\n            [ ]      -&gt; error \"\"\n            (j: js') -&gt; do\n                put js'\n                if j == i\n                   then return (f x)\n                   else return x\n</code></pre>\n\n<p>In Haskell, there is an attempt to generalize or otherwise sort out operations like this. First it was <a href=\"https://hackage.haskell.org/package/keys-3.12.2\" rel=\"nofollow noreferrer\">keys</a>, then it grew up into <a href=\"https://hackage.haskell.org/package/lens-4.18.1\" rel=\"nofollow noreferrer\">lens</a>. It is now a huge package. I am trying to make sense of it.</p>\n\n<p>To this end, I am trying to do simple things first. One simple thing is what I started with \u2014 to label a traversable. Can it be done? Further, can it be done on a <em>\"low level\"</em>?</p>\n\n<p><a href=\"https://hackage.haskell.org/package/lens-4.18.1/docs/src/Control.Lens.Traversal.html#element\" rel=\"nofollow noreferrer\"><code>element</code></a> seems to be doing the same as my example above, so I checked its definition. It led me to <a href=\"https://hackage.haskell.org/package/lens-4.18.1/docs/Control-Lens-Internal-Indexed.html#t:Indexable\" rel=\"nofollow noreferrer\"><code>Indexable</code></a>, then to <a href=\"https://hackage.haskell.org/package/lens-4.18.1/docs/Control-Lens-Internal-Indexed.html#t:Conjoined\" rel=\"nofollow noreferrer\">this</a>:</p>\n\n<pre><code>class ( Choice p, Corepresentable p, Comonad (Corep p)\n      , Traversable (Corep p), Strong p, Representable p, Monad (Rep p)\n      , MonadFix (Rep p), Distributive (Rep p), Costrong p, ArrowLoop p\n      , ArrowApply p, ArrowChoice p, Closed p\n      ) =&gt; Conjoined p\n</code></pre>\n\n<p>I admit this is a bit over my head. I like how <em>\"indexable\"</em> sounds \u2014 it must be useful. But it also seems to be the hardest piece of Haskell ever written. I understand that <code>Conjoined</code> is an advanced kind of a profunctor, so basically... a function? I am not sure what it might be, and how this all connects to keyed containers.</p>\n\n<p>Is it applicable to my problem? What is it for? How can I make sense of it?</p>\n"}, {"tags": ["haskell", "types", "liquid-haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1573499282, "post_id": 58806748, "comment_id": 103894044, "body": "<code>elem</code> is a variable, not an infix operator.  Also, where is elem defined?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1573513073, "post_id": 58806748, "comment_id": 103898995, "body": "@ThomasM.DuBuisson Uh, <code>Prelude</code>?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573513229, "post_id": 58806748, "comment_id": 103899030, "body": "@JosephSible But does liquid haskell&#39;s prelude include a lifted logical version of <code>elem</code> is the real question here."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1573513424, "post_id": 58806748, "comment_id": 103899083, "body": "I ask because the (admittedly out-dated) &quot;try liquid haskell&quot; online doesn&#39;t know what <code>elem</code> is so I suspect @kishlaya would have to provide a suitable definition for liquid Haskell to use to define <code>Powers</code> and refinment type check <code>log2</code>."}, {"owner": {"reputation": 393, "user_id": 2176528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136af1bfd8b8c1582d2e56ac08bfcd94?s=128&d=identicon&r=PG", "display_name": "kishlaya", "link": "https://stackoverflow.com/users/2176528/kishlaya"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1573534834, "post_id": 58806748, "comment_id": 103903209, "body": "@ThomasM.DuBuisson I have edited my question with the relevant details."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1573574722, "post_id": 58806748, "comment_id": 103921740, "body": "I still don&#39;t see your same error.  If you look <a href=\"http://goto.ucsd.edu:8090/index.html#?demo=permalink%2F1573574681_92.hs\" rel=\"nofollow noreferrer\">here</a> you see the issue is that <code>powers</code> is not reflected nor can it be trivially."}, {"owner": {"reputation": 393, "user_id": 2176528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136af1bfd8b8c1582d2e56ac08bfcd94?s=128&d=identicon&r=PG", "display_name": "kishlaya", "link": "https://stackoverflow.com/users/2176528/kishlaya"}, "edited": false, "score": 0, "creation_date": 1573581328, "post_id": 58806748, "comment_id": 103925086, "body": "Could you please elaborate on the phrase &quot;<code>powers</code> is not reflected&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1575837231, "post_id": 58844705, "comment_id": 104690622, "body": "Oh my, it can be trivial reflected.  I has a mistaken assumption."}], "tags": [], "owner": {"reputation": 1152, "user_id": 729775, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70ec20c66713dc2fe7ce050263961685?s=128&d=identicon&r=PG", "display_name": "Ranjit Jhala", "link": "https://stackoverflow.com/users/729775/ranjit-jhala"}, "is_accepted": true, "score": 5, "last_activity_date": 1573675163, "creation_date": 1573675163, "answer_id": 58844705, "question_id": 58806748, "link": "https://stackoverflow.com/questions/58806748/how-to-write-a-log2-function-in-liquid-haskell/58844705#58844705", "title": "How to write a log2 function in Liquid Haskell", "body": "<p>@TomMD is referring to the notion of \"reflection\" which lets you convert Haskell functions (under some restrictions) into refinements, e.g. see these posts:</p>\n\n<p><a href=\"https://ucsd-progsys.github.io/liquidhaskell-blog/tags/reflection.html\" rel=\"noreferrer\">https://ucsd-progsys.github.io/liquidhaskell-blog/tags/reflection.html</a></p>\n\n<p>Unfortunately haven't gotten around to updating the tutorial with this material yet.</p>\n\n<p>So for example, you can describe log2/pow2 as shown here:</p>\n\n<p><a href=\"https://ucsd-progsys.github.io/liquidhaskell-blog/tags/reflection.html\" rel=\"noreferrer\">https://ucsd-progsys.github.io/liquidhaskell-blog/tags/reflection.html</a></p>\n\n<p><a href=\"http://goto.ucsd.edu/liquid/index.html#?demo=permalink%2F1573673688_378.hs\" rel=\"noreferrer\">http://goto.ucsd.edu/liquid/index.html#?demo=permalink%2F1573673688_378.hs</a></p>\n\n<p>In particular you can write:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-@ reflect log2 @-}\nlog2 :: Int -&gt; Int\nlog2 1 = 0\nlog2 n = 1 + log2 (div n 2) \n\n{-@ reflect pow2 @-}\n{-@ pow2 :: Nat -&gt; Nat @-}\npow2 :: Int -&gt; Int\npow2 0 = 1\npow2 n = 2 * pow2 (n-1)\n</code></pre>\n\n<p>You can then \"check\" at compile time that the following are true:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>test8 :: () -&gt; Int\ntest8 _ = log2 8 === 3\n\ntest16 :: () -&gt; Int\ntest16 _ = log2 16 === 4\n\ntest3 :: () -&gt; Int\ntest3 _ = pow2 3 === 8\n\ntest4 :: () -&gt; Int\ntest4 _ = pow2 4 === 16 \n</code></pre>\n\n<p>However, the type checker will reject the below</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>test8' :: () -&gt; Int\ntest8' _ = log2 8 === 5     -- type error\n</code></pre>\n\n<p>Finally, you can prove the following theorem relating <code>log2</code> and <code>pow2</code></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-@ thm_log_pow :: n:Nat -&gt; { log2 (pow2 n) == n } @-}\n</code></pre>\n\n<p>The \"proof\" is by \"induction on n\", which means:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>thm_log_pow :: Int -&gt; () \nthm_log_pow 0 = ()\nthm_log_pow n = thm_log_pow (n-1)\n</code></pre>\n\n<p>Returning to your original question, you can define <code>isPow2</code> as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-@ reflect isEven @-}\nisEven :: Int -&gt; Bool\nisEven n = n `mod` 2 == 0\n\n{-@ reflect isPow2 @-}\nisPow2 :: Int -&gt; Bool\nisPow2 1 = True\nisPow2 n = isEven n &amp;&amp; isPow2 (n `div` 2) \n</code></pre>\n\n<p>and you can \"test\" it does the right thing by verifying that:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>testPow2_8 :: () -&gt; Bool\ntestPow2_8 () = isPow2 8 === True \n\ntestPow2_9 :: () -&gt; Bool\ntestPow2_9 () = isPow2 9 === False \n</code></pre>\n\n<p>and finally, by giving <code>pow2</code> the refined type:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-@ reflect pow2 @-}\n{-@ pow2 :: Nat -&gt; {v:Nat | isPow2 v} @-}\npow2 :: Int -&gt; Int\npow2 0 = 1\npow2 n = 2 * pow2 (n-1)\n</code></pre>\n\n<p>Hope this helps!</p>\n"}], "owner": {"reputation": 393, "user_id": 2176528, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/136af1bfd8b8c1582d2e56ac08bfcd94?s=128&d=identicon&r=PG", "display_name": "kishlaya", "link": "https://stackoverflow.com/users/2176528/kishlaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 58844705, "answer_count": 1, "score": 3, "last_activity_date": 1573675163, "creation_date": 1573496768, "last_edit_date": 1573534795, "question_id": 58806748, "link": "https://stackoverflow.com/questions/58806748/how-to-write-a-log2-function-in-liquid-haskell", "title": "How to write a log2 function in Liquid Haskell", "body": "<p>I am trying to learn Liquid Haskell from the <a href=\"http://ucsd-progsys.github.io/liquidhaskell-tutorial/book.pdf\" rel=\"nofollow noreferrer\">book</a>.\nTo test my understanding, I wanted to write a function <code>log2</code> which takes an input of the form 2^n and outputs n.</p>\n\n<p>I have the following code:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>powers :: [Int]\npowers = map (2^) [0..]\n\n{-@ type Powers = {v:Nat | v elem powers } @-}\n{-@ log2 :: Powers -&gt; Nat @-}\nlog2 :: Int -&gt; Int\nlog2 n\n | n == 1 = 0\n | otherwise = 1 + log2 (div n 2)\n</code></pre>\n\n<p>But some strange error occurs while executing this code, namely \"Sort Error in Refinement\". I am unable to understand and resolve this error.</p>\n\n<p>Any help would be really appreciated.</p>\n\n<p>EDIT: From the Liquid Haskell book:</p>\n\n<blockquote>\n  <p>A Predicate is either an atomic predicate, obtained by comparing\n  two expressions, or, an application of a predicate function to a list of\n  arguments...</p>\n</blockquote>\n\n<p>In the Liquid Haskell logic syntax, one of the allowed predicates are: <code>e r e</code> where <code>r</code> is an atomic binary relation (and functions are just special kind of relations).</p>\n\n<p>Also, in the tutorial, they define the <code>Even</code> subtype as:\n<code>{-@ type Even  = {v:Int | v mod 2 == 0 } @-}</code></p>\n\n<p>Based on that, I thought <code>elem</code> should work.</p>\n\n<p>But now as @ThomasM.DuBuisson pointed out, I thought of writing my own <code>elem'</code> instead, so as to avoid confusion.</p>\n\n<pre><code>elem' :: Int -&gt; [Int] -&gt; Bool\nelem' _ [] = False\nelem' e (x:xs)\n | e==x = True\n | otherwise = elem' e xs\n</code></pre>\n\n<p>Now, as far as I understand, to be able to use this <code>elem'</code> as a predicate function, I need to lift it as measure. So I added the following: </p>\n\n<pre><code>{-@ measure elem' :: Int -&gt; [Int] -&gt; Bool @-}\n</code></pre>\n\n<p>Now I replaced <code>elem</code> by <code>elem'</code> in type definition of <code>Powers</code>. But I still get the same error as the previous one.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1573484681, "post_id": 58803859, "comment_id": 103887589, "body": "Did you try to read and understand the error message? What is not clear about the error?"}, {"owner": {"reputation": 31, "user_id": 12356110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3a5773419a44293d006c343962acea?s=128&d=identicon&r=PG&f=1", "display_name": "newUser523590", "link": "https://stackoverflow.com/users/12356110/newuser523590"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573484744, "post_id": 58803859, "comment_id": 103887624, "body": "Sorry, I am a noob which I why I came here. I think it means that take requires an &quot;Int&quot; but I am giving it an &quot;a&quot;"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1573485287, "post_id": 58803859, "comment_id": 103887904, "body": "Your tree structure is wrong. It cannot represent a tree with two data items for example."}, {"owner": {"reputation": 31, "user_id": 12356110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3a5773419a44293d006c343962acea?s=128&d=identicon&r=PG&f=1", "display_name": "newUser523590", "link": "https://stackoverflow.com/users/12356110/newuser523590"}, "edited": false, "score": 0, "creation_date": 1573485542, "post_id": 58803859, "comment_id": 103888018, "body": "What do you mean sorry?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1573485709, "post_id": 58803859, "comment_id": 103888110, "body": "I recommend starting with a function <code>insert :: Ord a =&gt; a -&gt; Tree a -&gt; Tree a</code>. Gets a tree with N items, returns one with N+1 items. Don&#39;t muck with sorting and indices."}, {"owner": {"reputation": 31, "user_id": 12356110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3a5773419a44293d006c343962acea?s=128&d=identicon&r=PG&f=1", "display_name": "newUser523590", "link": "https://stackoverflow.com/users/12356110/newuser523590"}, "edited": false, "score": 0, "creation_date": 1573485877, "post_id": 58803859, "comment_id": 103888193, "body": "I would do it another way, but I have to do it this way as it&#39;s an exercise for school."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1573485989, "post_id": 58803859, "comment_id": 103888249, "body": "If you are talking to someone specific, use the @username convention, then they will get a notification. If you were asking me, I mean exactly what I say. Your tree data structure cannot represent a tree with two data items. You want to try and draw such a tree on a piece of paper, and see why it is impossible."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1573486020, "post_id": 58803859, "comment_id": 103888271, "body": "You probably need to fire your teacher."}, {"owner": {"reputation": 31, "user_id": 12356110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3a5773419a44293d006c343962acea?s=128&d=identicon&r=PG&f=1", "display_name": "newUser523590", "link": "https://stackoverflow.com/users/12356110/newuser523590"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1573486174, "post_id": 58803859, "comment_id": 103888342, "body": "@n.&#39;pronouns&#39;m. yeah my teacher is pretty bad. I have to go now but I will be back later to try and fix this. I thought this would work if I have some termination conditions. You&#39;re right btw. It prints infinitely."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1573493074, "post_id": 58803859, "comment_id": 103891687, "body": "change it to <code>middle :: [a] -&gt; Int</code>, and it&#39;ll fix the type errors. <code>(drop n xs&#39;)</code> is wrong, should be <code>drop (n+1)</code>. <code>n</code> is just an index, should be independent of the list&#39;s values&#39; type. why shouldn&#39;t you also be able to have lists of <code>Char</code>s etc."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1573494222, "post_id": 58803859, "comment_id": 103892108, "body": "@n.&#39;pronouns&#39;m. maybe the teacher wanted the students to discover for themselves what it means to have a fully balanced tree, what size is it, etc, etc. there is much value in finding problems in a design of a solution, and coming up with fixes yourself while learning, instead of being told the right answer upfront. :) maybe the teacher wanted the students to see for themselves there <i>is</i> a problem, in the first place."}, {"owner": {"reputation": 31, "user_id": 12356110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3a5773419a44293d006c343962acea?s=128&d=identicon&r=PG&f=1", "display_name": "newUser523590", "link": "https://stackoverflow.com/users/12356110/newuser523590"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1573501189, "post_id": 58803859, "comment_id": 103894738, "body": "I think drop needs to stay the same @WillNess"}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573490386, "post_id": 58803932, "comment_id": 103890362, "body": "You probably want <code>drop (n + 1) xs&#39;</code> to avoid storing the middle element at the root <i>and</i> in the right subtree. (Or <code>take (n-1) xs&#39;</code>)."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1573485380, "last_edit_date": 1573485380, "creation_date": 1573484868, "answer_id": 58803932, "question_id": 58803859, "link": "https://stackoverflow.com/questions/58803859/couldnt-match-expected-type-int-with-actual-type-a/58803932#58803932", "title": "Couldn&#39;t match expected type `Int&#39; with actual type `a&#39;", "body": "<p>The problem is that <code>middle</code> returns an <code>a</code>, not an <code>Int</code>. Indeed:</p>\n\n<pre><code>middle :: Num a =&gt; [a] -&gt; <b>a</b>\nmiddle xs = fromIntegral ((length xs `div` 2) + 1)</code></pre>\n\n<p>But in your <code>balancedTree</code>, you use it as if it is an index, and <code>take n</code>, <code>drop n</code>, and <code>!! n</code> require <code>n</code> to be an <code>Int</code>, indeed:</p>\n\n<pre><code>balancedTree :: Ord a =&gt; [a] -&gt; Tree a\nbalancedTree (x:[]) = Leaf x\nbalancedTree xs = Node (balancedTree (take <b>n</b> xs')) (<b>xs'!!n</b>) (balancedTree (drop <b>n</b> xs'))\n    where \n        xs' = sort xs\n        <b>n = middle xs</b></code></pre>\n\n<p>The type signature does not make much sense either. You can calculate the length over any list, not only from lists that consist out of numbers. You thus should construct a function that returns the <em>index</em> in the middle of the list and use that. For example:</p>\n\n<pre><code>middle :: [a] -&gt; <b>Int</b>\nmiddle = (length xs `div` 2) + 1</code></pre>\n\n<p>That being said, using <code>length</code>, etc. is usually <em>not</em> a good idea in Haskell. <code>length</code> requires <em>O(n)</em> time, and furthermore for infinite lists, it will get stuck in an infinite loop. Often if you use functions like <code>length</code>, there is a more elegant solution.</p>\n\n<p>Instead of using a \"top-down\" approach, it might be better to look at a \"bottom-up\" approach, where you iterate over the items, and on the fly construct <code>Leaf</code>s, and group these together in <code>Node</code>s until you reach the top.</p>\n"}], "owner": {"reputation": 31, "user_id": 12356110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a3a5773419a44293d006c343962acea?s=128&d=identicon&r=PG&f=1", "display_name": "newUser523590", "link": "https://stackoverflow.com/users/12356110/newuser523590"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 338, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1573486400, "creation_date": 1573484615, "last_edit_date": 1573486400, "question_id": 58803859, "link": "https://stackoverflow.com/questions/58803859/couldnt-match-expected-type-int-with-actual-type-a", "title": "Couldn&#39;t match expected type `Int&#39; with actual type `a&#39;", "body": "<pre><code>import Data.List\n\ndata Tree a = Leaf a | Node (Tree a) a (Tree a) deriving Show\n\ntoTree :: Ord a =&gt; [a] -&gt; Tree a\ntoTree xs = Node (balancedTree (take n xs')) (xs'!!n) (balancedTree (drop n xs'))\n    where \n        xs' = sort xs\n        n = middle xs\n\nmiddle :: Num a =&gt; [a] -&gt; a\nmiddle xs = fromIntegral ((length xs `div` 2) + 1)\n\nbalancedTree :: Ord a =&gt; [a] -&gt; Tree a\nbalancedTree (x:[]) = Leaf x\nbalancedTree xs = Node (balancedTree (take n xs')) (xs'!!n) (balancedTree (drop n xs'))\n    where \n        xs' = sort xs\n        n = middle xs\n</code></pre>\n\n<p>This is my code for converting from a list to a binary tree. I know there are many mistakes but I just want to get the types errors sorted before I start debugging. I get the following errors in both the \"toTree\" method and the \"balancedTree\" method as they are both really the same and will be condensed into one when the errors are sorted out.</p>\n\n<pre><code>ex7.hs:6:38: error:\n    * Couldn't match expected type `Int' with actual type `a'\n      `a' is a rigid type variable bound by\n        the type signature for:\n          toTree :: forall a. Ord a =&gt; [a] -&gt; Tree a\n        at ex7.hs:5:1-32\n    * In the first argument of `take', namely `n'\n      In the first argument of `balancedTree', namely `(take n xs')'\n      In the first argument of `Node', namely\n        `(balancedTree (take n xs'))'\n    * Relevant bindings include\n        xs' :: [a] (bound at ex7.hs:8:9)\n        n :: a (bound at ex7.hs:9:9)\n        xs :: [a] (bound at ex7.hs:6:8)\n        toTree :: [a] -&gt; Tree a (bound at ex7.hs:6:1)\n  |\n6 | toTree xs = Node (balancedTree (take n xs')) (xs'!!n) (balancedTree (drop n xs'))\n  |                                      ^\n</code></pre>\n\n<p>I have tried for hours to fix it by searching stackOverflow but I can't figure it out. The type declaration of \"toTree\" must stay the same. Also the definition of Tree should stay the same. </p>\n\n<p>My understanding is that \"take\" required an \"Int\" and I am giving it an \"a\". I do not know how I can fix this.</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "dependent-type", "existential-type", "continuation-passing"], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 6, "last_activity_date": 1573494551, "last_edit_date": 1573494551, "creation_date": 1573488613, "answer_id": 58804866, "question_id": 58802651, "link": "https://stackoverflow.com/questions/58802651/how-do-i-lazily-transform-a-list-into-this-type/58804866#58804866", "title": "How do I lazily transform a list into this type?", "body": "<p>This is going to be an unsatisfying answer, but I'm going to post it anyway.</p>\n\n<hr>\n\n<p>I don't think this is technically possible, because the head of the result should contain the type <code>n</code>, and types cannot be lazily constructed. They're sort of \"ephemeral\", don't really exist at runtime as such, but <em>logically</em> they have to be fully known.</p>\n\n<p>(I am not 100% sure the above is correct though)</p>\n\n<hr>\n\n<p>However, if you really need to do this, you can cheat. Observe that the polymorphic continuation doesn't actually know anything about <code>n</code>. The only thing it can possibly find out about <code>n</code> is whether it's a <code>Zero</code> or <code>Succ</code>, but even that is not actually encoded at runtime in any way. Instead, it gets inferred from whichever constructor of <code>Vect</code> matches during pattern match. This means that, at runtime, we don't actually have to pass in the correct type for <code>n</code>. Sure, the compiler will get anxious during compilation if it can't prove the type is right, but we can convince it to shut up with <code>unsafeCoerce</code>:</p>\n\n<pre><code>listToVect1 :: [a] -&gt; (forall n. Vect n a -&gt; b) -&gt; b\nlistToVect1 xs f = f $ go xs\n  where\n    go :: [a] -&gt; Vect Zero a\n    go [] = Nil\n    go (x:xs) = unsafeCoerce $ Cons x (go xs)\n</code></pre>\n\n<p>Here, the second line of <code>go</code> constructs a <code>Vect (Succ Zero) a</code>, but then erases its <code>n</code> component to <code>Zero</code>. This happens at every step, so the ultimate result is always <code>Vect Zero a</code>. This result is then passed to the continuation, which is none the wiser, because it doesn't care.</p>\n\n<p>When the continuation later tries to match on <code>Vect</code>'s constructors, it works fine, because the constructors have been instantiated correctly in the right order, reflecting the correct shape of the vector, and by extension, the correct shape of <code>n</code>.</p>\n\n<p>This works, try it:</p>\n\n<pre><code>vectLen :: Vect n a -&gt; Int\nvectLen Nil = 0\nvectLen (Cons _ xs) = 1 + vectLen xs\n\ntoList :: Vect n a -&gt; [a]\ntoList Nil = []\ntoList (Cons a xs) = a : toList xs\n\nmain :: IO ()\nmain = do\n  print $ listToVect1 [1,2,3] vectLen        -- prints 3\n  print $ listToVect1 [] vectLen             -- prints 0\n  print $ listToVect1 [1,2,3,4,5] vectLen    -- prints 5\n\n  print $ listToVect1 [1,2,3] toList         -- prints [1,2,3]\n  print $ listToVect1 ([] :: [Int]) toList   -- prints []\n  print $ listToVect1 [1,2,3,4,5] toList     -- prints [1,2,3,5]\n</code></pre>\n\n<hr>\n\n<p>Of course, the above is fragile. It relies (to an extent) on some lower-level knowledge. If this is not just a curiosity exercise, I would rather go back and rethink the original problem that lead you to this.</p>\n\n<p>But for what it's worth, this technique of \"hiding ugliness by hand-waving\" is in a relatively common use in lower-level libraries.</p>\n"}], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1573494551, "creation_date": 1573480163, "question_id": 58802651, "link": "https://stackoverflow.com/questions/58802651/how-do-i-lazily-transform-a-list-into-this-type", "title": "How do I lazily transform a list into this type?", "body": "<p>Consider this <code>Vect</code> type:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, KindSignatures, RankNTypes #-}\n\nimport Data.Kind (Type)\n\ndata Nat = Zero | Succ Nat\n\ndata Vect :: Nat -&gt; Type -&gt; Type where\n  Nil :: Vect 'Zero a\n  Cons :: a -&gt; Vect n a -&gt; Vect ('Succ n) a\n</code></pre>\n\n<p>I'd like to write a function that takes a list and lazily transforms it to this type. Since the length obviously isn't known, we need to use an existential. My first attempt at this used CPS and a rank-2 type to emulate one:</p>\n\n<pre><code>listToVect1 :: [a] -&gt; (forall n. Vect n a -&gt; b) -&gt; b\nlistToVect1 [] f = f Nil\nlistToVect1 (x:xs) f = listToVect1 xs (f . Cons x)\n</code></pre>\n\n<p>However, this isn't lazy. This is just a foldl (though written as explicit recursion because actually using <code>foldl</code> would require impredicativity), so <code>f</code> won't start running until it's gone all the way to the end of the list.</p>\n\n<p>I can't think of a way to do CPS in a right-associative manner, so I tried again, this time with a wrapper type instead:</p>\n\n<pre><code>data ArbitraryVect a = forall n. ArbitraryVect (Vect n a)\n\nnil :: ArbitraryVect a\nnil = ArbitraryVect Nil\n\ncons :: a -&gt; ArbitraryVect a -&gt; ArbitraryVect a\ncons x (ArbitraryVect xs) = ArbitraryVect (Cons x xs)\n\nlistToVect2 :: [a] -&gt; ArbitraryVect a\nlistToVect2 = foldr cons nil\n</code></pre>\n\n<p>The problem with this attempt is that I have to use <code>data</code> rather than <code>newtype</code> (or I get <code>A newtype constructor cannot have existential type variables</code>), and I need to pattern-match strictly in <code>cons</code> (or I get <code>An existential or GADT data constructor cannot be used inside a lazy (~) pattern</code>), so it doesn't return anything until it's through the entire list.</p>\n\n<p>I don't have any other ideas for how to do this. Is this even possible? If so, how? If not, why not?</p>\n"}, {"tags": ["string", "haskell", "recursion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1573476932, "post_id": 58801647, "comment_id": 103883548, "body": "Your second function is <code>takeword</code> with a lowercase, it should be <code>takeWord</code>."}, {"owner": {"reputation": 67, "user_id": 8215123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/498b063694552ee0fa4765a9f2931bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Dodande", "link": "https://stackoverflow.com/users/8215123/dodande"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573480143, "post_id": 58801647, "comment_id": 103885159, "body": "Thanks, I didn&#39;t notice it."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1573477112, "creation_date": 1573477112, "answer_id": 58801861, "question_id": 58801647, "link": "https://stackoverflow.com/questions/58801647/how-to-get-string-from-a-text-til-first-space-with-a-recursive-function/58801861#58801861", "title": "How to get string from a text til first space with a recursive function?", "body": "<p>You defined two functions here: <code>take<b>W</b>ord</code>, with an uppercase <code>W</code>, and <code>take<b>w</b>ord</code> with a lowercase <code>w</code>. The former one only works with empty lists, the latter one only works with non-empty lists.</p>\n\n<p>You thus should pick one of the two names, like:</p>\n\n<pre><code>takeWord :: [Char] -&gt; [Char]\ntakeWord [] = []\ntake<b>W</b>ord (x:xs) \n    | x == ' ' = []\n    | otherwise = x : take<b>W</b>ord xs</code></pre>\n\n<p>we can make it a bit more elegant by matching with a space in the pattern, and not in the guard:</p>\n\n<pre><code>takeWord :: [Char] -&gt; [Char]\ntakeWord [] = []\ntakeWord (<b>' '</b>:_) = \"\"\ntakeWord (x:xs) = x : takeWord xs</code></pre>\n\n<p>Note that you can make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:takeWhile\" rel=\"noreferrer\"><strong><code>takeWhile :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code></strong></a> here:</p>\n\n<pre><code>takeWord :: [Char] -&gt; [Char]\ntakeWord = <b>takeWhile</b> (' ' /=)</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8215123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/498b063694552ee0fa4765a9f2931bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Dodande", "link": "https://stackoverflow.com/users/8215123/dodande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 58801861, "answer_count": 1, "score": 3, "last_activity_date": 1573479928, "creation_date": 1573476359, "last_edit_date": 1573479928, "question_id": 58801647, "link": "https://stackoverflow.com/questions/58801647/how-to-get-string-from-a-text-til-first-space-with-a-recursive-function", "title": "How to get string from a text til first space with a recursive function?", "body": "<p>In my homework, my task is to write a recursive function which returns the first word of a text and <code>\"\"</code> if the first character is a space.</p>\n\n<p>Here is my function:</p>\n\n<pre><code>takeWord :: [Char] -&gt; [Char]\ntakeWord [] = []\ntakeword (x:xs) \n    | x == ' ' = []\n    | otherwise = x : takeword xs\n</code></pre>\n\n<p>It should work like this:</p>\n\n<pre><code>takeWord \" one\"    = \"\"\ntakeWord \"one two\" = \"one\"\ntakeWord \"\"        = \"\"    --returns with \"Non-exhaustive patterns in function takeword\"\ntakeWord \"one\"     = \"one\" --and this too\n</code></pre>\n\n<p>But at the cases where is no space, it returns with this error message:</p>\n\n<blockquote>\n  <p>Non-exhaustive patterns in function takeword</p>\n</blockquote>\n\n<p>What would be the correct code?</p>\n"}, {"tags": ["haskell", "ghc", "stack-trace"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1573477543, "post_id": 58801394, "comment_id": 103883836, "body": "This happens (I guess) because <code>op</code> and <code>httpCall</code> are not functions, so GHC has to decide where is the &quot;call point&quot;, the point where the &quot;call&quot; is logged into the stack trace. This is where the constraint is resolved by type inference, which might be not so intuitive. Consider to disambiguate this by having <code>httpCall :: HasCallStack =&gt; () -&gt; IO ()</code>, just for the sake of experimenting, and see if the result is more intuitive."}, {"owner": {"reputation": 354, "user_id": 3343425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b9956c6595bd2f3d27bed1383f46b60?s=128&d=identicon&r=PG&f=1", "display_name": "fghibellini", "link": "https://stackoverflow.com/users/3343425/fghibellini"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1573481100, "post_id": 58801394, "comment_id": 103885683, "body": "If <a href=\"https://repl.it/repls/BlondBothTransversals\" rel=\"nofollow noreferrer\">this</a> is what you meant, it doesn&#39;t change anything."}, {"owner": {"reputation": 354, "user_id": 3343425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b9956c6595bd2f3d27bed1383f46b60?s=128&d=identicon&r=PG&f=1", "display_name": "fghibellini", "link": "https://stackoverflow.com/users/3343425/fghibellini"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573505413, "post_id": 58801394, "comment_id": 103896339, "body": "here&#39;s the above code as a <a href=\"https://gist.github.com/fghibellini/680c45e4a6660e00a0a697fb742502da\" rel=\"nofollow noreferrer\">gist</a> (I can&#39;t freeze the repl.it code)"}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": false, "score": 0, "last_activity_date": 1573603046, "creation_date": 1573603046, "answer_id": 58828435, "question_id": 58801394, "link": "https://stackoverflow.com/questions/58801394/haskell-hascallstack-unexpected-behavior/58828435#58828435", "title": "Haskell HasCallStack unexpected behavior", "body": "<p>For both problems 1 and 2, note that <code>HasCallStack</code> call stacks are fundamentally \"lexical\".</p>\n\n<p>Specifically, with respect to \"problem 1\", the call site (function name and line number) information in the call stack is based on where syntactically in the program the called function appears, not the line of code that actually forces the call to be made.  So, the reason <code>httpCall</code> is shown to be called from line 17 and not line 14 is because the literal program text \"<code>httpCall</code>\" appears on line 17.  Similarly for \"problem 2\", the thing called on line 14 appears lexically as <code>op</code>, not <code>httpCall</code>, so that's how it appears in the call stack.</p>\n\n<p>With respect to the behavior of your programs:</p>\n\n<p>In your first program, the <code>HasCallStack</code> constraints on <code>retry</code> and <code>httpCall</code> in <code>main</code> are resolved by pushing appropriate call entries (with lexical call site information) onto an empty call stack (because <code>main</code> provides no <code>HasCallStack</code> instance itself).  If we made the call stack argument explicit, the code would look something like:</p>\n\n<pre><code>httpCall :: CallStack -&gt; IO ()\nhttpCall callStack = do\n  putStrLn $ prettyCallStack callStack\n  print \"http resolved\"\n\nretry :: CallStack -&gt; IO () -&gt; IO ()\nretry callStack op =\n  forM_ [1] $ \\i -&gt;\n    op\n\nmain :: IO ()\nmain = retry (push1 emptyCallStack) (httpCall (push2 emptyCallStack))\n  where push1 = pushCallStack (\"retry\", SrcLoc \"\" \"\" \"\" 15 7 15 11)\n        push2 = pushCallStack (\"httpCall\", SrcLoc \"\" \"\" \"\" 15 13 15 20)\n</code></pre>\n\n<p>Note that the <code>callStack</code> argument to <code>retry</code> that records the <code>retry</code> call (<code>push1</code>) isn't actually used.  When <code>httpCall</code> is evaluated, it gets passed <code>push2 emptyCallStack</code> which generates a single entry for the <code>httpCall</code> call in <code>main</code>.</p>\n\n<p>I think all that is more or less what you assumed was happening (i.e., the <code>HasCallStack</code> constraint gets resolved in main to fit the argument type of <code>retry</code>).</p>\n\n<p>In your second program, something interesting happens that perhaps isn't well documented.  The <code>retry</code> call is treated the same way as before, but the <code>httpCall</code> -- because it is typed as <code>HasCallStack =&gt; IO ()</code> instead of <code>IO ()</code> -- produces code that expects an instance to be in scope instead of resolving the instance immediately.  With explicit call stack arguments, the code generated for <code>retry</code> and <code>main</code> would now look something like:</p>\n\n<pre><code>retry :: CallStack -&gt; (CallStack -&gt; IO ()) -&gt; IO ()\nretry callStack op =\n  forM_ [1] $ \\i -&gt;\n    op (push3 callStack)\n  where push3 = pushCallStack (\"op\", SrcLoc \"\" \"\" \"\" 14 4 14 6)\n\nmain :: IO ()\nmain = retry (push1 emptyCallStack) (\\callStack -&gt; httpCall (push2 callStack))\n  where push1 = pushCallStack (\"retry\", SrcLoc \"\" \"\" \"\" 17 7 17 11)\n        push2 = pushCallStack (\"httpCall\", SrcLoc \"\" \"\" \"\" 17 13 17 20)\n</code></pre>\n\n<p>The result is that <code>httpCall</code> actually gets <code>push2 $ push3 $ push1 emptyCallStack</code> as its argument, so you see the three entries for <code>httpCall</code>, <code>op</code>, and <code>retry</code> in that order.</p>\n"}], "owner": {"reputation": 354, "user_id": 3343425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b9956c6595bd2f3d27bed1383f46b60?s=128&d=identicon&r=PG&f=1", "display_name": "fghibellini", "link": "https://stackoverflow.com/users/3343425/fghibellini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1573603046, "creation_date": 1573475405, "last_edit_date": 1573484789, "question_id": 58801394, "link": "https://stackoverflow.com/questions/58801394/haskell-hascallstack-unexpected-behavior", "title": "Haskell HasCallStack unexpected behavior", "body": "<p>The following is a simplification of a pretty common pattern we have, where you have some retry combinator wrapping an IO operation. I would like to have some stack traces so I added the <code>HasCallStack</code> constraint but the resulting stacktrace was not really satisfactory:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Control.Monad (forM_)\nimport GHC.Stack\n\nhttpCall :: HasCallStack =&gt; IO ()\nhttpCall = do\n  putStrLn $ prettyCallStack callStack\n  print \"http resolved\"\n\nretry :: HasCallStack =&gt; IO () -&gt; IO ()\nretry op =\n  forM_ [1] $ \\i -&gt;\n    op\n\nmain :: IO ()\nmain = retry httpCall\n</code></pre>\n\n<p>stacktrace:</p>\n\n<pre><code>CallStack (from HasCallStack):\n  httpCall, called at main.hs:16:14 in main:Main\n\"http resolved\"\n</code></pre>\n\n<p>I assumed the <code>HasCallStack</code> constraint gets resolved in <code>main</code> to fit the argument type of <code>retry</code> so I added the constraint to the argument type:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE RankNTypes #-}\n\nimport Control.Monad (forM_)\nimport GHC.Stack\n\nhttpCall :: HasCallStack =&gt; IO ()\nhttpCall = do\n  putStrLn $ prettyCallStack callStack\n  print \"http resolved\"\n\nretry :: HasCallStack =&gt; (HasCallStack =&gt; IO()) -&gt; IO () -- NOTICE the constraint in the argument\nretry op =\n  forM_ [1] $ \\i -&gt;\n    op\n\nmain :: IO ()\nmain = retry httpCall\n</code></pre>\n\n<p>Now the stacktrace has 2 more entries both of them quite surprising:</p>\n\n<pre><code>CallStack (from HasCallStack):\n  httpCall, called at main.hs:17:14 in main:Main\n  op, called at main.hs:14:5 in main:Main\n  retry, called at main.hs:17:8 in main:Main\n\"http resolved\"\n</code></pre>\n\n<h2>Problems</h2>\n\n<ol>\n<li><code>httpCall</code> reports it was called from <code>main</code> (line 17)</li>\n<li><code>op</code> reports the correct line but is quite unexpected to see it in the stacktrace to begin with.</li>\n</ol>\n\n<p>I expected something along the lines of:</p>\n\n<pre><code>CallStack (from HasCallStack):\n  httpCall, called at main.hs:14:5 in main:Main\n  retry, called at main.hs:17:8 in main:Main\n\"http resolved\"\n</code></pre>\n"}, {"tags": ["haskell", "monads", "functor", "applicative"], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 0, "creation_date": 1573464651, "post_id": 58798624, "comment_id": 103877821, "body": "Thanks got it. (&lt;*) fa fb = liftA2 (\\a _ -&gt; a) fa fb  &amp;&amp; (*&gt;) fa fb = liftA2 (_ b -&gt; b) fa fb. Can also please comment on my assumptions to the bottom of the question."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 0, "creation_date": 1573466988, "post_id": 58798624, "comment_id": 103878981, "body": "@PKChem I don&#39;t understand the last part of your question. Are you referring to two other type classes <code>Sequential</code> and <code>Parallel</code>? I don&#39;t know about those, sorry."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1573464287, "creation_date": 1573464287, "answer_id": 58798624, "question_id": 58798486, "link": "https://stackoverflow.com/questions/58798486/how-to-define-in-terms-of-and-pure/58798624#58798624", "title": "How to define (*&gt;), (&lt;*) in terms of (&lt;*&gt;) and pure?", "body": "<p>The standard definition is</p>\n\n<pre><code>(&lt;*) :: Applicative m =&gt; m a -&gt; m b -&gt; m a\n(&lt;*) fa fb = (\\a _ -&gt; a) &lt;$&gt; fa &lt;*&gt; fb\n</code></pre>\n\n<p>We can then apply the law <code>f &lt;$&gt; x = pure f &lt;*&gt; x</code> to only use <code>&lt;*&gt;</code> and <code>pure</code>.</p>\n\n<p>The other one is analogous.</p>\n"}], "owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 58798624, "answer_count": 1, "score": 1, "last_activity_date": 1573464287, "creation_date": 1573463776, "last_edit_date": 1573464112, "question_id": 58798486, "link": "https://stackoverflow.com/questions/58798486/how-to-define-in-terms-of-and-pure", "title": "How to define (*&gt;), (&lt;*) in terms of (&lt;*&gt;) and pure?", "body": "<p>I can define them using monads.</p>\n\n<pre><code>(&lt;*) :: Monad m =&gt; m a -&gt; m b -&gt; m a\n(&lt;*) fa fb = fa &gt;&gt;= \\a -&gt; (fb &gt;&gt;= \\_ -&gt; return a)\n(&lt;*) fa fb = ??? -- In terms of pure &amp; (&lt;*&gt;)\n\n(*&gt;) :: Monad m =&gt; m a -&gt; m b -&gt; m b\n(*&gt;) fa fb = fa &gt;&gt;= \\_ -&gt; (fb &gt;&gt;= \\b -&gt; return b)\n(*&gt;) fa fb = ??? -- In terms of pure &amp; (&lt;*&gt;)\n</code></pre>\n\n<p><code>(\\*&gt;)</code> and <code>(&lt;\\*)</code> are considered as sequencing operators. Can I safely assume that Applicatives can do work in both Sequential and Parallel? Monads are just a  sub category of applicatives only capable of doing things sequentiallay. And  even though it doesn't matter the order of operations for few monads like the reader monad (example reading configurations from a <code>HashMap</code> of environment settings)?</p>\n"}, {"tags": ["function", "haskell", "syntax", "type-mismatch", "function-call"], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 7, "last_activity_date": 1573439298, "creation_date": 1573439298, "answer_id": 58794858, "question_id": 58794828, "link": "https://stackoverflow.com/questions/58794828/what-is-the-haskell-reverse-function-expected-in-this-code/58794858#58794858", "title": "What is the Haskell reverse function expected in this code?", "body": "<p>That's not how parentheses work in Haskell. The way you wrote it, <code>reverse</code> and <code>abcdata</code> would both be arguments to <code>shifter</code>, but you want <code>abcdata</code> to be an argument to <code>reverse</code>. Do <code>shifter l n (reverse abcdata)</code> instead of <code>shifter l n reverse(abcdata)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1573472083, "last_edit_date": 1573472083, "creation_date": 1573457354, "answer_id": 58797157, "question_id": 58794828, "link": "https://stackoverflow.com/questions/58794828/what-is-the-haskell-reverse-function-expected-in-this-code/58797157#58797157", "title": "What is the Haskell reverse function expected in this code?", "body": "<blockquote>\n  <p>What am I doing wrong by calling <code>shifter</code> with <code>reverse(abcdata)</code> ?</p>\n</blockquote>\n\n<p>The answer <em>is</em> in the message:</p>\n\n<pre><code>    * Couldn't match expected type `[Char] -&gt; Char'\n                  with actual type `Char'\n    * The function `shifter' is applied to four arguments,\n      but its type `Char -&gt; Int -&gt; [Char] -&gt; Char' has only three\n      In the expression: shifter l n reverse (abcdata)\n      In an equation for `inverseShift':\n          inverseShift l n = shifter l n reverse (abcdata)\n</code></pre>\n\n<p>Repeat,</p>\n\n<h3><i>\n          <code>In an equation for `inverseShift':</code><br/><h1>\n          <code>    inverseShift l n = shifter l n reverse (abcdata)</code><br />\n          <code>                                     ~~~~~~~~~~~~~   -- mind the gap!  </code>\n</h1></i></h3>\n\n<p><em>That</em> is how your expression was read by Haskell. And <em>this</em> is how it was written by you:</p>\n\n<pre><code>   |\n21 | inverseShift l n = shifter l n reverse(abcdata)\n   |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>So you haven't in fact called <code>shifter</code> with <code>reverse(abcdata)</code>.</p>\n\n<p>You called it with <code>reverse</code> <em>and</em> <code>(abcdata)</code> (as well <code>l</code> and <code>n</code>), as is also explained in the other answer.</p>\n"}], "owner": {"reputation": 492, "user_id": 4170988, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-AOOLG8v7KNM/AAAAAAAAAAI/AAAAAAAAIJA/BO3ac6ZxzyM/photo.jpg?sz=128", "display_name": "Frederick &#193;lvarez", "link": "https://stackoverflow.com/users/4170988/frederick-%c3%81lvarez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 58794858, "answer_count": 2, "score": 1, "last_activity_date": 1573472083, "creation_date": 1573439049, "last_edit_date": 1573457481, "question_id": 58794828, "link": "https://stackoverflow.com/questions/58794828/what-is-the-haskell-reverse-function-expected-in-this-code", "title": "What is the Haskell reverse function expected in this code?", "body": "<p>I'm writing a small Haskell exercise, it is should shift some elements within a list, similar to a Caesar cipher, the code is already working, the code is below.</p>\n\n<pre><code>module Lib (shift, cipherEncode, cipherDecode ) where\nimport Data.Char\nimport Data.List\nimport Data.Maybe\n\nabcdata :: [Char]\nabcdata = ['a','b','c','d','e','f','g']\n\niabcdata :: [Char]\niabcdata = ['g','f','e','d','c','b','a']\n\nshift :: Char -&gt; Int -&gt; Char\nshift l n = if (n &gt;= 0)\n            then normalShift l n\n            else inverseShift l (abs n)\n\nnormalShift :: Char -&gt; Int -&gt; Char\nnormalShift l n = shifter l n abcdata\n\ninverseShift :: Char -&gt; Int -&gt; Char\ninverseShift l n = shifter l n reverse(abcdata) -- This is the line\n\ncharIdx :: Char -&gt; [Char] -&gt; Int\ncharIdx target xs = fromJust $ elemIndex target xs\n\nshifter :: Char -&gt; Int -&gt; [Char] -&gt; Char\nshifter l n xs = if (n &lt; length (xs))\n            then\n                picker ((charIdx l xs) + n) xs\n            else\n                picker ((charIdx l xs) + (n `mod` length (xs))) xs\n\npicker :: Int -&gt; [Char] -&gt; Char\npicker n xs = if n &lt; length xs\n              then\n                xs!!n\n              else\n                xs!!(n `mod` length (xs))\n</code></pre>\n\n<p>The question I have is regarding the line</p>\n\n<p><code>inverseShift l n = shifter l n reverse(abcdata)</code></p>\n\n<p>If I change it by </p>\n\n<p><code>inverseShift l n = shifter l n iabcdata</code></p>\n\n<p>it works fine</p>\n\n<p>also, when I do <code>reverse(abcdata) == iabcdata</code> it is <code>True</code>\nbut when I leave the <code>reverse</code> in the code I get the following error</p>\n\n<pre><code>    * Couldn't match expected type `[Char] -&gt; Char'\n                  with actual type `Char'\n    * The function `shifter' is applied to four arguments,\n      but its type `Char -&gt; Int -&gt; [Char] -&gt; Char' has only three\n      In the expression: shifter l n reverse (abcdata)\n      In an equation for `inverseShift':\n          inverseShift l n = shifter l n reverse (abcdata)\n   |\n21 | inverseShift l n = shifter l n reverse(abcdata)\n   |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n    * Couldn't match expected type `[Char]'\n                  with actual type `[a0] -&gt; [a0]'\n    * Probable cause: `reverse' is applied to too few arguments\n</code></pre>\n\n<p>What am I doing wrong by calling <code>shifter</code> with <code>reverse(abcdata)</code> ?</p>\n"}, {"tags": ["list", "haskell", "minesweeper"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 2, "creation_date": 1573423449, "post_id": 58793029, "comment_id": 103868287, "body": "I think this problem was already posted <a href=\"https://stackoverflow.com/questions/58763683/function-that-replaces-space-with-number-which-represents-stars-around#comment103815110_58763683\">here</a>. I don\u2019t think I can close this as a duplicate though because neither this question nor that one has any answers yet. But I\u2019ll repeat my comment from that question here:"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 2, "creation_date": 1573423492, "post_id": 58793029, "comment_id": 103868295, "body": "Here\u2019s some hints: (1) Try create a function which, given a coordinate, returns all the points around that coordinate in a given <code>Result</code>; (2) Then try create a function which, given a <code>Result</code>, returns a nested list of all coordinates in it (e.g. <code>[&quot;ab&quot;,&quot;cd&quot;]</code> becomes <code>[[(0,0),(0,1)],[(1,0),(1,1)]]</code>); (3) Try to use these two functions together to solve your problem."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573491656, "post_id": 58795879, "comment_id": 103891029, "body": "Alright, this looks very promising. However, I think I need several things explained first in order to even try putting it to use. I have not encountered . operator and am unsure what function applies to what. Is it possible to rewrite it without dots? I also didnt figure out how to turn on -fdefer-typed-holes and didnt quite understand what is in the link you attached. Also, you didn&#39;t need to leave holes. Its not about whether it is boring but about me being able to understand what I should need to do. Also, what other approaches could I take if I wanted to avoid stencil? Thanks for help"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573498813, "post_id": 58795879, "comment_id": 103893850, "body": "@JakubKudlej Dot operator is simply function composition. I do not think it makes sense to avoid it in Haskell. You can supply <code>-fdefer-typed-holes</code> to <code>ghc</code> as a command line argument, or you can say <code>:set -fdefer-typed-holes</code> in <code>ghci</code>. You cannot really avoid stencil, because it is in the very definition of your problem. Overall, I do not think it gets any simpler than this. I gave you structure, separated the problem into small chunks. If you find any particular subproblem too hard, you can ask a precise question about it. I really want to help you, but you have got to learn Haskell, too."}, {"owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 0, "creation_date": 1573500523, "post_id": 58795879, "comment_id": 103894529, "body": "Should that be <code>stencil (i,j)</code> at the end of the <code>applyStencil</code> line? It seems like you eta reduced it but only on one side."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "reply_to_user": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573501386, "post_id": 58795879, "comment_id": 103894822, "body": "Stencil convolution on nested lists, that&#39;s intense ;) @Jakub Kudlej, once you are ready for the 4th optimization step, you can start over here: <a href=\"https://github.com/lehins/massiv#stencil\" rel=\"nofollow noreferrer\">github.com/lehins/massiv#stencil</a> There are some examples on how to create your own stencils and apply them to actual arrays. Arrays in Haskell are slightly more involved than lists, so I&#39;d recommend to understand this answer first."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 0, "creation_date": 1573503198, "post_id": 58795879, "comment_id": 103895489, "body": "@Potato44 Thanks for catching this."}, {"owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573504655, "post_id": 58795879, "comment_id": 103896035, "body": "Alright, tried to do the first step although it&#39;s probably wrong.      charsToInts :: [[Char]] -&gt; [[Int]] charsToInts = (fmap . fmap) charToInt   where     charToInt &#39;*&#39; = 1     charToInt &#39; &#39; = 0  intsToChars :: [[Int]] -&gt; [[Char]] intsToChars = (fmap . fmap) intToChar     where            intToChar 0 = &#39;0&#39;         intToChar 1 = &#39;1&#39;         intToChar 2 = &#39;2&#39;         intToChar 3 = &#39;3&#39;         intToChar 4 = &#39;4&#39;         intToChar 5 = &#39;5&#39;         intToChar 6 = &#39;6&#39;         intToChar 7 = &#39;7&#39;         intToChar 8 = &#39;8&#39;"}, {"owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573505313, "post_id": 58795879, "comment_id": 103896294, "body": "anyways,here is my attempt on indices: indices::[[a]] -&gt; [[(Int, Int)]] indices ((x:xs):ys) = [[(c,r)|c&lt;-[0..(length(x:xs))]]|r&lt;-[0..(length((x:xs):ys))]]"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573507059, "post_id": 58795879, "comment_id": 103896983, "body": "@JakubKudlej See, not hard at all!"}, {"owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573538672, "post_id": 58795879, "comment_id": 103904210, "body": "I don&#39;t think I did what we need in chars to ints and ints to char part though"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573553039, "post_id": 58795879, "comment_id": 103910331, "body": "@JakubKudlej I put your code in the program and it worked. What makes you think it does not?"}, {"owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 0, "creation_date": 1573584998, "post_id": 58795879, "comment_id": 103926690, "body": "another small error, <code>pp</code> shouldn&#39;t be included in the definition of <code>minesweeper</code>"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "edited": false, "score": 0, "creation_date": 1573586325, "post_id": 58795879, "comment_id": 103927236, "body": "@Potato44 True."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "reply_to_user": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "edited": false, "score": 0, "creation_date": 1573676864, "post_id": 58795879, "comment_id": 103963802, "body": "@JakubKudlej please put your attempts above, and leave them out of the comments section. Putting that in the comments section makes it difficult for future readers to get value from your question."}], "tags": [], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "is_accepted": true, "score": 4, "last_activity_date": 1573586373, "last_edit_date": 1573586373, "creation_date": 1573449475, "answer_id": 58795879, "question_id": 58793029, "link": "https://stackoverflow.com/questions/58793029/minesweeper-board-labels-beginner-level/58795879#58795879", "title": "Minesweeper board labels (beginner level)", "body": "<p>What you need here is called <em>\"stencil convolution\"</em>. Look at this picture:</p>\n\n<pre><code>111\n1x1\n111\n</code></pre>\n\n<p>This is your stencil. Pick a tile on the playing board and place the stencil on top of that tile.\nHow many <code>1</code>s overlay mines, that number we should display in this tile. For example:</p>\n\n<pre><code>       .....   .....\n111    .*...   .....\n1x1  + ..x*. = ..3..\n111    ...*.   .....\n       .....   .....\n</code></pre>\n\n<p>Once we apply this operation to the whole board, we are basically done.</p>\n\n<p>There are advanced devices for this, such as comonads and arrays, but for the purpose of this post\nI will keep things simple, so we are going to draft everything by hand, in the simplest types. I\nam also going to leave some blanks in the code, so that it is less boring for the reader. If you\nenable <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#typed-holes\" rel=\"nofollow noreferrer\"><code>-fdefer-typed-holes</code></a>, you can put things like <code>_wut</code> in place of <code>...</code> and <code>ghc</code>\nwill tell you what it thinks the type of the hole should be.</p>\n\n<hr>\n\n<ol>\n<li><p>I should like to deal with numbers, rather than characters: as you point out, characters\nare ill-suited for algorithmic work. Conversion should be two way, so that we can display our\nresult as well.</p>\n\n<pre><code>charsToInts :: [[Char]] -&gt; [[Int]]\ncharsToInts = (fmap . fmap) charToInt\n  where\n    charToInt '*' = ...\n    charToInt ... = ...\n\nintsToChars :: [[Int]] -&gt; [[Char]]\nintsToChars = ...\n</code></pre></li>\n<li><p>A nested list is not a very comfortable type to work with. We will define some helper functions\nto make it easier. The operation that we will surely need is <em>\"indexing\"</em>, that is, accessing an\nelement by its index \u2014 if it is there in the first place.</p>\n\n<pre><code>lookup2DMaybe :: [[a]] -&gt; (Int, Int) -&gt; Maybe a\nlookup2DMaybe u (i, j) = do\n    xs' &lt;- lookupMaybe xs  i\n    x   &lt;- ...\n    return x\n  where\n    lookupMaybe :: [a] -&gt; Int -&gt; Maybe a\n    lookupMaybe xs i\n        | 0 &lt;= i &amp;&amp; i &lt; length xs = ...\n        | ...                     = ...\n</code></pre></li>\n<li><p>Now, to interesting stuff \u2014 stencil application.</p>\n\n<pre><code>applyStencil :: [[Int]] -&gt; (Int, Int) -&gt; Int\napplyStencil u = sum . Data.Maybe.catMaybes . fmap (... u) . stencil\n  where\n    stencil :: (Int, Int) -&gt; [(Int, Int)]\n    stencil (i, j) = [ (i + di, ...) | di &lt;- ..., dj &lt;- ..., (di, dj) /= ... ]\n</code></pre>\n\n<p>Does this work?</p>\n\n<pre><code>\u03bb applyStencil (charsToInts sampleInput) (3, 5)\n2\n\u03bb applyStencil (charsToInts sampleInput) (6, 1)\n8\n</code></pre></li>\n<li><p>All that is left to do is to <em>\"map\"</em> the stencil all around the minefield. To this end, we are\ngoing to generate a board where at every point its coordinates are written. I hope somewhere along\nthe way you will see why.</p>\n\n<pre><code>indices :: [[a]] -&gt; [[(Int, Int)]]\nindices u = [ [ ... | ... ] | ... ]\n</code></pre>\n\n<p>The idea here is that we give it a board of anything, and it creates a board of coordinates of\nthe same size.</p></li>\n<li><p>Consider the type we have so far:</p>\n\n<pre><code>\u03bb :type applyStencil (charsToInts sampleInput) \napplyStencil (charsToInts sampleInput) :: (Int, Int) -&gt; Int\n</code></pre>\n\n<p>So, this is a function that converts coordinates to the number of mines around these\ncoordinates. What happens if we map it over a board of coordinates?</p>\n\n<pre><code>fill :: [[Int]] -&gt; [[Int]]\nfill u = (fmap.fmap) (... u) (... u)\n\n\u03bb intsToChars (fill (charsToInts sampleInput))\n[\"1110000\",\"1011110\",\"1122110\",\"0011221\",\"2332110\",\"2422011\",\"4843000\",\"2422000\"]\n</code></pre>\n\n<p>Looks about right, does it not?</p></li>\n<li><p>Only small things left to do: given two boards of characters, overlay them. This is outlined in\n<a href=\"https://stackoverflow.com/a/58685116\">an answer to another question</a> about lists of lists. <em>(We get a lot of of questions of this\nkind of late. Say hi to your professor from the Stack Overflow Haskell Teacher's Assistants\nTeam!)</em></p></li>\n<li><p>Final solution!</p>\n\n<pre><code>minesweeper x = overlay x (intsToChars . fill . charsToInts $ x)\n</code></pre>\n\n<p>Not hard at all!</p></li>\n</ol>\n\n<hr>\n\n<p>There are some ways to improve this code:</p>\n\n<ol>\n<li>Create a specialized type for the board, such that only correct boards can be constructed.</li>\n<li>Define a comonad for that type.</li>\n<li>Scratch the type altogether and generalize the code to the Store comonad.</li>\n<li>Use efficient array processing.</li>\n</ol>\n\n<p>But the ideas we explored are there to last.</p>\n\n<p>Some further reading:</p>\n\n<ol>\n<li><a href=\"https://jaspervdj.be/posts/2014-11-27-comonads-image-processing.html\" rel=\"nofollow noreferrer\">The basics of stencil convolution.</a></li>\n<li><a href=\"http://blog.ielliott.io/comonad-transformers-in-the-wild/\" rel=\"nofollow noreferrer\">The use of standard comonad types.</a></li>\n<li><a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2016/07/Stencil.pdf\" rel=\"nofollow noreferrer\">Advanced optimization of stencil convolution.</a></li>\n</ol>\n\n<p>&nbsp;</p>\n\n<p>Let me know how it goes!</p>\n"}], "owner": {"reputation": 63, "user_id": 12352441, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/--bSQApUlq6g/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH9EvnDJS47rUWDtJ11JVamMWVqg/photo.jpg?sz=128", "display_name": "Jakub Kudlej", "link": "https://stackoverflow.com/users/12352441/jakub-kudlej"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 498, "favorite_count": 1, "accepted_answer_id": 58795879, "answer_count": 1, "score": 1, "last_activity_date": 1604175766, "creation_date": 1573420843, "last_edit_date": 1573672628, "question_id": 58793029, "link": "https://stackoverflow.com/questions/58793029/minesweeper-board-labels-beginner-level", "title": "Minesweeper board labels (beginner level)", "body": "<p>We were given a homework, where we get a sample minesweeper-like board, with blank spaces instead of numbers (board is in [String] form) and already placed mines. What we need is to create a function, that replaces all blank spaces with numbers, which are equal to number of adjecent mines.</p>\n\n<p>I was unable of making any real progress, except for removing all spaces with zeroes, which is probably not even useful in any way. I also had a problem with zeroes being of Char type, which made me unable to add for example +1 to it. It would be great if this could be solved without advanced functions, so I can understand it, but any solution or at least idea of solution will do.</p>\n\n<p>This is what the beginning of the code should look like.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Char\n\ntype Result = [String]\n\npp :: Result -&gt; IO ()\npp x = putStr (concat (map (++\"\\n\") x)) --prints strings in a column.\n\n\nsampleInput = [\"       \",\n               \" *     \",\n               \"    *  \",\n               \"   *   \",\n               \"      *\",\n               \"***    \",\n               \"* *    \",\n               \"***    \"]\n\nminesweeper :: Result -&gt; Result\n</code></pre>\n\n<p>And result should be this</p>\n\n<pre><code>Prelude&gt;pp(minesweeper sampleInput)\n1110000\n1*11110\n1122*10\n001*221\n233211*\n***2011\n*8*3000\n***2000\n</code></pre>\n\n<p>I'm incredibly glad for any guidance as I'm unable of any real progress.</p>\n\n<p>Update: Did a bit different yet similar solution. You can check related question  <a href=\"https://stackoverflow.com/questions/58827023/how-to-make-my-function-move-through-two-lists-at-once/58836932#58836932\">here</a></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1573412803, "post_id": 58791756, "comment_id": 103865674, "body": "The issue is in your recursive step, as you&#39;re not taking account of the fact that you know the space isn&#39;t at index 0. You just need <code>1 + elemIndex1 xs</code> instead. (The <code>then</code> clause should also just give <code>Just 0</code> directly, since that is what the result will always be.)"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1573416199, "post_id": 58791947, "comment_id": 103866542, "body": "A few minor points. Indentation of the <code>if ...</code> looks wrong. Further, it would be nice to add a base case for <code>[]</code>, since right now <code>weirdElemIndex []</code> crashes. (I&#39;d also use <code>... then elemIndex &#39; &#39; str else ...</code> to stress that <code>x</code> is a space, but that&#39;s a matter of personal taste.)"}, {"owner": {"reputation": 725, "user_id": 5309823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y9956.png?s=128&g=1", "display_name": "cole", "link": "https://stackoverflow.com/users/5309823/cole"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573417326, "post_id": 58791947, "comment_id": 103866838, "body": "Ah good point, I just copied the OP\u2019s code. I\u2019ll edit that in."}], "tags": [], "owner": {"reputation": 725, "user_id": 5309823, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y9956.png?s=128&g=1", "display_name": "cole", "link": "https://stackoverflow.com/users/5309823/cole"}, "is_accepted": true, "score": 5, "last_activity_date": 1573417750, "last_edit_date": 1573417750, "creation_date": 1573412224, "answer_id": 58791947, "question_id": 58791756, "link": "https://stackoverflow.com/questions/58791756/haskell-as-patterns-binding-variables-to-constants/58791947#58791947", "title": "Haskell As-patterns, binding variables to constants", "body": "<p>It seems like you are expecting <code>xss@(x:xs)</code> to be the following:</p>\n\n<ul>\n<li><code>xss</code>: the <em>original</em> string given to elemIndex1\n\n<ul>\n<li><code>x</code>: the first character of an arbitrary call</li>\n<li><code>xs</code>: the rest of the characters of an arbitrary call</li>\n</ul></li>\n</ul>\n\n<p>e.g. for your example when <code>x</code> first matches a space</p>\n\n<pre><code>xss = \"qwe asd zxc\"\nx = ' '\nxs = \"asd zxe\"\n</code></pre>\n\n<p>This is not how the pattern match works. <code>xss</code> is actually equal to <code>x:xs</code>, so in that example it would be <code>\" asd zxc\"</code>.</p>\n\n<p>If you want to keep around the first call to a function, you can use a helper function called inside of the scope of the original function.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>weirdElemIndex str = weirdElemIndex' str\n  where\n    weirdElemIndex' \"\"     = Nothing\n    weirdElemIndex' (x:xs) =\n      if x == ' ' \n        then elemIndex ' ' str\n        else weirdElemIndex' xs\n</code></pre>\n\n<p>Note that the <code>str</code> I reference in the body of the helper function will be a constant in its invocation.</p>\n\n<p>For what it\u2019s worth, your contrived example seems to be equivalent to <code>elemIndex ' '</code> since it deals with the case where there is no space in the string by returning <code>Nothing</code>.</p>\n"}], "owner": {"reputation": 409, "user_id": 7825727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8ebdf381633dc5bec96b1adff7ab691?s=128&d=identicon&r=PG&f=1", "display_name": "kirill fedorov", "link": "https://stackoverflow.com/users/7825727/kirill-fedorov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 58791947, "answer_count": 1, "score": 3, "last_activity_date": 1573423938, "creation_date": 1573410925, "last_edit_date": 1573423938, "question_id": 58791756, "link": "https://stackoverflow.com/questions/58791756/haskell-as-patterns-binding-variables-to-constants", "title": "Haskell As-patterns, binding variables to constants", "body": "<p>(This code doesn't make much sense, but I need this logic to work in my other complicated function):</p>\n\n<pre><code>import Data.List\n\nelemIndex1 xss@(x:xs) = \n    if (x == ' ') \n    then (elemIndex x xss) \n    else (elemIndex1 xs)\n</code></pre>\n\n<p>So I want this function to give this:</p>\n\n<pre><code>elemIndex1 \"qwe asd zxc\"\nJust 3\n</code></pre>\n\n<p>Instead it gives this:</p>\n\n<pre><code>elemIndex1 \"qwe asd zxc\"\nJust 0\n</code></pre>\n\n<p>As I understand, at the else clause xss actually becomes xs.\nSo my question is: is there a possibility to bind the variable (x:xs) to a constant and to use this constant at any iteration?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1573411250, "post_id": 58791681, "comment_id": 103865245, "body": "Guards are sort of like if/then/else anyway, at least conceptually, so I&#39;m not sure why you think something extra is in need of explanation here."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1573413704, "post_id": 58791681, "comment_id": 103865909, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/12532552/791604\">What part of Hindley-Milner do you not understand?</a>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1573418098, "post_id": 58791681, "comment_id": 103867029, "body": "Guards can be in fact be understood as simply <i>syntactic sugar</i> for <code>if</code>-expressions (which in turn can be reduced to <code>case</code>, which also allows for pattern guards). GHC actually typechecks before all desugaring, but that&#39;s an implementation detail and mostly done to get better error messages."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5868594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caf21c94059311da5de67225de01fc3a?s=128&d=identicon&r=PG&f=1", "display_name": "d3Roux", "link": "https://stackoverflow.com/users/5868594/d3roux"}, "edited": false, "score": 0, "creation_date": 1573466661, "post_id": 58793135, "comment_id": 103878791, "body": "Thank you for the detailed QED! This helps me understanding how type inference works in Haskell in general a lot better. I assume that guards and if/then/else constructs are handled equivalent implicitly according to type inference."}], "tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": true, "score": 2, "last_activity_date": 1573421670, "creation_date": 1573421670, "answer_id": 58793135, "question_id": 58791681, "link": "https://stackoverflow.com/questions/58791681/how-does-the-type-inference-algorithm-resolve-guarded-equations/58793135#58793135", "title": "How does the type inference algorithm resolve guarded equations?", "body": "<p><code>fun</code> has three arguments and a result. So initially the compiler assumes they might each be a different type:</p>\n\n<pre><code>fun :: alpha -&gt; beta -&gt; gamma -&gt; delta         -- the type vars are placeholders\n</code></pre>\n\n<p>Ignoring the guards, look at the rhs result of the equations: they each must be type <code>delta</code>. So set up a series of type-level equations from the term-level equations. Use <code>~</code> between types to say they must be the same.</p>\n\n<ul>\n<li>The first equation has result <code>b</code>, so <code>b</code>'s type must be same as the result, i.e. <code>beta ~ delta</code>.</li>\n<li>The third equation has result <code>c</code>, so <code>c</code>'s type must be the same as the result, <code>gamma ~ delta</code>.</li>\n<li>The second equation has rhs <code>+</code> operator <code>:: Num a =&gt; a -&gt; a -&gt; a</code>. We'll come back to the <code>Num a =&gt;</code>. This is saying <code>+</code> has two arguments and a result, all of which are same type. That type is the result of <code>fun</code>'s rhs so must be <code>delta</code>. The second arg to <code>+</code> is <code>b</code>, so <code>b</code>'s type must be same as the result, <code>beta ~ delta</code>. We already had that from the first equation, so this is just confirming consistency.</li>\n<li>The first arg to <code>+</code> is <code>a</code>, so <code>a</code>'s type must be same again, <code>alpha ~ delta</code>.</li>\n</ul>\n\n<p>We have <code>alpha ~ beta ~ gamma ~ delta</code>. So go back to the initial signature (which was as general as possible), and substitute equals for equals:</p>\n\n<pre><code>fun :: (constraints) =&gt; alpha -&gt; alpha -&gt; alpha -&gt; alpha\n</code></pre>\n\n<p><strong>Constraints</strong></p>\n\n<p>Pick those up on the fly from the operators.</p>\n\n<ul>\n<li>We already saw <code>Num</code> because of operator <code>+</code>.</li>\n<li>The first equation's <code>a == c</code> gives us <code>Eq</code>.</li>\n<li>The second equation's <code>b &lt; 0</code> gives us <code>Ord</code>.</li>\n<li>Actually the appearance of <code>0</code> gives us another <code>Num</code>, because <code>0 :: Num a =&gt; a</code>, and <code>&lt; :: Ord a =&gt; a -&gt; a -&gt; Bool</code> IOW the arguments to <code>&lt;</code> must be same type and same constraints.</li>\n</ul>\n\n<p>So pile up those constraints at the front of <code>fun</code>'s type, eliminating duplicates</p>\n\n<pre><code>fun :: (Num alpha, Eq alpha, Ord alpha) =&gt; alpha -&gt; alpha -&gt; alpha -&gt; alpha\n</code></pre>\n\n<p>Is that what you're favourite compiler is telling you? It's probably using type variable <code>a</code> rather than <code>alpha</code>. It's probably not showing <code>Eq alpha</code>.</p>\n\n<p><strong>Eliminating unnecessary superclass constraints</strong></p>\n\n<pre><code>Main&gt; :i Ord\n...\nclass Eq a =&gt; Ord a where\n...\n</code></pre>\n\n<p>The <code>Eq a =&gt;</code> is telling every <code>Ord</code> type must come with an <code>Eq</code> already. So in giving the signature for <code>fun</code>, the compiler is assuming away its <code>Eq</code>.</p>\n\n<pre><code>fun :: (Num a, Ord a) =&gt; a -&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>QED</p>\n"}, {"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1573422675, "post_id": 58793172, "comment_id": 103868154, "body": "Looking at your workings, I rather think the nesting for <code>if-then-else</code> makes it harder to see the program&#39;s logic or its type inference. That applies especially if there are type errors: the compiler will point to the errors in the guards source lines, not to the desugarred version."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1573423749, "post_id": 58793172, "comment_id": 103868360, "body": "@AntC I don&#39;t understand what you&#39;re getting at.  The asker mentioned they know how type inference works in the face of if-then-else so I merely sought to show how guards don&#39;t require any additional knowledge wrt type checking.  I wasn&#39;t advocating replacing guards in real programs or as a naive compilation step."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 0, "last_activity_date": 1573421949, "creation_date": 1573421949, "answer_id": 58793172, "question_id": 58791681, "link": "https://stackoverflow.com/questions/58791681/how-does-the-type-inference-algorithm-resolve-guarded-equations/58793172#58793172", "title": "How does the type inference algorithm resolve guarded equations?", "body": "<pre><code>fun a b c\n| a == c = b\n| b &lt; 0 = a+b\n| otherwise = c\n</code></pre>\n\n<p>Is it clear how this translates to if/else?</p>\n\n<pre><code>fun a b c\n = if a == c\n      then b\n      else if b &lt; 0\n             then a+b\n             else c\n</code></pre>\n\n<p>And if we add some human-readable annotations:</p>\n\n<pre><code>fun a b c      -- Start reasoning with types of `a`, `b`, `c`, and `result :: r`\n = if a == c   -- types `a` and `c` are equal,  aka `a ~ c`.  Also `Eq a, Eq c`.\n      then b   -- types `b ~ r`\n      else if b &lt; 0   -- `Num b, Ord b`\n             then a+b -- `a ~ b ~ r` and `Num a, Num b`\n             else c   -- `c ~ r`\n</code></pre>\n\n<p>If you take all these facts together the type boils down pretty quickly.</p>\n\n<pre><code>a ~ b ~ r  and c ~ r\n</code></pre>\n\n<p>So we know there's actually only one type which we'll just call <code>a</code> and rename all the other types variables in the facts.</p>\n\n<pre><code>Num a, Eq a, Ord a\n</code></pre>\n\n<p>As a small cognitive savings we know <code>Ord</code> implies <code>Eq</code> so we can end up with constraints <code>Num a, Ord a</code>.</p>\n\n<p>All that swept the mechanics - leveraging of implications such as <code>(==) t1 t2 ~~&gt; t1 = t2</code> - under the rug but hopefully in an acceptable fashion.</p>\n"}], "owner": {"reputation": 43, "user_id": 5868594, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caf21c94059311da5de67225de01fc3a?s=128&d=identicon&r=PG&f=1", "display_name": "d3Roux", "link": "https://stackoverflow.com/users/5868594/d3roux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 58793135, "answer_count": 2, "score": 1, "last_activity_date": 1573421949, "creation_date": 1573410345, "question_id": 58791681, "link": "https://stackoverflow.com/questions/58791681/how-does-the-type-inference-algorithm-resolve-guarded-equations", "title": "How does the type inference algorithm resolve guarded equations?", "body": "<p>I tried to find out how Haskell is able to resolve types from a guarded equation where no type is specified through the web.</p>\n\n<p>Like in e.g. following function definition, ghci is able to resolve the type and tells me exactly what it is.</p>\n\n<pre><code>fun a b c\n| a == c = b\n| b &lt; 0 = a+b\n| otherwise = c\n</code></pre>\n\n<p>How does it do this? I know how this works for if-then-else constructs  (basically: start with generic version, add constraints) but I am wondering which extra steps are needed here?</p>\n"}, {"tags": ["algorithm", "haskell", "functional-programming", "lambda-calculus"], "comments": [{"owner": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "edited": false, "score": 1, "creation_date": 1573409003, "post_id": 58791289, "comment_id": 103864586, "body": "How do you represent arrays, don&#39;t you rather mean lists? Also what does it contain, Church numerals?"}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "reply_to_user": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "edited": false, "score": 0, "creation_date": 1573412757, "post_id": 58791289, "comment_id": 103865664, "body": "@Th&#233;oWinterhalter,  by array I mean an ordered set of values. Nothing is said to me about the contents of this set."}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "reply_to_user": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "edited": false, "score": 0, "creation_date": 1573413990, "post_id": 58791289, "comment_id": 103865983, "body": "@Th&#233;oWinterhalter,  most likely it is a spiok that contains natural numbers"}, {"owner": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "edited": false, "score": 0, "creation_date": 1573423806, "post_id": 58791289, "comment_id": 103868375, "body": "Your approach would probably work, but you need to know how arrays (or stacks now?) are represented, or is it also your job to find a representation of those?"}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "reply_to_user": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "edited": false, "score": 0, "creation_date": 1573458352, "post_id": 58791289, "comment_id": 103875402, "body": "@Th&#233;oWinterhalter, An ordered set of values \u200b\u200b(for example, &lt;1,2,3,3,2,1&gt;) is fed to the input. My function should return TRUE if this set is symmetric. That is, X(i) = X(n+1-i). I myself am free to determine what to call this set of values. Since in the lambda calculus we cannot gain access to an element by index, it is best to represent this set of values \u200b\u200bas a stack or queue."}, {"owner": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "edited": false, "score": 0, "creation_date": 1573461756, "post_id": 58791289, "comment_id": 103876575, "body": "Right, so you have a Church-encoding of a list, which basically gives you a fold on it, then you just have to do what you said. What is the thing blocking you?"}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "reply_to_user": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "edited": false, "score": 0, "creation_date": 1573463172, "post_id": 58791289, "comment_id": 103877153, "body": "@Th&#233;oWinterhalter,  I do not understand the syntax. Simple examples are given to me more or less, but such an algorithm I do not understand how to paint."}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "reply_to_user": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "edited": false, "score": 0, "creation_date": 1573463430, "post_id": 58791289, "comment_id": 103877260, "body": "@Th&#233;oWinterhalter,  I added an update and wrote a function to calculate the length of the list. But I do not understand how it works ("}], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1573469741, "post_id": 58799471, "comment_id": 103880247, "body": "0 true (\u03bbm. false) = true,  what does it mean &#39;\u03bbm. false&#39;?"}, {"owner": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "reply_to_user": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1573472716, "post_id": 58799471, "comment_id": 103881601, "body": "<code>\u03bbm. false</code> is just the constant function returning <code>false</code>, I assumed you knew what <code>false</code> was given you use it in your question."}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1573475753, "post_id": 58799471, "comment_id": 103882974, "body": "Now it\u2019s clear, all that you gave as an explanation I read in the book, could you show a more complex example, for example, dividing a list into two lists?"}, {"owner": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "reply_to_user": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1573494861, "post_id": 58799471, "comment_id": 103892352, "body": "You could write <code>firstn</code> and <code>skipn</code> taking a natural number <code>n</code> and a list <code>l</code> to return either the <code>n</code> first elements of <code>l</code>, or <code>l</code> without those <code>n</code> elements. In both cases you would recurse on <code>n</code> and <code>l</code>."}, {"owner": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "reply_to_user": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1573678817, "post_id": 58799471, "comment_id": 103964612, "body": "I added the <code>firstn</code> example, but it&#39;s a bit more involved I would say. If you had a programming language in which you could test it, it might help you build those more efficiently."}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1573719459, "post_id": 58799471, "comment_id": 103976632, "body": "I don\u2019t understand how to recursively call the \u201cfirstn\u201d function with 2 arguments l and n (\u03bbr.\u03bbl), because initially it takes 1 argument to the input - \u03bbn"}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1573720142, "post_id": 58799471, "comment_id": 103976949, "body": "&quot;length l = l 0 (\u03bb_.\u03bbn. succ n)&quot; I did not understand what &#39;\u03bb_&#39; means. I understand correctly that the function lenght = \u03bbl. l 0 (\u03bbl.\u03bbn. succ n), where \u03bbl.\u03bbn. succ n is another function that takes a list l and a counter n. But how does this whole record work. So I got the list l, am I checking it for &#39;nill&#39;? and then return &#39;0&#39; if not &#39;nill&#39; then do (\u03bbl.\u03bbn. succ n)?"}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1573720339, "post_id": 58799471, "comment_id": 103977053, "body": "Could you write a function &#39;firstn&#39; which takes input &#39;n&#39; and &#39;l&#39; and gets a new list of &#39;n div 2&#39; elements at the output? This will be easier to understand."}, {"owner": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "reply_to_user": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 1, "creation_date": 1573726458, "post_id": 58799471, "comment_id": 103980469, "body": "I mean my function <code>firstn</code> is generic so if you give it <code>n div 2</code> and <code>l</code> it will already do that. When I write <code>\u03bb_.</code> I mean I write a function ignoring its argument, so I don&#39;t bother giving it a name. If you have a list <code>l</code> you give it first what you in case <code>l</code> is <code>nil</code> and then what you do if it is <code>cons h t</code>."}, {"owner": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "reply_to_user": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1573728118, "post_id": 58799471, "comment_id": 103981491, "body": "I explained even more, but I can&#39;t do it all for you."}, {"owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1573993544, "post_id": 58799471, "comment_id": 104064433, "body": "I am grateful for your explanations. But could you write a trace of the function &#39;firstn=\u03bbn. n (\u03bbl. nil) (\u03bbr.\u03bbl. caseL l nil (\u03bbh.\u03bbt. cons h (r t)))&#39; to the end. How did you do this for fst (pair a b). For example firstn 2 (1,2,3,4)"}, {"owner": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "reply_to_user": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "edited": false, "score": 0, "creation_date": 1574030831, "post_id": 58799471, "comment_id": 104074645, "body": "I added this example at the end."}], "tags": [], "owner": {"reputation": 3762, "user_id": 1275975, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ab70073acbb6b09ab7201b0eee2d4b3?s=128&d=identicon&r=PG", "display_name": "Th&#233;o Winterhalter", "link": "https://stackoverflow.com/users/1275975/th%c3%a9o-winterhalter"}, "is_accepted": true, "score": 1, "last_activity_date": 1574030786, "last_edit_date": 1574030786, "creation_date": 1573467535, "answer_id": 58799471, "question_id": 58791289, "link": "https://stackoverflow.com/questions/58791289/how-to-write-a-function-to-check-the-array-for-symmetry-using-lambda-calculus/58799471#58799471", "title": "How to write a function to check the array for symmetry using lambda calculus?", "body": "<p>In pure \u03bb-calculus, you do not have access to any data-type, but you can still represent them with so-called Church-encodings.</p>\n\n<p>For instance, the natural numbers in unary representation can either be <code>0</code> (<code>z</code>) or the successor (<code>s</code>) of another natural number <code>n</code>, i.e, representing <code>n+1</code>.\nSo you have <code>z</code>, <code>s z</code>, <code>s (s z)</code>, <code>s (s (s z))</code>, etc.\nTo represent them in \u03bb-calculus, you use functions taking <code>z</code> and <code>s</code> as arguments:\n<code>\u03bbz.\u03bbs.z</code>, <code>\u03bbz.\u03bbs.s z</code>, <code>\u03bbz.\u03bbs.s (s z)</code>, <code>\u03bbz.\u03bbs.s (s (s z))</code>, etc.</p>\n\n<p>What's pretty cool about this representation is that it also gives you a recursor on natural numbers, i.e, a way to build stuff inductively on your natural number.</p>\n\n<p>Say you want to test if <code>n</code> is <code>0</code>, just write <code>n true (\u03bbm. false)</code> (where <code>true</code> and <code>false</code> would represent booleans, but they could be anything really). You then have</p>\n\n<pre><code>0 true (\u03bbm. false) = true\n1 true (\u03bbm. false) = (\u03bbm. false) true = false\n2 true (\u03bbm. false) = (\u03bbm. false) ((\u03bbm. false) true) = false\n...\n</code></pre>\n\n<p>meaning you can distinguish <code>0</code> from the rest of the Church numerals.\nBasically when you feed a Church numeral <code>b</code> and <code>f</code> you give the image of <code>0</code> as <code>b</code> and a function <code>f</code> to go from the image of <code>n</code> to the image of <code>n+1</code>.</p>\n\n<p>To write the <code>succ</code> function to add one to a natural number, you want to add one <code>s</code> in front of its representation:</p>\n\n<pre><code>succ n = \u03bbz.\u03bbs.s (n z s)\n</code></pre>\n\n<p>The <code>n z s</code> is synonymous to the removal of the two leading <code>\u03bb</code>s.</p>\n\n<p>Now lists can be represented the same way. A list can either be the empty list (<code>[]</code> or <code>nil</code>) or some element (<code>head</code>) attached to some other list (<code>tail</code>): <code>head :: tail</code> or <code>cons head tail</code>.\nWe do the same <em>trick</em>:\n<code>nil</code> is <code>\u03bbn.\u03bbc.n</code> and <code>cons x nil</code> is <code>\u03bbn.\u03bbc.c x n</code>, <code>cons y (cons x nil)</code> is <code>\u03bbn.\u03bbc.c y (c x n)</code>, etc.</p>\n\n<p>Similarly you can feed a base case and a function to a list to perform a <em>fold</em>.</p>\n\n<pre><code>cons x (cons y nil) b f = f x (f y b)\n(cons x1 (cons x2 (... (cons xn nil) ...))) b f = f x1 (f x2 (... (f xn b) ...)))\n</code></pre>\n\n<p>To get the length you have to note that the length of <code>nil</code> is <code>0</code> and that the length of <code>cons x l</code> is <code>succ (length l)</code>, without depending on the <code>x</code>.\nSo <code>length l = l 0 (\u03bb_.\u03bbn. succ n)</code>.</p>\n\n<p>You should go on and build primitives like this to eventually solve your problem.</p>\n\n<hr>\n\n<p>Next you want to write <code>firstn</code> the function which takes an integer <code>n</code> and a list <code>l</code> and returns the <code>n</code> first elements.\nBasically you have</p>\n\n<pre><code>firstn 0 l = nil\nfirstn (n+1) nil = nil\nfirstn (n+1) (cons a l) = cons a (firstn n l)\n</code></pre>\n\n<p>so you first do an analysis on the natural number, and then on the list.\nI will write it as a function taking a natural number and returning a function taking a list and returning a list.</p>\n\n<pre><code>firstn = \u03bbn. n (\u03bbl. nil) (\u03bbr.\u03bbl. l nil (\u03bba.\u03bbl. cons a (r l)))\n</code></pre>\n\n<p>In there <code>r</code> represents the recursive call <code>firstn n</code> when I'm defining <code>firstn (n+1)</code>.</p>\n\n<p>It can feel a bit tricky, and to be honest knowing how to write this in a proper functional language with pattern-matching helps. I personally tested these in coq.</p>\n\n<hr>\n\n<p>Perhaps even easier to understand would first to write a case analysis function on lists, but for that we need to build pairs.</p>\n\n<p>A pair is something composed of two elements, so from any pair you want to be able to observe these two elements.</p>\n\n<pre><code>pair a b = \u03bbp. p a b\n</code></pre>\n\n<p>In other words </p>\n\n<pre><code>pair = \u03bba.\u03bbb.\u03bbp. p a b\n</code></pre>\n\n<p>You can then take the first and second projections of a pair easily.</p>\n\n<pre><code>fst = \u03bbp. p (\u03bbx.\u03bby.x)\nsnd = \u03bbp. p (\u03bbx.\u03bby.y)\n</code></pre>\n\n<p>You can see</p>\n\n<pre><code>fst (pair a b) = (pair a b) (\u03bbx.\u03bby.x)\n               = (\u03bbp. p a b) (\u03bbx.\u03bby.x)\n               = (\u03bbx.\u03bby.x) a b\n               = a\n</code></pre>\n\n<p>Case analysis on lists is like pattern matching, in ocaml you would write</p>\n\n<pre class=\"lang-ml prettyprint-override\"><code>match l with\n| nil -&gt; b\n| cons h t -&gt; f h t\n</code></pre>\n\n<p>meaning if <code>l</code> is <code>nil</code> I want to return <code>b</code>, and if it is <code>cons h t</code> I want to return <code>f h t</code>. </p>\n\n<p>There are no recursive calls here, however, applying <code>l</code> will automatically do recursion. In particular, you don't get access to <code>t</code> but to the value of the recursive call on <code>t</code> instead.\nTo circumvent this we will return both the original list and the value we want to return, using pairs.</p>\n\n<pre><code>caseL = \u03bbl.\u03bbb.\u03bbf. snd (l (pair nil b) (\u03bbx.\u03bbr. pair (cons x (fst r) (f x (fst r)))\n</code></pre>\n\n<p>such that</p>\n\n<pre><code>caseL nil b f = b\ncaseL (cons x l) b f = f x l\n</code></pre>\n\n<p>as we wanted.</p>\n\n<p>Now we can again write <code>firstn</code>. Remember, <code>firstn n</code> computes a function on lists remove all but the <code>n</code> first elements.</p>\n\n<pre><code>firstn = \u03bbn. n (\u03bbl. nil) (\u03bbr.\u03bbl. caseL l nil (\u03bbh.\u03bbt. cons h (r t)))\n</code></pre>\n\n<p>It obeys the following structure</p>\n\n<pre><code>n b (\u03bbr. f r)\n</code></pre>\n\n<p>corresponding to induction on <code>n</code>.\nFor <code>0</code> we return the base case <code>b</code> and for <code>n+1</code> we get the value of the recursive call <code>r</code> to produce our answer <code>f r</code>.\nIn our case, the base case is the function <code>firstn 0</code> which means the function taking a list and throwing it all away.\nThe recursive call corresponds to <code>firstn n</code> when defining <code>firstn (n+1)</code> and in that case we want to do a case analysis on the list as above, using <code>firstn n</code> (that is <code>r</code>) on the tail, if the list is not empty.</p>\n\n<hr>\n\n<pre><code>firstn 2 = 2 (\u03bbl. nil) (\u03bbr.\u03bbl. caseL l nil (\u03bbh.\u03bbt. cons h (r t)))\n         = (\u03bbr.\u03bbl. caseL l nil (\u03bbh.\u03bbt. cons h (r t))) ((\u03bbr.\u03bbl. caseL l nil (\u03bbh.\u03bbt. cons h (r t))) (\u03bbl. nil))\n         = (\u03bbr.\u03bbl. caseL l nil (\u03bbh.\u03bbt. cons h (r t))) (\u03bbl. caseL l nil (\u03bbh.\u03bbt. cons h ((\u03bbl. nil) t)))\n         = (\u03bbr.\u03bbl. caseL l nil (\u03bbh.\u03bbt. cons h (r t))) (\u03bbl. caseL l nil (\u03bbh.\u03bbt. cons h nil))\n         = \u03bbl. caseL l nil (\u03bbh.\u03bbt. cons h ((\u03bbl. caseL l nil (\u03bbh.\u03bbt. cons h nil)) t))\n         = \u03bbl. caseL l nil (\u03bbh.\u03bbt. cons h (caseL t nil (\u03bbh.\u03bbt. cons h nil)))\n</code></pre>\n\n<p>So if you look hard enough you can already see this a function that will only get the two first elements of a list.</p>\n\n<pre><code>firstn 2 (cons 1 (cons 2 (cons 3 (cons 4 nil))))\n= caseL (cons 1 (cons 2 (cons 3 (cons 4 nil)))) nil (\u03bbh.\u03bbt. cons h (caseL t nil (\u03bbh.\u03bbt. cons h nil)))\n= (\u03bbh.\u03bbt. cons h (caseL t nil (\u03bbh.\u03bbt. cons h nil))) 1 (cons 2 (cons 3 (cons 4 nil)))\n= cons 1 (caseL (cons 2 (cons 3 (cons 4 nil))) nil (\u03bbh.\u03bbt. cons h nil))\n= cons 1 ((\u03bbh.\u03bbt. cons h nil) 2 (cons 3 (cons 4 nil)))\n= cons 1 (cons 2 nil)\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 11388249, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Zhe1qISXmzY/AAAAAAAAAAI/AAAAAAAAAC0/Opx3Le0xlkE/photo.jpg?sz=128", "display_name": "Vasiliy", "link": "https://stackoverflow.com/users/11388249/vasiliy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 1, "accepted_answer_id": 58799471, "answer_count": 1, "score": -1, "last_activity_date": 1574030786, "creation_date": 1573407691, "last_edit_date": 1573992321, "question_id": 58791289, "link": "https://stackoverflow.com/questions/58791289/how-to-write-a-function-to-check-the-array-for-symmetry-using-lambda-calculus", "title": "How to write a function to check the array for symmetry using lambda calculus?", "body": "<p>I am studying Lambda Calculus. I need to define a lambda image of a syndicate that returns true or false depending on whether the input array is symmetric from the center or not.\nI will be very happy for any of your help, since this topic is very difficult for me.\nI understand how to define basic constructors such as true or false, as well as addition and multiplication.\nI have some algorithm, as I would like to do:</p>\n\n<ol>\n<li><p>Find the number of elements in the stack.</p></li>\n<li><p>Pull half (with rounding down) of the stack onto another stack.</p></li>\n<li><p>If the number of elements was odd, remove the element from the first stack.</p></li>\n<li>In pairs, remove elements from the stacks and compare, if not equal, return the constructor false, if the stacks are empty, return the constructor true.</li>\n</ol>\n\n<p>UPDATE</p>\n\n<p>1.lenght = \u03bbl.l (\u03bbx.succ), where succ = \u03bbnfx.n f (f x)</p>\n"}, {"tags": ["haskell", "haskell-stack", "template-haskell", "haskell-platform", "haskell-snap-framework"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1573406718, "post_id": 58791038, "comment_id": 103863926, "body": "here: <code>| acc &gt; 0 = Multiple x acc : [] | acc == 0 = Single x : []</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1573407854, "post_id": 58791038, "comment_id": 103864229, "body": "At the very end, you map <code>acc == 0</code> into <code>Single x</code>. That looks wrong. Isn&#39;t <code>acc</code> the number of occurrences? How can it be 0? It starts from 1 and it is increased, so it is impossible AFAICS."}, {"owner": {"reputation": 77, "user_id": 8472226, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ffb2a081b2dc65a17ee0217315193c0f?s=128&d=identicon&r=PG", "display_name": "Yaroslav", "link": "https://stackoverflow.com/users/8472226/yaroslav"}, "edited": false, "score": 0, "creation_date": 1573408233, "post_id": 58791038, "comment_id": 103864341, "body": "Right! It should be like that. Yes?   | acc&gt;1 = Multiple x acc : []  | acc == 1 = Single x : []"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1573408965, "post_id": 58791038, "comment_id": 103864576, "body": "yes. In general, to be able to see the code clearer you could try vertically aligning the relevant pieces of code. e.g. like <a href=\"https://repl.it/repls/VividFewKeychanger\" rel=\"nofollow noreferrer\">here</a>. (or try <a href=\"https://code.world/haskell#\" rel=\"nofollow noreferrer\">this</a>, it has nicer editor)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1573417363, "post_id": 58791038, "comment_id": 103866844, "body": "Why the redundant <code>Single</code> constructor?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1573417982, "post_id": 58791038, "comment_id": 103867000, "body": "This becomes much simpler if you can use <code>Data.List.group</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1573426814, "post_id": 58791038, "comment_id": 103869068, "body": "@chepner to save the replicate call on decoding."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1573479824, "post_id": 58791038, "comment_id": 103885008, "body": "Is it really worth saving that call at the expense of complicating the code? Unless you expect a <i>lot</i> of isolated values in the string, you won&#39;t be saving that many calls anyway. (Besides, you can always just check the integer stored in the <code>Multiple</code> value, which replaces the <code>Single</code>/<code>Multiple</code> check.)"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8472226, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ffb2a081b2dc65a17ee0217315193c0f?s=128&d=identicon&r=PG", "display_name": "Yaroslav", "link": "https://stackoverflow.com/users/8472226/yaroslav"}, "edited": false, "score": 0, "creation_date": 1573608170, "post_id": 58792817, "comment_id": 103934165, "body": "Thank you for your solution! This is a beautiful way."}], "tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 1, "last_activity_date": 1573419125, "creation_date": 1573419125, "answer_id": 58792817, "question_id": 58791038, "link": "https://stackoverflow.com/questions/58791038/haskell-implement-a-function-that-takes-a-string-as-input-and-expands-its-compr/58792817#58792817", "title": "Haskell. Implement a function that takes a string as input and expands its compressed representation", "body": "<p>As @chepner hints you may use <code>Data.List.group</code> to simplify your job while keeping your <code>MyData2</code> data type</p>\n\n<pre><code>import Data.Bool (bool) -- ternary operator\nimport Data.List (group)\n\nf s = map (\\g@(c:_) -&gt; let n = length g\n                       in bool (Single c) (Multiple c n) (n &gt; 1)) (group s)\n\n*Main&gt; f \"cvvccf\"\n[Single 'c',Multiple 'v' 2,Multiple 'c' 2,Single 'f']\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8472226, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ffb2a081b2dc65a17ee0217315193c0f?s=128&d=identicon&r=PG", "display_name": "Yaroslav", "link": "https://stackoverflow.com/users/8472226/yaroslav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1573419125, "creation_date": 1573405936, "last_edit_date": 1573406537, "question_id": 58791038, "link": "https://stackoverflow.com/questions/58791038/haskell-implement-a-function-that-takes-a-string-as-input-and-expands-its-compr", "title": "Haskell. Implement a function that takes a string as input and expands its compressed representation", "body": "<p>Implement a function (myData2Fun) that takes a string as input and expands its compressed representation according to the rules for encoding series lengths. The essence of compression is that consecutive identical characters are combined into one group.For example:</p>\n\n<pre><code>1. Input:  myData2Fun \"C\"\n   Output: [Single \"C\"] \n2. Input:  myData2Fun \"cvvccf\"\n   Output:[Single 'c',Multiple 'v' 2,Multiple 'c' 2,Single 'f']\n</code></pre>\n\n<p>It is also necessary to implement the data type required to solve the problem.</p>\n\n<p>I am trying to solve the problem as follows:</p>\n\n<pre><code>data MyData2 = Multiple Char Integer | Single Char deriving(Show)\n\nmyData2Fun (h:t) = fff h t 1\n\nfff x (h:t) acc\n    | h == x = fff x t (acc + 1)\n    | h /= x &amp;&amp; acc &gt; 1 = Multiple x acc : fff h t 1\n    | h /= x &amp;&amp; acc == 1 = Single x : fff h t 1\n\nfff x [] acc\n    | acc&gt;0 = Multiple x acc : []\n    | acc == 0 = Single x : []\n</code></pre>\n\n<p>But my program is on a line with a single character, for example \nInput: myData2Fun \"c\" returns Output: [Multiple 'c' 1], \ninstead of Output: [Single 'c']. Help me find the error and fix the code.</p>\n"}, {"tags": ["haskell", "ghc", "foldable"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573407521, "post_id": 58791207, "comment_id": 103864141, "body": "@HugoPeters With the standard <code>length</code> from <code>Foldable</code> and non-parametrized <code>Row</code> it is indeed impossible. You can declare a different length function, but that will need to have another name (or be in another package, and disambiguate between the two length functions manually). For instance <code>MonoFoldable</code> provides <code>olength</code> to avoid the name clash."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1573407586, "last_edit_date": 1573407586, "creation_date": 1573407064, "answer_id": 58791207, "question_id": 58791037, "link": "https://stackoverflow.com/questions/58791037/cannot-implement-foldable-instance-due-to-wrong-kind/58791207#58791207", "title": "Cannot implement Foldable instance due to wrong kind", "body": "<p>When we have <code>Foldable T</code>, <code>T</code> must be a <em>parametric</em> type, i.e. we must be able to form types <code>T Int</code>, <code>T String</code>, etc.</p>\n\n<p>In Haskell we write <code>T :: * -&gt; *</code> for \"a type parametrized over a type\", since it resembles a function from types to types. The syntax <code>* -&gt; *</code> is called the <em>kind</em> of <code>T</code>.</p>\n\n<p>In your case, <code>Row</code> is not parametrized, it is a plain type, something of kind <code>*</code>, not <code>* -&gt; *</code>. So, <code>Foldable Row</code> is a kind error. In a sense, a foldable must be a <em>generic</em> list-like container, not one that only carries <code>Field</code> as in your case.</p>\n\n<p>You could instead define <code>data Row a = Row [a]</code>, and use <code>Row Field</code> when you need that specific case.</p>\n\n<p>Alternatively, you could try <code>MonoFoldable Row</code> from the <code>mono-traversable</code> package, but note that this is a more advanced option, involving type families. Do not take this path lightly before considering its consequences. It ultimately boils down to <em>why</em> you need a <code>Foldable</code> instance.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1573488838, "creation_date": 1573488838, "answer_id": 58804930, "question_id": 58791037, "link": "https://stackoverflow.com/questions/58791037/cannot-implement-foldable-instance-due-to-wrong-kind/58804930#58804930", "title": "Cannot implement Foldable instance due to wrong kind", "body": "<blockquote>\n  <p>what is the <em>\"kind\"</em> of a datatype?</p>\n</blockquote>\n\n<p>Types \"of kind <code>*</code>\" are types of <em>things that can appear in a Haskell program</em>. </p>\n\n<p>Example: <code>Int</code>. </p>\n\n<p>Not an example: <code>Maybe</code>.  </p>\n\n<p><code>a :: Int ; a = 1</code> can appear in a Haskell program but <code>b :: Maybe ; b = Just 1</code> can't. It must be <code>b :: Maybe Int ; b = Just 1</code>, to be valid for it to appear in a Haskell program. </p>\n\n<p>What is <code>Maybe Int</code>? It is a type of kind <code>*</code> just as  <code>Int</code> is. So what is <code>Maybe</code>? It is a type of kind <code>* -&gt; *</code>. Because <em><code>Maybe Maybe</code></em> is <em>also</em> invalid. </p>\n\n<p>The type <code>t</code> appearing after the <code>Maybe</code> must itself be of kind <code>*</code> for <code>Maybe t</code> to be of kind <code>*</code>. Thus the kind of <code>Maybe</code> is <code>* -&gt; *</code>.</p>\n\n<p></p>\n\n<p>Haskell now calls the kind <code>*</code> by new name, <code>Type</code>. Calling it <code>Thing</code> or something  could have been more intuitive.</p>\n"}], "owner": {"reputation": 51, "user_id": 12004143, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cXdOxQt_GWQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdfEdWuVEQMJrHjuChm1CcdVrHNvA/photo.jpg?sz=128", "display_name": "Hugo Peters", "link": "https://stackoverflow.com/users/12004143/hugo-peters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1573488838, "creation_date": 1573405910, "question_id": 58791037, "link": "https://stackoverflow.com/questions/58791037/cannot-implement-foldable-instance-due-to-wrong-kind", "title": "Cannot implement Foldable instance due to wrong kind", "body": "<p>I am learning haskell and trying to make a pretty print program. At some point I want to get the length of a row (i.e. number of columns in that row). To be able to do that on my datatype I understand I have to implement Foldable, which relies on Monoid.</p>\n\n<p>Previously my row was just a type alias for a list but for sake of learning I want to make this move</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>    import System.IO\n    import System.Directory\n    import Control.Monad\n    import Data.Maybe\n    import Data.Monoid\n    import Data.Foldable\n    import Data.Functor\n    import Data.List.Split\n\n    type Field = String\n    data Row = Row [Field]\n\n    instance Monoid Row where\n        mempty = Row []\n\n\n    instance Foldable Row where\n        foldMap f (Row fs) = foldMap f fs\n\n</code></pre>\n\n<p>But I get the following compiler error (on ghci 8.0.2)</p>\n\n<pre><code>main.hs:20:19: error:\n    \u2022 Expected kind \u2018* -&gt; *\u2019, but \u2018Row\u2019 has kind \u2018*\u2019\n    \u2022 In the first argument of \u2018Foldable\u2019, namely \u2018Row\u2019\n      In the instance declaration for \u2018Foldable Row\u2019\n</code></pre>\n\n<p>Now I am not familiar with what the kind of a datatype is. I was expecting this to simply defer to Row's only property of type List</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 3, "last_activity_date": 1573413032, "last_edit_date": 1573413032, "creation_date": 1573407211, "answer_id": 58791230, "question_id": 58790907, "link": "https://stackoverflow.com/questions/58790907/error-character-when-not-finding-searched-value-in-list-of-tuples/58791230#58791230", "title": "&quot;Error character&quot; when not finding searched value in list of tuples", "body": "<p>You say you want to return a character, but your type signature specifies a generic return type <code>b</code>, which is not necessarily a character. A generic type means \"whatever type you give me, I can work with that\" - the main point being that <em>you don't choose that type, but whoever calls your function does</em>.</p>\n\n<p>So if you really want to return a special character, your type signature has to say so:</p>\n\n<pre><code>find_pair :: (Eq a) =&gt; a -&gt; [(a, Char)] -&gt;  Char\nfind_pair _ [] = '#'\nfind_pair x ((a,b):xs) = if x == a then b else find_pair x xs\n</code></pre>\n\n<p>However, returning special values to indicate special outcomes is fragile. What if your input actually happens to contain the character <code>'#'</code>? How would the consumer be able to tell whether you found the character <code>'#'</code> or didn't find anything?</p>\n\n<p>When a function may or may not have a result, the standard way to do that in Haskell is to return a value wrapped in <code>Maybe</code>:</p>\n\n<pre><code>find_pair :: (Eq a) =&gt; a -&gt; [(a,b)] -&gt;  Maybe b\nfind_pair _ [] = Nothing\nfind_pair x ((a,b):xs) = if x == a then Just b else find_pair x xs\n</code></pre>\n\n<p>Here, the function will return <code>Just b</code> when it finds an element, or <code>Nothing</code> when it doesn't.</p>\n"}], "owner": {"reputation": 67, "user_id": 8215123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/498b063694552ee0fa4765a9f2931bd8?s=128&d=identicon&r=PG&f=1", "display_name": "Dodande", "link": "https://stackoverflow.com/users/8215123/dodande"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 58791230, "answer_count": 1, "score": -1, "last_activity_date": 1573413032, "creation_date": 1573404965, "question_id": 58790907, "link": "https://stackoverflow.com/questions/58790907/error-character-when-not-finding-searched-value-in-list-of-tuples", "title": "&quot;Error character&quot; when not finding searched value in list of tuples", "body": "<p>In my Haskell homework, my task is to create a recursive function that accepts a Char and a list of tuple pairs.<br/>\nI want to scan the first elements of the tuples, and if it matches with the input 'char', then return the second element of the tuple.<br/>\nIf there is no matching then it should return <code>'#'</code></p>\n\n<p>Here is my code so far:</p>\n\n<pre><code>find_pair :: (Eq a) =&gt; a -&gt; [(a,b)] -&gt;  b\nfind_pair _ [] = error \"#\"\nfind_pair x ((a,b):xs) = if x == a then b else find_pair x xs\n</code></pre>\n\n<p>It should work like this:</p>\n\n<pre><code>find_pair 'b' [('b', 'g'), ('c', 'h'), ('a', 'f')] = 'g'\nfind_pair '!' [('b', 'g'), ('c', 'h'), ('a', 'f')] = '#'\n</code></pre>\n\n<p>It works almost fine, but my teacher dose not accept it since at the '#' part my function returns:</p>\n\n<pre><code>*** Exception: #\nCallStack (from HasCallStack):\n  error, called at haskell.hs:19:19 in main:Main\n</code></pre>\n\n<p>and not <code>'#'</code><br/>\nBut if i write my function like this:</p>\n\n<pre><code>find_pair :: (Eq a) =&gt; a -&gt; [(a,b)] -&gt;  b\nfind_pair _ [] =  '#' \nfind_pair x ((a,b):xs)  = if x == a then  b else find_pair x xs\n</code></pre>\n\n<p>It dose not even compile and gives me this error:</p>\n\n<pre><code>haskell.hs:19:19: error:\n    * Couldn't match expected type `b' with actual type `Char'\n      `b' is a rigid type variable bound by\n        the type signature for:\n          find_pair :: forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; b\n        at haskell.hs:18:1-41\n    * In the expression: '#'\n      In an equation for `find_pair': find_pair _ [] = '#'\n    * Relevant bindings include\n        find_pair :: a -&gt; [(a, b)] -&gt; b (bound at haskell.hs:19:1)\n   |\n19 | find_pair _ [] =  '#'\n   |                   ^^^\n</code></pre>\n\n<p>How should I solve this?</p>\n"}, {"tags": ["haskell", "monads", "functor", "applicative"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1573391933, "creation_date": 1573391933, "answer_id": 58789052, "question_id": 58789006, "link": "https://stackoverflow.com/questions/58789006/how-to-define-apply-in-terms-of-bind/58789052#58789052", "title": "How to define apply in terms of bind?", "body": "<p>We can copy the definition of <code>ap</code> and desugar it:</p>\n\n<pre><code>ap f a = do\n   xf &lt;- f\n   xa &lt;- a\n   return (xf xa)\n</code></pre>\n\n<p>Hence,</p>\n\n<pre><code>f &lt;*&gt; a = f &gt;&gt;= (\\xf -&gt; a &gt;&gt;= (\\xa -&gt; return (xf xa)))\n</code></pre>\n\n<p>(A few redundant parentheses added for clarity.)</p>\n"}, {"comments": [{"owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 0, "creation_date": 1573394131, "post_id": 58789107, "comment_id": 103860536, "body": "As monads are Monoids in the Category of endofunctors. There are Commutative monoids as well, which necessarily need not work in order. By you definition of Monads as Sequencing Actions, that means the Monad instances for Commutative Monoids also need an ordering?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1573395627, "post_id": 58789107, "comment_id": 103860889, "body": "Sequencing is an <i>application</i> of monads, not a defining feature. Regular function composition also implements a type of sequencing: in <code>f (g x)</code>, you necessarily have to call <code>g</code> before <code>f</code>."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1573399258, "post_id": 58789107, "comment_id": 103861858, "body": "Yes, its true that monads are not just about sequencing. I was skipping over that point as it isn&#39;t key to the question."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 5, "last_activity_date": 1573392518, "last_edit_date": 1573392518, "creation_date": 1573392348, "answer_id": 58789107, "question_id": 58789006, "link": "https://stackoverflow.com/questions/58789006/how-to-define-apply-in-terms-of-bind/58789107#58789107", "title": "How to define apply in terms of bind?", "body": "<blockquote>\n  <p>If Monad is really for sequencing actions then How come we can define Applicatives (which are not considered to strictly operate in sequence, some kind of parallel computing)?</p>\n</blockquote>\n\n<p>Not quite. All monads are applicatives, but only some applicatives are monads. So given a monad you can always define an applicative instance in terms of <code>bind</code> and <code>return</code>, but if all you have is the applicative instance then you cannot define a monad without more information.</p>\n\n<p>The applicative instance for a monad would look like this:</p>\n\n<pre><code>instance (Monad m) =&gt; Applicative m where\n   pure = return\n   f &lt;*&gt; v = do\n      f' &lt;- f\n      v' &lt;- v\n      return $ f' v'\n</code></pre>\n\n<p>Of course this evaluates <code>f</code> and <code>v</code> in sequence, because its a monad and that is what monads do. If this applicative does not do things in a sequence then it isn't a monad.</p>\n\n<p>Modern Haskell, of course, defines this the other way around: the <code>Applicative</code> typeclass is a subset of <code>Functor</code> so if you have a <code>Functor</code> and you can define <code>(&lt;*&gt;)</code> then you can create an <code>Applicative</code> instance. <code>Monad</code> is in turn defined as a subset of <code>Applicative</code>, so if you have an <code>Applicative</code> instance and you can define <code>(&gt;&gt;=)</code> then you can create a <code>Monad</code> instance. But you can't define <code>(&gt;&gt;=)</code> in terms of <code>(&lt;*&gt;)</code>.</p>\n\n<p>See the <a href=\"https://wiki.haskell.org/Typeclassopedia\" rel=\"nofollow noreferrer\">Typeclassopedia</a> for more details.</p>\n"}, {"tags": [], "owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "is_accepted": false, "score": 2, "last_activity_date": 1573397945, "last_edit_date": 1592644375, "creation_date": 1573397945, "answer_id": 58789869, "question_id": 58789006, "link": "https://stackoverflow.com/questions/58789006/how-to-define-apply-in-terms-of-bind/58789869#58789869", "title": "How to define apply in terms of bind?", "body": "<blockquote>\n<p>(&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b</p>\n<p>(&lt;*&gt;) = ???  -- Can we define this in terms return &amp; bind? without using &quot;ap&quot;</p>\n</blockquote>\n<p>Recall that <code>&lt;*&gt;</code> has the type signature of <code>f (a -&gt; b) -&gt; f a -&gt; f b</code>, and <code>&gt;&gt;</code> has <code>m a -&gt; (a -&gt; m b) -&gt; m b</code>. So how can we infer <code>m (a -&gt; b) -&gt; m a -&gt; m b</code> from <code>m a -&gt; (a -&gt; m b) -&gt; m b</code>?</p>\n<p>To define <code>f &lt;*&gt; x</code> with <code>&gt;&gt;=</code>, the first parameter of <code>&gt;&gt;=</code> should be <code>f</code> obviously, so we can write the first transformation:</p>\n<pre><code>f &lt;*&gt; x = f &gt;&gt;= k      -- k to be defined\n</code></pre>\n<p>where the function <code>k</code> takes as a parameter a function with the type of <code>a -&gt; b</code>, and returns a result of <code>m b</code> such that the whole definition aligns with the type signature of bind <code>&gt;&gt;=</code>. For <code>k</code>, we can write:</p>\n<pre><code>k :: (a -&gt; b) -&gt; m b\nk = \\xf -&gt; h x          \n</code></pre>\n<p>Note that the function <code>h</code> should use <code>x</code> from <code>f &lt;*&gt; x</code> since <code>x</code> is related to the result of <code>m b</code> in some way like the function <code>xf</code> of <code>a -&gt; b</code>.</p>\n<p>For <code>h x</code>, it's easy to get:</p>\n<pre><code>h :: m a -&gt; m b\nh x = x &gt;&gt;= return . xf\n</code></pre>\n<p>Put the above three definations together, and we get:</p>\n<pre><code>f &lt;*&gt; x = f &gt;&gt;= \\xf -&gt; x &gt;&gt;= return . xf\n</code></pre>\n<p>So even though you don't know the defination of <code>ap</code>, you can still get the final result as shown by @chi according to the type signature.</p>\n"}], "owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 58789107, "answer_count": 3, "score": 4, "last_activity_date": 1573400963, "creation_date": 1573391584, "last_edit_date": 1573400963, "question_id": 58789006, "link": "https://stackoverflow.com/questions/58789006/how-to-define-apply-in-terms-of-bind", "title": "How to define apply in terms of bind?", "body": "<p>In Haskell Applicatives are considered stronger than Functor that means we can define Functor using Applicative like</p>\n\n<pre><code>-- Functor\nfmap :: (a -&gt; b) -&gt; f a -&gt; f b\nfmap f fa = pure f &lt;*&gt; fa\n</code></pre>\n\n<p>and Monads are considered stronger than Applicatives &amp; Functors that means.</p>\n\n<pre><code>-- Functor\nfmap :: (a -&gt; b) -&gt; f a -&gt; f b\nfmap f fa = fa &gt;&gt;= return . f\n\n-- Applicative\npure :: a -&gt; f a\npure = return\n\n(&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n(&lt;*&gt;) = ???  -- Can we define this in terms return &amp; bind? without using \"ap\" \n</code></pre>\n\n<p>I have read that Monads are for sequencing actions. But I feel like the only thing a Monad can do is Join or Flatten and the rest of its capabilities comes from Applicatives. </p>\n\n<pre><code>join :: m (m a) -&gt; m a\n-- &amp; where is the sequencing in this part? I don't get it.\n</code></pre>\n\n<p>If Monad is really for sequencing actions then How come we can define Applicatives (which are not considered to strictly operate in sequence, some kind of parallel computing)?</p>\n\n<p>As monads are Monoids in the Category of endofunctors. There are Commutative monoids as well, which necessarily need not work in order. That means the Monad instances for Commutative Monoids also need an ordering?</p>\n\n<p><strong>Edit:</strong> \nI found an excellent page\n<strong><a href=\"http://wiki.haskell.org/What_a_Monad_is_not\" rel=\"nofollow noreferrer\">http://wiki.haskell.org/What_a_Monad_is_not</a></strong></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1573490142, "post_id": 58788375, "comment_id": 103890236, "body": "This is nearly an instance of the existential typeclass pattern. <code>Response</code> should not be a class -- <code>data Response = Response { messages :: State -&gt; [Message] }</code> is the correct model.  After this change, your question evaporates"}], "answers": [{"comments": [{"owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "edited": false, "score": 1, "creation_date": 1573387952, "post_id": 58788417, "comment_id": 103859080, "body": "Thanks! This was exactly what I was looking for :)  Then I&#39;m getting type inference problems elsewhere in my application, where it fails to deduce the type of  <code>b</code>, but I&#39;ll have to get back with a new question if I don&#39;t manage to solve that..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "edited": false, "score": 3, "creation_date": 1573405300, "post_id": 58788417, "comment_id": 103863512, "body": "@TomasAschan Double check if you actually need a class. If you will only have a single instance, you probably do not need the class. If you do need a class for this, you probably will need either type families or fundeps to make <code>b</code> deducible from <code>a</code>."}, {"owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "edited": false, "score": 0, "creation_date": 1573490053, "post_id": 58788417, "comment_id": 103890197, "body": "The use case is to enable implementing new features simply by creating instances of the requisite classes, so I will have multiple instances. (Basically, instantiate <code>Query</code> to provide <code>query :: a -&gt; b</code>, and <code>Response</code> to provide <code>messages :: b -&gt; [Message]</code>; there will be many instances of both <code>Query</code> and <code>Response</code>, but one-to-one mappings between them.) However, I might be able to re-structure my classes so that they are a little fewer and therefore don&#39;t have so many interdependencies..."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1573387090, "creation_date": 1573387090, "answer_id": 58788417, "question_id": 58788375, "link": "https://stackoverflow.com/questions/58788375/how-do-i-express-a-type-class-constraint-on-the-return-value-of-a-type-class-mem/58788417#58788417", "title": "How do I express a type class constraint on the return value of a type class member in Haskell?", "body": "<p>You can add this to the type signature of the function:</p>\n\n<pre><code>class Query a where\n  query :: Response b =&gt; a -&gt; State -&gt; b</code></pre>\n\n<p>Note however that this means it can return <em>any</em> <code>b</code> that is of a type that is an instance of <code>Response</code>.</p>\n"}], "owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 58788417, "answer_count": 1, "score": 3, "last_activity_date": 1573489857, "creation_date": 1573386821, "last_edit_date": 1573489857, "question_id": 58788375, "link": "https://stackoverflow.com/questions/58788375/how-do-i-express-a-type-class-constraint-on-the-return-value-of-a-type-class-mem", "title": "How do I express a type class constraint on the return value of a type class member in Haskell?", "body": "<p>Let's say I have the following types:</p>\n\n<pre><code>data State = State { ... }               -- exact structure is not relevant\ndata Message = Message { ... }           -- exact structure is not relevant\n\nclass Response a where\n  messages :: a -&gt; State -&gt; [Message]\n</code></pre>\n\n<p>Now, I would like to create a new class <code>Query</code>, which demands that there is a method <code>query</code> that, when applied to an instance of <code>Query</code> and a <code>State</code>, returns some object which is an instance of <code>Response</code>, but this fails to compile:</p>\n\n<pre><code>class (Response b) =&gt; Query where        -- Compile error on b: \"Not in scope: type variable b\"\n  query :: a -&gt; State -&gt; b\n</code></pre>\n\n<p>Is there a way for me to express in the <code>Query</code> class that I don't care which type the <code>query</code> method returns, as long as it instantiates the <code>Response</code> class?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1573386228, "post_id": 58788269, "comment_id": 103858650, "body": "They here simply used an infix operator <code>:&amp;</code> as data constructor. So <code>:&amp;</code> is nothing special."}], "answers": [{"comments": [{"owner": {"reputation": 1809, "user_id": 1394157, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/78a76d154cb240f2a43515b494e9748a?s=128&d=identicon&r=PG", "display_name": "Inso Reiges", "link": "https://stackoverflow.com/users/1394157/inso-reiges"}, "edited": false, "score": 1, "creation_date": 1573386689, "post_id": 58788347, "comment_id": 103858759, "body": "so.. <code>:&amp;</code> is a declaration of a data constructor? And since it uses only special characters it automatically becomes an infix function? I think i understand now, thank you!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1809, "user_id": 1394157, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/78a76d154cb240f2a43515b494e9748a?s=128&d=identicon&r=PG", "display_name": "Inso Reiges", "link": "https://stackoverflow.com/users/1394157/inso-reiges"}, "edited": false, "score": 2, "creation_date": 1573405156, "post_id": 58788347, "comment_id": 103863465, "body": "@InsoReiges Yes, it&#39;s just an arbitrary name for a constructor. It could have been <code>Cons</code>, <code>Foo</code>, or <code>:$&amp;$</code>. The only difference is that names starting with <code>:</code> are used infix instead of prefix."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1573386722, "last_edit_date": 1573386722, "creation_date": 1573386554, "answer_id": 58788347, "question_id": 58788269, "link": "https://stackoverflow.com/questions/58788269/what-does-this-haskell-data-declaration-means/58788347#58788347", "title": "What does this Haskell data declaration means", "body": "<blockquote>\n  <p>But i can't figure out what <code>:&amp;</code> means.</p>\n</blockquote>\n\n<p>Here they used <code>:&amp;</code> as the <em>infix</em> data constructor. So instead of using <code>Cons</code> like in the data declaration you quote, you should use <code>:&amp;</code>. An equivalent definition could have been:</p>\n\n<pre><code>data Stream a = <b>(:&amp;)</b> a (Stream a)</code></pre>\n\n<p>In fact, you could see the <code>:</code> operator as just another infix data constructor.</p>\n\n<p>A infix data constructor should start with a colon (<code>:</code>), as is specified in the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch2.html\" rel=\"nofollow noreferrer\">Haskell grammar</a>:</p>\n\n<blockquote><pre><code><i>consym</i> &rightarrow; ( : {symbol}) <sub>\u27e8reservedop\u27e9</sub></code></pre></blockquote>\n"}], "owner": {"reputation": 1809, "user_id": 1394157, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/78a76d154cb240f2a43515b494e9748a?s=128&d=identicon&r=PG", "display_name": "Inso Reiges", "link": "https://stackoverflow.com/users/1394157/inso-reiges"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 58788347, "answer_count": 1, "score": 1, "last_activity_date": 1573386722, "creation_date": 1573385991, "question_id": 58788269, "link": "https://stackoverflow.com/questions/58788269/what-does-this-haskell-data-declaration-means", "title": "What does this Haskell data declaration means", "body": "<p>Just started learning Haskell. Can someone be so kind to explain what this declaration means?</p>\n\n<pre><code>data Stream a = a :&amp; Stream a\n</code></pre>\n\n<p>I know that it builds an infinite stream of type a, similar to what Data/Stream does, except Data/Stream uses Cons:</p>\n\n<pre><code>data Stream a = Cons a (Stream a)\n</code></pre>\n\n<p>But i can't figure out what <code>:&amp;</code> means. <code>(:)</code> is a concatenation operator, but there is no <code>(:&amp;)</code> or <code>(&amp;)</code> operator in Haskell.</p>\n"}, {"tags": ["class", "haskell", "instance"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1573384489, "post_id": 58788079, "comment_id": 103858245, "body": "You should indent the <code>area</code> method in the <code>Polygon</code> class."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1573384619, "creation_date": 1573384619, "answer_id": 58788117, "question_id": 58788079, "link": "https://stackoverflow.com/questions/58788079/haskell-methode-of-class-is-not-visible-for-instance/58788117#58788117", "title": "Haskell methode of class is not visible for instance", "body": "<p>You need to indent the <code>area</code> method such that it is in the scope of the <code>Polygon</code> class, like:</p>\n\n<pre><code>class Polygon a where\n    area :: a -&gt; Float</code></pre>\n\n<p>By defining it with the same indentation level, you defined an empty typeclass, and created a function signature <code>area</code> without a binding.</p>\n"}], "owner": {"reputation": 75, "user_id": 12302998, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9c07fc4e19d0cafb3e3846b8f10398?s=128&d=identicon&r=PG&f=1", "display_name": "longroad", "link": "https://stackoverflow.com/users/12302998/longroad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 58788117, "answer_count": 1, "score": 2, "last_activity_date": 1573384619, "creation_date": 1573384365, "question_id": 58788079, "link": "https://stackoverflow.com/questions/58788079/haskell-methode-of-class-is-not-visible-for-instance", "title": "Haskell methode of class is not visible for instance", "body": "<p>I'm trying to define a class \"Polygon\" and subtypes \"Triangle\" and \"Quad\". Those should implement the area function of Polygon.</p>\n\n<p>So I tried to make an instance of Polygon, but this doesn't works.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Polygon a where\n\narea :: a -&gt; Float\n\ndata Triangle = MkTriangle {\n                        tP1 :: Point,\n                        tP2 :: Point,\n                        tP3 :: Point}\n                        deriving(Show)\n\ndata Quad = MkQuad{\n                    qP1 :: Point,\n                    qP2 :: Point,\n                    qP3 :: Point,\n                    qP4 :: Point}\n                    deriving(Show)\n\ninstance Polygon Triangle where\n    area triangle = 5.0\n</code></pre>\n\n<p>Note that <code>area triangle = 5.0</code> is just debugging and not the real function.\nTrying to compile this, I am getting the following error:</p>\n\n<pre><code>    `area' is not a (visible) method of class `Polygon'\n   |\n57 |         area triangle = 5\n   |         ^^^^\nFailed, no modules loaded.\n</code></pre>\n\n<p>Can you give me a hint to fix that? Thank you!</p>\n"}, {"tags": ["haskell", "comonad"], "comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1573449957, "post_id": 58787956, "comment_id": 103872936, "body": "No one likes Store?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1573513377, "post_id": 58787956, "comment_id": 103899068, "body": "I quite like <code>Store</code>! But I\u2019m slightly confused about this question: to clarify, are you asking why anyone would use <code>data Store s a = Store (s -&gt; a) a</code> instead of a concrete data type like a list or a map?"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1573514019, "post_id": 58787956, "comment_id": 103899237, "body": "@bradrn Yes! Or rather, why it was designed this way \u2014 what is the abstract justification for encoding a <i>container</i> <i>finally</i>? <i>(Since any comonad is necessarily a container, it also admits an initial representation with data constructors.)</i>"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1573515664, "post_id": 58787956, "comment_id": 103899660, "body": "Possibly, it could be because that allows you to represent any container in terms of its index type? <code>Store k v</code> is a pointed map, <code>Store Int a</code> is an infinite list, <code>Store Bool a</code> is a 2-tuple\u2026 in general, it seems very neat to me that you can represent any container using just one type. (Have a look at <code>Representable</code> if you want to learn more about this.) But then again, just because something is theoretically neat doesn\u2019t mean that it\u2019s practical or efficient!"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1573385400, "creation_date": 1573383460, "last_edit_date": 1573385400, "question_id": 58787956, "link": "https://stackoverflow.com/questions/58787956/what-is-the-point-of-the-store-comonad-if-recovering-a-container-is-difficult", "title": "What is the point of the `Store` comonad if recovering a container is difficult?", "body": "<p><a href=\"https://arxiv.org/pdf/1408.5809.pdf\" rel=\"nofollow noreferrer\">A pointed container is a comonad</a>, and this observation can be used to obtain some useful effects, like for example stencil convolutions, <a href=\"https://jaspervdj.be/posts/2014-11-27-comonads-image-processing.html\" rel=\"nofollow noreferrer\">almost for free</a>. Further it is noticed that an <code>instance Comonad</code> <a href=\"http://blog.ielliott.io/comonad-transformers-in-the-wild/\" rel=\"nofollow noreferrer\">may be obtained in a standard way</a> via the <a href=\"https://hackage.haskell.org/package/comonad-5.0.5/docs/Control-Comonad-Store.html\" rel=\"nofollow noreferrer\">Store comonad</a> <em>(by the means of a partially applied index function)</em>, and it would work just as fine as a hand-written definition.</p>\n\n<p>But this approach has a drawback: Store is essentially a function, and once something is made into a function, going back is uncomfortable. And I notice <a href=\"https://stackoverflow.com/q/57711476\">there are situations</a> such that a small change in requirements requires one to completely abandon the notion of a comonad, and return to the consideration of the initial container. I find it <a href=\"https://www.reddit.com/r/haskell/comments/dqc13x/are_there_compilers_implemented_using_final_style/\" rel=\"nofollow noreferrer\">similar to final tagless evaluation</a>: local transformations are easy, but the more context they require, the more complicated it gets. One may recover any portion of the initial container by iterating extraction over the corresponding subset of the cursor space, but then why trade the initial type for the final in the first place?</p>\n\n<p>In other words, there are 2 ways to represent a container, and both are equally conducive to the definition of <code>instance Comonad</code>:</p>\n\n<ol>\n<li>As an <em>\"initial\"</em> data type. Without Dependent Types, the trivial definition of <code>instance Comonad</code> in Haskell, when a container is paired with an index, is partial <em>(index may point to a place outside the shape of the container)</em>, but it will still work.</li>\n<li>As a <em>\"final\"</em> partially applied index function. A container may be made into a comonad by wrapping it in <code>Store</code>. It is then paired with an index automagically. Partiality argument applies equally, so there is no safety to be gained.</li>\n</ol>\n\n<p>When the initial type is traded for the final function, all the methods defined for the initial type are lost until recovered with more or less elaboration. Given that access to a small finite container is unsafe <em>(most indices are undefined)</em>, and that the container itself is not accessible to query, programming becomes a game of minesweeper. Whatever properties of the initial container I have not providently put in an <code>EnvT</code>, are lost. All in all, whatever safety or convenience benefit  <code>Store</code> is supposed to give is contested by the hardships of handling a final representation of a container.</p>\n\n<p>Put more concisely, a pointed container is, among other things, a comonad, but Store is <em>only</em> a comonad.</p>\n\n<p>So, what is the motivation for <code>Store</code>? And can we get an <code>instance Comonad</code>, or at least <a href=\"https://hackage.haskell.org/package/semigroupoids-5.3.3/docs/Data-Functor-Extend.html\" rel=\"nofollow noreferrer\"><code>Extend</code></a>, more cheaply?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1573382949, "post_id": 58787879, "comment_id": 103857899, "body": "variables start with lowercase."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 6, "last_activity_date": 1573382991, "creation_date": 1573382991, "answer_id": 58787896, "question_id": 58787879, "link": "https://stackoverflow.com/questions/58787879/haskell-multiple-where-statement/58787896#58787896", "title": "Haskell multiple where statement", "body": "<p>Variable names can't start with a capital letters. Identifiers starting with capital letters are reserved for constructor names (or type names when we're dealing with types rather than expressions).</p>\n\n<p>So <code>Q</code> and <code>C</code> are seen as constructor names in your code, which is why the compiler complains that no constructors with those names have been defined. Name them <code>q</code> and <code>c</code> instead and the problem will go away.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1573383094, "creation_date": 1573383094, "answer_id": 58787908, "question_id": 58787879, "link": "https://stackoverflow.com/questions/58787879/haskell-multiple-where-statement/58787908#58787908", "title": "Haskell multiple where statement", "body": "<p>Variables start with a <em>lowercase</em> (or certain symbols, but that is not relevant here), type constructors, data constructors, type classes, etc. start with an uppercase.</p>\n\n<p>You thus can fix this with:</p>\n\n<pre><code>solveCubic a b c d = (-b/(3*a) - <b>e</b>/(3*a) - (b*b - 3*a*c)/(3*a*<b>e</b>), 0, 0)\n    where <b>q</b> = cbrt ((2*(b**3) - 9*a*b*c + 27*a*a*d)**2 - 4*((b*b - 3*a*c)**3))\n          <b>e</b> = cbrt ((1/2)*(<b>q</b> + 2*(b**3) - 9*a*b*c + 27*a*a*d))</code></pre>\n"}], "owner": {"reputation": 28, "user_id": 11042528, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CgGxjceWroo/AAAAAAAAAAI/AAAAAAAAHPc/owzrj9j0OZE/photo.jpg?sz=128", "display_name": "ObinAtor 1", "link": "https://stackoverflow.com/users/11042528/obinator-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 58787896, "answer_count": 2, "score": 1, "last_activity_date": 1573383094, "creation_date": 1573382819, "question_id": 58787879, "link": "https://stackoverflow.com/questions/58787879/haskell-multiple-where-statement", "title": "Haskell multiple where statement", "body": "<p>I don't get what's not valid about this</p>\n\n<pre><code>solveCubic a b c d = (-b/(3*a) - C/(3*a) - (b*b - 3*a*c)/(3*a*C), 0, 0)\n    where Q = cbrt ((2*(b**3) - 9*a*b*c + 27*a*a*d)**2 - 4*((b*b - 3*a*c)**3))\n          C = cbrt ((1/2)*(Q + 2*(b**3) - 9*a*b*c + 27*a*a*d))\n</code></pre>\n\n<p>The error is</p>\n\n<pre><code>    main.hs:19:11: error: Not in scope: data constructor `Q'\n   |\n19 |     where Q = cbrt ((2*(b**3) - 9*a*b*c + 27*a*a*d)**2 - 4*((b*b - 3*a*c)**3))\n   |           ^\n\nmain.hs:20:11: error: Not in scope: data constructor `C'\n   |\n20 |           C = cbrt ((1/2)*(Q + 2*(b**3) - 9*a*b*c + 27*a*a*d))\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 1, "creation_date": 1573345391, "post_id": 58784740, "comment_id": 103852754, "body": "What errors does it give? For recursion, you need a base case."}, {"owner": {"reputation": 10593, "user_id": 4621513, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/uCfJK.png?s=128&g=1", "display_name": "mkrieger1", "link": "https://stackoverflow.com/users/4621513/mkrieger1"}, "edited": false, "score": 1, "creation_date": 1573345502, "post_id": 58784740, "comment_id": 103852777, "body": "What do the number of askerisks have to do with the numbers in front?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12349323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2796966387196005/picture?type=large", "display_name": "Chong JenFoong", "link": "https://stackoverflow.com/users/12349323/chong-jenfoong"}, "edited": false, "score": 0, "creation_date": 1573347226, "post_id": 58784835, "comment_id": 103853007, "body": "which part of my code do i replace with this? Is it just the displayGame function or all of it?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 1, "user_id": 12349323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2796966387196005/picture?type=large", "display_name": "Chong JenFoong", "link": "https://stackoverflow.com/users/12349323/chong-jenfoong"}, "edited": false, "score": 0, "creation_date": 1573350362, "post_id": 58784835, "comment_id": 103853376, "body": "@ChongJenFoong, with what error message. What might that error mean?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1573350395, "post_id": 58784835, "comment_id": 103853383, "body": "Look at hoogle.haskell.org to help navigate your way around the libraries"}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 2, "last_activity_date": 1573346416, "creation_date": 1573346416, "answer_id": 58784835, "question_id": 58784740, "link": "https://stackoverflow.com/questions/58784740/how-do-i-print-out-numbers-in-ascending-order-in-haskell/58784835#58784835", "title": "How do I print out numbers in ascending order in Haskell?", "body": "<pre><code>displayGame :: [Int] -&gt; IO ()\ndisplayGame xs = for_ (zip [1..] xs) $ \\(i, x) -&gt;\n  putStr $ show i ++ \": \" ++ replicate x '*' ++ \"\\n\\n\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12349323, "user_type": "registered", "profile_image": "https://graph.facebook.com/2796966387196005/picture?type=large", "display_name": "Chong JenFoong", "link": "https://stackoverflow.com/users/12349323/chong-jenfoong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1573346416, "creation_date": 1573345167, "last_edit_date": 1573345831, "question_id": 58784740, "link": "https://stackoverflow.com/questions/58784740/how-do-i-print-out-numbers-in-ascending-order-in-haskell", "title": "How do I print out numbers in ascending order in Haskell?", "body": "<p>I'm trying to print out something like this: </p>\n\n<pre><code>1: *****\n\n2: ****\n\n3: ***\n\n4: ******\n</code></pre>\n\n<p>The code I already have prints out the asterisks and the colon but I'm not sure how to make it print out the ascending order of numbers at the left side.When I take in a list of numbers the code prints out the number of asterisks based on each element in the list. What I can't do is print out the numbers on the left which is basically saying what the position of the number of asterisks in the list is. I've tried printing the head of a list <code>[1..10]</code> and then recursing it with <code>xs</code> of <code>(x:xs)</code> but it still gives me errors.</p>\n\n<p>This is the code I already have:</p>\n\n<pre><code>printPattern :: Int -&gt; Char -&gt; [String]\nprintPattern len a = map (take len . cycle) [[a]]\n\nprintStars :: Int -&gt; IO()\nprintStars x = mapM_ putStrLn (printPattern x '*')\n\ndisplayGame :: [Int] -&gt; IO(Int)\ndisplayGame (x:xs) = do putStr \" : \"\n                        printStars x\n                        displayGame xs\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1573339644, "post_id": 58784011, "comment_id": 103851770, "body": "Your terminology is weird: a function can not &quot;imply&quot; anything. I don&#39;t understand what are you trying to achieve. Are you trying to check if two values are equal? If so, <code>(==)</code> is a function which compares any two values whose type is in the <code>Eq</code> typeclass. (Note that you can&#39;t check if two functions are equal, so you need some typeclass constraint.)"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 2, "creation_date": 1573339978, "post_id": 58784011, "comment_id": 103851827, "body": "Are you sure you don\u2019t want to write <code>imply :: (Bool, Bool) -&gt; Bool</code>? Currently your function is trying to test whether two functions are equal, which seems decidedly odd, to say the least."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1573340003, "post_id": 58784011, "comment_id": 103851830, "body": "The signature of your function suggests that as input you take a 2-tuple where the first item is a function that maps <code>a</code>s to <code>Bool</code>s, and the second <code>b</code>s to <code>Bool</code>s. But that does not seems to be the case for your example."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1573375355, "post_id": 58784326, "comment_id": 103856396, "body": "Why is this function called <code>imply</code>? As you wrote it, it does not correspond to the truth table of implication, but of equivalence. Should it?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573412626, "post_id": 58784326, "comment_id": 103865625, "body": "@chi, look at the edit history of the question &amp; you&#39;ll get it.  (But I agree this name needs improvement)"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 5, "last_activity_date": 1573340653, "creation_date": 1573340653, "answer_id": 58784326, "question_id": 58784011, "link": "https://stackoverflow.com/questions/58784011/a-function-that-implies-true-when-a-and-b-have-the-same-value/58784326#58784326", "title": "A function that implies true when a and b have the same value", "body": "<p>I'm going to make a guess about what you want, since it seems like you are struggling with the basics of Haskell syntax.  Consider going through <a href=\"https://wiki.haskell.org/Tutorials\" rel=\"noreferrer\">a tutorial</a> if you are not already.</p>\n\n<p>I agree with <a href=\"https://stackoverflow.com/questions/58784011/a-function-that-implies-true-when-a-and-b-have-the-same-value/58784326#comment103851827_58784011\">@bradrn</a> that the function you are looking for is probably this one:</p>\n\n<pre><code>imply :: (Bool, Bool) -&gt; Bool\nimply (True, True)   = True\nimply (False, False) = True\nimply _ = False\n</code></pre>\n\n<p>I could explain all sorts of things about what you did, but I figured you just needed to see an example of how this looks.  I'm happy to answer any questions you have about it in the comments.</p>\n\n<p>To use this function, say, after loading the file in <code>ghci</code>, you type:</p>\n\n<pre><code>ghci&gt; imply (True, False)\nFalse\nghci&gt; imply (False, False)\nTrue\n</code></pre>\n\n<p>Note that in Haskell the convention is to define functions <em>curried</em>, so we would instead see</p>\n\n<pre><code>imply :: Bool -&gt; Bool -&gt; Bool\nimply True True = True\n...\n\nghci&gt; imply True False\nFalse\n</code></pre>\n\n<p>But the two versions are <em>(almost)</em> equivalent.</p>\n"}], "owner": {"reputation": 19, "user_id": 12348925, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/81HAH.jpg?s=128&g=1", "display_name": "K-1", "link": "https://stackoverflow.com/users/12348925/k-1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 58784326, "answer_count": 1, "score": 0, "last_activity_date": 1573401015, "creation_date": 1573337810, "last_edit_date": 1573401015, "question_id": 58784011, "link": "https://stackoverflow.com/questions/58784011/a-function-that-implies-true-when-a-and-b-have-the-same-value", "title": "A function that implies true when a and b have the same value", "body": "<p>I am trying to get true when both a and b are true or both of them are false. Can someone tell me what am I doing wrong?</p>\n\n<pre><code>imply :: (a -&gt; Bool, b -&gt; Bool) -&gt; Bool\na = False\nb = True\nimply (a, a) = True\nimply (b, b) = True\nimply _ = False\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1573334197, "post_id": 58783542, "comment_id": 103850650, "body": "What is the type of <code>getLine</code>?"}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1573334232, "post_id": 58783542, "comment_id": 103850656, "body": "What is the type of <code>+</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1573334556, "post_id": 58783542, "comment_id": 103850724, "body": "Binding variables to <code>0</code> like that isn&#39;t useful at all. Remember: Haskell variables are immutable, so once you define them to be something, you can never change them. The later bindings will actually <i>shadow</i> the original ones, binding <i>different</i> variables that just happen to have the same names."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 9351158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c14240de39656a631a75d6c4da0295a?s=128&d=identicon&r=PG&f=1", "display_name": "Clambert", "link": "https://stackoverflow.com/users/9351158/clambert"}, "edited": false, "score": 0, "creation_date": 1573437913, "post_id": 58783673, "comment_id": 103870888, "body": "while this helped me compile (which i greatly appreciate) it still errors out past insertion of my first number"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 33, "user_id": 9351158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c14240de39656a631a75d6c4da0295a?s=128&d=identicon&r=PG&f=1", "display_name": "Clambert", "link": "https://stackoverflow.com/users/9351158/clambert"}, "edited": false, "score": 0, "creation_date": 1573439303, "post_id": 58783673, "comment_id": 103871116, "body": "@Clambert, what did you type? What error did you get exactly?"}, {"owner": {"reputation": 33, "user_id": 9351158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c14240de39656a631a75d6c4da0295a?s=128&d=identicon&r=PG&f=1", "display_name": "Clambert", "link": "https://stackoverflow.com/users/9351158/clambert"}, "edited": false, "score": 0, "creation_date": 1573518694, "post_id": 58783673, "comment_id": 103900269, "body": "sorry it was errors specific to the fact i was using an online compiler, after using a regular compiler it ran perfectly and helped me to finish the program thanks!"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1573335550, "last_edit_date": 1573335550, "creation_date": 1573335036, "answer_id": 58783673, "question_id": 58783542, "link": "https://stackoverflow.com/questions/58783542/haskell-function-to-identify-triangles/58783673#58783673", "title": "haskell function to identify triangles", "body": "<p>The main problem is that <code>getLine</code> reads strings, but you actually need numbers. The smallest fix is to switch to <code>readLn :: Read a =&gt; IO a</code>.</p>\n\n<pre><code>main = do\n  putStrLn \"Input your angles.\"\n  angle1 &lt;- readLn\n  angle2 &lt;- readLn\n  angle3 &lt;- readLn\n  if angle1 + angle2 + angle3 == 180\n    then putStrLn \"The triangle is valid.\"\n    else putStrLn \"The triangle is not valid.\"\n  -- Add right triangle logic here. You\n  -- may wish to use the `any` function.\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 9351158, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c14240de39656a631a75d6c4da0295a?s=128&d=identicon&r=PG&f=1", "display_name": "Clambert", "link": "https://stackoverflow.com/users/9351158/clambert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 58783673, "answer_count": 1, "score": 0, "last_activity_date": 1573378443, "creation_date": 1573333958, "last_edit_date": 1573378443, "question_id": 58783542, "link": "https://stackoverflow.com/questions/58783542/haskell-function-to-identify-triangles", "title": "haskell function to identify triangles", "body": "<p>i am brand new to haskell and have been asked by one of my professors to make a simple haskell program that determines if a triangle is valid by the three angles provided by the users, and to identify if the triangle is right obtuse or scalene. i am struggling to understand how variables (particularly numbers) work in haskell and am trying to at least complete the function that determines validity my code looks like this, </p>\n\n<pre><code>main = do\n    let angle1 = 0\n    let angle2 = 0 \n    let angle3 = 0\n    putStrLn \"input your angles.\"\n    angle1 &lt;- getLine\n    angle2 &lt;- getLine\n    angle3 &lt;- getLine\n    if angle1 + angle2 + angle3 == 180\n        then putStrLn \"triangle is valid\"\n    else putStrLn \"triangle is not valid\"\n</code></pre>\n\n<p>i assume it has to do with IO errors or that getline is string instead of int? any assistance would be appreciated.</p>\n"}, {"tags": ["haskell", "compiler-construction", "language-features", "typechecking"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1573329702, "post_id": 58783024, "comment_id": 103849631, "body": "An <code>if ... then ... else ...</code>, needs to have the same type in the <code>then</code> and <code>else</code> part. You can see it as a ternary operator in some programming languages."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573329989, "post_id": 58783024, "comment_id": 103849708, "body": "To the best of my knowledge, there is no <i>anonymous</i> sum type, as in, all conversions are done explicitly. You can use <code>Left</code> and <code>Right</code> to convert it to an <code>Either Int Double</code>. I don&#39;t see why implementing it would be that hard. But Haskell aims to make all &quot;conversions&quot; explicit. So even converting an <code>Int</code> to a <code>Double</code>, something that a lot of languages do implicitly, is done explicitly."}, {"owner": {"reputation": 532, "user_id": 5031397, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-7o0CJBsl-8k/AAAAAAAAAAI/AAAAAAAARp0/VQwhXZ8i_Hg/photo.jpg?sz=128", "display_name": "Mehdi Saffar", "link": "https://stackoverflow.com/users/5031397/mehdi-saffar"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1573330258, "post_id": 58783024, "comment_id": 103849779, "body": "I agree about the <code>making all conversions explicit</code>. In my question, I do not want Haskell cast an <code>Int</code> to a <code>Double</code> or vice versa. I just used those two types as an example. You could replace every <code>Int</code> with <code>a</code> and <code>Double</code> with <code>b</code> in my question where both types derive <code>Show</code>. I understand that there are no <code>anonymous sum types</code> in Haskell but I would like to know why that is the case and what is stopping us from designing the language to have it."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1573330778, "post_id": 58783024, "comment_id": 103849886, "body": "I think such types are called <i>union types</i>. A sum type is essentially a <i>tagged</i> variant of the union type, where each value must carry a left / right tag beyond the value of the inner type. I expect that type inference with union types, with all the type-level features of Haskell is very hard to achieve. If <code>x :: Int | Bool</code> and we have to compile <code>show x</code>, there&#39;s no easy way to know which pointer-to-function to use for calling <code>show</code>, in a type-erasure based RTS. We&#39;d probably need to keep some type level information at runtime."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1573331133, "post_id": 58783024, "comment_id": 103849969, "body": "Not having anonymous sum types is a design decision of Haskell designers. I&#39;m not quite sure what kind of benefit they would bring to the table, bit I do see where they would complicate things. So my guess is that they are left out because the cost/benefit ratio isn&#39;t there. But to be absolutely sure you need to ask the original language designers and/or current maintainers. I don&#39;t think it would make a great SO question, because there&#39;s a great deal of personal opinions and tastes involved in designing a language."}, {"owner": {"reputation": 532, "user_id": 5031397, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-7o0CJBsl-8k/AAAAAAAAAAI/AAAAAAAARp0/VQwhXZ8i_Hg/photo.jpg?sz=128", "display_name": "Mehdi Saffar", "link": "https://stackoverflow.com/users/5031397/mehdi-saffar"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573331206, "post_id": 58783024, "comment_id": 103849986, "body": "@chi So if I understand correctly, for the compiler to <i>typecheck</i> that both <code>Int</code> and <code>Double</code> could be passed to <code>show</code> is easy, but the actual compilation step would require having some runtime type information to be able to decide what &quot;variant&quot; of the <code>show</code> function to call based on which of <code>Int</code> or <code>Bool</code> it happens to take when the <code>if ... else ...</code> is evaluated, correct?"}, {"owner": {"reputation": 532, "user_id": 5031397, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-7o0CJBsl-8k/AAAAAAAAAAI/AAAAAAAARp0/VQwhXZ8i_Hg/photo.jpg?sz=128", "display_name": "Mehdi Saffar", "link": "https://stackoverflow.com/users/5031397/mehdi-saffar"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1573331367, "post_id": 58783024, "comment_id": 103850017, "body": "@n.&#39;pronouns&#39;m. the way I think of it is since we have tuples like <code>(String, Int)</code> which are essentially anonymous product types, we should also have <code>(String | Int)</code>, union types, which are essentially anonymous sum types."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573331504, "post_id": 58783024, "comment_id": 103850046, "body": "@chi The question as I see it is not why Haskell doesn&#39;t have un-discriminated unions. These are clearly out of the question. The question is why sum types need to be explicitly constructed with a relatively heavyweight syntax."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1573331629, "post_id": 58783024, "comment_id": 103850074, "body": "<code>(String, Int)</code> is not anonymous. It is just a regular product type with funny syntax. <code>(String | Int)</code> would be a whole lot different. Start with asking yourself whether <code>(Int|Int)</code> should be identical to <code>Int</code> and why."}, {"owner": {"reputation": 532, "user_id": 5031397, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-7o0CJBsl-8k/AAAAAAAAAAI/AAAAAAAARp0/VQwhXZ8i_Hg/photo.jpg?sz=128", "display_name": "Mehdi Saffar", "link": "https://stackoverflow.com/users/5031397/mehdi-saffar"}, "edited": false, "score": 0, "creation_date": 1573331931, "post_id": 58783024, "comment_id": 103850136, "body": "I would say <code>(Int|Int)</code> is identical to <code>Int</code> except that it is redundant. Out of curiosity, in TypeScript I defined <code>const a : Number | Number = 2</code> and it didn&#39;t complain."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573332007, "post_id": 58783024, "comment_id": 103850152, "body": "Indeed, TypeScript does support union and intersection types, even though Haskell doesn&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 532, "user_id": 5031397, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-7o0CJBsl-8k/AAAAAAAAAAI/AAAAAAAARp0/VQwhXZ8i_Hg/photo.jpg?sz=128", "display_name": "Mehdi Saffar", "link": "https://stackoverflow.com/users/5031397/mehdi-saffar"}, "edited": false, "score": 0, "creation_date": 1573331437, "post_id": 58783130, "comment_id": 103850033, "body": "Could you please elaborate on the difference between union/intersection types and sum/product types? I have always thought they were the same, except for anonymity?"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 532, "user_id": 5031397, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-7o0CJBsl-8k/AAAAAAAAAAI/AAAAAAAARp0/VQwhXZ8i_Hg/photo.jpg?sz=128", "display_name": "Mehdi Saffar", "link": "https://stackoverflow.com/users/5031397/mehdi-saffar"}, "edited": false, "score": 1, "creation_date": 1573331897, "post_id": 58783130, "comment_id": 103850129, "body": "@MehdiSaffar Anonymous as in untagged, not as in an unnamed constructor. In other words, if you have an <code>Int \u222a Double</code>, then you&#39;d know you have one of the two, but wouldn&#39;t be able to pattern match to see which, so you could only do things that would be valid to do for both possibilities."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 532, "user_id": 5031397, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-7o0CJBsl-8k/AAAAAAAAAAI/AAAAAAAARp0/VQwhXZ8i_Hg/photo.jpg?sz=128", "display_name": "Mehdi Saffar", "link": "https://stackoverflow.com/users/5031397/mehdi-saffar"}, "edited": false, "score": 2, "creation_date": 1573332123, "post_id": 58783130, "comment_id": 103850182, "body": "For clarity, TypeScript has type information available at runtime, so it has a <code>typeof</code> operator that can make up for the lack of tagging and see which type is used anyway. Haskell is fully type-erased, so if it supported this feature, then there wouldn&#39;t be any equivalent to that."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 8, "last_activity_date": 1573331160, "last_edit_date": 1573331160, "creation_date": 1573330427, "answer_id": 58783130, "question_id": 58783024, "link": "https://stackoverflow.com/questions/58783024/sum-types-why-in-haskell-is-show-int-double-different-than-show-int/58783130#58783130", "title": "Sum types - Why in Haskell is `show (Int | Double)` different than `(show Int) | (show Double)`", "body": "<p>All parts of an expression must be well-typed. The type of <code>if someCondition then someInt else someDouble</code> would have to be something like <code>exists a. Show a =&gt; a</code>, but Haskell doesn't support that kind of existential quantification.</p>\n\n<p>Update: As <a href=\"https://stackoverflow.com/questions/58783024/sum-types-why-in-haskell-is-show-int-double-different-than-show-int/58783130#comment103849886_58783024\">chi points out in a comment</a>, this would also be possible if Haskell had support for union/intersection types (which are not the same as sum/product types), but it unfortunately doesn't.</p>\n"}, {"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 1, "creation_date": 1573333892, "post_id": 58783422, "comment_id": 103850579, "body": "@MichaWiedenmann Frankly I don&#39;t know if &quot;relevant&quot; is the right word. I think it is helpful in some way or other. Yes I did stop for a moment and think whether to include it. But I&#39;m known to be wrong at times."}, {"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 0, "creation_date": 1573333977, "post_id": 58783422, "comment_id": 103850602, "body": "No problem, its your post, you decide."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1573348966, "post_id": 58783422, "comment_id": 103853213, "body": "So what are your pronouns?"}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 7, "last_activity_date": 1573333087, "creation_date": 1573333087, "answer_id": 58783422, "question_id": 58783024, "link": "https://stackoverflow.com/questions/58783024/sum-types-why-in-haskell-is-show-int-double-different-than-show-int/58783422#58783422", "title": "Sum types - Why in Haskell is `show (Int | Double)` different than `(show Int) | (show Double)`", "body": "<p>There are product types with lightweight syntax, written <code>(,)</code>, in Haskell. One would thing that a sum type with a lightweight syntax, something like <code>(Int | String)</code>, would be a great idea. The reality is more complicated. Let's see why (I'm taking some liberties with <code>Num</code>, they are not important). </p>\n\n<pre><code>if someCondition then 42 else \"helloWorld\"\n</code></pre>\n\n<p>If this should return a value of type like <code>(Int | String)</code>, then what should the following return?</p>\n\n<pre><code>if someCondition then 42 else 0\n</code></pre>\n\n<p><code>(Int | Int)</code> obviously, but if this is distinct from plain <code>Int</code> then we're in deep trouble. So <code>(Int | Int)</code> should be identical to plain <code>Int</code>.</p>\n\n<p>One can immediately see that this is not just lightweight syntax for sum types, but a wholly new language feature. A different kind of type system if you will. Should we have one?</p>\n\n<p>Let's look at this function.</p>\n\n<pre><code>mysteryType x a b = if x then a else b\n</code></pre>\n\n<p>Now what type does <code>mysteryType</code> have? Obviously </p>\n\n<pre><code>mysteryType :: Bool -&gt; a -&gt; b -&gt; (a|b)\n</code></pre>\n\n<p>right? Now what if <code>a</code> and <code>b</code> are the same type? </p>\n\n<pre><code>let x = mysteryType True 42 0\n</code></pre>\n\n<p>This should be plain <code>Int</code> as we have agreed previously. Now <code>mysteryType</code> sometimes return an anonymous sum type, and sometimes it does not, depending on what arguments you pass. How would you pattern match such an expression? What on Earth can you do with it? Except trivial things like \"show\" (or whatever methods of other type-classes it would be an instance of), not a whole lot. Unless you add run-time type information to the language, that is, so <code>typeof</code> is available  \u2014 and that make Haskell an <em>entirely</em> different language.</p>\n\n<p>So yeah. Why isn't Haskell a TypeScript? Because we don't need another TypeScript. If you want TypeScript, you know where to find it.</p>\n"}], "owner": {"reputation": 532, "user_id": 5031397, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-7o0CJBsl-8k/AAAAAAAAAAI/AAAAAAAARp0/VQwhXZ8i_Hg/photo.jpg?sz=128", "display_name": "Mehdi Saffar", "link": "https://stackoverflow.com/users/5031397/mehdi-saffar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "answer_count": 2, "score": 9, "last_activity_date": 1573333087, "creation_date": 1573329589, "question_id": 58783024, "link": "https://stackoverflow.com/questions/58783024/sum-types-why-in-haskell-is-show-int-double-different-than-show-int", "title": "Sum types - Why in Haskell is `show (Int | Double)` different than `(show Int) | (show Double)`", "body": "<p>Why are these not equivalent?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>show $ if someCondition then someInt else some double\n</code></pre>\n\n<p>and</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>if someCondition then show someInt else show someDouble\n</code></pre>\n\n<p>I understand that if you isolate the <code>if ... else</code> part in the first example to an expression by itself then you can't represent its type with an anonymous sum type, the kind of <code>Int | Double</code>, like something you could do easily in TypeScript (mentioning TypeScript because it is the langauge I used often and that supports Sum types), and would have to resort to using the <code>Either</code> data then based on it would call <code>show</code>.</p>\n\n<p>The example I gave here is trivial but to me it makes more sense to think \"Okay we are going to show something, and that something depends on <code>someCondition</code>\" rather than \"Okay if someCondition is true then show someInt otherwise show someDouble\", and also allows for less code duplication (here the show is repeated twice but it could also be a long function application and instead of an <code>if ... else</code> there could be >2 branches to consider)</p>\n\n<p>In my mind it should be easy for the compiler to check if each of the types that make the sum type (here <code>Int | Double</code>) could be used as a parameter to <code>show</code> function and decides if the types are correct or not. Even better is that <code>show</code> function always returns a <code>string</code> no matter the types of the parameters, so the compiler doesn't have to carry with it all the possible \"branches\" (so all the possible types).</p>\n\n<p>Is it by choice that such a feature doesn't exist? Or is implementing it harder that I think?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1573327897, "post_id": 58782795, "comment_id": 103849216, "body": "Do you actually have <code>solve l r a b = . . .</code> indented like that?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573327912, "post_id": 58782795, "comment_id": 103849219, "body": "The function body should be lined up with the type signature, on the left - yours is indented."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1573327969, "post_id": 58782795, "comment_id": 103849225, "body": "You should not indent the function definition. It has the same level as the signature."}, {"owner": {"reputation": 1, "user_id": 12348660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734d222d144e6a1cc44f372cd08cd3ef?s=128&d=identicon&r=PG&f=1", "display_name": "junkicide", "link": "https://stackoverflow.com/users/12348660/junkicide"}, "edited": false, "score": 0, "creation_date": 1573328179, "post_id": 58782795, "comment_id": 103849272, "body": "I tried to line up the definition with the signature. It still produces the same error"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573328747, "post_id": 58782795, "comment_id": 103849394, "body": "All the equations in the <code>let</code> should also be indented at the same level."}, {"owner": {"reputation": 1, "user_id": 12348660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734d222d144e6a1cc44f372cd08cd3ef?s=128&d=identicon&r=PG&f=1", "display_name": "junkicide", "link": "https://stackoverflow.com/users/12348660/junkicide"}, "edited": false, "score": 0, "creation_date": 1573328913, "post_id": 58782795, "comment_id": 103849440, "body": "Sorry about that, I think there was a mess up while pasting my code. The let expressions are indeed correctly indented in my original code, and so is the in expression"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1573329193, "post_id": 58782795, "comment_id": 103849513, "body": "<code>solve :: solve ::</code> doesn&#39;t make any sense."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1573331050, "post_id": 58782795, "comment_id": 103849949, "body": "Don&#39;t edit your code to resolve errors pointed out in an answer."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1573332822, "post_id": 58782795, "comment_id": 103850358, "body": "I find studying other people&#39;s Haskell code to be a useful way of assimilating the language, even if I don&#39;t understand entirely what it is I&#39;m reading."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12348660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734d222d144e6a1cc44f372cd08cd3ef?s=128&d=identicon&r=PG&f=1", "display_name": "junkicide", "link": "https://stackoverflow.com/users/12348660/junkicide"}, "edited": false, "score": 0, "creation_date": 1573328718, "post_id": 58782817, "comment_id": 103849390, "body": "Thanks for pointing it out. I corrected this and I still get the same error."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 1, "user_id": 12348660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734d222d144e6a1cc44f372cd08cd3ef?s=128&d=identicon&r=PG&f=1", "display_name": "junkicide", "link": "https://stackoverflow.com/users/12348660/junkicide"}, "edited": false, "score": 0, "creation_date": 1573328794, "post_id": 58782817, "comment_id": 103849405, "body": "Well, your <code>let</code> bindings are also not aligned, as well as <code>in</code>"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 1, "user_id": 12348660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734d222d144e6a1cc44f372cd08cd3ef?s=128&d=identicon&r=PG&f=1", "display_name": "junkicide", "link": "https://stackoverflow.com/users/12348660/junkicide"}, "edited": false, "score": 1, "creation_date": 1573328910, "post_id": 58782817, "comment_id": 103849438, "body": "But you can&#39;t actually be getting <i>the exact same</i> error. The error quoted in your original question does point at <code>solve</code>. The error you&#39;re getting now must be pointing somewhere else. So take a look there."}, {"owner": {"reputation": 1, "user_id": 12348660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734d222d144e6a1cc44f372cd08cd3ef?s=128&d=identicon&r=PG&f=1", "display_name": "junkicide", "link": "https://stackoverflow.com/users/12348660/junkicide"}, "edited": false, "score": 0, "creation_date": 1573329220, "post_id": 58782817, "comment_id": 103849520, "body": "It is indeed the exact same error, pointing at the line 11 as in the question"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1573329237, "post_id": 58782817, "comment_id": 103849521, "body": "It&#39;s almost certainly because the bad type signature <code>f :: f :: ...</code>"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1573329316, "post_id": 58782817, "comment_id": 103849537, "body": "@ThomasMDuBuisson that bad signature wasn&#39;t there in the original question. It must have been added later. Perhaps another typo."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573330233, "post_id": 58782817, "comment_id": 103849769, "body": "if the error being pointed at is really the initial <code>s</code> of <code>solve</code> in the type signature, then the <i>real</i> error is almost certainly on the line(s) before it. If that is line 11, we need to know what&#39;s in lines 1-10."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573331018, "post_id": 58782817, "comment_id": 103849938, "body": "I&#39;ve rolled the question back to the original code."}, {"owner": {"reputation": 1, "user_id": 12348660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734d222d144e6a1cc44f372cd08cd3ef?s=128&d=identicon&r=PG&f=1", "display_name": "junkicide", "link": "https://stackoverflow.com/users/12348660/junkicide"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573348907, "post_id": 58782817, "comment_id": 103853204, "body": "@RobinZigmond The lines 1-10 are just the function &#39;expression&#39; as in the question, and one <code>import Text.Printf (printf)</code> in the beginning, that&#39;s all"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1573350547, "post_id": 58782817, "comment_id": 103853405, "body": "That&#39;s 4 lines, not 10. And you didn&#39;t specify the indentation of the import"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 0, "last_activity_date": 1573328833, "last_edit_date": 1573328833, "creation_date": 1573327989, "answer_id": 58782817, "question_id": 58782795, "link": "https://stackoverflow.com/questions/58782795/im-getting-a-very-general-error-on-my-haskell-code-parse-error-possibly-incor/58782817#58782817", "title": "I&#39;m getting a very general error on my Haskell code: parse error (possibly incorrect indentation or mismatched brackets)", "body": "<p>Haskell is sensitive to whitespace and indentation. In this particular case, it's about indentation of the function definition: it needs to be indented at the same level as the type signature:</p>\n\n<pre><code>solve :: Integer -&gt; Integer -&gt; [Integer] -&gt; [Integer] -&gt; [Double]\nsolve l r a b = ...\n</code></pre>\n\n<p>And same goes for your definition of <code>expression</code>.</p>\n\n<p>After you fix this issue, the next one is that your <code>let</code> bindings are not aligned.</p>\n"}], "owner": {"reputation": 1, "user_id": 12348660, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/734d222d144e6a1cc44f372cd08cd3ef?s=128&d=identicon&r=PG&f=1", "display_name": "junkicide", "link": "https://stackoverflow.com/users/12348660/junkicide"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1573330999, "creation_date": 1573327787, "last_edit_date": 1573330999, "question_id": 58782795, "link": "https://stackoverflow.com/questions/58782795/im-getting-a-very-general-error-on-my-haskell-code-parse-error-possibly-incor", "title": "I&#39;m getting a very general error on my Haskell code: parse error (possibly incorrect indentation or mismatched brackets)", "body": "<p>I have the following code, that takes inputs 'a' the integral coefficients and 'b' the integral powers in some polynomial expression in x, along with integers 'l' and 'r'. It uses rectangles of thickness 0.001 to estimate the integral between x=l and x=r. It then calculates the volume traced by the curve on rotation about the x-axis, by adding up volumes of the the cylinders traced by the rectangles of thickness 0.001.</p>\n\n<p>I have made sure the indentations are fine, and have checked the code several times for correctness. The error is so general that I have no ideas on where I should start troubleshooting.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>solve :: Integer -&gt; Integer -&gt; [Integer] -&gt; [Integer] -&gt; [Double]\nsolve l r a b = let list1 = [l, (l+0.001)..(r-0.001)] \n                           arealist = [(expression x a b)*0.001 |  x&lt;-list1]\n                           volumelist = [(0.001*pi*(expression x a b)^2 |  x&lt;- list1]\n                       in [sum(arealist), sum(volumelist)]\n</code></pre>\n\n<p>The function 'expression' is defined as follows </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>expression :: Integer -&gt;  [Integer] -&gt; [Integer] -&gt; Double\nexpression x [] [] = 0.0\nexpression x a b = fromIntegral(head(a))*fromIntegral(x^(head(b)) + (expression x (tail(a)) (tail(b))) \n</code></pre>\n\n<p>The expected output is a list of 2 elements, the integral along with the volume of the cylinder. I have the following error</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code> parse error (possibly incorrect indentation or mismatched brackets)\n   |\n11 | solve :: Integer -&gt; Integer -&gt; [Integer] -&gt; [Integer] -&gt; [Double]\n   | ^\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 1, "creation_date": 1573315197, "post_id": 58780928, "comment_id": 103845882, "body": "Perhaps you want to make <code>data Currency = Euro Int Int | Dollar Int Int | Yen Int Int</code>. I would use <code>Float</code> instead of <code>Int</code> though. May be you want to contain the current sell and bid values.. Just guessing."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1573315032, "creation_date": 1573315032, "answer_id": 58780978, "question_id": 58780928, "link": "https://stackoverflow.com/questions/58780928/how-do-i-define-a-data-type-consisting-of-other-data-types/58780978#58780978", "title": "How do I define a data type consisting of other data types?", "body": "<p>Currently your <code>Currency</code> is constructed as three values, that take <em>no</em> parameters. So <code>Euro</code> is a value, <code>Dollar</code> is a value, and <code>Yen</code> is a value, but not <code>MkYen 15</code>.</p>\n\n<p>You can add parameters to your data constructors like:</p>\n\n<pre><code>data Currency = Euro <b>Euro</b> | Dollar <b>Dollar</b> | Yen <b>Yen</b></code></pre>\n\n<p>Then you thus can construct a <code>Currency</code> with:</p>\n\n<pre><code><b>Euro</b> (MkEuro 14 25) :: Currency</code></pre>\n\n<p>The <code>:: Currency</code> is <em>not</em> necessary. The <code>MkEuro</code> will thus construct an object of the <code>Euro</code> type, and then we use the <code>Euro</code> <em>data</em> constructor with type <code>Euro -&gt; Currency</code> to construct a <code>Currency</code>.</p>\n\n<blockquote>\n  <p>Sadly I have to use the type <code>Currency</code> and can't create different functions for all three currencies.</p>\n</blockquote>\n\n<p>You might want to make a <code>Currency</code> <em>typeclass</em> however, that provides an interface that says what functions a currency should implement, and then make <code>Euro</code>, <code>Dollar</code>, and <code>Yen</code> instances of that typeclass.</p>\n"}, {"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 2, "last_activity_date": 1573315145, "creation_date": 1573315145, "answer_id": 58780994, "question_id": 58780928, "link": "https://stackoverflow.com/questions/58780928/how-do-i-define-a-data-type-consisting-of-other-data-types/58780994#58780994", "title": "How do I define a data type consisting of other data types?", "body": "<p>The issue with what you attempted is that the <code>Euro</code>, <code>Dollar</code> and <code>Yen</code> defined on the first 3 lines (on the left-hand-side of the <code>=</code> signs) are <em>types</em>, whereas those in the last line, on the right-hand-side, are <em>data constructors</em>. These are different things, which is why you're allowed to give them the same names - but also means that the <em>value</em> <code>Dollar</code> has the <em>type</em> <code>Currency</code>, not the type <code>Dollar</code>.</p>\n\n<p>You had the right idea to create a union type combining the other three - but you are confusing the data constructors (which are just \"tags\") with the types of the values they hold. You can fix it like this:</p>\n\n<pre><code>data Currency = Euro Euro | Dollar Dollar | Yen Yen\n</code></pre>\n\n<p>That might look confusing to have the same name twice (three times, too) - but the two occurrences of the name have different meanings. In <code>Euro Euro</code>, for example, the first <code>Euro</code> is a data constructor (a function which \"tags\" the value), while the second is the <em>type</em> on which the constructor function operates.</p>\n"}], "owner": {"reputation": 31, "user_id": 12348011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c01749dacad27225fc31de8bf85df36?s=128&d=identicon&r=PG&f=1", "display_name": "jonas", "link": "https://stackoverflow.com/users/12348011/jonas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "accepted_answer_id": 58780978, "answer_count": 2, "score": 2, "last_activity_date": 1573315145, "creation_date": 1573314812, "question_id": 58780928, "link": "https://stackoverflow.com/questions/58780928/how-do-i-define-a-data-type-consisting-of-other-data-types", "title": "How do I define a data type consisting of other data types?", "body": "<p>I want to define the data type Currency, which consists of three other data types. I have the problem that Haskell doesn't recognize the data types as a part of currency, which breaks everything.</p>\n\n<p>My idea was to define the different currencies as their own data types and then add them to the Currency type, which I tried with:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Euro = MkEuro Integer Integer\ndata Dollar = MkDollar Integer Integer\ndata Yen = MkYen Integer\ndata Currency = Euro | Dollar | Yen\n</code></pre>\n\n<p>If I want to use the type Currency in any function I get a variation of the following error message:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Couldn't match expected type `Currency' with actual type `Dollar'\n</code></pre>\n\n<p>Sadly I have to use the type Currency and can't create different functions for all three currencies.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573314476, "post_id": 58780845, "comment_id": 103845677, "body": "<code>b</code> can not be a type, it is probably <code>data B = B Int Int Int [B]</code>. What did you try? What is not working?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573314505, "post_id": 58780845, "comment_id": 103845683, "body": "aside from the fact that your code won&#39;t compile due to casing issues (the <code>data</code> keyword is all lowercase, type constructors and data constructors must start with an uppercase letter unlike the <code>b</code> that you&#39;ve used for both), you do this by pattern matching to give a name to the list then using the <code>length</code> function."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 0, "last_activity_date": 1573314616, "creation_date": 1573314616, "answer_id": 58780892, "question_id": 58780845, "link": "https://stackoverflow.com/questions/58780845/how-to-return-number-of-items-in-a-list-in-a-defined-data-type-with-haskell/58780892#58780892", "title": "How to return number of items in a list in a defined data type with haskell", "body": "<p>First of all, <code>b</code> can not be a type. A type starts with an uppercase. So the type is likely:</p>\n\n<pre><code><b>data</b> <b>B</b> = <b>B</b> Int Int Int [<b>B</b>] deriving (Eq)</code></pre>\n\n<p>You can use pattern matching to \"unpack\" the data constructor. So here you can define a function:</p>\n\n<pre><code>kk :: B -&gt; Int\nkk (B a b c ds) = &hellip;</code></pre>\n\n<p>Where <code>a</code> will be the first item of the data constructor (so <code>3</code> in the sample data), <code>b</code> the second item (so <code>4</code> in the sample data), etc. I leave filling in the <code>&hellip;</code> as an exercise.</p>\n"}], "owner": {"reputation": 33, "user_id": 11250729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ab0ddfe22353c1257870e3e47906a1d?s=128&d=identicon&r=PG&f=1", "display_name": "yam", "link": "https://stackoverflow.com/users/11250729/yam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573314616, "creation_date": 1573314352, "last_edit_date": 1573314423, "question_id": 58780845, "link": "https://stackoverflow.com/questions/58780845/how-to-return-number-of-items-in-a-list-in-a-defined-data-type-with-haskell", "title": "How to return number of items in a list in a defined data type with haskell", "body": "<p>so with the defined data type</p>\n\n<p>I am wondering how do you find the number of items in <code>list [b]</code> with a function.\ne.g if <code>a = b 3 4 5 [c,d,e]</code>\nThis will return 3 with the function</p>\n\n<pre><code>Data b = b Int Int Int [b] deriving (Eq) \n\nkk :: b -&gt; Int \n</code></pre>\n\n<p>sample input:</p>\n\n<pre><code>ghci&gt; a = b 3 4 5 [b,c,d] \nghci&gt; kk a\n3\n</code></pre>\n"}, {"tags": ["haskell", "prompt", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573321006, "post_id": 58780360, "comment_id": 103847458, "body": "What system are you on that has a umask that you&#39;d need to <code>chmod go-w</code> a newly-created file?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573326596, "post_id": 58780360, "comment_id": 103848923, "body": "@JosephSible: often the default umask of a Linux distro gives permissions to the group :)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1573310727, "creation_date": 1573310727, "answer_id": 58780360, "question_id": 58780284, "link": "https://stackoverflow.com/questions/58780284/set-prompt-in-haskell/58780360#58780360", "title": "Set prompt in Haskell", "body": "<p>You can make a <a href=\"https://downloads.haskell.org/~ghc/7.4.1/docs/html/users_guide/ghci-dot-files.html\" rel=\"nofollow noreferrer\"><code>.ghci</code> file</a> that specifies the configuration of your GHCi environment.</p>\n\n<p>For a *nix system, that is often located at the <code>~/.ghci</code>, for a Windows system, that is apparently located at <code>appdata/ghc/ghci.conf</code> where <code>appdata</code> is often <code>C:/Documents and Settings/<i>user</i>/Application Data</code>.</p>\n\n<p>You can thus write to this <code>.ghci</code> (or <code>ghci.conf</code>) file a set of instructions to do when opening the GHC shell, like:</p>\n\n<pre><code>:set prompt \"GHCi&gt; \"\n</code></pre>\n\n<p>GHCi will furthermore probably require to set the permissions to the file, for example on a Linux system with:</p>\n\n<pre><code>chmod go-w ~/.ghci\n</code></pre>\n\n<p>such that the group and other users can not write to the file.</p>\n"}], "owner": {"reputation": 163, "user_id": 12313191, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDelPS5VpuVOfMYXPwWBTLBvilRRWDWFzYm4WiPJA=k-s128", "display_name": "Yoni Melki", "link": "https://stackoverflow.com/users/12313191/yoni-melki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 1, "accepted_answer_id": 58780360, "answer_count": 1, "score": 1, "last_activity_date": 1573310727, "creation_date": 1573310163, "question_id": 58780284, "link": "https://stackoverflow.com/questions/58780284/set-prompt-in-haskell", "title": "Set prompt in Haskell", "body": "<p>I'm new in Haskell</p>\n\n<p>Instead of the:</p>\n\n<pre><code>Prelude&gt;\n</code></pre>\n\n<p>I want GHCi to prompt </p>\n\n<pre><code>GHCi&gt;\n</code></pre>\n\n<p>I wrote </p>\n\n<pre><code>:set prompt \"GHCi&gt; \"\n</code></pre>\n\n<p>but when I close GHCi and open it again it show me </p>\n\n<pre><code>prelude\n</code></pre>\n\n<p>again.\nI saw that I need to create a file called .ghci in my home folder and set its to contents to</p>\n\n<pre><code>:set prompt \"GHCi&gt; \".\n</code></pre>\n\n<p>How can I create this file and set the prompt.\nThank You for your answers</p>\n"}, {"tags": ["haskell", "utf-8", "yaml"], "comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1573287369, "post_id": 58777439, "comment_id": 103840040, "body": "I am not very familiar with string handling in Haskell, particularly, how the <code>Show</code> instance for <code>ByteString</code> works, but <code>&quot;\\177&quot;</code> does indeed not look like a legal UTF-8 multi-octet sequence, so the error from the decoder is correct."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1573289675, "post_id": 58777439, "comment_id": 103840446, "body": "The UTF-8 encoding of the Unicode character <a href=\"https://unicode.org/cldr/utility/character.jsp?a=03B1\" rel=\"nofollow noreferrer\"><code>\u03b1</code> U+03B1 <i>Greek small letter alpha</i></a> is <a href=\"https://mothereff.in/utf-8#%CE%B1\" rel=\"nofollow noreferrer\"><code>\\xCE\\xB1</code></a>."}, {"owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1573295279, "post_id": 58777439, "comment_id": 103841440, "body": "Agreed, on further investigation, it appears to be something funny with the way that literal bytestrings involving UTF-8 are handled; they seem to be ASCII rather than UTF-8.  Or something."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1573299576, "post_id": 58777439, "comment_id": 103842319, "body": "@user3416536 Instead of creating the <code>ByteString</code> directly, try creating a <code>Text</code> from the &quot;text&quot; package and then apply <code>Data.Text.Encoding.encodeUtf8</code> <a href=\"http://hackage.haskell.org/package/text-1.2.4.0/docs/Data-Text-Encoding.html#v:encodeUtf8\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/text-1.2.4.0/docs/&hellip;</a>"}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1573305437, "post_id": 58777439, "comment_id": 103843528, "body": "I suspect that <code>let t :: ByteString  = &quot;\u03b1&quot;</code> doesn&#39;t do what you want it to do. Take a look at the relevant <code>IsString</code> instance!"}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1573305573, "post_id": 58777439, "comment_id": 103843567, "body": "See <a href=\"https://github.com/haskell/bytestring/issues/140\" rel=\"nofollow noreferrer\">github.com/haskell/bytestring/issues/140</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "edited": false, "score": 0, "creation_date": 1573332942, "post_id": 58780612, "comment_id": 103850383, "body": "got it, and indeed, as @sjakobi said, the IsString instance isn&#39;t doing what I wanted here. Thanks!"}], "tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": true, "score": 0, "last_activity_date": 1573314677, "last_edit_date": 1573314677, "creation_date": 1573312692, "answer_id": 58780612, "question_id": 58777439, "link": "https://stackoverflow.com/questions/58777439/haskell-data-yaml-utf-8-decoding/58780612#58780612", "title": "Haskell Data.Yaml UTF-8 decoding", "body": "<p>It seems that in your example, the byte string is a truncated version of the initial ordinary string. The Greek lower case letter  \"\u03b1\" is Unicode character #945, and it appears as just code 177, while we have 945 == (3*256) + 177.</p>\n\n<pre><code> \u03bb&gt; \n \u03bb&gt; :m Data.Char\n \u03bb&gt; :m + Data.ByteString\n \u03bb&gt; :set -XScopedTypeVariables \n \u03bb&gt; :set -XOverloadedStrings \n \u03bb&gt; \n \u03bb&gt; Prelude.map ord \"A\u03b1\"\n [65,945]\n \u03bb&gt; \n \u03bb&gt; 177 + (3*256)\n 945\n \u03bb&gt; \n \u03bb&gt; let t1 :: ByteString  = \"\u03b1\"\n \u03bb&gt; \n \u03bb&gt; :t t1\n t1 :: ByteString\n \u03bb&gt; t1\n \"\\177\"\n \u03bb&gt; Data.ByteString.length t1\n 1\n \u03bb&gt; \n</code></pre>\n\n<p>The root cause might be that the UTF8 style of encoding has no special privileges. Hence the need to be quite explicit about the sort of conversion to byte string that you expect:</p>\n\n<pre><code> \u03bb&gt; import Data.ByteString.UTF8 as BSUTF8\n \u03bb&gt; \n \u03bb&gt; t2  = BSUTF8.fromString \"\u03b1\"\n \u03bb&gt; \n \u03bb&gt; :t t2\n t2 :: ByteString\n \u03bb&gt; \n \u03bb&gt; t2\n \"\\206\\177\"\n \u03bb&gt; \n \u03bb&gt; Data.ByteString.length t2\n 2\n \u03bb&gt; \n \u03bb&gt; Prelude.putStrLn $ BSUTF8.toString t2\n \u03b1\n \u03bb&gt; \n \u03bb&gt; :set -XTypeApplications\n \u03bb&gt; \n \u03bb&gt; :m +Data.Yaml\n \u03bb&gt; \n \u03bb&gt; Data.Yaml.decodeEither' @String  t2\n Right \"\\945\"\n \u03bb&gt; \n</code></pre>\n"}], "owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 58780612, "answer_count": 1, "score": 2, "last_activity_date": 1573314677, "creation_date": 1573286248, "question_id": 58777439, "link": "https://stackoverflow.com/questions/58777439/haskell-data-yaml-utf-8-decoding", "title": "Haskell Data.Yaml UTF-8 decoding", "body": "<p>I'm trying to decode a yaml file that contains UTF-8 strings, using Data.Yaml .  It chokes on the UTF-8.  I have narrowed down the example to this:</p>\n\n<pre><code>\u03bb&gt; :m + Data.ByteString\n\u03bb&gt; :m + Data.Yaml\n\u03bb&gt; :set -XOverloadedStrings \n\u03bb&gt; :set -XScopedTypeVariables \n\u03bb&gt; :set -XTypeApplications \n\u03bb&gt; let t :: ByteString  = \"\u03b1\"\n\u03bb&gt; t\n\"\\177\"\n\u03bb&gt; decodeEither' @Value t\nLeft (InvalidYaml (Just (YamlParseException {yamlProblem = \"invalid leading UTF-8 octet\", yamlContext = \"\", yamlProblemMark = YamlMark {yamlIndex = 0, yamlLine = 0, yamlColumn = 0}})))\n</code></pre>\n\n<p>I have tried different ByteStrings (Char8,UTF8 from the <code>utf8-string</code> package), but with the same result.</p>\n\n<p>My locale is set to UTF8:</p>\n\n<pre><code>$ env | grep LANG\nLANG=en_GB.UTF-8\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1573278527, "post_id": 58776762, "comment_id": 103838799, "body": "What do you expect instead?"}, {"owner": {"reputation": 1868, "user_id": 2696086, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8198375dbb66be88899da8d62228944?s=128&d=identicon&r=PG&f=1", "display_name": "Flame of udun", "link": "https://stackoverflow.com/users/2696086/flame-of-udun"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1573278581, "post_id": 58776762, "comment_id": 103838802, "body": "if 8.0 is min, then max should return 8. Or vice versa"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 3, "creation_date": 1573307642, "post_id": 58776762, "comment_id": 103844054, "body": "Do you not think that 8 and 8.0 are equal?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1573340097, "post_id": 58776762, "comment_id": 103851848, "body": "<code>ghci&gt; :t 8</code> <code>8 :: Num a =&gt; a</code>  -- <code>ghci&gt; :t 8.0</code> <code>8.0 :: Fractional a =&gt; a</code>  -- <code>ghci&gt; :t min</code> <code>min :: Ord a =&gt; a -&gt; a -&gt; a</code>  -- <code>ghci&gt; :t max</code> <code>max :: Ord a =&gt; a -&gt; a -&gt; a</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1573340655, "post_id": 58776762, "comment_id": 103851941, "body": "if both <code>min a b == a</code> and <code>max a b == a</code>, it can be explained by <code>a == b</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1573278738, "post_id": 58776785, "comment_id": 103838819, "body": "@dyukha What sounds wrong about it? What fixed version do you propose?"}, {"owner": {"reputation": 1868, "user_id": 2696086, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8198375dbb66be88899da8d62228944?s=128&d=identicon&r=PG&f=1", "display_name": "Flame of udun", "link": "https://stackoverflow.com/users/2696086/flame-of-udun"}, "edited": false, "score": 0, "creation_date": 1573278816, "post_id": 58776785, "comment_id": 103838828, "body": "Shouldn&#39;t 8 represent Int? There&#39;s Int, Float and Double types in Haskell by default so 8 shouldn&#39;t represent Double"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "edited": false, "score": 0, "creation_date": 1573278824, "post_id": 58776785, "comment_id": 103838829, "body": "Well, I&#39;m not into Haskell, but I expect that here 8 is not a Double, and here some conversion happens. Please correct me if I&#39;m wrong."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 9, "creation_date": 1573278970, "post_id": 58776785, "comment_id": 103838850, "body": "@dyukha You are wrong. There is no implicit conversion in Haskell, ever."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1868, "user_id": 2696086, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8198375dbb66be88899da8d62228944?s=128&d=identicon&r=PG&f=1", "display_name": "Flame of udun", "link": "https://stackoverflow.com/users/2696086/flame-of-udun"}, "edited": false, "score": 8, "creation_date": 1573279045, "post_id": 58776785, "comment_id": 103838863, "body": "@Flameofudun <code>8</code> is a perfectly fine <code>Double</code>, as you can see by my ghci session. It&#39;s also a perfectly fine <code>Int</code>, as you say. But <code>8.0</code> is not a perfectly fine <code>Int</code>, and so <code>min 8 8.0</code> defaults to <code>Double</code> and not <code>Int</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2956272"}, "edited": false, "score": 3, "creation_date": 1573279145, "post_id": 58776785, "comment_id": 103838877, "body": "I see, thanks, I should read this: <a href=\"https://www.haskell.org/tutorial/numbers.html\" rel=\"nofollow noreferrer\">haskell.org/tutorial/numbers.html</a> (&quot;Overloaded Literals&quot; section especially)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1573340176, "post_id": 58776785, "comment_id": 103851862, "body": "without the explanation of what is <code>8</code> (and <code>8.0</code> for that matter) and why are they both treated as <code>Double</code> here, this answer is incomplete."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 14, "last_activity_date": 1573278662, "creation_date": 1573278662, "answer_id": 58776785, "question_id": 58776762, "link": "https://stackoverflow.com/questions/58776762/in-haskell-why-is-min-8-0-8-8-0-and-max-8-0-8-8-0/58776785#58776785", "title": "In haskell why is min 8.0 8 = 8.0 and max 8.0 8 = 8.0", "body": "<p>Both <code>8</code> and <code>8.0</code> represent the same <code>Double</code>, and that <code>Double</code> prints as <code>8.0</code>. This has nothing to do with <code>min</code>, per se.</p>\n\n<pre><code>&gt; 8 :: Double\n8.0\n</code></pre>\n"}], "owner": {"reputation": 1868, "user_id": 2696086, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8198375dbb66be88899da8d62228944?s=128&d=identicon&r=PG&f=1", "display_name": "Flame of udun", "link": "https://stackoverflow.com/users/2696086/flame-of-udun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 58776785, "answer_count": 1, "score": 2, "last_activity_date": 1573278676, "creation_date": 1573278362, "last_edit_date": 1573278676, "question_id": 58776762, "link": "https://stackoverflow.com/questions/58776762/in-haskell-why-is-min-8-0-8-8-0-and-max-8-0-8-8-0", "title": "In haskell why is min 8.0 8 = 8.0 and max 8.0 8 = 8.0", "body": "<p>I'm learning haskell and I came across a weird behavior. I tried </p>\n\n<pre><code>Prelude&gt; min 8.0 8\n8.0\n</code></pre>\n\n<p>and </p>\n\n<pre><code>Prelude&gt; max 8 8.0\n8.0\n</code></pre>\n\n<p>I switch the argument positions for both functions but I got the same result. If 8.0 is returned as min shouldn't 8 be returned as max (or vice versa)? I'm using <code>ghci</code> version 8.0.2. Why does this happen?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 2, "creation_date": 1573273030, "post_id": 58776342, "comment_id": 103838190, "body": "What exactly are <code>Peca</code>, <code>Dirt</code>, and <code>Ramp</code>? Could you give us their definitions?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1573273160, "post_id": 58776342, "comment_id": 103838197, "body": "Actually, never mind. I think I can answer this without knowing their definitions."}, {"owner": {"reputation": 200, "user_id": 12174294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff5a9f269ee5f6948c98584fc17a9556?s=128&d=identicon&r=PG&f=1", "display_name": "Ramux05", "link": "https://stackoverflow.com/users/12174294/ramux05"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1573273755, "post_id": 58776342, "comment_id": 103838279, "body": "if you eventually do need the definitions I can post them here aswell, but it&#39;s all in Portuguese, don&#39;t know if it would make a diference or not. I can try to translate it but I&#39;m not sure it would be correct"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1573273828, "post_id": 58776342, "comment_id": 103838287, "body": "No, I don\u2019t need them \u2014 I actually just posted an answer."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 1, "creation_date": 1573293530, "post_id": 58776342, "comment_id": 103841111, "body": "BTW, well done on this question. You have been up-front about this being an assignment, explained your problem, showed what you have tried and asked a clear question with an answer that will be of use to other learners. Too often here we get &quot;questions&quot; that are merely cut-and-paste copies of a homework assignment, so this is a refreshing change."}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1573393227, "post_id": 58776342, "comment_id": 103860284, "body": "FWIW the Haskell language library offers some ready-made recursion schemes. In your case, it would be the <a href=\"https://hoogle.haskell.org/?hoogle=scanl\" rel=\"nofollow noreferrer\">scanl</a> function. Its type signature is: <code>scanl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; [b]</code>. So the first argument would be your <code>gamaTipo</code> function, with type <i>a</i> being (Int,Int) and type <i>b</i> being Peca. You might want to compare your solution with the <code>scanl</code> source code in the library once you&#39;re done."}], "answers": [{"comments": [{"owner": {"reputation": 200, "user_id": 12174294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff5a9f269ee5f6948c98584fc17a9556?s=128&d=identicon&r=PG&f=1", "display_name": "Ramux05", "link": "https://stackoverflow.com/users/12174294/ramux05"}, "edited": false, "score": 0, "creation_date": 1573274030, "post_id": 58776423, "comment_id": 103838314, "body": "So in this case all that the <code>go</code> helper function is doing is storing the previous element that I&#39;m then going to use in <code>gamaTipo</code>?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 200, "user_id": 12174294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff5a9f269ee5f6948c98584fc17a9556?s=128&d=identicon&r=PG&f=1", "display_name": "Ramux05", "link": "https://stackoverflow.com/users/12174294/ramux05"}, "edited": false, "score": 0, "creation_date": 1573290524, "post_id": 58776423, "comment_id": 103840605, "body": "@Ramux05 That\u2019s exactly right. It\u2019s actually quite simple when you express it like that, but I\u2019ve found this pattern incredibly useful in my own code."}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": true, "score": 1, "last_activity_date": 1573273653, "creation_date": 1573273653, "answer_id": 58776423, "question_id": 58776342, "link": "https://stackoverflow.com/questions/58776342/need-help-storing-the-previous-element-of-a-list-haskell/58776423#58776423", "title": "Need help storing the previous element of a list (Haskell)", "body": "<p>If I understand correctly, your program needs to have a basic structure something like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>updateTuple :: [(Int, Int)] -&gt; [Peca]\nupdateTuple = go initialValue\n  where\n    go prev (xy:xys) =\n        let next = getNextValue prev xy\n        in prev : (go next xys)\n    go prev [] = prev\n</code></pre>\n\n<p>Basically, what\u2019s happening here is:</p>\n\n<ul>\n<li><code>updateTuple</code> is defined in terms of a helper function <code>go</code>. (Note that \u2018helper function\u2019 isn\u2019t standard terminology, it\u2019s just what I\u2019ve decided to call it).</li>\n<li><code>go</code> has an extra argument, which is used to store the previous value.</li>\n<li>The implementation of <code>go</code> can then make use of the previous value.</li>\n<li>When <code>go</code> recurses, the recursive call can then pass the newly-calculated value as the new \u2018previous value\u2019.</li>\n</ul>\n\n<p>This is a reasonably common pattern in Haskell: if a recursive function requires an extra argument, then a new function (often named <code>go</code>) can be defined which has that extra argument. Then the original function can be defined in terms of <code>go</code>.</p>\n"}], "owner": {"reputation": 200, "user_id": 12174294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff5a9f269ee5f6948c98584fc17a9556?s=128&d=identicon&r=PG&f=1", "display_name": "Ramux05", "link": "https://stackoverflow.com/users/12174294/ramux05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 58776423, "answer_count": 1, "score": 2, "last_activity_date": 1573273653, "creation_date": 1573272756, "question_id": 58776342, "link": "https://stackoverflow.com/questions/58776342/need-help-storing-the-previous-element-of-a-list-haskell", "title": "Need help storing the previous element of a list (Haskell)", "body": "<p>I'm currently working on an assignment. I have a function called <code>gamaTipo</code> that converts the values of a tuple into a data type previously defined by my professor. \nThe problem is: in order for <code>gamaTipo</code> to work, it needs to receive some preceding element. gamaTipo is defined like this: <code>gamaTipo :: Peca -&gt; (Int,Int) -&gt; Peca</code> where <code>Peca</code> is the data type defined by my professor. </p>\n\n<p>What I need to do is to create a funcion that takes a list of tuples and converts it into <code>Peca</code> data type. The part that im strugling with is taking the preceding element of the list. i.e : let's say we have a list <code>[(1,2),(3,4)]</code> where the first element of the list <code>(1,2)</code> always corresponds to <code>Dirt Ramp</code> (data type defined by professor). I have to create a function <code>convert :: [(Int,Int)] -&gt; [Peca]</code> where in order to calculate the element <code>(3,4)</code> i need to first translate <code>(1,2)</code> into <code>Peca</code>, and use it as the previous element to translate <code>(3,4)</code></p>\n\n<p>Here's what I've tried so far: </p>\n\n<pre><code>    updateTuple :: [(Int,Int)] -&gt; [Peca]\n    updateTuple [] = []\n    updateTuple ((x,y):xs) = let previous = Dirt Ramp\n                                in (gamaTipo previous (x,y)): updateTuple xs\n</code></pre>\n\n<p>Although I get no error messages with this code, the expected output isn't correct. I'm also sorry if it's not easy to understand what I'm asking, English isn't my native tongue and it's hard to express my self. Thank you in advance! :)</p>\n"}, {"tags": ["haskell", "compiler-errors", "binary-search-tree"], "answers": [{"comments": [{"owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "edited": false, "score": 0, "creation_date": 1573282281, "post_id": 58776972, "comment_id": 103839311, "body": "Mama mia! I <i>hate</i> <code>unsafeCoerce</code>, as a normal Haskellian would do. Yet there doesn&#39;t seem a workaround in this case."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 3, "last_activity_date": 1573340081, "last_edit_date": 1573340081, "creation_date": 1573280988, "answer_id": 58776972, "question_id": 58775529, "link": "https://stackoverflow.com/questions/58775529/problem-with-perfectly-balanced-tree-with-fixed-size/58776972#58776972", "title": "Problem with perfectly balanced tree with fixed size", "body": "<p>GHC does not know algebra. <em>Any</em> algebra. Things like <code>n + 1 /= 0</code> and <code>n + 1 = m + 1 -&gt; n = m</code> are beyond it. The best it can do is evaluation, such as <code>1 + 1 = 2</code>. You have to explicitly write them down as axioms, implement them with <code>unsafeCoerce</code>, and tell GHC to use them. (Or, you can use a compiler plugin to hook GHC to a solver that <em>can</em> do algebra and translate those results into axioms.)</p>\n\n<p>Also, even if GHC could do algebra, in the <code>Odd l x r</code> and <code>Even l x y r</code> cases, <code>l, r :: MultiSet m a</code> where it is <em>not known</em> that <code>m = m' + 1</code>. That is, even though you have already matched <code>l</code> and <code>r</code> against <code>Leaf</code>, and therefore \"proved\" that <code>l</code> and <code>r</code> contain more than one element, this is not proven to GHC. Roughly, the reasoning behind \"<code>l</code> and <code>r</code> are non-empty\" is not \"direct\" enough. Failed matches do not give you more type information about the scrutinee. I would write a helper function:</p>\n\n<pre><code>{-# LANGUAGE AllowAmbiguousTypes, ExplicitForAll, ScopedTypeVariables, TypeApplications #-}\nimport Data.Proxy\nimport Data.Type.Equality\nimport Data.Void\nimport Unsafe.Coerce\n\ndata NatCheck (n :: Nat) where\n  IsZero :: NatCheck 0\n  IsSucc :: Proxy n -&gt; NatCheck (n + 1)\n  -- Proxy lets us bind the predecessor to a name\ncheckMultiSet :: forall n a. MultiSet n a -&gt; NatCheck n\ncheckMultiSet Leaf = IsZero\ncheckMultiSet (Odd _ _ _) = IsSucc Proxy\n-- get m :: Nat out of Even, learn n = (m + m) + (1 + 1) from it\n-- reassociate: n = ((m + m) + 1) + 1\ncheckMultiSet (Even (_ :: MultiSet m a) _ _ _) | Refl &lt;- addAssoc @(m + m) @1 @1 = IsSucc Proxy\n\n-- axiom\naddAssoc :: forall n m l. ((n + m) + l) :~: (n + (m + l))\naddAssoc = unsafeCoerce Refl\n</code></pre>\n\n<p>And use that instead of explicitly using the constructors of <code>MultiSet</code></p>\n\n<pre><code>{-# LANGUAGE EmptyCase #-}\nminView :: forall n a. MultiSet (n + 1) a -&gt; (a, MultiSet n a)\nminView Leaf = case natDiscrim @n Refl of { } -- Leaf is not ruled out automatically, have to prove unreachability with axiom n + 1 /= 0\nminView (Odd l x r) = -- get m :: Nat, learn n + 1 = m + m + 1, get l, r of size m\n  case checkMultiSet l of -- i.e. check m =? 0\n    -- learn m = 0, so n + 1 = 0 + 1\n    -- injectivity: n = 0\n    IsZero | Refl &lt;- succInj @n @0 -&gt; (x, Leaf) \n    -- get m' :: Nat, learn m = m' + 1\n    -- get l', r' of size m'\n    -- we know n + 1 = (m' + 1) + (m' + 1) + 1\n    -- the Even has size ((m' + m') + 2) when it should be n\n    -- algebra, except more painfully than ever before\n    -- injectivity gets: n = (m' + 1) + (m' + 1)\n    -- reassociate: n = ((m' + 1) + m') + 1\n    -- commute: n = (m' + (m' + 1)) + 1\n    -- reassociate: n = ((m' + m') + 1) + 1\n    -- reassociate: n = (m' + m') + (1 + 1)\n    IsSucc (Proxy :: Proxy m')\n      | (u, l') &lt;- minView l, (v, r') &lt;- minView r\n      , Refl &lt;- succInj @n @((m' + 1) + (m' + 1))\n      , Refl &lt;- addAssoc @(m' + 1) @m' @1\n      , Refl &lt;- addComm @(m' + 1) @m'\n      , Refl &lt;- addAssoc @m' @m' @1\n      , Refl &lt;- addAssoc @(m' + m') @1 @1\n      -&gt; (u, Even l' x v r')\nminView (Even (l :: MultiSet m a) x y r) = -- get m :: Nat, learn n + 1 = m + m + 2, get l, r of size m\n  case checkMultiSet l of -- i.e. check m =? 0\n    -- learn m = 0, so n + 1 = 1 + 1\n    -- injectivity: n = 1\n    IsZero | Refl &lt;- succInj @n @1 -&gt; (x, Odd Leaf y Leaf)\n    -- get m' :: Nat, learn m = m' + 1, get l' of size m'\n    -- we know n + 1 = (m + m) + (1 + 1)\n    -- the Odd has size ((m + m) + 1) when it should be n\n    -- algebra, less painful\n    -- reassociate: n + 1 = ((m + m) + 1) + 1\n    -- injectivity: n = (m + m) + 1\n    IsSucc _\n      | (u, l') &lt;- minView l\n      , Refl &lt;- addAssoc @(m + m) @1 @1\n      , Refl &lt;- succInj @n @(m + m + 1)\n      -&gt; (u, Odd (insert x l') y r)\n\n-- more axioms\nnatDiscrim :: forall n. (n + 1) :~: 0 -&gt; Void\nnatDiscrim Refl = error \"natDiscrim: impossible\"\nsuccInj :: forall n m. (n + 1) ~ (m + 1) =&gt; n :~: m\nsuccInj = unsafeCoerce Refl\naddComm :: forall n m. (n + m) :~: (m + n)\naddComm = unsafeCoerce Refl\n</code></pre>\n\n<p>Of course, instead of explaining the algebra to GHC, you could just brute force it by e.g. replacing the block of guards in the <code>Odd</code>, <code>IsSucc</code> case with <code>Refl &lt;- unsafeCoerce Refl :: n ~ (m' + m' + 2)</code>, and similarly for the others. I wouldn't do that though, since it's not obvious that that is correct. In contrast, the axioms are obviously correct. By doing your algebra in terms of them, you prove your reasoning correct, too.</p>\n"}], "owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 58776972, "answer_count": 1, "score": 3, "last_activity_date": 1573340081, "creation_date": 1573261931, "last_edit_date": 1573340012, "question_id": 58775529, "link": "https://stackoverflow.com/questions/58775529/problem-with-perfectly-balanced-tree-with-fixed-size", "title": "Problem with perfectly balanced tree with fixed size", "body": "<p>I tried to implement a perfectly balanced binary search tree, where the size is given as a type parameter (like C++'s <code>std::array</code> does).</p>\n\n<p>This is the implementation of the tree:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n\nimport GHC.TypeNats\nimport Data.Foldable hiding (length)\nimport Data.Monoid\nimport Data.Proxy\n\n\ndata MultiSet (n :: Nat) a where\n    Leaf :: MultiSet 0 a\n    Odd :: MultiSet n a -&gt; a -&gt; MultiSet n a -&gt; MultiSet (n+n+1) a\n    Even :: MultiSet n a -&gt; a -&gt; a -&gt; MultiSet n a -&gt; MultiSet (n+n+2) a\n</code></pre>\n\n<p>And this is the implementation of <code>minView</code>, as similar as <code>Data.Set</code> from <code>containers</code> package:</p>\n\n<pre><code>minView :: MultiSet (n+1) a -&gt; (a, MultiSet n a) \nminView (Odd Leaf x Leaf) = (x, Leaf)\nminView (Even Leaf x y Leaf) = (x, Odd Leaf y Leaf)\nminView (Odd l x r) = let\n    (u, l') = minView l\n    (v, r') = minView r\n    in (u, Even l' x v r')\nminView (Even l x y r) = let\n    (u, l') = minView l\n    in (u, Odd (insert x l') y r)\n</code></pre>\n\n<p>But many errors occur when I try to interpret it:</p>\n\n<pre><code>PerfectBalance.hs:71:33: error:\n    \u2022 Could not deduce: n ~ 0\n    from the context: (n + 1) ~ ((n5 + n5) + 1)\n        bound by a pattern with constructor:\n                Odd :: forall (n :: Nat) a.\n                        MultiSet n a -&gt; a -&gt; MultiSet n a -&gt; MultiSet ((n + n) + 1) a,\n                in an equation for \u2018minView\u2019\n        at PerfectBalance.hs:71:10-24\n    or from: n5 ~ 0\n        bound by a pattern with constructor:\n                Leaf :: forall a. MultiSet 0 a,\n                in an equation for \u2018minView\u2019\n        at PerfectBalance.hs:71:14-17\n    \u2018n\u2019 is a rigid type variable bound by\n        the type signature for:\n        minView :: forall (n :: Nat) a.\n                    MultiSet (n + 1) a -&gt; (a, MultiSet n a)\n        at PerfectBalance.hs:70:1-48\n    Expected type: MultiSet n a\n        Actual type: MultiSet 0 a\n    \u2022 In the expression: Leaf\n    In the expression: (x, Leaf)\n    In an equation for \u2018minView\u2019: minView (Odd Leaf x Leaf) = (x, Leaf)\n    \u2022 Relevant bindings include\n        minView :: MultiSet (n + 1) a -&gt; (a, MultiSet n a)\n        (bound at PerfectBalance.hs:71:1)\n|\n71 | minView (Odd Leaf x Leaf) = (x, Leaf)\n|                                 ^^^^\n\nPerfectBalance.hs:72:36: error:\n    \u2022 Could not deduce: n ~ 1\n    from the context: (n + 1) ~ ((n5 + n5) + 2)\n        bound by a pattern with constructor:\n                Even :: forall (n :: Nat) a.\n                        MultiSet n a -&gt; a -&gt; a -&gt; MultiSet n a -&gt; MultiSet ((n + n) + 2) a,\n                in an equation for \u2018minView\u2019\n        at PerfectBalance.hs:72:10-27\n    or from: n5 ~ 0\n        bound by a pattern with constructor:\n                Leaf :: forall a. MultiSet 0 a,\n                in an equation for \u2018minView\u2019\n        at PerfectBalance.hs:72:15-18\n    \u2018n\u2019 is a rigid type variable bound by\n        the type signature for:\n        minView :: forall (n :: Nat) a.\n                    MultiSet (n + 1) a -&gt; (a, MultiSet n a)\n        at PerfectBalance.hs:70:1-48\n    Expected type: MultiSet n a\n        Actual type: MultiSet ((0 + 0) + 1) a\n    \u2022 In the expression: Odd Leaf y Leaf\n    In the expression: (x, Odd Leaf y Leaf)\n    In an equation for \u2018minView\u2019:\n        minView (Even Leaf x y Leaf) = (x, Odd Leaf y Leaf)\n    \u2022 Relevant bindings include\n        minView :: MultiSet (n + 1) a -&gt; (a, MultiSet n a)\n        (bound at PerfectBalance.hs:71:1)\n|\n72 | minView (Even Leaf x y Leaf) = (x, Odd Leaf y Leaf)\n|                                    ^^^^^^^^^^^^^^^\n\nPerfectBalance.hs:75:23: error:\n    \u2022 Could not deduce: (n2 + 1) ~ n5\n    from the context: (n + 1) ~ ((n5 + n5) + 1)\n        bound by a pattern with constructor:\n                Odd :: forall (n :: Nat) a.\n                        MultiSet n a -&gt; a -&gt; MultiSet n a -&gt; MultiSet ((n + n) + 1) a,\n                in an equation for \u2018minView\u2019\n        at PerfectBalance.hs:73:10-18\n    \u2018n5\u2019 is a rigid type variable bound by\n        a pattern with constructor:\n        Odd :: forall (n :: Nat) a.\n                MultiSet n a -&gt; a -&gt; MultiSet n a -&gt; MultiSet ((n + n) + 1) a,\n        in an equation for \u2018minView\u2019\n        at PerfectBalance.hs:73:10-18\n    Expected type: MultiSet (n2 + 1) a\n        Actual type: MultiSet n5 a\n    \u2022 In the first argument of \u2018minView\u2019, namely \u2018r\u2019\n    In the expression: minView r\n    In a pattern binding: (v, r') = minView r\n    \u2022 Relevant bindings include\n        r' :: MultiSet n2 a (bound at PerfectBalance.hs:75:9)\n        r :: MultiSet n5 a (bound at PerfectBalance.hs:73:18)\n        l :: MultiSet n5 a (bound at PerfectBalance.hs:73:14)\n|\n75 |     (v, r') = minView r\n|                       ^\n\nPerfectBalance.hs:76:12: error:\n    \u2022 Could not deduce: ((n2 + n2) + 2) ~ n\n    from the context: (n + 1) ~ ((n5 + n5) + 1)\n        bound by a pattern with constructor:\n                Odd :: forall (n :: Nat) a.\n                        MultiSet n a -&gt; a -&gt; MultiSet n a -&gt; MultiSet ((n + n) + 1) a,\n                in an equation for \u2018minView\u2019\n        at PerfectBalance.hs:73:10-18\n    \u2018n\u2019 is a rigid type variable bound by\n        the type signature for:\n        minView :: forall (n :: Nat) a.\n                    MultiSet (n + 1) a -&gt; (a, MultiSet n a)\n        at PerfectBalance.hs:70:1-48\n    Expected type: MultiSet n a\n        Actual type: MultiSet ((n2 + n2) + 2) a\n    \u2022 In the expression: Even l' x v r'\n    In the expression: (u, Even l' x v r')\n    In the expression:\n        let\n        (u, l') = minView l\n        (v, r') = minView r\n        in (u, Even l' x v r')\n    \u2022 Relevant bindings include\n        l' :: MultiSet n2 a (bound at PerfectBalance.hs:74:9)\n        r' :: MultiSet n2 a (bound at PerfectBalance.hs:75:9)\n        minView :: MultiSet (n + 1) a -&gt; (a, MultiSet n a)\n        (bound at PerfectBalance.hs:71:1)\n|\n76 |     in (u, Even l' x v r')\n|            ^^^^^^^^^^^^^^\n\nPerfectBalance.hs:78:23: error:\n    \u2022 Could not deduce: (n3 + 1) ~ n5\n    from the context: (n + 1) ~ ((n5 + n5) + 2)\n        bound by a pattern with constructor:\n                Even :: forall (n :: Nat) a.\n                        MultiSet n a -&gt; a -&gt; a -&gt; MultiSet n a -&gt; MultiSet ((n + n) + 2) a,\n                in an equation for \u2018minView\u2019\n        at PerfectBalance.hs:77:10-21\n    \u2018n5\u2019 is a rigid type variable bound by\n        a pattern with constructor:\n        Even :: forall (n :: Nat) a.\n                MultiSet n a -&gt; a -&gt; a -&gt; MultiSet n a -&gt; MultiSet ((n + n) + 2) a,\n        in an equation for \u2018minView\u2019\n        at PerfectBalance.hs:77:10-21\n    Expected type: MultiSet (n3 + 1) a\n        Actual type: MultiSet n5 a\n    \u2022 In the first argument of \u2018minView\u2019, namely \u2018l\u2019\n    In the expression: minView l\n    In a pattern binding: (u, l') = minView l\n    \u2022 Relevant bindings include\n        l' :: MultiSet n3 a (bound at PerfectBalance.hs:78:9)\n        r :: MultiSet n5 a (bound at PerfectBalance.hs:77:21)\n        l :: MultiSet n5 a (bound at PerfectBalance.hs:77:15)\n|\n78 |     (u, l') = minView l\n|                       ^\n\nPerfectBalance.hs:79:12: error:\n    \u2022 Could not deduce: ((n5 + n5) + 1) ~ n\n    from the context: (n + 1) ~ ((n5 + n5) + 2)\n        bound by a pattern with constructor:\n                Even :: forall (n :: Nat) a.\n                        MultiSet n a -&gt; a -&gt; a -&gt; MultiSet n a -&gt; MultiSet ((n + n) + 2) a,\n                in an equation for \u2018minView\u2019\n        at PerfectBalance.hs:77:10-21\n    \u2018n\u2019 is a rigid type variable bound by\n        the type signature for:\n        minView :: forall (n :: Nat) a.\n                    MultiSet (n + 1) a -&gt; (a, MultiSet n a)\n        at PerfectBalance.hs:70:1-48\n    Expected type: MultiSet n a\n        Actual type: MultiSet ((n5 + n5) + 1) a\n    \u2022 In the expression: Odd (insert x l') y r\n    In the expression: (u, Odd (insert x l') y r)\n    In the expression:\n        let (u, l') = minView l in (u, Odd (insert x l') y r)\n    \u2022 Relevant bindings include\n        r :: MultiSet n5 a (bound at PerfectBalance.hs:77:21)\n        l :: MultiSet n5 a (bound at PerfectBalance.hs:77:15)\n        minView :: MultiSet (n + 1) a -&gt; (a, MultiSet n a)\n        (bound at PerfectBalance.hs:71:1)\n|\n79 |     in (u, Odd (insert x l') y r)\n|            ^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p><code>maxView</code>, <code>insert</code>, and <code>delete</code> also have similar problems.</p>\n\n<p>How can I resolve them?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1573257923, "post_id": 58775160, "comment_id": 103836208, "body": "that&#39;s a very good start, you&#39;ve just got a little bit of tidying up to do. The error message is actually perfectly clear here - what do you think it means?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1573258007, "post_id": 58775160, "comment_id": 103836223, "body": "(PS I don&#39;t know if you&#39;re not allowed to use certain library functions, but <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:zipWith\" rel=\"nofollow noreferrer\">ZipWith</a>, from the Prelude, is the easiest way to implement this. Still, as you&#39;ve shown, it&#39;s not hard to write this function without it.)"}, {"owner": {"reputation": 77, "user_id": 8472226, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ffb2a081b2dc65a17ee0217315193c0f?s=128&d=identicon&r=PG", "display_name": "Yaroslav", "link": "https://stackoverflow.com/users/8472226/yaroslav"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573312851, "post_id": 58775160, "comment_id": 103845309, "body": "Thanks for your question, it helped to comprehend the task and see the error)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1573314063, "post_id": 58775160, "comment_id": 103845596, "body": "either <code>data MyData3 = Same Int | Different Int Int</code>, or <code>data MyData3 = Same | Difference Int</code> would make more sense, no?"}, {"owner": {"reputation": 77, "user_id": 8472226, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ffb2a081b2dc65a17ee0217315193c0f?s=128&d=identicon&r=PG", "display_name": "Yaroslav", "link": "https://stackoverflow.com/users/8472226/yaroslav"}, "edited": false, "score": 0, "creation_date": 1573406104, "post_id": 58775160, "comment_id": 103863746, "body": "Yes  Will Ness , you are right)"}], "answers": [{"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1573286862, "post_id": 58775647, "comment_id": 103839967, "body": "I&#39;m not sure why you&#39;re writing this function in a way that will crash when given two lists of different length, when it&#39;s so simple to make it cover all input correctly. (You don&#39;t actually need more than 2 patterns in total.)"}, {"owner": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1573293580, "post_id": 58775647, "comment_id": 103841125, "body": "@RobinZigmond I have said it. &quot;Assuming that the length of the list on the arguments will be always the same.&quot; Yes, we could have use <code>if</code> instead."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1573293723, "post_id": 58775647, "comment_id": 103841156, "body": "I know you stated, but it seems strange to make this assumption when the resulting code is no simpler. (And I wasn&#39;t talking about <code>if</code> vs guards at all, that&#39;s just stylistic preference here.)"}, {"owner": {"reputation": 77, "user_id": 8472226, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ffb2a081b2dc65a17ee0217315193c0f?s=128&d=identicon&r=PG", "display_name": "Yaroslav", "link": "https://stackoverflow.com/users/8472226/yaroslav"}, "edited": false, "score": 0, "creation_date": 1573312700, "post_id": 58775647, "comment_id": 103845273, "body": "Thank Wisn !! You helped me a lot, a beautiful solution."}], "tags": [], "owner": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "is_accepted": false, "score": 1, "last_activity_date": 1573263485, "creation_date": 1573263485, "answer_id": 58775647, "question_id": 58775160, "link": "https://stackoverflow.com/questions/58775160/haskell-two-lists-of-the-same-length-are-given-write-a-diff-function-that-bu/58775647#58775647", "title": "Haskell. Two lists of the same length are given. Write a &quot;diff&quot; function that builds the difference as follows", "body": "<p>Your approach is right.\nHowever, the function you wrote need to be fixed.</p>\n\n<p>Assuming that the length of the list on the arguments will be always the same.\nWe take two arguments so we write the function's type signature:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>diff :: [Int] -&gt; [Int] -&gt; [MyData3]\n</code></pre>\n\n<p>Then, we identify the base case which is when the list is empty.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>diff [] [] = []\n</code></pre>\n\n<p>Lastly, we write the complete function like below.\nI used guards here.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>diff (h1:t1) (h2:t2)\n  | h1 == h2  = Same : diff t1 t2\n  | otherwise = Different h1 h2 : diff t1 t2\n</code></pre>\n\n<p>Hence, the complete code is like this.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data MyData3 = Same | Different Int Int deriving (Show)\n\ndiff :: [Int] -&gt; [Int] -&gt; [MyData3]\ndiff [] [] = []\ndiff (h1:t1) (h2:t2)\n  | h1 == h2  = Same : diff t1 t2\n  | otherwise = Different h1 h2 : diff t1 t2\n</code></pre>\n\n<p>Now, we write the main function.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>main :: IO ()\nmain = do\n  print $ diff [1,2,3,0] [1,3,4,0]\n  print $ diff [0,0,0,0,0] [0,0,1,0,2]\n</code></pre>\n\n<p>Compile and run the code.\nWe will get:</p>\n\n<pre><code>[Same,Different 2 3,Different 3 4,Same]\n[Same,Same,Different 0 1,Same,Different 0 2]\n</code></pre>\n\n<p>Okay.\nThe code run just as expected.\nPlease learn more about list and how to write a function in Haskell.\nHave a nice day!</p>\n"}, {"comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1573294927, "post_id": 58778154, "comment_id": 103841367, "body": "My preferred solution, apart from <code>zipWith</code>, is to simply have a second pattern of <code>diff _ _ = []</code>, which (because of the content of the first pattern) must match any input where either list is empty."}, {"owner": {"reputation": 77, "user_id": 8472226, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ffb2a081b2dc65a17ee0217315193c0f?s=128&d=identicon&r=PG", "display_name": "Yaroslav", "link": "https://stackoverflow.com/users/8472226/yaroslav"}, "edited": false, "score": 0, "creation_date": 1573312568, "post_id": 58778154, "comment_id": 103845235, "body": "Thank Willem Van Onsem and Robin Zigmond !! Right !!! I would have been looking for this error for a long time) A beautiful solution with zipWith I will take note of it."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1573293243, "creation_date": 1573293243, "answer_id": 58778154, "question_id": 58775160, "link": "https://stackoverflow.com/questions/58775160/haskell-two-lists-of-the-same-length-are-given-write-a-diff-function-that-bu/58778154#58778154", "title": "Haskell. Two lists of the same length are given. Write a &quot;diff&quot; function that builds the difference as follows", "body": "<p>The reason of the error is because your second clause only has one parameter. Indeed:</p>\n\n<pre><code>diff :: Int -&gt; Int -&gt; [MyData3]\ndiff (h:t) (h1:t1) = &hellip;\ndiff <s><b>[]</b></s> = &hellip;</code></pre>\n\n<p>We thus can fix this, by adding an extra empty list:</p>\n\n<pre><code>diff :: Int -&gt; Int -&gt; [MyData3]\ndiff (h:t) (h1:t1) = &hellip;\ndiff [] <b>[]</b> = &hellip;</code></pre>\n\n<p>That being said, the function is still not very \"safe\". Indeed, imagine that someone will pass <code>diff [1] [2,3]</code>, then the function will raise an error, since the tw lists have a different length.</p>\n\n<p>We can solve this problem in multiple ways. We can for example stop the processing, from the moment, one of the list is exhausted, we can implement this for example with <code>zipWith</code>:</p>\n\n<pre><code>diff :: [Int] -&gt; [Int] -&gt; [MyData3]\ndiff = <b>zipWith</b> f\n    where f x y | x == y = Same\n                | otherwise = Different x y</code></pre>\n\n<p>Or we can return a <code>Maybe [MyData3]</code> that is <code>Nothing</code> if the length of the two lists differ, and <code>Just &hellip;</code> if these are the same.</p>\n"}], "owner": {"reputation": 77, "user_id": 8472226, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/ffb2a081b2dc65a17ee0217315193c0f?s=128&d=identicon&r=PG", "display_name": "Yaroslav", "link": "https://stackoverflow.com/users/8472226/yaroslav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1573293243, "creation_date": 1573257779, "last_edit_date": 1573258058, "question_id": 58775160, "link": "https://stackoverflow.com/questions/58775160/haskell-two-lists-of-the-same-length-are-given-write-a-diff-function-that-bu", "title": "Haskell. Two lists of the same length are given. Write a &quot;diff&quot; function that builds the difference as follows", "body": "<p>Two lists of the same length are given. Write a diff function that builds the difference as follows. </p>\n\n<p>Example:</p>\n\n<pre><code> diff [1,2,3,0] [1,3,4,0] -&gt; [Same, Different 2 3, Different 3 4, Same]\n diff [0,0,0,0,0] [0,0,1,0,2] -&gt; [Same, Same, Different 0 1, Same, Different 0 2]\n</code></pre>\n\n<p>It is also necessary to implement the data type required for the task.</p>\n\n<p>I tried to solve this problem as follows:    </p>\n\n<pre><code>data MyData3 = Same | Different Int Int deriving(Show)\n\ndiff (h:t)(h1:t1) = if (h == h1) then Same : diff t t1 else Different h h1 : diff t t1\ndiff [] = []\n</code></pre>\n\n<p>But the program is interrupted by an error: Equations for \u2018diff\u2019 have different numbers of arguments. Please help me solve this problem and fix the code.</p>\n"}, {"tags": ["list", "haskell", "tuples", "list-comprehension"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1573255748, "post_id": 58774869, "comment_id": 103835864, "body": "You could either merge the outputs with a double <code>zipWith</code> (rather messy, since you&#39;ll be comparing output characters), or you could search the history once for each space in the board.  That is, use some auxiliary function <code>getLocation :: [(Int, Int)] -&gt; (Int, Int) -&gt; Char</code> (where the second <code>(Int,Int)</code> is a <i>position</i>)."}, {"owner": {"reputation": 21, "user_id": 12345677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae5b1f3d795a57fff16e9891682f808?s=128&d=identicon&r=PG&f=1", "display_name": "Weliras", "link": "https://stackoverflow.com/users/12345677/weliras"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1573740227, "post_id": 58774869, "comment_id": 103988343, "body": "@luqui Thanks for your answer. But could you please tell me how could this modification with double zipWith look like? I am still new to haskell, so any examples of code could really help me."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1573843788, "post_id": 58774869, "comment_id": 104033302, "body": "on the final line: <code>zipWith (zipWith mergeChar) [ [ if a == fst x ... ] ] (ticktack (a,b) xs)</code>.  That is, instead of concatenating (<code>++</code>) the boards generated from the remainder of the moves, we &quot;zip-merge&quot; them.   Here <code>mergeChar :: Char -&gt; Char -&gt; Char</code> is a function you write that will, for example, take <code>&#39; &#39;</code> and <code>&#39;x&#39;</code> and give <code>&#39;x&#39;</code> -- how to combine each location."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12345677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae5b1f3d795a57fff16e9891682f808?s=128&d=identicon&r=PG&f=1", "display_name": "Weliras", "link": "https://stackoverflow.com/users/12345677/weliras"}, "edited": false, "score": 0, "creation_date": 1573410076, "post_id": 58781396, "comment_id": 103864887, "body": "Really thanks. Your solucion really helped me with understanding the more complex functions and things in Haskell. I am still learning Haskell, so i got little bit confused in this STUArray and UArray things, so could you please explain me something little about this datatypes and how they work? And i got confused also when i tried to understand <code>applyMoves</code> function. But i really appreciate your help man."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 21, "user_id": 12345677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae5b1f3d795a57fff16e9891682f808?s=128&d=identicon&r=PG&f=1", "display_name": "Weliras", "link": "https://stackoverflow.com/users/12345677/weliras"}, "edited": false, "score": 0, "creation_date": 1573419230, "post_id": 58781396, "comment_id": 103867341, "body": "@Weliras Did you look at the other question I linked? It may be more accessible. I also added an explanation of <code>STUArray</code> and <code>foldST</code>."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 21, "user_id": 12345677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae5b1f3d795a57fff16e9891682f808?s=128&d=identicon&r=PG&f=1", "display_name": "Weliras", "link": "https://stackoverflow.com/users/12345677/weliras"}, "edited": false, "score": 0, "creation_date": 1573420835, "post_id": 58781396, "comment_id": 103867749, "body": "@Weliras Another advice is to try it out in <code>ghci</code>, on a small example. Can you create an array of characters, then change one character? Can you change several characters at once?"}, {"owner": {"reputation": 21, "user_id": 12345677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae5b1f3d795a57fff16e9891682f808?s=128&d=identicon&r=PG&f=1", "display_name": "Weliras", "link": "https://stackoverflow.com/users/12345677/weliras"}, "edited": false, "score": 0, "creation_date": 1573480398, "post_id": 58781396, "comment_id": 103885296, "body": "Ohh now i see it. Well i&#39;ll look into it, this should really help me out. I will also try some smaller tasks with arrays. And i wanted to ask you, if you know about another solucion to this program without arrays in haskell?"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 21, "user_id": 12345677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae5b1f3d795a57fff16e9891682f808?s=128&d=identicon&r=PG&f=1", "display_name": "Weliras", "link": "https://stackoverflow.com/users/12345677/weliras"}, "edited": false, "score": 0, "creation_date": 1573481267, "post_id": 58781396, "comment_id": 103885769, "body": "@Weliras Well, you need to store your board somewhere. Whether it is an array, a map, or maybe even a composite function. Certainly there are many options. If you keep working, eventually you will master them all."}], "tags": [], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "is_accepted": true, "score": 2, "last_activity_date": 1573418565, "last_edit_date": 1573418565, "creation_date": 1573317909, "answer_id": 58781396, "question_id": 58774869, "link": "https://stackoverflow.com/questions/58774869/how-to-make-a-pattern-of-ticktack-game-in-haskell/58781396#58781396", "title": "How to make a pattern of ticktack game in Haskell?", "body": "<p>As @luqui says in a comment to the question:</p>\n\n<blockquote>\n  <p>You could either merge the outputs ... or you could search the history once for each space in\n  the board. ...</p>\n</blockquote>\n\n<p>The former solution is <a href=\"https://stackoverflow.com/a/58685116\">described in a nearby question</a>. The <em>\"chess\"</em> problem having been\nsolved there is only superficially distinct from your <em>\"noughts &amp; crosses\"</em> problem, so it should\nnot be too hard to adapt the solution. However:</p>\n\n<ul>\n<li><p>In that case, the board size is fixed and small, so we were not worried about the inefficiency\nof merging the boards pairwise.</p></li>\n<li><p>In this case, the board size is variable, so a solution by the latter method may be worth a try.</p></li>\n</ul>\n\n<p>To make the algorithm even more efficient, instead of scrolling across the board and searching for\nmatching moves at every cell, we will scroll across the moves and assign values to a board\nrepresented as a mutable array. Mutable arrays may be considered an <em>\"advanced technique\"</em> in\nfunctional programming, so it could also be a good exercise for an intermediate Haskeller. I only\nused them once or twice before, so let us see if I can figure this out!</p>\n\n<h2>How is this going to work?</h2>\n\n<p>At the heart of the program will be a rectangular array of bytes. An array goes in two flavours:\nmutable and <em>\"frozen\"</em>. While a frozen array cannot be changed, It is a rule that a mutable array\nmay only exist in a monadic context, so we can only freely pass around an array when it is frozen.\nIf this seems to be overcomplicated, I can only ask the reader to believe that the additional\nsafety guarantees are worth this complication.</p>\n\n<p>Anyway, here are the types:</p>\n\n<pre><code>type Position = (Int, Int)\n\ntype Field s = STUArray s Position Char\n\ntype FrozenField = UArray Position Char\n</code></pre>\n\n<p>We will create a function that <em>\"applies\"</em> a list of moves to an array, thawing and freezing it as\nneeded.</p>\n\n<pre><code>type Move = (Char, Position)\n\napplyMoves :: FrozenField -&gt; [Move] -&gt; FrozenField\n</code></pre>\n\n<p><em>(The idea of <code>Move</code> is that it is sufficient to put a mark on the board, without needing to know\nwhose turn it is.)</em></p>\n\n<p>Applied to an empty field of the appropriate size, this function will solve our problem \u2014 we shall\nonly need to adjust the format of the input and the output.</p>\n\n<pre><code>empty :: Position -&gt; FrozenField\n\npositionsToMoves :: [Position] -&gt; [Move]\n\narrayToLists :: FrozenField -&gt; [[Char]]\n</code></pre>\n\n<p>Our final program will then look like this:</p>\n\n<pre><code>tictac :: Position -&gt; [Position] -&gt; IO ()\ntictac corner = pp . arrayToLists . applyMoves (empty corner) . positionsToMoves\n</code></pre>\n\n<p>I hope it looks sensible? Even though we have not yet written any tangible code.</p>\n\n<h2>Can we write the code?</h2>\n\n<p>Yes.</p>\n\n<p>First, we will need some imports. No one likes imports, but, for some reason, it is not yet\nautomated. So, here:</p>\n\n<pre><code>import Data.Foldable (traverse_)\nimport Data.Array.Unboxed\nimport Data.Array.ST\nimport GHC.ST (ST)\n</code></pre>\n\n<p>The simplest thing one can do with arrays is to create an empty one. Let us give it a try:</p>\n\n<pre><code>empty :: Position -&gt; FrozenField\nempty corner = runSTUArray (newArray ((1, 1), corner) ' ')\n</code></pre>\n\n<p>The idea is that <code>newArray</code> claims a region in memory and fills it with spaces, and <code>runSTUArray</code>\nfreezes it so that it can be safely transported to another part of a program. We could instead\n<em>\"inline\"</em> the creation of the array and win some speed, but we only need to do it once, and I\nwanted to keep it composable \u2014 I think the program will be simpler this way.</p>\n\n<p>Another easy thing to do is to write the <em>\"glue\"</em> code that adjusts the input and output format:</p>\n\n<pre><code>positionsToMoves :: [Position] -&gt; [Move]\npositionsToMoves = zip (cycle ['x', 'o'])\n\narrayToLists :: FrozenField -&gt; [[Char]]\narrayToLists u =\n  let ((minHeight, minWidth), (maxHeight, maxWidth)) = bounds u\n  in [ [ u ! (row, column) | column &lt;- [minWidth.. maxWidth] ] | row &lt;- [minHeight.. maxHeight] ]\n</code></pre>\n\n<p>Nothing unusual here, run-of-the-mill list processing.</p>\n\n<p>Finally, the hard part \u2014 the code that applies any number of moves to a given frozen array:</p>\n\n<pre><code>applyMoves :: FrozenField -&gt; [Move] -&gt; FrozenField\napplyMoves start xs = runSTUArray (foldST applyMove (thaw start) xs)\n  where\n\n    foldST :: (a -&gt; b -&gt; ST s ()) -&gt; ST s a -&gt; [b] -&gt; ST s a\n    foldST f start' moves = do\n        u &lt;- start'\n        traverse_ (f u) moves\n        return u\n\n    applyMove :: Field s -&gt; Move -&gt; ST s ()\n    applyMove u (x, i) = writeArray u i x\n</code></pre>\n\n<p>The pattern is the same as in the function <code>empty</code>: modify an array, then freeze it \u2014 and all the\nmodifications have to happen in an <code>ST</code> monad, for safety. <code>foldST</code> contains all the\n<em>\"imperative\"</em> <em>\"inner loop\"</em> of our program.</p>\n\n<h2><em>(P.S.)</em> How does this actually work?</h2>\n\n<p>Let us unwrap the <code>UArray</code> and <code>STUArray</code> types first. What are they and what is the difference?</p>\n\n<p><code>UArray</code> means <em>\"unboxed array\"</em>, which is to say an array of values, as opposed to an array of\npointers. The value in our case is actually a Unicode character, not a C <em>\"byte\"</em> <code>char</code>, so it is not a byte, but a variable\nsize entity. When it is stored in unboxed form, it is converted to an <code>Int32</code> and back invisibly\nto us. An <code>Int32</code> is of course way too much for our humble purpose of storing 3 different values,\nso there is space for improvement here. To find out more about unboxed values, I invite you to\ncheck the article that introduced them back in 1991, <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/1991/01/unboxed-values.pdf\" rel=\"nofollow noreferrer\"><em>\"Unboxed Values as First Class Citizens in\na Non-Strict Functional Language\"</em></a>.</p>\n\n<p>That the values are unboxed does not mean that you can change them though. A pure value in Haskell\nis always immutable. So, were you to change a single value in an array, the whole array would be\ncopied \u2014 expensive! This is where <code>STUArray</code> comes in. <code>ST</code> stands for <code>State Thread</code>, and what\n<code>STUArray</code> is is an <em>\"unfrozen\"</em> array, where you can overwrite individual values without copying\nthe whole thing. To ensure safety, it can only live in a monad, in this case the <code>ST</code> monad.\n<em>(Notice how an <code>STUArray</code> value never appears outside of an <code>ST s</code> wrap.)</em> You can imagine an\n<code>ST</code> computation as a small imperative process with its own memory, separate from the outside\nworld. The story goes that they invented <code>ST</code> first, and then figured out they can get <code>IO</code> from\nit, so <code>IO</code> is actually <code>ST</code> in disguise. For more details on how <code>ST</code> works, check out the\noriginal article from 1994: <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/1994/06/lazy-functional-state-threads.pdf.\" rel=\"nofollow noreferrer\"><em>\"Lazy Functional State Threads\"</em></a>.</p>\n\n<p>Let us now take a more careful look at <code>foldST</code>. What we see is that <em>functionally</em>, it does not\nmake sense. First we bind the value of <code>start'</code> to <code>u</code>, and then we return <code>u</code> \u2014 the same\nvariable. From the functional point of view, this is the same as writing:</p>\n\n<pre><code>u &lt;- start'\nreturn u\n</code></pre>\n\n<p>\u2014 Which would be equivalent to <code>u</code> by monad laws. The trick is in what happens inbetween:</p>\n\n<pre><code>traverse_ (f u) moves\n</code></pre>\n\n<p>Let us check the type.</p>\n\n<pre><code>\u03bb :type traverse_\ntraverse_ :: (Foldable t, Applicative f) =&gt; (a -&gt; f b) -&gt; t a -&gt; f ()\n</code></pre>\n\n<p>So, some function is being called, with <code>u</code> as argument, but the result is the useless <code>()</code> type.\nIn a functional setting, this line would mean nothing. But in a monad, bound values may <em>appear</em>\nto change. <code>f</code> is a function that can change the state of a monad, and so can change the value of\nthe bound names when they are returned. The analogous code in C would go somewhat like this:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>char* foldST(void f(char*, Move), int n_start, char start[], int n_moves, Move moves[])\n{\n    // u &lt;- start\n    char* u = malloc(sizeof(char) * n_start);\n    memcpy(u, start, sizeof(char) * n_start);\n\n    // traverse_ (f u) moves\n    for (int i = 0; i &lt; n_moves; i++)\n    {\n        f(u, moves[i]);\n    }\n\n    // return u\n    return u;\n}\n</code></pre>\n\n<p>In Haskell, the pointer arithmetic is abstracted away, but essentially <code>traverse_</code> in <code>ST</code> works\nlike this. I am not really familiar with C nor with the inner workings of the <code>ST</code> abstraction, so\nthis is merely an analogy, not an attempt at a precise rendition. Nevertheless I hope it helps the reader to observe the similarity between <code>ST</code> and ordinary imperative C code.</p>\n\n<h2>Mission accomplished!</h2>\n\n<p>It runs reasonably fast. Takes only a moment to draw a million-step match on a million-sized\nboard. I hope it is also explained clearly enough. Do not hesitate to comment if something is amiss or unclear.</p>\n"}], "owner": {"reputation": 21, "user_id": 12345677, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bae5b1f3d795a57fff16e9891682f808?s=128&d=identicon&r=PG&f=1", "display_name": "Weliras", "link": "https://stackoverflow.com/users/12345677/weliras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 58781396, "answer_count": 1, "score": 1, "last_activity_date": 1573418565, "creation_date": 1573255075, "question_id": 58774869, "link": "https://stackoverflow.com/questions/58774869/how-to-make-a-pattern-of-ticktack-game-in-haskell", "title": "How to make a pattern of ticktack game in Haskell?", "body": "<p>Implement the function ticktack which has 2 arguments. First argument is a tuple of natural numbers and defines the number of rows and columns of a play field. Second list contains a record of a match of ticktacktoe game given by coordinates on which played in turns player 'x' and player 'o'. Print actual state of the game in the way where play-field will be bordered by characters '-' and '|', empty squares ' ' and characters 'x' and 'o' will be on squares where the players have played. <br></p>\n\n<pre><code>ticktack::(Int,Int) -&gt; [(Int,Int)] -&gt; Result\n</code></pre>\n\n<p><br>\nI already tried something like this: <br></p>\n\n<pre><code>type Result = [String]\npp :: Result -&gt; IO ()\npp x = putStr (concat (map (++\"\\n\") x))\n\nticktack::(Int,Int) -&gt; [(Int,Int)] -&gt; Result\nticktack (0,0) (x:xs) = []\nticktack (a,b) [] = []\nticktack (a,b) (x:xs) =[ [if a == fst x &amp;&amp; b == snd x then 'x' else ' ' | b &lt;- [1..b]]| a &lt;- [1..a]] ++ ticktack (a,b) xs \n</code></pre>\n\n<p><br>\nBut it returns me only N [Strings] with 1 result, so i need these results merge into one [String].</p>\n"}, {"tags": ["haskell", "applicative", "category-theory"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1573247502, "post_id": 58773747, "comment_id": 103833649, "body": "<code>liftA2</code> has as signature, applied to <code>Maybe</code>, <code>(a -&gt; b -&gt; c) -&gt; Maybe a -&gt; Maybe b -&gt; Maybe c</code>. Notice that the function works on <code>a</code>, and <code>b</code>, and not <code>Maybe a</code>, etc."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1573248746, "post_id": 58773747, "comment_id": 103834057, "body": "You seem to want a kind of &quot;monoidal transform&quot;, i.e. the same translation which maps <code>Semigroup m</code> into <code>Monoid (Maybe m)</code>. In this scenario, your <code>f</code> is the first  semigroup <code>&lt;&gt;</code>. (Well, at least if <code>f</code> is associative). I don&#39;t know of a name for this, not if it is in the libraries."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1573250445, "post_id": 58773747, "comment_id": 103834571, "body": "That type for <code>mystery</code> doesn&#39;t make sense given the implementation. Should the <code>b</code> and <code>c</code> type variables be <code>a</code>s instead?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573251857, "post_id": 58773747, "comment_id": 103834965, "body": "@chi I had the same thought too, but I found the type in the libraries, as mentioned in my answer."}], "answers": [{"comments": [{"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 3, "creation_date": 1573259536, "post_id": 58774485, "comment_id": 103836485, "body": "I&#39;d like to add that the <code>Option</code> newtype is now longer needed if you are targetting GHC 8.4 or higher since the <code>Monoid</code> instance for <code>Maybe</code> is exactly the same."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 4, "last_activity_date": 1573251812, "creation_date": 1573251812, "answer_id": 58774485, "question_id": 58773747, "link": "https://stackoverflow.com/questions/58773747/looking-for-a-haskell-function-related-to-lifta2-but-works-like-from-altern/58774485#58774485", "title": "Looking for a Haskell function related to liftA2, but works like &lt;|&gt; from Alternative", "body": "<p>If you are willing to accept a different type signature, working with a Semigroup instance instead of with an arbitrary function <code>f</code>, then what you are looking for is the Option newtype from Data.Semigroup:</p>\n\n<pre><code>Prelude Data.Semigroup&gt; Option Nothing &lt;&gt; Option Nothing\nOption {getOption = Nothing}\nPrelude Data.Semigroup&gt; Option (Just [1]) &lt;&gt; Option Nothing\nOption {getOption = Just [1]}\nPrelude Data.Semigroup&gt; Option Nothing &lt;&gt; Option (Just [2])\nOption {getOption = Just [2]}\nPrelude Data.Semigroup&gt; Option (Just [1]) &lt;&gt; Option (Just [2])\nOption {getOption = Just [1,2]}\n</code></pre>\n\n<p>For an arbitrary function you need something that is pretty specialized to Maybe - I don't really see how it could work for an arbitrary Applicative, or Alternative.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1573259580, "post_id": 58775293, "comment_id": 103836494, "body": "isn&#39;t it <code>alignWith (these id id f)</code> or something? --- (<code>these :: (a -&gt; c) -&gt; (b -&gt; c) -&gt; (a -&gt; b -&gt; c) -&gt; These a b -&gt; c</code>)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1573259668, "post_id": 58775293, "comment_id": 103836511, "body": "@WillNess, yes, and it turns out there&#39;s even a specialized function, <code>mergeThese</code>, for this exact application."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1573259604, "last_edit_date": 1573259604, "creation_date": 1573259035, "answer_id": 58775293, "question_id": 58773747, "link": "https://stackoverflow.com/questions/58773747/looking-for-a-haskell-function-related-to-lifta2-but-works-like-from-altern/58775293#58775293", "title": "Looking for a Haskell function related to liftA2, but works like &lt;|&gt; from Alternative", "body": "<p>If I understand you correctly, you may be interested in the <code>Semialign</code> class from <a href=\"https://hackage.haskell.org/package/semialign-1.1/docs/Data-Align.html\" rel=\"nofollow noreferrer\"><code>Data.Align</code></a>, which offers <code>zip</code>-like operations that don't drop missing elements:</p>\n\n<pre><code>class Functor f =&gt; Semialign f where\n  align :: f a -&gt; f b -&gt; f (These a b)\n  align = alignWith id\n\n  alignWith :: (These a b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\n  alignWith f as bs = f &lt;$&gt; align as bs\n</code></pre>\n\n<p>You can write</p>\n\n<pre><code>alignBasic :: Semialign f =&gt; (a -&gt; a -&gt; a) -&gt; f a -&gt; f a -&gt; f a\nalignBasic f = alignWith $ \\case\n  This a -&gt; a\n  That a -&gt; a\n  These a1 a2 -&gt; f a1 a2\n-- or just\nalignBasic f = alignWith (mergeThese f)\n</code></pre>\n\n<p>Since <code>Maybe</code> is an instance of <code>Semialign</code>, <code>alignBasic</code> can be used at type</p>\n\n<pre><code>alignBasic :: (a -&gt; a -&gt; a) -&gt; Maybe a -&gt; Maybe a -&gt; Maybe a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 0, "last_activity_date": 1585797266, "last_edit_date": 1585797266, "creation_date": 1585775872, "answer_id": 60980490, "question_id": 58773747, "link": "https://stackoverflow.com/questions/58773747/looking-for-a-haskell-function-related-to-lifta2-but-works-like-from-altern/60980490#60980490", "title": "Looking for a Haskell function related to liftA2, but works like &lt;|&gt; from Alternative", "body": "<p>Here goes an extra argument in support of <code>alignWith</code> being the <code>liftA2</code> analogue you are looking for, <a href=\"https://stackoverflow.com/a/58775293/2751851\">as dfeuer suggests</a>.</p>\n\n<p>Using <a href=\"http://blog.ezyang.com/2012/08/applicative-functors/\" rel=\"nofollow noreferrer\">the monoidal presentation of <code>Applicative</code></a>...</p>\n\n<pre><code>fzip :: Applicative f =&gt; f a -&gt; f b -&gt; f (a, b)\nfzip u v = (,) &lt;$&gt; u &lt;*&gt; v  -- Think of this as a default implementation.\n</code></pre>\n\n<p>... we can do a subtle tweak on <code>liftA2</code>:</p>\n\n<pre><code>liftA2' :: Applicative f =&gt; ((a, b) -&gt; c) -&gt; f a -&gt; f b -&gt; f c\nliftA2' f u v = f &lt;$&gt; fzip u v\n</code></pre>\n\n<p>This variation is relevant here because it translates straightforwardly to <code>Alternative</code>, under the <a href=\"http://h2.jaguarpaw.co.uk/posts/alternatives-convert-products-to-sums/\" rel=\"nofollow noreferrer\">products-to-sums monoidal functor interpretation</a>:</p>\n\n<pre><code>-- fzip analogue. Name borrowed from protolude.\neitherA :: Alternative f =&gt; f a -&gt; f b -&gt; f (Either a b)\neitherA u v = (Left &lt;$&gt; u) &lt;|&gt; (Right &lt;$&gt; v)\n\n-- Made-up name.\nplusWith :: Alternative f =&gt; (Either a b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\nplusWith f u v = f &lt;$&gt; eitherA u v\n</code></pre>\n\n<p><code>plusWith</code>, however, isn't helpful in your case. An <code>Either a b -&gt; c</code> can't produce a <code>c</code> by combining an <code>a</code> with a <code>b</code>, except by discarding one of them. You'd rather have something that takes a <code>These a b -&gt; c</code> argument, as using <a href=\"https://hackage.haskell.org/package/these-1.0.1/docs/Data-These.html#t:These\" rel=\"nofollow noreferrer\"><code>These a b</code></a> can express the both-<code>a</code>-and-<code>b</code> case. It happens that a <code>plusWith</code> that uses <code>These</code> instead of <code>Either</code> is very much like <a href=\"https://hackage.haskell.org/package/semialign-1.1/docs/Data-Align.html#v:alignWith\" rel=\"nofollow noreferrer\"><code>alignWith</code></a>:</p>\n\n<pre><code>-- Taken from the class definitions:\nclass Functor f =&gt; Semialign f where\n    align :: f a -&gt; f b -&gt; f (These a b)\n    align = alignWith id\n\n    alignWith :: (These a b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\n    alignWith f a b = f &lt;$&gt; align a b\n\nclass Semialign f =&gt; Align f where\n    nil :: f a\n</code></pre>\n\n<p><code>Alternative</code> is a class for monoidal functors from Hask-with-<code>(,)</code> to Hask-with-<code>Either</code>. Similarly, <code>Align</code> is a class for monoidal functors from Hask-with-<code>(,)</code> to Hask-with-<code>These</code>, only it also has <a href=\"https://hackage.haskell.org/package/semialign-1.1/docs/Data-Align.html#t:Semialign\" rel=\"nofollow noreferrer\">extra idempotency and commutativity laws</a> that ensure the unbiased behaviour you are looking for.</p>\n\n<hr>\n\n<p>One aspect of <code>Align</code> worth noting is that it is closer to <code>Alternative</code> than to <code>Applicative</code>. In particular, the identity of the <code>These</code> tensor product is <code>Void</code> rather than <code>()</code>, and accordingly <code>nil</code>, the identity of <code>align</code>, is an empty structure rather than a singleton. That might come as a surprise, given that <code>align</code> and friends offer us greedy zips and zips with padding, and that <code>zip</code> is often thought of as an applicative operation. In this context, I feel it might help to mention a fact about <a href=\"https://downloads.haskell.org/ghc/8.10.1/docs/html/libraries/base-4.14.0.0/Control-Applicative.html#t:ZipList\" rel=\"nofollow noreferrer\"><code>ZipList</code></a>. <code>ZipList</code> offers a zippy <code>Applicative</code> instance for lists in lieu of the default, cartesian product one:</p>\n\n<pre><code>GHCi&gt; fzip [1,2] [3,9,27]\n[(1,3),(1,9),(1,27),(2,3),(2,9),(2,27)]\nGHCi&gt; getZipList $ fzip (ZipList [1,2]) (ZipList [3,9,27])\n[(1,3),(2,9)]\n</code></pre>\n\n<p>What is less widely known is that <code>ZipList</code> also has a different <code>Alternative</code> instance:</p>\n\n<pre><code>GHCi&gt; [1,2] &lt;|&gt; [3,9,27]\n[1,2,3,9,27]\nGHCi&gt; [3,9,27] &lt;|&gt; [1,2]\n[3,9,27,1,2]\nGHCi&gt; getZipList $ ZipList [1,2] &lt;|&gt; ZipList [3,9,27]\n[1,2,27]\nGHCi&gt; getZipList $ ZipList [3,9,27] &lt;|&gt; ZipList [1,2]\n[3,9,27]\n</code></pre>\n\n<p>Instead of concatenating the lists, it pads the first list with a suffix of the second one to the larger of the two lengths. (It is a fitting instance for the type because it follows the <a href=\"https://wiki.haskell.org/Typeclassopedia#Laws_6\" rel=\"nofollow noreferrer\">left distribution law</a> .) <code>align</code> for lists is somewhat similar to <code>(&lt;|&gt;) @ZipList</code>, except that it isn't biased towards either list:</p>\n\n<pre><code>GHCi&gt; align [1,2] [3,9,27]\n[These 1 3,These 2 9,That 27]\nGHCi&gt; align [3,9,27] [1,2]\n[These 3 1,These 9 2,This 27]\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12345264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1f7dfa3199a985ed116c31d0139714c?s=128&d=identicon&r=PG&f=1", "display_name": "crepe_lord", "link": "https://stackoverflow.com/users/12345264/crepe-lord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1585797266, "creation_date": 1573246853, "last_edit_date": 1585785541, "question_id": 58773747, "link": "https://stackoverflow.com/questions/58773747/looking-for-a-haskell-function-related-to-lifta2-but-works-like-from-altern", "title": "Looking for a Haskell function related to liftA2, but works like &lt;|&gt; from Alternative", "body": "<p>Consider this <code>liftA2</code> function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>liftA2 :: (a -&gt; b -&gt; c) -&gt; Maybe a -&gt; Maybe b -&gt; Maybe c\nliftA2 f Nothing  Nothing  = Nothing\nliftA2 f (Just x) Nothing  = Nothing\nliftA2 f Nothing  (Just y) = Nothing\nliftA2 f (Just x) (Just y) = f x y\n</code></pre>\n\n<p>This is equivalent to the real <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#line-841\" rel=\"nofollow noreferrer\"><code>liftA2</code></a> function from <code>Control.Applicative</code>, but specialized for <code>Maybe</code>. (and also <code>liftM2</code> from <code>Control.Monad</code>)</p>\n\n<p>I'm looking for a cousin of that function, that works like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>mystery :: (a -&gt; a -&gt; a) -&gt; Maybe a -&gt; Maybe b -&gt; Maybe c\nmystery f Nothing  Nothing  = Nothing\nmystery f (Just x) Nothing  = Just x\nmystery f Nothing  (Just y) = Just y\nmystery f (Just x) (Just y) = Just (f x y)\n</code></pre>\n\n<p>The closest concept I'm aware of is <code>&lt;|&gt;</code>, but that <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/src/GHC.Base.html#line-897\" rel=\"nofollow noreferrer\">discards the second value</a> if there are two, whereas I would rather pass a function to combine them.</p>\n\n<p>What is this mystery function called? What type class does it operate on? What terms can I google to learn more? Thank you!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573242984, "post_id": 58772909, "comment_id": 103831941, "body": "I would recommend trying to write <code>addRefuel :: Int -&gt; Refuel -&gt; [Vehicle] -&gt; [Vehicle]</code> without using lenses first, if you haven&#39;t already."}, {"owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573243027, "post_id": 58772909, "comment_id": 103831952, "body": "I have that function already. I&#39;ll add it to the question."}, {"owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573243485, "post_id": 58772909, "comment_id": 103832134, "body": "But the question still stands on how to manipulate that single item, even without lenses and knowing the index of the element @chepner."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573243565, "post_id": 58772909, "comment_id": 103832155, "body": "You don&#39;t, really; you create a new list that contains a new <code>Vehicle</code> that has a new <code>Refuel</code> list containing the refuel. Remember, all the values are immutable."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573243642, "post_id": 58772909, "comment_id": 103832180, "body": "Underneath, the compiler will recognize which values can be reused, so this doesn&#39;t involve as much work behind the scenes as your code would imply."}], "answers": [{"comments": [{"owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "edited": false, "score": 0, "creation_date": 1573244757, "post_id": 58773276, "comment_id": 103832591, "body": "What if the <code>vehicleId</code> wouldn&#39;t be 1, but instead would somethingbe like 129?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "edited": false, "score": 0, "creation_date": 1573244791, "post_id": 58773276, "comment_id": 103832602, "body": "That&#39;s a typo; I meant to use the argument <code>i</code> (renamed <code>vid</code> in the updated answer)."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1573244807, "last_edit_date": 1573244807, "creation_date": 1573244410, "answer_id": 58773276, "question_id": 58772909, "link": "https://stackoverflow.com/questions/58772909/manipulating-single-item-in-list/58773276#58773276", "title": "Manipulating single item in list", "body": "<p>Without using lenses, you would write a function like</p>\n\n<pre><code>addRefuel :: ID  -- vehicle id\n          -&gt; Refuel  -- refueling data\n          -&gt; [Vehicle] -- list of vehicles, one of which you want to update\n          -&gt; [Vehicle] -- list of vehicles after the update\naddRefuel _ _ [] = []\naddRefuel vid r (v:vs) | _vehicleId v == vid = v { _refuel = r : _refuel v} : vs\n                       | otherwise = v : addRefuel vid r vs\n</code></pre>\n\n<p>You can call this on your <code>vehicles</code> list, but then you pass the return value to whatever code will use your updated list.</p>\n"}, {"comments": [{"owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "edited": false, "score": 0, "creation_date": 1573244652, "post_id": 58773278, "comment_id": 103832564, "body": "I like this answer. You made a small typo with <code>vehicleId</code> (leading underscore). Wouldn&#39;t <code>&lt;&gt;~ [refuel]</code> also work?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "edited": false, "score": 0, "creation_date": 1573244766, "post_id": 58773278, "comment_id": 103832596, "body": "No, it must actually be <code>_vehicleId</code> there. <code>&lt;&gt;~</code> is fine, sure."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 2, "creation_date": 1573245008, "post_id": 58773278, "comment_id": 103832687, "body": "<code>filteredBy (vehicleId.only 1)</code>, using the <code>only</code> prism, would also work."}, {"owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1573393904, "post_id": 58773278, "comment_id": 103860467, "body": "@danidiaz Which package exports <code>filteredBy</code>? I&#39;ve both tried importing <code>Control.Lens</code> and <code>Control.Lens.Combinators</code>, but none of which seem to export it."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "edited": false, "score": 2, "creation_date": 1573399243, "post_id": 58773278, "comment_id": 103861853, "body": "@DevNebulae <code>filteredBy</code> wasn&#39;t added to &quot;lens&quot; until version 4.18 <a href=\"http://hackage.haskell.org/package/lens-4.18.1/changelog\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/lens-4.18.1/changelog</a>"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1573244799, "last_edit_date": 1573244799, "creation_date": 1573244424, "answer_id": 58773278, "question_id": 58772909, "link": "https://stackoverflow.com/questions/58772909/manipulating-single-item-in-list/58773278#58773278", "title": "Manipulating single item in list", "body": "<p>You can do it very similar to your OO code:</p>\n\n<pre><code>vehicles &amp; traverse\n         . filtered ((==1) . _vehicleId)\n         . refuels\n         &lt;&gt;~ [refuel]\n</code></pre>\n\n<p>N.B.: this will update <em>all</em> vehicles with matching IDs, and if there's none it'll just silently do nothing. Maybe not the behavious you want.</p>\n"}], "owner": {"reputation": 3716, "user_id": 3334862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/QlVz8.jpg?s=128&g=1", "display_name": "DevNebulae", "link": "https://stackoverflow.com/users/3334862/devnebulae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 58773278, "answer_count": 2, "score": 1, "last_activity_date": 1573244807, "creation_date": 1573242380, "last_edit_date": 1573244513, "question_id": 58772909, "link": "https://stackoverflow.com/questions/58772909/manipulating-single-item-in-list", "title": "Manipulating single item in list", "body": "<pre class=\"lang-hs prettyprint-override\"><code>import Control.Lens\nimport Data.List (filter)\nimport Data.Time\nimport Data.Text\n\ndata Vehicle = Vehicle\n  { _name :: Text\n  , _admissionDate :: Day\n  , _vehicleId :: Int\n  , _refuels :: [Refuel]\n  }\n\nmakeLenses ''Vehicle\n\ndata Refuel = Refuel\n  { distance :: Int\n  , volume :: Double\n  , pricePerUnit :: Double\n  }\n\naddRefuel :: Refuel -&gt; Vehicle -&gt; Vehicle\naddRefuel refuel = refuels &lt;&gt;~ [refuel]\n\naddRefuelToVehicle :: Int -&gt; refuel -&gt; [Vehicle] -&gt; [Vehicle]\naddRefuelToVehicle vehicleId refuel vehicles =\n  case vehicle of\n    -- Not actual implementation\n    Nothing -&gt; error \"Vehicle not found\"\n    Just v -&gt;\n      let\n        vehicle = addRefuel v refuel\n      -- Add everything that is not the vehicle and add modified vehicle\n      filter (\\v' -&gt; v' \u02c6. vehicleId /= vehicleId) vehicles ++ [vehicle]\n  where\n    vehicle = find (\\v -&gt; v ^. vehicleId == vehicleId) vehicles\n\nvehicles =\n  [ Vehicle { _name = \"Car 1\", _admissionDate = fromGregorian 2006 4 6, _vehicleId = 1, _refuels = []\n  , Vehicle { _name = \"Car 2\", _admissionDate = fromGregorian 2013 7 22, _vehicleId = 2, _refuels = []\n  ]\n</code></pre>\n\n<p>In this example I want to add a <code>Refuel</code> to the <code>_refuels</code> list of the vehicle with <code>_vehicleId = 1</code>. In an object-oriented language, I would solve it like this:</p>\n\n<pre><code>// Ignoring the fact that it may be null\nvehicles\n  .find { it._vehicleId == 1 }\n  ._refuels\n  .append(refuel)\n</code></pre>\n\n<p>How would you go around and solve this in Haskell?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 2, "creation_date": 1573241605, "post_id": 58772569, "comment_id": 103831424, "body": "I don&#39;t think you can. The usual way to go is to have almost all the code in a library, and then have a very-very thin wrapper in the executable."}, {"owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1573242130, "post_id": 58772569, "comment_id": 103831623, "body": "@FyodorSoikin I was afraid so, but since I think it <i>should</i> be possible I had to ask :)"}], "owner": {"reputation": 52747, "user_id": 38055, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d7912ba2ab72397e157148de151cd9e9?s=128&d=identicon&r=PG", "display_name": "Tomas Aschan", "link": "https://stackoverflow.com/users/38055/tomas-aschan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1573240663, "creation_date": 1573240663, "question_id": 58772569, "link": "https://stackoverflow.com/questions/58772569/how-do-i-define-a-dependency-on-an-executable-in-haskell-stack", "title": "How do I define a dependency on an executable in Haskell Stack?", "body": "<p>In a default configuration created with <code>stack new</code>, the project structure is something like this:</p>\n\n<pre><code># package.yaml\nname: my-cool-app\n\nlibrary:\n  source-dirs: src\n\nexecutables:\n  my-cool-app-exe:\n    source-dirs: app\n\ntests:\n  my-cool-app-tests:\n    source-dirs: test\n    dependencies:\n      - my-cool-app # refers to the library\n</code></pre>\n\n<p>How do I define a dependency on the executable, so that my test project can include tests of code that resides in <code>./app</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 1, "creation_date": 1573230765, "post_id": 58767464, "comment_id": 103826831, "body": "May I congratulate you for an excellently written question, well done!"}], "answers": [{"comments": [{"owner": {"reputation": 197, "user_id": 11346784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d07a32bbb6e1118706478f2fa47d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Mampenda", "link": "https://stackoverflow.com/users/11346784/mampenda"}, "edited": false, "score": 0, "creation_date": 1573224112, "post_id": 58768052, "comment_id": 103823085, "body": "Directly translated i&#39;m trying to &quot;check if each element that occurs in the first list, also occurs in the second list&quot;, the way i understand it del [1,1] [1] should return True."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 197, "user_id": 11346784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d07a32bbb6e1118706478f2fa47d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Mampenda", "link": "https://stackoverflow.com/users/11346784/mampenda"}, "edited": false, "score": 0, "creation_date": 1573224292, "post_id": 58768052, "comment_id": 103823193, "body": "Ok, then <code>elem</code> (or your own implementation of it) is the way to go. The other answer provides one possible solution."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1573223274, "last_edit_date": 1573223274, "creation_date": 1573221775, "answer_id": 58768052, "question_id": 58767464, "link": "https://stackoverflow.com/questions/58767464/check-if-all-elements-from-first-argument-appears-in-the-second-argument/58768052#58768052", "title": "Check if all elements from first argument appears in the second argument", "body": "<p>You are removing <code>y</code> too soon; just because <code>x /= y</code> doesn't mean <code>x == z</code> won't be true for some other value <code>z</code> in <code>ys</code>. This is much easier to implement (with <code>elem</code>) if you don't need to remove <code>y</code> at <em>all</em>. If you do, you'll have to do a little more work to remove the correct element from <code>ys</code> when you do find a match. (For instance, should <code>del [1, 1] [1]</code> return True, or False because <code>1</code> doesn't appear twice in the second list?)</p>\n"}, {"tags": [], "owner": {"reputation": 150, "user_id": 7366359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f3b3fe3f92aa52ea451acb8d57ec76?s=128&d=identicon&r=PG&f=1", "display_name": "Alessandro Scandone", "link": "https://stackoverflow.com/users/7366359/alessandro-scandone"}, "is_accepted": true, "score": 4, "last_activity_date": 1573230831, "last_edit_date": 1573230831, "creation_date": 1573222729, "answer_id": 58768299, "question_id": 58767464, "link": "https://stackoverflow.com/questions/58767464/check-if-all-elements-from-first-argument-appears-in-the-second-argument/58768299#58768299", "title": "Check if all elements from first argument appears in the second argument", "body": "<p><code>\"cbbbc\"</code> is not a sublist of <code>\"bca\"</code>, meaning the list <code>\"cbbbc\"</code> doesn't appear inside <code>\"bca\"</code>, like, for instance, <code>\"ca\"</code> does. Your problem is a different one. Here's a working code, in O(n) time complexity:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>del :: Eq a =&gt; [a] -&gt; [a] -&gt; Bool\ndel xs ys = all (`elem` ys) xs\n</code></pre>\n\n<p>It means: return <code>True</code> if (and only if), for every <code>x</code> in <code>xs</code>, <code>x</code> is element of <code>ys</code>.</p>\n"}], "owner": {"reputation": 197, "user_id": 11346784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13d07a32bbb6e1118706478f2fa47d7f?s=128&d=identicon&r=PG&f=1", "display_name": "Mampenda", "link": "https://stackoverflow.com/users/11346784/mampenda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 58768299, "answer_count": 2, "score": 2, "last_activity_date": 1573230831, "creation_date": 1573219515, "last_edit_date": 1573230737, "question_id": 58767464, "link": "https://stackoverflow.com/questions/58767464/check-if-all-elements-from-first-argument-appears-in-the-second-argument", "title": "Check if all elements from first argument appears in the second argument", "body": "<p>I get the wrong result from my code.</p>\n\n<p>I want to check if the elements from the first argument list appears in the second argument list, and I used the code from this quiestion <a href=\"https://stackoverflow.com/questions/47232335/check-if-list-is-a-sublist-of-another-list\">Check, if list is a sublist of another list</a> but i don't get the desired result. </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>del :: Eq t =&gt; [t] -&gt; [t] -&gt; Bool\ndel [] [] = True \ndel _ []  = False \ndel [] _  = True\ndel (x:xs) (y:ys)\n    | x == y    = del xs ys\n    | otherwise = del (x:xs) ys\n</code></pre>\n\n<pre><code>del [2,3] [3,3,1]  -- should return False, which it does, but \ndel \"cbbbc\" \"bca\"  -- should return True, but instead it returns False\n</code></pre>\n\n<p>and I don't understand why?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1573211754, "post_id": 58765431, "comment_id": 103816843, "body": "See comments to <a href=\"https://stackoverflow.com/a/58710168/745903\">stackoverflow.com/a/58710168/745903</a>"}, {"owner": {"reputation": 33, "user_id": 12342830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f2b2f60767c4b33bd7a8b67318eb9c?s=128&d=identicon&r=PG&f=1", "display_name": "michealmyers", "link": "https://stackoverflow.com/users/12342830/michealmyers"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1573212349, "post_id": 58765431, "comment_id": 103817102, "body": "@leftaroundabout thank you! your comment on the other post was perfect!"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1573216004, "post_id": 58765431, "comment_id": 103818878, "body": "There is a trivial solution if you can use the pre-defined <code>words</code> and <code>unwords</code> functions."}], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 2, "last_activity_date": 1573247014, "creation_date": 1573247014, "answer_id": 58773773, "question_id": 58765431, "link": "https://stackoverflow.com/questions/58765431/haskell-how-to-remove-excessive-spaces-in-a-string/58773773#58773773", "title": "Haskell how to remove excessive spaces in a String", "body": "<p>I'd do it like this:</p>\n\n<pre><code>formatSpace :: String -&gt; String\nformatSpace = foldr go \"\"\n  where\n    go x acc = x:if x == ' ' then dropWhile (' ' ==) acc else acc\n</code></pre>\n\n<p>This is maximally lazy and doesn't create any unnecessary intermediate data structures.</p>\n"}], "owner": {"reputation": 33, "user_id": 12342830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99f2b2f60767c4b33bd7a8b67318eb9c?s=128&d=identicon&r=PG&f=1", "display_name": "michealmyers", "link": "https://stackoverflow.com/users/12342830/michealmyers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1573247014, "creation_date": 1573211450, "last_edit_date": 1573215747, "question_id": 58765431, "link": "https://stackoverflow.com/questions/58765431/haskell-how-to-remove-excessive-spaces-in-a-string", "title": "Haskell how to remove excessive spaces in a String", "body": "<p>Trying to create a function that removes all double/triple etc spaces in a\nstring (and merges them into one single space)</p>\n\n<p>So far I have been able to get double spaces to remove, but not sure how to go about triple and more.</p>\n\n<p>i.e <code>\"a b  c   d    e\"</code> -> <code>\"a b c d e\"</code></p>\n\n<pre><code>formatSpace :: String -&gt; String\nformatSpace [] = []\nformatSpace (' ':' ':xs) = ' ': formatSpace xs\nformatSpace (x:xs)   = x: formatSpace xs\n</code></pre>\n\n<p>Thought about trying to turn all spaces into say '-' and then turn all those into a single space. \nBeen able to move and leading and trailing whitespace, but can't do this one</p>\n"}, {"tags": ["haskell", "haskell-stack", "haskell-platform"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 0, "creation_date": 1573207665, "post_id": 58764334, "comment_id": 103814854, "body": "I get &quot;error: Variable not in scope: fact :: Int -&gt; Int&quot; (AFAIK, you can&#39;t &quot;forward-declare&quot; a type in ghci). Which version are you using, and is that all your input?"}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1573208024, "post_id": 58764334, "comment_id": 103815030, "body": "@Megha  That would work with the compiler, but with GHCi the syntax has to be subtly different. This however works with GHCi v8.2.2: <code>let { fact :: Int -&gt; Int ; fact 0 = 1 ; fact n = n * fact (n-1)  }</code>"}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 5, "last_activity_date": 1573207851, "creation_date": 1573207851, "answer_id": 58764492, "question_id": 58764334, "link": "https://stackoverflow.com/questions/58764334/haskell-error-parse-error-on-input/58764492#58764492", "title": "Haskell error - &#39;parse error on input `-&gt;&#39;", "body": "<p>First off, it looks like you're using a pretty old version of GHC. In newer versions, the GHCi syntax has been relaxed a bit.</p>\n\n<p>But still: what you type in GHCi does <em>not</em> have the same rules as what you write in a Haskell source file. Specifically, the GHCi prompt is essentially an IO monad chain evaluator, the reason being that you can write stuff like</p>\n\n<pre><code>Prelude&gt; putStrLn \"Hello\"\nHello\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Prelude&gt; readFile \"test.txt\" \n\"fubar\\nbaz\"\n</code></pre>\n\n<p>and actually have it <em>execute right there</em>. By contrast, in a Haskell source file, you only <em>declare bindings</em>, and these can then be invoked in the <code>main</code> action or a GHCi session.</p>\n\n<p>But in this case, you want to declare a binding within GHCi itself. You <em>can</em> do that too, but it's a bit awkward, basically you need to start with <code>let</code> and then squeeze everything in a single line:</p>\n\n<pre><code>Prelude&gt; let fact :: Int -&gt; Int; fact n = product [1..n]\n</code></pre>\n\n<p><em>Actually</em>, newer GHCi version allow you to omit the <code>let</code>, and you can have multiple-line definitions by using a special bracket syntax:</p>\n\n<pre><code>Prelude&gt; :{\nPrelude| fact :: Int -&gt; Int\nPrelude| fact n = product [1..n]\nPrelude| :}\n</code></pre>\n\n<p>but I would recommend against this. If you actually have some bigger definitions, better put them in a proper Haskell source and <em>load</em> that into GHCi.</p>\n"}], "owner": {"reputation": 11, "user_id": 9046838, "user_type": "registered", "profile_image": "https://graph.facebook.com/258643381329454/picture?type=large", "display_name": "Megha", "link": "https://stackoverflow.com/users/9046838/megha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1573207851, "creation_date": 1573207331, "question_id": 58764334, "link": "https://stackoverflow.com/questions/58764334/haskell-error-parse-error-on-input", "title": "Haskell error - &#39;parse error on input `-&gt;&#39;", "body": "<p>I am trying to declare a function in Haskell GHCi as </p>\n\n<p><code>fact :: Int -&gt; Int</code></p>\n\n<p>But I am getting this error - <strong>error:</strong> <em>parse error on input `->'</em></p>\n\n<p>I do not understand why this is happening. Can anyone please explain it to me? Thanks. </p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 5, "creation_date": 1573193327, "post_id": 58761160, "comment_id": 103809298, "body": "When thinking about why <code>Enum</code> does this or that, it&#39;s always best to start with the knowledge that it&#39;s a fundamentally broken class. Don&#39;t try to make sense of it. Use it for convenience and otherwise ignore it."}, {"owner": {"reputation": 1359, "user_id": 3346496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b1230f0444613f0e8d74e5a71439d1e?s=128&d=identicon&r=PG&f=1", "display_name": "monocell", "link": "https://stackoverflow.com/users/3346496/monocell"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1573197645, "post_id": 58761160, "comment_id": 103810718, "body": "@dfeuer Broken because of stuff like <code>[0, 0.1 .. 0.3]</code> or broken in more fundamental ways?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1573205380, "post_id": 58761160, "comment_id": 103813696, "body": "\u201cThe <code>succ</code> function in enum essentially imposes an order...\u201d \u2014 Not really. For example, <code>succ 2 :: Double</code> is <code>3</code>. Does that mean <code>2.5</code> is not greater than <code>2</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1359, "user_id": 3346496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b1230f0444613f0e8d74e5a71439d1e?s=128&d=identicon&r=PG&f=1", "display_name": "monocell", "link": "https://stackoverflow.com/users/3346496/monocell"}, "edited": false, "score": 2, "creation_date": 1573205937, "post_id": 58761160, "comment_id": 103813994, "body": "@monocell, that&#39;s just a broken instance. To see how broken the class is, start by suggesting some useful laws relating multiple methods to each other. See where everything immediately falls apart."}, {"owner": {"reputation": 1359, "user_id": 3346496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b1230f0444613f0e8d74e5a71439d1e?s=128&d=identicon&r=PG&f=1", "display_name": "monocell", "link": "https://stackoverflow.com/users/3346496/monocell"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1573210631, "post_id": 58761160, "comment_id": 103816345, "body": "@dfeuer, I&#39;ve always though of Enum as things that can straightforwardly be embedded in naturals. Meaning <code>succ</code> is <code>toEnum . (+1) . fromEnum</code> etc. If i think this way then it is broken in a similar way to <code>Read</code>. Is that what you are talking about?"}, {"owner": {"reputation": 41, "user_id": 7048300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8aecf701eff1bf513397323118edd5a?s=128&d=identicon&r=PG&f=1", "display_name": "jude", "link": "https://stackoverflow.com/users/7048300/jude"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1573213152, "post_id": 58761160, "comment_id": 103817471, "body": "@leftaroundabout. I see what you mean but having succ 2:: Double be 3 seems odd to me. Is there some rule (explicit or implicit) on what a succ function can and cannot be?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1573214099, "post_id": 58761160, "comment_id": 103817968, "body": "@judekanil well that&#39;s David&#39;s point: <i>no</i>, the <code>Enum</code> class doesn&#39;t really have any proper specification what it can and can&#39;t do. It&#39;s kind of just, \u201ctypes where people will get an idea what you mean by a range-list\u201d."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1359, "user_id": 3346496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b1230f0444613f0e8d74e5a71439d1e?s=128&d=identicon&r=PG&f=1", "display_name": "monocell", "link": "https://stackoverflow.com/users/3346496/monocell"}, "edited": false, "score": 1, "creation_date": 1573215184, "post_id": 58761160, "comment_id": 103818516, "body": "@monocell For what it&#39;s worth, note that <code>[0.0, 0.1 .. 0.3]</code> works fairly reliably, since rounding errors are far smaller than what&#39;s checked. The list will always be 4 elements long, the last element being 0.3+/- some rounding error. What is really bogus is <code>[0.0, 0.1 .. 0.25]</code> which can be of length 3 or 4 depending on the rounding, since <code>0.25</code> falls exactly between two elements of the sequence. In retrospect, <code>Enum Double</code> should not exist."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1573216548, "post_id": 58761160, "comment_id": 103819083, "body": "The comments are getting a bit off-topic; the fact that some types with an <code>Enum</code> instance aren&#39;t <i>really</i> enumerable doesn&#39;t explain why <code>Ord</code> isn&#39;t assumed or required."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1573236467, "post_id": 58767024, "comment_id": 103829423, "body": "I disagree with this necessity argument. That doesn&#39;t mesh with a lot of classes. You don&#39;t need <code>fmap</code> to define <code>&gt;&gt;=</code>, for example."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1573236875, "post_id": 58767024, "comment_id": 103829620, "body": "Not directly, but <code>&gt;&gt;=</code> has to obey the law <code>fmap f xs === xs &gt;&gt;= return . f</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1573220668, "last_edit_date": 1573220668, "creation_date": 1573217676, "answer_id": 58767024, "question_id": 58761160, "link": "https://stackoverflow.com/questions/58761160/why-isnt-enum-typeclass-a-subclass-of-ord-typeclass/58767024#58767024", "title": "Why isnt enum typeclass a subclass of ord typeclass?", "body": "<p>The <code>Ord</code> typeclass is meant to represent <em>total</em> orders, which among other things requires transitivity: if <code>a &lt; b</code> and <code>b &lt; c</code>, then <code>a &lt; c</code>.</p>\n\n<p>A superclass should be necessary for the definition of an instance of a class.</p>\n\n<p>An <code>Enum</code>, though it might <em>impose</em> an order (though not a necessarily total one) on its elements, doesn't <em>use</em> or <em>require</em> a total ordering.</p>\n\n<p>As an example, consider everyone's favorite decision-making algorithm:</p>\n\n<pre><code>data RPS = Rock | Paper | Scissors deriving (Eq, Ord)\n\ninstance Enum RPS where\n    succ Rock = Paper\n    succ Paper = Scissors\n    succ Scissors = Rock\n</code></pre>\n\n<p>The <code>Ord</code> instance derived from the definition is total, and straightforward: <code>Rock</code> is the smallest element, <code>Scissors</code> the largest, and <code>Paper</code> comes between.</p>\n\n<p>The order implied by this enumeration isn't total. Given <code>succ</code>, you might assume that <code>Rock &lt; Paper</code> and <code>Paper &lt; Scissors</code>, but then <code>Rock &lt; Scissors</code> should be true, which is <em>not</em> implied by <code>succ Scissors = Rock</code>.</p>\n\n<p>The <code>Ord</code> instance wouldn't be useful in defining the <code>Enum</code> shown above.</p>\n"}], "owner": {"reputation": 41, "user_id": 7048300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8aecf701eff1bf513397323118edd5a?s=128&d=identicon&r=PG&f=1", "display_name": "jude", "link": "https://stackoverflow.com/users/7048300/jude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1573220668, "creation_date": 1573192515, "last_edit_date": 1573213005, "question_id": 58761160, "link": "https://stackoverflow.com/questions/58761160/why-isnt-enum-typeclass-a-subclass-of-ord-typeclass", "title": "Why isnt enum typeclass a subclass of ord typeclass?", "body": "<p>I would like to know the reasons why enum typeclass does not inherit the ord typeclass. The succ function in enum essentially imposes an order on the values and yet ord is not a required constraint.</p>\n\n<p>Edit:\nAlso, for other functions in the typeclass, there seems to be an implicit assumption about ord operators being defined for them. As shown here <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:enumFromTo\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:enumFromTo</a></p>\n\n<blockquote>\n  <p>a possible implementation being enumFromTo n m | n &lt;= m = n : enumFromTo (succ n) m | otherwise = []</p>\n</blockquote>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1573192817, "post_id": 58761046, "comment_id": 103809161, "body": "Hi talex. I&#39;m asking about <code>:|</code> not <code>NonEmpty</code>. Sorry for the confusion."}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1573192985, "post_id": 58761046, "comment_id": 103809213, "body": "You interested in <code>:|</code> specifically or want to learn about infix constructors in general?"}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1573193446, "post_id": 58761046, "comment_id": 103809335, "body": ":| specifically. For instance, I&#39;ve no idea how to rewrite that constructor without that operator, if that helps show my ignorance."}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1573193550, "post_id": 58761046, "comment_id": 103809370, "body": "What exactly you want to know about it? I thought all information you need you can learn from its definition <code>data NonEmpty a = a :| [a]</code>."}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1573193846, "post_id": 58761046, "comment_id": 103809446, "body": "I guess that&#39;s because you understand it :) If I look up &quot;haskell data constructor&quot; and go through articles explaining them, I won&#39;t find any examples with <code>:|</code> in there, because I&#39;ve been through quite a few. I just don&#39;t get what it&#39;s doing."}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 5, "creation_date": 1573194349, "post_id": 58761046, "comment_id": 103809602, "body": "Oh. I got it. <code>:|</code> doesn&#39;t have special meaning here. You can replace it with <code>:::</code>, <code>|:+</code> or any other combination of punctuation character. It is like constructor name but consists of punctuation characters instead of letters."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1573197864, "post_id": 58761046, "comment_id": 103810793, "body": "@talex Yeah, you kinda just have to know that you can define infix data constructors using symbols. Everybody sees the example of <code>:</code> for lists, but lists have other dedicated syntax so there&#39;s nothing to tell you that <code>:</code> isn&#39;t special. The Haskell Report does spell this out reasonably clearly (<a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-180002.4\" rel=\"nofollow noreferrer\">haskell.org/onlinereport/haskell2010/&hellip;</a>), but people don&#39;t learn the language from that, so if your learning material doesn&#39;t point out infix constructors then you just don&#39;t know about them."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1573198011, "post_id": 58761046, "comment_id": 103810848, "body": "@talex Btw it can&#39;t be any combination of punctuation characters. Much like normal identifiers are split into &quot;constructors&quot; beginning with an upper-case letter and &quot;variables&quot; beginning with a lower-case letter (or underscore), symbolic constructors must be distinguished by beginning with a <code>:</code>. (Basically: colons are &quot;upper case&quot;)"}, {"owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1573198376, "post_id": 58761046, "comment_id": 103810975, "body": "@Ben thanks, didn&#39;t know that. Never used that feature myself."}, {"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1573266549, "post_id": 58761046, "comment_id": 103837473, "body": "<i>Now</i> I get it! Thanks talex, and everyone."}], "tags": [], "owner": {"reputation": 15567, "user_id": 3656904, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c8dbd58d3b477ad0e5889bc60625e7e8?s=128&d=identicon&r=PG&f=1", "display_name": "talex", "link": "https://stackoverflow.com/users/3656904/talex"}, "is_accepted": true, "score": 6, "last_activity_date": 1573214677, "last_edit_date": 1573214677, "creation_date": 1573191837, "answer_id": 58761046, "question_id": 58760972, "link": "https://stackoverflow.com/questions/58760972/explanation-of-the-infix-data-constructor-operator/58761046#58761046", "title": "Explanation of the infix data constructor operator", "body": "<p>Full name of type is <code>Data.List.NonEmpty</code>.</p>\n\n<p>You can find details <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List-NonEmpty.html\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>There is site <a href=\"https://hoogle.haskell.org/\" rel=\"nofollow noreferrer\">https://hoogle.haskell.org/</a> which is good starting point in searching functions, types, etc. in haskell libraries.</p>\n\n<p><strong>EDIT</strong>: If you confuse with what <code>:|</code> mean then here some explanation.</p>\n\n<p>In haskell you can define custom operators like <code>.</code>, <code>$</code>, <code>&lt;*&gt;</code>. Same way you can create infix constructor with custom \"names\".</p>\n\n<p>So you can define one yourself:</p>\n\n<pre><code>data MyType = Integer :++ Integer\n</code></pre>\n\n<p>and use them as</p>\n\n<pre><code>someVal :: MyType\nsomeVal = 1 :++ 2\n</code></pre>\n\n<p>or</p>\n\n<pre><code>foo :: MyType -&gt; Integer\nfoo (a :++ b) = a\n</code></pre>\n\n<p>Note that it have to start with <code>:</code> (Thanks to @Ben)</p>\n"}, {"comments": [{"owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1573266897, "post_id": 58762251, "comment_id": 103837513, "body": "Ah, the laziness of programmers. I should&#39;ve known! :) Thanks."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "edited": false, "score": 0, "creation_date": 1573270593, "post_id": 58762251, "comment_id": 103837949, "body": "@iain I wouldn\u2019t call it laziness as such. Haskell programmers very often define functions (and less often constructors and data types) as operators, simply because it works better for that particular usecase. A great example is the monadic bind operator <code>&gt;&gt;=</code>: something like <code>m &gt;&gt;= func1 &gt;&gt;= func2 &gt;&gt;= func3</code> is a <i>lot</i> easier to read than <code>bind (bind (bind m func1) func2) func3</code>. Another good example is the <a href=\"https://tidalcycles.org/index.php/Welcome\" rel=\"nofollow noreferrer\">TidalCycles</a> library, which allows musical composition in Haskell by using operators to put pieces of music together."}], "tags": [], "owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "is_accepted": false, "score": 4, "last_activity_date": 1573198253, "creation_date": 1573198253, "answer_id": 58762251, "question_id": 58760972, "link": "https://stackoverflow.com/questions/58760972/explanation-of-the-infix-data-constructor-operator/58762251#58762251", "title": "Explanation of the infix data constructor operator", "body": "<p><code>:|</code> is just the name of the constructor. It\u2019s essentially the same as doing this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data NonEmpty2 a = (:|) a [a]\n</code></pre>\n\n<p>Or this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data NonEmpty3 a = TheNonEmptyConstructor a [a]\n\n(:|) = TheNonEmptyConstructor\n</code></pre>\n\n<p>The constructor name must begin with a colon in order to be used as an infix operator, but otherwise it\u2019s just a normal constructor, except that you can also use it as an operator.</p>\n\n<p>Now, why would someone need this? Really, it\u2019s just because <code>1 :| [2,3,4]</code> is much nicer to read and write than <code>ConstructorName 1 [2,3,4]</code>!</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1573214597, "creation_date": 1573214597, "answer_id": 58766239, "question_id": 58760972, "link": "https://stackoverflow.com/questions/58760972/explanation-of-the-infix-data-constructor-operator/58766239#58766239", "title": "Explanation of the infix data constructor operator", "body": "<p>The <code>data</code> declaration <em>defines</em> <code>:|</code>, rather than <em>using</em> a predefined <code>:|</code> operator.</p>\n\n<p>Consider the oft-used example of how <code>[]</code> is defined in (pseudo) Haskell:</p>\n\n<pre><code>data [] a = [] | (:) a ([] a)  -- data [a] = [] | a : [a]\n</code></pre>\n\n<p>Here, <code>:</code> is being defined as the operator that creates a list given an element of type <code>a</code> and another list of type <code>[a]</code>.</p>\n\n<p>Any type can create an infix constructor, just as you can define infix operators. The difference between an infix constructor and an infix operator is that the constructor can, and must, begin with a <code>:</code>. (<code>(:)</code> itself is the trivial example of one, starting with and consisting <em>only</em> of a <code>:</code>.)</p>\n\n<p>You can also define type-level infix constructors. For example,</p>\n\n<pre><code>type f :+: g = Either f g\n</code></pre>\n"}], "owner": {"reputation": 11068, "user_id": 335847, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/o0AC7.png?s=128&g=1", "display_name": "iain", "link": "https://stackoverflow.com/users/335847/iain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 58761046, "answer_count": 3, "score": 2, "last_activity_date": 1573214677, "creation_date": 1573191360, "question_id": 58760972, "link": "https://stackoverflow.com/questions/58760972/explanation-of-the-infix-data-constructor-operator", "title": "Explanation of the infix data constructor operator", "body": "<p>I was reading this interesting blog post called <a href=\"https://lexi-lambda.github.io/blog/2019/11/05/parse-don-t-validate/\" rel=\"nofollow noreferrer\">Parse, don't validate</a> and it includes this:</p>\n\n<blockquote>\n  <p>To do this, we need a type that represents non-empty lists. Fortunately, the existing NonEmpty type from Data.List.NonEmpty is exactly that. It has the following definition:</p>\n</blockquote>\n\n<pre><code>data NonEmpty a = a :| [a]\n</code></pre>\n\n<blockquote>\n  <p>Note that NonEmpty a is really just a tuple of an a and an ordinary, possibly-empty [a]. This conveniently models a non-empty list by storing the first element of the list separately from the list\u2019s tail: even if the [a] component is [], the a component must always be present.</p>\n</blockquote>\n\n<p>The only place I could find anything about <code>:|</code> was in the comments to <a href=\"https://stackoverflow.com/questions/6420606/creating-a-backward-list-using-recursive-data-type-in-haskell\">this SO question</a>, which meant I need to have some understanding of that question/discussion and parse the formatting.</p>\n\n<p>Is there any documentation for this (my searches bore no fruit) and is there a simple explanation of its use? I don't get it, as I only sometimes dip my toe in the water with Haskell.</p>\n\n<p>Any help or insight will be much appreciated.</p>\n"}, {"tags": ["list", "function", "haskell", "haskell-platform"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 7, "creation_date": 1573179320, "post_id": 58759404, "comment_id": 103806360, "body": "What have you tried?  Are you familiar with recursive functions?  How about the <code>lookup</code> function?"}], "answers": [{"tags": [], "owner": {"reputation": 716, "user_id": 4803382, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/1xwqI.jpg?s=128&g=1", "display_name": "dccsillag", "link": "https://stackoverflow.com/users/4803382/dccsillag"}, "is_accepted": false, "score": 0, "last_activity_date": 1574017904, "creation_date": 1574017904, "answer_id": 58904185, "question_id": 58759404, "link": "https://stackoverflow.com/questions/58759404/haskell-searching-the-entire-list-for-an-char/58904185#58904185", "title": "Haskell - Searching the entire list for an char", "body": "<p>There are a few ways to do this, and for all of them we will be writing a function that also takes as an input <code>charKeys</code>.</p>\n\n<p>The most important would be using recursion:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>search n charKeys = if n == fst (head charKeys) then replicate 3 (snd (head charKeys)) else search n (tail charKeys)\n</code></pre>\n\n<p>We can rewrite this using pattern matching and function guards like so:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>search n ((k,c):lst) | k == n       = replicate 3 c\n                     | otherwise    = search n lst\n</code></pre>\n\n<p>It's also good practice to cover all possible inputs for a pattern match, so we add this additional line:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>search _ [] = error \"Requested key not found\"\n</code></pre>\n\n<p>These are pretty important concepts in Haskell, so make sure you understand what's going on here before going on.</p>\n\n<p>Another solution would be to use the function <code>find</code> from <code>Data.List</code>, documented <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-List.html#v:find\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.List (find)\n</code></pre>\n\n<pre class=\"lang-hs prettyprint-override\"><code>search n charKeys = case find ((==n) . fst) charKeys of\n                        Just (_,c)  -&gt; replicate 3 c\n                        Nothing     -&gt; error \"Requested key not found\"\n</code></pre>\n\n<p>Note that we're using a case statement to check whether we've found a matching element in the list, since <code>find</code> returns a <code>Maybe</code>.\nAlso, <code>(==n) . fst</code> is a more idiomatic way of saying <code>\\x -&gt; fst x == n</code>, using composition and operator punning.</p>\n\n<p>We can simplify this even further by using Prelude's <code>lookup</code> function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>search n charKeys = case lookup n charKeys of\n                        Just c  -&gt; replicate 3 c\n                        Nothing -&gt; error \"Requested key not found\"\n</code></pre>\n\n<p>And even more by using <code>maybe</code> from <code>Data.Maybe</code> (also using <code>$</code>):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>search n charKeys = maybe (error \"Requested key not found\") (replicate 3) $ lookup n charKeys\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 12285658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c01b5bca18122d2e089df184b5e37d3e?s=128&d=identicon&r=PG&f=1", "display_name": "sambud_Ger", "link": "https://stackoverflow.com/users/12285658/sambud-ger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1574017904, "creation_date": 1573178604, "question_id": 58759404, "link": "https://stackoverflow.com/questions/58759404/haskell-searching-the-entire-list-for-an-char", "title": "Haskell - Searching the entire list for an char", "body": "<p>I have following list:</p>\n\n<pre><code> charKeys=[('1','a')\n          ,('2','b')\n          ,('3','c')\n          ,('4','d')\n          ,('5','e')]\n</code></pre>\n\n<p>Now i want to search for an character in the list and replicate the other character three times.\nI want a function like that:</p>\n\n<pre><code> search x = if x == fst(charKeys !! 0) then replicate 3 (snd(charKeys !! 0)) else \"Error\" \n</code></pre>\n\n<p>But this function only check the first index of the list and works only for x == '1'.</p>\n\n<p>Can somebody help me, that the function also works if x == '2' or '5' ?</p>\n"}, {"tags": ["haskell", "type-level-computation", "singleton-type"], "owner": {"reputation": 365, "user_id": 2593302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fe83beb5917d7541b088a20bce08b3?s=128&d=identicon&r=PG&f=1", "display_name": "chad", "link": "https://stackoverflow.com/users/2593302/chad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1573171417, "creation_date": 1573171417, "question_id": 58758599, "link": "https://stackoverflow.com/questions/58758599/creating-a-type-level-structure-that-contains-a-typelit-with-singletons", "title": "Creating a type-level structure that contains a TypeLit with singletons", "body": "<p>Suppose I define some type-level structures like so:</p>\n\n<pre><code>import Data.Singletons.Prelude\nimport Data.Singletons.TH\n\nsingletons [d|\n            data Natural = Succ Natural | Zero deriving (Show, Ord, Eq)\n            data Coord = Coord Natural Natural deriving (Show, Eq)\n           |]\n</code></pre>\n\n<p>However, instead of defining my own <code>Natural</code> type, I'd like to use <code>GHC.TypeLit.Nat</code> instead (if for no other reason than that the compiler error messages are nicer). The <code>singletons</code> package has already defined instances for the relevant classes in <code>Data.Singletons.TypeLits</code>, so this should be possible.</p>\n\n<p>However, attempting to replace <code>Natural</code> with <code>Nat</code> like so</p>\n\n<pre><code>import Data.Singletons.Prelude\nimport Data.Singletons.TH\nimport Data.Singletons.TypeLits\n\nsingletons [d| data Coord = Coord Nat Nat deriving (Show, Eq) |]\n</code></pre>\n\n<p>yields the following error</p>\n\n<pre><code>    \u2022 Couldn't match type \u2018GHC.Natural.Natural\u2019 with \u2018Nat\u2019\n      Expected type: Nat\n        Actual type: Demote Nat\n    \u2022 In the first argument of \u2018Coord\u2019, namely \u2018(fromSing b_awjJ)\u2019\n      In the expression: (Coord (fromSing b_awjJ)) (fromSing b_awjK)\n      In an equation for \u2018fromSing\u2019:\n          fromSing (SCoord b_awjJ b_awjK)\n            = (Coord (fromSing b_awjJ)) (fromSing b_awjK)\n</code></pre>\n\n<p>I understand why this error is appearing, but I am unsure how to proceed from here. Is it possible to create type-level structures that contain <code>TypeLits</code> using the <code>singletons</code> Template Haskell? And if not, is there some way to do this without having to implement all of the necessary singleton's machinery for <code>Coord</code> by hand?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 11777117, "user_type": "registered", "profile_image": "https://graph.facebook.com/2278657319062617/picture?type=large", "display_name": "Kris", "link": "https://stackoverflow.com/users/11777117/kris"}, "edited": false, "score": 0, "creation_date": 1573173240, "post_id": 58758604, "comment_id": 103805134, "body": "Thank you anyway..... I tried ur suggestion and i got more error......."}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "reply_to_user": {"reputation": 19, "user_id": 11777117, "user_type": "registered", "profile_image": "https://graph.facebook.com/2278657319062617/picture?type=large", "display_name": "Kris", "link": "https://stackoverflow.com/users/11777117/kris"}, "edited": false, "score": 0, "creation_date": 1573173803, "post_id": 58758604, "comment_id": 103805224, "body": "It works with the cases you mentioned in the post. Which new cases failed?"}, {"owner": {"reputation": 19, "user_id": 11777117, "user_type": "registered", "profile_image": "https://graph.facebook.com/2278657319062617/picture?type=large", "display_name": "Kris", "link": "https://stackoverflow.com/users/11777117/kris"}, "edited": false, "score": 0, "creation_date": 1573174007, "post_id": 58758604, "comment_id": 103805258, "body": "Testing matchEmpty INCORRECT: e|A        wanted: True        got:    False  INCORRECT: A*        wanted: True        got:    False  INCORRECT: (A|e)+        wanted: True        got:    False  INCORRECT: (AB)*        wanted: True        got:    False  INCORRECT: eA*        wanted: True        got:    False"}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "reply_to_user": {"reputation": 19, "user_id": 11777117, "user_type": "registered", "profile_image": "https://graph.facebook.com/2278657319062617/picture?type=large", "display_name": "Kris", "link": "https://stackoverflow.com/users/11777117/kris"}, "edited": false, "score": 0, "creation_date": 1573174371, "post_id": 58758604, "comment_id": 103805345, "body": "It works for all these cases when I try them manually. Are you sure you completely deleted all traces of your old <code>matchEmpty</code> function? Are you sure the file is saved and recompiled?"}, {"owner": {"reputation": 19, "user_id": 11777117, "user_type": "registered", "profile_image": "https://graph.facebook.com/2278657319062617/picture?type=large", "display_name": "Kris", "link": "https://stackoverflow.com/users/11777117/kris"}, "edited": false, "score": 0, "creation_date": 1573174745, "post_id": 58758604, "comment_id": 103805434, "body": "It was my fault, I added more parentheses just now , it works now, Thank you!"}], "tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": true, "score": 1, "last_activity_date": 1573171849, "last_edit_date": 1573171849, "creation_date": 1573171488, "answer_id": 58758604, "question_id": 58758515, "link": "https://stackoverflow.com/questions/58758515/write-a-function-that-returns-true-for-regular-expressions-that-match-the-empty/58758604#58758604", "title": "Write a function that returns true for regular expressions that match the empty string in Haskell", "body": "<p>It looks like the problems you have are that:</p>\n\n<ol>\n<li><p><code>Repeat (Symbol A)</code> is incorrectly marked false. </p>\n\n<p>This is because patterns are matched from top to bottom, so <code>matchEmpty (_) = False</code> catches it instead of <code>matchEmpty(Repeat(_)) = True</code></p></li>\n<li><p><code>Plus (x)</code> is incorrectly always marked as false.</p>\n\n<p>This should be true when <code>x</code> matches the empty string (yes, this would be a recursive check).</p></li>\n<li><p><code>x :- y</code> is correctly marked as true when <code>x</code> is <code>Empty</code>, but incorrectly fails these cases:</p>\n\n<p><code>Symbol A :+ Empty</code> -- the other side is empty</p>\n\n<p><code>(Repeat _) :+ (Empty :+ Empty)</code> -- neither side is <code>Empty</code> itself, but still matches the empty string (this would also be a recursive check)</p></li>\n<li><p><code>x :* y</code> is always incorrectly marked false. This should be true when <em>both</em> sides can match the empty string (also recursive).</p></li>\n</ol>\n\n<p>You can give it another go now with those observations.</p>\n\n<p>For a spoiler, here's my suggestion:</p>\n\n<pre><code>matchEmpty Empty = True\nmatchEmpty (Repeat _) = True\nmatchEmpty (Plus x) = matchEmpty x\nmatchEmpty (x :+ y) = matchEmpty x || matchEmpty y\nmatchEmpty (x :* y) = matchEmpty x &amp;&amp; matchEmpty y\nmatchEmpty _ = False\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11777117, "user_type": "registered", "profile_image": "https://graph.facebook.com/2278657319062617/picture?type=large", "display_name": "Kris", "link": "https://stackoverflow.com/users/11777117/kris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 58758604, "answer_count": 1, "score": -1, "last_activity_date": 1573171849, "creation_date": 1573170682, "question_id": 58758515, "link": "https://stackoverflow.com/questions/58758515/write-a-function-that-returns-true-for-regular-expressions-that-match-the-empty", "title": "Write a function that returns true for regular expressions that match the empty string in Haskell", "body": "<p>This is the code: </p>\n\n<pre><code>import Data.List\ndata RE sym\n    = Never             -- match no strings\n    | Empty             -- match empty string\n    | Symbol sym        -- match singleton string\n    | RE sym :+ RE sym  -- choice\n    | RE sym :* RE sym  -- concatenation\n    | Repeat (RE sym)   -- repeat zero or more times\n    | Plus (RE sym)     -- repeat one or more times\n    deriving (Show, Eq)\n\ninfixr 6 :+, .+.\ninfixr 7 :*, .*.\n\ndata ABC = A | B | C deriving (Show, Eq, Ord)\n</code></pre>\n\n<p>Write a function matchEmpty that returns true for regular expressions that match the empty string.</p>\n\n<pre><code>matchEmpty :: RE sym -&gt; Bool\nmatchEmpty = ???\n</code></pre>\n\n<p>This is What I write: </p>\n\n<pre><code>matchEmpty (Empty :+ _) = True\nmatchEmpty Empty = True\nmatchEmpty Never = False\nmatchEmpty (_) = False\nmatchEmpty(Repeat(_)) = True\n</code></pre>\n\n<p>but i still got error for some cases: </p>\n\n<pre><code>Testing matchEmpty\nINCORRECT: A*\n       wanted: True\n       got:    False\n\nINCORRECT: (A|e)+\n       wanted: True\n       got:    False\n\nINCORRECT: (AB)*\n       wanted: True\n       got:    False\n</code></pre>\n\n<p>I am so lost for this one, Please help me to do this one,  I am a beginner in Haskell and try to learn it by myself. \nDoes there need recursion or something else to do this problem? </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1573164337, "post_id": 58756420, "comment_id": 103802821, "body": "Could also return <code>const word</code>, if you&#39;re feeling cheeky"}, {"owner": {"reputation": 31, "user_id": 7999382, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-peWhPXD9z1E/AAAAAAAAAAI/AAAAAAAAACg/Fq6tf_hvHH0/photo.jpg?sz=128", "display_name": "Joseph Taylor", "link": "https://stackoverflow.com/users/7999382/joseph-taylor"}, "edited": false, "score": 0, "creation_date": 1573210625, "post_id": 58756420, "comment_id": 103816341, "body": "Thanks for this, though I&#39;m still not sure I understand. If I replace <code>???</code> with <code>enc (-num)</code> then try to run <code>encrypt 10 &quot;hello&quot;</code> it returns an error saying <code>no instance for (Show (String -&gt; String))</code>. What have I messed up?"}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1573230807, "post_id": 58756420, "comment_id": 103826849, "body": "Nothing, it&#39;s working. That just means &quot;I don&#39;t know how to represent a function on screen&quot;. Interactively in ghci you can do <code>let (encrypted, f) = encrypt 10 &quot;hello&quot;</code> and then show <code>encrypted</code> and <code>f encrypted</code> since those are both strings and can therefore be shown on screen"}], "tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": false, "score": 2, "last_activity_date": 1573158343, "creation_date": 1573158343, "answer_id": 58756420, "question_id": 58756339, "link": "https://stackoverflow.com/questions/58756339/returning-a-function/58756420#58756420", "title": "Returning a function", "body": "<p>There's the explicit lambda approach that declares a function with a parameter:</p>\n\n<pre><code>-- Expression is of the type String -&gt; String\n-- Similar to python  lambda mystring: enc(-num, mystring)\n--         or java    (mystring) =&gt; enc(-num, mystring)\n\n\\mystring -&gt; enc (-num) mystring\n</code></pre>\n\n<p>However, thanks to currying, you can just take <code>enc :: Int -&gt; String -&gt; String</code> and give it an int, which will result in a <code>String -&gt; String</code>:</p>\n\n<pre><code>-- Also of the type String -&gt; String\nenc (-num)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1573160058, "creation_date": 1573160058, "answer_id": 58756758, "question_id": 58756339, "link": "https://stackoverflow.com/questions/58756339/returning-a-function/58756758#58756758", "title": "Returning a function", "body": "<p>A lambda expression would be the most direct way, as others pointed out. Note that you can still simply define your own function and return it, e.g.</p>\n\n<pre><code>encrypt :: Int -&gt; String -&gt; (String , String -&gt; String)\nencrypt num word = (enc num word, myFunction)\n   where\n   myFunction :: String -&gt; String\n   myFunction str = .... -- here you can use num, word, str to produce the result you need\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7999382, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-peWhPXD9z1E/AAAAAAAAAAI/AAAAAAAAACg/Fq6tf_hvHH0/photo.jpg?sz=128", "display_name": "Joseph Taylor", "link": "https://stackoverflow.com/users/7999382/joseph-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1573165813, "creation_date": 1573157909, "last_edit_date": 1573165813, "question_id": 58756339, "link": "https://stackoverflow.com/questions/58756339/returning-a-function", "title": "Returning a function", "body": "<p>I have been tasked with this:</p>\n\n<blockquote>\n  <p>Write a function <code>enc :: Int -&gt; String -&gt; String</code> that encrypts a string by adding some given integer to each character's Unicode value. Now, using <code>enc</code> as a locally declared function write a function <code>encrypt :: Int -&gt; String -&gt; (String , String -&gt; String)</code> that accepts a <code>String</code> and an <code>Int</code> and returns a pair of an encrypted string and a function with which to decrypt the string.</p>\n</blockquote>\n\n<p>I have written the function <code>enc</code>, that was fairly easy, but I cannot figure out how to return a function from <code>encrypt</code>.</p>\n\n<p>So far I have</p>\n\n<pre><code>encrypt :: Int -&gt; String -&gt; (String , String -&gt; String)\nencrypt num word = (enc num word, ???)\n</code></pre>\n\n<p>I have no idea what to write in place of '???'. I've read a fair bit about curried functions but everything I've found defines a function that takes a function as a parameter and uses that function to recursively call itself. <code>encrypt</code> doesn't take a function as a parameter. How can I define an entirely new function and return it, rather than returning its value, all from within another function?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1573155243, "post_id": 58755712, "comment_id": 103799241, "body": "You probably mean <code>counta xs = length [ x | x &lt;- xs, isDigit x]</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1573156979, "post_id": 58755712, "comment_id": 103799977, "body": "I don&#39;t see why you <i>would</i> use a list comprehension to do this."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1573157014, "post_id": 58755712, "comment_id": 103799997, "body": "<code>counta = length . filter isDigit</code>."}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 1, "creation_date": 1573168845, "post_id": 58755712, "comment_id": 103804152, "body": "Maybe use: <code>let ls = [&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;2&#39;,&#39;a&#39;,&#39;s&#39;,&#39;d&#39;,&#39;f&#39;]  in  length  $  [ x | x &lt;- ls,  isDigit x ]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 239, "user_id": 3834848, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ervbf.jpg?s=128&g=1", "display_name": "Apoorv", "link": "https://stackoverflow.com/users/3834848/apoorv"}, "is_accepted": false, "score": 1, "last_activity_date": 1573158535, "creation_date": 1573158535, "answer_id": 58756463, "question_id": 58755712, "link": "https://stackoverflow.com/questions/58755712/using-list-comprehension-how-do-i-calculate-how-many-digits-there-are-in-a-list/58756463#58756463", "title": "using list comprehension how do i calculate how many digits there are in a list of characters", "body": "<p>You are on the right track, as @AJFarmar has pointed out the correct answer.\nLet the types guide your answer.</p>\n\n<p>You need a function that takes a list and returns the number digits present (Int)\nso the function should have the type as you have mentioned to be: </p>\n\n<p><code>counta :: [char] -&gt; Int</code></p>\n\n<p>But your function definition for <code>counta</code> says that it is a List. Which is what the type checker might be complaining about as a List is not an Int. To use the list comprehension idiom you need to get the name of the list, lets say <code>xs</code>, so that you can iterate through each of its elements. And for each element in <code>xs</code> it also has to be a digit. You already have a function <code>isDigit</code> that does the work of telling you if a <code>char</code> is a digit.</p>\n\n<p>Now you can have a list comprehension that tells you what exactly all those elements are:</p>\n\n<p><code>[x | x&lt;-xs, isDigit x]</code></p>\n\n<p>And you need a count of all those elements, so pass it to the standard <code>length</code> function.</p>\n\n<p><code>counta = length [x | x&lt;-xs , isDigit x]</code></p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1573187092, "post_id": 58758304, "comment_id": 103807954, "body": "... or <code>Prelude&gt; :set -XMonadComprehensions</code> at the GHCi prompt. (superbly done, seeing <i>that</i>. I didn&#39;t. :) )"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1573188446, "last_edit_date": 1573188446, "creation_date": 1573169098, "answer_id": 58758304, "question_id": 58755712, "link": "https://stackoverflow.com/questions/58755712/using-list-comprehension-how-do-i-calculate-how-many-digits-there-are-in-a-list/58758304#58758304", "title": "using list comprehension how do i calculate how many digits there are in a list of characters", "body": "<p>Your first attempt actually works as-is, if you just put <code>{-# LANGUAGE MonadComprehensions #-}</code> at the beginning of your program. However, it's super unidiomatic.</p>\n\n<p>Your \"list comprehension\" is really a monad comprehension, since <code>length . filter isDigit</code> isn't a list but rather a function, and functions are monads. Also, any list or monad comprehension that's of the form <code>[x | x &lt;- stuff]</code> is equivalent to just <code>stuff</code>. After that transformation, you wouldn't need to enable MonadComprehensions anymore, and then your solution would be idiomatic.</p>\n\n<p>Alternatively, you could go even sillier, using the facts that <code>(.) = fmap</code> and <code>fmap f xs = [f x | x &lt;- xs]</code>, and end up with this:</p>\n\n<pre><code>counta :: [Char] -&gt; Int\ncounta = [length x | x &lt;- filter isDigit]\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 12325447, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406948378ae5a4cbee9767d646911587?s=128&d=identicon&r=PG&f=1", "display_name": "mgt", "link": "https://stackoverflow.com/users/12325447/mgt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1573188446, "creation_date": 1573155053, "last_edit_date": 1573155192, "question_id": 58755712, "link": "https://stackoverflow.com/questions/58755712/using-list-comprehension-how-do-i-calculate-how-many-digits-there-are-in-a-list", "title": "using list comprehension how do i calculate how many digits there are in a list of characters", "body": "<p>I need to calculate the number of digits that appear in a list of characters using list comprehension in Haskell.</p>\n\n<p>so far i have found out how to do it using recursion but am struggling to use list comprehension:</p>\n\n<p>e.g. in the following list <code>['1','2','3','4','2','a','s','d','f']</code>\nthe answer would be <code>5</code></p>\n\n<p>I have tried using recursion as well as higher order functions </p>\n\n<p>List Comprehension:</p>\n\n<pre><code>counta :: [Char] -&gt; Int\ncounta = [ x | x &lt;- length . filter isDigit]\n</code></pre>\n\n<p>Recursion:</p>\n\n<pre><code>countb :: [Char] -&gt; Int\ncountb [] = 0\ncountb (x:xs)  \n    | isDigit x = 1 + countb xs \n    | otherwise = countb xs\n</code></pre>\n\n<p>I call <code>countb ['1','2','3','4','2','a','s','d','f']</code> and the answer is <code>5</code>.</p>\n"}, {"tags": ["haskell", "md5", "cabal"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 3712238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U0sEu.png?s=128&g=1", "display_name": "bfosterscripps", "link": "https://stackoverflow.com/users/3712238/bfosterscripps"}, "edited": false, "score": 0, "creation_date": 1573227166, "post_id": 58759535, "comment_id": 103824854, "body": "while it works, I don&#39;t understand what the consequences are - it would help if I better understood how cabal works, and what <code>cabal new-install</code> does ... it seems like cabal works within &quot;environments&quot; or projects, and I wonder what the consequences are of running <code>new-install</code>..."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 101, "user_id": 3712238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U0sEu.png?s=128&g=1", "display_name": "bfosterscripps", "link": "https://stackoverflow.com/users/3712238/bfosterscripps"}, "edited": false, "score": 0, "creation_date": 1573228231, "post_id": 58759535, "comment_id": 103825460, "body": "<code>new-install</code> and <code>install</code> are the same on sufficiently new versions of <code>cabal</code> so I shouldn&#39;t have mentioned it.  Consequences:  GHC and cabal uses an environment to keep a list of packages you have &quot;exposed&quot; - these packages must not conflict (no duplicate packages with different versions).  When you <code>cabal install</code> you are saying &quot;install this library and expose it in my default environment&quot;. Something you already installed uses a package with a different version than what you want to install now.  Because GHC envs are pointers to builds it is reasonable to rm the env as desired."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 1, "last_activity_date": 1573180543, "last_edit_date": 1573180543, "creation_date": 1573179927, "answer_id": 58759535, "question_id": 58755666, "link": "https://stackoverflow.com/questions/58755666/haskell-install-puremd5-package/58759535#58759535", "title": "Haskell: Install pureMD5 package", "body": "<p>This is a cabal issue unrelated to pureMD5 (I believe).  You can try to install with a different environment as:</p>\n\n<pre><code>cabal new-install --package-env=SomeNewEnv --lib pureMD5\n</code></pre>\n\n<p>And that should work.  But why? well the environment you currently have installed packages into looks something like this:</p>\n\n<pre><code>cat ~/.ghc/x86_64-darwin-8.6.4/environments/default | tail\npackage-id rts\npackage-id terminfo-0.4.1.2\npackage-id transformers-0.5.6.2\npackage-id deepseq-1.4.4.0\npackage-id ghc-boot-th-8.6.4\npackage-id pretty-1.1.3.6\npackage-id template-haskell-2.14.0.0\npackage-id directory-1.3.3.0\npackage-id txt-1.2.4.0-09ee5c37\npackage-id mtl-2.2.2\n</code></pre>\n\n<p>So you see it fixes a particular package version - for you it probably keeps process-1.6.5.0.  If you remove this file then the attempted install of process-1.6.6.0 will succeed and the install will work without the <code>--package-env</code>.</p>\n\n<p>Again, this is a guess based on the error and what I think your system state is - please do test and report back.</p>\n\n<p>EDIT: For the curious the bug is <a href=\"https://github.com/haskell/cabal/issues/5559\" rel=\"nofollow noreferrer\">https://github.com/haskell/cabal/issues/5559</a></p>\n"}], "owner": {"reputation": 101, "user_id": 3712238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U0sEu.png?s=128&g=1", "display_name": "bfosterscripps", "link": "https://stackoverflow.com/users/3712238/bfosterscripps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 58759535, "answer_count": 1, "score": 2, "last_activity_date": 1573180543, "creation_date": 1573154858, "last_edit_date": 1573155704, "question_id": 58755666, "link": "https://stackoverflow.com/questions/58755666/haskell-install-puremd5-package", "title": "Haskell: Install pureMD5 package", "body": "<p>I am trying to tell whether two files are likely the same, and found I could make a MD5 hash in Haskell from this StackOverflow thread: <a href=\"https://stackoverflow.com/questions/30536583/compute-md5-digest-of-file-in-haskell\">Compute MD5 digest of file in Haskell</a></p>\n\n<p>When I try to install <a href=\"https://hackage.haskell.org/package/pureMD5\" rel=\"nofollow noreferrer\">pureMD5</a>, I get an error:</p>\n\n<pre><code>$ cabal install --lib pureMD5\nResolving dependencies...\ncabal: Could not resolve dependencies:\n[__0] trying: base-4.12.0.0/installed-4.1... (user goal)\n[__1] trying: ghc-8.6.5/installed-8.6... (user goal)\n[__2] next goal: process (user goal)\n[__2] rejecting: process-1.6.6.0 (conflict: ghc =&gt;\nprocess==1.6.5.0/installed-1.6...)\n[__2] rejecting: process-1.6.5.1, process-1.6.5.0/installed-1.6...,\nprocess-1.6.5.0, process-1.6.4.0, process-1.6.3.0, process-1.6.2.0,\nprocess-1.6.1.0, process-1.6.0.0, process-1.5.0.0, process-1.4.3.0,\nprocess-1.4.2.0, process-1.4.1.0, process-1.4.0.0, process-1.3.0.0,\nprocess-1.2.3.0, process-1.2.2.0, process-1.2.1.0, process-1.2.0.0,\nprocess-1.1.0.2, process-1.1.0.1, process-1.1.0.0, process-1.0.1.5,\nprocess-1.0.1.4, process-1.0.1.3, process-1.0.1.2, process-1.0.1.1,\nprocess-1.0.0.0 (constraint from user target requires ==1.6.6.0)\n[__2] fail (backjumping, conflict set: ghc, process)\nAfter searching the rest of the dependency tree exhaustively, these were the\ngoals I've had most trouble fulfilling: process, base, ghc\n</code></pre>\n\n<p>I am not sure where to go from here, I'm new to Haskell. </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 8609723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0bqlb.jpg?s=128&g=1", "display_name": "sodapunk", "link": "https://stackoverflow.com/users/8609723/sodapunk"}, "edited": false, "score": 0, "creation_date": 1574290239, "post_id": 58933554, "comment_id": 104184226, "body": "Hi! Thank you for your answer, but I did indeed want to remove pairs. I will update the examples in the question :) What I ended up doing was converting to binary and then maping XOR to the transposed list. This ended up working for what I needed it for, but I am still lost as to how I can do this more generally. So i will keep the question open, in hopes that someone knows :)"}, {"owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "reply_to_user": {"reputation": 57, "user_id": 8609723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0bqlb.jpg?s=128&g=1", "display_name": "sodapunk", "link": "https://stackoverflow.com/users/8609723/sodapunk"}, "edited": false, "score": 0, "creation_date": 1574295206, "post_id": 58933554, "comment_id": 104185656, "body": "I think I have figured it out though I am curious if the code is legible."}, {"owner": {"reputation": 57, "user_id": 8609723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0bqlb.jpg?s=128&g=1", "display_name": "sodapunk", "link": "https://stackoverflow.com/users/8609723/sodapunk"}, "edited": false, "score": 1, "creation_date": 1574297575, "post_id": 58933554, "comment_id": 104186231, "body": "Yes this works! I think I get what your functions do, altough I am not well-versed in haskell so the finer details might be lost to me :)  It seems like you solved my main problem when trying to figure out this problem, which was how to keep track of what sub-list have and have not been checked for elem x, and then removing that element from the right index of that sublist. My code quickly turned into an  unreadable mess! Your logic seems a lot more readable to me. Thank you!"}], "tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": true, "score": 1, "last_activity_date": 1574295179, "last_edit_date": 1574295179, "creation_date": 1574164524, "answer_id": 58933554, "question_id": 58755144, "link": "https://stackoverflow.com/questions/58755144/remove-pairs-of-ints-from-a-list-of-lists-while-keeping-the-original-order-ha/58933554#58933554", "title": "Remove pairs of Ints from a list of lists, while keeping the original order - Haskell", "body": "<h2>Correct Response</h2>\n\n<p>I tried to solve it in a Haskell-y way, but this code has horrible performance and is hard to read. I just wanted to see if I could solve the problem.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.List (elemIndices)\n\nappendHead :: a -&gt; [[a]] -&gt; [[a]]\nappendHead x [] = [[x]]\nappendHead x (ys:yss) = (x:ys):yss\n\n-- | count how many time an element occurs in a list of lists\ncount :: Eq a =&gt; a -&gt; [[a]] -&gt; Int\ncount _ [] = 0\ncount x (ys:yss) = (length $ elemIndices x ys) + count x yss\n\n-- | assume count is 1 or greater for simplicity\nrmAllButLast :: Int -&gt; Int -&gt; [[Int]] -&gt; [[Int]]\nrmAllButLast x xCount yss =  \n  if xCount == 0\n  then yss\n  else\n    let protectLastElement cond = if even xCount then cond else True in\n    snd $\n    foldl\n    (\\(xIndex,acc) ys -&gt;\n        (\\y -&gt; acc++[y]) &lt;$&gt; foldl\n        (\\(xIndex,acc) y -&gt;\n           if protectLastElement (xIndex &lt; xCount-1) &amp;&amp; x == y\n           then (xIndex+1, acc)\n             else (xIndex, acc++[y]))\n        (xIndex, [])\n        ys\n    )\n    (0, [])\n    yss\n\nrmPairs :: [[Int]] -&gt; [[Int]]\nrmPairs [] = []\nrmPairs ([]:yss) = [] : rmPairs yss\nrmPairs ((x:xs):yss) =\n  let xCount = count x (xs:yss) in\n  if xCount == 0\n  then appendHead x $ rmPairs (xs:yss)\n  else rmPairs $ rmAllButLast x xCount (xs:yss)\n\n</code></pre>\n\n<h2>Old Response</h2>\n\n<p>Edit: the code below is not what the author wanted, but I will leave it so the comment below makes sense.</p>\n\n<p>I am not 100% if you want to remove duplicates (anything that occurs once or more would be reduced to one value) or actual pairs (there is two of this value so remove both of them, if there is an even number of x, then they will all be removed, if it is odd value of x then there will be one). Assuming the former and  with no consideration for performance:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>remPair :: [[Int]] -&gt; [[Int]]\nremPair []       = []\nremPair ([]:yss) = [] : remPair yss\nremPair (xs:yss) = remPairFromFlat xs : remPair yss\n  where\n    flatYss = concat yss\n    remPairFromFlat []     = []\n    remPairFromFlat (z:zs) =\n      let flat = zs ++ flatYss in\n      if z `elem` flat\n      then remPairFromFlat zs\n      else z : remPairFromFlat zs\n</code></pre>\n\n<p><code>remPair</code> iterates over the list of lists. If the first list is not empty, it flattens out the rest of the list then iterates through the elements of <code>xs</code> and creates a local flat list of <code>ys</code> and the tail of <code>xs</code>.</p>\n"}], "owner": {"reputation": 57, "user_id": 8609723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0bqlb.jpg?s=128&g=1", "display_name": "sodapunk", "link": "https://stackoverflow.com/users/8609723/sodapunk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 58933554, "answer_count": 1, "score": 3, "last_activity_date": 1574295179, "creation_date": 1573152300, "last_edit_date": 1574290482, "question_id": 58755144, "link": "https://stackoverflow.com/questions/58755144/remove-pairs-of-ints-from-a-list-of-lists-while-keeping-the-original-order-ha", "title": "Remove pairs of Ints from a list of lists, while keeping the original order - Haskell", "body": "<p>I have been struggling to remove duplicates from a list of list, while keeping the original position of the remainders and empty lists. Let's say: </p>\n\n<pre><code>list1 = [[1],[2],[1,2],[4],[1,4]]\nlist2 =[[1],[2],[1,2],[4],[1,4],[2,4]]\nlist3 = [[1,2,4],[1,4],[2,4],[1,4],[1,2,4]]\n</code></pre>\n\n<p>Then the output should be:</p>\n\n<pre><code>[[],[],[],[],[1]]\n\n[[],[],[],[],[1],[2,4]]\n\n[[],[],[,],[],[2,4]]\n</code></pre>\n\n<p>(which pairs get removed is not important)</p>\n\n<p>However, I can only get this to work if i first flatten the list, but then i lose the original position of the empty lists. If anyone has any idea how I can go about solving this I would be gratefull! </p>\n\n<p>The code is messy, but works for flat list:</p>\n\n<pre><code>remPair [] = []\nremPair (x:xs) = if elem x xs then\n                    let\n                      n = elemIndices x xs\n                      (ys, zs) = splitAt (head n) xs\n                      in remPair (ys ++ (drop 1 zs))\n                  else  [x] ++ remPair xs\n</code></pre>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1573150940, "creation_date": 1573150940, "answer_id": 58754862, "question_id": 58754652, "link": "https://stackoverflow.com/questions/58754652/how-do-i-list-enabled-language-extensions-from-within-ghci/58754862#58754862", "title": "How do I list enabled language extensions from within GHCI?", "body": "<pre><code>&gt; :show language\nbase language is: Haskell2010\nwith the following modifiers:\n  -XNoDatatypeContexts\n  -XExplicitForAll\n  -XNondecreasingIndentation\n  -XPatternSignatures\n  -XScopedTypeVariables\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 6201321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c242917680bffd3a50af4ae0f1b6c1d?s=128&d=identicon&r=PG", "display_name": "jbweston", "link": "https://stackoverflow.com/users/6201321/jbweston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 58754862, "answer_count": 1, "score": 3, "last_activity_date": 1573150940, "creation_date": 1573149867, "question_id": 58754652, "link": "https://stackoverflow.com/questions/58754652/how-do-i-list-enabled-language-extensions-from-within-ghci", "title": "How do I list enabled language extensions from within GHCI?", "body": "<p>I know that I am able to <em>set</em> language extensions with</p>\n\n<pre><code>:set  -XWhateverExtension\n</code></pre>\n\n<p>but how do I <em>list</em> the extensions that are currently enabled?</p>\n"}, {"tags": ["http", "haskell", "ghc"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1573148596, "post_id": 58754127, "comment_id": 103796449, "body": "You appear to simply be missing the packages that define those modules; they need to be installed."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1573148825, "post_id": 58754127, "comment_id": 103796527, "body": "You almost certainly don&#39;t need the package name in the <code>import</code> statement: &quot;You probably don\u2019t need to use this feature, it was added mainly so that we can build backwards-compatible versions of packages when APIs change.&quot;"}, {"owner": {"reputation": 101, "user_id": 3712238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U0sEu.png?s=128&g=1", "display_name": "bfosterscripps", "link": "https://stackoverflow.com/users/3712238/bfosterscripps"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573149269, "post_id": 58754127, "comment_id": 103796710, "body": "@chepner Do you mean the &quot;HTTP&quot; isn&#39;t necessary in <code>import &quot;HTTP&quot; Network.HTTP</code>, that it could just be <code>import Network.HTTP</code>?  Also, how do I install these packages? I know you use cabal, but how do you know which package is missing? Should I try <code>cabal install --lib http</code>?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1573149410, "post_id": 58754127, "comment_id": 103796777, "body": "Unless you have <code>Network.URL</code> in both the HTTP and url packages, GHC is smart enough to find the correct package."}, {"owner": {"reputation": 101, "user_id": 3712238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U0sEu.png?s=128&g=1", "display_name": "bfosterscripps", "link": "https://stackoverflow.com/users/3712238/bfosterscripps"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573149508, "post_id": 58754127, "comment_id": 103796817, "body": "I am trying <code>cabal install --lib network</code> now ... I removed <code>&quot;HTTP&quot;</code> and other package names from the imports."}, {"owner": {"reputation": 101, "user_id": 3712238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U0sEu.png?s=128&g=1", "display_name": "bfosterscripps", "link": "https://stackoverflow.com/users/3712238/bfosterscripps"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573149759, "post_id": 58754127, "comment_id": 103796911, "body": "@chepner OK, I finished installing <code>network</code>, I still get errors like <code>Could not find module \u2018Network.Stream\u2019</code> and <code>Could not find module \u2018Network.HTTP\u2019</code>..."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 0, "creation_date": 1573251388, "post_id": 58754127, "comment_id": 103834828, "body": "I would use stack. It will save you trouble now and in the future."}], "owner": {"reputation": 101, "user_id": 3712238, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U0sEu.png?s=128&g=1", "display_name": "bfosterscripps", "link": "https://stackoverflow.com/users/3712238/bfosterscripps"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 664, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1573148617, "creation_date": 1573147685, "last_edit_date": 1573148617, "question_id": 58754127, "link": "https://stackoverflow.com/questions/58754127/haskell-could-not-find-module-network-http", "title": "Haskell: Could not find module \u2018Network.HTTP\u2019", "body": "<p>I am trying to write a simple script that takes as input a URL (or set of URLs) and as output it downloads the contents of that page to a file (in particular I am trying to download hundreds of JSON files, which ultimately I wish to diff against other JSON files). </p>\n\n<p>In a file, <code>download.hs</code>, I have <code>import \"HTTP\" Network.HTTP</code>. </p>\n\n<p>When I run: <code>$ ghc -o download download.hs</code></p>\n\n<p>I get the following error:</p>\n\n<pre><code>download.hs:24:1: error:\n    Could not find module \u2018Network.HTTP\u2019\n    Perhaps you meant Network.TLS (needs flag -package-key tls-1.5.2)\n   |\n24 | import \"HTTP\" Network.HTTP\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n</code></pre>\n\n<p>My GHC version is:</p>\n\n<pre><code>$ ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 8.6.5\n</code></pre>\n\n<p>I also get errors like:</p>\n\n<pre><code>download.hs:22:1: error:\n    Could not load module \u2018Control.Concurrent.Async\u2019\n    It is a member of the hidden package \u2018async-2.2.2\u2019.\n    You can run \u2018:set -package async\u2019 to expose it.\n    (Note: this unloads all the modules in the current scope.)\n   |\n22 | import \"async\" Control.Concurrent.Async (mapConcurrently)\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n</code></pre>\n\n<p>I think it's possible there have been breaking changes between the ghc versions, and the examples I am finding online to start with may be outdated. </p>\n\n<p>Any pointers on doing started with Haskell, and particularly easy ways to download and diff JSON files in Haskell?</p>\n\n<p>I have been following this example: <a href=\"https://stackoverflow.com/questions/14323265/running-parallel-url-downloads-in-haskell\">Running parallel URL downloads in Haskell</a>, this is where I got the code that is erroring now.  </p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1573146227, "post_id": 58753545, "comment_id": 103795281, "body": "What do you want to do with the monad?"}, {"owner": {"reputation": 421, "user_id": 9184899, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/VPMya.jpg?s=128&g=1", "display_name": "Stefan Dorn", "link": "https://stackoverflow.com/users/9184899/stefan-dorn"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1573146308, "post_id": 58753545, "comment_id": 103795325, "body": "Nothing, just reading a chapter about monads in a book and trying to understand how they work. Pure learning exercise."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 9, "creation_date": 1573151082, "post_id": 58753545, "comment_id": 103797471, "body": "Hint: <code>Pair a</code> is isomorphic to <code>Bool -&gt; a</code>, and the latter has a very well-known <code>Monad</code> instance."}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 7, "creation_date": 1573146166, "post_id": 58753620, "comment_id": 103795241, "body": "There&#39;s nothing wrong with losing some of the data as far as monad laws go."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 0, "last_activity_date": 1573145827, "creation_date": 1573145827, "answer_id": 58753620, "question_id": 58753545, "link": "https://stackoverflow.com/questions/58753545/how-to-write-a-monad-instance-for-a-pair-where-both-arguments-have-the-same-type/58753620#58753620", "title": "How to write a monad instance for a pair where both arguments have the same type?", "body": "<p>A Monad instance may not place any constraints on the type of data it contains (the <code>a</code> here). It must treat that data as fully opaque. I don't think your <code>Pair</code> type admits a Monad instance (or Applicative), because there is no way to turn a pair of pairs into a single pair without either losing some of the data, or using it in some way not permitted by the typeclass definition.</p>\n"}, {"comments": [{"owner": {"reputation": 421, "user_id": 9184899, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/VPMya.jpg?s=128&g=1", "display_name": "Stefan Dorn", "link": "https://stackoverflow.com/users/9184899/stefan-dorn"}, "edited": false, "score": 0, "creation_date": 1573147200, "post_id": 58753975, "comment_id": 103795787, "body": "could you write some sketch here?"}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 3, "last_activity_date": 1573147251, "last_edit_date": 1573147251, "creation_date": 1573147122, "answer_id": 58753975, "question_id": 58753545, "link": "https://stackoverflow.com/questions/58753545/how-to-write-a-monad-instance-for-a-pair-where-both-arguments-have-the-same-type/58753975#58753975", "title": "How to write a monad instance for a pair where both arguments have the same type?", "body": "<p>It is possible to make <code>Pair</code> into <code>Monad</code> by having <code>join</code> that takes the diagonal.of the 2\u00d72 square. <code>return</code> has no other choice but replicate its argument. This turns <code>Pair</code> into essentially a fixed length <code>ZipList</code>.</p>\n\n<p>Of course this definition of <code>join</code> discards some data. This may or may not be important.</p>\n"}, {"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 4, "creation_date": 1573149856, "post_id": 58753984, "comment_id": 103796952, "body": "Check the laws!"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1573150097, "post_id": 58753984, "comment_id": 103797038, "body": "Yes, <code>Pair a&#39; b&#39;&#39;</code> is the correct one. See my answer for more details. <a href=\"https://stackoverflow.com/a/58754645/783743\">stackoverflow.com/a/58754645/783743</a>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1573150354, "post_id": 58753984, "comment_id": 103797154, "body": "@AaditMShah why you have to spoil the ending like that"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1573150390, "post_id": 58753984, "comment_id": 103797169, "body": "So bad... you have to let people think"}], "tags": [], "owner": {"reputation": 2623, "user_id": 9271266, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P2K9ibxquX4/AAAAAAAAAAI/AAAAAAAAABU/Jq4JVvo766Q/photo.jpg?sz=128", "display_name": "lsmor", "link": "https://stackoverflow.com/users/9271266/lsmor"}, "is_accepted": false, "score": 4, "last_activity_date": 1573151558, "last_edit_date": 1573151558, "creation_date": 1573147151, "answer_id": 58753984, "question_id": 58753545, "link": "https://stackoverflow.com/questions/58753545/how-to-write-a-monad-instance-for-a-pair-where-both-arguments-have-the-same-type/58753984#58753984", "title": "How to write a monad instance for a pair where both arguments have the same type?", "body": "<p>Functor and applicative instances are easy. The monad instance has taken a while to me.</p>\n\n<pre><code>data Pair a = Pair a a deriving (Eq, Show)\n\ninstance Functor Pair where \n  fmap f (Pair a b) = Pair (f a) (f b)\n\ninstance Applicative Pair where \n  pure a = Pair a a\n  (Pair f g) &lt;*&gt; (Pair a b) = Pair (f a) (g b)\n\ninstance Monad Pair where \n  return = pure\n  (Pair a b) &gt;&gt;= f = let Pair a' _ = f a \n                         Pair _ b' = f b\n                     in  Pair a' b'\n</code></pre>\n\n<p>The way I've come to this solution is by applying the monad laws. Easily you can check with an example that identity law doesn't hold if you take <code>Pair a' a''</code> or <code>Pair b' b''</code> or <code>Pair a' b'</code> nor <code>Pair a'' b''</code>. So the only solutions must be in the diagonals. Defining </p>\n\n<pre><code>(m &gt;&gt;= f) = Pair (first . f . first $ m) (second . f . second $ m)\n</code></pre>\n\n<p>where <code>first</code> and <code>second</code> are the obvious ones, you can proof all of the laws.</p>\n"}, {"comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1602033888, "post_id": 58754645, "comment_id": 113589696, "body": "@dfeuer Updated my answer to prove uniqueness using the monad instance laws."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1602040297, "post_id": 58754645, "comment_id": 113590898, "body": "You seem to appeal implicitly to parametricity. I imagine this is unavoidable?"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1602063849, "post_id": 58754645, "comment_id": 113598924, "body": "I&#39;m not sure what you mean."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1602068516, "post_id": 58754645, "comment_id": 113601071, "body": "Your proof begins with (and hinges critically on) the definition <code>return x = Pair x x</code>. This is the only sensible definition in Haskell -- but only because of parametricity. In a non-parametric context, one might wonder whether <code>return 0 = Pair 1 2; return x = Pair x x</code> might be a possible choice, say."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1602131950, "post_id": 58754645, "comment_id": 113624675, "body": "@DanielWagner I can&#39;t prove my intuition but I believe that a non-parametric monad instance of <code>Pair</code> would not be able to satisfy all the monad laws. Consider the expression <code>(m &gt;&gt;= k) &gt;&gt;= h</code>. If <code>m &gt;&gt;= k</code> evaluates to <code>return x</code> for some <code>x</code> then the entire expression should evaluate to <code>k x</code> because of the left identity law. However, if <code>return x</code> is not <code>Pair x x</code> then <code>m &gt;&gt;= (\\x -&gt; k x &gt;&gt;= h)</code> could evaluate to something other than <code>k x</code>. Hence, it would violate the associativity law. However, I don&#39;t know how to prove this hypothesis. Here&#39;s a code example. <a href=\"https://jsfiddle.net/zf0eL9jk/\" rel=\"nofollow noreferrer\">jsfiddle.net/zf0eL9jk</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1602140781, "post_id": 58754645, "comment_id": 113627262, "body": "@AaditMShah I suspect both standalone instances of <code>k x</code> in your text were intended to be <code>h x</code>, right? If so, then I think there&#39;s still quite a lot of holes in your argument, it seems to me -- we are asking if a lawful non-parametric definition exists, but all you appear to have argued is that an unlawful non-parametric definition exists."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1602147183, "post_id": 58754645, "comment_id": 113630074, "body": "@DanielWagner Yes, good catch. It was supposed to be <code>h x</code>."}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 13, "last_activity_date": 1615483055, "last_edit_date": 1615483055, "creation_date": 1573149854, "answer_id": 58754645, "question_id": 58753545, "link": "https://stackoverflow.com/questions/58753545/how-to-write-a-monad-instance-for-a-pair-where-both-arguments-have-the-same-type/58754645#58754645", "title": "How to write a monad instance for a pair where both arguments have the same type?", "body": "<p>Actually, the only correct monad instance of <code>Pair</code> is as follows.</p>\n<pre class=\"lang-hs prettyprint-override\"><code>instance Monad Pair where\n    m &gt;&gt;= f = joinPair (f &lt;$&gt; m)\n\njoinPair :: Pair (Pair a) -&gt; Pair a\njoinPair (Pair (Pair x _) (Pair _ y)) = Pair x y\n</code></pre>\n<p>The reason this is the correct monad instance is because <code>Pair</code> is a <a href=\"https://bartoszmilewski.com/2015/07/29/representable-functors/\" rel=\"nofollow noreferrer\">representable functor</a>.</p>\n<pre class=\"lang-hs prettyprint-override\"><code>instance Representable Pair where\n    type Rep Pair = Bool\n\n    index (Pair x _) False = x\n    index (Pair _ y) True  = y\n\n    tabulate f = Pair (f False) (f True)\n</code></pre>\n<p>Turns out, for every representable functor <code>(&gt;&gt;=)</code> is equivalent to the following <a href=\"http://hackage.haskell.org/package/representable-functors-3.2.0.2/docs/Data-Functor-Representable.html#g:8\" rel=\"nofollow noreferrer\"><code>bindRep</code></a> function.</p>\n<pre class=\"lang-hs prettyprint-override\"><code>bindRep :: Representable f =&gt; f a -&gt; (a -&gt; f b) -&gt; f b\nbindRep m f = tabulate (\\a -&gt; index (f (index m a)) a)\n</code></pre>\n<p>If we specialize the <code>bindRep</code> function to <code>Pair</code> we get the following.</p>\n<pre class=\"lang-hs prettyprint-override\"><code>bindRep :: Pair a -&gt; (a -&gt; Pair b) -&gt; Pair b\nbindRep (Pair x y) f = tabulate (\\a -&gt; index (f (index (Pair x y) a)) a)\n                     = Pair (index (f x) False) (index (f y) True)\n--                          |_________________| |________________|\n--                                   |                   |\n--                           (1st elem of f x)   (2nd elem of f y)\n</code></pre>\n<p>The following blog post by Adelbert Chang explains it better. <a href=\"https://www.adelbertc.com/representable-functors/\" rel=\"nofollow noreferrer\">Reasoning with representable functors</a>.</p>\n<hr />\n<p>Here's another way to prove uniqueness. Consider the left and right identity monad instance laws.</p>\n<pre class=\"lang-hs prettyprint-override\"><code>return a &gt;&gt;= k = k a -- left identity law\n\nm &gt;&gt;= return = m     -- right identity law\n</code></pre>\n<p>Now, for the <code>Pair</code> data type <code>return x = Pair x x</code>. Hence, we can specialize these laws.</p>\n<pre class=\"lang-hs prettyprint-override\"><code>Pair a a &gt;&gt;= k = k a     -- left identity law\n\nm &gt;&gt;= \\x -&gt; Pair x x = m -- right identity law\n</code></pre>\n<p>So, what should the definition of <code>&gt;&gt;=</code> be in order to satisfy these two laws?</p>\n<pre class=\"lang-hs prettyprint-override\"><code>Pair x y &gt;&gt;= f = Pair (oneOf [x1, x2, y1, y2]) (oneOf [x1, x2, y1, y2])\n    where Pair x1 y1 = f x\n          Pair x2 y2 = f y\n</code></pre>\n<p>The <code>oneOf</code> function returns one of the elements of the list non-deterministically.</p>\n<p>Now, if our <code>&gt;&gt;=</code> function is to satisfy the left identity law then when <code>x = y</code> then <code>x1 = x2</code> and <code>y1 = y2</code> and the result must be <code>Pair (oneOf [x1, x2]) (oneOf [y1, y2])</code>.</p>\n<p>Similarly, if our <code>&gt;&gt;=</code> function is to satisfy the right identity law then <code>x1 = y1 = x</code> and <code>x2 = y2 = y</code> and the result must be <code>Pair (oneOf [x1, y1]) (oneOf [x2, y2])</code>.</p>\n<p>Hence, if you want to satisfy both laws then the only valid result is <code>Pair x1 y2</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11283, "user_id": 5825294, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Un5fU.png?s=128&g=1", "display_name": "Enlico", "link": "https://stackoverflow.com/users/5825294/enlico"}, "is_accepted": false, "score": 0, "last_activity_date": 1616256608, "last_edit_date": 1616256608, "creation_date": 1616241161, "answer_id": 66721243, "question_id": 58753545, "link": "https://stackoverflow.com/questions/58753545/how-to-write-a-monad-instance-for-a-pair-where-both-arguments-have-the-same-type/66721243#66721243", "title": "How to write a monad instance for a pair where both arguments have the same type?", "body": "<h2>Why I am answering</h2>\n<p>I was curious to know what the practical usages of the <code>Pair a</code> monad are, especially considering that the only valid implementation of <code>(&gt;&gt;=)</code> actually throws away half of the data, so I asked <a href=\"https://stackoverflow.com/questions/66587591/known-estabilished-usecases-for-the-monad-instance-of-an-homogeneous-pair\">this question</a>.</p>\n<p>It turns out that the <a href=\"https://stackoverflow.com/a/66588610/5825294\">answer I accepted</a> is a very interesting answer to this question too (and was contained in Daniel Wagner's comment under the present question, but I hadn't noticed it), so I will elaborate it a bit here, because I've learned a lot from it.</p>\n<h2>The short answer: <code>(a,a)</code> and <code>Bool -&gt; a</code> are the same thing</h2>\n<p>So the short answer is that the types <code>Pair a</code>, or more simply <code>(a,a)</code>, and <code>Bool -&gt; a</code> are isomorphic: feeding a <code>(a,a)</code> to <code>fst</code>/<code>snd</code> is equivalent to feeding a <code>Bool -&gt; a</code> function with <code>True</code>/<code>False</code> (or <code>False</code>/<code>True</code>, it's just a choice). The two isomorphisms are actually shown in the (deleted) answer from <a href=\"https://stackoverflow.com/users/11143763/zhiltsoff-igor\">Zhiltsoff Igor</a>:</p>\n<blockquote>\n<pre class=\"lang-hs prettyprint-override\"><code>funToPair :: (Bool -&gt; a) -&gt; (a, a)\nfunToPair f = (f True, f False)\n\npairToFun :: (a, a) -&gt; Bool -&gt; a\npairToFun (x, y) True = x\npairToFun (x, y) False = y\n</code></pre>\n</blockquote>\n<p>As a consquence, whichever way <code>Bool -&gt; a</code> is a monad, <code>(a,a)</code>/<code>Pair a</code> is a monad in the same way.</p>\n<h2>But <code>(a,a)</code>'s <code>Monad</code> throws information away... so does <code>Bool -&gt; a</code>!</h2>\n<p>What bugged me at this point was that it's so apparent that the <code>Monad</code> instance for <code>(a,a)</code>/<code>Pair a</code>, thoroughly explained in <a href=\"https://stackoverflow.com/a/58754645/5825294\">Aadit M Shah's answer</a>, throws away data, whereas the <code>Monad</code> instance for <code>Bool -&gt; a</code>... doesn't...?</p>\n<p>Fatally wrong! The <code>Monad</code> instance for <code>r -&gt; a</code> (with generic <code>r</code>, not just <code>Bool</code>) throws away information all the time! How? Let's look at the well known implementation of <code>&gt;&gt;=</code>:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>instance Monad ((-&gt;) r) where\n    f &gt;&gt;= k = \\ r -&gt; k (f r) r\n</code></pre>\n<p>Now remember that a function of type <code>x -&gt; y</code> is equivalent to a tuple of type <code>(y,y,...,y)</code> with as many entries as the number of possible values of type <code>x</code> (<strong><em>not</em></strong> <code>y</code>).</p>\n<p>What about <code>k</code>? <code>k</code> is a binary function, let's say of type <code>x -&gt; y -&gt; z</code>, so it can be fed with the cartesian product of the values that inhabit the type <code>x</code> and those that inhabit the type of <code>y</code>. If <code>x</code> and <code>y</code> are inhabited by <code>m</code> and <code>n</code> values respectively, then <code>k</code> is equivalent to a tuple of type <code>(z,z,...,z)</code> with as many entries as <code>m*n</code>, and that is the information that comes with <code>k</code>.</p>\n<p>Now the question is whether <code>(&gt;&gt;=)</code> makes use of all that information. No, it doesn't! <code>(&gt;&gt;=)</code> is feeding <code>k</code> with only <code>n</code> possible inputs: the second argument <code>r</code> is any value of type <code>x</code>, whereas the first argument is <strong>the single value corresponding to <code>r</code> via <code>f</code></strong>.</p>\n<p>If we think of mathematical functions, we are saying that, for fixed unary function <em>f: A \u2192 B</em> and binary function <em>k: B\u00d7A \u2192 C</em>, <code>f &gt;&gt;= k</code> is the unary function that does <em>t \u2208 A \u2192 k(f(t),t) \u2208 C</em>, i.e. it's a restriction of <em>k</em> to the curve parametrized by the equations <em>x = f(t)</em> and <em>y = t</em>.</p>\n<p>Going back to <code>Bool -&gt; a</code>, the signature of <code>(&gt;&gt;=)</code> specilizes to</p>\n<pre class=\"lang-hs prettyprint-override\"><code>(&gt;&gt;=) :: (Bool -&gt; a) -&gt; (a -&gt; Bool -&gt; b) -&gt; Bool -&gt; b\nf &gt;&gt;= k = \\r -&gt; k (f r) r\n</code></pre>\n<p>which we can rewrite as follows, just to make the obvious more apparent:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>(&gt;&gt;=) f k r\n  | r == True  = k (f True)  True\n  | r == False = k (f False) False\n-- remember this\n</code></pre>\n<p>What's obvious in the above? If we feed <code>f &gt;&gt;= k</code> with <code>True</code>, we'll only use <code>f True</code>, thus throwing away the other half of the data, <code>f False</code>. Similarly, if we call <code>(f &gt;&gt;= k) False</code>, we throw away whatever <code>f True</code> is. This way of throwing away half of the information contained in <code>k</code> mirrors exactly what is throw away via the <code>_</code> placeholders for <code>(a,a)</code> aka <code>Pair a</code> (adaptation from <a href=\"https://stackoverflow.com/a/58753984/5825294\">Ismor's answer</a>):</p>\n<pre class=\"lang-hs prettyprint-override\"><code>instance Monad Pair where \n  return = pure\n  (Pair a b) &gt;&gt;= k = let Pair a' _  = k a\n                         Pair _  b' = k b\n                     in  Pair a' b'\n</code></pre>\n<p>Indeed, if we define <code>fst' (Pair a _) = a</code> and <code>snd' (Pair _ b) = b</code> (these are mirroring <code>fst</code> and <code>snd</code> for <code>(,)</code>), then <code>(&gt;&gt;=)</code> can be written simply as follows</p>\n<pre class=\"lang-hs prettyprint-override\"><code>(&gt;&gt;=) :: Pair a -&gt; (a -&gt; Pair b) -&gt; Pair b\np &gt;&gt;= k = (fst' (k (fst' p)),\n           snd' (k (snd' p)))\n</code></pre>\n<p>Which is in my opinion strikingly similar to the code I marked with <code>-- remember this</code>, with <code>fst'</code> mirrors <code>True</code> and <code>snd'</code> mirrors <code>False</code>.</p>\n<p>By the way, for the following, let's take note of the type of <code>(&gt;&gt;=)</code> in the case we were allowed to write it for <code>(a,a)</code>:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>(&gt;&gt;=) :: (a,a) -&gt; (a -&gt; (b,b)) -&gt; (b,b)\n</code></pre>\n<h2>What about <code>(a,b)</code> when <code>a</code> and <code>b</code> are the same type?</h2>\n<p>This was the last doubt I had: <em>since <a href=\"https://hackage.haskell.org/package/base-4.14.1.0/docs/src/GHC.Base.html#line-452\" rel=\"nofollow noreferrer\"><code>(a,b)</code> is a <code>Monad</code> in <code>b</code> provided <code>a</code> is a <code>Monoid</code></a>, in the special case that the type <code>b</code> is equal to the type <code>a</code> (and <code>b</code> has to be a <code>Monoid</code>), do we get the same instance as above?</em></p>\n<p>No, the question above is ill-posed, the flaw being in the part <em>&quot;in the special case that the type <code>b</code> is equal to the type <code>a</code>&quot;</em>. This hypothesis is simply not possible because for a type constructor to be a <code>Monad</code>, it has to have one and only one free type parameter:</p>\n<ul>\n<li><code>(a,b)</code> is made a <code>Monad</code> in the free parameter <code>b</code>, meaning that <code>b</code> will be allowed to vary according to the second argument to <code>(&gt;&gt;=)</code>, whereas the type <code>a</code> will stay the same through the <code>(&gt;&gt;=)</code> operator;</li>\n<li><code>(a,a)</code> is made a <code>Monad</code> in the free parameter <code>a</code>, meaning that <code>a</code> will be allowed to vary according to the second argument to <code>(&gt;&gt;=)</code>, whereas... nothing, that's it, all explained in the previous part of the answer.</li>\n</ul>\n"}], "owner": {"reputation": 421, "user_id": 9184899, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/VPMya.jpg?s=128&g=1", "display_name": "Stefan Dorn", "link": "https://stackoverflow.com/users/9184899/stefan-dorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 2, "accepted_answer_id": 58754645, "answer_count": 5, "score": 8, "last_activity_date": 1616256791, "creation_date": 1573145529, "last_edit_date": 1616256791, "question_id": 58753545, "link": "https://stackoverflow.com/questions/58753545/how-to-write-a-monad-instance-for-a-pair-where-both-arguments-have-the-same-type", "title": "How to write a monad instance for a pair where both arguments have the same type?", "body": "<p>Suppose I have a type <code>Pair</code>:</p>\n<pre><code>data Pair a = Pair a a\n</code></pre>\n<p>What is the right way to write a monad instance for it? My idea is roughly this:</p>\n<pre><code>instance Semigroup a =&gt; Semigroup (Pair a) where\n  Pair a1 a2 &lt;&gt; Pair b1 b2 = Pair (a1 &lt;&gt; b1)(a2 &lt;&gt; b2)\n\ninstance Monad Pair where\n  return = pure\n  (Pair a b) &gt;&gt;= f = f a &lt;&gt; f b\n</code></pre>\n<p>Is it correct? If so then where to specify that <code>b</code>-type in the <code>Pair b</code> is a semigroup?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1573144017, "post_id": 58753025, "comment_id": 103794081, "body": "Hint: what do you need to do to get the function <code>show&#39; :: a -&gt; String; show&#39; = show</code> to compile? (Hint to hint: what is the signature to <code>show</code>? (Hint to hint to hint: GHCi has a <code>:t</code> command to look up the type of something, or alternatively <a href=\"https://hoogle.haskell.org/?hoogle=show\" rel=\"nofollow noreferrer\">Hoogle will show it</a> to you.))"}, {"owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 0, "creation_date": 1573144335, "post_id": 58753025, "comment_id": 103794258, "body": "You may start with writing a <code>Read</code> type class instance for your <code>MathExpr a</code> type."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "edited": false, "score": 2, "creation_date": 1573144533, "post_id": 58753025, "comment_id": 103794359, "body": "@Redu no need, GHC can derive that (and does already, in the OP)."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 2, "creation_date": 1573145715, "post_id": 58753025, "comment_id": 103794990, "body": "It may be worth pointing out that you don&#39;t need to define a new function.  The expression <code>read &quot;Sum (Coef 1) (Coef 2)&quot; :: MathExpr Int</code> works directly, and when GHC can infer the type (which will usually be the case in a realistic program), you can drop the type annotation <code>:: MathExpr Int</code>."}], "answers": [{"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": true, "score": 4, "last_activity_date": 1573145012, "creation_date": 1573145012, "answer_id": 58753394, "question_id": 58753025, "link": "https://stackoverflow.com/questions/58753025/how-to-convert-a-string-to-an-enumerated-data-type-in-haskell/58753394#58753394", "title": "How to convert a String to an Enumerated Data Type in Haskell?", "body": "<p>The problem is simply that your proposed type signature is too general. The derived instance of <code>Read</code> for <code>MathExpr a</code> only works when there is already an instance of <code>Read</code> for <code>a</code>. That is, if you were to write out the instance yourself it would start:</p>\n\n<pre><code>instance (Read a) =&gt; Read (MathExpr a) where ...\n</code></pre>\n\n<p>I don't imagine that in practice you will wish to read values of type <code>MathExpr a</code> for types <code>a</code> which aren't themselves instances of <code>Read</code>, so the fix is simply to add the necessary type-class constraint to the signature:</p>\n\n<pre><code>readMathExpr :: (Read a) =&gt; String -&gt; MathExpr a\nreadMathExpr = read\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 12338839, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/198d1e66d5cae97c135a609f39441fc5?s=128&d=identicon&r=PG&f=1", "display_name": "KrabbyPatty", "link": "https://stackoverflow.com/users/12338839/krabbypatty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 58753394, "answer_count": 1, "score": 0, "last_activity_date": 1573145012, "creation_date": 1573143856, "question_id": 58753025, "link": "https://stackoverflow.com/questions/58753025/how-to-convert-a-string-to-an-enumerated-data-type-in-haskell", "title": "How to convert a String to an Enumerated Data Type in Haskell?", "body": "<p>I have an enumerated data type that looks like such: </p>\n\n<pre><code>data MathExpr a = X\n               | Coef a\n               | Sum (MathExpr a) (MathExpr a)\n               | Prod (MathExpr a) (MathExpr a)\n               | Quot (MathExpr a) (MathExpr a)\n               | Exp (MathExpr a)\n               | Log (MathExpr a)\n                 deriving (Eq,Show,Read)\n</code></pre>\n\n<p>I'm trying to convert a String to this type. I want to use the read function thats available within the prelude. To do so I created another function as such: </p>\n\n<pre><code>readMathExpr :: String -&gt; MathExpr a\nreadMathExpr = read\n</code></pre>\n\n<p>This gives me an error while compiling saying that there is no instance for (Read a) arising from use of 'read'. If anybody could point me in the right direction or link a useful tutorial pertaining to the read function I'd be extremely grateful. Thank you ! </p>\n"}, {"tags": ["haskell", "io", "monads", "function-composition", "io-monad"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1573138006, "post_id": 58750936, "comment_id": 103790550, "body": "Composition is fine, but there&#39;s no shame in using a <code>do</code> block, like <code>do contents &lt;- readFile &quot;quux.txt&quot; ; return (lines contents)</code>. Sure, using <code>fmap</code> or <code>&lt;$&gt;</code> would be more readable, but a <code>do</code> block is not that bad."}, {"owner": {"reputation": 3922, "user_id": 1198582, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/02d3e1025aed5f061c481871986c45b1?s=128&d=identicon&r=PG", "display_name": "Michael Litchard", "link": "https://stackoverflow.com/users/1198582/michael-litchard"}, "edited": false, "score": 1, "creation_date": 1573139614, "post_id": 58750936, "comment_id": 103791522, "body": "I use do notation, and then composition when I want to clean up my code <i>if</i> it improves clarity."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 7, "last_activity_date": 1573141586, "last_edit_date": 1573141586, "creation_date": 1573137508, "answer_id": 58751081, "question_id": 58750936, "link": "https://stackoverflow.com/questions/58750936/function-composition-in-the-io-monad/58751081#58751081", "title": "Function composition in the IO monad", "body": "<p>You can't compose them, at least not with <code>(.)</code> alone. You can use <code>fmap</code> (or its operator version <code>&lt;$&gt;</code>), though:</p>\n\n<pre><code>lines &lt;$&gt; readFile \"quux.txt\"  -- Produces IO [String], not [String]\n</code></pre>\n\n<p>One way to express this in terms of a kind of composition is to first create a Kleisli arrow (a function of type <code>a -&gt; m b</code> for some monad <code>m</code>) from <code>lines</code>:</p>\n\n<pre><code>-- return . lines itself has type Monad m =&gt; String -&gt; m [String]\n-- but for our use case we can restrict the type to the monad\n-- we are actually interested in.\nkleisliLines :: String -&gt; IO [String]\nkleisliLines = return . lines\n</code></pre>\n\n<p>Now you can use the Kleisli composition operator <code>&gt;=&gt;</code> to combine <code>readFile</code> (itself a Kleisli arrow) and <code>lines</code>:</p>\n\n<pre><code>import Control.Monad  -- where (&gt;=&gt;) is defined\n\n-- (&gt;=&gt;) :: Monad m =&gt; (a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c\n-- Here, m ~ IO\n--       a -&gt; FilePath\n--       b -&gt; String\n--       c -&gt; [String]\n(readFile &gt;=&gt; kleisliLines) \"quux.txt\"\n</code></pre>\n\n<p>Compare this with the <code>&gt;&gt;=</code> operator, which requires you to supply the file name to <code>readFile</code> before feeding the result to <code>return . lines</code>:</p>\n\n<pre><code>-- m &gt;&gt;= return . f === fmap f m === f &lt;$&gt; m\nreadFile \"quux.txt\" &gt;&gt;= kleisliLines\n</code></pre>\n\n<p><code>&gt;=&gt;</code> is natural if you are already thinking of a pipeline in terms of <code>&gt;=</code>; if you want something that preserves the order of <code>.</code>, use <code>&lt;=&lt;</code> (also defined in <code>Control.Monad</code>, as <code>(&lt;=&lt;) = flip (&gt;=&gt;)</code>; the operands are simply reversed).</p>\n\n<pre><code>(kleisliLines &lt;=&lt; readFile) \"quux.txt\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 1, "last_activity_date": 1573152882, "last_edit_date": 1573152882, "creation_date": 1573146401, "answer_id": 58753795, "question_id": 58750936, "link": "https://stackoverflow.com/questions/58750936/function-composition-in-the-io-monad/58753795#58753795", "title": "Function composition in the IO monad", "body": "<p>The other answers given so far have been to make <code>lines</code> produce an empty monadic context, and then use monadic composition (<code>&lt;=&lt;</code>) to compose it with <code>readFile</code>. But you can also go the other direction: lift <code>lines</code> to operate through a monadic argument, and then use ordinary composition to combine it with <code>readFile</code>:</p>\n\n<pre><code>(fmap lines . readFile) \"quux.txt\"\n</code></pre>\n\n<p>Of course, if you're going to immediately apply this to an argument, it's simpler to just write</p>\n\n<pre><code>lines &lt;$&gt; readFile \"quux.txt\"\n</code></pre>\n"}], "owner": {"reputation": 4743, "user_id": 1697709, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ce4707be88278549d13843ce0d95fdd9?s=128&d=identicon&r=PG", "display_name": "Gergely", "link": "https://stackoverflow.com/users/1697709/gergely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1573716745, "creation_date": 1573137079, "last_edit_date": 1573716745, "question_id": 58750936, "link": "https://stackoverflow.com/questions/58750936/function-composition-in-the-io-monad", "title": "Function composition in the IO monad", "body": "<p>The <code>lines</code> function in Haskell separates the lines of a string into a string list:</p>\n\n<pre><code>lines :: String -&gt; [String]\n</code></pre>\n\n<p>The <code>readFile</code> function reads a file into a string:</p>\n\n<pre><code>readFile :: FilePath -&gt; IO String\n</code></pre>\n\n<p>Trying to compose these functions to get a list of lines in a file results in a type error:</p>\n\n<pre><code>Prelude&gt; (lines . readFile) \"quux.txt\"\n&lt;interactive&gt;:26:10: error:\n    \u2022 Couldn't match type \u2018IO String\u2019 with \u2018[Char]\u2019\n      Expected type: FilePath -&gt; String\n        Actual type: FilePath -&gt; IO String\n    \u2022 In the second argument of \u2018(.)\u2019, namely \u2018readFile\u2019\n      In the expression: lines . readFile\n      In the expression: (lines . readFile) \"quux.txt\"\n</code></pre>\n\n<p>How can I do the monad trick here?</p>\n"}, {"tags": ["haskell", "testing"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1573136531, "post_id": 58750508, "comment_id": 103789726, "body": "If mocking is part of the grade, your teacher probably should not have let you use Haskell in the first place. The idiomatic approach in Haskell is to use types that don&#39;t require you to mock anything in the first place."}, {"owner": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1573136816, "post_id": 58750508, "comment_id": 103789899, "body": "I know that It would be much easier for me to get a higher grade if I would use Java or Python. But where is the fun in that (=. I dont really care about the grade, as long as i pass the course. I choose Haskell to learn more about Haskell.  Maybe I should try to convince him that mocking isn&#39;t really used in Haskell?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573138466, "post_id": 58750508, "comment_id": 103790822, "body": "You could try anyway, even if it&#39;s not that idiomatic in Haskell. You could rename all the IO actions to use a module like <code>IO.putStrLn &quot;...&quot;</code>, and then <code>import System.IO as IO</code> or <code>import MyMockIO as IO</code> to switch to a custom mock-IO module you can write. I don&#39;t know if that would count as proper &quot;mocking&quot; as your instructor expects. Even if that does not work perfectly well, learning that it&#39;s not a very good idea could still be learning, and you could get credit for that, in theory. Asking your instructor in advance would be a good idea."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573138603, "post_id": 58750508, "comment_id": 103790901, "body": "For very basic mocking, maybe you could even use the <code>pure-io</code> package, if you don&#39;t need very fancy IO. <a href=\"https://hackage.haskell.org/package/pure-io-0.2.1/docs/PureIO.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/pure-io-0.2.1/docs/PureIO.html</a>"}, {"owner": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573147348, "post_id": 58750508, "comment_id": 103795868, "body": "Lets say I create in MyMockIO  IO.getLine = &quot;1+2&quot; Im not sure how this helps me in my testing. I would need getLine to first return &quot;1+2&quot; and then &quot;quit&quot; otherwise we will be stuck in main forever. @chi, but I guess I just dont understand what you mean."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1573148344, "post_id": 58750508, "comment_id": 103796342, "body": "In the mock, <code>IO</code> would be some sort of state monad, where you keep track of things like the list of all the previous outputs (e.g. <code>IO.putStrLn</code>), the number of times a line was read (<code>IO.getLine</code>). Essentially, <code>IO.getLine</code> should be able to inspect the current mock-IO state and return a string accordingly: in this way you can return &quot;1+2&quot; the first time and &quot;quit&quot; the second one. This is because each <code>IO.getLine</code> would alter the state (e.g. incrementing some counter), so that next time we now what to do."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "edited": false, "score": 0, "creation_date": 1573162702, "post_id": 58755285, "comment_id": 103802213, "body": "here is what I have done so far: [<a href=\"https://repl.it/@erikTeacher/Checking-Flow]\" rel=\"nofollow noreferrer\">repl.it/@erikTeacher/Checking-Flow]</a>  I  dont think this is what you intended though. But my code maybe shows how little Haskell I do know, so that It is easier for you (or others) to point me to relevant learning material."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "edited": false, "score": 0, "creation_date": 1573162920, "post_id": 58755285, "comment_id": 103802291, "body": "@ErikT&#246;ger There&#39;s no need to use <code>unsafePerformIO</code> or to make the mutable references and functions top-level. Just create them in the <code>IO</code> do-block that holds your test and your assertions, it&#39;s easier that way. The references don&#39;t need to survive the test itself, after all. <code>pseudoGetLine</code> can also be defined within the block and passed as an argument inside the block. This link explains how <code>let</code>s let you create local definitions in a do-block <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation#Example:_user-interactive_program\" rel=\"nofollow noreferrer\">en.wikibooks.org/wiki/Haskell/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "edited": false, "score": 0, "creation_date": 1573194492, "post_id": 58755285, "comment_id": 103809653, "body": "thanks! I have now updated the code in the repl. My next step will be to write code that modifies my original meny to create the mockmeny code. So that when  I change my orginal meny code, the mockmeny code also change."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "edited": false, "score": 0, "creation_date": 1573233086, "post_id": 58755285, "comment_id": 103828020, "body": "@ErikT&#246;ger About <code>mockmeny</code> in repl.it. The point of mocking is keeping the <i>exact same business logic</i> that you use in reality, and <i>only substitute the dependencies</i>. But you are tying your logic irrevocably to how you define <code>pseudoPutStrLn</code>. You cease to be able to use the real <code>putStrLn</code>! Make your business logic a separate top level function that takes the print and read actions as parameters. Then you can either pass the <i>real</i> <code>putStrLn</code> and <code>readLine</code> (for actual use) or the mocked ones that you create inside your test."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 2, "last_activity_date": 1573159797, "last_edit_date": 1573159797, "creation_date": 1573152946, "answer_id": 58755285, "question_id": 58750508, "link": "https://stackoverflow.com/questions/58750508/how-to-test-small-program-with-user-input-in-haskell/58755285#58755285", "title": "How to test small program with user input in Haskell", "body": "<p>You can \"mock\" (or \"fake\") your dependencies without having to go beyond <code>IO</code>.</p>\n\n<p>Your program logic interacts with the external world by way of <code>putStrLn</code> and <code>getLine</code>. But what does it know about them? Nothing, really, other than their types <code>String -&gt; IO ()</code> and <code>IO String</code>.</p>\n\n<p>So we can abstract them away, turning your program logic into a function <code>myProgramLogic :: (String -&gt; IO ()) -&gt; IO String -&gt; IO ()</code> that receives the effectful actions as arguments. Passing dependencies as function arguments is a low-calorie version of dependency injection.</p>\n\n<p>Now the problem becomes: how to mock <code>putStrLn</code> and <code>getLine</code>. Obviously the mocks can't be something interactive, as we want to do automated testing. But neither can they be boring actions like <code>\\_ -&gt; return ()</code> and <code>return \"foo\"</code> which always do the same thing. They must have state, they must keep a record of their interactions with the program logic.</p>\n\n<p>There is a module called <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-IORef.html\" rel=\"nofollow noreferrer\"><code>Data.IORef</code></a> in the standard library that lets you create and manipulate mutable references living in <code>IO</code>. What other languages would call \"just a boring, run-of-the-mill variable\".</p>\n\n<p>This bit of code creates a mutable reference containing a list of strings, and also defines a <code>pseudoGetLine</code> function which extracts one of the strings each time it's executed:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    inputsRef &lt;- newIORef [\"foo\",\"bar\",\"baz\"]\n    let pseudoGetLine :: IO String\n        pseudoGetLine = do\n            atomicModifyIORef inputsRef (\\inputs -&gt;\n                case inputs of\n                    i : is -&gt; (is,i) -- the i becomes the return value of pseudoGetLine \n                    [] -&gt; error \"fake inputs exhausted\")\n    sample &lt;- pseudoGetLine\n    print sample\n</code></pre>\n\n<p>You can see where this is going: after faking both dependencies and passing them to your logic, you can inspect the states of the mutable references (using a function like <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-IORef.html#v:readIORef\" rel=\"nofollow noreferrer\"><code>readIORef</code></a>) in order to check that they are the expected ones.</p>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "edited": false, "score": 0, "creation_date": 1573293677, "post_id": 58764644, "comment_id": 103841141, "body": "Thank you for a very detailed answer! I will hopefully get it to work."}, {"owner": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "edited": false, "score": 0, "creation_date": 1573328318, "post_id": 58764644, "comment_id": 103849303, "body": "Im not sure what to install so I can get these to work:  import Test.Framework (defaultMain) import Test.Framework.Providers.HUnit import Q58750508  I tried <a href=\"http://hackage.haskell.org/package/HTF\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/HTF</a> but I get Module \u2018Test.Framework\u2019 does not export \u2018defaultMain\u2019 Failed to load interface for \u2018Test.Framework.Providers.HUnit\u2019"}, {"owner": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "edited": false, "score": 0, "creation_date": 1573373669, "post_id": 58764644, "comment_id": 103856082, "body": "I got it to work!  I just needed to install this Test instead <a href=\"https://batterseapower.github.io/test-framework/\" rel=\"nofollow noreferrer\">batterseapower.github.io/test-framework</a> for: import Test.Framework (defaultMain)    And <a href=\"http://hackage.haskell.org/package/test-framework-hunit\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/test-framework-hunit</a> for: import Test.Framework.Providers.HUnit  But I still dont know why I need import Q58750508 or how to obtain it?"}, {"owner": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "edited": false, "score": 0, "creation_date": 1573374498, "post_id": 58764644, "comment_id": 103856229, "body": "I do think this should be a completely new stackoverflow-post. But what is the best way to update  mainImp when main is changed?"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "edited": false, "score": 0, "creation_date": 1573390399, "post_id": 58764644, "comment_id": 103859598, "body": "@ErikT&#246;ger The test project in the above PoC has these dependencies, in addition to the SUT: <i>transformers, HUnit, test-framework, test-framework-hunit.</i> I don&#39;t understand the question about changing <code>main</code> - you don&#39;t change <code>main</code>, you change <code>mainImp</code>..."}, {"owner": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "edited": false, "score": 0, "creation_date": 1573415867, "post_id": 58764644, "comment_id": 103866455, "body": "With main Im refering to my original code, the one mainImp is based of. mainImp is a copy of this main (I think I have moved it to meny in my code, through. But in the question it was still in main). So how do you keep mainImp up to date when the original code changes? Lets say our calculator now says farwell instead of goodbye. Changing this by hand in multiple places isnt very good practice."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 2, "last_activity_date": 1573208413, "creation_date": 1573208413, "answer_id": 58764644, "question_id": 58750508, "link": "https://stackoverflow.com/questions/58750508/how-to-test-small-program-with-user-input-in-haskell/58764644#58764644", "title": "How to test small program with user input in Haskell", "body": "<p>Even in an object-oriented environment like Java or C# (my other specialty), one wouldn't be able to use <a href=\"https://en.wikipedia.org/wiki/Test_double\" rel=\"nofollow noreferrer\">Test Doubles</a> ('mocks') on the <code>Main</code> method, since you can't do dependency injection on the entry point; its signature is fixed.</p>\n\n<p>What you'd normally do would be to define a <code>MainImp</code> that takes dependencies, and then use Test Doubles to test that, leaving the actual <code>Main</code> method as a <a href=\"http://xunitpatterns.com/Humble%20Object.html\" rel=\"nofollow noreferrer\">Humble Executable</a>.</p>\n\n<h1>Production code</h1>\n\n<p>You can do the same in Haskell. A simple approach is to do what <em>danidiaz</em> suggests, and simply pass impure actions as arguments to <code>mainImp</code>:</p>\n\n<pre><code>mainImp :: Monad m =&gt; m String -&gt; (String -&gt; m ()) -&gt; m ()\nmainImp getInput displayOutput = do\n  displayOutput \"What should I calcuclate? ex 3*(2+2)  | quit to exit\" \n  line &lt;- getInput\n  if line /= \"quit\"\n  then do if correctInput line\n          then do displayOutput $ show $ calculate line\n                  mainImp getInput displayOutput\n          else do displayOutput \"Wrong input\"\n                  mainImp getInput displayOutput\n  else displayOutput \"goodbye\"\n</code></pre>\n\n<p>Notice that the type declaration explicitly allows any <code>Monad m</code>. This includes <code>IO</code>, which means that you can compose your actual <code>main</code> action like this:</p>\n\n<pre><code>main :: IO ()\nmain = mainImp getLine putStrLn\n</code></pre>\n\n<p>In tests, however, you can use another monad. Usually, <code>State</code> is well-suited to this task.</p>\n\n<h1>Tests</h1>\n\n<p>You can begin a test module with appropriate imports:</p>\n\n<pre><code>module Main where\n\nimport Control.Monad.Trans.State\nimport Test.HUnit.Base (Test(..), (~:), (~=?), (@?))\nimport Test.Framework (defaultMain)\nimport Test.Framework.Providers.HUnit\nimport Q58750508\n\nmain :: IO ()\nmain = defaultMain $ hUnitTestToTests $ TestList tests\n</code></pre>\n\n<p>This uses HUnit, and as you'll see in a while, I <a href=\"https://blog.ploeh.dk/2018/05/07/inlined-hunit-test-lists\" rel=\"nofollow noreferrer\">inline the tests in a list literal</a>.</p>\n\n<p>Before we get to the tests, however, I think it makes sense to define a test-specific type that can hold the state of the console:</p>\n\n<pre><code>data Console = Console { outputs :: [String], inputs :: [String] } deriving (Eq, Show)\n</code></pre>\n\n<p>You also need some functions that correspond to <code>getInput</code> and <code>displayOutput</code>, but that run in the <code>State Console</code> monad instead of in <code>IO</code>. This is <a href=\"https://blog.ploeh.dk/2019/03/11/an-example-of-state-based-testing-in-haskell\" rel=\"nofollow noreferrer\">a technique that I've described before</a>.</p>\n\n<pre><code>getInput :: State Console String\ngetInput = do\n  console &lt;- get\n  let input = head $ inputs console\n  put $ console { inputs = tail $ inputs console }\n  return input\n</code></pre>\n\n<p>Notice that this function is unsafe because it uses <code>head</code> and <code>tail</code>. I'll leave it as an exercise to make it safe.</p>\n\n<p>It uses <code>get</code> to retrieve the current state of the console, pulls the <code>head</code> of the 'queue' of <code>inputs</code>, and updates the state before returning the <code>input</code>.</p>\n\n<p>Likewise, you can implement <code>displayOutput</code> in the <code>State Console</code> monad:</p>\n\n<pre><code>displayOutput :: String -&gt; State Console ()\ndisplayOutput s = do\n  console &lt;- get\n  put $ console { outputs = s : outputs console }\n</code></pre>\n\n<p>This just updates the state with the supplied <code>String</code>.</p>\n\n<p>You're also going to need a way to run tests in the <code>State Console</code> monad:</p>\n\n<pre><code>runStateTest :: State Console a -&gt; a\nrunStateTest = flip evalState $ Console [] []\n</code></pre>\n\n<p>This always kicks off any test with empty <code>inputs</code> and empty <code>outputs</code>, so it's your responsibility as a test writer to make sure that the <code>inputs</code> always ends with <code>\"quit\"</code>. You could also write a helper function to do that, or change <code>runStateTest</code> to always include this value.</p>\n\n<p>A simple test, then, is:</p>\n\n<pre><code>tests :: [Test]\ntests = [\n  \"Quit right away\" ~: runStateTest $ do\n    modify $ \\console -&gt; console { inputs = [\"quit\"] }\n\n    mainImp getInput displayOutput\n\n    Console actual _ &lt;- get\n    return $ elem \"goodbye\" actual @? \"\\\"goodbye\\\" wasn't found in \" ++ show actual\n-- other tests go here...\n]\n</code></pre>\n\n<p>This test just verifies that if you immediately <code>\"quit\"</code>, the <code>\"goodbye\"</code> message is present.</p>\n\n<p>A slightly more involved test could be:</p>\n\n<pre><code>  ,\n  \"Run single calcuation\" ~: runStateTest $ do\n    modify $ \\console -&gt; console { inputs = [\"3*(2+2)\", \"quit\"] }\n\n    mainImp getInput displayOutput\n\n    Console actual _ &lt;- get\n    let expected =\n          [ \"What should I calcuclate? ex 3*(2+2)  | quit to exit\",\n            \"12\",\n            \"What should I calcuclate? ex 3*(2+2)  | quit to exit\",\n            \"goodbye\"]\n    return $ expected ~=? reverse actual\n</code></pre>\n\n<p>You can insert it before the closing <code>]</code> in the above <code>tests</code> list, where the comment says <code>-- other tests go here...</code>.</p>\n\n<p>I have more articles on unit testing with Haskell than the articles I've linked to, so be sure to follow the links there, as well as investigate what other articles inhabit the intersection between <a href=\"https://blog.ploeh.dk/tags/#Haskell-ref\" rel=\"nofollow noreferrer\">the Haskell tag</a> and <a href=\"https://blog.ploeh.dk/tags/#Unit%20Testing-ref\" rel=\"nofollow noreferrer\">the Unit Testing tag</a>.</p>\n"}], "owner": {"reputation": 33, "user_id": 12338025, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mB1BKwK3FIi6efcl3o4CwmaRfqNVMhkn88XaxZOEg=k-s128", "display_name": "Erik T&#246;ger", "link": "https://stackoverflow.com/users/12338025/erik-t%c3%b6ger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 58764644, "answer_count": 2, "score": 3, "last_activity_date": 1573208413, "creation_date": 1573135630, "question_id": 58750508, "link": "https://stackoverflow.com/questions/58750508/how-to-test-small-program-with-user-input-in-haskell", "title": "How to test small program with user input in Haskell", "body": "<p>Im taking a software testing class. And we were allowed to choose what language to write our code and tests in. And I choose Haskell. I know, maybe not the best way to learn testing (= but...</p>\n\n<p>The unit-testing and coding has been working great!</p>\n\n<p>But I am also required to use mocking to get a higher grade.</p>\n\n<p>My problem is that I dont know very much Haskell (like Monads and stuff).</p>\n\n<p>I have written and tested Calculator. And now I want to test my main. My instructor used Mockito for Java to check that the program had the correct flow. </p>\n\n<p>Is it possible to test that my if-statements are correct?\nI have tried reading up on testing IO actions through Monads, but I dont quite understand it.\nMaybe I should just learn more about Monads before trying to solve this?</p>\n\n<p>Any help or reading suggestions are very much appreciated!  </p>\n\n<pre><code>import Calculator\n\nmain :: IO ()\nmain = do\n        putStrLn(\"What should I calcuclate? ex 3*(2+2)  | quit to exit\" )\n        line &lt;- getLine\n        if line /= \"quit\"\n        then do if correctInput line\n                then do putStrLn( show $ calculate line) \n                        main\n                else do putStrLn( \"Wrong input\") \n                        main\n        else putStrLn(\"goodbye\")\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "cabal-install"], "answers": [{"comments": [{"owner": {"reputation": 2736, "user_id": 6560579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8333bafdc079cc54ededd323a6993fe7?s=128&d=identicon&r=PG&f=1", "display_name": "Ackdari", "link": "https://stackoverflow.com/users/6560579/ackdari"}, "edited": false, "score": 0, "creation_date": 1573135577, "post_id": 58750226, "comment_id": 103789116, "body": "what is your guess on how this could have happend?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 2736, "user_id": 6560579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8333bafdc079cc54ededd323a6993fe7?s=128&d=identicon&r=PG&f=1", "display_name": "Ackdari", "link": "https://stackoverflow.com/users/6560579/ackdari"}, "edited": false, "score": 0, "creation_date": 1573138010, "post_id": 58750226, "comment_id": 103790554, "body": "@Ackdari Presumably you asked to install some library that depends on <code>binary</code> (perhaps <code>binary</code> itself) but not the boot libraries that conflict with the chosen <code>binary</code> version."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1573134770, "creation_date": 1573134770, "answer_id": 58750226, "question_id": 58749961, "link": "https://stackoverflow.com/questions/58749961/cabal-trouble-resolving-dependencies/58750226#58750226", "title": "Cabal trouble resolving dependencies", "body": "<p>To me, this looks like you have a version of <code>binary</code> installed that isn't compatible with the boot libraries that come with the compiler. I recommend that you edit the file</p>\n\n<pre><code>~/.ghc/&lt;something&gt;-8.6.5/environments/default\n</code></pre>\n\n<p>and delete the line that mentions <code>binary</code>, then try again. (The <code>&lt;something&gt;</code> is almost certainly <code>x86_64-linux</code>.)</p>\n"}], "owner": {"reputation": 2736, "user_id": 6560579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8333bafdc079cc54ededd323a6993fe7?s=128&d=identicon&r=PG&f=1", "display_name": "Ackdari", "link": "https://stackoverflow.com/users/6560579/ackdari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 58750226, "answer_count": 1, "score": 1, "last_activity_date": 1573134770, "creation_date": 1573133905, "question_id": 58749961, "link": "https://stackoverflow.com/questions/58749961/cabal-trouble-resolving-dependencies", "title": "Cabal trouble resolving dependencies", "body": "<p>I'm tring to install the package <code>cabal-debian</code> globally using <code>cabal v2-install cabal-debian</code> and get this error message:</p>\n\n<pre><code>Resolving dependencies...\ncabal: Could not resolve dependencies:\n[__0] trying: base-4.12.0.0/installed-4.1... (user goal)\n[__1] trying: binary-0.8.7.0 (user goal)\n[__2] next goal: ghc (user goal)\n[__2] rejecting: ghc-8.6.5/installed-8.6... (conflict: binary==0.8.7.0, ghc =&gt;\nbinary==0.8.6.0/installed-0.8...)\n[__2] trying: ghc-8.6.5\n[__3] rejecting: ghc:-buildable (conflict: base==4.12.0.0/installed-4.1...,\nghc -buildable =&gt; base&lt;0)\n[__3] rejecting: ghc:+buildable (manual flag can only be changed explicitly)\n[__3] fail (backjumping, conflict set: base, ghc, ghc:buildable)\nAfter searching the rest of the dependency tree exhaustively, these were the\ngoals I've had most trouble fulfilling: binary, base, ghc, ghc:buildable\nTry running with --minimize-conflict-set to improve the error message.\n</code></pre>\n\n<p>I am using <code>cabal 3.0.0.0</code> and have <code>ghc 8.6.5</code> installed.</p>\n"}, {"tags": ["haskell", "type-conversion", "sqrt"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1573130658, "post_id": 58749010, "comment_id": 103786481, "body": "<code>sqrt</code> does not return a <code>Float</code>, it returns a value of the same type as that of the parameter, and that is an instance of <code>Floating</code> (note that <code>Floating</code> is a typeclass, and <i>not</i> the same as <code>Float</code>, which is a type). You can here specialize your <code>distance</code> function to <code>distance :: Metric Double</code>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 12337683, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBtPvOXoHgjLtmSpfau5LLrociLmrVQC30mkyXS=k-s128", "display_name": "jtef", "link": "https://stackoverflow.com/users/12337683/jtef"}, "edited": false, "score": 1, "creation_date": 1573131220, "post_id": 58749086, "comment_id": 103786812, "body": "oh, I get it now, it worked when I used Metric Double but yeah it makes more sense to let Metric return an a. Thanks a lot!!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1573130783, "creation_date": 1573130783, "answer_id": 58749086, "question_id": 58749010, "link": "https://stackoverflow.com/questions/58749010/how-can-i-make-my-function-return-a-double-without-changing-type-metric/58749086#58749086", "title": "How can I make my function return a double without changing type Metric?", "body": "<blockquote>\n  <p>my problem is that the function should be of type <code>Metric</code>, a type which returns a <code>Double</code> while my <code>sqrt</code> within the function returns a <code>Float</code>.</p>\n</blockquote>\n\n<p><code>sqrt</code> does <em>not</em> return a <code>Float</code>, it returns a value of the same type as that of the parameter, and that is an instance of <code>Floating</code> (note that <code>Floating</code> is a typeclass, and <em>not</em> the same as <code>Float</code>, which is a type). It thus has as type <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:sqrt\" rel=\"nofollow noreferrer\"><strong><code>sqrt :: Floating a =&gt; a -&gt; a</code></strong></a>.</p>\n\n<p>You can here specialize your <code>distance</code> function to <code>distance :: Metric Double</code>:</p>\n\n<pre><code>distance :: Metric <b>Double</b>\ndistance (a1,b1) (a2, b2) = sqrt ((a*a)+(b*b))\n    where a = a2 - a1\n          b = b2 - b1</code></pre>\n\n<p>That being said, it might make more sense to let the <code>Metric</code> return an <code>a</code>:</p>\n\n<pre><code>type Metric2 a = Point a -&gt; Point a -&gt; <b>a</b></code></pre>\n\n<p>and then thus work with a <code>Floating a =&gt; Metric2 a</code>:</p>\n\n<pre><code>distance :: Floating a =&gt; Metric2 a\ndistance (a1,b1) (a2, b2) = sqrt ((a*a)+(b*b))\n    where a = a2 - a1\n          b = b2 - b1</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12337683, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBtPvOXoHgjLtmSpfau5LLrociLmrVQC30mkyXS=k-s128", "display_name": "jtef", "link": "https://stackoverflow.com/users/12337683/jtef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 58749086, "answer_count": 1, "score": 1, "last_activity_date": 1573130783, "creation_date": 1573130505, "question_id": 58749010, "link": "https://stackoverflow.com/questions/58749010/how-can-i-make-my-function-return-a-double-without-changing-type-metric", "title": "How can I make my function return a double without changing type Metric?", "body": "<p>I have a function 'distance' that calculates the distance between two points.\nmy problem is that the function should be of type Metric, a type which returns a  Double while my sqrt within the function returns a Float.\nThis is my code:</p>\n\n<pre><code>    type Metric a = Point a -&gt; Point a -&gt; Double\n    type Point a = (a, a)\n    distance :: Floating a =&gt; Metric a\n    distance (a1,b1) (a2, b2) = sqrt ((a*a)+(b*b))\n       where a = a2 - a1\n             b = b2 - b1\n</code></pre>\n\n<p>I know if a write Metric as Point a -> Point a -> a will solve my problem  but I need to use Metric as it is\nI've also looked up for how to convert float to double in Haskell but did not found anything helpful</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573130262, "post_id": 58748760, "comment_id": 103786251, "body": "It does not have to detect that, it simply constraints it to an instance of <code>Arbitrary</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573130878, "post_id": 58748760, "comment_id": 103786636, "body": "As for the number of data types. In Haskell, every function takes <i>exactly</i> one parameter. It thus uses some sort of recursion to recurse on the function that is returned out of that function, etc."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1573133117, "creation_date": 1573133117, "answer_id": 58749725, "question_id": 58748760, "link": "https://stackoverflow.com/questions/58748760/how-does-quickcheck-detect-datatypes/58749725#58749725", "title": "How does QuickCheck detect datatypes?", "body": "<p>Roughly, this is how type classes work. One can declare</p>\n\n<pre><code>class C a where\n   foo :: a -&gt; Bool\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>instance C (Int -&gt; Bool) where\n   foo f = f 42\ninstance C (String -&gt; Bool) where\n   foo f = f \"hello\"\ninstance C (String -&gt; [Int]) where\n   foo f = sum (f \"hello\") &gt; 42\n</code></pre>\n\n<p>and so on.</p>\n\n<p>This has the apparent effect to make <code>foo</code> \"detect\" the type of its argument <code>f</code> and act accordingly. Actually, what happens is that Haskell performs type inference, during which the appropriate instance is selected -- at compile time. At runtime, no \"type detection\" happens; indeed, types are erased after compilation, and there is no type information available at runtime, so it would be impossible to detect which type <code>f</code> belongs to.</p>\n\n<p>The actual QuickCheck mechanism is much more complex, of course. To handle functions with an arbitrary number of arguments, a set of \"recursive\" <code>instance</code>s is used, handling each argument every \"recursive call\", so to speak. This is a rather tricky technique, also used in <code>printf</code> and other \"variadic\" functions. If you are unfamiliar with type classes, I do not recommend to start learning them from such a complex trick.</p>\n"}, {"tags": [], "owner": {"reputation": 488, "user_id": 11255651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15605be966e9a10bc070220078d06610?s=128&d=identicon&r=PG", "display_name": "Mike", "link": "https://stackoverflow.com/users/11255651/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1587843533, "creation_date": 1587843533, "answer_id": 61431517, "question_id": 58748760, "link": "https://stackoverflow.com/questions/58748760/how-does-quickcheck-detect-datatypes/61431517#61431517", "title": "How does QuickCheck detect datatypes?", "body": "<p>A bit late to the party, but <a href=\"https://github.com/nick8325/quickcheck/blob/62e32e099cac456b088407bbe70d33e0b03fd75e/Test/QuickCheck/Property.hs#L176\" rel=\"nofollow noreferrer\">this is the instance</a> you're looking for in the current implementation.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance (Arbitrary a, Show a, Testable prop) =&gt; Testable (a -&gt; prop) where\n  property f =\n    propertyForAllShrinkShow arbitrary shrink (return . show) f\n  propertyForAllShrinkShow gen shr shw f =\n    -- gen :: Gen b, shr :: b -&gt; [b], f :: b -&gt; a -&gt; prop\n    -- Idea: Generate and shrink (b, a) as a pair\n    propertyForAllShrinkShow\n      (liftM2 (,) gen arbitrary)\n      (liftShrink2 shr shrink)\n      (\\(x, y) -&gt; shw x ++ [show y])\n      (uncurry f)\n</code></pre>\n\n<p>As @chi correctly stated, there is recursion happening here. The recursive call is <code>propertyForAllShrinkShow</code> calling <code>propertyForAllShrinkShow</code>, and by calling <code>uncurry</code>, a property in the form <code>a -&gt; b -&gt; c -&gt; Bool</code> gets turned into <code>(a, b) -&gt; c -&gt; Bool</code>. As <code>(a, b)</code> is a valid arbitrary because there is an <code>instance</code> of <code>Arbitrary (a, b)</code>, the same instance of <code>Testable</code> will run again where <code>prop</code> is <code>c -&gt; Bool</code>. Then, the same will run again as <code>((a, b), c</code>, and <code>prop</code> will then be just <code>Bool</code>. At that point, the <a href=\"https://github.com/nick8325/quickcheck/blob/62e32e099cac456b088407bbe70d33e0b03fd75e/Test/QuickCheck/Property.hs#L135\" rel=\"nofollow noreferrer\"><code>Bool</code> instance of <code>Testable</code></a> kicks in, which uses the default <code>propertyForAllShrinkShow</code>, which creates the actual application of <code>f x</code>. So another way to say it is that quickcheck generates all of the values at the same time as an arbitrary tuple and uses recursion in the <code>instance</code> of <code>Testable</code> to construct the tuple.</p>\n"}], "owner": {"reputation": 304, "user_id": 10216028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08208ff791a99d795cb970e6ba83d355?s=128&d=identicon&r=PG&f=1", "display_name": "Coder", "link": "https://stackoverflow.com/users/10216028/coder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1587843533, "creation_date": 1573129552, "last_edit_date": 1573129657, "question_id": 58748760, "link": "https://stackoverflow.com/questions/58748760/how-does-quickcheck-detect-datatypes", "title": "How does QuickCheck detect datatypes?", "body": "<p>If we define a function like this </p>\n\n<pre><code>fun :: Int -&gt; Property\n</code></pre>\n\n<p>and then run </p>\n\n<pre><code>quickCheck fun\n</code></pre>\n\n<p>The quickCheck starts generating random data of type Int. The question is how does quickCheck detect that the argument datatype of fun is Int and not any other datatype?  If I make the question more general I should ask that if we have a function called fun like this</p>\n\n<pre><code>fun :: datatype_1 -&gt; datatype_2 -&gt; ... -&gt; datatype_n -&gt; Property\n</code></pre>\n\n<p>How does quickCheck detect the type of each individual datatype_1, datatype_2, ... and datatype_n? And also how does it detect how many arguments the function fun takes?</p>\n"}, {"tags": ["parsing", "haskell", "recursion", "functional-programming", "stack-overflow"], "comments": [{"owner": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "edited": false, "score": 2, "creation_date": 1573147962, "post_id": 58747995, "comment_id": 103796169, "body": "As someone who is not familiar with fp-course, this code is hard to understand on its own. Can you try and reduce this to a minimal reproducible example? <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">stackoverflow.com/help/minimal-reproducible-example</a>"}, {"owner": {"reputation": 1285, "user_id": 2075423, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/084668018e4752a76a838f27e041d182?s=128&d=identicon&r=PG", "display_name": "stevemao", "link": "https://stackoverflow.com/users/2075423/stevemao"}, "reply_to_user": {"reputation": 1290, "user_id": 5499871, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206799318615183/picture?type=large", "display_name": "Izaak Weiss", "link": "https://stackoverflow.com/users/5499871/izaak-weiss"}, "edited": false, "score": 0, "creation_date": 1573159769, "post_id": 58747995, "comment_id": 103801107, "body": "@IzaakWeiss I have removed unrelated code (<code>pure</code>)"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1573164058, "post_id": 58747995, "comment_id": 103802712, "body": "@stevemao We&#39;re missing the definitions of <code>Parser</code>, <code>onresult</code>, <code>parse</code>, <code>|||</code> and <code>:.</code>  though. Please make a self-contained example."}, {"owner": {"reputation": 1285, "user_id": 2075423, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/084668018e4752a76a838f27e041d182?s=128&d=identicon&r=PG", "display_name": "stevemao", "link": "https://stackoverflow.com/users/2075423/stevemao"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1573164433, "post_id": 58747995, "comment_id": 103802845, "body": "@Bergi missing definitions should be added. Thanks."}, {"owner": {"reputation": 1285, "user_id": 2075423, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/084668018e4752a76a838f27e041d182?s=128&d=identicon&r=PG", "display_name": "stevemao", "link": "https://stackoverflow.com/users/2075423/stevemao"}, "edited": false, "score": 0, "creation_date": 1573282592, "post_id": 58747995, "comment_id": 103839345, "body": "I found the problem and have updated the description. Please help me"}, {"owner": {"reputation": 1285, "user_id": 2075423, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/084668018e4752a76a838f27e041d182?s=128&d=identicon&r=PG", "display_name": "stevemao", "link": "https://stackoverflow.com/users/2075423/stevemao"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1573346436, "post_id": 58747995, "comment_id": 103852921, "body": "@WillNess The link doesn&#39;t mention the difference between <code>data</code> and <code>newtype</code> in terms of laziness. Do you also have a link to that? Many thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 1, "last_activity_date": 1573513329, "last_edit_date": 1573513329, "creation_date": 1573487821, "answer_id": 58804687, "question_id": 58747995, "link": "https://stackoverflow.com/questions/58747995/stack-overflow-with-two-functions-calling-each-other-in-applicative-parser/58804687#58804687", "title": "Stack overflow with two functions calling each other in Applicative parser", "body": "<blockquote>\n  <p>If I use lazy pattern matching <code>P f &lt;*&gt; ~(P a) = ...</code> then it works fine. Why?</p>\n</blockquote>\n\n<p>This very issue was <a href=\"https://stackoverflow.com/questions/58625324/applicative-parser-stuck-in-infinite-loop/58631068#58631068\">discussed recently</a>. You could also fix it by using <code>newtype</code> instead of <code>data</code>: <code>newtype Parser a = P (Input -&gt; ParseResult a)</code>.(*)</p>\n\n<p>The definition of <code>list1</code> wants to know <em>both</em> parser arguments to <code>&lt;*&gt;</code>, but actually when the first will fail (when input is exhausted) we don't need to know the second! But since we force it, it will force its second argument, and that one will force its second parser, ad infinitum.(**) That is, <code>p</code> <em>will</em> fail when input is exhausted, but we have <code>list1 p = (:.) &lt;$&gt; p &lt;*&gt; list p</code> which forces <code>list p</code> even though it won't run when the preceding <code>p</code> fails. That's the reason for the infinite looping, and why your fix with the lazy pattern works.</p>\n\n<blockquote>\n  <p>What is the difference between <code>data</code> and <code>newtype</code> in terms of laziness? </p>\n</blockquote>\n\n<p>(*)<code>newtype</code>'d type always has only one data constructor, and pattern matching on it does <em>not</em> actually force the value, so it is implicitly like a lazy pattern. Try <code>newtype P = P Int</code>, <code>let foo (P i) = 42 in foo undefined</code> and see that it works.</p>\n\n<p>(**) This happens when the parser is still prepared, composed; before the combined, composed parser even gets to run on the actual input. This means there's yet another, third way to fix the problem: define </p>\n\n<pre><code>list1 p = (:.) &lt;$&gt; p &lt;*&gt; P (\\s -&gt; parse (list p) s)\n</code></pre>\n\n<p>This should work regardless of the laziness of <code>&lt;*&gt;</code> and whether <code>data</code> or <code>newtype</code> was used.</p>\n\n<p>Intriguingly, the above definition means that the parser will be actually created during run time, depending on the input, which is the defining characteristic of Monad, not Applicative which is supposed to be known statically, in advance. But the difference here is that the Applicative depends on the hidden state of input, and not on the \"returned\" value.</p>\n"}], "owner": {"reputation": 1285, "user_id": 2075423, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/084668018e4752a76a838f27e041d182?s=128&d=identicon&r=PG", "display_name": "stevemao", "link": "https://stackoverflow.com/users/2075423/stevemao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "accepted_answer_id": 58804687, "answer_count": 1, "score": 2, "last_activity_date": 1573513329, "creation_date": 1573126707, "last_edit_date": 1573492677, "question_id": 58747995, "link": "https://stackoverflow.com/questions/58747995/stack-overflow-with-two-functions-calling-each-other-in-applicative-parser", "title": "Stack overflow with two functions calling each other in Applicative parser", "body": "<p>I'm doing data61's course: <a href=\"https://github.com/data61/fp-course\" rel=\"nofollow noreferrer\">https://github.com/data61/fp-course</a>. In the parser one, the following implementation will cause <code>parse (list1 (character *&gt; valueParser 'v')) \"abc\"</code> stack overflow.</p>\n\n<p>Existing code:</p>\n\n<pre><code>data List t =\n  Nil\n  | t :. List t\n  deriving (Eq, Ord)\n\n-- Right-associative\ninfixr 5 :.\n\ntype Input = Chars\n\ndata ParseResult a =\n    UnexpectedEof\n  | ExpectedEof Input\n  | UnexpectedChar Char\n  | UnexpectedString Chars\n  | Result Input a\n  deriving Eq\n\ninstance Show a =&gt; Show (ParseResult a) where\n  show UnexpectedEof =\n    \"Unexpected end of stream\"\n  show (ExpectedEof i) =\n    stringconcat [\"Expected end of stream, but got &gt;\", show i, \"&lt;\"]\n  show (UnexpectedChar c) =\n    stringconcat [\"Unexpected character: \", show [c]]\n  show (UnexpectedString s) =\n    stringconcat [\"Unexpected string: \", show s]\n  show (Result i a) =\n    stringconcat [\"Result &gt;\", hlist i, \"&lt; \", show a]\n\ninstance Functor ParseResult where\n  _ &lt;$&gt; UnexpectedEof =\n    UnexpectedEof\n  _ &lt;$&gt; ExpectedEof i =\n    ExpectedEof i\n  _ &lt;$&gt; UnexpectedChar c =\n    UnexpectedChar c\n  _ &lt;$&gt; UnexpectedString s =\n    UnexpectedString s\n  f &lt;$&gt; Result i a =\n    Result i (f a)\n\n-- Function to determine is a parse result is an error.\nisErrorResult ::\n  ParseResult a\n  -&gt; Bool\nisErrorResult (Result _ _) =\n  False\nisErrorResult UnexpectedEof =\n  True\nisErrorResult (ExpectedEof _) =\n  True\nisErrorResult (UnexpectedChar _) =\n  True\nisErrorResult (UnexpectedString _) =\n  True\n\n-- | Runs the given function on a successful parse result. Otherwise return the same failing parse result.\nonResult ::\n  ParseResult a\n  -&gt; (Input -&gt; a -&gt; ParseResult b)\n  -&gt; ParseResult b\nonResult UnexpectedEof _ = \n  UnexpectedEof\nonResult (ExpectedEof i) _ = \n  ExpectedEof i\nonResult (UnexpectedChar c) _ = \n  UnexpectedChar c\nonResult (UnexpectedString s)  _ = \n  UnexpectedString s\nonResult (Result i a) k = \n  k i a\n\ndata Parser a = P (Input -&gt; ParseResult a)\n\nparse ::\n  Parser a\n  -&gt; Input\n  -&gt; ParseResult a\nparse (P p) =\n  p\n\n-- | Produces a parser that always fails with @UnexpectedChar@ using the given character.\nunexpectedCharParser ::\n  Char\n  -&gt; Parser a\nunexpectedCharParser c =\n  P (\\_ -&gt; UnexpectedChar c)\n\n--- | Return a parser that always returns the given parse result.\n---\n--- &gt;&gt;&gt; isErrorResult (parse (constantParser UnexpectedEof) \"abc\")\n--- True\nconstantParser ::\n  ParseResult a\n  -&gt; Parser a\nconstantParser =\n  P . const\n\n-- | Return a parser that succeeds with a character off the input or fails with an error if the input is empty.\n--\n-- &gt;&gt;&gt; parse character \"abc\"\n-- Result &gt;bc&lt; 'a'\n--\n-- &gt;&gt;&gt; isErrorResult (parse character \"\")\n-- True\ncharacter ::\n  Parser Char\ncharacter = P p\n  where p Nil = UnexpectedString Nil\n        p (a :. as) = Result as a\n\n-- | Parsers can map.\n-- Write a Functor instance for a @Parser@.\n--\n-- &gt;&gt;&gt; parse (toUpper &lt;$&gt; character) \"amz\"\n-- Result &gt;mz&lt; 'A'\ninstance Functor Parser where\n  (&lt;$&gt;) ::\n    (a -&gt; b)\n    -&gt; Parser a\n    -&gt; Parser b\n  f &lt;$&gt; P p = P p'\n    where p' input = f &lt;$&gt; p input \n\n-- | Return a parser that always succeeds with the given value and consumes no input.\n--\n-- &gt;&gt;&gt; parse (valueParser 3) \"abc\"\n-- Result &gt;abc&lt; 3\nvalueParser ::\n  a\n  -&gt; Parser a\nvalueParser a = P p\n  where p input = Result input a\n\n-- | Return a parser that tries the first parser for a successful value.\n--\n--   * If the first parser succeeds then use this parser.\n--\n--   * If the first parser fails, try the second parser.\n--\n-- &gt;&gt;&gt; parse (character ||| valueParser 'v') \"\"\n-- Result &gt;&lt; 'v'\n--\n-- &gt;&gt;&gt; parse (constantParser UnexpectedEof ||| valueParser 'v') \"\"\n-- Result &gt;&lt; 'v'\n--\n-- &gt;&gt;&gt; parse (character ||| valueParser 'v') \"abc\"\n-- Result &gt;bc&lt; 'a'\n--\n-- &gt;&gt;&gt; parse (constantParser UnexpectedEof ||| valueParser 'v') \"abc\"\n-- Result &gt;abc&lt; 'v'\n(|||) ::\n  Parser a\n  -&gt; Parser a\n  -&gt; Parser a\nP a ||| P b = P c\n  where c input\n          | isErrorResult resultA = b input\n          | otherwise = resultA\n            where resultA = a input\n\ninfixl 3 |||\n</code></pre>\n\n<p>My code:</p>\n\n<pre><code>instance Monad Parser where\n  (=&lt;&lt;) ::\n    (a -&gt; Parser b)\n    -&gt; Parser a\n    -&gt; Parser b\n  f =&lt;&lt; P a = P p\n    where p input = onResult (a input) (\\i r -&gt; parse (f r) i)\n\ninstance Applicative Parser where\n  (&lt;*&gt;) ::\n    Parser (a -&gt; b)\n    -&gt; Parser a\n    -&gt; Parser b\n  P f &lt;*&gt; P a = P b\n    where b input = onResult (f input) (\\i f' -&gt; f' &lt;$&gt; a i)\n\nlist ::\n  Parser a\n  -&gt; Parser (List a)\nlist p = list1 p ||| pure Nil\n\nlist1 ::\n  Parser a\n  -&gt; Parser (List a)\nlist1 p = (:.) &lt;$&gt; p &lt;*&gt; list p\n</code></pre>\n\n<p>However, if I change <code>list</code> to not use <code>list1</code>, or use <code>=&lt;&lt;</code> in <code>list1</code>, it works fine. It also works if <code>&lt;*&gt;</code> uses <code>=&lt;&lt;</code>. I feel like it might be an issue with tail recursion.</p>\n\n<p><strong>UPDATE:</strong> </p>\n\n<p>If I use lazy pattern matching here</p>\n\n<pre><code>  P f &lt;*&gt; ~(P a) = P b\n    where b input = onResult (f input) (\\i f' -&gt; f' &lt;$&gt; a i)\n</code></pre>\n\n<p>It works fine. Pattern matching here is the problem. I don't understand this... Please help!</p>\n"}, {"tags": ["haskell", "typeclass", "newtype"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573126063, "post_id": 58747762, "comment_id": 103783983, "body": "<code>fromInteger</code> is used to convert an <code>Integer</code> to a numerical type (like <code>Int</code> for example). The &quot;appropriate value&quot; means a value in the target type that has the same value as the <code>Integer</code>."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1573126257, "post_id": 58747762, "comment_id": 103784077, "body": "No. Read the quote from the Report. &quot;the appropriate value of type <code>Integer</code>&quot;."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1573133906, "post_id": 58747762, "comment_id": 103788189, "body": "I think there is no Haskell syntax for <i>directly</i> expressing the &quot;appropriate value&quot; the Report is referring to. It is a value that should be created by a Haskell implementation when a literal is found, and it will always be surrounded by an implicit <code>fromInteger</code>. This is a sort-of theoretical limitation which has no practical consequences, since <code>4 :: Integer</code> stands for <code>fromInteger the_actual_Integer_4 :: Integer</code> which evaluates to the same value <code>the_actual_Integer_4</code> represents. So, even if there is no syntax for <code>the_actual_Integer_4</code> it does not really matter. (It&#39;s a bit weird.)"}], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1573129585, "post_id": 58748593, "comment_id": 103785900, "body": "I think you&#39;re just telling me what I already wrote in the q, but putting it rather confusingly. Can I write &quot;the appropriate value&quot; in Haskell source code? <code>4 :: Integer</code> yields that value; there&#39;s an invisible <code>fromInteger 4?</code> hidden in the bare <code>4</code>, so it&#39;s not writing the appropriate value direct."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1573130051, "post_id": 58748593, "comment_id": 103786154, "body": "I think the part you are asking about is that you too literally trying to use <code>fromInteger</code>. In Haskell <i>source code</i>, you would need some magical literal <code>4?</code> to avoid infinite recursion. But the compiler isn&#39;t limited to source code; it can work with the correct value internally that the literal <code>4</code> implies, and call <code>fromInteger</code> directly on that."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1573129911, "last_edit_date": 1573129911, "creation_date": 1573128942, "answer_id": 58748593, "question_id": 58747762, "link": "https://stackoverflow.com/questions/58747762/what-is-the-appropriate-value-of-type-integer-and-can-i-write-one-also-newt/58748593#58748593", "title": "what is the &quot;appropriate value of type `Integer`&quot; and can I write one; also newtypes", "body": "<p><code>4 :: Integer</code> is such a value; <code>4 :: Int</code> is not. Don't confuse the literal <code>4</code> with the family of actual values that it represents in source code.</p>\n\n<p><code>4</code> by itself has the polymorphic type <code>Num a =&gt; a</code>, which means in the right context, you can \"extract\" from it a value of type <code>4 :: Integer</code>. Such a context is a call to <code>fromInteger</code>, since it expects a value of type <code>Integer</code> as an argument, not a value of type <code>Num a =&gt; a</code>.</p>\n\n<p>When you write <code>x = 4</code> after declaring that <code>x</code> is, indeed, a value of type <code>Integer</code>, the compiler takes care of \"extracting\" the value <code>4 :: Integer</code> for your from the literal.</p>\n\n<hr>\n\n<p><code>MkAge</code> is necessary for type checking. <code>mkAge2 4</code> works precisely because you have defined (or at least derived) an instance of <code>Num</code> for <code>Age</code>, which entails defining <code>fromInteger :: Integer -&gt; Age</code>. <code>mkAge2</code> is implicitly calling <code>fromInteger</code> on <code>4</code> to return <code>MkAge 4</code>, and <em>that</em> is the value passed to <code>mkAge2</code>. So you still need <code>MkAge</code>, you just don't have to <em>use</em> it explicitly.</p>\n"}, {"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1573169574, "post_id": 58749362, "comment_id": 103804331, "body": "Thank you for the sleuthing inside GHC."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1573175204, "post_id": 58749362, "comment_id": 103805540, "body": "Remember that <a href=\"https://hackage.haskell.org/package/true-name\" rel=\"nofollow noreferrer\">a little bit of Template Haskell</a> will let you get at those hidden constructors anyway."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1573131751, "creation_date": 1573131751, "answer_id": 58749362, "question_id": 58747762, "link": "https://stackoverflow.com/questions/58747762/what-is-the-appropriate-value-of-type-integer-and-can-i-write-one-also-newt/58749362#58749362", "title": "what is the &quot;appropriate value of type `Integer`&quot; and can I write one; also newtypes", "body": "<blockquote>\n  <p>Can I write it in source Haskell?</p>\n</blockquote>\n\n<p>Sort of.</p>\n\n<p>You can write <code>4 :: Integer</code> but <code>4</code> is already an application of <code>fromInteger</code> to \"an appropriate value\". <code>:: Integer</code> only selects an appropriate overload for <code>fromInteger</code>. The application has type <code>Integer</code> though, so it can function like a magic monomorphic literal.</p>\n\n<blockquote>\n<pre><code>newtype Age = MkAge Int  deriving (Num, Eq, Ord, Show)\n</code></pre>\n</blockquote>\n\n<p>You can write <code>4 :: Age</code> now and this is OK. This has nothing to do with what <code>Show</code> does. You can write your own <code>Show</code> instance that prints a plain <code>4</code> instead of <code>MkAge 4</code>. This is how <code>Show</code> instances for all the built-in types work. The following is GHC-specific, other implementations may have different details, but the general principles are likely to be the same.</p>\n\n<pre><code>Prelude&gt; :i Int\ndata Int = GHC.Types.I# Int#    -- Defined in \u2018GHC.Types\u2019\nPrelude&gt; :i Integer\ndata Integer\n  = integer-gmp-1.0.2.0:GHC.Integer.Type.S# Int#\n  | integer-gmp-1.0.2.0:GHC.Integer.Type.Jp# {-# UNPACK #-}integer-gmp-1.0.2.0:GHC.Integer.Type.BigNat\n  | integer-gmp-1.0.2.0:GHC.Integer.Type.Jn# {-# UNPACK #-}integer-gmp-1.0.2.0:GHC.Integer.Type.BigNat\n    -- Defined in \u2018integer-gmp-1.0.2.0:GHC.Integer.Type\u2019\n</code></pre>\n\n<p>As you can see, there are data constructors (and they are not <em>that</em> invisible!) for <code>Int</code> and <code>Integer</code>. We can use the one for <code>Int</code> no problem. </p>\n\n<pre><code>Prelude&gt; :set -XMagicHash\nPrelude&gt; :t 3#\n3# :: GHC.Prim.Int#\nPrelude&gt; :t GHC.Types.I# 3#\nGHC.Types.I# 3# :: Int\nPrelude&gt; show 3\n\"3\"\nPrelude&gt; show $ GHC.Types.I# 3#\n\"3\"\n</code></pre>\n\n<p>OK we have built an <code>Int</code> with a constructor, which doesn't interfere with showing it as a plain <code>3</code> one little bit. It is an application of a bona fide constructor to an honest monomorphic literal. What about <code>Integer</code>?</p>\n\n<pre><code>Prelude&gt; GHC.Integer.Type.S# 3#\n\n&lt;interactive&gt;:16:1: error:\n    Not in scope: data constructor \u2018GHC.Integer.Type.S#\u2019\n    No module named \u2018GHC.Integer.Type\u2019 is imported.\nPrelude&gt;\n</code></pre>\n\n<p>Hmm.</p>\n\n<pre><code>Prelude&gt; :m + GHC.Integer.Type\n\n&lt;no location info&gt;: error:\n    Could not load module \u2018GHC.Integer.Type\u2019\n    it is a hidden module in the package \u2018integer-gmp-1.0.2.0\u2019\n</code></pre>\n\n<p>So <code>Integer</code> constructors are hidden from the programmer (intentionally I suppose). But if you were writing <code>GHC.Integer.Type</code> itself you would be able to use <code>GHC.Integer.Type.S# 3#</code>. This has type <code>Integer</code> and is again an application of a bona fide constructor to an honest monomorphic literal.</p>\n"}], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 58749362, "answer_count": 2, "score": 1, "last_activity_date": 1573131751, "creation_date": 1573125923, "last_edit_date": 1573128202, "question_id": 58747762, "link": "https://stackoverflow.com/questions/58747762/what-is-the-appropriate-value-of-type-integer-and-can-i-write-one-also-newt", "title": "what is the &quot;appropriate value of type `Integer`&quot; and can I write one; also newtypes", "body": "<p>Haskell 2010 report section 6.4.1 says</p>\n\n<blockquote>\n  <p>An integer literal represents the application of the function <code>fromInteger</code> to the appropriate value of type <code>Integer</code>.</p>\n</blockquote>\n\n<p>What does that \"appropriate value\" look like? Can I write it in source Haskell? I could of course write</p>\n\n<pre><code>x :: Integer\nx = 4\n</code></pre>\n\n<p>But that equation is equivalent to</p>\n\n<pre><code>x = (fromInteger 4) :: Integer\n</code></pre>\n\n<p><strong>Edit:</strong> hmm to avoid infinite regress that should probably be</p>\n\n<pre><code>x = (fromInteger 4?) :: Integer\n</code></pre>\n\n<p>in which <code>4?</code> is the mysterious value <code>4</code> at type <code>Integer</code>.</p>\n\n<p>so it's selecting the <code>Integer</code> overloading of <code>fromInteger</code>. The type of the literal (in the original <code>x = 4</code>) is still <code>4 :: Num a =&gt; a</code>, it's not type <code>Integer</code>.</p>\n\n<p>I'm thinking about this wrt <code>newtype</code>s:</p>\n\n<pre><code>{-# LANGUAGE  GeneralisedNewtypeDeriving  #-}\n\nnewtype Age = MkAge Int  deriving (Num, Eq, Ord, Show)\n                        -- fromInteger is in Num\ny :: Age\ny = 4  \nz = (4 + 5 :: Age)      -- no decl for z, inferred :: Age\n</code></pre>\n\n<p>If I ask to <code>show y</code> I see <code>MkAge 4</code>; if I ask to <code>show x</code> I see plain <code>4</code>. So is there some invisible constructor for <code>Integer</code>s?</p>\n\n<p>Supplementary q for <code>newtype</code>s: since I can write <code>z = (4 + 5 :: Age)</code> is the constructor <code>MkAge</code> really necessary?</p>\n\n<pre><code>mkAge2 :: Age -&gt; Age\nmkAge2 = id\n\nw = mkAge2 4\n\nmkAge3 :: Integer -&gt; Age\nmkAge3 = fromInteger\n\nu = mkAge3 4\n</code></pre>\n\n<p>seems to work just as well, if I want something prefix.</p>\n"}, {"tags": ["haskell", "functor", "applicative"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1573102245, "post_id": 58742123, "comment_id": 103773631, "body": "Are you suggesting that an applicative functor should be able to crack open any other functor?"}, {"owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1573102406, "post_id": 58742123, "comment_id": 103773657, "body": "I am not suggesting anything. But I just wanted to know the reason for having the same effect for functions and data they may apply. Btw I am in a reading phase, just started learning Haskell from past 2 months."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1573103043, "post_id": 58742123, "comment_id": 103773777, "body": "Each instance of Applicative necessarily has its own implementation of <code>&lt;*&gt;</code>. That&#39;s why we have type classes in the first place. Your code has all the methods defined in the class itself, nothing is left for instances. This means you don&#39;t have much of a type class at all, but just a bunch of generic functions. All the meat is delegated to the arguments of peelOuter and cleanInner which you cannot in general provide for all functors."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1573112774, "post_id": 58742123, "comment_id": 103777137, "body": "For the question in your final code block, there is an alternative instance for lists (necessarily wrapped in a <code>newtype</code>) called <code>ZipList</code> that does this."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1573114470, "post_id": 58742123, "comment_id": 103777893, "body": "Your <code>Just (*2) &lt;*&gt; [1,2,3,4]</code> equivalent to <code>Compose (Just [*2]) &lt;*&gt; Compose (Just [1,2,3,4])</code>"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1573114698, "post_id": 58742123, "comment_id": 103777998, "body": "Your <code>(&lt;&lt;*&gt;&gt;) elfm (Just (*2)) [1,2,3,4]</code> equivalent to <code>(elfm . getCompose) $ Compose (Just [(*2)]) &lt;*&gt; Compose (Just [1,2,3,4])</code>"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1573114873, "post_id": 58742123, "comment_id": 103778086, "body": "Your <code>(&gt;&gt;*&lt;&lt;) flem (Just (++ &quot;Haskell&quot;)) [&quot;Hello, &quot;]</code> equivalent to <code>(flem . getCompose) $ Compose (Just [(++ &quot;Haskell&quot;)]) &lt;*&gt; Compose (Just [&quot;Hello, &quot;])</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 0, "creation_date": 1573116054, "post_id": 58744115, "comment_id": 103778662, "body": "Can you please comment on my questions to the end."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 0, "creation_date": 1573116468, "post_id": 58744115, "comment_id": 103778876, "body": "You mean, on the other Applicative instance for lists? That&#39;s ZipList as the comments say."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1573116684, "last_edit_date": 1573116684, "creation_date": 1573112844, "answer_id": 58744115, "question_id": 58742123, "link": "https://stackoverflow.com/questions/58742123/in-haskell-why-applicatives-need-to-take-morphisms-and-data-in-same-context/58744115#58744115", "title": "In Haskell why Applicatives need to take morphisms and data in same Context?", "body": "<p>Each instance of <code>Applicative</code> necessarily has its own implementation of <code>&lt;*&gt;</code>. That's why we have type classes in the first place. Your code has all the methods defined in the class itself, nothing is left for instances. This means there isn't much of a type class at all. There's just a bunch of generic functions. All the meat is delegated to the arguments <code>peelOuter</code> and <code>cleanInner</code> of <code>('&lt;&lt;*&gt;&gt;)</code> and <code>(&gt;&gt;*&lt;&lt;)</code>. Let's look at them more closely. They are more or less symmetrical so <code>(&lt;&lt;*&gt;&gt;)</code> should be enough.</p>\n\n<pre><code>(&lt;&lt;*&gt;&gt;) :: Functor g =&gt; (g (f a) -&gt; f a) -&gt; g (a -&gt; b) -&gt; f a -&gt; f b\n(&lt;&lt;*&gt;&gt;) peelOuter gab fa = peelOuter $ gab &lt;*&gt; fa\n</code></pre>\n\n<p>It's actually <code>peelOuter</code> that should have been a method of a type class, but there is more than one problem with that. </p>\n\n<p>The first problem that there are two functors involved, and <code>peelOuter</code>  needs to be implemented separately for each <em>pair</em> of functors. That is, we would have a bi-parametric type class <code>ApplicativePair</code> here, and we would need a separate instance for each pair.</p>\n\n<p>The second problem is that <code>peelOuter</code> cannot be implemented for every pair of bona fide <code>Applicative</code> functors. One cannot extract an <code>Id a</code> from a <code>Maybe (Id a)</code>, or a <code>[a]</code> from an <code>IO [a]</code>, or ... </p>\n\n<p>Worse yet, it isn't clear if it is always implementable when <code>f</code> and <code>g</code> are the same functor. Clearly, when <code>f</code> is a monad, then it's just a <code>join</code>. Not all applicatives are monads however, and <code>join</code> is precisely what an applicative lacks to be a monad. So <code>peelOuter</code>, even if such a type is implementable, would violate some monad laws. Is that a bad thing? Not necessarily, if it still follows applicative laws. You however have not supplied any laws, only a bunch of functions. </p>\n"}, {"comments": [{"owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 0, "creation_date": 1573116147, "post_id": 58744726, "comment_id": 103778712, "body": "Thanks for the the clarity. Can you also please comment on my questions to the end."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 1, "creation_date": 1573117103, "post_id": 58744726, "comment_id": 103779182, "body": "@PKChem, I wrote answer in the body."}], "tags": [], "owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "is_accepted": false, "score": 1, "last_activity_date": 1573118325, "last_edit_date": 1573118325, "creation_date": 1573115563, "answer_id": 58744726, "question_id": 58742123, "link": "https://stackoverflow.com/questions/58742123/in-haskell-why-applicatives-need-to-take-morphisms-and-data-in-same-context/58744726#58744726", "title": "In Haskell why Applicatives need to take morphisms and data in same Context?", "body": "<p>Any two functors are <strong>Functor</strong> and <strong>Applicative</strong> functors. This coded with <code>newtype Compose</code>, see <code>Data.Functor.Compose</code>.</p>\n\n<p>So, your examples can be solved by <code>newtype Compose</code>.</p>\n\n<pre><code>-- Just (*2) &lt;*&gt; [1,2,3,4]\ngetCompose $ pure (*2) &lt;*&gt; Compose (Just [1,2,3,4])\n-- or\ngetCompose $ (*2) &lt;$&gt; Compose (Just [1,2,3,4])\n-- Just [2,4,6,8]\n\n-- (&lt;&lt;*&gt;&gt;) elfm (Just (*2)) [1,2,3,4]\nelfm . getCompose $ pure (*2) &lt;*&gt; Compose (Just [1,2,3,4])\n-- or with toList (method of Foldable)\ntoList $ pure (*2) &lt;*&gt; Compose (Just [1,2,3,4])\n-- or\ntoList $ (*2) &lt;$&gt; Compose (Just [1,2,3,4])\n-- [2,4,6,8]\n\n-- (&gt;&gt;*&lt;&lt;) flem (Just (++ \"Haskell\")) [\"Hello, \"]\nflem . getCompose $ pure (++ \"Haskell\") &lt;*&gt; Compose (Just [\"Hello, \"])\n-- or with toList and listToMaybe\nlistToMaybe . toList $ pure (++ \"Haskell\") &lt;*&gt; Compose (Just [\"Hello, \"])\n-- or\nlistToMaybe . toList $ (++ \"Haskell\") &lt;$&gt; Compose (Just [\"Hello, \"])\n-- or with head :: Foldable f =&gt; f a -&gt; Maybe a\nhead $ (++ \"Haskell\") &lt;$&gt; Compose (Just [\"Hello, \"])\n-- Just \"Hello, Haskell\"\n</code></pre>\n\n<hr>\n\n<p>About the last question. You have got an answer in comments by @Robin Zigmond. It wrote about the <code>newtype ZipList</code>. With <code>ZipList</code> you can do:</p>\n\n<pre><code>getZipList $ (+) &lt;$&gt; ZipList [1,2,3] &lt;*&gt; ZipList [4,5,6]\n-- [5,7,9]\n</code></pre>\n\n<p>So, one of the purposes of newtype in Haskell is the ability to write different instances for some type.</p>\n"}], "owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 1, "accepted_answer_id": 58744115, "answer_count": 2, "score": 2, "last_activity_date": 1573118325, "creation_date": 1573101983, "last_edit_date": 1573104809, "question_id": 58742123, "link": "https://stackoverflow.com/questions/58742123/in-haskell-why-applicatives-need-to-take-morphisms-and-data-in-same-context", "title": "In Haskell why Applicatives need to take morphisms and data in same Context?", "body": "<p>I am new to Haskell. This may be stupid question.</p>\n\n<p>As the Applicative typeclass has <strong>apply</strong> function that takes the functions and data in the same context. Why can't it be different and be more generic.</p>\n\n<pre><code>class Functor f =&gt; Applicative f where\n    pure :: a -&gt; f a\n    (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>Why can't we write something like this</p>\n\n<pre><code>class Functor f =&gt; Applicative f where\n    (&lt;*&gt;) :: Functor g =&gt; g (a -&gt; b) -&gt; f a -&gt; g (f b)\n    (&lt;*&gt;) gab fa = fmap (\\g -&gt; fmap g fa) gab\n\n    (&lt;&lt;*&gt;&gt;) :: Functor g =&gt; (g (f a) -&gt; f a) -&gt; g (a -&gt; b) -&gt; f a -&gt; f b\n    (&lt;&lt;*&gt;&gt;) peelOuter gab fa = peelOuter $ gab &lt;*&gt; fa\n\n    (&gt;&gt;*&lt;&lt;) :: Functor g =&gt; (g (f a) -&gt; g a) -&gt; g (a -&gt; b) -&gt; f a -&gt; g b\n    (&gt;&gt;*&lt;&lt;) cleanInner gab fa = cleanInner $ gab &lt;*&gt; fa\n</code></pre>\n\n<p>It can be used as below</p>\n\n<pre><code>-- Extract List from maybe\nelfm :: Maybe [a] -&gt; [a]\nelfm Nothing = []\nelfm (Just xs) = xs\n\n-- Fuse List elements in Maybe []\nflem :: Monoid a =&gt; Maybe [a] -&gt; Maybe a\nflem Nothing = mempty\nflem (Just xs) = Just $ foldl (&lt;&gt;) mempty xs\n\nJust (*2) &lt;*&gt; [1,2,3,4]\n-- Just [2,4,6,8]\n(&lt;&lt;*&gt;&gt;) elfm (Just (*2)) [1,2,3,4]\n-- [2,4,6,8]\n(&gt;&gt;*&lt;&lt;) flem (Just (++ \"Haskell\")) [\"Hello, \"]\n-- Just \"Hello, Haskell\"\n</code></pre>\n\n<p>And I read that the whole point of having Applicatives is the drawback of Functors lifting multi argument functions. Is this right?</p>\n\n<p>And I don't think the function application is as expected.</p>\n\n<pre><code>add :: Num a =&gt; a -&gt; a -&gt; a\nadd a b = a + b\n\n-- I want to apply [1,2,3] as First arguments and [4,5,6] as 2nd arguments.\n-- Like add 1 4, add 2 4, add 3 6\n-- But it is give all possibilities of combinations like a tree\n\n--                          &lt;*&gt;\n--      (+1)                (+2)            (+3)\n-- (1+4)(1+5)(1+6)  (2+4)(2+5)(2+6)  (3+4)(3+5)(3+6)\n\n</code></pre>\n\n<p>And also they are compared to batch processing, but no quite real life example is given. Please provide an example for this.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 362, "user_id": 4762234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880403468672301/picture?type=large", "display_name": "Yogendra", "link": "https://stackoverflow.com/users/4762234/yogendra"}, "edited": false, "score": 0, "creation_date": 1573107628, "post_id": 58741810, "comment_id": 103775023, "body": "you should also add type synonyms you are using to the question detail."}], "answers": [{"tags": [], "owner": {"reputation": 362, "user_id": 4762234, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/880403468672301/picture?type=large", "display_name": "Yogendra", "link": "https://stackoverflow.com/users/4762234/yogendra"}, "is_accepted": true, "score": 1, "last_activity_date": 1573107481, "creation_date": 1573107481, "answer_id": 58742987, "question_id": 58741810, "link": "https://stackoverflow.com/questions/58741810/replace-element-in-nested-list/58742987#58742987", "title": "Replace element in nested list", "body": "<p>you are not using <code>setRowAt</code> correctly in <code>setBoardAt</code>.</p>\n\n<p>What you are doing right now is taking each element from a row, and passing a list containing this element to setRowAt function. What you should instead do is something like following</p>\n\n<pre><code>setBoardAt b i j v = take i b ++ [setRowAt (b!!i) j v] ++ drop (i + 1) b\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 10387237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8aad23d6bc478eb05e7ec9c1bc4c25a?s=128&d=identicon&r=PG&f=1", "display_name": "Clarke Woogner", "link": "https://stackoverflow.com/users/10387237/clarke-woogner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 58742987, "answer_count": 1, "score": -2, "last_activity_date": 1573107481, "creation_date": 1573099270, "question_id": 58741810, "link": "https://stackoverflow.com/questions/58741810/replace-element-in-nested-list", "title": "Replace element in nested list", "body": "<p>I am working on a sudoku problem and trying to create a setBoardAt function that will update one of the values in one of the rows within the board to a new value using a setRowAt function.</p>\n\n<pre><code>setRowAt :: Sequence -&gt; Int -&gt; Int -&gt; Sequence\nsetRowAt s i v = take i s ++ [v] ++ drop (i + 1) s\n\nsetBoardAt :: Board -&gt; Int -&gt; Int -&gt; Int -&gt; Board\nsetBoardAt b i j v = take i b ++ [setRowAt [s] j v | s &lt;- b !! i] ++ drop (i + 1) b \n</code></pre>\n\n<p>In my main I can use the setRowAt function and return the expected results with what I have mapped out in the setBoardAt function</p>\n\n<pre><code>main = do\n\n  args &lt;- getArgs\n  txt  &lt;- readFile (head args)\n  let board1 = getBoard txt\n  print board1\n  let seq1 = board1 !! 5\n  print seq1\n  let row1 = setRowAt seq1 2 5\n  print row1\n  let nboard1 = take 1 board1 ++ [row1] ++ drop (1 + 1) board1\n\n</code></pre>\n\n<p>results received are correct</p>\n\n<pre><code>[[5,3,0,0,7,0,0,0,0],[6,0,0,1,9,5,0,0,0],[0,9,8,0,0,0,0,6,0],[8,0,0,0,6,0,0,0,3],[4,0,0,8,0,3,0,0,1],[7,0,0,0,2,0,0,0,6],[0,6,0,0,0,0,2,8,0],[0,0,0,4,1,9,0,0,5],[0,0,0,0,8,0,0,7,9]]\n[7,0,0,0,2,0,0,0,6]\n[7,0,5,0,2,0,0,0,6]\n</code></pre>\n\n<p>but when I try to use the setBoardAt function using the same parameters and the nested setRowAt function, the row that I am manipulating returns incorrectly and I can't pinpoint why.</p>\n\n<pre><code>main = do\n\n  args &lt;- getArgs\n  txt  &lt;- readFile (head args)\n  let board1 = getBoard txt\n  print board1\n  let test1 = setBoardAt board1 5 2 5\n  print test1\n\n</code></pre>\n\n<pre><code>[[5,3,0,0,7,0,0,0,0],[7,0,5,0,2,0,0,0,6],[0,9,8,0,0,0,0,6,0],[8,0,0,0,6,0,0,0,3],[4,0,0,8,0,3,0,0,1],[7,0,0,0,2,0,0,0,6],[0,6,0,0,0,0,2,8,0],[0,0,0,4,1,9,0,0,5],[0,0,0,0,8,0,0,7,9]]\n[[5,3,0,0,7,0,0,0,0],[6,0,0,1,9,5,0,0,0],[0,9,8,0,0,0,0,6,0],[8,0,0,0,6,0,0,0,3],[4,0,0,8,0,3,0,0,1],[7,5],[0,5],[0,5],[0,5],[2,5],[0,5],[0,5],[0,5],[6,5],[0,6,0,0,0,0,2,8,0],[0,0,0,4,1,9,0,0,5],[0,0,0,0,8,0,0,7,9]]\n\n</code></pre>\n\n<p>Any suggestions or insight would be appreciated. </p>\n"}, {"tags": ["haskell", "foldleft"], "answers": [{"tags": [], "owner": {"reputation": 2088, "user_id": 4281998, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/q8Jvt.png?s=128&g=1", "display_name": "Brady Dean", "link": "https://stackoverflow.com/users/4281998/brady-dean"}, "is_accepted": false, "score": 0, "last_activity_date": 1573095455, "creation_date": 1573095455, "answer_id": 58741322, "question_id": 58741251, "link": "https://stackoverflow.com/questions/58741251/concatenate-list-of-strings-adding-a-separator-in-between-using-foldl-haskell/58741322#58741322", "title": "Concatenate List of Strings, adding a separator in between using foldl Haskell", "body": "<p>I think you can solve this simply by checking if the first argument is the empty string and handling it accordingly</p>\n\n<pre><code>sepConcat sep = foldl (\\x y -&gt; if x == \"\" then y else x ++ sep ++ y) \"\"\n-- or\nsepConcat sep = foldl combine \"\"\n  where combine \"\" x = x\n        combine x y = x ++ sep ++ y\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 0, "last_activity_date": 1573101721, "last_edit_date": 1573101721, "creation_date": 1573095673, "answer_id": 58741349, "question_id": 58741251, "link": "https://stackoverflow.com/questions/58741251/concatenate-list-of-strings-adding-a-separator-in-between-using-foldl-haskell/58741349#58741349", "title": "Concatenate List of Strings, adding a separator in between using foldl Haskell", "body": "<p>The huge problem is your pattern matching:</p>\n\n<pre><code>sepConcat sep []     = \"\"\nsepConcat sep (x:xs) = foldLeft f base l\n</code></pre>\n\n<p>You don't need to divide the patterns again in <code>[]</code> and <code>(x:xs)</code> because <strong>foldl</strong> and <strong>foldr</strong> take care of <strong>both cases</strong>. This is how <code>foldl</code> can be defined to list with recursion:</p>\n\n<pre><code>foldLeft :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldLeft f base []     = base\nfoldLeft f base (x:xs) = f (foldLeft f base xs) x\n</code></pre>\n\n<p>you just need to apply correctly both cases:</p>\n\n<pre><code>sepConcat :: String -&gt; [String] -&gt; String\nsepConcat sep xs = foldLeft (\\rs s -&gt;\n if null rs \n then s ++ rs\n else s ++ sep ++ rs) \"\" xs\n</code></pre>\n\n<p>Here the case of the empty list is <code>\"\"</code> and the function is for the recursive case of the list</p>\n\n<p>with your example:</p>\n\n<pre><code>sepConcat \", \" [\"foo\", \"bar\", \"baz\"]\n=&gt; \"foo, bar, baz\"\n</code></pre>\n"}], "owner": {"reputation": 422, "user_id": 5000759, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/414464cba2bb1dad8bb77798b6f04d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Myers", "link": "https://stackoverflow.com/users/5000759/scott-myers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 341, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1573101721, "creation_date": 1573094799, "question_id": 58741251, "link": "https://stackoverflow.com/questions/58741251/concatenate-list-of-strings-adding-a-separator-in-between-using-foldl-haskell", "title": "Concatenate List of Strings, adding a separator in between using foldl Haskell", "body": "<p>I have a function that is meant to combine strings in a list, adding a separator in between each and outputting a single string using foldl. Here is what I have and some expected behavior of the function -- It isn't working and I'm unsure why.</p>\n\n<pre><code>-- | `sepConcat sep [s1,...,sn]` returns `s1 ++ sep ++ s2 ++ ... ++ sep ++ sn`\n--\n-- &gt;&gt;&gt; sepConcat \"---\" []\n-- \"\"\n--\n-- &gt;&gt;&gt; sepConcat \", \" [\"foo\", \"bar\", \"baz\"]\n-- \"foo, bar, baz\"\n--\n-- &gt;&gt;&gt; sepConcat \"#\" [\"a\",\"b\",\"c\",\"d\",\"e\"]\n-- \"a#b#c#d#e\"\n\nsepConcat :: String -&gt; [String] -&gt; String\nsepConcat sep []     = \"\"\nsepConcat sep (x:xs) = foldLeft f base l\n  where\n    f a x            = a ++ sep ++ x\n    base             = \"\"\n    l                = xs\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1281, "user_id": 6647585, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cac5dd1f2f2645dcc1dbf1165fed77c6?s=128&d=identicon&r=PG&f=1", "display_name": "Vlam", "link": "https://stackoverflow.com/users/6647585/vlam"}, "edited": false, "score": 1, "creation_date": 1573095959, "post_id": 58741351, "comment_id": 103772428, "body": "I believe that you meant <code>mylist &lt;- createList maxtests []</code> for the third problem. Compiles and works fine now. Thanks!"}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 1281, "user_id": 6647585, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cac5dd1f2f2645dcc1dbf1165fed77c6?s=128&d=identicon&r=PG&f=1", "display_name": "Vlam", "link": "https://stackoverflow.com/users/6647585/vlam"}, "edited": false, "score": 0, "creation_date": 1573095985, "post_id": 58741351, "comment_id": 103772434, "body": "@Vlam Yep, fixed now."}, {"owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "reply_to_user": {"reputation": 1281, "user_id": 6647585, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cac5dd1f2f2645dcc1dbf1165fed77c6?s=128&d=identicon&r=PG&f=1", "display_name": "Vlam", "link": "https://stackoverflow.com/users/6647585/vlam"}, "edited": false, "score": 0, "creation_date": 1573096795, "post_id": 58741351, "comment_id": 103772579, "body": "@Vlam Also, I edited in some extra tips, some of which you may find useful."}, {"owner": {"reputation": 1281, "user_id": 6647585, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cac5dd1f2f2645dcc1dbf1165fed77c6?s=128&d=identicon&r=PG&f=1", "display_name": "Vlam", "link": "https://stackoverflow.com/users/6647585/vlam"}, "edited": false, "score": 1, "creation_date": 1573097204, "post_id": 58741351, "comment_id": 103772652, "body": "The code looks so simple and clean now. Thanks a lot!!"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1573097233, "last_edit_date": 1573097233, "creation_date": 1573095682, "answer_id": 58741351, "question_id": 58741072, "link": "https://stackoverflow.com/questions/58741072/trying-to-print-out-a-list-of-random-ips-but-keep-encountering-errors-in-haskell/58741351#58741351", "title": "Trying to print out a list of random IPs but keep encountering errors in Haskell", "body": "<p>Your problems all stem from not handling IO correctly.</p>\n\n<p>First problem: <code>createList</code> calls <code>randomIP</code>, and <code>randomIP</code>'s result is in IO. Thus, <code>createList</code> must have its result in IO too. So change <code>createList :: Int -&gt; [[Char]] -&gt; [[Char]]</code> to <code>createList :: Int -&gt; [[Char]] -&gt; IO [[Char]]</code>.</p>\n\n<p>Second problem: Since <code>createList</code>'s result is in IO, the recursive call to itself must unwrap the IO. So change <code>let mylist3 = createList (n-1) mylist2</code> to <code>mylist3 &lt;- createList (n-1) mylist2</code>.</p>\n\n<p>Third problem: Since <code>createList</code>'s result is in IO, <code>main</code>'s call to it must unwrap the IO. So change <code>let mylist = createList maxtests []</code> to <code>mylist &lt;- createList maxtests []</code>.</p>\n\n<p>With all of those changes, it compiles.</p>\n\n<hr>\n\n<p>Bonus material below here:</p>\n\n<p>Also, note that you've unnecessarily reimplemented a few functions that are already built in to Haskell: <code>replicateM</code>, <code>intercalate</code>, and <code>map</code>.</p>\n\n<p>To make use of <code>intercalate</code> and <code>map</code>, change <code>let myip = (show (myarr !! 0)) ++ \".\" ++ (show (myarr !! 1)) ++ \".\" ++ (show (myarr !! 2)) ++ \".\" ++ (show (myarr !! 3))</code> to <code>let myip = intercalate \".\" (map show myarr)</code>.</p>\n\n<p>Making use of <code>replicateM</code> requires much larger changes, so I'll just show you the result:</p>\n\n<pre><code>import System.Random (randomRIO)\nimport Data.List\nimport Control.Monad.Cont\n\nmain :: IO ()\nmain = do\n    let maxtests = 5\n    mylist &lt;- createList maxtests\n    forM_ mylist $ \\ip -&gt; do\n        print ip\n\ncreateList :: Int -&gt; IO [[Char]]\ncreateList n = replicateM n $ do\n    myarr &lt;- randomIp 4\n    let myip = intercalate \".\" (map show myarr)\n    return myip\n\nrandomIp :: Int -&gt; IO [Int]\nrandomIp n = replicateM n $ do\n    r  &lt;- randomRIO (0,255)\n    return r\n</code></pre>\n\n<p>You can even continue the refactoring further if you want, to something like this:</p>\n\n<pre><code>import System.Random (randomRIO)\nimport Control.Monad\nimport Data.Foldable\nimport Data.List\n\nmain :: IO ()\nmain = do\n    let maxtests = 5\n    mylist &lt;- createList maxtests\n    for_ mylist print\n\ncreateList :: Int -&gt; IO [[Char]]\ncreateList n = replicateM n $ intercalate \".\" . map show &lt;$&gt; randomIp 4\n\nrandomIp :: Int -&gt; IO [Int]\nrandomIp n = replicateM n $ randomRIO (0,255)\n</code></pre>\n"}], "owner": {"reputation": 1281, "user_id": 6647585, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/cac5dd1f2f2645dcc1dbf1165fed77c6?s=128&d=identicon&r=PG&f=1", "display_name": "Vlam", "link": "https://stackoverflow.com/users/6647585/vlam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 58741351, "answer_count": 1, "score": 1, "last_activity_date": 1573097233, "creation_date": 1573093196, "question_id": 58741072, "link": "https://stackoverflow.com/questions/58741072/trying-to-print-out-a-list-of-random-ips-but-keep-encountering-errors-in-haskell", "title": "Trying to print out a list of random IPs but keep encountering errors in Haskell", "body": "<p>I am not very experienced in Haskell so I am not too sure what's going on. I want to generate a list of random IP addresses and print them out but I keep encountering the errors below:</p>\n\n<p><strong>My code:</strong></p>\n\n<pre><code>import System.Random (randomRIO)\nimport Data.List\nimport Control.Monad.Cont\n\nmain :: IO ()\nmain = do\n    let maxtests = 5\n    let mylist = createList maxtests []\n    forM_ mylist $ \\ip -&gt; do\n        print ip\n\ncreateList :: Int -&gt; [[Char]] -&gt; [[Char]]\ncreateList 0 mylist = return mylist\ncreateList n mylist = do\n    myarr &lt;- randomIp 4\n    let myip = (show (myarr !! 0)) ++ \".\" ++ (show (myarr !! 1)) ++ \".\" ++ (show (myarr !! 2)) ++ \".\" ++ (show (myarr !! 3))\n    let mylist2 = mylist ++ [myip]\n    let mylist3 = createList (n-1) mylist2\n    return mylist3\n\nrandomIp :: Int -&gt; IO([Int])\nrandomIp 0 = return []\nrandomIp n = do\n    r  &lt;- randomRIO (0,255)\n    rs &lt;- randomIp (n-1)\n    return (r:rs) \n</code></pre>\n\n<p><strong>Error messages when I compile:</strong></p>\n\n<pre><code>test2.hs:13:23: error:\n    * Couldn't match type `[Char]' with `Char'\n      Expected type: [[Char]]\n        Actual type: [[[Char]]]\n    * In the expression: return mylist\n      In an equation for `createList':\n          createList 0 mylist = return mylist\n   |\n13 | createList 0 mylist = return mylist\n   |                       ^^^^^^^^^^^^^\n\ntest2.hs:15:14: error:\n    * Couldn't match type `IO' with `[]'\n      Expected type: [[Int]]\n        Actual type: IO [Int]\n    * In a stmt of a 'do' block: myarr &lt;- randomIp 4\n      In the expression:\n        do myarr &lt;- randomIp 4\n           let myip\n                 = (show (myarr !! 0))\n                     ++\n                       \".\"\n                         ++\n                           (show (myarr !! 1))\n                             ++ \".\" ++ (show (myarr !! 2)) ++ \".\" ++ (show (myarr !! 3))\n           let mylist2 = mylist ++ ...\n           let mylist3 = createList (n - 1) mylist2\n           ....\n      In an equation for `createList':\n          createList n mylist\n            = do myarr &lt;- randomIp 4\n                 let myip = ...\n                 let mylist2 = ...\n                 ....\n   |\n15 |     myarr &lt;- randomIp 4\n   |              ^^^^^^^^^^\n\ntest2.hs:19:5: error:\n    * Couldn't match type `[Char]' with `Char'\n      Expected type: [[Char]]\n        Actual type: [[[Char]]]\n    * In a stmt of a 'do' block: return mylist3\n      In the expression:\n        do myarr &lt;- randomIp 4\n           let myip\n                 = (show (myarr !! 0))\n                     ++\n                       \".\"\n                         ++\n                           (show (myarr !! 1))\n                             ++ \".\" ++ (show (myarr !! 2)) ++ \".\" ++ (show (myarr !! 3))\n           let mylist2 = mylist ++ ...\n           let mylist3 = createList (n - 1) mylist2\n           ....\n      In an equation for `createList':\n          createList n mylist\n            = do myarr &lt;- randomIp 4\n                 let myip = ...\n                 let mylist2 = ...\n                 ....\n   |\n19 |     return mylist3\n   |     ^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Would appreciate any pointers on what I'm doing wrong.</p>\n"}, {"tags": ["haskell", "foldleft"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573087557, "post_id": 58740419, "comment_id": 103770712, "body": "What do <i>you</i> think <code>foldLeft</code> and <code>base</code> should be? Do you have no intuition at all? PS the function is called <code>foldl</code>, there is no such thing as <code>foldLeft</code>. (And I&#39;m not convinced this will work as desired with a left fold, although I&#39;d have to think about it - it&#39;s usually more natural in Haskell to use a right fold.)"}, {"owner": {"reputation": 422, "user_id": 5000759, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/414464cba2bb1dad8bb77798b6f04d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Myers", "link": "https://stackoverflow.com/users/5000759/scott-myers"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573087864, "post_id": 58740419, "comment_id": 103770772, "body": "I&#39;m very new to haskell -- but imagining that foldLeft is identical to foldl. Just a little stunted as to where to start"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573087966, "post_id": 58740419, "comment_id": 103770802, "body": "Start by writing down the types that <code>f</code> and <code>base</code> must have. (I accidentally wrote <code>foldLeft</code> in the first sentence of my above comment, where I meant <code>f</code>.) That should make it reasonably obvious what they should be."}, {"owner": {"reputation": 422, "user_id": 5000759, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/414464cba2bb1dad8bb77798b6f04d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Myers", "link": "https://stackoverflow.com/users/5000759/scott-myers"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573088608, "post_id": 58740419, "comment_id": 103770932, "body": "I figure that <code>base</code> should be <code>fs</code>. I&#39;ve added expected results of the functions to my post. <code>f</code> should be a function that somehow stacks the function of the previous term with &#39;fs&#39; at the center. I could be far off here, im pretty lost."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573088863, "post_id": 58740419, "comment_id": 103770981, "body": "I understand what you want the function to do (and <code>foldl</code> does work just as well as <code>foldr</code>, I checked). But <code>base</code> cannot be <code>fs</code>, as they have different types. Seriously, write down the types of <code>f</code> and <code>base</code> - it will make things a lot clearer. You&#39;d be surprised how far you can get with Haskell just by making sure types match up. Another way to think about <code>base</code> is: what do you expect <code>pipe</code> to do if given an empty list?"}, {"owner": {"reputation": 422, "user_id": 5000759, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/414464cba2bb1dad8bb77798b6f04d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Myers", "link": "https://stackoverflow.com/users/5000759/scott-myers"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573089296, "post_id": 58740419, "comment_id": 103771046, "body": "Ok, I&#39;ve written down the types of <code>f</code> and <code>base</code> as: <code>f :: (a -&gt; b -&gt; a)</code> and base should be an integer  I&#39;m still unsure as to how to apply the term of the list as a function in <code>f</code>"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573089476, "post_id": 58740419, "comment_id": 103771085, "body": "Those types aren&#39;t correct. Compare the type of <code>foldl</code> with those of your list and the final output that you want."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1573089539, "post_id": 58740419, "comment_id": 103771096, "body": "Another way to look at it is: you want to combine a bunch of functions into a single function. What tools (= functions or operators) does Haskell provide for doing that?"}], "answers": [{"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": true, "score": 2, "last_activity_date": 1573090481, "creation_date": 1573090481, "answer_id": 58740749, "question_id": 58740419, "link": "https://stackoverflow.com/questions/58740419/foldl-on-a-list-of-functions-in-haskell/58740749#58740749", "title": "Foldl on a list of functions in Haskell", "body": "<p>with foldl it should be:</p>\n\n<pre><code>pipe :: [(a -&gt; a)] -&gt; (a -&gt; a)\npipe fs = foldl (\\rs f -&gt; f . rs) id fs \n</code></pre>\n\n<p>or with an eta:</p>\n\n<pre><code>pipe :: [(a -&gt; a)] -&gt; (a -&gt; a)\npipe = foldl (\\rs f -&gt; f . rs) id \n</code></pre>\n\n<p>with another eta:</p>\n\n<pre><code>pipe :: [(a -&gt; a)] -&gt; (a -&gt; a)\npipe = foldl (.) id \n</code></pre>\n\n<p>taking your example:</p>\n\n<pre><code>pipe [(\\x -&gt; x * 4), (\\x -&gt; x + x)] 3\n=&gt; 24 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1573097678, "last_edit_date": 1573097678, "creation_date": 1573095227, "answer_id": 58741295, "question_id": 58740419, "link": "https://stackoverflow.com/questions/58740419/foldl-on-a-list-of-functions-in-haskell/58741295#58741295", "title": "Foldl on a list of functions in Haskell", "body": "<p><code>pipe</code> can actually be made much simpler than you'd think, and there's no need to use the rather inefficient <code>foldl</code> (you can see this even in your own parentheses&mdash;they're right-associative): just <code>flip (foldr id)</code>. Steps to get there:</p>\n\n<pre><code>pipe [f1,...,fn] x\nf1 (f2 (... (fn x)))            -- your definition of pipe\nid f1 (id f2 (... (id fn x)))   -- id x = x\nfoldr id x [f1,...,fn]          -- the definition of foldr\n</code></pre>\n"}], "owner": {"reputation": 422, "user_id": 5000759, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/414464cba2bb1dad8bb77798b6f04d6f?s=128&d=identicon&r=PG&f=1", "display_name": "Scott Myers", "link": "https://stackoverflow.com/users/5000759/scott-myers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 58740749, "answer_count": 2, "score": 2, "last_activity_date": 1573097678, "creation_date": 1573087356, "last_edit_date": 1573088626, "question_id": 58740419, "link": "https://stackoverflow.com/questions/58740419/foldl-on-a-list-of-functions-in-haskell", "title": "Foldl on a list of functions in Haskell", "body": "<p>I'm trying to write a function, <code>pipe</code> that takes a list of mathematical functions where <code>pipe [f1,...,fn] x</code> should return <code>f1(f2(...(fn x)))</code> \nI've set it up such that:</p>\n\n<pre><code>pipe :: [(a -&gt; a)] -&gt; (a -&gt; a)\npipe fs   = foldLeft f base fs\n  where\n    f a x =    \n    base  = \n\n-- &gt;&gt;&gt; pipe [] 3\n-- 3\n--\n-- &gt;&gt;&gt; pipe [(\\x -&gt; x+x), (\\x -&gt; x + 3)] 3\n-- 12\n--\n-- &gt;&gt;&gt; pipe [(\\x -&gt; x * 4), (\\x -&gt; x + x)] 3\n-- 24\n</code></pre>\n\n<p>whats the best way to go about this using foldl?\nThanks!</p>\n"}]