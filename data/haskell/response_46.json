[{"tags": ["haskell", "matrix", "linear-algebra"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1448488314, "post_id": 33926631, "comment_id": 55615030, "body": "The first error looks wrong: the source code is <code>... | numCols a &#47;= numRows b = error &quot;Matrix.times: `numRows a&#39; and `numCols b&#39; don&#39;t match.&quot;</code> which is eyebrow-raising ..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1448488424, "post_id": 33926631, "comment_id": 55615094, "body": "@chi That&#39;s the source code for the most recent release, yes -- but I bet OP isn&#39;t using the most recent release!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448493013, "post_id": 33926631, "comment_id": 55617046, "body": "@DanielWagner If that&#39;s the latest release, it still looks wrong! I also checked the github and the error is still there... Am I missing anything?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1448493476, "post_id": 33926631, "comment_id": 55617208, "body": "@chi The text of the error is backwards (actually ambiguous, because who the heck knows which argument is <code>a</code> and which is <code>b</code> without reading the source of <code>times</code>?) -- but the actual check is right. And in the old release, the text of the error matched the (wrong) check -- so it was semantically wrong but at least it was accurate to what the code actually did!"}, {"owner": {"reputation": 1593, "user_id": 1829442, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/f1b88b650cc161e532273962f4017f75?s=128&d=identicon&r=PG", "display_name": "idontgetoutmuch", "link": "https://stackoverflow.com/users/1829442/idontgetoutmuch"}, "edited": false, "score": 1, "creation_date": 1448730053, "post_id": 33926631, "comment_id": 55704118, "body": "I had never heard of this library until now. I would recommend the static part of hmatrix <a href=\"https://hackage.haskell.org/package/hmatrix-0.17.0.1/docs/Numeric-LinearAlgebra-Static.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/hmatrix-0.17.0.1/docs/&hellip;</a>. This catches row / column mismatches at compile time rather than run time. You can see an example here in an implementation of a Kalman filter: <a href=\"https://idontgetoutmuch.wordpress.com/2015/05/31/the-flow-of-the-thames-an-autoregressive-model/\" rel=\"nofollow noreferrer\">idontgetoutmuch.wordpress.com/2015/05/31/&hellip;</a>. The plethora of type signatures are mainly there to help the reader; most can be removed."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "edited": false, "score": 0, "creation_date": 1448488213, "post_id": 33926961, "comment_id": 55614987, "body": "Ok, thanks. But <code>[[1], [2], [3]]</code> is displayed (show b) like <code>1\\n 2\\n 3\\n</code>.. It&#39;s really confusing."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "reply_to_user": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "edited": false, "score": 0, "creation_date": 1448488474, "post_id": 33926961, "comment_id": 55615119, "body": "Yep.  I would probably choose a different library."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448488550, "post_id": 33926961, "comment_id": 55615163, "body": "I think <code>fromList [[1],[2],[3]]</code> is indeed intended to be a 3x1 matrix. Since <code>[[1], [2], [3]]</code> has three inner-most lists, it has three rows. This seems to mesh perfectly well with the documentation in my reading."}, {"owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "edited": false, "score": 0, "creation_date": 1448488643, "post_id": 33926961, "comment_id": 55615211, "body": "Then how is &quot;the number of columns&quot; equal to &quot;the length of the outer list&quot;?  Perhaps the documentation is incorrect or contradictory.  At a bare minimum, the documentation is poor."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448489924, "post_id": 33926961, "comment_id": 55615787, "body": "@DietrichEpp ...you&#39;re right, that excerpt is a mess. Somehow I managed to not even read the second sentence before I wrote my comment. Having the number of rows be the minimum length of any row is... just clearly wrong."}], "tags": [], "owner": {"reputation": 181215, "user_id": 82294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5c5f910416e2b92bb73fa59c56fe695d?s=128&d=identicon&r=PG", "display_name": "Dietrich Epp", "link": "https://stackoverflow.com/users/82294/dietrich-epp"}, "is_accepted": false, "score": 1, "last_activity_date": 1448487994, "creation_date": 1448487994, "answer_id": 33926961, "question_id": 33926631, "link": "https://stackoverflow.com/questions/33926631/haskells-bed-and-breakfast-matrix-multiplication-is-wrong/33926961#33926961", "title": "Haskell&#39;s bed-and-breakfast matrix multiplication is wrong?", "body": "<p>I looked at the <a href=\"http://hackage.haskell.org/package/bed-and-breakfast-0.4.3/docs/Numeric-Matrix.html\" rel=\"nofollow\">Numeric.Matrix documentation</a>.</p>\n\n<blockquote>\n  <p>The innermost lists represent the rows. This function will create a m-n-matrix, where m is the number of rows, which is the minimum length of the row lists and n is the number of columns, i.e. the length of the outer list. </p>\n</blockquote>\n\n<p>This is... difficult to parse, but it means that <code>[[1], [2], [3]]</code> is a 1x3 matrix, <em>not</em> a 3x1 matrix.  This matches the assertion that the number of columns is the length of the outer list--which of course implies that each inner list is itself a column.</p>\n\n<p>Using the phrase \"row-major order\" would make things clearer.  For reference, Fortran is row-major, C is column-major.  Most linear algebra packages seem to follow Fortran conventions, so the bed-and-breakfast library is fairly normal in that regard.</p>\n\n<p>As for the exception... sounds like a bug?</p>\n"}, {"comments": [{"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "edited": false, "score": 0, "creation_date": 1448489150, "post_id": 33927033, "comment_id": 55615457, "body": "Thanks. Cabal really chose 0.1.2 version. Last time I tried to build hmatrix on windows it takes 2 days and led me to nowhere. So I&#39;d better use Python or Matlab.."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "edited": false, "score": 0, "creation_date": 1448489374, "post_id": 33927033, "comment_id": 55615545, "body": "@user834108 You could also consider using <code>cabal unpack bed-and-breakfast-0.1.2</code> to get a copy of the source, fix the check, and <code>cabal install</code> the result, if you&#39;re really set on &quot;bed-and-breakfast or nothing&quot;."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1448491075, "last_edit_date": 1448491075, "creation_date": 1448488343, "answer_id": 33927033, "question_id": 33926631, "link": "https://stackoverflow.com/questions/33926631/haskells-bed-and-breakfast-matrix-multiplication-is-wrong/33927033#33927033", "title": "Haskell&#39;s bed-and-breakfast matrix multiplication is wrong?", "body": "<p>I would bet that you are using a newish GHC; and as a result cabal chose an oldish version of bed-and-breakfast. On my machine, it chose version 0.1.2 (even though the latest version is 0.4.3); this version appears to have an <a href=\"http://hackage.haskell.org/package/bed-and-breakfast-0.1.2/docs/src/Numeric-Matrix.html#line-222\" rel=\"nofollow\">incorrect dimensions check in its multiplication function</a>:</p>\n\n<pre><code>a `times` b\n    | numRows a /= numCols b = error \"Matrix.times: `numRows a' and `numCols b' don't match.\"\n    | otherwise = fromList [ [ row i a `dotProd` col j b\n                             | j &lt;- [1..numCols b] ]\n                           | i &lt;- [1..numRows a] ]\n</code></pre>\n\n<p>That check should be <code>numCols a /= numRows b</code>. The check is fixed in later versions of the library; but these versions also (correctly) specify upper bounds on <code>base</code> that exclude new GHCs.</p>\n\n<p>Therefore I suspect that you will either have to update the library to work with new GHCs, patch the old version of the library, or use a more actively maintained library. I've been happy with <a href=\"http://hackage.haskell.org/package/hmatrix\" rel=\"nofollow\">hmatrix</a> in the past, though note that matrix multiplication is spelled <code>(&lt;&gt;)</code>, not <code>(*)</code>.</p>\n"}], "owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 33927033, "answer_count": 2, "score": 3, "last_activity_date": 1563316119, "creation_date": 1448486482, "last_edit_date": 1563316119, "question_id": 33926631, "link": "https://stackoverflow.com/questions/33926631/haskells-bed-and-breakfast-matrix-multiplication-is-wrong", "title": "Haskell&#39;s bed-and-breakfast matrix multiplication is wrong?", "body": "<p>Haskell's bed-and-breakfast library is the first library in the Linear algebra section in <a href=\"https://wiki.haskell.org/Applications_and_libraries/Mathematics\" rel=\"nofollow\">https://wiki.haskell.org/Applications_and_libraries/Mathematics</a>.\nSo, I'm trying:</p>\n\n<pre><code>let a = Matrix.fromList [[1,2,3], [4,5,6], [7,8,9]]\nlet b = Matrix.fromList [[1], [2], [3]]\na * b\n*** Exception: Matrix.times: `numRows a' and `numCols b' don't match.\n</code></pre>\n\n<p>Wat? If I multiply [m x n] matrix by [n x p] matrix I should get [m x p] matrix, not this silly exception. Ok, maybe library author doesn't know where is left and where is right.</p>\n\n<pre><code>b * a\n *** Exception: Ix{Int}.index: Index (2) out of range ((1,1))\n</code></pre>\n\n<p>Waaaaat?</p>\n"}, {"tags": ["haskell", "exception", "infinite-loop"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 9, "creation_date": 1448487987, "post_id": 33926604, "comment_id": 55614889, "body": "I fear you are trying to solve the halting problem. You might be able to catch &lt;&lt;loop&gt;&gt; (inside the <code>IO</code> monad), but in more complex cases GHC will actually loop instead of generating a catchable exception."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1448505936, "post_id": 33926604, "comment_id": 55620358, "body": "Your function takes as input any <code>Functor f =&gt; f (f a -&gt; f)</code>, knowing nothing else, you know that all you can do with that value is <code>fmap</code> over it - producing some other <code>f b</code> for some <code>b</code>. This can <i>never</i> be of the form <code>Maybe (f c)</code> for any c. And there is no function which converts a general functor to a <code>Maybe</code> anything - there is simply no way to do so with a <code>Functor</code>. You may have more luck with <code>Traversable f =&gt; f (f a -&gt; Maybe a) -&gt; Maybe (f a)</code>? I&#39;m not sure."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1448521398, "last_edit_date": 1495541710, "creation_date": 1448511724, "answer_id": 33930554, "question_id": 33926604, "link": "https://stackoverflow.com/questions/33926604/maybeloeb-and-why-does-loop-occur-only-sometimes-is-it-catchable/33930554#33930554", "title": "maybeLoeb, and why does &lt;&lt;loop&gt;&gt; occur only sometimes / is it catchable?", "body": "<p>The <code>&lt;&lt;loop&gt;&gt;</code> exception exists because GHC's implementation of lazy evaluation, which was designed for <em>multi-threaded</em> operation, makes a very specific form of infinite loop easy to detect when using the <em>single-threaded</em> runtime system (RTS). When the multi-threaded RTS needs to force a thunk, it follows a procedure roughly like this:</p>\n\n<ol>\n<li><p>Check if the thunk has been evaluated yet; if so, use the known value and ignore the rest of this.</p></li>\n<li><p>Check if the thunk is marked as being in the process of evaluation. If so, the thread yields to let whatever thread is working on that thunk finish its job. Go back to step 0.</p></li>\n<li><p>Mark the thunk to indicate it is being evaluated.</p></li>\n<li><p>Evaluate the thunk.</p></li>\n<li><p>Store the result and mark the thunk as evaluated.</p></li>\n</ol>\n\n<p>The same basic procedure is used for both the single-threaded and multi-threaded runtimes, to avoid tremendous amounts of code duplication. But in the single-threaded runtime, the \"yield\" step is replaced by a <code>&lt;&lt;loop&gt;&gt;</code> exception&mdash;if the program tries to force a thunk in the process of forcing that very thunk, it is surely stuck. There surely isn't any other thread in the middle of forcing the thunk.</p>\n\n<p>I'm not sure if the exception can be caught, but you certainly never want to <em>rely</em> on catching it&mdash;different optimization levels or compiler versions may produce the exception in different cases. The question of whether your program is stuck in an infinite loop cannot be answered in general. As <a href=\"https://stackoverflow.com/questions/33926604/maybeloeb-and-why-does-loop-occur-only-sometimes-is-it-catchable/33930554#comment55614889_33926604\">chi mentions</a>, this is called the <em>halting problem</em>, and Alan Turing famously proved it unsolvable.</p>\n"}], "owner": {"reputation": 143, "user_id": 2842249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87faf1568d6d36713507255fc27e0e24?s=128&d=identicon&r=PG&f=1", "display_name": "tdj", "link": "https://stackoverflow.com/users/2842249/tdj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 33930554, "answer_count": 1, "score": 1, "last_activity_date": 1448521398, "creation_date": 1448486401, "last_edit_date": 1448490377, "question_id": 33926604, "link": "https://stackoverflow.com/questions/33926604/maybeloeb-and-why-does-loop-occur-only-sometimes-is-it-catchable", "title": "maybeLoeb, and why does &lt;&lt;loop&gt;&gt; occur only sometimes / is it catchable?", "body": "<p>I am playing around with loeb (<a href=\"https://github.com/quchen/articles/blob/master/loeb-moeb.md\" rel=\"nofollow\">https://github.com/quchen/articles/blob/master/loeb-moeb.md</a>):</p>\n\n<pre><code>loeb :: Functor f =&gt; f (f a -&gt; a) -&gt; f a\nloeb fs = xs where xs = fmap ($ xs) fs\n</code></pre>\n\n<p>and I want to write a function:</p>\n\n<pre><code>maybeLoeb :: Functor f =&gt; f (f a -&gt; a) -&gt; Maybe (f a)\n</code></pre>\n\n<p>that fails instead of entering an infinite loop when given bad input. </p>\n\n<p>I am also having some difficulties understanding the behavior of the <code>&lt;&lt;loop&gt;&gt;</code> exception. I would like to catch it if possible.</p>\n\n<p>When entered into GHCI:</p>\n\n<pre><code>loeb [(!! 1),(!! 0)] :: [Int]\n*** Exception: &lt;&lt;loop&gt;&gt;\n</code></pre>\n\n<p>However, when defined in loeb.hs:</p>\n\n<pre><code>main = print (loeb [(!! 1),(!! 0)] :: [Int])\n</code></pre>\n\n<p>And then loaded into GHCI with <code>:l main</code> we get:</p>\n\n<pre><code>*Main&gt; :l loeb\n[1 of 1] Compiling Main             ( loeb.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; main\n[\n</code></pre>\n\n<p>And the program does not terminate. </p>\n\n<p>Is the <code>&lt;&lt;loop&gt;&gt;</code> except catchable? If so, is there a way to get the second version above to throw the exception?</p>\n"}, {"tags": ["haskell", "types", "compiler-errors", "dependent-type"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1448506228, "post_id": 33926459, "comment_id": 55620436, "body": "The code is &quot;inaccessible&quot; because even if you compile that function, pretending there is no type error, nothing calling your function will ever reach that code, because it is not well typed (so any application which would use it would not be well typed)."}], "answers": [{"comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1448486793, "post_id": 33926497, "comment_id": 55614287, "body": "I was going to use <code>coerce</code>, from <code>Data.Coerce</code>. It can converts newtypes, if when buried inside of other types. For example, <code>coerce</code> can take on the type <code>coerce::Maybe (Fix []) -&gt; Maybe [Fix []]</code>."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1448487031, "post_id": 33926497, "comment_id": 55614403, "body": "Also, is there anyway to get GHC to &quot;suppress&quot; this error?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1448487044, "post_id": 33926497, "comment_id": 55614413, "body": "@PyRulez Ah, <code>coerce</code>! If that works, it looks pretty bad. I hope GHC infers the right role to <code>Refl</code> to forbid it. About the error: I don&#39;t think it can be suppressed: why do you want to keep the code for an &quot;impossible&quot; case? If that&#39;s possible that&#39;s another issue, IMHO, that should be fixed..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1448487339, "post_id": 33926497, "comment_id": 55614550, "body": "@PyRulez By default, <code>Refl</code> arguments have type roles &quot;nominal, nominal&quot;, so <code>coerce</code> does not work. Whew."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1448487356, "post_id": 33926497, "comment_id": 55614557, "body": "I actually did try it later. When I run <code>coerce Refl :: Refl (Fix []) [Fix []]</code>, it just says it can&#39;t match <code>Fix []</code> and <code>[Fix []]</code>. Do you know the &quot;rules&quot; surrounding coerce?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1448487610, "post_id": 33926497, "comment_id": 55614678, "body": "@PyRulez Not precisely, it has to do with <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/roles.html\" rel=\"nofollow noreferrer\">type roles</a>. Nominal roles can not be coerced. Others can. See also the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.8.1.0/Data-Coerce.html\" rel=\"nofollow noreferrer\">coercion rules</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1448489212, "post_id": 33926497, "comment_id": 55615486, "body": "@PyRulez You can turn the error into a mere warning with <code>-fdefer-type-errors</code>, though this will apply to all other type errors in the file as well."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1448486351, "last_edit_date": 1448486351, "creation_date": 1448485988, "answer_id": 33926497, "question_id": 33926459, "link": "https://stackoverflow.com/questions/33926459/i-was-trying-to-break-haskell-and-got-an-inaccessiable-code-error-from-ghc-wh/33926497#33926497", "title": "I was trying to break Haskell and got an &quot;Inaccessiable code&quot; error from GHC. What does it mean?", "body": "<p>It simply means that there's no way to call function <code>weird</code> with a non-bottom argument (i.e., with a <em>terminating</em>, non exception-raising expression).</p>\n\n<p>This is because no constructor (or more precisely, no WHNF) can ever have <code>Refl a [a]</code> as its type. Indeed, the types <code>a</code> and <code>[a]</code> are surely different, whatever <code>a</code> might be (and this can be checked during unification).</p>\n\n<p>Since this is more often than not a source of a programming error, GHC errors out to loudly complain to the programmer.</p>\n\n<p>If taking an \"impossible\" input is what you really wanted to do, use this instead:</p>\n\n<pre><code>{-# LANGUAGE EmptyCase #-}\nweird :: Refl a [a] -&gt; a\nweird x = case x of { }\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>{-# LANGUAGE EmptyCase #-}\nweird :: Refl a [a] -&gt; b\nweird x = case x of { }\n</code></pre>\n\n<p>Indeed, <code>weird</code> can actually produce any type at all! Being impossible to call, it can claim any type for its output. This follows the logical principle \"ex falso quod libet\": from a false premise (e.g. that <code>a</code> and <code>[a]</code> are the same type) you can deduce whatever you wish.</p>\n\n<p>Final note, since you import <code>Data.Functor.Fixedpoint</code>, I guess you want to use <code>Fix []</code>. Well, that is <em>isomorphic</em> to <code>[Fix []]</code> -- but not equal! So, again, you can't have a non-bottom expression of type <code>Refl (Fix []) [Fix []]</code>.</p>\n"}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 33926497, "answer_count": 1, "score": 2, "last_activity_date": 1448486351, "creation_date": 1448485834, "question_id": 33926459, "link": "https://stackoverflow.com/questions/33926459/i-was-trying-to-break-haskell-and-got-an-inaccessiable-code-error-from-ghc-wh", "title": "I was trying to break Haskell and got an &quot;Inaccessiable code&quot; error from GHC. What does it mean?", "body": "<p>So, I had the following code:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\nimport Data.Coerce\nimport Data.Functor.Fixedpoint --Although I'm not using these yet, they provide \"context\"\n\ndata Refl a b where\n    Refl :: Refl a a\n\nweird :: Refl a [a] -&gt; a\nweird Refl = [[], [[], []]]\n</code></pre>\n\n<p>I think you can see where I am going. If not, what I am trying to do is to force Haskell into thinking that <code>a</code> and <code>[a]</code> are the same type by giving it the <code>Refl</code> argument. This will allow me to do shenanigans. When I to compile it, <code>ghci</code> gives me this error:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( pad'.hs, interpreted )\n\npad'.hs:9:7:\n    Couldn't match type \u2018a\u2019 with \u2018[a]\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n          the type signature for weird :: Refl a [a] -&gt; [a] at pad'.hs:8:10\n    Inaccessible code in\n      a pattern with constructor\n        Refl :: forall a. Refl a a,\n      in an equation for \u2018weird\u2019\n    Relevant bindings include\n      weird :: Refl a [a] -&gt; [a] (bound at pad'.hs:9:1)\n    In the pattern: Refl\n    In an equation for \u2018weird\u2019: weird Refl = [[], [[], []]]\nFailed, modules loaded: none.\n</code></pre>\n\n<p>What does <code>Inaccessible code</code> mean? In general, are there any resources related to what I'm trying to do?</p>\n"}, {"tags": ["haskell", "type-declaration"], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1448478641, "post_id": 33923761, "comment_id": 55610164, "body": "Or, equivalently, pass a function that when given an <code>a</code> will return an <code>a</code>, and get as a result a function that when given an <code>a</code> will return an <code>a</code>."}], "tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": true, "score": 3, "last_activity_date": 1448475571, "creation_date": 1448475571, "answer_id": 33923761, "question_id": 33923552, "link": "https://stackoverflow.com/questions/33923552/understanding-higher-order-function-type-declaration/33923761#33923761", "title": "Understanding higher-order function type declaration", "body": "<p>In between each <code>-&gt;</code> is the type of a parameter to the function, with the last one being the type of the function's return value. So here the shape is <code>_ -&gt; _ -&gt; _</code> (a function taking two parameters). The first parameter, though, happens to be a function, and has shape <code>_ -&gt; _</code> (taking one parameter).</p>\n\n<p>So to use <code>applyTwice</code>:</p>\n\n<ul>\n<li>pass a function that when given an <code>a</code> will return an <code>a</code></li>\n<li>pass an <code>a</code></li>\n<li>get an <code>a</code> as the result</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 2, "last_activity_date": 1448475582, "creation_date": 1448475582, "answer_id": 33923766, "question_id": 33923552, "link": "https://stackoverflow.com/questions/33923552/understanding-higher-order-function-type-declaration/33923766#33923766", "title": "Understanding higher-order function type declaration", "body": "<p>You should thing <code>a -&gt; b</code> as a function that takes a <code>a</code> and outputs a <code>b</code> - so if <code>f</code> is such a function: <code>f :: a -&gt; b</code> then everytime you feed it an <code>v :: a</code> (written as <code>f v</code>) you get an <code>b</code>: <code>(f v) :: b</code>.</p>\n\n<p>Now of course such a function-type is a <em>type</em> too - <em>higher order ...</em> ;)</p>\n\n<p>Now <code>(a -&gt; a) -&gt; a -&gt; a</code> is <code>(a -&gt; a) -&gt; (a -&gt; a)</code> so this is a <em>function</em> (let's call it <code>applyTwice</code>) that when given an <code>f :: a -&gt; a</code> will produce another function <code>a -&gt; a</code>: <code>applyTwice f :: a -&gt; a</code> which is of course the function that take an <code>v :: a</code> and then does <code>f (f a)</code> (<em>applying <code>f</code> twice</em>).</p>\n\n<p>If you have <code>(a -&gt; a) -&gt; a</code> on the other hand you have to somehow produce an <code>a</code> from a function of type <code>a -&gt; a</code> which is really tricky (think about it: where do you get an <code>a</code> from that you can feed <code>f</code>?</p>\n"}], "owner": {"reputation": 2534, "user_id": 2122392, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/oBPqA.jpg?s=128&g=1", "display_name": "David Shaked", "link": "https://stackoverflow.com/users/2122392/david-shaked"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 2, "accepted_answer_id": 33923761, "answer_count": 2, "score": 1, "last_activity_date": 1448475582, "creation_date": 1448474876, "question_id": 33923552, "link": "https://stackoverflow.com/questions/33923552/understanding-higher-order-function-type-declaration", "title": "Understanding higher-order function type declaration", "body": "<p>In the introductory Haskell text, <em>Learn You a Haskell for Great Good</em>, the author defines a function, applyTwice, that two times applies a function f to a parameter x to illustrate the higher order capabilities central to the functional paradigm.</p>\n\n<pre><code>applyTwice :: (a -&gt; a) -&gt; a -&gt; a  \napplyTwice f x = f (f x)\n</code></pre>\n\n<p>To this point, I found Haskell's type declarations clear, but this particular example confuses me. I think this is an opportunity to better understand type declarations.</p>\n\n<p>The author indicates this construct \"indicates that the first parameter is a function that takes something and returns that same thing. The second parameter is something of that type also and the return value is also of the same type.\" (<a href=\"http://learnyouahaskell.com/higher-order-functions#higher-orderism\" rel=\"nofollow\">text</a>)</p>\n\n<p><strong>What does this type declaration mean?</strong> Why not use (a -> a) -> a, with each -> indicating a transformation of some sort?</p>\n"}, {"tags": ["algorithm", "haskell", "random", "sampling", "reservoir-sampling"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448467884, "post_id": 33920928, "comment_id": 55603617, "body": "well the algorithms holds one coin till it&#39;s at the end (and maybe changes it with some other) - the key point is: <i>till the end</i> - so you have to traverse the complete list ... and of course this algorithm depends on exactly this in order to give you an uniform distribution"}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448468341, "post_id": 33920928, "comment_id": 55603890, "body": "From the way it&#39;s written above, it doesn&#39;t seem like anything is getting replaced. That&#39;s something that was confusing me, why Jeremy Kun&#39;s example didn&#39;t actually maintain any particular reservoir to be mutated. So I&#39;m not understanding your comment."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448469169, "post_id": 33920928, "comment_id": 55604442, "body": "I am talking about the <i>reservoir-sampling</i> algorithm as described in your first link - seems you removed the vital parts - but yours is not working becaue you try to materialize the complete list - why don&#39;t you try and do it without <code>IO</code> (pass the generator around with <a href=\"https://hackage.haskell.org/package/random-1.1/docs/System-Random.html#v:randomR\" rel=\"nofollow noreferrer\"><code>randomR</code></a> ?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448470198, "post_id": 33920928, "comment_id": 55605162, "body": "Operationally, your <code>sampleReservoir</code> can be made to be suitably lazy; however, it has the wrong denotation. It does not produce an element drawn uniformly at random from the input list. Indeed, it produces a list and not an element; but even the list it produces does not contain uniformly distributed values."}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448469395, "post_id": 33921688, "comment_id": 55604584, "body": "in this version the prop. to return the first is extremely high (a random number in [0,1] &lt; 1) ;)"}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1448470236, "post_id": 33921688, "comment_id": 55605191, "body": "That&#39;s cool! Yea I agree, I am bit wary about this algorithm, it seems strange as the probability starts high and goes very low."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1448606815, "post_id": 33921688, "comment_id": 55661497, "body": "I revisited this answer in more detail now, does the refactored version work because instead of fmapping into a infinitely nested IO structure (forcing a strict evaluation from inside out), we instead have a list data structure that simply contains a random value produced by IO computation. And somehow this allows lazy consumption of IO values when deconstructing the list?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1448626988, "post_id": 33921688, "comment_id": 55672299, "body": "In <code>sampleReservoir3</code> there is no lazy consumption of IO computation. When you write <code>ws &lt;- getRandomRs (0, 1 :: Double)</code> you get a single IO computation which, when executed, produces an infinite random list of doubles between 0 and 1. Essentially what happens is that <code>getRandomRs</code> performs an IO action to get a new random seed, then <i>purely</i> and <i>lazily</i> returns an infinite list of random values using that seed. I&#39;ve added another equivalent version of the function."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 4, "last_activity_date": 1448627053, "last_edit_date": 1448627053, "creation_date": 1448469004, "answer_id": 33921688, "question_id": 33920928, "link": "https://stackoverflow.com/questions/33920928/infinite-lazy-reservoir-sampling-in-haskell/33921688#33921688", "title": "Infinite/Lazy Reservoir Sampling in Haskell", "body": "<p>The problem is that the IO monad maintains a strict sequence between actions. Writing <code>fmap (e:) reservoir</code> will first execute all of the effects associated with <code>reservoir</code>, which will be infinite if the input list is infinite.</p>\n\n<p>I was able to fix this with liberal use of <code>unsafeInterleaveIO</code>, which allows you to break the semantics of <code>IO</code>:</p>\n\n<pre><code>sampleReservoir2 :: [e] -&gt; IO [e]\nsampleReservoir2 stream = \n    foldr \n        (\\(i, e) reservoir -&gt; do \n            r &lt;- unsafeInterleaveIO $ randomRIO (0.0, 1.0) :: IO Double -- randomRIO gets confused about 0.0 and 1.0\n            if r &lt; (1.0 / fromIntegral i) then unsafeInterleaveIO $ do\n                rr &lt;- reservoir\n                return (e:rr)\n            else \n                reservoir) \n        (return []) \n        (enumerate 1 stream)\n</code></pre>\n\n<p>Obviously, this will allow the interleaving of IO actions, but since all you're doing is generating random numbers it shouldn't matter. However, this solution isn't very satisfactory; the correct solution is to refactor your code somewhat. You should generate an infinite list of random numbers, then consume that infinite list (lazily) with <code>foldr</code>:</p>\n\n<pre><code>sampleReservoir3 :: MonadRandom m =&gt; [a] -&gt; m [a]\nsampleReservoir3 stream = do\n  ws &lt;- getRandomRs (0, 1 :: Double) \n  return $ foldr \n     (\\(w, (i, e)) reservoir -&gt; \n        (if w &lt; (1 / fromIntegral i) then (e:) else id) reservoir\n     ) \n     []\n     (zip ws $ enumerate 1 stream)\n</code></pre>\n\n<p>This can also (equivalently) be written as</p>\n\n<pre><code>sampleReservoir4 :: [a] -&gt; IO [a] \nsampleReservoir4 stream = do\n  seed &lt;- newStdGen \n  let ws = randomRs (0, 1 :: Double) seed \n  return $ foldr \n     (\\(w, (i, e)) reservoir -&gt; \n        (if w &lt; (1 / fromIntegral i) then (e:) else id) reservoir\n     ) \n     []\n     (zip ws $ enumerate 1 stream)\n</code></pre>\n\n<p>As an aside, I'm not sure as to the correctness of the algorithm, since it seems to always return the first element of the input list first. Not very random. </p>\n"}], "owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 33921688, "answer_count": 1, "score": 2, "last_activity_date": 1616316780, "creation_date": 1448466873, "last_edit_date": 1616316780, "question_id": 33920928, "link": "https://stackoverflow.com/questions/33920928/infinite-lazy-reservoir-sampling-in-haskell", "title": "Infinite/Lazy Reservoir Sampling in Haskell", "body": "<p>I tried to implement a simple reservoir sampling in haskell following <a href=\"http://jeremykun.com/2013/07/05/reservoir-sampling/\" rel=\"nofollow noreferrer\">http://jeremykun.com/2013/07/05/reservoir-sampling/</a> (note that the algorithm shown is possibly semantically incorrect)</p>\n<p>According to this: <a href=\"https://stackoverflow.com/questions/24172693/iterative-or-lazy-reservoir-sampling\">Iterative or Lazy Reservoir Sampling</a> lazy reservoir sampling is impossible unless you know the population size ahead of time.</p>\n<p>Even so, I'm not understanding why (operationally speaking) the below <code>sampleReservoir</code> doesn't work on infinite lists. Just where exactly is laziness broken?</p>\n<pre><code>import System.Random (randomRIO)\n\n-- equivalent to python's enumerate\nenumerate :: (Num i, Enum i) =&gt; i -&gt; [e] -&gt; [(i, e)]\nenumerate start = zip [start..]\n\nsampleReservoir stream = \n    foldr \n        (\\(i, e) reservoir -&gt; do \n            r &lt;- randomRIO (0.0, 1.0) :: IO Double\n                              -- randomRIO gets confused about 0.0 and 1.0\n            if r &lt; (1.0 / fromIntegral i) then\n                fmap (e:) reservoir\n            else \n                reservoir) \n        (return []) \n        (enumerate 1 stream)\n</code></pre>\n<p>The challenge and test is <code>fmap (take 1) $ sampleReservoir [1..]</code>.</p>\n<p>Furthermore, if reservoir sampling can't be lazy, what can take in a lazy list and produce a sampled lazy list?</p>\n<p>I get the idea that there must be a way of making the above function lazy in the output as well, because I could change this:</p>\n<pre><code>if r &lt; (1.0 / fromIntegral i) then\n    fmap (e:) reservoir\nelse \n    \n</code></pre>\n<p>To:</p>\n<pre><code>if r &lt; (1.0 / fromIntegral i) then\n    do \n        print e\n        fmap (e:) reservoir\n</code></pre>\n<p>This shows results as the function is iterating over the list. Using coroutine abstraction, perhaps instead of <code>print e</code> there can be a <code>yield e</code>, and the rest of the computation can be held as a continuation.</p>\n"}, {"tags": ["haskell", "module"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1448466043, "creation_date": 1448466043, "answer_id": 33920637, "question_id": 33920310, "link": "https://stackoverflow.com/questions/33920310/haskell-module-not-compiling/33920637#33920637", "title": "Haskell module not compiling", "body": "<p>Since <code>where</code> is a block herald, all lines after it must be indented the same amount (or explicit <code>{;}</code> must be used).</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 4236885, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-iV4bAx3qf88/AAAAAAAAAAI/AAAAAAAAACE/iJAw05gZQwc/photo.jpg?sz=128", "display_name": "Sir Hadez", "link": "https://stackoverflow.com/users/4236885/sir-hadez"}, "edited": false, "score": 0, "creation_date": 1448466543, "post_id": 33920689, "comment_id": 55602662, "body": "Thanks for your complete aswer about the problems in the code, much appreciated, and thanks for the (..) tip. It worked based on identation you provided."}, {"owner": {"reputation": 2560, "user_id": 46842, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3a5acbe9f67bdc96d5901946aa87d619?s=128&d=identicon&r=PG", "display_name": "psycotica0", "link": "https://stackoverflow.com/users/46842/psycotica0"}, "edited": false, "score": 0, "creation_date": 1448592280, "post_id": 33920689, "comment_id": 55657931, "body": "Since this answers your question, it&#39;s customary to mark it as the accepted answer. <a href=\"http://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 5, "last_activity_date": 1448466155, "creation_date": 1448466155, "answer_id": 33920689, "question_id": 33920310, "link": "https://stackoverflow.com/questions/33920310/haskell-module-not-compiling/33920689#33920689", "title": "Haskell module not compiling", "body": "<p>Your code is poorly formatted and you need to follow whitespace conventions properly, since the Haskell compiler is whitespace aware.  Something like this should work:</p>\n\n<pre><code>module MyModule\n    ( FavoriteList(..)\n    , empty\n    ) where\n\ndata FavoriteList a = L [a]\n\nempty :: FavoriteList a\nempty = L []\n</code></pre>\n\n<p>You should use the form <code>FavoriteList(..)</code> to export the type and all of its constructors, and the constructor for <code>FavoriteList</code> is <code>L</code>, not <code>FavoriteList</code>, which is the type name, so you have to construct a value of type <code>FavoriteList</code> using the <code>L</code> constructor.</p>\n\n<p>All top level declarations must be at the same indentation level, too, so you can't have</p>\n\n<pre><code>    data FavoriteList a = L [a]\n\nempty :: FavoriteList a\nempty = L []\n</code></pre>\n\n<p>You have to have</p>\n\n<pre><code>data FavoriteList a = L [a]\n\nempty :: FavoriteList a\nempty = L []\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4236885, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-iV4bAx3qf88/AAAAAAAAAAI/AAAAAAAAACE/iJAw05gZQwc/photo.jpg?sz=128", "display_name": "Sir Hadez", "link": "https://stackoverflow.com/users/4236885/sir-hadez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1448466290, "creation_date": 1448465170, "last_edit_date": 1448466290, "question_id": 33920310, "link": "https://stackoverflow.com/questions/33920310/haskell-module-not-compiling", "title": "Haskell module not compiling", "body": "<p>So imagine if i have this module declaration</p>\n\n<pre><code>module MyModule\n(FavoriteList\n,empty\n,insert\n,delete\n)where\n  data FavoriteList a = L [a]\nempty :: FavoriteList a\nempty = FavoriteList []\n</code></pre>\n\n<p>For some reason that surpasses my experience in Haskell this does not compile, sometimes it says that the Data constructor is not in scope, and when i move it in the code it says that exists a parse error in input on the empty function.\nAny help?</p>\n\n<p>EDIT:</p>\n\n<pre><code>)where\n  data FavoriteList a = L [a]\n  empty :: FavoriteList a\n  empty = FavoriteList []\n</code></pre>\n"}, {"tags": ["list", "haskell", "types"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1448458719, "post_id": 33917862, "comment_id": 55596949, "body": "<code>type String = [Char]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1448459186, "post_id": 33918016, "comment_id": 55597288, "body": "Also, <code>head</code> is generally evil. (This problem isn&#39;t really one of the reasons, but it also adds to the evidence.)"}, {"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1448459282, "post_id": 33918016, "comment_id": 55597376, "body": "Second that. <code>head</code> should be renamed to <code>evilHead</code> to reflect it&#39;s evil more clearly :)"}], "tags": [], "owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "is_accepted": false, "score": 4, "last_activity_date": 1448458871, "creation_date": 1448458871, "answer_id": 33918016, "question_id": 33917862, "link": "https://stackoverflow.com/questions/33917862/why-is-a-list-of-strings-suddenly-a-list-of-list-of-strings/33918016#33918016", "title": "Why is a list of strings suddenly a list of list of strings?", "body": "<p>You are using <code>head</code> on <code>dIds</code> and expect that to be a <code>[String]</code>. Thus, type inference tells us, that dIds to be used that way should be of type <code>[[String]]</code>.</p>\n\n<p>Also, you are using <code>tail</code> on <code>dIds</code> one line below. That doesn't type match.</p>\n"}, {"comments": [{"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 3, "creation_date": 1448459329, "post_id": 33918138, "comment_id": 55597410, "body": "... better yet, use pattern matching and get rid of head."}, {"owner": {"reputation": 5665, "user_id": 982084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mLw2v.jpg?s=128&g=1", "display_name": "WilQu", "link": "https://stackoverflow.com/users/982084/wilqu"}, "reply_to_user": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 0, "creation_date": 1448460087, "post_id": 33918138, "comment_id": 55597974, "body": "@JanGreve I added an example with pattern matching."}], "tags": [], "owner": {"reputation": 5665, "user_id": 982084, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mLw2v.jpg?s=128&g=1", "display_name": "WilQu", "link": "https://stackoverflow.com/users/982084/wilqu"}, "is_accepted": true, "score": 4, "last_activity_date": 1448460025, "last_edit_date": 1448460025, "creation_date": 1448459211, "answer_id": 33918138, "question_id": 33917862, "link": "https://stackoverflow.com/questions/33917862/why-is-a-list-of-strings-suddenly-a-list-of-list-of-strings/33918138#33918138", "title": "Why is a list of strings suddenly a list of list of strings?", "body": "<p>If <code>dIds</code> is a <code>[String]</code>, then the result of <code>head</code> will be a <code>String</code>, but <code>chngDispl</code> expects a <code>[String]</code>. That\u2019s why the compiler thinks that the argument of <code>head</code> should be a <code>[[String]]</code>.</p>\n\n<p>Wrap <code>head dIds</code> in a list and the error should go away.</p>\n\n<p>You should generally avoid <code>head</code> and use pattern matching instead. You can rewrite your function like this:</p>\n\n<pre><code>setDisplays :: Char -&gt; [String] -&gt; IO()\nsetDisplays mode (id:ids)\n    | mode == 'l' = chngDispl [id]\n    | mode == 'e' = chngDispl ids\n    where\n      chngDispl on = mapM_ (\\id -&gt; callProcess \"xrandr\" [\"--output\", id, \"--auto\"]) on\n</code></pre>\n\n<p>Note that this will fail if the list is empty (but so will <code>head</code>), you should handle that case as well.</p>\n"}], "owner": {"reputation": 672, "user_id": 2224973, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/864d8f904b79e9773eee4e6597deac7a?s=128&d=identicon&r=PG", "display_name": "Cut&#250; Chique&#241;o", "link": "https://stackoverflow.com/users/2224973/cut%c3%ba-chique%c3%b1o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 33918138, "answer_count": 2, "score": 1, "last_activity_date": 1448460025, "creation_date": 1448458457, "question_id": 33917862, "link": "https://stackoverflow.com/questions/33917862/why-is-a-list-of-strings-suddenly-a-list-of-list-of-strings", "title": "Why is a list of strings suddenly a list of list of strings?", "body": "<p>I have a function:</p>\n\n<pre><code>setDisplays :: Char -&gt; [String] -&gt; IO()\nsetDisplays mode dIds\n    | mode == 'l' = chngDispl (head dIds)\n    | mode == 'e' = chngDispl (tail dIds)\n    where\n      chngDispl on = mapM_ (\\id -&gt; callProcess \"xrandr\" [\"--output\", id, \"--auto\"]) on\n</code></pre>\n\n<p>that gets a list of strings with the ids of Displays provided by xrandr which looks like this <code>[\"eDP1\", \"HDMI1\"]</code>. The list is passed to <code>setDisplays</code> by binding an <code>IO ()</code>:</p>\n\n<pre><code>getDisplays &gt;&gt;= setDisplays 'e'\n</code></pre>\n\n<p>Now, I get the following error message:\nparser.hs:50:37:</p>\n\n<pre><code>    Couldn't match type \u2018Char\u2019 with \u2018[Char]\u2019\n    Expected type: [[String]]\n      Actual type: [String]\n    In the first argument of \u2018head\u2019, namely \u2018dIds\u2019\n    In the first argument of \u2018chngDispl\u2019, namely \u2018(head dIds)\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>which I don't get. Even ghc-mod is telling me that the name dIds when it is first mentioned identifies <code>[String]</code> and when I typecheck with ghc-mod in the function call it identifies <code>[[[Char]]]</code>. What is happening here?</p>\n"}, {"tags": ["haskell", "cabal", "ffi", "haskell-stack"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1448517489, "post_id": 33917759, "comment_id": 55623485, "body": "Is this really stack specific? Or is this still <a href=\"https://github.com/ocramz/petsc-hs/issues/2\" rel=\"nofollow noreferrer\">#2</a>, e.g. would you prefer/also like a cabal solution?"}, {"owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1448562231, "post_id": 33917759, "comment_id": 55648965, "body": "@Zeta , I&#39;m still a bit confused about the options. I understood stack requires a fully functional .cabal. In this case I need not only to supply pkgconfig directory and extra includes and libraries, but also to build the new bindings and tell ghci where to find them. I don&#39;t understand how to achieve this with .cabal syntax.  I was hoping stack had an option to run a simple macro, or, better still, a makefile, as part of the build."}, {"owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1448582124, "post_id": 33917759, "comment_id": 55656010, "body": "@Zeta ok I made some progress: the stack and cabal sandbox builds both work but the linker complains that it cannot find the dynamic libraries produced by inline-c"}], "answers": [{"tags": [], "owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "is_accepted": true, "score": 0, "last_activity_date": 1448590573, "last_edit_date": 1448590573, "creation_date": 1448585520, "answer_id": 33948934, "question_id": 33917759, "link": "https://stackoverflow.com/questions/33917759/haskell-stack-build-including-makefile/33948934#33948934", "title": "Haskell stack build including makefile", "body": "<p>Yes, there is. Read carefully the Stack guide and adhere to the correct .cabal file syntax.</p>\n\n<p>More precisely, when in a similar situation (HaskellC -> C -> Haskell), make sure the .cabal file has:</p>\n\n<ul>\n<li><p>Binding libraries within scope by specifying the <code>include-dirs</code>, <code>extra-lib-dirs</code> and <code>extra-libraries</code> field in the <code>library</code> stanza.</p></li>\n<li><p>the <code>c-sources</code> field, pointing to a file with the <em>same</em> name as the Haskell file that contains the <code>inline-c</code> stuff (i.e. all the <code>[C.exp| |]</code> quasiquoters for wrapping C functions) but with the <code>.c</code> extension. \nThis will trigger a warning because the C file doesn't exist yet at the beginning  of the build, but it will ALSO call gcc, which will take care of the C output produced by <code>inline-c</code>.</p></li>\n</ul>\n"}], "owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "accepted_answer_id": 33948934, "answer_count": 1, "score": 0, "last_activity_date": 1448590573, "creation_date": 1448458174, "question_id": 33917759, "link": "https://stackoverflow.com/questions/33917759/haskell-stack-build-including-makefile", "title": "Haskell stack build including makefile", "body": "<p>I am developing a library that uses some C bindings via <code>inline-c</code>. As of now, the build process involves a makefile, as follows, since we first need to produce C stubs from the inline-c macros, compile them into object code and link them dynamically, in this case to GHCi.</p>\n\n<pre><code>step1:\n    ghc ${SRCDIR}/Internal/InlineC.hs -isrc/\n\nstep2:\n    cc -c ${SRCDIR}/Internal/InlineC.c -o ${LIBDIR}/InlineC_c.o -I${PETSC_DIR_ARCH}/include -I${PETSC_DIR}/include\n\nstep3:\n    ghci ${SRCDIR}/Test.hs ${SRCDIR}/Internal/InlineC.hs  ${LIBDIR}/InlineC_c.o  ${LIBDIR}/Internal.o -isrc/ -L${PETSC_DIR_ARCH}/lib -lpetsc -lmpich\n</code></pre>\n\n<h2>Question</h2>\n\n<p>Is there a way to package up the above build sequence in a <code>stack build</code> recipe?</p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["haskell", "gadt", "type-families"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448484043, "post_id": 33916039, "comment_id": 55612914, "body": "You don&#39;t need a type class just to get a type family. You could write <code>type family Content t; type instance (JointBox a b) = Either (Content a) (Content b)</code> (and similarly for <code>IntBox</code>/<code>StringBox</code>). This is less code, and doesn&#39;t introduce a type-level name you don&#39;t care about."}, {"owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448618257, "post_id": 33916039, "comment_id": 55667338, "body": "@DanielWagner, right, I just reduced the actual example I was working with."}], "answers": [{"tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": true, "score": 7, "last_activity_date": 1448454750, "creation_date": 1448454750, "answer_id": 33916644, "question_id": 33916039, "link": "https://stackoverflow.com/questions/33916039/haskell-cant-figure-out-types-from-gadt-constructor/33916644#33916644", "title": "Haskell can&#39;t figure out types from GADT constructor", "body": "<p>Refinement for GADT pattern matches works left-to-right. So a type refinement resulting from matching on the second argument of <code>frobABox</code> will not apply to the first.</p>\n\n<p>You can make the code compile by flipping the arguments of <code>frobABox</code>:</p>\n\n<pre><code>frobABox' :: ABox t              -&gt; Content t -&gt; IO ()\nfrobABox' (AnIntBox _)          int           =  print $ int + 3\nfrobABox' (AStringBox _)        string        =  putStrLn $ reverse string\nfrobABox' (AnIntOrStringBox _) (Left int)     =  print $ int + 6\nfrobABox' (AnIntOrStringBox _) (Right string) =  putStrLn $ reverse string\n\nfrobABox :: (Content t) -&gt;  ABox t              -&gt; IO ()\nfrobABox = flip frobABox'\n</code></pre>\n"}], "owner": {"reputation": 4452, "user_id": 562583, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7d7c259d7212f8278d89e6bc45a9b39c?s=128&d=identicon&r=PG", "display_name": "Turion", "link": "https://stackoverflow.com/users/562583/turion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 33916644, "answer_count": 1, "score": 3, "last_activity_date": 1448454750, "creation_date": 1448452977, "question_id": 33916039, "link": "https://stackoverflow.com/questions/33916039/haskell-cant-figure-out-types-from-gadt-constructor", "title": "Haskell can&#39;t figure out types from GADT constructor", "body": "<p>Apologies in advance for the long example, I couldn't figure out a shorter one.</p>\n\n<p>Let's define a type class <code>Box</code>, that does nothing but contain another type, the <code>Content</code>.</p>\n\n<pre><code>{-# LANGUAGE GADTs                     #-}\n{-# LANGUAGE TypeFamilies              #-}\n\nclass Box t where\n    type Content t\n\ndata IntBox = IntBox\ndata StringBox = StringBox\n</code></pre>\n\n<p>Let's write a few instances:</p>\n\n<pre><code>instance Box IntBox where\n    type Content IntBox = Int\n\ninstance Box StringBox where\n    type Content StringBox = String\n\ndata JointBox a b = JointBox a b\n\ninstance (Box a, Box b) =&gt; Box (JointBox a b) where\n    type Content (JointBox a b) = Either (Content a) (Content b)\n</code></pre>\n\n<p>That all compiles and works so far. Enter GADTs. I want an algebraic data type that is constructed out of a box and its contents. The constructor decides the box type completely.</p>\n\n<pre><code>data ABox t where\n    AnIntBox :: IntBox -&gt; ABox IntBox\n    AStringBox :: StringBox -&gt; ABox StringBox\n    AnIntOrStringBox :: JointBox IntBox StringBox -&gt; ABox (JointBox IntBox StringBox)\n</code></pre>\n\n<p>Now, in my mind, this would mean that by pattern matching on the constructor of <code>ABox</code>, the type of the box and its contents should be determined. But this doesn't seem to be the case:</p>\n\n<pre><code>frobABox :: (Content t) -&gt;  ABox t              -&gt; IO ()\nfrobABox     int           (AnIntBox _)         =  print $ int + 3\nfrobABox     string        (AStringBox _)       =  putStrLn $ reverse string\nfrobABox    (Left int)     (AnIntOrStringBox _) =  print $ int + 6\nfrobABox    (Right string) (AnIntOrStringBox _) =  putStrLn $ reverse string\n</code></pre>\n\n<p>This throws a lot of errors, amongst which these two seem the most important to me:</p>\n\n<pre><code>GADTAndTypeClassBug.hs:29:14:\n    Couldn't match expected type \u2018Content t\u2019\n                with actual type \u2018Either t0 t1\u2019\n    The type variables \u2018t0\u2019, \u2018t1\u2019 are ambiguous\n    Relevant bindings include\n      frobABox :: Content t -&gt; ABox t -&gt; IO ()\n        (bound at GADTAndTypeClassBug.hs:27:1)\n    In the pattern: Left int\n    In an equation for \u2018frobABox\u2019:\n        frobABox (Left int) (AnIntOrStringBox _) = print $ int + 6\n\nGADTAndTypeClassBug.hs:30:14:\n    Couldn't match expected type \u2018Content t\u2019\n                with actual type \u2018Either t2 t3\u2019\n    The type variables \u2018t2\u2019, \u2018t3\u2019 are ambiguous\n    Relevant bindings include\n      frobABox :: Content t -&gt; ABox t -&gt; IO ()\n        (bound at GADTAndTypeClassBug.hs:27:1)\n    In the pattern: Right string\n    In an equation for \u2018frobABox\u2019:\n        frobABox (Right string) (AnIntOrStringBox _)\n          = putStrLn $ reverse string\n\nGADTAndTypeClassBug.hs:30:71:\n    Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018t3\u2019\n      \u2018t3\u2019 is untouchable\n        inside the constraints (t ~ JointBox IntBox StringBox)\n        bound by a pattern with constructor\n                   AnIntOrStringBox :: JointBox IntBox StringBox\n                                       -&gt; ABox (JointBox IntBox StringBox),\n                 in an equation for \u2018frobABox\u2019\n        at GADTAndTypeClassBug.hs:30:29-46\n    Relevant bindings include\n      string :: t3 (bound at GADTAndTypeClassBug.hs:30:20)\n    In the first argument of \u2018reverse\u2019, namely \u2018string\u2019\n    In the second argument of \u2018($)\u2019, namely \u2018reverse string\u2019\n</code></pre>\n\n<p>An easier example without the type families works:</p>\n\n<pre><code>data UnitOrEither t where\n    AUnit :: () -&gt; UnitOrEither ()\n    AnEither :: Either String Int -&gt; UnitOrEither (Either String Int)\n\nfrob :: UnitOrEither t -&gt; IO ()\nfrob   (AUnit _)       =  print ()\nfrob   (AnEither _)    =  print \"Either\"\n</code></pre>\n\n<p>So what's the problem?</p>\n"}, {"tags": ["haskell", "ghc", "quickcheck"], "comments": [{"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1448447751, "post_id": 33914073, "comment_id": 55589913, "body": "This may help: <a href=\"http://stackoverflow.com/questions/2892586/how-can-my-haskell-program-or-library-find-its-version-number\" title=\"how can my haskell program or library find its version number\">stackoverflow.com/questions/2892586/&hellip;</a>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1448449747, "post_id": 33914073, "comment_id": 55591273, "body": "*sigh*, another one for <a href=\"http://stackoverflow.com/a/23733494/1139697\">the list</a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 2, "creation_date": 1448462630, "post_id": 33914073, "comment_id": 55599764, "body": "@shree.pat18 That doesn&#39;t seem useful for a library that&#39;s already installed (and which, like most libraries, does not expose its <code>Paths_*</code> module)."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1448462529, "post_id": 33914702, "comment_id": 55599682, "body": "Or, if you don&#39;t want to go through <code>cabal</code> (and are using <code>ghc</code>), you can <code>ghc-pkg list QuickCheck</code>, which by default will just show version numbers for installed packages."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 6, "last_activity_date": 1448479848, "last_edit_date": 1448479848, "creation_date": 1448449063, "answer_id": 33914702, "question_id": 33914073, "link": "https://stackoverflow.com/questions/33914073/which-package-version-do-i-have/33914702#33914702", "title": "Which package version do I have?", "body": "<h1>Using <code>cabal info</code></h1>\n\n<p>You can use <code>cabal info &lt;packagename&gt;</code> to get information about the package, including the currently installed version:</p>\n\n<pre>\n$ cabal info QuickCheck\n* QuickCheck       (library)\n    Synopsis:      Automatic testing of Haskell programs\n    Versions available: 1.1.0.0, 1.2.0.0, 1.2.0.1, 2.6, 2.7.4, 2.7.5, 2.7.6,\n                        2.8, 2.8.1 (and 24 others)\n    Versions installed: 2.8.1\n    Homepage:      https://github.com/nick8325/quickcheck\n    Bug reports:   mailto:quickcheck@projects.haskell.org\n    Description:   QuickCheck is a library for random testing of program\n                   properties.\n\n                   The programmer provides a specification of the program, in\n                   the form of properties which functions should satisfy, and\n                   ...\n</pre>\n\n<p>So all you have to do is to <code>grep</code> the \"Versions installed\":</p>\n\n<pre><code>$ cabal info QuickCheck | grep \"Versions installed\"\nVersions installed: 2.8.1\n</code></pre>\n\n<p>On Windows, you can use findstr:</p>\n\n<pre><code>$ cabal info QuickCheck | findstr /C:\"Versions installed\"\nVersions installed: 2.8.1\n</code></pre>\n\n<p>Remark: If you don't have <code>&lt;packagename&gt;</code> installed but still want to know some information about it, you might need to <code>cabal update</code> first.</p>\n\n<h1>Using <code>ghc-pkg</code></h1>\n\n<p>If you don't have <code>cabal</code> installed, you can still use GHC's package manager, <code>ghc-pkg</code>:</p>\n\n<pre><code>$ ghc-pkg list QuickCheck\nC:\\Program Files\\MinGHC-7.8.4\\ghc-7.8.4\\lib\\package.conf.d:\n    QuickCheck-2.8.1\n</code></pre>\n\n<p>However, note that <code>ghc-pkg</code> won't acknowledge cabal sandboxes:</p>\n\n<pre><code>$ cabal sandbox init\n$ cabal install QuickCheck\n$ ghc-pkg list QuickCheck\nC:\\Program Files\\MinGHC-7.8.4\\ghc-7.8.4\\lib\\package.conf.d:\n    (no packages)\n</code></pre>\n\n<p>In this case, you need to use <code>ghc-pkg -f .\\.cabal-sandbox\\&lt;platform&gt;-packages.conf.d</code> or <code>cabal exec</code>:</p>\n\n<pre><code>$ ghc-pkg -f .\\.cabal-sandbox\\x86_64-windows-ghc-7.8.4-packages.conf.d list QuickCheck \n.\\.cabal-sandbox\\x86_64-windows-ghc-7.8.4-packages.conf.d:\n    QuickCheck-2.8.1\n\n$ cabal exec -- ghc-pkg list QuickCheck \n.\\.cabal-sandbox\\x86_64-windows-ghc-7.8.4-packages.conf.d:\n    QuickCheck-2.8.1\n</code></pre>\n\n<p>However, since you're already using <code>cabal</code>, you can simply use <code>cabal info</code>.</p>\n"}], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 1, "accepted_answer_id": 33914702, "answer_count": 1, "score": 8, "last_activity_date": 1448479848, "creation_date": 1448447356, "last_edit_date": 1448449244, "question_id": 33914073, "link": "https://stackoverflow.com/questions/33914073/which-package-version-do-i-have", "title": "Which package version do I have?", "body": "<p>One should think that this is a FAQ, but I haven't been able to find an answer to this simple question:</p>\n\n<p><em>Which version of a certain package do I have in my GHC installation?</em></p>\n\n<h1>Background</h1>\n\n<p>I'm trying to learn Haskell, and in order to do that, I'm making my way through <a href=\"http://book.realworldhaskell.org/read/\">Real World Haskell</a>. I've now reached <a href=\"http://book.realworldhaskell.org/read/testing-and-quality-assurance.html\">chapter 11</a>, which, among other topics, introduces QuickCheck.</p>\n\n<p>Unfortunately, QuickCheck has changed since the book was published in 2009, and it seems it has undergone various revisions. Whenever I search for a new way of doing things, as alternatives to the instructions in the book, the new ways sometimes don't work either. Perhaps the 'new way' was described in 2012, but then QuickCheck changed yet again between then and now.</p>\n\n<p>Ultimately, I'll have to figure out how to use QuickCheck from either the documentation or the source code, but it'd be tremendously helpful to know which version I ought to investigate.</p>\n\n<p>I've not yet reached the point where I've learned about Cabal and such, so my question is grounded in sheer ignorance. Hopefully, there's an easy answer.</p>\n\n<p>I use GHC on Windows, and apparently, QuickCheck is already bundled into my installation. I already have QuickCheck, but I don't know which version.</p>\n"}, {"tags": ["haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 0, "creation_date": 1448442952, "post_id": 33912423, "comment_id": 55586827, "body": "... you would still have to wrap a fromMaybe [] around it to get to your expected result."}], "tags": [], "owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "is_accepted": false, "score": 1, "last_activity_date": 1448443830, "last_edit_date": 1448443830, "creation_date": 1448442688, "answer_id": 33912423, "question_id": 33912046, "link": "https://stackoverflow.com/questions/33912046/haskell-aeson-to-deal-with-missing-data/33912423#33912423", "title": "Haskell Aeson to deal with missing data", "body": "<p>To begin with, your expected result is not of type <code>(Maybe [Maybe Int])</code>, but of type <code>[Maybe Int]</code>.</p>\n\n<p>Secondly, as of the definition of <code>decode</code>, this is not possible. Yet, you could use <code>decode</code> to decode the JSON array into a list of Aeson Values, which then you can map over and decode the actual values.</p>\n\n<p>Thus, a parser error for a single value does not result in a parser error for the whole array.</p>\n\n<p>Edit: As you modified your expectations, this might help you:</p>\n\n<pre><code>Prelude Data.ByteString.Lazy.Char8 Data.Aeson&gt; (decode (pack \"[1,2,3,null,\\\"hello\\\"]\") :: Maybe [Value])\nJust [Number 1.0,Number 2.0,Number 3.0,Null,String \"hello\"]\n</code></pre>\n\n<p>From there, you can map and match such that it fits your needs (because just rounding floats may not be suiteable).</p>\n"}, {"tags": [], "owner": {"reputation": 12813, "user_id": 40569, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/e536b92667e2150c01628f4031974fa2?s=128&d=identicon&r=PG", "display_name": "yogsototh", "link": "https://stackoverflow.com/users/40569/yogsototh"}, "is_accepted": true, "score": 3, "last_activity_date": 1448443781, "creation_date": 1448443781, "answer_id": 33912810, "question_id": 33912046, "link": "https://stackoverflow.com/questions/33912046/haskell-aeson-to-deal-with-missing-data/33912810#33912810", "title": "Haskell Aeson to deal with missing data", "body": "<p>I would use Values and work from them:</p>\n\n<pre><code>decode \"[1,2,3,4,null,\\\"hello\\\"]\" :: (Maybe [Value])\nJust [Number 1.0,Number 2.0,Number 3.0,Number 4.0,Null,String \"hello\"]\n</code></pre>\n\n<p>So</p>\n\n<pre><code>&gt; let fromNum v = case v of Number x -&gt; Just x ; _ -&gt; Nothing \n&gt; maybe [] (map fromNum) (decode  \"[1,2,3,4,null,\\\"hello\\\"]\" :: (Maybe [Value])\n[Just 1.0,Just 2.0,Just 3.0,Just 4.0,Nothing,Nothing]\n</code></pre>\n\n<p>A very ineffective (but safe) solution would be:</p>\n\n<pre><code>&gt; let tmp = maybe [] (map fromNum) (decode  \"[1,2,3,4,null,\\\"hello\\\"]\" :: (Maybe [Value])\n&gt; let keepJust l v = case v of Just i -&gt; i:l; Nothing -&gt; l\n&gt; reverse (foldl keepJust [] tmp)\n[1.0,2.0,3.0,4.0]\n</code></pre>\n\n<p>If you want to make things more effective you might want to use <code>Vector</code>s and <code>foldl'</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "edited": false, "score": 0, "creation_date": 1448448253, "post_id": 33913449, "comment_id": 55590228, "body": "I love this answer. I had no idea about Data.Coerce. I went with @yogsototh s approach because it&#39;s less code but thank you!"}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 4, "last_activity_date": 1448446105, "last_edit_date": 1448446105, "creation_date": 1448445650, "answer_id": 33913449, "question_id": 33912046, "link": "https://stackoverflow.com/questions/33912046/haskell-aeson-to-deal-with-missing-data/33913449#33913449", "title": "Haskell Aeson to deal with missing data", "body": "<p>We can create a newtype around <code>Maybe</code> that doesn't fail when parsing fails, but instead succeeds with <code>Nothing</code>:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings, GeneralizedNewtypeDeriving #-}\n\nimport Data.Aeson\nimport Data.Coerce\nimport Control.Applicative\nimport Control.Monad\n\nnewtype Maybe' a = Maybe' (Maybe a) deriving\n  (Eq, Ord, Show, Functor, Applicative, Monad, Alternative, MonadPlus)\n\ninstance FromJSON a =&gt; FromJSON (Maybe' a) where\n  parseJSON v = do\n    case fromJSON v :: Result a of\n      Success a -&gt; pure (Maybe' $ Just a)\n      _         -&gt; pure (Maybe' $ Nothing)\n</code></pre>\n\n<p>Now we can wrap types with <code>Maybe'</code> to get the desired behavior:</p>\n\n<pre><code>&gt; decode \"[4, 5, \\\"foo\\\", \\\"bar\\\"]\" :: Maybe [Maybe' Int]\nJust [Maybe' (Just 4),Maybe' (Just 5),Maybe' Nothing,Maybe' Nothing]\n</code></pre>\n\n<p>However, there's a good chance we want to work with regular <code>Maybe</code> values afterwards. <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Coerce.html\" rel=\"nofollow\"><code>Data.Coerce</code></a> comes handy here, since it lets us coerce all <code>Maybe'</code>-s to <code>Maybe</code>-s, no matter where they are in the result type:</p>\n\n<pre><code>&gt; coerce (decode \"[[[], 3], [4, 5]]\" :: Maybe [(Maybe' Int, Int)]) :: Maybe [(Maybe Int, Int)]\nJust [(Nothing,3),(Just 4,5)]\n</code></pre>\n"}], "owner": {"reputation": 5328, "user_id": 325809, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/b858606c4daae58cfdb362bf2fc4caa5?s=128&d=identicon&r=PG", "display_name": "fakedrake", "link": "https://stackoverflow.com/users/325809/fakedrake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 33912810, "answer_count": 3, "score": 2, "last_activity_date": 1448446105, "creation_date": 1448441571, "last_edit_date": 1448443439, "question_id": 33912046, "link": "https://stackoverflow.com/questions/33912046/haskell-aeson-to-deal-with-missing-data", "title": "Haskell Aeson to deal with missing data", "body": "<p>I have a (valid) json encoded array that has missing or malformed data. I want Aeson to turn that into <code>Maybe [Maybe Point]</code> and have <code>Nothing</code> where the array element was not a valid <code>Point</code>.</p>\n\n<pre><code>import Data.Aeson\ndecode \"[1,2,3,4,null,\\\"hello\\\"]\" :: (Maybe [Maybe Int])\n=&gt; Nothing\n</code></pre>\n\n<p>But I would much rather have it evaluate to</p>\n\n<pre><code>=&gt; Just [Just 1, Just 2, Just 3, Just 4, Nothing, Nothing]\n</code></pre>\n\n<p>If this can't be done with Aeson, is there another library that can do it?</p>\n\n<p>Note that the actual object is much more complex than a simple integer so string manipulations are not a viable solution.</p>\n"}, {"tags": ["haskell", "llvm", "ghc", "ffi", "llvm-ir"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 2, "last_activity_date": 1449231630, "last_edit_date": 1449231630, "creation_date": 1449231314, "answer_id": 34088207, "question_id": 33910131, "link": "https://stackoverflow.com/questions/33910131/foreign-import-prim-call-to-llvm/34088207#34088207", "title": "foreign import prim call to LLVM", "body": "<p>I've found two problems with your code:</p>\n\n<ol>\n<li><p>Although your signature says you pass in two <code>Word#</code> arguments on the Haskell side, on the LLC side you have <code>i64* %buffer</code> and <code>i64 %length</code> (note type of <code>%buffer</code> is a pointer type!).</p></li>\n<li><p>There is one more level of indirection in <code>sp</code>: <code>sp</code> points at the stack, and the top thing on the stack is the continuation pointer. Your code seems to try to interpret the stack pointer as the function pointer itself.</p></li>\n</ol>\n\n<p>I don't know LLVM, I've just pieced it together by looking at the blog post you linked, knowing GHC, and playing around; so I eventually had to resort to looking at <code>clang</code>'s output, so there might be a more efficient way to handle #2, but anyway here is a version that works and implements swapping of two 64-bit numbers:</p>\n\n<pre><code>define cc10 void @primllvm(i64* %baseReg, i64* %sp, i64* %hp,\n                           i64 %x, i64 %y, i64 %r3, i64 %r4, i64 %r5, i64 %r6,\n                           i64* %spLim,\n                           float %f1, float %f2, float %f3, float %f4,\n                           double %d1, double %d2)\n{\n  %1 = getelementptr inbounds i64* %sp, i64 0\n  %2 = load i64* %1, align 8\n  %cont = inttoptr i64 %2 to void (i64*, i64*, i64*,\n                                   i64, i64, i64, i64, i64, i64,\n                                   i64*,\n                                   float, float, float, float,\n                                   double, double)*\n\n  tail call cc10 void %cont(i64* %baseReg, i64* %sp, i64* %hp,\n                            i64 %y, i64 %x, i64 %r3, i64 %r4, i64 %r5, i64 %r6,\n                            i64* %spLim,\n                            float %f1, float %f2, float %f3, float %f4,\n                            double %d1, double %d2) noreturn\n  ret void\n}\n</code></pre>\n\n<p>Haskell code for testing:</p>\n\n<pre><code>{-# LANGUAGE GHCForeignImportPrim #-}\n{-# LANGUAGE MagicHash, UnboxedTuples, BangPatterns  #-}\n{-# LANGUAGE ForeignFunctionInterface, UnliftedFFITypes #-}\n\nimport GHC.Prim\nimport GHC.Word\n\nforeign import prim \"primllvm\" primllvm :: Word# -&gt; Word# -&gt; (# Word#, Word# #)\n\nmain :: IO ()\nmain = do\n  let !(W# w1) = 12\n      !(W# w2) = 34\n      !(# w1', w2' #) = primllvm w1 w2\n      x = W# w1'\n      y = W# w2'\n  print (x, y)\n</code></pre>\n\n<p>Building:</p>\n\n<pre><code>llc -filetype=obj -o Define.o Define.ll\nghc --make Use.hs Define.o\n</code></pre>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 2, "answer_count": 1, "score": 5, "last_activity_date": 1449232446, "creation_date": 1448434221, "last_edit_date": 1449232446, "question_id": 33910131, "link": "https://stackoverflow.com/questions/33910131/foreign-import-prim-call-to-llvm", "title": "foreign import prim call to LLVM", "body": "<p>I'm trying to make a call to a foreign import prim written in LLVM, using the ideas from this <a href=\"http://breaks.for.alienz.org/blog/2012/02/09/parsing-market-data-feeds-with-ragel/\" rel=\"nofollow\">post</a> but I just keep getting segfaults. Here's what I've got currently.</p>\n\n<p>In Haskell</p>\n\n<pre><code>{-# LANGUAGE GHCForeignImportPrim #-}\n{-# LANGUAGE MagicHash, UnboxedTuples #-}\n{-# LANGUAGE ForeignFunctionInterface, UnliftedFFITypes #-}\n\nimport GHC.Prim\n\nforeign import prim \"primllvm\" primllvm :: Word# -&gt; Word# -&gt; (# Word#, Word# #)\n</code></pre>\n\n<p>And in the <code>.ll</code> file</p>\n\n<pre><code>define cc10 void @primllvm(i64* %baseReg, i64* %sp, i64* %hp, i64* %buffer, i64 %length, i64 %r3, i64 %r4, i64 %r5, i64 %r6, i64* %spLim, float %f1, float %f2, float %f3, float %f4, double %d1, double %d2)\n{\n  %fp = bitcast i64* %sp to void(i64*, i64*, i64*, i64*, i64, i64, i64, i64, i64, i64*, float, float, float, float, double, double)*\n  tail call cc10 void %fp(i64* %baseReg, i64* %sp, i64* %hp, i64* %buffer, i64 %length, i64 %r3, i64 %r4, i64 %r5, i64 %r6, i64* %spLim, float %f1, float %f2, float %f3, float %f4, double %d1, double %d2) noreturn;\n  ret void\n}\n</code></pre>\n\n<p>In theory I think this should just return it's arguments as a tuple, but like I said, it just segfaults. Any help to get this working appreciated.</p>\n"}, {"tags": ["haskell", "types", "polymorphism", "parametric-polymorphism"], "comments": [{"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1448432794, "post_id": 33909773, "comment_id": 55581763, "body": "What are you trying to solve with this function?"}, {"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "reply_to_user": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1448435242, "post_id": 33909773, "comment_id": 55582789, "body": "Making a library that computes music theory things (scales, chords, etc).  I have a function that takes either a scale or chord, and a root note, and then returns a list of notes, which is formatted differently depending on the type.  I figured that streamlining this to just illustrate the issue would make it more palatable, but I probably should have just included the function I was actually using"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1448435287, "post_id": 33909773, "comment_id": 55582816, "body": "I think your example was fine - the music stuff would probably have hidden the details/what matters to much"}], "answers": [{"comments": [{"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1448434850, "post_id": 33909986, "comment_id": 55582604, "body": "That helps.  The solution you proposed for my type signature seems to be as close as it&#39;s going to get to doing type-dependent actions inside a function, but it requires explicit knowledge as to what side of Either it&#39;s going into.  It seems standard practice to do them in instance declarations."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "edited": false, "score": 0, "creation_date": 1448435223, "post_id": 33909986, "comment_id": 55582778, "body": "if you want <code>Either</code> you have to deal with <code>Left</code>/<code>Right</code> - just as with <code>Maybe</code> and <code>Just</code>/<code>Nothing</code>"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 5, "last_activity_date": 1448434247, "last_edit_date": 1448434247, "creation_date": 1448433609, "answer_id": 33909986, "question_id": 33909773, "link": "https://stackoverflow.com/questions/33909773/haskell-polymorphic-type-functions/33909986#33909986", "title": "haskell polymorphic type functions", "body": "<p>first the things you describe and the <code>Either Int String</code> signature seem not to match - I'll try what you describe first (choose the output-type by it's input type):</p>\n\n<p>you can do something very similar to what I think you are trying with type-families:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\nmodule SO where\n\ndata Foo = One | Two | Three deriving (Show, Read)\ndata Bar = This | That | TheOther deriving (Show, Read)\n\nclass PolyMap k where\n  type To k :: *\n  polyMap :: k -&gt; To k\n\ninstance PolyMap Foo where\n  type To Foo = Int\n  polyMap _ = 123\n\ninstance PolyMap Bar where\n  type To Bar = String\n  polyMap _ = \"string\"\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>\u03bb&gt; polyMap One\n123\n\u03bb&gt; polyMap That\n\"string\"\n</code></pre>\n\n<h3>some explanation</h3>\n\n<p>What I think you want is to have type-mappings/functions (there is no runtime check with <code>typeOf</code> out-of-the box and this would give you some nice type-checking support instead) and there are basically two ways to do it (I am aware of)</p>\n\n<ul>\n<li><a href=\"https://wiki.haskell.org/GHC/Type_families\">Type Families</a> which I showed you</li>\n<li><a href=\"https://wiki.haskell.org/Functional_dependencies\">functional dependencies</a> which Cactus did</li>\n</ul>\n\n<p>Both give you (among others) the means to have some way to say: look if I get type A I can say what some associated type B must be (<code>Foo -&gt; Int</code> and <code>Bar -&gt; String</code>)</p>\n\n<p>This is a deep topic (borderline dependent-types ;)) but I think type-families with classes are not to hard to understand.</p>\n\n<p>The idea I used is to have the class <code>PolyMap</code> that provides the <code>polyMap</code> function (you can have it named anything you want - <code>doSomething</code>, whatever) and there the output type depends on the input type using the <code>To k</code> mapping which is <code>Int</code> for <code>Foo</code> and <code>String</code> for <code>Bar</code> as stated in the instance-declarations.</p>\n\n<hr>\n\n<p>the other one for your signature is even easier:</p>\n\n<pre><code>doSomething :: Either Foo Bar -&gt; Either Int String\ndoSomething (Left _) = Left 123\ndoSomething (Right _) = Right \"string\"\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>\u03bb&gt; doSomething (Left One)\nLeft 123\n\u03bb&gt; doSomething (Right That)\nRight \"string\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1448436390, "post_id": 33910004, "comment_id": 55583336, "body": "soon: <a href=\"https://ghc.haskell.org/trac/ghc/wiki/InjectiveTypeFamilies\" rel=\"nofollow noreferrer\">injective type families</a> ;) - of course in this special case you probably don&#39;t need (or even want it) - hard to tell from what we know"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448436497, "post_id": 33910004, "comment_id": 55583386, "body": "@Carsten: but of course. I must say though, I didn&#39;t realize that&#39;s going to support open families as well."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 3, "last_activity_date": 1448435654, "last_edit_date": 1448435654, "creation_date": 1448433670, "answer_id": 33910004, "question_id": 33909773, "link": "https://stackoverflow.com/questions/33909773/haskell-polymorphic-type-functions/33910004#33910004", "title": "haskell polymorphic type functions", "body": "<p>You can put <code>doSomething</code> in a typeclass keyed on both the domain and the codomain types, with a functional dependency from the domain to the codomain:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses, FunctionalDependencies #-}\n{-# LANGUAGE FlexibleInstances  #-} -- if one of your `to` really is `String`\nclass DoSomething from to | from -&gt; to where\n    doSomething :: from -&gt; to\n\ninstance DoSomething Foo Int where -- ...\ninstance DoSomething Bar String where -- ...\n</code></pre>\n\n<p>Compared with the type family-based solution, this has the benefit that <em>if the codomain also uniquely determines the domain</em>, you can add another functional dependency <code>to -&gt; from</code>. I don't think type families offer a good way of modelling that.</p>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 606, "favorite_count": 0, "accepted_answer_id": 33909986, "answer_count": 2, "score": 3, "last_activity_date": 1448435654, "creation_date": 1448432688, "question_id": 33909773, "link": "https://stackoverflow.com/questions/33909773/haskell-polymorphic-type-functions", "title": "haskell polymorphic type functions", "body": "<p>Is it possible in Haskell to have a function that can take a polymorphic type and return a polymorphic type?</p>\n\n<p>For example, I want a function that takes a value, and returns an Int if the value is of type <code>Foo</code> and a String if it is of type <code>Bar</code></p>\n\n<pre><code>data Foo = One | Two | Three deriving (Show, Read)\ndata Bar = This | That | TheOther deriving (Show, Read)\n\ndoSomething :: Either Foo Bar -&gt; Either Int String\ndoSomething var = if (typeOf var) == Int then 123 else \"string\"\n</code></pre>\n\n<p>Is something like this possible?  If not, what is the best practice for routing to another function based on type?</p>\n"}, {"tags": ["haskell", "reflection"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1448399107, "post_id": 33903695, "comment_id": 55570206, "body": "Perhaps you should give this concept its proper name: reflection. I will tag the question."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 9, "creation_date": 1448400114, "post_id": 33903695, "comment_id": 55570710, "body": "This particular brand of reflection is not a service that the Haskell language provides, though it&#39;s pretty straightforward to build (something like) it yourself. What exactly are you hoping to achieve? I suspect this is an X/Y problem, so if you could clarify the underlying problem you&#39;re trying to solve we could probably provide some alternatives."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1448400178, "post_id": 33903695, "comment_id": 55570759, "body": "If your <i>really</i>, <i>really</i> must: <a href=\"http://hackage.haskell.org/package/plugins\" rel=\"nofollow noreferrer\">plugins</a> -- Dynamic linking and runtime evaluation of Haskell, and C, including dependency chasing and package resolution. Using this when not necessary may be considered very bad style."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 2, "creation_date": 1448401302, "post_id": 33903695, "comment_id": 55571368, "body": "Your example does not show any communication between the workers and the application code that launches them, nor any in-JVM communication between the workers. I don&#39;t know if that&#39;s an artifact of the example or a fact about your system, but I think it points to a key question: do the workers really need to be in the same process as the one that launches them? If not, a simple solution is just for the coordinator to launch them as processes. This approach is also known in the Java world\u2014for example, Hadoop normally launches &quot;workers&quot; as separate processes."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1448416255, "post_id": 33903695, "comment_id": 55577023, "body": "As an easy to use alternative to plugins, I suggest looking at hint. (<a href=\"http://stackoverflow.com/questions/5582926/haskell-how-to-evaluate-a-string-like-12/5584638#5584638\" title=\"haskell how to evaluate a string like 12\">stackoverflow.com/questions/5582926/&hellip;</a>)"}, {"owner": {"reputation": 3190, "user_id": 875265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf761af25a59c5da69b56deaf8a32e7?s=128&d=identicon&r=PG", "display_name": "fycth", "link": "https://stackoverflow.com/users/875265/fycth"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1448439096, "post_id": 33903695, "comment_id": 55584657, "body": "@BenjaminHodgson say, I have an application that grabs some data from Internet, does some parsing work and puts the result in DB. We have a vary of websites we grab data from, so we have a vary of parsers. These parsers are workers. User can implement its own worker (a java class) and put its details into DB via UI. So we store names of workers (and their params) in DB. And when it&#39;s time, we go to DB, gather workers&#39; class names and instantiate and start every worker. I&#39;m looking on how such an app could be written in Haskell - in a Haskell way, not necessary to copy the existing Java way."}, {"owner": {"reputation": 3190, "user_id": 875265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf761af25a59c5da69b56deaf8a32e7?s=128&d=identicon&r=PG", "display_name": "fycth", "link": "https://stackoverflow.com/users/875265/fycth"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1448439243, "post_id": 33903695, "comment_id": 55584733, "body": "@chi I&#39;m not sure if I really must to do that. I&#39;m actually looking how I could rewrite such an app in Haskell. And I have some part of it that uses Java reflection. So I need to find an Haskell analog of this feature, or rewrite this part in a Haskell way."}, {"owner": {"reputation": 3190, "user_id": 875265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf761af25a59c5da69b56deaf8a32e7?s=128&d=identicon&r=PG", "display_name": "fycth", "link": "https://stackoverflow.com/users/875265/fycth"}, "reply_to_user": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1448439573, "post_id": 33903695, "comment_id": 55584924, "body": "@LuisCasillas no communication between workers. No communication between a worker and the app. I think, worker not necessarily should be in the same process as the one launched it. Let&#39;s say, it doesn&#39;t mater. OK, but how could I launch a process in Haskell if I know just a function name (storing in as a text in DB) or a class name or so?"}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 1, "creation_date": 1448478856, "post_id": 33903695, "comment_id": 55610295, "body": "@fych: you can just compile each worker to a different executable and launch them by name."}], "owner": {"reputation": 3190, "user_id": 875265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf761af25a59c5da69b56deaf8a32e7?s=128&d=identicon&r=PG", "display_name": "fycth", "link": "https://stackoverflow.com/users/875265/fycth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1448439849, "creation_date": 1448398816, "last_edit_date": 1448439849, "question_id": 33903695, "link": "https://stackoverflow.com/questions/33903695/how-to-run-a-haskell-code-by-its-name", "title": "How to run a Haskell code by its name?", "body": "<p>First of all, I'm new in Haskell and I'm curious how can I implement something that I have working in Java.</p>\n\n<p><strong>A bit of prehistory:</strong></p>\n\n<p>I have a Java-based project with workers. Workers can be started periodically and do some work. A worker - is just a Java-class with some functionality implemented. New workers can be added and configured. Workers' names and parameters are stored in a data base. Periodically, the application gathers workers' details (names, params) from DB and starts them. In Java, to start worker by its name, I do the following:</p>\n\n<pre><code>Class&lt;?&gt; myClass = Class.forName(\"com.mycompany.superworker\");\nConstructor&lt;?&gt; constructor = myClass.getConstructor();\nMyClass myInstance = (MyClass) constructor.newInstance();\nmyInstance.run(\"param1\", \"param2\");\n</code></pre>\n\n<p>Hence, the application gets worker's name (the actual class name) from DB, gets class and constructor, creates new instance of the class and then just runs it.</p>\n\n<p><strong>Now, the question:</strong> how I could implement something similar in Haskell? I mean, if I have some function/module/class whatever implemented in Haskell and I have its name stored in plain text, - then how can I run this code by its name (from the main Haskell-based application, of course)?</p>\n\n<p>Thanks</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>A bit more about the app...\nI have an application that grabs some data from Internet, does some parsing work and puts the result in DB. We have a vary of websites we grab data from, so we have a vary of parsers. These parsers are workers. User can implement its own worker (a java class) and put its details into DB via UI. So we store names of workers (and their params) in DB. And when it's time, we go to DB, gather workers' class names and instantiate and start every worker. </p>\n\n<p>Workers do not need communication between each other. Application also don't need to communicate to workers. Application just start a worker, worker grabs data from web, does some parsing, and puts result into DB. That's it.</p>\n\n<p>So, worker can be launched as a separate process.</p>\n\n<p>The main problem (as for me) is that we don't have some constant amount of workers. User can implement its own worker, compile it, restart the application, and the application should know how to start this new worker. So, we store workers' class names in DB and use Java reflection to launch them.</p>\n\n<p>I'm looking for how such an app could be written in Haskell - in a Haskell way, not necessary to just copy the existing Java way.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 6, "creation_date": 1448395766, "post_id": 33902767, "comment_id": 55568380, "body": "I&#39;m not sure about performance differences (you could try outputting the core of both versions to see if there are any differences), but most haskellers would prefer the second version since it reduces the number of names that need to be bound.  The <code>_</code> means that any value can go there (so long as its the right type, which is given by the type signature.  While it may feel more natural to use <code>n</code> to indicate an integer even when it&#39;s not in use, keep in mind that not everyone will have that bias."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 5, "creation_date": 1448402020, "post_id": 33902767, "comment_id": 55571753, "body": "You can compromise by naming the variable <code>_n</code>, which turns off the warnings when using <code>-Wall</code>, indicates that the variable is not used and names it at the same time."}, {"owner": {"reputation": 474, "user_id": 5464290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5uvw3.jpg?s=128&g=1", "display_name": "basketballfan22", "link": "https://stackoverflow.com/users/5464290/basketballfan22"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1448403462, "post_id": 33902767, "comment_id": 55572463, "body": "@bheklilr Okay, I appreciate your input. I will train myself to get more comfortable with <code>_</code>. Thanks."}, {"owner": {"reputation": 474, "user_id": 5464290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5uvw3.jpg?s=128&g=1", "display_name": "basketballfan22", "link": "https://stackoverflow.com/users/5464290/basketballfan22"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1448403540, "post_id": 33902767, "comment_id": 55572493, "body": "@luqui I appreciate the suggestion to avoid any warnings that would come up with my preferred method. Honestly, I never even knew about <code>-Wall</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1448415388, "post_id": 33902767, "comment_id": 55576787, "body": "@basketballfan22, luqui&#39;s approach has also become idiomatic in recent times, and I like it a lot."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1448472130, "post_id": 33902767, "comment_id": 55606379, "body": "@dfeuer Does any prominent library use that the feature mentioned by Luke ?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1448510306, "post_id": 33902767, "comment_id": 55621353, "body": "@Sibi, I&#39;ve definitely seen it a good bit, so it&#39;s almost certainly used by some, most likely including <code>base</code>, but I couldn&#39;t point to anything in particular off the top of my head."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1448510567, "post_id": 33902767, "comment_id": 55621414, "body": "@bheklilr, there certainly won&#39;t be any performance differences. Alpha conversion only affects anything in a language with too much reflection or with an insane compiler."}, {"owner": {"reputation": 2560, "user_id": 46842, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3a5acbe9f67bdc96d5901946aa87d619?s=128&d=identicon&r=PG", "display_name": "psycotica0", "link": "https://stackoverflow.com/users/46842/psycotica0"}, "edited": false, "score": 1, "creation_date": 1448592644, "post_id": 33902767, "comment_id": 55658004, "body": "Another thing to think about is multiple parameters. You can write: <code>thing _ value _ = value</code> but <code>thing n value n</code> is an error."}], "answers": [{"comments": [{"owner": {"reputation": 474, "user_id": 5464290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5uvw3.jpg?s=128&g=1", "display_name": "basketballfan22", "link": "https://stackoverflow.com/users/5464290/basketballfan22"}, "edited": false, "score": 0, "creation_date": 1448403690, "post_id": 33903076, "comment_id": 55572570, "body": "Thanks a lot. As I mentioned in my post, I haven&#39;t been programming in Haskell for very long; consequently, I never even knew about <code>-Wall</code>. How does one turn it on? Do I simply type <code>-Wall</code> at the very beginning of my source code; and if so, should it precede any imports?"}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 474, "user_id": 5464290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5uvw3.jpg?s=128&g=1", "display_name": "basketballfan22", "link": "https://stackoverflow.com/users/5464290/basketballfan22"}, "edited": false, "score": 1, "creation_date": 1448404702, "post_id": 33903076, "comment_id": 55573058, "body": "@basketballfan22: It&#39;s a command-line option to the compiler.  If you&#39;re compiling by hand with the <code>ghc</code> command, you supply it there.  If you&#39;re using a build tool like Cabal or Stack, the documentation for them will say how to configure your project&#39;s GHC options."}, {"owner": {"reputation": 474, "user_id": 5464290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5uvw3.jpg?s=128&g=1", "display_name": "basketballfan22", "link": "https://stackoverflow.com/users/5464290/basketballfan22"}, "reply_to_user": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1448405140, "post_id": 33903076, "comment_id": 55573258, "body": "@LuisCasillas: Ah! That&#39;s awesome. Thank you for the help."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 474, "user_id": 5464290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5uvw3.jpg?s=128&g=1", "display_name": "basketballfan22", "link": "https://stackoverflow.com/users/5464290/basketballfan22"}, "edited": false, "score": 1, "creation_date": 1448649544, "post_id": 33903076, "comment_id": 55683685, "body": "@basketballfan22, another option is to put <code>{-# OPTIONS_GHC -Wall #-}</code> in your <code>.hs</code> file somewhere above the <code>module</code> line."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 22, "last_activity_date": 1448396901, "last_edit_date": 1448396901, "creation_date": 1448396465, "answer_id": 33903076, "question_id": 33902767, "link": "https://stackoverflow.com/questions/33902767/haskell-underscore-vs-explicit-variable/33903076#33903076", "title": "Haskell underscore vs. explicit variable", "body": "<blockquote>\n  <p>Is there a functional advantage of the second version?</p>\n</blockquote>\n\n<p>I don't think they have any operational difference. But I find the second version more readable. <code>_</code> indicates that it isn't used at all. So while reading the code,  I can just ignore it and just concentrate on the other parameters. Whereas in the first version, I will be thinking that <code>n</code> is defined but maybe the author forgot to use it ? Or maybe the argument isn't required. The second version just avoids this kind of mental overload. But this is just my opinion. :)</p>\n\n<p>In fact, if you enable the warning flag (<code>-Wall</code>) and compile your code, it will throw warning for your first version:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( code.hs, code.o )\n\ncode.hs:2:16: Warning: Defined but not used: \u2018xs\u2019\n\ncode.hs:3:19: Warning: Defined but not used: \u2018n\u2019\n\ncode.hs:4:19: Warning: Defined but not used: \u2018xs\u2019\n\ncode.hs:5:17: Warning: Defined but not used: \u2018x\u2019\n\ncode.hs:8:17: Warning: Defined but not used: \u2018xs\u2019\n</code></pre>\n"}], "owner": {"reputation": 474, "user_id": 5464290, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/5uvw3.jpg?s=128&g=1", "display_name": "basketballfan22", "link": "https://stackoverflow.com/users/5464290/basketballfan22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4634, "favorite_count": 1, "accepted_answer_id": 33903076, "answer_count": 1, "score": 8, "last_activity_date": 1448648158, "creation_date": 1448395430, "last_edit_date": 1448648158, "question_id": 33902767, "link": "https://stackoverflow.com/questions/33902767/haskell-underscore-vs-explicit-variable", "title": "Haskell underscore vs. explicit variable", "body": "<p>I've been learning Haskell for a few weeks, and I have a question about the use of the underscore (<code>_</code>) as a function parameter. I think my question will be better asked with a specific example. Let's say I want to define a function that extracts the element of a list based on the provided index\u2014yes, I realize <code>(!!)</code> is already pre-defined. The two ways that I can define the function (I'm sure there are more) are the following:</p>\n\n<p><strong>Version 1</strong></p>\n\n<pre><code>indexedElement             :: [a] -&gt; Int -&gt; a\nindexedElement xs n | n &lt; 0 = error \"Index can not be negative.\"\nindexedElement [] n         = error \"Index must be smaller than the length of the list.\"\nindexedElement (x:xs) 0     = x\nindexedElement (x:xs) n     = indexedElement xs (n - 1)\n</code></pre>\n\n<p><strong>Version 2</strong></p>\n\n<pre><code>indexedElement            :: [a] -&gt; Int -&gt; a\nindexedElement _ n | n &lt; 0 = error \"Index can not be negative.\"\nindexedElement [] _        = error \"Index must be smaller than the length of the list.\"\nindexedElement (x:_) 0     = x\nindexedElement (_:xs) n    = indexedElement xs (n - 1)\n</code></pre>\n\n<p>The two versions are obviously very similar. The only difference between the two is the use of an explicit variable or an underscore. To me <code>_</code> means that literally anything can be written there while an explicit variable like <code>n</code> makes it more obvious that the argument must be an integer. For that reason, I prefer Version 1; but the GHC source code for <code>(!!)</code> is written like Version 2. Is there a functional advantage of the second version? If not, would \"hardcore\" Haskell programmers take issue with Version 1? I understand the importance of having a consistent way of writing code, so I try to follow the \"unwritten rules\" for programming in a particular language. This is an example where I much prefer the first version though, and I don't think it makes the code any more difficult to read. I don't know if it's due to my background in pure math or what, but I'd like to hear what you more-seasoned-Haskell vets think.</p>\n"}, {"tags": ["haskell", "parsec"], "answers": [{"comments": [{"owner": {"reputation": 477, "user_id": 1874126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095eb7da9ce9f285e965fc8615966652?s=128&d=identicon&r=PG", "display_name": "qwe2", "link": "https://stackoverflow.com/users/1874126/qwe2"}, "edited": false, "score": 0, "creation_date": 1448446869, "post_id": 33908281, "comment_id": 55589338, "body": "Thanks! Still needed some adjustments (namely <code>chainl1 (lexeme subExpr) (pure App)</code>) but it seems to be working now."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1448424106, "creation_date": 1448424106, "answer_id": 33908281, "question_id": 33901206, "link": "https://stackoverflow.com/questions/33901206/parsec-chainl1-on-failure/33908281#33908281", "title": "Parsec chainl1 on failure", "body": "<p>Please include your imports - it makes working with your code a lot easier.</p>\n\n<p>I think I have gotten your parser to work by modifying all of the token parsers to also consume the white space immediately following the token.</p>\n\n<p>For example, replace <code>char x</code> with <code>(char x) &lt;* spaces</code>, <code>string \"-&gt;\"</code> with <code>(string \"-&gt;\") &lt;* spaces</code>, etc.</p>\n\n<p>Here is the working code:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction, FlexibleContexts #-}\n\nimport Text.Parsec \nimport qualified Text.Parsec as P\nimport Text.Parsec.Expr\nimport Text.ParserCombinators.Parsec.Char\nimport Data.Functor.Identity\n\nnewtype LambdaVar = LV Char\n  deriving (Eq, Ord, Show)\n\ndata Type\n  = TBool\n  | TNat\n  | Arr Type Type\n  deriving (Eq, Show)\n\ndata LambdaExpr\n  = Abstr LambdaVar Type LambdaExpr\n  | App LambdaExpr LambdaExpr\n  | Var LambdaVar\n  deriving (Eq, Show)\n\nnewtype TypeContext = TC [(LambdaVar, Type)]\n  deriving (Eq, Show)\n\ndata Expression = Expr TypeContext LambdaExpr Type\n  deriving (Eq, Show)\n\ntype ParserT a b = ParsecT String a Identity b\n\nlexeme p = p &lt;* spaces\n\nlchar = lexeme . char\nlstring = lexeme . string\n\nparens :: ParserT a b -&gt; ParserT a b\nparens = between (lchar '(') (lchar ')')\n\nsymbol :: String -&gt; ParserT a String\nsymbol p = string p &lt;* spaces\n\ntypeParser :: CharParser () Type\ntypeParser = arr &lt;|&gt; tbool &lt;|&gt; tnat\n  where tbool = const TBool &lt;$&gt; lstring \"Bool\"\n        tnat = const TNat &lt;$&gt; lstring \"Nat\"\n        subtyp = parens arr &lt;|&gt; tbool &lt;|&gt; tnat\n        arr = chainr1 subtyp $ try (symbol \"-&gt;\" *&gt; pure Arr)\n\nlambdaParser :: CharParser () LambdaExpr\nlambdaParser = expr\n  where expr = pApp &lt;|&gt; pAbstr &lt;|&gt; pVar\n        pVar = Var . LV &lt;$&gt; (lexeme letter)\n        pAbstr = Abstr &lt;$&gt; (LV &lt;$&gt; (lchar '\\\\' *&gt; letter)) &lt;*&gt; (symbol \":\" *&gt; typeParser) &lt;*&gt; (lchar '.' *&gt; expr)\n        pApp = chainl1 subExpr (pure App)\n        subExpr = parens pApp &lt;|&gt; pAbstr &lt;|&gt; pVar\n\ntypeContextParser :: CharParser () TypeContext\ntypeContextParser = TC &lt;$&gt; ((,) &lt;$&gt; (LV &lt;$&gt; letter &lt;* symbol \":\") &lt;*&gt; typeParser) `sepBy` try (symbol \",\")\n\nexpressionParser :: CharParser () Expression\nexpressionParser = Expr &lt;$&gt; (typeContextParser &lt;* symbol \"|-\") &lt;*&gt; (lambdaParser &lt;* symbol \":\") &lt;*&gt; try typeParser\n\nparseIt :: String -&gt; Either ParseError Expression\nparseIt = P.parse expressionParser \"\"\n\ntest1 = parseIt\n  \"|- \\\\x:Bool -&gt; Nat.\\\\y:Bool.x y : (Bool -&gt; Nat) -&gt; Bool -&gt; Nat\"\n-- 1234 56789.123456789 .123456789.\n--           1          2\n</code></pre>\n"}], "owner": {"reputation": 477, "user_id": 1874126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095eb7da9ce9f285e965fc8615966652?s=128&d=identicon&r=PG", "display_name": "qwe2", "link": "https://stackoverflow.com/users/1874126/qwe2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 33908281, "answer_count": 1, "score": 0, "last_activity_date": 1448424106, "creation_date": 1448389904, "last_edit_date": 1448423253, "question_id": 33901206, "link": "https://stackoverflow.com/questions/33901206/parsec-chainl1-on-failure", "title": "Parsec chainl1 on failure", "body": "<p>I am trying to parse expressions from simply typed lambda calculus (F1) and I'm a struggling a bit with Parsec and can't figure out for the life of me how to solve my problem.</p>\n\n<p>I have the following ADTs:</p>\n\n<pre><code>newtype LambdaVar = LV Char\n  deriving (Eq, Ord)\n\ndata Type\n  = TBool\n  | TNat\n  | Arr Type Type\n  deriving Eq\n\ndata LambdaExpr\n  = Abstr LambdaVar Type LambdaExpr\n  | App LambdaExpr LambdaExpr\n  | Var LambdaVar\n  deriving Eq\n\nnewtype TypeContext = TC [(LambdaVar, Type)]\n  deriving (Eq, Show)\n\ndata Expression = Expr TypeContext LambdaExpr Type\n  deriving (Eq, Show)\n</code></pre>\n\n<p>with this parser:</p>\n\n<pre><code>type ParserT a b = ParsecT String a Identity b\n\nparens :: ParserT a b -&gt; ParserT a b\nparens = between (char '(') (char ')')\n\nsymbol :: String -&gt; ParserT a String\nsymbol p = spaces *&gt; string p &lt;* spaces\n\ntypeParser :: CharParser () Type\ntypeParser = arr &lt;|&gt; tbool &lt;|&gt; tnat\n  where tbool = const TBool &lt;$&gt; string \"Bool\"\n        tnat = const TNat &lt;$&gt; string \"Nat\"\n        subtyp = parens arr &lt;|&gt; tbool &lt;|&gt; tnat\n        arr = chainr1 subtyp $ try (symbol \"-&gt;\" *&gt; pure Arr)\n\nlambdaParser :: CharParser () LambdaExpr\nlambdaParser = expr\n  where expr = pApp &lt;|&gt; pAbstr &lt;|&gt; pVar\n        pVar = Var . LV &lt;$&gt; letter\n        pAbstr = Abstr &lt;$&gt; (LV &lt;$&gt; (char '\\\\' *&gt; letter)) &lt;*&gt; (symbol \":\" *&gt; typeParser) &lt;*&gt; (char '.' *&gt; expr)\n        pApp = chainl1 subExpr (char ' ' *&gt; pure App)\n        subExpr = parens pApp &lt;|&gt; pAbstr &lt;|&gt; pVar\n\ntypeContextParser :: CharParser () TypeContext\ntypeContextParser = TC &lt;$&gt; ((,) &lt;$&gt; (LV &lt;$&gt; letter &lt;* symbol \":\") &lt;*&gt; typeParser) `sepBy` try (symbol \",\")\n\nexpressionParser :: CharParser () Expression\nexpressionParser = Expr &lt;$&gt; (typeContextParser &lt;* symbol \"|-\") &lt;*&gt; (lambdaParser &lt;* symbol \":\") &lt;*&gt; try typeParser\n\nparse :: String -&gt; Either ParseError Expression\nparse = P.parse expressionParser \"\"\n</code></pre>\n\n<p>Now the problem arises when i.e. trying to parse an expression like </p>\n\n<pre><code>|- \\x:Bool -&gt; Nat.\\y:Bool.x y : (Bool -&gt; Nat) -&gt; Bool -&gt; Nat\n</code></pre>\n\n<p>and I try to parse it i will get an error: </p>\n\n<pre><code>unexpected \":\"\nexpecting \"(\", \"\\\\\" or letter\n</code></pre>\n\n<p>So what happens here is that I have a space after <code>x y</code> so the parser assumes this will be an application but then finds a <code>:</code> which it can't parse as one, but I have no idea how to correct this behavior. I suppose I'd have to backtrack somehow with <code>try</code> but I just can't make it work.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 704, "user_id": 939572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadfb25285dc4e9a3caf81e2277d77b?s=128&d=identicon&r=PG", "display_name": "GarethR", "link": "https://stackoverflow.com/users/939572/garethr"}, "edited": false, "score": 0, "creation_date": 1448389981, "post_id": 33900373, "comment_id": 55564871, "body": "Please post the command you used to compile and any output from that command. Are you using cabal? If so, please post the cabal file. If you&#39;re not using cabal you probably should be."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1448390011, "post_id": 33900373, "comment_id": 55564890, "body": "<code>ghc-7.10.20150906</code> is not <code>ghc-7.10.2.20150906</code>."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1448390245, "post_id": 33900373, "comment_id": 55565031, "body": "Also, you can just use <code>ghc-pkg expose ghc</code>."}, {"owner": {"reputation": 331, "user_id": 5377701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/osnHj.jpg?s=128&g=1", "display_name": "O.Phillips", "link": "https://stackoverflow.com/users/5377701/o-phillips"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1448391759, "post_id": 33900373, "comment_id": 55565950, "body": "@ReidBarton Oh, ex\u0441use me, it was a typo."}, {"owner": {"reputation": 331, "user_id": 5377701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/osnHj.jpg?s=128&g=1", "display_name": "O.Phillips", "link": "https://stackoverflow.com/users/5377701/o-phillips"}, "reply_to_user": {"reputation": 704, "user_id": 939572, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2aadfb25285dc4e9a3caf81e2277d77b?s=128&d=identicon&r=PG", "display_name": "GarethR", "link": "https://stackoverflow.com/users/939572/garethr"}, "edited": false, "score": 0, "creation_date": 1448393237, "post_id": 33900373, "comment_id": 55566813, "body": "@GarethR Thanks for your response, I&#39;ve posted a cabal file."}, {"owner": {"reputation": 331, "user_id": 5377701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/osnHj.jpg?s=128&g=1", "display_name": "O.Phillips", "link": "https://stackoverflow.com/users/5377701/o-phillips"}, "edited": false, "score": 0, "creation_date": 1448393722, "post_id": 33900373, "comment_id": 55567103, "body": "Using <code>ghc-pkg expose ghc</code> didn&#39;t help :("}, {"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1448399050, "post_id": 33900373, "comment_id": 55570178, "body": "Could you share the output of <code>sudo ghc-pkg -v2 expose ghc</code> ?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1448401285, "post_id": 33900373, "comment_id": 55571359, "body": "Didn&#39;t help with what? What are you really trying to do?"}, {"owner": {"reputation": 331, "user_id": 5377701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/osnHj.jpg?s=128&g=1", "display_name": "O.Phillips", "link": "https://stackoverflow.com/users/5377701/o-phillips"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1448425384, "post_id": 33900373, "comment_id": 55579288, "body": "@ReidBarton I want to use some modules from GHC API, in particular I want to be able to import them in ghci."}, {"owner": {"reputation": 331, "user_id": 5377701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/osnHj.jpg?s=128&g=1", "display_name": "O.Phillips", "link": "https://stackoverflow.com/users/5377701/o-phillips"}, "reply_to_user": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1448425771, "post_id": 33900373, "comment_id": 55579395, "body": "@adamse <a href=\"http://freetexthost.com/d1utxlrsoa\" rel=\"nofollow noreferrer\">here it is</a>"}, {"owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1448653763, "post_id": 33900373, "comment_id": 55685252, "body": "@O.Phillips: any success?"}, {"owner": {"reputation": 331, "user_id": 5377701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/osnHj.jpg?s=128&g=1", "display_name": "O.Phillips", "link": "https://stackoverflow.com/users/5377701/o-phillips"}, "reply_to_user": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "edited": false, "score": 0, "creation_date": 1448782870, "post_id": 33900373, "comment_id": 55717103, "body": "@adamse Yes, the problem was that root used the wrong <code>ghc-pkg</code>. Thank you very much."}], "answers": [{"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1448485552, "post_id": 33914133, "comment_id": 55613641, "body": "Good catch on the different version of GHC being used under sudo! An easy way to be sure to use the same version is <code>sudo $(which ghc-pkg) expose ghc</code>."}], "tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": true, "score": 2, "last_activity_date": 1448447492, "creation_date": 1448447492, "answer_id": 33914133, "question_id": 33900373, "link": "https://stackoverflow.com/questions/33900373/ghc-pkg-cannot-find-package-ghc-7-10-2-20150906/33914133#33914133", "title": "ghc-pkg: cannot find package ghc-7.10.2.20150906", "body": "<p>Usually when you're writing a larger Haskell project you would specify the packages that you want to use in a project specific Cabal file, here is a quite minimal example that uses the <code>base</code> package and the <code>ghc</code> package, <code>example.cabal</code>:</p>\n\n<pre><code>name:                example\nversion:             0.1.0.0\nbuild-type:          Simple\ncabal-version:       &gt;=1.10\n\nlibrary\n  exposed-modules:     AModule\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n                       , ghc\n  default-language:    Haskell2010\n</code></pre>\n\n<p>To use the GHC 7.10.3 snapshot with this project you run <code>cabal configure --with-compiler=PATH/TO/ghc-7.10.3</code>, then you can access your project with the dependent packages in a GHCi session using <code>cabal repl</code>.</p>\n\n<hr>\n\n<p>If you really want to expose the <code>ghc</code> package your problem seems to be that the <code>sudo ghc-pkg</code> invocation is not the ghc-pkg from the 7.10.3 snapshot, as evidenced by the line</p>\n\n<blockquote>\n  <p>flag db stack: [\"/home/valoisa/.ghc/x86_64-linux-7.10.2/package.conf.d\",\"/usr/local/lib/ghc-7.10.2/package.conf.d\"]</p>\n</blockquote>\n\n<p>in the <a href=\"http://freetexthost.com/d1utxlrsoa\" rel=\"nofollow\">output</a> of <code>sudo ghc-pkg -v2 expose ghc</code> you posted.</p>\n\n<p>I can see two possible solutions</p>\n\n<ol>\n<li>Don't use <code>sudo</code> as it seems the correct version of <code>ghc-pkg</code> is used (I can't think of any reason to use sudo here).</li>\n<li>Use the correct <code>ghc-pkg</code> by specifying the whole path to the program.</li>\n</ol>\n"}], "owner": {"reputation": 331, "user_id": 5377701, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/osnHj.jpg?s=128&g=1", "display_name": "O.Phillips", "link": "https://stackoverflow.com/users/5377701/o-phillips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "accepted_answer_id": 33914133, "answer_count": 1, "score": 0, "last_activity_date": 1448447995, "creation_date": 1448387057, "last_edit_date": 1448447995, "question_id": 33900373, "link": "https://stackoverflow.com/questions/33900373/ghc-pkg-cannot-find-package-ghc-7-10-2-20150906", "title": "ghc-pkg: cannot find package ghc-7.10.2.20150906", "body": "<p>I need to expose a package ghc-7.10.2.20150906. \nWhen I use \"ghc-pkg list\", I see this:<a href=\"https://i.stack.imgur.com/J0sew.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/J0sew.png\" alt=\"enter image description here\"></a></p>\n\n<p>But when I'm trying to expose ghc-7.10.2.20150906 by <code>sudo ghc-pkg expose ghc-7.10.2.20150906</code>, I get a message:</p>\n\n<blockquote>\n  <p>ghc-pkg: cannot find package ghc-7.10.2.20150906</p>\n</blockquote>\n\n<p>What's the problem? Or is there another way to expose it?</p>\n\n<p>Cabal file:</p>\n\n<pre><code>-- This is the configuration file for the 'cabal' command line tool.\n\n-- The available configuration options are listed below.\n-- Some of them have default values listed.\n\n-- Lines (like this one) beginning with '--' are comments.\n-- Be careful with spaces and indentation because they are\n-- used to indicate layout for nested sections.\n\n\nremote-repo: hackage.haskell.org:http://hackage.haskell.org/packages/archive\nremote-repo-cache: /home/valoisa/.cabal/packages\n-- local-repo:\n-- logs-dir:\nworld-file: /home/valoisa/.cabal/world\n-- verbose: 1\n-- compiler: ghc\n-- with-compiler:\n-- with-hc-pkg:\n-- scratchdir:\n-- program-prefix: \n-- program-suffix: \n-- library-vanilla: True\n-- library-profiling: False\n-- shared:\n-- executable-dynamic: False\n-- executable-profiling: False\n-- optimization: True\n-- library-for-ghci: False\n-- split-objs: False\n-- executable-stripping: True\n-- user-install: True\n-- package-db:\n-- flags:\n-- extra-include-dirs:\n-- extra-lib-dirs:\nextra-prog-path: /home/valoisa/.cabal/bin\n-- tests: False\n-- library-coverage: False\n-- benchmarks: False\n-- cabal-lib-version:\n-- constraint:\n-- preference:\n-- solver: choose\n-- documentation: False\n-- doc-index-file: $datadir/doc/index.html\n-- max-backjumps: 2000\n-- reorder-goals: False\n-- shadow-installed-packages: False\n-- strong-flags: False\n-- reinstall: False\n-- avoid-reinstalls: False\n-- force-reinstalls: False\n-- upgrade-dependencies: False\n-- root-cmd:\n-- symlink-bindir:\nbuild-summary: /home/valoisa/.cabal/logs/build.log\n-- build-log:\nremote-build-reporting: anonymous\n-- one-shot: False\njobs: $ncpus\n-- username:\n-- password:\n\ninstall-dirs user\n  -- prefix: /home/valoisa/.cabal\n  -- bindir: $prefix/bin\n  -- libdir: $prefix/lib\n  -- libsubdir: $arch-$os-$compiler/$pkgid\n  -- libexecdir: $prefix/libexec\n  -- datadir: $prefix/share\n  -- datasubdir: $arch-$os-$compiler/$pkgid\n  -- docdir: $datadir/doc/$arch-$os-$compiler/$pkgid\n  -- htmldir: $docdir/html\n  -- haddockdir: $htmldir\n  -- sysconfdir: $prefix/etc\n\ninstall-dirs global\n  -- prefix: /usr/local\n  -- bindir: $prefix/bin\n  -- libdir: $prefix/lib\n  -- libsubdir: $arch-$os-$compiler/$pkgid\n  -- libexecdir: $prefix/libexec\n  -- datadir: $prefix/share\n  -- datasubdir: $arch-$os-$compiler/$pkgid\n  -- docdir: $datadir/doc/$arch-$os-$compiler/$pkgid\n  -- htmldir: $docdir/html\n  -- haddockdir: $htmldir\n  -- sysconfdir: $prefix/etc\n\nprogram-locations \n  -- alex-location:\n  -- ar-location:\n  -- c2hs-location:\n  -- cpphs-location:\n  -- ffihugs-location:\n  -- gcc-location:\n  -- ghc-location:\n  -- ghc-pkg-location:\n  -- greencard-location:\n  -- haddock-location:\n  -- happy-location:\n  -- hmake-location:\n  -- hpc-location:\n  -- hsc2hs-location:\n  -- hscolour-location:\n  -- hugs-location:\n  -- jhc-location:\n  -- ld-location:\n  -- lhc-location:\n  -- lhc-pkg-location:\n  -- nhc98-location:\n  -- pkg-config-location:\n  -- ranlib-location:\n  -- strip-location:\n  -- tar-location:\n  -- uhc-location:\n\nprogram-default-options \n  -- alex-options:\n  -- ar-options:\n  -- c2hs-options:\n  -- cpphs-options:\n  -- ffihugs-options:\n  -- gcc-options:\n  -- ghc-options:\n  -- ghc-pkg-options:\n  -- greencard-options:\n  -- haddock-options:\n  -- happy-options:\n  -- hmake-options:\n  -- hpc-options:\n  -- hsc2hs-options:\n  -- hscolour-options:\n  -- hugs-options:\n  -- jhc-options:\n  -- ld-options:\n  -- lhc-options:\n  -- lhc-pkg-options:\n  -- nhc98-options:\n  -- pkg-config-options:\n  -- ranlib-options:\n  -- strip-options:\n  -- tar-options:\n  -- uhc-options:\n</code></pre>\n"}, {"tags": ["haskell", "cycle"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448391424, "post_id": 33899439, "comment_id": 55565741, "body": "<code>doSomething = dropWhile . (&#47;=)</code>"}, {"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448397528, "post_id": 33899439, "comment_id": 55569309, "body": "@DanielWagner, you nailed it.  If you want to make this comment an answer I&#39;ll check it."}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448385277, "post_id": 33899628, "comment_id": 55562122, "body": "there was a question on that not long ago ... <a href=\"https://stackoverflow.com/questions/33785138/fromenum-toenum-instance/33786042#33786042\" title=\"fromenum toenum instance\">stackoverflow.com/questions/33785138/fromenum-toenum-instanc&zwnj;&#8203;e/&hellip;</a> - maybe it&#39;s interesting - it&#39;s not hard to implement (the tuple version for <code>Enum</code>)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1448385748, "post_id": 33899628, "comment_id": 55562410, "body": "@Carsten: any idea why that instance isn&#39;t in <code>base</code>? Hm, I see it would require <code>Eq</code>. Still, might be a worthwhile proposal..."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448386185, "post_id": 33899628, "comment_id": 55562654, "body": "no clue - best guess: the way to enumerate might be up to debate - also note that I did not check the laws (so there might be some problem there)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1448400505, "post_id": 33899628, "comment_id": 55570933, "body": "@leftaroundabout <code>Enum</code> is a surprisingly tricky class. For example, there&#39;s nothing stopping you from defining <code>data X = A | B</code> with <code>instance Enum X where toEnum 3 = A; toEnum 7 = B</code> -- and this kind of thing (where there are &quot;holes&quot; in the enumeration) happens quite often when writing wrappers around C libraries with C enums."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1448385640, "last_edit_date": 1448385640, "creation_date": 1448384582, "answer_id": 33899628, "question_id": 33899439, "link": "https://stackoverflow.com/questions/33899439/generating-a-sublist-from-cycle-in-haskell/33899628#33899628", "title": "Generating a sublist from cycle in Haskell", "body": "<p>I'd just</p>\n\n<pre><code>getNotes root = [root .. maxBound] ++ init [minBound .. root]\n</code></pre>\n\n<p>but I can see how you prefer the cyclic approach. How about</p>\n\n<pre><code>getNotes root = map snd . take 12 $ [(0,root) .. ]\n</code></pre>\n\n<p>...sadly, that doesn't in fact work: it would need a <code>(Enum a, Enum b, Bounded b) =&gt; Enum (a,b)</code> instance, which for some reason isn't defined, at least not in the prelude.</p>\n\n<p>Alternatively, you can use the index of <code>root</code>:</p>\n\n<pre><code>getNotes root = take 12 . drop (fromEnum root) $ cycle [minBound .. maxBound]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 2, "last_activity_date": 1448387134, "creation_date": 1448387134, "answer_id": 33900401, "question_id": 33899439, "link": "https://stackoverflow.com/questions/33899439/generating-a-sublist-from-cycle-in-haskell/33900401#33900401", "title": "Generating a sublist from cycle in Haskell", "body": "<p>Based on the second idea of @leftaroundabout this is a working version - just in case you are curious and want to play with it:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nmodule Stackoverflow where\n\ndata Note = C | CsDb | D | DsEb | E | F | FsGb | G | GsAb | A | AsBb | B\n          deriving (Show, Enum, Bounded)\n\ninstance (Enum a, Enum b, Bounded b) =&gt; Enum (a,b) where\n  toEnum i =\n    let (d,m) = i `divMod` (fromEnum (maxBound :: b) + 1)\n    in (toEnum d, toEnum m)\n  fromEnum (a, b) = fromEnum a * (fromEnum (maxBound :: b) + 1) + fromEnum b\n\ngetNotes :: Note -&gt; [Note]\ngetNotes root = map snd . take 12 $ [(0,root) .. ]\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>\u03bb&gt; getNotes E\n[E,F,FsGb,G,GsAb,A,AsBb,B,C,CsDb,D,DsEb]\n</code></pre>\n\n<hr>\n\n<p>PS: the idea is extremely smart @leftaroundabout &lt;- so guys make sure to give him lot's of upvotes ;)</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1448400301, "creation_date": 1448400301, "answer_id": 33904111, "question_id": 33899439, "link": "https://stackoverflow.com/questions/33899439/generating-a-sublist-from-cycle-in-haskell/33904111#33904111", "title": "Generating a sublist from cycle in Haskell", "body": "<p>The smallest change you can make that works is to use <code>dropWhile</code>:</p>\n\n<pre><code>getNotes :: Note -&gt; [Note]\ngetNotes root = take 12 . dropWhile (/= root) . cycle $ [minBound .. maxBound]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "is_accepted": false, "score": 0, "last_activity_date": 1448445978, "last_edit_date": 1448445978, "creation_date": 1448445451, "answer_id": 33913380, "question_id": 33899439, "link": "https://stackoverflow.com/questions/33899439/generating-a-sublist-from-cycle-in-haskell/33913380#33913380", "title": "Generating a sublist from cycle in Haskell", "body": "<p>How about</p>\n\n<pre><code>getNotes :: Note -&gt; [Note]\ngetNotes root = ys ++ xs where (xs,ys) = break (==root) [minBound..maxBound]\n</code></pre>\n\n<p>? This is more-or-less the same as @leftaroundabout's first suggestion, avoids the <code>init</code>, but incurs a number of equality comparisons :-)</p>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 1, "accepted_answer_id": 33904111, "answer_count": 4, "score": 2, "last_activity_date": 1448445978, "creation_date": 1448384051, "question_id": 33899439, "link": "https://stackoverflow.com/questions/33899439/generating-a-sublist-from-cycle-in-haskell", "title": "Generating a sublist from cycle in Haskell", "body": "<p>Let's say I have a list of twelve musical notes (which have their own data type), and I want a function that returns a list of notes starting with a given note and looping around.</p>\n\n<pre><code>data Note = C | CsDb | D | DsEb | E | F | FsGb | G | GsAb | A | AsBb | B deriving (Read, Eq, Ord, Enum, Bounded)\ngetNotes :: Note -&gt; [Note]\ngetNotes root = take 12 $ doSomething root $ cycle noteList\n    where noteList :: [Note]\n          noteList = [minBound..maxBound]\n</code></pre>\n\n<p>such that</p>\n\n<pre><code>ghci&gt; getNotes E\n[E, F, FsGb, G, GsAb, A, AsBb, B, C, CsDb, D, DsEb] \n</code></pre>\n\n<p>I can think of a few sloppy ways to do this, but it feels like there should be an obvious, very Haskellian way.  Any recommendations?</p>\n"}, {"tags": ["haskell", "error-handling"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1448380339, "post_id": 33897641, "comment_id": 55558679, "body": "Have you looked at using Software Transactional Memory or STM?"}, {"owner": {"reputation": 1858, "user_id": 1352240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5650ebc3479d59a5266767a26b0e6649?s=128&d=identicon&r=PG", "display_name": "YuriAlbuquerque", "link": "https://stackoverflow.com/users/1352240/yurialbuquerque"}, "edited": false, "score": 1, "creation_date": 1448380443, "post_id": 33897641, "comment_id": 55558746, "body": "Non-related: That <code>Either</code> nested inside the <code>IO</code> could probably be better represented by the <code>ExceptT</code> monad transformer."}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1448380917, "post_id": 33897641, "comment_id": 55559106, "body": "Hi @bheklilr - I have not looked at STM. Would you please show me how to apply it to this example?"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1448381567, "post_id": 33897641, "comment_id": 55559571, "body": "@bheklilr: The idea is to use <code>TVar</code>s to collect the both results purely and then either commit them both to the database or completely roll back? Isn&#39;t it enough to just make <code>foo</code> and <code>bar</code> pure then? I also wonder if <i>&quot;calling <code>foo</code> persists data to a database&quot;</i> means that the database&#39;s transaction control can be used."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448402062, "post_id": 33897641, "comment_id": 55571780, "body": "Can you just throw a <a href=\"http://hackage.haskell.org/package/reducers-3.12.1/docs/Data-Semigroup-Applicative.html#t:Ap\" rel=\"nofollow noreferrer\"><code>WriterT (Ap IO ())</code></a> into your monad transformer stack and use <code>tell</code> to accumulate roll-back actions?"}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1448403757, "post_id": 33897641, "comment_id": 55572607, "body": "could you please give an example, Daniel, for my question?"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1448379061, "creation_date": 1448379061, "question_id": 33897641, "link": "https://stackoverflow.com/questions/33897641/error-handling-with-do-notation", "title": "Error Handling with `do notation`?", "body": "<p>Given the data structure:</p>\n\n<pre><code>data CustomError = FooError | BarError deriving Show\n</code></pre>\n\n<p>And then two functions that perform <code>IO</code>:</p>\n\n<pre><code>foo :: IO (Either CustomError Int)\nfoo = return $ Right 100\n\nbar :: IO (Either CustomError Int)\nbar = return $ Left BarError\n</code></pre>\n\n<p>And a method that adds two <code>Either</code>'s.</p>\n\n<pre><code>add :: Either CustomError Int -&gt; Either CustomError Int -&gt; Either CustomError Int\nadd e1 e2 = (+) &lt;$&gt; e1 &lt;*&gt; e2\n</code></pre>\n\n<p>Lastly, a function that performs two <code>IO</code> actions, and then tries to apply <code>add</code> to their extracted <code>Right</code> values:</p>\n\n<pre><code>f :: IO (Either CustomError Int)\nf = do\n    x &lt;- foo\n    y &lt;- bar\n    return $ add x y\n</code></pre>\n\n<p>Running it shows:</p>\n\n<pre><code>\u03bb: f\nLeft BarError\n</code></pre>\n\n<p>But, let's say that calling <code>foo</code> persists data to a database. If <code>foo</code> succeeds, but <code>bar</code> fails, then there will be irregular state. In other words, I want <code>f</code> to operate like a transaction - everything succeeds or nothing does.</p>\n\n<p>I thought of doing something like:</p>\n\n<pre><code>fWithRecovery:: IO (Either CustomError Int)\nfWithRecovery = do\n    x      &lt;- foo\n    y      &lt;- bar\n    case y of (Right _)       -&gt; return $ add x y\n              (Left FooError) -&gt; fmap Right recoverFoo\n              (Left BarError) -&gt; fmap Right recoverBar\n\n\nrecoverFoo :: IO Int\nrecoverFoo = do\n    _ &lt;- undefined -- clean up DB\n    return 666     -- using an 'evil' value \n                   -- Note - I know using this value is horrible, but\n                   --   I'm using for this simple example\n\nrecoverBar :: IO Int\nrecoverBar = do\n    _ &lt;- undefined -- clean up DB\n    return 42      -- Note - I know using this value is horrible, but\n                   --   I'm using for this simple example\n</code></pre>\n\n<p>But, I'm curious if there's an idiomatic way to handle roll-back for my <code>do notation</code> case.</p>\n"}, {"tags": ["multithreading", "haskell", "parallel-processing", "ghc"], "comments": [{"owner": {"reputation": 88411, "user_id": 120163, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OPDmg.jpg?s=128&g=1", "display_name": "Ira Baxter", "link": "https://stackoverflow.com/users/120163/ira-baxter"}, "edited": false, "score": 0, "creation_date": 1448378661, "post_id": 33895982, "comment_id": 55557400, "body": "I&#39;m not a Haskell person so I can&#39;t help you with making it go parallel.   I am interested in what happens (serial and parallel) in terms of memory space demands.  See <a href=\"http://stackoverflow.com/a/5086087/120163\">stackoverflow.com/a/5086087/120163</a>"}, {"owner": {"reputation": 88411, "user_id": 120163, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/OPDmg.jpg?s=128&g=1", "display_name": "Ira Baxter", "link": "https://stackoverflow.com/users/120163/ira-baxter"}, "edited": false, "score": 3, "creation_date": 1448380377, "post_id": 33895982, "comment_id": 55558711, "body": "Tripped over this, maybe useful: <a href=\"http://stackoverflow.com/questions/9024672/writing-fib-to-run-in-parallel-n2-is-slower?rq=1\" title=\"writing fib to run in parallel n2 is slower\">stackoverflow.com/questions/9024672/&hellip;</a>"}, {"owner": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "edited": false, "score": 1, "creation_date": 1448407899, "post_id": 33895982, "comment_id": 55574276, "body": "I can write a single-threaded program in ruby and run it on an Intel Core i3 - which runs faster than <code>fib n = fib (n-1) + fib (n-2)</code> on an IBM Main Frame with 128 CPUs ;) - sorry, but the fibonacci sequence is a classical example of a problem that should NOT be solved with recursion."}, {"owner": {"reputation": 403, "user_id": 3187369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ld5fs.gif?s=128&g=1", "display_name": "Akaberto", "link": "https://stackoverflow.com/users/3187369/akaberto"}, "edited": false, "score": 0, "creation_date": 1448432228, "post_id": 33895982, "comment_id": 55581516, "body": "I just saw that you had tried to do a force.  I missed that part and hence the deletion.  That said, when I ran this code on my system, I&#39;m getting a speed benefit of around 1.5 (averaged around 10).   Also, parallelism of this sort doesn&#39;t really help since the fibonacci generation itself is of the order 2^n, which is quite bad for large numbers.  As Michael said, fib is not a good suit for recursion (well, memoization will turn it into a linear time complexity algorithm and you get to keep the recursion).    The crux is this:This problem is not inherently very parallel."}, {"owner": {"reputation": 2097, "user_id": 1646823, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8471ef6adbd84694d3c37e445768a75f?s=128&d=identicon&r=PG", "display_name": "jvans", "link": "https://stackoverflow.com/users/1646823/jvans"}, "reply_to_user": {"reputation": 6159, "user_id": 754705, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/942fe51aac5dc523f0305439fa9a6e3d?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/754705/michael"}, "edited": false, "score": 0, "creation_date": 1448451600, "post_id": 33895982, "comment_id": 55592414, "body": "@Michael, this is intentionally using a very slow algorithm. The point here is to learn how to write parallel code. This should be something that can be easily parallelized because we&#39;re running two computations of fibonacci, one should be able to run on each core."}, {"owner": {"reputation": 2024, "user_id": 3026489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42eefce716334b3baef26625220fb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/3026489/yosh"}, "edited": false, "score": 0, "creation_date": 1475393815, "post_id": 33895982, "comment_id": 66920343, "body": "<a href=\"https://www.reddit.com/r/haskellquestions/comments/4cbh58\" rel=\"nofollow noreferrer\">A post on reddit</a> suggests that running with <code>-A16M</code> allows GC to run less frequently and somehow fixes this. I can confirm this on my setup. Behind this was apparently a bug in GHC, as described in <a href=\"http://stackoverflow.com/q/36270447/3026489\">another question on stackoverflow</a>."}], "owner": {"reputation": 2097, "user_id": 1646823, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8471ef6adbd84694d3c37e445768a75f?s=128&d=identicon&r=PG", "display_name": "jvans", "link": "https://stackoverflow.com/users/1646823/jvans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 234, "favorite_count": 3, "closed_date": 1475428481, "answer_count": 0, "score": 8, "last_activity_date": 1448426946, "creation_date": 1448374705, "last_edit_date": 1448375238, "question_id": 33895982, "link": "https://stackoverflow.com/questions/33895982/parallel-fibonacci-example-from-parallel-and-concurrent-programming", "closed_reason": "Duplicate", "title": "Parallel Fibonacci example from &quot;Parallel and Concurrent Programming&quot;", "body": "<p>I'm working through <a href=\"http://chimera.labs.oreilly.com/books/1230000000929/ch03.html\">Chapter 3</a> of \"Parallel and Concurrent Programming in Haskell\" and it has the following example of running the fibonacci sequence in parallel using strategies:</p>\n\n<pre><code>import Control.Parallel\nimport Control.Parallel.Strategies (rpar, Strategy, using)\nimport Text.Printf\nimport System.Environment\n\n-- &lt;&lt;fib\nfib :: Integer -&gt; Integer\nfib 0 = 1\nfib 1 = 1\nfib n = fib (n-1) + fib (n-2)\n-- &gt;&gt;\n\nmain = print pair\n where\n  pair =\n-- &lt;&lt;pair\n   (fib 35, fib 36) `using` parPair\n-- &gt;&gt;\n\n-- &lt;&lt;parPair\nparPair :: Strategy (a,b)\nparPair (a,b) = do\n  a' &lt;- rpar a\n  b' &lt;- rpar b\n  return (a',b')\n-- &gt;&gt;\n</code></pre>\n\n<p>when I compile this with:</p>\n\n<pre><code>ghc -O2 strat.hs -threaded -rtsopts -eventlog\n</code></pre>\n\n<p>and run it with 1 core</p>\n\n<pre><code>./strat +RTS -N1 -s -l\n</code></pre>\n\n<p>I get the following time output:</p>\n\n<pre><code>Total   time    1.23s  (  1.24s elapsed)\n</code></pre>\n\n<p>With two cores <code>./strat +RTS -N2 -s -l</code></p>\n\n<pre><code> Total   time    1.47s  (  1.46s elapsed)\n</code></pre>\n\n<p>When I inspect the log with threadscope, It's easy to see that only 1 core is ever being used to run haskell code and the 2nd core is gc'ing the entire time.</p>\n\n<p>I thought this might be because the evaluation of each function call to to <code>fib</code> wasn't actually occurring until the call the print resulting in the computing not happening in parallel. I made a slight modification to the original code:</p>\n\n<pre><code>import Control.DeepSeq(force, NFData)\nparPair :: (NFData a, NFData b) =&gt; Strategy (a,b)\nparPair (a,b) = do\n  a' &lt;- rpar $ force a\n  b' &lt;- rpar $ force b\n  return (a',b')\n</code></pre>\n\n<p>However this didn't help. What am I missing here, Why is this computation not occurring in parallel?</p>\n"}, {"tags": ["haskell", "char"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1448374487, "post_id": 33895846, "comment_id": 55554392, "body": "Show us your efforts so far."}, {"owner": {"reputation": 31108, "user_id": 350351, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b1a41bbf4677c8961237c4d147e764d6?s=128&d=identicon&r=PG", "display_name": "Daenyth", "link": "https://stackoverflow.com/users/350351/daenyth"}, "edited": false, "score": 2, "creation_date": 1448374509, "post_id": 33895846, "comment_id": 55554404, "body": "Your example doesn&#39;t make sense. In the first line you removed a space, in the second line you preserved it. In the 4th line I can&#39;t tell where <code>str</code> came from - I&#39;d have expected <code>ng</code> instead."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1448374527, "post_id": 33895846, "comment_id": 55554422, "body": "Do you mean <code>yellow ing</code> at the end?"}, {"owner": {"reputation": 5, "user_id": 5524099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b222b4e40769b8445d9a6ef26e42ea89?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hirst", "link": "https://stackoverflow.com/users/5524099/j-hirst"}, "edited": false, "score": 0, "creation_date": 1448374786, "post_id": 33895846, "comment_id": 55554582, "body": "The examples I have used are supposed to be 10 characters in length, apologies if I have made a typo."}, {"owner": {"reputation": 1025, "user_id": 1439629, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4cfce72158cd5741f0a48e67483b85e8?s=128&d=identicon&r=PG", "display_name": "Hamish", "link": "https://stackoverflow.com/users/1439629/hamish"}, "edited": false, "score": 0, "creation_date": 1448374868, "post_id": 33895846, "comment_id": 55554627, "body": "what would you like to happen if you run out of characters in your seed string? Would you like it to loop back and start from the beginning again?"}, {"owner": {"reputation": 5, "user_id": 5524099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b222b4e40769b8445d9a6ef26e42ea89?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hirst", "link": "https://stackoverflow.com/users/5524099/j-hirst"}, "edited": false, "score": 0, "creation_date": 1448374998, "post_id": 33895846, "comment_id": 55554714, "body": "I have tried multiple functions and all seem to fail. I&#39;ve been stuck with this for quite some time now and I&#39;m beginning to lose interest and will most likely move on to something else. I have deleted all previous attempts of code since nothing seems to be working."}, {"owner": {"reputation": 54, "user_id": 4530121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eFjbw.jpg?s=128&g=1", "display_name": "eternauta", "link": "https://stackoverflow.com/users/4530121/eternauta"}, "edited": false, "score": 3, "creation_date": 1448375104, "post_id": 33895846, "comment_id": 55554792, "body": "Can you give us a better and precise specification, please?"}, {"owner": {"reputation": 5, "user_id": 5524099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b222b4e40769b8445d9a6ef26e42ea89?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hirst", "link": "https://stackoverflow.com/users/5524099/j-hirst"}, "reply_to_user": {"reputation": 1025, "user_id": 1439629, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4cfce72158cd5741f0a48e67483b85e8?s=128&d=identicon&r=PG", "display_name": "Hamish", "link": "https://stackoverflow.com/users/1439629/hamish"}, "edited": false, "score": 0, "creation_date": 1448375599, "post_id": 33895846, "comment_id": 55555146, "body": "@Hamish I&#39;m assuming the seed string is the string which I am passing through it? If there are less characters than list elements then it should just stop once it&#39;s finished, but if there are more characters than list elements they need to carry on making new lines of new list elements of the same length."}], "answers": [{"tags": [], "owner": {"reputation": 1212, "user_id": 2455145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kazBZ.jpg?s=128&g=1", "display_name": "AlexJ136", "link": "https://stackoverflow.com/users/2455145/alexj136"}, "is_accepted": false, "score": 1, "last_activity_date": 1448376931, "creation_date": 1448376931, "answer_id": 33896842, "question_id": 33895846, "link": "https://stackoverflow.com/questions/33895846/haskell-how-to-attach-a-string-to-elements-of-a-list-with-a-specific-line-lengt/33896842#33896842", "title": "Haskell: How to attach a string to elements of a list with a specific line length?", "body": "<p>If I understand your question correctly, you want something like this:</p>\n\n<pre><code>extendToLength :: Int -&gt; String -&gt; [String] -&gt; [String]\nextendToLength n (c:cs) (s:ss)\n    | n &gt;  length s = extendToLength n cs ((s ++ [c]):ss)\n    | n == length s = s : extendToLength n (c:cs) ss\n    | otherwise     = undefined\nextendToLength _ [] ss = ss\nextendToLength _ _  [] = []\n</code></pre>\n\n<p>Which takes an <code>Int</code>, a <code>String</code> and a <code>[String]</code>, and while the first element in the <code>[String]</code> has length less than the <code>Int</code>, we take characters from the <code>String</code> and append them to it. When we hit the desired length, we move on to the next element with whatever characters we have left.</p>\n\n<pre><code>&gt; extendToLength 10 \"this is my string\" [\"red\", \"blue\", \"green\", \"yellow\"]\n[\"redthis is\", \"blue my st\", \"greenring\", \"yellow\"]\n\n&gt; extendToLength 10 \"this is my longer string\" [\"red\", \"blue\", \"green\", \"yellow\"]\n[\"redthis is\", \"blue my lo\", \"greennger \", \"yellowstri\"]\n</code></pre>\n\n<p>If you want a buffer of a single space before any characters are appended, you can first apply <code>map (++ \" \")</code> on your list of strings.</p>\n\n<pre><code>&gt; extendToLength 10 \"this is my string\" (map (++ \" \") [\"red\", \"blue\", \"green\", \"yellow\"])\n[\"red this i\", \"blue s my \", \"green stri\", \"yellow ng\"]\n</code></pre>\n\n<p>EDIT: FYI an error is thrown if a <code>String</code> is found exceeding the specified length.</p>\n"}, {"tags": [], "owner": {"reputation": 54, "user_id": 4530121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eFjbw.jpg?s=128&g=1", "display_name": "eternauta", "link": "https://stackoverflow.com/users/4530121/eternauta"}, "is_accepted": false, "score": 0, "last_activity_date": 1448377294, "creation_date": 1448377294, "answer_id": 33896977, "question_id": 33895846, "link": "https://stackoverflow.com/questions/33895846/haskell-how-to-attach-a-string-to-elements-of-a-list-with-a-specific-line-lengt/33896977#33896977", "title": "Haskell: How to attach a string to elements of a list with a specific line length?", "body": "<p>This code work in the way that you describe for this case, but you should change the base cases for get your desired answers in that cases:</p>\n\n<pre><code>cutWord :: String -&gt; Int -&gt; (String, String)\ncutWord \"\" _ = (\"\", \"\")\ncutWord xs 0 = (\"\", xs)\ncutWord (x:xs) n = ((x:s1), s2)\n    where (s1, s2) = cutWord xs (n-1)\n\nappendWord :: [String] -&gt; String -&gt; Int -&gt; [String]\nappendWord [] _ _ = []\nappendWord (xs:xss) ys n = (xs ++ \" \" ++ s1) : (appendWord xss s2 n)\n    where (s1, s2) = cutWord ys (n - (length xs + 1))\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5524099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b222b4e40769b8445d9a6ef26e42ea89?s=128&d=identicon&r=PG&f=1", "display_name": "J. Hirst", "link": "https://stackoverflow.com/users/5524099/j-hirst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1448377294, "creation_date": 1448374311, "question_id": 33895846, "link": "https://stackoverflow.com/questions/33895846/haskell-how-to-attach-a-string-to-elements-of-a-list-with-a-specific-line-lengt", "title": "Haskell: How to attach a string to elements of a list with a specific line length?", "body": "<p>My knowledge of Haskell is very basic as I have just started learning in my second year of university.</p>\n\n<p>I have a list of elements such as:</p>\n\n<pre><code>[\"red\", \"blue\", \"green\", \"yellow\"]\n</code></pre>\n\n<p>I have a function that prints them vertically using the printStrLn function, however I want to attach a string to each end of the line. For example <code>if this is my string</code></p>\n\n<pre><code>red ifthis\nblue is my\ngreen stri\nyellow str\n</code></pre>\n\n<p>It would appear like this if I were to set a character length of 10 for each line.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "is_accepted": true, "score": 5, "last_activity_date": 1448380467, "last_edit_date": 1448380467, "creation_date": 1448371415, "answer_id": 33894877, "question_id": 33894774, "link": "https://stackoverflow.com/questions/33894774/haskell-creating-rectangle-of-1s-with-height-and-width-of-user-input/33894877#33894877", "title": "Haskell - Creating rectangle of 1s with height and width of user input", "body": "<pre><code>rectangle :: Int -&gt; Int -&gt; String\nrectangle h w = unlines (replicate h (replicate w '1'))\n</code></pre>\n\n<p>Although this is a pure function, it does show the relevant part. You can just <code>putStrLn (rectangle 3 4)</code> to have it printed out as expected in ghci, rather than wrapped in a <code>show</code>.</p>\n\n<p>Giving it a second thought, here's a short walkthrough.</p>\n\n<pre><code>replicate :: Int -&gt; a -&gt; [a]\nunlines :: [String] -&gt; String\n</code></pre>\n\n<p>As you can see, <code>replicate w '1'</code>creates a list of w times the charakter <code>1</code>. Because <code>String = [Char]</code>, the result is a String of ones, as many as <code>w</code> says.</p>\n\n<p>Now, this <code>String</code> is replicated again, h times, giving a list of <code>h</code> times that string.</p>\n\n<p><code>unlines</code> now concatenates those strings, inserting a new line character between the strings.</p>\n\n<p>The result is what you'd expect, only that ghci (which you appear to be using) is wrapping each expression's result in a <code>show</code> call. So, to do exactly what you want to achieve, a call to <code>putStr</code> in needed as so:</p>\n\n<pre><code>impureRectangle :: Int -&gt; Int -&gt; IO ()\nimpureRectangle x y = putStr (rectangle x y)\n</code></pre>\n\n<p>Note that monads (or IO, as the first monad, people use to get to know as such) are not the easiest things to get your head around. I'd suggest staying pure until you feel safe.</p>\n"}], "owner": {"reputation": 157, "user_id": 5521983, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fbfb4ad966e1ab171a9027954d47d428?s=128&d=identicon&r=PG&f=1", "display_name": "James Powell", "link": "https://stackoverflow.com/users/5521983/james-powell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 33894877, "answer_count": 1, "score": 0, "last_activity_date": 1448380467, "creation_date": 1448371149, "question_id": 33894774, "link": "https://stackoverflow.com/questions/33894774/haskell-creating-rectangle-of-1s-with-height-and-width-of-user-input", "title": "Haskell - Creating rectangle of 1s with height and width of user input", "body": "<p>I am trying to create a function that will take two integer values that correspond to the width and height of a rectangle of 1s that is outputted like so:</p>\n\n<pre><code> Main&gt; rectangle 3 4\n 1111\n 1111\n 1111\n</code></pre>\n\n<p>I am a beginner at Haskell and have no experience, so any pointers would be appreciated, and therefore only basic Haskell operations should be used. Thanks.</p>\n"}, {"tags": ["haskell", "scrap-your-boilerplate"], "comments": [{"owner": {"reputation": 1722, "user_id": 697188, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b0927ded7bba64ba28a6ec4279a754a6?s=128&d=identicon&r=PG", "display_name": "Michael Welch", "link": "https://stackoverflow.com/users/697188/michael-welch"}, "edited": false, "score": 1, "creation_date": 1448373307, "post_id": 33894217, "comment_id": 55553591, "body": "Interesting question. In looking at Data.Data I see there are functions for create Constr instances. Like mkConstr. I&#39;m guessing that the instance of Show for Constr doesn&#39;t give you enough detail to actually construct a Constr as you are attempting with i2"}], "answers": [{"comments": [{"owner": {"reputation": 773, "user_id": 1133157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c2925a7b468041c60bb15e20f79d058?s=128&d=identicon&r=PG", "display_name": "grwlf", "link": "https://stackoverflow.com/users/1133157/grwlf"}, "edited": false, "score": 0, "creation_date": 1448445536, "post_id": 33900661, "comment_id": 55588464, "body": "Indeed, I&#39;ve missed the Show instance for Constr <code>instance Show Constr where show = constring</code> which shows the name of a constructor.  Just a good old poor Show design problem, Thanks!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 0, "last_activity_date": 1448387980, "creation_date": 1448387980, "answer_id": 33900661, "question_id": 33894217, "link": "https://stackoverflow.com/questions/33894217/understanding-constr-type-of-data-data-package-of-haskell/33900661#33900661", "title": "Understanding Constr type of Data.Data package of Haskell", "body": "<p>That is not a list of actual constructors, but a list of <em>constructor representations</em>. Its <code>Show</code> instance uses a fast and loose output which makes it seem something else.</p>\n\n<p>Just pretend it's something as</p>\n\n<pre><code>[ Constr{ name = \"Nothing\", args = 0, ... }\n, Constr{ name = \"Just\", args = 1, ... }\n]\n</code></pre>\n\n<p>except it's being displayed in a loose way.</p>\n\n<p>More precisely, that is the <em>internal</em>, opaque constructor representation. Use the <code>constr*</code> observer to inspect a value of type <code>Constr</code>.</p>\n"}], "owner": {"reputation": 773, "user_id": 1133157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7c2925a7b468041c60bb15e20f79d058?s=128&d=identicon&r=PG", "display_name": "grwlf", "link": "https://stackoverflow.com/users/1133157/grwlf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 33900661, "answer_count": 1, "score": 1, "last_activity_date": 1448387980, "creation_date": 1448369529, "question_id": 33894217, "link": "https://stackoverflow.com/questions/33894217/understanding-constr-type-of-data-data-package-of-haskell", "title": "Understanding Constr type of Data.Data package of Haskell", "body": "<p>I am trying to understand the Constr type of Data.Data package. Consider the session below. <code>dataTypeConstrs</code> returns a list of <code>Constr</code>, both zero- and one-argument constructors of Maybe. Attempting to re-create the list fails due to obvious type error. Is it a special behavior of GHC regarding to Constr value?</p>\n\n<pre><code>$ ghci\nGHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :set -XScopedTypeVariables\nPrelude&gt; :module +Data.Data\nPrelude Data.Data&gt; dataTypeConstrs (dataTypeOf (Nothing :: Maybe ()))\n[Nothing,Just]\nPrelude Data.Data&gt; :i it\nit :: [Constr]  -- Defined at &lt;interactive&gt;:4:1\n\nPrelude Data.Data&gt; let i2 :: [Constr] = [Nothing,Just]\n\n&lt;interactive&gt;:6:23:\n    Couldn't match expected type \u2018Constr\u2019 with actual type \u2018Maybe a0\u2019\n    In the expression: Nothing\n    In the expression: [Nothing, Just]\n</code></pre>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1448366016, "post_id": 33892572, "comment_id": 55548806, "body": "Do you need to write <code>findArticle</code> yourself, as a homework assignment, or is this a real problem you need to solve? If the latter, you should be able to use <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:lookup\" rel=\"nofollow noreferrer\"><code>Data.List.lookup</code></a> if you can preprocess your inventory so that it has type <code>[(Int, (String, Int)]</code> instead; or just use <code>Data.List.find</code> directly."}, {"owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "edited": false, "score": 0, "creation_date": 1448372238, "post_id": 33892572, "comment_id": 55552910, "body": "What should happen if there&#39;s more than one product with a given barcode, or if there is no product with the given barcode (e.g. if the market has been robbed and there are no products left)?"}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 2, "last_activity_date": 1448366144, "creation_date": 1448366144, "answer_id": 33893053, "question_id": 33892572, "link": "https://stackoverflow.com/questions/33892572/haskell-recursive-find-function/33893053#33893053", "title": "Haskell recursive find Function", "body": "<p>You don't need to write a recursive function yourself -- <code>Data.List</code> already exports the function <code>find</code> with this signature:</p>\n\n<pre><code>find :: Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a\n</code></pre>\n\n<p>Given a barcode <code>bc</code> to look up, the predicate in your case  can be </p>\n\n<pre><code>\\(bc', _, _) -&gt; bc' == bc\n</code></pre>\n\n<p>The result will be <code>Just (_, name, price)</code> if the barcode is found, and <code>Nothing</code> otherwise.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5599364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f7a6a795468a267d4c1267d46b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "MOHAWK", "link": "https://stackoverflow.com/users/5599364/mohawk"}, "edited": false, "score": 0, "creation_date": 1448367279, "post_id": 33893059, "comment_id": 55549700, "body": "thanks for your answer. i think this is what i looked for, but if im trying to use it i get a parse error on findit."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1, "user_id": 5599364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f7a6a795468a267d4c1267d46b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "MOHAWK", "link": "https://stackoverflow.com/users/5599364/mohawk"}, "edited": false, "score": 0, "creation_date": 1448368075, "post_id": 33893059, "comment_id": 55550222, "body": "@MOHAWK Check your indentation."}, {"owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "edited": false, "score": 0, "creation_date": 1448378052, "post_id": 33893059, "comment_id": 55556986, "body": "Could not tested it since im at work (no haskell repl here :/)"}], "tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 0, "last_activity_date": 1448366158, "creation_date": 1448366158, "answer_id": 33893059, "question_id": 33892572, "link": "https://stackoverflow.com/questions/33892572/haskell-recursive-find-function/33893059#33893059", "title": "Haskell recursive find Function", "body": "<p>Here is a recursive version, but keep in mind it is not the best option:    </p>\n\n<pre><code>findIt :: Barcode -&gt; [Inventory] -&gt; (Name, Price)\nfindIt code [] = ()\nfindIt code ((Inventory bc n p):xs) | code == bc = (n, p)\n                                    | otherwise  = findIt code xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 5599364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f7a6a795468a267d4c1267d46b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "MOHAWK", "link": "https://stackoverflow.com/users/5599364/mohawk"}, "edited": false, "score": 0, "creation_date": 1448390646, "post_id": 33894040, "comment_id": 55565255, "body": "thx for you answer, but as i do that i get the error:  No instance for (Show (Inventory -&gt; Maybe InventoryItem)) arising from a use of \u2018print\u2019 n a stmt of an interactive GHCi command: print it  sorry im a total noob and just dont get it with these types."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 0, "last_activity_date": 1448369030, "last_edit_date": 1495541242, "creation_date": 1448369030, "answer_id": 33894040, "question_id": 33892572, "link": "https://stackoverflow.com/questions/33892572/haskell-recursive-find-function/33894040#33894040", "title": "Haskell recursive find Function", "body": "<p>You may want to name your record-style parameters, name the type so it matches a single inventory item and use the type <code>Inventory</code> to reflect the entire inventory (e.g. a list of items):</p>\n\n<pre><code>type Barcode = Int\ntype Name = String\ntype Price = Int\ndata InventoryItem = InventoryItem { barcode :: Barcode\n                                   , name    :: Name\n                                   , price   :: Price\n                                   }\n                     deriving (Eq, Ord, Show)\ntype Inventory = [(Barcode, InventoryItem)]\n</code></pre>\n\n<p>You can then convert your <code>marktInventar</code> to an <code>Inventory</code>:</p>\n\n<pre><code>inventory :: Inventory\ninventory = map (\\(bc, n, p) -&gt; (bc, InventoryItem bc n p)) marktInventar\n</code></pre>\n\n<p>and, as <a href=\"https://stackoverflow.com/users/477476/cactus\">Cactus</a> suggests, use <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:lookup\" rel=\"nofollow noreferrer\"><code>Data.List.lookup</code></a> for your function <code>findArticle</code>:</p>\n\n<pre><code>findArticle :: Barcode -&gt; Inventory -&gt; Maybe InventoryItem\nfindArticle = lookup\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5599364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f7a6a795468a267d4c1267d46b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "MOHAWK", "link": "https://stackoverflow.com/users/5599364/mohawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1448369030, "creation_date": 1448364855, "last_edit_date": 1448365734, "question_id": 33892572, "link": "https://stackoverflow.com/questions/33892572/haskell-recursive-find-function", "title": "Haskell recursive find Function", "body": "<p>I have this code with the inventory list of a supermarket:</p>\n\n<pre><code>type Barcode = Int\ntype Name = String\ntype Price = Int\ndata Inventory = Inventory Barcode Name Price deriving (Eq, Ord, Show)\n\nmarktInventar :: [(Int,String,Int)]\nmarktInventar = [ (321, \"Salz\",     35)\n                , (432, \"Butter\",   95)\n                , (531, \"Milch\",    85)\n                , (235, \"Eier\",    145)\n                , (246, \"Schmalz\", 245)\n                , (642, \"Mehl\",    110)\n                , (528, \"Safran\",  249)\n                , (395, \"Wurst\",   345)\n                , (294, \"Kaese\",   215)\n                , (178, \"Tomate\",   45)\n                , (378, \"Banane\",   75)\n                , (938, \"Orange\",   65)\n                , (491, \"Kiwi\",     95)\n                ]\n</code></pre>\n\n<p>I was just given the list, the rest is made by myself and I hope it is correct.\nNow I should build a function findArticle where I input a barcode and get the name and the price of the product. It should be a recursive function, searching through the list for the matching barcode. But how do I do this?</p>\n\n<p>Thanks for help</p>\n"}, {"tags": ["haskell", "nested-lists", "applicative", "traversable"], "answers": [{"comments": [{"owner": {"reputation": 6824, "user_id": 2144227, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/BiCrB.jpg?s=128&g=1", "display_name": "Manuel Eberl", "link": "https://stackoverflow.com/users/2144227/manuel-eberl"}, "edited": false, "score": 0, "creation_date": 1448366798, "post_id": 33892865, "comment_id": 55549337, "body": "That works, of course, but it is quite a bit more verbose than what I had in mind. As I said, I was hoping for something simple in a shape similar to <code>f &lt;$&gt; xs &lt;*&gt; ys</code>. Besides, this solution does not generalise to arbitrary traversables, does it?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1448369348, "post_id": 33892865, "comment_id": 55551027, "body": "IMO the perfect readability is a <b>huge plus</b> to the generalization / point-free in this case"}, {"owner": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "edited": false, "score": 0, "creation_date": 1448369953, "post_id": 33892865, "comment_id": 55551441, "body": "It generalizes to arbitrary monads."}], "tags": [], "owner": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "is_accepted": false, "score": 7, "last_activity_date": 1448365640, "creation_date": 1448365640, "answer_id": 33892865, "question_id": 33892534, "link": "https://stackoverflow.com/questions/33892534/lifting-function-a-%e2%86%92-b-%e2%86%92-c-to-a-%e2%86%92-b-%e2%86%92-c/33892865#33892865", "title": "Lifting function `a \u2192 b \u2192 c` to `[a] \u2192 [b] \u2192 [[c]]`", "body": "<p>This is a job for list comprehensions!</p>\n\n<pre><code>foo f xs ys = [ [ f x y | y &lt;- ys ] | x &lt;- xs]\n</code></pre>\n\n<p>Testcase:</p>\n\n<pre><code>foo (\\x y -&gt; show x ++ \" \" ++ show y) [1..3] [4..6]\n</code></pre>\n\n<p>yields:</p>\n\n<pre><code>[[\"1 4\",\"1 5\",\"1 6\"],[\"2 4\",\"2 5\",\"2 6\"],[\"3 4\",\"3 5\",\"3 6\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "edited": false, "score": 0, "creation_date": 1448370024, "post_id": 33893764, "comment_id": 55551486, "body": "Any <code>Traversable</code> is a <code>Functor</code>. So this solution generalizes to an arbitrary <code>Traversable</code>."}, {"owner": {"reputation": 1722, "user_id": 697188, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b0927ded7bba64ba28a6ec4279a754a6?s=128&d=identicon&r=PG", "display_name": "Michael Welch", "link": "https://stackoverflow.com/users/697188/michael-welch"}, "edited": false, "score": 0, "creation_date": 1448375141, "post_id": 33893764, "comment_id": 55554816, "body": "I can&#39;t get this to type check. ghci assigns this type: <code>foo :: (Functor f, Functor f1) =&gt; (a -&gt; a1 -&gt; b) -&gt; f a -&gt; f (f1 a1 -&gt; f1 b)</code>. Any attempt to assign the desired type results in an error part of which is the following <code>Expected type: f a -&gt; g b -&gt; f (g c)  Actual type: f a -&gt; f (g b -&gt; g c)</code>"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 1722, "user_id": 697188, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b0927ded7bba64ba28a6ec4279a754a6?s=128&d=identicon&r=PG", "display_name": "Michael Welch", "link": "https://stackoverflow.com/users/697188/michael-welch"}, "edited": false, "score": 1, "creation_date": 1448382653, "post_id": 33893764, "comment_id": 55560309, "body": "@MichaelWelch Oops, sorry. Had to completely rewrite it."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "reply_to_user": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "edited": false, "score": 0, "creation_date": 1448382697, "post_id": 33893764, "comment_id": 55560336, "body": "@svenningsson Yes, my point was that it was even more general (except I got it quite wrong and had to fix)."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 4, "last_activity_date": 1448382587, "last_edit_date": 1448382587, "creation_date": 1448368165, "answer_id": 33893764, "question_id": 33892534, "link": "https://stackoverflow.com/questions/33892534/lifting-function-a-%e2%86%92-b-%e2%86%92-c-to-a-%e2%86%92-b-%e2%86%92-c/33893764#33893764", "title": "Lifting function `a \u2192 b \u2192 c` to `[a] \u2192 [b] \u2192 [[c]]`", "body": "<blockquote>\n  <p>Besides, this solution does not generalise to arbitrary traversables, does it?</p>\n</blockquote>\n\n<p>It does (and even more): both list comprehensions can be replaced by <code>fmap</code>, yielding</p>\n\n<pre><code>foo :: (Functor f, Functor g) =&gt; (a -&gt; b -&gt; c) -&gt; f a -&gt; g b -&gt; f (g c)\nfoo f xs ys = fmap (\\x -&gt; fmap (\\y -&gt; f x y) ys) xs\n</code></pre>\n\n<p>Now, some simplifications:</p>\n\n<pre><code>\\y -&gt; f x y === f x\nfmap (f x) ys === flip fmap ys (f x) === flip fmap ys . f $ x\n\\x -&gt; flip fmap ys . f $ x === flip fmap ys . f\n</code></pre>\n\n<p>So</p>\n\n<pre><code>foo f xs ys = fmap (flip fmap ys . f) xs\n</code></pre>\n"}], "owner": {"reputation": 6824, "user_id": 2144227, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/BiCrB.jpg?s=128&g=1", "display_name": "Manuel Eberl", "link": "https://stackoverflow.com/users/2144227/manuel-eberl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1448382587, "creation_date": 1448364712, "question_id": 33892534, "link": "https://stackoverflow.com/questions/33892534/lifting-function-a-%e2%86%92-b-%e2%86%92-c-to-a-%e2%86%92-b-%e2%86%92-c", "title": "Lifting function `a \u2192 b \u2192 c` to `[a] \u2192 [b] \u2192 [[c]]`", "body": "<p>I would like to have a function </p>\n\n<pre><code>foo :: (a \u2192 b \u2192 c) \u2192 [a] \u2192 [b] \u2192 [[c]]\n</code></pre>\n\n<p>that takes a function <code>f :: a \u2192 b \u2192 c</code> and two lists <code>xs</code> and <code>ys</code> and returns a grid (i.e. a list of lists) containing the values of <code>f</code> applied to every combination of values from <code>xs</code> and <code>ys</code>.</p>\n\n<p>Example: <code>foo [1..3] [4..6]</code> should return</p>\n\n<pre><code>[[f 1 4,f 1 5,f 1 6],\n [f 2 4,f 2 5,f 2 6],\n [f 3 4,f 3 5,f 3 6]]\n</code></pre>\n\n<p>My current approach is</p>\n\n<pre><code>foo = traverse . flip . traverse . flip\n</code></pre>\n\n<p>This works, but I wonder if there is some other approach or a pre-defined combinator with which this can be done more nicely (or perhaps even composably, so that it can easily be extended to ternary or n-ary functions)</p>\n\n<p>For instance: if I didn't want a grid of results but just a list of results, I could write <code>f &lt;$&gt; xs &lt;*&gt; ys</code>, which is concise, uses pre-defined combinators, and generalises to n-ary functions in the obvious way. Is there a similarly concise way of writing my combinator?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1448355732, "post_id": 33889134, "comment_id": 55542004, "body": "note that this is not a list of data-types - it&#39;s still a list of values - maybe you should change the title"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 12, "last_activity_date": 1448356592, "last_edit_date": 1448356592, "creation_date": 1448355442, "answer_id": 33889239, "question_id": 33889134, "link": "https://stackoverflow.com/questions/33889134/can-i-automatically-generate-a-list-of-data-values-in-haskell/33889239#33889239", "title": "Can I automatically generate a list of data values in Haskell?", "body": "<p>if you add automatic <code>deriving</code> for <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#t:Enum\"><code>Enum</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#t:Bounded\"><code>Bounded</code></a> it's as easy as:</p>\n\n<pre><code>data Note = C | CsDb | D | DsEb | E | F | FsGb | G | GsAb | A | AsBb | B\n          deriving (Read, Show, Eq, Ord, Enum, Bounded)\n\nnotes :: [Note]\nnotes = [minBound .. maxBound]\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>\u03bb&gt; notes\n[C,CsDb,D,DsEb,E,F,FsGb,G,GsAb,A,AsBb,B]\n</code></pre>\n\n<p>I'll guess you will know how to do the other ;)</p>\n\n<hr>\n\n<p>you need the <code>Enum</code> for the <code>[ .. ]</code> syntax and <code>Bounded</code> for <code>minBound</code> and <code>maxBound</code> - so you don't have to use <code>Bounded</code> if you don't want but in this case you have to add the <em>bounds</em> yourself:</p>\n\n<pre><code>data Note = C | CsDb | D | DsEb | E | F | FsGb | G | GsAb | A | AsBb | B\n          deriving (Read, Show, Eq, Ord, Enum)\n\nnotes :: [Note]\nnotes = [C .. B]\n</code></pre>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 33889239, "answer_count": 1, "score": 4, "last_activity_date": 1448356592, "creation_date": 1448355120, "last_edit_date": 1448356460, "question_id": 33889134, "link": "https://stackoverflow.com/questions/33889134/can-i-automatically-generate-a-list-of-data-values-in-haskell", "title": "Can I automatically generate a list of data values in Haskell?", "body": "<p>Let's say I create an enumerable <code>data</code> set (or two) in Haskell.</p>\n\n<pre><code>data Note = C | CsDb | D | DsEb | E | F | FsGb | G | GsAb | A | AsBb | B deriving (Read, Show, Eq, Ord)\ndata Diatonic = Unison | Min2 | Maj2 | Min3 | Maj3 | Per4 | Tritone | Per5 | Min6 | Maj6 | Min7 | Maj7 | Octave deriving (Read, Show, Eq, Ord)\n</code></pre>\n\n<p>I'd like to have access to a list of these values, and this is the only way I know how:</p>\n\n<pre><code>notes :: [Note]\nnotes = [C, CsDb, D, DsEb, E, F, FsGb, G, GsAb, A, AsBb, B]\n\ndiatonics :: [Diatonic]\ndiatonics = [Unison, Min2, Maj2, Min3, Maj3, Per4, Tritone, Per5, Min6, Maj6, Min7, Maj7, Octave]\n</code></pre>\n\n<p>This seems like redundant boilerplate.  Is this the only way to create such a list, or can Haskell do it for me somehow?</p>\n"}, {"tags": ["haskell", "io"], "comments": [{"owner": {"reputation": 1280, "user_id": 1545982, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6126f899f04c410b80d91063a8f125ab?s=128&d=identicon&r=PG&f=1", "display_name": "Emz", "link": "https://stackoverflow.com/users/1545982/emz"}, "edited": false, "score": 0, "creation_date": 1448355262, "post_id": 33889109, "comment_id": 55541712, "body": "In the code. Jokes aside, I suggest you paste the code here instead of linking to parts of it."}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 1, "creation_date": 1448358549, "post_id": 33889109, "comment_id": 55543749, "body": "Please don&#39;t edit out the mistakes of your original code, it makes the correlation between question and answers very confusing."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 5598716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ae4598a833681031358683c2d29eb5?s=128&d=identicon&r=PG&f=1", "display_name": "VCib", "link": "https://stackoverflow.com/users/5598716/vcib"}, "edited": false, "score": 0, "creation_date": 1448355787, "post_id": 33889177, "comment_id": 55542042, "body": "Thanks, adding let&#39;s to the density bindings solved the first issue. However, the second is still present - I can&#39;t make main show any text, it only accepts inputs and mirrors them."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1448355229, "creation_date": 1448355229, "answer_id": 33889177, "question_id": 33889109, "link": "https://stackoverflow.com/questions/33889109/haskell-issues-parse-error-and-empty-main/33889177#33889177", "title": "Haskell issues: parse error and empty main", "body": "<p>You need <code>let</code> to define new bindings inside a <code>do</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1448357933, "post_id": 33889649, "comment_id": 55543378, "body": "GHCi does not execute anything by default, just provides a REPL -- you have to call <code>main</code> yourself. Otherwise, avoid GHCi and run <code>runhaskell Yourfile.hs</code> from the command line, which will execute <code>main</code>, but will not give you a REPL as GHCi does."}], "tags": [], "owner": {"reputation": 15, "user_id": 5598716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ae4598a833681031358683c2d29eb5?s=128&d=identicon&r=PG&f=1", "display_name": "VCib", "link": "https://stackoverflow.com/users/5598716/vcib"}, "is_accepted": false, "score": 0, "last_activity_date": 1448356663, "creation_date": 1448356663, "answer_id": 33889649, "question_id": 33889109, "link": "https://stackoverflow.com/questions/33889109/haskell-issues-parse-error-and-empty-main/33889649#33889649", "title": "Haskell issues: parse error and empty main", "body": "<p>Figured out I need to manually write \"getLength\" when working with the program to call the function, then everything works fine.</p>\n\n<p>Question is - why do I have to do that, if getLength is explicitly mentioned in the \"main = do\" clause?</p>\n"}], "owner": {"reputation": 15, "user_id": 5598716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5ae4598a833681031358683c2d29eb5?s=128&d=identicon&r=PG&f=1", "display_name": "VCib", "link": "https://stackoverflow.com/users/5598716/vcib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 33889177, "answer_count": 2, "score": 1, "last_activity_date": 1448357101, "creation_date": 1448355022, "last_edit_date": 1448357101, "question_id": 33889109, "link": "https://stackoverflow.com/questions/33889109/haskell-issues-parse-error-and-empty-main", "title": "Haskell issues: parse error and empty main", "body": "<p>I have to figure out how to write a Haskell program that does the following:</p>\n\n<ol>\n<li>Asks the user for container length, width and height</li>\n<li>Asks for the maximum allowed mass</li>\n<li>Calculates and presents the maximum allowed density</li>\n</ol>\n\n<p>After some fooling around with the code and several quality hours studying LearnYouAHaskell, I came to this:</p>\n\n<pre><code>main = do\n getLength\n\nisNumber :: String -&gt; Bool\nisNumber line = if (null $ filter (`notElem` ['0'..'9'] ++ ['.']) line)\n  then True\n  else False\n\ngetInput :: IO Double\ngetInput = do\n line &lt;- getLine\n if isNumber line\n  then return (read line :: Double)\n  else do\n  putStrLn \"This value is not a number, please try again!\"\n  getInput\n\ngetLength :: IO ()\ngetLength = do\n putStrLn \"-----------------------\"\n putStrLn \"DensityCalc v1.0\"\n putStrLn \"-----------------------\"\n putStrLn \"\"\n putStrLn \"Please enter the container length to begin.\"\n putStrLn \"Entering 0 will end the program.\"\n length &lt;- getInput\n if length == 0\n  then putStrLn \"Goodbye!\"\n  else do\n   putStrLn $ \"Length: \" ++ show length\n   putStrLn \"Now enter container width (0 to quit): \"\n   getWidth length\n\ngetWidth :: Double -&gt; IO ()\ngetWidth length = do\n width &lt;- getInput\n if width == 0\n  then putStrLn \"Goodbye!\"\n  else do\n   putStrLn $ \"Width: \" ++ show width\n   putStrLn \"Now enter container height (0 to quit): \"\n   getHeight length width\n\ngetHeight :: Double -&gt; Double -&gt; IO ()\ngetHeight length width = do\n height &lt;- getInput\n if height == 0\n  then putStrLn \"Goodbye!\"\n  else do\n   putStrLn $ \"Height: \" ++ show height\n   putStrLn \"Finally, enter maximum allowed mass (0 to quit): \"\n   getMass length width height   \n\ngetMass :: Double -&gt; Double -&gt; Double -&gt; IO ()\ngetMass length width height = do\n mass &lt;- getInput\n if mass == 0\n  then putStrLn \"Goodbye!\"\n  else do\n   putStrLn $ \"Maximum mass: \" ++ show mass\n   putStrLn \"Calculating density...\"\n   getDensity length width height mass\n\ngetDensity :: Double -&gt; Double -&gt; Double -&gt; Double -&gt; IO ()\ngetDensity length width height mass = do\n let density = mass * 100.0 / length * width * height\n let roundedDensity = round (density :: Double)\n let shownDensity = (fromIntegral roundedDensity) / 100.0\n putStrLn $ \"Maximum allowed freight density: \" ++ show shownDensity\n putStrLn \"Thank you for using my tool! Goodbye!\"\n</code></pre>\n\n<p>My first issue is: when compiling, it's giving me a \"parse error on input =\" in line 65 - </p>\n\n<pre><code>density = mass * 100.0 / length * width * height\n</code></pre>\n\n<p>Second, if I take out the density function altogether, it compiles - but the main function does nothing (returns what I input, and nothing else) - <a href=\"http://content.screencast.com/users/VCibinogins/folders/Jing/media/9849bd48-b8b8-4823-83bc-5182c5e20674/2015-11-24_1049.png\" rel=\"nofollow\">screenshot</a></p>\n\n<p>Where should I look for mistakes?</p>\n\n<p>[edit]</p>\n\n<p>First issue solved, changed the code. Second still present.</p>\n\n<p>[edit2]</p>\n\n<p>It seems that, in order to start, I need to manually type in \"getLength\" in the Main window. Can I make it call the function immediately?</p>\n"}, {"tags": ["algorithm", "haskell", "optimization", "point"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 5, "creation_date": 1448328018, "post_id": 33883795, "comment_id": 55531985, "body": "<a href=\"https://en.wikipedia.org/wiki/Nearest_neighbor_search\" rel=\"nofollow noreferrer\">There are many</a>. I&#39;d recommend to look into triangle inequality."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1448333615, "post_id": 33883795, "comment_id": 55533453, "body": "You might like to read about how <a href=\"http://chipmunk-physics.net/release/ChipmunkLatest-Docs/#cpSpace-SpatialHash\" rel=\"nofollow noreferrer\">Chipmunk, an existing 2D physics library</a> handles this problem."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 2, "creation_date": 1448349982, "post_id": 33883795, "comment_id": 55538977, "body": "I would recommend a <a href=\"https://en.wikipedia.org/wiki/K-d_tree\" rel=\"nofollow noreferrer\">k-d tree</a> or some similar tree structure where you first insert all the points into the structure and then extract them based on some criterion of closeness. You can avoid comparing all points with all other points by sorting them in each dimension. (The sorting step can be the same as the step where you insert something into a tree.)"}, {"owner": {"reputation": 153, "user_id": 5511813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82fa8bad39b965aa42733fc71d8cbf49?s=128&d=identicon&r=PG&f=1", "display_name": "Snow Sailor", "link": "https://stackoverflow.com/users/5511813/snow-sailor"}, "edited": false, "score": 0, "creation_date": 1448733570, "post_id": 33883795, "comment_id": 55705361, "body": "Hmm that&#39;s interesting. Thanks for the replies. I did some stuff with list comprehensions, but I know it&#39;s not the fastest way. I will definitely look into your ways and see if I can apply them to my problem."}], "owner": {"reputation": 153, "user_id": 5511813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82fa8bad39b965aa42733fc71d8cbf49?s=128&d=identicon&r=PG&f=1", "display_name": "Snow Sailor", "link": "https://stackoverflow.com/users/5511813/snow-sailor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448327646, "creation_date": 1448327646, "question_id": 33883795, "link": "https://stackoverflow.com/questions/33883795/locate-points-that-are-close-to-other-points-in-haskell", "title": "Locate Points that are close to other Points in Haskell", "body": "<p>I am working on building a gravity simulator and I want to run the back end of it (dealing with the particles) in Haskell. I have my Point data like this:</p>\n\n<pre><code>data Point = Point {\n  key :: Int,\n  x :: Double,\n  y :: Double,\n  r :: Double\n} deriving (Show, Read, Eq)\n</code></pre>\n\n<p>Where a <code>key</code> is just some unique identifier, the <code>x</code> is the x-position, the <code>y</code> the y-position, and <code>r</code> being the radius of the sphere that surrounds the point.</p>\n\n<p>Say I have a list of points <code>[Point]</code>. I would like to grab all the points from this list that are going to be touching. This means that <code>(distance between Point1 and Point2) &lt;= (radius1 + radius2)</code>.</p>\n\n<p>Is there a fast way I check this condition for each element against every other element relatively quickly? I feel like choosing one element, looping through the list, and then repeating that action for every element of the list could be rather slow when I have a list that is longer than a certain number of points.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "functional-programming", "typeclass"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1448318360, "post_id": 33881849, "comment_id": 55528653, "body": "No other sane way but those two, as far as I can see."}, {"owner": {"reputation": 1587, "user_id": 3271946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/446c713f3dc5528707d32819146a9789?s=128&d=identicon&r=PG&f=1", "display_name": "ArunasR", "link": "https://stackoverflow.com/users/3271946/arunasr"}, "edited": false, "score": 0, "creation_date": 1448354363, "post_id": 33881849, "comment_id": 55541220, "body": "<code>class UserLetter</code> is the preferable solution, because it is extendible. Suppose later you get type <code>OfficerInfo</code>; all you need to do is add the instance of the class. It is also least useful...because if you have entirely unrelated types, how can you use them together? For instance, how are you going to store a mixed list of all civilians, service members and veterans? You will need a boxed type, like @leftaroundabout suggested below, and then you can as well use pattern matching on the boxed type."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 5346542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XKOUIxTHV58/AAAAAAAAAAI/AAAAAAAAAZQ/o6nA1BYK8AI/photo.jpg?sz=128", "display_name": "Alexander Shestakov", "link": "https://stackoverflow.com/users/5346542/alexander-shestakov"}, "edited": false, "score": 0, "creation_date": 1448320281, "post_id": 33882437, "comment_id": 55529438, "body": "But then I&#39;d need to wrap my VeteranInfo instances to be VeteranUserInfo...  Any easy (generalized) way to do so?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 23, "user_id": 5346542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XKOUIxTHV58/AAAAAAAAAAI/AAAAAAAAAZQ/o6nA1BYK8AI/photo.jpg?sz=128", "display_name": "Alexander Shestakov", "link": "https://stackoverflow.com/users/5346542/alexander-shestakov"}, "edited": false, "score": 0, "creation_date": 1448325883, "post_id": 33882437, "comment_id": 55531404, "body": "@AlexanderShestakov: yeah (see edit), but it&#39;s a bad idea. Having new constructors to explicitly distinguish the types is <i>a good thing</i>, because it makes the code clear and gives the compiler plenty of hints for type checking. That is of course provided these type are <i>supposed</i> to be rigorously distinguished. Frankly, it quite looks to like you shouldn&#39;t have three different types at all, but just use a simple variant label in a single <code>UserVar</code> type (as user2407038 suggests in the beginning)."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 0, "last_activity_date": 1448325579, "last_edit_date": 1448325579, "creation_date": 1448319823, "answer_id": 33882437, "question_id": 33881849, "link": "https://stackoverflow.com/questions/33881849/polymorphic-function-over-types-combined-by-typeclass/33882437#33882437", "title": "Polymorphic function over types combined by typeclass", "body": "<blockquote>\n  <p>&ldquo;Is there a way to declare one ADT with existing ServiceMemberInfo (and others) types?&rdquo;</p>\n</blockquote>\n\n<p>Why, sure there is!</p>\n\n<pre><code>data UserInfo = ServiceMemberUserInfo ServiceMemberInfo\n              | VeteranUserInfo VeteranInfo\n              | CivilianUserInfo CivilianInfo\n</code></pre>\n\n<p>Then <code>userLetter1 :: UserInfo -&gt; Char</code> can be defined as before, but you still keep the seperate record definitions of <code>ServiceMemberInfo</code>, <code>VeteranInfo</code> and <code>CivilianInfo</code>.</p>\n\n<p>Instead of declaring this as a new named ADT, you can also make it an &ldquo;anonymous variant type&rdquo;:</p>\n\n<pre><code>type (+) = Either\n\ntype UserInfo = ServiceMemberInfo + VeteranInfo + CivilianInfo\n</code></pre>\n\n<p>Then you can define</p>\n\n<pre><code>userLetter1 :: UserInfo -&gt; Char\nuserLetter1 (Left (Left _)) = 'C'\nuserLetter1 (Left (Right _)) = 'S'\nuserLetter1 (Right _) = 'V'\n</code></pre>\n\n<p>Clearly, this is not really preferrable: the anonymous constructors are much less descriptive.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1448320817, "last_edit_date": 1448320817, "creation_date": 1448320306, "answer_id": 33882538, "question_id": 33881849, "link": "https://stackoverflow.com/questions/33881849/polymorphic-function-over-types-combined-by-typeclass/33882538#33882538", "title": "Polymorphic function over types combined by typeclass", "body": "<p>It is possible to use existing type-classes to do this, and meet the pattern-matching-like syntax requirements you have, by defining a <em>type</em>-level function which returns the appropriate string, then picking the term-level string that corresponds to the type-level one. Here's a complete working example:</p>\n\n<pre><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE FlexibleContexts #-}\nimport GHC.TypeLits\nimport Data.Proxy\n\ndata ServiceMemberInfo = ServiceMemberInfo { smname::String }\ndata       VeteranInfo =       VeteranInfo {  vname::String }\ndata      CivilianInfo =      CivilianInfo {  cname::String }\n\ntype family Label x :: Symbol\ntype instance Label ServiceMemberInfo = \"S\"\ntype instance Label       VeteranInfo = \"V\"\ntype instance Label      CivilianInfo = \"C\"\n\nlabel :: forall a. KnownSymbol (Label a) =&gt; a -&gt; String\nlabel x = symbolVal (Proxy :: Proxy (Label a))\n</code></pre>\n\n<p>We can see it go in ghci:</p>\n\n<pre><code>*Main&gt; label (ServiceMemberInfo \"\")\n\"S\"\n</code></pre>\n\n<p>However, there's a lot not to like about this solution: it requires many extensions; it's complicated (hence will be a maintenance problem); and it is in some sense done this way <em>only</em> to paper over a design problem in the underlying types, which would be better served by eliminating the technical debt you've incurred already.</p>\n"}, {"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 1, "last_activity_date": 1448324439, "creation_date": 1448324439, "answer_id": 33883296, "question_id": 33881849, "link": "https://stackoverflow.com/questions/33881849/polymorphic-function-over-types-combined-by-typeclass/33883296#33883296", "title": "Polymorphic function over types combined by typeclass", "body": "<p>I would just redefine the datatypes like so:</p>\n\n<pre><code>newtype UserInfo = User { type :: UserType, name :: String } \ndata UserType = Civilian | ServiceMember | Veteran\n</code></pre>\n\n<p>But if you really can't change the original datatypes, then you can do something like the following with <code>ViewPattern</code> and optiononally <code>PatternSynonyms</code>:</p>\n\n<pre><code>{-# LANGUAGE PatternSynonyms, ViewPatterns, StandaloneDeriving, DeriveDataTypeable #-} \n\nimport Data.Typeable \n\ndata ServiceMemberInfo = ServiceMemberInfo { smname::String }\ndata VeteranInfo = VeteranInfo { vname::String }\ndata CivilianInfo = CivilianInfo { cname::String }\n\nderiving instance Typeable ServiceMemberInfo\nderiving instance Typeable VeteranInfo\nderiving instance Typeable CivilianInfo\n\npattern ServiceMemberInfo_ x &lt;- (cast -&gt; Just (ServiceMemberInfo x))\npattern VeteranInfo_ x &lt;- (cast -&gt; Just (VeteranInfo x))\npattern CivilianInfo_ x &lt;- (cast -&gt; Just (CivilianInfo x))\n\ntype UserLetter = Typeable \n\n-- without pattern synonyms\nuserLetter :: UserLetter a =&gt; a -&gt; Char\nuserLetter (cast -&gt; Just (CivilianInfo{})) = 'C'\nuserLetter (cast -&gt; Just (ServiceMemberInfo{})) = 'S'\nuserLetter (cast -&gt; Just (VeteranInfo{})) = 'V'\nuserLetter _ = error \"userLetter\"\n\n-- with pattern synonyms\nuserLetter1 :: UserLetter a =&gt; a -&gt; Char\nuserLetter1 (CivilianInfo_ _) = 'C'\nuserLetter1 (ServiceMemberInfo_ _) = 'S'\nuserLetter1 (VeteranInfo_ _) = 'V'\nuserLetter1 _ = error \"userLetter\"\n</code></pre>\n\n<p>This isn't very safe because you can call <code>userLetter</code> with <em>any</em> <code>Typeable</code> (which is everything); it could be better (but more work) to define a class like:</p>\n\n<pre><code>class Typeable a =&gt; UserLetter a \ninstance UserLetter ServiceMemberInfo \n...\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 5346542, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XKOUIxTHV58/AAAAAAAAAAI/AAAAAAAAAZQ/o6nA1BYK8AI/photo.jpg?sz=128", "display_name": "Alexander Shestakov", "link": "https://stackoverflow.com/users/5346542/alexander-shestakov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1448325579, "creation_date": 1448317410, "last_edit_date": 1448319688, "question_id": 33881849, "link": "https://stackoverflow.com/questions/33881849/polymorphic-function-over-types-combined-by-typeclass", "title": "Polymorphic function over types combined by typeclass", "body": "<p>Consider such domain logic: three types of users: Civilians, ServiceMembers and Veterans. Each of them has 'name', stored in different attributes.</p>\n\n<p>Task is to write a function, accepting each of the types and returning 'C' char for Civilians, 'V' char for Veterans and 'S' char for ServiceMembers.</p>\n\n<p>I have such record declarations:</p>\n\n<pre><code>data ServiceMemberInfo = ServiceMemberInfo { smname::String }\ndata VeteranInfo = VeteranInfo { vname::String }\ndata CivilianInfo = CivilianInfo { cname::String }\n</code></pre>\n\n<p>My first idea was to combine them by such typeclass:</p>\n\n<pre><code>class UserLetter a where\n  userLetter :: a -&gt; Char\n</code></pre>\n\n<p>And implement instances:</p>\n\n<pre><code>instance UserLetter ServiceMemberInfo where\n  userLetter _ = 'S'\n\ninstance UserLetter VeteranInfo where\n  userLetter _ = 'V'\n\ninstance UserLetter CivilianInfo where\n  userLetter _ = 'C'\n</code></pre>\n\n<p>In this case, <code>userLetter</code> is a function I wanted.\nBut I really would like to write something like that (without typeclasses)</p>\n\n<pre><code>userLetter1 :: UserLetter a =&gt; a -&gt; Char\nuserLetter1 (CivilianInfo _) = 'C'\nuserLetter1 (ServiceMemberInfo _) = 'S'\nuserLetter1 (VeteranInfo _) = 'V'\n</code></pre>\n\n<p>which throws compilation error: 'a' is a rigid type variable bound by</p>\n\n<p>Another way is to use ADT: </p>\n\n<pre><code>data UserInfo = ServiceMemberInfo { smname::String }\n              | VeteranInfo { vname::String }\n              | CivilianInfo { cname::String }\n</code></pre>\n\n<p>Then userLetter1 declaration becomes obvious:</p>\n\n<pre><code>userLetter1 :: UserInfo -&gt; Char\nuserLetter1 (CivilianInfo _) = 'C'\nuserLetter1 (ServiceMemberInfo _) = 'S'\nuserLetter1 (VeteranInfo _) = 'V'\n</code></pre>\n\n<p>But, lets say, I don't have control over ServiceMemberInfo (and others) declarations. How userLetter1 can be defined?</p>\n\n<p>Is there a way to declare one ADT with existing ServiceMemberInfo (and others) types?</p>\n"}, {"tags": ["haskell", "monads", "writer-monad"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1448318101, "post_id": 33881822, "comment_id": 55528523, "body": "When you do <code>x &lt;- e</code> in the <code>Writer</code> monad, the <code>x</code> will not generally capture the writer state. You could rewrite logNumber as <code>logNumber num = tell &quot;...&quot; &gt;&gt; return num</code> - this is a computation which yields the same number it was given, but as a side effect &quot;logs&quot; a string. When you &quot;bind&quot; you are accessing the value that was &quot;returned&quot; - which is simply the number. You can get the desired behaviour with <code>listen</code>: <code>(x,loggedString) &lt;- listen $ logNumber 3</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1448319188, "last_edit_date": 1495542220, "creation_date": 1448318207, "answer_id": 33882090, "question_id": 33881822, "link": "https://stackoverflow.com/questions/33881822/understanding-example-on-writer-monad/33882090#33882090", "title": "Understanding example on Writer Monad", "body": "<p>The idea of &ldquo;values contained in a monad&rdquo; is a bit fuzzy. It kind of works, but not rigorously.</p>\n\n<p>Really, a monad as such doesn't &ldquo;contain&rdquo; anything. It's <a href=\"https://stackoverflow.com/questions/3261729/monad-in-non-programming-terms\">not actually a spacesuit or burrito</a>, you know...</p>\n\n<p>In the case of <code>Writer</code>, you can say clearly that this is a <em>type</em> whose values contain both log-snippets and computation-results. The latter is what you might interpret as the &ldquo;content&rdquo; of the monad, and is what you can retrieve with <code>a &lt;-</code>. But in general, there needn't be any such content at all.</p>\n\n<p>In fact, to stay with your <code>Maybe</code> example:</p>\n\n<pre><code>do a &lt;- Just 3\n   Nothing\n   b &lt;- Just 5\n   return (a * b)\n</code></pre>\n\n<p>In this case, the <code>Nothing</code> &ldquo;interrupts&rdquo; the computation, so the <code>Just 5</code> doesn't ever get to inject the value <code>5</code> into <code>a</code>.</p>\n\n<p>The thing to keep in mind is that, if <code>action :: M T</code> for some monad <code>M</code>, then</p>\n\n<pre><code>do\n   ...\n   a &lt;- action\n</code></pre>\n\n<p>can give <code>a</code> a value of type <code>T</code>. (In your example, <code>M</code> is <code>Writer [String]</code> and <code>T</code> is <code>Int</code>, so <code>a</code> can only have type <code>Int</code>.)</p>\n\n<p>Whether that actually happens, how often, where the values come from and <em>what it means</em> depends on the particular monad. Still, the <a href=\"https://wiki.haskell.org/Monad_laws\" rel=\"nofollow noreferrer\">monad laws</a> can tell you a lot about the whole computation will behave. But while learning about monads, it's probably best to forget about all this, simply look at many different examples and dabble with monads yourself, at some point you'll get an intuition for them. <a href=\"https://byorgey.wordpress.com/2009/01/12/abstraction-intuition-and-the-monad-tutorial-fallacy/\" rel=\"nofollow noreferrer\">Don't try too hard to &ldquo;understand&rdquo; monads through analogies</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 3, "last_activity_date": 1448319214, "last_edit_date": 1448319214, "creation_date": 1448318639, "answer_id": 33882188, "question_id": 33881822, "link": "https://stackoverflow.com/questions/33881822/understanding-example-on-writer-monad/33882188#33882188", "title": "Understanding example on Writer Monad", "body": "<blockquote>\n  <p>In this case it makes sense to me, since <code>a</code> and <code>b</code> receive the content inside <code>Just</code>. But with the initial example, <code>a</code> and <code>b</code> only receive part of the value.</p>\n</blockquote>\n\n<p>There is nothing really wrong with this description, but we can also look at this situation in another way. In...</p>\n\n<pre><code>  a &lt;- Just 3\n</code></pre>\n\n<p>... we might also say that <code>a</code> receives only part of <code>Just 3</code> -- the <code>Just</code> wrapper does not make it. From that point of view, what happens with...</p>\n\n<pre><code>  a &lt;- writer (3, [\"Got number: \" ++ show 3])\n</code></pre>\n\n<p>... is quite similar: <code>a</code> only receives the <code>3</code> value. The <code>[String]</code> annotations, so to say, stay in the background, getting <code>mappend</code>ed into each other by the monadic binds, much like <code>(&gt;&gt;=)</code> combines <code>Maybe</code>s so that <code>Just</code> with <code>Just</code> gives <code>Just</code> and <code>Nothing</code> with anything gives <code>Nothing</code>.  </p>\n"}, {"comments": [{"owner": {"reputation": 421, "user_id": 1758759, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/5e7df1d51660a7dd65bb2e7f46eca915?s=128&d=identicon&r=PG", "display_name": "dim_voly", "link": "https://stackoverflow.com/users/1758759/dim-voly"}, "edited": false, "score": 1, "creation_date": 1546587022, "post_id": 33882477, "comment_id": 94904857, "body": "In case it helps anyone, I added the definition for execWriter too: <code>execWriter :: Writer w a -&gt; w execWriter m = snd (runWriter m)</code>"}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 5, "last_activity_date": 1448320009, "creation_date": 1448320009, "answer_id": 33882477, "question_id": 33881822, "link": "https://stackoverflow.com/questions/33881822/understanding-example-on-writer-monad/33882477#33882477", "title": "Understanding example on Writer Monad", "body": "<blockquote>\n  <p>It is easy to see that a = 3 and b = 5, since both of them are being multiplied on the return function.  What I don't understand is why those values are 3 and 5. Shouldn't a and b be the values that contain inside the Writer Monad? In this case tuples?</p>\n</blockquote>\n\n<p>No.  I think the simplest way to answer this is to just implement the <code>Writer</code> type and study its <code>Monad</code> class instance:</p>\n\n<pre><code>newtype Writer w a = Writer { runWriter :: (a, w) }\n\ninstance Functor (Writer w) where\n  fmap f (Writer (a, w)) = Writer (f a, w)\n\ninstance Monoid w =&gt; Applicative (Writer w) where\n  pure a = Writer (a, mempty)\n  Writer (f, w) &lt;*&gt; Writer (a, w') = Writer (f a, w &lt;&gt; w')\n\ninstance Monoid w =&gt; Monad (Writer w) where\n  return = pure\n  Writer (a, w) &gt;&gt;= f = let (b, w') = runWriter (f a)\n                        in Writer (b, w &lt;&gt; w')\n\ntell :: w -&gt; Writer w ()\ntell w = Writer ((), w)\n</code></pre>\n\n<p>As you can see in the instance method for <code>&gt;&gt;=</code>, the function <code>f</code> is applied to the <code>a</code> value, not the whole tuple.  The syntax <code>a &lt;- logNumber 3</code> is desugared using <code>&gt;&gt;=</code>, so the value that's bound to <code>a</code> will be the first element of the tuple that <code>Writer</code> wraps around.</p>\n"}], "owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1047, "favorite_count": 1, "accepted_answer_id": 33882477, "answer_count": 3, "score": 3, "last_activity_date": 1448320009, "creation_date": 1448317254, "question_id": 33881822, "link": "https://stackoverflow.com/questions/33881822/understanding-example-on-writer-monad", "title": "Understanding example on Writer Monad", "body": "<p>I am learning about the Writer Monad on the book Learn You A Haskell.</p>\n\n<p>this is the piece of code:</p>\n\n<pre><code>import Control.Monad.Writer\n\nlogNumber :: Int -&gt; Writer [String] Int\nlogNumber num = writer (num, [\"Got number: \" ++ show num])\n\nmultWithLog :: Writer [String] Int\nmultWithLog = do\n  a &lt;- logNumber 3\n  b &lt;- logNumber 5\n  return (a * b)\n</code></pre>\n\n<p>When running <code>multWithLog</code>, this is the result:</p>\n\n<pre><code>*Main&gt; runWriter multWithLog\n(15,[\"Got number: 3\",\"Got number: 5\"])\n</code></pre>\n\n<p>On this lines:</p>\n\n<pre><code>a &lt;- logNumber 3\nb &lt;- logNumber 5\n</code></pre>\n\n<p>It is easy to see that <code>a = 3</code> and <code>b = 5</code>, since both of them are being multiplied on the <code>return</code> function.</p>\n\n<p>What I don't understand is why those values are <code>3</code> and <code>5</code>. Shouldn't <code>a</code> and <code>b</code> be the values that contain inside the <code>Writer</code> Monad? In this case tuples?</p>\n\n<p>For example, with this was with the <code>Maybe</code> Monad, <code>a</code> and <code>b</code>would be <code>3</code> and <code>5</code>:</p>\n\n<pre><code>do\n  a &lt;- Just 3\n  b &lt;- Just 5\n  return (a * b)\n</code></pre>\n\n<p>In this case it makes sense to me, since <code>a</code> and <code>b</code> receive the content inside <code>Just</code>. But with the initial example, <code>a</code> and <code>b</code> only receive part of the value.</p>\n"}, {"tags": ["parsing", "haskell", "parsec"], "answers": [{"comments": [{"owner": {"reputation": 2895, "user_id": 1385269, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a7d953ada68569a034a0a4e7030bc4a2?s=128&d=identicon&r=PG", "display_name": "Ryan Kennedy", "link": "https://stackoverflow.com/users/1385269/ryan-kennedy"}, "edited": false, "score": 0, "creation_date": 1448336384, "post_id": 33882203, "comment_id": 55534202, "body": "I came to the same realization; the same can be achieved by using <code>sepEndBy</code> instead of <code>sepBy</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1448319096, "last_edit_date": 1448319096, "creation_date": 1448318730, "answer_id": 33882203, "question_id": 33881260, "link": "https://stackoverflow.com/questions/33881260/parsec-parsing-a-list-of-lists-both-with-the-same-delimiter/33882203#33882203", "title": "Parsec: Parsing a list of lists, both with the same delimiter", "body": "<p>Try consuming the spaces after each non-space token. E.g.</p>\n\n<pre><code>commands = many (command &lt;* spaces)\n\ncommand = do\n  l &lt;- letter\n  spaces\n  ns &lt;- many (number &lt;* spaces)\n  return (l, ns)\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>command = (,) &lt;$&gt; (letter &lt;* spaces) &lt;*&gt; many (number &lt;* spaces)\n</code></pre>\n\n<p>The main idea is: after you parse something, the next character should be a non-space starting the next item to be parsed.</p>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 0, "last_activity_date": 1448324893, "creation_date": 1448324893, "answer_id": 33883372, "question_id": 33881260, "link": "https://stackoverflow.com/questions/33881260/parsec-parsing-a-list-of-lists-both-with-the-same-delimiter/33883372#33883372", "title": "Parsec: Parsing a list of lists, both with the same delimiter", "body": "<p>I would write the parser as @chi has suggested.</p>\n\n<p>The deal with <code>sepBy</code> is that if the separator is matched then <code>sepBy</code> expects to parse another item.</p>\n"}], "owner": {"reputation": 2895, "user_id": 1385269, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/a7d953ada68569a034a0a4e7030bc4a2?s=128&d=identicon&r=PG", "display_name": "Ryan Kennedy", "link": "https://stackoverflow.com/users/1385269/ryan-kennedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 33882203, "answer_count": 2, "score": 1, "last_activity_date": 1448324893, "creation_date": 1448314969, "last_edit_date": 1448315301, "question_id": 33881260, "link": "https://stackoverflow.com/questions/33881260/parsec-parsing-a-list-of-lists-both-with-the-same-delimiter", "title": "Parsec: Parsing a list of lists, both with the same delimiter", "body": "<p>Consider a simple language that's a list of space-delimited commands. Each command takes a single letter as the command name, and a series of space-delimited numbers as its arguments; e.g. <code>a 1 2 3 b 4 5 6 d 7 e f</code> would represent the following commands:</p>\n\n<ul>\n<li><strong>a</strong> 1 2 3</li>\n<li><strong>b</strong> 4 5 6</li>\n<li><strong>d</strong> 7</li>\n<li><strong>e</strong></li>\n<li><strong>f</strong></li>\n</ul>\n\n<p>The problem is that it keeps grabbing items through <code>sepBy</code>, and reaches for another number but fails when it gets to \"b\".</p>\n\n<p>However, this yields the following error when passed through the code below:</p>\n\n<pre><code>Left \"error\" (line 1, column 5):\nunexpected \"b\"\nexpecting space\n</code></pre>\n\n<p>I realize now that this is likely coming from an error in the way I'm looking at the problem, and would appreciate someone pointing out how to parse something like this.</p>\n\n<hr>\n\n<pre><code>module Main where\n\nimport Control.Applicative hiding (many, optional, (&lt;|&gt;))\nimport Text.ParserCombinators.Parsec\nimport Numeric (readSigned, readFloat)\n\ncommands = command `sepBy` spaces\n\ncommand = do\n  l &lt;- letter\n  ns &lt;- number `sepBy` spaces\n  return (l, ns)\n\nmain :: IO ()\nmain = print $ show $ parse commands \"error\" \"a 1 2 3 b 4 5 6 d 7 e f\"\n\nnumber :: CharParser () Double\nnumber = do s &lt;- getInput\n            case readSigned readFloat s of\n              [(n, s')] -&gt; n &lt;$ setInput s'\n              _         -&gt; empty\n</code></pre>\n"}, {"tags": ["haskell", "polymorphism", "typeclass", "compiler-directives", "system-f"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 6, "creation_date": 1448307919, "post_id": 33879297, "comment_id": 55522698, "body": "GHC means what it says. Polymorphic types are simply not allowed in instance heads. If you define <code>Tree</code> as a newtype then you can create instances for it."}, {"owner": {"reputation": 1929, "user_id": 5181199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204393995596520/picture?type=large", "display_name": "Oly", "link": "https://stackoverflow.com/users/5181199/oly"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1448308194, "post_id": 33879297, "comment_id": 55522898, "body": "Perhaps I should add, I&#39;m interested also, if that&#39;s the case, in why that needs to be or was chosen to be the way the language works."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1448310496, "post_id": 33879297, "comment_id": 55524304, "body": "The implicit instantiation of polytypes and type inference makes such instances cumbersome. E.g. assume <code>class C a where foo::a -&gt; Int</code> -- does <code>foo id</code> call <code>instance C (Int -&gt; Int)</code> or <code>instance C (forall a. a-&gt;a)</code> ? If we had explicit type arguments as in System F, it would be the second one. With implicit type args, it&#39;s much less clear. Now, assume that we have a complex expression instead of <code>id</code>: it starts becoming too complex. The current mechanism is driven by type constructors, and <code>forall</code> can not be regarded as a tycon since it gets instantiated implicitly."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1448310621, "post_id": 33879297, "comment_id": 55524395, "body": "As an alternative approach, check out Agda&#39;s <a href=\"http://wiki.portal.chalmers.se/agda/pmwiki.php?n=ReferenceManual.InstanceArguments\" rel=\"nofollow noreferrer\">implicit instance arguments</a>."}], "answers": [{"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 3, "last_activity_date": 1448310880, "creation_date": 1448310880, "answer_id": 33880184, "question_id": 33879297, "link": "https://stackoverflow.com/questions/33879297/illegal-polymorphic-or-qualified-type-in-instance-declaration-system-f-style/33880184#33880184", "title": "&quot;Illegal polymorphic or qualified type&quot; in instance declaration (System-F style trees)", "body": "<p>First, there's a trick which allows you to write some instances for universally quantified types: we remove the <code>forall</code>-s from the instance head, and introduce type equality constraints to whatever types we want to instantiate the variables. In our case:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, FlexibleInstances, TypeFamilies #-}\n\ninstance (a ~ String, Show t) =&gt; Show (a -&gt; (t -&gt; a) -&gt; (a -&gt; a -&gt; a) -&gt; a) where\n  show t = t \"nil\" show (\\l r -&gt; \"(\" ++ l ++ \", \" ++ r ++ \")\")\n\n-- show (fork empty (fork (leaf ()) empty)) == \"(nil, ((), nil))\"\n</code></pre>\n\n<p>This works because the instance head implicitly quantifies the variable for us. Of course, if we want to instantiate a polymorphic type to several different types then this trick might not be applicable. </p>\n\n<p>On another note, if  GHC allowed polymorphic types in instances, that wouldn't be useful, because GHC doesn't support impredicative instantiation (and the <code>ImpredicativeTypes</code> pragma doesn't actually work). For example, <code>Show (forall a. t)</code> doesn't imply <code>Show [forall a. t]</code>, because <code>[forall a. t]</code> isn't valid to begin with. Also, class constraints are kinded in the same system as regular type constructors (except that they return in kind <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/constraint-kind.html\" rel=\"nofollow\"><code>Constraint</code></a>), so <code>Show (forall a. t)</code> is similarly invalid without impredicative instantiation. </p>\n"}], "owner": {"reputation": 1929, "user_id": 5181199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204393995596520/picture?type=large", "display_name": "Oly", "link": "https://stackoverflow.com/users/5181199/oly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1448310880, "creation_date": 1448307740, "question_id": 33879297, "link": "https://stackoverflow.com/questions/33879297/illegal-polymorphic-or-qualified-type-in-instance-declaration-system-f-style", "title": "&quot;Illegal polymorphic or qualified type&quot; in instance declaration (System-F style trees)", "body": "<p>I'm experimenting with implementing System-F-style data structures in Haskell.</p>\n\n<p>I'll use <code>A &lt;B&gt;</code> to mean application of a term <code>A</code> to a type <code>B</code> just to make it unambiguous (also using capitals for types).</p>\n\n<p>Let's say <code>Tree &lt;T&gt;</code> is the type of binary trees with values of type <code>T</code>. We want to find a type that can act as <code>Tree &lt;T&gt;</code>. There are three constructors:</p>\n\n<pre><code>EmptyTree &lt;T&gt; : (Tree &lt;T&gt;)\nLeaf &lt;T&gt; : T \u2192 (Tree &lt;T&gt;)\nBranch &lt;T&gt; : (Tree &lt;T&gt;) \u2192 (Tree &lt;T&gt;) \u2192 (Tree &lt;T&gt;)\n</code></pre>\n\n<p>So, by some cleverness due, I think, to Girard, we can use the following</p>\n\n<pre><code>Tree T = \u2200 A. A \u2192 (T \u2192 A) \u2192 (A \u2192 A \u2192 A) \u2192 A\n</code></pre>\n\n<p>from which</p>\n\n<pre><code>Empty &lt;T&gt;\n        = \u039bA.\u03bba:A.\u03bbf:(T \u2192 A).\u03bbg:(A \u2192 A \u2192 A).\n            a\n\nLeaf &lt;T&gt; (x:T)\n        = \u039bA.\u03bba:A.\u03bbf:(T \u2192 A).\u03bbg:(A \u2192 A \u2192 A).\n            f x\n\nBranch &lt;T&gt; (t1:Tree &lt;T&gt;) (t2:Tree &lt;T&gt;)\n        = \u039bA.\u03bba:A.\u03bbf:(T \u2192 A).\u03bbg:(A \u2192 A \u2192 A).\n            g (t1 &lt;A&gt; a f g) (t2 &lt;A&gt; a f g)\n</code></pre>\n\n<p>I've found out about the directives needed for these things in Haskell, and I don't think I'm missing any. So in Haskell:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\ntype T t = forall a.a -&gt; (t -&gt; a) -&gt; (a -&gt; a -&gt; a) -&gt; a\n\nempty :: T t\nempty = \\a _ _ -&gt; a\nleaf :: t -&gt; T t\nleaf x = \\_ f _ -&gt; f x\nfork :: T t -&gt; T t -&gt; T t\nfork t1 t2 = \\a f g -&gt; g (t1 a f g) (t2 a f g)\n</code></pre>\n\n<p>So far, all of this compiles and seems to work. The issue arises when I try to make an instance for <code>Show</code> for my <code>T t</code> type. I've added more directives:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, TypeSynonymInstances, FlexibleInstances #-}\n</code></pre>\n\n<p>and a function for printing the tree</p>\n\n<pre><code>displayTree :: Show t =&gt; T t -&gt; String\ndisplayTree t = t displayEmpty show displayFork\n</code></pre>\n\n<p>with appropriate helpers <code>displayEmpty :: String</code> and <code>displayFork :: String -&gt; String -&gt; String</code>. This also compiles and works (up to prettiness). Now if I try to instantiate <code>T t</code> as an instance of <code>Show</code></p>\n\n<pre><code>instance Show t =&gt; Show (T t) where\n    show = displayTree\n</code></pre>\n\n<p>I get the following error when trying to compile:</p>\n\n<pre><code>    Illegal polymorphic or qualified type: T t\n    In the instance declaration for 'Show (T t)'\n</code></pre>\n\n<p>I (think I) understand the need for <code>TypeSynonymInstances</code> and <code>FlexibleInstances</code> and the pragmatic reasons for their existence, but I don't understand why my type <code>T t</code> <em>still</em> can't be declared an instance of <code>Show</code>. Is there a way to do this, and what property of <code>T t</code> means that this is currently problematic in my code?</p>\n"}, {"tags": ["haskell", "applicative", "monoids"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1448311920, "last_edit_date": 1592644375, "creation_date": 1448303436, "answer_id": 33878055, "question_id": 33877487, "link": "https://stackoverflow.com/questions/33877487/applicative-implementation-of-const-monoid/33878055#33878055", "title": "Applicative implementation of Const Monoid", "body": "<blockquote>\n<p>After changing the names to the current situation:</p>\n<pre><code>(&lt;*&gt;) :: c (m -&gt; b) -&gt; c m -&gt; c b\n</code></pre>\n<p>=&gt; <code>f :: m -&gt; *</code>.</p>\n</blockquote>\n<p>Not quite. After changing the names to the current situation:</p>\n<pre><code>(&lt;*&gt;) :: Const m (a -&gt; b) -&gt; Const m a -&gt; Const m b\n</code></pre>\n<p>Since a value of type <code>Const x y</code> is the constructor <code>Const</code> applied to a value of type <code>x</code>, this means <code>f :: m</code> (and <code>v :: m</code>), and we know <code>Monoid m</code> from the instance context.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 6, "last_activity_date": 1448303595, "creation_date": 1448303595, "answer_id": 33878090, "question_id": 33877487, "link": "https://stackoverflow.com/questions/33877487/applicative-implementation-of-const-monoid/33878090#33878090", "title": "Applicative implementation of Const Monoid", "body": "<pre><code>(&lt;*&gt;) :: f         (a-&gt;b) -&gt; f         a -&gt; f         b\n      \u2261  (Const m) (a-&gt;b) -&gt; (Const m) a -&gt; (Const m) b\n      \u2261  Const m (a-&gt;b) -&gt; Const m a -&gt; Const m b\n      \u2245        m        -&gt;       m   -&gt;       m\n</code></pre>\n\n<p>which is the signature of <code>&lt;&gt;</code> (aka <code>mappend</code>).</p>\n"}], "owner": {"reputation": 2204, "user_id": 112298, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/515a5692f7efeba0c7ef6906d67352be?s=128&d=identicon&r=PG", "display_name": "libeako", "link": "https://stackoverflow.com/users/112298/libeako"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 1, "accepted_answer_id": 33878055, "answer_count": 2, "score": 4, "last_activity_date": 1448311920, "creation_date": 1448301494, "question_id": 33877487, "link": "https://stackoverflow.com/questions/33877487/applicative-implementation-of-const-monoid", "title": "Applicative implementation of Const Monoid", "body": "<pre><code>instance Monoid m =&gt; Applicative (Const m) where\n    pure _ = Const mempty\n    Const f &lt;*&gt; Const v = Const (f `mappend` v)\n</code></pre>\n\n<p><strong>I do not understand how can the definition of <code>&lt;*&gt;</code> type-check.</strong></p>\n\n<p>On the left side <code>f</code> is constrained by the signature of <code>&lt;*&gt;</code> as in the definition of Applicative </p>\n\n<pre><code>class Functor f =&gt; Applicative f where\n    pure :: a -&gt; f a\n    (&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>After changing the names to the current situation:</p>\n\n<pre><code>    (&lt;*&gt;) :: c (m -&gt; b) -&gt; c m -&gt; c b\n</code></pre>\n\n<p>=> <code>f :: m -&gt; *</code>.</p>\n\n<p>On the left side <code>f</code> is the [first] parameter of <code>mappend</code>.</p>\n\n<p>From the definition of Monoid</p>\n\n<pre><code>class Monoid a where\n        mempty  :: a\n        -- ^ Identity of 'mappend'\n        mappend :: a -&gt; a -&gt; a\n</code></pre>\n\n<p>After changing the names to the current situation:</p>\n\n<pre><code>        mappend :: m -&gt; m -&gt; m\n</code></pre>\n\n<p>=> <code>f :: m</code>.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "edited": false, "score": 0, "creation_date": 1448304784, "post_id": 33875449, "comment_id": 55520809, "body": "oh, ok. So if I lower the stackage resolver it should work?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "edited": false, "score": 0, "creation_date": 1448317453, "post_id": 33875449, "comment_id": 55528177, "body": "Not necessarily. Even 2.x resolvers use cairo &gt;= 0.13. Ideally the maintainers would add helm to stackage so they can be notified when they need to adjust the dependency bounds."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1448294842, "creation_date": 1448294842, "answer_id": 33875449, "question_id": 33874604, "link": "https://stackoverflow.com/questions/33874604/failure-installing-dependencies-when-installing-helm-with-stack/33875449#33875449", "title": "&quot;Failure installing dependencies&quot; when installing Helm with Stack", "body": "<p>What it's saying is that the stackage resolver you are trying to use (lts-3.12) is incompatible with helm-0.7.1.</p>\n\n<p>For instance, helm-0.7.1 requires a cairo version between 0.12 and 0.13, but the version of cairo supported in lts-3.12 is 0.13.1. Similarly for the other constraints.</p>\n\n<p>It is possible that the helm might actually work with a later version of cairo. To test that, download the helm source, modify the dependency in its cabal file and include it in your stack project as a local package.</p>\n\n<p>Another suggestion is to see if it builds in a cabal sandbox.</p>\n"}], "owner": {"reputation": 1171, "user_id": 3758543, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a4a349f90341d8d2b1045f6cf8cc54b3?s=128&d=identicon&r=PG&f=1", "display_name": "lhahn", "link": "https://stackoverflow.com/users/3758543/lhahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448294842, "creation_date": 1448292246, "question_id": 33874604, "link": "https://stackoverflow.com/questions/33874604/failure-installing-dependencies-when-installing-helm-with-stack", "title": "&quot;Failure installing dependencies&quot; when installing Helm with Stack", "body": "<p>I am currently trying to install <a href=\"http://helm-engine.org/\" rel=\"nofollow\">helm</a> with <a href=\"https://github.com/commercialhaskell/stack\" rel=\"nofollow\">stack</a>. I created a simple project with </p>\n\n<pre><code>stack new sandbox\n</code></pre>\n\n<p>and added helm as a dependency on <code>sandbox.cabal</code>:</p>\n\n<pre><code>library\n  hs-source-dirs:      src\n  exposed-modules:     Lib\n  build-depends:       base &gt;= 4.7 &amp;&amp; &lt; 5\n                     , helm\n  default-language:    Haskell2010\n</code></pre>\n\n<p>After that I run the usual <code>stack build</code> and get the error, indicating that I have to add <code>helm-0.7.1</code> on my <code>stack.yaml</code> file. I do that and also insert <code>elerea-2.8.0</code>, since it was also a requirement.\nThis is my <code>stack.yaml</code>:</p>\n\n<pre><code># Specifies the GHC version and set of packages available (e.g., lts-3.5, nightly-2015-09-21, ghc-7.10.2)\nresolver: lts-3.12\n\n# Local packages, usually specified by relative directory name\npackages:\n- '.'\n\n# Packages to be pulled from upstream that are not in the resolver (e.g., acme-missiles-0.3)\nextra-deps:\n- helm-0.7.1\n- elerea-2.8.0\n\n# Override default flag values for local packages and extra-deps\nflags: {}\n\n# Extra package databases containing global packages\nextra-package-dbs: []\n\n# Control whether we use the GHC we find on the path\n# system-ghc: true\n\n# Require a specific version of stack, using version ranges\n# require-stack-version: -any # Default\n# require-stack-version: &gt;= 0.1.4.0\n\n# Override the architecture used by stack, especially useful on Windows\n# arch: i386\n# arch: x86_64\n\n# Extra directories used by stack for building\n# extra-include-dirs: [/path/to/dir]\n# extra-lib-dirs: [/path/to/dir]\n</code></pre>\n\n<p>Running <code>stack build</code> again gives me this error.</p>\n\n<pre><code>While constructing the BuildPlan the following exceptions were encountered:\n\n--  Failure when adding dependencies:    \n      helm: needed (-any), couldn't resolve its dependencies\n    needed for package: sandbox-0.1.0.0\n\n--  Failure when adding dependencies:    \n      cairo: needed (&gt;0.12 &amp;&amp; &lt;0.13), 0.13.1.0 found (latest version available)\n      mtl: needed (&gt;=2.1 &amp;&amp; &lt;2.2), 2.2.1 found (latest version available)\n      pango: needed (&gt;0.12 &amp;&amp; &lt;0.13), 0.13.1.0 found (latest version available)\n      sdl2: needed (&gt;=1.1 &amp;&amp; &lt;1.3), 1.3.1 found (latest is 2.1.0)\n      time: needed (&gt;=1.4 &amp;&amp; &lt;1.5), 1.5.0.1 found (latest version available)\n    needed for package: helm-0.7.1\n</code></pre>\n\n<p>What does this error mean? From what I understand it is not finding the correct version.</p>\n"}, {"tags": ["macos", "sockets", "haskell", "tcp"], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1448307945, "post_id": 33874996, "comment_id": 55522719, "body": "I would bet that if you run wireshark you&#39;d see the proper DNS request for localhost does not resolve - what does <code>ping localhost</code> say?  What do those packets look like?  Perhaps &#39;localhost&#39; is resolving to an IPv6 address and you have v6 issues?"}], "tags": [], "owner": {"reputation": 20193, "user_id": 1779113, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbd338a5ff4a8feb86507a4dacddc05b?s=128&d=identicon&r=PG", "display_name": "nburk", "link": "https://stackoverflow.com/users/1779113/nburk"}, "is_accepted": true, "score": 5, "last_activity_date": 1448293478, "creation_date": 1448293478, "answer_id": 33874996, "question_id": 33874370, "link": "https://stackoverflow.com/questions/33874370/exception-connect-does-not-exist-connection-refused-when-trying-to-connect-t/33874996#33874996", "title": "Exception: connect: does not exist (Connection refused) when trying to connect to TCP socket in Haskell", "body": "<p>Okay, the problem can be solved by connecting to <code>127.0.0.1</code> instead of <code>localhost</code>. Apparently some bindings were changed when my system broke down and got reinstalled, so <code>ghc</code> doesn't know how to resolve <code>localhost</code> (or something like that....)</p>\n"}], "owner": {"reputation": 20193, "user_id": 1779113, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/fbd338a5ff4a8feb86507a4dacddc05b?s=128&d=identicon&r=PG", "display_name": "nburk", "link": "https://stackoverflow.com/users/1779113/nburk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1868, "favorite_count": 0, "accepted_answer_id": 33874996, "answer_count": 1, "score": 5, "last_activity_date": 1448293478, "creation_date": 1448291537, "last_edit_date": 1448292259, "question_id": 33874370, "link": "https://stackoverflow.com/questions/33874370/exception-connect-does-not-exist-connection-refused-when-trying-to-connect-t", "title": "Exception: connect: does not exist (Connection refused) when trying to connect to TCP socket in Haskell", "body": "<h3>Context</h3>\n\n<p>I was following the <a href=\"http://book.realworldhaskell.org/read/sockets-and-syslog.html\" rel=\"noreferrer\">tutorial on writing a TCP server last week in Real World Haskell</a>. Everything went well and I had the final version of it working and was able to send messages between the TCP client and server.</p>\n\n<p>Then, I wanted to write my own TCP server for a small TicTacToe game that I coded. I started out writing the server and client and played around with it a bit, it worked so far that the server was able to accept connections, but there was no real interaction yet.</p>\n\n<p>Now it gets a bit awkward, because after I turned my Mac off and tried to reboot it again, it wouldn't boot any more. I fiddled around all Friday to do a backup from Single User Mode and reinstalled Mac OS. After a successful reinstallation, all my data was still there, so I didn't need the backup after all. </p>\n\n<p>Anyway, today I am turning back to my TicTacToe-server but it doesn't work any more. Or, at least the client can't connect to it any more. </p>\n\n<h3>TL;DR</h3>\n\n<p>I wrote a TCP server for a TicTacToe game inspired by the <a href=\"http://book.realworldhaskell.org/read/sockets-and-syslog.html\" rel=\"noreferrer\">tutorial in Real World Haskell</a> but am getting a <code>*** Exception: connect: does not exist (Connection refused)</code> error when trying to connect to the server. The same happens with the vanilla code from the mentioned tutorial. </p>\n\n<p>Note that I can still connect to the servers using <code>telnet</code>. I'm pretty sure the issue isn't with the code but rather on system level as the same code was working before I had the trouble with my machine (see above) and I am still using the identical code from the tutorial in RWH.   </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1448291116, "post_id": 33869961, "comment_id": 55511864, "body": "Unrelated: this kind of &quot;guard-based&quot; anti-pattern seems to be quite popular lately on SO. Someone should write a &quot;guards considered harmful&quot; paper ..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1448292980, "post_id": 33869961, "comment_id": 55513159, "body": "This doesn&#39;t address your question at all, but I can&#39;t help but suggest it: you may like <code>concatMap (take 1)</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1448304490, "post_id": 33869961, "comment_id": 55520656, "body": "I can&#39;t help mentioning that when you&#39;re tempted to use <code>length</code> on a list, you&#39;re usually making a mistake."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1448306021, "post_id": 33869961, "comment_id": 55521530, "body": "@chi, they&#39;re a lot better than nested <code>if&#47;then&#47;else</code>, but obviously not as good as pattern matching or eliminators when those will do."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1448306517, "post_id": 33869961, "comment_id": 55521840, "body": "@dfeuer I agree. I fear that many beginners still &quot;think&quot; in other languages, where testing whether a list is empty is done with an <code>if</code>, and translate that to guards. This neglects better alternatives for elimination, and leads to an error-prone and arguably unsafe constructor-test&amp;partial-projection pattern, and to &quot;boolean blindness&quot;. Worse, judging from the SO questions, the guard-based code is often wrong (!)"}], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 5449377, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5c1b0852a7e9e7a953ae50583dcd09e1?s=128&d=identicon&r=PG&f=1", "display_name": "Neo Streets", "link": "https://stackoverflow.com/users/5449377/neo-streets"}, "edited": false, "score": 0, "creation_date": 1448278665, "post_id": 33870095, "comment_id": 55503456, "body": "In the program it can&#39;t get &#39; [] &#39; it will onlny have [[],[],[],[]]. But I have tried what you suggested and it still gives the error"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1448279100, "post_id": 33870095, "comment_id": 55503712, "body": "&quot;In the program it can&#39;t get &#39; [] &#39; it will onlny have [[],[],[],[]].&quot; You might know that, but GHC doesn&#39;t, so it warns you about the non-exhaustive pattern."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 4, "last_activity_date": 1448278480, "creation_date": 1448278480, "answer_id": 33870095, "question_id": 33869961, "link": "https://stackoverflow.com/questions/33869961/haskell-non-exhaustive-pattern-in-function/33870095#33870095", "title": "Haskell: Non-exhaustive pattern in function", "body": "<p><code>makeL (h:t) l</code> exclusively matches the case where the list of lists have a head and tail, but it doesn't match the empty list (which doesn't have a head).</p>\n\n<p>As a bare minimum, you'll need to add a case that deals with the empty list:</p>\n\n<pre><code>makeL [] l = -- implementation goes here\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 0, "last_activity_date": 1448278686, "creation_date": 1448278686, "answer_id": 33870151, "question_id": 33869961, "link": "https://stackoverflow.com/questions/33869961/haskell-non-exhaustive-pattern-in-function/33870151#33870151", "title": "Haskell: Non-exhaustive pattern in function", "body": "<p>I think this will pattern the job, but not using wards:</p>\n\n<pre><code>makeL :: (Eq a) =&gt; [[a]]-&gt;[a] -&gt; [a]\nmakeL [] l              = l -- base case, empty list return l\nmakeL ([]:xs) l         = makeL xs l --case the list inside the list is empty, continue with the rest of the list\nmakeL ((x:xxs):xs)  l   = makeL xs l++[x] --if the list in the list have a head append to l and continue with the list\n</code></pre>\n"}], "owner": {"reputation": 505, "user_id": 5449377, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5c1b0852a7e9e7a953ae50583dcd09e1?s=128&d=identicon&r=PG&f=1", "display_name": "Neo Streets", "link": "https://stackoverflow.com/users/5449377/neo-streets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1448278686, "creation_date": 1448278049, "question_id": 33869961, "link": "https://stackoverflow.com/questions/33869961/haskell-non-exhaustive-pattern-in-function", "title": "Haskell: Non-exhaustive pattern in function", "body": "<p>So i have a function, which takes a list of lists, and takes the head of each list and adds it to another list, I have guards which I thought covered all issues but it doesn't, can anyone see why it might be giving me an exception.</p>\n\n<pre><code>makeL :: (Eq a) =&gt; [[a]]-&gt;[a] -&gt; [a]\nmakeL (h:t) l\n    | length (concat (h:t)) == 0 = l\n    | length h == 0 &amp;&amp; length t /= 0 = makeL t l\n    | length h /= 0 &amp;&amp; length t == 0 = l++[head h]\n    | otherwise = makeL t (l++[head h])\n</code></pre>\n\n<p>When I play about with it in prelude I can't replicate the error. but when I run the program if the <code>[[a]]</code> is equal to <code>[[],[],[],[],[]]</code> then it gives the error I think</p>\n"}, {"tags": ["haskell", "generics", "data-structures", "types", "abstract-syntax-tree"], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 4162959, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-e0huN4x2igA/AAAAAAAAAAI/AAAAAAAAAJU/YGUl-V6Gjy0/photo.jpg?sz=128", "display_name": "Salvador Tamarit", "link": "https://stackoverflow.com/users/4162959/salvador-tamarit"}, "edited": false, "score": 0, "creation_date": 1448280976, "post_id": 33869999, "comment_id": 55505032, "body": "Thanks @chi! I knew that the AST of the Language.C library was prepared for user annotations. Although all node types shared the same kind of annotations, it would not be a problem for me, but, as you propose, can be a good improvement. Using the provided functionality, what I would need is a way to go from the AST built by the parser (its type is <code>CTranslationUnit NodeInfo</code>) to the user-annotated AST (<code>CTranslationUnit AnnotatedNodeInfo</code>). Therefore, I will need to use a function similar to <code>annotateAST</code> in the question, but, of course,  fulfilling types constraints."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 151, "user_id": 4162959, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-e0huN4x2igA/AAAAAAAAAAI/AAAAAAAAAJU/YGUl-V6Gjy0/photo.jpg?sz=128", "display_name": "Salvador Tamarit", "link": "https://stackoverflow.com/users/4162959/salvador-tamarit"}, "edited": false, "score": 0, "creation_date": 1448281321, "post_id": 33869999, "comment_id": 55505240, "body": "@SalvadorTamarit You can use <code>fmap fromNodeInfoToAnnotatedNodeInfo</code> to perform that, albeit the new annotation in this way can not depend on anything else but the old annotation. If there&#39;s a sensible &quot;default&quot; for the new annotation, that might be enough to define your <code>fromNodeInfo...</code>. After this transformation, you can use SYB to affect the new annotations so to make them depend on the actual data. (Maybe there&#39;s a better approach, but that&#39;s all I can see)"}, {"owner": {"reputation": 151, "user_id": 4162959, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-e0huN4x2igA/AAAAAAAAAAI/AAAAAAAAAJU/YGUl-V6Gjy0/photo.jpg?sz=128", "display_name": "Salvador Tamarit", "link": "https://stackoverflow.com/users/4162959/salvador-tamarit"}, "edited": false, "score": 0, "creation_date": 1448291095, "post_id": 33869999, "comment_id": 55511852, "body": "Thank again @chi. Your proposal works. <code>fmap</code> can do a nice job here. Thanks for your help."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1448279353, "last_edit_date": 1448279353, "creation_date": 1448278169, "answer_id": 33869999, "question_id": 33869371, "link": "https://stackoverflow.com/questions/33869371/augment-a-complex-data-type-in-a-generic-way-in-haskell/33869999#33869999", "title": "Augment a complex data type in a generic way in Haskell", "body": "<p>I am not an expert of that library, but it seems to be designed so to allow user-defined decorations.</p>\n\n<p>This is because all the main data types are parametrized over <code>NodeInfo</code>, the standard annotation (only carrying location and name information). E.g. the library provides</p>\n\n<pre><code>type CTranslUnit = CTranslationUnit NodeInfo\n</code></pre>\n\n<p>which allows you to define</p>\n\n<pre><code>type MyTransUnit = CTranslationUnit MyNodeInfo\ndata MyNodeInfo = MNI NodeInfo AdditionalStuffHere\n</code></pre>\n\n<p>so to decorate the AST as you wish.</p>\n\n<p>The library provides <code>Functor</code> instances that can affect such decorations, as well as an <code>Annotated</code> typeclass to retrieve the (possibly user-defined) annotation from any AST node.</p>\n\n<p>I'd try to pursue that approach.</p>\n\n<hr>\n\n<p>The design looks nice. The only drawback I can see is that the annotation type must be the same for all kinds on nodes, which basically forces one to define it as a huge sum of all kinds of annotations one might possibly have inside. For example:</p>\n\n<pre><code>-- AST library for a simple lambda-calculus\ndata AST n\n    = Fun n String (AST n)\n    | Var n String\n    | App n (AST n) (AST n)\n\n-- user code\ndata Annotation\n    = AnnVar ... | AnnFun ... | AnnApp ...\ntype AnnotatedAST = AST Annotation\n</code></pre>\n\n<p>and we offer no static guarantees on functions being decorated with <code>AnnFun</code>, only.</p>\n\n<p>One could wish for a more advanced library design exploiting GADTs such as:</p>\n\n<pre><code>-- AST library for a simple lambda-calculus\ndata Tag = TagFun | TagVar | TagApp\ndata AST (n :: Tag -&gt; *)\n    = Fun (n 'TagFun) String (AST n)\n    | Var (n 'TagVar) String\n    | App (n 'TagApp) (AST n) (AST n)\n\n-- user code\ndata Annotation (n :: Tag) where\n   AnnFun :: String -&gt; Annotation 'TagFun\n   AnnVar :: Int    -&gt; Annotation 'TagVar\n   AnnApp :: Bool   -&gt; Annotation 'TagApp\ntype AnnotatedAST = AST Annotation\n</code></pre>\n\n<p>which guarantees a correct annotation in every node. <code>AST</code> would no longer be a <code>Functor</code>, but a <code>Functor</code>-like class could be defined, at least.</p>\n\n<p>Still -- I'd be grateful that at least the library allows some form of user-defined annotations.</p>\n"}], "owner": {"reputation": 151, "user_id": 4162959, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-e0huN4x2igA/AAAAAAAAAAI/AAAAAAAAAJU/YGUl-V6Gjy0/photo.jpg?sz=128", "display_name": "Salvador Tamarit", "link": "https://stackoverflow.com/users/4162959/salvador-tamarit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 1, "accepted_answer_id": 33869999, "answer_count": 1, "score": 4, "last_activity_date": 1448279353, "creation_date": 1448276313, "question_id": 33869371, "link": "https://stackoverflow.com/questions/33869371/augment-a-complex-data-type-in-a-generic-way-in-haskell", "title": "Augment a complex data type in a generic way in Haskell", "body": "<p>I have been using the abstract syntax tree (AST) of <a href=\"https://hackage.haskell.org/package/language-c-0.4.7\" rel=\"nofollow\">Language.C library</a> to modify C programs using generic transformations of <a href=\"https://hackage.haskell.org/package/syb\" rel=\"nofollow\">SYB library</a>. This AST has different kind of nodes (data types), each one representing a C construction, i.e. expressions, statements, definitions, etc. I need now to augment somehow the information that statements carry, i.e. annotate them. I have supposed (maybe I'm wrong) that I cannot modify or redefine the original data type, so I would like to have something like this:</p>\n\n<pre><code>annotateAST anns =\n   everywhere (mkT (annotateAST_ anns))\n\nannotateAST_ astnode anns \n  | isStmt astnode = AnnStmt astnode (getAnn astnode anns)\n  | otherwise = astnode\n</code></pre>\n\n<p>In this way I would have a new ast with annotated statements instead of the original one. Of course, GHC is going to complain because <code>everywhere</code>should return the same type that it gets, and this is not what it is happening here. </p>\n\n<p>Concluding, I need to generically annotate an AST without modifying the original data types, and in a way that it is easy to return to the original data structure. \nI have been thinking in different solutions for this problem, but not convinced of any of them, so I decided to share it here.</p>\n\n<p>P.S. I was told that SYB library is not very efficient. Taking into account that the AST of Language.C only derives Data, do I have a more efficient alternative to do generic traversal and modification of the AST?</p>\n"}, {"tags": ["haskell", "cabal", "cabal-install"], "answers": [{"tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": true, "score": 1, "last_activity_date": 1448269955, "creation_date": 1448269955, "answer_id": 33867245, "question_id": 33866674, "link": "https://stackoverflow.com/questions/33866674/cabal-install-haskellformaths-fails/33867245#33867245", "title": "Cabal install HaskellForMaths fails", "body": "<p>The problem seems to be that you're trying to build HaskellForMaths with a version of the base package that does not export <code>*&gt;</code> and <code>&lt;*</code>, these were probably added in base version 4.8.0.0 which shipped with GHC 7.10.1.</p>\n\n<p>I would suggest that you upgrade to the latest GHC (7.10.2).</p>\n"}], "owner": {"reputation": 23, "user_id": 2990852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a7e614f0bd77804c746fd90986b3c07a?s=128&d=identicon&r=PG&f=1", "display_name": "AlexZ", "link": "https://stackoverflow.com/users/2990852/alexz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 33867245, "answer_count": 1, "score": 0, "last_activity_date": 1448269955, "creation_date": 1448268052, "question_id": 33866674, "link": "https://stackoverflow.com/questions/33866674/cabal-install-haskellformaths-fails", "title": "Cabal install HaskellForMaths fails", "body": "<p>I'm trying to install Quipper using this <a href=\"http://www.mathstat.dal.ca/~selinger/quipper/README\" rel=\"nofollow\">readme</a>. Cabal-install fails on installing Lattices:</p>\n\n<pre><code>Resolving dependencies...\nConfiguring HaskellForMaths-0.4.8...\nBuilding HaskellForMaths-0.4.8...\nPreprocessing library HaskellForMaths-0.4.8...\n[ 1 of 58] Compiling Math.QuantumAlgebra.TensorCategory ( Math/QuantumAlgebra/TensorCategory.hs, dist/build/Math/QuantumAlgebra/TensorCategory.o )\n[ 2 of 58] Compiling Math.NumberTheory.Prime ( Math/NumberTheory/Prime.hs, dist/build/Math/NumberTheory/Prime.o )\n[ 3 of 58] Compiling Math.Algebras.VectorSpace ( Math/Algebras/VectorSpace.hs, dist/build/Math/Algebras/VectorSpace.o )\n\nMath/Algebras/VectorSpace.hs:9:26:\n    Module `Prelude' does not export `(&lt;*)'\n\nMath/Algebras/VectorSpace.hs:9:32:\n    Module `Prelude' does not export `(*&gt;)'\ncabal: Error: some packages failed to install:\nHaskellForMaths-0.4.8 failed during the building phase. The exception was:\nExitFailure 1\nLattices-0.0.2 depends on HaskellForMaths-0.4.8 which failed to install.\n</code></pre>\n\n<p>I tried to install HaskellForMaths, but it fails with same error.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1448275454, "post_id": 33865479, "comment_id": 55501528, "body": "To expand a little: as in some other languages, output is buffered, and is not really sent to the OS until a newline, or an explicit flush operation happens. (It is sad though, that <code>runhaskell</code> and compiling the code use different buffering -- they should be more consistent IMHO)"}, {"owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1448414399, "post_id": 33865479, "comment_id": 55576498, "body": "@chi Is there are reason that <code>runhaskell</code> and <code>ghc</code> use different buffering modes, or is it just an unintentional inconsistency?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "edited": false, "score": 0, "creation_date": 1448460695, "post_id": 33865479, "comment_id": 55598399, "body": "@Kwarrtz I can&#39;t think of any reason."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 7, "last_activity_date": 1448262838, "creation_date": 1448262838, "answer_id": 33865479, "question_id": 33865433, "link": "https://stackoverflow.com/questions/33865433/weird-buffering-with-prompt-in-haskell/33865479#33865479", "title": "Weird buffering with prompt in haskell", "body": "<p>Buffering.</p>\n\n<pre><code>hSetBuffering stdout NoBuffering\n</code></pre>\n\n<p>I think you can get all that from <code>System.IO</code></p>\n"}], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "closed_date": 1448289220, "accepted_answer_id": 33865479, "answer_count": 1, "score": 0, "last_activity_date": 1448414487, "creation_date": 1448262599, "last_edit_date": 1448414487, "question_id": 33865433, "link": "https://stackoverflow.com/questions/33865433/weird-buffering-with-prompt-in-haskell", "closed_reason": "Duplicate", "title": "Weird buffering with prompt in haskell", "body": "<p>I was playing around in Haskell and noticed something weird. I've defined a simple prompt function below.</p>\n\n<pre><code>-- file: test.hs\nmain :: IO ()\nmain = putStrLn . (\"Hello, \" ++) =&lt;&lt; (putStr \"Name: \" &gt;&gt; getLine)\n</code></pre>\n\n<p>When I <code>runhaskell</code> this, it works as expected, printing the prompt, waits for my input, then prints the greeting.</p>\n\n<pre><code>$ runhaskell test.hs\nName: kwarrtz\nHello, kwarrtz\n</code></pre>\n\n<p>When I compile it, however, things get weird. When I run it, it doesn't print the prompt, instead giving me a blank line and waiting for input. When I type my name and hit enter, it prints the prompt and the greeting, on the same line. In otherwords, the <code>getLine</code> happens before the <code>putStr</code>. </p>\n\n<pre><code>$ ghc test.hs\n$ ./test\nkwarrtz\nName: Hello, kwarrtz\n</code></pre>\n\n<p>Any thoughts on what's happening? I imagine it has something to do with the line buffering on my terminal, but I'm not sure how (that or I've just made some really ridiculous mistake in my code).</p>\n\n<p>I'm running GHC 7.8.3 on Mac OS X El Capitan and using the default Terminal app.</p>\n"}, {"tags": ["haskell", "llvm", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 1182, "user_id": 726086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f74516af74d7577c6ca6976996ca54fe?s=128&d=identicon&r=PG", "display_name": "mentatkgs", "link": "https://stackoverflow.com/users/726086/mentatkgs"}, "is_accepted": false, "score": 1, "last_activity_date": 1458362885, "creation_date": 1458362885, "answer_id": 36097969, "question_id": 33863062, "link": "https://stackoverflow.com/questions/33863062/running-ghcs-llvm-output-through-the-llvm-bitcode-linker-first/36097969#36097969", "title": "Running GHC&#39;s LLVM output through the LLVM bitcode linker first", "body": "<p>Have you tried these two things?</p>\n\n<p>1 - Use the <strong>alwaysinline</strong>  function attribute: <a href=\"http://llvm.org/docs/LangRef.html#function-attributes\" rel=\"nofollow\">http://llvm.org/docs/LangRef.html#function-attributes</a></p>\n\n<p>2 - Using GHC calling convention, (cc 10 instead of fastcc):\n<a href=\"http://llvm.org/docs/LangRef.html#calling-conventions\" rel=\"nofollow\">http://llvm.org/docs/LangRef.html#calling-conventions</a></p>\n\n<pre><code>define cc 10 i64 @llvminc(i64 inreg %x) alwaysinline {\n  %r = add i64 %x, 1\n  ret i64 %r\n}\n</code></pre>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 2, "answer_count": 1, "score": 17, "last_activity_date": 1458362885, "creation_date": 1448247184, "last_edit_date": 1448327816, "question_id": 33863062, "link": "https://stackoverflow.com/questions/33863062/running-ghcs-llvm-output-through-the-llvm-bitcode-linker-first", "title": "Running GHC&#39;s LLVM output through the LLVM bitcode linker first", "body": "<p>I want to be able to call LLVM code from Haskell without the overhead of a full function call. For example:</p>\n\n<pre><code>-- Main.hs --\n\n{-# LANGUAGE MagicHash #-}\n{-# LANGUAGE UnboxedTuples #-}\n{-# LANGUAGE GHCForeignImportPrim #-}\n{-# LANGUAGE ForeignFunctionInterface #-}\n{-# LANGUAGE UnliftedFFITypes #-}\n{-# LANGUAGE BangPatterns #-}\n\nimport GHC.Exts(Word(W#))\nimport GHC.Prim(Word#)\n\nforeign import ccall llvminc :: Word# -&gt; Word#\n\nmain = do\n  line1 &lt;- getLine\n  let !(W# x1) = read line1\n  let !r1 = llvminc x1\n  print (W# r1)\n\n\n-- funcs.ll --\n\ndefine fastcc i64 @llvminc(i64 inreg %x) {\n  %r = add i64 %x, 1\n  ret i64 %r\n}\n</code></pre>\n\n<p>I can compile and link this to produce a functioning executable by running:</p>\n\n<pre><code>ghc -O2 -fllvm Main.hs funcs.ll\n</code></pre>\n\n<p>Indeed, even removing <code>-fllvm</code> still results in a functioning executable, e.g. </p>\n\n<pre><code>ghc -O2 Main.hs funcs.ll\n</code></pre>\n\n<p>Which leads me to strongly suspect GHC is linking these files separately in both cases using ordinary C linkage.</p>\n\n<p>Indeed, when I investigate the intermediate output using:</p>\n\n<pre><code>ghc -O2 -fllvm -keep-s-files Main.hs funcs.ll\n</code></pre>\n\n<p>I see the following in Main.s:</p>\n\n<pre><code>callq   suspendThread\nmovq    %rax, %rbp\nmovq    %rbx, %rdi\ncallq   llvminc\nmovq    %rax, %rbx\nmovq    %rbp, %rdi\ncallq   resumeThread\n</code></pre>\n\n<p>Which again suggests that GHC is just asking LLVM to compile the files separately and it then just sending the results to the system linker, which wouldn't inline the calls.</p>\n\n<p>Instead, I'd like GHC to send the initial LLVM files (both from GHC and user specified) to the <a href=\"http://llvm.org/docs/CommandGuide/llvm-link.html\" rel=\"noreferrer\">llvm-link</a>, which unlike a system linker, simply combines multiple LLVM bitcode files into one LLVM bitcode file. It would be best if this result was then compiled to native code object file and sent to the system linker, instead of multiple object files being sent to the system linker.</p>\n\n<p>Indeed, when I tried this manually, assembling the <code>.ll</code> human readable files to LLVM <code>.bc</code> bitcode, <code>llvm-link</code>ing the resulting bitcode, then disassembling the bitcode like so:</p>\n\n<pre><code>llvm-as Main.ll\nllvm-as funcs.ll\nllvm-link funcs.bc Main.bc -o combined.bc\nllvm-dis combined.bc\n</code></pre>\n\n<p>I found the following in the resulting LLVM code</p>\n\n<pre><code>%ln59M = add i64 %ln59L, 1\n</code></pre>\n\n<p>directly after the call to read, with no \"call\" or return. The actual function is still in the LLVM, but is uncalled.</p>\n\n<p>So I tried instructing GHC to link with the LLVM linker by adding <code>-pgml llvm-link</code> to the command line, but this failed spectacularly, with <code>llvm-link</code> throwing back many errors about unknown options. This is unsurprising, as <code>llvm-link</code> isn't a real linker, it just combines LLVM files.</p>\n\n<p>So, is there anyway to get GHC to send all it's intermediate LLVM files through the LLVM linker to enable intermodule optimisations at the LLVM level?</p>\n"}, {"tags": ["python", "loops", "haskell", "for-loop"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1448245370, "post_id": 33862776, "comment_id": 55490003, "body": "You can write it almost identically using a list comprehension <code>isAssociative test = all [ g (g x y) z == g x (g y z) | x &lt;- [1..n], y &lt;- [1..n], z &lt;- [1..n] ] where n = length test; g = getValue test</code>."}, {"owner": {"reputation": 13, "user_id": 5593366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b23a3941c487a4b163075121123bcb28?s=128&d=identicon&r=PG&f=1", "display_name": "Kelly ", "link": "https://stackoverflow.com/users/5593366/kelly"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1448246234, "post_id": 33862776, "comment_id": 55490185, "body": "@user2407038 there was an error: Couldn&#39;t match expected type \u2018Bool\u2019 with actual type \u2018t0 a0 -&gt; Bool\u2019 Probable cause: \u2018all\u2019 is applied to too few arguments. Looking at documentation, <code>all</code> requires two parameters, but I don&#39;t think that would work here?"}, {"owner": {"reputation": 1521, "user_id": 365807, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8c9db2824164d60fe55d2b0c1c361f20?s=128&d=identicon&r=PG", "display_name": "Fraser", "link": "https://stackoverflow.com/users/365807/fraser"}, "edited": false, "score": 0, "creation_date": 1448248704, "post_id": 33862776, "comment_id": 55490769, "body": "<code>isTrue</code> is just <code>id</code>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1448250688, "post_id": 33862776, "comment_id": 55491191, "body": "Python&#39;s list comprehension was inspired by Haskell&#39;s -- so it would be surprising if the Python solution couldn&#39;t be converted to Haskell fairly easily. Also -- becoming familiar with how Python 3 handles iterators, map, zip, etc., is a good a way to get used to the lazy approach to computation which is so central in Haskell."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1448257767, "post_id": 33862776, "comment_id": 55492989, "body": "@user2407038, @Kelly: that <code>all</code> shoud read <code>and</code>, which has the correct type <code>[Bool] -&gt; Bool</code>."}, {"owner": {"reputation": 13, "user_id": 5593366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b23a3941c487a4b163075121123bcb28?s=128&d=identicon&r=PG&f=1", "display_name": "Kelly ", "link": "https://stackoverflow.com/users/5593366/kelly"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1448265009, "post_id": 33862776, "comment_id": 55495767, "body": "@Cactus: good catch, thanks. Do you know how I am able to achieve the find_identity equivalent in Haskell? I tried <code>filter (`elem` y) [ y | (g x y == g y x) &amp;&amp; (g y x == x ),  x &lt;- [0..n-1], y &lt;- [0..n-1]]</code> but it says y is not in scope."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1448290400, "post_id": 33862776, "comment_id": 55511335, "body": "@Kelly I&#39;m not sure what the filter should do there - if you want to search for  (left) identity elements - <code>[ o | o &lt;- [1..n], and [ g o x == x | x &lt;- [1..n] ] ]</code>. This returns a list - there could be no identities, there could be one, and there could be many. You must discriminate between these cases if you want your return type to be <code>Int</code> (but you probably want <code>Maybe Int</code> - <code>Nothing</code> if there is no identity)."}], "answers": [{"tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": true, "score": 0, "last_activity_date": 1448390467, "last_edit_date": 1448390467, "creation_date": 1448354172, "answer_id": 33888847, "question_id": 33862776, "link": "https://stackoverflow.com/questions/33862776/how-can-i-implement-a-for-loop-in-haskell-that-iterates-through-all-values-of-a/33888847#33888847", "title": "How can I implement a for loop in Haskell that iterates through all values of a list?", "body": "<p>Here is the <code>findIdentity</code> part:</p>\n\n<pre><code>findIdentity :: [[Int]] -&gt; Maybe Int\nfindIdentity ls = find 0 ls $ transpose ls where\n  n = length ls - 1\n  find _ [] [] = Nothing\n  find y xs ys = if map head xs == map head ys &amp;&amp; map head xs == [0..n]\n                 then Just y\n                 else if n == y\n                      then Nothing\n                      else find (y+1) (map tail xs) (map tail ys)\n\n\ntranspose :: [[b]] -&gt; [[b]]\ntranspose [] = []\ntranspose ls | (length $ head ls) == 1 = [map head ls]\n             | otherwise = map head ls:(transpose $ map tail ls)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5593366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b23a3941c487a4b163075121123bcb28?s=128&d=identicon&r=PG&f=1", "display_name": "Kelly ", "link": "https://stackoverflow.com/users/5593366/kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 33888847, "answer_count": 1, "score": 1, "last_activity_date": 1448390467, "creation_date": 1448244866, "last_edit_date": 1448355014, "question_id": 33862776, "link": "https://stackoverflow.com/questions/33862776/how-can-i-implement-a-for-loop-in-haskell-that-iterates-through-all-values-of-a", "title": "How can I implement a for loop in Haskell that iterates through all values of a list?", "body": "<p>I am new to Haskell as well as functional programming. I have been searching for a way to iterate through all values in a list, but haven't found any.</p>\n\n<p>Here is the Python code of what I am trying to achieve:</p>\n\n<pre><code>    matrix = [[2, 0, 1],[0, 1, 2],[1, 2, 0]]\n\n    def is_associative(G):\n        n = len(G)          \n        return all(G[(G[x][y])][z] == G[x][(G[y][z])] for x in range(n) \n                   for y in range(n) for z in range(n))\n\n    # is_associative(matrix) returns true\n\n    def find_identity(G):\n        n = len(G)\n        for y in range(n):\n            if all(G[x][y] == G[y][x] == x for x in range(n)):\n                return y\n\n    # find_identity(matrix) returns 1\n</code></pre>\n\n<p>Here is what I have so far in Haskell:</p>\n\n<pre><code>    isAssociative :: [[Int]] -&gt; Bool\n    isAssociative [[]] = False\n    isAssociative test = do \n        let x = 0\n        let y = 1\n        let z = 2\n        getValue test (getValue test x y) z == getValue test x (getValue test y z)\n\n    getValue :: [[Int]] -&gt; Int -&gt; Int -&gt; Int\n    getValue list a b = list !! a !! b\n\n    findIdentity :: [[Int]] -&gt; Int\n    findIdentity test = \n        if all isTrue [ (g x y == g y x) &amp;&amp; (g y x == x ) | x &lt;- [0..n-1], y &lt;- [0..n-1]]\n            then 1 -- how to return y?\n            else 0 -- how to return nothing?\n        where n = length test\n              g = getValue test\n</code></pre>\n\n<p>I have been able to fix my associativity function, but I still want to achieve the exact same functionality for finding the identity as the Python function.</p>\n\n<p><strong>EDIT (PARTIALLY SOLVED -- need help with identity)</strong>: </p>\n\n<pre><code>    isAssociative :: [[Int]] -&gt; Bool\n    isAssociative [[]] = False\n    isAssociative test = \n        all id [ g (g x y) z == g x (g y z) | x &lt;- [0..n-1], y &lt;- [0..n-1], z &lt;- [0..n-1]]\n        where n = length test\n              g = getValue test\n\n    getValue :: [[Int]] -&gt; Int -&gt; Int -&gt; Int\n    getValue list a b = list !! a !! b\n</code></pre>\n"}, {"tags": ["haskell", "idle-processing"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 2547777, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1552cfe6018ca3d119dbee1ab5461533?s=128&d=identicon&r=PG", "display_name": "michaelg9", "link": "https://stackoverflow.com/users/2547777/michaelg9"}, "edited": false, "score": 0, "creation_date": 1448705824, "post_id": 33949871, "comment_id": 55696899, "body": "Hey!  I found the problem,  and as you guessed, it wasn&#39;t idlecallback&#39;s problem, it was just slow to update so the animation was sluggish. I fixed it by changing the order of commands, leaving the animated part at the end. Thank you for the suggestion of functional reactive programming, seems interesting so I&#39;ll check it out.  Thank you for your answer :)"}], "tags": [], "owner": {"reputation": 2560, "user_id": 46842, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3a5acbe9f67bdc96d5901946aa87d619?s=128&d=identicon&r=PG", "display_name": "psycotica0", "link": "https://stackoverflow.com/users/46842/psycotica0"}, "is_accepted": false, "score": 1, "last_activity_date": 1448595169, "creation_date": 1448595169, "answer_id": 33949871, "question_id": 33861853, "link": "https://stackoverflow.com/questions/33861853/haskell-idlecallback-too-slow/33949871#33949871", "title": "Haskell IdleCallback too slow", "body": "<p>There's not a lot to go on here. I don't see an explicit delay anywhere, so I'm guessing it's slow just because of how long it takes to update?</p>\n\n<p>It also doesn't look explicitly recursive, so it seems like the problem is outside the scope of this snippet.</p>\n\n<p>Also I don't know which libraries you may be using.</p>\n\n<p>In general, though, that <code>IORef</code> makes me feel unhappy.\nWhile it may be common in other languages to have global variables, <code>IORef</code>s in Haskell have their place, but are often a bad sign.</p>\n\n<p>Even in another language, I don't think I'd do this with a global variable.</p>\n\n<p>If you want to do time-updating things in Haskell, one \"common\" approach is to use a <a href=\"https://wiki.haskell.org/Functional_Reactive_Programming\" rel=\"nofollow\">Functional Reactive Programming</a> library.</p>\n\n<p>They are built to have chains of functions that trigger off of a signal coming from outside, modifying the state of something, which eventually renders an output.</p>\n\n<p>I've used them in the past for (simple) games, and in your case you could construct a system that is fed a clock signal 24 times per second, or whatever, and uses that to update the counter and yield a new image to blit.</p>\n\n<p>My answer is kind of vague, but the question is a little vague too, so hopefully I've at least given you something to look into.</p>\n"}], "owner": {"reputation": 75, "user_id": 2547777, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/1552cfe6018ca3d119dbee1ab5461533?s=128&d=identicon&r=PG", "display_name": "michaelg9", "link": "https://stackoverflow.com/users/2547777/michaelg9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1448595169, "creation_date": 1448237244, "question_id": 33861853, "link": "https://stackoverflow.com/questions/33861853/haskell-idlecallback-too-slow", "title": "Haskell IdleCallback too slow", "body": "<p>I just started designing some graphics in haskell. I want to create an animated picture with a rotating sphere, so I created an IdleCallback function to constantly update the angle value:</p>\n\n<pre><code>idle :: IORef GLfloat -&gt; IdleCallback\nidle angle = do \n  a &lt;- get angle\n  angle $= a+1\n  postRedisplay Nothing\n</code></pre>\n\n<p>I'm adding 1 each time to the angle because I want to make my sphere smoothly rotate, rather than just jump from here to there. The problem is that now it rotates TOO slow. Is there a way to keep the rotation smooth and make it faster??</p>\n\n<p>Thanks a lot!</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448228588, "post_id": 33859734, "comment_id": 55485580, "body": "A minor variant of <a href=\"http://stackoverflow.com/a/12398993/791604\">this previous answer</a>: <code>\\s -&gt; elems . fromListWith (++) $ [(take 3 (reverse w), [w]) | w &lt;- words s]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "edited": false, "score": 0, "creation_date": 1448228379, "post_id": 33860307, "comment_id": 55485483, "body": "You can remove the <code>reverse</code> part from your <code>rhyming</code> function and the first <code>map reverse</code> from <code>rhymeWords</code>. They are sort of &quot;cancelling each other out&quot;. Other than that, nice answer (a lot more readable that the one I came up with). I was trying to use <code>groupBy</code> at the beginning, but failed..."}, {"owner": {"reputation": 53, "user_id": 5536215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34b3d920e62ece3a722bbd9fdb908d25?s=128&d=identicon&r=PG&f=1", "display_name": "04k", "link": "https://stackoverflow.com/users/5536215/04k"}, "edited": false, "score": 0, "creation_date": 1448228642, "post_id": 33860307, "comment_id": 55485608, "body": "Thank you for the answer!"}, {"owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "edited": false, "score": 0, "creation_date": 1448261519, "post_id": 33860307, "comment_id": 55494327, "body": "<a href=\"http://stackoverflow.com/users/3053082/kapol\">Kapol</a>: Since <code>rhyming</code> and <code>rhymeWords</code> are two separate functions, they need to be &quot;standalone&quot;. What I mean is that they should work in any condition. However if I put the <code>rhyming</code> function in a <code>where clause</code>, it would make more sense because it would exist only in <code>rhymeWords</code>&#39;s context. Nice answer too :)"}, {"owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "edited": false, "score": 0, "creation_date": 1448263754, "post_id": 33860307, "comment_id": 55495186, "body": "@baxbaxwalanuksiwe Thanks for the clarification."}], "tags": [], "owner": {"reputation": 1404, "user_id": 5559663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sQiE2.gif?s=128&g=1", "display_name": "baxbaxwalanuksiwe", "link": "https://stackoverflow.com/users/5559663/baxbaxwalanuksiwe"}, "is_accepted": false, "score": 1, "last_activity_date": 1448228194, "last_edit_date": 1448228194, "creation_date": 1448227052, "answer_id": 33860307, "question_id": 33859734, "link": "https://stackoverflow.com/questions/33859734/string-to-list-of-lists-of-rhyming-words/33860307#33860307", "title": "string to list of lists of rhyming words", "body": "<p>When you have to group items together, you can use <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html\" rel=\"nofollow\"><code>Data.List</code></a>'s grouping higher order functions. With <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:groupBy\" rel=\"nofollow\"><code>groupBy</code></a> you can easily solve your problem just by writing your grouping function. In your case, you want to group words that rhyme together. You just have to write the function <code>rhyming</code>:</p>\n\n<pre><code>rhyming :: String -&gt; String -&gt; Bool\nrhyming word1 word2 = last3 (lower word1) == last3 (lower word2)\n    where\n        last3 = take 3 . reverse  -- if you wanted `last3` to return the last three characters in order, you'd just have to apply `reverse` to the result, but that's unnecessary here\n        lower = map toLower\n</code></pre>\n\n<p>So your <code>rhymeWords</code> function can be written like so:</p>\n\n<pre><code>import Data.List (groupBy, sort)\nimport Data.Char (toLower)\n\nrhyming :: String -&gt; String -&gt; Bool\nrhyming word1 word2 = last3 (lowercase word1) == last3 (lowercase word2)\n    where\n        last3 = take 3 . reverse\n        lowercase = map toLower\n\nrhymeWords :: String -&gt; [[String]]\nrhymeWords = groupBy rhyming . map reverse . sort . map reverse . words\n</code></pre>\n\n<p>The <code>map reverse . sort . map reverse</code> thing is needed since <code>groupBy</code> groups elements that are next to another. It groups words that are likely to rhyme together.</p>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 5536215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34b3d920e62ece3a722bbd9fdb908d25?s=128&d=identicon&r=PG&f=1", "display_name": "04k", "link": "https://stackoverflow.com/users/5536215/04k"}, "edited": false, "score": 0, "creation_date": 1448228613, "post_id": 33860422, "comment_id": 55485592, "body": "Thank you! Fiddling now! :)"}], "tags": [], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "is_accepted": true, "score": 1, "last_activity_date": 1448228749, "last_edit_date": 1448228749, "creation_date": 1448227666, "answer_id": 33860422, "question_id": 33859734, "link": "https://stackoverflow.com/questions/33859734/string-to-list-of-lists-of-rhyming-words/33860422#33860422", "title": "string to list of lists of rhyming words", "body": "<p>The following code groups rhymes as requested, although it converts all characters to lower case.</p>\n\n<pre><code>import Data.List (sort)\nimport Data.Char (toLower)\n\nrhymeWords:: String -&gt; [[String]]\nrhymeWords \"\" = []\nrhymeWords xs = [map reverse g | g &lt;- groupRhymes (sortRhymes xs) []]\n    where sortRhymes xs = sort $ map reverse (words [toLower x | x &lt;- xs])\n\ngroupRhymes :: [String] -&gt; [[String]] -&gt; [[String]]\ngroupRhymes [] acc     = acc\ngroupRhymes (x:xs) acc = case acc of\n                            [] -&gt; groupRhymes xs [[x]]\n                            _  -&gt; if take 3 x == take 3 (head (last acc)) \n                                    then groupRhymes xs ((init acc) ++ [(last acc) ++ [x]])\n                                    else groupRhymes xs (acc ++ [[x]])\n</code></pre>\n\n<p>Example result:</p>\n\n<pre><code>hymeWords \"Six sick hicks nick six slick bricks with picks and sticks\"\n[[\"and\"],[\"with\"],[\"slick\",\"nick\",\"sick\"],[\"hicks\",\"picks\",\"bricks\",\"sticks\"],[\"six\",\"six\"]]\n</code></pre>\n\n<p>Note that the example input doesn't have a period at the end of the sentence, because the last word would include it and break the sorting. You'll need to fiddle a bit with presented code if you need to pass sentences with a period.</p>\n"}], "owner": {"reputation": 53, "user_id": 5536215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34b3d920e62ece3a722bbd9fdb908d25?s=128&d=identicon&r=PG&f=1", "display_name": "04k", "link": "https://stackoverflow.com/users/5536215/04k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 33860422, "answer_count": 2, "score": 0, "last_activity_date": 1448228749, "creation_date": 1448223697, "last_edit_date": 1448224939, "question_id": 33859734, "link": "https://stackoverflow.com/questions/33859734/string-to-list-of-lists-of-rhyming-words", "title": "string to list of lists of rhyming words", "body": "<p>My goal is a function which takes a sentence and returns a list of lists with the words rhyming (rhyming = last 3 chars are equal).</p>\n\n<p>Example: <code>\"Six sick hicks nick six slick bricks with picks and sticks.\"</code> -></p>\n\n<pre><code>[[Six,six],[sick,nick,slick],[hicks,bricks,picks,sticks],[with]]\n</code></pre>\n\n<p>This is my code so far (bsort is bubblesort):</p>\n\n<pre><code>rhymeWords:: String -&gt; [[String]]\nrhymeWords \"\" = []\nrhymeWords xs = bsort (words (reverse xs))\n</code></pre>\n\n<p>I do not know how to translate it into code but I would like to take the first three chars of the first string and put them into a list. Then take the next String and test if it is equal to the first. If true put the second string into the first list otherwise create a second list. Then move on to the third string, each time testing with previous lists.</p>\n\n<p>Can anyone please help me?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 1, "creation_date": 1448220399, "post_id": 33859122, "comment_id": 55482649, "body": "Values in Haskell &quot;stick around&quot; in the same way they do in OO language. Objects are usually created and destroyed all the time as the program is executed just like values in Haskell are collected after they are no longer required."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 5, "creation_date": 1448221269, "post_id": 33859122, "comment_id": 55482996, "body": "What about narrowing the discussion to something concrete. Give us an algorithm / computation, and we can compare and contrast OO vs Haskell implementations. Note that you can use mutable data structures in Haskell, but you also have the choice not to."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1448221317, "post_id": 33859122, "comment_id": 55483015, "body": "&quot;create a bunch of functions that take in a state data structure (&quot;object&quot;) plus some other data and return a new state data structure&quot; - yep, that&#39;s the essence of FP. But we can use higher-order functions to define nice abstractions to fit many different patterns we find in our code (including those that are best thought of as &quot;stateful&quot;), and the type system makes these abstractions sensible and composable."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1448221414, "creation_date": 1448221414, "answer_id": 33859365, "question_id": 33859122, "link": "https://stackoverflow.com/questions/33859122/am-i-moving-from-oo-to-haskell-in-the-correct-manner/33859365#33859365", "title": "Am I moving from OO to Haskell in the correct manner?", "body": "<p>I would rather put it the other way around: in Haskell, nothing is momentary, or concerned with any kind of time scale at all. You define stuff <em>once and for all</em>, values &ldquo;have always been and will always stay around&rdquo;.</p>\n\n<p>(Not really, of course; that would be terribly memory-inefficient. Stuff you haven't evaluated yet won't actually exist in memory, but only in an abstract thunk form, and stuff that isn't needed anymore will be garbage-collected just like in Java.)</p>\n\n<p>Instead of thinking about how objects change in time, you just think about the end result, the &ldquo;desired final state&rdquo; right away.</p>\n\n<p>Now, obviously often the whole purpose of a program is to <em>do stuff</em> in time, not just give some final result. Well, in Haskell we like to think of such processes in more of a big picture: you try to consider the entire behaviour, or &ldquo;history of states&rdquo;, as a single abstract super-value. For instance, Functional Reactive Programming describes the history of states as a <em>function of a time variable</em>. The function <em>has</em> many values over time, but the function itself <em>is</em> just a single value, that you define once and for all times.</p>\n"}], "owner": {"reputation": 117, "user_id": 5592551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d521a4021aea28572ece936720e60925?s=128&d=identicon&r=PG&f=1", "display_name": "hsk6", "link": "https://stackoverflow.com/users/5592551/hsk6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "closed_date": 1448228648, "accepted_answer_id": 33859365, "answer_count": 1, "score": 1, "last_activity_date": 1448221414, "creation_date": 1448220059, "question_id": 33859122, "link": "https://stackoverflow.com/questions/33859122/am-i-moving-from-oo-to-haskell-in-the-correct-manner", "closed_reason": "Needs more focus", "title": "Am I moving from OO to Haskell in the correct manner?", "body": "<p>In OO, I have objects (instances of classes). I create objects, they stick around in memory, and I act on them to modify them over time.</p>\n\n<p>The way I see Haskell: I don't have objects. Nothing sticks around in memory really. Things are just momentarily created and passed around functions to create new momentary things. And so on. My first question: <strong>Is this an accurate depiction of Haskell</strong>?</p>\n\n<p>Moving to Haskell, I sometimes don't really know where to begin. How do I solve the same problem I was solving in OO? So I just turn to what seems obvious: I create state data structures (usually using record syntax). These are sort of like objects so they're familiar to me (except they're momentary as I talked about above). Then I just create a bunch of functions that take in a state data structure (\"object\") plus some other data and return a new state data structure (\"object\") plus some other new data. That's all I'm finding myself doing. I can't imagine any other way of doing things. (Well, except where I create small pure utility functions. These sort of correspond to private methods in OO. Small utility functions for specific tasks.) Second question: <strong>Does what I'm doing sound correct or am I on the wrong path?</strong></p>\n"}, {"tags": ["haskell", "tree", "drawing", "draw"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1448211191, "post_id": 33857328, "comment_id": 55479217, "body": "It sounds like you want an algorithm for a <a href=\"https://en.wikipedia.org/wiki/Tree_traversal\" rel=\"nofollow noreferrer\">&quot;depth-first tree traversal&quot;</a>, and one technique that can help you with &quot;variables which would be required to remember which parts of the tree the cursor has already drawn&quot; is to use a <a href=\"https://wiki.haskell.org/Zipper\" rel=\"nofollow noreferrer\">zipper</a>."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 1, "creation_date": 1448211217, "post_id": 33857328, "comment_id": 55479230, "body": "If every drawing function that you write would afterwards move the curser back to its original position, no state needs to be kepts. Simply recurse over the tree and write it out. But it would be easier to help if you show some code (what is your drawing API, what are your data types)."}, {"owner": {"reputation": 94, "user_id": 5504651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/36f9632b5e73c225475a644e029ead84?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5504651/james"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1448211745, "post_id": 33857328, "comment_id": 55479426, "body": "@JoachimBreitner I am not sure what you mean, could you elaborate?"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1448267322, "post_id": 33857328, "comment_id": 55496780, "body": "See adamse\u2019s answer, it pretty much nails it down."}], "answers": [{"comments": [{"owner": {"reputation": 94, "user_id": 5504651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/36f9632b5e73c225475a644e029ead84?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5504651/james"}, "edited": false, "score": 0, "creation_date": 1448299539, "post_id": 33858912, "comment_id": 55517540, "body": "Ah ok this makes a lot of sense, thanks for explaining."}], "tags": [], "owner": {"reputation": 11612, "user_id": 204218, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3ee571049ff6ff0361be53e554b877e6?s=128&d=identicon&r=PG", "display_name": "adamse", "link": "https://stackoverflow.com/users/204218/adamse"}, "is_accepted": true, "score": 2, "last_activity_date": 1448220363, "last_edit_date": 1448220363, "creation_date": 1448219056, "answer_id": 33858912, "question_id": 33857328, "link": "https://stackoverflow.com/questions/33857328/drawing-a-binary-tree-structure-in-haskell/33858912#33858912", "title": "Drawing a binary tree structure in haskell", "body": "<p>Assuming this is your drawing API:</p>\n\n<pre><code>forward :: Int -&gt; IO ()\nbackward :: Int -&gt; IO ()\nrotate :: Double -&gt; IO ()\n</code></pre>\n\n<p>And from your description the tree datatype looks like this:</p>\n\n<pre><code>data Tree\n  = Bin Tree Int Tree\n  | Tip\n</code></pre>\n\n<p>Then you can recursively draw the left subtree followed by the right as you suggested: (a \"pre-order depth-first\" traversal of the tree)</p>\n\n<pre><code>draw :: Double -- ^ Angle\n     -&gt; Tree\n     -&gt; IO ()\ndraw d Tip = return () -- no lines for Tips\ndraw d (Bin l v r) = do\n  -- draw this node's line\n  forward v\n\n  -- draw left subtree\n  rotate d\n  draw d l\n\n  -- draw right subtree\n  rotate (2 * (-d))\n  draw d r\n\n  -- return to starting position\n  rotate d\n  backward v\n</code></pre>\n"}], "owner": {"reputation": 94, "user_id": 5504651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/36f9632b5e73c225475a644e029ead84?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5504651/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "accepted_answer_id": 33858912, "answer_count": 1, "score": 0, "last_activity_date": 1448220363, "creation_date": 1448210638, "question_id": 33857328, "link": "https://stackoverflow.com/questions/33857328/drawing-a-binary-tree-structure-in-haskell", "title": "Drawing a binary tree structure in haskell", "body": "<p>I am working in Haskell and attempting to draw a tree data structure which uses 'nodes' which have one or two children trees and 'tips' which are empty trees.</p>\n\n<p>The drawing process takes the highest level node and draws a straight line upwards whose length is equal to the value of the node itself.</p>\n\n<p>Tips don't have lines drawn for them.</p>\n\n<p>From this initial line, the children of the node are drawn at an angle 'd' to the parent line. The lines are angled left for the left children and right for the right children of the node. The length of these lines are equal to the value of each child respectively.</p>\n\n<p>This repeats for each node down the tree structure.</p>\n\n<p>My problem is that we are using a single cursor (which can move forwards, backwards and rotate) to draw the trees.\nTherefore drawing the entire tree seems to require some kind of algorithm for systematically drawing out a tree (e.g prioritising drawing children on the left until a tip is reached, and then back tracking and drawing a right child)</p>\n\n<p>However this approach seems extremely complex because Haskell is unable to store variables which would be required to remember which parts of the tree the cursor has already drawn.</p>\n\n<p>Is there an algorithm which is capable of achieving this?\nIf not, is there some other way to draw a tree using a single cursor on a 2d plane?</p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5536215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34b3d920e62ece3a722bbd9fdb908d25?s=128&d=identicon&r=PG&f=1", "display_name": "04k", "link": "https://stackoverflow.com/users/5536215/04k"}, "edited": false, "score": 0, "creation_date": 1448203721, "post_id": 33856002, "comment_id": 55476272, "body": "I did not have downvoted you!  Still try to understand your approach."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 53, "user_id": 5536215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34b3d920e62ece3a722bbd9fdb908d25?s=128&d=identicon&r=PG&f=1", "display_name": "04k", "link": "https://stackoverflow.com/users/5536215/04k"}, "edited": false, "score": 0, "creation_date": 1448203805, "post_id": 33856002, "comment_id": 55476309, "body": "the approach is just to make a new list out of <code>[a,b,c,d...]</code> using an operator <code>f</code> by doing <code>[f a b, f b c, f c d, ...]</code> - so it&#39;s basically what you started"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 53, "user_id": 5536215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34b3d920e62ece3a722bbd9fdb908d25?s=128&d=identicon&r=PG&f=1", "display_name": "04k", "link": "https://stackoverflow.com/users/5536215/04k"}, "edited": false, "score": 0, "creation_date": 1448204508, "post_id": 33856002, "comment_id": 55476605, "body": "yes it is ;) ... also random downvote ... yay sunday on SO"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": -1, "last_activity_date": 1448203652, "last_edit_date": 1448203652, "creation_date": 1448203311, "answer_id": 33856002, "question_id": 33855892, "link": "https://stackoverflow.com/questions/33855892/largest-prefix-list-of-lists/33856002#33856002", "title": "Largest prefix list of lists", "body": "<p>So I cleaned up your function a bit and added the following idea:</p>\n\n<p>if you write a function that applies an operator to every two consecutive pairs of a list (<code>pairwise</code>) then you should be able to finish your work:</p>\n\n<pre><code>pairwise :: (a -&gt; a -&gt; b) -&gt; [a] -&gt; [b]\npairwise f (x:xs@(y:_)) = f x y : pairwise f xs\npairwise _ _            = []\n\nprefix:: String -&gt; String -&gt; String\nprefix (x:xs) (y:ys) \n  | x == y = x:prefix xs ys\n  | otherwise = \"\"\nprefix _ _ = \"\"\n</code></pre>\n\n<p>here is an example:</p>\n\n<pre><code>\u03bb&gt; pairwise prefix [\"a\",\"abca\",\"bca\",\"bcadabca\",\"ca\",\"cdabca\"]\n[\"a\",\"\",\"bca\",\"\",\"c\"]\n</code></pre>\n\n<hr>\n\n<p>so maybe someone was unhappy because I did not resolve everything so here you go:</p>\n\n<pre><code>largestPrefix :: [String] -&gt; (Int, String)\nlargestPrefix xs = maximumBy (compare `on` length . snd) $ zip [1..] (pairwise prefix xs)\n</code></pre>\n\n<p>where you have to import this to work:</p>\n\n<pre><code>import Data.List (maximumBy)\nimport Data.Function (on)\n</code></pre>\n\n<h3>example</h3>\n\n<pre><code>\u03bb&gt; largestPrefix [\"a\",\"abca\",\"bca\",\"bcadabca\",\"ca\",\"cdabca\"]\n(3,\"bca\")\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 5536215, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34b3d920e62ece3a722bbd9fdb908d25?s=128&d=identicon&r=PG&f=1", "display_name": "04k", "link": "https://stackoverflow.com/users/5536215/04k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 33856002, "answer_count": 1, "score": 1, "last_activity_date": 1448203652, "creation_date": 1448202520, "question_id": 33855892, "link": "https://stackoverflow.com/questions/33855892/largest-prefix-list-of-lists", "title": "Largest prefix list of lists", "body": "<p>I need to define a function <code>largestPrefix</code> that goes through a list of strings\nand returns the longest prefix of two adjacent strings of the list in a tuple. The first element of the tuple is the length of the prefix .</p>\n\n<p>a.e.: <code>largestPrefix [\"a\",\"abca\",\"bca\",\"bcadabca\",\"ca\",\"cdabca\"] =&gt; (3,\"bca\")</code></p>\n\n<p>I have already built a function for two Stings, but have no idea how to use that on a list of lists. To ensure the adjacency I thought about using this:</p>\n\n<pre><code> prefix:: String -&gt; String -&gt; String\n prefix (x:xs) (y:ys)   | x:xs == \"\" = \"\"\n                        | y:ys == \"\" = \"\"\n                        | x == y = x:prefix xs ys\n                        | otherwise = \"\"\n</code></pre>\n"}, {"tags": ["haskell", "ffi"], "comments": [{"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 3, "creation_date": 1448202230, "post_id": 33855562, "comment_id": 55475763, "body": "You define it a <code>Foreign.Storable.Storable</code> instance."}, {"owner": {"reputation": 1099, "user_id": 1725165, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f45c9108a779695d5ccf44941eea31f0?s=128&d=identicon&r=PG", "display_name": "Zsolt Szatmari", "link": "https://stackoverflow.com/users/1725165/zsolt-szatmari"}, "reply_to_user": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1448202960, "post_id": 33855562, "comment_id": 55476007, "body": "Yes, I could do something like that, but it&#39;s very manual, lot of work, not too good for a sensible workflow."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 1, "creation_date": 1448208183, "post_id": 33855562, "comment_id": 55478033, "body": "Generally to do this right you would use hsc2hs, c2hs, etc. For newtypes that wrap <code>Storable</code>s, use <code>GeneralizedNewtypeDeriving</code>. Some packages will generate it for you based on Generics. Try querying <a href=\"https://hackage.haskell.org/packages/search?terms=storable\" rel=\"nofollow noreferrer\">storable</a> on Hackage; I&#39;ve never tried them. Hmm and maybe you could also look up a preprocessor, I&#39;ve never tried to. You can also simply write boilerplate but generally, and use it in all your instances. To be honest, I&#39;ve instantiated Storable on ADTs just yesterday and I also used hsc2hs, still, it really is pretty horrifying."}], "owner": {"reputation": 1099, "user_id": 1725165, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f45c9108a779695d5ccf44941eea31f0?s=128&d=identicon&r=PG", "display_name": "Zsolt Szatmari", "link": "https://stackoverflow.com/users/1725165/zsolt-szatmari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1448200595, "creation_date": 1448200595, "question_id": 33855562, "link": "https://stackoverflow.com/questions/33855562/how-do-i-export-data-structures-from-haskell-via-ffi", "title": "How do I export data structures from Haskell via FFI?", "body": "<p>I am trying to make a Haskell library, which is meant to be called from other languages, notably C.</p>\n\n<p>For example:</p>\n\n<pre><code>{-# LANGUAGE CPP                         #-}\n{-# LANGUAGE ForeignFunctionInterface    #-}\n\nmodule Example where\n\nimport Foreign.C.String as CString\n\ndata Person = Person { firstName :: CString  \n                      , lastName :: CString }\n\nforeign export ccall entrypoint :: IO (Person)\n\nentrypoint :: IO (Person)\nentrypoint = do\n    first &lt;- newCString \"John\"\n    last &lt;- newCString \"Doe\"\n    return (Person {firstName = first, lastName = last})\n</code></pre>\n\n<p>When I try to compile this:</p>\n\n<pre><code>$ hsc2hs x.hsc &amp;&amp; ghc x.hs\n[1 of 1] Compiling Example          ( x.hs, x.o )\n\nx.hsc:11:1:\n    Unacceptable result type in foreign declaration:\n      \u2018Person\u2019 cannot be marshalled in a foreign call\n    When checking declaration:\n      foreign export ccall \"entrypoint\" entrypoint :: IO (Person)\n</code></pre>\n\n<p>How do I do this, and how do I do this with the least boilerplate possible?</p>\n\n<p>I'd also like to see the C structs autogenerated, something along the lines of:</p>\n\n<pre><code>struct Person {\n   char *firstName;\n   char *lastName;\n};\n</code></pre>\n\n<p>Maybe I am asking too much from the language &amp; tools, but in that case, I'd really like to know what the (best) options are.</p>\n\n<p>Thank You!</p>\n"}, {"tags": ["haskell", "haskell-platform"], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 2588566, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/15eaf9455fc6942b6752da7ca98ec788?s=128&d=identicon&r=PG", "display_name": "Y&#225;bir Garcia", "link": "https://stackoverflow.com/users/2588566/y%c3%a1bir-garcia"}, "edited": false, "score": 0, "creation_date": 1448208605, "post_id": 33856330, "comment_id": 55478217, "body": "Thanks that worked for me. Now I get another error: user error (Development.Shake.command_, system command failed Command: cabal unpack hscolour-1.23 Current directory: /home/yabir/haskell/haskell-platform/build/package/hscolour-&zwnj;&#8203;1.23 cabal: createProcess: runInteractiveProcess: exec: does not exist (No such file or directory)) Can you help me?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 329, "user_id": 2588566, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/15eaf9455fc6942b6752da7ca98ec788?s=128&d=identicon&r=PG", "display_name": "Y&#225;bir Garcia", "link": "https://stackoverflow.com/users/2588566/y%c3%a1bir-garcia"}, "edited": false, "score": 0, "creation_date": 1448209667, "post_id": 33856330, "comment_id": 55478617, "body": "You need the hscolour command in your PATH. Perhaps <code>cabal install hscolour</code>?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 329, "user_id": 2588566, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/15eaf9455fc6942b6752da7ca98ec788?s=128&d=identicon&r=PG", "display_name": "Y&#225;bir Garcia", "link": "https://stackoverflow.com/users/2588566/y%c3%a1bir-garcia"}, "edited": false, "score": 0, "creation_date": 1448209782, "post_id": 33856330, "comment_id": 55478652, "body": "Btw - why are you building the Haskell Platform? You can download a precompiled version for Linux, OS X and Windows - that&#39;s what most people do."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 0, "last_activity_date": 1448205186, "creation_date": 1448205186, "answer_id": 33856330, "question_id": 33855506, "link": "https://stackoverflow.com/questions/33855506/error-when-installing-haskell-platform-from-source/33856330#33856330", "title": "Error when installing haskell-platform from source", "body": "<p>When using the <code>./platform.sh</code> script you can't pass a build option like <code>-j 3</code>.</p>\n\n<p>Try building and running hptool manually like this:</p>\n\n<pre><code>cd hptool\ncabal sandbox init\ncabal install -j3\n\ncd ..\n./hptool/.cabal-sandbox/bin/hptool PATH-TO-GHC-BINDIST SHAKE-TARGET\n</code></pre>\n\n<p>Run hptool with no arguments to get a list of valid values for SHAKE-TARGET.</p>\n"}], "owner": {"reputation": 329, "user_id": 2588566, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/15eaf9455fc6942b6752da7ca98ec788?s=128&d=identicon&r=PG", "display_name": "Y&#225;bir Garcia", "link": "https://stackoverflow.com/users/2588566/y%c3%a1bir-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 33856330, "answer_count": 1, "score": 0, "last_activity_date": 1448205186, "creation_date": 1448200306, "question_id": 33855506, "link": "https://stackoverflow.com/questions/33855506/error-when-installing-haskell-platform-from-source", "title": "Error when installing haskell-platform from source", "body": "<p>I need to install from source files the haskell platform so as indicated in the instructions installed cabal, ghc and other libraries for Ubuntu that are needed. </p>\n\n<p>When I try to install the haskell platform with the command:</p>\n\n<pre><code>./platform.sh /home/myuser/haskell/ghc-7.10.2-x86_64-unknown-linux-deb7.tar.bz2 -j 3\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>***\n*** Building hptool\n***\nBuilding hptool-0.1...\nPreprocessing executable 'hptool' for hptool-0.1...\n***\n*** Running hptool\n***\nError when running Shake build system:\n* 3\nError, file does not exist and no rule available:\n  3\n</code></pre>\n\n<p>and I don't find anyone with same error. The haskell platform version that I have downloaded is haskell-platform-7.10.2-a</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1448211381, "post_id": 33855161, "comment_id": 55479302, "body": "What have you tried? It looks from the GHC source like you should be able to just give a <code>.ll</code> file on the command line and it will be compiled and linked with the rest of your program or library."}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1448198097, "creation_date": 1448198097, "question_id": 33855161, "link": "https://stackoverflow.com/questions/33855161/passing-llvm-assembly-into-ghc", "title": "Passing LLVM Assembly into GHC", "body": "<p>I've passed \".cmm\" files into GHC and called C-- functions from my my \".hs\" file via a foreign import. I'd like to instead pass LLVM assembly files and similarly call functions in them. I would then assume the LLVM compiler would put both of these files together, generating nice machine code. Is this possible with GHC, and if so how? Answer here with simple example or link to a documentation or tutorial is fine.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448193869, "post_id": 33854333, "comment_id": 55473225, "body": "thanx! i did not see that. Well I guess it doen&#39;t work at all with a&lt;b. i tried everything, most I got was the biggest element of the list.Or Is the idea with foldl utterly poppycock?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448215996, "post_id": 33854333, "comment_id": 55481083, "body": "@letter The issue with folds is that they handle only one element at a time, which is troublesome in this case since you need two. There are ways to workaround that (e.g. building a function as the result of the fold, instead of a plain boolean), but they are cumbersome IMHO compared to plain recursion. If you really have to fold this, start by pairing adjacent elements as in <code>zip xs (tail xs)</code>, and then fold."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1448193501, "last_edit_date": 1448193501, "creation_date": 1448192347, "answer_id": 33854333, "question_id": 33854248, "link": "https://stackoverflow.com/questions/33854248/coulnt-match-expected-type-with-list-sorting/33854333#33854333", "title": "couln&#39;t match expected type with list sorting", "body": "<p>Hint 1: the third argument of <code>foldl</code> must be a list, and <code>a</code> is not.</p>\n\n<p>Hint 2: Using your fold,</p>\n\n<pre><code>foldl (\\a b -&gt; a &lt; b) base [1,2,3]\n= (((base &lt; 1) &lt; 2) &lt; 3)\n</code></pre>\n\n<p>and something is wrong here: the result of <code>base &lt; 1</code> is a boolean, and we can't compare that with <code>2</code> afterwards.</p>\n\n<p>So, your function <code>\\a b -&gt; a &lt; b</code> looks wrong in this context: it has the wrong type.</p>\n"}, {"comments": [{"owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448196194, "post_id": 33854571, "comment_id": 55473884, "body": "What do &#39;$&#39; and &#39;cur&#39; stand for?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448196683, "post_id": 33854571, "comment_id": 55474026, "body": "ok sorry (should not have used <code>$</code>) - it&#39;s really simple: <code>f $ x = f (x)</code> it will just let me be lazy and use fewer <code>(...)</code> - <code>cur</code> are the elements of your list that <code>foldl</code> will <i>show</i>  you (I choose the name to stand for <i>current element * - see: *previous</i>  and <i>current</i> ;))"}, {"owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448230677, "post_id": 33854571, "comment_id": 55486308, "body": "Finally, I know what $ means. I saw it everywhere ;). And I am really sorry to ask,but what means sorted, &#39;&lt;=&#39; and the syntax with (True,x)?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448256643, "post_id": 33854571, "comment_id": 55492611, "body": "<code>sorted</code> just like <code>cur</code> is just a name of the anonymous function&#39;s argument for the <code>fold</code> - it&#39;s here used to keep track of if the list was sorted to this point - you did the very same ... <code>&lt;=&#180; means </code>smaller or equal` ... well you used <code>&lt;</code> so I kindof expected you to know this (how much about Haskell/Programming to you know anyways?), <code>(True,x)</code> is a tuple consisting of the value <code>True</code> and <code>x</code> the first saying: hey a list with one element is sorted and the second being the head of your list (as indicated by your own code: <code>(x:xs)</code>)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 0, "last_activity_date": 1448201086, "last_edit_date": 1448201086, "creation_date": 1448194064, "answer_id": 33854571, "question_id": 33854248, "link": "https://stackoverflow.com/questions/33854248/coulnt-match-expected-type-with-list-sorting/33854571#33854571", "title": "couln&#39;t match expected type with list sorting", "body": "<p>Ok I will try to give you some help of how you can do it.</p>\n\n<p>First you should observe, that in order to check if a list is sorted you usually compare consecutive elements and check for example if they are ascending or not - note that you have to use <em>two consecutive</em> elements.</p>\n\n<p>Now <code>foldl</code> and <code>foldr</code> let you only see one of them at a time - so you probably have to <em>remember</em> the <em>previous</em> element you saw somehow - and the only place to do this is to include it somehow in your state.</p>\n\n<p>This can be done in various ways but I would recommend <em>tuples</em>.</p>\n\n<p>So instead of the state being <em>is the list sorted so far</em>  I would but in a tuple <em>(is the list sorted so far, previous element)</em>.</p>\n\n<p>Here is a simple template you have to fill with a few things:</p>\n\n<pre><code>isSorted :: Ord a =&gt; [a] -&gt; Bool\nisSorted (x:xs) = _A (foldl (\\ (sorted,prev) cur -&gt; (_B, _C)) (_D, _E) (_F))\n</code></pre>\n\n<p>if you try this this will not compile because you have to think about some <strong>holes</strong> (if you load it GHC(i) will help you with the types):</p>\n\n<ul>\n<li><code>_E</code>,<code>_F</code> should have type <code>a</code> and <code>[a]</code> respectively, <em>hint</em> <code>_E</code> should be the first <em>previous</em> element you saw - as checking this predicate for empty lists is useless you can probably use <code>xs</code> and <code>x</code> somehow ;)</li>\n<li><code>_D</code> should have type <code>Bool</code></li>\n<li><code>_C</code> should have type <code>a</code> and be your next <em>previous</em> element</li>\n<li><code>_B</code> should have type <code>Bool</code> - this is where the <strong>flesh</strong> is - basically what you already tried</li>\n<li><code>_A</code> should have type <code>(Bool, a) -&gt; Bool</code> you'll figure it out.</li>\n</ul>\n\n<p>I will give the solution in an hour or so to make this answer complete - but you should really try to do it by yourself</p>\n\n<hr>\n\n<h2>solution</h2>\n\n<pre><code>isSorted :: Ord a =&gt; [a] -&gt; Bool\nisSorted []     = True\nisSorted (x:xs) = fst (foldl\n                  (\\ (sorted,prev) cur -&gt; (sorted &amp;&amp; prev &lt;= cur, cur))\n                  (True, x)\n                  xs)\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1448201086, "creation_date": 1448191718, "last_edit_date": 1448191990, "question_id": 33854248, "link": "https://stackoverflow.com/questions/33854248/coulnt-match-expected-type-with-list-sorting", "title": "couln&#39;t match expected type with list sorting", "body": "<p>we have to write a code with an higher-order function. It should be just one sentence long.\nA given list will be checked, if it is sorted.\nSo far, I have this:</p>\n\n<pre><code>compare (a:xs) = foldl (\\a b -&gt; a &lt; b ) True a xs || foldl (\\a b -&gt; a &gt; b ) True\n</code></pre>\n\n<p>I alway get the error message: couln't match expected type bool witch actual type t0 Bool -> Bool. what does that mean?</p>\n"}, {"tags": ["haskell", "applicative"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1448180570, "post_id": 33852781, "comment_id": 55469980, "body": "<a href=\"https://www.haskell.org/hoogle/?hoogle=Applicative\" rel=\"nofollow noreferrer\">Hoogling &quot;Applicative&quot;</a> leads to this <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/src/GHC.Base.html#line-307\" rel=\"nofollow noreferrer\"><code>instance Monoid a =&gt; Applicative ((,) a)</code> definition</a> but for lists it&#39;s <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/src/GHC.Base.html#line-717\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 5, "creation_date": 1448180952, "post_id": 33852781, "comment_id": 55470046, "body": "<code>[[Char], a -&gt; a]</code>, or more generally <code>[a,b]</code> is not a list in haskell."}, {"owner": {"reputation": 105, "user_id": 5496598, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/541610289324111/picture?type=large", "display_name": "yuanqili", "link": "https://stackoverflow.com/users/5496598/yuanqili"}, "reply_to_user": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 0, "creation_date": 1448181952, "post_id": 33852781, "comment_id": 55470254, "body": "Oh thanks, my stupid. @Franky"}, {"owner": {"reputation": 105, "user_id": 5496598, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/541610289324111/picture?type=large", "display_name": "yuanqili", "link": "https://stackoverflow.com/users/5496598/yuanqili"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1448182133, "post_id": 33852781, "comment_id": 55470292, "body": "Thanks, that&#39;s solves the problem. But it&#39;s there any reason that defining list and tuple&#39;s Applicative in such ways? Or just a convention. @WillNess"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1448191269, "last_edit_date": 1448191269, "creation_date": 1448182700, "answer_id": 33853144, "question_id": 33852781, "link": "https://stackoverflow.com/questions/33852781/different-behaviors-of-applicative-on-tuples-and-lists-in-haskell/33853144#33853144", "title": "Different behaviors of Applicative on tuples and lists in Haskell", "body": "<p>The difference lies in the fact that lists are <em>homogeneous</em>, while tuple are not: lists contain only elements of the same type, while tuples do not have to.</p>\n\n<p>Even without looking at applicatives, functors already show a main difference:</p>\n\n<pre><code>fmap succ [1,2,3]  ==&gt; [2,3,4]\nfmap succ (\"a\", 4) ==&gt; ???\n</code></pre>\n\n<p>It would be illogical to argue that <code>fmap</code> applies <code>succ</code> to <code>\"a\"</code>. What happens is that only the <em>second</em> component gets affected:</p>\n\n<pre><code>fmap succ (\"a\", 4) ==&gt; (\"a\", 5)\n</code></pre>\n\n<p>Indeed, look at the instances:</p>\n\n<pre><code>instance Functor [] where ...\ninstance Functor ((,) a) where ...\n</code></pre>\n\n<p>Notice the <code>a</code> type. In the list instance, <code>[]</code> takes only one type parameter, and that's the type affected by <code>fmap</code>. In <code>(,)</code> we have <em>two</em> type parameters: one is fixed (to <code>a</code>) and does not change when applying <code>fmap</code> -- only the second one does.</p>\n\n<p>Note that it would be theoretically possible to admit an instance of <code>Functor (,)</code> when both type arguments are forced to be the same. E.g., </p>\n\n<pre><code>instance Functor (\\b -&gt; (b,b)) where ...\n</code></pre>\n\n<p>but Haskell does not allow this. If needed, one needs a newtype wrapper:</p>\n\n<pre><code>newtype P b = P (b,b)\ninstance Functor P where\n   fmap f (P (x,y)) = P (f x, f y)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1448183796, "last_edit_date": 1448183796, "creation_date": 1448183454, "answer_id": 33853223, "question_id": 33852781, "link": "https://stackoverflow.com/questions/33852781/different-behaviors-of-applicative-on-tuples-and-lists-in-haskell/33853223#33853223", "title": "Different behaviors of Applicative on tuples and lists in Haskell", "body": "<p>An Applicative is whatever combination of a datatype and of definitions of <code>pure</code> and <code>&lt;*&gt;</code> that satisfies the <a href=\"https://wiki.haskell.org/Typeclassopedia#Laws_2\" rel=\"nofollow\">applicative</a> <a href=\"http://blog.ezyang.com/2012/08/applicative-functors/\" rel=\"nofollow\">laws</a>:</p>\n\n<pre><code>    [identity] pure id &lt;*&gt; v = v\n [composition] pure (.) &lt;*&gt; u &lt;*&gt; v &lt;*&gt; w = u &lt;*&gt; (v &lt;*&gt; w)\n[homomorphism] pure f &lt;*&gt; pure x = pure (f x)\n [interchange] u &lt;*&gt; pure y = pure ($ y) &lt;*&gt; u\n</code></pre>\n\n<p>These laws ensure that <code>&lt;*&gt;</code> behaves very much like function application, but one taking place in some kind of \"special context\" that depends on the Applicative. For the case of <code>Maybe</code> the context is the possible absence of value. For tuples, the context is \"monoidal annotations that accompany each value\".</p>\n\n<p><code>pure</code> and <code>&lt;*&gt;</code> can do very different things for different datatypes as long as they respect the laws.</p>\n\n<p>In fact, the <em>same</em> datatype can be an Applicative in different ways. Lists have the Applicative instance in which <code>&lt;*&gt;</code> \"obtains all combinations\", but also the instance implemented with the auxiliary <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Applicative.html#t:ZipList\" rel=\"nofollow\"><code>ZipList</code></a> newtype, where <code>&lt;*&gt;</code> zips lists together and <code>pure</code> constructs an infinite list.</p>\n"}], "owner": {"reputation": 105, "user_id": 5496598, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/541610289324111/picture?type=large", "display_name": "yuanqili", "link": "https://stackoverflow.com/users/5496598/yuanqili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 603, "favorite_count": 0, "accepted_answer_id": 33853144, "answer_count": 2, "score": 4, "last_activity_date": 1448191269, "creation_date": 1448179083, "question_id": 33852781, "link": "https://stackoverflow.com/questions/33852781/different-behaviors-of-applicative-on-tuples-and-lists-in-haskell", "title": "Different behaviors of Applicative on tuples and lists in Haskell", "body": "<p>For example,</p>\n\n<pre><code>-- Num a =&gt; ([Char], a -&gt; a) &lt;*&gt; ([Char], a)\n&gt; (\"hello \",(*6)) &lt;*&gt; (\"world\",7)\n(\"hello world\",42)\n\n-- Num a =&gt; [a -&gt; a] &lt;*&gt; [a]\n&gt; [(*7),(*6)] &lt;*&gt; [6,7]\n[42,49,36,42]\n\n-- Num a =&gt; [[Char], a -&gt; a] &lt;*&gt; [[Char], a]\n&gt; [\"hello \",(*6)] &lt;*&gt; [\"world\",7]\n&lt;interactive&gt;:17:2:\n    Couldn't match expected type \u2018[Char] -&gt; [Char]\u2019\n                with actual type \u2018[Char]\u2019\n    In the expression: \"hello \"\n    In the first argument of \u2018(&lt;*&gt;)\u2019, namely \u2018[\"hello \", (* 6)]\u2019\n    In the expression: [\"hello \", (* 6)] &lt;*&gt; [\"world\", 7]\n</code></pre>\n\n<p>For three examples, <code>&lt;*&gt;</code> shows different behaviors. What happens? Why in the third case, it expects a <code>[Char] -&gt; [Char]</code> rather than <code>[Char]</code> just like in the first case. What's more, even there's only <code>[Char]</code> in tuples, <code>&lt;*&gt;</code> combines them together.</p>\n"}, {"tags": ["string", "haskell", "filter", "split", "case"], "answers": [{"comments": [{"owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "edited": false, "score": 0, "creation_date": 1448184729, "post_id": 33852684, "comment_id": 55470879, "body": "Ok. But I need more cases, like you see at: <a href=\"http://ix.io/mpl\" rel=\"nofollow noreferrer\">ix.io/mpl</a> ... cause i want to get from &quot;[&amp;test]&quot; the &quot;test&quot; out of it. My example isnt working .. why?"}], "tags": [], "owner": {"reputation": 16397, "user_id": 303939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3f6c98562c6d9bb188eacc2002af257?s=128&d=identicon&r=PG", "display_name": "Ming-Tang", "link": "https://stackoverflow.com/users/303939/ming-tang"}, "is_accepted": true, "score": 4, "last_activity_date": 1448178485, "last_edit_date": 1495541245, "creation_date": 1448178136, "answer_id": 33852684, "question_id": 33852663, "link": "https://stackoverflow.com/questions/33852663/haskell-function-with-split-cases/33852684#33852684", "title": "Haskell Function with &quot;split&quot; cases", "body": "<p>You are trying to match a pattern, but since you are using the <code>| cond = expr</code> notation, you are actually using a guard. Visit this page for more details about guards: <a href=\"https://en.wikibooks.org/wiki/Haskell/Control_structures#if_and_guards_revisited\" rel=\"nofollow noreferrer\">https://en.wikibooks.org/wiki/Haskell/Control_structures#if_and_guards_revisited</a> . <code>| (\"[&amp;\":c:r)</code> actually means \"a list constructed from the string <code>\"[&amp;\"</code> and value <code>c</code> and value <code>r</code>\", and Haskell compiler complains the variables <code>c</code> and <code>r</code> do not exist.</p>\n\n<p>Here is how to define functions with multiple cases:</p>\n\n<pre><code>getBase64 (\"[&amp;\":c:r) = c\ngetBase64 _ = ' '\n</code></pre>\n\n<p>However, this won't work because <code>\"[&amp;\"</code> is a string, and Haskell thinks the first parameter is a list of strings. A string is a list of characters and you need to fix your pattern like this:</p>\n\n<pre><code>getBase64 ('[':'&amp;':c:r) = c\ngetBase64 _ = ' '\n</code></pre>\n\n<p>Look at these examples for more details about pattern matching against characters in a string: <a href=\"https://stackoverflow.com/a/1602296/303939\">https://stackoverflow.com/a/1602296/303939</a> and <a href=\"https://stackoverflow.com/a/3851126/303939\">https://stackoverflow.com/a/3851126/303939</a></p>\n\n<p>Then there is another problem: <code>getBase64</code> returns <code>[Char]</code>. If that's what you intended, your code should be fixed like this:</p>\n\n<pre><code>getBase64 ('[':'&amp;':c:r) = [c]\ngetBase64 _ = \" \"     -- or [' ']\n</code></pre>\n"}], "owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "accepted_answer_id": 33852684, "answer_count": 1, "score": 0, "last_activity_date": 1448178485, "creation_date": 1448177889, "question_id": 33852663, "link": "https://stackoverflow.com/questions/33852663/haskell-function-with-split-cases", "title": "Haskell Function with &quot;split&quot; cases", "body": "<p>How can I make a \"split\"ting case inside an function like this:</p>\n\n<pre><code>getBase64 :: String -&gt; [Char]\ngetBase64 code\n  | (\"[&amp;\":c:r) = c\n  | _          = ' '\n</code></pre>\n\n<p>This is so not working cause:</p>\n\n<pre><code>main.hs:7:11: Not in scope: \u2018c\u2019\n\nmain.hs:7:13: Not in scope: \u2018r\u2019\n\nmain.hs:7:18: Not in scope: \u2018c\u2019\n</code></pre>\n\n<p>The error is clear to me, but I'm a newcommer and don't know how I can do my \"wish\" ...</p>\n\n<p>Thanks for help!</p>\n"}, {"tags": ["haskell", "recurrence"], "comments": [{"owner": {"reputation": 31706, "user_id": 479180, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a6a0fe77d0b255095771224c05db75cc?s=128&d=identicon&r=PG", "display_name": "LuxuryMode", "link": "https://stackoverflow.com/users/479180/luxurymode"}, "edited": false, "score": 0, "creation_date": 1448167053, "post_id": 33851495, "comment_id": 55467567, "body": "Could you describe the computation you&#39;re trying to implement? What&#39;s the recurrence, what is the base case, etc?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1448167462, "post_id": 33851495, "comment_id": 55467649, "body": "Other than a base-case, that code looks fine to me."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1448183973, "post_id": 33851495, "comment_id": 55470709, "body": "due to the first one <code>f (t+1,i+1)</code> it might be really hard to find a base case as it seem to me that both of the arguments/items will grow unbounded"}, {"owner": {"reputation": 85, "user_id": 5556989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaf3b606d2a1e3d83a5498f0f053063f?s=128&d=identicon&r=PG&f=1", "display_name": "Nryan6", "link": "https://stackoverflow.com/users/5556989/nryan6"}, "edited": false, "score": 0, "creation_date": 1448228072, "post_id": 33851495, "comment_id": 55485376, "body": "The problem I&#39;m trying to solve was for a statistics class:   &quot;Assume that we play a game where at each stage we can win one dollar with probability 4/6 and lose one dollar with probability 2/6. We start with four dollars. If we lose all our money we have to stop playing. What is the probability to reach the level of six dollars before time t = 8?&quot;  My base cases are: <code>f(8,_) = 0</code> and <code>f(_,6)=1</code> The answer to the problem is <code>f(0,2)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448184040, "post_id": 33853202, "comment_id": 55470727, "body": "have you tried running this? let&#39;s say with <code>f 1 1</code>? (In GHCi it will not take long to overflow the stack)"}, {"owner": {"reputation": 1025, "user_id": 1439629, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4cfce72158cd5741f0a48e67483b85e8?s=128&d=identicon&r=PG", "display_name": "Hamish", "link": "https://stackoverflow.com/users/1439629/hamish"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448184256, "post_id": 33853202, "comment_id": 55470777, "body": "Thanks, @Carsten not with those args - I didn&#39;t know what his conditions were, so made something simple up to illustrate the idea - I&#39;ve updated the answer now to have another condition :)"}], "tags": [], "owner": {"reputation": 1025, "user_id": 1439629, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4cfce72158cd5741f0a48e67483b85e8?s=128&d=identicon&r=PG", "display_name": "Hamish", "link": "https://stackoverflow.com/users/1439629/hamish"}, "is_accepted": true, "score": 2, "last_activity_date": 1448184137, "last_edit_date": 1448184137, "creation_date": 1448183192, "answer_id": 33853202, "question_id": 33851495, "link": "https://stackoverflow.com/questions/33851495/recurrence-relations-in-haskell/33853202#33853202", "title": "Recurrence relations in haskell", "body": "<p>Haskell defines functions a little differently from other languages - you don't wrap parameters in brackets, instead they are used in a similar way to maths where it means \"do this bit first\". So your function would look a little like this in haskell, where you just need a space between your function name and your variables</p>\n\n<pre><code>f t i = (2/3) * f (t+1) (i+1) + (1/3) * f (t+1) (i-1)\n</code></pre>\n\n<p>Also, to prevent an infinite loop, it's important you create a condition for the recursion to end, for example if you just want to return t when i is zero you can do this (this is a guess, I'm not sure what you'd like your condition to be, you can have more than one)</p>\n\n<pre><code>f t 0 = t\nf 10 _ = 10\nf t i = (2/3) * f (t+1) (i+1) + (1/3) * f (t+1) (i-1)\n</code></pre>\n\n<p>It's also considered good practice to add the function type (normally I would do this as my very first step)</p>\n\n<pre><code>f :: Float -&gt; Float -&gt; Float\nf t 0 = t\nf 10 _ = 10\nf t i = (2/3) * f (t+1) (i+1) + (1/3) * f (t+1) (i-1)\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 5556989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaf3b606d2a1e3d83a5498f0f053063f?s=128&d=identicon&r=PG&f=1", "display_name": "Nryan6", "link": "https://stackoverflow.com/users/5556989/nryan6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 482, "favorite_count": 0, "accepted_answer_id": 33853202, "answer_count": 1, "score": 0, "last_activity_date": 1448184137, "creation_date": 1448165345, "question_id": 33851495, "link": "https://stackoverflow.com/questions/33851495/recurrence-relations-in-haskell", "title": "Recurrence relations in haskell", "body": "<p>I'm new to Haskell and still haven't figured out how to do anything realistic.\nI've looked at examples of recurrence relations but the implementation is too advanced for me at the moment.</p>\n\n<p>I'm trying to set up the recurrence relation:</p>\n\n<pre><code>f(t,i) = (2/3)*f(t+1,i+1) + (1/3)*f(t+1,i-1)\n</code></pre>\n\n<p>but I can't figure out to set my types for the input to f(a,b) or how to define it in general.</p>\n"}, {"tags": ["haskell", "filter"], "answers": [{"comments": [{"owner": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "edited": false, "score": 0, "creation_date": 1448164613, "post_id": 33851427, "comment_id": 55467172, "body": "I was just writing how I think I stumbled upon an answer: <code>myfunc (Temp a) = Temp (filter (&#47;=[]) a)</code>. How is yours different? Dare I ask, which one is &quot;better&quot;?"}, {"owner": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "edited": false, "score": 0, "creation_date": 1448164703, "post_id": 33851427, "comment_id": 55467188, "body": "I think I got it, the <code>(&#47;=[])</code> part in yours is actually a parameter to the function. Haskell is awesome!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448167316, "post_id": 33851427, "comment_id": 55467625, "body": "Have you tested the <code>Functor</code> part of your answer? A few pieces of it seem suspect to me -- the definition as given has the wrong kind to be a <code>Functor</code>, and the &quot;obvious&quot; generalization of <code>data Temp a = Temp [[a]]</code> would not let your proposed expression type-check when <code>example :: Temp Int</code>."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1448168716, "post_id": 33851427, "comment_id": 55467882, "body": "@Danial Wagner - thanks for the reminder about always testing your answer before posting."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1448168662, "last_edit_date": 1448168662, "creation_date": 1448164532, "answer_id": 33851427, "question_id": 33851390, "link": "https://stackoverflow.com/questions/33851390/filter-on-custom-data-type/33851427#33851427", "title": "Filter on custom data type", "body": "<p>Try this:</p>\n\n<pre><code>filterTemp p (Temp lol) = Temp (filter p lol)\n</code></pre>\n\n<p>i.e. - you deconstruct your Temp value t get at the list of lists, and then reconstruct the Temp value with the new list of lists.</p>\n\n<p>(stuff about using a Functor deleted)</p>\n"}], "owner": {"reputation": 24126, "user_id": 368864, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/76e6f95b06ade13607a4dd999f7f72e5?s=128&d=identicon&r=PG", "display_name": "cambraca", "link": "https://stackoverflow.com/users/368864/cambraca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 33851427, "answer_count": 1, "score": 0, "last_activity_date": 1448168662, "creation_date": 1448164144, "last_edit_date": 1448164538, "question_id": 33851390, "link": "https://stackoverflow.com/questions/33851390/filter-on-custom-data-type", "title": "Filter on custom data type", "body": "<p>I have this data type</p>\n\n<pre><code>data Temp = Temp [[Int]]\n            deriving (Show)\n</code></pre>\n\n<p>so, for example:</p>\n\n<pre><code>&gt; let example = Temp [[2,3],[],[5,7,8],[2],[]]\n</code></pre>\n\n<p>How can I filter only the non-empty elements? I know I can do this:</p>\n\n<pre><code>&gt; filter (/=[]) [[2,3],[],[5,7,8],[2],[]]\n[[2,3],[5,7,8],[2]]\n</code></pre>\n\n<p>but trying to filter directly on <code>example</code> gives me an error:</p>\n\n<pre><code>&gt; filter (/=[]) example\nCouldn't match expected type \u2018[[t]]\u2019 with actual type 'Temp'\n</code></pre>\n\n<p>My goal is to write a function that does that filter and returns the new list. How can I do that? (please bear with me, I've just begun learning Haskell)</p>\n"}, {"tags": ["haskell", "recursive-datastructures"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1448167106, "post_id": 33851287, "comment_id": 55467580, "body": "A value is a value; it neither increases nor decreases."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1448184160, "post_id": 33851287, "comment_id": 55470753, "body": "The second argument of <code>add</code> decreases at each recursive call: from <code>Succ n</code> to <code>n</code>."}], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 5, "last_activity_date": 1448401783, "last_edit_date": 1448401783, "creation_date": 1448202719, "answer_id": 33855916, "question_id": 33851287, "link": "https://stackoverflow.com/questions/33851287/natural-numbers-as-a-recursive-datatype/33855916#33855916", "title": "Natural numbers as a recursive datatype", "body": "<p>In usual math notation, <code>Zero</code> is <code>0</code> and <code>Succ</code> is <code>1 +</code>. So:</p>\n\n<pre><code>add m Zero = m\n</code></pre>\n\n<p>Is saying <code>m + 0 = m</code>, and:</p>\n\n<pre><code>add m (Succ n) = Succ (add m n)\n</code></pre>\n\n<p>Is saying <code>m + (1 + n) = 1 + (m + n)</code>. So at every recursive call, the second argument to <code>+</code> decreases by 1, down to the base case of 0. For example, say we want to compute <code>2 + 3</code>:</p>\n\n<pre><code>                  add (Succ (Succ Zero)) (Succ (Succ (Succ Zero)))\nSucc             (add (Succ (Succ Zero))       (Succ (Succ Zero)))\nSucc (Succ       (add (Succ (Succ Zero))             (Succ Zero)))\nSucc (Succ (Succ (add (Succ (Succ Zero))                   Zero)))\nSucc (Succ (Succ      (Succ (Succ Zero))))\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>                  add two three\nSucc             (add two two)\nSucc (Succ       (add two one))\nSucc (Succ (Succ (add two Zero)))\nSucc (Succ (Succ      two))\nfive\n</code></pre>\n\n<p>Given:</p>\n\n<pre><code>one = Succ Zero\ntwo = Succ one\nthree = Succ two\nfour = Succ three\nfive = Succ four\n</code></pre>\n\n<p>You can also think of the <code>Natural</code> type as a linked list containing no values, where the length denotes a number. Then <code>+</code> is just concatenation of those lists.</p>\n"}], "owner": {"reputation": 21, "user_id": 2387611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/728ad3e55962eb60499f627c0479ce8e?s=128&d=identicon&r=PG", "display_name": "0908", "link": "https://stackoverflow.com/users/2387611/0908"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1448401783, "creation_date": 1448162785, "last_edit_date": 1448164502, "question_id": 33851287, "link": "https://stackoverflow.com/questions/33851287/natural-numbers-as-a-recursive-datatype", "title": "Natural numbers as a recursive datatype", "body": "<p>I have started working with datatypes but I am getting confused with the following:</p>\n\n<pre><code>data Natural = Zero | Succ Natural\n\nadd :: Natural -&gt; Natural -&gt; Natural\n\nadd m Zero = m\n\nadd m (Succ n) = Succ (add m n)\n</code></pre>\n\n<p>How is this the addition working. I understood that <code>Natural 3</code> is represented by <code>Succ(Succ(Succ 0)))</code> though this is still not 100% clear to me that is the value decreasing on its own or what. I want to understand addition of step by step.</p>\n\n<p>P.S: This was taken from the book Introduction to Functional Programming by Richard Bird.</p>\n"}, {"tags": ["json", "parsing", "haskell", "monads", "aeson"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1448161937, "post_id": 33851142, "comment_id": 55466823, "body": "What is your test code that demonstrates the space leak?"}, {"owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1448162225, "post_id": 33851142, "comment_id": 55466863, "body": "It might be a lot to compile, but it&#39;s from <a href=\"https://github.com/athanclark/contact-logger/blob/4250c8f36452934b96044918e5f5321237f45883/src/Application/Api.hs#L215\" rel=\"nofollow noreferrer\">this repository</a> - if you <code>:set -XOverloadedStrings</code> and <code>import Application.Api</code> in ghci, and run <a href=\"http://lpaste.net/145756\" rel=\"nofollow noreferrer\">this attempt to parse</a>, your computer will bloat.  <b>Edit</b>: This assumes you are running GHC &gt;= 7.10"}, {"owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1448163063, "post_id": 33851142, "comment_id": 55466959, "body": "Another edit: <a href=\"http://lpaste.net/145756\" rel=\"nofollow noreferrer\">a more precise attempt to parse</a>"}, {"owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1448163875, "post_id": 33851142, "comment_id": 55467055, "body": "I actually had some incorrect logic - it should be <code>notElem</code>, not <code>elem</code>. However, <a href=\"https://github.com/athanclark/contact-logger/blob/805c636da1cbc663fbd4ff74c7975755d36134e8/src/Application/Api.hs#L215\" rel=\"nofollow noreferrer\">this commit</a> and <a href=\"http://lpaste.net/145756\" rel=\"nofollow noreferrer\">this input</a> (after <code>:set -XOverloadedStrings</code>) is still causing the leak.  An interesting attempt I made was to use the <code>Parser</code> monad to first get <code>optional&#39;</code>&#39;s results <i>first</i>, but this caused the entire decode to fail."}, {"owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1448164307, "post_id": 33851142, "comment_id": 55467126, "body": "<a href=\"https://github.com/athanclark/contact-logger/blob/1a5b91744ed6760c76c93f5c4be49b70f9668ff1/src/Application/Api.hs#L215\" rel=\"nofollow noreferrer\">Here&#39;s yet another approach</a>, just to get shot down by the same issue :\\"}, {"owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1448164791, "post_id": 33851142, "comment_id": 55467202, "body": "I also just noticed that <i>all</i> these implementations also fail to parse <a href=\"http://lpaste.net/145758\" rel=\"nofollow noreferrer\">this input as well</a> - a basic example of retrieving the &quot;rest&quot; of the key/values.  So, the parser fails to use <code>many</code> with <code>(&lt;|&gt;)</code>, and fails to catch the rest."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1448168059, "post_id": 33851142, "comment_id": 55467763, "body": "Could you please try to prepare a minimalistic example that demonstrates the issue? A self-contained piece of code, a single Haskell file, that can be posted in the question? See <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> and <a href=\"http://sscce.org/\" rel=\"nofollow noreferrer\">Short, Self Contained, Correct (Compilable), Example</a>."}], "answers": [{"comments": [{"owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "edited": false, "score": 0, "creation_date": 1448168799, "post_id": 33851739, "comment_id": 55467890, "body": "This is actually an incorrect implementation - although the variable name usage was misleading, all of the <code>&quot;firstName&quot;</code> etc. fields are <i>optional</i>. I have made a working solution <a href=\"https://github.com/athanclark/contact-logger/blob/e8f293000f64cfc8964a88367dd162695dbbb163/src/Application/Api.hs#L208\" rel=\"nofollow noreferrer\">here (finally)</a> - I needed to use <code>(.:?)</code> to get the optional <i>known</i> fields, then manually decompose the &quot;rest&quot; structure, and reparse the <code>Maybe String</code> sub-fields with a <code>mapM</code>."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1448169899, "last_edit_date": 1448169899, "creation_date": 1448168152, "answer_id": 33851739, "question_id": 33851142, "link": "https://stackoverflow.com/questions/33851142/parsing-the-rest-of-an-aeson-object/33851739#33851739", "title": "Parsing &quot;the rest&quot; of an aeson object", "body": "<p>For your PartialAppContact example here is a more mundane approach which seems to work:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings, QuasiQuotes #-}\n\nimport Data.Aeson\nimport qualified Data.Text as T\nimport qualified Data.HashMap.Strict  as HM\nimport Control.Monad\nimport Text.Heredoc\n\ntype RequiredField = String\ntype OptionalField = String\n\ndata PartialAppContact = PartialAppContact\n  { partialAppContactRequired :: [(RequiredField, String)]\n  , partialAppContactOptional :: [(OptionalField, Maybe String)]\n  } deriving (Show, Eq)\n\ninstance FromJSON PartialAppContact where\n  parseJSON (Object o) = do\n    let required = [ \"firstName\", \"lastName\", \"email\", \"phoneNumber\" ]\n    reqPairs &lt;- forM required $ \\k -&gt; do\n      v &lt;- o .: k\n      s &lt;- parseJSON v\n      return (T.unpack k, s)\n    nonReqPairs &lt;- forM [ (k,v) | (k,v) &lt;- HM.toList o, k `notElem` required ] $ \\(k,v) -&gt; do\n      s &lt;- parseJSON v\n      return (T.unpack k, s)\n    return $ PartialAppContact reqPairs nonReqPairs\n\ntest1 = Data.Aeson.eitherDecode \"{\\\"firstName\\\":\\\"Athan'\\\"}\" :: Either String PartialAppContact\n\ninput = [str|\n| { \"firstName\": \"a first name\"\n| , \"lastName\": \"a last name\"\n| , \"email\": \"asasd@asd.com\"\n| , \"phoneNumber\": \"123-123-123\"\n| , \"another field\": \"blah blah\" }\n|]\n\ntest2 = Data.Aeson.eitherDecode \"{\\\"firstName\\\":\\\"Athan'\\\" }\" :: Either String PartialAppContact\n\ntest3 = Data.Aeson.eitherDecode input :: Either String PartialAppContact\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>Based on your comments, consider this idea for writing the instance:</p>\n\n<pre><code>import Data.List (partition)\n\ninstance FromJSON PartialAppContact where\n  parseJSON (Object o) = do\n    let required = [ \"firstName\", \"lastName\", \"email\", \"phoneNumber\" ]\n    let (group1, group2) = partition (\\(k,_) -&gt; k `elem` required) (HM.toList o)\n    reqFields   &lt;- forM group1 $ \\(k,v) -&gt; do s &lt;- parseJSON v; return (T.unpack k, s)\n    otherFields &lt;- forM group2 (\\(k,v) -&gt; (T.unpack k,) &lt;$&gt; parseJSON v)\n    return $ PartialAppContact reqFields otherFields\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "is_accepted": false, "score": 0, "last_activity_date": 1448169088, "creation_date": 1448169088, "answer_id": 33851834, "question_id": 33851142, "link": "https://stackoverflow.com/questions/33851142/parsing-the-rest-of-an-aeson-object/33851834#33851834", "title": "Parsing &quot;the rest&quot; of an aeson object", "body": "<p>I found a working implementation requires the use of <code>(.:?)</code>, to correctly implement <em>optional, known</em> fields. From there, you can freely decompose the HashMap and re-<code>parseJSON</code> it's subfields:</p>\n\n<pre><code>instance FromJSON Foo where\n  parseJSON (Object o) = do\n    mfoo &lt;- o .:? \"foo\"\n    mbar &lt;- o .:? \"bar\"\n    let foundFields = catMaybes [mfoo, mbar]\n    rest &lt;- mapM (\\(k,v) -&gt; (T.unpack k,) &lt;$&gt; parseJSON v) \n              (toList theRest)\n    return $ Foo rest -- assuming you're done with `foundFields`\n    where\n      theRest = foldr HM.delete o [\"foo\", \"bar\"]\n</code></pre>\n\n<p>To see the final implementation of the issue discussed in the comments, <a href=\"https://github.com/athanclark/contact-logger/blob/e8f293000f64cfc8964a88367dd162695dbbb163/src/Application/Api.hs#L208\" rel=\"nofollow\">see this commit</a>.</p>\n"}], "owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 33851739, "answer_count": 2, "score": 0, "last_activity_date": 1448169899, "creation_date": 1448161047, "question_id": 33851142, "link": "https://stackoverflow.com/questions/33851142/parsing-the-rest-of-an-aeson-object", "title": "Parsing &quot;the rest&quot; of an aeson object", "body": "<p>for some reason I can't wrap my head around arbitrarilly successful parses in Aeson, without making the whole system bork and cause a space leak.</p>\n\n<p>Here's my issue:</p>\n\n<pre><code>newtype Foo = Foo\n  { getFoo :: [(String, Maybe String)]\n  } deriving (Show, Eq)\n\ninstance ToJSON Foo where\n  toJSON (Foo xs) = object $\n    map (\\(k,mv) -&gt; T.pack k .= mv) xs\n</code></pre>\n\n<p>so far, encoding a <code>Foo</code> is fine and dandy. But, I want to make a parser that <em>rejects</em> a couple of keys, if they exist. Right now, I have a pseudo-rejection going on, and that's why I think I'm getting a bad outcome:</p>\n\n<pre><code>import qualified Data.HashMap as HM\n\n-- the \"duck-tape and chewing gum\" approach\ninstance FromJSON Foo where\n  parseJSON (Object o) = Foo &lt;$&gt; parseJSON (Object theRest)\n    where\n      theRest = foldr HM.delete o [ \"foo\"\n                                  , \"bar\"\n                                  ]\n  parseJSON _ = empty\n</code></pre>\n\n<p>This version is what caused me to think that manipulating the internal object was incorrect, because the parser may be getting \"more\" data in the HashMap, outside of the parser (because of the lazy bytestring being fed into it), but I am clearly not sure about this. So, I tried a different approach:</p>\n\n<pre><code>instance FromJSON Foo where\n  parseJSON (Object o) =\n    (Foo . filter (\\(k,_) -&gt; k `elem` toIgnore)) &lt;$&gt;\n      parseJSON (Object o)\n    where\n      toIgnore = [\"foo\", \"bar\"]\n  parseJSON _ = empty\n</code></pre>\n\n<p>But this <em>also</em> seems to cause a deadlock / space leak (not sure exactly what to diagnose this halting of execution). What would be the advised way to accept everything <em>except</em> a few keys of the object? I need to pattern-match on the <code>(Object o)</code> structure because I'm manually looking up <code>o .: \"foo\"</code> and <code>o .: \"bar\"</code> in a different component for my data type. Ideally, I would like to just <em>remove</em> those keys from the content and continue parsing, because I <strong>already accounted for them</strong> (hence - \"the rest\").</p>\n\n<p>Is there any hope?</p>\n"}, {"tags": ["list", "haskell", "filter"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1448146412, "post_id": 33849464, "comment_id": 55463631, "body": "This is very unclear: <code>map (filter (==2))</code> fits the description, yet you might be looking for something different. You should add some examples of expected input/output, at least."}, {"owner": {"reputation": 101, "user_id": 4748137, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100001694230148/picture?type=large", "display_name": "Danny", "link": "https://stackoverflow.com/users/4748137/danny"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1448146691, "post_id": 33849464, "comment_id": 55463729, "body": "Ah excellent that does work for my first problem- give me 2 seconds and I&#39;ll edit the question for expected output!"}, {"owner": {"reputation": 397, "user_id": 5334460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6d3eb29fba44333b64e516e53717c16?s=128&d=identicon&r=PG&f=1", "display_name": "AleArk", "link": "https://stackoverflow.com/users/5334460/aleark"}, "edited": false, "score": 0, "creation_date": 1448148277, "post_id": 33849464, "comment_id": 55464183, "body": "Still unclear what you want."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4748137, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100001694230148/picture?type=large", "display_name": "Danny", "link": "https://stackoverflow.com/users/4748137/danny"}, "edited": false, "score": 0, "creation_date": 1448148463, "post_id": 33849720, "comment_id": 55464232, "body": "Yes thats what I&#39;m after- sorry for the poor wording."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1448155425, "post_id": 33849720, "comment_id": 55465719, "body": "This will fail if there is an empty list.  Might I suggest <code>filter (==2)  . concatMap (take 1)</code>."}], "tags": [], "owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "is_accepted": true, "score": 1, "last_activity_date": 1448156541, "last_edit_date": 1448156541, "creation_date": 1448147471, "answer_id": 33849720, "question_id": 33849464, "link": "https://stackoverflow.com/questions/33849464/checking-the-heads-of-lists-of-lists/33849720#33849720", "title": "Checking the heads of lists of lists", "body": "<p>Maybe <code>filter (==2) $ map (head) [[2,2,2],[1,2,3],[2,2,3]]</code> ? But still the problem is very ambiguously stated.</p>\n\n<p>Output:\n<code>[2,2]</code></p>\n\n<p>EDIT:\nAs Thomas M. DuBuisson said head returns error when the list is empty according to its definition: </p>\n\n<pre><code>badHead :: a\nbadHead = errorEmptyList \"head\"\n\nhead []                 =  badHead\n</code></pre>\n\n<p>whereas <code>take !_  []     = []</code>.</p>\n"}], "owner": {"reputation": 101, "user_id": 4748137, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100001694230148/picture?type=large", "display_name": "Danny", "link": "https://stackoverflow.com/users/4748137/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 33849720, "answer_count": 1, "score": -2, "last_activity_date": 1448156541, "creation_date": 1448145750, "last_edit_date": 1448151544, "question_id": 33849464, "link": "https://stackoverflow.com/questions/33849464/checking-the-heads-of-lists-of-lists", "title": "Checking the heads of lists of lists", "body": "<p>I'm trying to write a function that filters on a list of lists however I can't manage to work out how. My first question of course is how to filter a list of lists</p>\n\n<pre><code>[[2,2,2],[1,2,3],[2,2,3]]\nfilter (==2)\n</code></pre>\n\n<p>The second thing I'm trying to work out is how to only filter the Head of each of the lists.</p>\n\n<p>Eg for the above filter, I would expect an output of 2 from the first list, and 2 from the third list.\nAny help would be much appreciated. </p>\n\n<p>Cheers. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 1, "creation_date": 1448140981, "post_id": 33848657, "comment_id": 55462001, "body": "<a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:splitAt\" rel=\"nofollow noreferrer\">splitAt</a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1448143046, "post_id": 33848657, "comment_id": 55462614, "body": "<a href=\"http://hackage.haskell.org/package/split-0.2.2/docs/Data-List-Split.html#v:splitPlaces\" rel=\"nofollow noreferrer\"><code>splitPlaces</code></a>"}, {"owner": {"reputation": 130, "user_id": 5112919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d11c7178696614975ee6140c61e9ebe6?s=128&d=identicon&r=PG&f=1", "display_name": "Nowandthen98", "link": "https://stackoverflow.com/users/5112919/nowandthen98"}, "edited": false, "score": 0, "creation_date": 1448144064, "post_id": 33848657, "comment_id": 55462944, "body": "splitPlaces seems to be perfect. I&#39;m using it in a later function. Any idea how I would access each sublist individually when assigning them?"}], "answers": [{"comments": [{"owner": {"reputation": 130, "user_id": 5112919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d11c7178696614975ee6140c61e9ebe6?s=128&d=identicon&r=PG&f=1", "display_name": "Nowandthen98", "link": "https://stackoverflow.com/users/5112919/nowandthen98"}, "edited": false, "score": 0, "creation_date": 1448141838, "post_id": 33848735, "comment_id": 55462241, "body": "I understand how this would work for the first sublist; and the last. But how exactly would I use this to get the items at indexes 10-20?"}], "tags": [], "owner": {"reputation": 178, "user_id": 4556658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176748782a450651ab1ef750943e5f35?s=128&d=identicon&r=PG&f=1", "display_name": "sdx23", "link": "https://stackoverflow.com/users/4556658/sdx23"}, "is_accepted": false, "score": 1, "last_activity_date": 1448143955, "last_edit_date": 1448143955, "creation_date": 1448141012, "answer_id": 33848735, "question_id": 33848657, "link": "https://stackoverflow.com/questions/33848657/splitting-a-list-into-uneven-sub-lists/33848735#33848735", "title": "Splitting a list into uneven sub-lists", "body": "<p>A fitting combination of </p>\n\n<pre><code>splitAt :: Int -&gt; [a] -&gt; ([a], [a])\n</code></pre>\n\n<p>and </p>\n\n<pre><code>snd :: (a, b) -&gt; b\n</code></pre>\n\n<p>should do the trick.</p>\n\n<p>EDIT:</p>\n\n<pre><code>splitUp :: [Int] -&gt; [a] -&gt; [[a]]\nsplitUp [] xs = [xs]\nsplitUp _ [] = []\nsplitUp (l:ls) xs = let (a,b) = splitAt l xs in a : splitUp ls b \n</code></pre>\n"}], "owner": {"reputation": 130, "user_id": 5112919, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d11c7178696614975ee6140c61e9ebe6?s=128&d=identicon&r=PG&f=1", "display_name": "Nowandthen98", "link": "https://stackoverflow.com/users/5112919/nowandthen98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448144278, "creation_date": 1448140499, "last_edit_date": 1448144278, "question_id": 33848657, "link": "https://stackoverflow.com/questions/33848657/splitting-a-list-into-uneven-sub-lists", "title": "Splitting a list into uneven sub-lists", "body": "<p>I'm attempting to split a list of 50 items into different sized sub-lists; e.g. 3 of 10, 4 of 5. </p>\n\n<p>I tried doing this using <code>take</code> but this just takes the first few items in the list repeatedly rather than moving along by index.</p>\n\n<p>Does anyone have any advice on how to do this? Or can link me to a Prelude/Data.List function which may aid me. (I have looked around but I am struggling to find anything.)</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1452806292, "post_id": 34796209, "comment_id": 57343041, "body": "does this set <code>-O2</code> ? how"}, {"owner": {"reputation": 271, "user_id": 2925208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8cc2e6c8da46e3eb9be370b90d5fe06?s=128&d=identicon&r=PG&f=1", "display_name": "axm", "link": "https://stackoverflow.com/users/2925208/axm"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1461179184, "post_id": 34796209, "comment_id": 61086102, "body": "No - I would not think so - why would it? I would set this in the .cabal file, but there is probably a stack option for that, too."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1461250706, "post_id": 34796209, "comment_id": 61123802, "body": "Because it&#39;s a good practice to profile optimised version of the code. I don&#39;t want it in the cabal file because it don&#39;t need it when I am developing."}, {"owner": {"reputation": 271, "user_id": 2925208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8cc2e6c8da46e3eb9be370b90d5fe06?s=128&d=identicon&r=PG&f=1", "display_name": "axm", "link": "https://stackoverflow.com/users/2925208/axm"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1461433974, "post_id": 34796209, "comment_id": 61201481, "body": "Point taken. In the <a href=\"http://docs.haskellstack.org/en/stable/GUIDE/#exec\" rel=\"nofollow noreferrer\">docs</a> are examples for setting ghc options on the command line. This should override the .cabal settings. I have not tested that though."}, {"owner": {"reputation": 866, "user_id": 171898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97c7cb70d1f6c24b47aa9ad809cb2c25?s=128&d=identicon&r=PG", "display_name": "mhansen", "link": "https://stackoverflow.com/users/171898/mhansen"}, "edited": false, "score": 0, "creation_date": 1606526868, "post_id": 34796209, "comment_id": 114994787, "body": "FYI looks like the answer is a little redundant: <code>stack build --profile</code> implies <code>--enable-library-profiling</code> and <code>--enable-executable-profiling</code>: <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#debugging\" rel=\"nofollow noreferrer\">docs.haskellstack.org/en/stable/GUIDE/#debugging</a>"}], "tags": [], "owner": {"reputation": 271, "user_id": 2925208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8cc2e6c8da46e3eb9be370b90d5fe06?s=128&d=identicon&r=PG&f=1", "display_name": "axm", "link": "https://stackoverflow.com/users/2925208/axm"}, "is_accepted": false, "score": 4, "last_activity_date": 1452848768, "last_edit_date": 1452848768, "creation_date": 1452793222, "answer_id": 34796209, "question_id": 33847819, "link": "https://stackoverflow.com/questions/33847819/using-stack-for-profiling/34796209#34796209", "title": "Using stack for profiling", "body": "<p>Stack support for enabling profiling works great, example:</p>\n\n<pre><code>stack build --profile --executable-profiling --library-profiling\nstack exec -- example &lt;your prog args&gt; +RTS -p\n</code></pre>\n\n<p>Then see example.prof for the default output.</p>\n\n<p><strong>Update</strong>: the stack support pointed me to the right correct for exec, see <a href=\"https://github.com/commercialhaskell/stack/issues/1655\" rel=\"nofollow\">https://github.com/commercialhaskell/stack/issues/1655</a></p>\n"}], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 700, "favorite_count": 2, "answer_count": 1, "score": 5, "last_activity_date": 1452848768, "creation_date": 1448135158, "question_id": 33847819, "link": "https://stackoverflow.com/questions/33847819/using-stack-for-profiling", "title": "Using stack for profiling", "body": "<p>I'm trying to do some profiling using <code>stack --enable-profiling</code> and I'm a bit confused about what's happening exactly. </p>\n\n<p>Do I need to use also <code>--enable-library</code> ?.\nAlso, is it build in a separate directory ?What happend next I build it, will remember that am I in <em>profiling mode</em> or do I have to use the <code>--enable-profiling</code> all the time. </p>\n\n<p>It is generally recommended to profile in conjonction with the <code>-O2</code> option. Does <code>--enable-profiling</code> set it automatically ? </p>\n"}, {"tags": ["haskell", "cabal", "haskell-platform", "friday"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1448156285, "post_id": 33847658, "comment_id": 55465882, "body": "It isn&#39;t too common people dive far enough down to really solve someone elses linking problems.  If you don&#39;t get enough help with using friday-devil then consider my friday juicypixels bridge.  JuicyPixels is a pure Haskell image serialization library - slower than DevIL but it avoids the C library dependency."}, {"owner": {"reputation": 7341, "user_id": 991762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0427cc380ee354ba126c1f0cb89d719e?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/991762/chris"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1448190791, "post_id": 33847658, "comment_id": 55472481, "body": "Thanks, I might just do that. Seems a shame not to be figure out what I&#39;m missing, but at this point it&#39;s just stopping me from getting anything done =D"}], "answers": [{"comments": [{"owner": {"reputation": 2075, "user_id": 460789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86714400e06d543caba42ccc80d158e7?s=128&d=identicon&r=PG", "display_name": "Andreas Kahler", "link": "https://stackoverflow.com/users/460789/andreas-kahler"}, "edited": false, "score": 0, "creation_date": 1461315475, "post_id": 33854603, "comment_id": 61153524, "body": "Thanks, that worked for me! Another hint: after sucessfully installing the package you also need to put the DevIL dlls somewhere in your PATH (or locally next to your compiled Haskell program)"}, {"owner": {"reputation": 7341, "user_id": 991762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0427cc380ee354ba126c1f0cb89d719e?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/991762/chris"}, "reply_to_user": {"reputation": 2075, "user_id": 460789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86714400e06d543caba42ccc80d158e7?s=128&d=identicon&r=PG", "display_name": "Andreas Kahler", "link": "https://stackoverflow.com/users/460789/andreas-kahler"}, "edited": false, "score": 1, "creation_date": 1461321771, "post_id": 33854603, "comment_id": 61157713, "body": "Glad that was of use to someone else, I was scratching my head for ages =D"}], "tags": [], "owner": {"reputation": 7341, "user_id": 991762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0427cc380ee354ba126c1f0cb89d719e?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/991762/chris"}, "is_accepted": true, "score": 2, "last_activity_date": 1448194229, "creation_date": 1448194229, "answer_id": 33854603, "question_id": 33847658, "link": "https://stackoverflow.com/questions/33847658/error-installing-friday-devil-missing-c-library-il-on-windows/33854603#33854603", "title": "Error Installing friday-DevIL - &quot;Missing C Library: IL&quot; on Windows", "body": "<p>I eventually managed to get this to work using the steps <a href=\"https://github.com/RaphaelJ/friday-devil/wiki/Windows\" rel=\"nofollow\">here</a> with a couple of tweaks.</p>\n\n<blockquote>\n  <p>DevIL C libraries do not come with friday-devil. Those trying to use\n  friday-devil on Windows can use the following procedue:</p>\n  \n  <ol>\n  <li><p>Download prebuilt Windows binaries and header files. These are currently hosted from sourceforge in the \"DevIL Windows SDK\" folder. You will need either x86 or the x64 variant depending on which version of GHC you are using.</p></li>\n  <li><p>Extract the archive somewhere on your hard drive such as <code>C:\\DevIL-1.7.8-x64</code>.</p></li>\n  <li><p>Unpack <code>friday-devil</code> with <code>cabal unpack friday-devil</code>.</p></li>\n  <li><p>Edit the \"<code>friday-devil.cabal</code>\" file so that the \"<code>Extra-Libraries</code>\" field specifies \"<code>DevIL</code>\" instead of \"<code>IL</code>\".</p>\n  \n  <p><code>Extra-Libraries: DevIL</code></p></li>\n  <li><p>install <code>friday-devil</code> with <code>cabal install friday-devil --extra-lib-dirs=c:\\devil-1.7.8-x64 --extra-include-dirs=c:\\devil-1.7.8-x64\\include</code>.</p></li>\n  </ol>\n</blockquote>\n\n<p>Step 3 creates a directory e.g. <code>friday-devil-0.1.1.1</code>, which is where the .cabal file you need to edit resides.</p>\n\n<p>I was unsuccessful when attempting to run the command in step 5. Instead I had to <code>cd</code> into the <code>friday-devil-0.1.1.1</code> directory created in step 3, and simply run: </p>\n\n<pre><code>cabal install --extra-lib-dirs=c:\\devil-1.7.8-x64 --extra-include-dirs=c:\\devil-1.7.8-x64\\include. \n</code></pre>\n\n<p>without specifying <code>friday-devil</code>.</p>\n\n<p>It might be the case that when running the full command, cabal was using a previously downloaded version (although yesterday I'm reasonably sure I changed the downloaded package in the cabal directory as well). I may revisit this on another system at some point, but the altered <code>cabal install</code> step above has solved my immediate problem.</p>\n\n<p>I'm sure it might just be a simple/obvious to people more familiar with cabal in general (I'm new to this), but I'll leave this here on the off chance it helps someone.</p>\n"}], "owner": {"reputation": 7341, "user_id": 991762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0427cc380ee354ba126c1f0cb89d719e?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/991762/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 696, "favorite_count": 0, "accepted_answer_id": 33854603, "answer_count": 1, "score": 1, "last_activity_date": 1461384256, "creation_date": 1448134249, "last_edit_date": 1495535635, "question_id": 33847658, "link": "https://stackoverflow.com/questions/33847658/error-installing-friday-devil-missing-c-library-il-on-windows", "title": "Error Installing friday-DevIL - &quot;Missing C Library: IL&quot; on Windows", "body": "<p>I'm having a problem similar to the one listed here: <a href=\"https://stackoverflow.com/questions/4991093/trying-to-install-image-codec-devil-under-windows-needs-pthread-and-il-cant-g\">Trying to install Image.Codec.DevIL under windows. Needs pthread and IL. Can&#39;t get IL to work</a> But I don't seem to be able resolve it following the small pieces of advice in the comments.</p>\n\n<p>I'm running the Haskell Platform on Windows 7, and am attempt to install and use the <code>friday</code> package <a href=\"https://hackage.haskell.org/package/friday\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/friday</a></p>\n\n<p>I can successfully run <code>cabal install package friday</code> but when attempting to run <code>cabal install package friday-devil</code>, the package installation fails with the following errors:</p>\n\n<pre><code>Resolving dependencies... \nConfiguring friday-devil-0.1.1.1... \nFailed to install friday-devil-0.1.1.1 Last 10 lines of the build log ( C:\\Users\\Chris\\AppData\\Roaming\\cabal\\logs\\friday-devil-0.1.1.1.log):     \nConfiguring friday-devil-0.1.1.1...\nsetup-Cabal-1.18.1.3-x86_64-windows-ghc-7.8.3.exe: Missing dependency on a foreign library:    \n* Missing C library: IL \nThis problem can usually be solved by installing the system package that provides this library (you may need the \"-dev\" version). \nIf the library is already installed but in a non-standard location then you can use the flags\n--extra-include-dirs= and --extra-lib-dirs= to specify where it is. \ncabal: Error: some packages failed to install: \nfriday-devil-0.1.1.1 failed during the configure step. The exception was: \nExitFailure 1\n</code></pre>\n\n<p>I've installed the libraries found at <a href=\"http://openil.sourceforge.net/\" rel=\"nofollow noreferrer\">http://openil.sourceforge.net/</a>, I've also tried manually specifying the location of the libs included in DevIL with the <code>--extra-include-dirs=</code> and <code>--extra-lib-dirs=</code> options suggested above. </p>\n\n<p>I've also attempted to run using MSYS2 shell and via cygwin (running out of ideas at that point).</p>\n\n<p>I thought that maybe the other answer was on to something regarding pthreads, but I've just attempted to install that and reference it, and nothing seemed to change.</p>\n\n<p>I'm unsure what else to try at this point, any thoughts greatly appreciated.</p>\n\n<p>Edit: I get exactly the same issue in Ubuntu 14, there must be a step I'm missing/not understanding somewhere.</p>\n\n<p>Further Edit: I've managed to get over this hump in Ubuntu by running <code>sudo apt-get install libdevil-dev</code> as suggested in this answer: <a href=\"https://stackoverflow.com/questions/29311547/g-with-devil-unable-to-link#\">g++ with DevIL: unable to link</a></p>\n\n<p>Also tried everything listed on this page: <a href=\"https://github.com/RaphaelJ/friday-devil/wiki/Windows\" rel=\"nofollow noreferrer\">https://github.com/RaphaelJ/friday-devil/wiki/Windows</a> and the error persists.</p>\n\n<p>I guess I need to figure out what the equivalent is in Windows?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 2, "creation_date": 1448129212, "post_id": 33846654, "comment_id": 55458097, "body": "Welcome to Stack Overflow! The community expects that you show your existing efforts, i.e. what have you tried, what worked and what didn&#39;t, what documentation you searched and what ideas you&#39;ve had when looking for a solution etc. You should also ask specific questions that can have a clear answer, not &quot;please assist me&quot; or &quot;solve this for me&quot;. I strongly suggest you to read <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a>."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1448129250, "post_id": 33846654, "comment_id": 55458115, "body": "Note for downvoters: If you downvote a question of a newcomer, please add an explanation why so that the question can be improved."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1448130344, "post_id": 33846654, "comment_id": 55458504, "body": "What have you tried should be described in the question, and not in comments. Also giving a type signature without any explanation is far from enough. What were the details? How the function looked like? Why it didn&#39;t work? ..."}], "answers": [{"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 1, "last_activity_date": 1448130243, "creation_date": 1448130243, "answer_id": 33846978, "question_id": 33846654, "link": "https://stackoverflow.com/questions/33846654/a-function-that-turns-string-to-int-int/33846978#33846978", "title": "a function that turns [String] to (Int,Int)", "body": "<p>What you need is to create a <a href=\"https://en.wikipedia.org/w/index.php?title=Parsing&amp;oldid=690761306\" rel=\"nofollow\">parser</a> that will convert a string input into a data structure.</p>\n\n<p>As this is a homework, I don't want to give you a direct answer. Rather I'd suggest you to read <a href=\"http://book.realworldhaskell.org/read/using-parsec.html\" rel=\"nofollow\">Using Parsec</a> from a great book Real World Haskell, which solves a problem very similar to yours. A parser will allow you to have nice and location-specific error messages.</p>\n\n<p>Note that you probably want to treat the whole input as one <code>String</code> so that everything (including counting lines etc.) is done by the parser. So the signature you're looking would be probably something like</p>\n\n<pre><code>processcoordinates :: String -&gt; Either ParseError [(Int, Int)]\n</code></pre>\n\n<p>where the left part of <code>Either</code> describes an error, and the right part a successful outcome.</p>\n"}], "owner": {"reputation": 21, "user_id": 5589734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa67d16978b0b28571fbf61b27073743?s=128&d=identicon&r=PG&f=1", "display_name": "wvstealth", "link": "https://stackoverflow.com/users/5589734/wvstealth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1448131065, "creation_date": 1448128360, "last_edit_date": 1448131065, "question_id": 33846654, "link": "https://stackoverflow.com/questions/33846654/a-function-that-turns-string-to-int-int", "title": "a function that turns [String] to (Int,Int)", "body": "<p>ive been lurking in this website for some time so ill finally post my 1st question.<br>\natm i have to do a school project which is to create the game Sokoban with haskell,and so far its been going good until i got to the part where i have to validate the coordinates.<br>\nthey come as such<br>\n11 2<br>\n3 4<br>\n5 6<br>\nit should return \"Ok\"<br>\ni have a function that turns them into a tuple of ints so i can check if they point to a place inside the map ,however that function doesnt give me a nice error message if its a a or just a number, which i need it to do that, for example<br>\na a<br>\n11 2<br>\n3 4<br>\nthe message should be \"1\", as in error in line 1.<br>\n1 3<br>\n2<br>\n4 5<br>\nthe error message should be \"2\" too<br>\nIs there any way to do that sort of thing, ive ran out of ideas\nthe function that turns from String into (Int,Int) </p>\n\n<pre><code>processcoordinates::[String]-&gt;(Int,Int)  \nprocesscoordinates [x,y]= (read x,read y)  \nprocesscoordinates xs = error \"invalid format\"  \n</code></pre>\n\n<p>Note:the function above is applied with the map function  </p>\n\n<p>among the things ive already tried but failed were using something along the lines of     </p>\n\n<pre><code>valcoor::Int-&gt;[String]-&gt;Int  \nvalcoor n []=-1   \nvalcoor n ((x,y):t)  \n|isDigit x &amp;&amp; isDigit y =valcoor (n+1) t \n|otherwise =n  \n</code></pre>\n\n<p>Note:sorry first time posting a question so im making a lot of mistakes :D<br>\nive edited this function so many times so i cant remember exactly the kind of error messages it gave although among them were<br>\nCouldn't match expected type \u2018[String]\u2019\n                with actual type \u2018([[Char]], [[Char]])\u2019<br>\n which happened when testing with actual values such as<br>\n([\"1\",\"1\"],[\"2\",\"2\"])</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1448175131, "post_id": 33845172, "comment_id": 55468984, "body": "uncurry is not related to <code>&gt;&gt;=</code>. See <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:uncurry\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.1.0/docs/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1025, "user_id": 1439629, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4cfce72158cd5741f0a48e67483b85e8?s=128&d=identicon&r=PG", "display_name": "Hamish", "link": "https://stackoverflow.com/users/1439629/hamish"}, "is_accepted": false, "score": 0, "last_activity_date": 1448120223, "creation_date": 1448120223, "answer_id": 33845224, "question_id": 33845172, "link": "https://stackoverflow.com/questions/33845172/haskell-constructor-meaning/33845224#33845224", "title": "Haskell constructor &quot;&gt;&gt;=&quot;meaning?", "body": "<p>The operation is called bind and from the <a href=\"https://www.haskell.org/tutorial/monads.html\" rel=\"nofollow\">haskell tutorial docs</a></p>\n\n<blockquote>\n  <p>The bind operations, >> and >>=, combine two monadic values (...)</p>\n</blockquote>\n\n<p>I suggest reading the link above - it's well explained there</p>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 5577531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/486fa1ecf90369f0e46fc979261b0125?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5577531/joe"}, "edited": false, "score": 0, "creation_date": 1448120641, "post_id": 33845242, "comment_id": 55454980, "body": "so can I rewrite    action1 &gt;&gt;= \\value -&gt; action2   without  &gt;&gt;=  just use some simply function"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 105, "user_id": 5577531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/486fa1ecf90369f0e46fc979261b0125?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5577531/joe"}, "edited": false, "score": 0, "creation_date": 1448120725, "post_id": 33845242, "comment_id": 55455016, "body": "@Joe Yes, every use of <code>&gt;&gt;=</code> (or <code>&gt;&gt;</code>) is equivalent to <code>do</code> notation (and vice versa)."}, {"owner": {"reputation": 105, "user_id": 5577531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/486fa1ecf90369f0e46fc979261b0125?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5577531/joe"}, "edited": false, "score": 0, "creation_date": 1448123370, "post_id": 33845242, "comment_id": 55455979, "body": "Can I rewrite action2 ([a],[b]@(<i>:</i>)) = action1 ([a&#39;],[b&#39;]) &gt;&gt;= action1   to   action2([a],[b]@(<i>:</i>)) = action2(action1([a&#39;],[b&#39;])) Just like what you said first executes action1 and feed the result to the function which is in action2 and then execute action2. So can I regard  action2 (a,b) = action1 (a&#39;,b&#39;) &gt;&gt;= action1  just like recursion in this case, because i will not stop execute action1 and 2 many times until it meets the trivial case which is when [b] becomes empty list."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1448120603, "last_edit_date": 1448120603, "creation_date": 1448120279, "answer_id": 33845242, "question_id": 33845172, "link": "https://stackoverflow.com/questions/33845172/haskell-constructor-meaning/33845242#33845242", "title": "Haskell constructor &quot;&gt;&gt;=&quot;meaning?", "body": "<p><code>&gt;&gt;=</code> is a function name, not a constructor name. Constructor names in Haskell have to start with a capital letter or a colon (<code>:</code>).</p>\n\n<p>In the Prelude <code>&gt;&gt;=</code> is defined as a method of <code>class Monad m</code> as follows:</p>\n\n<pre><code>(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>This called the \"bind operator\" and meant to combine a value of a monad with a function that uses the value \"contained\" in the monad.</p>\n\n<p>For the <code>IO</code> monad <code>action1 &gt;&gt;= \\value -&gt; action2</code> executes <code>action1</code>, feeds the result of the action into the function and then executes <code>action2</code>.</p>\n\n<p>For the list monad <code>&gt;&gt;=</code> is equivalent to <code>concatMap</code>, that is it executes the given function for each element of the given list and produces the concattenation of the thus-produced lists as its result.</p>\n\n<p>The special thing about <code>&gt;&gt;=</code> is that it's used by the desugaring of the <code>do</code> notation. So <code>a &gt;&gt;= \\b -&gt; c</code> can also be written using <code>do</code> notation like this:</p>\n\n<pre><code>do\n  b &lt;- a\n  c\n</code></pre>\n\n<p>So by defining <code>&gt;&gt;=</code> for your type (via a <code>Monad</code> instance), you control how <code>do</code> notation behaves for your type.</p>\n"}], "owner": {"reputation": 105, "user_id": 5577531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/486fa1ecf90369f0e46fc979261b0125?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5577531/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 1, "accepted_answer_id": 33845242, "answer_count": 2, "score": -5, "last_activity_date": 1448120603, "creation_date": 1448120008, "last_edit_date": 1448120256, "question_id": 33845172, "link": "https://stackoverflow.com/questions/33845172/haskell-constructor-meaning", "title": "Haskell constructor &quot;&gt;&gt;=&quot;meaning?", "body": "<pre><code>&gt;&gt;=\n&gt;&gt;= what is this mean in the Haskell programming?\nuncurry meaning?\n</code></pre>\n\n<p>what is meaning of >>= in the Haskell programming?\n  what is uncurry mean in Haskell?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 6, "creation_date": 1448118702, "post_id": 33844925, "comment_id": 55454222, "body": "You aren&#39;t matching the empty list: <code>buildTowers []</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1448119347, "post_id": 33844925, "comment_id": 55454513, "body": "Yet another reason to use <code>-Wall</code>: it would have pointer out the definition without type signatures, spotting the typo."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1448129832, "post_id": 33844925, "comment_id": 55458316, "body": "This is only tangentially related to your problem, but: why make the base case <code>[x]</code> instead of <code>[]</code>?"}, {"owner": {"reputation": 397, "user_id": 2555560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100000044259680/picture?type=large", "display_name": "Tilman Zuckmantel", "link": "https://stackoverflow.com/users/2555560/tilman-zuckmantel"}, "edited": false, "score": 0, "creation_date": 1448149856, "post_id": 33844925, "comment_id": 55464601, "body": "Thank you very much sometimes a typo can be your worst enemy..."}], "answers": [{"tags": [], "owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "is_accepted": false, "score": 1, "last_activity_date": 1448378304, "creation_date": 1448378304, "answer_id": 33897345, "question_id": 33844925, "link": "https://stackoverflow.com/questions/33844925/pattern-matching-in-haskell/33897345#33897345", "title": "Pattern matching in Haskell", "body": "<p>As @Reid Barton already pointed out in the comments, you are missing to match the empty list. I'd further go with @Daniel Wagners suggestion, merging both in this community answer so the question can be closed.</p>\n"}], "owner": {"reputation": 397, "user_id": 2555560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100000044259680/picture?type=large", "display_name": "Tilman Zuckmantel", "link": "https://stackoverflow.com/users/2555560/tilman-zuckmantel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1448378304, "creation_date": 1448118568, "last_edit_date": 1448137741, "question_id": 33844925, "link": "https://stackoverflow.com/questions/33844925/pattern-matching-in-haskell", "title": "Pattern matching in Haskell", "body": "<p>I am working on a Haskell project and I have some trouble with this code snippet:</p>\n\n<pre><code>buildTowers :: [Int] -&gt; Int -&gt;[[Bool]]\nbuildTowers [x] max = (buildBoolList x max) :[]\nbuildTowers (x:xs) max = (buildBoolList x max):buildTowers xs max\n</code></pre>\n\n<p>I get this error: Non exhausting pattern matches, but for me it seems as everthing is covered. Do you know what the problem is?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell", "monads", "applicative", "fam-proposal"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1448118830, "post_id": 33844804, "comment_id": 55454276, "body": "While I would like to have such a feature, I really don&#39;t see much need for it in case of AMP. <code>instance Applicative YourFunctor where {pure=return; (&lt;*&gt;)=ap}</code>. There, is that really too much boilerplate for you? \u2013 Besides, often it <i>is</i> a good idea to write out the <code>Applicative</code> instance manually; sometimes it can be much more efficient than a <code>Monad</code>-derived version. And <code>Functor</code> you normally don&#39;t need to define at all, just use <code>-XDeriveFunctor</code>."}, {"owner": {"reputation": 2418, "user_id": 1232832, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/2c492983af89b49d44250c79579a2641?s=128&d=identicon&r=PG", "display_name": "Shou Ya", "link": "https://stackoverflow.com/users/1232832/shou-ya"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1448119211, "post_id": 33844804, "comment_id": 55454457, "body": "@leftaroundabout: Although writing the data as an instance <code>Applicative</code> could be not that long, it is still a boilerplate. I know that sometimes implementing an <code>Applicative</code> instance would be more efficient but what I want is the choice, so I could only write that down when I really wanted."}], "owner": {"reputation": 2418, "user_id": 1232832, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/2c492983af89b49d44250c79579a2641?s=128&d=identicon&r=PG", "display_name": "Shou Ya", "link": "https://stackoverflow.com/users/1232832/shou-ya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1448129918, "answer_count": 0, "score": 0, "last_activity_date": 1448157713, "creation_date": 1448117988, "last_edit_date": 1448157713, "question_id": 33844804, "link": "https://stackoverflow.com/questions/33844804/omit-defining-an-applicative-instance-for-a-monad", "closed_reason": "Duplicate", "title": "Omit defining an Applicative instance for a Monad", "body": "<p>I'm defining a data an instance Monad just for utilizing the <code>do</code> notation. However, by the <a href=\"https://wiki.haskell.org/Functor-Applicative-Monad_Proposal\" rel=\"nofollow\">Applicative-Monad Proposal</a> implemented in GHC 7.10+, I will have to also define the data as an instance of Applicative and Functor. I don't plan to define <code>fmap</code>, <code>pure</code>, <code>&lt;*&gt;</code>, as they are easily derived from <code>liftM</code>, <code>return</code> and <code>ap</code> in terms of Monad.</p>\n\n<p>To make Applicative a superclass of Monad explicitly is good. However, is it the case that AMP also introduces some really unnecessary code on writing those part that are totally useless? Or if Haskell has some short hand ways to cope with this situation? Some like:</p>\n\n<pre><code>class Applicative m =&gt; Monad m where\n   super pure = return\n   super (&lt;*&gt;) = ap\n   return :: a -&gt; m a\n   (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448115058, "post_id": 33844282, "comment_id": 55453044, "body": "I know of none such function - so I guess you have to do it yourself (or wait and see if someone knows one)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1448115176, "post_id": 33844282, "comment_id": 55453082, "body": "That by itself doesn&#39;t seem useful&amp;general enough to warrant having a dedicated standard function for it. It&#39;s simple enough to define it yourself, so probably you should just do it. But, what do you actually need this for? Perhaps we can point to a more general alternative approach (sounds like a scan of traversal might be the right thing)."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1448117670, "post_id": 33844282, "comment_id": 55453849, "body": "@leftaroundabout, it&#39;s rather easy with <code>para</code>: <code>fun f = para (\\x xs r -&gt; map (f x :) (xs : r)) []</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1448118649, "post_id": 33844282, "comment_id": 55454206, "body": "@user3237465: how about you guys get a proper SO account with a readable username instead of a magic number? And, that solution with <code>para</code> sounds interesting, why don&#39;t you make it an answer?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1448120629, "post_id": 33844282, "comment_id": 55454972, "body": "@leftaroundabout, I&#39;m a magician. The question doesn&#39;t ask about a solution directly, so I decided to leave a comment."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 4, "last_activity_date": 1448116940, "creation_date": 1448116940, "answer_id": 33844604, "question_id": 33844282, "link": "https://stackoverflow.com/questions/33844282/get-partial-results-of-map-function/33844604#33844604", "title": "Get partial results of map function", "body": "<p>You must make a new function for yourself.</p>\n"}], "owner": {"reputation": 248, "user_id": 3657850, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/43a7448e5c53fd976f54ff0015006772?s=128&d=identicon&r=PG&f=1", "display_name": "user3657850", "link": "https://stackoverflow.com/users/3657850/user3657850"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 33844604, "answer_count": 1, "score": -2, "last_activity_date": 1448117129, "creation_date": 1448114834, "last_edit_date": 1448115528, "question_id": 33844282, "link": "https://stackoverflow.com/questions/33844282/get-partial-results-of-map-function", "title": "Get partial results of map function", "body": "<p>Is it possible to get the partial results of the map function in Haskell?<br>\nSo if i use map this would be the normal result:   </p>\n\n<p><code>map (+1) [1,1,1]\n[2,2,2]</code>   </p>\n\n<p>But I want this as a result:<br>\n<code>[[2,1,1],[2,2,1],[2,2,2]</code>   </p>\n\n<p>Is this possible to get this result with a buildin function or do I have to make a new function for myself?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448115121, "post_id": 33844244, "comment_id": 55453062, "body": "this will not even compile - are you sure it&#39;s the code you have?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448115178, "post_id": 33844244, "comment_id": 55453083, "body": "how are you supposed to run this (what is <code>p</code>)?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448115227, "post_id": 33844244, "comment_id": 55453099, "body": "also the very last line is wrong if you don&#39;t want to have your sorted list the same length as before (for example <code>[1,1,1]</code>)"}, {"owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448115437, "post_id": 33844244, "comment_id": 55453154, "body": "It was my attempt at solving the task."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448115515, "post_id": 33844244, "comment_id": 55453179, "body": "ok so you want to sort descending or ascending?"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448117205, "post_id": 33844405, "comment_id": 55453715, "body": "Thank you for your help. But I guess , I&#39;m not allowed to use minimumBy, &#39;delete&#39; and &#39;on&#39;. I changed &lt; to 2, just to see if it would compile. Beside  looking really ugly, it does ;) . But it will not work with &#39;&lt;&#39;, &#39;&gt;&#39; or just plain &lt;, &gt;."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448119044, "post_id": 33844405, "comment_id": 55454382, "body": "it will not work this way - you cannot compare functions (and even if the syntax would be <code>(&lt;)</code> for the function) - I don&#39;t know what you are allowed to use but you don&#39;t have to use the second version - just use a parameter (you <code>2</code> would do - or use <code>Bool</code> or some self-defined sum-type) to decide if you want to use <code>minimum</code> or <code>maximum</code> - I did not do because I wanted you to have some thought (it&#39;s homework after all)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448119108, "post_id": 33844405, "comment_id": 55454409, "body": "btw: if you are not allowed to use <code>delete</code> you can either stick with your <code>filter</code> version (which might be okay) or try to define it yourself - usually it&#39;s one of those functions you&#39;ll see in an introduction course anyway (it&#39;s not hard to write using the usual recursive pattern-match)"}, {"owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448126426, "post_id": 33844405, "comment_id": 55457161, "body": "I tried, but i don&#39;t get it. What should I do if sort ( &lt; ) [ 2,5,3,7] =&gt; [2,3,5,7]?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448127931, "post_id": 33844405, "comment_id": 55457649, "body": "again - you cannot use <code>(&lt;)</code> as a switch - what you can do is <code>sort True [2,5,3,7] = [2,3,5,7]</code> and <code>sort False [2,5,3,7] = [7,5,3,2]</code> and the way you can do it is basically use my first version and then either use <code>maximum</code> instead of <code>minimum</code> for <code>False</code> or just <code>reverse</code> if <code>False</code> ..."}, {"owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448129530, "post_id": 33844405, "comment_id": 55458214, "body": "But we have to use (&lt;) . the task explicitly says it."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448129949, "post_id": 33844405, "comment_id": 55458361, "body": "well ok I&#39;ll do it for you (the trick is to rewrite minimum I guess)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448130444, "post_id": 33844405, "comment_id": 55458537, "body": "ok I served you everything on a plate there - you probably have to work a bit to get the things you are not allowed to use out but at least the idea should be clear"}, {"owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1448187158, "post_id": 33844405, "comment_id": 55471559, "body": "Awesome. it also helped me to understand the foldr function much better."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 0, "last_activity_date": 1448130409, "last_edit_date": 1448130409, "creation_date": 1448115722, "answer_id": 33844405, "question_id": 33844244, "link": "https://stackoverflow.com/questions/33844244/could-not-deduce-error-type/33844405#33844405", "title": "Could not deduce error type", "body": "<p>Here is a version that should be close to your idea (taking the <em>least</em> element of the list and then sorting the rest):</p>\n\n<pre><code>import Data.List (delete)\n\nsort :: Ord t =&gt; [t] -&gt; [t]\nsort [] = []\nsort ls = selected : sort (delete selected ls)\n where selected = minimum ls\n</code></pre>\n\n<p>that will not shorten a list:</p>\n\n<pre><code>\u03bb&gt; sort [2,4,6,1,2,5]\n[1,2,2,4,5,6]\n</code></pre>\n\n<p>the idea to take in a function to decide if you want to sort descending or ascending can be done like this:</p>\n\n<pre><code>import Data.List (delete, minimumBy)\nimport Data.Function (on)\n\nsort :: Eq t =&gt; (t -&gt; t -&gt; Ordering) -&gt; [t] -&gt; [t]\nsort _ [] = []\nsort p ls = selected : sort p (delete selected ls)\n where selected = minimumBy p ls\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>\u03bb&gt; sort (compare) [2,4,6,1,2,5]\n[1,2,2,4,5,6]\n\u03bb&gt; sort (compare `on` negate) [2,4,6,1,2,5]\n[6,5,4,2,2,1]\n</code></pre>\n\n<p>of course this is not really a good sorting-algorithm</p>\n\n<hr>\n\n<p>now you should go over your version again and think how you can fix it - for example there is a way to use <code>maximum</code> to get the list sorted descending instead</p>\n\n<hr>\n\n<h3>using <code>(&lt;)</code> and <code>(&gt;)</code>:</h3>\n\n<p>the idea is then to basically rewrite <code>minimum</code> and use the <em>compare</em> function you pass on:</p>\n\n<pre><code>import Data.List (delete, foldr1)\n\nsort :: Eq t =&gt; (t -&gt; t -&gt; Bool) -&gt; [t] -&gt; [t]\nsort _ [] = []\nsort p ls = extremum : sort p (delete extremum ls)\n  where extremum  = foldr1 (\\ a b -&gt; if p a b then a else b) ls\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>\u03bb&gt; sort (&lt;) [2,4,6,1,2,5]\n[1,2,2,4,5,6]\n\u03bb&gt; sort (&gt;) [2,4,6,1,2,5]\n[6,5,4,2,2,1]\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 33844405, "answer_count": 1, "score": -1, "last_activity_date": 1448130409, "creation_date": 1448114652, "question_id": 33844244, "link": "https://stackoverflow.com/questions/33844244/could-not-deduce-error-type", "title": "Could not deduce error type", "body": "<p>we have to write a code, which will sort the elments of a list.</p>\n\n<p>For this , we have to use two help functions. \nIn my case calculate (gives the max/min of a list) and delete ( will delete the max/min).</p>\n\n<p>And what a suprise, it is not working ;).</p>\n\n<p>Running the code , I am always getting:\" could not deduce (Ey (a-> a-> Bool)) arising from a use of 'sort'\"</p>\n\n<p>Any suggestions?</p>\n\n<pre><code>sort p [] = []\nsort p ls = selected : sort p (delete)\n where\n  selected =  calculate p ls\n  calculate p ls\n                | p == &lt; =  minimum ls\n                | otherwise = maximum ls\n  delete = del selected ls\n  del selected ls = filter (/= selected) ls\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "runtime-error"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1448113858, "post_id": 33844008, "comment_id": 55452674, "body": "I think the problem is right here: <code>parseHour xs | length (checkT) == 2 = [(Hour(read f :: Int), (drop 3 xs))]</code> - in the <code>read f</code>part - see: <code>f</code> will still include the <code>&#39;T&#39;</code> so you should do <code>read checkT :: Int</code> instead"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448113923, "post_id": 33844008, "comment_id": 55452697, "body": "the very next line is a bit strange too: <code>| length (checkT) == 3 = [(Hour(read f :: Int), (drop 2 xs))]</code> - why would you want to read 3 digits into <code>Hour</code> but then only drop 2 from the input?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448114085, "post_id": 33844008, "comment_id": 55452760, "body": "overall I would write an <i>parser</i> that consumes an optional <code>T</code> (<code>()</code> return would be fine) and then use this one plus the <code>parseDigits</code> you already have for the Hour part as well"}], "owner": {"reputation": 65, "user_id": 5330987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc83ef22819c01bceec3444c00180fb7?s=128&d=identicon&r=PG&f=1", "display_name": "mcNuggetsplays", "link": "https://stackoverflow.com/users/5330987/mcnuggetsplays"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1448113188, "creation_date": 1448113188, "question_id": 33844008, "link": "https://stackoverflow.com/questions/33844008/exception-prelude-read-no-parse", "title": "Exception: Prelude.read: no parse", "body": "<p>For an assignment on parser if been working on the following code in Haskell;</p>\n\n<p>Imports; </p>\n\n<pre><code>import ParseLib.Simple\nimport Prelude hiding ((&lt;*&gt;), (&lt;$&gt;),(&lt;$),(&lt;*))\nimport Data.Char\nimport Data.Time.Calendar hiding (Day)\n</code></pre>\n\n<p>Data Types;</p>\n\n<pre><code>data DateTime = DateTime { date :: Date\n                     , time :: Time\n                     , utc :: Bool }\nderiving (Eq, Ord)\n\ndata TimeUTC = Eps | Z deriving Show\n\n\ndata Date = Date { year  :: Year\n             , month :: Month\n             , day   :: Day }\nderiving (Eq, Ord)\n\nnewtype Year  = Year { unYear :: Int }  deriving (Eq, Ord)\nnewtype Month = Month { unMonth :: Int } deriving (Eq, Ord)\nnewtype Day   = Day { unDay :: Int } deriving (Eq, Ord)\n\ndata Time = Time { hour   :: Hour\n             , minute :: Minute\n             , second :: Second }\nderiving (Eq, Ord)\n\nnewtype Hour   = Hour { unHour :: Int } deriving (Eq, Ord)\nnewtype Minute = Minute { unMinute :: Int } deriving (Eq, Ord)\nnewtype Second = Second { unSecond :: Int } deriving (Eq, Ord)\n\ndata Result = SyntaxError | Invalid DateTime | Valid DateTime deriving (Eq, Ord)\n\ninstance Show DateTime where\nshow = printDateTime\n\ninstance Show Result where\nshow SyntaxError = \"date/time with wrong syntax\"\nshow (Invalid _) = \"good syntax, but invalid date or time values\"\nshow (Valid x)   = \"valid date: \" ++ show x\n</code></pre>\n\n<p>With show instances for all the newtypes equel to this;</p>\n\n<pre><code>instance Show Year where\nshow (Year a) = show a\n</code></pre>\n\n<p>The parsers look like this;</p>\n\n<pre><code>-- Exercise 1\nparseDateTime :: Parser Char DateTime\nparseDateTime = DateTime &lt;$&gt; parseDate &lt;*&gt; parseTime &lt;*&gt; parseUTC\n\nparseDigits :: Int -&gt; Parser Char Int\nparseDigits n (xs) | length f == n = [(read f :: Int, drop n xs)]\n           | otherwise = []\n           where f = take n xs\n\n-- Time parsing\nparseTime :: Parser Char Time\nparseTime =  Time &lt;$&gt; parseHour &lt;*&gt; parseMinute &lt;*&gt; parseSeconds       \n\nparseHour :: Parser Char Hour\nparseHour xs | length (checkT) == 2 = [(Hour(read f :: Int), (drop 3 xs))]\n         | length (checkT) == 3 = [(Hour(read f :: Int), (drop 2 xs))]\n         | otherwise = []\n         where f = take 3 xs\n               checkT = if (head f) == 'T' then drop 1 f else f\n\nparseMinute :: Parser Char Minute\nparseMinute  = Minute &lt;$&gt; (parseDigits 2)\n\nparseSeconds :: Parser Char Second\nparseSeconds = Second &lt;$&gt; (parseDigits 2)\n\n-- Date parsing\nparseDate :: Parser Char Date\nparseDate = Date &lt;$&gt; parseYear &lt;*&gt; parseMonth &lt;*&gt; parseDay\n\nparseYear :: Parser Char Year\nparseYear = Year &lt;$&gt; (parseDigits 4)\n\nparseMonth :: Parser Char Month\nparseMonth = Month &lt;$&gt; (parseDigits 2)\n\nparseDay :: Parser Char Day\nparseDay = Day &lt;$&gt; (parseDigits 2)\n\n-- UTC parsing\nparseUTC :: Parser Char Bool\nparseUTC = utcToBool &lt;$&gt; (option ((\\a -&gt; Z) &lt;$&gt; satisfy (=='Z')) Eps) \n\nutcToBool :: TimeUTC -&gt; Bool\nutcToBool Eps = False\nutcToBool Z = True\n\n-- Exercise 2\n\nisFinished :: [(a, [b])] -&gt; Maybe a\nisFinished [] = Nothing\nisFinished ((result, rest):xs) | null rest   = Just result\n                           | otherwise   = isFinished xs \n\nrun :: Parser a b -&gt; [a] -&gt; Maybe b\nrun p s = isFinished r\n      where r = p s\n\n-- Exercise 3\nprintDateTime :: DateTime -&gt; String\nprintDateTime (DateTime (Date year month day)(Time hour minute     second)timezone) = f year 4 ++ f month 2 ++ f day 2 ++ \"T\" ++ f hour 2 ++ f     minute 2 ++ f second 2 ++ endOrZ timezone\n   where f s a = take (a - length (show s)) (repeat '0') ++ show s\n     endOrZ False = \"\"\n     endOrZ True = \"Z\"\n\n-- Exercise 4\nparsePrint s = fmap printDateTime $ run parseDateTime s\n</code></pre>\n\n<p>So now my problem. After finishing exercise 4 we are supossed to test \"parsePrint\" and if the string that goes in is correct it returns Just \"inputstring\" else nothing</p>\n\n<p>So i tried to test it with some strings that were given to us and i got the following error;</p>\n\n<pre><code>*Main&gt;  parsePrint \"20111012T083945\"\n*** Exception: Prelude.read: no parse\nJust \"20111012T*Main&gt; \n</code></pre>\n\n<p>Now I found some thread on here about the same error, these were mostly about missing qoutes and one about the read instance. Yet I'm still not really able to figure out the problem. </p>\n\n<p>I don't expect the flat out answser seeing it's for a school assignment but if someone could point me in the right direction I would be really grateful, seeing I've been trying to figure it out for a couple of hours now.</p>\n\n<p>-- Indents got a bit messed up when I copied the code here, but I don't think that would be the problem.</p>\n"}, {"tags": ["c#", "haskell"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1448112814, "post_id": 33843403, "comment_id": 55452333, "body": "Use the 32-bit version of GHC if you want a 32-bit output. (You can build GHCs in other configurations, like a 64-bit GHC that produces 32-bit output, but there are no such binaries provided for download.)"}, {"owner": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1448155017, "post_id": 33843403, "comment_id": 55465651, "body": "I must still be doing something wrong: I&#39;ve downloaded and installed: <a href=\"https://www.haskell.org/ghc/dist/7.6.1/ghc-7.6.1-i386-windows.exe\" rel=\"nofollow noreferrer\">haskell.org/ghc/dist/7.6.1/ghc-7.6.1-i386-windows.exe</a>  and changed my command line to point to the location of this version of ghc:  C:\\ghc32\\ghc-7.6.1\\bin\\ghc --make -shared ParserIO.hs  But dependency walker is still showing HSdll.dll as 64 bit and the app is still failing when the dll is loaded (though now with no message or call stack). My test &quot;Hello&quot; function is not calling the dll yet so it must be the load that is failing"}], "owner": {"reputation": 371, "user_id": 5589037, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a8e0afcaf170b7c13a53093cf2f5f84c?s=128&d=identicon&r=PG&f=1", "display_name": "John Walker", "link": "https://stackoverflow.com/users/5589037/john-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1448155358, "creation_date": 1448109215, "last_edit_date": 1495539870, "question_id": 33843403, "link": "https://stackoverflow.com/questions/33843403/how-can-i-compile-a-haskell-module-to-be-called-from-a-32-bit-c-application", "title": "How can I compile a haskell module to be called from a 32 Bit C# Application", "body": "<p>I need to call a string function from C# like the one below:</p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\n\nmodule ParserIO where\n\nimport Foreign\nimport Foreign.C.Types\nimport Foreign.C.String\nimport ParserFuncs\n\nwrapHello :: String -&gt; IO CString\nwrapHello name = newCString $ hello name\n\nhiThere :: CString -&gt; IO CString\nhiThere name = peekCString name &gt;&gt;= wrapHello\n\nforeign export ccall hiThere ::  CString -&gt; IO CString\n</code></pre>\n\n<p>The calling code is as follows:</p>\n\n<pre><code>public sealed class HaskellInterOp : IDisposable {\n    [DllImport(\"HSdll.dll\", CallingConvention = CallingConvention.Cdecl)]\n    private static extern void hs_init(IntPtr argc, IntPtr argv);\n\n    [DllImport(\"HSdll.dll\", CallingConvention = CallingConvention.Cdecl)]\n    private static extern void hs_exit();\n\n    [DllImport(\"HSdll.dll\", CallingConvention = CallingConvention.Cdecl)]\n    private static extern String hiThere(String name);\n\n\n    public HaskellInterOp() {\n        hs_init(IntPtr.Zero, IntPtr.Zero); \n    }\n\n    public void Dispose() {\n        hs_exit(); \n    }\n\n    public String Hello(string name) {\n        var result = \"Hi\";  //hiThere(name);\n        return result;\n    }\n}\n</code></pre>\n\n<p>I have tried various combinations of from:\n<a href=\"https://stackoverflow.com/questions/16615641/calling-haskell-from-c-sharp\">Calling Haskell from C#</a>\nand\n<a href=\"https://stackoverflow.com/questions/1494478/call-a-haskell-function-in-net\">Call a Haskell function in .NET</a> without success.</p>\n\n<p>I am using the following to compile the DLL (ghc version 7.10.2): </p>\n\n<pre><code>ghc --make -shared ParserIO.hs\n</code></pre>\n\n<p>But when the dll produced is called it fails when it is loading in C# I get:</p>\n\n<p>Result Message: System.BadImageFormatException : An attempt was made to load a program with an incorrect format. (Exception from HRESULT: 0x8007000B).</p>\n\n<p>Here is the test code:</p>\n\n<pre><code>   [Test]\n    public void when_interop_is_called_then_the_result_is_as_expected() {\n        using (var io = new HaskellInterOp()) {\n           var greeting = io.Hello(\"John\");\n           Assert.AreEqual(\"Hello John\", greeting);\n       }\n    }\n</code></pre>\n\n<p>I figure because my ap needs to be 32 bit and the HSdll.dlld is 64. Is there a way to get GHC to generate a 32 Bit DLL that can be called from my 32 Bit C# ap?</p>\n\n<p>Thanks</p>\n\n<p>John</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2161, "user_id": 193622, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ccf61bd20c2f51314bee79769561200d?s=128&d=identicon&r=PG", "display_name": "ponkin", "link": "https://stackoverflow.com/users/193622/ponkin"}, "edited": false, "score": 2, "creation_date": 1448108774, "post_id": 33843184, "comment_id": 55450991, "body": "What is the goal of your function? What are you trying to do?"}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 3, "last_activity_date": 1448108581, "creation_date": 1448108581, "answer_id": 33843300, "question_id": 33843184, "link": "https://stackoverflow.com/questions/33843184/patternmatching-for-empty-list-in-haskell/33843300#33843300", "title": "Patternmatching for empty List in Haskell", "body": "<p>Both functions take as arguments list of lists. The empty list match <code>[]</code> only matches the outer list, but not the case where the outer list is non-empty, but the inner list isn't; e.g. <code>[[]]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1025, "user_id": 1439629, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4cfce72158cd5741f0a48e67483b85e8?s=128&d=identicon&r=PG", "display_name": "Hamish", "link": "https://stackoverflow.com/users/1439629/hamish"}, "is_accepted": true, "score": 5, "last_activity_date": 1448108631, "creation_date": 1448108631, "answer_id": 33843309, "question_id": 33843184, "link": "https://stackoverflow.com/questions/33843184/patternmatching-for-empty-list-in-haskell/33843309#33843309", "title": "Patternmatching for empty List in Haskell", "body": "<p>I think you're missing a pattern to match your inner list, so when you get to your list comprehension, there hasn't been a check to see if your inner list is empty</p>\n\n<p>I'm not sure what your function is designed to do, but you might want to split out your functions a bit like this so you can deal with the empty sublist on it's own</p>\n\n<pre><code>swapListToTowers::[[Bool]]-&gt;[[Bool]]\nswapListToTowers [] = []\nswapListToTowers xs = swapListToTowersInner (head xs) : ...\n\nswapListToTowersInner :: [Bool] -&gt; [Bool]\nswapListToTowersInner [] = []\nswapListToTowersInner xs = head xs\n\n... similarly here for cutOfFirstElements\n</code></pre>\n"}], "owner": {"reputation": 397, "user_id": 2555560, "user_type": "registered", "accept_rate": 87, "profile_image": "https://graph.facebook.com/100000044259680/picture?type=large", "display_name": "Tilman Zuckmantel", "link": "https://stackoverflow.com/users/2555560/tilman-zuckmantel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1739, "favorite_count": 0, "accepted_answer_id": 33843309, "answer_count": 2, "score": 6, "last_activity_date": 1448108631, "creation_date": 1448107876, "question_id": 33843184, "link": "https://stackoverflow.com/questions/33843184/patternmatching-for-empty-list-in-haskell", "title": "Patternmatching for empty List in Haskell", "body": "<p>as i am new to Haskell i am not quite familiar with everything. i tried to implement a function using pattern matching but this wont work as it gives the following Exception: Prelude.head empty list. This is the code sample:</p>\n\n<pre><code>swapListToTowers::[[Bool]]-&gt;[[Bool]]\nswapListToTowers [] = []\nswapListToTowers xs = [head x| x &lt;-xs]:swapListToTowers (cutOfFirstElements xs)\n\n\ncutOfFirstElements::[[Bool]]-&gt;[[Bool]]\ncutOfFirstElements [] = []\ncutOfFirstElements xs = [tail x | x &lt;- xs]\n</code></pre>\n\n<p>I think the case for capturing the empty list does not quite work , does it?\nThanks in advance for any help!</p>\n"}, {"tags": ["haskell", "ghc", "typeclass", "generic-programming", "overlapping-instances"], "answers": [{"comments": [{"owner": {"reputation": 7230, "user_id": 788337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wiVpx.png?s=128&g=1", "display_name": "jmite", "link": "https://stackoverflow.com/users/788337/jmite"}, "edited": false, "score": 0, "creation_date": 1448137573, "post_id": 33841460, "comment_id": 55461036, "body": "This was excellent, and is certainly the &quot;real world&quot; answer. But I&#39;d still love to see if there&#39;s a way to get the instances behaviour I&#39;m talking about."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 8, "last_activity_date": 1448095507, "creation_date": 1448095507, "answer_id": 33841460, "question_id": 33840818, "link": "https://stackoverflow.com/questions/33840818/can-i-use-overlappinginstances-to-get-nicer-error-messages/33841460#33841460", "title": "Can I use OverlappingInstances to get nicer error messages?", "body": "<p>You don't need overlapping instances, just use the GHC debugger on your own <code>(!!)</code>:</p>\n\n<pre><code>{-# OPTIONS -Wall -O0 #-}\nmodule Debugger3 where\n\nimport qualified Prelude as P\nimport Prelude hiding ((!!))\n\n(!!) :: [a] -&gt; Int -&gt; a\nxs !! n =\n   xs P.!! n    -- line 9\n\nfoo :: Int -&gt; Int\nfoo n = [0..n] !! 3\n\nbar :: Int -&gt; Int\nbar n = foo (n-3)\n\nmain :: IO ()\nmain = print (bar 4)\n</code></pre>\n\n<p>GHCi session:</p>\n\n<pre><code>&gt; :l Debugger3\n[1 of 1] Compiling Debugger3        ( Debugger3.hs, interpreted )\nOk, modules loaded: Debugger3.\n*Debugger3&gt; :break 9\nBreakpoint 1 activated at Debugger3.hs:9:4-18\n*Debugger3&gt; :trace main\nStopped at Debugger3.hs:9:4-18\n_result :: a = _\nn :: Int = 3\nxs :: [a] = _\n[Debugger3.hs:9:4-18] *Debugger3&gt; :force xs\nxs = [0,1]\n[Debugger3.hs:9:4-18] *Debugger3&gt; :history\n-1  : !! (Debugger3.hs:(8,1)-(9,18))\n-2  : foo (Debugger3.hs:12:9-19)\n-3  : foo (Debugger3.hs:12:1-19)\n-4  : bar (Debugger3.hs:15:9-17)\n-5  : bar (Debugger3.hs:15:1-17)\n-6  : main (Debugger3.hs:18:15-19)\n-7  : main (Debugger3.hs:18:8-20)\n&lt;end of history&gt;\n[Debugger3.hs:9:4-18] *Debugger3&gt; :back\nLogged breakpoint at Debugger3.hs:(8,1)-(9,18)\n_result :: a\n[-1: Debugger3.hs:(8,1)-(9,18)] *Debugger3&gt; :back\nLogged breakpoint at Debugger3.hs:12:9-19\n_result :: Int\nn :: Int\n[-2: Debugger3.hs:12:9-19] *Debugger3&gt; n\n1\n</code></pre>\n"}], "owner": {"reputation": 7230, "user_id": 788337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wiVpx.png?s=128&g=1", "display_name": "jmite", "link": "https://stackoverflow.com/users/788337/jmite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 10, "last_activity_date": 1448095507, "creation_date": 1448090594, "last_edit_date": 1448090910, "question_id": 33840818, "link": "https://stackoverflow.com/questions/33840818/can-i-use-overlappinginstances-to-get-nicer-error-messages", "title": "Can I use OverlappingInstances to get nicer error messages?", "body": "<p>I'm currently dealing with some Haskell code that I didn't write, but that I've made changes to. After my changes, I run the program and get the following error message:</p>\n\n<pre><code>Prelude.!!: index too large\n</code></pre>\n\n<p>The call to <code>!!</code> is not in my code, so refactoring it away is more work than I want to do, if I can avoid it.</p>\n\n<p>What I'd like is to do something like this:</p>\n\n<pre><code>class PrintList a where\n  (!!) :: [a] -&gt; Int -&gt; a\n\ninstance (Show a) =&gt; PrintList a where\n  l (!!) n = if n &lt; (length l) \n             then (l Prelude.!! n)\n             else error (\"Index \" ++ show n ++ \" out of bounds in \" ++ show l )\n\ninstance PrintList a where\n  (!!) = Prelude.!!\n</code></pre>\n\n<p>i.e. the function <code>!!</code> is defined for every possible list type, but it behaves differently whenever a Show instance is defined for the element type.</p>\n\n<p>Alternately, a <code>tryShow :: a -&gt; Maybe String</code> method would also do the trick.</p>\n\n<p>Is there a way to do this? Can I force OverlappingInstances to use the default implementation only when the Show implementation does not apply? Is this guaranteed behaviour?</p>\n\n<p>EDIT: bonus points for anyone who can get the error to also print a stack-trace-like message!</p>\n"}, {"tags": ["haskell", "sieve"], "comments": [{"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 1, "creation_date": 1448087797, "post_id": 33840160, "comment_id": 55445891, "body": "Please search for List Comprehensions. Also, mod is the Modulo function."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448098173, "post_id": 33840160, "comment_id": 55448148, "body": "the list-comprehension syntax is where to close to the set-syntax you would use in math - so it means <i>the list of all <code>x</code> in <code>xs</code> where <code>x `mod` p &gt; 0</code></i>"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1448106607, "post_id": 33840160, "comment_id": 55450363, "body": "I recommend reading through all of <a href=\"http://learnxinyminutes.com/docs/haskell/\" rel=\"nofollow noreferrer\">learnxinyminutes.com/docs/haskell</a> for a quick overview of the syntax."}], "answers": [{"tags": [], "owner": {"reputation": 5237, "user_id": 819720, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/5bfa5cdbed8fbe25e9fb607a3b788aa4?s=128&d=identicon&r=PG", "display_name": "Marcus Vin&#237;cius Monteiro", "link": "https://stackoverflow.com/users/819720/marcus-vin%c3%adcius-monteiro"}, "is_accepted": false, "score": 2, "last_activity_date": 1448098050, "last_edit_date": 1448098050, "creation_date": 1448097574, "answer_id": 33841708, "question_id": 33840160, "link": "https://stackoverflow.com/questions/33840160/haskell-sieve-prime-number/33841708#33841708", "title": "haskell sieve prime number", "body": "<p><code>[ x | x &lt;- xs, x `mod` p &gt; 0]</code> is a list of <code>x</code>s made of elements from <code>xs</code>, but only those elements that satisfy the <code>x `mod` p &gt; 0</code> condition (<code>mod</code> returns the <a href=\"http://www.cse.unsw.edu.au/~en1000/haskell/inbuilt.html#div\" rel=\"nofollow\">remainder after the first number is divided by the second number</a>, so you're asking for elements of <code>xs</code> that aren't divisible by <code>p</code>).</p>\n"}], "owner": {"reputation": 99, "user_id": 3453122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/d2fxp.jpg?s=128&g=1", "display_name": "carrotzoe", "link": "https://stackoverflow.com/users/3453122/carrotzoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448106522, "creation_date": 1448084911, "last_edit_date": 1448106522, "question_id": 33840160, "link": "https://stackoverflow.com/questions/33840160/haskell-sieve-prime-number", "title": "haskell sieve prime number", "body": "<p>In the following prime sieve:</p>\n\n<pre><code>primes :: [Integer]\nprimes = sieve [2..]\n  where\n    sieve (p:xs) = p : sieve [x|x &lt;- xs, x `mod` p &gt; 0]\n</code></pre>\n\n<p>What do <code>x | x &lt;- xs</code> and <code>x `mod` p &gt; 0</code> mean?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1448082732, "post_id": 33839740, "comment_id": 55444954, "body": "<code>fullGame ( r (x:xs,y:ys))</code> should be <code>fullGame r ( r (x:xs,y:ys))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3611, "user_id": 1029158, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YmuXk.jpg?s=128&g=1", "display_name": "DiegoNolan", "link": "https://stackoverflow.com/users/1029158/diegonolan"}, "is_accepted": true, "score": 2, "last_activity_date": 1448099040, "creation_date": 1448099040, "answer_id": 33841901, "question_id": 33839740, "link": "https://stackoverflow.com/questions/33839740/haskell-recursion/33841901#33841901", "title": "Haskell - Recursion", "body": "<p>There is a helpful function that almost does exactly what you are looking for.</p>\n\n<pre><code>  iterate :: (a -&gt; a) -&gt; a -&gt; [a]\n</code></pre>\n\n<p>This can successively apply your <code>RoundRule</code> function which is essentially an update function. All you have to do is stop when the game is done.</p>\n\n<pre><code>done :: ([Card],[Card]) -&gt; Bool\n</code></pre>\n\n<p>Then when you have that function your full game will be.</p>\n\n<pre><code>fullGame roundRule initState = takeWhile (not . done) (iterate roundRule initState)\n</code></pre>\n\n<p>Since Haskell is lazy it won't generate at game states beyond the end state.</p>\n"}], "owner": {"reputation": 59, "user_id": 5495763, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8cf1c15207081427bf0986f40230cc5f?s=128&d=identicon&r=PG&f=1", "display_name": "Andalib Ali", "link": "https://stackoverflow.com/users/5495763/andalib-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 2, "accepted_answer_id": 33841901, "answer_count": 1, "score": 1, "last_activity_date": 1448099040, "creation_date": 1448080336, "question_id": 33839740, "link": "https://stackoverflow.com/questions/33839740/haskell-recursion", "title": "Haskell - Recursion", "body": "<p>I am trying to make a card game that two players show there cards and the one with the highest rank wins and takes the card.(War Card Game). The trouble i am having is running the whole game, to see the final result of who the winner is. I have made the code that can do one round of the game:</p>\n\n<pre><code>type ComparisonRule = Card -&gt; Card -&gt; Bool\ntype RoundRule = ([Card],[Card]) -&gt; ([Card],[Card])\n\nstandardComparison :: ComparisonRule\nstandardComparison (Card r1 _) (Card r2 _)\n    | r1 &gt; r2  = True\n    |otherwise = False\n\nroundWithoutWar :: ComparisonRule -&gt; RoundRule\nroundWithoutWar f (x:xs,y:ys)\n        |f x y     = (xs ++ [x] ++ [y],ys)\n        |f y x     = (xs,ys ++ [y] ++ [x])\n        |otherwise = (xs,ys)\n</code></pre>\n\n<p>I use</p>\n\n<pre><code>standardRound :: RoundRule\nstandardRound =  roundWithoutWar standardComparison\nto run one round of the game.\n</code></pre>\n\n<p>I am trying to make a full game function that would run the rounds in recursion until someone wins(the winner is the person with the most cards):</p>\n\n<pre><code>fullGame :: RoundRule -&gt; ([Card],[Card]) -&gt; [([Card],[Card])]\nfullGame r  ([],[]) = [([],[])]\nfullGame r ([],y:ys)        = [([],y:ys)]\nfullGame r (x:xs,[])      = [(x:xs,[])]\nfullGame r (x:xs,y:ys)       = (x:xs,y:ys) : fullGame ( r (x:xs,y:ys))\n</code></pre>\n\n<p>\"r\" being the single round function (StandardRound) However, i get an error when i try to run the full game function</p>\n\n<pre><code> War_Project_2.hs:138:46:\n    Couldn't match expected type \u2018[([Card], [Card])]\u2019\n                with actual type \u2018([Card], [Card]) -&gt; [([Card], [Card])]\u2019\n    Probable cause: \u2018fullGame\u2019 is applied to too few arguments\n    In the second argument of \u2018(:)\u2019, namely\n      \u2018fullGame (r (x : xs, y : ys))\u2019\n    In the expression: (x : xs, y : ys) : fullGame (r (x : xs, y : ys))\n\nWar_Project_2.hs:138:57:\n    Couldn't match type \u2018([Card], [Card])\u2019\n                   with \u2018([Card], [Card]) -&gt; ([Card], [Card])\u2019\n\n    Expected type: RoundRule\n      Actual type: ([Card], [Card])\n    Possible cause: \u2018r\u2019 is applied to too many arguments\n    In the first argument of \u2018fullGame\u2019, namely \u2018(r (x : xs, y : ys))\u2019\n    In the second argument of \u2018(:)\u2019, namely\n      \u2018fullGame (r (x : xs, y : ys))\u2019\n</code></pre>\n\n<p>The point free function i tried to write to run the fullgame is:</p>\n\n<pre><code>simpleFullGame ::([Card],[Card]) -&gt; [([Card],[Card])]\nsimpleFullGame = fullGame simpleRound\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "type-signature"], "answers": [{"tags": [], "owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "is_accepted": true, "score": 1, "last_activity_date": 1448079910, "creation_date": 1448079910, "answer_id": 33839708, "question_id": 33839636, "link": "https://stackoverflow.com/questions/33839636/ghc-constraint-in-type-signature-invalid/33839708#33839708", "title": "GHC - constraint in type signature invalid", "body": "<p>The part before <code>=&gt;</code> is a constraint and must contain type classes, while <code>NestedList</code> is just a type. What you wanted to write is</p>\n\n<pre><code>flatten :: NestedList a -&gt; [a]\n</code></pre>\n"}], "owner": {"reputation": 1286, "user_id": 732923, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/6a220dacb5ddcd34c38e6333c36c43f3?s=128&d=identicon&r=PG", "display_name": "Jay", "link": "https://stackoverflow.com/users/732923/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 33839708, "answer_count": 1, "score": 0, "last_activity_date": 1448079910, "creation_date": 1448079159, "question_id": 33839636, "link": "https://stackoverflow.com/questions/33839636/ghc-constraint-in-type-signature-invalid", "title": "GHC - constraint in type signature invalid", "body": "<p>I'm trying to load the following definition</p>\n\n<pre><code>data NestedList a = Elem a | List [NestedList a]\nflatten :: (NestedList a) =&gt; a -&gt; [a]\nflatten (Elem x) = [x]\n</code></pre>\n\n<p>But GHC is giving an error</p>\n\n<pre><code>Expected a constraint, but 'NestedList a' has kind '*'\nIn the type signature for 'flatten'\n</code></pre>\n\n<p>Is there something missing or invalid in the type signature? </p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["haskell", "types", "higher-order-functions"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1448050781, "post_id": 33835386, "comment_id": 55436039, "body": "You can do this with some <code>OverlappingInstances</code> trickery (perhaps even with less controversial extensions), but I doubt it&#39;s a good idea. Why don&#39;t you just use the list-accepting function as it is?"}, {"owner": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1448050959, "post_id": 33835386, "comment_id": 55436139, "body": "Regarding &quot;Why?&quot;: the question whether this is possible or not just popped into my head --&gt; I&#39;m asking for educational reasons (maybe also learn some new Haskell magic, while trying to figure out a solution). I&#39;m a bit confused as to which &quot;list accepting function&quot; you&#39;re refering to. I have a function f :: a -&gt; a -&gt; ... a -&gt; b (with a unknown number of &#39;a&#39;s) and want a function f&#39; :: [a] -&gt; b, such that f x1 ... xr = f&#39; [x1, ...., xr]. Thus, I don&#39;t have a list accepting function, I want one! But probably I didn&#39;t get what you really meant."}, {"owner": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1448051243, "post_id": 33835386, "comment_id": 55436304, "body": "What exactly would you do with <code>OverlappingInstances</code> to make it work? I don&#39;t see any way to do it."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1448051374, "post_id": 33835386, "comment_id": 55436375, "body": "Well, yes, it is possible, it&#39;s basically the dual problem to a variadic signature like <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Printf.html#v:printf\" rel=\"nofollow noreferrer\"><code>printf</code></a>. However, this kind of polymorphism often leads to problems. In particular, your proposal circumvents the compiler&#39;s type-checking: by deferring a fixed number of arguments to being taken from a runtime-length list, the compiler can&#39;t check that there are enough arguments, so you&#39;ll need a sensible error case... An application where I could see this useful is parsing, but this is better done with <i>parser combinators</i>!"}, {"owner": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1448051882, "post_id": 33835386, "comment_id": 55436611, "body": "With the &quot;to little arugements&quot; you&#39;re of course right. I just thought &quot;Well... just return a partly applied function.&quot;. But I&#39;m seeing just now, that this of course doesn&#39;t type check (maybe even thats possible? I mean returning a partially applied function if the list is too short). Regarding usefulness: I don&#39;t really care for applications/usefulness/dangers of such a function. I&#39;m merely interested on how to do it (I&#39;m hoping to acquire some knew Haskell knowledge + I think that <code>listify</code> just intersting ;))."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "edited": false, "score": 0, "creation_date": 1448052871, "post_id": 33835721, "comment_id": 55437105, "body": "Thanks for the solution! &quot;need for those local explicit type signatures&quot; yeah thats rather ugly. Do you know if there is any better way to do it? I mean the idea of <code>f x1 ... xr = f&#39; [x1, ..., xr]</code> is sound (even with partial application in mind). If there is no way to do that &quot;nicely&quot; in Haskell this would be the first case I experience of &quot;mathematically easily expressed, but very hard to implement&quot; (very hard meaning: either dangerous or just completely ugly). Do you maybe know a language where it can be expressed easily &amp; safely?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "edited": false, "score": 0, "creation_date": 1448053183, "post_id": 33835721, "comment_id": 55437223, "body": "The problem is that functions with different numbers of arguments have different types, while lists of different length have all the same type. Types only exist at compile time, list-lengths only exist at runtime. \u2014 And, no, I don&#39;t agree this is \u201cmathematically easily expressed\u201d: <i>what are</i> <code>f</code> and <code>f&#39;</code> in your statement? What you really mean is, it can be easily expressed in a dynamically-typed language. Well, you can <a href=\"https://en.wikibooks.org/wiki/Write_Yourself_a_Scheme_in_48_Hours\" rel=\"nofollow noreferrer\">easily implement a dynamic language in Haskell</a>! But you loose all the benefits of static types."}, {"owner": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "edited": false, "score": 0, "creation_date": 1448054410, "post_id": 33835721, "comment_id": 55437787, "body": "I can express it as follows. Let X, Y be non empty sets, define Fn indutively as Fn := {X -&gt; F(n-1)}, where F1 := {X -&gt; Y}. Let F be the union of all Fn for n, natural number greater than 0. Furthermore, consider the set L := (union {n = 0, to inf.} X^n) union {N -&gt; X}, where N are the natural numbers (L &quot;=&quot; {[X]}). f in F implies f in An for some n. Define f&#39; : L -&gt; (union {n = 1, to inf.} An) union Y as follows: for each args in L, r := &quot;length&quot; args:  f&#39; args := (...(f(args_1))(args_2) ... (args_max(n,r)). This determines f&#39; uniquely &amp; is well defined."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "edited": false, "score": 0, "creation_date": 1448055353, "post_id": 33835721, "comment_id": 55438193, "body": "Nice. (Not <i>that</i> easy though, is it?) Well, Andr&#225;s Kov&#225;cs demonstrated how to express this unique type-mapping in Haskell with either <code>OverlappingInstances</code> or closed type families (which really does look a lot like your mathematical definition). I persist, however, that you should probably better avoid all of this, by simply not listifying your functions..."}, {"owner": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "edited": false, "score": 0, "creation_date": 1448055643, "post_id": 33835721, "comment_id": 55438330, "body": "The formalized version probably looks a lot cleaner/easier in &quot;non ASCII math&quot; ; ) - I can not even see a single sane reason to listify my functions; probably code golf could in some circumstances be a reason if &quot;listify&quot; was part of the standard library (meaning: safe &amp; easy to use)."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 5, "last_activity_date": 1448052489, "last_edit_date": 1448052489, "creation_date": 1448052105, "answer_id": 33835721, "question_id": 33835386, "link": "https://stackoverflow.com/questions/33835386/haskell-a-a-b-to-a-b/33835721#33835721", "title": "Haskell: a -&gt; a -&gt; ... -&gt; b to [a] -&gt; b", "body": "<p>Actually it's quite simple, doesn't even require overlapping instances:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses, FlexibleInstances #-}\n\nclass Listifiable f a b where\n  listify :: f -&gt; [a] -&gt; b\n\ninstance Listifiable b a b where\n  listify = const\n\ninstance (Listifiable f) a b =&gt; Listifiable (a-&gt;f) a b where\n  listify f (x:xs) = listify (f x) xs\n</code></pre>\n\n<p>Then you can do</p>\n\n<pre><code>GHCi&gt; listify ((+) :: Int-&gt;Int-&gt;Int) [1,2 :: Int] :: Int\n3\n</code></pre>\n\n<p>But the need for those local explicit type signatures quite shows the problems you're getting yourself in.</p>\n\n<p>(It might be possible to alleviate this problem with <code>FunctionalDependencies</code>, but at least not in a straightforward way.)</p>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "edited": false, "score": 1, "creation_date": 1448055186, "post_id": 33836286, "comment_id": 55438122, "body": "Especially the last one is pretty cool! That&#39;s extremeply close to how I imagined it should be (only &quot;flaw&quot; I can see are the explicit type annotations). What is the customary here? If I consider your answer to be better than the previously accepted one, am I allowed/supposed to instead accept yours?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "edited": false, "score": 2, "creation_date": 1448055623, "post_id": 33836286, "comment_id": 55438322, "body": "@morris: yes, you&#39;re supposed to accept the best answer, not the earliest."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "edited": false, "score": 0, "creation_date": 1448056128, "post_id": 33836286, "comment_id": 55438555, "body": "@morris: note that in the above solutions we only need type annotations (except with incoherent instances, because there GHC wriggles its way through either way) if the argument type is polymorphic. In the examples, the number literals have polymorphic type <code>Num a =&gt; a</code>, but it always works with <code>Bool</code> annotation-free, for example."}, {"owner": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "edited": false, "score": 1, "creation_date": 1448056483, "post_id": 33836286, "comment_id": 55438728, "body": "@Andr&#225;sKov&#225;cs : Do you think it&#39;s possible to incorporate partial application into <code>listify</code>? I mean stuff like <code>listify (+) [1]</code> (whoch should be equal to <code>(+) 1</code>)."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "edited": false, "score": 0, "creation_date": 1448056522, "post_id": 33836286, "comment_id": 55438748, "body": "@morris as a general rule you should avoid accepting an answer right away. Wait some time, even 1 day. For a simple reason: once an answer is accepted the chances of receiving other answers go down. But you generally don&#39;t know whether there <i>could</i> be much better answers than the current one."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 9, "last_activity_date": 1448055345, "last_edit_date": 1448055345, "creation_date": 1448054593, "answer_id": 33836286, "question_id": 33835386, "link": "https://stackoverflow.com/questions/33835386/haskell-a-a-b-to-a-b/33836286#33836286", "title": "Haskell: a -&gt; a -&gt; ... -&gt; b to [a] -&gt; b", "body": "<p>We just have to pick our poison here. If we use less safe pragmas, we can get more inference, and vice versa; there's a number of combinations.</p>\n\n<p><strong>First</strong>: uses overlapping instances, has non-functions as base case, but can't handle polymorphic <code>a</code> types:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses, TypeFamilies, FlexibleInstances #-}\n\nclass Listify a b where\n  listify :: a -&gt; b  \n\ninstance {-# OVERLAPS #-} r ~ ([a] -&gt; b) =&gt; Listify b r where\n  listify = const\n\ninstance (Listify f r, r ~ ([a] -&gt; b)) =&gt; Listify (a -&gt; f) r where\n  listify f (a:as) = listify (f a) as\n\n-- listify (+) [0, 2] -- error\n-- listify (+) [0, 2 :: Int] -- OK\n-- listify () [] -- OK\n</code></pre>\n\n<p><strong>Second</strong>: uses overlapping instances, has functions as base case, can handle polymorphic types:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses, TypeFamilies, FlexibleInstances, FlexibleContexts #-}\n\nclass Listify a b where\n  listify :: a -&gt; b  \n\ninstance {-# OVERLAPS #-} r ~ ([a] -&gt; b) =&gt; Listify (a -&gt; b) r where\n  listify f (a:_) = f a\n\ninstance (Listify (a -&gt; b) r, r ~ ([a] -&gt; b)) =&gt; Listify (a -&gt; a -&gt; b) r where\n  listify f (a:as) = listify (f a) as\n\n-- listify (+) [0, 2] -- OK\n-- listify () [] -- error, first arg must be a function\n</code></pre>\n\n<p><strong>Third</strong>: uses incoherent instances, has values in base case, can handle polymorphic types:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses, TypeFamilies, FlexibleInstances #-}\n\nclass Listify a b where\n  listify :: a -&gt; b  \n\ninstance {-# INCOHERENT #-} r ~ ([a] -&gt; b) =&gt; Listify b r where\n  listify = const\n\ninstance (Listify f r, r ~ ([a] -&gt; b)) =&gt; Listify (a -&gt; f) r where\n  listify f (a:as) = listify (f a) as\n\n-- listify 0 [] -- OK\n-- listify (+) [2, 4] -- OK\n</code></pre>\n\n<p><strong>Fourth</strong>: uses closed type families with <code>UndecidableInstances</code> as helper for instance resolution, has values in base case, can't handle polymorphic types:</p>\n\n<pre><code>{-# LANGUAGE UndecidableInstances, ScopedTypeVariables, DataKinds,\n    TypeFamilies, MultiParamTypeClasses, FlexibleInstances, FlexibleContexts #-}\n\nimport Data.Proxy\n\ndata Nat = Z | S Nat\n\ntype family Arity f where\n  Arity (a -&gt; b) = S (Arity b)\n  Arity b        = Z\n\nclass Listify (n :: Nat) a b where\n  listify' :: Proxy n -&gt; a -&gt; b\n\ninstance r ~ (a -&gt; b) =&gt; Listify Z b r where\n  listify' _ = const\n\ninstance (Listify n f r, a ~ (a' -&gt; f), r ~ ([a'] -&gt; b)) =&gt; Listify (S n) a r where\n  listify' _ f (a:as) = listify' (Proxy :: Proxy n) (f a) as\n\nlistify :: forall a b. Listify (Arity a) a b =&gt; a -&gt; b\nlistify = listify' (Proxy :: Proxy (Arity a))\n\n-- listify (+) [3, 4] -- error\n-- listify (+) [3, 4::Int] -- OK\n-- listify () [] -- OK\n-- listify 0 [] -- error\n-- listify (0 :: Int) [] -- OK\n</code></pre>\n\n<p>From the top of my head, roughly these are the variants one can see in the wild, except for the <code>INCOHERENT</code> one, because that's extremely rare in library code (for good reasons). </p>\n\n<p>I personally recommend the version with the closed type families, because <code>UndecidableInstances</code> and type families are by far the least controversial as language extensions, and they still provide a fair amount of usability. </p>\n"}], "owner": {"reputation": 83, "user_id": 5587228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f29d195d5677739dfd8c2cfdb35a892a?s=128&d=identicon&r=PG&f=1", "display_name": "morris", "link": "https://stackoverflow.com/users/5587228/morris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 2, "closed_date": 1448070623, "accepted_answer_id": 33836286, "answer_count": 2, "score": 8, "last_activity_date": 1448055345, "creation_date": 1448050598, "question_id": 33835386, "link": "https://stackoverflow.com/questions/33835386/haskell-a-a-b-to-a-b", "closed_reason": "Duplicate", "title": "Haskell: a -&gt; a -&gt; ... -&gt; b to [a] -&gt; b", "body": "<p>I'm trying to express the following map as a Haskell function:</p>\n\n<p>Given two types <code>a, b</code> consider the family of functions <code>F(a, b)</code> consisting of functions of the type </p>\n\n<pre><code>f :: a -&gt; a -&gt; ... -&gt; a -&gt; b\n</code></pre>\n\n<p>with <code>n</code> repetitions of <code>a</code>, where <code>n</code> is an integer greater than zero.\nWhat I want is to map each function <code>f</code> in <code>F(a, b)</code> to a function <code>f' :: [a] -&gt; b</code>, such that <code>f x1 x2 ... xr = f' [x1, ..., xr]</code>, where <code>r</code> is smaller than the number of arguments <code>f</code> takes (i.e. I'm looking for the function <code>listify :: F(a, b) -&gt; ([a] -&gt; b)</code>). If there are more elements than <code>f</code> takes arguments, the additional elements should be discarded: </p>\n\n<pre><code>f :: a -&gt; a -&gt; b\n(listify f xs) == (listify f $ take 2 xs)\n</code></pre>\n\n<p>Furthermore, if the empty listed is passed, any value is acceptable.</p>\n\n<p>I'm of course able to implement this map for functions with a fixed number of arguments (for example:  <code>listify :: (a -&gt; a -&gt; b) -&gt; ([a] -&gt; b)</code>, etc.), but I couldn't find a way to write a function that does it for all <code>f</code> in <code>F(a, b)</code> simultaneously. Even though Template Haskell is probably able to provide me with the right tools, I'm not interested in such a solution. I want to find some pure \"type magic\" way to do it. </p>\n\n<p>Does anyone know if that's even possible? Can someone maybe point me in the right direction? Or is this a known \"problem\" which has been solved billions of times and I'm just unable to find a solution?</p>\n"}, {"tags": ["haskell", "lambda"], "comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 10, "creation_date": 1448040889, "post_id": 33832706, "comment_id": 55430541, "body": "Because you can generally insert arbitrary many spaces between two tokens. Backslash is one token, <code>x</code> is another one."}, {"owner": {"reputation": 3566, "user_id": 4325010, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/048bff2cd5cae6d0a93ecd485f6690ad?s=128&d=identicon&r=PG&f=1", "display_name": "users at 4325010", "link": "https://stackoverflow.com/users/4325010/users-at-4325010"}, "edited": false, "score": 0, "creation_date": 1448153432, "post_id": 33832706, "comment_id": 55465375, "body": "Haskell is based on Lambda Calculus in its core. That&#39;s why such anonymous functions are possible. Basically it is achieved by Beta-reduction in <code>\\r -&gt; x</code>, where <code>r</code> is the formal parameter. Here &#39;r&#39; is not bounded. However in the inc. function <code>\\x -&gt; + x 1</code> x is bounded and that means that the value of x is passed onto the variable &#39;x&#39; and after a Delta-reduction it&#39;s incremented."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1448042495, "last_edit_date": 1448042495, "creation_date": 1448040959, "answer_id": 33832770, "question_id": 33832706, "link": "https://stackoverflow.com/questions/33832706/what-does-backslash-space-mean-in-haskell/33832770#33832770", "title": "What does backslash space mean in Haskell", "body": "<p>There is no difference: <code>\\ r -&gt; x</code> or <code>\\r -&gt; x</code> have the same meaning, much as <code>1+1</code> and <code>1 + 1</code> have the same meaning. Whitespace after <code>\\</code> is irrelevant.</p>\n\n<p>So, <code>return x</code> is just <code>\\r -&gt; x</code>, which is a function which takes a parameter <code>r</code>, ignores it, and yields <code>x</code>.</p>\n\n<p>Moreover, since <code>r</code> gets ignored, we tend to write <code>\\ _ -&gt; x</code> (or <code>const x</code> - which is defined as <code>const x _ = x</code>) instead.</p>\n"}], "owner": {"reputation": 1703, "user_id": 2757620, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/wFg9k.jpg?s=128&g=1", "display_name": "qartal", "link": "https://stackoverflow.com/users/2757620/qartal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 33832770, "answer_count": 1, "score": 3, "last_activity_date": 1448135630, "creation_date": 1448040741, "last_edit_date": 1448135630, "question_id": 33832706, "link": "https://stackoverflow.com/questions/33832706/what-does-backslash-space-mean-in-haskell", "title": "What does backslash space mean in Haskell", "body": "<p>I know that something like <code>\\x-&gt;x+1</code> is an anonymous function definition that gets an x and adds one to it. But I saw the expression <code>return x = (\\ r -&gt; x)</code> when I was reading an article <a href=\"https://www.quora.com/Functional-Programming/What-are-monads-and-why-are-they-useful\" rel=\"nofollow\">here</a>.</p>\n\n<p>What does <code>(\\ r -&gt; x)</code> mean? Why after backslash is empty? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1448039210, "post_id": 33831602, "comment_id": 55429614, "body": "just a comment: the higher order functions like <code>map</code>, <code>filter</code>, <code>foldx</code>, ... in a way hide away the <i>pattern matching</i> part - therefore you usually won&#39;t want to pattern match on the list you are using for those functions (see the good answer below) - also you should accept it (the answer) if it solves your question"}, {"owner": {"reputation": 595, "user_id": 5382921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ebe30bbd2ea94a919248b716ffd4ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kushal Shinde", "link": "https://stackoverflow.com/users/5382921/kushal-shinde"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448039534, "post_id": 33831602, "comment_id": 55429803, "body": "@Carsten Thank you :)"}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448039078, "post_id": 33831680, "comment_id": 55429527, "body": "you should probably rename <code>x</code> to <code>xs</code> here (as you did with <code>ys</code> I guess you just forgot)"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 1, "creation_date": 1448039799, "post_id": 33831680, "comment_id": 55429952, "body": "Why not just define <code>my_map f = foldr ((:) . f) []</code>?"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 1, "creation_date": 1448039887, "post_id": 33831680, "comment_id": 55429999, "body": "If you want to get really pointless then try <code>flip foldr [] . ((:) .)</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 1, "creation_date": 1448040262, "post_id": 33831680, "comment_id": 55430210, "body": "@AaditMShah <i>pointless</i> ;) ... I think beginners (probably not only those) will have a hard(er) time reading and understanding this"}, {"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1448040741, "post_id": 33831680, "comment_id": 55430456, "body": "@Carsten You mean use xs rather than x to inricate its a list?"}], "tags": [], "owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "is_accepted": true, "score": 4, "last_activity_date": 1448050200, "last_edit_date": 1448050200, "creation_date": 1448037446, "answer_id": 33831680, "question_id": 33831602, "link": "https://stackoverflow.com/questions/33831602/map-function-using-foldl-or-foldr-in-haskell/33831680#33831680", "title": "map function using foldl or foldr in Haskell", "body": "<p>You are using the (x:xs) pattern in your arguments, but when you apply the fold, you only apply it to the xs part, which means your first element i.e. the one that x represents never gets processed. You need to change it to this:</p>\n\n<pre><code>my_map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmy_map f xs = foldr (\\y ys -&gt; (f y):ys) [] xs\n</code></pre>\n\n<p>Since you are using <code>foldr</code>, you do not need to explicitly handle the empty list case. Moreoever, you do not need to specify the list in (x:xs) format.</p>\n\n<p>Finally, my own preference is to avoid using the same name for function inputs and any helper functions or expressions in the function definition.That is why, I have used <code>xs</code> for the input list and <code>y</code> and <code>ys</code> for the parameters passed to the lambda.</p>\n"}], "owner": {"reputation": 595, "user_id": 5382921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ebe30bbd2ea94a919248b716ffd4ee?s=128&d=identicon&r=PG&f=1", "display_name": "Kushal Shinde", "link": "https://stackoverflow.com/users/5382921/kushal-shinde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1673, "favorite_count": 0, "accepted_answer_id": 33831680, "answer_count": 1, "score": 1, "last_activity_date": 1448050200, "creation_date": 1448037193, "last_edit_date": 1448039265, "question_id": 33831602, "link": "https://stackoverflow.com/questions/33831602/map-function-using-foldl-or-foldr-in-haskell", "title": "map function using foldl or foldr in Haskell", "body": "<p>I am writing a function my_map which takes a unary function and a list and returns the list resulting from mapping the function over all elements of the input list.</p>\n\n<pre><code>Main&gt; my_map (^3) [1..5]\n\n[1,8,27,64,125]\n</code></pre>\n\n<p>I tried it like this:</p>\n\n<pre><code>my_map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmy_map f [] = []\nmy_map f (x:xs) = foldr (\\x xs -&gt; (f x):xs) [] xs\n</code></pre>\n\n<p>But after running above, I get only <code>[8,27,64,125]</code>. the first number <code>1</code> is not displaying in output. </p>\n\n<p>Can anybody help me?</p>\n"}, {"tags": ["loops", "haskell", "recursion", "repeat"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 2, "creation_date": 1448033309, "post_id": 33830287, "comment_id": 55425558, "body": "You&#39;re the 2nd person from the same university course I&#39;m going to answer to - <a href=\"http://stackoverflow.com/questions/33736975/how-to-define-an-n-sided-polygon-function-in-haskell/33738198#33738198\">here&#39;s the first answer</a>. Or wait, it&#39;s an exact duplicate. If you think there&#39;s something you don&#39;t know that isn&#39;t answered there, please post a comment."}, {"owner": {"reputation": 94, "user_id": 5504651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/36f9632b5e73c225475a644e029ead84?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5504651/james"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1448033531, "post_id": 33830287, "comment_id": 55425703, "body": "Wow, my bad, thanks anyway."}], "owner": {"reputation": 94, "user_id": 5504651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/36f9632b5e73c225475a644e029ead84?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5504651/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "closed_date": 1448033485, "answer_count": 0, "score": 0, "last_activity_date": 1448033181, "creation_date": 1448033181, "question_id": 33830287, "link": "https://stackoverflow.com/questions/33830287/haskell-how-to-create-a-function-which-will-repeat-a-line-of-code-n-times", "closed_reason": "Duplicate", "title": "Haskell - How to create a function which will repeat a line of code n times", "body": "<p>Firstly, I would like to explain that this problem is mainly due to my difficulty in understanding how to avoid the requirement for a 'for' loop in functional programming in general.</p>\n\n<p>I know that this is a very common problem which newbies to functional programming have, and I have spent hours trawling through posts similar to this. However I still have not yet found a solution to my particular problem.</p>\n\n<p><strong>I have the following problem:</strong> </p>\n\n<p>I am using a simple 2d graphics window with pre made Haskell commands to control a cursor which will trace a line on the screen wherever the cursor moves.</p>\n\n<p>I am attempting to create a function which will cause the cursor to trace a regular polygon with n sides.</p>\n\n<p>This involves repeating the following line of code n times:</p>\n\n<pre><code>Fd 1 :&gt; Rt (360/(fromIntegral n))\n</code></pre>\n\n<p>This code says: \"move forward (forward is relative to the current <em>direction</em> of the cursor) by 1 unit\" and then: \"turn the cursor clockwise by 360/n degrees\".</p>\n\n<p>Obviously I now need to create a function which can repeat the above line of code n times to create the regular polygon.</p>\n\n<p>I have tried several approaches to solve the problem recursively however the best I can currently manage is the following:</p>\n\n<pre><code>rep :: (Eq a, Integral a) =&gt; a -&gt; Command -&gt; Command\nrep 1 action = action\nrep n action = rep (n-1) action \n</code></pre>\n\n<p>As it is, this code compiles fine and will ultimately recurse all the way back to n=1 where it will perform the action once (the action will be the first line of code)</p>\n\n<p>I instinctively want to get the last line of that code to simultaneously, perform the action <em>and</em> call itself with n-1 and action as parameters. But I don't know if this is possible or if it is even the best way of achieving what I want to accomplish.</p>\n\n<p>Any insight anyone can give me on this problem would be appreciated, thanks.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 842, "user_id": 90651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91ec8980f6d1db63e0c7bd3073cba264?s=128&d=identicon&r=PG&f=1", "display_name": "Umair", "link": "https://stackoverflow.com/users/90651/umair"}, "edited": false, "score": 0, "creation_date": 1448070678, "post_id": 33829812, "comment_id": 55442912, "body": "Thank you for the tips. When I used g in place of u &amp; v, it made sense to my head, but now I cannot think why I chose to do so. Your suggestion of reducing LHS and RHS independently certainly helped, and I was able to solve the Interchange equation. As a Haskell beginner, I will need to spend some time with the Composition lambdas before I&#39;m done."}, {"owner": {"reputation": 842, "user_id": 90651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91ec8980f6d1db63e0c7bd3073cba264?s=128&d=identicon&r=PG&f=1", "display_name": "Umair", "link": "https://stackoverflow.com/users/90651/umair"}, "edited": false, "score": 0, "creation_date": 1451517724, "post_id": 33829812, "comment_id": 56819835, "body": "I couldn&#39;t post my attempt for the Composition law here, as I couldn&#39;t format the code correctly. Instead, I have posted a new follow-up question: <a href=\"http://stackoverflow.com/questions/34538754/proving-composition-applicative-law-for-r-type\" title=\"proving composition applicative law for r type\">stackoverflow.com/questions/34538754/&hellip;</a>"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1448031650, "creation_date": 1448031650, "answer_id": 33829812, "question_id": 33829415, "link": "https://stackoverflow.com/questions/33829415/applicative-laws-for-the-r-type/33829812#33829812", "title": "Applicative Laws for the ((-&gt;) r) type", "body": "<p>I think in your \"Identity\" proof, you should replace <code>g</code> with <code>v</code> everywhere (otherwise what is <code>g</code> and where did it come from?). Similarly, in your \"Interchange\" proof, things look okay so far, but the <code>g</code> that magically appears should just be <code>u</code>. To continue that proof, you could start reducing the RHS and verify that it also produces <code>\\x -&gt; u x y</code>.</p>\n\n<p>Composition is more of the same: plug in the definitions of <code>pure</code> and <code>(&lt;*&gt;)</code> on both sides, then start calculating on both sides. You'll soon come to some bare lambdas that will be easy to prove equivalent.</p>\n"}], "owner": {"reputation": 842, "user_id": 90651, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/91ec8980f6d1db63e0c7bd3073cba264?s=128&d=identicon&r=PG&f=1", "display_name": "Umair", "link": "https://stackoverflow.com/users/90651/umair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 33829812, "answer_count": 1, "score": 2, "last_activity_date": 1448031650, "creation_date": 1448030559, "question_id": 33829415, "link": "https://stackoverflow.com/questions/33829415/applicative-laws-for-the-r-type", "title": "Applicative Laws for the ((-&gt;) r) type", "body": "<p>I'm trying to check that the Applicative laws hold for the function type <code>((-&gt;) r)</code>, and here's what I have so far:</p>\n\n<pre><code>-- Identiy\npure (id) &lt;*&gt; v = v \n-- Starting with the LHS\npure (id) &lt;*&gt; v\nconst id &lt;*&gt; v\n(\\x -&gt; const id x (g x))\n(\\x -&gt; id (g x))\n(\\x -&gt; g x)\ng x\nv\n\n\n-- Homomorphism\npure f &lt;*&gt; pure x = pure (f x)\n-- Starting with the LHS\npure f &lt;*&gt; pure x\nconst f &lt;*&gt; const x\n(\\y -&gt; const f y (const x y))\n(\\y -&gt; f (x))\n(\\_ -&gt; f x)\npure (f x)\n</code></pre>\n\n<p>Did I perform the steps for the first two laws correctly?</p>\n\n<p>I'm struggling with the interchange &amp; composition laws. For interchange, so far I have the following:</p>\n\n<pre><code>-- Interchange\nu &lt;*&gt; pure y = pure ($y) &lt;*&gt; u\n-- Starting with the LHS\nu &lt;*&gt; pure y\nu &lt;*&gt; const y\n(\\x -&gt; g x (const y x))\n(\\x -&gt; g x y)\n-- I'm not sure how to proceed beyond this point.\n</code></pre>\n\n<p>I would appreciate any help for the steps to verify the Interchange &amp; Composition applicative laws for the <code>((-&gt;) r)</code> type. For reference, the Composition applicative law is as follows:</p>\n\n<pre><code>pure (.) &lt;*&gt; u &lt;*&gt; v &lt;*&gt; w = u &lt;*&gt; (v &lt;*&gt; w)\n</code></pre>\n"}, {"tags": ["user-interface", "haskell"], "comments": [{"owner": {"reputation": 31108, "user_id": 350351, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b1a41bbf4677c8961237c4d147e764d6?s=128&d=identicon&r=PG", "display_name": "Daenyth", "link": "https://stackoverflow.com/users/350351/daenyth"}, "edited": false, "score": 1, "creation_date": 1448024779, "post_id": 33827040, "comment_id": 55419761, "body": "I&#39;m not familiar with the library you&#39;re using but I expect that you&#39;re overwriting individual values instead of accumulating a list of values to display. <code>a&lt;-forM [1..30] (\\t -&gt; labelSetText (display gui) (show $ fib t))</code>"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 31108, "user_id": 350351, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b1a41bbf4677c8961237c4d147e764d6?s=128&d=identicon&r=PG", "display_name": "Daenyth", "link": "https://stackoverflow.com/users/350351/daenyth"}, "edited": false, "score": 0, "creation_date": 1448028298, "post_id": 33827040, "comment_id": 55422057, "body": "Yes, the expected behaviour is to display the values as soon as they are computed"}, {"owner": {"reputation": 31108, "user_id": 350351, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b1a41bbf4677c8961237c4d147e764d6?s=128&d=identicon&r=PG", "display_name": "Daenyth", "link": "https://stackoverflow.com/users/350351/daenyth"}, "edited": false, "score": 0, "creation_date": 1448028690, "post_id": 33827040, "comment_id": 55422308, "body": "And if you compute them too quickly? Suppose that all computations are finished in 0.1 seconds, how should it be displayed?"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 31108, "user_id": 350351, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b1a41bbf4677c8961237c4d147e764d6?s=128&d=identicon&r=PG", "display_name": "Daenyth", "link": "https://stackoverflow.com/users/350351/daenyth"}, "edited": false, "score": 0, "creation_date": 1448028933, "post_id": 33827040, "comment_id": 55422469, "body": "that&#39;s why I used the fibonacci suite; compute 30 terms takes a few seconds, and only after these few seconds the label&#39;s text is changed. That&#39;s why I posted this message : I think the entire suite is computed before is is displayed. But you&#39;re right : it&#39;s still a little bit quick to be sure."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1448097764, "post_id": 33827040, "comment_id": 55448025, "body": "It would be easier to help if you would could upload the code with all relevant files (i.e. the <code>xml</code> files) somewhere. Then I could test my suggestions easily :-)"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1448107569, "post_id": 33827040, "comment_id": 55450648, "body": "ok, and thanks for your help; gui haskell file : <a href=\"http://pastebin.com/G2siMdSa\" rel=\"nofollow noreferrer\">pastebin.com/G2siMdSa</a>; glade file : <a href=\"http://pastebin.com/U9n8Hw5m\" rel=\"nofollow noreferrer\">pastebin.com/U9n8Hw5m</a>. but you will have to install gtk and glade from cabal"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1448205842, "post_id": 33827040, "comment_id": 55477109, "body": "Hmm, <code>galde</code> is obsolete (no 0.13 version) and I cannot build it here. You should use <code>Graphics.UI.Gtk.Builder</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448031021, "post_id": 33829300, "comment_id": 55423960, "body": "There will be some synchronization trouble, but not much: gtk offers <code>postGUIAsync</code> (and <code>postGUISync</code>) for more convenient synchronization."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448031146, "post_id": 33829300, "comment_id": 55424055, "body": "Great. That should make a straight-forward solution based on the original code, by wrapping <code>guiAnswer</code> in a <code>forkIO</code> and wrapping the <code>labelSetText</code> inside <code>postGUIAsync</code>. Anyone care te test and post an answer?"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1448032352, "post_id": 33829300, "comment_id": 55424961, "body": "@loveley, don\u2019t forget to wrap the <code>guiAnswer</code> (or just the <code>forM</code> line) in <code>forkIO</code>."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1448033468, "post_id": 33829300, "comment_id": 55425659, "body": "sorry I don&#39;t understand how to do that. Could you show me? I get some errors concerning the mapM function (it needs forkIO[()] and not forkIO())"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1448035233, "post_id": 33829300, "comment_id": 55426951, "body": "Use <code>mapM_</code> instead of <code>mapM</code>."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1448097722, "post_id": 33829300, "comment_id": 55448010, "body": "<code>forkIO</code> returns a <code>ThreadId</code>, but <code>guiAnswer</code> should return a <code>()</code>. Either prepend the line with <code>void $</code> (from <code>Data.Functor</code>), or simply put a <code>return ()</code> in the following line."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1448104306, "post_id": 33829300, "comment_id": 55449737, "body": "Well, I can compile the result but, with postGUIAsync &amp;  forkIO, it still displays the last result only, after 10 s of computing"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1448107524, "post_id": 33829300, "comment_id": 55450633, "body": "Try compiling with <code>-threaded</code> and run with <code>+RTS -N</code>. Or make the project available somewhere so that I can help less blindly."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1448109640, "post_id": 33829300, "comment_id": 55451275, "body": "I will try to put it in FPComplete, but I&#39;m not sure of the result, because of the GTK packages. As soon as I have sth I will post here the link; maybe can I send you this link by a private message?"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1448116158, "post_id": 33829300, "comment_id": 55453384, "body": "you will find above the 2 files at pastebin. for FPcomplete, I&#39;m having a look."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": false, "score": 2, "last_activity_date": 1448030189, "creation_date": 1448030189, "answer_id": 33829300, "question_id": 33827040, "link": "https://stackoverflow.com/questions/33827040/display-the-terms-of-a-sequence-as-they-are-computed/33829300#33829300", "title": "Display the terms of a sequence as they are computed", "body": "<p>GTK is single-threaded. So while indeed your code in <code>guiAnswer</code> will call <code>labelSetText</code> as the things are being displayed, the will not actually make use of that data until <code>guiAnswer</code> returns.</p>\n\n<p>Blind guess: Try running <code>mainContextIteration mainContextDefault False</code> after <code>labelSetText</code>.</p>\n\n<p>Better guess: Run the computation in a different thread. But beware that all gtk interaction has to happen from the main thread, so you will have to go through some trouble to synchronize that.</p>\n\n<p>Many years ago I implemented such a display-as-calculation-happens functionality for a <a href=\"http://www.joachim-breitner.de/blog/292-FrakView__An_Haskell_Renderer_for_Iterated_Function_Systems\" rel=\"nofollow\">fractal renderer</a>, but I\u2019m not sure I\u2019d still advocate that style :-)</p>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448097654, "creation_date": 1448023381, "last_edit_date": 1448097654, "question_id": 33827040, "link": "https://stackoverflow.com/questions/33827040/display-the-terms-of-a-sequence-as-they-are-computed", "title": "Display the terms of a sequence as they are computed", "body": "<p>I wrote a little program that displays, in a window, the first 30 terms of the Fibonacci sequence. However, it does not work. My program (see below) computes all the terms, but only the last term is displayed. I would like to display all 30 terms, as soon as they are computed. What should I do?</p>\n\n<pre><code>module Main where\n\nimport           Control.Monad         (forM)\nimport           Graphics.UI.Gtk\nimport           Graphics.UI.Gtk.Glade\n\nfib :: Int -&gt; Integer\nfib 1 = 1\nfib 2 = 1\nfib n = fib(n-1)+fib(n-2)\n\ndata GUI = GUI {\n  mainWin :: Window,\n  clickMe :: Button,\n  display :: Label\n  }\n\nloadGlade :: IO GUI\nloadGlade = do\n  Just xml &lt;- xmlNew \"gladeFile.glade\"\n  mw &lt;- xmlGetWidget xml castToWindow \"wdwFirst\"\n  bc &lt;- xmlGetWidget xml castToButton \"btnClick\"\n  ld &lt;- xmlGetWidget xml castToLabel \"lblDisplay\"\n\n  return $ GUI mw bc ld\n\nconnectGui :: GUI -&gt; IO  (ConnectId Button)\nconnectGui gui = do\n  onDestroy (mainWin gui) mainQuit\n  onClicked (clickMe gui) (guiAnswer gui)\n\nguiAnswer :: GUI -&gt; IO()\nguiAnswer gui = do\n  a&lt;-forM [1..30] (\\t -&gt; labelSetText (display gui) (show $ fib t))\n  --labelSetText (display gui) \"WELCOME!!\"\n  putStr \"\"\n\n\nmain :: IO ()\nmain = do\n  initGUI\n  gui &lt;- loadGlade\n  connectGui gui\n  widgetShowAll (mainWin gui)\n  mainGUI\n</code></pre>\n\n<p>EDIT: </p>\n\n<p>for postGuiAsync, I tried this:</p>\n\n<pre><code>guiAnswer :: GUI -&gt; IO()\nguiAnswer gui = do\n  a&lt;-forM [1..40] (\\t -&gt; postGUIAsync $ labelSetText (display gui) (show $ fib t))\n  --labelSetText (display gui) \"WELCOME!!\"\n  --mainContextIteration mainContextDefault False\n  print \"\"\n</code></pre>\n\n<p>but without success (it still displays only the final number), and I'm not sure about my code.</p>\n\n<p>EDIT2:\nI tried this :</p>\n\n<pre><code>guiAnswer :: GUI -&gt; IO()\nguiAnswer gui = do\n  forkIO $ forM_ [1..40] (\\t -&gt; postGUIAsync $ labelSetText (display gui) (show $ fib t))\n</code></pre>\n\n<p>but it is not correct.Can you help me?</p>\n\n<p>the error is :</p>\n\n<pre><code>Couldn't match type `GHC.Conc.Sync.ThreadId' with `()'\n Expected type: IO ()\n   Actual type: IO GHC.Conc.Sync.ThreadId\n In a stmt of a 'do' block:\n   forkIO\n   $ forM_\n       [1 .. 40]\n       (\\ t -&gt; postGUIAsync $ labelSetText (display gui) (show $ fib t))\n In the expression:\n   do { forkIO\n        $ forM_\n            [1 .. 40]\n            (\\ t -&gt; postGUIAsync $ labelSetText (display gui) (show $ fib t)) }\n</code></pre>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 478, "user_id": 4079111, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e4775c2984de42fca587c03065107de1?s=128&d=identicon&r=PG&f=1", "display_name": "doofin", "link": "https://stackoverflow.com/users/4079111/doofin"}, "edited": false, "score": 0, "creation_date": 1448015074, "post_id": 33822236, "comment_id": 55413778, "body": "where does ghc find the corresponding libiconv.so and how does it check the target?"}, {"owner": {"reputation": 656, "user_id": 2465463, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1e28be29151470dd797603b9968dfadf?s=128&d=identicon&r=PG", "display_name": "minmaxavg", "link": "https://stackoverflow.com/users/2465463/minmaxavg"}, "reply_to_user": {"reputation": 478, "user_id": 4079111, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e4775c2984de42fca587c03065107de1?s=128&d=identicon&r=PG&f=1", "display_name": "doofin", "link": "https://stackoverflow.com/users/4079111/doofin"}, "edited": false, "score": 0, "creation_date": 1518961580, "post_id": 33822236, "comment_id": 84708032, "body": "@doofin As NDK lacks iconv yet (planned to be included in future releases), you should either build it from scratch or link in an existing library that supports the interface. Currently I&#39;m doing the exact same thing you are attempting to achieve. Will post updates."}], "tags": [], "owner": {"reputation": 10248, "user_id": 268396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4220afde4dd928ef33648797c7415ada?s=128&d=identicon&r=PG", "display_name": "user268396", "link": "https://stackoverflow.com/users/268396/user268396"}, "is_accepted": false, "score": 1, "last_activity_date": 1448008699, "creation_date": 1448008699, "answer_id": 33822236, "question_id": 33822142, "link": "https://stackoverflow.com/questions/33822142/cross-compile-ghc-failed-missing-iconv/33822236#33822236", "title": "cross-compile ghc failed missing iconv", "body": "<p>You may need an <code>iconv</code> matching <code>arm-linux-androideabi</code>. Speculatively: if GHC links <code>iconv</code> into compiled Haskell binaries, then that copy of iconv must match the <code>--target</code> architecture.</p>\n"}], "owner": {"reputation": 478, "user_id": 4079111, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e4775c2984de42fca587c03065107de1?s=128&d=identicon&r=PG&f=1", "display_name": "doofin", "link": "https://stackoverflow.com/users/4079111/doofin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1448008699, "creation_date": 1448008353, "question_id": 33822142, "link": "https://stackoverflow.com/questions/33822142/cross-compile-ghc-failed-missing-iconv", "title": "cross-compile ghc failed missing iconv", "body": "<p>successfully run</p>\n\n<pre><code>./configure --target=arm-linux-androideabi --with-gcc=arm-linux-androideabi-gcc\n</code></pre>\n\n<p>then make failed.</p>\n\n<pre><code>checking value of ENOTSUP... 95\nchecking value of SIGINT... 2\nchecking value of O_BINARY... 0\nchecking for library containing iconv... no\nconfigure: error: iconv is required on non-Windows platforms\nmake[1]: *** [libraries/base/dist-install/package-data.mk] Error 1\nmake: *** [all] Error 2\n</code></pre>\n\n<p>Try installing libiconv,and assure that</p>\n\n<pre><code>dt-ubt@dt-ubt:~/workspace/ghc$ ls /usr/local/lib/\ncharset.alias        libiconv.la        libsodium.la             python2.7\nlibcharset.a         libiconv.so        libsodium.so             python3.4\nlibcharset.la        libiconv.so.2      libsodium.so.13          site_ruby\nlibcharset.so        libiconv.so.2.5.0  libsodium.so.13.0.2      x86_64-linux-ghc-7.8.3\nlibcharset.so.1      libiconv.so.2.5.1  pkgconfig\nlibcharset.so.1.0.0  libsodium.a        preloadable_libiconv.so\n</code></pre>\n\n<p>but then i ran make,the problem remains.</p>\n\n<p>Specifying the source location of iconv also not works(add it in mk/build.mk)</p>\n\n<pre><code>libraries/base_CONFIGURE_OPTS += --configure-option=--with-iconv-includes=/home/dt-ubt/workspace/ghc/iconv/include \nlibraries/base_CONFIGURE_OPTS += --configure-option=--with-iconv-libraries=/home/dt-ubt/workspace/ghc/iconv/lib\n</code></pre>\n"}, {"tags": ["c", "haskell", "ghc", "in-place", "purely-functional"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 7, "creation_date": 1448004449, "post_id": 33820971, "comment_id": 55407804, "body": "IIUC &quot;uniqueness types&quot;, or similarly linear types, do this.  Unfortunately these are not a feature of the Haskell type system.  The conventional way in Haskell is to use <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad-ST.html\" rel=\"nofollow noreferrer\">the <code>ST</code> monad</a> to achieve mutation in a conceptually pure setting (which temporarily enters into a monad with mutable state, but the type system guarantees that the computation is deterministic and the state doesn&#39;t leak).  It&#39;s a very different thing than what you&#39;re talking about though."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1448009703, "post_id": 33820971, "comment_id": 55410249, "body": "<a href=\"http://clean.cs.ru.nl/Clean\" rel=\"nofollow noreferrer\">Clean</a> is a functional language using uniqueness types, also influenced by Haskell."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1577105772, "post_id": 33820971, "comment_id": 105092588, "body": "<a href=\"https://stackoverflow.com/a/9605197/849891\">related</a>: a pure <code>UArray Int Bool</code> is being updated in a loop, without any references to its previous value. similar to what you express here, it <i>could</i> be updated in-place, but it seems that it isn&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 17508, "user_id": 1128289, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9gnmI.jpg?s=128&g=1", "display_name": "Praxeolitic", "link": "https://stackoverflow.com/users/1128289/praxeolitic"}, "edited": false, "score": 0, "creation_date": 1483121737, "post_id": 33827943, "comment_id": 70003614, "body": "It&#39;s been a year but this answer just crossed my mind and I wanted to check if I understood it so now I have a question. Why exactly do you say <code>ST monad</code> doesn&#39;t quite fit the question? Do you just mean the extra typing and conceptual matter of keeping state in a monad? Or is the implementation forced to create a copy somewhere? Thanks."}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 17508, "user_id": 1128289, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9gnmI.jpg?s=128&g=1", "display_name": "Praxeolitic", "link": "https://stackoverflow.com/users/1128289/praxeolitic"}, "edited": false, "score": 0, "creation_date": 1483129594, "post_id": 33827943, "comment_id": 70006900, "body": "@Praxeolitic There is <i>no</i> copying; ST monad (in contrast to <a href=\"https://wiki.haskell.org/State_Monad\" rel=\"nofollow noreferrer\"><code>State Monad</code></a>) does in fact mutate in-place. The point of ST Monad is that mutations become <i>explicit</i> in the type system. But it does not provide guarantees which <a href=\"https://en.wikipedia.org/wiki/Uniqueness_type\" rel=\"nofollow noreferrer\"><code>uniqueness type</code></a> provide."}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 6, "last_activity_date": 1448061658, "last_edit_date": 1448061658, "creation_date": 1448026113, "answer_id": 33827943, "question_id": 33820971, "link": "https://stackoverflow.com/questions/33820971/haskell-use-last-reference-to-a-variable-to-efficiently-create-a-new-variable/33827943#33827943", "title": "Haskell: use last reference to a variable to efficiently create a new variable", "body": "<p>Though <a href=\"https://wiki.haskell.org/Monad/ST\" rel=\"nofollow\"><code>ST monad</code></a> is <em>not</em> exactly what you describe, in practice you may implement most of that using <a href=\"https://hackage.haskell.org/package/array-0.5.1.0/docs/Data-Array-ST.html\" rel=\"nofollow\"><code>STUArray</code></a>. So, a mock up of your code may be something like:</p>\n\n<pre><code>import Control.Monad (forM_)\nimport Control.Monad.ST (ST)\nimport Data.Array.Unboxed (UArray)\nimport Data.Array.ST (STUArray, newArray, readArray, writeArray, runSTUArray)\n\nretire_and_update :: STUArray s Int Int -&gt; ST s (STUArray s Int Int)\nretire_and_update arr = do\n    writeArray arr 0 1\n    return arr\n</code></pre>\n\n<p>and if you have another function which mutates the array in-place, like:</p>\n\n<pre><code>mutate_inplace :: STUArray s Int Int -&gt; Int -&gt; ST s ()\nmutate_inplace arr size = do\n    forM_ [2..size - 1] $ \\i -&gt; do\n        a &lt;- readArray arr (i - 2)\n        b &lt;- readArray arr (i - 1)\n        writeArray arr i (a + b)\n</code></pre>\n\n<p>you may <em>bind</em> the two impure function together and <em>call them inside a pure function</em> using <code>runSTUArray</code>:</p>\n\n<pre><code>run :: Int -&gt; UArray Int Int\nrun size = runSTUArray $ do\n    arr &lt;- newArray (0, size - 1) 0\n    retire_and_update arr\n    mutate_inplace arr size\n    return arr\n</code></pre>\n\n<p>note that <code>run</code> stays pure, and <em>the earlier versions of the returned array are not leaked out anywhere</em>:</p>\n\n<pre><code>\\&gt; run 8\narray (0,7) [(0,1),(1,0),(2,1),(3,1),(4,2),(5,3),(6,5),(7,8)]\n</code></pre>\n"}], "owner": {"reputation": 17508, "user_id": 1128289, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/9gnmI.jpg?s=128&g=1", "display_name": "Praxeolitic", "link": "https://stackoverflow.com/users/1128289/praxeolitic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 33827943, "answer_count": 1, "score": 8, "last_activity_date": 1577105604, "creation_date": 1448003788, "last_edit_date": 1577105604, "question_id": 33820971, "link": "https://stackoverflow.com/questions/33820971/haskell-use-last-reference-to-a-variable-to-efficiently-create-a-new-variable", "title": "Haskell: use last reference to a variable to efficiently create a new variable", "body": "<p>This C code can conceptually be described as creating a new array identical to an input array but with 1 as the first element:</p>\n\n<pre><code>int* retire_and_update(int* arr) {\n    arr[0] = 1;\n    return arr;\n}\n</code></pre>\n\n<p>This is a pure function (wink wink nudge nudge) so long as no further references are made to the input array and its elements. The C type system won't enforce that for us but it seems enforceable in principle.</p>\n\n<p>The code that gcc generates is simple and efficient:</p>\n\n<pre><code>retire_and_update:\n    movq    %rdi, %rax\n    movl    $1, (%rdi)\n    ret\n</code></pre>\n\n<p>Our function achieves the seemingly impossible by creating a whole new array in constant time and using no additional memory. Nice. Can a Haskell function with array-like input and output be written that could be validly implemented with similar code? Is there a way to express \"this is the last reference to this variable\" so that a pure function can cannibalize the variable behind the scenes?</p>\n\n<p>If the function gets inlined then nothing interesting needs to happen here so let's suppose the caller and function will be compiled separately.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1448003619, "post_id": 33818517, "comment_id": 55407436, "body": "I don&#39;t understand your question, looks like it&#39;s working as intended..."}, {"owner": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1448003821, "post_id": 33818517, "comment_id": 55407517, "body": "@luqui: i want to do sum on tree to list with the below function type but i m not getting any idea ,                                                                                                  reduce_tree :: Tree a -&gt; (a -&gt; b) -&gt; (b -&gt; a -&gt; b -&gt; b) -&gt; b"}, {"owner": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1448004930, "post_id": 33818517, "comment_id": 55408018, "body": "@luqui : with the below function type i am trying to do sum of tree to list  reduce_tree :: Tree a -&gt; (a -&gt; b) -&gt; (b -&gt; a -&gt; b -&gt; b) -&gt; b"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "edited": false, "score": 0, "creation_date": 1448004600, "post_id": 33821057, "comment_id": 55407871, "body": "thanks for your reply.. actually i want to give identity function and sum function in ghci itself not using let... for ex:                                      ghci&gt; reduce_tree (Node (Leaf 1) 2 (Node (Leaf 3) 4 (Leaf 5))) id sum where sum t1 v t2 = t1+v+t2                                                                                              then the output is 15"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "edited": false, "score": 0, "creation_date": 1448004925, "post_id": 33821057, "comment_id": 55408014, "body": "Uh, ok... I edited my answer with another suggestion.  You can&#39;t use <code>where</code> in ghci."}, {"owner": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "edited": false, "score": 0, "creation_date": 1448004965, "post_id": 33821057, "comment_id": 55408034, "body": ":with the below function type i am trying to do sum of tree to list reduce_tree :: Tree a -&gt; (a -&gt; b) -&gt; (b -&gt; a -&gt; b -&gt; b) -&gt; b"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "edited": false, "score": 0, "creation_date": 1448005098, "post_id": 33821057, "comment_id": 55408092, "body": "Oh of course, <code>reduce_tree</code> is wrong, I didn&#39;t notice!  See other answer."}, {"owner": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "edited": false, "score": 0, "creation_date": 1448006567, "post_id": 33821057, "comment_id": 55408774, "body": "can u explain clearly with the function type i mentioned.. i got confused"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 2, "last_activity_date": 1448004910, "last_edit_date": 1448004910, "creation_date": 1448004143, "answer_id": 33821057, "question_id": 33818517, "link": "https://stackoverflow.com/questions/33818517/finding-sum-of-tree-to-list-using-haskell/33821057#33821057", "title": "finding sum of tree to list using haskell", "body": "<p>Oh, if I understand correctly, I think you are just trying to enter your example into ghci.  I would recommend putting the complexity in the file:</p>\n\n<pre><code>sum_tree :: Tree Int -&gt; Int\nsum_tree t = reduce_tree t id sum\n    where sum t1 v t2 = t1 + v + t2\n</code></pre>\n\n<p>then in ghci, after you have loaded the file that <code>sum_tree</code> and <code>reduce_tree</code> are defined in, </p>\n\n<pre><code>ghci&gt; sum_tree (VNode (VLeaf 1) 2 (VNode (VLeaf 3) 4 (VLeaf 5))\n</code></pre>\n\n<p>If you must do it all in ghci, be aware that you can't use <code>where</code> in ghci usually, since <code>where</code> is only used in definitions.  Use <code>let ... in</code> instead:</p>\n\n<pre><code>ghci&gt; let sum t1 v t2 = t1 + v + t2 in reduce_tree (VNode (VLeaf 1) 2 (VNode (VLeaf 3) 4 (VLeaf 5))) id sum\n</code></pre>\n\n<p>If you for some reason don't want to use let, you can use a lambda:</p>\n\n<pre><code>ghci&gt; reduce_tree (VNode (VLeaf 1) 2 (VLeaf 3)) id (\\t1 v t2 -&gt; t1 + v + t2)\n</code></pre>\n\n<p>Did I understand your question correctly?</p>\n"}, {"comments": [{"owner": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "edited": false, "score": 0, "creation_date": 1448058487, "post_id": 33821152, "comment_id": 55439632, "body": "below is how you told me to find sum of tree code:                                                                                                       data Tree a = Leaf a | Node (Tree a) a (Tree a) deriving (Show, Eq)     treefold :: (a -&gt; b -&gt; b) -&gt; b -&gt; Tree a -&gt; b     treefold f acc (Leaf x) = f x acc     treefold f acc1 (Node left x right) =       let acc2 = treefold f acc1 right       acc3 = f x acc2       acc4 = treefold f acc3 left in acc4        sumTree :: Num a =&gt; Tree a -&gt; a        sumTree tree = treefold (+) 0 tree"}, {"owner": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "edited": false, "score": 0, "creation_date": 1448058534, "post_id": 33821152, "comment_id": 55439648, "body": "ghci&gt; sumTree (Node (Leaf 1) 2 (Node (Leaf 3) 4 (Leaf 5))) 15"}, {"owner": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "edited": false, "score": 0, "creation_date": 1448058573, "post_id": 33821152, "comment_id": 55439665, "body": "but how can i find sum at run time as below :                                     data Tree a = Leaf a | Node (Tree a) a (Tree a) deriving (Show, Eq) treefold :: (a -&gt; b -&gt; b) -&gt; b -&gt; Tree a -&gt; b                                      treefold f acc (Leaf x) = f x acc  treefold f acc1 (Node left x right) = let acc2 = treefold f acc1 right acc3 = f x acc2 acc4 = treefold f acc3 left in acc4  flattenTree :: Tree a -&gt; [a]                                                    flattenTree tree = treefold (:) [] tree"}, {"owner": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "edited": false, "score": 0, "creation_date": 1448058741, "post_id": 33821152, "comment_id": 55439739, "body": "ghci&gt; flattenTree (Node (Leaf 1) 2 (Node (Leaf 3) 4 (Leaf 5)))id sum where sum t1 v t2 = t1 + v + t2     then ouput : 15"}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 3, "last_activity_date": 1448025178, "last_edit_date": 1495542190, "creation_date": 1448004482, "answer_id": 33821152, "question_id": 33818517, "link": "https://stackoverflow.com/questions/33818517/finding-sum-of-tree-to-list-using-haskell/33821152#33821152", "title": "finding sum of tree to list using haskell", "body": "<p>Since I don't understand your question completely, here are some observations:</p>\n\n<ul>\n<li><p><code>reduce_tree</code>'s type signature suggests that it should have more arguments than you give it.</p>\n\n<p>If <code>f</code> is a function that maps values of type <code>a</code> to values of type <code>b</code>, and <code>g</code> is what appears to be an accumulating function of three arguments (although I'm unsure why two are not enough), then</p>\n\n<pre><code>reduce_tree :: Tree a -&gt; (a -&gt; b) -&gt; (b -&gt; a -&gt; b -&gt; b) -&gt; b\nreduce_tree (Leaf v) f g = ...\nreduce_tree (Node left v right) f g = ...\n</code></pre></li>\n<li><p>If <code>reduce_tree</code> is in fact a reduce function, and not one that simply flattens trees into lists, you may draw inspiration from <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Foldable.html\" rel=\"nofollow noreferrer\"><code>Data.Foldable</code></a>. </p>\n\n<pre><code>data Tree a = Leaf a | Node (Tree a) a (Tree a) deriving (Show, Eq)\n\ntreefold :: (a -&gt; b -&gt; b) -&gt; b -&gt; Tree a -&gt; b\ntreefold f acc (Leaf x) = f x acc\ntreefold f acc1 (Node left x right) =\n  let acc2 = treefold f acc1 right\n      acc3 = f x acc2\n      acc4 = treefold f acc3 left\n  in acc4\n</code></pre>\n\n<p>With such a function you can either flatten or sum the elements of a tree:</p>\n\n<pre><code>flattenTree :: Tree a -&gt; [a]\nflattenTree tree = treefold (:) [] tree\n\nsumTree :: Num a =&gt; Tree a -&gt; a\nsumTree tree = treefold (+) 0 tree\n</code></pre></li>\n<li><p>The only bell that rings when you say \"apply sum using id function\" is that perhaps you wish to use continuations. This is already covered thoroughly in e.g. <a href=\"https://stackoverflow.com/questions/21205213/haskell-tail-recursion-version-of-depth-of-binary-tree\">Haskell: tail recursion version of depth of binary tree</a> and concisely in <a href=\"https://stackoverflow.com/q/19070577/235908\">Tail-recursion on trees</a> (Standard ML). A Haskell equivalent would be:</p>\n\n<pre><code>treefold :: (a -&gt; b -&gt; b) -&gt; b -&gt; Tree a -&gt; b\ntreefold f acc tree = tf f acc tree id\n  where\n    tf f acc (Leaf x) k = k (f x acc)\n    tf f acc (Node left x right) old_k = tf f left acc new_k\n      where\n        new_k = \\acc -&gt; tf f right (f x acc) old_k\n</code></pre>\n\n<p>Now <code>sumTree</code> can be defined in the exact same way as before, except it would use folding as well as the identity function as the initial continuation. Or you could extract the helper function <code>tf</code> to the top-level if you want to feed the traversal function with the function <code>id</code> yourself.</p></li>\n</ul>\n"}], "owner": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1448025178, "creation_date": 1447990433, "last_edit_date": 1448023410, "question_id": 33818517, "link": "https://stackoverflow.com/questions/33818517/finding-sum-of-tree-to-list-using-haskell", "title": "finding sum of tree to list using haskell", "body": "<p>I am trying to apply sum using id function while giving input to program.but i am with below. any guidance is much appreciated. </p>\n\n<pre><code>data Tree a = Leaf a | Node (Tree a) a (Tree a) deriving (Eq, Show)\nreduce_tree :: Tree a -&gt; (a -&gt; b) -&gt; (b -&gt; a -&gt; b -&gt; b) -&gt; b\nreduce_tree (Leaf v) = [v]\nreduce_tree (Node left root right) = reduce_tree left ++ [root] ++   reduce_tree right\n</code></pre>\n\n<p>input as follows:</p>\n\n<pre><code>ghci&gt; reduce_tree (VNode (VLeaf 1) 2 (VNode (VLeaf 3) 4 (VLeaf 5)))\n                   id sum\n                   where sum t1 v t2 = t1 + v + t2\n15\n</code></pre>\n"}, {"tags": ["haskell", "command-line-interface"], "comments": [{"owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "edited": false, "score": 1, "creation_date": 1447982660, "post_id": 33817372, "comment_id": 55400647, "body": "<a href=\"https://hackage.haskell.org/package/ncurses\" rel=\"nofollow noreferrer\"><code>ncurses</code></a> or some higher-level progressbar library like <a href=\"https://github.com/yamadapc/haskell-ascii-progress\" rel=\"nofollow noreferrer\">this</a> will do, I think."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1447982743, "post_id": 33817372, "comment_id": 55400678, "body": "I&#39;ve also heard very good things about <a href=\"https://github.com/jtdaugherty/brick/\" rel=\"nofollow noreferrer\">brick</a>."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 2, "creation_date": 1447983480, "post_id": 33817372, "comment_id": 55400871, "body": "Just print a CR - see this SO question: <a href=\"http://stackoverflow.com/q/31900566/866915\">stackoverflow.com/q/31900566/866915</a>"}, {"owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "reply_to_user": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "edited": false, "score": 0, "creation_date": 1447984907, "post_id": 33817372, "comment_id": 55401317, "body": "@fjarri ascii-progress is nice!"}, {"owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1447984926, "post_id": 33817372, "comment_id": 55401322, "body": "@HaoLian brick seems too much for my needs"}, {"owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447984940, "post_id": 33817372, "comment_id": 55401327, "body": "@ErikR also nice solution"}], "answers": [{"tags": [], "owner": {"reputation": 11412, "user_id": 617159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc43cf2d76ce0981a21c0e5a817f96f5?s=128&d=identicon&r=PG", "display_name": "Lambda Fairy", "link": "https://stackoverflow.com/users/617159/lambda-fairy"}, "is_accepted": true, "score": 11, "last_activity_date": 1447983464, "creation_date": 1447983464, "answer_id": 33817563, "question_id": 33817372, "link": "https://stackoverflow.com/questions/33817372/dynamic-stdout-in-haskell/33817563#33817563", "title": "Dynamic stdout in Haskell", "body": "<p>If it's just one row, you can use <code>\\r</code> to rewind the cursor to the beginning of the line.</p>\n\n<p>Here's an example:</p>\n\n<pre><code>import Control.Concurrent\nimport Control.Monad\nimport Text.Printf\n\nmain :: IO ()\nmain = do\n    forM_ [10, 9 .. 1] $ \\seconds -&gt; do\n        printf \"\\rLaunching missiles in %2d...\" (seconds :: Int)\n        threadDelay $ 1 * 1000 * 1000\n    putStrLn \"\\nBlastoff!\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1617, "user_id": 2239956, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cc5132d21c85f66d0d10ab0c8069c59?s=128&d=identicon&r=PG", "display_name": "drquicksilver", "link": "https://stackoverflow.com/users/2239956/drquicksilver"}, "is_accepted": false, "score": 3, "last_activity_date": 1448010198, "creation_date": 1448010198, "answer_id": 33822661, "question_id": 33817372, "link": "https://stackoverflow.com/questions/33817372/dynamic-stdout-in-haskell/33822661#33822661", "title": "Dynamic stdout in Haskell", "body": "<p>Joey Hess's <code>concurrent-output</code> library is designed for progress output like this (and more complex variations).</p>\n\n<p><a href=\"http://hackage.haskell.org/package/concurrent-output\" rel=\"nofollow\">http://hackage.haskell.org/package/concurrent-output</a></p>\n\n<p><a href=\"https://joeyh.name/blog/entry/a_tiling_region_manager_for_the_console/\" rel=\"nofollow\">https://joeyh.name/blog/entry/a_tiling_region_manager_for_the_console/</a></p>\n"}], "owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 1, "accepted_answer_id": 33817563, "answer_count": 2, "score": 5, "last_activity_date": 1448010198, "creation_date": 1447982153, "question_id": 33817372, "link": "https://stackoverflow.com/questions/33817372/dynamic-stdout-in-haskell", "title": "Dynamic stdout in Haskell", "body": "<p>I have simple command line interface with insertion records in DB and\nnow it writes a lot of info to stdout, like this:</p>\n\n<pre><code>...    \nrecord 856/1000: 85%\nrecord 857/1000: 85%\nrecord 858/1000: 85%\n...\n</code></pre>\n\n<p>but I want to have 1 dynamic line with updating current string parameters</p>\n\n<pre><code> status         |T    | C   | A   | E\n ---------------------------------------\n   inserting    |1000 | 857 | 85% | 96  \n</code></pre>\n\n<p>How can I achieve that?</p>\n"}, {"tags": ["haskell", "ghc", "ghc-mod"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1448032585, "post_id": 33816970, "comment_id": 55425122, "body": "did you compile <code>ghc-mod</code> yourself ? what&#39;s the output of <code>ghc-mod --version</code>"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1450364292, "post_id": 33816970, "comment_id": 56416513, "body": "did you find what was going wrong ? I think I have the same pb with 7.10.3"}, {"owner": {"reputation": 3190, "user_id": 875265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf761af25a59c5da69b56deaf8a32e7?s=128&d=identicon&r=PG", "display_name": "fycth", "link": "https://stackoverflow.com/users/875265/fycth"}, "edited": false, "score": 0, "creation_date": 1454265843, "post_id": 33816970, "comment_id": 57956009, "body": "Seems to be an issue in 7.10.3: <a href=\"https://github.com/DanielG/ghc-mod/issues/607\" rel=\"nofollow noreferrer\">github.com/DanielG/ghc-mod/issues/607</a>"}, {"owner": {"reputation": 7230, "user_id": 788337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wiVpx.png?s=128&g=1", "display_name": "jmite", "link": "https://stackoverflow.com/users/788337/jmite"}, "edited": false, "score": 0, "creation_date": 1454272348, "post_id": 33816970, "comment_id": 57958665, "body": "Sorry, I don&#39;t remember exactly how I solved this... I think I just started a fresh sandbox and it worked?"}], "answers": [{"comments": [{"owner": {"reputation": 7230, "user_id": 788337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wiVpx.png?s=128&g=1", "display_name": "jmite", "link": "https://stackoverflow.com/users/788337/jmite"}, "edited": false, "score": 0, "creation_date": 1465409813, "post_id": 37709944, "comment_id": 62893928, "body": "This is probably a solution, but I wasn&#39;t using stack when I originally encountered this."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 1, "last_activity_date": 1465409646, "creation_date": 1465409646, "answer_id": 37709944, "question_id": 33816970, "link": "https://stackoverflow.com/questions/33816970/ghc-mod-after-update-cannot-satisfy-package-id-base-4-8-2-0/37709944#37709944", "title": "ghc-mod: After update, `cannot satisfy -package-id base-4.8.2.0`", "body": "<p>It seems restarting the ghc-mod process after a <code>rm -rf .stack-work</code> helps; <code>stack clean</code> doesn't seem \"strong\" enough for some reason \u2014 <code>ghc-mod</code> is not particularly clever about when it should clean and rebuild \u2014 wish that wasn't the case but it is.</p>\n\n<hr>\n\n<p>Alternatively, your <code>ghc-mod</code> might need to be recompiled with whatever GHC version it's being used with; if you have multiple versions of GHC installed and need <code>ghc-mod</code> for a specific one, pass <code>-w path/to/ghc</code> to <code>cabal install</code>, for example in my case I have 8.0.1 globally but need <code>ghc-mod</code> with 7.10.3, which <code>stack</code> has already installed for me under <code>.stack/programs</code>:</p>\n\n<pre><code>~/my-sandboxes/ghc-mod-7.10.3 $ cabal install -w ~/.stack/programs/x86_64-osx/ghc-7.10.3/bin/ghc ghc-mod\n</code></pre>\n\n<p>otherwise, a simple <code>cabal install ghc-mod</code> should do.</p>\n"}], "owner": {"reputation": 7230, "user_id": 788337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wiVpx.png?s=128&g=1", "display_name": "jmite", "link": "https://stackoverflow.com/users/788337/jmite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1465409768, "creation_date": 1447979523, "last_edit_date": 1465409768, "question_id": 33816970, "link": "https://stackoverflow.com/questions/33816970/ghc-mod-after-update-cannot-satisfy-package-id-base-4-8-2-0", "title": "ghc-mod: After update, `cannot satisfy -package-id base-4.8.2.0`", "body": "<p>So, an apt-get update in Ubuntu updated my GHC-version to 7.10.3 from <a href=\"https://launchpad.net/~hvr/+archive/ubuntu/ghc\" rel=\"nofollow\">this repository</a>.</p>\n\n<p>After this update, everything broke, so I switched to 7.10.2, from that same repository.</p>\n\n<p>Almost everything is working now, except for ghc-mod, which when run, gives the following error when I try to check my project:</p>\n\n<pre><code>ghc-mod: &lt;command line&gt;: cannot satisfy -package-id base-4.8.2.0-9bb65294401b6ef629a229811a1f4249\n    (use -v for more information)\n</code></pre>\n\n<p>When I run cabal-install on my project, I don't get any dependency errors.</p>\n\n<p>What might be causing this problem? Is there a setting within GHC-mod that needs to be changed, or a path that needs to be specified?</p>\n\n<p>I can provide more information, but I just don't know where to start with this error.</p>\n\n<p>My build-depends section in the .cabal file looks like this:</p>\n\n<pre><code>  build-depends:       base &gt;=4.8 &amp;&amp; &lt;4.9\n                       , mtl\n                       , parsec\n                       , pretty\n                       , readline\n</code></pre>\n\n<p>Like I said, these dependencies all install fine.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1447973899, "post_id": 33815735, "comment_id": 55397593, "body": "In the future, posting the error message or incorrect output you get is helpful to those answering your questions."}, {"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 0, "creation_date": 1448001779, "post_id": 33815735, "comment_id": 55406626, "body": "What is the purpose of the <code>Ord</code> constraint? It is not necessary, is it part of your solution or part of your assignment? <code>treeToList :: Tree a -&gt; [a]</code> suffices."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "edited": false, "score": 0, "creation_date": 1447980258, "post_id": 33815885, "comment_id": 55399911, "body": "how can i add identity function to perform sum say, the below is my function with type:                                                       treeToList :: Tree a -&gt; (a -&gt; b) -&gt; (b -&gt; a -&gt; b -&gt; b) -&gt; b      *Main&gt;treeToList (Node (Leaf 1) 2 (Node (Leaf 3) 4 (Leaf 5))) id sum where sum t1 v t2 = t1+v+t2   then the output is 15"}, {"owner": {"reputation": 20829, "user_id": 1030110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bsgx2.png?s=128&g=1", "display_name": "m0nhawk", "link": "https://stackoverflow.com/users/1030110/m0nhawk"}, "reply_to_user": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "edited": false, "score": 0, "creation_date": 1448013926, "post_id": 33815885, "comment_id": 55412992, "body": "@John I have no idea why you type of function is so complex. The function with a function argument should look like: <code>treeToFunElem :: Tree a -&gt; (a -&gt; a -&gt; b) -&gt; b</code>, so the result would be of type <code>b</code>, which may or may not be the same type as <code>a</code> (for example, tree of integers and taking square roots of them with convert to double)."}], "tags": [], "owner": {"reputation": 20829, "user_id": 1030110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bsgx2.png?s=128&g=1", "display_name": "m0nhawk", "link": "https://stackoverflow.com/users/1030110/m0nhawk"}, "is_accepted": false, "score": 6, "last_activity_date": 1447973668, "creation_date": 1447973668, "answer_id": 33815885, "question_id": 33815735, "link": "https://stackoverflow.com/questions/33815735/reducing-tree-to-a-list-in-haskell/33815885#33815885", "title": "Reducing Tree to a list in haskell", "body": "<p>You have two errors:</p>\n\n<ol>\n<li>Non-exhaustive pattern (for <code>Leaf</code> constructor).</li>\n<li>And in the pattern for <code>Node</code> you matching <code>root</code> as a left tree value (<code>Tree a</code>) and not an <code>a</code>.</li>\n</ol>\n\n<p>Thus the result should look like:</p>\n\n<pre><code>data Tree a = Leaf a | Node (Tree a) a (Tree a) deriving (Eq, Show)\n\ntreeToList :: (Ord a) =&gt; Tree a -&gt; [a]\ntreeToList (Leaf v) = [v]\ntreeToList (Node left root right) = treeToList left ++ [root] ++ treeToList right\n</code></pre>\n\n<blockquote>\n<pre><code>*Main&gt; treeToList (Node (Leaf 1) 2 (Node (Leaf 3) 4 (Leaf 5)))\n[1,2,3,4,5]\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 3, "last_activity_date": 1447977853, "creation_date": 1447977853, "answer_id": 33816683, "question_id": 33815735, "link": "https://stackoverflow.com/questions/33815735/reducing-tree-to-a-list-in-haskell/33816683#33816683", "title": "Reducing Tree to a list in haskell", "body": "<p>Riffing on m0nhawk's absolutely correct answer, I'd offer the following advice.  When you're writing a function that pattern matches on an algebraic data type like <code>Tree</code>, start by writing a template of how the function will be structured.  In this case, given the type definition:</p>\n\n<pre><code>data Tree a = Leaf a | Node (Tree a) a (Tree a) deriving (Eq, Show)\n</code></pre>\n\n<p>...and this function signature:</p>\n\n<pre><code>treeToList :: (Ord a) =&gt; Tree a -&gt; [a]\n</code></pre>\n\n<p>...you can start by writing a template like this one, which is just expanding out the two alternatives of the <code>Tree</code> type and their components:</p>\n\n<pre><code>treeToList (Leaf value) = _\ntreeToList (Node left value right) = _\n</code></pre>\n\n<p>Read the <code>_</code> (underscores) as \"blanks\" to fill in later.  This is actually valid syntax in recent GHC versions, called a \"hole\" so the compiler will remind you that you need to fill it in.</p>\n\n<p>By writing out a template like this and making sure you're covering all of the alternatives of the type you're working with, you greatly reduce your risk of running into problem #1 that m0nhawk pointed out.</p>\n"}], "owner": {"reputation": 29, "user_id": 5583522, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/770af1f506d00dbe804711984e843527?s=128&d=identicon&r=PG&f=1", "display_name": "John", "link": "https://stackoverflow.com/users/5583522/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1447977853, "creation_date": 1447973050, "last_edit_date": 1447973258, "question_id": 33815735, "link": "https://stackoverflow.com/questions/33815735/reducing-tree-to-a-list-in-haskell", "title": "Reducing Tree to a list in haskell", "body": "<p>I am trying to reduce a Tree to List but I am stuck up here.. any suggestions are appreciated..</p>\n\n<pre><code>data Tree a = Leaf a | Node (Tree a) a (Tree a) deriving (Eq, Show)\ntreeToList :: (Ord a) =&gt; Tree a -&gt; [a]\ntreeToList (Node root left right) = treeToList left ++ [root] ++   treeToList right\n</code></pre>\n\n<p>Expecting Result:</p>\n\n<blockquote>\n<pre><code>ghci&gt; treeToList (Node (Leaf 1) 2 (Node (Leaf 3) 4 (Leaf 5)))\n\n[1,2,3,4,5]\n</code></pre>\n</blockquote>\n"}, {"tags": ["java", "haskell", "lambda", "comparator"], "comments": [{"owner": {"reputation": 34901, "user_id": 3973077, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e80187d131859fc0601a01231fec657e?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Boddington", "link": "https://stackoverflow.com/users/3973077/paul-boddington"}, "edited": false, "score": 0, "creation_date": 1447968110, "post_id": 33814472, "comment_id": 55394730, "body": "It is not clear to me what you are trying to do. Can you explain what <code>foldl</code> does, and give some examples of input and output of your <code>max</code> method?"}, {"owner": {"reputation": 4519, "user_id": 1977887, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/I3Cij.jpg?s=128&g=1", "display_name": "Erick G. Hagstrom", "link": "https://stackoverflow.com/users/1977887/erick-g-hagstrom"}, "edited": false, "score": 0, "creation_date": 1447968211, "post_id": 33814472, "comment_id": 55394781, "body": "In addition, what the <code>R</code> and <code>T</code> types bind to, and how you intend to guarantee that <code>s</code> is a <code>String</code> would be interesting."}, {"owner": {"reputation": 4519, "user_id": 1977887, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/I3Cij.jpg?s=128&g=1", "display_name": "Erick G. Hagstrom", "link": "https://stackoverflow.com/users/1977887/erick-g-hagstrom"}, "edited": false, "score": 0, "creation_date": 1447968265, "post_id": 33814472, "comment_id": 55394814, "body": "What do you mean by &quot;uses the emulated <code>foldl</code>&quot; and by &quot;<i>gets</i> a <code>Comparator</code> and a <code>List&lt;T&gt;</code>&quot;?"}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "reply_to_user": {"reputation": 34901, "user_id": 3973077, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e80187d131859fc0601a01231fec657e?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Boddington", "link": "https://stackoverflow.com/users/3973077/paul-boddington"}, "edited": false, "score": 0, "creation_date": 1447969121, "post_id": 33814472, "comment_id": 55395287, "body": "@PaulBoddington I edited the question. Thanks in advance."}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "reply_to_user": {"reputation": 4519, "user_id": 1977887, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/I3Cij.jpg?s=128&g=1", "display_name": "Erick G. Hagstrom", "link": "https://stackoverflow.com/users/1977887/erick-g-hagstrom"}, "edited": false, "score": 0, "creation_date": 1447969208, "post_id": 33814472, "comment_id": 55395339, "body": "@ErickG.Hagstrom I edited the question, also I don&#39;t need to guarantee the the types, it&#39;s an exercise so we assume it&#39;s a string. Thanks in advance"}, {"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "reply_to_user": {"reputation": 4519, "user_id": 1977887, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/I3Cij.jpg?s=128&g=1", "display_name": "Erick G. Hagstrom", "link": "https://stackoverflow.com/users/1977887/erick-g-hagstrom"}, "edited": false, "score": 0, "creation_date": 1447969466, "post_id": 33814472, "comment_id": 55395466, "body": "@ErickG.Hagstrom What I mean by &quot;uses the emulated <code>foldl</code>&quot; is that the <code>max</code> method calls the <code>foldl</code> method."}], "answers": [{"comments": [{"owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1447971330, "post_id": 33814956, "comment_id": 55396400, "body": "Thanks very much Paul Boddington, foldl is pretty much it, the only difference is that it removes the first element of the list, but no need to edit the answer, explained it just for you to know, I missed the <code>(t, u) -&gt;</code> part in my attempts, now I understand how it should be done and may continue to do the rest of the exercise. Thank you again."}, {"owner": {"reputation": 34901, "user_id": 3973077, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e80187d131859fc0601a01231fec657e?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Boddington", "link": "https://stackoverflow.com/users/3973077/paul-boddington"}, "reply_to_user": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "edited": false, "score": 0, "creation_date": 1447971410, "post_id": 33814956, "comment_id": 55396439, "body": "No problem. I&#39;m glad I could help."}], "tags": [], "owner": {"reputation": 34901, "user_id": 3973077, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/e80187d131859fc0601a01231fec657e?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Boddington", "link": "https://stackoverflow.com/users/3973077/paul-boddington"}, "is_accepted": true, "score": 4, "last_activity_date": 1447969610, "creation_date": 1447969610, "answer_id": 33814956, "question_id": 33814472, "link": "https://stackoverflow.com/questions/33814472/return-value-from-comparator-using-lambda-expression-java/33814956#33814956", "title": "Return value from comparator using lambda expression java", "body": "<p>You can get the maximum of two elements using a <code>Comparator</code> by doing</p>\n\n<pre><code>(t, u) -&gt; c.compare(t, u) &gt; 0 ? t : u\n</code></pre>\n\n<p>This says: if <code>t</code> is greater than <code>u</code>, return <code>t</code>, else return <code>u</code>.</p>\n\n<p>This lambda expression can be passed as the <code>BiFunction</code> in your <code>foldl</code> method. Here is a full, working example. I decided to pass the first element of the list as <code>z</code>. This makes sense, as an empty list doesn't have a maximum anyway. </p>\n\n<pre><code>public static void main(String[] args) {\n    List&lt;Integer&gt; list = Arrays.asList(7, 2, 8, 1, 9, 5);\n    System.out.println(max(Comparator.naturalOrder(), list));\n}\n\n// Not knowing Haskell at all, this is my guess at what foldl does.\nprivate static &lt;R, T&gt; R foldl(BiFunction&lt;R, T, R&gt; f, R z, List&lt;T&gt; l) {\n    for (T t : l)\n        z = f.apply(z, t);\n    return z;\n}\n\nprivate static &lt;T&gt; T max(Comparator&lt;T&gt; c, List&lt;T&gt; l) {\n    if (l.isEmpty())\n        throw new IllegalArgumentException();\n    return foldl((t, u) -&gt; c.compare(t, u) &gt; 0 ? t : u, l.get(0), l);\n}\n</code></pre>\n\n<p>In java 8, streams were introduced. This kind of process is called a reduction in java, and there are standard methods available for doing this sort of thing. </p>\n"}], "owner": {"reputation": 338, "user_id": 1801837, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f31b81b452235f4ae71d26a853cb3e93?s=128&d=identicon&r=PG", "display_name": "Francisco Costa", "link": "https://stackoverflow.com/users/1801837/francisco-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 1, "accepted_answer_id": 33814956, "answer_count": 1, "score": 0, "last_activity_date": 1447969610, "creation_date": 1447967593, "last_edit_date": 1447969082, "question_id": 33814472, "link": "https://stackoverflow.com/questions/33814472/return-value-from-comparator-using-lambda-expression-java", "title": "Return value from comparator using lambda expression java", "body": "<p>I'm emulating the haskell function <code>foldl</code> in java.\nthat at the same time retrieves and removes the first index of a list. <br>\nI've done that, with the following signature <code>foldl(BiFunction &lt;R, T, R&gt; f, R z, List&lt;T&gt; l)</code>, where <code>T</code> is a <code>String</code> and <code>R</code> a <code>int</code>.</p>\n\n<p>The only problem now is I need to create a <code>max</code> java method that uses the emulated <code>foldl</code> and has the following signature: <code>max(Comparator&lt;T&gt; c, List&lt;T&gt; l)</code>. <p>\nThis is the comparator I'm using as an example:<br>\n<code>Comparator.comparing(s -&gt; Integer.valueOf(s.split(\",\")[1]));</code><p>\nI figured I needed to construct a lambda expression so it returns the value of comparator if it's true.</p>\n\n<p>All of my attempts were in vain, since I don't know how to use comparators in lambda expressions, and I'm newbie in this kind of expressions.</p>\n\n<p>Any help would be appreciated.\nThanks in advance.</p>\n"}, {"tags": ["haskell", "tree", "traversal"], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 3, "last_activity_date": 1447967945, "creation_date": 1447967945, "answer_id": 33814552, "question_id": 33814354, "link": "https://stackoverflow.com/questions/33814354/how-to-clean-up-a-level-traversal-function/33814552#33814552", "title": "How to clean up a level traversal function?", "body": "<p>If you had a function <code>depth :: Tree a -&gt; Int</code> that told you how deep the tree was, it would be as simple as</p>\n\n<pre><code>levelorder tree = concatMap (\\lvl -&gt; level lvl tree) [0..depth tree]\n</code></pre>\n\n<p>This is not a particularly fast implementation, though, you end up traversing the tree many times.</p>\n"}, {"tags": [], "owner": {"reputation": 4835, "user_id": 1056928, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/c8dba2f6f4d8be9cedf020c0907e9361?s=128&d=identicon&r=PG", "display_name": "ScarletAmaranth", "link": "https://stackoverflow.com/users/1056928/scarletamaranth"}, "is_accepted": false, "score": 0, "last_activity_date": 1447968579, "creation_date": 1447968579, "answer_id": 33814709, "question_id": 33814354, "link": "https://stackoverflow.com/questions/33814354/how-to-clean-up-a-level-traversal-function/33814709#33814709", "title": "How to clean up a level traversal function?", "body": "<p>You need a depth function first, so that you don't need to fix the number of levels you concatenate.</p>\n\n<pre><code>depth :: Tree a -&gt; Int\ndepth (Node _ [])       = 1\ndepth (Node _ r@(x:xs)) = 1 + maximum (map depth r)\n</code></pre>\n\n<p>Then instead of fixing the number of times you use the <code>(++)</code> ,\nyou simply <code>concat</code> the results of <code>map</code>ing the level function over each level which you draw from a list <code>[0..depth tree]</code>.</p>\n\n<p><code>levelorder' tree = concatMap (flip level tree) [0..depth tree]</code></p>\n"}, {"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 1, "last_activity_date": 1447968911, "creation_date": 1447968911, "answer_id": 33814789, "question_id": 33814354, "link": "https://stackoverflow.com/questions/33814354/how-to-clean-up-a-level-traversal-function/33814789#33814789", "title": "How to clean up a level traversal function?", "body": "<p>You can traverse the levels succesively until you run out of nodes:</p>\n\n<pre><code>levelorder :: Tree a -&gt; [a]\nlevelorder t = concat $ takeWhile (not . null) $ map (`level` t) [0..]\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4804953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f84ac4b4d027ecfeed018596e791fb1?s=128&d=identicon&r=PG&f=1", "display_name": "JavaUser90909", "link": "https://stackoverflow.com/users/4804953/javauser90909"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 33814552, "answer_count": 3, "score": 1, "last_activity_date": 1447968911, "creation_date": 1447967149, "question_id": 33814354, "link": "https://stackoverflow.com/questions/33814354/how-to-clean-up-a-level-traversal-function", "title": "How to clean up a level traversal function?", "body": "<p>I am dealing with a general tree setup that is defined as follows:</p>\n\n<pre><code>data Tree a = Node a [Tree a] deriving (Eq, Read, Show)\n</code></pre>\n\n<p>With this setup, I have created a function that prints the nodes at a specific level of the tree (root is level 0, immediate children of root are level 1, etc.). This is the function:</p>\n\n<pre><code>level :: Int -&gt; Tree a -&gt; [a]\nlevel 0 (Node a _) = [a]\nlevel n (Node _ subtrees) = concatMap (level (n - 1)) subtrees\n</code></pre>\n\n<p>Using this function as a base, I created a second function, levelorder, which prints a list of all nodes in a tree in level order traversal. That function currently looks like this:</p>\n\n<pre><code>levelorder :: Tree a -&gt; [a]\nlevelorder tree = level 0 tree ++ level 1 tree ++ level 2 tree ++ level 3 tree\n</code></pre>\n\n<p>While this works great for the tree I am currently working with, I would like to clean it up to where it would work with a tree of any size. As you can see, it currently only works on a tree with 4 levels (0 to 3). How would I go about achieving this to where I can still utilize the level function as a base?</p>\n"}, {"tags": ["user-interface", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1447969881, "post_id": 33814735, "comment_id": 55395685, "body": "What do you mean? Is there an actual function <code>widgetShowAll</code>, or is this just a suggestion?"}, {"owner": {"reputation": 26, "user_id": 3057490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8af67705842768e2f2f9ec504d510a9?s=128&d=identicon&r=PG&f=1", "display_name": "lambda", "link": "https://stackoverflow.com/users/3057490/lambda"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1447970613, "post_id": 33814735, "comment_id": 55396027, "body": "There is a function called <a href=\"http://hackage.haskell.org/package/gtk-0.13.9/docs/Graphics-UI-Gtk-Abstract-Widget.html#v:widgetShowAll\" rel=\"nofollow noreferrer\">widgetShowAll</a>. This <a href=\"http://code.haskell.org/gtk2hs/docs/tutorial/Tutorial_Port/chap2.xhtml\" rel=\"nofollow noreferrer\">minimal example</a> shows the functions you need. (Sadly this tutorial is outdated.)"}], "tags": [], "owner": {"reputation": 26, "user_id": 3057490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8af67705842768e2f2f9ec504d510a9?s=128&d=identicon&r=PG&f=1", "display_name": "lambda", "link": "https://stackoverflow.com/users/3057490/lambda"}, "is_accepted": true, "score": 1, "last_activity_date": 1447971340, "last_edit_date": 1447971340, "creation_date": 1447968689, "answer_id": 33814735, "question_id": 33814190, "link": "https://stackoverflow.com/questions/33814190/simple-application-in-haskell-for-gui-programming/33814735#33814735", "title": "simple application in Haskell for gui programming", "body": "<p>You have forgotten to actually show the window. A function call like</p>\n\n<pre><code>    widgetShowAll window\n</code></pre>\n\n<p>seems to be missing. </p>\n\n<p><em>edit</em></p>\n\n<p>This main function should work:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>    main :: IO ()\n    main = do\n     initGUI\n     gui &lt;- loadGlade\n     connectGui gui\n     widgetShowAll (mainWin gui)\n     mainGUI        \n</code></pre>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 1, "accepted_answer_id": 33814735, "answer_count": 1, "score": 1, "last_activity_date": 1447971340, "creation_date": 1447966497, "question_id": 33814190, "link": "https://stackoverflow.com/questions/33814190/simple-application-in-haskell-for-gui-programming", "title": "simple application in Haskell for gui programming", "body": "<p>I created a simple haskell program to display a window :</p>\n\n<pre><code>module Main where\n\nimport           Graphics.UI.Gtk\nimport           Graphics.UI.Gtk.Glade\n\ndata GUI = GUI {\n  mainWin :: Window,\n  clickMe :: Button,\n  display :: Label\n  }\n\nloadGlade :: IO GUI\nloadGlade = do\n  Just xml &lt;- xmlNew \"gladeFile.glade\"\n  mw &lt;- xmlGetWidget xml castToWindow \"wdwFirst\"\n  bc &lt;- xmlGetWidget xml castToButton \"btnClick\"\n  ld &lt;- xmlGetWidget xml castToLabel \"lblDisplay\"\n\n  return $ GUI mw bc ld\n\nconnectGui :: GUI -&gt; IO  (ConnectId Button)\nconnectGui gui = do\n  onDestroy (mainWin gui) mainQuit\n  onClicked (clickMe gui) (guiAnswer gui)\n\nguiAnswer :: GUI -&gt; IO()\nguiAnswer gui =\n  labelSetText (display gui) \"WELCOME!!\"\n\n\nmain :: IO ()\nmain = do\n  initGUI\n  gui &lt;- loadGlade\n  connectGui gui\n  mainGUI\n</code></pre>\n\n<p>with this gui file created by glade:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;glade-interface&gt;\n  &lt;!-- interface-requires gtk+ 2.24 --&gt;\n  &lt;!-- interface-naming-policy project-wide --&gt;\n  &lt;widget class=\"GtkWindow\" id=\"wdwFirst\"&gt;\n    &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n    &lt;property name=\"title\" translatable=\"yes\"&gt;DEBUT&lt;/property&gt;\n    &lt;property name=\"window_position\"&gt;center&lt;/property&gt;\n    &lt;property name=\"default_width\"&gt;400&lt;/property&gt;\n    &lt;property name=\"default_height\"&gt;250&lt;/property&gt;\n    &lt;child&gt;\n      &lt;widget class=\"GtkLayout\" id=\"layout1\"&gt;\n        &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n        &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n        &lt;child&gt;\n          &lt;widget class=\"GtkButton\" id=\"btnClick\"&gt;\n            &lt;property name=\"label\" translatable=\"yes\"&gt;Click me!&lt;/property&gt;\n            &lt;property name=\"width_request\"&gt;100&lt;/property&gt;\n            &lt;property name=\"height_request\"&gt;23&lt;/property&gt;\n            &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n            &lt;property name=\"can_focus\"&gt;True&lt;/property&gt;\n            &lt;property name=\"receives_default\"&gt;True&lt;/property&gt;\n          &lt;/widget&gt;\n          &lt;packing&gt;\n            &lt;property name=\"x\"&gt;21&lt;/property&gt;\n            &lt;property name=\"y\"&gt;20&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n        &lt;child&gt;\n          &lt;widget class=\"GtkLabel\" id=\"lblDisplay\"&gt;\n            &lt;property name=\"width_request\"&gt;350&lt;/property&gt;\n            &lt;property name=\"height_request\"&gt;136&lt;/property&gt;\n            &lt;property name=\"visible\"&gt;True&lt;/property&gt;\n            &lt;property name=\"can_focus\"&gt;False&lt;/property&gt;\n            &lt;property name=\"label\" translatable=\"yes\"&gt;gdghh\n&lt;/property&gt;\n          &lt;/widget&gt;\n          &lt;packing&gt;\n            &lt;property name=\"x\"&gt;43&lt;/property&gt;\n            &lt;property name=\"y\"&gt;77&lt;/property&gt;\n          &lt;/packing&gt;\n        &lt;/child&gt;\n      &lt;/widget&gt;\n    &lt;/child&gt;\n  &lt;/widget&gt;\n&lt;/glade-interface&gt;\n</code></pre>\n\n<p>the program compiles, and runs without error but...nothing appears, there is no window.</p>\n\n<p>I use glade 3.8.5 with gtk+ 2</p>\n\n<p>thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1447952417, "post_id": 33809638, "comment_id": 55385303, "body": "Okay, next step: try implementing <code>nodesAtLevel 0</code>. Then, write <code>nodesAtLevel n</code> in function of <code>nodesAtLevel (n-1)</code>."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1447952444, "post_id": 33809638, "comment_id": 55385327, "body": "Stack overflow isn&#39;t a great venue for &quot;how do I write this from scratch&quot; sort of questions.  I suggest you attempt to implement the function you&#39;re asking about then when you get stuck ask about that particular sub-problem."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447952876, "post_id": 33809638, "comment_id": 55385628, "body": "if you like you can try my answer - I will try to answer comments/questions on it without spoiling to much and come back later to fill in the holes (to make a complete answer)"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1447956511, "last_edit_date": 1447956511, "creation_date": 1447952408, "answer_id": 33809991, "question_id": 33809638, "link": "https://stackoverflow.com/questions/33809638/how-do-i-print-a-list-of-nodes-at-a-specific-level-of-a-general-tree/33809991#33809991", "title": "How do I print a list of nodes at a specific level of a general tree?", "body": "<p>Ok, let's to this step by step (leaving you with some holes for now):</p>\n\n<h2>nodes at level 0</h2>\n\n<p>as I understand it you are suppost to only return the roots value here (of course in a list)</p>\n\n<p>so what goes in the <code>...</code> here?</p>\n\n<pre><code>nodesAtLevel 0 (Node a subtrees) = ...\n</code></pre>\n\n<h2>nodes at deeper levels</h2>\n\n<p>well the structure is nicely recursive so we probably want to use recursion.</p>\n\n<p>So let's go recursively deeper one level deeper (decreasing the <em>way we have left to go</em> - aka our <code>n</code>)</p>\n\n<p>But there is a slight problem: <code>nodesAtLevel</code> acts on a single node but we only have a list of nodes left (the <code>subtrees</code>) .. so what to do?</p>\n\n<p>Well maybe we should do something <em>for each</em> of the subtrees/subnodes - so we need to find the right function <code>f</code> here (<em>hint</em> you probably want to <em>map</em> and <em>concat</em> the results ...):</p>\n\n<pre><code>nodesAtLevel n (Node a subtrees) = f (nodesAtLevel (n-1)) subtrees\n</code></pre>\n\n<p>what can that <code>f</code> be? Can you guess it? Maybe you can write it yourself if not?</p>\n\n<hr>\n\n<h3>Additional Hint:</h3>\n\n<p>maybe you should first find out what <em>type</em> <code>f</code> has - because then you might be even able to use <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow\">Hoogle</a> to find a good fit.</p>\n\n<p>If you use a newer GHC version you an let the compiler do the work if you write </p>\n\n<pre><code>nodesAtLevel n (Node _ subtrees) = _f (nodesAtLevel (n-1)) subtrees\n</code></pre>\n\n<p>where <code>_f</code> is a <strong>hole</strong> - now if you load this in GHCi it will give you a</p>\n\n<pre><code>Found hole \u2018_f\u2019 with type: ....\n</code></pre>\n\n<p>error with lot's of additional information ;)</p>\n\n<hr>\n\n<p>so just find <code>...</code> and <code>f</code> and this should work ;)</p>\n\n<p><strong>BTW</strong> you can use the functions you already have instead of <em>pattern matching</em> again as I did, but I feel it's easier to see the result this way - so if you follow this <em>path</em> you don't need to use <code>treeSubtrees</code> or <code>treeRoot</code></p>\n\n<hr>\n\n<h2>solution</h2>\n\n<ul>\n<li><code>...</code> = <code>[a]</code></li>\n<li><code>f</code> = <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:concatMap\" rel=\"nofollow\"><code>concatMap</code></a></li>\n</ul>\n\n<p>so one possible way to do it is this:</p>\n\n<pre><code>nodesAtLevel :: Int -&gt; Tree a -&gt; [a]\nnodesAtLevel 0 (Node a _) = [a]\nnodesAtLevel n (Node _ subtrees) = concatMap (nodesAtLevel (n-1)) subtrees\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4804953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f84ac4b4d027ecfeed018596e791fb1?s=128&d=identicon&r=PG&f=1", "display_name": "JavaUser90909", "link": "https://stackoverflow.com/users/4804953/javauser90909"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 0, "accepted_answer_id": 33809991, "answer_count": 1, "score": 1, "last_activity_date": 1447956511, "creation_date": 1447951379, "question_id": 33809638, "link": "https://stackoverflow.com/questions/33809638/how-do-i-print-a-list-of-nodes-at-a-specific-level-of-a-general-tree", "title": "How do I print a list of nodes at a specific level of a general tree?", "body": "<p>I am given the following tree definition and functions:</p>\n\n<pre><code>data Tree a = Node a [Tree a] deriving (Eq, Read, Show)\n\ntreeRoot :: Tree a -&gt; a\ntreeRoot (Node a _) = a\n\ntreeSubtrees :: Tree a -&gt; [Tree a]\ntreeSubtrees (Node _ subtrees) = subtrees\n</code></pre>\n\n<p>I need to create a function 'nodesAtLevel' that takes two arguments: a tree and an integer n >= 0. The function needs to return a list of all the nodes at the given level n. The root of the tree is level 0. I am very new to Haskell, and yes, this is part of a homework assignment, so if you could help walk me through the thought process of completing this, it would be greatly appreciated! I currently have the definition of the 'nodesAtLevel' function written as follows:</p>\n\n<pre><code>nodesAtLevel :: Int -&gt; Tree a -&gt; [a]\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1447945031, "post_id": 33807187, "comment_id": 55379790, "body": "The <code>(&#47;&#47;)</code> operator only removes the <i>first</i> occurrence of an item. Try using <code>filter</code> instead."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1447946064, "post_id": 33807187, "comment_id": 55380562, "body": "thanks for your answer!"}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 2, "last_activity_date": 1447959924, "creation_date": 1447959924, "answer_id": 33812331, "question_id": 33807187, "link": "https://stackoverflow.com/questions/33807187/list-dont-removes-empty-lists-in-a-list-of-lists/33812331#33812331", "title": "List.\\\\ don&#39;t removes empty lists in a list of lists", "body": "<p>First of all, <code>xs \\\\ ys</code> removes the first occurrence of an element in <code>ys</code> from <code>xs</code>, e.g. </p>\n\n<pre><code>[1,2,1,2] \\\\ [1] == [2,1,2]\n</code></pre>\n\n<p>Furthermore, <code>[]</code> doesn't contain an element at all, so <code>\\\\ []</code> doesn't have any effect:</p>\n\n<pre><code>xs \\\\ [] = xs -- due to (ys ++ xs) \\\\ ys == xs and [] ++ xs == xs\n</code></pre>\n\n<p>However, you can use <code>filter</code> if you want to remove a empty lists from a list of lists:</p>\n\n<pre><code>filter (not . null) [[1,2,3,5], [], [1,2,3], [], [1,2]] == [[1,2,3,5], [1,2,3], [1,2]]\n</code></pre>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447959924, "creation_date": 1447944810, "question_id": 33807187, "link": "https://stackoverflow.com/questions/33807187/list-dont-removes-empty-lists-in-a-list-of-lists", "title": "List.\\\\ don&#39;t removes empty lists in a list of lists", "body": "<p>I am facing something very strange:</p>\n\n<p>these lines of code:</p>\n\n<pre><code>piles n =\n  let\n    listes2 = map (\\i -&gt; [n-i,i]) [1..(n `div` 2)]\n  in ( [[n,0]] ++ (L.concat [trouveTous [l] | l &lt;- listes2 ])) L.\\\\ []\n</code></pre>\n\n<p>produces a list of lists where there are some [].\ndue to the \"L.\\ []\" just before the return of the function \"listes\", how can [] be present in the return?</p>\n"}, {"tags": ["haskell", "functional-programming", "typeclass", "unification", "type-theory"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1447947582, "post_id": 33807002, "comment_id": 55381672, "body": "In short, <code>[a] -&gt; [a]</code> and <code>[a] -&gt; [b]</code> do indeed unify; but unification is not the operation of interest here. Instead, the operation of interest is type checking; &quot;can this term be given this type?&quot;. <code>map id</code> cannot be given the type <code>[a] -&gt; [b]</code> -- do you believe this, or is this also part of the confusion?"}, {"owner": {"reputation": 123, "user_id": 3167200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b800513b9839ba7d5b6e2df5bfa437?s=128&d=identicon&r=PG", "display_name": "TWhit", "link": "https://stackoverflow.com/users/3167200/twhit"}, "edited": false, "score": 0, "creation_date": 1447947871, "post_id": 33807002, "comment_id": 55381881, "body": "Yes, I hadn&#39;t realized that the types of method implementations must be <i>exactly</i> equal to the type stipulated by the class, not just unifiable."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1447949282, "post_id": 33807002, "comment_id": 55382995, "body": "@TWhit Well, that&#39;s not quite accurate, either; for example, it&#39;s okay to give a method definition whose inferred type would be more general than the type demanded by the instance. (There are other exceptions as well.) But yes, that&#39;s the basic idea."}, {"owner": {"reputation": 123, "user_id": 3167200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b800513b9839ba7d5b6e2df5bfa437?s=128&d=identicon&r=PG", "display_name": "TWhit", "link": "https://stackoverflow.com/users/3167200/twhit"}, "edited": false, "score": 0, "creation_date": 1447950170, "post_id": 33807002, "comment_id": 55383663, "body": "Would it be accurate to say that the method definition&#39;s inferred type may not be further concretized w.r.t. the class&#39; stipulated type?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1447953248, "post_id": 33807002, "comment_id": 55385867, "body": "@TWhit I think talking about the definition&#39;s inferred type is misleading. Instead, the right thing to say is that the definition can be given the type specified by the class. It&#39;s totally possible to give a method definition whose type <i>cannot</i> be inferred (and does not even have a most general type), but which is accepted by the compiler -- so the real criteria is about type checking, not type inference."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447953401, "post_id": 33807002, "comment_id": 55385991, "body": "By the way, I fully recognize that I&#39;m using jargon that could easily hold a lot of meaning for me and little for you -- but it&#39;s tricky for me to spot which bits might be hard to understand. So please keep asking questions and talking about where you&#39;re most confused."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 3167200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b800513b9839ba7d5b6e2df5bfa437?s=128&d=identicon&r=PG", "display_name": "TWhit", "link": "https://stackoverflow.com/users/3167200/twhit"}, "edited": false, "score": 0, "creation_date": 1447946475, "post_id": 33807712, "comment_id": 55380884, "body": "<i>Potentially</i> different, not <i>necessarily</i> different. The specific type of <code>mapB</code> in the instance declaration is <code>[a] -&gt; [a]</code>. Letting <code>m ~ []</code> since that&#39;s the body of the instance we&#39;re in, <code>[a] -&gt; [a]</code> is unifiable with <code>[a] -&gt; [b]</code> by letting <code>a ~ b</code>. Other examples include <code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code> ; <code>map id :: [a] -&gt; [a]</code>, and in GHCi <code>:t [undefined :: a -&gt; b, undefined a -&gt; a]</code> yields <code>[undefined :: a -&gt; b, undefined a -&gt; a] :: [b -&gt; b]</code>."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 123, "user_id": 3167200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b800513b9839ba7d5b6e2df5bfa437?s=128&d=identicon&r=PG", "display_name": "TWhit", "link": "https://stackoverflow.com/users/3167200/twhit"}, "edited": false, "score": 1, "creation_date": 1447946637, "post_id": 33807712, "comment_id": 55381015, "body": "@TWhit you&#39;re confusing the two examples. In your case, the <code>id</code> function makes the type of the mapping more concrete, but that&#39;s because we&#39;re <i>outside</i> of the function and we&#39;re utilizing <i>one of its possible concretizations</i>. The inside of it still has to be implemented in a way that permits <code>a</code> and <code>b</code> to differ. What you&#39;re doing is implementing your function, not using it, hence what you wrote above isn&#39;t correct, since someone might want to use your class in a context where <code>a ~&#47;~ b</code>."}, {"owner": {"reputation": 123, "user_id": 3167200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b800513b9839ba7d5b6e2df5bfa437?s=128&d=identicon&r=PG", "display_name": "TWhit", "link": "https://stackoverflow.com/users/3167200/twhit"}, "edited": false, "score": 1, "creation_date": 1447947044, "post_id": 33807712, "comment_id": 55381309, "body": "Ok, I see; in a class instance I&#39;m not permitted to concretize the type stipulated in the class definition."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 2, "last_activity_date": 1447946174, "creation_date": 1447946174, "answer_id": 33807712, "question_id": 33807002, "link": "https://stackoverflow.com/questions/33807002/unification-weirdness-in-typeclass-instance/33807712#33807712", "title": "Unification Weirdness in Typeclass Instance", "body": "<blockquote>\n  <p>What am I missing here?</p>\n</blockquote>\n\n<p><code>map id</code> produces a list of values of some arbitrary type given a list of such values. <code>[a] -&gt; [b]</code> promises to produce a list of values of some arbitrary type given a list of values of <em>potentially different</em> type.</p>\n\n<p>Hence what it expects is <code>a -&gt; b</code>, but your id-based function can only take what it returns, so <code>b -&gt; b</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 0, "last_activity_date": 1448041768, "creation_date": 1448041768, "answer_id": 33833003, "question_id": 33807002, "link": "https://stackoverflow.com/questions/33807002/unification-weirdness-in-typeclass-instance/33833003#33833003", "title": "Unification Weirdness in Typeclass Instance", "body": "<p>More generally, you said that you would provide functions with type:</p>\n\n<pre><code>forall a b.[a] -&gt; [b]\n</code></pre>\n\n<p>in your instance definitions. The compiler took your word on that.</p>\n\n<p>Now that you came up with an instance, the compiler really needs to see that miraculous function. And it rejects all code that does less than what you promised.</p>\n\n<p>Before you continue, you should try to write a function</p>\n\n<pre><code>forall a b. a -&gt; b\n</code></pre>\n\n<p>and you will see that you can at best come up with something like:</p>\n\n<pre><code>f x = f x\ng x = error \"not terminating.\"\n</code></pre>\n\n<p>And as long as there is no usable element mapping function, only the following instances can be written:</p>\n\n<pre><code>instance BlindMap (Maybe a) where mapB _ = Nothing\ninstance BlindMap ([a])     where mapB _ = []\n</code></pre>\n\n<p>and so on in the same spirit. </p>\n"}], "owner": {"reputation": 123, "user_id": 3167200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2b800513b9839ba7d5b6e2df5bfa437?s=128&d=identicon&r=PG", "display_name": "TWhit", "link": "https://stackoverflow.com/users/3167200/twhit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 33807712, "answer_count": 2, "score": 1, "last_activity_date": 1448041768, "creation_date": 1447944259, "question_id": 33807002, "link": "https://stackoverflow.com/questions/33807002/unification-weirdness-in-typeclass-instance", "title": "Unification Weirdness in Typeclass Instance", "body": "<p>Let's say I have the following (silly) class:</p>\n\n<pre><code>class BlindMap m where\n    mapB :: m a -&gt; m b\n</code></pre>\n\n<p>I could provide the following <code>[]</code> instance:</p>\n\n<pre><code>instance BlindMap [] where\n    mapB = map id\n</code></pre>\n\n<p>The type of the RHS is <code>[a] -&gt; [a]</code> which should unify with <code>[a] -&gt; [b]</code>, but GHC doesn't think so:</p>\n\n<pre><code>Couldn't match type \u2018a\u2019 with \u2018b\u2019\n  \u2018a\u2019 is a rigid type variable bound by\n      the type signature for mapB :: [a] -&gt; [b] at dingas.hs:11:5\n  \u2018b\u2019 is a rigid type variable bound by\n      the type signature for mapB :: [a] -&gt; [b] at dingas.hs:11:5\nExpected type: a -&gt; b\n  Actual type: b -&gt; b\nRelevant bindings include\n  mapB :: [a] -&gt; [b]\nIn the first argument of \u2018map\u2019, namely \u2018id\u2019\nIn the expression: map id\n</code></pre>\n\n<p>What am I missing here?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1448083373, "post_id": 33803166, "comment_id": 55445060, "body": "A GADT is an algebraic datatype indexed by types, but for whatever technical reason, you cannot have a kind-indexed GADT. This is what the error means."}], "answers": [{"comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1447936651, "post_id": 33803204, "comment_id": 55373621, "body": "Note that you don&#39;t need <code>kproxy</code> as index for <code>SomeSingWith</code>, because <code>k</code>  is apparent from <code>f</code>&#39;s kind."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1447937211, "post_id": 33803204, "comment_id": 55374041, "body": "The definition here is identical to the one in the question. Was that intentional?"}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1447937717, "post_id": 33803204, "comment_id": 55374377, "body": "@ReidBarton Sorry. I discovered the solution half-way through writing the question, but I decided to finish it out anyway. It looks like I did end up posting the solution in the question by accident. I&#39;ll change it to the non-working version (which is a one-character difference)."}], "tags": [], "owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "is_accepted": false, "score": 2, "last_activity_date": 1447934004, "creation_date": 1447934004, "answer_id": 33803204, "question_id": 33803166, "link": "https://stackoverflow.com/questions/33803166/ghc-existentially-quantified-singleton/33803204#33803204", "title": "GHC existentially quantified singleton", "body": "<p>I figured it out. The second argument of <code>TyFun</code> needs to be kinded <code>*</code> instead of being allowed to be any arbitrary kind. This makes sense. However, the error message associated with the mistake is not helpful.</p>\n\n<pre><code>data SomeSingWith (kproxy :: KProxy k) (f :: TyFun k * -&gt; *) where\n  SomeSingWith :: Sing (a :: k) -&gt; Apply g a -&gt; SomeSingWith ('KProxy :: KProxy k) g\n</code></pre>\n"}], "owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447937855, "creation_date": 1447933889, "last_edit_date": 1447937855, "question_id": 33803166, "link": "https://stackoverflow.com/questions/33803166/ghc-existentially-quantified-singleton", "title": "GHC existentially quantified singleton", "body": "<p>I'm using GHC 7.10 and the <code>singletons</code> package. There's a GADT named <a href=\"http://hackage.haskell.org/package/singletons-2.0.1/docs/Data-Singletons.html#t:SomeSing\" rel=\"nofollow\">SomeSing</a> in this library that allows you to existentially quantify a singleton. It's definition looks like this:</p>\n\n<pre><code>data SomeSing (kproxy :: KProxy k) where\n  SomeSing :: Sing (a :: k) -&gt; SomeSing ('KProxy :: KProxy k)\n</code></pre>\n\n<p>And it works great. We can wrap up a singleton with this so that only the kind is known, not the type.</p>\n\n<p>I wanted to create a variant, a similar wrapper that would allow me to wrap up a singleton and the result of a type function applied to it:</p>\n\n<pre><code>data SomeSingWith (kproxy :: KProxy k) (f :: TyFun k n -&gt; *) where\n  SomeSingWith :: Sing (a :: k) -&gt; Apply g a -&gt; SomeSingWith ('KProxy :: KProxy k) g\n</code></pre>\n\n<p>However, I get this error:</p>\n\n<pre><code>Data constructor \u2018SomeSingWith\u2019 cannot be GADT-like in its *kind* arguments\n  SomeSingWith :: forall (k :: BOX) (g :: TyFun k * -&gt; *) (a :: k).\n                  Sing a -&gt; Apply g a -&gt; SomeSingWith 'KProxy g\nIn the definition of data constructor \u2018SomeSingWith\u2019\nIn the data declaration for \u2018SomeSingWith\u2019\n</code></pre>\n\n<p>What does this mean? And can it be fixed, or is what I'm doing impossible in GHC?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1447909809, "post_id": 33795640, "comment_id": 55357948, "body": "you need to call <code>addThree</code> recursively and supply it <code>n-1</code> as argument"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1447909810, "post_id": 33795640, "comment_id": 55357949, "body": "Surely &quot;Learn you a Haskell&quot; explains how to define simple recursive functions"}, {"owner": {"reputation": 1203, "user_id": 587418, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d961c1bd949176868a8d2e491d2891ea?s=128&d=identicon&r=PG", "display_name": "BrianWilson", "link": "https://stackoverflow.com/users/587418/brianwilson"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1447913656, "post_id": 33795640, "comment_id": 55359379, "body": "@JohnColeman Yes. There are a few examples, but I am struggling to understand so that I can  apply them in the real world."}], "answers": [{"comments": [{"owner": {"reputation": 1203, "user_id": 587418, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d961c1bd949176868a8d2e491d2891ea?s=128&d=identicon&r=PG", "display_name": "BrianWilson", "link": "https://stackoverflow.com/users/587418/brianwilson"}, "edited": false, "score": 0, "creation_date": 1447912873, "post_id": 33795869, "comment_id": 55359063, "body": "Thank you. Thank you. Not only does this answer my question as to the syntax, there is much to refer back to as I continue to learn Haskell. BTW how did you enter the subscript?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 1203, "user_id": 587418, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d961c1bd949176868a8d2e491d2891ea?s=128&d=identicon&r=PG", "display_name": "BrianWilson", "link": "https://stackoverflow.com/users/587418/brianwilson"}, "edited": false, "score": 2, "creation_date": 1447912993, "post_id": 33795869, "comment_id": 55359109, "body": "@BrianWilson <code>&lt;sub&gt;Subscript&lt;&#47;sup&gt;</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1447913004, "post_id": 33795869, "comment_id": 55359114, "body": "for the subscript you just have to use <code>a&lt;sub&gt;n-1&lt;&#47;sub&gt;</code> right in the text editor"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 8, "last_activity_date": 1447911368, "last_edit_date": 1447911368, "creation_date": 1447910704, "answer_id": 33795869, "question_id": 33795640, "link": "https://stackoverflow.com/questions/33795640/recursive-arithmetic-sequence-in-haskell/33795869#33795869", "title": "Recursive arithmetic sequence in Haskell", "body": "<p>First a <em>word</em> on Algebra and you problem: I think you are slightly wrong - if we write 3x it usually means 3*x (Mathematicans are even more lazy then programmers) so your series indeed should look like a<sub>n</sub> = 8 + 3*a<sub>n-1</sub> IMO</p>\n\n<p>Then a<sub>n</sub> is the <em>n-th</em> element in a series of a's: a<sub>0</sub>, a<sub>1</sub>, a<sub>2</sub>, a<sub>3</sub>, ... that's why you there is a big difference between <code>(n-1)</code> and <code>addThree (n-1)</code> as the last one would designate a<sub>n-1</sub> while the first one would just be a number not really connected to your series.</p>\n\n<hr>\n\n<p>Ok, let's have a look at your series a<sub>n</sub> = 8 + 3a<sub>n-1</sub> (this is how I would understand it - because otherwise you would have x=8+3*x and therefore just x = -4:</p>\n\n<ul>\n<li>you can choose a<sub>0</sub> - let's say it`s 0 (as you did?)</li>\n<li>then a<sub>1</sub>=8+3*0 = 8</li>\n<li>a<sub>2</sub>=8+3*8 = 4*8 = 32</li>\n<li>a<sub>3</sub>=8+3*32 = 8+3*32 = 104</li>\n<li>...</li>\n</ul>\n\n<p>ok let's say you want to use recursion than the problem directly translates into Haskell:</p>\n\n<pre><code>a :: Integer -&gt; Integer\na 0 = 0\na n = 8 + 3 * a (n-1)\n\nseries :: [Integer]\nseries = map a [0..]\n</code></pre>\n\n<p>giving you (for the first 5 elements):</p>\n\n<pre><code>\u03bb&gt; take 5 series\n[0,8,32,104,320]\n</code></pre>\n\n<hr>\n\n<p>Please note that this is a very bad performing way to do it - as the recursive call in <code>a</code> really does the same work over and over again.</p>\n\n<p>A technical way to solve this is to observe that you only need the previous element to get the next one and use <code>Data.List.unfoldr</code>:</p>\n\n<pre><code>series :: [Integer]\nseries = unfoldr (\\ prev -&gt; Just (prev, 8 + 3 * prev)) 0\n</code></pre>\n\n<hr>\n\n<p>now of course you can get a lot more fancier with Haskell - for example you can define the series as it is (using Haskells laziness):</p>\n\n<pre><code>series :: [Integer]\nseries = 0 : map (\\ prev -&gt; 8 + 3 * prev) series\n</code></pre>\n\n<p>and I am sure there are much more ways out there to do it but I hope this will help you along a bit</p>\n"}], "owner": {"reputation": 1203, "user_id": 587418, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d961c1bd949176868a8d2e491d2891ea?s=128&d=identicon&r=PG", "display_name": "BrianWilson", "link": "https://stackoverflow.com/users/587418/brianwilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1447913420, "creation_date": 1447909527, "last_edit_date": 1447913420, "question_id": 33795640, "link": "https://stackoverflow.com/questions/33795640/recursive-arithmetic-sequence-in-haskell", "title": "Recursive arithmetic sequence in Haskell", "body": "<p>It's been nearly 30 years since I took an Algebra class and I am struggling with some of the concepts in Haskell as I work through <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow\"><em>Learn you a Haskell</em></a>. The concept that I am working on now is \"recursion\". I have watched several youtube videos on the subject and found a site with the arithmetic sequence problem: a<sub>n</sub> = 8 + 3(a<sub>n-1</sub>) which I understand to be a<sub>n</sub> = a<sub>n-1</sub> + 3 This is what I have in Haskell.</p>\n\n<pre><code>addThree :: (Integral a) =&gt; a -&gt; a\naddThree 1 = 8\naddThree n = (n-1) + 3\n</code></pre>\n\n<p>Running the script yields:</p>\n\n<pre><code>addThree 1\n8\naddThree 2\n4\naddThree 3\n6\n</code></pre>\n\n<p>I am able to solve this and similar recursions on paper, (after polishing much rust), but do not understand the syntax in Haskell. </p>\n\n<p><strong>My Question</strong> How do I define the base and the function in Haskell as per my example?</p>\n\n<hr>\n\n<p>If this is not the place for such questions, kindly direct me to where I should post. I see there are Stack Exchanges for Super User, Programmers, and Mathematics, but not sure which of the Stack family best fits my question.</p>\n"}, {"tags": ["performance", "haskell", "fold"], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 11, "last_activity_date": 1447896333, "creation_date": 1447896333, "answer_id": 33793662, "question_id": 33793167, "link": "https://stackoverflow.com/questions/33793167/haskell-foldl-in-terms-of-foldr-and-performance-issues/33793662#33793662", "title": "Haskell - foldl&#39; in terms of foldr and performance issues", "body": "<p>In GHC 7.10+, <code>foldl</code> and <code>foldl'</code> are both defined in terms of <code>foldr</code>. The reason that they weren't before is that GHC didn't optimize the <code>foldr</code> definition well enough to participate in <code>foldr/build</code> fusion.  But GHC 7.10 introduced a new optimization specifically to allow <code>foldr/build</code> fusion to succeed while using <code>foldl'</code> or <code>foldl'</code> defined that way.</p>\n\n<p>The big win here is that an expression like <code>foldl' (+) 0 [1..10]</code> can be optimized down to never allocating a <code>(:)</code> constructor at all.  And we all know that the absolute fastest garbage collection is when there's no garbage to collect.</p>\n\n<p>See <a href=\"http://www.joachim-breitner.de/publications/CallArity-TFP.pdf\">http://www.joachim-breitner.de/publications/CallArity-TFP.pdf</a> for information on the new optimization in GHC 7.10, and why it was necessary.</p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 3, "accepted_answer_id": 33793662, "answer_count": 1, "score": 3, "last_activity_date": 1447896333, "creation_date": 1447892840, "last_edit_date": 1447893145, "question_id": 33793167, "link": "https://stackoverflow.com/questions/33793167/haskell-foldl-in-terms-of-foldr-and-performance-issues", "title": "Haskell - foldl&#39; in terms of foldr and performance issues", "body": "<p>While studying <code>fold</code> in depth with <a href=\"http://www.cs.nott.ac.uk/~gmh/fold.pdf\" rel=\"nofollow\">A tutorial on the universality and expressiveness of fold\n</a> I found an amazing definition of <code>foldl</code> using <code>foldr</code>:</p>\n\n<pre><code>-- I used one lambda function inside another only to improve reading\nfoldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldl f z xs = foldr (\\x g -&gt; (\\a -&gt; g (f a x))) id xs z\n</code></pre>\n\n<p>After understanding what is going on, I thought I could even use <code>foldr</code> to define <code>foldl'</code>, which would be like this:</p>\n\n<pre><code>foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldl' f z xs = foldr (\\x g -&gt; (\\a -&gt; let z' = a `f` x in z' `seq` g z')) id xs z\n</code></pre>\n\n<p>Which is parallel to this:</p>\n\n<pre><code>foldl' :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldl' f z (x:xs) = let z' = z `f` x \n                    in seq z' $ foldl' f z' xs \nfoldl' _ z _     = z\n</code></pre>\n\n<p>It seems that both of them are running in constant space (not creating thunks) in simple cases like this:</p>\n\n<pre><code>*Main&gt; foldl' (+) 0 [1..1000000]\n500000500000\n</code></pre>\n\n<p><strong>May I consider both definitions of <code>foldl'</code> equivalent in terms of performance?</strong> </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 1, "creation_date": 1447897163, "post_id": 33793088, "comment_id": 55354375, "body": "I would recommend to <a href=\"http://stackoverflow.com/a/33586782/1094403\">follow ErikR&#39;s advice</a> to that recent question (or <a href=\"http://stackoverflow.com/a/33621574/1094403\">mine</a> which is the same) and just use <code>String</code>. Basically, using existential quantification the way you&#39;re doing here is no better than just using <code>String</code>."}, {"owner": {"reputation": 1741, "user_id": 639465, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00f1bf67a52fc75fb6da011edcf3f42b?s=128&d=identicon&r=PG", "display_name": "caio", "link": "https://stackoverflow.com/users/639465/caio"}, "reply_to_user": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1447900610, "post_id": 33793088, "comment_id": 55355324, "body": "@LuisCasillas you&#39;re right. I&#39;ll follow your suggestion, but leave the question for further references. Thanks :)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447912842, "post_id": 33793088, "comment_id": 55359045, "body": "This has been asked just <a href=\"http://stackoverflow.com/search?q=%5Bhaskell%5D+string+show+quotes\">so very many times before</a>."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447922423, "post_id": 33793127, "comment_id": 55363633, "body": "There&#39;s a complete overlap between the two instances heads, which is going to cause problems, since contexts are not used during overlap resolution. You could try to change the first to <code>instance Show1 String</code>. That would still not help in <code>Showable</code>, though."}], "tags": [], "owner": {"reputation": 16397, "user_id": 303939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3f6c98562c6d9bb188eacc2002af257?s=128&d=identicon&r=PG", "display_name": "Ming-Tang", "link": "https://stackoverflow.com/users/303939/ming-tang"}, "is_accepted": false, "score": 0, "last_activity_date": 1447892962, "last_edit_date": 1447892962, "creation_date": 1447892582, "answer_id": 33793127, "question_id": 33793088, "link": "https://stackoverflow.com/questions/33793088/when-its-a-string-use-id-otherwise-use-show/33793127#33793127", "title": "When it&#39;s a String use &quot;id&quot;, otherwise use &quot;show&quot;", "body": "<p>I don't know how to do this, but I'm pretty sure this requires some Haskell extensions. First, there is the equality constraint, like <code>(a ~ String)</code>. The <code>~</code> notation is explained in this article: <a href=\"http://chrisdone.com/posts/haskell-constraint-trick\" rel=\"nofollow\">http://chrisdone.com/posts/haskell-constraint-trick</a></p>\n\n<p>Also, there is overlapping instances: <a href=\"https://wiki.haskell.org/GHC/AdvancedOverlap\" rel=\"nofollow\">https://wiki.haskell.org/GHC/AdvancedOverlap</a></p>\n\n<p>Here is what I would do (untested code, unlikely to compile):</p>\n\n<pre><code>class Show1 a where\n  show1 :: a -&gt; String\n\n-- requires some extension since String = [Char]\ninstance (a ~ String) =&gt; Show1 a where\n  show1 = id\n\ninstance Show a =&gt; Show1 a where\n  show1 a = show a\n\ninstance Show Showable where\n  show (Showable a) = show1 a\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1447923053, "post_id": 33796565, "comment_id": 55364022, "body": "how&#39;s that different from <code>data Showable = forall a. Show a =&gt; Showable { isString :: Bool, unShowable :: a }</code> or in fact even just calling <code>show nonStr</code> and <code>str</code> as appropriate? what compile time &quot;automation&quot; does your approach offer over manual selection?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1447975135, "post_id": 33796565, "comment_id": 55398118, "body": "@ErikAllik That&#39;s a great point. You&#39;re right, you don&#39;t gain anything here. I got a bit overexcited to apply dependent sums. It does demonstrate the technique (which I believe does have useful applications, especially when GADTs are involved), but this would not be the best application of it."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1447983447, "post_id": 33796565, "comment_id": 55400862, "body": "@ErikAllik Actually, I spoke too soon. In order to implement that <code>Show</code> instance, the type checker needs to know that <code>a ~ String</code> for one of the cases and this is not possible with just a <code>Bool</code>. I would still agree that using <code>show nonStr</code> and <code>str</code> directly would be preferable for this particular example though."}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": false, "score": 1, "last_activity_date": 1447914827, "last_edit_date": 1447914827, "creation_date": 1447913900, "answer_id": 33796565, "question_id": 33793088, "link": "https://stackoverflow.com/questions/33793088/when-its-a-string-use-id-otherwise-use-show/33796565#33796565", "title": "When it&#39;s a String use &quot;id&quot;, otherwise use &quot;show&quot;", "body": "<p>It is possible to do something along these lines but you need some boilerplate unfortunately, so it would probably be better to go about it in a different way.</p>\n\n<p>Here is one way it could be done though (using something equivalent to a <a href=\"https://hackage.haskell.org/package/dependent-sum\" rel=\"nofollow\">dependent sum</a>):</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification, GADTs, DataKinds, TypeFamilies #-}\n\ntype family StringP a where\n  StringP String = 'True\n  StringP a      = 'False\n\ndata CheckStringness a where\n  IsTypeString  ::                         CheckStringness String\n  NotTypeString :: (StringP a) ~ 'False =&gt; CheckStringness a\n\ndata Showable = forall a. Show a =&gt; Showable (CheckStringness a) a\n\ninstance Show Showable where\n  show (Showable IsTypeString  str  ) = str\n  show (Showable NotTypeString other) = show other\n</code></pre>\n\n<p>The difficult part is that you cannot directly reflect a type into a value in the way that you would want to for this, so you have to write a bit of boilerplate code to take care of that.</p>\n\n<p>Example usage:</p>\n\n<pre><code>ghci&gt; show (Showable NotTypeString (123 :: Int))\n\"123\"\nghci&gt; show (Showable NotTypeString ())\n\"()\"\nghci&gt; show (Showable IsTypeString \"abc\")\n\"abc\"\n</code></pre>\n\n<p>Like I said though, I would try to approach the problem in a different way entirely (such as Luis Casillas's and ErikR's recommendations in the comments on this question), to avoid being in this situation in this first place. The main reason I demonstrated this is that things similar to this technique may at some point become nicer to work with and have more practical value than they do now, especially as the dependent Haskell initiative continues.</p>\n"}], "owner": {"reputation": 1741, "user_id": 639465, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/00f1bf67a52fc75fb6da011edcf3f42b?s=128&d=identicon&r=PG", "display_name": "caio", "link": "https://stackoverflow.com/users/639465/caio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1447914827, "creation_date": 1447892341, "question_id": 33793088, "link": "https://stackoverflow.com/questions/33793088/when-its-a-string-use-id-otherwise-use-show", "title": "When it&#39;s a String use &quot;id&quot;, otherwise use &quot;show&quot;", "body": "<p>I have the following piece of code</p>\n\n<pre><code>data Showable = forall a . (Show a) =&gt; Showable a\n\ninstance Show Showable where\n    show (Showable a) =\n        show a\n</code></pre>\n\n<p>It works quite fine:</p>\n\n<pre><code>&gt; show (Showable 1)\n\"1\"\n&gt; show (Showable True)\n\"True\"\n</code></pre>\n\n<p>But when it's a string, I get unwanted quotes:</p>\n\n<pre><code>&gt; show (Showable \"foo\")\n\"\\\"foo\\\"\"\n</code></pre>\n\n<p>I know it's because of apply <code>show</code> over a string, so it's the same as:</p>\n\n<pre><code>&gt; show \"foo\"\n\"\\\"foo\\\"\"\n</code></pre>\n\n<p>What I want to do, is when it's a <code>String</code>, use <code>id</code> instead of <code>show</code>.</p>\n\n<p>Something like:</p>\n\n<pre><code>instance Show Showable where\n    show (Showable a) =\n        case a of\n            (String _) -&gt; id a\n            _ -&gt; show a\n</code></pre>\n\n<p>Is it possible? Any workarounds? </p>\n"}]