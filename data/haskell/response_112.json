[{"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 431, "user_id": 2423002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/857ed0fe0d30694c2c87e42a917e90bb?s=128&d=identicon&r=PG", "display_name": "John Stef", "link": "https://stackoverflow.com/users/2423002/john-stef"}, "edited": false, "score": 1, "creation_date": 1488411533, "post_id": 42544190, "comment_id": 72224159, "body": "Thanks for your reply! If it is not a problem, can you explain the difference of the two approaches?"}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 431, "user_id": 2423002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/857ed0fe0d30694c2c87e42a917e90bb?s=128&d=identicon&r=PG", "display_name": "John Stef", "link": "https://stackoverflow.com/users/2423002/john-stef"}, "edited": false, "score": 0, "creation_date": 1488422358, "post_id": 42544190, "comment_id": 72227258, "body": "@JohnStef It would probably be more useful for you to read about data declarations in haskell"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 6, "last_activity_date": 1488482400, "last_edit_date": 1488482400, "creation_date": 1488411294, "answer_id": 42544190, "question_id": 42544101, "link": "https://stackoverflow.com/questions/42544101/show-matrix-function-in-haskell/42544190#42544190", "title": "Show matrix function in haskell", "body": "<p>It is actually no problem - if you want to you can declare it this way</p>\n\n<pre><code>data Mat a = Mat [[a]]\n</code></pre>\n\n<p>then you just have to alter the show instance declaration a bit</p>\n\n<pre><code>instance (Show a) =&gt; Show (Mat a) where\n     show (Mat x) = unlines $ map (unwords . map show) x\n</code></pre>\n\n<h2>Edit</h2>\n\n<p>The other approach has a few upsides:</p>\n\n<p>If you want to get a bit more performance you can change the <code>data</code> keyword to <code>newtype</code>.</p>\n\n<p>Moreover if you want to assert that this list of lists contain only lists of the same size - you can <em>not</em> export the constructor <code>Mat</code> but provide a 'smart' constructor <code>mat :: [[a]] -&gt; Maybe (Mat a)</code> like:</p>\n\n<pre><code>mat x = if  (length $ nub $ map length x) &lt;= 1) then Just x else Nothing\n</code></pre>\n\n<p>but with the latter approach you can always still extract the <code>[[a]]</code> part if you export <code>mrows</code></p>\n\n<pre><code>module Mat (Mat, mrows, mat) where ...\n</code></pre>\n\n<p>would hide the <code>Mat</code> construcor, but export the type of <code>Mat</code> where </p>\n\n<pre><code>module Mat (Mat(..), mat) ...\n</code></pre>\n\n<p>would export everything</p>\n\n<h2>Edit2</h2>\n\n<p>AAAAAnother thing - if you have a type with multiple records say</p>\n\n<pre><code>data Pirate = Pirate { head :: HeadThing\n                     , rightArm :: ArmThing\n                     , leftArm :: ArmThing\n                     , rightLeg :: LegThing\n                     , leftLeg :: LegThing}\n\ndata ArmThing = ...\ndata HeadThing = ...\ndata LegThing = ...\n</code></pre>\n\n<p>you can update one (or more \"members\") with record syntax - i.e.</p>\n\n<pre><code>redBeard :: Pirate\nredBeard = blackbeard {head = RedBeard, rightArm = Hook}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1488452906, "creation_date": 1488452906, "answer_id": 42553782, "question_id": 42544101, "link": "https://stackoverflow.com/questions/42544101/show-matrix-function-in-haskell/42553782#42553782", "title": "Show matrix function in haskell", "body": "<pre><code>data Mat a = Mat {mrows :: [[a]]}\n</code></pre>\n\n<p>This is Haskell's \"record syntax\". (That's the term you want to search for.) The above declaration is identical to</p>\n\n<pre><code>data Mat a = Mat [[a]]\n</code></pre>\n\n<p>The difference is that the second one declares a <code>Mat</code> constructor with an \"unnamed\" field of type <code>[[a]]</code>, which the first one <em>names</em> the field <code>mrows</code>. In particular, this auto-defines a function</p>\n\n<pre><code>mrows :: Mat a -&gt; [[a]]\n</code></pre>\n\n<p>that \"unwraps\" the <code>Mat</code> constructor. You can also use the name <code>mrows</code> in patterns, but that's generally more useful for constructors with <em>dozens</em> of fields, not just one.</p>\n\n<p>A named field can always be referred to using unnamed syntax as well, so the named version does everything the unnamed version does plus a bit more.</p>\n"}], "owner": {"reputation": 431, "user_id": 2423002, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/857ed0fe0d30694c2c87e42a917e90bb?s=128&d=identicon&r=PG", "display_name": "John Stef", "link": "https://stackoverflow.com/users/2423002/john-stef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "accepted_answer_id": 42544190, "answer_count": 2, "score": 3, "last_activity_date": 1488482400, "creation_date": 1488410854, "last_edit_date": 1488412288, "question_id": 42544101, "link": "https://stackoverflow.com/questions/42544101/show-matrix-function-in-haskell", "title": "Show matrix function in haskell", "body": "<p>I've just started learning functional programming with Haskell and I need your help in the case below.</p>\n\n<p>The idea is to display a Matrix using the show function in the following way:</p>\n\n<pre><code>&gt; Mat [[1,2,3],[4,5,6]]\n  1 2 3\n  4 5 6\n</code></pre>\n\n<p>I already have a suggested solution that achieves the above outcome, but I do not particularly understand it.</p>\n\n<pre><code>data Mat a = Mat {mrows :: [[a]]}\ninstance (Show a) =&gt; Show (Mat a) where\n     show  =  unlines . map (unwords . map show) . mrows\n</code></pre>\n\n<p>I have searched on the internet regarding this part <code>Mat {mrows :: [[a]]}</code> but could not find any helpful answer. Why we can't just declare it as <code>Mat [[a]]</code>?</p>\n\n<p>Also, how does exactly the last line achieves the above outcome. My apologies if the answer is too obvious, but I literally just started learning Haskell. </p>\n"}, {"tags": ["haskell", "monad-transformers", "haskell-lens", "state-monad", "higher-kinded-types"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1488408418, "post_id": 42543095, "comment_id": 72222956, "body": "Does your <code>zoomer</code> compile? <code>nextState</code> is an <code>s</code> but <code>put</code> should take an <code>AppState</code>, I think."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1488408892, "post_id": 42543095, "comment_id": 72223156, "body": "It seems that you have over-engineered a solution to a fairly straightforward problem. What is wrong with having a single <code>StateT</code> containing both the global state and the additional state, e.g. <code>newtype App  s a = App (State (AppState, s) a)</code>? As for your attempts; in the first, having a <code>runStateT</code> in the body of an action is almost always the wrong thing to do, for precisely the reason you stated. In the second, the error you posted does not correspond to any code you posted - the 2nd <code>App</code> is perfectly valid (<code>m :: * -&gt; *</code> is inferred unless you have something stating otherwise)."}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1488410386, "post_id": 42543095, "comment_id": 72223751, "body": "@user2407038 I&#39;m afraid that doesn&#39;t work since the <code>s</code> of the <code>StateT</code> is actually INSIDE <code>AppState</code>, hence the zooming."}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1488410531, "post_id": 42543095, "comment_id": 72223800, "body": "@BenjaminHodgson I believe nextState is an <code>AppState</code> actually, since <code>zoom lns act</code> zooms the <code>act</code> to run over an <code>App</code>, which when run produces an <code>AppState</code>, which put accepts. Does that make sense? The nesting is confusing :P, hence the question in the first place."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1488411090, "post_id": 42543095, "comment_id": 72224000, "body": "@ChrisPenner I&#39;m not sure I understand what you mean by &quot;the s of the <code>StateT</code> is inside <code>AppState</code>&quot;. <code>StateT s0 (StateT s1)</code> and <code>StateT (s0, s1)</code> are isomorphic types; this is simply by currying: <code>s0 -&gt; s1 -&gt; (s1, (s0, a))</code> vs. <code>(s0, s1) -&gt; (s1, (s0, a))</code>."}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1488417600, "post_id": 42543095, "comment_id": 72225968, "body": "Yes, those are isomorphic, but type A that we&#39;re editing is literally inside type AppState: <code>newtype AppState = AppState A</code> In reality it is nested several levels deep, so if we did <code>(AppState, A)</code> then there&#39;s two copies of the object, the A, and the A inside AppState, which isn&#39;t quite right."}], "answers": [{"comments": [{"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1488417476, "post_id": 42544304, "comment_id": 72225933, "body": "I&#39;ll try this out next chance I get; what would be the implementation of      <code>liftApp :: MonadState s m =&gt; App () -&gt; m ()</code> in this case?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1488422125, "post_id": 42544304, "comment_id": 72227184, "body": "@ChrisPenner That type is too general. <code>App</code> has <code>IO</code> as the base monad, and so if <code>m</code> is <code>State s</code> (that is, <code>StateT Identity s</code>) then <code>liftApp</code> is impossible. Cases in which it is feasible include <code>m ~ StateT App s</code> (using <code>lift</code>, as you already know) and <code>m ~ StateT s IO</code> with you having a lens from <code>s</code> to <code>AppState</code> (<code>runApp</code> then <code>zoom</code>). In any case, <code>MonadState</code> essentially only gives you <code>get</code> and <code>put</code>, which are not enough for meaningfully implementing your operation."}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1488516570, "post_id": 42544304, "comment_id": 72275321, "body": "Hrmm, okay. <code>liftAction</code> is what I was hoping to get (through implementing zoomer correctly), I should have phrased my question more appropriately (I&#39;m relatively familiar with general zooming at this point), the trouble comes with &#39;unzooming&#39; so to speak. I&#39;ve got a few ideas I&#39;ll try out though."}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1488580603, "post_id": 42544304, "comment_id": 72311515, "body": "This got really tricky in mtl, so I&#39;ve decided to try rebuilding it in a Free Monad, which I&#39;ve typically had better luck with, I really need the behaviour of <code>liftAction</code>. Thanks so much for your help! Here&#39;s the new question: <a href=\"http://stackoverflow.com/questions/42589612/zoom-instance-over-free-monad\" title=\"zoom instance over free monad\">stackoverflow.com/questions/42589612/&hellip;</a>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1488589707, "post_id": 42544304, "comment_id": 72313962, "body": "@ChrisPenner After looking at this for a second time, I think I have found a better way to state your troubles here. You say you want &quot;monads over nested states to be able to run actions over the global state as well&quot;. Once you have that, though, can we really think of the nested monads as state monads <i>for their specific substate</i>? My gut feeling is that we can&#39;t, though I don&#39;t want to settle for a more definite answer without a little more thought."}, {"owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "edited": false, "score": 0, "creation_date": 1488597252, "post_id": 42544304, "comment_id": 72315212, "body": "We can think of them as monads with a monadstate over their chosen state, but yes it needs some extra engineering to be able to &#39;unzoom&#39;. I did have a working implementation over mtl by using phantom types in a monad I defined, but it was quite complex. I&#39;d still really like to get something working yet, if even it&#39;s just the free monad version."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 1, "last_activity_date": 1488411927, "last_edit_date": 1495542725, "creation_date": 1488411927, "answer_id": 42544304, "question_id": 42543095, "link": "https://stackoverflow.com/questions/42543095/lift-through-nested-state-transformers-mtl/42544304#42544304", "title": "Lift through nested state transformers (mtl)", "body": "<p>Along the lines of <a href=\"https://stackoverflow.com/questions/42543095/lift-through-nested-state-transformers-mtl#comment72223156_42543095\">user2407038's comment</a>, this type...</p>\n\n<pre><code>type ActionA a = StateT A App a\n</code></pre>\n\n<p>... looks a bit strange to me. If you want to use <code>zoom stateA</code>, then the other state is a part of <code>AppState</code>. Assuming you can modify the <code>A</code> substate without touching the rest of the <code>AppState</code> (otherwise you wouldn't want <code>zoom</code> in the first place), you should be able to simply define, for instance...</p>\n\n<pre><code>doStuffA :: StateT A IO ()\n</code></pre>\n\n<p>... and then bring that to <code>App</code> with:</p>\n\n<pre><code>zoomer :: Lens' AppState s -&gt; StateT s IO r -&gt; App r\nzoomer l a = App (zoom l a)\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; :t zoomer stateA doStuffA \nzoomer stateA doStuffA :: App ()\n</code></pre>\n\n<p>If you'd rather have a pure <code>doStuffA</code>...</p>\n\n<pre><code>pureDoStuffA :: State A ()\n</code></pre>\n\n<p>... you just have to slip in a <code>return</code> into <code>IO</code> in the appopriate place...</p>\n\n<pre><code>GHCi&gt; :t zoomer stateA (StateT $ return . runState pureDoStuffA)\nzoomer stateA (StateT $ return . runState pureDoStuffA) :: App ()\n</code></pre>\n\n<p>... or, using <a href=\"https://hackage.haskell.org/package/mmorph-1.0.9/docs/Control-Monad-Morph.html#v:generalize\" rel=\"nofollow noreferrer\"><em>mmorph</em></a> for a cuter spelling:</p>\n\n<pre><code>GHCi&gt; :t zoomer stateA (hoist generalize pureDoStuffA)\nzoomer stateA (hoist generalize pureDoStuffA) :: App ()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 0, "last_activity_date": 1489374898, "last_edit_date": 1495541373, "creation_date": 1489374898, "answer_id": 42756096, "question_id": 42543095, "link": "https://stackoverflow.com/questions/42543095/lift-through-nested-state-transformers-mtl/42756096#42756096", "title": "Lift through nested state transformers (mtl)", "body": "<p><em>Preliminary note: I took the highly unusual step of posting a second answer because I feel my previous one stands on its own well enough, while this one looks at the issue from a quite different angle.</em></p>\n\n<p>This answer is now a bit moot, given that <a href=\"https://stackoverflow.com/a/42725567/2751851\">you have found a solution already</a>, but in any case I feel I should expand on my latest comment here. In it, I had asked:</p>\n\n<blockquote>\n  <p>You say you want \"monads over nested states to be able to run actions over the global state as well\". Once you have that, though, can we really think of the nested monads as state monads <em>for their specific substate?</em></p>\n</blockquote>\n\n<p>I would say that we can't. With the functionality you suggest implemented, perhaps you would formally have some sort of distinct <code>StateT</code> layer for each substate; however, if you can run global state actions in these layers then the lines between them and the overall state are blurred. As far as isolation goes, you might as well work with a monolithic <code>AppState</code>.</p>\n\n<p>I can, however, think of another plausible intepretation of your requirements, which may or may not be relevant for what you are trying to do. Perhaps you want to retain distinct substates for the components of your framework, but have a core state which is shared by them all. Schematically, that might look like this:</p>\n\n<pre><code>data AppState = AppState\n  { _stateA :: A\n  , _stateB :: B\n  }\nmakeLenses ''AppState\n\ndata Shared = Shared -- etc.\n</code></pre>\n\n<p>One simple way of wiring that is would be using two <code>StateT</code> layers:</p>\n\n<pre><code>newtype App a = App\n  { runApp :: StateT AppState (StateT Shared IO) a\n  } deriving (Functor, Applicative, Monad, MonadState AppState, MonadIO)\n</code></pre>\n\n<p>Now you can <code>lift</code> actions on the shared state to e.g. <code>StateT A (StateT Shared IO)</code>, and then bring that to <code>App</code> with <code>App . zoom stateA</code>. Working with nested <code>StateT</code> layers, however, can be a little awkward. An alternative is bringing <code>Shared</code> into <code>AppState</code>...</p>\n\n<pre><code>data AppState = AppState\n  { _stateA :: A\n  , _stateB :: B\n  , _shared :: Shared\n  }\nmakeLenses ''AppState\n\nnewtype App a = App\n  { runApp :: StateT AppState IO a\n  } deriving (Functor, Applicative, Monad, MonadState AppState, MonadIO)\n</code></pre>\n\n<p>... and then writing lenses that give access to both the substate and the shared state:</p>\n\n<pre><code>data Substate a = Substate\n    { _getSubstate :: a\n    , _sharedInSub :: Shared\n    }\nmakeLenses ''Substate\n\n-- There are, of course, lots of other ways of spelling these definitions.\nsubA :: Lens' AppState (Substate A)\nsubA = lens\n    (Substate &lt;$&gt; _stateA &lt;*&gt; _shared) \n    (\\app (Substate a s) -&gt; app { _stateA = a, _shared = s })\n\nsubB :: Lens' AppState (Substate B)\nsubB = lens\n    (Substate &lt;$&gt; _stateB &lt;*&gt; _shared) \n    (\\app (Substate b s) -&gt; app { _stateB = b, _shared = s })\n</code></pre>\n\n<p>Now you just have to <code>zoom</code> with e.g. <code>subA</code> instead of <code>stateA</code>. There is a little extra boilerplate in having to define these lenses, but that can be alleviated if need be.</p>\n\n<p>Incidentally, there is no combinator in <em>lens</em> that captures this pattern -- for instance, something with type <code>Lens s t a b -&gt; Lens s t c d -&gt; Lens s t (a, c) (b, d)</code> -- because in general it doesn't produce legal lenses -- <a href=\"https://stackoverflow.com/q/26722458/2751851\">the lenses have to be disjoint</a>, as ours are, for it to work properly. That said, with a little more shuffling we can express what we are doing in terms of <a href=\"http://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Lens.html#v:alongside\" rel=\"nofollow noreferrer\"><code>alongside</code></a>, though I'm not sure if that is in any way advantageous:</p>\n\n<pre><code>data ComponentState = ComponentState\n  { _stateA :: A\n  , _stateB :: B\n  }\nmakeLenses ''AppState\n\nnewtype App a = App\n  { runApp :: StateT (ComponentState, Shared) IO a\n  } deriving (Functor, Applicative, Monad, MonadState AppState, MonadIO)\n\nsubA :: Lens' (ComponentState, Shared) (A, Shared)\nsubA = alongside stateA simple\n\nsubB :: Lens' (ComponentState, Shared) (B, Shared)\nsubB = alongside stateB simple\n</code></pre>\n\n<p>(If you don't like working with the naked pairs, you might define <code>AppState</code> and <code>Substate a</code> isomorphic to them and use the corresponding <code>Iso</code>s to submit them to <code>alongside</code>.) </p>\n"}], "owner": {"reputation": 1835, "user_id": 3907685, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4a9d7cdfc525e689e6baefb7d2158fb0?s=128&d=identicon&r=PG", "display_name": "Chris Penner", "link": "https://stackoverflow.com/users/3907685/chris-penner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 480, "favorite_count": 0, "accepted_answer_id": 42544304, "answer_count": 2, "score": 2, "last_activity_date": 1489374898, "creation_date": 1488406315, "last_edit_date": 1488408196, "question_id": 42543095, "link": "https://stackoverflow.com/questions/42543095/lift-through-nested-state-transformers-mtl", "title": "Lift through nested state transformers (mtl)", "body": "<p>So I'm working on an extensible application framework, and a key part of the framework is to be able to run state monads over many different state types; I've got it set up, and can run the nested state monads; however a key feature I need is for monads over nested states to be able to run actions over the global state as well; I managed to rig this up using some complicated Free Monads in an earlier project, but now I'm using mtl and I'm a bit stuck.</p>\n\n<p>Here's some context:</p>\n\n<pre><code>newtype App a = App\n  { runApp :: StateT AppState IO a\n  } deriving (Functor, Applicative, Monad, MonadState AppState, MonadIO)\n\ndata AppState = AppState\n  { _stateA :: A\n  , _stateB :: B\n  }\nmakeLenses ''AppState\n</code></pre>\n\n<p>I'm trying to define something like:</p>\n\n<pre><code>liftApp :: MonadTrans m =&gt; App a -&gt; m App a\nliftApp = lift\n</code></pre>\n\n<p>This works fine of course because of the properties of MonadTrans, but the trick now is when I have an action like this:</p>\n\n<pre><code>appAction :: App ()\nappAction = ...\n\ntype ActionA a = StateT A App a\ndoStuffA :: ActionA ()\ndoStuffA = do\n  thing1\n  thing2\n  liftApp appAction\n  ...\n</code></pre>\n\n<p>This compiles within my app; but the trick comes when run this in an App itself:</p>\n\n<pre><code>myApp :: App ()\nmyApp = do\n  ...\n  zoomer stateA doStuffA\n</code></pre>\n\n<p>I'm having trouble writing <code>zoomer</code>; Here's an attempt:</p>\n\n<pre><code>zoomer :: Lens' AppState s -&gt; StateT s App r -&gt; App r\nzoomer lns act = do\n  s &lt;- get\n  (r, nextState) &lt;- runStateT (zoom lns act) s\n  put nextState\n  return r\n</code></pre>\n\n<p>The problem is that <code>runStateT (zoom lns act) s</code> is itself an App, but it also yields an AppState which I then need to <code>put</code> to get the changes. This means that any changes caused in the Monadic part of <code>&lt;- runStateT</code> are overwritten by <code>put nextState</code>.</p>\n\n<p>I'm pretty sure I'm not supposed to be nesting two sets of MonadState AppState like this, but I'm not sure how to get it working since mtl doesn't allow me to nest multiple MonadState's due to functional dependencies.</p>\n\n<p>I also started trying something like inverting it and having App be the outer transformer:</p>\n\n<pre><code>newtype App m a = App\n  { runApp :: StateT AppState m a\n  } deriving (Functor, Applicative, Monad, MonadState AppState, MonadIO, MonadTrans)\n</code></pre>\n\n<p>with the hopes of using the <code>MonadTrans</code> to allow:</p>\n\n<pre><code>liftApp = lift\n</code></pre>\n\n<p>But GHC doesn't allow this:</p>\n\n<pre><code>\u2022 Expected kind \u2018* -&gt; *\u2019, but \u2018m\u2019 has kind \u2018*\u2019\n\u2022 In the second argument of \u2018StateT\u2019, namely \u2018m\u2019\n  In the type \u2018StateT AppState m a\u2019\n  In the definition of data constructor \u2018App\u2019\n</code></pre>\n\n<p>And I'm not sure that would work anyways...</p>\n\n<p>So that's the issue, I want to be able to nest <code>App</code> monads inside arbitrary levels of <code>StateT</code>'s somehow being run inside an <code>App</code>.</p>\n\n<p>Any ideas? Thanks for your time!!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488377770, "post_id": 42533673, "comment_id": 72203717, "body": "These instances are different: <code>HasFormat Transaction</code> vs <code>HasFormat FormatModel</code>. So, there&#39;s more than an eta between them, it seems?"}, {"owner": {"reputation": 101, "user_id": 4211172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5n7vP.jpg?s=128&g=1", "display_name": "Rik", "link": "https://stackoverflow.com/users/4211172/rik"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488378768, "post_id": 42533673, "comment_id": 72204398, "body": "@chi I do not see why they are more different than eta reduce."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488378960, "post_id": 42533673, "comment_id": 72204537, "body": "<code>instance HasFormat Transaction where formatId_ = formatId</code> differs from <code>instance HasFormat Transaction where formatId_ x = formatId x</code> only by an eta, the instances above differ by an eta AND the involved type."}, {"owner": {"reputation": 101, "user_id": 4211172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5n7vP.jpg?s=128&g=1", "display_name": "Rik", "link": "https://stackoverflow.com/users/4211172/rik"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488379507, "post_id": 42533673, "comment_id": 72204935, "body": "@chi point is that they have both <code>formatId</code> field"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488385918, "post_id": 42536294, "comment_id": 72209854, "body": "It feels a bit odd, though, when the eta-contracted version is allowed. Doesn&#39;t that also need some type information to disambiguate?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1488388719, "post_id": 42536294, "comment_id": 72211735, "body": "@chi From the docs: &quot;we do not infer the type of the argument to determine the datatype&quot;. The first version does not work because it would have to look at the type of the argument. The second version works because there is no argument - the correct <code>formatId</code> is chosen based on the type of <code>formatId_</code>. It is as if one had written <code>formatId :: X -&gt; Y</code> as opposed to <code>formatId (x :: X)</code>."}, {"owner": {"reputation": 101, "user_id": 4211172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5n7vP.jpg?s=128&g=1", "display_name": "Rik", "link": "https://stackoverflow.com/users/4211172/rik"}, "edited": false, "score": 0, "creation_date": 1488395824, "post_id": 42536294, "comment_id": 72216001, "body": "I&#39;m still confused because in the instance declaration I have defined the type for which I do the implementation."}, {"owner": {"reputation": 101, "user_id": 4211172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5n7vP.jpg?s=128&g=1", "display_name": "Rik", "link": "https://stackoverflow.com/users/4211172/rik"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1488398001, "post_id": 42536294, "comment_id": 72217311, "body": "@user2407038 Your explanation is clear. But in case of the not working version, the correct implemenation could also be chosen from type information because of the type of instance declaration."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 101, "user_id": 4211172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5n7vP.jpg?s=128&g=1", "display_name": "Rik", "link": "https://stackoverflow.com/users/4211172/rik"}, "edited": false, "score": 1, "creation_date": 1488403731, "post_id": 42536294, "comment_id": 72220593, "body": "@Rik This is simply not how type checking (in GHC, which is based on the HM type system) works; not in the context of disambiguating record fields, not ever. When <code>f x</code> is typechecked, the type of <code>x</code> is <i>never</i> examined to determine the type of <code>f</code>. The class instances have absolutely nothing to with it - within the body of the instance, the function has a monomorphic type anyways. To make things work as you expect, the typechecking algorithm would have to be modified in a very fundamental way. This would be a huge hack, as it would serve no other purpose other than <code>DuplicateRecordFields</code>."}, {"owner": {"reputation": 101, "user_id": 4211172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5n7vP.jpg?s=128&g=1", "display_name": "Rik", "link": "https://stackoverflow.com/users/4211172/rik"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1488444543, "post_id": 42536294, "comment_id": 72236417, "body": "@user2407038 Thanks for explaining!"}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 6, "last_activity_date": 1488383703, "creation_date": 1488383703, "answer_id": 42536294, "question_id": 42533673, "link": "https://stackoverflow.com/questions/42533673/eta-reduce-and-duplicaterecordfields-language-extension/42536294#42536294", "title": "Eta reduce and DuplicateRecordFields language extension", "body": "<p>Disambiguation of duplicate record fields is necessarily a best-effort kind of thing because it needs to occur <em>before</em> type checking (you can't generally type check an expression before you know what identifiers the names in it refer to; which is what the disambiguation is doing).</p>\n\n<p>Your non-working example is equivalent to this non-working example from the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#selector-functions\" rel=\"noreferrer\" title=\"documentation\">documentation</a>:</p>\n\n<pre><code>data S = MkS { x :: Int }\ndata T = MkT { x :: Bool }\nbad :: S -&gt; Int\nbad s = x s\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4211172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5n7vP.jpg?s=128&g=1", "display_name": "Rik", "link": "https://stackoverflow.com/users/4211172/rik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1488383703, "creation_date": 1488376678, "last_edit_date": 1488378889, "question_id": 42533673, "link": "https://stackoverflow.com/questions/42533673/eta-reduce-and-duplicaterecordfields-language-extension", "title": "Eta reduce and DuplicateRecordFields language extension", "body": "<p>Issue is about having 2 data types, <code>Transaction</code> and <code>FormatModel</code>, both having <code>formatId</code> field. To prevent adding type signatures to get <code>formatId</code> from a <code>transaction</code> or <code>formatModel</code>, I have created type class <code>HasFormat</code>:</p>\n\n<pre><code>class HasFormat a where\n  formatId_ :: a -&gt; FormatId\n\ninstance HasFormat Transaction where\n   formatId_  x = formatId x -- gives error because ambiguous occurrence \u2018formatId\u2019\n\ninstance HasFormat FormatModel where\n  formatId_  = formatId -- this works\n</code></pre>\n\n<p>Can some explain why the instance which has eta reduced implementation is working and the other one not?</p>\n"}, {"tags": ["haskell", "gloss"], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1488388214, "post_id": 42535565, "comment_id": 72211447, "body": "<a href=\"https://hackage.haskell.org/package/gloss-rendering-1.10.3.5/docs/src/Graphics-Gloss-Internals-Data-Color.html#Color\" rel=\"nofollow noreferrer\">There is such a constructor</a>, it is defined in a dependency of gloss, but <code>Color</code> is abstract and the constructor is not exported. Effectively, &#39;there is no such constructor&#39; is a true statement, but perhaps this pedantic distinction would be useful to the understanding for someone."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1488392650, "last_edit_date": 1488392650, "creation_date": 1488381688, "answer_id": 42535565, "question_id": 42533012, "link": "https://stackoverflow.com/questions/42533012/how-do-i-generate-test-cases-for-pictures-using-the-rgba-constructor-in-the-glos/42535565#42535565", "title": "How do I generate test cases for pictures using the RGBA constructor in the Gloss library?", "body": "<p>I don't know where you are getting the <code>RGBA</code> constructor, but looking at the haddocks there is no such constructor for a <code>Color</code>.  You probably want the <a href=\"https://hackage.haskell.org/package/gloss-1.10.2.5/docs/Graphics-Gloss-Data-Color.html#t:Color\" rel=\"nofollow noreferrer\"><code>makeColor</code></a> function:</p>\n\n<pre><code>makeColor :: Float -&gt; Float -&gt; Float -&gt; Float -&gt; Color\n</code></pre>\n\n<p>EDIT: And yes, user24...38 is right there exists an <code>RGBA</code> but in the version of Gloss I'm looking at it is part of an <code>Internal</code> module and not exported elsewhere.  As a general rule, external users should not leverage <code>Internal</code> modules since the API might change or the interface can be somehow unsafe (ex: not maintaining invariants).</p>\n"}], "owner": {"reputation": 293, "user_id": 5846939, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/3f615365cdfd3144347c977c2a902b47?s=128&d=identicon&r=PG&f=1", "display_name": "user5846939", "link": "https://stackoverflow.com/users/5846939/user5846939"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488392650, "creation_date": 1488374746, "question_id": 42533012, "link": "https://stackoverflow.com/questions/42533012/how-do-i-generate-test-cases-for-pictures-using-the-rgba-constructor-in-the-glos", "title": "How do I generate test cases for pictures using the RGBA constructor in the Gloss library?", "body": "<p>I am trying to write some test cases using HUnit in Haskell for a function using the Gloss Graphics library.</p>\n\n<p>The function:</p>\n\n<pre><code>makePicture :: Color -&gt; Picture\nmakePicture c = Color c $ Circle 80\n</code></pre>\n\n<p>If I display a call to this function with argument \"black\" in a console you see something like:</p>\n\n<pre><code>Color (RGBA 0.0 0.0 0.0 1.0) (Circle 80.0)\n</code></pre>\n\n<p>Which has the type of a Picture. My question is how do I properly write a test case for something like this?</p>\n\n<p>The problem occurs if I try to write a test like:</p>\n\n<pre><code>test = TestCase $ assertEqual \"makePicture\" (Color (RGBA 0.0 0.0 0.0 1.0) (Circle 80.0)) (makePicture black)\n</code></pre>\n\n<p>It can't compile, because it says the following:</p>\n\n<pre><code>error: Data constructor not in scope: RGBA\n</code></pre>\n\n<p>Anyone have any ideas how I can write a test case for my function? </p>\n"}, {"tags": ["haskell", "closures", "state-monad"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 3, "creation_date": 1488371475, "post_id": 42531472, "comment_id": 72199227, "body": "Use the state monad."}, {"owner": {"reputation": 12763, "user_id": 255363, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7b75e9c5528b79acc6a81c18265329f9?s=128&d=identicon&r=PG", "display_name": "kirilloid", "link": "https://stackoverflow.com/users/255363/kirilloid"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1488374341, "post_id": 42531472, "comment_id": 72201305, "body": "@BenjaminHodgson that&#39;s pretty obvious, but I don&#39;t understand how it answers my question regarding global vs local state. Am I correct with proposed interface at the very end of my question? How to combine specific compilers if they have different types of states?"}], "answers": [{"comments": [{"owner": {"reputation": 12763, "user_id": 255363, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7b75e9c5528b79acc6a81c18265329f9?s=128&d=identicon&r=PG", "display_name": "kirilloid", "link": "https://stackoverflow.com/users/255363/kirilloid"}, "edited": false, "score": 0, "creation_date": 1488811478, "post_id": 42536205, "comment_id": 72384739, "body": "Your answer is pretty deep, but I&#39;d like to clarify how it answers my specific question. Do I understand you correctly that you suggest having &quot;global&quot; state for the compiler and make local states for specialized compiler functions via lenses focusing on this global state?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 12763, "user_id": 255363, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7b75e9c5528b79acc6a81c18265329f9?s=128&d=identicon&r=PG", "display_name": "kirilloid", "link": "https://stackoverflow.com/users/255363/kirilloid"}, "edited": false, "score": 0, "creation_date": 1488816751, "post_id": 42536205, "comment_id": 72388593, "body": "Yes, that&#39;s the idea. The key point is that a <code>State Little</code> computation has no access to the rest of the <code>Big</code> state, even though <code>zoom</code> allows you to use it as a <code>State Big</code> computation."}, {"owner": {"reputation": 12763, "user_id": 255363, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7b75e9c5528b79acc6a81c18265329f9?s=128&d=identicon&r=PG", "display_name": "kirilloid", "link": "https://stackoverflow.com/users/255363/kirilloid"}, "edited": false, "score": 0, "creation_date": 1488818019, "post_id": 42536205, "comment_id": 72389484, "body": "Here we achieve isolation, but if I&#39;d like to add new VM command and new compiler I&#39;d need to re-compile Big source. Is it possible and not too crazy to do hold scope together with a function like that <code>(State Scope, Scope -&gt; In -&gt; (Scope, Out))</code>?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 12763, "user_id": 255363, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7b75e9c5528b79acc6a81c18265329f9?s=128&d=identicon&r=PG", "display_name": "kirilloid", "link": "https://stackoverflow.com/users/255363/kirilloid"}, "edited": false, "score": 0, "creation_date": 1488820752, "post_id": 42536205, "comment_id": 72391248, "body": "@kirilloid [1/2] (1) Do note that e.g. <code>State Scope Int</code> doesn&#39;t actually store a <code>Scope</code>: it is a computation of an <code>Int</code> that uses (and transforms) a <code>Scope</code> state that will be supplied at the point of use. To put it in a different way, <code>Scope -&gt; In -&gt; (Scope, Out)</code> is equivalent to <code>In -&gt; State Scope Out</code>. (2) &quot;if I&#39;d like to add new VM command and new compiler I&#39;d need to re-compile Big source&quot; -- not necessarily. If your new command can be defined in terms of the substates already defined in/for <code>Big</code> you don&#39;t need to change <code>Big</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 12763, "user_id": 255363, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7b75e9c5528b79acc6a81c18265329f9?s=128&d=identicon&r=PG", "display_name": "kirilloid", "link": "https://stackoverflow.com/users/255363/kirilloid"}, "edited": false, "score": 0, "creation_date": 1488820795, "post_id": 42536205, "comment_id": 72391272, "body": "@kirilloid [2/2] (3) You might find <a href=\"http://stackoverflow.com/q/40698396/2751851\">this question</a> to be an interesting read, though I strongly suspect you don&#39;t actually need the trickery discussed there."}, {"owner": {"reputation": 12763, "user_id": 255363, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7b75e9c5528b79acc6a81c18265329f9?s=128&d=identicon&r=PG", "display_name": "kirilloid", "link": "https://stackoverflow.com/users/255363/kirilloid"}, "edited": false, "score": 0, "creation_date": 1488835836, "post_id": 42536205, "comment_id": 72399419, "body": "I&#39;ve yet to comprehend &quot;state doesn&#39;t actually store for <i>smth</i>, but is a computation&quot;. As for re-compilation, yes, I&#39;d need something like &quot;data &#224; la carte&quot; for <code>VM_COMMAND</code>s to make code extensible w/o recompilation anyway."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 12763, "user_id": 255363, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7b75e9c5528b79acc6a81c18265329f9?s=128&d=identicon&r=PG", "display_name": "kirilloid", "link": "https://stackoverflow.com/users/255363/kirilloid"}, "edited": false, "score": 0, "creation_date": 1488836917, "post_id": 42536205, "comment_id": 72400015, "body": "@kirilloid <code>newtype State s a = State { runState :: s -&gt; (a, s) }</code> is a simple way of defining <code>State</code> -- it is a <i>function</i> that takes a state and returns a result and an updated state. (This isn&#39;t literally what you&#39;ll find if you go to the sources of <i>transformers</i>, but the definition there -- <code>type State s = StateT s Identity</code> -- is equivalent to this one.)"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 8, "last_activity_date": 1488816814, "last_edit_date": 1488816814, "creation_date": 1488383393, "answer_id": 42536205, "question_id": 42531472, "link": "https://stackoverflow.com/questions/42531472/whats-the-proper-way-to-emulate-stateful-closure-in-haskell/42536205#42536205", "title": "What&#39;s the proper way to emulate stateful closure in Haskell", "body": "<p>If you have...</p>\n\n<pre><code>data Big = Big { little :: Little, stuff :: Whatever }\n</code></pre>\n\n<p>... you can define your...</p>\n\n<pre><code>littleProcessor :: State Little [String]\n</code></pre>\n\n<p>... and then use a function like this one...</p>\n\n<pre><code>innerState :: Monad m \n    =&gt; (s -&gt; i) -&gt; (i -&gt; s -&gt; s) -&gt; StateT i m a -&gt; StateT s m a\ninnerState getI setI (StateT m) = StateT $ \\s -&gt; do\n    (a, i) &lt;- m (getI s)\n    return (a, setI i s)\n</code></pre>\n\n<p>... to lift it to the bigger state:</p>\n\n<pre><code>bigProcessor :: State Big [String]\nbigProcessor = innerState little (\\l b -&gt; b {little = l}) littleProcessor\n</code></pre>\n\n<p>(Add auxiliary definitions to taste.)</p>\n\n<p>The use of the getter/setter pair in <code>innerState</code> makes it look like it should be possible to phrase it in terms of lenses. Indeed, <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Zoom.html#v:zoom\" rel=\"nofollow noreferrer\"><code>zoom</code></a> from <em>lens</em> is basically <code>innerState</code> with minimised boilerplate:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport Control.Lens\n\ndata Big = Big { _little :: Little, _stuff :: Whatever }\nmakeLenses ''Big -- little is now a lens.\n</code></pre>\n\n\n\n<pre><code>bigProcessor :: State Big [String]\nbigProcessor = zoom little littleProcessor\n</code></pre>\n"}], "owner": {"reputation": 12763, "user_id": 255363, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/7b75e9c5528b79acc6a81c18265329f9?s=128&d=identicon&r=PG", "display_name": "kirilloid", "link": "https://stackoverflow.com/users/255363/kirilloid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1488816814, "creation_date": 1488370554, "question_id": 42531472, "link": "https://stackoverflow.com/questions/42531472/whats-the-proper-way-to-emulate-stateful-closure-in-haskell", "title": "What&#39;s the proper way to emulate stateful closure in Haskell", "body": "<p>Context: I need to write a mostly stateless compiler which transforms VM bytecode into machine codes. Most VM commands can be translated statelessly with pure function like the following: </p>\n\n<pre><code>compilePop = [\"mov ax, @sp\", \"dec ax\", \"mov @sp, ax\"]\n\ncompile :: VM_COMMAND -&gt; [String]\ncompile STACK_POP = compilePop \n\n-- compile whole program\ncompileAll :: [VM_COMMAND] -&gt; [String]\ncompileAll = flatMap compile\n</code></pre>\n\n<p>But some commands need inserting labels which should be different for every call.</p>\n\n<p>I understand how to do this with a state object \"global\" for entire compiler:</p>\n\n<pre><code>compileGt n = [label ++ \":\", \"cmp ax,bx\", \"jgt \" ++ label]\n                where label = \"cmp\" ++ show n\n\ncompile :: Int -&gt; COMPILER_STATE -&gt; VM_COMMAND -&gt; (COMPILER_STATE, [String])\n-- here state currently contains only single integer, but it will grow larger\ncompile lcnt STACK_POP = (lcnt, compilePop)\ncompile lcnt CMP_GT    = (lcnt + 1, compileGt lcnt)\n\ncompileAll commands = snd $ foldr compile commands 0\n                      -- incorrect, but you get the idea\n</code></pre>\n\n<p>But I think this is bad because every specialized compile function needs only little piece of a state or even none at all. For example in not such a purely functional JavaScript I'd implement specialized compile functions with local state in a closure.</p>\n\n<pre><code>// compile/gt.js\nvar i = 0;\nexport default const compileGt = () =&gt; {\n  const label = \"cmp\" + i++;\n  return [label ++ \":\", \"cmp ax,bx\", \"jgt \" ++ label];\n};\n// index.js\nimport compileGt from './compile/gt';\n\nfunction compile (cmd) {\n  switch (cmd) {\n  case CMP_GT: return compileGt();\n  // ...\n  }\n}\n\nexport default const compileAll = (cmds) =&gt; cmds.flatMap(compile);\n</code></pre>\n\n<p>So the question is how can I do the same in Haskell or an explanation why it's really bad idea. Should it be something like that?</p>\n\n<pre><code>type compileFn = State -&gt; VM_COMMAND -&gt; [String]\n(compileFn, State) -&gt; VM_COMMAND -&gt; ([String], (compileFn, State))\n</code></pre>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1488370301, "post_id": 42531032, "comment_id": 72198433, "body": "So are you certain the <code>QuantHas</code> directory in the filesystem is named with the uppercase <code>H</code>?  If so, did you do something like start with lowercase and later rename it?  Wondering if it can be some caching thing."}, {"owner": {"reputation": 406, "user_id": 1738086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44ffd4d27d01bce9b3425f88d83975a3?s=128&d=identicon&r=PG", "display_name": "Simon Courtenage", "link": "https://stackoverflow.com/users/1738086/simon-courtenage"}, "reply_to_user": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1488371666, "post_id": 42531032, "comment_id": 72199369, "body": "Yes, it has always had an &#39;H&#39; in the directory name."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1488373223, "post_id": 42531032, "comment_id": 72200521, "body": "Tried <code>cabal configure</code> after changing?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1488387819, "post_id": 42531032, "comment_id": 72211172, "body": "Your errors clearly states the directory name - <code>src&#47;Quanthas&#47;Settings.hs:17:8: error:</code> and <code>src&#47;QuantHas&#47;Settings.hs:17:8: error:</code>. As far as your machine is concerned, your claim that the directory has always been named <code>QuantHas</code> is simply false. In these sorts of matters, I am inclined to believe the machine."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1488405532, "post_id": 42531032, "comment_id": 72221620, "body": "Is it possible that your filesystem is case-insensitive? In such a case, sometimes a file may be <i>accessed</i> at e.g. name <code>X&#47;Y&#47;Z</code> even though if you asked the filesystem what files were in <code>X</code> it would tell you about <code>y&#47;z</code>. I guess it&#39;s not too surprising to think this would confuse tools like cabal/GHC. If this is the problem, making a partition with a case-sensitive filesystem should fix things up."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1488427650, "post_id": 42531032, "comment_id": 72228773, "body": "Perhaps you have a typo in one of your import statements, and OS X&#39;s case insensitivity is just causing lots of confusion."}, {"owner": {"reputation": 406, "user_id": 1738086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44ffd4d27d01bce9b3425f88d83975a3?s=128&d=identicon&r=PG", "display_name": "Simon Courtenage", "link": "https://stackoverflow.com/users/1738086/simon-courtenage"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1488444795, "post_id": 42531032, "comment_id": 72236584, "body": "@MichaelSnoyman yes that was it! thank you.  I went through all the places where the module was imported and found one &#39;h&#39; instead of an &#39;H&#39; in an import statement.  The error message led me to believe it was just the module and its file that was the cause of the problem.  If you want to make this an answer, I can upvote it etc."}], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 3, "last_activity_date": 1488457256, "creation_date": 1488457256, "answer_id": 42555394, "question_id": 42531032, "link": "https://stackoverflow.com/questions/42531032/haskell-cabal-confused-about-file-and-module-name/42555394#42555394", "title": "Haskell cabal confused about file and module name", "body": "<p>The issue is that there is a typo in one of the import statements in a different module. Since you're on a case-insensitive filesystem (OS X), GHC is able to find the module contents, but upon checking the module header finds it mismatches with the import statement and errors out.</p>\n"}], "owner": {"reputation": 406, "user_id": 1738086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44ffd4d27d01bce9b3425f88d83975a3?s=128&d=identicon&r=PG", "display_name": "Simon Courtenage", "link": "https://stackoverflow.com/users/1738086/simon-courtenage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 42555394, "answer_count": 1, "score": 1, "last_activity_date": 1488457256, "creation_date": 1488369182, "question_id": 42531032, "link": "https://stackoverflow.com/questions/42531032/haskell-cabal-confused-about-file-and-module-name", "title": "Haskell cabal confused about file and module name", "body": "<p>In my haskell project, I have the following directory structure (some entries are missing but not relevant to this problem)</p>\n\n<pre><code>- quanthas\n   - quanthas.cabal\n   - src/\n      - QuantHas/\n         - Settings.hs\n</code></pre>\n\n<p>My Settings.hs file contains this module header</p>\n\n<pre><code>module QuantHas.Settings(module QuantHas.Settings) where\n</code></pre>\n\n<p>My cabal file looks like this</p>\n\n<pre><code>Name:               QuantHas\nVersion:            0.0\nDescription:\n    QuantHas project is an attempt to port QuantLib to Haskell keeping the functional flavor of Haskell.\nLicense:            BSD3\nLicense-file:       LICENSE\nBuild-Type:         Simple\nCabal-Version:      &gt;=1.10\n\nLibrary\n  Build-Depends:    base &gt;= 3 &amp;&amp; &lt; 5, array &gt;= 0.2\n  Exposed-modules:  QuantHas.Time.Frequency\n                QuantHas.Time.TimeUnit\n                QuantHas.Time.Period\n                QuantHas.Time.Date\n                QuantHas.Time.DayCounter\n                QuantHas.Time.BusinessDayConvention\n                QuantHas.Time.Calendar\n                QuantHas.Time.Calendars.UnitedKingdom\n                QuantHas.Time.Schedule\n                QuantHas.Settings\n                QuantHas.Require\n  default-language: Haskell2010                 \n  hs-source-dirs:   src\n  --  ghc-options:      -Wall\n\ntest-suite QuantHas-tests\n  type: exitcode-stdio-1.0\n  hs-source-dirs: testsuite\n  main-is: Tests.hs\n  default-language: Haskell2010  \n</code></pre>\n\n<p>When I execute</p>\n\n<pre><code>cabal install --enable-tests\n</code></pre>\n\n<p>I get this message</p>\n\n<pre><code>src/Quanthas/Settings.hs:17:8: error:\n   File name does not match module name:\n   Saw: \u2018QuantHas.Settings\u2019\n   Expected: \u2018Quanthas.Settings\u2019\n</code></pre>\n\n<p>This seems wrong.  However, what if we do what cabal expects.  So the Settings.hs module header now is</p>\n\n<pre><code>module Quanthas.Settings(module Quanthas.Settings) where\n</code></pre>\n\n<p>Cabal now says</p>\n\n<pre><code>src/QuantHas/Settings.hs:17:8: error:\n   File name does not match module name:\n   Saw: \u2018Quanthas.Settings\u2019\n   Expected: \u2018QuantHas.Settings\u2019\n</code></pre>\n\n<p>And it's at this ppint that I give up and turn to SO.  Can anyone help me understand what is going on?</p>\n\n<p>Versions info:\n   Platform: Macbook Pro running MacOS 10.12.3\n   Haskell: 8.0.1\n   Cabal: 1.24.0.0</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "type-constraints", "type-families"], "comments": [{"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "edited": false, "score": 0, "creation_date": 1488370648, "post_id": 42530308, "comment_id": 72198660, "body": "Maybe I&#39;m mistaken, but maybe the problem is that you choose the kind constraint for the return of your family. Constraints can only appear in the left hand side of <code>=&gt;</code>."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "edited": false, "score": 0, "creation_date": 1488370828, "post_id": 42530308, "comment_id": 72198781, "body": "What else could it be other than <code>Constraint</code> if all the type instances are Constraints? Like say <code>type instance SillyT Int a = Num a</code> to make a silly example"}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1488383899, "post_id": 42530308, "comment_id": 72208376, "body": "Sorry for misunderstanding your other question slightly. I think in this more general case the class-wrapping you&#39;re doing is adequate, and indeed I&#39;ve been using the same approach quite often to be able to trick GHC into accepting partially applied constraints. In some cases you may be able to do entirely without the type family, given you have the class. But not always."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1488389794, "post_id": 42530308, "comment_id": 72212378, "body": "It should be noted that this does not really allow you to &#39;partially apply&#39; your type family - if you had <code>instance SillyT Int a = Num a</code> then <code>SillyC Int</code> does not reduce to <code>Num</code>. This is the operative difference between families and injective type constructors (i.e. <code>data</code>, <code>newtype</code>, and <code>class</code>) - the former reduces immediately, but cannot be partially applied, while the latter only reduces when fully applied, but &#39;partial applications&#39; are valid, but only in the sense that a partial application is a syntactically valid type."}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1488442627, "post_id": 42530308, "comment_id": 72235261, "body": "@user2407038 Not quite sure why you&#39;re saying this isn&#39;t partial application. Partially applied functions also do (in general) not reduce unless you pass sufficiently many arguments."}], "answers": [{"comments": [{"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1488373902, "post_id": 42532652, "comment_id": 72201016, "body": "I think it does, but just to confirm, is the approach I&#39;m using sensible or is there a better way?"}, {"owner": {"reputation": 10726, "user_id": 889902, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ops76.png?s=128&g=1", "display_name": "Wojciech Danilo", "link": "https://stackoverflow.com/users/889902/wojciech-danilo"}, "reply_to_user": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "edited": false, "score": 0, "creation_date": 1488379754, "post_id": 42532652, "comment_id": 72205136, "body": "You should not need to make type families and wrap them in classes in this way, because it generally makes no sense. I could tell you more if you tell about a real use case. Sometimes it could be profitable, but rather as a hack than a right solution. Everything  depends on the use case."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1488397176, "post_id": 42532652, "comment_id": 72216859, "body": "I downvoted. There&#39;s a lot of text here, but even as a Haskell expert I&#39;m having a tough time sifting out just what the difference you&#39;re trying to call out is, and why it matters/was done that way. For some concrete examples: &quot;the only thing you know [with the type family] is that you get <code>Constraint</code> after applying two type variables&quot;; what extra thing do you know with the type class? What are you trying to illustrate with your <code>Functor</code> analogy? What is &quot;pattern matching on variables&quot;, why is it useful for GHC to be able to do it, and what do you give up by allowing it?"}, {"owner": {"reputation": 647, "user_id": 2545568, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LdpKP.png?s=128&g=1", "display_name": "justinpc", "link": "https://stackoverflow.com/users/2545568/justinpc"}, "edited": false, "score": 2, "creation_date": 1577558070, "post_id": 42532652, "comment_id": 105199251, "body": "This answer is wrong on multiple accounts. 1. Type classes ARE NOT types, they are classes of types, as per the name. 2. Overlapping type classes are equivalent to non-injective type families: In an overlapping type class, it is possible that a type matches with the heads of two separate type class instances of the same type class. 3. By pattern matching, I think that you mean that the type system tries to find the most specific type class instance according to algorithms laid out in the specification and GHC, for overlapping instances."}], "tags": [], "owner": {"reputation": 10726, "user_id": 889902, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ops76.png?s=128&g=1", "display_name": "Wojciech Danilo", "link": "https://stackoverflow.com/users/889902/wojciech-danilo"}, "is_accepted": false, "score": -1, "last_activity_date": 1488373713, "creation_date": 1488373713, "answer_id": 42532652, "question_id": 42530308, "link": "https://stackoverflow.com/questions/42530308/partially-applied-type-family/42532652#42532652", "title": "Partially applied type family", "body": "<p>These two definitions you mention:\n<code>type family SillyT a b :: Constraint</code> and <code>class ... =&gt; SillyC a b</code> are very, very different from the perspective of Haskell's type checker.</p>\n\n<p>If you see the former one the only thing you know is that you get <code>Constraint</code> after applying two type variables, but you don't tell GHC what happens after applying only one. You should be able to define <code>SillyT</code> as <code>type family SillyT a :: * -&gt; Constraint</code> and then it tells GHC much more.</p>\n\n<p>Think about it like about constructor variables. If you tell GHC that something is a <code>Functor</code>, GHC knows that it's \"shape\" is <code>f a</code>, where <code>a</code> is a last parameter to some <code>f</code>. You have to tell GHC that it could analyse the result of <code>SillyT</code> in the same way, so GHC could be sure, that it always can access the last parameter looking at the result type. </p>\n\n<p>Type classes, on the other hand, are a little more expressive here. They ARE a type, not a type transformation (like type families) and GHC can \"pattern match\" on their variables, so you don't encounter here the above limitation. Moreover, type classes allow you defining overlapping instances, which is not possible when using type families. However, functional dependencies are less flexible than type families, because unless GHC supports impredicative contexts, it's very hard to get rid of unnecessary free type variables using type deps.</p>\n\n<p>I hope it clarifies some things :)</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 525, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1488373713, "creation_date": 1488367108, "last_edit_date": 1495542312, "question_id": 42530308, "link": "https://stackoverflow.com/questions/42530308/partially-applied-type-family", "title": "Partially applied type family", "body": "<p>This is a follow up question to <a href=\"https://stackoverflow.com/questions/42526616/partially-applied-equality-constraint\">this question</a> where an answer revealed partially applying the <code>(~)</code> type operator is allowed.</p>\n\n<p>Consider the following (silly) type family:</p>\n\n<pre><code>type family SillyT a b :: Constraint\n\ndata D (c :: * -&gt; Constraint) where\n  D :: Proxy c -&gt; D c\n</code></pre>\n\n<p>Then something like this is not valid:</p>\n\n<pre><code>D (Proxy :: (Proxy (SillyT Int)))\n</code></pre>\n\n<p>But if I wrap <code>SillyT</code> in a class like so:</p>\n\n<pre><code>class SillyT a b =&gt; SillyC a b\ninstance SillyT a b =&gt; SillyC a b\n</code></pre>\n\n<p>Then I can do this:</p>\n\n<pre><code>D (Proxy :: (Proxy (SillyC Int)))\n</code></pre>\n\n<p>And everything works fine. However wrapping in a class does seem a bit silly and repetitive, but is this the only way to partially apply a type family?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "pattern-matching", "parse-error"], "comments": [{"owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "edited": false, "score": 1, "creation_date": 1488367916, "post_id": 42530122, "comment_id": 72196849, "body": "You are missing a case in min also, where a and b are equal"}, {"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "reply_to_user": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "edited": false, "score": 0, "creation_date": 1488368021, "post_id": 42530122, "comment_id": 72196923, "body": "I have added   | a == b = 0. Now I get the issue: Ambigous ocurrence &#39;main&#39;. I have saved and recompiled the file before."}, {"owner": {"reputation": 5008, "user_id": 5762796, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b3acb5c2021f4c279f29d61481b28e15?s=128&d=identicon&r=PG&f=1", "display_name": "Aleph0", "link": "https://stackoverflow.com/users/5762796/aleph0"}, "edited": false, "score": 0, "creation_date": 1488369182, "post_id": 42530122, "comment_id": 72197710, "body": "What about this one-liner? <code>foldl (\\x y-&gt;if x&lt;y then x else y) (maxBound::Int) [2,5,2,3,5]</code>"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1504685156, "post_id": 42530122, "comment_id": 79100307, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8561762/haskell-parse-error-in-pattern\">Haskell: Parse error in pattern</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1488367073, "post_id": 42530222, "comment_id": 72196280, "body": "Your explanation seems correct and logic to me. Unfortunately for &#39;minim x:[]     = x&#39; I still get error in parse pattern."}, {"owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "reply_to_user": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "edited": false, "score": 0, "creation_date": 1488367630, "post_id": 42530222, "comment_id": 72196633, "body": "@jublikon: my bad I&#39;ve noticed a second problem!"}, {"owner": {"reputation": 42360, "user_id": 389146, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/zGYUq.jpg?s=128&g=1", "display_name": "Karl Bielefeldt", "link": "https://stackoverflow.com/users/389146/karl-bielefeldt"}, "edited": false, "score": 2, "creation_date": 1488371140, "post_id": 42530222, "comment_id": 72198973, "body": "<code>[x]</code> is a perfectly fine (a much clearer) way to match a list of one."}, {"owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "reply_to_user": {"reputation": 42360, "user_id": 389146, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/zGYUq.jpg?s=128&g=1", "display_name": "Karl Bielefeldt", "link": "https://stackoverflow.com/users/389146/karl-bielefeldt"}, "edited": false, "score": 0, "creation_date": 1488506002, "post_id": 42530222, "comment_id": 72272497, "body": "@KarlBielefeldt: ah, I hadn&#39;t realised that, I&#39;ve always used the cons operator (so when told that there was a syntax error but not which line that looked wrong to me)."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1488526558, "post_id": 42530222, "comment_id": 72279538, "body": "@dave Many would love to see that misinformation is removed from SO answers. Therefore, I kindly ask you to edit yours accordingly."}], "tags": [], "owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1488702102, "last_edit_date": 1488702102, "creation_date": 1488366822, "answer_id": 42530222, "question_id": 42530122, "link": "https://stackoverflow.com/questions/42530122/haskell-finding-smallest-element-in-list/42530222#42530222", "title": "Haskell - finding smallest Element in list", "body": "<p>You have one parameter that you want to match (the list of <code>Int</code>s).  Where you want to match parts of that list you need to put these in brackets to show the compiler you are matching one thing.   Thus the last pattern should be <code>(x:xs)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1488396065, "post_id": 42531749, "comment_id": 72216161, "body": "<code>0</code> is a pretty bad initialiser for <code>min</code>, don&#39;t you think? Maybe <code>minim [] = 1&#47;0</code> ?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1488399007, "post_id": 42531749, "comment_id": 72217914, "body": "The third equation for <code>minim</code> is pretty awkward, with the <code>fromJust</code> call and another mention of <code>Just</code> as well. Better would be: <code>minim (x:xs) = min x &lt;$&gt; minim xs</code>."}, {"owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1488455268, "post_id": 42531749, "comment_id": 72243672, "body": "@amalloy, thanks for the suggestion, felt that something was strange with having &quot;Just&quot; there, but didn&#39;t get it to work. Not very familiar with &lt;$&gt; (or Functors/monads at all) but now i learned something, thanks :)"}], "tags": [], "owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "is_accepted": true, "score": 7, "last_activity_date": 1488455110, "last_edit_date": 1488455110, "creation_date": 1488371311, "answer_id": 42531749, "question_id": 42530122, "link": "https://stackoverflow.com/questions/42530122/haskell-finding-smallest-element-in-list/42531749#42531749", "title": "Haskell - finding smallest Element in list", "body": "<p>If you want to solve it the most Haskell way. I would solve it as such:</p>\n\n<pre><code>-- Does not work for empty lists (so maybe needs to be wrapped in some logic)\nfoldr1 min [-3,1,2,3]\n-- Works for empty but needs a \"default value\" (in this case 0)\nfoldr min 0 [-3,1,2,3]\n</code></pre>\n\n<p>If you want to learn by implementing it yourself, then this works for me</p>\n\n<pre><code>minim :: [Int] -&gt; Int\nminim []       = 0\nminim [x]      = x\nminim (x:xs)   = min x (minim xs)\n\nmin :: Int -&gt; Int -&gt; Int\nmin a b\n    | a &gt; b  = b\n    | a &lt; b  = a\n    | a == b = a\n</code></pre>\n\n<p>I would however make it a bit more safe, because is really 0 the smallest int in the list if it is empty? I think you should use <code>Nothing</code> as the result.</p>\n\n<pre><code>import Data.Maybe\n\nimport Prelude hiding (min)\n\nmain = print $  minim [1,3,4, 6,6,-9]\n\nminim :: [Int] -&gt; Maybe Int\nminim []       = Nothing\nminim [x]      = Just x\nminim (x:xs)   = min x &lt;$&gt; minim xs\n\nmin :: Int -&gt; Int -&gt; Int\nmin a b\n    | a &gt; b  = b\n    | a &lt; b  = a\n    | a == b = a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12223694, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBB4rQN_57wzylTtId4IRF1Kvi9BWGdAJUUJVOE2Q=k-s128", "display_name": "Lucas Castro", "link": "https://stackoverflow.com/users/12223694/lucas-castro"}, "is_accepted": false, "score": 1, "last_activity_date": 1571191904, "creation_date": 1571191904, "answer_id": 58404820, "question_id": 42530122, "link": "https://stackoverflow.com/questions/42530122/haskell-finding-smallest-element-in-list/58404820#58404820", "title": "Haskell - finding smallest Element in list", "body": "<p>here's another way of implementing what you asked but without having to use auxiliary functions such as min</p>\n\n<pre><code>minElem::[Int]-&gt;Int\nminElem [] = 0\nminElem [x] = x\nminElem (x:y:xs) \n |x &gt; y = minElem (y:xs)\n |x &lt; y = minElem (x:xs)\n |x == y = minElem (x:xs)\n</code></pre>\n"}], "owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11180, "favorite_count": 0, "accepted_answer_id": 42531749, "answer_count": 3, "score": 1, "last_activity_date": 1571191904, "creation_date": 1488366546, "last_edit_date": 1504685174, "question_id": 42530122, "link": "https://stackoverflow.com/questions/42530122/haskell-finding-smallest-element-in-list", "title": "Haskell - finding smallest Element in list", "body": "<p>I have a function that gets a List and has to return the smallest Element of it. </p>\n\n<p>Unfortunately I keep getting the issue: </p>\n\n<blockquote>\n  <p>Parse error in pattern: minim</p>\n</blockquote>\n\n<p>What could I have done wrong?</p>\n\n<pre><code>minim :: [Int] -&gt; Int\nminim []       = 0\nminim [x]      = x\nminim x:xs     = min x (minim xs)\n\nmin :: Int -&gt; Int -&gt; Int\nmin a b\n    | a &gt; b  = b\n    | a &lt; b  = a\n</code></pre>\n"}, {"tags": ["debugging", "haskell", "recursion", "infinite-loop", "lazy-evaluation"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488364248, "post_id": 42529206, "comment_id": 72194318, "body": "<code>mylist = addElement mylist elem</code> It&#39;s not an assignment, it&#39;s an equation. Haskell has no updates. Show your attempt in context. How are you trying to build mylist?"}, {"owner": {"reputation": 201, "user_id": 5356562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed98805ce9f837e41b8d8cc262379e3?s=128&d=identicon&r=PG&f=1", "display_name": "MonadBoy", "link": "https://stackoverflow.com/users/5356562/monadboy"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488364732, "post_id": 42529206, "comment_id": 72194674, "body": "Well, I basically run <code>mylist = []</code> first, and then, say, <code>mylist = addElement mylist 3</code>. The second call is equivalent to <code>mylist = mylist ++ [3]</code>. If I then type <code>id mylist</code> in ghci for example, nothing happens and I&#39;m stuck in the loop. So should I take it that it is impossible to have a function <code>addElement</code> in Haskell that would end up with <code>id mylist</code> resulting in <code>[3]</code> ?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488365542, "post_id": 42529206, "comment_id": 72195238, "body": "No, please show an entire function you are trying to build mylist in."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1488365810, "post_id": 42529206, "comment_id": 72195414, "body": "If you don&#39;t need to build the list in a specific order, then adding an element at the front is the solution (it&#39;s an O(1) operation). Even if you need this specific order it&#39;s probably cheaper to build the list in the reverse order and just reverse it once in the end."}], "answers": [{"comments": [{"owner": {"reputation": 201, "user_id": 5356562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed98805ce9f837e41b8d8cc262379e3?s=128&d=identicon&r=PG&f=1", "display_name": "MonadBoy", "link": "https://stackoverflow.com/users/5356562/monadboy"}, "edited": false, "score": 0, "creation_date": 1488365537, "post_id": 42529466, "comment_id": 72195235, "body": "Thank you for the thorough answer, I think your first and last paragraphs best answer my question. So the fact that I have to introduce new variables for each &quot;new list&quot; is basically something of a limitation that I have to live with in Haskell, and there is nothing I (or anyone else) can do about it. That&#39;s enough for me to accept."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 201, "user_id": 5356562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed98805ce9f837e41b8d8cc262379e3?s=128&d=identicon&r=PG&f=1", "display_name": "MonadBoy", "link": "https://stackoverflow.com/users/5356562/monadboy"}, "edited": false, "score": 2, "creation_date": 1488365706, "post_id": 42529466, "comment_id": 72195340, "body": "@A.Sh: indeed, although it is not really a limitation: you can write any program without redefining a variable. Furthermore personally I think that is useful to have such limitation since you do not have to reason about variables changing values through the process. Declarative languages tend to be easier to debug in my opinion."}, {"owner": {"reputation": 201, "user_id": 5356562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed98805ce9f837e41b8d8cc262379e3?s=128&d=identicon&r=PG&f=1", "display_name": "MonadBoy", "link": "https://stackoverflow.com/users/5356562/monadboy"}, "edited": false, "score": 0, "creation_date": 1488365866, "post_id": 42529466, "comment_id": 72195448, "body": "@WillemVanOnsem That is true, now that you say it. I&#39;m still quite new to functional (and declarative) programming, so I guess my thinking is still biased by all the imperative programming I&#39;ve done before."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1488364733, "creation_date": 1488364733, "answer_id": 42529466, "question_id": 42529206, "link": "https://stackoverflow.com/questions/42529206/how-do-i-modify-a-haskell-list-without-entering-an-infinite-loop/42529466#42529466", "title": "How do I modify a Haskell list without entering an infinite loop?", "body": "<p>First of all <code>mylist = addElement mylist elem</code> is an equation, it is <strong>not an assignment</strong>. It is <strong>not</strong> evaluated once: since Haskell is a declarative language, you <strong>cannot alter a variable</strong>: once you give it a value, it will always have that value.</p>\n\n<p>Your equation will thus result in:</p>\n\n<pre><code>mylist = addElement mylist elem\n       = addElement (addElement mylist elem) elem\n       = addElement (... (addElement mylist elem) ...) elem\n</code></pre>\n\n<p>you get the idea.</p>\n\n<p>Nevertheless, you <strong>do not need to construct an complete new list each time</strong>: you can simply use <code>(h:t)</code> to <strong>append to the head</strong>:</p>\n\n<pre><code>addElement :: [a] -&gt; a -&gt; [a]\naddElement t h = (h:t)\n</code></pre>\n\n<p>This will construct a \"new\" list in <em>O(1)</em> that reuses the old list as tail. As mentioned before the element will be added to the front.</p>\n\n<p>Another way to solve the issue is using <strong><em>difference lists</em></strong>. Here a list is denoted as:</p>\n\n<pre><code>type DiffList a = a -&gt; [a]\n</code></pre>\n\n<p>and an empty list is:</p>\n\n<pre><code>emptyDiffList :: DiffList a\nemptyDiffList = \\x -&gt; x\n</code></pre>\n\n<p>In that case you <em>ground</em> the difference list with:</p>\n\n<pre><code>groundDiffList :: DiffList a -&gt; [a]\ngroundDiffList x = x []\n</code></pre>\n\n<p>and you can add an element to the <strong>end of the list</strong> with:</p>\n\n<pre><code>addElement :: DiffList a -&gt; a -&gt; DiffList a\naddElement l el = \\x -&gt; l (el:x)\n</code></pre>\n\n<p>Nevertheless you will always need to <em>create a new variable</em> for a \"new list\": you cannot all of a sudden give <code>mylist</code> another value (you can of course use recursion but in that case those are technically two different variables: the <code>mylist</code> of the <em>caller</em>, and the <code>mylist</code> of the <em>callee</em>).</p>\n"}], "owner": {"reputation": 201, "user_id": 5356562, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ed98805ce9f837e41b8d8cc262379e3?s=128&d=identicon&r=PG&f=1", "display_name": "MonadBoy", "link": "https://stackoverflow.com/users/5356562/monadboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 0, "accepted_answer_id": 42529466, "answer_count": 1, "score": 1, "last_activity_date": 1488364733, "creation_date": 1488364014, "question_id": 42529206, "link": "https://stackoverflow.com/questions/42529206/how-do-i-modify-a-haskell-list-without-entering-an-infinite-loop", "title": "How do I modify a Haskell list without entering an infinite loop?", "body": "<p>I am writing a piece of code in Haskell, where I have a line that does something like this:</p>\n\n<pre><code>addElement :: [a] -&gt; a -&gt; [a]\naddElement list elem = list ++ [elem]\n</code></pre>\n\n<p>I need (or at least, I think so) a function like this for the purpose of adding new vertices in a vertex list of a graph data structure that I'm implementing. Now, I can call this function as follows</p>\n\n<pre><code>newlist = addElement oldlist elem\n</code></pre>\n\n<p>and everything works out fine. However, if I write</p>\n\n<pre><code>mylist = addElement mylist elem\n</code></pre>\n\n<p>and then try to do anything with mylist after the call has terminated (it does), I enter an infinite loop, and if I understand correctly this is due to the lazy evaluation of Haskell or something of the sort (<code>mylist</code> gets expanded to <code>addElement (addElement ... elem) elem</code> if I got it right ?). </p>\n\n<p>This is of course bad for my particular implementation, since for my purposes I now have to make new lists every time I need to add an element to a list. So how do I make an element-adding function that works the way I want?</p>\n"}, {"tags": ["haskell", "types", "type-constraints"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488358029, "post_id": 42526616, "comment_id": 72189883, "body": "I guess <code>Proxy ((~) Int)</code> does not work, but it would be nice."}], "answers": [{"tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": true, "score": 4, "last_activity_date": 1488358250, "creation_date": 1488358250, "answer_id": 42527133, "question_id": 42526616, "link": "https://stackoverflow.com/questions/42526616/partially-applied-equality-constraint/42527133#42527133", "title": "Partially applied equality constraint", "body": "<p>You do not need a class at all, you can just use <code>(~)</code> in prefix notation.</p>\n\n<p>There is a bug in GHC 8.0.1 which sometimes makes it crash, but it is just a bug, and it's fixed in 8.0.2. The class / instance combo you're describing is indeed an effective workaround for this bug.</p>\n\n<p>If you do not need backwards compatibility with 8.0.1, you can use <code>(~) Int</code> or <code>Proxy ((~) Int)</code> directly.</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 42527133, "answer_count": 1, "score": 3, "last_activity_date": 1488358250, "creation_date": 1488356595, "last_edit_date": 1488357167, "question_id": 42526616, "link": "https://stackoverflow.com/questions/42526616/partially-applied-equality-constraint", "title": "Partially applied equality constraint", "body": "<p>Consider the following:</p>\n\n<pre><code>class (a ~ b) =&gt; Equal a b\ninstance (a ~ b) =&gt; Equal a b\n</code></pre>\n\n<p>Lets say I later have a data type:</p>\n\n<pre><code>data D (c :: * -&gt; Constraint) where\n  D :: Proxy c -&gt; D c\n</code></pre>\n\n<p>Then something like this is valid:</p>\n\n<pre><code>D (Proxy :: (Proxy (Equal Int)))\n</code></pre>\n\n<p>My question is, is there any way to write <code>Equal</code> other than the repetitive class/instance notation I've used? </p>\n\n<p>It seems that when I define <code>Equal</code> as a type family <code>Equal Int</code> doesn't work because it's an incomplete application.</p>\n\n<p>The class/instance hack looks bad but at least it works, but is there any other maybe cleaner way of achieving this?</p>\n\n<p>Note I'll be using constraints more complex than equality in my actual code, I just thought this would be a good example.</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 1, "creation_date": 1488355209, "post_id": 42526165, "comment_id": 72188233, "body": "There is no difference; <code>String</code> is exactly <code>[Char]</code>, defined as <code>type String = [Char]</code>. String literals can be overloaded with the <code>OverloadedStrings</code> extension, though."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1488397085, "post_id": 42526165, "comment_id": 72216801, "body": "You have another error: <code>present v :: b -&gt; Bool</code>, not <code>Bool</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1488355583, "last_edit_date": 1488355583, "creation_date": 1488355255, "answer_id": 42526203, "question_id": 42526165, "link": "https://stackoverflow.com/questions/42526165/understanding-the-implications-of-string-over-char/42526203#42526203", "title": "Understanding the implications of String over [Char]?", "body": "<p>There is absolutely no difference between <code>[Char]</code> and <code>String</code>. The latter is defined as a type alias/synonym:</p>\n\n<pre><code>type String = [Char]\n</code></pre>\n\n<p>Both are lazy linked lists of characters. For other representation, there's <code>Text</code> which represents strings with contiguous arrays (as in C, roughly, but Unicode aware). We also have <code>ByteStrings</code> which however is unsuitable for strings, despite the name: that is a contiguous array of bytes, which can hold binary data. You then need to decode such binary data to reach a real Unicode string. If you know that your characters is latin-1 encoded, you can use a <code>ByteString</code>, but for real applications nowadays one should be Unicode-ready.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "accepted_answer_id": 42526203, "answer_count": 1, "score": 0, "last_activity_date": 1488355583, "creation_date": 1488355131, "question_id": 42526165, "link": "https://stackoverflow.com/questions/42526165/understanding-the-implications-of-string-over-char", "title": "Understanding the implications of String over [Char]?", "body": "<p>I'm building a simple class interface for basic parametic polymorphism:</p>\n\n<pre><code>class Document a where\n  present :: a -&gt; b -&gt; Bool\n\ninstance Document String where\n  present s o = False\n\ninstance Document Int where\n  present i o = True\n\nimplementation :: Document a =&gt; a -&gt; Int -&gt; Bool\nimplementation v int | int &gt; 10           = present v\n                     | otherwise          = False\n</code></pre>\n\n<p>I understand that when numerical arguments to parameters constrained by <code>Document</code> you are required to specify their type:</p>\n\n<pre><code>print $ implementation (22 :: Int) 400\n</code></pre>\n\n<p>My understanding is that this is due to the compiler not knowing if 22 is an <code>Int</code> or a <code>Float</code>.</p>\n\n<p>However, I see that the same applies to strings:</p>\n\n<pre><code>print $ implementation (\"mystring\" :: String) 400\n</code></pre>\n\n<p>Again, to differentiate between <code>String</code> and <code>[Char]</code>. However I don't actually understand the practical differences between these? </p>\n\n<p>I assumed Haskell compiler behavior was similar to C/C++, where all types of <code>String</code> were converted to <code>[Char]</code> at compile time - is this not the case?</p>\n\n<p>Why would one use <code>[Char]</code> over <code>String</code> and vice versa?  </p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "edited": false, "score": 1, "creation_date": 1488346574, "post_id": 42523375, "comment_id": 72184175, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/18929610/how-to-get-a-typesafe-url-to-a-static-resource-in-yesod\">How to get a TypeSafe URL to a static resource in Yesod</a>"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1488351711, "post_id": 42523375, "comment_id": 72186413, "body": "Try putting this: <code>&#47;static&#47;img&#47;bg.jpg</code> instead ?"}, {"owner": {"reputation": 845, "user_id": 4131972, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/--SIseZZR51U/AAAAAAAAAAI/AAAAAAAAAAw/xWroBmQMpfk/photo.jpg?sz=128", "display_name": "hliu", "link": "https://stackoverflow.com/users/4131972/hliu"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1488351941, "post_id": 42523375, "comment_id": 72186544, "body": "@Sibi It works. Thanks very much!"}], "answers": [{"comments": [{"owner": {"reputation": 845, "user_id": 4131972, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/--SIseZZR51U/AAAAAAAAAAI/AAAAAAAAAAw/xWroBmQMpfk/photo.jpg?sz=128", "display_name": "hliu", "link": "https://stackoverflow.com/users/4131972/hliu"}, "edited": false, "score": 0, "creation_date": 1488349146, "post_id": 42523944, "comment_id": 72185239, "body": "Thanks for reply. But the compiler complains &quot;Variable not in scope: img_bg_jpg :: Route Static&quot;. I have the routes defined in file &quot;config/routes&quot; and there is &quot;mkYesodData &quot;App&quot; $(parseRoutesFile &quot;config/routes&quot;)&quot; in Foundation.hs to generate router. Am I miss something to let compiler know where to find img_bg_jpg?"}, {"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "reply_to_user": {"reputation": 845, "user_id": 4131972, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/--SIseZZR51U/AAAAAAAAAAI/AAAAAAAAAAw/xWroBmQMpfk/photo.jpg?sz=128", "display_name": "hliu", "link": "https://stackoverflow.com/users/4131972/hliu"}, "edited": false, "score": 0, "creation_date": 1488352496, "post_id": 42523944, "comment_id": 72186816, "body": "@hliu <code>img_bg_jpg</code> should be defined automatically from Settings.StaticFiles by TemplateHaskell. Did you reload on ghci? <code>:r</code> wouldn&#39;t be sufficient."}, {"owner": {"reputation": 845, "user_id": 4131972, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/--SIseZZR51U/AAAAAAAAAAI/AAAAAAAAAAw/xWroBmQMpfk/photo.jpg?sz=128", "display_name": "hliu", "link": "https://stackoverflow.com/users/4131972/hliu"}, "edited": false, "score": 0, "creation_date": 1488364999, "post_id": 42523944, "comment_id": 72194853, "body": "I use command &quot;stack exec -- yesod devel&quot; to run the server in develop mode.  After put the image into img directory, I re-run and the compiler shows error still. Use following path can get this problem. 1) stack new  test-static-img yesod-simple; 2) copy test.jpg into static/img/; 3) modify templates/default-layout.lucius, modify the third line to background-image:url(@{StaticR  img_test_jpg}); 4) stack exec -- yesod devel"}, {"owner": {"reputation": 845, "user_id": 4131972, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/--SIseZZR51U/AAAAAAAAAAI/AAAAAAAAAAw/xWroBmQMpfk/photo.jpg?sz=128", "display_name": "hliu", "link": "https://stackoverflow.com/users/4131972/hliu"}, "edited": false, "score": 0, "creation_date": 1488365351, "post_id": 42523944, "comment_id": 72195090, "body": "I doubt the static file not handled automatically? Maybe some codes should be added to make the image file be handled by Yesod."}, {"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "reply_to_user": {"reputation": 845, "user_id": 4131972, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/--SIseZZR51U/AAAAAAAAAAI/AAAAAAAAAAw/xWroBmQMpfk/photo.jpg?sz=128", "display_name": "hliu", "link": "https://stackoverflow.com/users/4131972/hliu"}, "edited": false, "score": 1, "creation_date": 1488366206, "post_id": 42523944, "comment_id": 72195697, "body": "@hliu I have no problem with your commands. It should work. If you&#39;re reusing existing project, could you try <code>stack build</code>? It seems <code>yesod devel</code> can&#39;t detect static resource modification at all."}, {"owner": {"reputation": 845, "user_id": 4131972, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/--SIseZZR51U/AAAAAAAAAAI/AAAAAAAAAAw/xWroBmQMpfk/photo.jpg?sz=128", "display_name": "hliu", "link": "https://stackoverflow.com/users/4131972/hliu"}, "edited": false, "score": 0, "creation_date": 1488367269, "post_id": 42523944, "comment_id": 72196400, "body": "you are right. I run stack clean at first, then it works. Thanks a lot for your help!"}, {"owner": {"reputation": 427, "user_id": 7941330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u7jCJ.jpg?s=128&g=1", "display_name": "F&#225;bio Roberto Teodoro", "link": "https://stackoverflow.com/users/7941330/f%c3%a1bio-roberto-teodoro"}, "reply_to_user": {"reputation": 845, "user_id": 4131972, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/--SIseZZR51U/AAAAAAAAAAI/AAAAAAAAAAw/xWroBmQMpfk/photo.jpg?sz=128", "display_name": "hliu", "link": "https://stackoverflow.com/users/4131972/hliu"}, "edited": false, "score": 1, "creation_date": 1498498253, "post_id": 42523944, "comment_id": 76511704, "body": "I needed to run <code>stack build</code>. Thank you @jeiea and @hliu. Maybe this and the <code>stack clean</code> should be included the answer."}, {"owner": {"reputation": 7287, "user_id": 258848, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/2Ckug.jpg?s=128&g=1", "display_name": "dimsuz", "link": "https://stackoverflow.com/users/258848/dimsuz"}, "edited": false, "score": 0, "creation_date": 1501022777, "post_id": 42523944, "comment_id": 77591773, "body": "Had the same problem and resolved the compilation error only after running <code>stack clean</code>. I too suggest to mention this in the answer."}, {"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "reply_to_user": {"reputation": 427, "user_id": 7941330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u7jCJ.jpg?s=128&g=1", "display_name": "F&#225;bio Roberto Teodoro", "link": "https://stackoverflow.com/users/7941330/f%c3%a1bio-roberto-teodoro"}, "edited": false, "score": 1, "creation_date": 1501069106, "post_id": 42523944, "comment_id": 77613275, "body": "@frt @dimsuz It seems the latest <code>yesod-static</code> includes staticDevel, which reflects changes without <code>stack clean</code>. If not, let me know. For now I will append that as note."}, {"owner": {"reputation": 1327, "user_id": 1749901, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06876c39fc89c5abe3d891e36fe29504?s=128&d=identicon&r=PG", "display_name": "Geradlus_RU", "link": "https://stackoverflow.com/users/1749901/geradlus-ru"}, "edited": false, "score": 0, "creation_date": 1597511146, "post_id": 42523944, "comment_id": 112159290, "body": "I use <code>touch</code> instead of <code>stack clean</code>: <code>touch src&#47;Settings&#47;StaticFiles.hs</code>.  Cleaning everything with <i>stack clean</i> leads to long-time rebuilds, touching <i>StaticFiles.hs</i> leads to quick rebuild and in most cases is sufficient.  Though this works only until you&#39;re under <b>*nix</b>."}], "tags": [], "owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "is_accepted": true, "score": 5, "last_activity_date": 1501069222, "last_edit_date": 1501069222, "creation_date": 1488346382, "answer_id": 42523944, "question_id": 42523375, "link": "https://stackoverflow.com/questions/42523375/how-to-use-image-under-static-directory-as-background-in-yesodweb/42523944#42523944", "title": "How to use image under static directory as background in Yesodweb?", "body": "<p>Maybe you were using lucius template, the real css file was autogenerated in temporary location <code>/tmp</code> on runtime and used the relative path. What you need is <a href=\"http://www.yesodweb.com/book/basics#basics_resources_and_type_safe_urls\" rel=\"nofollow noreferrer\">type-safe URL</a> which verifies URL validity on compile time.</p>\n\n<p>If you're using scaffold template, then you can represent it as <code>@{StaticR img_bg_jpg}</code> according to <a href=\"http://www.yesodweb.com/book/scaffolding-and-the-site-template#scaffolding-and-the-site-template_static_files\" rel=\"nofollow noreferrer\">this</a></p>\n\n<p>Note: With old version of <code>yesod-static</code> and template, <code>stack clean</code> may be required to reflect changes in static directory.</p>\n"}], "owner": {"reputation": 845, "user_id": 4131972, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/--SIseZZR51U/AAAAAAAAAAI/AAAAAAAAAAw/xWroBmQMpfk/photo.jpg?sz=128", "display_name": "hliu", "link": "https://stackoverflow.com/users/4131972/hliu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 311, "favorite_count": 0, "accepted_answer_id": 42523944, "answer_count": 1, "score": 3, "last_activity_date": 1501069222, "creation_date": 1488343443, "question_id": 42523375, "link": "https://stackoverflow.com/questions/42523375/how-to-use-image-under-static-directory-as-background-in-yesodweb", "title": "How to use image under static directory as background in Yesodweb?", "body": "<p>New to Yesod and I wonder how to use an image under directory static/img as the background image of a div. I use the Scaffolding site and have tried:</p>\n\n<pre><code>.mydiv {\n  background-image: url(\"static/img/bg.jpg\");\n}\n</code></pre>\n\n<p>But it seems the url at last changes to <code>http://myhost/tmp/static/img/bg.jpg</code>. </p>\n"}, {"tags": ["list", "haskell", "types", "interface", "typeclass"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1488333570, "post_id": 42521811, "comment_id": 72180573, "body": "History, and also laziness makes it less necessary.  For example, <code>toList</code> essentially gives you an iterator because it&#39;s a lazy list."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 7, "creation_date": 1488333690, "post_id": 42521811, "comment_id": 72180600, "body": "I think it&#39;s tricky to identify the &quot;correct&quot; interface that captures a wide enough notion of &quot;what you can do with a list&quot; that you can actually implement reasonable algorithms with it generically, while still allowing reasonable implementations that aren&#39;t structurally similar to the native <code>[]</code>. Operating by consing and deconsing individual elements at the head is hugely inefficient for array-like structures, for example. That said, there are things like <a href=\"https://hackage.haskell.org/package/ListLike\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/ListLike</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1488334818, "post_id": 42521811, "comment_id": 72180855, "body": "Why does defining your function to take a <code>Foldable t =&gt; t a</code> argument seem wrong?"}, {"owner": {"reputation": 2161, "user_id": 896145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6109f3ca490441df26c206cb6c2e6f?s=128&d=identicon&r=PG", "display_name": "dainichi", "link": "https://stackoverflow.com/users/896145/dainichi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1488338023, "post_id": 42521811, "comment_id": 72181660, "body": "@chepner, there&#39;s nothing wrong about it, I guess, but it&#39;d just be a wrapper that calls the original function with toList of the argument. It&#39;s not like Foldable has functions head/tail/isEmpty, which is what I would find more intuitive."}, {"owner": {"reputation": 2161, "user_id": 896145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6109f3ca490441df26c206cb6c2e6f?s=128&d=identicon&r=PG", "display_name": "dainichi", "link": "https://stackoverflow.com/users/896145/dainichi"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1488338066, "post_id": 42521811, "comment_id": 72181672, "body": "@Ben &quot;tricky to identify the &quot;correct&quot; interface.&quot; Sure, but isn&#39;t that language-independent trickiness? That&#39;s why you would have a list at the top of the hierarchy, and then, say, FIFO queues and priority queues under that, then dequeues further down, etc."}, {"owner": {"reputation": 2161, "user_id": 896145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6109f3ca490441df26c206cb6c2e6f?s=128&d=identicon&r=PG", "display_name": "dainichi", "link": "https://stackoverflow.com/users/896145/dainichi"}, "edited": false, "score": 0, "creation_date": 1488349981, "post_id": 42521811, "comment_id": 72185602, "body": "I still don&#39;t quite see the kind of answers I was hoping for. I was hoping for something like &quot;(In the absence of ViewPatterns), head and tail wouldn&#39;t let us pattern match on lists, and pattern matching is neat&quot;"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 1, "creation_date": 1499212804, "post_id": 42521811, "comment_id": 76806892, "body": "Initiality is a powerful form of abstraction."}], "answers": [{"comments": [{"owner": {"reputation": 2161, "user_id": 896145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6109f3ca490441df26c206cb6c2e6f?s=128&d=identicon&r=PG", "display_name": "dainichi", "link": "https://stackoverflow.com/users/896145/dainichi"}, "edited": false, "score": 0, "creation_date": 1488340533, "post_id": 42522630, "comment_id": 72182334, "body": "Thanks. Right. Of course, I could even define my own type class hierarchy and make instances for [], Dequeue etc. So it&#39;s more a question of why this doesn&#39;t seem to be common practice, and why there aren&#39;t standard type classes like this."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1488340644, "post_id": 42522630, "comment_id": 72182369, "body": "Very well motivated! This is truly an exceptional answer."}, {"owner": {"reputation": 2161, "user_id": 896145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6109f3ca490441df26c206cb6c2e6f?s=128&d=identicon&r=PG", "display_name": "dainichi", "link": "https://stackoverflow.com/users/896145/dainichi"}, "edited": false, "score": 1, "creation_date": 1488349350, "post_id": 42522630, "comment_id": 72185330, "body": "Ignoring Maybe, tail should satisfy &quot;head x : toList (tail x) = toList x&quot;. For lists, that would be the usual tail. For balanced trees, it would be the re-balanced tree after removing the leftmost element.... &quot;It&#39;s not obvious what tail would even mean for an arbitrary type&quot;. That&#39;s up to the designer of the type to decide, as long as the laws are satisfied, right? It&#39;s not obvious what mappend means for Num, that&#39;s why we have Sum and Product..."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 13, "last_activity_date": 1499212593, "last_edit_date": 1499212593, "creation_date": 1488338863, "answer_id": 42522630, "question_id": 42521811, "link": "https://stackoverflow.com/questions/42521811/why-is-haskell-list-not-a-type-class/42522630#42522630", "title": "Why is Haskell [] (list) not a type class?", "body": "<p>A given algebraic datatype can be represented as its catamorphism, a transformation known as <a href=\"https://en.wikipedia.org/wiki/Church_encoding\" rel=\"nofollow noreferrer\"><em>Church encoding</em></a>. That means lists are isomorphic to their <code>foldr</code>:</p>\n\n<pre><code>type List a = forall b. (a -&gt; b -&gt; b) -&gt; b -&gt; b\n\nfromList :: [a] -&gt; List a\nfromList xs = \\f z -&gt; foldr f z xs\n\ntoList :: List a -&gt; [a]\ntoList l = l (:) []\n</code></pre>\n\n<p>But <code>foldr</code> also characterises <code>Foldable</code>. You can define <code>foldMap</code> in terms of <code>foldr</code>, and vice versa.</p>\n\n<pre><code>foldMap f = foldr (mappend . f) mempty\nfoldr f z t = appEndo (foldMap (Endo . f) t) z\n</code></pre>\n\n<p>(It shouldn't be surprising that <code>foldMap :: Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m</code> characterises lists, because lists are a free monoid.) In other words, <code>Foldable</code> basically gives you <code>toList</code> as a class. Instances of <code>Foldable</code> have a \"path\" through them which can be walked to give you a list; <code>Foldable</code> types have at least as much structure as lists.</p>\n\n<hr>\n\n<p>Regarding your misgivings:</p>\n\n<blockquote>\n  <p>It's not like <code>Foldable</code> has functions <code>head</code>/<code>tail</code>/<code>isEmpty</code>, which is what I would find more intuitive.</p>\n</blockquote>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Foldable.html#v:null\" rel=\"nofollow noreferrer\"><code>null :: Foldable t =&gt; t a -&gt; Bool</code></a> is your <code>isEmpty</code>, and you can define (a safe version of) <code>head</code> straightforwardly with <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Monoid.html#t:First\" rel=\"nofollow noreferrer\">an appropriate choice of <code>Monoid</code></a>:</p>\n\n<pre><code>head :: Foldable t :: t a -&gt; Maybe a\nhead = getFirst . foldMap (First . Just)\n</code></pre>\n\n<p><code>tail</code> is kinda tricky in my opinion. It's not obvious what <code>tail</code> would even mean for an arbitrary type. You can certainly write <code>tail :: Foldable t =&gt; t a -&gt; Maybe [a]</code> (by <code>toList</code>ing and then unconsing), but I think any type <code>T</code> for which <code>tail :: T a -&gt; Maybe (T a)</code> is defined would necessarily be structurally similar to lists (eg <a href=\"https://hackage.haskell.org/package/containers-0.5.10.1/docs/Data-Sequence.html#t:Seq\" rel=\"nofollow noreferrer\"><code>Seq</code></a>). Besides, in my experience, the vast majority of cases where you'd think you need access to a list's <code>tail</code> turn out to be folds after all.</p>\n\n<p>That said, abstracting over unconsable types is occasionally useful. <a href=\"https://hackage.haskell.org/package/megaparsec-5.3.0\" rel=\"nofollow noreferrer\"><code>megaparsec</code></a>, for example, defines a <a href=\"https://hackage.haskell.org/package/megaparsec-5.3.0/docs/Text-Megaparsec.html#t:Stream\" rel=\"nofollow noreferrer\"><code>Stream</code></a> class for (monomorphic) streams of tokens to be used as input for a parser.</p>\n"}, {"comments": [{"owner": {"reputation": 2161, "user_id": 896145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6109f3ca490441df26c206cb6c2e6f?s=128&d=identicon&r=PG", "display_name": "dainichi", "link": "https://stackoverflow.com/users/896145/dainichi"}, "edited": false, "score": 0, "creation_date": 1488346561, "post_id": 42522694, "comment_id": 72184169, "body": "The class is useful for 1. lists, 2. FIFO queues, 3. priority queues... The class could also be useful for trees, although the tail might need some rebalancing of the original tree (that would in fact be an obvious implementation option of a priority queue). &quot;As a result, isEmpty shouldn&#39;t even be in the class&quot;. Huh? Why can&#39;t we have a convenience function with a default implementation? Eq has both == and /=."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1488346670, "post_id": 42522694, "comment_id": 72184208, "body": "<a href=\"https://hackage.haskell.org/package/mono-traversable-1.0.1.3/docs/Data-Sequences.html#t:IsSequence\" rel=\"nofollow noreferrer\"><code>IsSequence</code></a> is a souped up version of <code>HasHeadAndTail</code>. I&#39;m not a fan of it, but, for those who dislike qualified imports of, it <i>does</i> present a sequence-like abstraction."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1488355347, "post_id": 42522694, "comment_id": 72188308, "body": "Despite FIFO and other types, I maintain the utility gap exislts.  Moving <code>isEmpty</code> back into the class is unnecessary and thus doesn&#39;t help the class become more principled - an optional isEmpty can&#39;t make head or tail optional and doesn&#39;t cause fundamental change."}, {"owner": {"reputation": 2161, "user_id": 896145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6109f3ca490441df26c206cb6c2e6f?s=128&d=identicon&r=PG", "display_name": "dainichi", "link": "https://stackoverflow.com/users/896145/dainichi"}, "edited": false, "score": 0, "creation_date": 1488868414, "post_id": 42522694, "comment_id": 72410537, "body": "@ThomasM.DuBuisson &quot;principled&quot;. You don&#39;t think Haskell needs default implementations at all? So Monad doesn&#39;t need mconcat, then?"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 5, "last_activity_date": 1488339269, "creation_date": 1488339269, "answer_id": 42522694, "question_id": 42521811, "link": "https://stackoverflow.com/questions/42521811/why-is-haskell-list-not-a-type-class/42522694#42522694", "title": "Why is Haskell [] (list) not a type class?", "body": "<p><strong>The Question</strong></p>\n\n<p>Making your question more concrete, let's ask:</p>\n\n<p>Why isn't the type class</p>\n\n<pre><code>class HasHeadAndTail t where\n    head :: t a -&gt; Maybe a\n    tail :: t a -&gt; Maybe (t a)\n    isEmpty :: t a -&gt; Bool\n</code></pre>\n\n<p>in the <code>base</code> library?</p>\n\n<p><strong>An Answer</strong></p>\n\n<p>This class is only useful for ordered, linear containers.  <code>Map</code>, <code>Set</code>, <code>HashMap</code>, <code>HashTable</code>, and <code>Tree</code> all would not be instances.  I'd even argue against making <code>Seq</code> and <code>DList</code> an instance since there are really two possible \"heads\" of that structure.</p>\n\n<p>Also what can we say about any type that is an instance of this class?  I think the only property is if <code>isEmpty</code> is False then <code>head</code> and <code>tail</code> should be non-<code>Nothing</code>.  As a result, isEmpty shouldn't even be in the class and instead be a function <code>isEmpty :: HashHeadAndTail t =&gt; t a -&gt; Bool ; isEmpty = isNothing . head</code>.</p>\n\n<p>So my answer is:</p>\n\n<ul>\n<li>This class lacks utility in so far as it lacks instances.</li>\n<li>This class lacks useful properties and classes that lack properties are frequently discouraged.</li>\n</ul>\n"}], "owner": {"reputation": 2161, "user_id": 896145, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff6109f3ca490441df26c206cb6c2e6f?s=128&d=identicon&r=PG", "display_name": "dainichi", "link": "https://stackoverflow.com/users/896145/dainichi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1550949448, "creation_date": 1488332918, "last_edit_date": 1550949448, "question_id": 42521811, "link": "https://stackoverflow.com/questions/42521811/why-is-haskell-list-not-a-type-class", "title": "Why is Haskell [] (list) not a type class?", "body": "<p>I am writing a Haskell function which takes a list as input. That is, there's no reason it couldn't be a queue or dequeue, or anything that allows me to access its \"head\" and its \"tail\" (and check if it's empty). So the [a] input type seems too specific. But AFAIK there's no standard library typeclass that captures exactly this interface. Sure, I could wrap my function in a Data.Foldable.toList and make it polymorphic wrt Foldable, but that doesn't quite seem right (idiomatic).</p>\n\n<p>Why is there no standard list type class? (And why is the \"container\" type class hierarchy in Haskell less developed than I think it should be?) Or am I missing something essential?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 3, "creation_date": 1488313338, "post_id": 42518003, "comment_id": 72172942, "body": "This can\u2019t really be done and isn\u2019t really necessary. Use more <code>let</code>s to make expressions more readable."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 5, "creation_date": 1488313651, "post_id": 42518003, "comment_id": 72173090, "body": "For <code>(+) (-) 10 1 2</code> to work, you would need to lookup how many arguments <code>(-)</code> and <code>(+)</code> expect before being able to parse. Compared to needing to know fixities, this seems a bit more painful. Oh, and this would create ambiguities with unary <code>-</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488317421, "post_id": 42518003, "comment_id": 72175074, "body": "Why on earth do you want to use prefix notation in a language which was not designed for it? Even if it were somehow possible (e.g. through quasiquotation or TH) it would only lead to terribly unidiomatic code."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1488322432, "post_id": 42518003, "comment_id": 72177483, "body": "Postfix would be just as nice, ambiguity-wise, and doesn&#39;t require remembering which operators are currently awaiting operands. There&#39;s a reason RPN calculators are more common and PN calculators."}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488323058, "post_id": 42518003, "comment_id": 72177747, "body": "@chi I want to use the language as a calculator and I like the ease of prefix notation."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1488326565, "post_id": 42518003, "comment_id": 72178806, "body": "@Addem I know this is a bit flippant, but may I suggest you get a prefix notation calculator program for your prefix-notation-calculator purposes? I&#39;m pretty sure that an overwhelming majority of programmers would find prefix notation for writing Haskell programs (as opposed to arithmetic expressions in a calculator) to be very difficult to read/write."}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1488329693, "post_id": 42518003, "comment_id": 72179623, "body": "@Ben I could but thought it&#39;d be nice to have it in a programming language, figured I&#39;d ask.  Just asking a question.  The answer could be &quot;no&quot;."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1488330742, "post_id": 42518003, "comment_id": 72179889, "body": "@Addem: I think you could probably make a Haskell quasiquoter that does something roughly similar to the way you proposed in your comment on my answer (if I get some time I might try to whip up a rough demo). But you&#39;d end up having to write <code>[prefix| + - 10 1 2 |]</code>. So it&#39;s not a terrible question."}, {"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 1, "creation_date": 1488330919, "post_id": 42518003, "comment_id": 72179931, "body": "@Ben I get that compliment a lot: &quot;Your question isn&#39;t <b>terrible</b>.&quot;  :)  (joking)"}, {"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 1, "creation_date": 1488332158, "post_id": 42518003, "comment_id": 72180229, "body": "I&#39;m too lazy to expand it into an answer (someone else feel free) but look at Chris Okasaki&#39;s <a href=\"http://www.westpoint.edu/eecs/SiteAssets/SitePages/Faculty%20Publication%20Documents/Okasaki/jfp03flat.pdf\" rel=\"nofollow noreferrer\">Flattening Combinators: Surviving without Parentheses</a>."}], "answers": [{"comments": [{"owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 0, "creation_date": 1488323233, "post_id": 42520057, "comment_id": 72177820, "body": "True and I had thought of that, but really I think there are good resolutions available.  For one thing, we could assume that all operations--contrasted with functions--are binary and if we want to distinguish the binary and unary - symbol, we could always just use the binary and write - 0 1 to get -1."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "edited": false, "score": 2, "creation_date": 1488326243, "post_id": 42520057, "comment_id": 72178730, "body": "@Adam Yeah, I guess you could make something work. Something like &quot;ordinary terms adjacent to each other are a left-associative chain of applications, an operator term starts a Polish prefix notation chain and continues until the head operator has 2 arguments, in the Polish chain all non-operator terms are operator arguments&quot;. So you could say <code>fmap ($) $ . (f arg) . g (h q (r s)) x foo bar </code> for what Haskellers would spell <code>fmap ($) (f arg . g . h q (r s) $ x) foo bar</code> (I <i>think</i> I got that right). Possible, but definitely not Haskell!"}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 6, "last_activity_date": 1488321497, "creation_date": 1488321497, "answer_id": 42520057, "question_id": 42518003, "link": "https://stackoverflow.com/questions/42518003/haskell-get-a-prefix-operator-that-works-without-parentheses/42520057#42520057", "title": "Haskell: Get a prefix operator that works without parentheses", "body": "<blockquote>\n  <p>It gets even worse when you try to compose functions because</p>\n\n<pre><code>Prelude&gt; (+) (-) 10 1 2 \n</code></pre>\n  \n  <p>yields an error, I believe because it's\n  trying to feed the minus operation into the plus operations rather\n  than first evaluating the minus and then feeding--so now you need even\n  more parens!</p>\n</blockquote>\n\n<p>Here you raise exactly the key issue that's a blocker for getting what you want in Haskell.</p>\n\n<p>The prefix notation you're talking about is unambiguous for basic arithmetic operations (more generally, for any set of functions of statically known arity). But you have to know that <code>+</code> and <code>-</code> each accept 2 arguments for <code>+ - 10 1 2</code> to be unambiguously resolved as <code>+(-(10, 1), 2)</code> (where I've explicit argument lists to denote every call).</p>\n\n<p>But ignoring the specific meaning of <code>+</code> and <code>-</code>, the first function taking the second function as an argument is a perfectly reasonable interpretation! For <em>Haskell</em> rather than arithmetic we need to support higher order functions like <code>map</code>. You would want <code>not not x</code> has to turn into <code>not(not(x))</code>, but <code>map not x</code> has to turn into <code>map(not, x)</code>.</p>\n\n<p>And what if I had <code>f g x</code>? How is that supposed to work? Do I need to know what <code>f</code> and <code>g</code> are bound to so that I know whether it's a case like <code>not not x</code> or a case like <code>map not x</code>, just to know how to parse the call structure? Even assuming I have all the code available to inspect, how am I supposed to figure out what things are bound to if I can't know what the call structure of any expression is?</p>\n\n<p>You'd end up needing to invent disambiguation syntax like <code>map (not) x</code>, wrapping <code>not</code> in parentheses to disable it's ability to act like an arity-1 function (much like Haskell's actual syntax lets you wrap operators in parentheses to disable their ability to act like an infix operator). Or use the fact that all Haskell functions are arity-1, but then you have to write <code>(map not) x</code> and your arithmetic example has to look like <code>(+ ((- 10) 1)) 2</code>. Back to the parentheses!</p>\n\n<p>The truth is that the prefix notation you're proposing <strong>isn't</strong> unambiguous. Haskell's normal function syntax (without operators) <strong>is</strong>; the rule is you <em>always</em> interpret a sequence of terms like <code>foo bar baz qux etc</code> as <code>((((foo) bar) baz) qux) etc</code> (where each of foo, bar, etc can be an identifier or a sub-term in parentheses). You use parentheses not to <em>disambiguate</em> that rule, but to group terms to impose a <em>different</em> call structure than that hard rule would give you.</p>\n\n<p>Infix operators <em>do</em> complicate that rule, and they <em>are</em> ambiguous without knowing something about the operators involved (their precedence and associativity, which unlike arity is associated with the <strong>name</strong> not the actual value referred to). Those complications were added to help make the code easier to understand; particularly for the arithmetic conventions most programmers are already familiar with (that <code>+</code> is lower precedence than <code>*</code>, etc).</p>\n\n<p>If you don't like the additional burden of having to memorise the precedence and associativity of operators (not an unreasonable position), you <em>are</em> free to use a notation that is unambiguous without needing precedence rules, but it has to be <strong>Haskell's</strong> prefix notation, not Polish prefix notation. And whatever syntactic convention you're using, in any language, you'll <strong>always</strong> have to use something like parentheses to indicate grouping where the call structure you need is different from what the standard convention would indicate. So:</p>\n\n<pre><code>(+) ((-) 10 1) 2\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>plus (minus 10 1) 2\n</code></pre>\n\n<p>if you define non-operator function names.</p>\n"}], "owner": {"reputation": 3108, "user_id": 3047729, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/xnWyL.png?s=128&g=1", "display_name": "Addem", "link": "https://stackoverflow.com/users/3047729/addem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2545, "favorite_count": 0, "accepted_answer_id": 42520057, "answer_count": 1, "score": 6, "last_activity_date": 1488321497, "creation_date": 1488313168, "last_edit_date": 1495541419, "question_id": 42518003, "link": "https://stackoverflow.com/questions/42518003/haskell-get-a-prefix-operator-that-works-without-parentheses", "title": "Haskell: Get a prefix operator that works without parentheses", "body": "<p>One big reason prefix operators are nice is that they can avoid the need for parentheses so that <code>+ - 10 1 2</code> unambiguously means <code>(10 - 1) + 2</code>.  The infix expression becomes ambiguous if parens are dropped, which you can do away with by having certain precedence rules but that's messy, blah, blah, blah.   </p>\n\n<p>I'd like to make Haskell use prefix operations but the only way I've seen to do that sort of trades away the gains made by getting rid of parentheses.  </p>\n\n<pre><code>Prelude&gt; (-) 10 1 \n</code></pre>\n\n<p>uses two parens.  </p>\n\n<p>It gets even worse when you try to compose functions because </p>\n\n<pre><code>Prelude&gt; (+) (-) 10 1 2 \n</code></pre>\n\n<p>yields an error, I believe because it's trying to feed the minus operation into the plus operations rather than first evaluating the minus and then feeding--so now you need even more parens!  </p>\n\n<p>Is there a way to make Haskell intelligently evaluate prefix notation?  I think if I made functions like </p>\n\n<pre><code>Prelude&gt; let p x y = x+y\nPrelude&gt; let m x y = x-y\n</code></pre>\n\n<p>I would recover the initial gains on fewer parens but function composition would still be a problem.  If there's a clever way to join this with <code>$</code> notation to make it behave at least close to how I want, I'm not seeing it.  If there's a totally different strategy available I'd appreciate hearing it.</p>\n\n<p>I tried reproducing what the accepted answer did here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28524471/haskell-get-rid-of-parentheses-in-liftm2\">Haskell: get rid of parentheses in liftM2</a></p>\n\n<p>but in both a Prelude console and a Haskell script, the import command didn't work.  And besides, this is more advanced Haskell than I'm able to understand, so I was hoping there might be some other simpler solution anyway before I do the heavy lifting to investigate whatever this is doing.</p>\n"}, {"tags": ["regex", "haskell", "pcre"], "comments": [{"owner": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "edited": false, "score": 0, "creation_date": 1488313145, "post_id": 42517879, "comment_id": 72172844, "body": "No. PCRE doesn&#39;t support any kind of character class operations like intersections."}, {"owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "reply_to_user": {"reputation": 43580, "user_id": 1020526, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/Scjj8.jpg?s=128&g=1", "display_name": "revo", "link": "https://stackoverflow.com/users/1020526/revo"}, "edited": false, "score": 0, "creation_date": 1488314039, "post_id": 42517879, "comment_id": 72173305, "body": "In some places I read it. Bad sources :) However I changed a bit the question. Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1488314002, "creation_date": 1488314002, "answer_id": 42518202, "question_id": 42517879, "link": "https://stackoverflow.com/questions/42517879/haskell-and-regex-with-intersections/42518202#42518202", "title": "Haskell and Regex with Intersections", "body": "<p>PCRE does not support character class intersection/subtraction.</p>\n\n<p>However, you may work around it with negative lookaheads and other methods.</p>\n\n<p>Here, replace <code>\"(\\\\d{1,2})([C-X&amp;&amp;[^IO]])([A-Z&amp;&amp;[^IO]])([A-Z&amp;&amp;[^IO]])(\\\\d{2,10})\"</code> with</p>\n\n<pre><code>\"(\\\\d{1,2})((?![IO])[C-X])((?![IO])[A-Z])((?![IO])[A-Z])(\\\\d{2,10})\"\n            ^^^^^^^^^^^^^  ^^^^^^^^^^^^^  ^^^^^^^^^^^^^\n</code></pre>\n\n<p>That is, replace the subtractions with lookaheads, <code>[C-X&amp;&amp;[^IO]]</code> -> <code>(?![IO])[C-X]</code>.</p>\n\n<p>Another way, that is more verbose, is to spell out the character classes:</p>\n\n<pre><code>\"(\\\\d{1,2})([C-HJ-NP-X])([A-HJ-NP-Z])([A-HJ-NP-Z])(\\\\d{2,10})\"\n</code></pre>\n\n<p>So, <code>[C-X]</code> that does not match <code>I</code> and <code>O</code> must be written as <code>[C-HJ-NP-X]</code>.</p>\n"}], "owner": {"reputation": 7296, "user_id": 324315, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/fbb413736c6866ac28a73a44ab56c6b5?s=128&d=identicon&r=PG&f=1", "display_name": "Randomize", "link": "https://stackoverflow.com/users/324315/randomize"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 42518202, "answer_count": 1, "score": 2, "last_activity_date": 1488314002, "creation_date": 1488312735, "last_edit_date": 1488313969, "question_id": 42517879, "link": "https://stackoverflow.com/questions/42517879/haskell-and-regex-with-intersections", "title": "Haskell and Regex with Intersections", "body": "<p>I am using regex with Haskell along with Text.Regex.PCRE and in my case I have:</p>\n\n<pre><code>Prelude Text.Regex.PCRE&gt; getAllTextMatches (\"32UMU1078\" =~ \"(\\\\d{1,2})([C-X&amp;&amp;[^IO]])([A-Z&amp;&amp;[^IO]])([A-Z&amp;&amp;[^IO]])(\\\\d{2,10})\" :: AllTextMatches [] String)\n[]\n</code></pre>\n\n<p>I am expecting some values returned but list is empty. However this returns what is expected:</p>\n\n<pre><code>Prelude Text.Regex.PCRE&gt; getAllTextMatches (\"32UMU1078\" =~ \"(\\\\d{1,2})([C-X])([A-Z])([A-Z])(\\\\d{2,10})\" :: AllTextMatches [] String)\n[\"32UMU1078\"]\n</code></pre>\n\n<p>So if I remove the intersections like <code>&amp;&amp;[^IO]</code> there are no problems.\nAs I just discovered PCRE doesn't support intersections. Any alternative library with Haskell that support it?</p>\n"}, {"tags": ["haskell", "ghc", "haskell-stack", "ghcjs", "hdevtools"], "comments": [{"owner": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "edited": false, "score": 0, "creation_date": 1488331925, "post_id": 42517497, "comment_id": 72180191, "body": "This has all of the hallmarks of a <code>stack</code> misconfiguration. Are you building <code>hdevtools</code> from source or are you using the <code>stack</code> global project to build <code>hdevtools</code>?"}, {"owner": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "edited": false, "score": 0, "creation_date": 1488331958, "post_id": 42517497, "comment_id": 72180197, "body": "Also, you don&#39;t <code>stack install ghc</code>. You could <code>stack build --install-ghc</code> to get the proper <code>ghc</code> version installed."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "edited": false, "score": 0, "creation_date": 1488347349, "post_id": 42517497, "comment_id": 72184462, "body": "@scootermefecit For all my other projects I just use <code>stack install hdevtools</code> and everything works wonderfully. I assume I can&#39;t use the global project, since <code>hdevtools</code> needs to know about local library installs? Or am I wrong on that? Also I tried <code>stack build --install-ghc</code> and it didn&#39;t change anything, still can&#39;t install or use <code>hdevtools</code>."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "edited": false, "score": 0, "creation_date": 1488347559, "post_id": 42517497, "comment_id": 72184552, "body": "@scootermefecit It does seem like hdevtools does have to be compiled with the same version/compiler as the files it is checking, so idk how to compile it with ghc then use it on what are essentially ghcjs files."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "edited": false, "score": 0, "creation_date": 1488347700, "post_id": 42517497, "comment_id": 72184627, "body": "Hmm this is confusing, when I do <code>--start-server</code> it will create the <code>.hevtools.sock</code> file (<code>ls</code> shows it), but it will be deleted very shortly after, (next <code>ls</code> doesn&#39;t show it)."}, {"owner": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "edited": false, "score": 0, "creation_date": 1489513819, "post_id": 42517497, "comment_id": 72700774, "body": "Keep in mind that the <code>stack</code>&#39; &quot;global&quot; configuration will do something similar to <code>cabal install</code>: fetch package from hackage, unpack, build, install. So, you&#39;re at the mercy of hackage in terms of whether the code you&#39;re building is current or close to current. Best bet (what I do): clone the appropriate git repo, then build within the cloned repo."}, {"owner": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "edited": false, "score": 0, "creation_date": 1489514261, "post_id": 42517497, "comment_id": 72701061, "body": "If you <code>ps</code>, is there a <code>hdevtools</code> process still running? If not, it likely died."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "edited": false, "score": 0, "creation_date": 1489538023, "post_id": 42517497, "comment_id": 72712607, "body": "I ended up figuring it out, but I totally forgot about this question and I don&#39;t think I remember how I fixed it."}], "owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488311233, "creation_date": 1488311233, "question_id": 42517497, "link": "https://stackoverflow.com/questions/42517497/how-do-i-use-hdevtools-with-ghcjs-within-stack", "title": "How do I use hdevtools with ghcjs within stack", "body": "<p>So it looks like hdevtools cannot be directly used with ghcjs. Using <code>stack install hdevtools</code> within a GHCJS stack project gives me:</p>\n\n<pre><code>Error: While constructing the build plan, the following exceptions were encountered:\n\nIn the dependencies for hdevtools-0.1.5.0:\n    ghc must match &gt;=7.2, but the stack configuration has no specified version\n\nPlan construction failed.\n</code></pre>\n\n<p>But since GHCJS and GHC should (I hope) both give the same errors and have the same types and things in scope for the same codebase. Then I would be happy if I also had GHC + dependencies simultaneously installed, purely for hdevtools (and perhaps for GHCI, as GHCJS doesn't support interpreted mode). Anyone know the best way to do this?</p>\n\n<p><code>stack install ghc</code> errors out purely with:</p>\n\n<pre><code>Error: While constructing the build plan, the following exceptions were encountered:\n\nPlan construction failed.\n</code></pre>\n\n<p>So that does not appear to be a solution.</p>\n\n<p>I would rather not switch back and forth every time I deploy or anything like that. But I also wouldn't completely rule it out.</p>\n"}, {"tags": ["haskell", "testing", "random", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1488309559, "post_id": 42516949, "comment_id": 72170951, "body": "<code>abs &lt;$&gt; arbitrary</code> can still yield <code>0</code>. You can use <code>positive = getPositive &lt;$&gt; arbitrary</code> to generate only positive numbers."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1488310557, "post_id": 42516949, "comment_id": 72171538, "body": "The generator for <code>xs</code> creates a list with at most 50 elements, not at least 50. For at least 50 elements, you could do something like <code>n &lt;- getNonNegative &lt;$&gt; arbitrary; xs &lt;- replicateM (n+50) (arbitrary `suchThat` (&#47;= x))</code>."}, {"owner": {"reputation": 111, "user_id": 4586632, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ef8a257abcede4daee9fba747dad5cc?s=128&d=identicon&r=PG&f=1", "display_name": "brander", "link": "https://stackoverflow.com/users/4586632/brander"}, "edited": false, "score": 0, "creation_date": 1488311056, "post_id": 42516949, "comment_id": 72171784, "body": "Thanks! Insightful.   Is there a way to guarantee xs contains 50 elements?  If I do something like nub.delete... <code>mygen = do      x &lt;- getPositive &lt;$&gt; arbitrary     xs &lt;- nub.delete x &lt;$&gt; replicateM 50 (getPositive &lt;$&gt; arbitrary)     return (x, xs)</code>  returns fairly small lists <code>(1,[1,2,3]) (2,[2,1,3]) (1,[4,1,3,2]) (4,[3,2,1,6,5,4]) (7,[1,2,8,6,5,7,4,3])</code>  because many of the elements are thrown out..."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 111, "user_id": 4586632, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ef8a257abcede4daee9fba747dad5cc?s=128&d=identicon&r=PG&f=1", "display_name": "brander", "link": "https://stackoverflow.com/users/4586632/brander"}, "edited": false, "score": 0, "creation_date": 1488316289, "post_id": 42516949, "comment_id": 72174494, "body": "@brander, hm, you might be able to use a smaller-scoped <code>suchThat</code> for that.  Say <code>(getPositive &lt;$&gt; arbitrary) `suchThat` (`notElem` alreadyGenerated)</code> -- recursively with <code>alreadyGenerated</code> as the accumulator."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 6, "last_activity_date": 1488310071, "last_edit_date": 1488310071, "creation_date": 1488309215, "answer_id": 42516949, "question_id": 42516835, "link": "https://stackoverflow.com/questions/42516835/how-to-efficiently-generate-random-tests-in-haskell-test-quickcheck/42516949#42516949", "title": "How to efficiently generate random tests in Haskell Test.QuickCheck", "body": "<p>Yeah, assuming the probability that a generated number is positive is 1/2, then the probability of getting a list of 50 positive numbers is (1/2)^50, or 1 in 1,125,899,906,842,624.  So yeah, that's not gonna happen. </p>\n\n<p>Instead of generating lists and filtering them, I would suggest building lists you need by transforming generators.</p>\n\n<pre><code>mygen :: Gen (Int, [Int])\nmygen = do \n    x &lt;- getPositive &lt;$&gt; arbitrary\n    xs &lt;- delete x &lt;$&gt; replicateM 50 (getPositive &lt;$&gt; arbitrary)\n    return (x, xs)\n</code></pre>\n\n<p>Now you are guaranteed to get a list matching your criteria immediately.</p>\n\n<p>As for uniqueness, see <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html#v:nub\" rel=\"nofollow noreferrer\"><code>Data.List.nub</code></a>.  You might also consider using a <a href=\"https://hackage.haskell.org/package/containers-0.5.10.1/docs/Data-Set.html\" rel=\"nofollow noreferrer\"><code>Data.Set</code></a>, since it seems you are using it that way.</p>\n"}], "owner": {"reputation": 111, "user_id": 4586632, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/1ef8a257abcede4daee9fba747dad5cc?s=128&d=identicon&r=PG&f=1", "display_name": "brander", "link": "https://stackoverflow.com/users/4586632/brander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1488310071, "creation_date": 1488308793, "last_edit_date": 1488309767, "question_id": 42516835, "link": "https://stackoverflow.com/questions/42516835/how-to-efficiently-generate-random-tests-in-haskell-test-quickcheck", "title": "How to efficiently generate random tests in Haskell Test.QuickCheck", "body": "<p>I'd like to generate some sample tests using Haskell Test.QuickCheck</p>\n\n<p>The goal is to generate data of (Int, [Int]) with the following conditions where the tuple is (x, xs):</p>\n\n<ol>\n<li>x > 0</li>\n<li>x not in xs</li>\n<li>all xs >0</li>\n</ol>\n\n<p>Scratching my head and stumbling through the manual <a href=\"https://github.com/stackbuilders/quickcheck-manual\" rel=\"nofollow noreferrer\">https://github.com/stackbuilders/quickcheck-manual</a> after some time I can produce random lists meeting these requirements:</p>\n\n<pre><code>import Test.QuickCheck\nmygen = arbitrary::Gen (Int, [Int]))\nsample (mygen `suchThat` ( \\(x, xs)-&gt;( (x `notElem` xs) &amp;&amp; (x &gt; 0) &amp;&amp; (all (&gt;0) xs)&amp;&amp; (xs/=[]))))\n</code></pre>\n\n<p>Running the last line in the GHCI outputs something like:</p>\n\n<pre><code>(40,[19,35,27,29,45,1,17,28])\n(20,[3,9,11,12,15,8])\n(43,[76,102,106,71,24,2,29,101,59,48])\n(99,[5,87,136,131,22,22,133])\n(77,[11,14,55,47,78,15,14])\n...\n</code></pre>\n\n<p>Questions:</p>\n\n<ol>\n<li><p>How can this be done more efficiently since - I'm guessing- the function mygen creates a large sample set then filters out based on the <code>suchThat</code> criteria</p></li>\n<li><p>How can I indicate the list xs should be of a certain size. For example if I add <code>&amp;&amp; length xs &gt; 50</code> the program runs for a very long time. </p></li>\n<li><p>Guarantee that each element of xs is unique. I.e. avoid records like (99,[22,22])</p></li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 2, "creation_date": 1488308689, "post_id": 42516711, "comment_id": 72170499, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/8905272/convert-maybe-int-to-int-in-haskell\">Convert Maybe Int to Int in Haskell</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "edited": false, "score": 0, "creation_date": 1488310687, "post_id": 42516870, "comment_id": 72171603, "body": "Prelude.!!: index too large"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "edited": false, "score": 2, "creation_date": 1488310716, "post_id": 42516870, "comment_id": 72171623, "body": "Given that <code>!!</code> doesn&#39;t appear in this code at all, I have very few ideas about what to do. Is it possible that your original code should have been using <code>cb &lt; ce</code> as a condition, meaning I would use <code>cb &gt;= ce</code> for the base case?"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1488309236, "last_edit_date": 1488309236, "creation_date": 1488308929, "answer_id": 42516870, "question_id": 42516711, "link": "https://stackoverflow.com/questions/42516711/convert-maybe-int-to-int-in-a-complex-function-in-haskell/42516870#42516870", "title": "convert maybe int to int in a complex function in haskell", "body": "<p>Just use pattern matching. Here, I invert the comparison of <code>cb</code> and <code>ce</code> to get that out of the way for the more complicated case.</p>\n\n<pre><code>to_ref cb ce _ _ m | cb &gt; ce = m\n-- If we get to this case, we know cb &lt; ce\nto_ref cb ce rb re m = let ref = to_ref (cb+1) ce rb re m\n                           row = find_non_null_row cb rb re m\n                       in case row of\n                           Nothing -&gt; ref\n                           Just x -&gt; elim_all cb rb re x m : ref\n</code></pre>\n\n<p>You can also use the <code>maybe</code> function if you don't like the <code>case</code> expression.</p>\n\n<pre><code>to_ref cb ce rb re m = let ref = to_ref (cb+1) ce rb re m\n                           row_f x = elim_all cb rb re x m : ref\n                           row = find_non_null_row cb rb re m\n                       in maybe ref row_f row\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 1, "last_activity_date": 1488332377, "last_edit_date": 1488332377, "creation_date": 1488332049, "answer_id": 42521682, "question_id": 42516711, "link": "https://stackoverflow.com/questions/42516711/convert-maybe-int-to-int-in-a-complex-function-in-haskell/42521682#42521682", "title": "convert maybe int to int in a complex function in haskell", "body": "<p>My style would be to use <code>PatternGuards</code>.</p>\n\n<pre><code>to_ref :: Idx -&gt; Idx -&gt; Idx -&gt; Idx -&gt; Mat El -&gt; Mat El\nto_ref cb ce rb re m\n     | cb &lt;= ce, Just row &lt;- find_non_null_row cb rb re m \n         = elim_all cb rb re row m : to_ref (cb+1) ce rb re m\n     | cb &lt;= ce \n         = to_ref (cb+1) ce rb re m\n     | otherwise = m\n</code></pre>\n\n<p>List comprehensions actually seem to fit quite well</p>\n\n<pre><code>to_ref cb0 ce rb re m = newItems ++ m\n   where \n   newItems = [ elim_all cb rb re row m \n              | cb &lt;- [cb0..ce]\n              , Just row &lt;- find_non_null_row cb rb re m\n              ]\n</code></pre>\n\n<p>assuming I did that refactor right...</p>\n"}, {"tags": [], "owner": {"reputation": 3350, "user_id": 6112457, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ZRj0Z.jpg?s=128&g=1", "display_name": "Zoey Hewll", "link": "https://stackoverflow.com/users/6112457/zoey-hewll"}, "is_accepted": false, "score": 1, "last_activity_date": 1488334186, "creation_date": 1488334186, "answer_id": 42521968, "question_id": 42516711, "link": "https://stackoverflow.com/questions/42516711/convert-maybe-int-to-int-in-a-complex-function-in-haskell/42521968#42521968", "title": "convert maybe int to int in a complex function in haskell", "body": "<p>The three guards you're currently using could be separated into two guards and a case expression (to unwrap the <code>Maybe</code>). I've also abstracted away some of the repeated computations with a <code>let</code></p>\n\n<pre><code>to_ref :: Idx -&gt; Idx -&gt; Idx -&gt; Idx -&gt; Mat El -&gt; Mat El\nto_ref cb ce rb re m\n    | cb &lt;= ce =\n        let\n            ref = to_ref (cb + 1) ce rb re m\n            row = find_non_null_row cb rb re m\n        in case row of\n            Nothing -&gt; ref\n            Just x -&gt; elim_all cb rb re x m : ref\n    | otherwise = m\n</code></pre>\n"}], "owner": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "accepted_answer_id": 42516870, "answer_count": 3, "score": 1, "last_activity_date": 1488334186, "creation_date": 1488308431, "last_edit_date": 1488308825, "question_id": 42516711, "link": "https://stackoverflow.com/questions/42516711/convert-maybe-int-to-int-in-a-complex-function-in-haskell", "title": "convert maybe int to int in a complex function in haskell", "body": "<p>I have such a function:</p>\n\n<pre><code>to_ref :: Idx -&gt; Idx -&gt; Idx -&gt; Idx -&gt; Mat El -&gt; Mat El\nto_ref cb ce rb re m\n     | cb &lt;= ce &amp;&amp; (find_non_null_row cb rb re m) == Nothing = (to_ref (cb+1) ce rb re m)\n     | cb &lt;= ce &amp;&amp; (find_non_null_row cb rb re m) /= Nothing = (elim_all cb rb re (find_non_null_row cb rb re m) m) : (to_ref (cb+1) ce rb re m)\n     | otherwise = m\n</code></pre>\n\n<p>In <code>(elim_all cb rb re (find_non_null_row cb rb re m) m) : (to_ref (cb+1) ce rb re m)</code>, <code>(find_non_null_row cb rb re m)</code> returns a <code>Maybe Int</code> type value, but I need it as <code>Int</code> type to make my code work.</p>\n\n<p>I have checked this post, <code>http://stackoverflow.com/questions/8905272/convert-maybe-int-to-int-in-haskell</code>, but I couldn't fit the solution to my issue.</p>\n\n<p>How can I convert it to <code>Int</code> in the most efficient way?</p>\n"}, {"tags": ["haskell", "records", "template-haskell", "lenses"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1488306971, "post_id": 42516064, "comment_id": 72169591, "body": "Do you want to update it based on the value of the label or based on the position in this tree"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1488307088, "post_id": 42516064, "comment_id": 72169661, "body": "And what do you expect to happen if there are more than one <code>Bar 5</code>"}], "answers": [{"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1488308836, "post_id": 42516725, "comment_id": 72170591, "body": "It seems that <code>transformOn</code> and <code>transformOnOf</code> would allow working directly on the <code>Foo</code> value."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1488309199, "post_id": 42516725, "comment_id": 72170765, "body": "@danidiaz Yep, <code>transformOn</code> basically just runs <code>transform</code> inside a given lens: <code>transformOn s g = over s (transform g)</code>"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 5, "last_activity_date": 1488311715, "last_edit_date": 1488311715, "creation_date": 1488308453, "answer_id": 42516725, "question_id": 42516064, "link": "https://stackoverflow.com/questions/42516064/modify-haskell-nested-record-by-value/42516725#42516725", "title": "Modify Haskell nested record by value", "body": "<p>Yep, <code>lens</code> can do that. The <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Plated.html\" rel=\"nofollow noreferrer\"><code>Control.Lens.Plated</code></a> module contains tools for \"Scrap Your Boilerplate\"-style programming with self-similar structures like your <code>Bar</code>. The idea is seductively simple: you explain how to find the immediate children of a node (by writing a <code>Traversal' a a</code>) and the library recursively applies that traversal to the whole structure.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nimport Control.Lens    \n\ndata Bar = Bar { _lbl :: Int, _bars :: [Bar] } deriving (Show)\n\nmakeLenses ''Bar\n\ninstance Plated Bar where\n    plate = bars.traverse\n</code></pre>\n\n<p>(If you don't want to implement <code>plate</code> yourself, you can derive <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Data.html#t:Data\" rel=\"nofollow noreferrer\"><code>Data</code></a> and leave the <code>instance</code> empty.)</p>\n\n<p><a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Plated.html#v:transform\" rel=\"nofollow noreferrer\"><code>transform :: Plated a =&gt; (a -&gt; a) -&gt; a -&gt; a</code></a> takes a function which modifies a single node and applies it to the whole structure.</p>\n\n<pre><code>fiveToSix :: Bar -&gt; Bar\nfiveToSix = transform go\n    where go bar\n            | bar^.lbl == 5 = bar &amp; lbl .~ 6\n            | otherwise = bar\n</code></pre>\n\n<p>Using the example from your question:</p>\n\n<pre><code>ghci&gt; let bars = [Bar 1 [Bar 2 []], Bar 3 [Bar 4 [], Bar 5 []]]\nghci&gt; map fiveToSix bars\n[Bar 1 [Bar 2 []], Bar 3 [Bar 4 [], Bar 6 []]]\n</code></pre>\n\n<p>As another example, for funzies, let's use <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Plated.html#v:cosmos\" rel=\"nofollow noreferrer\"><code>cosmos</code></a> to pull all of the <code>Bar 5</code>s out of a <code>Bar</code>.</p>\n\n<pre><code>fives :: Bar -&gt; [Bar]\nfives = toListOf $ cosmos.filtered (views lbl (== 5))\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7637196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28ac05edf9ebd508c6df07017921e118?s=128&d=identicon&r=PG&f=1", "display_name": "clmn", "link": "https://stackoverflow.com/users/7637196/clmn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 653, "favorite_count": 0, "accepted_answer_id": 42516725, "answer_count": 1, "score": 4, "last_activity_date": 1488311715, "creation_date": 1488306077, "question_id": 42516064, "link": "https://stackoverflow.com/questions/42516064/modify-haskell-nested-record-by-value", "title": "Modify Haskell nested record by value", "body": "<p>Say I have a nested structure as follows:</p>\n\n<pre><code>data Bar = Bar { _id :: Integer, _bars :: [Bar] }\ndata Foo = Foo { _bars :: [Bar] }\n</code></pre>\n\n<p>And I have a <code>Foo</code> with a bunch of <code>Bars</code> with various <code>id</code>s:</p>\n\n<pre><code>foo = Foo [Bar 1 [Bar 2], Bar 3 [Bar 4, Bar 5]]\n</code></pre>\n\n<p>How do, perhaps using lenses, I modify <code>foo</code> such that <code>Bar 5</code> becomes <code>Bar 6</code>?</p>\n\n<p>I know I use <code>fclabels</code> to do something like this:</p>\n\n<pre><code>mkLabel ''Foo\nmkLabel ''Bar\nmodify bars (\\bars -&gt; ...) foo\n</code></pre>\n\n<p>But bars can be nested infinitely. How do I locate and modify the <code>Bar</code> with a specified ID?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 7941330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u7jCJ.jpg?s=128&g=1", "display_name": "F&#225;bio Roberto Teodoro", "link": "https://stackoverflow.com/users/7941330/f%c3%a1bio-roberto-teodoro"}, "edited": false, "score": 0, "creation_date": 1501271377, "post_id": 42521061, "comment_id": 77724300, "body": "This <code>getCurrentTime</code> return time in UTC or in local timezone? What timezone will the user see in the browser?"}, {"owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "reply_to_user": {"reputation": 427, "user_id": 7941330, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/u7jCJ.jpg?s=128&g=1", "display_name": "F&#225;bio Roberto Teodoro", "link": "https://stackoverflow.com/users/7941330/f%c3%a1bio-roberto-teodoro"}, "edited": false, "score": 1, "creation_date": 1501284942, "post_id": 42521061, "comment_id": 77728795, "body": "@frt You can test it with ghci, <code>import Data.Time</code> <code>getCurrentTime</code>. It will show us <code>2017-07-28 23:32:26.2083905 UTC</code> <code>it :: UTCTime</code>."}], "tags": [], "owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "is_accepted": true, "score": 4, "last_activity_date": 1488327400, "creation_date": 1488327400, "answer_id": 42521061, "question_id": 42514507, "link": "https://stackoverflow.com/questions/42514507/how-to-show-current-time-with-yesod-template-languages/42521061#42521061", "title": "How to show current time with Yesod Template languages?", "body": "<blockquote>\n  <p>In other words, you need to run the IO action outside of the template.</p>\n</blockquote>\n\n<p>That <em>outside</em> means the template's <em>handler</em>. So I would write like this.</p>\n\n<pre><code>-- Home.hs\ngetHomeR = do\n  time &lt;- liftIO getCurrentTime\n  defaultLayout $(widgetFile \"homepage\")\n\n-- homepage.hamlet\n&lt;h2&gt;#{show time}\n</code></pre>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 1, "accepted_answer_id": 42521061, "answer_count": 1, "score": 1, "last_activity_date": 1488327400, "creation_date": 1488300942, "last_edit_date": 1495540008, "question_id": 42514507, "link": "https://stackoverflow.com/questions/42514507/how-to-show-current-time-with-yesod-template-languages", "title": "How to show current time with Yesod Template languages?", "body": "<p>Since <a href=\"https://stackoverflow.com/questions/23318426/yesods-shakespearean-templates-hamlet-and-io\">IO can not be used inside Yesod Template</a>, how can I display a simple current time on a page?</p>\n\n<p>In my .hamlet file, something like:</p>\n\n<pre><code>&lt;h2&gt;\n #{show $ getCurrentTime } \n\ngetCurrentTime :: IO UTCTime\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1488295925, "post_id": 42512566, "comment_id": 72162724, "body": "<code>folded</code> will only work if you have data all of the same type. Lens cannot (easily) extract all members of a record into a sequence type if those members do not have the same type. You are probably looking for generics, e.g. <code>syb</code> or <code>GHC.Generics</code>. More importantly, there are already plenty of libraries for serializing and deserializing Haskell datatypes."}], "owner": {"reputation": 447, "user_id": 2812201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a5900e009117b30b90fb5bce64d6fd8e?s=128&d=identicon&r=PG&f=1", "display_name": "user2812201", "link": "https://stackoverflow.com/users/2812201/user2812201"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488295729, "creation_date": 1488295311, "last_edit_date": 1488295729, "question_id": 42512566, "link": "https://stackoverflow.com/questions/42512566/is-it-possible-to-do-lens-like-traverse-on-data", "title": "is it possible to do lens like traverse on data", "body": "<p>Say we have this following data definition</p>\n\n<pre><code>data Test = Test\n  { _intMember :: Int\n  , _strMember :: String\n  , _dblMember :: Double\n  }\n</code></pre>\n\n<p>I want to encode the data structure into a ByteString like this:</p>\n\n<pre><code>encode :: Test -&gt; ByteString\nencode test = pack $ show (test ^. intMember) `append` show (test ^. strMember) `append` show (test ^. dblMember)\n</code></pre>\n\n<p>Very straightforward. However, in reality I have a data with like 50 redords and it becomes really unpleasant quickly. What make it even worse is that I have dozens of data definitions like this one. It would be best if <code>toListOf</code> from the Lens library would work on the custom data but apparently a generic custom data is not <code>Getting</code> type that function works with. So my question is what is the best way to reduce boilerplate as much as I could? To make it simple, lets assume all records I need to deal with are instances of the <code>Show</code> class. Thanks for reading.</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 2, "creation_date": 1488295318, "post_id": 42512467, "comment_id": 72162265, "body": "What&#39;s the type of <code>elim_one</code>? What&#39;s <code>Mat El</code>?"}, {"owner": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1488295373, "post_id": 42512467, "comment_id": 72162314, "body": "type of elim_one is elim_one :: Idx -&gt; Idx -&gt; Idx -&gt;  Mat El -&gt; Mat El. Type of Mat El is [[]]."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1488295566, "post_id": 42512467, "comment_id": 72162461, "body": "Then shouldn&#39;t the type of <code>elim_all</code> be <code>elem_all :: Idx -&gt; Idx -&gt; Idx -&gt; Idx -&gt; Mat El -&gt; [Mat El]</code>?"}, {"owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "edited": false, "score": 1, "creation_date": 1488295604, "post_id": 42512467, "comment_id": 72162488, "body": "Well, then the cons operator expects one element (a list), buy you supply a list of lists?"}], "answers": [{"tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": false, "score": 2, "last_activity_date": 1488303078, "creation_date": 1488303078, "answer_id": 42515225, "question_id": 42512467, "link": "https://stackoverflow.com/questions/42512467/haskell-type-mismatch-error-in-recursion/42515225#42515225", "title": "haskell: type mismatch error in recursion", "body": "<p>So here is the line in question:</p>\n\n<pre><code>| otherwise = elim_one c r1b r2 m : elim_all c (r1b+1) r1e r2 m\n</code></pre>\n\n<p>Now you have said in your type signature that the result* of <code>elim_all</code> will be a <code>Mat El</code>, but in this line the result is a list (that is what the <code>(:)</code> operator forms).</p>\n\n<p>Without knowing more about what the <code>Mat</code> type does, my best guess is that you need to wrap the output of this case in a Type Constructor of <code>Mat</code>.</p>\n\n<hr>\n\n<p>* When the function is fully applied.</p>\n"}, {"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": true, "score": 2, "last_activity_date": 1488303091, "creation_date": 1488303091, "answer_id": 42515230, "question_id": 42512467, "link": "https://stackoverflow.com/questions/42512467/haskell-type-mismatch-error-in-recursion/42515230#42515230", "title": "haskell: type mismatch error in recursion", "body": "<p>Both <code>elim_one</code> and <code>elim_all</code> compute something of type <code>Mat E1</code>. But whatever this might be, since</p>\n\n<pre><code>(:) :: a -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>and for all types x, it holds that <code>x</code> is not the same as <code>[x]</code> you can never\nrelate the results of evaluation of <code>elim_one</code> and <code>elim_all</code>  with the <code>(:)</code> operator.</p>\n"}], "owner": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 42515230, "answer_count": 2, "score": 0, "last_activity_date": 1488311809, "creation_date": 1488295033, "last_edit_date": 1488311809, "question_id": 42512467, "link": "https://stackoverflow.com/questions/42512467/haskell-type-mismatch-error-in-recursion", "title": "haskell: type mismatch error in recursion", "body": "<p>I have such a recursive function;</p>\n\n<pre><code>elim_all :: Idx -&gt; Idx -&gt; Idx -&gt; Idx -&gt; Mat El -&gt; Mat El\nelim_all c r1b r1e r2 m\n     | r1b == r1e = elim_one c r1b r2 m\n     | otherwise = elim_one c r1b r2 m : elim_all c (r1b+1) r1e r2 m\n</code></pre>\n\n<p>elim_one function is;</p>\n\n<pre><code>elim_one :: Idx -&gt; Idx -&gt; Idx -&gt;  Mat El -&gt; Mat El\nelim_one c r1 r2 m = let val1 = ((m!!r1)!!c)\n                         val2 = ((m!!r2)!!c)\n                         row1 = (mulr r1 val2 m)!!r1\n                         row2 = (mulr r2 val1 m)!!r2\n                         nrow = zipWith (-) row1 row2\n                         matr = if r1 == r2\n                                     then m\n                                     else replacer r1 nrow m\n                      in matr\n</code></pre>\n\n<p>When I run it, I get the following error:</p>\n\n<pre><code>    Couldn't match type \u2018[El]\u2019 with \u2018Int\u2019\n    Expected type: [El]\n      Actual type: Mat El\n    In the first argument of \u2018(:)\u2019, namely \u2018elim_one c r1b r2 m\u2019\n    In the expression:\n      elim_one c r1b r2 m : elim_all c (r1b + 1) r1e r2 m\n</code></pre>\n\n<p>error still doesn't make sense to me. How can I fix the problem?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "edited": false, "score": 0, "creation_date": 1488291410, "post_id": 42511057, "comment_id": 72159338, "body": "How can be a basic recursion? Since I am new, I still couldn&#39;t fit any recursion to my issue :)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "edited": false, "score": 1, "creation_date": 1488291657, "post_id": 42511057, "comment_id": 72159519, "body": "@yusuf If <code>r1b==r1e</code>, you just remove one element. Otherwise (assuming <code>r1b&gt;r1e</code>) you remove <code>r1b</code> and then you recurse using <code>r1b+1</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "edited": false, "score": 1, "creation_date": 1488291745, "post_id": 42511057, "comment_id": 72159576, "body": "@yusuf For instance, this counts from <code>n</code> to <code>m</code>: <code>f n m | n==m = [n] | otherwise = n : f (n+1) m</code> -- the result is the same as <code>[n..m]</code> (for <code>m&gt;=n</code>). Use the same technique: handle <code>n</code> (<code>r1b</code>) and &quot;increment&quot; it in the recursive call."}, {"owner": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "edited": false, "score": 0, "creation_date": 1488294729, "post_id": 42511057, "comment_id": 72161824, "body": "what is wrong here?                                                                                 elim_all c r1b r1e r2 m      | r1b == r1e = elim_one c r1b r2 m      | otherwise = elim_one c r1b r2 m : elim_all c (r1b+1) r1e r2 m"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "edited": false, "score": 0, "creation_date": 1488302034, "post_id": 42511057, "comment_id": 72166954, "body": "The last part should probably be <code>| otherwise = elim_all c (r1b+1) r1e r2 (elim_one c r1b r2 m)</code>. I used <code>:</code> because I was working with lists, you don&#39;t need that."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1488291248, "creation_date": 1488291248, "answer_id": 42511057, "question_id": 42510886, "link": "https://stackoverflow.com/questions/42510886/using-loop-to-update-value-of-the-variables-in-haskell/42511057#42511057", "title": "using loop to update value of the variables in haskell", "body": "<p>Your first issue is an indentation problem. <code>in</code> must be indented more.</p>\n\n<p>However, I can't see why you are using <code>do</code> and <code>forM_</code>, since you are not working in a monadic context. I think this is simply wrong.</p>\n\n<p>If you want to perform multiple nested call to the removal function, either use basic recursion or exploit <code>foldl'</code>.</p>\n"}], "owner": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 42511057, "answer_count": 1, "score": 0, "last_activity_date": 1488291248, "creation_date": 1488290807, "question_id": 42510886, "link": "https://stackoverflow.com/questions/42510886/using-loop-to-update-value-of-the-variables-in-haskell", "title": "using loop to update value of the variables in haskell", "body": "<p>I have such a function:</p>\n\n<pre><code>elim_one :: Idx -&gt; Idx -&gt; Idx -&gt;  Mat El -&gt; Mat El\nelim_one c r1 r2 m = let val1 = ((m!!r1)!!c)\n                         val2 = ((m!!r2)!!c)\n                         row1 = (mulr r1 val2 m)!!r1\n                         row2 = (mulr r2 val1 m)!!r2\n                         nrow = zipWith (-) row1 row2\n                         matr = if r1 == r2\n                                     then m\n                                     else replacer r1 nrow m\n                      in matr\n</code></pre>\n\n<p>I want to call this function recursively by using the following function type:</p>\n\n<pre><code>elim_all :: Idx -&gt; Idx -&gt; Idx -&gt; Idx -&gt; Mat El -&gt; Mat El\n</code></pre>\n\n<p>For this reason, I wrote the following function:</p>\n\n<pre><code>elim_all c r1b r1e r2 m = forM_ [(r1b)..(r1e)] $ \\i -&gt; do\n                              let matr = m\n                              let m = elim_one c i r2 matr\n                            in m\n</code></pre>\n\n<p>But I get <code>parse error on input \u2018in\u2019</code> exception. How should I fix for loop?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["haskell", "tree", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1488289323, "post_id": 42510345, "comment_id": 72157850, "body": "What about two <code>Node</code>s?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488291565, "post_id": 42510345, "comment_id": 72159449, "body": "Enabling warnings with <code>-Wall</code> would have 1) signaled this at compile time instead of runtime, 2) pointed out the case(s) which are not matched. Highly recommended."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488291498, "post_id": 42510448, "comment_id": 72159402, "body": "No, it <i>is</i> an error! It is precisely what GHCi prints at runtime when pattern matching fails to find a matching case. The compile-time warning reads &quot;Pattern match(es) are non-exhaustive&quot;, the run-time error reads &quot;Non-exhaustive patterns in function &lt;name&gt;&quot;."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1488305066, "last_edit_date": 1488305066, "creation_date": 1488289552, "answer_id": 42510448, "question_id": 42510345, "link": "https://stackoverflow.com/questions/42510345/haskell-print-tree-data-non-exhaustive-patterns-in-function-tolist/42510448#42510448", "title": "Haskell - Print tree data: Non-exhaustive patterns in function toList", "body": "<p>It means that you can call <code>toList</code> with a value, and <strong>all your lines will fail to fire</strong>.</p>\n\n<p>This is the case when I call your script with <strong>two <code>Node</code>s</strong>: <code>toList (Node (Node x y) (Node z t))</code>. In that case all lines will fail. You probably want to add the line:</p>\n\n<pre><code>toList (Node (Node x y) (Node z t)) = (toList (Node x y))++(toList (Node x y))\n</code></pre>\n\n<p>or a bit shorter:</p>\n\n<pre><code>toList (Node a@(Node _ _) b@(Node _ _)) = (toList a)++(toList b)\n</code></pre>\n\n<p>another one is a <strong>single <code>Leaf</code></strong>: <code>toList (Leaf x)</code>:</p>\n\n<pre><code>toList (Leaf x) = [x]\n</code></pre>\n\n<p>This being said you make things overcomplicated. You can simply use two lines:</p>\n\n<pre><code>toList :: Tree a -&gt; [a]\ntoList (Leaf x) = [x]\ntoList (Node x y) = toList x ++ toList y\n</code></pre>\n\n<p>It is very easy to see that here all cases are covered since there are only two data constructors and we do not put pattern constraints on their arguments.</p>\n"}], "owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 42510448, "answer_count": 1, "score": 2, "last_activity_date": 1488305066, "creation_date": 1488289246, "last_edit_date": 1488289505, "question_id": 42510345, "link": "https://stackoverflow.com/questions/42510345/haskell-print-tree-data-non-exhaustive-patterns-in-function-tolist", "title": "Haskell - Print tree data: Non-exhaustive patterns in function toList", "body": "<p>I have a <code>tree</code> that is represented by a data structure: </p>\n\n<pre><code>data Tree a = Node (Tree a) (Tree a)| Leaf a\n\nt1 :: Tree Int\nt1 = (Node (Node (Leaf 23) (Leaf 42)) (Node (Leaf 19) (Leaf 65)))\n</code></pre>\n\n<p>Now I need to print the data of the leaves:</p>\n\n<pre><code>toList :: Tree a -&gt; [a]\ntoList (Node (Leaf a) (Leaf b))       = [a] ++ [b]\ntoList (Node (Leaf a) (Node x y))     = [a] ++ (toList (Node x y))\ntoList (Node (Node x y) (Leaf b))     = (toList (Node x y)) ++ [b]\n</code></pre>\n\n<p>Unfotunately I keep getting the error:</p>\n\n<blockquote>\n  <p>Non-exhaustive patterns in function toList</p>\n</blockquote>\n\n<p>However I am using parentheses. </p>\n\n<p>What have I done wrong?</p>\n"}, {"tags": ["haskell", "documentation-generation", "haddock"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1488288921, "post_id": 42509775, "comment_id": 72157533, "body": "Er, <code>cabal haddock</code> and done? \u2014 This question asks some rather different things, I think you should narrow it down to one subject lest it be closed as too broad."}, {"owner": {"reputation": 3138, "user_id": 293420, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9c3b60c19a6b0d7804413960bd251bd6?s=128&d=identicon&r=PG", "display_name": "lesolorzanov", "link": "https://stackoverflow.com/users/293420/lesolorzanov"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1488292575, "post_id": 42509775, "comment_id": 72160131, "body": "@leftaroundabout It is not just that. I tried and it only created one link to the main package I want a list of functions contained in the program like when I do :bro in ghci. Also I would like to know where to  dd this command in the setup file so that it is generated instead of me having to call cabal for each command individually. It is not that trivial. And I&#39;d say there are very poor and few examples on comment syntax to generate documentation."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1488293081, "post_id": 42509775, "comment_id": 72160486, "body": "Ah, now I see what&#39;s the issue (this is actually about module exports). Please edit so the answers can actually match the question, not just the comment to the question..."}, {"owner": {"reputation": 3138, "user_id": 293420, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9c3b60c19a6b0d7804413960bd251bd6?s=128&d=identicon&r=PG", "display_name": "lesolorzanov", "link": "https://stackoverflow.com/users/293420/lesolorzanov"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1488293258, "post_id": 42509775, "comment_id": 72160655, "body": "I am new to haskell so I am not familiar with terminology. I understan there is a main module, but I dont need it in the documentation. I have very simple files which dont even contain classes, just some types and functions, I don&#39;t know if I can document those. Can you help me rephrase the question?"}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1488294805, "last_edit_date": 1488294805, "creation_date": 1488294015, "answer_id": 42512106, "question_id": 42509775, "link": "https://stackoverflow.com/questions/42509775/haskell-haddock-automatic-documentation/42512106#42512106", "title": "Haskell haddock automatic documentation", "body": "<p>If you build an <em>executable</em>, like</p>\n\n<pre><code>module Main (main) -- this line is implicit if your module isn't named otherwise\n   where\n\n-- | Some important function that does most of the work\nfoo :: Bar -&gt; Baz\nfoo = ...\n\n-- Other definitions\n-- ...\n\n-- | The program you want to run.\nmain :: IO ()\nmain = ...\n\n-- ...\n</code></pre>\n\n<p>then Haddock assumes there's nothing public to actually document \u2013 after all, <code>main</code> is the only thing someone using that project actually gets to call, everything else is hidden!</p>\n\n<p>To generate also documentation for <code>foo</code>, you need to <em>export</em> it, either directly from the <code>Main</code> module or from another module where it's originally defined. The usual way to go is to put everything really interesting in some \u201cinternal\u201d modules, like</p>\n\n<pre><code>module Foo (foo, {- other stuff ... -}) where\n\n-- | Some important function that does most of the work\nfoo :: Bar -&gt; Baz\nfoo = ...\n\n-- Other definitions\n-- ... but not `main`\n</code></pre>\n\n<p>and for the executable only use an \u201cend user scratch-resistant plastic wrapper\u201d module</p>\n\n<pre><code>module Main (main) where\n\nimport Foo\n\nmain :: IO ()\nmain = ...\n</code></pre>\n\n<p>Then the documentation for <code>Foo</code> will contain the actually interesting Haskell API Haddocks. This will then look like</p>\n\n<blockquote>\n  <h2>Foo</h2>\n  \n  <p><strong><code>foo</code></strong> :: <code>Bar</code> -> <code>Baz</code><br>Some important function that does most of the work</p>\n</blockquote>\n\n<p>Actually, you'll want to write the documentation something like</p>\n\n<pre><code>-- | Transmogrify a bare bar into a zapcutted one\nfoo :: Bar -- ^ The bare input to transmogrify\n    -&gt; Baz -- ^ The zapcutted wrimch\n</code></pre>\n\n<p>yielding documentation looking like</p>\n\n<blockquote>\n  <h2>Foo</h2>\n  \n  <p><strong><code>foo</code></strong> ::</p>\n  \n  <ul>\n  <li><p><code>Bar</code> The bare input to transmogrify</p></li>\n  <li><p>-> <code>Baz</code> The zapcutted wrimch</p></li>\n  </ul>\n  \n  <p>Transmogrify a bare bar into a zapcutted one</p>\n</blockquote>\n\n<p>The Haddock for <code>Main</code> isn't really interesting, you might better put the information in some command-line help box.</p>\n\n<p>In the <code>project.cabal</code> file, you then need to classify <code>Foo</code> as belonging to the \u201clibrary\u201d part of the project, whereas <code>Main</code> is the executable part.</p>\n\n<p>Basically, Haddock is just for libraries, not for executables.</p>\n"}], "owner": {"reputation": 3138, "user_id": 293420, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9c3b60c19a6b0d7804413960bd251bd6?s=128&d=identicon&r=PG", "display_name": "lesolorzanov", "link": "https://stackoverflow.com/users/293420/lesolorzanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 1, "accepted_answer_id": 42512106, "answer_count": 1, "score": 0, "last_activity_date": 1488307424, "creation_date": 1488287763, "last_edit_date": 1488307424, "question_id": 42509775, "link": "https://stackoverflow.com/questions/42509775/haskell-haddock-automatic-documentation", "title": "Haskell haddock automatic documentation", "body": "<p>I have not been able to generate documentaion for haskell using haddock.</p>\n\n<p>So far I have not found any useful examples. The documentation has a lot of options and also I am not sure about the comment syntax so that documentation is correctly generated. </p>\n\n<p>I know that inside ghci I can call :bro for loaded files and it lists types and functions, I wish these functions could be documented with haddock even without comments. I don't know if this is possible.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1488286432, "post_id": 42509252, "comment_id": 72155864, "body": "Looks to me it is an indentation error: it things <code>putStrLn</code> is on the same line as <code>getContents</code>..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1488292709, "post_id": 42509252, "comment_id": 72160220, "body": "You have a tab character in your source code, making <code>putStrLn</code> be indented too much. Remove tabs, use spaces."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488293316, "post_id": 42509252, "comment_id": 72160704, "body": "GHC should really warn for this. There&#39;s already an open <a href=\"https://ghc.haskell.org/trac/ghc/ticket/12610\" rel=\"nofollow noreferrer\">bug ticket</a> for that."}], "answers": [{"tags": [], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "is_accepted": true, "score": 0, "last_activity_date": 1488391113, "creation_date": 1488391113, "answer_id": 42538777, "question_id": 42509252, "link": "https://stackoverflow.com/questions/42509252/trouble-shoot-a-haskell-program/42538777#42538777", "title": "Trouble shoot a Haskell program", "body": "<p>This is the line that you need to focus on:</p>\n\n<pre><code> In the expression: getContents putStrLn\n</code></pre>\n\n<p>This is haskell showing you how it views your code, but your code doesn't look like that.  This is almost always an indentation error.  Check that you don't have an extra space or a tab where it doesn't belong.</p>\n\n<p>As a suggestion when reading haskell type error messages there are three places to look, and you should scan all of them before fixating on a single one:</p>\n\n<ul>\n<li>The type signature information -- do your types really match?</li>\n<li>The expression information -- does the expression the compiler sees match your expectations, or do you need to add <code>$</code> or parens</li>\n<li>Is there a typo or indentation problem.</li>\n</ul>\n\n<p>I frequently feel my brain starting to overheat as I try to read through a really messy <code>Couldn't match expected type</code> so before I get too upset over trying to read that part of the error message I carefully check the <code>In the expression:</code> part to make sure that there is an easy to fix issue with how I entered the code.</p>\n"}], "owner": {"reputation": 1627, "user_id": 5964853, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/502f299d16be599d15334e99a5581705?s=128&d=identicon&r=PG&f=1", "display_name": "Srinivas", "link": "https://stackoverflow.com/users/5964853/srinivas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 42538777, "answer_count": 1, "score": 1, "last_activity_date": 1488391113, "creation_date": 1488286290, "question_id": 42509252, "link": "https://stackoverflow.com/questions/42509252/trouble-shoot-a-haskell-program", "title": "Trouble shoot a Haskell program", "body": "<p>Can anyone tell me what is the problem with this Haskell program</p>\n\n<pre><code>import Control.Monad\nimport Data.Char\n\nmain = do  \n    contents &lt;- getContents  \n    putStrLn $ contents  \n    putStr $ \"shortLinesOnly version is \" ++ (shortLinesOnly contents)  \n    putStr $ \"printOnlyLessChars version is \" ++ (printOnlyLessChars contents)\nshortLinesOnly :: String -&gt; String  \nshortLinesOnly input =   \n    let allLines = lines input  \n        shortLines = filter (\\line -&gt; length line &lt; 10) allLines  \n        result = unlines shortLines  \n    in  result  \n\n--------------------the other way of doing this is -----------------\nprintOnlyLessChars contents = unlines $ filter (\\a -&gt; length a &lt; 10)  $ lines $ contents\n</code></pre>\n\n<p>The program works fine, but it fails when I try to print the contents (line 5). Why is it having problems printing the string via putStrLn</p>\n\n<p>The error message I get is</p>\n\n<pre><code>* Couldn't match expected type `(String -&gt; IO ())\n                                -&gt; t0 -&gt; IO String'\n              with actual type `IO String'\n* The function `getContents' is applied to one argument,\n  but its type `IO String' has none\n  In the expression: getContents putStrLn\n</code></pre>\n\n<p>Thanks,</p>\n"}, {"tags": ["haskell", "asynchronous", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 5, "last_activity_date": 1488275457, "creation_date": 1488275457, "answer_id": 42505357, "question_id": 42503446, "link": "https://stackoverflow.com/questions/42503446/yesod-withasync/42505357#42505357", "title": "Yesod, withAsync", "body": "<p>The API in the async package is <em>monomorphic</em>, meaning it works only for actions in <code>IO</code>. You're trying to use it in the <code>WidgetT</code> transformer type instead, which is where the error message is coming from. You can use the <a href=\"https://www.stackage.org/haddock/lts-8.3/lifted-async-0.9.1.1/Control-Concurrent-Async-Lifted.html\" rel=\"noreferrer\">lifted-async</a> package, which provides a polymorphic variant of the <code>withAsync</code> function. For the most part, this should just be a matter of:</p>\n\n<ol>\n<li>Import <code>Control.Concurrent.Async.Lifted</code></li>\n<li>Add <code>lifted-async</code> to your <code>build-depends</code></li>\n</ol>\n"}], "owner": {"reputation": 51, "user_id": 7634118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb67c4d4d8bda9f7239973b92d08a03?s=128&d=identicon&r=PG&f=1", "display_name": "L. Blommers", "link": "https://stackoverflow.com/users/7634118/l-blommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1488275457, "creation_date": 1488269809, "last_edit_date": 1488271918, "question_id": 42503446, "link": "https://stackoverflow.com/questions/42503446/yesod-withasync", "title": "Yesod, withAsync", "body": "<p>I'm a newbie to Haskell &amp; Yesod and I'm trying to use the <code>Control.Concurrent.Async</code> module to do stuff async. (the code is based on: <a href=\"https://hackage.haskell.org/package/async-2.1.1/docs/Control-Concurrent-Async.html#v:withAsync\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/async-2.1.1/docs/Control-Concurrent-Async.html#v:withAsync</a>)</p>\n\n<pre><code>quizWidget = do\n   --Get first question   \n    withAsync (showQuizItem 1 1 ) $ \\qi -&gt; do\n    withAsync (showScoreboard)    $ \\sb -&gt; do\n\n    quizItem &lt;- wait (qi)\n    scoreboard &lt;- wait (sb)\n\n    toWidget $(hamletFile \"hamlet/quiz.hamlet\")\n</code></pre>\n\n<p>But this produces the following error:</p>\n\n<blockquote>\n  <p>\"No instance for (MonadWidget IO) arising from a use of \u2018toWidget\u2019\".</p>\n</blockquote>\n\n<p>So the question is what am I doing wrong?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 104340, "user_id": 23649, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7e9f543f0ffdb7c9a899e628fe76e7f3?s=128&d=identicon&r=PG", "display_name": "jtbandes", "link": "https://stackoverflow.com/users/23649/jtbandes"}, "edited": false, "score": 0, "creation_date": 1488269107, "post_id": 42503017, "comment_id": 72144431, "body": "Which part is confusing?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1488269180, "post_id": 42503017, "comment_id": 72144455, "body": "Can you evaluate the last line by hand, or start by evaluating parts of it with the hrlp of ghci"}, {"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "edited": false, "score": 0, "creation_date": 1488269586, "post_id": 42503017, "comment_id": 72144660, "body": "One fun thing about this implementation is that it is productive on infinite lists, with sensible results, if you think about it in the right way.  <code>choose [1..] 3</code> == <code>[[1,2,3],[1,2,4],[1,2,5],[1,2,6],[1,2,7],..]</code>"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1488279831, "post_id": 42503017, "comment_id": 72151431, "body": "Pascal&#39;s Triangle!"}], "answers": [{"tags": [], "owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "is_accepted": false, "score": 4, "last_activity_date": 1488271954, "creation_date": 1488271954, "answer_id": 42504088, "question_id": 42503017, "link": "https://stackoverflow.com/questions/42503017/haskell-choose-l-n-function/42504088#42504088", "title": "Haskell - choose l n function", "body": "<p>The function prints all possible combinations given a list and number of elements for a combination. What the last line does is to apply this recursively given a non-empty list and a positive integer.</p>\n\n<p>First, let's look at this part:</p>\n\n<pre><code>(map (\\ys -&gt; x:ys) (choose xs (n-1)))\n</code></pre>\n\n<p>This uses the very first element as a kind of 'constant'. It first generates combinations of the other elements recursively, and then puts the 'constant' element at the head of each list generated as a result</p>\n\n<p>e.g. If input is [1,2,3] and 2 element combinations are needed, the function will be evaluated as follows:</p>\n\n<pre><code> choose [1,2,3] 2\n= choose (1:[2,3]) 2\n= (map (\\ys -&gt; 1:ys) (choose [2,3] 1)) ++ (choose [2,3] 2)\n\nchoose (2:[3]) 1\n= (map (\\ys -&gt; 2:ys) (choose [3] 0)) ++ (choose [3] 1)\n\n= [[2]] ++ [[3]]\n= [[2],[3]]\n</code></pre>\n\n<p>Because</p>\n\n<pre><code>choose 3:[] 1\n= (map (\\ys -&gt; 3:ys) (choose [] 0)) ++ (choose [] 1)\n= [[3]]\n</code></pre>\n\n<p>So, </p>\n\n<pre><code> choose (2:[3]) 1\n= (map (\\ys -&gt; 2:ys) ([[]])) ++ ([[3]])\n= [[2],[3]]\n</code></pre>\n\n<p>And therefore,</p>\n\n<pre><code> choose (1:[2,3]) 2\n= (map (\\ys -&gt; 1:ys) ([[2],[3]])) ++ (choose [2,3] 2)\n= [[1,2],[1,3]] ++ (choose [2,3] 2)\n</code></pre>\n\n<p>The second part in the above expression is nothing but <code>++ (choose xs n)</code> from the original definition. All it does is to repeat the above process with a smaller sublist of the original list. </p>\n\n<p>Continuing the example above, <code>choose [2,3] 2</code> evaluates to [[2,3]]</p>\n\n<p>Putting it all together, you end up with [[1,2],[1,3],[2,3]], which is the output you get.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1488273983, "last_edit_date": 1488273983, "creation_date": 1488271968, "answer_id": 42504101, "question_id": 42503017, "link": "https://stackoverflow.com/questions/42503017/haskell-choose-l-n-function/42504101#42504101", "title": "Haskell - choose l n function", "body": "<p>One can choose <code>n</code> elements from <code>x:xs</code> in two ways: either <code>x</code> is chosen, or it is not.</p>\n\n<p>If <code>x</code> is chosen, we are left with choosing <code>n-1</code> elements from <code>xs</code>. So, we recursively do <code>choose xs (n-1)</code> and then we add <code>x</code> on top with <code>map (\\ys -&gt; x:ys)</code>.</p>\n\n<p>If <code>x</code> is not chosen, we are left with choosing all the <code>n</code> elements form the tail <code>xs</code>. So, we consider <code>choose xs n</code>.</p>\n\n<p>Finally, we put together all such choices with <code>++</code>.</p>\n"}], "owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 977, "favorite_count": 0, "accepted_answer_id": 42504101, "answer_count": 2, "score": 0, "last_activity_date": 1488273983, "creation_date": 1488268252, "last_edit_date": 1488268987, "question_id": 42503017, "link": "https://stackoverflow.com/questions/42503017/haskell-choose-l-n-function", "title": "Haskell - choose l n function", "body": "<p>I have to write a function <code>choose l n</code> that prints a list of all possible combinations to choose <code>n</code> elements of a list <code>l</code>.</p>\n\n<p>As an example the call <code>choose [1,2,3] 2</code> returns <code>[[1,2], [1,3], [2,3]]</code> or <code>[[2,1], [3,1], [3,2]]</code></p>\n\n<p>Unfortunately I do not understand the solution: </p>\n\n<pre><code>choose :: [a] -&gt; Int -&gt; [[a]]\nchoose _ 0 = [[]]\nchoose [] _ = []\nchoose (x:xs) n = (map (\\ys -&gt; x:ys) (choose xs (n-1))) ++ (choose xs n)\n</code></pre>\n\n<p>I understand the first two statements. The last line is not clear to me. </p>\n\n<p>Can someone explain it, please?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 2, "creation_date": 1488262966, "post_id": 42501113, "comment_id": 72141358, "body": "This might well be a bug, which you <a href=\"https://ghc.haskell.org/trac/ghc/wiki/ReportABug\" rel=\"nofollow noreferrer\">should report</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1488274494, "post_id": 42501113, "comment_id": 72147738, "body": "This could be a limitation of the implementation. Usually this extension is needed because you want to define two identically-named fields in the same module. Doing so in different modules was already OK, since it can be disambiguated using qualified import. Probably other cases like the one above were simply not considered by the GHC devs."}], "answers": [{"tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": true, "score": 2, "last_activity_date": 1488311584, "creation_date": 1488311584, "answer_id": 42517583, "question_id": 42501113, "link": "https://stackoverflow.com/questions/42501113/exporting-duplicate-record-fields/42517583#42517583", "title": "Exporting duplicate record fields", "body": "<p>I did post a bug <a href=\"https://ghc.haskell.org/trac/ghc/ticket/13352\" rel=\"nofollow noreferrer\">here</a>. However, I also accidentally discovered a workaround:</p>\n\n<p>If I put the pragma in <em>either</em> Foo.hs or Bar.hs, GHC accepts the program. That is, the following compiles:</p>\n\n<pre><code>{-# LANGUAGE DuplicateRecordFields #-}\nmodule Foo(Foo(..)) where\ndata Foo = Foo {qux::Int}\n\nmodule Bar(Bar(..)) where\ndata Bar = Bar {qux::String}\n\nmodule Baz(Foo(..),Bar(..)) where\nimport Foo (Foo(..))\nimport Bar (Bar(..))\n</code></pre>\n"}], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 42517583, "answer_count": 1, "score": 5, "last_activity_date": 1488311584, "creation_date": 1488260902, "question_id": 42501113, "link": "https://stackoverflow.com/questions/42501113/exporting-duplicate-record-fields", "title": "Exporting duplicate record fields", "body": "<p>With <code>-XDuplicateRecordFields</code>, the following is allowed:</p>\n\n<pre><code>{-# LANGUAGE DuplicateRecordFields #-}\n\nmodule Baz(Foo(..), Bar(..)) where\ndata Foo = Foo {qux :: Int}    \ndata Bar = Bar {qux :: String}\n</code></pre>\n\n<p>However, I get a compile error when <code>Foo</code> is defined in a module <code>Foo</code> and <code>Bar</code> is defined in a module <code>Bar</code>:</p>\n\n<pre><code>{-# LANGUAGE DuplicateRecordFields #-}\n\nmodule Baz(Foo(..), Bar(..)) where\nimport Foo (Foo(..))\nimport Bar (Bar(..))\n</code></pre>\n\n<p><code>Conflicting exports for \u2018qux\u2019</code></p>\n\n<p>I think what I'm trying to do is equivalent to the first example; it shouldn't matter where the data types are originally defined. Is this sort of thing supported in GHC 8?</p>\n"}, {"tags": ["parsing", "haskell", "parsec"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1488258540, "post_id": 42500314, "comment_id": 72139659, "body": "The problem is that an <code>Application</code> will parse as some single <code>Expression</code> plus some leftover. You could instead parse per single <code>Expression</code> and then combine it into (left-associated) <code>Application</code>s: <code>parseExpression = foldl1 Application &lt;$&gt; (parseLambda &lt;|&gt; parseVar) `sepBy1` spaces</code>"}], "owner": {"reputation": 269, "user_id": 4038547, "user_type": "registered", "accept_rate": 18, "profile_image": "https://graph.facebook.com/100006406093905/picture?type=large", "display_name": "Rodrigo Stv", "link": "https://stackoverflow.com/users/4038547/rodrigo-stv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 783, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1488256654, "creation_date": 1488256654, "question_id": 42500314, "link": "https://stackoverflow.com/questions/42500314/haskell-parsec-parsing-application-in-lambda-calculus", "title": "Haskell, Parsec - Parsing application in lambda calculus", "body": "<p>I am writing a simple parser/interpreter for lambda calculus in Haskell.</p>\n\n<p>I am using the syntax \"/(x.x)\" for a lambda function, \"x\" for a name and \"f y\" for application, such that \"/(x.x) y\" is the application of identity to y and should return y.</p>\n\n<p>My strategy is to have a parser for names, lambda functions and applications. The name and function parsers work, but not the application parser. </p>\n\n<p>When I try to parse \"/(x.x) y\" it fails. It should try to parse the source as a name, as a lambda function, and after not being able to use both (because it would not parse all the source) try to parse it as an application and then succeed.</p>\n\n<p>My code is:</p>\n\n<pre><code>module Main where\n\nimport Text.ParserCombinators.Parsec\n\ndata Expression =\n  Var String\n  | Lambda Expression Expression\n  | Application Expression Expression\n  deriving Eq\n\ninstance Show Expression where\n  show (Var v) = v\n  show (Lambda v e) = \"/(\" ++ show v ++ \".\" ++ show e ++ \")\"\n  show (Application e1 e2) = \"\" ++ show e1 ++ \" \" ++ show e2 ++ \"\"\n\n-- Parser\n\nparseSource :: String -&gt; Expression\nparseSource source =\n  case parse (parseExpression &lt;* eof) \"\" source of\n    Right e -&gt; e\n    _ -&gt; error \"Parsing error\"\n\nparseExpression :: Parser Expression\nparseExpression =\n  parseVar &lt;|&gt; parseLambda &lt;|&gt; parseApplication\n\nparseVar :: Parser Expression\nparseVar = Var &lt;$&gt; many1 letter\n\nparseLambda :: Parser Expression\nparseLambda = do\n  _ &lt;- char '/'\n  _ &lt;- char '('\n  arg &lt;- parseVar\n  _ &lt;- char '.'\n  body &lt;- parseExpression\n  _ &lt;- char ')'\n  return $ Lambda arg body\n\nparseApplication :: Parser Expression\nparseApplication = do\n  e1 &lt;- parseExpression\n  _ &lt;- spaces\n  e2 &lt;- parseExpression\n  return $ Application e1 e2\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 853, "user_id": 3645112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QFHGj.jpg?s=128&g=1", "display_name": "Rainbacon", "link": "https://stackoverflow.com/users/3645112/rainbacon"}, "edited": false, "score": 0, "creation_date": 1488228420, "post_id": 42495196, "comment_id": 72130104, "body": "Your code works perfectly fine for me. Perhaps you&#39;re using it wrong. How are you calling it?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1488229547, "post_id": 42495196, "comment_id": 72130699, "body": "Are you sure you are using <code>putStrLn</code> like in the above code, and not <code>putStr</code>? It sounds like a buffering problem."}], "answers": [{"comments": [{"owner": {"reputation": 2861, "user_id": 2847643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmATO.jpg?s=128&g=1", "display_name": "user2847643", "link": "https://stackoverflow.com/users/2847643/user2847643"}, "edited": false, "score": 1, "creation_date": 1488233598, "post_id": 42495756, "comment_id": 72132732, "body": "AFAIK line buffering should be the default in all sane implementations when stdout is connected to a terminal. If this works I would still look for the root cause elsewhere."}, {"owner": {"reputation": 33, "user_id": 7631926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff130cb89f71bd0bedf9eebfb00a418?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/7631926/greg"}, "reply_to_user": {"reputation": 2861, "user_id": 2847643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmATO.jpg?s=128&g=1", "display_name": "user2847643", "link": "https://stackoverflow.com/users/2847643/user2847643"}, "edited": false, "score": 0, "creation_date": 1488238659, "post_id": 42495756, "comment_id": 72134661, "body": "This fixed it, thanks. and @user2847643, I&#39;ll look into it."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 5, "last_activity_date": 1488229554, "creation_date": 1488229554, "answer_id": 42495756, "question_id": 42495196, "link": "https://stackoverflow.com/questions/42495196/haskell-taking-input-during-runtime/42495756#42495756", "title": "Haskell - Taking input during runtime", "body": "<p>It is probably due to the default buffering on your system. Try explicitly setting the buffering modes to line buffering using <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/System-IO.html#v:hSetBuffering\" rel=\"noreferrer\">hSetBuffering</a>:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>main = do\n    hSetBuffering stdout LineBuffering\n    hSetBuffering stdin LineBuffering\n    putStrLn \"Hi, what's your name?\"  \n    name &lt;- getLine  \n    putStrLn (\"Hi \" ++ name)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7631926, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff130cb89f71bd0bedf9eebfb00a418?s=128&d=identicon&r=PG&f=1", "display_name": "Greg", "link": "https://stackoverflow.com/users/7631926/greg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 42495756, "answer_count": 1, "score": 3, "last_activity_date": 1488229720, "creation_date": 1488227411, "last_edit_date": 1488229720, "question_id": 42495196, "link": "https://stackoverflow.com/questions/42495196/haskell-taking-input-during-runtime", "title": "Haskell - Taking input during runtime", "body": "<p>I'm new to Haskell and I can't figure out how to accept input from the user during code execution. Say I type this code:</p>\n\n<pre><code>import System.IO\n\nmain = do  \n    putStrLn \"Hi, what's your name?\"  \n    name &lt;- getLine  \n    putStrLn (\"Hi \" ++ name)\n</code></pre>\n\n<p>Well, I want the text <code>\"Hi, what's your name?\"</code> to show up <em>before</em> I type in my name, then print the second line <code>\"Hi, name\"</code> <em>after</em> the user types their name.\nHowever, as it is right now, none of the text shows up until <em>after</em> I type my name. This makes the question redundant, since the question is not presented to the user until after they have answered it.</p>\n\n<p>I know this may be a noobish question, but I've been googling it for a long time with no success. Thanks for your time.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 7, "creation_date": 1488224935, "post_id": 42494451, "comment_id": 72128172, "body": "You&#39;re on the right track!  consider <code>foldr :: (x -&gt; y -&gt; x) -&gt; x -&gt; [y] -&gt; x</code>, now substitute <code>a -&gt; a</code> for <code>y</code>. What does <code>x</code> need to be? What&#39;s a good default value for the parameter of type <code>x</code>? What would the value of type <code>x -&gt; y -&gt; x</code> need to do?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1488224982, "post_id": 42494451, "comment_id": 72128204, "body": "<code>foldMap</code> (as in <code>compositeFunctions = appEndo . foldMap Endo</code>) conveys the <i>intent</i> better than <code>foldr</code> I think. (And is only a handful of characters longer than <code>foldr (.) id</code>)"}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1488325781, "post_id": 42494451, "comment_id": 72178607, "body": "Using <code>foldMap</code> is very obscure, imo."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 11, "last_activity_date": 1488224929, "creation_date": 1488224929, "answer_id": 42494505, "question_id": 42494451, "link": "https://stackoverflow.com/questions/42494451/is-it-possible-to-take-a-list-of-functions-and-return-a-function-which-is-their/42494505#42494505", "title": "Is it possible to take a list of functions and return a function which is their composite", "body": "<p><code>foldr</code> does exactly what you want, since <code>id</code> is the identity for <code>(.)</code> (i.e., <code>f . id == f</code>):</p>\n\n<pre><code>compose :: [(a -&gt; a)] -&gt; a -&gt; a\ncompose = foldr (.) id\n</code></pre>\n\n<p>In a more explicit recursive form:</p>\n\n<pre><code>compose' [] = id\ncompose' (f:fs) = f . compose' fs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 4, "creation_date": 1488226075, "post_id": 42494753, "comment_id": 72128820, "body": "Or more succinctly <code>compositeFunctions = appEndo . foldMap Endo</code>, as I mentioned in my comment."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1488233319, "post_id": 42494753, "comment_id": 72132556, "body": "You could also use the reducers package, it becomes something like <code>reduceWith appEndo</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1488234899, "post_id": 42494753, "comment_id": 72133311, "body": "Why doesn&#39;t <code>(a -&gt; a)</code> just have a Monoid instance itself? Why is using a newtype necessary?"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 3, "creation_date": 1488235521, "post_id": 42494753, "comment_id": 72133556, "body": "Because the function arrow also admits the similarly useful <code>instance Monoid m =&gt; Monoid (r -&gt; m)</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1488246038, "post_id": 42494753, "comment_id": 72136383, "body": "@JoachimBreitner That is one of the least known yet most useful instances of <code>Monoid</code>. I wish it were more advertised. :/"}], "tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": false, "score": 8, "last_activity_date": 1488225844, "creation_date": 1488225844, "answer_id": 42494753, "question_id": 42494451, "link": "https://stackoverflow.com/questions/42494451/is-it-possible-to-take-a-list-of-functions-and-return-a-function-which-is-their/42494753#42494753", "title": "Is it possible to take a list of functions and return a function which is their composite", "body": "<p>Functions of the form <code>a -&gt; a</code>, i.e. the argument and result have the same type, are known as <em>endomorphisms</em>. A really cool thing about endomorphisms for a given <code>a</code> is that they form a monoid with <code>id</code> as the identity and <code>(.)</code> as the operator. This means that <code>mconcat</code> should do exactly what you want... </p>\n\n<pre><code>compositeFunctions = mconcat\n</code></pre>\n\n<p>...unfortunately it's slightly more complicated. In order to get at the <code>Monoid</code> instance, you'll have to wrap your functions in the <code>Endo</code> newtype from <code>Data.Monoid</code> and then unwrap the result:</p>\n\n<pre><code>compositeFunctions = appEndo . mconcat . fmap Endo\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 7631748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e4e22062039aaa769da14d948c37a50?s=128&d=identicon&r=PG&f=1", "display_name": "the_bamboo", "link": "https://stackoverflow.com/users/7631748/the-bamboo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 2, "score": 9, "last_activity_date": 1488225844, "creation_date": 1488224687, "last_edit_date": 1488224823, "question_id": 42494451, "link": "https://stackoverflow.com/questions/42494451/is-it-possible-to-take-a-list-of-functions-and-return-a-function-which-is-their", "title": "Is it possible to take a list of functions and return a function which is their composite", "body": "<p>I was trying to figure out how to do something along the lines of </p>\n\n<pre><code>compositeFunctions :: [(a -&gt; a)] -&gt; (a -&gt; a)\n</code></pre>\n\n<p>I was thinking I could use <code>foldr</code> to continuously fold the list of functions over, but I can't figure anything out. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1488220980, "post_id": 42492989, "comment_id": 72126023, "body": "I&#39;m voting to close this question as off-topic because there is no attempt or prior effort."}], "answers": [{"tags": [], "owner": {"reputation": 853, "user_id": 3645112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QFHGj.jpg?s=128&g=1", "display_name": "Rainbacon", "link": "https://stackoverflow.com/users/3645112/rainbacon"}, "is_accepted": false, "score": 0, "last_activity_date": 1488221204, "last_edit_date": 1488221204, "creation_date": 1488220769, "answer_id": 42493369, "question_id": 42492989, "link": "https://stackoverflow.com/questions/42492989/haskell-change-all-indices-from-a-list-to-some-value/42493369#42493369", "title": "Haskell: change all indices from a list to some value", "body": "<p>You can define a helper function to replace a single value and then use it to fold over your list.</p>\n\n<pre><code>replaceAll :: a -&gt; [Int] -&gt; [a] -&gt; [a]\nreplaceAll repVal indices values = foldl (replaceValue repVal) values indices\n                            where replaceValue val vals index = (take index vals) ++ [val] ++ (drop (index + 1) vals)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 2, "last_activity_date": 1488221677, "creation_date": 1488221677, "answer_id": 42493622, "question_id": 42492989, "link": "https://stackoverflow.com/questions/42492989/haskell-change-all-indices-from-a-list-to-some-value/42493622#42493622", "title": "Haskell: change all indices from a list to some value", "body": "<p>Here is a beautiful version that uses <code>lens</code>:</p>\n\n<pre><code>import Control.Lens\n\nf :: a -&gt; [Int] -&gt; [a] -&gt; [a]\nf x is = elements (`elem` is) .~ x\n</code></pre>\n\n<p>Here is an efficient version that doesn't have any dependencies other than <code>base</code>. Basically, we start by sorting (and removing duplicates from the) indices list. That way, we don't need to scan the whole list for every replacement.</p>\n\n<pre><code>import Data.List\n\nf :: a -&gt; [Int] -&gt; [a] -&gt; [a]\nf x is xs = snd $ mapAccumR go is' (zip xs [1..])\n   where\n     is' = map head . group . sort $ is\n     go [] (y,_) = ([],y)\n     go (i:is) (y,j) = if i == j then (is,x) else (i:is,y)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1488223945, "last_edit_date": 1488223945, "creation_date": 1488222484, "answer_id": 42493836, "question_id": 42492989, "link": "https://stackoverflow.com/questions/42492989/haskell-change-all-indices-from-a-list-to-some-value/42493836#42493836", "title": "Haskell: change all indices from a list to some value", "body": "<p>Sort the indices first. Then you can traverse the two lists in tandem.</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\nimport Prelude (Eq, Enum, Num, Ord, snd, (==), (&lt;$&gt;))\nimport Data.List (head, group, sort, zip)\n\nf :: forall a. (Eq a, Enum a, Num a, Ord a) =&gt; a -&gt; [a] -&gt; [a] -&gt; [a]\nf replacement indices values =\n    go (head &lt;$&gt; group (sort indices)) (zip [0..] values)\n  where\n    go :: [a] -&gt; [(a, a)] -&gt; [a]\n    go []     vs                     = snd &lt;$&gt; vs\n    go _      []                     = []\n    go (i:is) ((i', v):vs) | i == i' = replacement : go is vs\n    go is     (v:vs)                 = snd v       : go is vs\n</code></pre>\n\n<p>The sorting incurs an extra <em>log</em> factor on the length of the index list, but the rest is linear.</p>\n"}], "owner": {"reputation": 499, "user_id": 2499255, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4e7eadea443aa4826cbd8bff34168551?s=128&d=identicon&r=PG", "display_name": "domoremath", "link": "https://stackoverflow.com/users/2499255/domoremath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1488224096, "creation_date": 1488219481, "last_edit_date": 1488221122, "question_id": 42492989, "link": "https://stackoverflow.com/questions/42492989/haskell-change-all-indices-from-a-list-to-some-value", "title": "Haskell: change all indices from a list to some value", "body": "<p>If I am given a list of objects and another list for some indices from this list, is there an easy way to change every object in this list with an index from the list of indices to a different value?</p>\n\n<p>E.g. I am hoping there exists some function f such that</p>\n\n<pre><code>f 0 [4,2,5] [6,5,8,4,3,6,2,7]\n</code></pre>\n\n<p>would output</p>\n\n<pre><code>[6,5,0,4,0,0,2,7]\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 4, "last_activity_date": 1488216730, "creation_date": 1488216730, "answer_id": 42492154, "question_id": 42492118, "link": "https://stackoverflow.com/questions/42492118/invalid-type-signature-tabelaprodutos/42492154#42492154", "title": "Invalid type signature: TabelaProdutos :: ...?", "body": "<p>Functions in Haskell must begin with a lowercase letter. Change the function name to <code>tabelaProdutos</code> and you should be fine.</p>\n"}], "owner": {"reputation": 67, "user_id": 5831174, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh4.googleusercontent.com/-9ZPl9P7x9y8/AAAAAAAAAAI/AAAAAAAAAGg/Xfw4TrmdWAw/photo.jpg?sz=128", "display_name": "Mar Oli", "link": "https://stackoverflow.com/users/5831174/mar-oli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 42492154, "answer_count": 1, "score": 1, "last_activity_date": 1488217297, "creation_date": 1488216648, "last_edit_date": 1488217297, "question_id": 42492118, "link": "https://stackoverflow.com/questions/42492118/invalid-type-signature-tabelaprodutos", "title": "Invalid type signature: TabelaProdutos :: ...?", "body": "<p>Can you help me to fiz this error? Thank you.\nDo not know why my Produto Type is not being recognized as a type for my function header ... Could you help me?</p>\n\n<pre><code>--\" Invalid type signature: TabelaProdutos :: ...\n-- Should be of form &lt;variable&gt; :: &lt;type&gt; \"\n\ntype Codigo     = Int\ntype Nome       = [Char]\ntype Preco      = Int\ntype Produtos   = [(Codigo, Nome, Preco)] -- Type Product defined here\ntype Carrinho   = [Codigo]\ntype Conta      = [(Nome, Preco)]\n\nTabelaProdutos :: Produtos          -- THE ERROR OCCURS IN THAT LINE\nTabelaProdutos =  [(001, \"Chocolate\", 121)\n                  ,(002, \"Biscoito\", 1010)\n                  ,(003, \"Laranja\", 56)\n                  ,(004, \"Sabao\", 21)\n                  ,(005, \"Batata Chips\", 133)\n                  ,(006, \"Doritos\", 450)\n                  ]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1488215973, "post_id": 42491823, "comment_id": 72123034, "body": "Won&#39;t this fail to compile in vanilla GHC anyways since you can&#39;t have overloaded record fields?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 2, "creation_date": 1488216163, "post_id": 42491823, "comment_id": 72123165, "body": "@jkeuhlen No. It creates a partial function <code>name :: Value -&gt; String</code> which fails with <code>*** Exception: No match in record selector name</code> on <code>name C</code>. You are thinking of records with shared fields in <i>different</i> datatypes."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1488216356, "post_id": 42491823, "comment_id": 72123278, "body": "You introduce the need for such boilerplate in your datatype definition. Instead you could write <code>data Value = AorB Bool String | C; getName (AorB _ x) = x; getName _ = Nothing</code>"}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1488216489, "post_id": 42491823, "comment_id": 72123359, "body": "@Alec thanks for the clarification!"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1488216870, "post_id": 42491823, "comment_id": 72123593, "body": "@user2407038 It is easy to do that refactor in a small toy example, but it won&#39;t always work so easily...."}], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1488216500, "post_id": 42491990, "comment_id": 72123364, "body": "Maybe you meant <code>A :: { name :: String } -&gt; Value String</code> and <code>B :: { name :: String } -&gt; Value String</code>? That way, <code>name :: Value String -&gt; String</code> is automatically generated for you."}, {"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1488216742, "post_id": 42491990, "comment_id": 72123504, "body": "@Alec: I&#39;ve tried such syntax on my GHC version 8.0.1 and it doesn&#39;t work. Maybe I&#39;m missing something?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1488216876, "post_id": 42491990, "comment_id": 72123595, "body": "Do you have <code>-XGADTs</code> enabled? If so, it should work (and has for already many GHC versions). See <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#generalised-algebraic-data-types-gadts\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1488217007, "post_id": 42491990, "comment_id": 72123675, "body": "This doesn&#39;t really solve the problem, rather it moves it to a different place. <code>Value String</code> is not isomorphic to the original type. You will still need a function of type <code>(exists x . Value x) -&gt; Maybe (Value String)</code>. If the OP could rely on always having a value of type <code>Value String</code> as opposed to <code>exists x . Value x</code> then they would not have written the <code>C</code> constructor in the first place."}], "tags": [], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "is_accepted": false, "score": 0, "last_activity_date": 1488216221, "creation_date": 1488216221, "answer_id": 42491990, "question_id": 42491823, "link": "https://stackoverflow.com/questions/42491823/safe-record-field-query/42491990#42491990", "title": "Safe Record field query", "body": "<p>Why don't you use a GADT? I do not know if you are interested in using only records. But, I fell that GADTs provide a clean solution to your problem, since you can restrict what constructors are valid by refining types.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\nmodule Teste where\n\n data Value a where\n    A :: String -&gt; Value String\n    B :: String -&gt; Value String\n    C :: Value ()\n\n name :: Value String -&gt; String\n name (A s) = s\n name (B s) = s\n</code></pre>\n\n<p>Notice that both <code>A</code> and <code>B</code> produce <code>Value String</code> values while <code>C</code> produces <code>Value ()</code>. When you define function </p>\n\n<pre><code>name :: Value String -&gt; String\n</code></pre>\n\n<p>it specifically says that you can only pass a value that has a string in it. So, you can only pattern match on <code>A</code> or <code>B</code> values. This is useful to avoid the need of <code>Maybe</code> in code.</p>\n"}, {"comments": [{"owner": {"reputation": 143, "user_id": 4077515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1130100597/picture?type=large", "display_name": "learnereveryday", "link": "https://stackoverflow.com/users/4077515/learnereveryday"}, "edited": false, "score": 0, "creation_date": 1555216369, "post_id": 42495322, "comment_id": 98029958, "body": "Benjamin, to use Lens, do we have to always start the field name with &#39;_&#39;? Why? Thanks!"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 143, "user_id": 4077515, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1130100597/picture?type=large", "display_name": "learnereveryday", "link": "https://stackoverflow.com/users/4077515/learnereveryday"}, "edited": false, "score": 1, "creation_date": 1555272222, "post_id": 42495322, "comment_id": 98043678, "body": "You don\u2019t have to! It\u2019s just the default naming convention that <code>makeLenses</code> recognises. You can configure it to match whatever naming convention you want, though."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 5, "last_activity_date": 1488227914, "creation_date": 1488227914, "answer_id": 42495322, "question_id": 42491823, "link": "https://stackoverflow.com/questions/42491823/safe-record-field-query/42495322#42495322", "title": "Safe Record field query", "body": "<p><a href=\"https://hackage.haskell.org/package/lens\" rel=\"noreferrer\"><code>lens</code></a>'s <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-TH.html\" rel=\"noreferrer\">Template Haskell helpers</a> do the right thing when they encounter partial record fields.</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\n\nimport Control.Applicative\nimport Control.Lens\n\n\ndata T = A { _name :: String }\n       | B { _name :: String }\n       | C\n\nmakeLenses ''T\n</code></pre>\n\n<p>This'll generate a <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Traversal.html#t:Traversal-39-\" rel=\"noreferrer\"><code>Traversal'</code></a> called <code>name</code> that selects the <code>String</code> inside the <code>A</code> and <code>B</code> constructors and does nothing in the <code>C</code> case.</p>\n\n<pre><code>ghci&gt; :i name\nname :: Traversal' T String  -- Defined at test.hs:11:1\n</code></pre>\n\n<p>So we can use <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Fold.html#v:-94--63-\" rel=\"noreferrer\">the <code>^?</code> operator</a> (which is a flipped synonym for <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Fold.html#v:preview\" rel=\"noreferrer\"><code>preview</code></a>) from <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Fold.html\" rel=\"noreferrer\"><code>Control.Lens.Fold</code></a> to pull out <code>Maybe</code> the name.</p>\n\n<pre><code>getName :: T -&gt; Maybe String\ngetName = (^? name)\n</code></pre>\n\n<p>You can also make <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Prism.html#t:Prism-39-\" rel=\"noreferrer\"><code>Prism'</code></a>s for the constructors of your datatype, and choose the first one of those which matches using <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Applicative.html#v:-60--124--62-\" rel=\"noreferrer\"><code>&lt;|&gt;</code></a>. This version is useful when the fields of your constructors have different names, but you do have to remember to update your extractor function when you add constructors.</p>\n\n<pre><code>makePrisms ''T\n\ngetName' :: T -&gt; Maybe String\ngetName' t = t^?_A &lt;|&gt; t^?_B\n</code></pre>\n\n<p><code>lens</code> is pretty useful!</p>\n"}], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 42495322, "answer_count": 2, "score": 2, "last_activity_date": 1488227914, "creation_date": 1488215710, "last_edit_date": 1488216028, "question_id": 42491823, "link": "https://stackoverflow.com/questions/42491823/safe-record-field-query", "title": "Safe Record field query", "body": "<p>Is there a clean way to avoid the following boilerplate:</p>\n\n<p>Given a Record data type definition....</p>\n\n<pre><code>data Value = A{ name::String } | B{ name::String } | C{}\n</code></pre>\n\n<p>write a function that safely returns <code>name</code></p>\n\n<pre><code>getName :: Value -&gt; Maybe String\ngetName A{ name=x } = Just x\ngetName B{ name=x } = Just x\ngetName C{} = Nothing\n</code></pre>\n\n<p>I know you can do this with Template Haskell, I am looking for a cleaner soln than that, perhaps a GHC extension or something else I've overlooked.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1488214491, "post_id": 42490912, "comment_id": 72122040, "body": "<code>map</code> expects a function of type <code>a -&gt; b</code>; you are providing one of type <code>a -&gt; b -&gt; c</code>."}], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1488216066, "post_id": 42491540, "comment_id": 72123099, "body": "what does not work? - the calculation of the gcd - or the reducer and in which way - does not compile or produces unexpected output - I think @chepner might have omitted one case <code>getGCD [x] = x</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1488216386, "last_edit_date": 1488216386, "creation_date": 1488214974, "answer_id": 42491540, "question_id": 42490912, "link": "https://stackoverflow.com/questions/42490912/dividing-all-haskell-array-values-with-their-gcd/42491540#42491540", "title": "dividing all haskell array values with their gcd", "body": "<p>The GCD of 3 or more numbers must be computed taking <em>all</em> numbers into account. The simplest way to do this is to compute the GCD of the tail of the list recursively, then compute the GCD of that value and the head. Since <code>gcd x 0 == x</code> for any x, we can define the base case to be 0. (Haskell's implementation of <code>gcd</code> also defines <code>gcd 0 0 == 0</code>.)</p>\n\n<pre><code>getGCD [] = 0\ngetGCD (x:rest) = gcd x (getGCD rest)\n</code></pre>\n\n<p>Once you have that, you can find the GCD of your list, then <em>divide</em> each number by the GCD.</p>\n\n<pre><code>reducer r = let gcd' = getGCD r\n            in map (\\x -&gt; div x gcd') r\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 661, "user_id": 1021134, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8724cd9cfab6d6818d3cf8c7f10400e5?s=128&d=identicon&r=PG", "display_name": "fredefox", "link": "https://stackoverflow.com/users/1021134/fredefox"}, "is_accepted": false, "score": 3, "last_activity_date": 1488215491, "creation_date": 1488215491, "answer_id": 42491742, "question_id": 42490912, "link": "https://stackoverflow.com/questions/42490912/dividing-all-haskell-array-values-with-their-gcd/42491742#42491742", "title": "dividing all haskell array values with their gcd", "body": "<p>GCD of multiple numbers:</p>\n\n<pre><code>gcd' = foldl gcd 0 :: (Integral b, Foldable t) =&gt; t b -&gt; b\n</code></pre>\n\n<p>Which you can then use to divide all numbers in the array:</p>\n\n<pre><code>div' xs = map (`div` g) xs\n  where\n    g = gcd' xs\n</code></pre>\n"}], "owner": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 42491540, "answer_count": 2, "score": 0, "last_activity_date": 1488216386, "creation_date": 1488213233, "question_id": 42490912, "link": "https://stackoverflow.com/questions/42490912/dividing-all-haskell-array-values-with-their-gcd", "title": "dividing all haskell array values with their gcd", "body": "<p>I have the following code</p>\n\n<pre><code>reducer :: Row El -&gt; Row El\nreducer r = let getGCD l = map (\\x y -&gt; gcd x y) l\n                gcd' = getGCD r\n                f = (\\x -&gt; map (\\y -&gt; y * gcd') x)\n             in (f (r))\n</code></pre>\n\n<p>in order to divide an array with its gcd.</p>\n\n<pre><code>reducer [8,8,12] :: Row Int\n-- &gt; [2,2,3]\n</code></pre>\n\n<p>but I couldn't manage to fit to <code>reducer :: Row El -&gt; Row El</code> function type, so basically code doesn't work.</p>\n\n<p>How can I fix it?</p>\n"}, {"tags": ["haskell", "syntax"], "comments": [{"owner": {"reputation": 1414, "user_id": 6564029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WxyK5.jpg?s=128&g=1", "display_name": "Michail", "link": "https://stackoverflow.com/users/6564029/michail"}, "edited": false, "score": 1, "creation_date": 1488213267, "post_id": 42490680, "comment_id": 72121254, "body": "The source of errors is that <code>+</code>&#39;s type signature is <code>Num a =&gt; a -&gt; a -&gt; a</code>, i.e. it returns value of the same type as its arguments. But you want it to produce a value of a different type than it&#39;s arguments (<code>b</code> against <code>a</code>s), which it simply cannot do."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1488213795, "post_id": 42490680, "comment_id": 72121596, "body": "You are actually being <i>less</i> specific about your types. <code>[a] -&gt; b</code> means you have no idea what type is being returned; the caller can specify anything they want. With <code>[a] -&gt; a</code>, you are at least saying that the return type must be the same as the type stored in the input list."}], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 3404378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fc7503cd12e59d0059cb39086363db7?s=128&d=identicon&r=PG", "display_name": "Travis Sunderland", "link": "https://stackoverflow.com/users/3404378/travis-sunderland"}, "is_accepted": false, "score": 0, "last_activity_date": 1488213302, "creation_date": 1488213302, "answer_id": 42490931, "question_id": 42490680, "link": "https://stackoverflow.com/questions/42490680/usage-of-symbol-on-haskell/42490931#42490931", "title": "Usage of &#39;=&gt;&#39; symbol on Haskell", "body": "<p>In the first code snippet, you're saying \"Take a list of <code>a</code>s (that are an instance of typeclass Num), and return something that's the same type as the elements in that list (that type is represented by <code>a</code> in the entire type signature).\"  That's what you want.</p>\n\n<p>The second snippet says \"Take a list of <code>a</code>s (that are an instance of typeclass Num), and return something of type <code>b</code>, a different type.\"  Since (+) returns the same type as its parameters, your function must as well.</p>\n\n<p>The <code>Num a</code> in your first snippet applies to all <code>a</code>s in the type signature, so there's no reason to split them into <code>a</code> and <code>b</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1488213389, "creation_date": 1488213389, "answer_id": 42490966, "question_id": 42490680, "link": "https://stackoverflow.com/questions/42490680/usage-of-symbol-on-haskell/42490966#42490966", "title": "Usage of &#39;=&gt;&#39; symbol on Haskell", "body": "<blockquote>\n  <p>Instead of using 'a' only i try to write my code like that.</p>\n</blockquote>\n\n<p>This doesn't work because <code>+</code> requires two arguments of the same type, and returns a result of that very type.</p>\n\n<pre><code>:t (+)\n(+) :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Since there's no way to add two <code>Integer</code>s and get back a <code>Double</code>, or add an <code>Integer</code> and a <code>Double</code>, there is also no way to sum a list of <code>Integer</code>s and get back a <code>Double</code>.</p>\n\n<p><code>Num a =&gt;</code> means that the type <code>a</code> must be a number. More precisely, it requires that there is an <em>instance</em> <code>Num a</code> of the <em>type class</em> <code>Num</code> exists.</p>\n\n<p>More info about type classes can be found <a href=\"http://learnyouahaskell.com/types-and-typeclasses\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 121, "user_id": 7630793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec96bab3afc3df4512ddbe8d3720f2e2?s=128&d=identicon&r=PG&f=1", "display_name": "No N", "link": "https://stackoverflow.com/users/7630793/no-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 42490966, "answer_count": 2, "score": 1, "last_activity_date": 1488213389, "creation_date": 1488212516, "question_id": 42490680, "link": "https://stackoverflow.com/questions/42490680/usage-of-symbol-on-haskell", "title": "Usage of &#39;=&gt;&#39; symbol on Haskell", "body": "<p>I am a newbie to haskell and have a working code below as follows.</p>\n\n<pre><code>sum' :: (Num a) =&gt; [a] -&gt; a\nsum' [] = 0  \nsum' (x:xs) = x + sum' xs \n</code></pre>\n\n<p>What i try to do is to be more specific about my types.Instead of using 'a' only i try to write my code like that.</p>\n\n<pre><code>sum' :: (Num a, Num b) =&gt; [a] -&gt; b\nsum' [] = 0  \nsum' (x:xs) = x + sum' xs \n</code></pre>\n\n<p>When i do is i get an error.Error is as follows: Couldn't match expected type \u2018b\u2019 with actual type \u2018a\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n          the type signature for sum' :: (Num a, Num b) => [a] -> b\n          at baby.hs:2:9\n      \u2018b\u2019 is a rigid type variable bound by\n          the type signature for sum' :: (Num a, Num b) => [a] -> b\n          at baby.hs:2:9</p>\n\n<p>I think i don't really understand the meaning of '=>'. The part confuses me is what comes before '=>'. Sometimes a thing like that '(Show a) =>' and usually just types just like in my code. Please help thanks in advance.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 4, "creation_date": 1488212871, "post_id": 42489932, "comment_id": 72121031, "body": "If your issue is with <code>MultiParamTypeClasses</code>, then clear that out of your head.  This is a pretty standard extension to enable.  The reason why these extensions exist is to allow different Haskell compilers to implement new behavior beyond the Haskell Standard, which can eventually become standard.  I&#39;ll note that the &quot;dilemmas&quot; linked to by <a href=\"https://prime.haskell.org/wiki/MultiParamTypeClasses\" rel=\"nofollow noreferrer\">prime.haskell.org/wiki/MultiParamTypeClasses</a> is an article last modified 11 years ago.  Since then it&#39;s become easier to work with."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1488212875, "post_id": 42489932, "comment_id": 72121035, "body": "Another one of your complaints is that you seemingly have to reimplement  the <code>getId</code> part multiple Times.  This is somewhat true without further techniques, and it comes down to how Haskell does name resolution.  You could look at the lens library, which solves a lot of these problems at the cost of several compiler extensions."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1488213100, "post_id": 42489932, "comment_id": 72121165, "body": "Modern Haskell code often uses a lot of language extensions. Don&#39;t be afraid to turn them on as needed. There are a few that should be avoided (like overlapping/incoherent instances, or the currently broken impredicative types), but many extensions are harmless."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488213302, "post_id": 42489932, "comment_id": 72121277, "body": "About &quot;a generic interface requires additional language support in the highly-touted type system in Haskell&quot; -- I can&#39;t follow this. Are you referring as &quot;additional language support&quot; the extension you had to turn on? It&#39;s one of the most well-known ones... we do not program in Haskell&#39;98 anymore."}, {"owner": {"reputation": 9966, "user_id": 171121, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63c0a0bf0ddd889a0ea8f78d1ea73b8a?s=128&d=identicon&r=PG", "display_name": "Dax Fohl", "link": "https://stackoverflow.com/users/171121/dax-fohl"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488213416, "post_id": 42489932, "comment_id": 72121354, "body": "@chi Yes, I&#39;m referring to the extension. Will update the question to be more explicit."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488214546, "post_id": 42489932, "comment_id": 72122070, "body": "Haskell type classes are actually rather different from C# interfaces."}, {"owner": {"reputation": 9966, "user_id": 171121, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63c0a0bf0ddd889a0ea8f78d1ea73b8a?s=128&d=identicon&r=PG", "display_name": "Dax Fohl", "link": "https://stackoverflow.com/users/171121/dax-fohl"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488214695, "post_id": 42489932, "comment_id": 72122193, "body": "@n.m. They have similarities and differences. That&#39;s the source of my confusion and the reason for my question."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488215414, "post_id": 42489932, "comment_id": 72122675, "body": "C# interfaces place constraints on <i>objects</i>. Haskell type classes place constraints on <i>types</i>. You probably won&#39;t see any difference until you encounter Haskell functions with more than one occurrence of the same type class in the signature."}], "answers": [{"comments": [{"owner": {"reputation": 9966, "user_id": 171121, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63c0a0bf0ddd889a0ea8f78d1ea73b8a?s=128&d=identicon&r=PG", "display_name": "Dax Fohl", "link": "https://stackoverflow.com/users/171121/dax-fohl"}, "edited": false, "score": 0, "creation_date": 1488220767, "post_id": 42492835, "comment_id": 72125897, "body": "Going with (1), I changed <code>Table</code> from a class to a record with <code>getRecords</code> and <code>setRecords</code> members: <code>data Table db a = Table { getRecords :: db -&gt; a, setRecords :: a -&gt; db -&gt; db }</code>. Then the CRUD ops just needed types changed to e.g. <code>deleteRecord :: Record r =&gt; Table Database [r] -&gt; Int -&gt; Database -&gt; Database</code>.  Finally the objects could be defined using lambdas: <code>bookTable = Table { getRecords = books, setRecords = \\records db -&gt; Database (employees db) records (customers db) }</code> and all compiled. Is this more idiomatic in Haskell?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488223184, "post_id": 42492835, "comment_id": 72127205, "body": "Option 4. Allow ambiguous types (and use type applications). This would be probably the worst option for this case, since there&#39;s a clear fundep here."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 3, "last_activity_date": 1488219727, "last_edit_date": 1488219727, "creation_date": 1488219014, "answer_id": 42492835, "question_id": 42489932, "link": "https://stackoverflow.com/questions/42489932/equivalent-to-c-generic-interface-in-haskell/42492835#42492835", "title": "Equivalent to C# generic interface in Haskell", "body": "<pre><code>deleteRecord :: (Table r t) =&gt; t -&gt; Int -&gt; Database -&gt; Database\n</code></pre>\n\n<p>This is a problem. There's an <code>r</code> before the <code>=&gt;</code> but no <code>r</code> after the <code>=&gt;</code>. Given a function call like <code>deleteRecord bookTable 1 db</code>, Haskell has no idea which <code>r</code> you are talking about. Though <code>r</code> should be completely determined by <code>t</code>, Haskell has no way of knowing that. Indeed, no one disallows these instance definitions:</p>\n\n<pre><code>instance Table Foo Bar\ninstance Table Foo Baz\ninstance Table Qux Bar\ninstance Table Qux Baz\n</code></pre>\n\n<p>There is nothing in the \"table\" types that could prevent this. They are just empty tags without any real data.</p>\n\n<p>The fact that there is only one instance of interest in your module is irrelevant, Haskell cannot guarantee anything about other modules.</p>\n\n<p>So what are your options here?</p>\n\n<ol>\n<li>Get rid of table types altogether. Record types could be enough.</li>\n<li>Use another Haskell extension, <code>FunctionalDependencies</code>.  </li>\n<li>Use yet another Haskell extension, <code>TypeFamilies</code>.</li>\n</ol>\n\n<p>The last two extensions allow for creation of generic containers among other things, which is what your database tables essentially are.</p>\n\n<p>Here's how <code>Table</code> type class would look with the first extension:</p>\n\n<pre><code>class Record r =&gt; Table r t | t -&gt; r where ...\n</code></pre>\n\n<p>The notation <code>t -&gt; r</code> means that <code>r</code> is completely determined by <code>t</code> (IOW <code>r</code> <em>functionally depends</em> on <code>t</code>). Once Haskell sees an instance <code>Table Foo Bar</code>, it knows there can be no instance <code>Table Qux Bar</code> (the compiler will signal an error should it see a conflicting definition). This way <code>deleteRecord</code> is well-formed. <code>r</code> is not in the signature but it's OK: <code>t</code> is known and <code>r</code> is a function of <code>t</code>.</p>\n\n<p>I let you figure out <code>TypeFamilies</code> by yourself. It's a more popular solution these days. <code>FunctionalDependencies</code> is an older extension, it is simple to understand but can lead to complications in some corner cases. Don't worry about them, you will be a master of Haskell before you see any. </p>\n"}], "owner": {"reputation": 9966, "user_id": 171121, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63c0a0bf0ddd889a0ea8f78d1ea73b8a?s=128&d=identicon&r=PG", "display_name": "Dax Fohl", "link": "https://stackoverflow.com/users/171121/dax-fohl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 42492835, "answer_count": 1, "score": 1, "last_activity_date": 1488219727, "creation_date": 1488210432, "last_edit_date": 1592644375, "question_id": 42489932, "link": "https://stackoverflow.com/questions/42489932/equivalent-to-c-generic-interface-in-haskell", "title": "Equivalent to C# generic interface in Haskell", "body": "<p>I'm trying to convert some simple C# code to Haskell.  So say I've got a simple immutable &quot;database&quot; type that is just a record with various list fields.  So, say</p>\n<pre><code>data Person = Person { }\ndata Book = Book { }\ndata Database = Database { employees :: [Person], books :: [Book], customers :: [Person] }\n</code></pre>\n<p>Now I want to create a typeclass that represents a &quot;view&quot;, or essentially a &quot;table&quot; of that DB.</p>\n<pre><code>class Table r t where -- r is the record type (e.g. Person or Book)\n  getRecords :: t -&gt; Database -&gt; [r]\n  setRecords :: t -&gt; [r] -&gt; Database -&gt; Database\n</code></pre>\n<p>Then I can create instances that represent each of those tables:</p>\n<pre><code>data ET = EmployeeTable\ninstance (Table Person) ET where\n  getRecords t db = employees db\n  setRecords t records db = Database records (books db) (customers db)\n</code></pre>\n<p>This is what I have, and it works, but only if <code>{-# LANGUAGE MultiParamTypeClasses #-}</code> is included.  Otherwise the definition of the Table typeclass fails.</p>\n<p>Not a big deal in itself: it compiles and works, but a quick read on <code>MultiParamTypeClasses</code> alludes to potential complications down the line (I haven't taken the time to fully grok them yet).</p>\n<p>The weird thing for me though is that this is very straightforward in C#.  Assuming simple immutable definitions of the record/DB class, it's simple to define the interface, and then the implementations follow without issue.</p>\n<pre><code>interface ITable&lt;TRecord&gt; {\n    TRecord[] GetRecords(Database db);\n    Database SetRecords(TRecord[] records, Database db);\n}\n</code></pre>\n<p>So really that's the essence of this question.  Is there a more idiomatic way to translate the functionality accorded by the above <code>ITable&lt;TRecord&gt;</code> interface from C# to Haskell?  My understanding is that C# interfaces are closest to Haskell typeclasses, so that's what I'm trying to do.  But I find it suprising that something as simple as a <em>generic</em> interface requires a language extension in the highly-touted type system in Haskell.</p>\n<p>(N.B. <em>why</em> do I want to do this?  The above is a bit simplified for brevity's sake, but in general, if I make the fleshed-out <code>Person</code> and <code>Book</code> instances of a <code>Record</code> typeclass that just has <code>getId</code>, then I can support CRUD functions for the whole database very generically: I only have to define these functions once for the Table typeclass, and they'll apply to all tables in the DB automatically.  Here's the full code a sample usage of it at the bottom, and its C# equivalent. <a href=\"https://gist.github.com/daxfohl/a785d1ff72b921d7e90b70f625191a1c\" rel=\"nofollow noreferrer\">https://gist.github.com/daxfohl/a785d1ff72b921d7e90b70f625191a1c</a>.  Note in Haskell <code>deleteRecord</code> doesn't compile either since the type of <code>r</code> cannot be deduced, whereas in C# it compiles fine. This adds to my thought that maybe <code>MultiParamTypeClasses</code> is not the right approach. But if not, then what <em>is</em>?)</p>\n<h1>Update</h1>\n<p>Okay it sounds from the comments like <code>MultiParamTypeClasses</code> is fine. So now my remaining question is how to fix the linked gist such that <code>deleteRecord</code> will compile?</p>\n"}, {"tags": ["list", "haskell", "duplicates"], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 3892813, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffe39aa9cddbd9d05ebe8601d47edb07?s=128&d=identicon&r=PG&f=1", "display_name": "Pavels", "link": "https://stackoverflow.com/users/3892813/pavels"}, "edited": false, "score": 0, "creation_date": 1488210726, "post_id": 42489950, "comment_id": 72119548, "body": "&quot;Because there is no mutation in Haskell, both accumulator lists are passed in as parameters to the helper function. &quot;  Please can you elaborate bit more on that?"}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "reply_to_user": {"reputation": 19, "user_id": 3892813, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffe39aa9cddbd9d05ebe8601d47edb07?s=128&d=identicon&r=PG&f=1", "display_name": "Pavels", "link": "https://stackoverflow.com/users/3892813/pavels"}, "edited": false, "score": 0, "creation_date": 1488210931, "post_id": 42489950, "comment_id": 72119693, "body": "You mentioned &quot;state variable&quot; in your original post, so it makes me think you have experience with imperative languages. The term &quot;variable&quot; in Haskell doesn&#39;t make much sense because all values are immutable. There is no &quot;state&quot; that can change, and functions can only return values based upon the values that were passed in as parameters."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 1, "last_activity_date": 1488210482, "creation_date": 1488210482, "answer_id": 42489950, "question_id": 42489878, "link": "https://stackoverflow.com/questions/42489878/why-does-this-remove-duplicate-function-in-haskell-has-two-arguments-instead-of/42489950#42489950", "title": "Why does this remove duplicate function in Haskell has two arguments instead of one?", "body": "<p><code>rdHelper</code> is a helper function that accumulates a list of those elements that were seen, as well as the remaining list of elements from the original list. Because there is no mutation in Haskell, both accumulator lists are passed in as parameters to the helper function, and it calls itself recursively.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 3892813, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffe39aa9cddbd9d05ebe8601d47edb07?s=128&d=identicon&r=PG&f=1", "display_name": "Pavels", "link": "https://stackoverflow.com/users/3892813/pavels"}, "edited": false, "score": 0, "creation_date": 1488211378, "post_id": 42490019, "comment_id": 72120011, "body": "Thanks Willem, your post explains everything."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1488221359, "last_edit_date": 1488221359, "creation_date": 1488210663, "answer_id": 42490019, "question_id": 42489878, "link": "https://stackoverflow.com/questions/42489878/why-does-this-remove-duplicate-function-in-haskell-has-two-arguments-instead-of/42490019#42490019", "title": "Why does this remove duplicate function in Haskell has two arguments instead of one?", "body": "<p>In order to remove duplicates, you need to somehow store what <strong>values you have already seen</strong>. That's why the variable is called <code>seen</code>. Initially in the recursion, you haven't seen any elements so <code>seen</code> is empty.</p>\n\n<p>Each time you <em>emit</em> a value however, you add it to the accumulator <code>seen</code>. Say for instance you call <code>removeDuplicates [1,2,3,1,4,2]</code>. Then it will be evaluated like:</p>\n\n<pre><code>removeDuplicates [1,2,3,1,4,2]\n    rdHelper [] [1,2,3,1,4,2]\n        (1 : rdHelper [1] [2,3,1,4,2])\n</code></pre>\n\n<p>so now <code>rdHelper</code> will be called and we know <code>1</code> is already emitted so we should filter it out. Next we perform:</p>\n\n<pre><code>removeDuplicates [1,2,3,1,4,2]\n    rdHelper [] [1,2,3,1,4,2]\n        (1 : rdHelper [1] [2,3,1,4,2])\n            (1 : 2 : rdHelper [1,2] [3,1,4,2])\n                (1 : 2 : 3 : rdHelper [1,2,3] [1,4,2])\n</code></pre>\n\n<p>So now we encouter a situation where <code>1</code> is in the head of the second list but because it is also an <code>elem</code> of <code>seen</code>, we will ignore that element.</p>\n\n<p>There is a bug in your code since <code>rdHelper</code> never emits something. Note furthermore that you can improve performance by adding to the head (adding to the head will not change the semantics of the program, but will make it run faster):</p>\n\n<pre><code>removeDuplicates :: Eq a => [a] -> [a] \nremoveDuplicates = rdHelper []     \n    where rdHelper seen [] = seen  \n          rdHelper seen (x:xs)\n              | x `elem` seen = rdHelper seen xs \n              | otherwise = <b>x : </b>rdHelper <b>(x:seen)</b> xs\n--                          ^emit element  ^add to head</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 3892813, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ffe39aa9cddbd9d05ebe8601d47edb07?s=128&d=identicon&r=PG&f=1", "display_name": "Pavels", "link": "https://stackoverflow.com/users/3892813/pavels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 42490019, "answer_count": 2, "score": 1, "last_activity_date": 1488221359, "creation_date": 1488210305, "question_id": 42489878, "link": "https://stackoverflow.com/questions/42489878/why-does-this-remove-duplicate-function-in-haskell-has-two-arguments-instead-of", "title": "Why does this remove duplicate function in Haskell has two arguments instead of one?", "body": "<p>help me understand why the function <code>removeDuplicates</code> has only one argument, but the function <code>rdHelper</code> that is under it has two? It works, and there are no errors trying it out on a list.</p>\n\n<pre><code>removeDuplicates :: Eq a =&gt; [a] -&gt; [a] \nremoveDuplicates = rdHelper []     \n    where rdHelper seen [] = seen  \n          rdHelper seen (x:xs)\n              | x `elem` seen = rdHelper seen xs \n              | otherwise = rdHelper (seen ++ [x]) xs\n</code></pre>\n\n<p>Perhaps its linked to state-variable? But I'm not sure what it is</p>\n"}, {"tags": ["list", "haskell", "concatenation", "addition"], "comments": [{"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 3, "creation_date": 1488201776, "post_id": 42486866, "comment_id": 72113249, "body": "I think you need parenthesis around the <code>x:xs</code> and <code>y:ys</code> pattern matches."}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1504683836, "post_id": 42486866, "comment_id": 79099542, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/8561762/haskell-parse-error-in-pattern\">Haskell: Parse error in pattern</a>"}], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 8, "last_activity_date": 1488201775, "creation_date": 1488201775, "answer_id": 42486900, "question_id": 42486866, "link": "https://stackoverflow.com/questions/42486866/haskell-list-operation-parse-error-in-pattern/42486900#42486900", "title": "Haskell - list operation: Parse error in pattern", "body": "<p>You need parentheses around your patterns. It should be <code>(x:xs)</code>, not <code>x:xs</code> on its own. That's what is causing the compiler confusion.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>addElements :: [Int] -&gt; [Int] -&gt; [Int]\naddElements [] [] = []\naddElements (x:xs) [] = x:xs\naddElements [] (y:ys) = y:ys\naddElements (x:xs) (y:ys) = [x+y] ++ addElements xs ys\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": false, "score": 1, "last_activity_date": 1488208346, "creation_date": 1488208346, "answer_id": 42489191, "question_id": 42486866, "link": "https://stackoverflow.com/questions/42486866/haskell-list-operation-parse-error-in-pattern/42489191#42489191", "title": "Haskell - list operation: Parse error in pattern", "body": "<p>Not an answer to the OP, but I just wanted to point out that the patterns can be simplified to:</p>\n\n<pre><code>addElements :: [Int] -&gt; [Int] -&gt; [Int]\naddElements xs [] = xs\naddElements [] ys = ys\naddElements (x:xs) (y:ys) = (x+y) : addElements xs ys\n</code></pre>\n"}], "owner": {"reputation": 3148, "user_id": 4125633, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7f4383d9ff9fd3d3e3b35694bae38e99?s=128&d=identicon&r=PG&f=1", "display_name": "jublikon", "link": "https://stackoverflow.com/users/4125633/jublikon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 550, "favorite_count": 0, "accepted_answer_id": 42486900, "answer_count": 2, "score": 1, "last_activity_date": 1488208346, "creation_date": 1488201676, "question_id": 42486866, "link": "https://stackoverflow.com/questions/42486866/haskell-list-operation-parse-error-in-pattern", "title": "Haskell - list operation: Parse error in pattern", "body": "<p>I am writing in <code>Haskell</code> a function that gets two lists of type <code>Int</code> and adds the values of one list to that one of the other. </p>\n\n<p>for example: <code>addElements [1,2,3] [4,5,6]</code> will give the output: <code>[5,7,9]</code></p>\n\n<p>my function so far: </p>\n\n<pre><code>addElements :: [Int] -&gt; [Int] -&gt; [Int]\naddElements [] [] = []\naddElements x:xs [] = x:xs\naddElements [] y:ys = y:ys\naddElements x:xs y:ys = [x+y] ++ addElements xs ys\n</code></pre>\n\n<p>I keep getting the error: </p>\n\n<blockquote>\n  <p>Parse error in pattern: addElements Failed, modules loaded: none</p>\n</blockquote>\n\n<p>I do not get any additional information - what have I done wrong?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 2, "last_activity_date": 1488209710, "creation_date": 1488209710, "answer_id": 42489671, "question_id": 42486437, "link": "https://stackoverflow.com/questions/42486437/yesod-new-data-type-definition-and-mapping/42489671#42489671", "title": "Yesod new data type definition and mapping", "body": "<blockquote>\n  <p>So in the best practice where should I declare the above data? In the Foundation.hs or Application.hs or elsewhere?</p>\n</blockquote>\n\n<p>I define it neither of the places. I usually create a new module for it and define the type there. But ultimately it boils down to personal taste. I don't recommend it doing it in <code>Foundation.hs</code> because that's a module where your master application type and it's instances for various Yesod related typeclasses reside on. Similary I would not add it in <code>Application.hs</code> because that's a module where your application's setting and the Wai <code>Application</code> related functions reside on. But that's just my taste. :-)</p>\n\n<blockquote>\n  <p>I will then create a database table with one of the column as this Status type. How is this mapped to my Postgresql backend? Which sql data type should correspond to this Status type?</p>\n</blockquote>\n\n<p>You can use <code>Status</code> algebric type to be define as it is. An example:</p>\n\n<pre><code>#!/usr/bin/env stack\n{- stack\n     --resolver lts-6.19\n     --install-ghc\n     runghc\n     --package persistent\n     --package aeson\n     --package persistent-postgresql\n     --package text\n     --package persistent-template\n     --package time\n     --package mtl\n-}\n\n{-# LANGUAGE EmptyDataDecls             #-}\n{-# LANGUAGE FlexibleContexts           #-}\n{-# LANGUAGE GADTs                      #-}\n{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n{-# LANGUAGE MultiParamTypeClasses      #-}\n{-# LANGUAGE OverloadedStrings          #-}\n{-# LANGUAGE QuasiQuotes                #-}\n{-# LANGUAGE TemplateHaskell            #-}\n{-# LANGUAGE FlexibleInstances#-}\n{-# LANGUAGE TypeFamilies               #-}\n\nimport           Database.Persist\nimport           Database.Persist.Postgresql\nimport           Database.Persist.TH\nimport           Control.Monad.IO.Class  (liftIO)\nimport           Control.Monad.Logger    (runStderrLoggingT)\nimport Data.Time\nimport Data.Text\nimport Data.Aeson\nimport ModelSum\n\nshare [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nUser\n    name Text\n    age Int\n    status Status\n    deriving Show\n|]\n\nconnStr = \"host=localhost dbname=test user=postgres password=postgres port=5432\"\n\nmain :: IO ()\nmain = mockMigration migrateAll\n</code></pre>\n\n<p>And the <code>ModelSum</code> file:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nmodule ModelSum where\n\nimport Database.Persist.TH\n\ndata Status\n  = Read\n  | Reviewed\n  | Learned\n  deriving (Show, Eq, Read)\n\nderivePersistField \"Status\"\n</code></pre>\n\n<p>On executing it, you get:</p>\n\n<pre><code>$ ./script.hs\nCREATe TABLE \"user\"(\"id\" SERIAL8  PRIMARY KEY UNIQUE,\"name\" VARCHAR NOT NULL,\"age\" INT8 NOT NULL,\"status\" VARCHAR NOT NULL)\n</code></pre>\n\n<p>You can see that the <code>status</code> column is created as\n<code>varchar</code>. Internally it performs the conversion using the <code>Show</code> and\n<code>Read</code> instances.</p>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 42489671, "answer_count": 1, "score": 1, "last_activity_date": 1488209710, "creation_date": 1488200403, "question_id": 42486437, "link": "https://stackoverflow.com/questions/42486437/yesod-new-data-type-definition-and-mapping", "title": "Yesod new data type definition and mapping", "body": "<p>In Yesod, I want to define a new data type:</p>\n\n<pre><code>data Status = Read | Reviewed | Learned\n</code></pre>\n\n<p>I'm using the Scaffold example. So in the best practice where should I declare the above data?  In the <code>Foundation.hs</code> or <code>Application.hs</code> or elsewhere?</p>\n\n<p>I will then create a database table with one of the column as this <code>Status</code> type.\nHow is this mapped to my Postgresql backend? Which sql data type should correspond to this <code>Status</code> type?</p>\n"}, {"tags": ["haskell", "lambda-calculus"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1488197671, "post_id": 42485055, "comment_id": 72110478, "body": "No, they are not isomorphic. What makes you think so?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1488199502, "post_id": 42485055, "comment_id": 72111749, "body": "If you happen to be familiar with category theory, <code>f :: forall a. F a -&gt; G a</code> can be seen as a family of functions which is <i>natural</i> on <code>a</code>: it is a natural transformation <code>F-&gt;G</code> (provided <code>F,G</code> are functors, as in this case)."}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488200448, "post_id": 42485055, "comment_id": 72112369, "body": "@n.m. Isn&#39;t <code>g(2) :: forall a. a</code> a sufficient reason ?"}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488200995, "post_id": 42485055, "comment_id": 72112716, "body": "@chi Indeed, my question originates from natural transformations, which is why I spoke of a family of functions. Do you know if typed lambda calculus has rules for distributing the type quantifiers when <code>F</code> or <code>G</code> is a constant functor ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1488201655, "post_id": 42485055, "comment_id": 72113181, "body": "Type quantifers can be swapped with arrows as in logic: the proposition <code>p -&gt; forall a. q(a)</code> is equivalent to <code>forall a. p -&gt; q(a)</code> provided <code>p</code> does not depend on <code>a</code>. If Haskell had existential types, we would have the isomorphism <code>(forall a. p(a) -&gt; q) ~ ((exists a. p(a)) -&gt; q)</code>. It commutes with products too <code>(forall a. p a, forall a. q a) ~ forall a. (p a, q a)</code>. On sums it&#39;s trickier."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488201865, "post_id": 42485055, "comment_id": 72113302, "body": "Hmm sorry my mistake, they probably are."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488201933, "post_id": 42485055, "comment_id": 72113351, "body": "By the way, just because two types are isomorphic, GHC does not have to identify them. (GHC does perform &quot;hoisting&quot; on <code>p -&gt; forall a. q(a)</code>, but the others isos I mentioned are not automatically done, even because they require impredicative polymorphism which is broken at the moment in GHC)."}, {"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488202107, "post_id": 42485055, "comment_id": 72113495, "body": "@chi Perfect, I hadn&#39;t thought of using Curry-Howard to interpret functions as implications. If you rewrite that as an answer, I&#39;ll accept it."}], "answers": [{"comments": [{"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 0, "creation_date": 1488199276, "post_id": 42485417, "comment_id": 72111593, "body": "How about with a typeclass constraint <code>(forall a. SomeClass a =&gt; a) -&gt; Int</code> ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 0, "creation_date": 1488200763, "post_id": 42485417, "comment_id": 72112548, "body": "@V.Semeria In such case, it may be possible to find a defined argument. E.g. if <code>SomeClass = Num</code>, then <code>42 :: Num a =&gt; a</code> is a valid argument."}], "tags": [], "owner": {"reputation": 1207, "user_id": 2884502, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d817ec525df88f7a149bc9186e1a31f3?s=128&d=identicon&r=PG&f=1", "display_name": "lightandlight", "link": "https://stackoverflow.com/users/2884502/lightandlight"}, "is_accepted": false, "score": 2, "last_activity_date": 1488197207, "creation_date": 1488197207, "answer_id": 42485417, "question_id": 42485055, "link": "https://stackoverflow.com/questions/42485055/type-quantifiers-in-haskell-functions/42485417#42485417", "title": "Type quantifiers in Haskell functions", "body": "<p><code>weird :: (forall a. a) -&gt; Int</code> is unnecessarily specific.</p>\n\n<p><code>undefined</code> is the only value that has type <code>forall a. a</code>, so the definiton would have to be <code>weird _ = someInteger</code>, which is just a more restrictive version of <code>const</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 0, "creation_date": 1488199768, "post_id": 42485892, "comment_id": 72111906, "body": "Thanks for explaining how GHC implements it behind the scenes. Do you know if this is a theoretical rule of typed lambda calculus too ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "edited": false, "score": 0, "creation_date": 1488199952, "post_id": 42485892, "comment_id": 72112028, "body": "Yeah, I think in System F it you&#39;d have expressions something like <code>\u039b a . (\u03bb (n:a) . X)</code> which kind of express the same thing, but I&#39;ve never really read into that."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1488213531, "post_id": 42485892, "comment_id": 72121429, "body": "The issue of constraints and type quantification are disjoint - a constraint can appear in a position not immediately to the right of a quantifier, e.g. <code>forall a . (C a =&gt; a) -&gt; X</code> vs. <code>forall a . C a =&gt; a -&gt; X</code>; even <code>(D =&gt; X) -&gt; Z</code> is a valid type. Both are implemented as function arguments in the core representation, but that is the case for quantified type variables for a deeply primitive reason about the type system (the formal semantics of System F omega), whereas for constraints it is simply an implementation detail."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1488225958, "post_id": 42485892, "comment_id": 72128740, "body": "@user2407038: sounds good. I&#39;d love to see it explained in proper detail, how about adding an answer?"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1488198704, "creation_date": 1488198704, "answer_id": 42485892, "question_id": 42485055, "link": "https://stackoverflow.com/questions/42485055/type-quantifiers-in-haskell-functions/42485892#42485892", "title": "Type quantifiers in Haskell functions", "body": "<p>A <code>\u2200 a .</code> is basically just an extra implicit argument, or rather, a specification of how type-constraints pertaining to that argument should be handled. For instance,</p>\n\n<pre><code>f :: \u2200 a . Show a =&gt; (a -&gt; Int)\ng :: \u2200 a . Show a =&gt; (Int -&gt; a)\n</code></pre>\n\n<p>are in essence functions of two arguments,</p>\n\n<pre><code>f' :: ShowDictionary a -&gt; a -&gt; Int\ng' :: ShowDictionary a -&gt; Int -&gt; a\n</code></pre>\n\n<p>or even dumber,</p>\n\n<pre><code>type GenericReference = Ptr Foreign.C.Types.Void -- this doesn't actually exist\n\nf'' :: (GenericReference -&gt; String) -&gt; GenericReference -&gt; Int\ng'' :: (GenericReference -&gt; String) -&gt; Int -&gt; GenericReference\n</code></pre>\n\n<p>Now, these are just monomorphic (or weak-dynamic typed) functions. We can clearly use <code>flip</code> on them to obtain</p>\n\n<pre><code>f''' :: GenericReference -&gt; (GenericReference -&gt; String) -&gt; Int\ng''' :: Int -&gt; (GenericReference -&gt; String) -&gt; GenericReference\n</code></pre>\n\n<p>The latter can simply be evaluated partially with any <code>Int</code> argument, hence <code>g</code> is indeed equivalent to <code>\u03b3 :: Int -&gt; (\u2200 a . Show a =&gt; Int -&gt; a)</code>.</p>\n\n<p>With <code>f'''</code>, applying it to some void-pointered argument would be a recipe to disaster, since there's no way for the type system to ensure that the actually passed type matches the one the <code>Show</code> function is prepared to handle.</p>\n"}, {"tags": [], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "is_accepted": false, "score": 0, "last_activity_date": 1488229162, "creation_date": 1488229162, "answer_id": 42495660, "question_id": 42485055, "link": "https://stackoverflow.com/questions/42485055/type-quantifiers-in-haskell-functions/42495660#42495660", "title": "Type quantifiers in Haskell functions", "body": "<p>This is a copy of Chi's comment above, it explains the theoretical part by interpreting functions as logical implications (Curry-Howard correspondence) :</p>\n\n<blockquote>\n  <p>Type quantifers can be swapped with arrows as in logic: the\n  proposition <code>p -&gt; forall a. q(a)</code> is equivalent to <code>forall a. p -&gt; q(a)</code>\n  provided <code>p</code> does not depend on <code>a</code>. If Haskell had existential types, we\n  would have the isomorphism <code>(forall a. p(a) -&gt; q) ~ ((exists a. p(a))\n  -&gt; q)</code>. It commutes with products too <code>(forall a. p a, forall a. q a) ~ forall a. (p a, q a)</code>. On sums it's trickier.</p>\n</blockquote>\n\n<p>I also link the specs of <a href=\"https://prime.haskell.org/wiki/RankNTypes\" rel=\"nofollow noreferrer\">RankNTypes</a>. It does enforce the rules of \"floating out\" type quantifiers and defines the type <code>(forall a. SomeClass a =&gt; a) -&gt; Int</code>.</p>\n"}], "owner": {"reputation": 2585, "user_id": 6701918, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/fBOp9.jpg?s=128&g=1", "display_name": "V. Semeria", "link": "https://stackoverflow.com/users/6701918/v-semeria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "answer_count": 3, "score": 7, "last_activity_date": 1488229162, "creation_date": 1488196127, "last_edit_date": 1488199478, "question_id": 42485055, "link": "https://stackoverflow.com/questions/42485055/type-quantifiers-in-haskell-functions", "title": "Type quantifiers in Haskell functions", "body": "<p>Suppose I have two Haskell functions of the following types, with ExplicitForAll activated,</p>\n\n<pre><code>f :: forall a. (a -&gt; Int)\ng :: forall a. (Int -&gt; a)\n</code></pre>\n\n<p>It seems to me that the type of <code>g</code> is isomorphic to <code>Int -&gt; (forall a. a)</code>, because for example the type of <code>g(2)</code> is <code>forall a. a</code>.</p>\n\n<p>However, the type of <code>f</code> doesn't look isomorphic to <code>(forall a. a) -&gt; Int</code>. <code>f</code> is a polymorphic function, it knows what to compute on each input type <code>a</code>, in mathematics I guess it would rather be a family of functions ; but I don't think it can handle a single argument that has all types.</p>\n\n<p>Is it a rule of typed lambda calculus that type quantifiers distribute on functions target types, but not on functions source types ?</p>\n\n<p>Does the type <code>(forall a. a) -&gt; Int</code> exist in Haskell, possibly restrained to a type class <code>(forall a. SomeClass a =&gt; a) -&gt; Int</code> ? Is it useful ?</p>\n"}, {"tags": ["parsing", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1488231719, "post_id": 42483221, "comment_id": 72131790, "body": "I like to avoid Template Haskell so I do still hope there is a TH-free solution. But with that said this still does seem like an incredibly effective solution, and I have a feeling that it might be hard to do this without TH, so thank you!"}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "reply_to_user": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1488269114, "post_id": 42483221, "comment_id": 72144434, "body": "@semicolon In principle, you can also derive prisms using generic programming. Would that be more acceptable than using TH?"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1488271870, "post_id": 42483221, "comment_id": 72145985, "body": "Is that what you are doing in your other answer?"}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "reply_to_user": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1488291301, "post_id": 42483221, "comment_id": 72159279, "body": "@semicolon No, that&#39;s a totally different approach. Here, I was just talking about taking the prism-based approach, but rather than using TH to derive the prisms, using something like GHC generics. For example, the <a href=\"https://hackage.haskell.org/package/stack-prism\" rel=\"nofollow noreferrer\">stack-prism</a> package, contains such code (but derives prisms of slightly different source and target types). This could probably be adapted to suit your needs."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1488308857, "post_id": 42483221, "comment_id": 72170606, "body": "Oh ok then yeah, generics definitely does seem like a more disciplined and rigorous method than TH, but I could be wrong."}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": true, "score": 6, "last_activity_date": 1488190972, "creation_date": 1488190972, "answer_id": 42483221, "question_id": 42482128, "link": "https://stackoverflow.com/questions/42482128/how-to-avoid-excessive-boilerplate-for-matching-constructors/42483221#42483221", "title": "How to avoid excessive boilerplate for matching constructors", "body": "<p>You can get the <code>Tok -&gt; Maybe ()</code> and <code>Tok -&gt; Maybe String</code> functions \"for free\" (via Template Haskell) by using prisms (e.g. from the <a href=\"https://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Prism.html\" rel=\"noreferrer\">lens library</a>).</p>\n\n<pre><code>data Tok =\n    IdLower String\n  | IdUpper String\n  | IdSymbol String\n  | IdColon String\n  | Equals\n  | Newline\n\nmakePrisms ''Tok\n</code></pre>\n\n<p>Now you can say:</p>\n\n<pre><code>GHCi&gt; preview _IdLower (IdLower \"foo\")\nJust \"foo\"\nGHCi&gt; preview _IdLower (IdUpper \"Foo\")\nNothing\n</code></pre>\n\n<p>Then, as you suggest yourself, you can abstract from the prism in your token-specific function:</p>\n\n<pre><code>tok :: Prism' Tok a -&gt; Parser a\ntok p = get &gt;&gt;= \\ s -&gt; if\n  | (_, t) :- xs &lt;- s, Just n &lt;- preview p t -&gt; put xs *&gt; pure n\n  | (l, t) :- _ &lt;- s -&gt; throwError [(l, \"Unexpected \" &lt;&gt; description t)]\n  | Nil l &lt;- s -&gt; throwError [(l, \"Unexpected end of input\")]\n</code></pre>\n\n<p>And then you can get the individual functions back by saying <code>tok _IdLower</code> or <code>tok _Equals</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": false, "score": 3, "last_activity_date": 1488270568, "creation_date": 1488270568, "answer_id": 42503673, "question_id": 42482128, "link": "https://stackoverflow.com/questions/42482128/how-to-avoid-excessive-boilerplate-for-matching-constructors/42503673#42503673", "title": "How to avoid excessive boilerplate for matching constructors", "body": "<p>Here is a different approach that also requires a bit of boilerplate code, but no Template Haskell.</p>\n\n<p>It's based on restructuring your <code>Tok</code> type so that you can use a form of equality test rather than matching, and can extract the payload of the token uniformly:</p>\n\n<pre><code>data Tok where\n  Tok :: TokKind a -&gt; a -&gt; Tok\n</code></pre>\n\n<p>Every token has a token kind and a payload. The type of token kinds is a GADT\nthat determines the type of the payload:</p>\n\n<pre><code>data TokKind :: * -&gt; * where\n  IdLower  :: TokKind String\n  IdUpper  :: TokKind String\n  IdSymbol :: TokKind String\n  IdColon  :: TokKind String\n  Equal    :: TokKind ()\n  Newline  :: TokKind ()\n</code></pre>\n\n<p>We now need a form of equality that implies that if two tokens have the same kind, their payload types must be compatible. This is what <code>testEquality</code> from <code>Data.Type.Equality</code> does (which unfortunately cannot currently be derived in any easy way, except by using TH again):</p>\n\n<pre><code>instance TestEquality TokKind where\n  testEquality IdLower  IdLower  = Just Refl \n  testEquality IdUpper  IdUpper  = Just Refl \n  testEquality IdSymbol IdSymbol = Just Refl \n  testEquality IdColon  IdColon  = Just Refl \n  testEquality Equal    Equal    = Just Refl \n  testEquality Newline  Newline  = Just Refl \n  testEquality _        _        = Nothing\n</code></pre>\n\n<p>Then your parameterized token function becomes</p>\n\n<pre><code>tok :: TokKind a -&gt; Parser a\ntok tk' = get &gt;&gt;= \\ s -&gt; if\n  | (_, Tok tk x) :- xs &lt;- s, Just Refl &lt;- testEquality tk tk' -&gt; put xs *&gt; pure x\n  | (l, t) :- _ &lt;- s -&gt; throwError [(l, \"Unexpected \" &lt;&gt; description t)]\n  | Nil l &lt;- s -&gt; throwError [(l, \"Unexpected end of input\")]\n</code></pre>\n"}], "owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 42483221, "answer_count": 2, "score": 4, "last_activity_date": 1488270568, "creation_date": 1488187938, "question_id": 42482128, "link": "https://stackoverflow.com/questions/42482128/how-to-avoid-excessive-boilerplate-for-matching-constructors", "title": "How to avoid excessive boilerplate for matching constructors", "body": "<p>I am currently implementing a Lexer / Parser. And one thing that bugs me is that currently half of my code in my Parser.hs is going to be dedicated to simply getting a single token:</p>\n\n<p>For a small data type like this:</p>\n\n<pre><code>data Tok\n    = IdLower String \n    | IdUpper String \n    | IdSymbol String\n    | IdColon String\n    | Equals\n    | Newline\n</code></pre>\n\n<p>I seem to need something like this:</p>\n\n<pre><code>idLower :: Parser String\nidLower = get &gt;&gt;= \\s -&gt; if\n    | (_, IdLower n) :- xs &lt;- s -&gt; put xs *&gt; pure n\n    | (l, t) :- _ &lt;- s -&gt; throwError [(l, \"Unexpected \" &lt;&gt; description t)]\n    | Nil l &lt;- s -&gt; throwError [(l, \"Unexpected end of input\")]\n\nidUpper :: Parser String\nidUpper = get &gt;&gt;= \\s -&gt; if\n    | (_, IdUpper n) :- xs &lt;- s -&gt; put xs *&gt; pure n\n    | (l, t) :- _ &lt;- s -&gt; throwError [(l, \"Unexpected \" &lt;&gt; description t)]\n    | Nil l &lt;- s -&gt; throwError [(l, \"Unexpected end of input\")]\n\nidSymbol :: Parser String\nidSymbol = get &gt;&gt;= \\s -&gt; if\n    | (_, IdSymbol n) :- xs &lt;- s -&gt; put xs *&gt; pure n\n    | (l, t) :- _ &lt;- s -&gt; throwError [(l, \"Unexpected \" &lt;&gt; description t)]\n    | Nil l &lt;- s -&gt; throwError [(l, \"Unexpected end of input\")]\n\nidColon :: Parser String\nidColon = get &gt;&gt;= \\s -&gt; if\n    | (_, IdColon n) :- xs &lt;- s -&gt; put xs *&gt; pure n\n    | (l, t) :- _ &lt;- s -&gt; throwError [(l, \"Unexpected \" &lt;&gt; description t)]\n    | Nil l &lt;- s -&gt; throwError [(l, \"Unexpected end of input\")]\n\nequals :: Parser ()\nequals = get &gt;&gt;= \\s -&gt; if\n    | (_, Equals) :- xs &lt;- s -&gt; put xs\n    | (l, t) :- _ &lt;- s -&gt; throwError [(l, \"Unexpected \" &lt;&gt; description t)]\n    | Nil l &lt;- s -&gt; throwError [(l, \"Unexpected end of input\")]\n\nnewline :: Parser ()\nnewline = get &gt;&gt;= \\s -&gt; if\n    | (_, Newline) :- xs &lt;- s -&gt; put xs\n    | (l, t) :- _ &lt;- s -&gt; throwError [(l, \"Unexpected \" &lt;&gt; description t)]\n    | Nil l &lt;- s -&gt; throwError [(l, \"Unexpected end of input\")]\n</code></pre>\n\n<p>Which is like 99% repeated code, the only difference between them is the constructor used, and whether or not I have something like <code>pure n</code> for the ones that have contents.</p>\n\n<p>I have tried refactoring it a bit so that I have just one <code>Tok -&gt; Maybe ()</code> or <code>Tok -&gt; Maybe String</code> function per symbol, and then made a higher order function that takes these functions as parameters. But each <code>Tok -&gt; Maybe a</code> function takes at 3 lines plus 1 line of spacer, and now I need another higher order function to support it, and if I want shorthands so I can just use <code>idLower</code> instead of <code>getToken idLower</code> then I end up with just as much code total, if not more!</p>\n\n<p>I am just really hoping there is an alternative to the above. Now I know I can reduce a bit of the duplication by perhaps creating an automatically failing function that will always call the relevant <code>throwError</code> that I can defer to if the first guard doesn't hit, but even with that this still feels pretty gross.</p>\n"}, {"tags": ["haskell", "types", "continuations"], "comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1488192586, "post_id": 42480255, "comment_id": 72107080, "body": "Isn&#39;t <code>f :: a -&gt; Gadt a</code>, why should it act on <code>AInt v :: Gadt a</code> or <code>AString v :: Gadt a</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1488196670, "last_edit_date": 1488196670, "creation_date": 1488188016, "answer_id": 42482153, "question_id": 42480255, "link": "https://stackoverflow.com/questions/42480255/continuation-function-implementations-based-upon-input-type/42482153#42482153", "title": "Continuation function implementations based upon input type?", "body": "<p>First you cannot use <code>::</code> as a predicate to test the runtime type (as far as I know). Second your <code>a</code> parameter of <code>Gadt</code> is entirely phantom. Is that intended? <code>example</code> can either be polymorphic by treating different types uniformly or you'd need to use <code>class</code> (<a href=\"https://wiki.haskell.org/Polymorphism#Parametric_polymorphism\" rel=\"nofollow noreferrer\">parametric</a> vs <a href=\"https://wiki.haskell.org/Polymorphism#Ad-hoc_polymorphism\" rel=\"nofollow noreferrer\">ad-hoc</a> polymorphism). You might have wanted something like</p>\n\n<pre><code>data Gadt where\n    AInt :: Int -&gt; Gadt\n    AString :: String -&gt; Gadt\n\ndata C a = C { unwrap :: (a -&gt; Gadt) -&gt; Gadt }\n\nclass Ex a where\n    example :: a -&gt; C a\n\ninstance Ex Int where\n    example v = C ...\n\ninstance Ex String where\n    example v = C ...\n</code></pre>\n\n<p>This is still pseudo-code, as it makes little sense but at least type-checks for me.</p>\n"}, {"tags": [], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "is_accepted": true, "score": 0, "last_activity_date": 1488190093, "creation_date": 1488190093, "answer_id": 42482909, "question_id": 42480255, "link": "https://stackoverflow.com/questions/42480255/continuation-function-implementations-based-upon-input-type/42482909#42482909", "title": "Continuation function implementations based upon input type?", "body": "<p>I've come across a potential solution, following advice from <a href=\"http://www.haskellforall.com/2012/12/the-continuation-monad.html\" rel=\"nofollow noreferrer\">here</a>:</p>\n\n<pre><code>newtype C r a = C {runC :: (a -&gt; r) -&gt; r}\n\ndata Hole = Hole1 Int | Hole2 String | Hole3 Bool\n\nexample :: String -&gt; C Bool a\nexample s = C $ \\f -&gt; do\n   x &lt;- f (Hole1 22)\n   y &lt;- f (Hole2 \"string\")\n   k (Hole3 False)\n\ncont :: Hole -&gt; Bool\ncont (Hole1 x) = ...\ncont (Hole2 x) = ...\ncont (Hole3 x) = ...\n</code></pre>\n\n<p>This enables specific implementations based on type by wrapping the input type inside the <code>Hole</code> data structure.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 1, "accepted_answer_id": 42482909, "answer_count": 2, "score": 0, "last_activity_date": 1488196670, "creation_date": 1488181499, "last_edit_date": 1488182187, "question_id": 42480255, "link": "https://stackoverflow.com/questions/42480255/continuation-function-implementations-based-upon-input-type", "title": "Continuation function implementations based upon input type?", "body": "<p>I have a very simple continuation function (avoided using Monads for simplicity sake):</p>\n\n<pre><code>data C a = C {unwrap :: (a -&gt; a) -&gt; a}\n</code></pre>\n\n<p>Essentially, I'm trying to perform different implementations based on input type, something similar to (sudo-code):</p>\n\n<pre><code>data Gadt a where\n  AString :: String -&gt; Gadt Bool\n  AInt :: Int -&gt; Gadt Bool\n\ndata C a = C {unwrap :: (a -&gt; Gadt a) -&gt; a}\n\nexample :: a -&gt; C a\nexample v = C $ \\f -&gt; | (v :: Int) == True      = f (AInt v)\n                      | (v :: String) == True   = f (AString v)\n\ncont :: Gadt a -&gt; a\ncont (AInt v)       = ...\ncont (AString v)    = ...\n</code></pre>\n\n<p>Am I overlooking a basic solution here? I'm new to continuations so I may of just overlooked something simple.</p>\n"}, {"tags": ["haskell", "lexer", "gadt"], "comments": [{"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 3, "creation_date": 1488188771, "post_id": 42479251, "comment_id": 72104468, "body": "Would it destroy anything important to factor out the common tokens as a separate, unindexed <code>CommonToken</code> type? Then you could have <i>one</i> constructor <code>TokenCommon :: CommonToken -&gt; Token p</code>, and implement the conversion in one line."}, {"owner": {"reputation": 1207, "user_id": 2884502, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d817ec525df88f7a149bc9186e1a31f3?s=128&d=identicon&r=PG&f=1", "display_name": "lightandlight", "link": "https://stackoverflow.com/users/2884502/lightandlight"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1488196161, "post_id": 42479251, "comment_id": 72109558, "body": "@pigworker I arrived at a similar conclusion"}, {"owner": {"reputation": 402, "user_id": 4476886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/826ef771ed046477d324a4dc64aa17b1?s=128&d=identicon&r=PG&f=1", "display_name": "SongWithoutWords", "link": "https://stackoverflow.com/users/4476886/songwithoutwords"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 0, "creation_date": 1488213472, "post_id": 42479251, "comment_id": 72121381, "body": "@pigworker in this simpler case that is certainly a viable alternative, although with a more complicated data structure, like an AST with dozens of data types and more than two stages, factoring out this commonality would become much more challenging."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1488214244, "post_id": 42479251, "comment_id": 72121888, "body": "@SongWithoutWords Why would it be much more challenging? The constructor <code>Common :: .. -&gt; Token p</code> will be valid regardless of how many inhabitants the kind <code>Phase</code> has. (Perhaps your question should include the actual problem you want to solve instead of a highly simplified version?)"}], "owner": {"reputation": 402, "user_id": 4476886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/826ef771ed046477d324a4dc64aa17b1?s=128&d=identicon&r=PG&f=1", "display_name": "SongWithoutWords", "link": "https://stackoverflow.com/users/4476886/songwithoutwords"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488177380, "creation_date": 1488177380, "question_id": 42479251, "link": "https://stackoverflow.com/questions/42479251/mapping-between-gadts", "title": "Mapping between GADTs", "body": "<p>I'm relatively new to Haskell, and am using it to write a compiler, using Alex and Happy. The language I'm writing it for is whitespace sensitive: blocks are delimited by indentation, and lines are continued by an increase of two indentation levels.</p>\n\n<p>Although I've been down this road with Alex's monadUserState wrapper, as someone unfamiliar with monads I found this approach quite messy. As a result, I am thinking instead of breaking the lexing process into two stages, one which scans the tokens, and a second which will replace raw whitespace with indent, dedent and continuation tokens (this approach may be less performant, but I'm not very concerned with performance at this stage).</p>\n\n<p>The GADT which describes both phases of lexical analysis looks like this:</p>\n\n<pre><code>{-# Language DataKinds, GADTs, KindSignatures #-}\n\nmodule Tokens where\n\ndata Phase = P0 | Pn\n\ndata Token (p :: Phase) where\n\n  -- Phase 0\n  TokenTabs :: Int -&gt; Token 'P0\n\n  -- Phase n\n  TokenIndent :: Token 'Pn\n  TokenDedent :: Token 'Pn\n  TokenLineCont :: Token 'Pn\n\n  -- Common tokens\n  TokenIf :: Token p\n  -- ...\n  -- Many other data constructors with result Token p, that can appear in either stage\n  -- ...\n  TokenName :: String -&gt; Token p\n</code></pre>\n\n<p>The function that performs the second lexing phase looks like this:</p>\n\n<pre><code>postLex :: [Token 'P0] -&gt; [Token 'Pn]\npostLex tokens = postLex' 0 tokens where\n  postLex' :: Int -&gt; [Token 'P0] -&gt; [Token 'Pn]\n  postLex' depth [] = replicate depth TokenDedent\n  postLex' depth ((TokenTabs n) : rest)\n    | n == depth = postLex' depth rest\n    | n == (depth + 1) = TokenIndent : postLex' n rest\n    | n &gt;= (depth + 2) = TokenLineCont : postLex' depth rest\n    | n &lt; depth = replicate (depth - n) TokenDedent ++ postLex' n rest\n  postLex' depth (t:rest) = t : postLex' depth rest\n</code></pre>\n\n<p>The problem I'm encountering is that after matching the tabs token, all remaining tokens can exist in either stage, but I don't know any good way of converting the result of a data constructor with signature TokenX :: Token p from Token P0 to Token Pn.</p>\n\n<p>Is there a good way of performing such a conversion? If not, are there any alternative approaches that preserve type safety? I'm largely interested because I imagine a similar approach would be useful when transforming between various different stages of ASTs later in this project.</p>\n"}, {"tags": ["haskell", "ghc", "ubuntu-16.04", "cabal"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1488169914, "post_id": 42477854, "comment_id": 72095985, "body": "<code>youProbablyWantCapitalCabal</code> is maybe a hint..."}, {"owner": {"reputation": 499, "user_id": 2499255, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4e7eadea443aa4826cbd8bff34168551?s=128&d=identicon&r=PG", "display_name": "domoremath", "link": "https://stackoverflow.com/users/2499255/domoremath"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1488179072, "post_id": 42477854, "comment_id": 72099238, "body": "Thanks. But it still doesn&#39;t solve everything."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1488185905, "post_id": 42477854, "comment_id": 72102698, "body": "Aside from using cabal in your global userspace being a bad idea(see haskellstack.org) i guess .cabal/bin is not in your path"}, {"owner": {"reputation": 499, "user_id": 2499255, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4e7eadea443aa4826cbd8bff34168551?s=128&d=identicon&r=PG", "display_name": "domoremath", "link": "https://stackoverflow.com/users/2499255/domoremath"}, "edited": false, "score": 0, "creation_date": 1488187895, "post_id": 42477854, "comment_id": 72103935, "body": "@ epsilonhalbe . It is in my path."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1488189251, "post_id": 42477854, "comment_id": 72104796, "body": "Could you give us the output of: ls .cabal/bin, ./.cabal/bin/cabal -- version, ghc-pkg list, echo $PATH,  where cabal ?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1488189794, "post_id": 42477854, "comment_id": 72105195, "body": "Also editing out old error messages someone referred to is confusing"}, {"owner": {"reputation": 499, "user_id": 2499255, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4e7eadea443aa4826cbd8bff34168551?s=128&d=identicon&r=PG", "display_name": "domoremath", "link": "https://stackoverflow.com/users/2499255/domoremath"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1488191745, "post_id": 42477854, "comment_id": 72106497, "body": "@epsilonhalbe I only have a file called &quot;cabal&quot; inside .cabal/bin and nothing else. I don&#39;t understand the rest of what you said."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 499, "user_id": 2499255, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4e7eadea443aa4826cbd8bff34168551?s=128&d=identicon&r=PG", "display_name": "domoremath", "link": "https://stackoverflow.com/users/2499255/domoremath"}, "edited": false, "score": 0, "creation_date": 1488192430, "post_id": 42477854, "comment_id": 72106948, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/136737/discussion-between-epsilonhalbe-and-domoremath\">continue this discussion in chat</a>."}], "owner": {"reputation": 499, "user_id": 2499255, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/4e7eadea443aa4826cbd8bff34168551?s=128&d=identicon&r=PG", "display_name": "domoremath", "link": "https://stackoverflow.com/users/2499255/domoremath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1488171517, "creation_date": 1488169652, "last_edit_date": 1488171517, "question_id": 42477854, "link": "https://stackoverflow.com/questions/42477854/haskell-trouble-updating-detecting-cabal", "title": "Haskell: Trouble updating/detecting cabal", "body": "<p>I have both ghci versions 7.10 and 8 installed on my Ubuntu 16.04. I want to install something based on cabal. I already have cabal installed as the command</p>\n\n<pre><code>cabal --version\n</code></pre>\n\n<p>yields</p>\n\n<pre><code>cabal-install version 1.22.6.0\nusing version 1.22.5.0 of the Cabal library \n</code></pre>\n\n<p>But when I go to update with</p>\n\n<pre><code>cabal update\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>Downloading the latest package list from hackage.haskell.org\ncabal: does not exist\n</code></pre>\n\n<p>So I am not sure what is going on or how to resolve this. I hope to afterwards install <code>gloss</code> which is based on cabal. But</p>\n\n<pre><code>cabal install gloss-examples\n</code></pre>\n\n<p>yields</p>\n\n<pre><code>Resolving dependencies...\nDownloading bindings-DSL-1.0.23...\nDownloading bmp-1.2.6.3...\nFailed to install bmp-1.2.6.3\nDownloading vector-0.10.12.3...\nBuild log ( /home/username/.cabal/logs/bmp-1.2.6.3.log ):\ncabal: /home/username/.cabal/logs/bmp-1.2.6.3.log: does not exist\n</code></pre>\n\n<p>EDIT: I originally installed ghci 7.10. Then later installed ghci 8. Could this have any effect?</p>\n\n<p>EDIT2: After installing</p>\n\n<pre><code>cabal install Cabal cabal-install\n</code></pre>\n\n<p>I still get the same error with</p>\n\n<pre><code>cabal update\n</code></pre>\n\n<p>Also I still cannot </p>\n\n<pre><code>cabal install gloss-examples\n</code></pre>\n\n<p>But I get a different error this time</p>\n\n<pre><code>Resolving dependencies...\nDownloading bindings-DSL-1.0.23...\nDownloading bmp-1.2.6.3...\nFailed to install bindings-DSL-1.0.23\nDownloading vector-0.10.12.3...\nBuild log ( /home/aa/.cabal/logs/bindings-DSL-1.0.23.log ):\ncabal: /home/aa/.cabal/logs/bindings-DSL-1.0.23.log: does not exist\n</code></pre>\n\n<p>EDIT3: When I installed Cabal, it says that I installed</p>\n\n<pre><code>Installed cabal-install-1.24.0.2\n</code></pre>\n\n<p>But when I check with \n    cabal --version</p>\n\n<p>I am still stuck at </p>\n\n<pre><code>cabal-install version 1.22.6.0\n</code></pre>\n\n<p>which tells me somehow they are not linked.</p>\n"}, {"tags": ["haskell", "state-monad"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1488165721, "post_id": 42477198, "comment_id": 72094936, "body": "An analogous question that might (or might not!) be enlightening: what is the purpose of <code>putStrLn &quot;hello world!&quot;</code> in <code>main = putStrLn &quot;hello world!&quot; &gt;&gt; main</code>, if <code>&gt;&gt;</code> throws away its return value?"}, {"owner": {"reputation": 1877, "user_id": 965613, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/UiRBe.png?s=128&g=1", "display_name": "planarian", "link": "https://stackoverflow.com/users/965613/planarian"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1488196366, "post_id": 42477198, "comment_id": 72109690, "body": "I see now that the phrase &quot;if &gt;&gt; throws away its return value?&quot; distracts from the intent of my question, which wasn&#39;t to ask &quot;what&#39;s the point of this operator (in general)&quot; but rather, &quot;how does it function in the context of the state monad?&quot; @jcast&#39;s response was what I had in mind."}], "answers": [{"comments": [{"owner": {"reputation": 1877, "user_id": 965613, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/UiRBe.png?s=128&g=1", "display_name": "planarian", "link": "https://stackoverflow.com/users/965613/planarian"}, "edited": false, "score": 0, "creation_date": 1488198043, "post_id": 42477230, "comment_id": 72110726, "body": "Where (other than source code) would I have found this definition? The docs I&#39;ve seen frequently don&#39;t include &gt;&gt;"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1877, "user_id": 965613, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/UiRBe.png?s=128&g=1", "display_name": "planarian", "link": "https://stackoverflow.com/users/965613/planarian"}, "edited": false, "score": 0, "creation_date": 1488210178, "post_id": 42477230, "comment_id": 72119149, "body": "@planarian Source code is generally where you find definitions. It is the exception rather than the rule to see them elsewhere."}, {"owner": {"reputation": 1877, "user_id": 965613, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/UiRBe.png?s=128&g=1", "display_name": "planarian", "link": "https://stackoverflow.com/users/965613/planarian"}, "edited": false, "score": 0, "creation_date": 1488219036, "post_id": 42477230, "comment_id": 72124882, "body": "That surprises me. I&#39;d always thought Hoogle was the place to look for them."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1877, "user_id": 965613, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/UiRBe.png?s=128&g=1", "display_name": "planarian", "link": "https://stackoverflow.com/users/965613/planarian"}, "edited": false, "score": 1, "creation_date": 1488219197, "post_id": 42477230, "comment_id": 72124974, "body": "@planarian Hoogle will get you a type declaration and a link to the docs; often there is a link to the source from there. In the specific case of <code>(&gt;&gt;)</code> (and other class methods), of course, you want the source for the instance, not the source for the declaration of <code>(&gt;&gt;)</code>."}, {"owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "edited": false, "score": 1, "creation_date": 1488219555, "post_id": 42477230, "comment_id": 72125168, "body": "Ah, &quot;docs&quot; = &quot;Haddock&quot;.  Yeah, I wouldn&#39;t rely on those. I would recommend finding some long-form tutorials that at least have some thought put into them. (I don&#39;t have a good recommendation right now, sorry)."}], "tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": true, "score": 3, "last_activity_date": 1488219736, "last_edit_date": 1488219736, "creation_date": 1488165149, "answer_id": 42477230, "question_id": 42477198, "link": "https://stackoverflow.com/questions/42477198/use-of-put-with-in-the-state-monad/42477230#42477230", "title": "Use of put with &gt;&gt; in the state monad", "body": "<p><code>&gt;&gt;</code> doesn't throw away everything from the first argument.  The definition for the state monad (ignoring the <code>newtype</code>)</p>\n\n<pre><code>a &gt;&gt; b = \\s -&gt; let (x, s') = a s in b s'\n</code></pre>\n\n<p>So the state form the first argument is used by <code>&gt;&gt;</code>, but the 'return value' (the <code>x</code> component of the result) is ignored.  That's the point of the state monad --- to track changes to the state without the programmer having to explicitly take them into account.</p>\n\n<p>Apparently, this isn't explained properly by what the OP has been reading, so here's how you can derive the definition above.  The definition of <code>&gt;&gt;</code> across all monads is</p>\n\n<pre><code>a &gt;&gt; b = a &gt;&gt;= \\ _ -&gt; b\n</code></pre>\n\n<p>The definition of <code>&gt;&gt;=</code> for the state monad (ignoring <code>newtype</code>s) is</p>\n\n<pre><code>a &gt;&gt;= f = \\ s -&gt; let (x, s') = a s in f x s'\n</code></pre>\n\n<p>Now, substituting the definition of <code>&gt;&gt;=</code> into the definition of <code>&gt;&gt;</code> above and simplifying, we get:</p>\n\n<pre><code>a &gt;&gt; b = let f = \\ _ -&gt; b in \\ s -&gt; let (x, s') = a s in f x s'\n    = \\ s -&gt; let (x, s') = a s in (\\ _ -&gt; b) x s'\n    = \\ s -&gt; let (x, s') = a s in b s'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 3, "last_activity_date": 1488165759, "creation_date": 1488165759, "answer_id": 42477323, "question_id": 42477198, "link": "https://stackoverflow.com/questions/42477198/use-of-put-with-in-the-state-monad/42477323#42477323", "title": "Use of put with &gt;&gt; in the state monad", "body": "<blockquote>\n  <p>So what is the purpose of <code>put s'</code>, if <code>&gt;&gt;</code> throws away its return value?</p>\n</blockquote>\n\n<p><code>(&gt;&gt;)</code> does throw away the return value, but we don't use <code>put</code> for the return value. The type of <code>put</code> is:</p>\n\n<pre><code>put :: s -&gt; State s ()\n</code></pre>\n\n<p>The return value is of <code>put</code> is a <code>()</code>, and <code>()</code> is for the most part just an uninteresting placeholder. The meaningful part of what <code>put</code> does -- replacing the state -- is not reflected in the return value. A similar case is the type of <code>putStrLn :: String -&gt; IO ()</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": false, "score": 3, "last_activity_date": 1488166702, "creation_date": 1488166702, "answer_id": 42477439, "question_id": 42477198, "link": "https://stackoverflow.com/questions/42477198/use-of-put-with-in-the-state-monad/42477439#42477439", "title": "Use of put with &gt;&gt; in the state monad", "body": "<p><code>State</code> is an example where the monad abstraction is used to encapsulate an <em>effect</em>. In such cases, it's perfectly normal to have operations in which the effect of the operation is important, but it might not have a meaningful return value.</p>\n\n<p>I'll illustrate with an example. Consider everyone's favorite recursive algorithm, the Fibonacci sequence:</p>\n\n<pre><code>fib :: Int -&gt; Int\nfib 1 = 0\nfib 2 = 1\nfib n = fib (n-1) + fib (n-2)\n</code></pre>\n\n<p>We all know this is a pretty inefficient way to calculate these numbers, but <em>how</em> inefficient is it? If we were using a lesser language, we would probably be tempted to hack in a mutable variable and increment it every time <code>fib</code> is called. We can do something similar in Haskell in a purely functional way using <code>State</code>.</p>\n\n<p>Let's define a new version of fib:</p>\n\n<pre><code>fib' :: Int -&gt; State Int Int\nfib' 1 = modify (+1) &gt;&gt; return 0\nfib' 2 = modify (+1) &gt;&gt; return 1\nfib' n = modify (+1) &gt;&gt; (+) &lt;$&gt; fib' (n-1) &lt;*&gt; fib' (n-2)\n</code></pre>\n\n<p>Now we can simultaneously compute the nth number and also count how many calls were made:</p>\n\n<pre><code>&gt; runState (fib' 7) 0\n(8,25)\n&gt; runState (fib' 10) 0\n(34,109)\n&gt; runState (fib' 30) 0  -- this takes about 5 seconds on my machine\n(514229,1664079)\n</code></pre>\n\n<p>Ok, that's great but how does it answer the question? The point to note in the above implementation is <code>modify (+1)</code>. This has the effect of adding 1 to the counter, but doesn't have any useful result on its own. We use <code>&gt;&gt;</code> to sequence it with the next operation, which does have a useful result, namely the computation.</p>\n"}], "owner": {"reputation": 1877, "user_id": 965613, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/UiRBe.png?s=128&g=1", "display_name": "planarian", "link": "https://stackoverflow.com/users/965613/planarian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 1, "accepted_answer_id": 42477230, "answer_count": 3, "score": 2, "last_activity_date": 1488219736, "creation_date": 1488164895, "last_edit_date": 1488165939, "question_id": 42477198, "link": "https://stackoverflow.com/questions/42477198/use-of-put-with-in-the-state-monad", "title": "Use of put with &gt;&gt; in the state monad", "body": "<p>From <em>Thinking Functionally with Haskell</em> (pg 248):</p>\n\n<blockquote>\n  <p>You can think of type <code>State s a</code> as being</p>\n\n<pre><code>type State s a = s -&gt; (a,s) \n</code></pre>\n  \n  <p>...</p>\n\n<pre><code>put :: s -&gt; State s ()\nget :: State s s\nstate :: (s -&gt; (a,s)) -&gt; State s a\n</code></pre>\n  \n  <p>... <code>state</code> can be defined using <code>put</code> and <code>get</code>:</p>\n\n<pre><code>state f = do {s &lt;- get; let (a,s') = f s;\n              put s'; return a}\n</code></pre>\n</blockquote>\n\n<p>Which I believe can be rewritten this way:</p>\n\n<pre><code>get &gt;&gt;= \\s -&gt;\n    let (a,s') = fs in\n        put s' &gt;&gt; return a\n</code></pre>\n\n<p>So what is the purpose of <code>put s'</code>, if <code>&gt;&gt;</code> throws away its return value?</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 1, "creation_date": 1488155476, "post_id": 42475956, "comment_id": 72092563, "body": "Try terminating with <code>n == 1</code>; also, you cannot apply <code>(&#47;)</code> to <code>Integral</code> types. Try casting <code>suma</code> with <code>fromIntegral</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 0, "creation_date": 1488157075, "post_id": 42476186, "comment_id": 72092912, "body": "I&#39;d probably go one step further: <code>sumNums n = sum &lt;$&gt; replicateM n getInt</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 0, "creation_date": 1488164722, "post_id": 42476186, "comment_id": 72094702, "body": "@user2297560 Indeed, I forgot about <code>replicateM</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1488164866, "last_edit_date": 1488164866, "creation_date": 1488156913, "answer_id": 42476186, "question_id": 42475956, "link": "https://stackoverflow.com/questions/42475956/recursion-in-haskell-sum-of-number-read-from-keyboard/42476186#42476186", "title": "Recursion in Haskell - Sum of number read from keyboard", "body": "<p>The main problem is that you read a number, <em>then</em> you check if the value of <code>n</code> indicates you should be reading another number. Instead, check the value of <code>n</code> first.</p>\n\n<pre><code>sumNums 0 = return 0\nsumNums n = do\n  rest &lt;- sumNums (n - 1)\n  x &lt;- getInt\n  return (x + rest)\n</code></pre>\n\n<p>However, you should try to avoid explicit recursion when you can. Many common patterns have already been abstracted away behind higher-order functions.</p>\n\n<p>Here, what do you want? You want to sum a list of numbers, which you can get by running <code>getInt</code> some number of times. Start with the <code>replicate</code> function to repeat <code>getInt</code> the desired number of times:</p>\n\n<pre><code>&gt; :t replicate 3 getInt\nreplicate 3 getInt :: [IO Int]\n</code></pre>\n\n<p>Then use <code>sequence</code> to extract all the integers into a single list.</p>\n\n<pre><code>&gt; :t sequence (replicate 3 getInt)\nsequence (replicate 3 getInt) :: IO [Int]\n</code></pre>\n\n<p>Finally, you can lift <code>sum</code> into the <code>IO</code> monad to add up the numbers.</p>\n\n<pre><code>&gt; :t sum &lt;$&gt; sequence (replicate 3 getInt)\nsum &lt;$&gt; sequence (replicate 3 getInt) :: IO Int\n</code></pre>\n\n<p>Thus, you can write <code>sumNums</code> simply as</p>\n\n<pre><code>sumNums n = sum &lt;$&gt; sequence (replicate n getInt)\n</code></pre>\n\n<hr>\n\n<p>More simply, <code>replicateM</code> combines <code>sequence</code> with <code>replicate</code> (effectively, <code>replicateM = (sequence . ) . replicate</code>).</p>\n\n<pre><code>import Control.Monad\nsumNums n = sum &lt;$&gt; replicateM n getInt\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7059419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08283eb2858524e633a2f2016bddf123?s=128&d=identicon&r=PG&f=1", "display_name": "Darkmantis", "link": "https://stackoverflow.com/users/7059419/darkmantis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "accepted_answer_id": 42476186, "answer_count": 1, "score": 1, "last_activity_date": 1488164866, "creation_date": 1488154859, "question_id": 42475956, "link": "https://stackoverflow.com/questions/42475956/recursion-in-haskell-sum-of-number-read-from-keyboard", "title": "Recursion in Haskell - Sum of number read from keyboard", "body": "<p>I'm trying sum numbers read from the keyboard but i don't get it, in the function sumNums for example i put 7 and i can input 8 numbers but just add 7, i want that input 7 and add 7. In the main function i don't get to use sumNums</p>\n\n<pre><code>getInt :: IO Int \ngetInt = do\n s &lt;- getLine\n return (read s)\n\nsumNums :: Integer -&gt; IO Int\nsumNums n = do\n  x&lt;-getInt\n  if n==0 \n    then return 0\n    else do\n         rest &lt;- sumNums (n-1)\n         return (x+rest)\n\nmain = do putStrLn \"Type numbers: \"\n suma &lt;- sumNums 7\n putStrLn \"Sum: \" ++ show sum\n average &lt;- suma/7\n putStrLn \"Average: \" ++ show average\n</code></pre>\n"}, {"tags": ["haskell", "types"], "answers": [{"comments": [{"owner": {"reputation": 454, "user_id": 3005960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4cQ2w.jpg?s=128&g=1", "display_name": "Kaamil Jasani", "link": "https://stackoverflow.com/users/3005960/kaamil-jasani"}, "edited": false, "score": 0, "creation_date": 1488152953, "post_id": 42474810, "comment_id": 72091986, "body": "Thanks, I&#39;m just getting into Haskell and I thought doing a couple simple things would help me learn, and clearly it worked..."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 5, "last_activity_date": 1488146817, "creation_date": 1488146817, "answer_id": 42474810, "question_id": 42474546, "link": "https://stackoverflow.com/questions/42474546/couldnt-match-type-io-with-map-and-couldnt-match-type-map-with-char/42474810#42474810", "title": "Couldn&#39;t match type IO with Map and couldn&#39;t match type Map with [Char]", "body": "<p>You are mixing pure with impure code - this might work out in less strict programming languages but haskell makes you \"tag\" every usage of <code>IO</code> - by putting you in the IO monad (there are unsafe ways around that - so let us not concern us with those).</p>\n\n<p>You are promising to GHC - <code>getPhonebook :: Int -&gt; (Map.Map String String)</code>\nwhich means for every <code>Int</code> in the domain of getPhonebook - you will return a <code>(Map String String)</code> - pureley without any user input.</p>\n\n<p>Now in the function body you do not fulfill this promise by using <code>getLine</code> and so on.</p>\n\n<p>So let us change the type and acknowledge the use of IO.</p>\n\n<pre><code>getPhonebook :: Int -&gt; IO (Map.Map String String)\n</code></pre>\n\n<p>Now your base case is not matching up to be an IO action, but this can be  fixed easily by using <code>return ...</code>.</p>\n\n<p>But still GHC spots one problem - <code>Map.insert</code> is pure and good and won't accept <code>getPhonebook (n-1)</code> as this is now an IO action. How to solve this - binding this action to a name <code>previousPB &lt;- getPhonebook (n-1)</code>.</p>\n\n<p>Putting this together we get the following code:</p>\n\n<pre><code>getPhonebook :: Int -&gt; IO (Map.Map String String)\ngetPhonebook n\n  | n == 0 = return Map.empty\n  | otherwise = do\n        line &lt;- getLine\n        let split = words line\n        previousPB &lt;- getPhonebook (n-1)\n        return $ Map.insert (split !! 0) (split !! 1) previousPB\n</code></pre>\n\n<p>now the question what the heck does this do - it fills a phone book by asking you for <code>n</code> entries and returns this to you - is this what you want it to do?  - I don't know!</p>\n"}], "owner": {"reputation": 454, "user_id": 3005960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4cQ2w.jpg?s=128&g=1", "display_name": "Kaamil Jasani", "link": "https://stackoverflow.com/users/3005960/kaamil-jasani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "accepted_answer_id": 42474810, "answer_count": 1, "score": 0, "last_activity_date": 1488146817, "creation_date": 1488145026, "question_id": 42474546, "link": "https://stackoverflow.com/questions/42474546/couldnt-match-type-io-with-map-and-couldnt-match-type-map-with-char", "title": "Couldn&#39;t match type IO with Map and couldn&#39;t match type Map with [Char]", "body": "<p>I am new to Haskell and the following code is giving me two errors:</p>\n\n<pre><code>import Control.Monad\nimport Control.Applicative\nimport System.IO\nimport qualified Data.Map as Map\nimport Data.Maybe\n\nmain = do\n    return ()\n\ngetPhonebook :: Int -&gt; (Map.Map String String)\ngetPhonebook n\n    | n == 0 = Map.empty\n    | otherwise = do\n        line &lt;- getLine\n        let split = words line\n        return (Map.insert (split !! 0) (split !! 1) (getPhonebook (n-1)))\n</code></pre>\n\n<p>The first error is on the line <code>line &lt;- getLine</code>. The error says <code>Couldn't match type \u2018IO\u2019 with \u2018Map.Map String\u2019</code>. I don't understand this error, probably a silly mistake.</p>\n\n<p>The second error is on the return line. It says <code>Couldn't match type \u2018Map.Map String String\u2019 with \u2018[Char]\u2019</code>, and the expected type is <code>[Char]</code>. I don't understand this since the function is supposed to return a Map and yet it is asking for a <code>[Char]</code>.</p>\n\n<p>Any help would be appreciated :D</p>\n"}, {"tags": ["haskell", "matrix"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1488144867, "post_id": 42474153, "comment_id": 72089434, "body": "<code>!!</code> is little use here (and incidentally, seldom makes sense in Haskell generally \u2013 even where it does the job, it&#39;s terribly inefficient). Try it with <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:splitAt\" rel=\"nofollow noreferrer\"><code>splitAt</code></a> and pattern matching."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1488145180, "post_id": 42474153, "comment_id": 72089522, "body": "Your call to <code>mapr</code> is missing the update function to use to update row 2 in the matrix <code>a</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "edited": false, "score": 0, "creation_date": 1488145535, "post_id": 42474575, "comment_id": 72089644, "body": "Couldn&#39;t match type \u2018[El]\u2019 with \u2018Int\u2019     Expected type: Row El -&gt; El       Actual type: Row El -&gt; Row El     In the first argument of \u2018map\u2019, namely \u2018f\u2019     In the first argument of \u2018(:)\u2019, namely \u2018(map f x)\u2019"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "edited": false, "score": 0, "creation_date": 1488145913, "post_id": 42474575, "comment_id": 72089764, "body": "I misread that - I thought you wanted to apply a function to each element of your row."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 4, "last_activity_date": 1488148214, "last_edit_date": 1488148214, "creation_date": 1488145192, "answer_id": 42474575, "question_id": 42474153, "link": "https://stackoverflow.com/questions/42474153/updating-all-values-on-a-row-in-a-haskell-matrix/42474575#42474575", "title": "updating all values on a row in a haskell matrix", "body": "<p>I think it would be easiest to write this in a recursive function</p>\n\n<pre><code>mapr n _ [] = error $ \"index: \"++ show n ++\" out of bounds\"\nmapr n f (x:xx) | n &lt; 0     = error \"negative index\"\n                | n == 0    = f x : xx\n                | otherwise = x : mapr (n-1) f xx\n</code></pre>\n\n<p>the following code runs:</p>\n\n<pre><code>main :: IO ()\nmain = do let a = [[2,1,-1,8],[-3,-1,2,-11],[-2,1,2,-3]]\n              res = mapr 2 (const []) a\n          print res\n</code></pre>\n\n<p>you can replace <code>const []</code> with all functions that work on rows - for example <code>map (+1)</code> as well.</p>\n\n<h2>Update:</h2>\n\n<p>Here is one version that uses <code>zip</code> to get indices for comparison, and I have changed the type of the function to work element-wise instead of row wise.</p>\n\n<pre><code>mapr' :: Idx -&gt; (El -&gt; El) -&gt; Mat El -&gt; Mat El\nmapr' n f xx = map (mapIf n f) $ zip xx [0..]\n  where mapIf n f (row,idx) = if idx == n then (map f row)\n                                          else row\n</code></pre>\n\n<p>This is a bit terse so, would ask you to fire up ghci and evaluate the following expressions to get a feeling what it does:</p>\n\n<ul>\n<li><code>zip ['a'..'z'] [0..]</code></li>\n<li><code>map succ ['a'..'c']</code> and <code>map (*3) [10,9..1]</code></li>\n<li><code>let mapIf n f (row,idx) = if idx == n then (map f row) else row</code></li>\n<li><code>mapIf 1 (*3) ([10,9..1],0)</code></li>\n<li><code>mapIf 0 (*3) ([10,9..1],0)</code></li>\n<li><code>map (map (*3)) [[1,2,3],[1,2,4]]</code></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "is_accepted": true, "score": 1, "last_activity_date": 1488146375, "creation_date": 1488146375, "answer_id": 42474751, "question_id": 42474153, "link": "https://stackoverflow.com/questions/42474153/updating-all-values-on-a-row-in-a-haskell-matrix/42474751#42474751", "title": "updating all values on a row in a haskell matrix", "body": "<p>Your code contains several problems:</p>\n\n<ul>\n<li><p>the <code>mapr</code> function should take three arguments (an index, a function that should be applied to the row, and a matrix), but the stub implementation contains only two</p>\n\n<p><code>mapr idx f m = ...</code></p></li>\n<li><p>the <code>+1</code> in the definition of mapr should be replaced by the function that is provided as an argument to <code>mapr</code></p>\n\n<p><code>mapr idx f m = ... f ...</code></p></li>\n<li><p>there should be parentheses around <code>+1</code></p>\n\n<p><code>(+1)</code></p></li>\n<li><p>your <code>mapr</code> expects a function of type <code>[a] -&gt; [a]</code>; <code>+1</code> doesn't fit the bill, you need <code>map (+1)</code></p></li>\n</ul>\n\n<p>Altogether, we get:</p>\n\n<pre><code>type El  = Int\ntype Idx = Int\ntype Mat a = [[a]]\ntype Row a = [a]\n\nmapr :: Idx -&gt; (Row El -&gt; Row El) -&gt; Mat El -&gt; Mat El  \nmapr idx f m = [ m!!i | i &lt;- [0.. (idx-1)]] ++ [(f (m !! idx))] ++ [m!!i | i &lt;- [(idx+1) .. (length m-1)]]\n\nmain = \n  let\n    a = [[2,1,-1,8],[-3,-1,2,-11],[-2,1,2,-3]]\n    res = mapr 2 (\\x -&gt; map (\\y -&gt; y + 1) x) a\n  in\n    print res \n</code></pre>\n"}], "owner": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 42474751, "answer_count": 2, "score": 1, "last_activity_date": 1488148214, "creation_date": 1488142464, "last_edit_date": 1488144963, "question_id": 42474153, "link": "https://stackoverflow.com/questions/42474153/updating-all-values-on-a-row-in-a-haskell-matrix", "title": "updating all values on a row in a haskell matrix", "body": "<p>I have such a code;</p>\n\n<pre><code>type El  = Int\ntype Idx = Int\ntype Mat a = [[a]]\ntype Row a = [a]\nmapr :: Idx -&gt; (Row El -&gt; Row El) -&gt; Mat El -&gt; Mat El\nmapr ----- ??????\n\nmain = do\n        let a = [[2,1,-1,8],[-3,-1,2,-11],[-2,1,2,-3]]\n        let res = mapr 2 a\n</code></pre>\n\n<p>By using <code>mapr</code> function type, I want to update all values on a row on <code>a</code> matrix. Let's say I want to increase all the values in a specific row by 1. But the way I have explained mapr function is wrong. How should I modify my code to update values on a row on matrix <code>a</code> by using <code>mapr</code> function type?</p>\n"}, {"tags": ["haskell", "towers-of-hanoi"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1488141792, "post_id": 42473917, "comment_id": 72088415, "body": "arguments do not need to be enclosed in quotes. Here, they even shouldn&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6368640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9ea0dc9858543ad657087cbe80301bb2?s=128&d=identicon&r=PG&f=1", "display_name": "RunningPig", "link": "https://stackoverflow.com/users/6368640/runningpig"}, "edited": false, "score": 0, "creation_date": 1488143151, "post_id": 42474138, "comment_id": 72088859, "body": "Thank you very much. This is really helpful."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 1, "last_activity_date": 1488142356, "creation_date": 1488142356, "answer_id": 42474138, "question_id": 42473917, "link": "https://stackoverflow.com/questions/42473917/haskell-error-when-implementing-tower-of-hanoi/42474138#42474138", "title": "Haskell error when implementing Tower of Hanoi", "body": "<p>Arguments to Haskell functions are actually patterns that the supplied values are matched against. </p>\n\n<p><code>a</code> is an irrefutable pattern that always succeeds by matching up the variable <code>a</code> with the supplied value, whether <code>\"a\"</code>, <code>\"b\"</code>, <code>\"c\"</code> or something else entirely.</p>\n\n<p><code>\"a\"</code> is also a pattern, but it will <em>only</em> succeed when matched up with a <em>matching</em> value, <code>\"a\"</code>:</p>\n\n<pre><code>~&gt; let f \"a\" = 1\nf :: Num a =&gt; [Char] -&gt; a\n\n~&gt; f \"a\"\n1\nit :: Num a =&gt; a\n\n~&gt; f \"c\"\n*** Exception: &lt;interactive&gt;:3:5-13: Non-exhaustive patterns in function f\n</code></pre>\n\n<p>So, do not enclose your arguments in quotes when defining functions, if you want them to be interpreted as variable patterns.</p>\n"}], "owner": {"reputation": 55, "user_id": 6368640, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9ea0dc9858543ad657087cbe80301bb2?s=128&d=identicon&r=PG&f=1", "display_name": "RunningPig", "link": "https://stackoverflow.com/users/6368640/runningpig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 42474138, "answer_count": 1, "score": 1, "last_activity_date": 1488142356, "creation_date": 1488141235, "last_edit_date": 1488141620, "question_id": 42473917, "link": "https://stackoverflow.com/questions/42473917/haskell-error-when-implementing-tower-of-hanoi", "title": "Haskell error when implementing Tower of Hanoi", "body": "<p>I am trying to implement a recursive function for Tower of Hanoi.</p>\n\n<p>The algorithm is:</p>\n\n<pre><code>Move n\u22121 disks from peg AA to peg C using peg B as intermediate storage.\n\nMove the nth disk from peg A to peg B,\n\nMove n\u22121 disks from peg C to peg BB using peg A as intermediate storage.\n</code></pre>\n\n<p>Eample:</p>\n\n<pre><code>hanoi 2 \"a\" \"b\" \"c\" =\n[(\"a\",\"c\"), (\"a\",\"b\"), (\"c\",\"b\")]\n</code></pre>\n\n<p>This is my implementation</p>\n\n<pre><code>hanoi :: Integer -&gt; Peg -&gt; Peg -&gt; Peg -&gt; [Move] \n\nhanoi x \"a\" \"b\" \"c\" \n    | x &lt;= 0    = []\n    | x == 1    = [(\"a\", \"b\")]\n    | otherwise = (hanoi (x-1) \"a\" \"c\" \"b\") ++ [(\"a\", \"b\")] ++ (hanoi (x-1) \"c\" \"b\" \"a\")\n</code></pre>\n\n<p>However I got an error said <code>there is un-exhausted pattern</code>.\nWhat does it mean an how can I solve it?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "edited": false, "score": 2, "creation_date": 1488140153, "post_id": 42473682, "comment_id": 72087792, "body": "Can you add a bit of code that makes it more explicit what these lists contain?"}, {"owner": {"reputation": 1, "user_id": 7626611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/410cdd480d5ba20d0284dbab901e22f3?s=128&d=identicon&r=PG&f=1", "display_name": "EraseMe", "link": "https://stackoverflow.com/users/7626611/eraseme"}, "reply_to_user": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "edited": false, "score": 0, "creation_date": 1488140358, "post_id": 42473682, "comment_id": 72087862, "body": "Yes of course !"}, {"owner": {"reputation": 1, "user_id": 7626611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/410cdd480d5ba20d0284dbab901e22f3?s=128&d=identicon&r=PG&f=1", "display_name": "EraseMe", "link": "https://stackoverflow.com/users/7626611/eraseme"}, "reply_to_user": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "edited": false, "score": 0, "creation_date": 1488141380, "post_id": 42473682, "comment_id": 72088270, "body": "type idLibrary = Int type location = String type author = String   data Book = Book idLibrary author deriving Show data Library = Book idLibrary location deriving Show  Book1 = (Book 1 &quot;Anthony C&quot;) Library1 = (Library 2 &quot;Alaska&quot;)  listB :: [Book] listB = [Book1]  listL :: [Library] listL = [Library1]"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1488141538, "post_id": 42473682, "comment_id": 72088326, "body": "this is not valid haskell code"}, {"owner": {"reputation": 1, "user_id": 7626611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/410cdd480d5ba20d0284dbab901e22f3?s=128&d=identicon&r=PG&f=1", "display_name": "EraseMe", "link": "https://stackoverflow.com/users/7626611/eraseme"}, "edited": false, "score": 0, "creation_date": 1488141815, "post_id": 42473682, "comment_id": 72088421, "body": "Sorry please remove i7 line"}, {"owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "edited": false, "score": 2, "creation_date": 1488141872, "post_id": 42473682, "comment_id": 72088439, "body": "@EraseMe You should be able to edit the question (I think some of the types need to have a capital first letter as well for it be valid)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7626611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/410cdd480d5ba20d0284dbab901e22f3?s=128&d=identicon&r=PG&f=1", "display_name": "EraseMe", "link": "https://stackoverflow.com/users/7626611/eraseme"}, "edited": false, "score": 0, "creation_date": 1488143578, "post_id": 42473981, "comment_id": 72088986, "body": "Could you provide an example?"}], "tags": [], "owner": {"reputation": 3683, "user_id": 330242, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9f3ffc3e30d25eb64e2e464f0a86bd7?s=128&d=identicon&r=PG", "display_name": "przemo_li", "link": "https://stackoverflow.com/users/330242/przemo-li"}, "is_accepted": false, "score": 1, "last_activity_date": 1488147741, "last_edit_date": 1488147741, "creation_date": 1488141571, "answer_id": 42473981, "question_id": 42473682, "link": "https://stackoverflow.com/questions/42473682/2-data-list-comparaisons-haskell/42473981#42473981", "title": "2 data list comparaisons Haskell", "body": "<p>You can use <code>intersectBy</code> and <code>\\\\</code> from <code>Data.List</code>.</p>\n\n<p>With <code>intersectBy</code> You would create list of common elements, and then use <code>\\\\</code> to remove those for Your list.</p>\n\n<p>Mathematical term for desired outcome is relative complement of one set in another, so that's how I will call main function.</p>\n\n<p><strong>Note: I defined <em>Eq</em> instance for <em>Book</em> where equality means equality of id's but that's only for the benefit of <em>elem</em>. If that definition do not meet Your needs then replace <em>elem</em> use in remove with something that check for ids there.</strong></p>\n\n<p><strong><em>import Data.List</em> is only for <em>intersectBy</em> function</strong></p>\n\n<pre><code>import Data.List\n\ntype IDLibrary = Int\ntype Location = String\ntype Author = String\n\ndata Book = Book IDLibrary Author deriving Show\ndata Library = LibraryBook IDLibrary Location deriving Show\n\ninstance Eq Book where\n  (==) (Book id _) (Book id' _) = id == id'\n\nlistB :: [Book]\nlistB = [Book 1 \"Anthony C\", Book 3 \"David Weber\"]\nlistL :: [Library]\nlistL = [LibraryBook 1 \"Alaska\", LibraryBook 2 \"Majorka\"]\n\nrelativeComplement :: [Book] -&gt; [Library] -&gt; [Book]\nrelativeComplement xs ys = xs `remove` common xs ys\n\nremove :: [Book] -&gt; [Book] -&gt; [Book]\nremove xs ys = filter (not . (`elem` ys)) xs\n\ncommon :: [Book] -&gt; [Library] -&gt; [Book]\ncommon xs ys = intersectBy sameID xs (intoBooks ys)\n\nsameID :: Book -&gt; Book -&gt; Bool\nsameID (Book id1 _) (Book id2 _) = id1 == id2\n\nintoBooks :: [Library] -&gt; [Book]\nintoBooks = map turnIntoBook\n          where turnIntoBook (LibraryBook id _) = Book id \"\"\n</code></pre>\n\n<p>Output:</p>\n\n<blockquote>\n  <p>[Book 3 \"David Weber\"]</p>\n</blockquote>\n\n<p>PS By no means my code is of high quality, I too am in a process of learning Haskell.</p>\n"}], "owner": {"reputation": 1, "user_id": 7626611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/410cdd480d5ba20d0284dbab901e22f3?s=128&d=identicon&r=PG&f=1", "display_name": "EraseMe", "link": "https://stackoverflow.com/users/7626611/eraseme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1488147741, "creation_date": 1488140012, "last_edit_date": 1488143019, "question_id": 42473682, "link": "https://stackoverflow.com/questions/42473682/2-data-list-comparaisons-haskell", "title": "2 data list comparaisons Haskell", "body": "<p>I have 2 data lists in haskell each which contain an id attribut. I would like to compare both lists and return all data objects from that are in the first list but not the second.</p>\n\n<h2>Here is an example:</h2>\n\n<pre><code>type IDLibrary = Int\ntype Location = String\ntype Author = String\n\ndata Book = Book IDLibrary Author deriving Show\ndata Library = LibraryBook IDLibrary Location deriving Show\n\nbook1 = Book 1 \"Anthony C\"\nlibrary1 = LibraryBook 2 \"Alaska\"\nlistB :: [Book]\nlistB = [book1]\nlistL :: [Library]\nlistL = [library1]\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 5, "last_activity_date": 1488141164, "creation_date": 1488141164, "answer_id": 42473904, "question_id": 42473592, "link": "https://stackoverflow.com/questions/42473592/why-does-the-following-type-constructor-take-less-arguments-than-the-data-constr/42473904#42473904", "title": "Why does the following type constructor take less arguments than the data constructor?", "body": "<p>It's like with functions, where each formal parameter can be used more than once, like <code>sqr x = x * x</code>.</p>\n\n<p>Same here: <code>Quadruple</code> is a <em>type</em> constructor: it constructs a new type when given two argument types, <code>a</code> and <code>b</code>. So <code>Quadruple Int Double</code> is a type; <code>Quadruple Int Int</code> is another type.</p>\n\n<p>How its <em>values</em> are created? By using a <em>data</em> constructor <code>Quad</code> with four argument values: a pair with one type and another pair with another type. This is what <em>you</em> are telling to Haskell with that definition. So yes, it will use this knowledge in inferring and checking the types.</p>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1488141231, "creation_date": 1488141231, "answer_id": 42473916, "question_id": 42473592, "link": "https://stackoverflow.com/questions/42473592/why-does-the-following-type-constructor-take-less-arguments-than-the-data-constr/42473916#42473916", "title": "Why does the following type constructor take less arguments than the data constructor?", "body": "<p>I think you are right - the left hand side only declares the type-variables that can be used on the right hand side<sup>1</sup>.</p>\n\n<p>So all of the following are valid:</p>\n\n<pre><code>data A = A Int\n</code></pre>\n\n<p>has no variable on the LHS => none on the RHS</p>\n\n<pre><code>data B b = B1 Int | B2 b\n</code></pre>\n\n<p>has one variable on the LHS and uses this in one of it's constructors on the RHS; note you don't need to use the variable at all - this is called phantom type.</p>\n\n<pre><code>data C c = C Int\n</code></pre>\n\n<p>which is still something useful.</p>\n\n<p><sup>1</sup>: except for existential types</p>\n"}, {"tags": [], "owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "is_accepted": true, "score": 8, "last_activity_date": 1488141964, "last_edit_date": 1488141964, "creation_date": 1488141327, "answer_id": 42473932, "question_id": 42473592, "link": "https://stackoverflow.com/questions/42473592/why-does-the-following-type-constructor-take-less-arguments-than-the-data-constr/42473932#42473932", "title": "Why does the following type constructor take less arguments than the data constructor?", "body": "<p>It might be clearer with using the type</p>\n\n<pre><code>q = Quad 1 2 \"peter\" \"paul\"\n</code></pre>\n\n<p>Here you can see there are 2 types in play, <code>Int</code> and <code>String</code>. So <code>q</code> is of the type <code>Quadruple Int String</code>.</p>\n\n<p>So there are 2 types in play: the number of type parameters of <code>Quadruple</code>. And there are 4 values(/fields) needed for the value constructor: the number of arguments of the <code>Quad</code> value constructor.</p>\n"}], "owner": {"reputation": 1724, "user_id": 3286513, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/bc0cef8062401f1b84db320cb56c28bd?s=128&d=identicon&r=PG", "display_name": "Steven L.", "link": "https://stackoverflow.com/users/3286513/steven-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 42473932, "answer_count": 3, "score": 2, "last_activity_date": 1488141964, "creation_date": 1488139503, "question_id": 42473592, "link": "https://stackoverflow.com/questions/42473592/why-does-the-following-type-constructor-take-less-arguments-than-the-data-constr", "title": "Why does the following type constructor take less arguments than the data constructor?", "body": "<p>I have the following type declaration:</p>\n\n<pre><code>data Quadruple a b = Quad a a b b\n</code></pre>\n\n<p>(Some of you might recognize this declaration from <em>Yet Another Haskell Tutorial</em>).</p>\n\n<p>I understand the code's intent to be: <em>create a data type called Quadruple. It has a single type constructor called Quad, which takes four values. The first two values must have the same type, and the last two values must have the same type.</em></p>\n\n<p>I am having trouble explaining to myself why the type constructor takes less arguments than the data constructor. The only explanation I could conjure up is that Haskell is able to infer from the type declaration that if the first value is of type a, so is the second value, and if the third value is of type b, so is the fourth value.</p>\n\n<p>Is this correct? Am I missing something here? I know Haskell has type inference so this makes sense, but I don't want to run with the wrong mental model. (Second time trying to learn Haskell).</p>\n"}, {"tags": ["haskell", "lambda"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1488135944, "post_id": 42472799, "comment_id": 72086203, "body": "You do not need a lambda expression here: simply <code>isGroupInscr</code> is enough as first argument in <code>filter</code>."}, {"owner": {"reputation": 237, "user_id": 4355151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pIXuHK643rM/AAAAAAAAAAI/AAAAAAAAAKI/FG5TNHAr07U/photo.jpg?sz=128", "display_name": "digitalis_", "link": "https://stackoverflow.com/users/4355151/digitalis"}, "edited": false, "score": 0, "creation_date": 1488138153, "post_id": 42472799, "comment_id": 72086980, "body": "Could you edit your question to include the whole program? (Or provide a link to the source in <a href=\"https://hastebin.com\" rel=\"nofollow noreferrer\">some pastebin</a>?)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488138315, "post_id": 42472799, "comment_id": 72087042, "body": "It&#39;s impossible to answer this without the type definitions and the specification -- what are you trying to do? You are not using the <code>listInscr</code> argument at all, so this looks quite wrong. Probably you need to either <code>zip</code> the two lists and then filter, or search whether a course occurs in the incriptions using <code>any</code> or custom recursion."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1488138776, "post_id": 42472799, "comment_id": 72087257, "body": "<code>filter</code> usually takes only one-argument-functions"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1488139756, "post_id": 42472799, "comment_id": 72087630, "body": "use list comprehensions (like, <code>filter p xs</code> is <code>[ x | x &lt;- xs, p xs ]</code>). they are much more visual and immediate, it&#39;s harder to write a wrong expression with them. for instance, where is <code>y</code> coming from into your lambda function?"}, {"owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "edited": false, "score": 0, "creation_date": 1488190178, "post_id": 42472799, "comment_id": 72105442, "body": "It&#39;s hard to tell what do you want to do however yout program does not typecheck because filter is of type      (a -&gt; Bool) -&gt; [a] -&gt; [a]  however you are invoking it with function of type      GroupeCours -&gt; Inscription -&gt; Bool  as first argument. As it was stated in previous comment filter expects one-argument function, not two-argument function. Depending on what do you want to do, you may use uncurry or reformulate isGroupInsc."}], "answers": [{"tags": [], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "is_accepted": true, "score": 0, "last_activity_date": 1488202065, "last_edit_date": 1488202065, "creation_date": 1488198671, "answer_id": 42485887, "question_id": 42472799, "link": "https://stackoverflow.com/questions/42472799/haskell-lambda-expression-and-matching-types/42485887#42485887", "title": "Haskell Lambda expression and matching types", "body": "<p>You need to partially apply </p>\n\n<pre><code>isGroupInscr :: GroupeCours -&gt; Inscription -&gt; Bool\n</code></pre>\n\n<p>to get a function that has type </p>\n\n<pre><code>Inscription -&gt; Bool \n</code></pre>\n\n<p>to be able to use with <code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code></p>\n\n<hr>\n\n<p><strong>Guessing</strong> from type of the function, I think what you want is</p>\n\n<pre><code>isGroupInscr :: GroupeCours -&gt; Inscription -&gt; Bool\nisGroupInscr sigleGroup sigleInscr =  getSigle sigleGroup /= getSigle2 sigleInscr\n\nfiltreGroupInscr :: [GroupeCours] -&gt; [Inscription] -&gt; [GroupeCours]\nfiltreGroupInscr (g:gs) (l:ls) = if isGroupInscr g l \n                                 then g : filtreGroupInscr gs ls\n                                 else []\nfiltreGroupInscr _      _      = []\n</code></pre>\n\n<p>Other possible guess</p>\n\n<pre><code>filtreGroupInscr listGroupe listInscr  \n    = [g | g &lt;- listGroupe , l &lt;- listInscr, isGroupInscr g l]\n</code></pre>\n\n<p>Also, noted that you don't have to use <code>()</code> for calling function unless it really need. Haskell use space as function application.</p>\n\n<hr>\n\n<p><strong>Side-note</strong> : With haskell <code>undefined</code> magic, I am able to load the incomplete code in GHCi to do the type-checking.</p>\n\n<p>code test3.hs</p>\n\n<pre><code>data GroupeCours = GroupeCours\ndata Inscription = Inscription\ndata Single = Single deriving Eq\n\ngetSigle :: GroupeCours -&gt; Single\ngetSigle = undefined\n\ngetSigle2 :: Inscription -&gt; Single\ngetSigle2 = undefined\n\nisGroupInscr :: GroupeCours -&gt; Inscription -&gt; Bool\nisGroupInscr sigleGroup sigleInscr =  getSigle sigleGroup /= getSigle2 sigleInscr\n\nfiltreGroupInscr :: [GroupeCours] -&gt; [Inscription] -&gt; [GroupeCours]\nfiltreGroupInscr (g:gs) (l:ls) = if isGroupInscr g l \n                                then g : filtreGroupInscr gs ls\n                                else []\nfiltreGroupInscr _      _      = []\n\nfiltreGroupInscr' :: [GroupeCours] -&gt; [Inscription] -&gt; [GroupeCours]\nfiltreGroupInscr' listGroupe listInscr  \n    = [g | g &lt;- listGroupe , l &lt;- listInscr, isGroupInscr g l]\n</code></pre>\n\n<p>GHCi in action</p>\n\n<pre><code>$ ghci\nGHCi, version 8.0.1: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /data/works/dotfiles/ghci\nPrelude&gt; :l test3.hs\n[1 of 1] Compiling Main             ( test3.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; :t isGroupInscr \nisGroupInscr :: GroupeCours -&gt; Inscription -&gt; Bool\n*Main&gt; :t filtreGroupInscr\nfiltreGroupInscr :: [GroupeCours] -&gt; [Inscription] -&gt; [GroupeCours]\n*Main&gt; :t filtreGroupInscr'\nfiltreGroupInscr'\n  :: [GroupeCours] -&gt; [Inscription] -&gt; [GroupeCours]\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7626378, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4bae5294940118124ae40b2f9f0945f0?s=128&d=identicon&r=PG&f=1", "display_name": "Tirvax", "link": "https://stackoverflow.com/users/7626378/tirvax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "accepted_answer_id": 42485887, "answer_count": 1, "score": 1, "last_activity_date": 1488202065, "creation_date": 1488135621, "question_id": 42472799, "link": "https://stackoverflow.com/questions/42472799/haskell-lambda-expression-and-matching-types", "title": "Haskell Lambda expression and matching types", "body": "<p>I need a bit of help here. On the last line of code i always got a type match error but i dont understand why 'cause it seems to be good...\nisGroupInscr(x)(y) return true or false and i compare it to True so no mismatch...\nCan you give me some advices? :)</p>\n\n<pre><code>isGroupInscr :: GroupeCours -&gt; Inscription -&gt; Bool\nisGroupInscr sigleGroup sigleInscr =  getSigle(sigleGroup) /= getSigle2(sigleInscr)\n\nfiltreGroupInscr :: [GroupeCours] -&gt; [Inscription] -&gt; [GroupeCours]\nfiltreGroupInscr listGroupe listInscr = filter (\\x y -&gt; isGroupInscr(x)(y) == True) listGroupe\n</code></pre>\n\n<p>error : </p>\n\n<pre><code>\u2022 Couldn't match expected type \u2018Bool\u2019\n              with actual type \u2018Inscription -&gt; Bool\u2019\n\u2022 The lambda expression \u2018\\ x y -&gt; isGroupInscr (x) (y) == True\u2019\n  has two arguments,\n  but its type \u2018GroupeCours -&gt; Bool\u2019 has only one\n  In the first argument of \u2018filter\u2019, namely\n    \u2018(\\ x y -&gt; isGroupInscr (x) (y) == True)\u2019\n  In the expression:\n    filter (\\ x y -&gt; isGroupInscr (x) (y) == True) listGroupe\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1488135834, "post_id": 42472790, "comment_id": 72086159, "body": "Shouldn&#39;t the values in the last case be swapped?"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1488136566, "last_edit_date": 1488136566, "creation_date": 1488135795, "answer_id": 42472842, "question_id": 42472790, "link": "https://stackoverflow.com/questions/42472790/minbound-and-maxbound-in-haskell/42472842#42472842", "title": "minBound and MaxBound in haskell", "body": "<p>You can simply use a check for an empty list:</p>\n\n<pre><code><b>minmax1 [] = (maxBound,minBound)</b>\nminmax1 arr = (minimum arr, maximum arr)</code></pre>\n\n<p>Note that you do <strong>not have to define <code>minBound</code> and <code>maxBound</code></strong> yourself: <code>Int</code> is an instance of <code>Bounded</code> and thus has such bounds:</p>\n\n<pre><code>Prelude&gt; maxBound :: Int\n9223372036854775807\nPrelude&gt; minBound :: Int\n-9223372036854775808\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4681, "user_id": 1264328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/786f8275d9fa334bc27630e0fc7f0d22?s=128&d=identicon&r=PG", "display_name": "bwroga", "link": "https://stackoverflow.com/users/1264328/bwroga"}, "is_accepted": false, "score": 3, "last_activity_date": 1488135949, "last_edit_date": 1488135949, "creation_date": 1488135831, "answer_id": 42472847, "question_id": 42472790, "link": "https://stackoverflow.com/questions/42472790/minbound-and-maxbound-in-haskell/42472847#42472847", "title": "minBound and MaxBound in haskell", "body": "<p>You can pattern match on the list to see if it is empty or not:</p>\n\n<pre><code>minmax1 :: [Int] -&gt; (Int, Int)\nminmax1 [] = (maxBound,minBound)\nminmax1 arr = (minimum(arr), maximum(arr))\n</code></pre>\n\n<p>If the list is empty, the first equation will be used. If the list is not empty, the first equation is ignored and the second one will be used.</p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 3, "last_activity_date": 1488157902, "creation_date": 1488157902, "answer_id": 42476309, "question_id": 42472790, "link": "https://stackoverflow.com/questions/42472790/minbound-and-maxbound-in-haskell/42476309#42476309", "title": "minBound and MaxBound in haskell", "body": "<p>As an alternative, consider a single fold over the list instead of two separate passes:</p>\n\n<pre><code>minmax1 = foldl' (\\(a,b) c -&gt; (min a c,max b c)) (maxBound,minBound)\n</code></pre>\n\n<p>And as an example use:</p>\n\n<pre><code>&gt; minmax1 [1,5893549,192,55] :: (Int,Int)\n(1,5893549)\n</code></pre>\n"}], "owner": {"reputation": 3042, "user_id": 4393898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/JvZg5.jpg?s=128&g=1", "display_name": "yusuf", "link": "https://stackoverflow.com/users/4393898/yusuf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2121, "favorite_count": 1, "accepted_answer_id": 42472842, "answer_count": 3, "score": 2, "last_activity_date": 1488157902, "creation_date": 1488135567, "question_id": 42472790, "link": "https://stackoverflow.com/questions/42472790/minbound-and-maxbound-in-haskell", "title": "minBound and MaxBound in haskell", "body": "<p>I have the following code:</p>\n\n<pre><code>minmax1, minmax2, minmax3 :: [Int] -&gt; (Int, Int)\nminBound :: Int = -9223372036854775808\nmaxBound :: Int = 9223372036854775807\nminmax1 arr = (minimum(arr), maximum(arr))\n\nmain = do\n    let list1 = [1, 2, 3]\n    let list2 = [1, 9, 3]\n    let list3 = [3, 2, 1, 0]\n    let list4 = [100]\n    let list5 = []\n    putStrLn $ show list1 ++ \" -&gt; \" ++ show (minmax1 list1)\n    putStrLn $ show list2 ++ \" -&gt; \" ++ show (minmax1 list2)\n    putStrLn $ show list3 ++ \" -&gt; \" ++ show (minmax1 list3)\n    putStrLn $ show list4 ++ \" -&gt; \" ++ show (minmax1 list4)\n    putStrLn $ show list5 ++ \" -&gt; \" ++ show (minmax1 list5)\n</code></pre>\n\n<p>in order to obtain the following results:</p>\n\n<pre><code>--   minmax1 [1,2,3] = (1,3)\n--   minmax1 [1,9,3] = (1,9)\n--   minmax1 [3,2,1,0] = (0,3)\n--   minmax1 [100]   = (100,100)\n--   minmax1 [] = (9223372036854775807,-9223372036854775808)\n</code></pre>\n\n<p>If the array is not empty, it is easy to get the values above. But when the input to <code>minmax1</code> is an empty array, how should I modify my code to obtain the value above?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 1, "last_activity_date": 1488143209, "creation_date": 1488143209, "answer_id": 42474270, "question_id": 42472168, "link": "https://stackoverflow.com/questions/42472168/yesod-how-to-give-utctime-a-tomarkup-instance/42474270#42474270", "title": "Yesod: How to give UTCTime a toMarkup instance?", "body": "<p>I think you can do something like</p>\n\n<pre><code>import Data.Time.Format\n\ngetHomeR :: Handler Html\ngetHomeR = do\nwordList &lt;- runDB $ selectList [] [] :: HandlerT App IO [Entity Vocabulary]\ndefaultLayout $ do\n  setTitle \"test\"\n  [whamlet|\n          &lt;ul&gt;\n            $forall Entity wordid worditem &lt;- wordList\n              &lt;li&gt;#{dateFormat $ vocabularyDate worditem} \n  |]\n\ndateFormat :: UTCTime -&gt; String\ndateFormat = formatTime defaultTimeLocale \"%F\"\n</code></pre>\n\n<p>I am not quite familiar with hamlet templates, so you might need to tweak this code a bit.</p>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 42474270, "answer_count": 1, "score": 0, "last_activity_date": 1488158800, "creation_date": 1488132270, "last_edit_date": 1495539973, "question_id": 42472168, "link": "https://stackoverflow.com/questions/42472168/yesod-how-to-give-utctime-a-tomarkup-instance", "title": "Yesod: How to give UTCTime a toMarkup instance?", "body": "<p>I have this Haskell Data in the models:</p>\n\n<pre><code>Vocabulary json\n    word Text\n    date UTCTime\n    deriving Show\n</code></pre>\n\n<p>I get errors with the following code:</p>\n\n<pre><code>getHomeR :: Handler Html\ngetHomeR = do\n    wordList &lt;- runDB $ selectList [] [] :: HandlerT App IO [Entity Vocabulary]\n    defaultLayout $ do\n      setTitle \"test\"\n      [whamlet|\n              &lt;ul&gt;\n                $forall Entity wordid worditem &lt;- wordList\n                  &lt;li&gt;#{vocabularyDate worditem} \n      |]\n</code></pre>\n\n<p>Error is:</p>\n\n<pre><code> Could not deduce (blaze-markup-0.7.1.1:Text.Blaze.\nToMarkup\n                          UTCTime)\n        arising from a use of \u2018toHtml\u2019\n      from the context: PersistEntity Vocabulary\n</code></pre>\n\n<p>I read from <a href=\"https://stackoverflow.com/questions/12275273/using-utctime-with-hamlet\">This post</a> that I should declare UTCTime to be an instance of ToMarkup. How and in which file should I do this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488132394, "post_id": 42471712, "comment_id": 72084788, "body": "Weird error, I&#39;m unsure about how to debug that. Have you tried installing the &quot;haskell platform&quot;? It should contain all the needed tools for Haskell development."}, {"owner": {"reputation": 11, "user_id": 7626065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041dd2f1d54a7f1760b5488615e7cd90?s=128&d=identicon&r=PG&f=1", "display_name": "Volgin212", "link": "https://stackoverflow.com/users/7626065/volgin212"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488149145, "post_id": 42471712, "comment_id": 72090801, "body": "That&#39;s where I got the program, exact spot was Haskell.org"}, {"owner": {"reputation": 11, "user_id": 7626065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041dd2f1d54a7f1760b5488615e7cd90?s=128&d=identicon&r=PG&f=1", "display_name": "Volgin212", "link": "https://stackoverflow.com/users/7626065/volgin212"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1505857888, "post_id": 42471712, "comment_id": 79582421, "body": "It seems that the issue was a mechanical one, a different computer seems to run it just fine"}], "owner": {"reputation": 11, "user_id": 7626065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/041dd2f1d54a7f1760b5488615e7cd90?s=128&d=identicon&r=PG&f=1", "display_name": "Volgin212", "link": "https://stackoverflow.com/users/7626065/volgin212"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 301, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488129781, "creation_date": 1488129781, "question_id": 42471712, "link": "https://stackoverflow.com/questions/42471712/createghciprocess-failed-with-failed-with-error-0-the-operation-completed-succe", "title": "CreateGHCiProcess failed with failed with error 0: The operation completed successfully", "body": "<p>When I open WinGHCi the following error message pops up:</p>\n\n<p>CreateGHCiProcess failed with failed with error 0: The operation completed successfully</p>\n\n<p>I don't know how to fix this, It's my first time trying to do anything with Haskell, and I've already tried reinstalling the program.</p>\n\n<p>Any Ideas?</p>\n"}, {"tags": ["haskell", "pattern-matching", "deque"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488127739, "post_id": 42471130, "comment_id": 72083015, "body": "Isn&#39;t Okasaki&#39;s <code>Deque</code> a class?"}, {"owner": {"reputation": 1, "user_id": 3845588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bf301a45e978e0e355c6372880af620?s=128&d=identicon&r=PG&f=1", "display_name": "mixz", "link": "https://stackoverflow.com/users/3845588/mixz"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488128550, "post_id": 42471130, "comment_id": 72083307, "body": "in my example Deque is a type:  type Deque = ImplicitCatDeque BankersDeque VfElement ,  where ImplicitCatDeque and BankersDeque is my implemenation of Okasaki&#39;s Data Structures (I took it from his book) . VfELement is my data to represent an Element of refal-expression.  So I have following functions on my Deque: head, tail, cons, snoc, init, last, (++), size"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1488129041, "post_id": 42471130, "comment_id": 72083521, "body": "It looks like you need a generic (not character-based) extended regular expression matcher."}], "owner": {"reputation": 1, "user_id": 3845588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bf301a45e978e0e355c6372880af620?s=128&d=identicon&r=PG&f=1", "display_name": "mixz", "link": "https://stackoverflow.com/users/3845588/mixz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1500092314, "creation_date": 1488126860, "last_edit_date": 1500092314, "question_id": 42471130, "link": "https://stackoverflow.com/questions/42471130/pattern-matching-on-deque", "title": "Pattern matching on deque", "body": "<p>I'm trying to do some pattern matching on deque in haskell, but have some problems. </p>\n\n<p>Here is some explanation for what i'm trying to do.</p>\n\n<p>I'm trying to implement a compiler from Refal to Haskell. Refal is a language that uses pattern matching alot. So a typical refal function looks like this:</p>\n\n<pre><code>    RefalFunc {\n         e.1 s.1 (e.2) 's' t.1 t.2 t.1 e.2 = e.1 e.2\n         e.1 ' ' e.2 = 'foo' e.1 'foo' e.2\n         e.1 = 'anyexpression'\n    }\n</code></pre>\n\n<p>So this function takes an refal-expression (which consists of terms) and try to match it with 1 of 3 patterns, and if it succeeded then transform refal-expression into another according to rules on the right side.</p>\n\n<p>e.1, e.2 .. - means some refal-expressions\nt.1 t.2 - means some terms , for example \"(e.1 t.2 e.2)\" is a term, \"e.1 t.2 e.2\" is not \ns.A s.1   - means symbols\n's' - means symbol 's'. there are some others type of symbols, but it doesn't matter.</p>\n\n<p>In my compiler refal-expressions represent as deques, so for each refal function i need to generate a function, which takes some deque and transform it, according to some pattern. \nSo i have something like this</p>\n\n<pre><code>    myFunc1:: Deque -&gt; Deque\n    myFunc1 deq = if matchPattern1 deq then doSomeWork1\n                  else if matchPattern2 deq then doSomeWork2\n                  ...\n               where matchPattern1 = ...\n                     matchPattern2 = ...\n                     ....\n</code></pre>\n\n<p>So, the main problem is, that I'm realy don't know how to do that matchPattern functions. </p>\n\n<p>So, for given deque I can easily find first(or last) term or symbol, but i'm don't know what to do, when i meet e.1, which means part of the deque with uknown size. </p>\n\n<p>So here's example.\nDeque: ( 5 + 6 ) * 7 * ( 5 + ( 4 + 1 ) ) * ( 5 + 6 ) * ( 5 + 6 ) //every symbol here is an element of the deque, every non-Bracket symbol is a term, every (/<em>some symbols</em>/) is a term</p>\n\n<p>I need to check is this deque match the following patterns (and find an appropriate partition)</p>\n\n<pre><code> pattern1: t.1 e.1 t.1\n pattern2: t.1 '*' e.1 (t.2 e.2) s.1 t.1 e.3 \n</code></pre>\n\n<p>answer for pattern1 : </p>\n\n<pre><code> t.1 = ( 5 + 6 )\n e.1 =  * 7 * ( 5 + ( 4 + 1 ) ) * ( 5 + 6 ) *\n</code></pre>\n\n<p>answer for pattern2 : </p>\n\n<pre><code> t.1 =  ( 5 + 6 )\n e.1 = 7 *\n t.2 = 5\n s.1 = *\n e.2 = + ( 4 + 1 )  \n e.3 =  * ( 5 + 6 )\n</code></pre>\n\n<p>I'm using an implementation of Okasaki CatenableDeque.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 7, "creation_date": 1488116749, "post_id": 42469244, "comment_id": 72079286, "body": "Because if you could do this, there&#39;d be no point in having an IO type in the first place."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1488125301, "post_id": 42469244, "comment_id": 72082182, "body": "Would-be duplicate: <a href=\"http://stackoverflow.com/q/11229854/2751851\"><i>How can I parse the IO String in Haskell?</i></a> (I&#39;m not closing this myself because it might make for a better duplicate target)."}, {"owner": {"reputation": 243, "user_id": 13679816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b02acae66c6a347786eb93e8cbead85?s=128&d=identicon&r=PG", "display_name": "atravers", "link": "https://stackoverflow.com/users/13679816/atravers"}, "edited": false, "score": 0, "creation_date": 1605599273, "post_id": 42469244, "comment_id": 114692379, "body": "Possible duplicate of  <a href=\"https://stackoverflow.com/questions/7154518/unwrapping-a-monad\">stackoverflow.com/questions/7154518/unwrapping-a-monad</a> ."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1488166653, "post_id": 42469581, "comment_id": 72095175, "body": "Great simple explanation for this common question!  &quot;Instead, you put the operation you want to perform into IO, as well!&quot;"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 10, "last_activity_date": 1488122008, "last_edit_date": 1488122008, "creation_date": 1488118485, "answer_id": 42469581, "question_id": 42469244, "link": "https://stackoverflow.com/questions/42469244/write-a-function-from-io-a-a/42469581#42469581", "title": "Write a function from IO a -&gt; a?", "body": "<p>In Haskell, when you want to work with a value that is \"trapped\" in <code>IO</code>, you don't take the value out of <code>IO</code>. Instead, you put the operation you want to perform into <code>IO</code>, as well!</p>\n\n<p>For example, suppose you want to check how many characters the <code>getLine :: IO String</code> will produce, using the <code>length</code> function from Prelude. </p>\n\n<p>There exists a helper function called <a href=\"https://en.wikibooks.org/wiki/Haskell/The_Functor_class\" rel=\"noreferrer\"><code>fmap</code></a> which, when specialized to <code>IO</code>, has the type:</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; IO a -&gt; IO b\n</code></pre>\n\n<p>It takes a function that works on \"pure\" values not trapped in <code>IO</code>, and gives you a function that works with values that are trapped in <code>IO</code>. This means that the code</p>\n\n<pre><code>fmap length getLine :: IO Int\n</code></pre>\n\n<p>represents an <code>IO</code> action that reads a line from console and then gives you its length.</p>\n\n<p><code>&lt;$&gt;</code> is an infix synonym for <code>fmap</code> that can make things simpler. This is equivalent to the above code:</p>\n\n<pre><code>length &lt;$&gt; getLine\n</code></pre>\n\n<p>Now, sometimes the operation you want to perform with the <code>IO</code>-trapped value <em>itself</em> returns an <code>IO</code>-trapped value. Simple example: you wan to write back the string you have just read using <code>putStrLn :: String -&gt; IO ()</code>.</p>\n\n<p>In that case, <code>fmap</code> is not enough. You need to use the <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad.html#v:-62--62--61-\" rel=\"noreferrer\"><code>(&gt;&gt;=)</code></a> operator, which, when specialiced to <code>IO</code>, has the type <code>IO a -&gt; (a -&gt; IO b) -&gt; IO b</code>. In out case:</p>\n\n<pre><code>getLine &gt;&gt;= putStrLn :: IO ()\n</code></pre>\n\n<p>Using <code>(&gt;&gt;=)</code> to chain <code>IO</code> actions has an imperative, sequential flavor. There is a kind of syntactic sugar called <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"noreferrer\">\"do-notation\"</a> which helps to write sequential operation like these in a more natural way:</p>\n\n<pre><code>do line &lt;- getLine\n   putStrLn line\n</code></pre>\n\n<p>Notice that the <code>&lt;-</code> here is not an operator, but part of the syntactic sugar provided by the do notation.</p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 1, "last_activity_date": 1488121679, "creation_date": 1488121679, "answer_id": 42470139, "question_id": 42469244, "link": "https://stackoverflow.com/questions/42469244/write-a-function-from-io-a-a/42470139#42470139", "title": "Write a function from IO a -&gt; a?", "body": "<p>If you know C then consider the question \"How can I get the string from <code>gets</code>?\"  An <code>IO String</code> is not some string that's made hard to get to, it's a procedure that can return a string - like reading from a network or stdin.  You want to <em>run</em> the procedure to obtain a string.</p>\n\n<p>A common way to run IO actions in a sequence is <code>do</code> notation:</p>\n\n<pre><code>main = do\n   someString &lt;- getLine\n   -- someString :: String\n   print someString\n</code></pre>\n\n<p>In the above you run the <code>getLine</code> operation to obtain a <code>String</code> value then use the value however you wish.</p>\n"}, {"tags": [], "owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "is_accepted": false, "score": 2, "last_activity_date": 1488121772, "creation_date": 1488121772, "answer_id": 42470162, "question_id": 42469244, "link": "https://stackoverflow.com/questions/42469244/write-a-function-from-io-a-a/42470162#42470162", "title": "Write a function from IO a -&gt; a?", "body": "<p>Not going into any details, if you're in a <code>do</code> block, you can (informally/inaccurately) consider <code>&lt;-</code> as getting the value out of the IO.</p>\n\n<p>For example, the following function takes a line from <code>getLine</code>, and passes it to a pure function that just takes a String</p>\n\n<pre><code>main = do\n  line &lt;- getLine\n  putStrLn (wrap line)\n\nwrap :: String -&gt; String\nwrap line = \"'\" ++ line ++ \"'\"\n</code></pre>\n\n<p>If you compile this as <code>wrap</code>, and on the command line run</p>\n\n<pre><code>echo \"Hello\" | wrap\n</code></pre>\n\n<p>you should see</p>\n\n<pre><code>'Hello'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2861, "user_id": 2847643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmATO.jpg?s=128&g=1", "display_name": "user2847643", "link": "https://stackoverflow.com/users/2847643/user2847643"}, "is_accepted": false, "score": 0, "last_activity_date": 1488122391, "creation_date": 1488122391, "answer_id": 42470290, "question_id": 42469244, "link": "https://stackoverflow.com/questions/42469244/write-a-function-from-io-a-a/42470290#42470290", "title": "Write a function from IO a -&gt; a?", "body": "<p>So \"generally\", it's unclear why you think you need a function of this type and in this case it makes all the difference.</p>\n\n<p>It should be noted for completeness that it is possible. There indeed exists a function of type <code>IO a -&gt; a</code> in the base library called <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/System-IO-Unsafe.html\" rel=\"nofollow noreferrer\"><code>unsafePerformIO</code></a>.</p>\n\n<p>But the <code>unsafe</code> part is there for a reason. There are few situations where its usage would be considered justified. It's an escape hatch to be used with great caution - most of the time you will let monsters in instead of letting yourself out.</p>\n\n<p>Why can't you normally go from <code>IO a</code> to <code>a</code>? Well at the very least it allows you to break the rules by having a seemingly pure function that is not pure at all - ouch! If it were a common practice to do this the type signatures and all the work done by the compiler to verify them would make no sense at all. All the correctness guarantees would go out of the window.</p>\n\n<p>Haskell is, partly, interesting precisely because this is (normally) impossible.</p>\n\n<p>For how to approach your <code>getLine</code> problem in particular see the other answers.</p>\n"}], "owner": {"reputation": 356, "user_id": 536342, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f354d52ac79638d5bc6b967981ef9945?s=128&d=identicon&r=PG", "display_name": "pikapika", "link": "https://stackoverflow.com/users/536342/pikapika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1488122391, "creation_date": 1488116652, "last_edit_date": 1488118952, "question_id": 42469244, "link": "https://stackoverflow.com/questions/42469244/write-a-function-from-io-a-a", "title": "Write a function from IO a -&gt; a?", "body": "<p>Take the function getLine.</p>\n\n<p>it has a type</p>\n\n<pre><code>getLine :: IO String\n</code></pre>\n\n<p>How do I extract the String from this IO value. More generally, how do I convert this.</p>\n\n<pre><code>IO a\n</code></pre>\n\n<p>to this:</p>\n\n<pre><code>a\n</code></pre>\n\n<p>If this is not possible. Why can't I do this?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "edited": false, "score": 0, "creation_date": 1488126419, "post_id": 42469413, "comment_id": 72082566, "body": "may I know which part of yesod book explains this?"}], "tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": true, "score": 2, "last_activity_date": 1488126957, "last_edit_date": 1488126957, "creation_date": 1488117539, "answer_id": 42469413, "question_id": 42468694, "link": "https://stackoverflow.com/questions/42468694/yesod-hamlet-gethomer-cant-find-reference/42469413#42469413", "title": "Yesod Hamlet getHomeR can&#39;t find reference", "body": "<p>It should be <code>vocabularyDate</code> instead of just <code>date</code>.\nAccording to the persistent section on the <a href=\"http://www.yesodweb.com/book/persistent\" rel=\"nofollow noreferrer\">yesod book</a>, </p>\n\n<pre><code>mkPersist sqlSettings [persistLowerCase|\nPerson\n    name String\n    age Int\n    deriving Show\n|]\n</code></pre>\n\n<p>will generates code which looks like</p>\n\n<pre><code>data Person = Person\n    { personName :: !String\n    , personAge :: !Int\n    }\n  deriving Show\n ...\n</code></pre>\n\n<p>As you can see, the field names are prefixed by the data name (<code>personName</code> instead of <code>name</code>). This is a standard practice in Haskell to avoid name collision.</p>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 42469413, "answer_count": 1, "score": 0, "last_activity_date": 1488126957, "creation_date": 1488113201, "question_id": 42468694, "link": "https://stackoverflow.com/questions/42468694/yesod-hamlet-gethomer-cant-find-reference", "title": "Yesod Hamlet getHomeR can&#39;t find reference", "body": "<pre><code>getHomeR :: Handler Html\ngetHomeR = do\n    wordList &lt;- runDB $ selectList [] [] :: HandlerT App IO [Entity Vocabulary]\n    defaultLayout\n        [whamlet|\n            &lt;ul&gt;\n                $forall Entity wordid wordItem &lt;- wordList\n                    &lt;li&gt;\n                        &lt;a href=@{HomeR}&gt;#{date wordItem}\n        |]\n</code></pre>\n\n<p>I get this error</p>\n\n<pre><code>Variable not in scope: date :: Vocabulary -&gt; a0\n</code></pre>\n\n<p>while I have defined in models:</p>\n\n<pre><code>Vocabulary json\n    word Text\n    date UTCTime\n    deriving Show\n</code></pre>\n\n<p>PS: I'm developing based on the yesod scaffold example: yesod-postgres</p>\n"}, {"tags": ["haskell", "category-theory", "monoids", "semigroup", "category-abstractions"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 4331419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f9af27b67cd85acad4734764045c53?s=128&d=identicon&r=PG&f=1", "display_name": "LorenzoPerticone", "link": "https://stackoverflow.com/users/4331419/lorenzoperticone"}, "edited": false, "score": 0, "creation_date": 1488118439, "post_id": 42468281, "comment_id": 72079808, "body": "I&#39;m not sure I understand why this happens: of course (in general) Nontrivial is not a category, but that&#39;s my point: any category is automatically made into a monoid, whereas Nontrivial is a monoid whenever its type parameters are too. Since Nontrivial is not (made into) a category, I don&#39;t understand what ghc is complaining about."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 77, "user_id": 4331419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f9af27b67cd85acad4734764045c53?s=128&d=identicon&r=PG&f=1", "display_name": "LorenzoPerticone", "link": "https://stackoverflow.com/users/4331419/lorenzoperticone"}, "edited": false, "score": 0, "creation_date": 1488120133, "post_id": 42468281, "comment_id": 72080458, "body": "<i>You</i> know <code>Nontrivial</code> is not a category. The compiler can&#39;t know this; in fact anybody could <i>make</i> it a category by defining an orphan <code>instance Category Nontrivial</code> later on. What of course true is, this couldn&#39;t possibly be <i>well-formed</i> because both the <code>s</code> and <code>q</code> parameters are actually covariant, but the requirement of the first parameter being contravariant is not a law the <code>Category</code> class explicitly mentions in a form that the compiler could understand, so on what grounds is is supposed to reject the possibility of that instance?"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1488111220, "last_edit_date": 1488111220, "creation_date": 1488110915, "answer_id": 42468281, "question_id": 42468135, "link": "https://stackoverflow.com/questions/42468135/relation-between-the-semigroupoid-and-semigroup-classes/42468281#42468281", "title": "Relation between the Semigroupoid and Semigroup classes", "body": "<p>If it only required <code>FlexibleInstances</code> nobody would mind (that extension is totally harmless), but unfortunately it also leads to requiring a very un-harmless other extension as soon as you add sufficiently interesting other instances. Namely,</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n\nimport Control.Category (Category)\n\ninstance Category c =&gt; Monoid (c a a)\n\ndata Nontrivial s q = Nontrivial {\n      someLabel :: String\n    , someValues :: [(s, Int)]\n    , otherValues :: Maybe (String, q)\n    , moreStuff :: ({-...-})\n    }\n\ninstance (Monoid s, Monoid q) =&gt; Monoid (Nontrivial s q) where\n  mempty = Nontrivial \"\" [] Nothing ()\n\nmain = case mempty :: Nontrivial String String of\n  Nontrivial _ _ _ _ -&gt; return ()\n</code></pre>\n\n<p>does not compile:</p>\n\n<pre><code>$ runhaskell  wtmpf-file6064.hs \n\nwtmpf-file6064.hs:17:13:\n    Overlapping instances for Monoid (Nontrivial String String)\n      arising from a use of \u2018mempty\u2019\n    Matching instances:\n      instance Category c =&gt; Monoid (c a a)\n        -- Defined at wtmpf-file6064.hs:5:10\n      instance (Monoid s, Monoid q) =&gt; Monoid (Nontrivial s q)\n        -- Defined at wtmpf-file6064.hs:14:10\n    In the expression: mempty :: Nontrivial String String\n    In the expression:\n      case mempty :: Nontrivial String String of {\n        Nontrivial _ _ _ _ -&gt; return () }\n    In an equation for \u2018main\u2019:\n        main\n          = case mempty :: Nontrivial String String of {\n              Nontrivial _ _ _ _ -&gt; return () }\n</code></pre>\n\n<p>Now, you could get it working by adding <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#instance-overlap\" rel=\"nofollow noreferrer\"><code>{-# OVERLAPPABLE #-}</code> Pragmas</a>, but this is some rather fiddly business and can lead to strange behaviour. Such instances are strongly avoided.</p>\n"}], "owner": {"reputation": 77, "user_id": 4331419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6f9af27b67cd85acad4734764045c53?s=128&d=identicon&r=PG&f=1", "display_name": "LorenzoPerticone", "link": "https://stackoverflow.com/users/4331419/lorenzoperticone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 1, "accepted_answer_id": 42468281, "answer_count": 1, "score": 2, "last_activity_date": 1559485198, "creation_date": 1488110084, "last_edit_date": 1559485198, "question_id": 42468135, "link": "https://stackoverflow.com/questions/42468135/relation-between-the-semigroupoid-and-semigroup-classes", "title": "Relation between the Semigroupoid and Semigroup classes", "body": "<p>In the last week I've been trying to grasp some of Haskell's \"core\" types and type classes (but have been studying Haskell for at most two weeks total), and I've found something that bugs me:</p>\n\n<ul>\n<li>a \"Semigroupoid\" is a generalization of a \"Category\", meaning that any Category is trivially a Semigroupoid, just by ignoring it's own identity and defining </li>\n</ul>\n\n<p><code>o = (.)</code></p>\n\n<ul>\n<li>also a \"Semigroup\" is a generalization of a \"Monoid\", in the exact same connotation as above: one just has to ignore mempty and define</li>\n</ul>\n\n<p><code>(&lt;&gt;) = mappend</code></p>\n\n<p>These two facts alone, and the idea that both Semigroupoids and Semigroups only have a notion of combining elements (semigroupoid-composition vs semigroup-multiplication) and both Category and Monoid also have a notion of \"unity\" (identity vs unit element) bring to mind that one could express relations between Semigroupoids and Semigroups, and between Categories and Monoids as follows</p>\n\n<pre><code>import Prelude hiding (id, (.))\n\nimport Data.Semigroupoid\nimport Data.Semigroup\n\nimport Control.Category\nimport Data.Monoid\n\ninstance Semigroupoid c =&gt; Semigroup (c a a) where\n    (&lt;&gt;) = o\n\ninstance Category c =&gt; Monoid (c a a) where\n    mempty = id\n    mappend = (.)\n\nmain = putStrLn \"Does not type-check!\"\n</code></pre>\n\n<p>Now, I'm not sure why this doesn't compile; the ghc compiler says:</p>\n\n<pre><code>All instance types must be of the form (T a1 ... an)\nwhere a1 ... an are *distinct type variables*,\nand each type variable appears at most once in the instance head.\n</code></pre>\n\n<p>but it happens that including</p>\n\n<p><code>{-# LANGUAGE FlexibleInstances #-}</code></p>\n\n<p>on top of the file fixes everything.</p>\n\n<p>The relations expressed above don't seem to be built in the libraries, while the relations between Semigroupoid and Category, and between Semigroup and Monoid are be built in.</p>\n\n<p>Is there any specific reason for this, and I'm just missing it?</p>\n\n<p>Maybe it has something to do with the mysterious \"FlexibleInstances\"?</p>\n\n<p>Any insight would be greatly appreciated.</p>\n"}, {"tags": ["haskell", "pattern-matching"], "answers": [{"tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": false, "score": 3, "last_activity_date": 1539533206, "last_edit_date": 1539533206, "creation_date": 1488097165, "answer_id": 42466272, "question_id": 42466255, "link": "https://stackoverflow.com/questions/42466255/namedfieldpuns-pattern-matching-using-variable-name/42466272#42466272", "title": "NamedFieldPuns, Pattern matching using variable name", "body": "<p>Record punning with <code>Factory{fId}</code> is only syntactic sugar which GHC expands to <code>Factory{fId=fId}</code>. This declared a variable named <code>fId</code>  with the value of the field named <code>fId</code> from the <code>Factory</code> record.</p>\n\n<p>Furthermore, pattern matching only declares variables. It does not allow you to compare them by repeating the same name. Consider an attempt to compare equality:</p>\n\n<pre><code>eq a a = True\neq _ _ = False\n</code></pre>\n\n<p>This is a simple example that tried to do the same thing you are. It will not compile, though.</p>\n\n<p>In the same way, the compiler complains because you declare two variables when you do <code>(Link fId _ _)</code>. This is not allowed. Instead you need to use another name and explicitly compare the two:</p>\n\n<pre><code>hasLinkTo Factory{fId} (Link fInd' _ _) = fId == fId' \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1488103401, "creation_date": 1488103401, "answer_id": 42467109, "question_id": 42466255, "link": "https://stackoverflow.com/questions/42466255/namedfieldpuns-pattern-matching-using-variable-name/42467109#42467109", "title": "NamedFieldPuns, Pattern matching using variable name", "body": "<p>Haskell only allows linear patterns, where each variable can appear at most once. I believe that this was a deliberate design choice. Theoretically speaking</p>\n\n<pre><code>case e1 of C x x y -&gt; e2 ; ...\n</code></pre>\n\n<p>could be automatically translated to</p>\n\n<pre><code>case e1 of C x1 x2 y | x1==x2 -&gt; e2 ; ...\n</code></pre>\n\n<p>This would mean that non linear patterns require an additional <code>Eq</code> constraint for the types of non-linear variables. Further, it could be argued that it is possible for a programmer to accidentally reuse a variable by mistake, which would be silently ignored and lead to the unintended semantics if we allowed non-linear patterns.</p>\n\n<p>Probably, the Haskell designers felt that adding <code>| x1==x2</code> to a pattern was not too cumbersome and makes the intent more explicit.</p>\n\n<p>For numeric literals, however, they kept this translation. A pattern</p>\n\n<pre><code>case e1 of K 0 y z -&gt; e2 ; ...\n</code></pre>\n\n<p>does translate to</p>\n\n<pre><code>case e1 of K x y z | x==0 -&gt; e2 ; ...\n</code></pre>\n\n<p>and does require <code>Eq</code>. Since <code>0</code> is not a variable, we no longer have the issues of non-linear patterns.</p>\n\n<p>Anyway, the idiomatic way is to add guards like <code>| x1==x2</code> to non-liner patterns.\nYou can't use only pattern matching for this at the moment.</p>\n"}], "owner": {"reputation": 2141, "user_id": 1664572, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c2bee27fdb72050b60a3c6aae64b474f?s=128&d=identicon&r=PG", "display_name": "wizzup", "link": "https://stackoverflow.com/users/1664572/wizzup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2257, "favorite_count": 0, "accepted_answer_id": 42467109, "answer_count": 2, "score": 2, "last_activity_date": 1539533206, "creation_date": 1488096998, "last_edit_date": 1488116194, "question_id": 42466255, "link": "https://stackoverflow.com/questions/42466255/namedfieldpuns-pattern-matching-using-variable-name", "title": "NamedFieldPuns, Pattern matching using variable name", "body": "<pre><code>{-# LANGUAGE NamedFieldPuns #-}\n\ndata Factory = Factory { fId :: Int}\ndata Link = Link Int Int Double\n\nhasLinkTo :: Factory -&gt; Link -&gt; Bool\nhasLinkTo Factory{fId} (Link fId _  _) = True\n</code></pre>\n\n<p>Got error</p>\n\n<pre><code>\u2022 Conflicting definitions for \u2018fId\u2019 Bound at: &lt;source.hs&gt; In an equation for \u2018hasLinkTo\u2019\n</code></pre>\n\n<p>I know using variables could fix it,</p>\n\n<pre><code>hasLinkTo Factory{fId=a} (Link b _  _) = a == b\n</code></pre>\n\n<p><strong>I want to ask for</strong> </p>\n\n<ul>\n<li>reason of compilation fail, to better understand how pattern matching work.</li>\n<li>is there any idiomatic way to write the function?</li>\n</ul>\n\n<p>for example: if I want to extract what link to a node <code>i</code>, I want to write something like this</p>\n\n<pre><code>connected :: Int -&gt; Link -&gt; (Int, Double)\nconnected i (Link i j d) = (j,d)\nconnected i (Link j i d) = (j,d)\n</code></pre>\n\n<p>Is there any way to check for (==) using only pattern matching on non-numeric literals? </p>\n\n<p><code>connected 0 (Link 0 j d) = (j,d)</code> is working fine. but the above example won't.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1488076243, "post_id": 42463938, "comment_id": 72070078, "body": "Did you try to read the error message carefully? If so what is confusing you about it?"}, {"owner": {"reputation": 3, "user_id": 7623282, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vK0uHP1ZWwk/AAAAAAAAAAI/AAAAAAAADjM/wQgCPoXoopM/photo.jpg?sz=128", "display_name": "JiaMing Wang", "link": "https://stackoverflow.com/users/7623282/jiaming-wang"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1488076848, "post_id": 42463938, "comment_id": 72070197, "body": "I dont understand how to make them match..."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1488079615, "post_id": 42463938, "comment_id": 72070667, "body": "What should <code>getCodePermanent</code> do when passed an <code>Inscription</code>? What does your code say? When you call <code>getCodePermanent (etu)</code>, you are passing <code>getCodePermanent</code> a <b>list</b> of <code>Inscription</code>s, but it expects a single <code>Etudiant</code>."}, {"owner": {"reputation": 3, "user_id": 7623282, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vK0uHP1ZWwk/AAAAAAAAAAI/AAAAAAAADjM/wQgCPoXoopM/photo.jpg?sz=128", "display_name": "JiaMing Wang", "link": "https://stackoverflow.com/users/7623282/jiaming-wang"}, "edited": false, "score": 0, "creation_date": 1488082448, "post_id": 42463938, "comment_id": 72071150, "body": "Ok my goal is to get the group course number(noGroupe) of the student x (passed in parameter : Etudiant) for the semester code 32003 (codeSession = 32003). So first i have to get the list of course that have as semester code : 32003 And then in that list i have to locate the codePermanent that matches the Etudiant passed in parameter of numGroupeCoursEtu to finally get the list of the course number (NoCours) that the student is following"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1488099023, "post_id": 42463938, "comment_id": 72074425, "body": "<code>numGroupesCoursEtu</code> does to much in a single line. Break it apart and implement each step in your previous comment each as a top level function. When you get it working you can put these functions into a where clause."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7623282, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vK0uHP1ZWwk/AAAAAAAAAAI/AAAAAAAADjM/wQgCPoXoopM/photo.jpg?sz=128", "display_name": "JiaMing Wang", "link": "https://stackoverflow.com/users/7623282/jiaming-wang"}, "edited": false, "score": 0, "creation_date": 1488123290, "post_id": 42466593, "comment_id": 72081579, "body": "Thanks! i add those two lines : getCodePermanent2 :: Inscription -&gt; CodePermanent getCodePermanent2 (Inscription codePermanent _ _ _ _ _ _) = codePermanent And now its working!"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 3, "user_id": 7623282, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vK0uHP1ZWwk/AAAAAAAAAAI/AAAAAAAADjM/wQgCPoXoopM/photo.jpg?sz=128", "display_name": "JiaMing Wang", "link": "https://stackoverflow.com/users/7623282/jiaming-wang"}, "edited": false, "score": 0, "creation_date": 1488123362, "post_id": 42466593, "comment_id": 72081597, "body": "@JiaMingWang that is the idea. Although, I suggest finding a better name."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "reply_to_user": {"reputation": 3, "user_id": 7623282, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vK0uHP1ZWwk/AAAAAAAAAAI/AAAAAAAADjM/wQgCPoXoopM/photo.jpg?sz=128", "display_name": "JiaMing Wang", "link": "https://stackoverflow.com/users/7623282/jiaming-wang"}, "edited": false, "score": 0, "creation_date": 1488126592, "post_id": 42466593, "comment_id": 72082626, "body": "@JiaMingWang please remember to accept my answer when you are able"}], "tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": true, "score": 0, "last_activity_date": 1488100103, "last_edit_date": 1488100103, "creation_date": 1488099606, "answer_id": 42466593, "question_id": 42463938, "link": "https://stackoverflow.com/questions/42463938/haskell-couldnt-match-type/42466593#42466593", "title": "Haskell Couldn&#39;t match type", "body": "<p>getCodePermanent :: Etudiant -> CodePermanent</p>\n\n<p>Note that <code>getCodePermanent</code> takes a <code>Etudiant</code> as a parameter.</p>\n\n<pre><code>(\\x -&gt; getCodePermanent(x) == getCodePermanent(etu))\n</code></pre>\n\n<p>Presumably you are trying to check if a <code>Inscription</code> has the same <code>CodePermanent</code> as the given <code>Etudiant</code>. But as I said earlier, <code>getCodePermanent</code> takes a <code>Etudiant</code> as a parameter. You need to write another function to get the <code>CodePermanent</code> from a <code>Inscription</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 7623282, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-vK0uHP1ZWwk/AAAAAAAAAAI/AAAAAAAADjM/wQgCPoXoopM/photo.jpg?sz=128", "display_name": "JiaMing Wang", "link": "https://stackoverflow.com/users/7623282/jiaming-wang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 400, "favorite_count": 0, "accepted_answer_id": 42466593, "answer_count": 1, "score": -2, "last_activity_date": 1488100103, "creation_date": 1488075065, "question_id": 42463938, "link": "https://stackoverflow.com/questions/42463938/haskell-couldnt-match-type", "title": "Haskell Couldn&#39;t match type", "body": "<p>The program is suppose to deal with student in university</p>\n\n<pre><code>data Etudiant = Etudiant CodePermanent Nom Prenom CodeProgramme deriving Show\ndata Inscription = Inscription CodePermanent Sigle NoGroupe CodeSession Date Date Note deriving (Show, Eq)\n\ngetCodePermanent :: Etudiant -&gt; CodePermanent\ngetCodePermanent (Etudiant codePermanent _ _ _) = codePermanent\n\nlisteInscription :: Inscription -&gt; Bool\nlisteInscription (Inscription _ _ _ codeSession _ _ _) = codeSession == 32003\n\nfiltreInscription1 :: [Inscription] -&gt; [Inscription]\nfiltreInscription1 linscription = filter listeInscription linscription\n\ngetNoGroupe2 :: Inscription -&gt; NoGroupe\ngetNoGroupe2 (Inscription _ _ noGroupe _ _ _ _) = noGroupe\n\nnumGroupesCoursEtu :: [Inscription] -&gt; Etudiant -&gt; [NoGroupe]\nnumGroupesCoursEtu listeInscr etu = map getNoGroupe2(filter (\\x -&gt; getCodePermanent(x) == getCodePermanent(etu)) listeInscr)\n</code></pre>\n\n<p>The goal of the fonctions here is to extract from the list [Inscription] a list [NoGroupe] that match the session code 32003 and the id of the student : CodePermanent</p>\n\n<p>My last line of code gives back an error with the types... Can you guys see the problem? </p>\n\n<p>the error : </p>\n\n<pre><code>TP1.hs:115:54: error:\n\u2022 Couldn't match type \u2018Etudiant\u2019 with \u2018Inscription\u2019\n  Expected type: [Inscription]\n    Actual type: [Etudiant]\n\u2022 In the second argument of \u2018map\u2019, namely\n    \u2018(filter\n        (\\ x -&gt; getCodePermanent (x) == getCodePermanent (etu))\n        listeInscr)\u2019\n  In the expression:\n    map\n      getNoGroupe2\n      (filter\n         (\\ x -&gt; getCodePermanent (x) == getCodePermanent (etu)) listeInscr)\n  In an equation for \u2018numGroupesCoursEtu\u2019:\n      numGroupesCoursEtu listeInscr etu\n        = map\n            getNoGroupe2\n            (filter\n               (\\ x -&gt; getCodePermanent (x) == getCodePermanent (etu)) listeInscr)\n\nTP1.hs:115:114: error:\n\u2022 Couldn't match type \u2018Inscription\u2019 with \u2018Etudiant\u2019\n  Expected type: [Etudiant]\n    Actual type: [Inscription]\n\u2022 In the second argument of \u2018filter\u2019, namely \u2018listeInscr\u2019\n  In the second argument of \u2018map\u2019, namely\n    \u2018(filter\n        (\\ x -&gt; getCodePermanent (x) == getCodePermanent (etu))\n        listeInscr)\u2019\n  In the expression:\n    map\n      getNoGroupe2\n      (filter\n         (\\ x -&gt; getCodePermanent (x) == getCodePermanent (etu)) listeInscr)\n</code></pre>\n\n<p>line 115 is the last line of code numGroupesCoursEtu.....</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 6, "creation_date": 1488068245, "post_id": 42462766, "comment_id": 72068528, "body": "<code>\u2200 a . Show a =&gt; a</code> is isomorphic to <code>String</code>. So why not just store a plain old string?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1488071134, "post_id": 42462766, "comment_id": 72069129, "body": "@leftaroundabout If he wants to have an <code>Eq</code> instance, he really wants more than <code>Show</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1488106320, "post_id": 42462766, "comment_id": 72076244, "body": "@Alec: you obviously get an <code>Eq</code> instance with <code>String</code> as well, and it has rather less obscure semantics than <code>\u2200 a . (Typeable a, Eq a) =&gt; a</code>, what with <code>(37 :: Int) &#47;= (37 :: Integer)</code> and the like. (I&#39;m not saying <code>(37 :: Int) == (37 :: Integer)</code> would necessarily be better, but if you simply store just monomorphic plain data such questions don&#39;t even arise.)"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1488071184, "post_id": 42463558, "comment_id": 72069137, "body": "A cute spelling for <code>maybe False (==a) (cast b)</code> is <code>Just a == cast b</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1488071836, "post_id": 42463558, "comment_id": 72069274, "body": "@DanielWagner Derp."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 5, "last_activity_date": 1488071796, "last_edit_date": 1488071796, "creation_date": 1488071145, "answer_id": 42463558, "question_id": 42462766, "link": "https://stackoverflow.com/questions/42462766/different-types-comparising-in-haskell/42463558#42463558", "title": "different types comparising in Haskell", "body": "<p>This is definitely possible if you are willing to add <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Typeable.html\" rel=\"nofollow noreferrer\"><code>Typeable</code></a> and <code>Eq</code> to <code>Show</code> in the constraints in <code>Property</code>.</p>\n\n<pre><code>import Data.Typeable\n\ndata Property = forall a. (Show a, Eq a, Typeable a) =&gt; Property a\n\ninstance Eq Property where\n  Property a == Property b = Just a == cast b\n</code></pre>\n"}], "owner": {"reputation": 1131, "user_id": 2615160, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6c82d2b99325ea24eedae70d7ea24bc8?s=128&d=identicon&r=PG", "display_name": "Sergey Sosnin", "link": "https://stackoverflow.com/users/2615160/sergey-sosnin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 42463558, "answer_count": 1, "score": 0, "last_activity_date": 1488071796, "creation_date": 1488064509, "question_id": 42462766, "link": "https://stackoverflow.com/questions/42462766/different-types-comparising-in-haskell", "title": "different types comparising in Haskell", "body": "<p>I have objects with some different properties, like that:</p>\n\n<pre><code>newtype Symbol = Symbol String\nnewtype Charge = Charge Int\n...\n</code></pre>\n\n<p>In principle, the second argument may be arbitrary: <code>String</code>, <code>Int</code>, <code>Float</code> and so on. </p>\n\n<p>I have a datatype that wraps these types:</p>\n\n<pre><code>data Property = forall a. (Show a) =&gt; Property a\n</code></pre>\n\n<p>But I need the way how to compare these instances. If I write something like that: </p>\n\n<pre><code>instance Eq Property where\n    (Property a) == (Property b) = a == b\n</code></pre>\n\n<p>It fails because compiler doesn't know types of a and b. </p>\n\n<p>The question is, how to make <code>Eq</code> instance of <code>Property</code> with such logic:</p>\n\n<ol>\n<li>If <code>a</code> and <code>b</code> are different types i.e. <code>Symbol</code> vs <code>Charge</code> it is always <code>False</code>.</li>\n<li>If <code>a</code> and <code>b</code> belongs to the same type, check <code>a == b</code> </li>\n</ol>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1488063663, "post_id": 42462581, "comment_id": 72067401, "body": "I doubt you can win much by parallelizing this function. There&#39;s not much of interesting computation here, performance is very much bound by the cache-performance of all those lists. Switch at least to <a href=\"http://hackage.haskell.org/package/text\" rel=\"nofollow noreferrer\"><code>Text</code></a> or <a href=\"http://hackage.haskell.org/package/bytestring\" rel=\"nofollow noreferrer\"><code>Bytestring</code></a> before considering any more special optimisations."}], "answers": [{"tags": [], "owner": {"reputation": 1668, "user_id": 4050960, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2433d3125076f5789fe82a2eae87fdd1?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Aguilar", "link": "https://stackoverflow.com/users/4050960/chuck-aguilar"}, "is_accepted": false, "score": 0, "last_activity_date": 1501669793, "creation_date": 1501669793, "answer_id": 45458299, "question_id": 42462581, "link": "https://stackoverflow.com/questions/42462581/haskell-parallel-programming/45458299#45458299", "title": "haskell parallel programming", "body": "<p>I saw your post now. There're many ways to make a parallel computing. </p>\n\n<p>You could read this three libraries:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/parallel-3.2.1.1/docs/Control-Parallel.html\" rel=\"nofollow noreferrer\">Control.Parallel</a> </p>\n\n<p><a href=\"https://hackage.haskell.org/package/parallel-3.2.1.1/docs/Control-Parallel-Strategies.html\" rel=\"nofollow noreferrer\">Control.Parallel.Strategies</a></p>\n\n<p><a href=\"https://hackage.haskell.org/package/monad-par-0.3.4.8/docs/Control-Monad-Par.html\" rel=\"nofollow noreferrer\">Control.Monad.Par</a> (for monads)</p>\n\n<p>Then, I use to use two ways:</p>\n\n<pre><code>right `par` \nleft `pseq` \nleft ++ right\n</code></pre>\n\n<p>and </p>\n\n<pre><code>result `using` strategy\n  where\n    result = losort ++ (x:hisort)\n    losort = quicksortP1 [y|y &lt;- xs, y &lt; x]\n    hisort = quicksortP1 [y|y &lt;- xs, y &gt;= x]\n    strategy = parList rseq \n</code></pre>\n\n<p>here some results:</p>\n\n<pre><code>-- parList rpar     -- 2m42s N=4\n-- parList rseq     -- 38.3s N=4\n-- parList r0       -- 57.3s N=4\n-- parList rdeepseq -- 2m40s N=4\n-- r0               -- 48.5s N=4\n</code></pre>\n\n<p>and if you want to get deep :) </p>\n\n<pre><code>    result = losort ++ (x:hisort)\n    (losort,hisort) = \n      ( quicksortP2 [y|y &lt;- xs, y &lt; x]\n      , quicksortP2 [y|y &lt;- xs, y &gt;= x]\n      ) `using` strategy \n    strategy = \n            parTuple2 rdeepseq rdeepseq -- 17.9s N=4\n--             parTuple2 rdeepseq rseq  -- 18.0s N=4            \n--             parTuple2 rdeepseq r0    -- 42s N=4 \n--             parTuple2 rseq     rseq  -- 23.8s N=4\n--             parTuple2 rpar     rpar  -- 26.9s N=4\n--             parTuple2 r0       r0    -- 47.6s N=4\n--             r0                       -- 46.2s N=4\n</code></pre>\n\n<p>where <code>N</code> is the number of processors I used. </p>\n\n<p>So, knowing it, you could easily adapt it.</p>\n\n<p>And for compiling:</p>\n\n<pre><code>&gt; ghc MyProg.hs -threaded -rtsopts\n&gt; ./MyProg +RTS -N4 -s\n</code></pre>\n\n<p>I hope I can help someone. </p>\n"}], "owner": {"reputation": 68, "user_id": 7453834, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f55f74b22f7a443280b5ebe12faf942e?s=128&d=identicon&r=PG&f=1", "display_name": "Hasan Mozumder", "link": "https://stackoverflow.com/users/7453834/hasan-mozumder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1501669793, "creation_date": 1488063270, "question_id": 42462581, "link": "https://stackoverflow.com/questions/42462581/haskell-parallel-programming", "title": "haskell parallel programming", "body": "<pre><code>import Data.List\n\ngenkstrings :: Int -&gt; [String] -&gt; [String]\ngenkstrings k [] = []\ngenkstrings 1 (s:ss) = [ [c] | c &lt;- s ] ++ genkstrings 1 ss\ngenkstrings k (s:ss)\n  | length (s:ss) &lt; k = []\n  | otherwise = concat [kStartWith k c ss | c &lt;- s ]\n                ++\n                genkstrings k ss\n\nkStartWith k c ss =\n map (c :) $ genkstringsNogap (k-1) ss\n\ngenkstringsNogap 0 _ = []\ngenkstringsNogap 1 (s:ss) = [ [c] | c &lt;- s ]\ngenkstringsNogap k (s:ss) = concat $ [kStartWithNoGap k c ss | c &lt;- s ]\n\nkStartWithNoGap k c ss = map (c:) (genkstringsNogap (k-1) ss)\n</code></pre>\n\n<p>Input: <code>genkstrings 2 [\"sds\",\"ghghg\"]</code></p>\n\n<p>Output:</p>\n\n<pre><code>[\"sg\",\"sh\",\"sg\",\"sh\",\"sg\",\"dg\",\"dh\",\"dg\",\"dh\",\"dg\",\"sg\",\"sh\",\"sg\",\"sh\",\"sg\"]\n</code></pre>\n\n<p>I am learning Haskell and I found I can run my code paralleled. I found some examples in the books that I am reading but I don't understand how can I apply Parallel programming it.</p>\n\n<p>if I am correct I should apply it on this line</p>\n\n<pre><code>| otherwise = concat [kStartWith k c ss | c &lt;- s ]\n                    ++\n                    genkstrings k ss\n</code></pre>\n\n<p>How can I do it?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1488056463, "post_id": 42461504, "comment_id": 72065257, "body": "This is just an indentation issue."}, {"owner": {"reputation": 7, "user_id": 5380463, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dcc0bc819fbaf1e59dac91c98f932d6?s=128&d=identicon&r=PG&f=1", "display_name": "carl123", "link": "https://stackoverflow.com/users/5380463/carl123"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1488056838, "post_id": 42461504, "comment_id": 72065386, "body": "and where is that causing the problem?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1488056901, "post_id": 42461504, "comment_id": 72065412, "body": "Indent <code>where</code> more."}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 5380463, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dcc0bc819fbaf1e59dac91c98f932d6?s=128&d=identicon&r=PG&f=1", "display_name": "carl123", "link": "https://stackoverflow.com/users/5380463/carl123"}, "edited": false, "score": 0, "creation_date": 1488057328, "post_id": 42461619, "comment_id": 72065552, "body": "Ok, your way seemed to work but why can I have &#39;where&#39; on its own line?"}, {"owner": {"reputation": 237, "user_id": 4355151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pIXuHK643rM/AAAAAAAAAAI/AAAAAAAAAKI/FG5TNHAr07U/photo.jpg?sz=128", "display_name": "digitalis_", "link": "https://stackoverflow.com/users/4355151/digitalis"}, "reply_to_user": {"reputation": 7, "user_id": 5380463, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dcc0bc819fbaf1e59dac91c98f932d6?s=128&d=identicon&r=PG&f=1", "display_name": "carl123", "link": "https://stackoverflow.com/users/5380463/carl123"}, "edited": false, "score": 0, "creation_date": 1488057600, "post_id": 42461619, "comment_id": 72065634, "body": "@carl123; It&#39;s just a stylistic thing: I like to save space by putting the first declaration on the same line as <code>where</code> \u2013 but as long as you align all the declarations Haskell doesn&#39;t mind."}, {"owner": {"reputation": 7, "user_id": 5380463, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dcc0bc819fbaf1e59dac91c98f932d6?s=128&d=identicon&r=PG&f=1", "display_name": "carl123", "link": "https://stackoverflow.com/users/5380463/carl123"}, "edited": false, "score": 0, "creation_date": 1488065134, "post_id": 42461619, "comment_id": 72067782, "body": "Oh ok. I see. Thanks"}, {"owner": {"reputation": 237, "user_id": 4355151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pIXuHK643rM/AAAAAAAAAAI/AAAAAAAAAKI/FG5TNHAr07U/photo.jpg?sz=128", "display_name": "digitalis_", "link": "https://stackoverflow.com/users/4355151/digitalis"}, "reply_to_user": {"reputation": 7, "user_id": 5380463, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dcc0bc819fbaf1e59dac91c98f932d6?s=128&d=identicon&r=PG&f=1", "display_name": "carl123", "link": "https://stackoverflow.com/users/5380463/carl123"}, "edited": false, "score": 0, "creation_date": 1488075512, "post_id": 42461619, "comment_id": 72069951, "body": "@carl123; if the answer solved your problem, consider accepting it."}, {"owner": {"reputation": 7, "user_id": 5380463, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dcc0bc819fbaf1e59dac91c98f932d6?s=128&d=identicon&r=PG&f=1", "display_name": "carl123", "link": "https://stackoverflow.com/users/5380463/carl123"}, "edited": false, "score": 0, "creation_date": 1488079253, "post_id": 42461619, "comment_id": 72070601, "body": "Yes it solved the problem and how do I go about accepting it?"}, {"owner": {"reputation": 237, "user_id": 4355151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pIXuHK643rM/AAAAAAAAAAI/AAAAAAAAAKI/FG5TNHAr07U/photo.jpg?sz=128", "display_name": "digitalis_", "link": "https://stackoverflow.com/users/4355151/digitalis"}, "reply_to_user": {"reputation": 7, "user_id": 5380463, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dcc0bc819fbaf1e59dac91c98f932d6?s=128&d=identicon&r=PG&f=1", "display_name": "carl123", "link": "https://stackoverflow.com/users/5380463/carl123"}, "edited": false, "score": 0, "creation_date": 1488137173, "post_id": 42461619, "comment_id": 72086621, "body": "@carl123; There should be a grey tick next to the answer. See <a href=\"http://meta.stackexchange.com/a/5235\">here</a>."}], "tags": [], "owner": {"reputation": 237, "user_id": 4355151, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-pIXuHK643rM/AAAAAAAAAAI/AAAAAAAAAKI/FG5TNHAr07U/photo.jpg?sz=128", "display_name": "digitalis_", "link": "https://stackoverflow.com/users/4355151/digitalis"}, "is_accepted": false, "score": 2, "last_activity_date": 1488057305, "last_edit_date": 1488057305, "creation_date": 1488056974, "answer_id": 42461619, "question_id": 42461504, "link": "https://stackoverflow.com/questions/42461504/new-to-haskell-and-im-getting-this-error-when-i-compile-this-in-ghci-can-figur/42461619#42461619", "title": "New to haskell and I&#39;m getting this error when I compile this in ghci, can figure out why. Everything seems to be right", "body": "<p>As @leftaroundabout says: this is just a problem with the way you've indented the code. Here is a working version:</p>\n\n<pre><code>n :: Int\nn = a `div` length xs\n  where a = 10\n        xs = [1..5]\n\nmain :: IO ()\nmain = print n    -- =&gt; 2\n</code></pre>\n\n<p>Indentation in Haskell is actually (for the most part\u00b9) very intuitive.</p>\n\n<blockquote>\n  <p><strong>The golden rule of indentation.</strong>\n  Code which is part of some expression should be indented further in than the beginning of that expression (even if the expression is not the leftmost element of the line).</p>\n</blockquote>\n\n<p>\u00b9There is one little confusing exception, to do with placing an <code>if</code> statement in a <code>do</code> block (but you hardly ever have to worry about this). Look <a href=\"https://en.wikibooks.org/wiki/Haskell/Indentation#if_within_do\" rel=\"nofollow noreferrer\">here</a> for more info.</p>\n\n<p>Source: Haskell Wikibook, <a href=\"https://en.wikibooks.org/wiki/Haskell/Indentation#The_golden_rule_of_indentation\" rel=\"nofollow noreferrer\">https://en.wikibooks.org/wiki/Haskell/Indentation#The_golden_rule_of_indentation</a></p>\n"}], "owner": {"reputation": 7, "user_id": 5380463, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/2dcc0bc819fbaf1e59dac91c98f932d6?s=128&d=identicon&r=PG&f=1", "display_name": "carl123", "link": "https://stackoverflow.com/users/5380463/carl123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1488058094, "creation_date": 1488056316, "last_edit_date": 1488058094, "question_id": 42461504, "link": "https://stackoverflow.com/questions/42461504/new-to-haskell-and-im-getting-this-error-when-i-compile-this-in-ghci-can-figur", "title": "New to haskell and I&#39;m getting this error when I compile this in ghci, can figure out why. Everything seems to be right", "body": "<pre><code>n = a `div` length xs\nwhere \n   a = 10\n   xs = [1,2,3,4,5]\n</code></pre>\n\n<p>This is the error message i got</p>\n\n<pre><code>test.hs:27:8: parse error on input `xs'\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I've tried renaming the 'xs' to a different name but it doesn't seem to fix it</p>\n"}, {"tags": ["haskell", "uuid", "haskell-spock"], "answers": [{"comments": [{"owner": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "edited": false, "score": 0, "creation_date": 1488092071, "post_id": 42460759, "comment_id": 72072875, "body": "That did it.And something new for me to learn. liftIO, Monad Transformer stack ? Well, well, I will get there eventually. Now the show is returning <code>Just 03fcbcbe-fbf0-11e6-8001-a8667f260e4c</code> because uuid is a [Maybe UUID] I suppose. I think I will figure out how to get the actuall value from that somehow and post the full correct result here. Thanks a million."}], "tags": [], "owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "is_accepted": true, "score": 2, "last_activity_date": 1488057439, "last_edit_date": 1488057439, "creation_date": 1488051728, "answer_id": 42460759, "question_id": 42460391, "link": "https://stackoverflow.com/questions/42460391/haskell-spock-io-within-get-route-actionctxt-error/42460759#42460759", "title": "Haskell Spock IO within GET Route ActionCtxT Error", "body": "<blockquote>\n  <p>So I thought, since I am in IO and work with another IO</p>\n</blockquote>\n\n<p>That's the trouble here, when you're routing in Spock, you're not in IO. The error message tells you what context you're really in: <code>ActionCtxT ctx0 m0</code>. According to <a href=\"https://hackage.haskell.org/package/Spock-0.10.0.1/docs/Web-Spock-Shared.html#t:SpockActionCtx\" rel=\"nofollow noreferrer\">the docs</a>, that's a <a href=\"https://en.wikibooks.org/wiki/Haskell/Monad_transformers\" rel=\"nofollow noreferrer\">monad transformer stack</a> that bundles effects and state.</p>\n\n<p>You can \"lift\" an IO computation into the right type using <code>liftIO</code>. </p>\n\n<pre><code>get (\"id\") $ do\n    uuid &lt;- liftIO nextUUID\n    json . pack $ show $ uuid\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "is_accepted": false, "score": 0, "last_activity_date": 1488316682, "creation_date": 1488316682, "answer_id": 42518909, "question_id": 42460391, "link": "https://stackoverflow.com/questions/42460391/haskell-spock-io-within-get-route-actionctxt-error/42518909#42518909", "title": "Haskell Spock IO within GET Route ActionCtxT Error", "body": "<p>Based on Libbys helpful answer I just added the catch for the <code>Nothing</code> of the <code>Maybe UUID</code>. Here the full programm:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\n\nmodule Main where\n\nimport Web.Spock hiding (head)\nimport Web.Spock.Config\n\nimport Data.UUID.V1\nimport Data.Pool\nimport Control.Monad.IO.Class\nimport Database.PostgreSQL.Simple\nimport Data.Aeson (Value(Null))\n\nimport qualified Network.HTTP.Types.Status as Http\n\ntype AppAction a = SpockActionCtx () Connection AppSession AppState a\ndata AppState = EmptyState\ndata AppSession = EmptySession\n\n\nmain :: IO ()\nmain =\n  do pool&lt;-createPool (connect (ConnectInfo \"localhost\" 5432 \"\" \"\" \"envelopes\") ) close 1 10 10\n     spockCfg &lt;- defaultSpockCfg EmptySession (PCPool pool) EmptyState\n     runSpock 8080 (spock spockCfg app)\n\napp :: SpockM Connection AppSession AppState ()\napp = do \n    get (\"json/id\") $ do\n      uuid&lt;-liftIO nextUUID\n      case uuid of\n        Nothing -&gt; do \n          setStatus Http.status500\n          json Null\n        Just x  -&gt; json $ show x\n</code></pre>\n"}], "owner": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 42460759, "answer_count": 2, "score": 0, "last_activity_date": 1488316682, "creation_date": 1488049648, "question_id": 42460391, "link": "https://stackoverflow.com/questions/42460391/haskell-spock-io-within-get-route-actionctxt-error", "title": "Haskell Spock IO within GET Route ActionCtxT Error", "body": "<p>I try to return a uuid within a route definition for a web app (<a href=\"https://hackage.haskell.org/package/Spock\" rel=\"nofollow noreferrer\">Spock</a> Webserver).</p>\n\n<p>A route is pretty simple to define</p>\n\n<pre><code>get(\"PATH\") $ do\n text \"Hello World\"\n</code></pre>\n\n<p>Now I try to return a uuid via <code>nextRandom</code> from the <a href=\"https://hackage.haskell.org/package/uuid-1.3.13/docs/Data-UUID-V1.html\" rel=\"nofollow noreferrer\">Data.UUID.V1</a> module.\nThe function returns a <code>IO(Maybe UUID)</code> value.</p>\n\n<p>So I thought, since I am in IO and work with another IO I have to do bind the value simply with <code>&lt;-</code>, like so:</p>\n\n<pre><code>get (\"id\") $ do\n    uuid&lt;-nextUUID\n    json . pack $ show $ uuid\n</code></pre>\n\n<p>But the compiler says no:</p>\n\n<pre><code>Couldn't match type \u2018ActionCtxT ctx0 m0\u2019 with \u2018IO\u2019\n      Expected type: IO b0\n        Actual type: ActionCtxT ctx0 m0 b0\n    \u2022 In a stmt of a 'do' block: json . pack $ show $ uuid\n      In the second argument of \u2018($)\u2019, namely\n        \u2018do { uuid &lt;- nextUUID;\n              json . pack $ show $ uuid }\u2019\n</code></pre>\n\n<p>Why is it throwing that error?\nI could easily create the uuid with a simple print example, but within Spock I don't understand what the ActionCtxT does and why I can't do the uuid IO in it.</p>\n"}, {"tags": ["haskell", "cryptography", "sha"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1488049121, "post_id": 42459047, "comment_id": 72062860, "body": "What don&#39;t you like about it? Aside from the type annotations (some of which I imagine you might not need in some real context) this seems fine to me."}, {"owner": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1488092341, "post_id": 42459047, "comment_id": 72072939, "body": "Exactly the type annotation I don&#39;t like, but the compiler had some problems  with the B.ByteStrings and asked me to clarify  the  types. Thanks for confirming what I did"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1488151484, "post_id": 42459047, "comment_id": 72091557, "body": "Yep, so where they can&#39;t be inferred (like when you compose a polymorphic function like <code>show</code> with a function with a polymorphic result type) you&#39;ll need type annotations. You might factor out some part of that line into a top-level function <code>hmacSH256</code> just to fix its type signature if you intend to use it elsewhere, or just split the line into several <code>let</code> declarations in that <code>do</code> block. Any of those would be idiomatic."}], "owner": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 322, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1488042660, "creation_date": 1488042660, "question_id": 42459047, "link": "https://stackoverflow.com/questions/42459047/haskell-cryptonite-hmac-sha-to-json", "title": "Haskell Cryptonite HMAC SHA To JSON", "body": "<p>While learning haskell, I gave myself the challenge to create an SHA HMAC and return it as a Text.</p>\n\n<p>I got it finally working.\nI was wondering though if there is a nicer way to write what I did. I am using <a href=\"https://hackage.haskell.org/package/cryptonite\" rel=\"nofollow noreferrer\">cryptonite</a>. The <code>text</code> function in my examples comes from the Spock Webframework and returns finally a json output to the browser. \nMy question is more about everything after <code>json</code>. Can I make this shorter? Nicer to read? Or maybe you are thinking: Why is he not using the soandso package?<br>\nI am new to the environement, so if you have any suggestion to make my line nicer or for using a different package, pleas let me know.</p>\n\n<p>Here is what I did:</p>\n\n<pre><code>import Crypto.MAC.HMAC\nimport Crypto.Hash.Algorithms\nimport qualified Data.ByteString as B\nimport Data.Text (pack )\n\napp :: SpockM Connection AppSession AppState ()\napp = do \n    get (\"json/id\") $ do\n        json . pack $ show $ (hmacGetDigest $ (hmac (\"MySecret\"::B.ByteString) (\"Somethin To Hash\"::B.ByteString) ::HMAC SHA256))\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "edited": false, "score": 0, "creation_date": 1488040983, "post_id": 42457966, "comment_id": 72059868, "body": "I didn&#39;t understand completely. The return of bar is a IO () and doesn&#39;t have a input , but if I wish pass a parameter to the bar function? Because I need specify the input. For example  <code>bar s i = putStrLn (foo s i)</code> ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "edited": false, "score": 1, "creation_date": 1488042250, "post_id": 42457966, "comment_id": 72060335, "body": "@Marcio You can add additional arguments. The <code>bar</code> in your example will have type <code>bar :: String -&gt; Int -&gt; IO ()</code>."}, {"owner": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "edited": false, "score": 0, "creation_date": 1488044095, "post_id": 42457966, "comment_id": 72061037, "body": "Thank you so much! But I have more one doubt: exists some way to concatenate the result of bar with a String? I&#39;m trying with <code>show</code>, doing something like this: <code>&quot;hello&quot; ++ (show baz s)</code> but didn&#39;t work. Appear a message &quot;No instance for (Show (IO ())) arising from a use of `show&#39;&quot; and I don&#39;t know what could be a instance of show. I&#39;m sorry if I&#39;m taking advantage of you"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "edited": false, "score": 0, "creation_date": 1488050877, "post_id": 42457966, "comment_id": 72063451, "body": "@Marcio That makes no sense. <code>baz</code> does not return a string, it returns an IO action. I.e. <code>baz</code> prints the string, it does not return it. If you want to further concatenate, use the pure <code>foo</code> function e.g. <code>&quot;hello&quot; ++ foo &quot;a&quot; 2</code> -- no need to <code>show</code> here."}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1488103962, "post_id": 42457966, "comment_id": 72075618, "body": "I suggest that you read about the difference between returning a String and printing a value to the screen. You sold also learn more about <code>IO()</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1488042179, "last_edit_date": 1488042179, "creation_date": 1488036886, "answer_id": 42457966, "question_id": 42457926, "link": "https://stackoverflow.com/questions/42457926/how-can-i-break-line-on-haskell/42457966#42457966", "title": "How can I break line on Haskell?", "body": "<p>Split your code in two parts.</p>\n\n<p>One part simply constructs the string. Use <code>\"\\n\"</code> for newlines.</p>\n\n<p>The second part takes the string and applies <code>putStrLn</code> (NOT <code>print</code>) to it. The newlines will get printed correctly.</p>\n\n<p>Example:</p>\n\n<pre><code>foo :: String -&gt; Int -&gt; String\nfoo s n = s ++ \"\\n\" ++ show (n*10) ++ \"\\n\" ++ s\n\nbar :: IO ()\nbar = putStrLn (foo \"abc\" 42)\n    -- or putStr (...) for no trailing newline\n\nbaz :: String -&gt; IO ()\nbaz s = putStrLn (foo s 21)\n</code></pre>\n\n<p>If you use <code>print</code> instead, you'll print the string representation, with quotes and escapes (like <code>\\n</code>) inside it. Use <code>print</code> only for values that have to be converted to string, like numbers.</p>\n\n<p>Also note that you can only do IO (like printing stuff) in functions whose return type is <code>IO (something)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "is_accepted": false, "score": 1, "last_activity_date": 1488037377, "creation_date": 1488037377, "answer_id": 42458063, "question_id": 42457926, "link": "https://stackoverflow.com/questions/42457926/how-can-i-break-line-on-haskell/42458063#42458063", "title": "How can I break line on Haskell?", "body": "<p>You need to print the results to output.</p>\n\n<p>This is an IO action, and so you cannot have a function signature ending with <code>-&gt; String</code>. Instead, as @chi points out, the return type should be <code>IO ()</code>. Further, since you have the function to generate formatted string already, all you need is a function to help you map the printing action over your input list. This you can do using <code>mapM_</code>, like so:</p>\n\n<pre><code>formatLines::[(String,Integer)] -&gt; IO ()\nformatLines y = mapM_ (putStrLn . formatLine) y\n</code></pre>\n\n<p><a href=\"http://rextester.com/MTHJA50026\" rel=\"nofollow noreferrer\">Demo</a></p>\n"}], "owner": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1519, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1488111894, "creation_date": 1488036628, "last_edit_date": 1488111894, "question_id": 42457926, "link": "https://stackoverflow.com/questions/42457926/how-can-i-break-line-on-haskell", "title": "How can I break line on Haskell?", "body": "<p>I tried break line using <code>\\n</code>, <code>putStrLn</code> and <code>print</code> but nothing works.</p>\n\n<p>When I use <code>\\n</code> the result only concatenates the strings, and when I use <code>putStrLn</code> or <code>print</code> I receive a type error.</p>\n\n<p><strong>Output for <code>\\n</code>:</strong></p>\n\n<pre><code>formatLines [(\"a\",12),(\"b\",13),(\"c\",14)]\n\"a...............12\\nb...............13\\nc...............14\\n\"\n</code></pre>\n\n<p><strong>Output for <code>putStrLn</code>:</strong></p>\n\n<pre><code>format.hs:6:22:\n    Couldn't match type `IO ()' with `[Char]'\n    Expected type: String\n      Actual type: IO ()\n    In the return type of a call of `putStrLn'\n    In the expression:\n      putStrLn (formatLine ((fst x), (snd x)) ++ formatLines xs)\n    In an equation for `formatLines':\n        formatLines (x : xs)\n          = putStrLn (formatLine ((fst x), (snd x)) ++ formatLines xs)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>the output for <code>print</code> is the same as that of <code>putStrLn</code></p>\n\n<p>Here is my code:</p>\n\n<pre><code>formatLine :: (String,Integer) -&gt; String\nformatLine (s, i) = s ++ \"...............\" ++ show i\n\nformatLines::[(String,Integer)] -&gt; String\nformatLines [] = \"\"\nformatLines (x:xs) = print (formatLine ((fst x), (snd x)) ++ formatLines xs) \n</code></pre>\n\n<p>I understand the reason of the error for <code>print</code> and <code>putStrLn</code> but i have no idea how fix it. </p>\n"}, {"tags": ["haskell", "lambda"], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 601703, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fcd22bb5a793d4430a312336d0a9a466?s=128&d=identicon&r=PG", "display_name": "dmitry", "link": "https://stackoverflow.com/users/601703/dmitry"}, "is_accepted": true, "score": 5, "last_activity_date": 1488036414, "creation_date": 1488036414, "answer_id": 42457892, "question_id": 42457783, "link": "https://stackoverflow.com/questions/42457783/no-instance-for-show-int-int-arising-from-a-use-of-print/42457892#42457892", "title": "No instance for (Show (Int -&gt; Int)) arising from a use of `print&#39;", "body": "<p>addSomethingTwo have a function (Int -> Int) as a result, not Int</p>\n\n<p>You need function definition as</p>\n\n<pre><code>addSomethingTwo x = (\\x-&gt;x+1) x\n</code></pre>\n\n<p>Or, to clear that x in lambda and in function parameter are different variables (they are in different scopes):</p>\n\n<pre><code>addSomethingTwo y = (\\x-&gt;x+1) y\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1488036726, "creation_date": 1488036726, "answer_id": 42457942, "question_id": 42457783, "link": "https://stackoverflow.com/questions/42457783/no-instance-for-show-int-int-arising-from-a-use-of-print/42457942#42457942", "title": "No instance for (Show (Int -&gt; Int)) arising from a use of `print&#39;", "body": "<p><code>myMap addSomethingTwo listTwo</code> generates a list of functions. It has type <code>[Int-&gt;Int]</code>, since <code>addSomethingTwo</code> is a binary function <code>a-&gt;(a-&gt;a)</code> (provided <code>Num a</code>), which means that it takes a number of type <code>a</code> and returns a numerical function <code>a-&gt;a</code>, thanks to currying. Those functions <code>a-&gt;a</code> get put in the list by <code>map</code>.</p>\n\n<p>Functions can not be printed by default, as the error message reports: \"no <code>Show</code> instance for <code>Int -&gt; Int</code>. Your commented <code>Show</code> instance allows functions to be printed as \"<code>function</code>\".</p>\n\n<p>I have little idea on what you are actually trying to achieve.</p>\n"}], "owner": {"reputation": 309, "user_id": 2372684, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AW7Sa.jpg?s=128&g=1", "display_name": "bling5630", "link": "https://stackoverflow.com/users/2372684/bling5630"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1573, "favorite_count": 0, "accepted_answer_id": 42457892, "answer_count": 2, "score": 1, "last_activity_date": 1488036726, "creation_date": 1488035748, "question_id": 42457783, "link": "https://stackoverflow.com/questions/42457783/no-instance-for-show-int-int-arising-from-a-use-of-print", "title": "No instance for (Show (Int -&gt; Int)) arising from a use of `print&#39;", "body": "<p>I try to implement a basic lambda function but struggle with some mistakes and can't figure out the solution after searching between the questions here. My code is: </p>\n\n<pre><code>myMap :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmyMap addSomething [] = []\nmyMap addSomething (x:xs) = addSomething x : myMap addSomething xs\n\n-- instance Show (a -&gt; b) where\n--          show a = \"funcion\"\n\nlist = [0..4]\nlistTwo = [(5 :: Int)..9]\n\naddSomething :: Int -&gt; Int\naddSomething x = x + 1\n\naddSomethingTwo ::  Num a =&gt; a -&gt; a-&gt; a\naddSomethingTwo x = (\\x-&gt;x+1)\n\nmain = do\n    print $ myMap addSomething list\n    print $ myMap addSomethingTwo listTwo\n</code></pre>\n\n<p>and here is the error message I get</p>\n\n<pre><code> No instance for (Show (Int -&gt; Int)) arising from a use of `print'\n    Possible fix: add an instance declaration for (Show (Int -&gt; Int))\n    In the expression: print\n    In a stmt of a 'do' block: print $ myMap addSomethingTwo listTwo\n    In the expression:\n      do { print $ myMap addSomething list;\n           print $ myMap addSomethingTwo listTwo }\n</code></pre>\n\n<p>if I uncomment these lines</p>\n\n<pre><code>instance Show (a -&gt; b) where\n         show a = \"function\"\n</code></pre>\n\n<p>I get this strange result</p>\n\n<pre><code>[1,2,3,4,5]\n[function,function,function,function,function]\n[Finished in 0.4s]\n</code></pre>\n\n<p>thank you in advance,\nTamas</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 5, "creation_date": 1488032335, "post_id": 42457167, "comment_id": 72056950, "body": "Just remove the type signature and ask ghci for the inferred type."}, {"owner": {"reputation": 372, "user_id": 2397226, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ecf8aae1b1c82da6448fdac37204319e?s=128&d=identicon&r=PG", "display_name": "MrX", "link": "https://stackoverflow.com/users/2397226/mrx"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1488032798, "post_id": 42457167, "comment_id": 72057093, "body": "that&#39;s one way but would it be possible to make the function definition more generic? I m in search of a technique rather then any solution"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1488033657, "post_id": 42457167, "comment_id": 72057389, "body": "If you don&#39;t use language extensions, Haskell will infer the most general type. (There are a few exceptions, e.g. I don&#39;t think it can infer polymorphic recursion.)"}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1488050066, "post_id": 42457167, "comment_id": 72063188, "body": "@MrX: Put another way, melpomene is saying that &quot;asking GHCi&quot; <i>is</i> a technique :-)"}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1488042183, "last_edit_date": 1495542712, "creation_date": 1488042183, "answer_id": 42458957, "question_id": 42457167, "link": "https://stackoverflow.com/questions/42457167/how-to-give-a-more-general-type-to-these-two-functions-that-have-identical-defin/42458957#42458957", "title": "How to give a more general type to these two functions that have identical definitions?", "body": "<p>The systematic way of doing that is covered in answers such as <a href=\"https://stackoverflow.com/a/23329230/2751851\">this one</a>. In many cases, though, a careful look at what we do know about the type signature is all we need to figure it out.</p>\n\n<blockquote>\n<pre><code>unsafeListHandling  :: [a] -&gt; ([a] -&gt;  a ) -&gt; Maybe  a\nunsafeListHandling2 :: [a] -&gt; ([a] -&gt; [a]) -&gt; Maybe [a]\n</code></pre>\n</blockquote>\n\n<p>Things we know about the generalised <code>unsafeListHandling</code>:</p>\n\n<ul>\n<li>Its first argument should be a list of arbitrary type (let's take that as a requirement you have imposed).</li>\n<li>It should take a function on lists of that type as its second argument.</li>\n<li>It should produce a <code>Maybe</code> that matches the result type of the second argument.</li>\n<li>It should be possible to specialise the result type of the second argument to either the (list) type of the first argument or to its corresponding element type (that covers the difference between your two signatures). </li>\n</ul>\n\n<p>If we write that down as a type signature, we get:</p>\n\n<pre><code>unsafeListHandling :: [a] -&gt; ([a] -&gt; b) -&gt; Maybe b\n</code></pre>\n\n<p>With <code>a</code> being arbitrary and <code>b</code> being such that both <code>b ~ [a]</code> and <code>b ~ a</code> are valid specialisations. If we take <code>b</code> as literally just a free and unconstrained type variable, we can see that nothing stops us from specialising it to either <code>[a]</code> or <code>a</code>; that being so, the general type signature indeed is:</p>\n\n<pre><code>unsafeListHandling :: [a] -&gt; ([a] -&gt; b) -&gt; Maybe b\nunsafeListHandling xs fx = if null xs then Nothing else Just $ fx xs\n</code></pre>\n\n<p>If we follow melpomene's suggestion and ask GHCi the type of your function without adding any signatures...</p>\n\n<pre><code>GHCi&gt; :t \\xs fx -&gt; if null xs then Nothing else Just $ fx xs\n\\xs fx -&gt; if null xs then Nothing else Just $ fx xs\n  :: Foldable t =&gt; t a -&gt; (t a -&gt; a1) -&gt; Maybe a1\n</code></pre>\n\n<p>... we get just that, except for the unconcerning generalisation of <code>[a]</code> to <code>Foldable t =&gt; t a</code>, which happens because the type of <code>null</code> is <code>Foldable t =&gt; t a -&gt; Bool</code>. By the way, if you are using GHC 8, you can enable the <code>TypeApplications</code> extension and use it as a convenient way to specialise <code>null</code> for your type tetris purposes:</p>\n\n<pre><code>GHCi&gt; :set -XTypeApplications\nGHCi&gt; :t \\xs fx -&gt; if null @[] xs then Nothing else Just $ fx xs\n\\xs fx -&gt; if null @[] xs then Nothing else Just $ fx xs\n  :: [a] -&gt; ([a] -&gt; a1) -&gt; Maybe a1\n</code></pre>\n\n<p>To wrap things up, a demonstration that the generalised function actually does what you want:</p>\n\n<pre><code>GHCi&gt; (\\xs fx -&gt; if null @[] xs then Nothing else Just $ fx xs) [1..7] head\nJust 1\nGHCi&gt; (\\xs fx -&gt; if null @[] xs then Nothing else Just $ fx xs) [1..7] tail\nJust [2,3,4,5,6,7]\n</code></pre>\n"}], "owner": {"reputation": 372, "user_id": 2397226, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/ecf8aae1b1c82da6448fdac37204319e?s=128&d=identicon&r=PG", "display_name": "MrX", "link": "https://stackoverflow.com/users/2397226/mrx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 42458957, "answer_count": 1, "score": -3, "last_activity_date": 1488043012, "creation_date": 1488032105, "last_edit_date": 1488043012, "question_id": 42457167, "link": "https://stackoverflow.com/questions/42457167/how-to-give-a-more-general-type-to-these-two-functions-that-have-identical-defin", "title": "How to give a more general type to these two functions that have identical definitions?", "body": "<p>Is it possible to somehow make the following code snippets more generic, we basically have 2 functions with identical code, the only difference being the function definition, is it possible to somehow abstract this away </p>\n\n<pre><code>unsafeListHandling :: [a] -&gt; ([a] -&gt; a) -&gt; Maybe a\nunsafeListHandling xs fx = if null xs then Nothing else Just $ fx xs\n\nunsafeListHandling2 :: [a] -&gt; ([a] -&gt; [a]) -&gt; Maybe [a]\nunsafeListHandling2 xs fx = if null xs then Nothing else Just $ fx xs\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1488029778, "post_id": 42456738, "comment_id": 72056026, "body": "It&#39;s telling you that it&#39;s expecting a <code>FixMePls b</code> (ie either a <code>FixMe</code> or a <code>Pls</code>) but it got a <code>Maybe a</code> (ie a <code>Just</code> or a <code>Nothing</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 5, "last_activity_date": 1488029943, "creation_date": 1488029943, "answer_id": 42456785, "question_id": 42456738, "link": "https://stackoverflow.com/questions/42456738/custom-applicative-maybe/42456785#42456785", "title": "Custom Applicative Maybe", "body": "<pre><code>data FixMePls a = FixMe | Pls a deriving (Eq, Show)\n</code></pre>\n\n<p>is ok nothing wrong with that one</p>\n\n<pre><code>instance Monoid a =&gt; Monoid (FixMePls a) where\n  mempty = Nothing\n  mappend m Nothing = m\n  mappend Nothing m = m\n  mappend (Pls a) (Pls a') = Pls (mappend a a')\n</code></pre>\n\n<p>here you start to mix <code>Maybe</code> and <code>FixmePls</code> - <code>Nothing</code> is a constructor for <code>Maybe</code> whereas <code>Fixme</code> is the one you need.</p>\n\n<pre><code>instance Monoid a =&gt; Monoid (FixMePls a) where\n  mempty = FixMe\n  mappend m FixMe = m\n  mappend FixMe m = m\n  mappend (Pls a) (Pls a') = Pls (mappend a a')\n</code></pre>\n\n<p>I am ommiting the applicative instance - as it should be quite similar, if you have problems - I spotted a parenthization error ;)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3292534"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 42456785, "answer_count": 1, "score": 0, "last_activity_date": 1488029943, "creation_date": 1488029640, "question_id": 42456738, "link": "https://stackoverflow.com/questions/42456738/custom-applicative-maybe", "title": "Custom Applicative Maybe", "body": "<p>Tying to implement Applicative of same nature as Maybe.\nGot tons of errors on compliation, most like</p>\n\n<pre><code>Couldn't match expected type \u2018FixMePls b\u2019\n            with actual type \u2018Maybe a1\u2019\n</code></pre>\n\n<p>The code is as follows</p>\n\n<pre><code>data FixMePls a = FixMe | Pls a deriving (Eq, Show)\n\ninstance Monoid a =&gt; Monoid (FixMePls a) where\n  mempty = Nothing\n  mappend m Nothing = m\n  mappend Nothing m = m\n  mappend (Pls a) (Pls a') = Pls (mappend a a')\n\ninstance Applicative FixMePls where\n  pure = Pls\n  Nothing &lt;*&gt; _ = Nothing\n  _ &lt;*&gt; Nothing = Nothing\n  Pls f &lt;*&gt; Pls a = Pls f a\n\n\nmain :: IO ()\nmain = do\n  putStrLn(\"Weee!!!1!\")\n</code></pre>\n\n<p>Any hints on what I'm doing wrong are welcome. I suspect it's datatype declaration, but not sure how to fix it.</p>\n"}, {"tags": ["haskell", "cryptography"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1488030291, "post_id": 42456724, "comment_id": 72056199, "body": "Hey nice that you have your try at haskell! But what is it you have tried where are you stuck? Right now I consider this question a bit too broad stackoverflow - can you narrow it down what you need?"}, {"owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1488030603, "post_id": 42456724, "comment_id": 72056316, "body": "OK. I&#39;ll remove this question and ask a more specific one. Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1488042666, "post_id": 42459006, "comment_id": 72060471, "body": "&quot;Trying to post a better question I managed to compile the code&quot; I often find that&#39;s the case myself"}], "tags": [], "owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "is_accepted": true, "score": 9, "last_activity_date": 1488042904, "last_edit_date": 1488042904, "creation_date": 1488042464, "answer_id": 42459006, "question_id": 42456724, "link": "https://stackoverflow.com/questions/42456724/how-to-use-haskell-cryptonite/42459006#42459006", "title": "How to use Haskell cryptonite?", "body": "<p>Trying to post a better question I managed to compile the code. I'm posting my solution hoping that it might help somebody else</p>\n\n<pre><code>import Crypto.Random(getSystemDRG, randomBytesGenerate)\nimport Crypto.KDF.Scrypt (generate, Parameters(..))\nimport Crypto.Cipher.AES (AES256)\nimport Crypto.Cipher.Types (BlockCipher(..), Cipher(..),nullIV)\nimport Crypto.Error (throwCryptoError)\n\nsaltSize = 32\nparamN = 14 :: Word64\nparamR = 8\nparamP = 1\nparamKeyLen = 32\n\n-- AES256 encryption\nencrypt :: ByteString -&gt; ByteString -&gt; ByteString\nencrypt key plainData = ctrCombine ctx nullIV plainData\n  where ctx :: AES256\n        ctx = throwCryptoError $ cipherInit key\n\ndecrypt :: ByteString -&gt; ByteString -&gt; ByteString\ndecrypt = encrypt\n\n--Scrypt KDF\nderiveKey :: Text -&gt; ByteString -&gt; ByteString\nderiveKey password salt = generate params (encodeUtf8 password) salt\n  where params = Parameters {n = paramN, r = paramR, p = paramP, outputLength = paramKeyLen}\n\n-- for generating the salt\nrandom :: Int -&gt; IO ByteString\nrandom size = do\n  drg &lt;- getSystemDRG\n  let (bytes, _) = randomBytesGenerate size drg\n  return bytes\n</code></pre>\n"}], "owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1060, "favorite_count": 0, "accepted_answer_id": 42459006, "answer_count": 1, "score": 3, "last_activity_date": 1488042904, "creation_date": 1488029548, "question_id": 42456724, "link": "https://stackoverflow.com/questions/42456724/how-to-use-haskell-cryptonite", "title": "How to use Haskell cryptonite?", "body": "<p>I need Scrypt, AES256 and RSA from <a href=\"http://hackage.haskell.org/package/cryptonite\" rel=\"nofollow noreferrer\">cryptonite</a> and I'm having a hard time trying to figure out how to use them. Are there some good examples for these?</p>\n\n<p>This <a href=\"http://hackage.haskell.org/package/cryptonite-0.21/docs/Crypto-Tutorial.html\" rel=\"nofollow noreferrer\">tutorial</a> is incomplete and it doesn't really count.</p>\n\n<p>Thanks!</p>\n\n<p>PS: I'm neither a cryptography nor a Haskell expert.</p>\n"}, {"tags": ["haskell", "typeclass", "gadt"], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 9, "last_activity_date": 1488033209, "creation_date": 1488033209, "answer_id": 42457346, "question_id": 42456698, "link": "https://stackoverflow.com/questions/42456698/understanding-when-to-uses-type-classes-or-gadts/42457346#42457346", "title": "Understanding when to uses type classes or GADT&#39;s?", "body": "<p>If you have a <em>class</em>, you can add new instances at any time.</p>\n\n<p>If you use a GADT, you have a data structure which is fixed forever. You can never add new cases to it, without altering the original definition. However, as you note, it's far more flexible.</p>\n\n<p>Really, they're intended for different use-cases. Classes are for when you want to be able to do a thing to lots of different data types which otherwise have nothing to do with each other. (E.g., you can do <code>(==)</code> on <code>Int</code> and on <code>String</code>, but those types aren't very similar.) GADTs are for when you want to have <em>one type</em>, but some of its type parameters tell you something about it. The canonical example is where the GADT represents an expression in some programming language, and you want to use the <em>Haskell</em> type system to enforce the <em>other language's</em> type system.</p>\n\n<p>What classes <em>are not</em> like are the \"classes\" we use in object-oriented programming. ;-) Please put all such ideas out of your brain.</p>\n"}, {"tags": [], "owner": {"reputation": 9485, "user_id": 20371, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32c7a412ad0caf812ae974df5eb8ffcd?s=128&d=identicon&r=PG", "display_name": "Yawar", "link": "https://stackoverflow.com/users/20371/yawar"}, "is_accepted": false, "score": 2, "last_activity_date": 1488033522, "creation_date": 1488033522, "answer_id": 42457412, "question_id": 42456698, "link": "https://stackoverflow.com/questions/42456698/understanding-when-to-uses-type-classes-or-gadts/42457412#42457412", "title": "Understanding when to uses type classes or GADT&#39;s?", "body": "<p>If you need pattern matching, use a (G)ADT. If you need third parties to be able to implement your interface, use a typeclass.</p>\n\n<p>My intuition is to use typeclasses as much as possible; if I absolutely need pattern matching, then I'll reach for a (G)ADT. I usually don't need it.</p>\n"}], "owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 3, "accepted_answer_id": 42457346, "answer_count": 2, "score": 8, "last_activity_date": 1488033522, "creation_date": 1488029409, "question_id": 42456698, "link": "https://stackoverflow.com/questions/42456698/understanding-when-to-uses-type-classes-or-gadts", "title": "Understanding when to uses type classes or GADT&#39;s?", "body": "<p>I'm trying to figure out the differences between type classes and GADTS, especially when using <code>-XMultiParamTypeClasses</code> extension. </p>\n\n<p>Both appear to have similar uses:</p>\n\n<pre><code>class MyClass a b where\n  f :: a -&gt; b -&gt; Bool\n\ninstance MyClass String String where\n  f s1 s2 = ...\n\ninstance MyClass Int Int where\n  f i1 i2 = ...\n\ndata Gadt a where\n  F :: String -&gt; String -&gt; Bool\n  F2 :: Int -&gt; Int -&gt; Bool\n</code></pre>\n\n<p>So far, the only difference I really see is that GADT's enable a function type interface to have a flexible number arguments:</p>\n\n<pre><code>data Gadt a where\n  PassTwoArgs :: String -&gt; String -&gt; Gadt Bool\n  PassOneArgs :: String -&gt; Gadt Bool\n\nmyFunction :: Gadt a -&gt; a\nmyFunction (PassTwoArgs s1 s2) = ...\nmyFunction (PassOneArgs s1) = ...\n</code></pre>\n\n<p>Whilst this isn't easily done with type classes. </p>\n\n<p>Are there any other differences or use cases to use one over the other? </p>\n"}, {"tags": ["haskell", "algebraic-data-types"], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 4, "last_activity_date": 1488027734, "creation_date": 1488027734, "answer_id": 42456398, "question_id": 42456273, "link": "https://stackoverflow.com/questions/42456273/error-no-instance-for-num-price-arising-from-the-literal/42456398#42456398", "title": "Error: No instance for (Num Price) arising from the literal", "body": "<pre><code>data Price = Integer | Float\n</code></pre>\n\n<p>This line creates three things: The type <code>Price</code>, and the constants <code>Integer</code> and <code>Float</code>. It works exactly like:</p>\n\n<pre><code>data Bool = False | True\n</code></pre>\n\n<p>In your case you have the new values <code>Integer</code> (of type <code>Price</code>) and <code>Float</code> (of type <code>Price</code>). These are unrelated to the <em>types</em> <code>Integer</code> and <code>Float</code>. And <code>50</code> is not a value of type <code>Price</code> (<code>Price</code> has only two possible values).</p>\n\n<p>The whole thing is a bit confusing because types and values live in different namespaces. You can have a type called <code>X</code> and a value called <code>X</code> and they have nothing to do with each other (or in your case, a type called <code>Integer</code> and a value called <code>Integer</code>).</p>\n\n<p>To create a type that contains either an integer or a float, you can do this:</p>\n\n<pre><code>data Price = PriceInteger Integer | PriceFloat Float\n</code></pre>\n\n<p>Now you can do <code>PriceInteger 50</code> and it will have type <code>Price</code> (but you still can't use a bare <code>50</code>). It's probably easier to just do <code>type Price = Integer</code> and not allow floats.</p>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 1, "last_activity_date": 1488029201, "creation_date": 1488029201, "answer_id": 42456660, "question_id": 42456273, "link": "https://stackoverflow.com/questions/42456273/error-no-instance-for-num-price-arising-from-the-literal/42456660#42456660", "title": "Error: No instance for (Num Price) arising from the literal", "body": "<p><code>Float</code> and <code>Integer</code> are on the right hand side of your <code>data</code> declaration - you can view them as citizens of a different universe compared to types, as they are constructors, i.e. things that make a type.</p>\n\n<p>If you want to have a sum type of <code>Integer</code> and <code>Float</code> you have to </p>\n\n<pre><code>data Price = I Integer | F Float deriving (Eq,Show)\n</code></pre>\n\n<p>But it would be best to represent monetary values as either <code>Rational</code> from <code>Data.Ratio</code> or <code>Scientific</code> from <a href=\"https://hackage.haskell.org/package/scientific\" rel=\"nofollow noreferrer\"><code>scientific</code></a> and use the <a href=\"https://hackage.haskell.org/package/formatting\" rel=\"nofollow noreferrer\"><code>formatting</code></a> package to make string representations of fixed precision.</p>\n\n<pre><code>import Data.Ratio (Rational)\nimport Formatting\n\nnewtype Price = Price {getPrice :: Rational}\ninstance Show Price where\n   show (Price p) = formatToString (fixed 2) p\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 6776800, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47d3e8dc018d553c442354c3afd1a8da?s=128&d=identicon&r=PG&f=1", "display_name": "Marcio", "link": "https://stackoverflow.com/users/6776800/marcio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 42456398, "answer_count": 2, "score": 0, "last_activity_date": 1488029201, "creation_date": 1488027047, "last_edit_date": 1488027776, "question_id": 42456273, "link": "https://stackoverflow.com/questions/42456273/error-no-instance-for-num-price-arising-from-the-literal", "title": "Error: No instance for (Num Price) arising from the literal", "body": "<p>I'm praticing Haskell and I'm trying to create e movies store.</p>\n\n<p>I created the types <code>Code</code>,<code>Name</code>,<code>Genre</code> and <code>Price</code>, a tuple <code>Movie</code> and a tuple list <code>Movies</code> and when I try add movies at <code>tableMovies</code> appear the message:</p>\n\n<blockquote>\n<pre><code>Prelude&gt; :l movies\n[1 of 1] Compiling Main             ( movies.hs, interpreted )\n\nmovies.hs:11:45:\n    No instance for (Num Price) arising from the literal `50'\n    Possible fix: add an instance declaration for (Num Price)\n    In the expression: 50\n    In the expression: (1, \"Movie 1\", \"Adventure\", 50)\n    In the expression:\n      [(1, \"Movie 1\", \"Adventure\", 50), (2, \"Movie 2\", \"Horror\", 30)]\nFailed, modules loaded: none.\nPrelude&gt;\n</code></pre>\n</blockquote>\n\n<p>My code:</p>\n\n<pre><code>type Code = Integer\ntype Name = String\ntype Genre = String\ndata Price = Integer | Float\n\ntype Movie = (Code, Name, Genre,Price)\n\ntype Movies = [(Movie)]\n\ntableMovies :: Movies\ntableMovies = [ (001,\"Movie 1\", \"Adventure\",50)\n             , (002,\"Movie 2\", \"Horror\", 30)]\n</code></pre>\n\n<p>I found some answers for this problem but I couldn't understand because the codes were very complexity to me. I'm only starting on Haskell </p>\n"}, {"tags": ["haskell", "x11", "haskell-stack"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1488025382, "post_id": 42455814, "comment_id": 72054426, "body": "It seems you don&#39;t have the (non-Haskell) X11 development headers installed in your system. While I don&#39;t have Mint to test it, I suspect installing <a href=\"https://community.linuxmint.com/software/view/libx11-dev\" rel=\"nofollow noreferrer\"><i>libx11-dev</i></a> will solve the problem."}, {"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1488026428, "post_id": 42455814, "comment_id": 72054813, "body": "@duplode. Thank for your help. I am not sure how you found this, but I did load libx11-dev, but I got a new set of error messages, which I will add to the original post as an edit."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1488027108, "post_id": 42455814, "comment_id": 72055033, "body": "It is the same issue, except with other libraries. You have to install the Mint <i>*-dev</i> packages that provide the headers for <i>Xrandr</i> and <i>Xinerama</i> (the libraries mentioned in the errors/warnings)."}, {"owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1488028563, "post_id": 42455814, "comment_id": 72055568, "body": "Thanks! As suggested I loaded <a href=\"https://community.linuxmint.com/software/view/libx11-dev\" rel=\"nofollow noreferrer\">libx11-dev</a>, <a href=\"https://community.linuxmint.com/software/view/libxrandr-dev\" rel=\"nofollow noreferrer\">libxrandr-dev</a>, <a href=\"https://community.linuxmint.com/software/view/libxinerama-dev\" rel=\"nofollow noreferrer\">libxinerama-dev</a> and <code>stack build</code> did work."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 4, "last_activity_date": 1488035379, "last_edit_date": 1488035379, "creation_date": 1488030224, "answer_id": 42456838, "question_id": 42455814, "link": "https://stackoverflow.com/questions/42455814/x11-libraries-not-found-error-when-installing-the-x11-package-with-stack/42456838#42456838", "title": "&quot;X11 libraries not found&quot; error when installing the X11 package with Stack", "body": "<p>Errors about missing libraries when installing packages with <em>stack</em> or <em>cabal-install</em> are typically about non-Haskell dependencies that must be installed separately, as the Haskell-specific tools aren't meant to pull them on their own. In this case, to quote <a href=\"https://github.com/xmonad/X11\" rel=\"nofollow noreferrer\">the readme</a> of the <em>X11</em> Haskell package...</p>\n\n<blockquote>\n  <p>You will need development versions of at least the X11, xrandr, and Xinerama libraries installed for the build to succeed [...]</p>\n</blockquote>\n\n<p>The development versions of these libraries can be installed through the package manager of your Linux distribution; in the case of Mint they amount to the <a href=\"https://community.linuxmint.com/software/view/libx11-dev\" rel=\"nofollow noreferrer\"><em>libx11-dev</em></a>, <a href=\"https://community.linuxmint.com/software/view/libxrandr-dev\" rel=\"nofollow noreferrer\"><em>libxrandr-dev</em></a> and <a href=\"https://community.linuxmint.com/software/view/libxinerama-dev\" rel=\"nofollow noreferrer\"><em>libxinerama-dev</em></a> packages respectively.</p>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3246, "favorite_count": 1, "accepted_answer_id": 42456838, "answer_count": 1, "score": 1, "last_activity_date": 1488035379, "creation_date": 1488024171, "last_edit_date": 1488030307, "question_id": 42455814, "link": "https://stackoverflow.com/questions/42455814/x11-libraries-not-found-error-when-installing-the-x11-package-with-stack", "title": "&quot;X11 libraries not found&quot; error when installing the X11 package with Stack", "body": "<p>I need to use the <a href=\"https://www.stackage.org/lts-8.2/package/X11-1.8\" rel=\"nofollow noreferrer\">x11 package</a> with the <a href=\"https://www.stackage.org/lts-8.2\" rel=\"nofollow noreferrer\">lts-8.2 resolver</a>, and when I run the command <code>stack build</code>, I get the following :</p>\n\n<pre><code>X11-1.8: configure\nProgress: 1/2\n--  While building package X11-1.8 using:\n/tmp/stack7885/X11-1.8/.stack-work/dist/x86_64-linux/Cabal-1.24.2.0    /setup/setup --builddir=.stack-work/dist/x86_64-linux/Cabal-1.24.2.0 configure --with-ghc=/home/userXYZ/.stack/programs/x86_64-linux/ghc-8.0.2/bin/ghc --with-ghc-pkg=/home/userXYZ/.stack/programs/x86_64-linux/ghc-8.0.2/bin/ghc-pkg --user --package-db=clear --package-db=global --package-db=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/pkgdb --libdir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/lib --bindir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/bin --datadir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/share --libexecdir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/libexec --sysconfdir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/etc --docdir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/doc/X11-1.8 --htmldir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/doc/X11-1.8 --haddockdir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/doc/X11-1.8 --dependency=base=base-4.9.1.0 --dependency=data-default=data-default-0.7.1.1-7EGYJX2YWqWJRbPFUHNoCr\n\nProcess exited with code: ExitFailure 1\nLogs have been written to: /home/userXYZ/Documents/programming/haskell/projects/MyStack/screen-linux/.stack-work/logs/X11-1.8.log\n\n[1 of 1] Compiling Main             ( /tmp/stack7885/X11-1.8/Setup.hs, /tmp/stack7885/X11-1.8/.stack-work/dist/x86_64-linux/Cabal-1.24.2.0/setup/Main.o )\n\n/tmp/stack7885/X11-1.8/Setup.hs:6:29: warning: [-Wdeprecations]\n    In the use of \u2018defaultUserHooks\u2019\n    (imported from Distribution.Simple):\n    Deprecated: \"Use simpleUserHooks or autoconfUserHooks, unless you need Cabal-1.2\n             compatibility in which case you must stick with defaultUserHooks\"\nLinking /tmp/stack7885/X11-1.8/.stack-work/dist/x86_64-linux/Cabal-1.24.2.0/setup/setup ...\nWarning: defaultUserHooks in Setup script is deprecated.\nConfiguring X11-1.8...\nconfigure: WARNING: unrecognized options: --with-hc\nchecking for gcc... /usr/bin/gcc\nchecking whether the C compiler works... yes\nchecking for C compiler default output file name... a.out\nchecking for suffix of executables... \nchecking whether we are cross compiling... no\nchecking for suffix of object files... o\nchecking whether we are using the GNU C compiler... yes\nchecking whether /usr/bin/gcc accepts -g... yes\nchecking for /usr/bin/gcc option to accept ISO C89... none needed\nchecking how to run the C preprocessor... /usr/bin/gcc -E\nchecking for X... no\nconfigure: error: in `/tmp/stack7885/X11-1.8':\nconfigure: error: X11 libraries not found, so X11 package cannot be built\nSee `config.log' for more details\n</code></pre>\n\n<p>I am running on LinuxMint 17.2 64bits. </p>\n\n<p>I found a similar issue <a href=\"https://github.com/commercialhaskell/stack/issues/2735\" rel=\"nofollow noreferrer\">here</a>, but unfortunately that did not help me to solve my issue.</p>\n\n<p>I am looking for any help to fix the issue. I am not entirely sure where to start with.</p>\n\n<p>===============================</p>\n\n<p>EDIT: following the suggestion of duplode, I loaded libx11-dev, and then got the following set of other messages after running <code>stack build</code> :</p>\n\n<pre><code>    X11-1.8: configure\nProgress: 1/2\n--  While building package X11-1.8 using:\n    /tmp/stack12282/X11-1.8/.stack-work/dist/x86_64-linux/Cabal-1.24.2.0/setup/setup --builddir=.stack-work/dist/x86_64-linux/Cabal-1.24.2.0 configure --with-ghc=/home/userXYZ/.stack/programs/x86_64-linux/ghc-8.0.2/bin/ghc --with-ghc-pkg=/home/userXYZ/.stack/programs/x86_64-linux/ghc-8.0.2/bin/ghc-pkg --user --package-db=clear --package-db=global --package-db=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/pkgdb --libdir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/lib --bindir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/bin --datadir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/share --libexecdir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/libexec --sysconfdir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/etc --docdir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/doc/X11-1.8 --htmldir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/doc/X11-1.8 --haddockdir=/home/userXYZ/.stack/snapshots/x86_64-linux/lts-8.2/8.0.2/doc/X11-1.8 --dependency=base=base-4.9.1.0 --dependency=data-default=data-default-0.7.1.1-7EGYJX2YWqWJRbPFUHNoCr\nProcess exited with code: ExitFailure 1\nLogs have been written to: /home/userXYZ/Documents/programming/haskell/projects/MyStack/screen-linux/.stack-work/logs/X11-1.8.log\n\n[1 of 1] Compiling Main             ( /tmp/stack12282/X11-1.8/Setup.hs, /tmp/stack12282/X11-1.8/.stack-work/dist/x86_64-linux/Cabal-1.24.2.0/setup/Main.o )\n\n/tmp/stack12282/X11-1.8/Setup.hs:6:29: warning: [-Wdeprecations]\n    In the use of \u2018defaultUserHooks\u2019\n    (imported from Distribution.Simple):\n    Deprecated: \"Use simpleUserHooks or autoconfUserHooks, unless you need Cabal-1.2\n             compatibility in which case you must stick with defaultUserHooks\"\nLinking /tmp/stack12282/X11-1.8/.stack-work/dist/x86_64-linux/Cabal-1.24.2.0/setup/setup ...\nWarning: defaultUserHooks in Setup script is deprecated.\nConfiguring X11-1.8...\nconfigure: WARNING: unrecognized options: --with-hc\nchecking for gcc... /usr/bin/gcc\nchecking whether the C compiler works... yes\nchecking for C compiler default output file name... a.out\nchecking for suffix of executables... \nchecking whether we are cross compiling... no\nchecking for suffix of object files... o\nchecking whether we are using the GNU C compiler... yes\nchecking whether /usr/bin/gcc accepts -g... yes\nchecking for /usr/bin/gcc option to accept ISO C89... none needed\nchecking how to run the C preprocessor... /usr/bin/gcc -E\nchecking for X... libraries , headers \nchecking for gethostbyname... yes\nchecking for connect... yes\nchecking for remove... yes\nchecking for shmat... yes\nchecking for IceConnectionNumber in -lICE... no\nchecking whether to build Xinerama... yes\nchecking for grep that handles long lines and -e... /bin/grep\nchecking for egrep... /bin/grep -E\nchecking for ANSI C header files... yes\nchecking for sys/types.h... yes\nchecking for sys/stat.h... yes\nchecking for stdlib.h... yes\nchecking for string.h... yes\nchecking for memory.h... yes\nchecking for strings.h... yes\nchecking for inttypes.h... yes\nchecking for stdint.h... yes\nchecking for unistd.h... yes\nchecking X11/extensions/Xinerama.h usability... no\nchecking X11/extensions/Xinerama.h presence... no\nchecking for X11/extensions/Xinerama.h... no\nWARNING: Xinerama headers not found. Building without Xinerama support\nchecking X11/extensions/Xrandr.h usability... no\nchecking X11/extensions/Xrandr.h presence... no\nchecking for X11/extensions/Xrandr.h... no\nconfigure: error: X11/extensions/Xrandr.h (from libXrandr) is required\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1487992093, "post_id": 42451468, "comment_id": 72046693, "body": "Haskell doesn&#39;t have variables like in Java or C.  Here you&#39;re defining <code>x</code> to be <code>doubleThis x</code> as a recursive definition.  This is perfectly acceptable in Haskell.  For example, you can define the fibonacci sequence as <code>let fibs = 1 : 1 : zipWith (+) fibs (tail fibs)</code>.  Or more simply you can define an empty list containing only 1s as <code>let ones = 1 : ones</code>."}, {"owner": {"reputation": 151, "user_id": 4568308, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56ab75416fe0e9a5d98f84202444ab6c?s=128&d=identicon&r=PG&f=1", "display_name": "Blake", "link": "https://stackoverflow.com/users/4568308/blake"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1487992975, "post_id": 42451468, "comment_id": 72046832, "body": "so i would have to define it as let y = doubleThis x then let x = y?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1487994848, "post_id": 42451468, "comment_id": 72047127, "body": "No, you&#39;d define it as <code>let y = doubleThis x</code> then use <code>y</code> instead of <code>x</code> and forget about ever &quot;changing&quot; the value of <code>x</code>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1487996280, "post_id": 42451468, "comment_id": 72047353, "body": "@Blake Haskell doesn&#39;t have variables, and definitions can occur in any order. Once you define x to be something, that&#39;s what x will be (in that lexical scope). It won&#39;t change no matter how hard you try. There are some special rules in GHCi, but not in actual source code."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1487998706, "post_id": 42451468, "comment_id": 72047812, "body": "if the reason of trying to define <code>x &lt;- f(x)</code> to find f(f(x)), f(f(f(x))), etc instead use <code>iterate doubleThis 5</code>"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1488002114, "post_id": 42451468, "comment_id": 72048505, "body": "This is too broad man. You need to just start reading a book or tutorial."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1488009013, "post_id": 42451468, "comment_id": 72050115, "body": "In Haskell, everything is immutable. Once <code>x</code> was defined, if will keep that value forever. To an imperative programmer, this might look as extremely constraining, and possibly preventing any programming at all. In practice, this is not the case, since pure FP has been used for virtually any task successfully (also because, there are some libraries that model mutation like <code>ST</code>, but they are mostly unneeded). If you need to &quot;mutate&quot; <code>x</code>, you probably need some recursion like <code>f x = if x == then 2 else f (newValue x)</code> -- this is how looping works in Haskell."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6428287"}, "edited": false, "score": 0, "creation_date": 1488035123, "post_id": 42457623, "comment_id": 72057886, "body": "There are no variables in Haskell."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1488037323, "post_id": 42457623, "comment_id": 72058605, "body": "@GeorgJohannSchubert Well, the <code>x</code> in <code>f x = x^2</code> is usually called a variable, even if its value is immutable. This convention follows maths, where in <code>f(x)=x^2</code> the <code>x</code> is called a variable as well. It &quot;varies&quot; in the sense that you can call <code>f</code> on several distinct arguments, both in maths and Haskell."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 2, "last_activity_date": 1488034775, "creation_date": 1488034775, "answer_id": 42457623, "question_id": 42451468, "link": "https://stackoverflow.com/questions/42451468/storing-the-result-of-a-function-in-a-variable-used-as-input-to-the-function/42457623#42457623", "title": "Storing the result of a function in a variable used as input to the function", "body": "<pre><code>int x = 5\n\nx = doubleThis(x)\n\nfunction doubleThis(x){return x*x}\n</code></pre>\n\n<p>You seem to have figured out how to do the last line. And the first line.</p>\n\n<p>What you <em>cannot</em> do is the middle line. Haskell purposely does not allow this. What you <em>can</em> do is</p>\n\n<pre><code>x1 = 5\n\nx2 = doubleThis x1\n</code></pre>\n\n<p>That's perfectly fine. But you can't <em>change</em> the value of an existing variable. This is a deliberate design choice.</p>\n\n<p>Don't try to think in terms of \"I have this imperative code, how do I write something in Haskell that does exactly the same thing?\" The whole <em>point</em> of Haskell is that you do things a completely different way. Rather, think \"What problem am I actually trying to solve? What would be the most sensible way to do that in Haskell?\"</p>\n"}], "owner": {"reputation": 151, "user_id": 4568308, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56ab75416fe0e9a5d98f84202444ab6c?s=128&d=identicon&r=PG&f=1", "display_name": "Blake", "link": "https://stackoverflow.com/users/4568308/blake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 970, "favorite_count": 0, "closed_date": 1488041961, "accepted_answer_id": 42457623, "answer_count": 1, "score": 2, "last_activity_date": 1499902294, "creation_date": 1487991436, "question_id": 42451468, "link": "https://stackoverflow.com/questions/42451468/storing-the-result-of-a-function-in-a-variable-used-as-input-to-the-function", "closed_reason": "Needs more focus", "title": "Storing the result of a function in a variable used as input to the function", "body": "<p>I am new to haskell and functional languages in general but i have some OO language background</p>\n\n<p>Can someone show me the haskell equivalent of some code like this:</p>\n\n<pre><code>  int x = 5 \n\n  x = doubleThis(x)\n\n  function doubleThis(x){\n\n  return x*x\n  }\n</code></pre>\n\n<p>so if i had a function :</p>\n\n<pre><code>doubleThis :: Integer -&gt; Integer\ndoubleThis x = x*x \n</code></pre>\n\n<p>how could i make it so that if i ran this:</p>\n\n<pre><code>let x = 5 \ndoubleThis x\noutput&gt; 25\nx\noutput&gt; 25 \n</code></pre>\n\n<p>my initial thought was that it would be something like:</p>\n\n<pre><code>let x = doubleThis x\n</code></pre>\n\n<p>but uh.... that seems to make an infinite loop</p>\n\n<p>bonus points if you feel like showing me how to do this with concatenating a tuple onto a list</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1487981700, "post_id": 42450219, "comment_id": 72044604, "body": "I don&#39;t think so, sorry. Is this serving another goal? If so, you should talk about it; there may be another way to achieve it than via this route."}, {"owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1487981783, "post_id": 42450219, "comment_id": 72044634, "body": "Yes, I want to apply a function to a heterogeneous list, but I thought this would be a simpler example."}], "answers": [{"comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1487982709, "post_id": 42450421, "comment_id": 72044835, "body": "You might be able to generalize to that third one, and &quot;unify&quot; all three of them, using things from a couple answers I gave a little while back, regarding similar problems: <a href=\"http://stackoverflow.com/questions/38603014/type-signature-for-function-with-possibly-polymorphic-arguments/38606908#38606908\">1</a>, <a href=\"http://stackoverflow.com/a/31223058/2476735\">2</a>"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1487982976, "post_id": 42450421, "comment_id": 72044902, "body": "@DavidYoung Oh sure. I would prefer to stay away from a typeclass-dependent approach though."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1487989702, "post_id": 42450421, "comment_id": 72046227, "body": "It is a matter of opinion of course, but I would say my approach isn&#39;t <i>that</i> type class dependent (I&#39;m not putting <code>pairmap</code> into a type class at least). I&#39;m just using empty type classes to make type level functions (unless of course that&#39;s what you mean by typeclass-dependent). What I had in mind was something like <a href=\"https://gist.github.com/roboguy13/045839a354bd8b89ec70c18cde781ad6\" rel=\"nofollow noreferrer\">this</a>. I would use type families, but sadly while you can partially apply type classes, you can&#39;t partially apply type families."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1488021601, "post_id": 42450421, "comment_id": 72053333, "body": "@Alec why do you need that <code>Constraint</code> in function? Why not just <code>pairmap :: (forall a . a -&gt; a) -&gt; (x, y) -&gt; (x, y); pairmap f (x, y) = (f x, f y)</code>?"}, {"owner": {"reputation": 3038, "user_id": 2725031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a052ac048fc2c1c0df69dd66100e9c06?s=128&d=identicon&r=PG&f=1", "display_name": "Marcin \u0141o\u015b", "link": "https://stackoverflow.com/users/2725031/marcin-%c5%81o%c5%9b"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1488022573, "post_id": 42450421, "comment_id": 72053633, "body": "@Shersh because <code>(+2)</code> does not have type <code>forall a. a -&gt; a</code>, it has a type <code>Num a =&gt; a -&gt; a</code>. Usage of <code>Constraint</code> in the answer solves this issue in a general manner."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 7, "last_activity_date": 1487982312, "last_edit_date": 1487982312, "creation_date": 1487981958, "answer_id": 42450421, "question_id": 42450219, "link": "https://stackoverflow.com/questions/42450219/functions-on-pairs-of-different-types/42450421#42450421", "title": "Functions on pairs of different types", "body": "<p>The first two of your examples are somewhat simpler to generalize than the third.</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, ConstraintKinds, KindSignatures, AllowAmbiguousTypes, TypeApplications #-}\n\nimport GHC.Exts (Constraint)\n\npairmap :: forall (c :: * -&gt; Constraint) d e. (c d, c e) =&gt;\n              (forall a. (c a) =&gt; a -&gt; a) -&gt; (d,e) -&gt; (d,e)\npairmap f (x,y) = (f x, f y) \n</code></pre>\n\n<p>The caveat with this solution is that you need to explicitly instantiate the constraint you are using:</p>\n\n<pre><code>ghci&gt; pairmap @Num (+1) (1 :: Int, 1.0 :: Float)\n(2,2.0)\n</code></pre>\n\n<p>As for the third, here is a half solutions. If the second type is always a type parametrized over the first (like <code>f a</code>), then you can do the same thing as above (albeit your first examples cease to work - you could make them work by wrapping them in <code>Identity</code>).</p>\n\n<pre><code>pairmap' :: forall (c :: * -&gt; Constraint) f d e. (c d, c e) =&gt;\n              (forall a. (c a) =&gt; a -&gt; f a) -&gt; (d,e) -&gt; (f d,f e)\npairmap' f (x,y) = (f x, f y) \n</code></pre>\n\n<p>And again, at GHCi</p>\n\n<pre><code>ghci&gt; pairmap' @Num (Just . (+1)) (1 :: Int , 1.0 :: Float)\n(Just 2,Just 2.0)\n</code></pre>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1488030676, "creation_date": 1487980405, "last_edit_date": 1488030676, "question_id": 42450219, "link": "https://stackoverflow.com/questions/42450219/functions-on-pairs-of-different-types", "title": "Functions on pairs of different types", "body": "<p>Is there a way to define \"<code>pairmap</code>\" like the following:</p>\n\n<pre><code>pairmap f (x,y) = (f x, f y)\n</code></pre>\n\n<p>So that the following works:</p>\n\n<pre><code>pairmap (+2) (1::Int, 2::Float)\npairmap succ (1::Int, 'a')\npairmap Just ('a', True)\n</code></pre>\n\n<p>etc.</p>\n\n<p>Naturally, in the first case, both the elements must be of class <code>Num</code>, and in the second case, both of class <code>Enum</code>. In the third case however, there's no restriction required.</p>\n\n<p><strong>Answer (but could be improved)</strong></p>\n\n<p>The following code <a href=\"http://ideone.com/moxzT6\" rel=\"nofollow noreferrer\">(ideone)</a> solves the problem, but note that my functions have to be wrapped in a datatype that encapsulates both the relation between the input and output types and also any constraints on the input type. This works but there's a bit of boilerplate. It would be nice if I could use a bit less boilerplate to achieve this, so any answer would be appreciated (although this solution is reasonably fine for my purposes).</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE RankNTypes #-}\n\nimport GHC.Exts (Constraint)\n\nclass Function f where\n  type Constraints f a :: Constraint\n  type instance Constraints f a = ()\n  type Result f a\n  type instance Result f a = a\n  applyFunc :: (Constraints f a) =&gt; f -&gt; a -&gt; Result f a\n\npairmap :: \n  (Function f, Constraints f a, Constraints f b) =&gt; \n  f -&gt; (a, b) -&gt; (Result f a, Result f b)\npairmap f (x,y) = (applyFunc f x, applyFunc f y)\n\ndata NumFunc where\n  NumFunc :: (forall a. Num a =&gt; a -&gt; a) -&gt; NumFunc\n\ninstance Function NumFunc where\n  type Constraints NumFunc a = (Num a)\n  applyFunc (NumFunc f) = f\n\ndata EnumFunc where\n  EnumFunc :: (forall a. Enum a =&gt; a -&gt; a) -&gt; EnumFunc\n\ninstance Function EnumFunc where\n  type Constraints EnumFunc a = (Enum a)\n  applyFunc (EnumFunc f) = f\n\ndata MaybeFunc where\n  MaybeFunc :: (forall a. a -&gt; Maybe a) -&gt; MaybeFunc\n\ninstance Function MaybeFunc where\n  type Result MaybeFunc a = Maybe a\n  applyFunc (MaybeFunc f) = f\n\ny1 = pairmap (NumFunc (+2)) (1::Int, 2::Float)\ny2 = pairmap (EnumFunc succ) (1::Int, 'a')\ny3 = pairmap (MaybeFunc Just) ('a', True)\n\nmain = do\n  print y1\n  print y2\n  print y3\n</code></pre>\n\n<p><strong>Answer 2</strong></p>\n\n<p>I think this is better and more flexible <a href=\"http://ideone.com/wMMtMi\" rel=\"nofollow noreferrer\">(ideone)</a>, but again, any improvements to reduce the boilerplate welcome:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE UndecidableSuperClasses #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE TypeApplications #-}\n\nimport GHC.Exts (Constraint)\n\ndata Func (c :: (* -&gt; * -&gt; Constraint)) where\n  Func :: (forall a b. c a b =&gt; a -&gt; b) -&gt; Func c\n\nclass (c a, a ~ b) =&gt; BasicConstraint c a b\ninstance (c a, a ~ b) =&gt; BasicConstraint c a b\n\nnumFunc = Func @(BasicConstraint Num)\nenumFunc = Func @(BasicConstraint Enum)\n\nclass (c a, t a ~ b) =&gt; NewtypeConstraint c t a b\ninstance (c a, t a ~ b) =&gt; NewtypeConstraint c t a b\n\nclass EmptyConstraint a\ninstance EmptyConstraint a\n\nmaybeFunc = Func @(NewtypeConstraint EmptyConstraint Maybe)\n\napplyFunc :: Func c -&gt; (forall a b. c a b =&gt; a -&gt; b)\napplyFunc (Func f) = f\n\npairmap :: (c a a', c b b') =&gt; Func c -&gt; (a, b) -&gt; (a', b')\npairmap f (x,y) = (applyFunc f x, applyFunc f y)\n\nmain = do\n  print $ pairmap (numFunc (+2)) (1::Int, 2::Float)\n  print $ pairmap (enumFunc succ) (1::Int, 'a')\n  print $ pairmap (maybeFunc Just) ('a', True)\n</code></pre>\n"}, {"tags": ["haskell", "monads", "haskell-lens", "lenses"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1487982344, "post_id": 42449853, "comment_id": 72044752, "body": "Did you check <code>wreq</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 0, "creation_date": 1488039818, "post_id": 42452963, "comment_id": 72059469, "body": "<code>view</code>=<code>GET</code>, <code>set</code>=<code>POST</code> or <code>PUT</code>, to me that looks awfully similar to a lens, am I wrong?"}, {"owner": {"reputation": 1020, "user_id": 500060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c122862374667042520953c02df7d7ed?s=128&d=identicon&r=PG", "display_name": "glguy", "link": "https://stackoverflow.com/users/500060/glguy"}, "reply_to_user": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 0, "creation_date": 1488045842, "post_id": 42452963, "comment_id": 72061710, "body": "It seems like you&#39;re thinking of lenses in a much more generic setting of simply storage and retrieval. Lenses are specifically about functions that interact as shown in the laws above. Those laws are referring to actual function application, not a general notion of actions like interacting with a REST API."}], "tags": [], "owner": {"reputation": 1020, "user_id": 500060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c122862374667042520953c02df7d7ed?s=128&d=identicon&r=PG", "display_name": "glguy", "link": "https://stackoverflow.com/users/500060/glguy"}, "is_accepted": false, "score": 0, "last_activity_date": 1488005482, "creation_date": 1488005482, "answer_id": 42452963, "question_id": 42449853, "link": "https://stackoverflow.com/questions/42449853/http-lens-for-interfacing-with-an-api/42452963#42452963", "title": "HTTP Lens for interfacing with an API?", "body": "<p>No, this doesn't have anything to do with lenses, unfortunately. Lenses are things that satisfy the <a href=\"http://hackage.haskell.org/package/lens-4.15.1/docs/Control-Lens-Lens.html#g:1\" rel=\"nofollow noreferrer\">lens laws</a></p>\n\n<pre><code>view l (set l v s) \u2261 v\nset l (view l s) s \u2261 s\nset l v' (set l v s) \u2261 set l v' s\n</code></pre>\n\n<p>It's possible there's some clever thing you would write in Haskell to produce the outputs you're looking for, it just won't be related to this topic.</p>\n"}], "owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1488005482, "creation_date": 1487978005, "question_id": 42449853, "link": "https://stackoverflow.com/questions/42449853/http-lens-for-interfacing-with-an-api", "title": "HTTP Lens for interfacing with an API?", "body": "<p>I'm just starting to pick up momentum with Haskell, and loving the abstractions I run into daily, such as <code>lens</code>.</p>\n\n<p>I'm to a point where a REST API lens would be useful to work with, but before I spend hours finding it's not possible... is it?</p>\n\n<p>The major problem I see is that I'm not directly accessing a data structure, but outputting a string which is requested (my lens syntax is probably wrong):</p>\n\n<pre><code>\u03bb&gt; over (user \"robertplant\") . set favoritesong\n\nPOST http://...com/api/user/robertplant/favoritesong\n{\n  ...\n}\n\n----\n\n\u03bb&gt; over (user \"robertplant\") . view _1\n\nGET http://...com/api/user/robertplant/favoritesong/123\n</code></pre>\n\n<p>I'm assuming that's at least an Applicative problem, or possibly needs an Monad?</p>\n\n<p>I mean, I could imagine this lens satisfying the lens laws (in some sense... it's still a bit fuzzy to me), but I haven't seen yet that a lens has the hardware for putting out strings/other data structures like this.</p>\n\n<p>Is this a journey worth pursuing?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1487980493, "post_id": 42450079, "comment_id": 72044266, "body": "Any hints on implementing <code>Ord1</code> by hand? I&#39;m thinking of something like <code>constructorIndex :: Foo a -&gt; Int</code> helper."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1487981265, "post_id": 42450079, "comment_id": 72044483, "body": "@nponeccop That can help if you have lots of constructors. For something small like your <code>Foo</code> I&#39;d do it in a similar way to your <code>Eq1</code> instance. In terms of <code>compare</code>: <code>Bar</code> vs. <code>Baz</code> gives <code>LT</code>; <code>Baz</code> vs. <code>Bar</code> gives <code>GT</code>; for <code>Bar</code> vs. <code>Bar</code> you compare the strings; and for <code>Baz</code> vs. <code>Baz</code> you compare the heads, and then the tails if comparing the heads gives <code>EQ</code>."}, {"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1488572747, "post_id": 42450079, "comment_id": 72307797, "body": "Well, the <a href=\"https://github.com/ptol/oczor/blob/4e400dfcf54e1b3a8de9d3bbf13b6c5f70a3ec15/src/Oczor/Syntax/TypesF.hs#L48\" rel=\"nofollow noreferrer\">real type</a> has 11 constructors lol."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1488573975, "post_id": 42450079, "comment_id": 72308431, "body": "@nponeccop Then it definitely helps :) (How many equations you&#39;d need without the helper? 31 at least, I reckon?)"}, {"owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1488574422, "post_id": 42450079, "comment_id": 72308640, "body": "121 completely naive and 67 if you take anti-symmetry into account."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "edited": false, "score": 0, "creation_date": 1488576367, "post_id": 42450079, "comment_id": 72309610, "body": "@nponeccop My figure of 31 was exploiting the order of the matches, but not the anti-symmetry. If you use both the order and the anti-symmetry I think you can get it down to 22."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1487979471, "last_edit_date": 1495541354, "creation_date": 1487979471, "answer_id": 42450079, "question_id": 42449584, "link": "https://stackoverflow.com/questions/42449584/purpose-and-semantics-of-eq1-ord1-type-classes/42450079#42450079", "title": "Purpose and semantics of Eq1/Ord1 type classes", "body": "<p>The point of <code>Eq1</code> and friends is providing constraints meant to be used with type constructors that take type constructors -- for instance, monad transformers, or <code>Fix</code> (cf. <a href=\"https://stackoverflow.com/q/38958895/2751851\"><em>How to derive instances in recursion schemes</em></a>) -- in a tidier manner that doesn't require extensions such as <code>FlexibleContexts</code> or <code>UndecidableInstances</code>.</p>\n\n<blockquote>\n  <p>Is the instance above correct?</p>\n</blockquote>\n\n<p>Yes, it is.</p>\n\n<blockquote>\n  <p>Am I supposed to implement it by hand in GHC 8.0.2?</p>\n</blockquote>\n\n<p>For the moment, there is no GHC-provided deriving for <code>Eq1</code>. Here is a <a href=\"https://mail.haskell.org/pipermail/libraries/2016-January/026536.html\" rel=\"nofollow noreferrer\">libraries mailing list discussion of that matter</a>.</p>\n\n<blockquote>\n  <p>There is <code>deriving-compat</code> library that uses TH, but why is it called <code>-compat?</code></p>\n</blockquote>\n\n<p>I believe the \"compat\" is there merely because that library also offers deriving of instances that recent GHCs do provide for older GHCs.</p>\n"}], "owner": {"reputation": 13121, "user_id": 805266, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/eabce8cd59f72d8f9e7db06a0343bdb1?s=128&d=identicon&r=PG", "display_name": "nponeccop", "link": "https://stackoverflow.com/users/805266/nponeccop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 1, "accepted_answer_id": 42450079, "answer_count": 1, "score": 4, "last_activity_date": 1487979564, "creation_date": 1487976493, "last_edit_date": 1487979564, "question_id": 42449584, "link": "https://stackoverflow.com/questions/42449584/purpose-and-semantics-of-eq1-ord1-type-classes", "title": "Purpose and semantics of Eq1/Ord1 type classes", "body": "<p>Considering the following type, how am I supposed to implement the <code>Eq1</code> instance?</p>\n\n<pre><code>data Foo a = Bar String | Baz a [a]\n\ninstance Eq1 Foo where\n    liftEq _ (Bar a) (Bar b) = a == b -- can't use f\n    liftEq f (Baz a aa) (Baz b bb) = f a b &amp;&amp; liftEq f aa bb -- instance for lists\n    liftEq _ _ _ = False\n</code></pre>\n\n<p>Is the instance above correct? Am I supposed to implement it by hand in GHC 8.0.2? There is <code>deriving-compat</code> library that uses TH, but why is it called <code>-compat</code>?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1487975259, "post_id": 42449282, "comment_id": 72042495, "body": "Short answer: yes, it is preserved. Related: <a href=\"http://stackoverflow.com/q/5451645/2751851\"><i>Implementing lazy functional languages</i></a>"}], "answers": [{"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": true, "score": 5, "last_activity_date": 1487984117, "creation_date": 1487984117, "answer_id": 42450666, "question_id": 42449282, "link": "https://stackoverflow.com/questions/42449282/is-haskells-laziness-preserved-at-compilation/42450666#42450666", "title": "Is Haskell&#39;s Laziness Preserved at Compilation?", "body": "<p>To be sure, on contemporary hardware Haskell code is ultimately turned into imperative code, namely assembly code, which is imperative. </p>\n\n<p>This does not mean that laziness must vanish, and in fact, it doesn't. Mind you that it is possible to model lazy data structures in imperative languages. For example, one could do the following to model a lazy list of values (note: I am <strong>not</strong> saying that existing Haskell implementations do it that way, I just want to show how it <em>could</em> be done):</p>\n\n<pre><code>struct List {\n    Value *val;\n    struct {\n        bool evaluated;\n        union {\n            struct List *list;\n            struct List *(*eval)();\n        } ptr;\n    } next;\n};\n</code></pre>\n\n<p>So, whenever one needs to go to the tail of a list, there may be either an already evaluated pointer to it (<code>next.ptr.list</code>), or just a pointer to a function that computes such a pointer (<code>next.ptr.eval</code>). </p>\n"}], "owner": {"reputation": 230, "user_id": 4064871, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh3.googleusercontent.com/-m120Xswr1B0/AAAAAAAAAAI/AAAAAAAAACA/RcMDxAI5g-s/photo.jpg?sz=128", "display_name": "name", "link": "https://stackoverflow.com/users/4064871/name"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 42450666, "answer_count": 1, "score": 0, "last_activity_date": 1487984117, "creation_date": 1487974912, "question_id": 42449282, "link": "https://stackoverflow.com/questions/42449282/is-haskells-laziness-preserved-at-compilation", "title": "Is Haskell&#39;s Laziness Preserved at Compilation?", "body": "<p>So I'm new to this whole functional programming deal. In my recent adventures to learn about Haskell, I've come across a curious question. I'm aware that the GHC interactive environment allows for what is called \"lazy\" evaluation, which means that Haskell expressions are only evaluated when their values are required. This sounds like a very useful behavior, since it could help simplify the optimization process. My next logical thought went to: then what happens when Haskell is compiled to machine code? Do you lose your laziness? Is it turned into \"imperative\" code?</p>\n"}, {"tags": ["selenium", "haskell", "selenium-webdriver", "webdriver"], "answers": [{"comments": [{"owner": {"reputation": 2322, "user_id": 33841, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/5xaqb.jpg?s=128&g=1", "display_name": "kmelvn", "link": "https://stackoverflow.com/users/33841/kmelvn"}, "edited": false, "score": 1, "creation_date": 1487979774, "post_id": 42446459, "comment_id": 72044047, "body": "I did try something like that, but it doesn&#39;t survive a GHCi reload."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 2322, "user_id": 33841, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/5xaqb.jpg?s=128&g=1", "display_name": "kmelvn", "link": "https://stackoverflow.com/users/33841/kmelvn"}, "edited": false, "score": 1, "creation_date": 1488016383, "post_id": 42446459, "comment_id": 72051806, "body": "@kmelva You can use &quot;foreign-store&quot; <a href=\"http://hackage.haskell.org/package/foreign-store\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/foreign-store</a> to make the session persist across GHCi reloads. But perhaps the simplest way is to read the session from a predetermined file path (perhaps having an environment variable pointing to the file, for a bit of flexibility)."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "reply_to_user": {"reputation": 2322, "user_id": 33841, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/5xaqb.jpg?s=128&g=1", "display_name": "kmelvn", "link": "https://stackoverflow.com/users/33841/kmelvn"}, "edited": false, "score": 0, "creation_date": 1488201482, "post_id": 42446459, "comment_id": 72113058, "body": "@kmelva Why do you want/need it to persist across a reload? Is this for development convenience, or a fundamental part of the target workflow? Looking at <code>WDSession</code> I think the only part that would probably be difficult to serialize is the <code>Manager</code>. I&#39;m not familiar with <code>foreign-store</code> mentioned by @danidiaz - perhaps that is an easy easy way to get something working."}], "tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": false, "score": 2, "last_activity_date": 1488201091, "last_edit_date": 1488201091, "creation_date": 1487963303, "answer_id": 42446459, "question_id": 42446192, "link": "https://stackoverflow.com/questions/42446192/reuse-existing-selenium-session-with-haskell-and-webdriver/42446459#42446459", "title": "Reuse existing Selenium session with Haskell and webdriver", "body": "<p>I've never heard of the library before, but poking around now, I see <code>runSession</code> appears to indicate it will create a new session given a configuration and run a <code>WD</code> action.</p>\n\n<p>So perhaps something like this could work:</p>\n\n<pre><code>do\n  session &lt;- runSession defaultConfig getSession\n  runWD session (return ())\n</code></pre>\n\n<p><code>getSession</code> should work because <code>WD</code> is an instance of <code>WDSessionState</code>. <code>runSession</code> explicitly says that the session is not closed automatically, so hopefully it can be reused.</p>\n"}, {"comments": [{"owner": {"reputation": 2322, "user_id": 33841, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/5xaqb.jpg?s=128&g=1", "display_name": "kmelvn", "link": "https://stackoverflow.com/users/33841/kmelvn"}, "edited": false, "score": 0, "creation_date": 1487979684, "post_id": 42447938, "comment_id": 72044025, "body": "Thanks for the answer, but I&#39;m explicitly looking for a solution that does not require writing all fo the code inside one <code>runSession</code> block."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 4, "last_activity_date": 1487969693, "last_edit_date": 1487969693, "creation_date": 1487969015, "answer_id": 42447938, "question_id": 42446192, "link": "https://stackoverflow.com/questions/42446192/reuse-existing-selenium-session-with-haskell-and-webdriver/42447938#42447938", "title": "Reuse existing Selenium session with Haskell and webdriver", "body": "<p>The <code>WD</code> monad is an instance of <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad-IO-Class.html#t:MonadIO\" rel=\"nofollow noreferrer\"><code>MonadIO</code></a>, which means you can interleave WebDriver actions with IO actions using <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad-IO-Class.html#v:liftIO\" rel=\"nofollow noreferrer\"><code>liftIO</code></a>. This allows you to read and write to the the console. The idea is to do everything inside a single call to <code>runSession</code>.</p>\n\n<pre><code>main = runSession chromeConfig $ do\n    openPage \"http://www.google.com\"\n\n    liftIO $ putStrLn \"Enter your search term\"\n    searchTerm &lt;- liftIO getLine\n\n    input &lt;- findElem \"#lst-ib\"\n\n    sendKeys input searchTerm\n    submit input\n</code></pre>\n"}], "owner": {"reputation": 2322, "user_id": 33841, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/5xaqb.jpg?s=128&g=1", "display_name": "kmelvn", "link": "https://stackoverflow.com/users/33841/kmelvn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1488201091, "creation_date": 1487962238, "question_id": 42446192, "link": "https://stackoverflow.com/questions/42446192/reuse-existing-selenium-session-with-haskell-and-webdriver", "title": "Reuse existing Selenium session with Haskell and webdriver", "body": "<p>Trying to use Selenium from Haskell (with <code>webdriver</code> package) in a REPL session. To start things I run this:</p>\n\n<pre><code>startup :: IO ()\nstartup = do\n  runSession chromeConfig $ do\n    openPage \"http://www.google.com\"\n</code></pre>\n\n<p>New Chrome browser opens, navigates to Google, leaves it there and <code>startup</code> function is done and the Chrome browser is still open (that's just like I need it).</p>\n\n<p>Now I'd like to write simple scripts to interact with Google page and run them from the REPL. How can I reuse already existing session / Chrome browser that's open?</p>\n\n<p>If I try with runSession again, it opens a new browser (as the docs say). If I try to use <code>runWD</code>, it needs a session as a first parameter, which I don't have yet.</p>\n\n<p>There is a <code>sessions :: WebDriver wd =&gt; wd [(SessionId, Capabilities)]</code> value, but to use it I have to be inside <code>runWD</code> and that needs a session! Furthermore, it returns a <code>SessionID</code> and I don't see any function to turn that into a <code>WDSession</code>.</p>\n\n<p>I'm going in circles here, any help appreciated. I'm not sure why is this so complicated, is because of Selenium or Haskell?</p>\n"}, {"tags": ["python", "haskell", "recursion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1487961019, "post_id": 42445819, "comment_id": 72035245, "body": "<code>div</code> should be between backticks: <code>`div`</code>..."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1487964996, "post_id": 42445819, "comment_id": 72037364, "body": "Count your parentheses, and don&#39;t separate function arguments with <code>,</code>. It&#39;s <code>funcion x n (k + 1)</code>, not <code>funcion(x,n,k+1)</code>."}, {"owner": {"reputation": 103, "user_id": 7559973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ff7ffbd5dee68290cb41b5cf6827b5?s=128&d=identicon&r=PG&f=1", "display_name": "delta1020", "link": "https://stackoverflow.com/users/7559973/delta1020"}, "edited": false, "score": 0, "creation_date": 1487965821, "post_id": 42445819, "comment_id": 72037806, "body": "it is the python code"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 7559973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ff7ffbd5dee68290cb41b5cf6827b5?s=128&d=identicon&r=PG&f=1", "display_name": "delta1020", "link": "https://stackoverflow.com/users/7559973/delta1020"}, "edited": false, "score": 0, "creation_date": 1487964697, "post_id": 42445865, "comment_id": 72037177, "body": "Alexis Still does not give me the code and I get error prog.hs: 4: 1: error:     Parse error (possibly incorrect indentation or mismatched brackets) on line 4  I already corrected the div error"}], "tags": [], "owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "is_accepted": false, "score": 3, "last_activity_date": 1487961005, "creation_date": 1487961005, "answer_id": 42445865, "question_id": 42445819, "link": "https://stackoverflow.com/questions/42445819/haskell-error-improperly-terminated-character-constant/42445865#42445865", "title": "Haskell error Improperly terminated character constant", "body": "<p>You want backticks (which indicate an infix use of a prefix function) around <code>div</code>, not single quotes (which indicate character constants, hence the error). That is, you should use <code>`div`</code> where you use <code>'div'</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1487966226, "creation_date": 1487966226, "answer_id": 42447250, "question_id": 42445819, "link": "https://stackoverflow.com/questions/42445819/haskell-error-improperly-terminated-character-constant/42447250#42447250", "title": "Haskell error Improperly terminated character constant", "body": "<p>You are opening 4 parentheses and closing 3.</p>\n\n<p>Here's a suggestion for reformatting your code. I also made <code>funcionaux</code> recursive as it should be.</p>\n\n<p>You might have more errors to fix, this was untested.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import System.IO\nfuncion x n = funcionaux x n 1\nfuncionaux x n k = if k&gt;n \n   then 2*k - 1 \n   else 2*k - 1 - ((x**k) `div` funcionaux x n (k+1))\nmain = do\n   x &lt;- readLn :: IO Double\n   n &lt;- readLn :: IO Int\n   putStrLn (show (funcion x n))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 7618482, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e59104c3572ece7e5061d14e3fec61c?s=128&d=identicon&r=PG&f=1", "display_name": "avgolubev", "link": "https://stackoverflow.com/users/7618482/avgolubev"}, "is_accepted": true, "score": 0, "last_activity_date": 1487968438, "creation_date": 1487968438, "answer_id": 42447783, "question_id": 42445819, "link": "https://stackoverflow.com/questions/42445819/haskell-error-improperly-terminated-character-constant/42447783#42447783", "title": "Haskell error Improperly terminated character constant", "body": "<p>Well... Haskell is not so simple like python and it requires thoughtful study.</p>\n\n<p>Working code looks like:</p>\n\n<pre><code>import System.IO\n\nfuncionaux x n k = if(k&gt;n)\n                then 2*k-1\n                else (2*k-1)-((x^k) `div` (funcionaux x n (k+1)) )\nmain = do\n x &lt;- readLn :: IO Int\n n &lt;- readLn :: IO Int\n putStrLn (show (funcionaux x n 1))\n</code></pre>\n\n<p>And some notes:</p>\n\n<ol>\n<li>for infix use `operator` not 'operator';</li>\n<li>** and ^ for different types;</li>\n<li><code>div</code> and / for different types too;</li>\n<li>during a function call the arguments are passed without commas;</li>\n<li>and so on.</li>\n</ol>\n"}], "owner": {"reputation": 103, "user_id": 7559973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ff7ffbd5dee68290cb41b5cf6827b5?s=128&d=identicon&r=PG&f=1", "display_name": "delta1020", "link": "https://stackoverflow.com/users/7559973/delta1020"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 984, "favorite_count": 0, "accepted_answer_id": 42447783, "answer_count": 3, "score": -1, "last_activity_date": 1487968438, "creation_date": 1487960859, "last_edit_date": 1487964797, "question_id": 42445819, "link": "https://stackoverflow.com/questions/42445819/haskell-error-improperly-terminated-character-constant", "title": "Haskell error Improperly terminated character constant", "body": "<p>I'm trying to pass to haskell the following code but it gets me error Improperly terminated character constant in haskell. The code in python is already tested and is correc</p>\n\n<pre><code>    import System.IO\n    funcion x n = funcionaux x n 1\n    funcionaux x n k = if(k&gt;n) then 2*k-1 else (2*k-1)-((x**k)\u00b4div\u00b4(funcion(x,n,(k+1)))\n    main = do\n    x &lt;- readLn :: IO Double\n    n &lt;- readLn :: IO Int\n    putStrLn (show(funcion x n))\n</code></pre>\n\n<p>The python code is</p>\n\n<pre><code>    def funcion(x,n,k):\n        if k &gt; n:\n            return ((2*k)-1)\n        else:\n            return ((2*k)-1) - ((x**k)/funcion(x, n, (k+1)))\n\n    print(funcion(1.3,7,1)) \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1487944943, "post_id": 42440396, "comment_id": 72024934, "body": "Trying to get a declarative language to produce a certain lowlevel behaviour is generally a bad idea and contradicts the idea of &quot;declarative programming&quot;. Maybe you could outsource the relevant operations to another language?"}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1487946390, "post_id": 42440396, "comment_id": 72025923, "body": "@Ctx true ... otoh the asm generated from the manually unrolled code is actually pretty decent. Once the exploration phase is over I don&#39;t mind having that in my code."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1487947289, "post_id": 42440396, "comment_id": 72026527, "body": "BTW, your code looks a bit funny: nested guards, monadic <code>do</code> while returning a pure type. Not a big deal, since the question is about optimization, but you might want to clarify that anyway."}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 0, "creation_date": 1487948052, "post_id": 42440396, "comment_id": 72027122, "body": "Yep, that&#39;s probably more pseudo Haskell than real code :-)"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1487948094, "post_id": 42440396, "comment_id": 72027152, "body": "@Ctx: Often it&#39;s easy to convince SQL, a poster child of declarative, to generate the plan you ask for, unless what you ark for something unreasonable. Also, isn&#39;t <code>do</code>-notation pretty &quot;imperative&quot;, that is, a pretty linear, predictable nested function application?"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1487948582, "post_id": 42440396, "comment_id": 72027489, "body": "@9000 But you usually cannot &quot;convince&quot; the database to follow a special plan within the sql-statement itself, but you have to make appropriate indexes, make sure the row statistics are accurete, set environment parameters etc. pp. Yes, the do-notation is a compromise being pure functional on one hand but pragmatic enough to resemble imperative programming up to some degree. If it is used extensively it is usually a strong indication that the wrong language was chosen ;)"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1487949327, "post_id": 42440396, "comment_id": 72027969, "body": "@Ctx: Indeed! You can <i>hope</i> to convince the implementation follow your understanding how to do something, but there&#39;s no guarantee. In other words, there are no tools for finer control, and often no visibility into the reasons why the compiler decides not to apply an &quot;obvious&quot; pattern. I wish both Haskell and SQL had more tools for that. Maybe you know some? (The problem is not endemic to functional / declarative realms; e.g. it&#39;s often hard to understand why C++ would not vectorize a certain &quot;obviously parllel&quot; computation.)"}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1487949519, "post_id": 42440396, "comment_id": 72028102, "body": "@9000 With PostgreSQL &quot;EXPLAIN ANALYZE&quot; is very useful to understand why the database does things a certain way (and this helps much to take appropriate countermeasures). Unfortunately I do not know an equivalent useful tool for haskell&amp;friends..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 2, "creation_date": 1487950822, "post_id": 42440396, "comment_id": 72029010, "body": "@Ctx GHC Haskell internally compiler to Core, which can be dumped with <code>-ddump-simpl</code>. Sometimes it clarifies a lot, other times it can produce a hard to read code."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1487951306, "post_id": 42440396, "comment_id": 72029343, "body": "@Ctx [1/2] (1) Haskell libraries like <i>vector</i> offer tools explictly geared for writing fairly low-level Haskell code tuned for performance. It can get tricky sometimes, and the resulting code won&#39;t necessarily be very pretty or very &quot;declarative&quot;, but depending on what you are trying to write it is very much a reasonable path to follow. (2) &quot;If [do-notation] is used extensively it is usually a strong indication that the wrong language was chosen&quot; -- That claim is too broad. do-notation is just syntactic sugar for monadic code, and monadic code is definitely not a code smell."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "edited": false, "score": 0, "creation_date": 1487951321, "post_id": 42440396, "comment_id": 72029350, "body": "@Ctx [2/2] (3) As chi suggests, Core output (possibly paired with relevant time and memory profiles) can be seen as a rough counterpart to EXPLAIN ANALYZE in Haskell."}, {"owner": {"reputation": 17054, "user_id": 5636775, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GC9DT.gif?s=128&g=1", "display_name": "Ctx", "link": "https://stackoverflow.com/users/5636775/ctx"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1487951616, "post_id": 42440396, "comment_id": 72029548, "body": "@duplode Maybe the claim is too general, but was meant as a reply to &quot;do-notation being pretty imperative&quot; and to better take an imperative language in the first place when it is used too much for that purpose. I do not deny that there may be sensible applications."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 4, "creation_date": 1487960791, "post_id": 42440396, "comment_id": 72035118, "body": "Your code would be subject to stream fusion if you wrote <code>minimum3</code>/<code>median15</code> taking a vector and then using a fold over it. <a href=\"https://www.microsoft.com/en-us/research/wp-content/uploads/2016/07/haskell-beats-C.pdf\" rel=\"nofollow noreferrer\">This paper</a> goes into more detail about this sort of thing. The general advice is always the same: write your code using functions that fuse (like folds). <code>sequence</code> seems like a singularly bad idea in this case."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1487976437, "post_id": 42440396, "comment_id": 72042956, "body": "As I see it, this has nothing to do with vector in particular. You have a &#39;loop&#39; over the integers <code>[0..2]</code> - it just so happens that the body of the loop uses <code>vector</code> operations and types. While fusion could certainly solve this problem, it isn&#39;t <code>vector</code> which would do it. If you represent your loop as <code>(Int, Int -&gt; a)</code> (the size of the loop, and the body) then you could write a <i>term-level</i> Haskell program (as opposed to compiler-level, i.e. rewrite rules) which &#39;unrolls&#39; such a loop, and use e.g. type classes to inline copies of the body. ...."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1487976532, "post_id": 42440396, "comment_id": 72043001, "body": "... While this is more tedious than using rewrite rules, it gives you a very fine-grained control over how you unroll your loop - unroll every iteration, or unroll <code>k</code> iterations into <code>n</code> blocks, or unroll up to <code>k</code> iterations for any given loop, etc."}], "owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 0, "score": 7, "last_activity_date": 1487951507, "creation_date": 1487944410, "last_edit_date": 1487951507, "question_id": 42440396, "link": "https://stackoverflow.com/questions/42440396/how-to-prevent-allocations-in-unrollable-code", "title": "How to prevent allocations in unrollable code?", "body": "<p>Given the following pieces of (boiled down and pseudo Haskell-ish) code:</p>\n\n<pre><code>import qualified Data.Vector.Unboxed as V\n\nminimum3 :: Double -&gt; Double -&gt; Double -&gt; Double\nminimum3 a b c | a &lt; b     | a &lt; c     = a\n                           | otherwise = c\n               | otherwise | b &lt; c = b\n                           | otherwise c\n\nreadMinimum3 :: V.Vector Double -&gt; Int -&gt; Double\nreadMinimum3 v i = do\n\n    a &lt;- V.unsafeRead v (i+0)\n    b &lt;- V.unsafeRead v (i+1)\n    c &lt;- V.unsafeRead v (i+2)\n\n    -- manually unrolled version of:\n    -- [a,b,c] &lt;- sequence [V.unsafeRead v (i+j) | j &lt;- [0..2]]\n\n    return $! minimum3 a b c\n</code></pre>\n\n<p><code>minimum3</code> is a standin for a bigger function <code>median15</code> but the idea is the same. All of this is done to prevent memory allocations, in fact this code gets compiled down to basically linear assembler.</p>\n\n<p>I've also tried the same thing based on <code>vectors</code> hoping that fusion would eliminated the intermediate vector holding the read values, but no luck.</p>\n\n<p>The question is if there is any way to write this in a more maintainable way without having to unroll the thing by hand?</p>\n"}, {"tags": ["haskell", "types", "ghc", "cartesian-product", "hlist"], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1487956542, "post_id": 42439383, "comment_id": 72032680, "body": "Note that this bottoms out pretty quickly - GHC&#39;s tuples are limited to <a href=\"https://github.com/ghc/ghc/blob/master/libraries/ghc-prim/GHC/Tuple.hs#L167-L168\" rel=\"nofollow noreferrer\">62 elements</a> (if I count correctly)."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1487956696, "post_id": 42439383, "comment_id": 72032776, "body": "@Alec: yeah, I only wanted to provide a solution that uses builtin Haskell types."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1487941428, "creation_date": 1487941428, "answer_id": 42439383, "question_id": 42438383, "link": "https://stackoverflow.com/questions/42438383/cartesian-product-of-heterogeneous-lists/42439383#42439383", "title": "Cartesian product of heterogeneous lists", "body": "<p>A way to solve this, is by using <em>template Haskell</em> for that:</p>\n\n<pre><code>import Control.Monad(replicateM)\nimport Language.Haskell.TH.Syntax(newName,Pat(TupP,VarP),Exp(LamE,TupE,VarE))\n\nheteroCartesian m n = do\n    as &lt;- replicateM m $ newName \"a\"\n    bs &lt;- replicateM n $ newName \"b\"\n    return $ LamE [TupP (map VarP as),TupP (map VarP bs)] $ TupE $ [TupE [VarE ai,VarE bi] | ai &lt;- as, bi &lt;- bs]\n</code></pre>\n\n<p>Now in another file, you can use the function:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nheteroCartesian23 = $(heteroCartesian 2 3)\n</code></pre>\n\n<p>In that case <code>heteroCartesian23</code> will have type <code>heteroCartesian23 :: (a1,a2) -&gt; (b1,b2,b3) -&gt; ((a1,b1),(a1,b2),(a1,b3),(a2,b1),(a2,b2),(a2,b3))</code>.</p>\n\n<p>Or you can use it in <code>ghci</code>:</p>\n\n<pre><code>$ ghci -XTemplateHaskell library.hs\nGHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( ha.hs, interpreted )\nOk, modules loaded: Main.\n*Main&gt; :t $(heteroCartesian 3 4)\n$(heteroCartesian 3 4)\n  :: (t, t1, t5)\n     -&gt; (t2, t3, t4, t6)\n     -&gt; ((t, t2),\n         (t, t3),\n         (t, t4),\n         (t, t6),\n         (t1, t2),\n         (t1, t3),\n         (t1, t4),\n         (t1, t6),\n         (t5, t2),\n         (t5, t3),\n         (t5, t4),\n         (t5, t6))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 5, "last_activity_date": 1487960179, "last_edit_date": 1495540409, "creation_date": 1487953109, "answer_id": 42443413, "question_id": 42438383, "link": "https://stackoverflow.com/questions/42438383/cartesian-product-of-heterogeneous-lists/42443413#42443413", "title": "Cartesian product of heterogeneous lists", "body": "<p>It appears <code>HList</code> has indeed bit rotted a bit. Nonetheless, nothing stops us from rolling our own <code>HList</code>! In fact, we can also heavily rely on <a href=\"https://hackage.haskell.org/package/singletons\" rel=\"nofollow noreferrer\"><code>singletons</code></a> for our type level list operations. First, some imports:</p>\n\n<pre><code>{-# LANGUAGE DataKinds, TypeOperators, GADTs,TypeFamilies, UndecidableInstances, PolyKinds, FlexibleInstances #-}\n\nimport Data.Singletons\nimport Data.Promotion.Prelude.List\n</code></pre>\n\n<p>Then the actual definition of an <code>HList</code> (simpler than the one the package of that name uses, for reasons described <a href=\"https://stackoverflow.com/questions/41135212/understanding-this-definition-of-hlist/41135693#41135693\">here</a> and <a href=\"https://stackoverflow.com/questions/41158070/future-of-roles-for-gadt-like-type-variables\">here</a>).</p>\n\n<pre><code>data HList (l :: [*]) where\n  HNil :: HList '[]\n  HCons :: x -&gt; HList xs -&gt; HList (x ': xs)\n\n-- Notice we are using `:++` from singletons\nappend :: HList xs -&gt; HList ys -&gt; HList (xs :++ ys)\nappend HNil xs = xs\nappend (x `HCons` xs) ys = x `HCons` (xs `append` ys)\n\n-- Notice we are using `Map` and `TyCon1` from singletons. Bow before the magic\n-- of type level HOFs. ;)\naddTuple :: z -&gt; HList xs -&gt; HList (Map (TyCon1 ((,) z)) xs)\naddTuple _ HNil = HNil\naddTuple x (y `HCons` ys) = (x,y) `HCons` addTuple x ys\n\n-- These instances aren't needed, but they let us check the output of our code\ninstance (Show x, Show (HList xs)) =&gt; Show (HList (x ': xs)) where\n  show (x `HCons` xs) = show x ++ \" \" ++ show xs\ninstance Show (HList '[]) where\n  show HNil = \"\"\n</code></pre>\n\n<p>Finally, we get to the cartesian product itself:</p>\n\n<pre><code>type family Cartesian (ys :: [*]) (xs :: [*]) :: [*] where\n  Cartesian '[] xs = '[]\n  Cartesian (y ': ys) xs = Map (TyCon1 ((,) y)) xs :++ Cartesian ys xs\n\ncartesian :: HList xs -&gt; HList ys -&gt; HList (xs `Cartesian` ys)\ncartesian HNil _ = HNil\ncartesian (y `HCons` ys) xs = addTuple y xs `append` cartesian ys xs\n</code></pre>\n\n<p>Which we can test works:</p>\n\n<pre><code>ghci&gt; h1 = HCons True $ HCons LT $ HCons () $ HCons (1 :: Int) HNil\nghci&gt; h2 = HCons () $ HCons \"hello\" $ HCons 'a' HNil\nghci&gt; h1 `cartesian` h2\n(True,()) (True,\"hello\") (True,'a') (LT,()) (LT,\"hello\") (LT,'a') ((),()) ((),\"hello\") ((),'a') (1,()) (1,\"hello\") (1,'a')\n</code></pre>\n\n<hr>\n\n<p>With all that said, I'm not sure this is <em>really</em> worth it for tests. Fundamentally, I expect tests to be simpler and more readable than the code I am testing. And <code>HList</code> is not my idea of a simple test. But, to each his own. :)</p>\n"}], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1582786528, "creation_date": 1487938453, "last_edit_date": 1582786528, "question_id": 42438383, "link": "https://stackoverflow.com/questions/42438383/cartesian-product-of-heterogeneous-lists", "title": "Cartesian product of heterogeneous lists", "body": "<p>Of course, producing a Cartesian product of heterogeneous lists can be done in a number of way in Haskell, such as:</p>\n\n<pre><code>[(x,y) | x &lt;- [1,2,3], y &lt;- [4,5,6]]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>(,) &lt;$&gt; [1,2,3] &lt;*&gt; [4,5,6]\n</code></pre>\n\n<p>But what I want is a function like this:</p>\n\n<pre><code>heteroCartesian :: \n  (a1, a2, ... , an) -&gt; \n  (b1, b2, ... , bn) -&gt; \n  ((a1,b1), (a1,b2), ... , (a1,bn), (a2,b1), (a2,b2), ... , (a2,bn), (an,b1), ... ,(an,b2), ... , (an,bn))\n</code></pre>\n\n<p>So I can do something like this:</p>\n\n<pre><code>f (1,'a',True) (2,'b') == \n((1,2),(1,'b'),('a',2),('a','b'),(True,2),(True,'b'))\n</code></pre>\n\n<p>I don't mind whether I'm using tuples or something else, but I need to retain the type information like I have above.</p>\n\n<p>The reason why I want this is to create test cases. I've got a bunch of say <code>n</code> functions and <code>m</code> values. Eventually I will map a function over these which reduces them all to the same type (a <code>Test</code>) but up to that point there's a bunch of different types for the <code>n*m</code> testcases I want to perform (it's actually not that simple as some functions can only take restricted subsets of the values). </p>\n\n<p>So naturally it would good to have other functions these heterogeneous lists, like some sort of <code>map</code> for example.</p>\n\n<p>I've had a look at <a href=\"https://hackage.haskell.org/package/HList-0.4.1.0\" rel=\"nofollow noreferrer\">HList</a>, but it hasn't been updated in the last year and a bit, and I wasn't sure if it was the most appropriate tool anyway.</p>\n"}, {"tags": ["haskell", "ms-access-2016", "hdbc"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1487949389, "post_id": 42435431, "comment_id": 72028017, "body": "[1/2] <a href=\"https://github.com/hdbc/hdbc-odbc/issues/14\" rel=\"nofollow noreferrer\">This seems to be the same problem</a>, but there is no clear solution offered at the GitHub issue. More optmistically, perhaps you just need to install the appropriate ODBC drivers (cf. this <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_excel-mso_other/no-odbc-drivers-available-for-excel-or-access-in/001c234b-dfd5-4378-a325-c4f1482fb6fd\" rel=\"nofollow noreferrer\">discussion at a Microsoft forum</a>, and what I think is <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=13255\" rel=\"nofollow noreferrer\">the relevant download</a>)."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1487949554, "post_id": 42435431, "comment_id": 72028118, "body": "[2/2] (I remember that, a long time ago, I had to install some ODBC driver so that HDBC could talk with SQL Server on Windows 7. Unfortunately, I can&#39;t recall the excat details of what I did back then, nor am I able to attempt reproducing your problem at the moment.)"}], "answers": [{"tags": [], "owner": {"reputation": 4138, "user_id": 30160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9cc7a433f140236fb55c21d3266cced8?s=128&d=identicon&r=PG", "display_name": "Derrick Turk", "link": "https://stackoverflow.com/users/30160/derrick-turk"}, "is_accepted": false, "score": 1, "last_activity_date": 1532202204, "creation_date": 1532202204, "answer_id": 51459532, "question_id": 42435431, "link": "https://stackoverflow.com/questions/42435431/hdbc-odbc-with-ms-access-2016/51459532#51459532", "title": "HDBC-ODBC with MS Access 2016", "body": "<p>I got you, buddy, even if it's probably uselessly late!</p>\n\n<p>I just hit this exact issue and forked <code>HDBC-odbc</code> to fix it. In short: they \"foolishly\" trusted the MSDN documentation for <a href=\"https://docs.microsoft.com/en-us/sql/odbc/reference/syntax/sqlgetinfo-function?view=sql-server-2017\" rel=\"nofollow noreferrer\"><code>SQLGetInfo</code></a>, which claims that the <code>BufferLength</code> parameter is more-or-less ignored for non-string information types (say, the <code>SQLUSMALLINT</code> used when querying <code>SQL_TXN_CAPABLE</code>).</p>\n\n<p>Well, at least with the MS Access driver, that's not true. I tweaked the querying code to actually pass <code>sizeof(SQLUSMALLINT)</code> instead of zero, and things seem to be working.</p>\n\n<p>The updated <code>HDBC-odbc</code> can be had at <a href=\"https://github.com/derrickturk/hdbc-odbc\" rel=\"nofollow noreferrer\">https://github.com/derrickturk/hdbc-odbc</a>. I intend to put in a pull request as well, but I am not sure if <code>HDBC-odbc</code> is still maintained.</p>\n\n<p>In any case, if you use <code>stack</code>, it's as easy as changing your <code>extra-deps</code> in <code>stack.yaml</code> to include (replacing any previous source of <code>HDBC-odbc</code>):</p>\n\n<pre>\nextra-deps:\n  - git: https://github.com/derrickturk/hdbc-odbc.git\n    commit: 99cbefb16defc9ce6de77c1434207a78b5c3c365\n</pre>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1532202204, "creation_date": 1487929710, "last_edit_date": 1487949565, "question_id": 42435431, "link": "https://stackoverflow.com/questions/42435431/hdbc-odbc-with-ms-access-2016", "title": "HDBC-ODBC with MS Access 2016", "body": "<p>I am unable to understand the error I am getting when I try to connect to a MS access database file</p>\n\n<pre><code>\u03bb: :m + Database.HDBC Database.HDBC.ODBC\n\u03bb: let connectionString = \"DBQ=c:\\\\Users\\\\user\\\\Desktop\\\\Database1.accdb;Driver={Microsoft Access Driver (*.mdb, *.accdb)};\"\n\u03bb: conn &lt;- connectODBC connectionString\n\n*** Exception: SqlError {seState = \"[]\", seNativeError = -1, seErrorMsg = \"sqlGetInfo SQL_TXN_CAPABLE: []\"}\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1488070106, "post_id": 42434611, "comment_id": 72068927, "body": "side note - I would recommend using record syntax for your <code>Body</code> data type"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 6, "last_activity_date": 1487929917, "creation_date": 1487929917, "answer_id": 42435495, "question_id": 42434611, "link": "https://stackoverflow.com/questions/42434611/error-in-the-implementation-of-functor-for-my-datatype/42435495#42435495", "title": "Error in the implementation of Functor for my datatype", "body": "<p><code>Maybe</code> is not a type. <code>Maybe Int, Maybe Char, Maybe String, ...</code> are types.</p>\n\n<p><code>Body</code> is a type. <code>Body Int, Body Char, Body String, ...</code> are nonsense.</p>\n\n<p>In order to be a functor, your <code>data</code> must define a parametric type like <code>Maybe</code>.</p>\n\n<p>I guess you actually want a regular function rather than a functor instance. I'm not sure, however, about what you are really trying to accomplish.</p>\n"}], "owner": {"reputation": 411, "user_id": 7235699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/x7sjr.jpg?s=128&g=1", "display_name": "user7235699", "link": "https://stackoverflow.com/users/7235699/user7235699"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1487939445, "creation_date": 1487927129, "last_edit_date": 1487939445, "question_id": 42434611, "link": "https://stackoverflow.com/questions/42434611/error-in-the-implementation-of-functor-for-my-datatype", "title": "Error in the implementation of Functor for my datatype", "body": "<p>When I define following <code>Functor</code> for Maybe , it works fine </p>\n\n<pre><code>    instance Functor Maybe where\n        fmap func Nothing = Nothing\n        fmap func (Just val) = Just (func val)\n</code></pre>\n\n<p>I have defined my datatype as:</p>\n\n<pre><code>    type Vec2 = (Double, Double)\n    data Body = Body Vec2 Vec2 Double (Color3 Double) deriving(Eq,Ord, Show, Foldable)\n</code></pre>\n\n<p>But when I define following <code>functor</code> for it:</p>\n\n<pre><code>    instance Functor Body where\n    fmap func (Body pos vel mass clr) = Body (func pos vel mass clr)\n</code></pre>\n\n<p>I get the following error:</p>\n\n<blockquote>\n  <p>Expected kind '* -> *', but Body has kind *</p>\n</blockquote>\n\n<p>Kindly identify what is the issue?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1487924371, "post_id": 42433692, "comment_id": 72012026, "body": "Is that a typo in your list? <code>[Lust 4, List 5]</code> shouldn&#39;t compile."}, {"owner": {"reputation": 411, "user_id": 7235699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/x7sjr.jpg?s=128&g=1", "display_name": "user7235699", "link": "https://stackoverflow.com/users/7235699/user7235699"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1487924476, "post_id": 42433692, "comment_id": 72012075, "body": "Yes it is a typoi"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1487924521, "post_id": 42433692, "comment_id": 72012095, "body": "You can <a href=\"https://stackoverflow.com/posts/42433692/edit\">edit</a> your question at any time."}], "answers": [{"tags": [], "owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "is_accepted": false, "score": 1, "last_activity_date": 1487924274, "creation_date": 1487924274, "answer_id": 42433748, "question_id": 42433692, "link": "https://stackoverflow.com/questions/42433692/fmap-does-not-work-on-list-of-my-datatype/42433748#42433748", "title": "fmap does not work on list of my datatype", "body": "<p>Look at the type of <code>fmap</code>:</p>\n\n<pre><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>When you do</p>\n\n<pre><code>fmap (+3) [Lust 4, List 5]\n</code></pre>\n\n<p>You are using <code>fmap</code> on a list <code>[]</code>, so <code>f a</code> in this case is <code>Num b =&gt; [MyMaybe b]</code></p>\n\n<p>The implementation of <code>fmap</code> on a list is to map all elements of the list. In this case, the elements are <code>MyMaybe's</code>. But you can't apply <code>+3</code> on your <code>MyMaybe</code>s because it isn't a <code>Num</code>. If you want you can do:</p>\n\n<pre><code>fmap (fmap (+3)) [Lust 4, List 5]\n</code></pre>\n\n<p>This will apply the function <code>fmap (+3)</code> on each element of the list.</p>\n\n<hr>\n\n<p>You can use <code>ghci</code> to examine types of simple expressions, for example:</p>\n\n<pre><code>Prelude&gt; :t fmap (+3)\nfmap (+3) :: (Functor f, Num b) =&gt; f b -&gt; f b\n</code></pre>\n\n<p>Shows that the argument to <code>fmap (+3)</code> must be a functor of some <code>Num</code></p>\n"}, {"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1487924333, "creation_date": 1487924333, "answer_id": 42433772, "question_id": 42433692, "link": "https://stackoverflow.com/questions/42433692/fmap-does-not-work-on-list-of-my-datatype/42433772#42433772", "title": "fmap does not work on list of my datatype", "body": "<p><code>fmap (+3)</code> works for a <em>single</em> <code>MyMaybe</code> in this case. If you want to map a function over a list, you map that function. Let's give <code>fmap (+3)</code> a name:</p>\n\n<pre><code>myMaybePlus3 :: Num a =&gt; MyMaybe a -&gt; MyMaybe a\nmyMaybePlus3 = fmap (+3)\n</code></pre>\n\n<p>We can now see that it only works for a single <code>MyMaybe</code>. We can use <code>map</code> (or <code>fmap</code>) to use it for a list:</p>\n\n<pre><code>map myMaybePlus3 [Lust 4, Lust 5]\n</code></pre>\n\n<p>But due to referential transparency, we can also simply write</p>\n\n<pre><code>map (fmap (+3)) [Lust 4, Lust 5]\n</code></pre>\n\n<p>So all you were missing was an additional <code>(f)map</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 974, "user_id": 3829232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d2de116df80bc024b799e84dcdbc97?s=128&d=identicon&r=PG", "display_name": "soupi", "link": "https://stackoverflow.com/users/3829232/soupi"}, "is_accepted": false, "score": 1, "last_activity_date": 1487924679, "creation_date": 1487924679, "answer_id": 42433875, "question_id": 42433692, "link": "https://stackoverflow.com/questions/42433692/fmap-does-not-work-on-list-of-my-datatype/42433875#42433875", "title": "fmap does not work on list of my datatype", "body": "<p>In your code you are traversing through the list (using <code>fmap</code>) and are trying to apply <code>(+3)</code> to all elements, but your list elements are of type <code>Num a =&gt; MyMaybe a</code>.</p>\n\n<p>You need to apply <code>fmap</code> twice. Once for traversing the list as you did, and another to traverse each element inside the list which, again, has the type  <code>Num a =&gt; MyMaybe a</code>.</p>\n\n<p>So the code needs to be:</p>\n\n<p><code>fmap (fmap (+3)) [Lust 4, Lust 5]</code></p>\n"}], "owner": {"reputation": 411, "user_id": 7235699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/x7sjr.jpg?s=128&g=1", "display_name": "user7235699", "link": "https://stackoverflow.com/users/7235699/user7235699"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 42433772, "answer_count": 3, "score": 1, "last_activity_date": 1488292326, "creation_date": 1487924037, "last_edit_date": 1487927264, "question_id": 42433692, "link": "https://stackoverflow.com/questions/42433692/fmap-does-not-work-on-list-of-my-datatype", "title": "fmap does not work on list of my datatype", "body": "<p>I have defined my datatype as:</p>\n\n<pre><code>data MyMaybe a = Lust a | Lothing deriving (Show,Eq,Ord,Functor, Foldable)\n</code></pre>\n\n<p>When I type <code>fmap (+3) Lust 4</code> it gives me the correct answer:  <code>Lust 7</code></p>\n\n<p>But when I type <code>fmap (+3) [Lust 4, Lust 5]</code> it does not work and I get the follwoing error:</p>\n\n<pre><code>Non type-variable argument in the constraint: Num (MyMaybe a)\n</code></pre>\n\n<p>Please tell me what to do resolve this error. </p>\n"}, {"tags": ["haskell", "split", "escaping"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1487916619, "post_id": 42431576, "comment_id": 72008744, "body": "That code doesn&#39;t contain that error. What are you doing that results in the error? What exactly are you doing when you try to escape it?"}, {"owner": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1487917506, "post_id": 42431576, "comment_id": 72009077, "body": "Yes, that code works fine with other type of input. but if I call it like this: splitText  &quot;\\sentence number 1&quot; &#39;\\&#39; , it throws that error message. The problem is about splitting a text that has an escape character. So for example even the built-in function LINES &quot;\\sentence&quot; will give the same error."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1487917675, "post_id": 42431576, "comment_id": 72009142, "body": "You need to escape both slashes: <code>splitText &quot;\\\\sentence number 1&quot; &#39;\\\\&#39;</code>. Also, when you&#39;re writing inline code, you should use backticks (`) so that the StackOverflow formatter doesn&#39;t eat the `\\`s."}, {"owner": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1487917805, "post_id": 42431576, "comment_id": 72009194, "body": "You&#39;re right. The problem I was testing this code directly in Prelude, and for some reason it won&#39;t recognize the &#39;\\\\&#39;. When I compile the function, it works. Thank you for your help"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1487917930, "post_id": 42431576, "comment_id": 72009251, "body": "That should work both when running it in GHCi (I think this is what you mean by testing it in the Prelude) and when you compile it."}], "owner": {"reputation": 343, "user_id": 3413510, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a4bb04e8e539c57a6b5e1d43e3478579?s=128&d=identicon&r=PG&f=1", "display_name": "omar", "link": "https://stackoverflow.com/users/3413510/omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 393, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1489807255, "creation_date": 1487914970, "last_edit_date": 1489807255, "question_id": 42431576, "link": "https://stackoverflow.com/questions/42431576/split-a-string-in-haskell-escape-character-as-delimiter", "title": "Split a string in haskell: escape character &#39;\\&#39; as delimiter", "body": "<p>I am having a problem splitting a string with a '\\' as a delimiter.\nI copied this function:</p>\n\n<pre><code>  splitText :: String -&gt; Char -&gt; [String]\n\n  splitText [] delim =[\"\"]\n  splitText (c:cs) delim\n                  | c==delim = \"\" : rest\n                  |otherwise = (c:head rest):tail rest\n                  where\n                    rest= splitText cs delim\n</code></pre>\n\n<p>the problem is: my string starts like this: \"\\sentence....\" and I get the following error:</p>\n\n<pre><code>  lexical error in string/character literal at character 's'\n</code></pre>\n\n<p>I tried to escape the delimiter with '\\' but it doesn't work.\nI am allowed to use only modules that come pre-packaged with ghci /prelude</p>\n"}, {"tags": ["algorithm", "haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 7, "creation_date": 1487898812, "post_id": 42428876, "comment_id": 72003633, "body": "What you have posted is not a program, but an abstract specification of a program (i.e. &#39;pseudocode&#39;). As far as abstract specifications go, you are never obligated to &#39;literally&#39; translate the spec to code - how you implement <i>any</i> feature (in this case, control flow) is completely up to you. Furthermore, even if the question is &quot;how do I literally translate this pseudocode to Haskell&quot; then it seems you already have an answer (&quot;Continuation Monad can be used as goto statements&quot;) - but &quot;does it scale&quot; is entirely opinion based (what is &#39;complex&#39;? what is &#39;scale&#39;?)."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1487899281, "post_id": 42428876, "comment_id": 72003733, "body": "As far as the titular question (to which, in my opinion, the body does not correspond at all), my answer (which is again, only my opinion) would be - a goto is translated to a function call. But, this isn&#39;t saying much - Haskell is a <i>function</i>al language, so basically everything can be expressed as a function."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1487899468, "post_id": 42428876, "comment_id": 72003769, "body": "You may find this question will get more interesting answers if you include a <i>short</i> (real) code sample that uses GOTOs (presumably in some imperative language) and ask for a translation using CPS. In general, the problem with GOTOs is the same as CPS is the same as too many HOF - control flow becomes very difficult to follow."}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1487903371, "post_id": 42428876, "comment_id": 72004779, "body": "@Alec what is HOF? I&#39;ll provide a sample code later today."}, {"owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1487903455, "post_id": 42428876, "comment_id": 72004807, "body": "@user2407038 By scale I meant if the continuation monad has trouble when it is combined with other monads or if it is memory inneficient."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1487905297, "post_id": 42428876, "comment_id": 72005290, "body": "Consider reading something like <a href=\"http://repository.readscheme.org/ftp/papers/ai-lab-pubs/AIM-443.pdf\" rel=\"nofollow noreferrer\">lambda the ultimate goto</a> for an explanation of how to translate a goto-based implementation of an algorithm into one with function calls."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1487921721, "post_id": 42428876, "comment_id": 72010857, "body": "@LayGonz&#225;lez &quot;HOF&quot; = &quot;Higher order function&quot;. That being said, the algorithm above can be easily transformed into several loops and some smaller functions with some additional booleans and some early returns in your usual imperative language."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 1, "creation_date": 1487921790, "post_id": 42428876, "comment_id": 72010884, "body": "perhaps this will help <a href=\"https://gist.github.com/AndrasKovacs/6948657\" rel=\"nofollow noreferrer\">gist.github.com/AndrasKovacs/6948657</a>"}], "answers": [{"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 2, "last_activity_date": 1487935647, "creation_date": 1487935647, "answer_id": 42437488, "question_id": 42428876, "link": "https://stackoverflow.com/questions/42428876/how-to-express-gotos-in-a-fuctional-way/42437488#42437488", "title": "How to express &quot;goto&quot;s in a fuctional way?", "body": "<p>You may found these examples with <code>Cont</code> monad useful. They basically explain how you can define jumps in functional language:</p>\n\n<p><a href=\"https://www.vex.net/~trebla/haskell/cont-monad.xhtml\" rel=\"nofollow noreferrer\">https://www.vex.net/~trebla/haskell/cont-monad.xhtml</a></p>\n\n<p>As it was mentioned in comments to your questions, <code>goto</code> has connection with CPS and CPS is basically what <code>Cont</code> monad about.</p>\n"}], "owner": {"reputation": 2765, "user_id": 1120410, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/667389841c856a06cbb6d2821f130056?s=128&d=identicon&r=PG", "display_name": "Lay Gonz&#225;lez", "link": "https://stackoverflow.com/users/1120410/lay-gonz%c3%a1lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1487935647, "creation_date": 1487897097, "last_edit_date": 1487898375, "question_id": 42428876, "link": "https://stackoverflow.com/questions/42428876/how-to-express-gotos-in-a-fuctional-way", "title": "How to express &quot;goto&quot;s in a fuctional way?", "body": "<p>Take for example this diagram about some algorithm, where I have indicated with red arrows what I consider are \"goto\"s :\n<a href=\"https://i.stack.imgur.com/s10vI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s10vI.png\" alt=\"enter image description here\"></a></p>\n\n<p>In the Wikibook about Haskell, particularly in the <a href=\"https://en.wikibooks.org/wiki/Haskell/Continuation_passing_style\" rel=\"nofollow noreferrer\">Continuation Passing Style</a> section, it says that the Continuation Monad can be used as goto statements, but I'm wondering if this approach could scale to complex algorithms.</p>\n\n<p>To be honest, I thought that \"goto\"s were an antipattern, which bias me into thinking that there could be a better alternative. Perhaps \"goto\"s are just an antipattern in object oriented design?</p>\n"}, {"tags": ["string", "haskell", "indentation"], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 4, "last_activity_date": 1487893409, "creation_date": 1487893409, "answer_id": 42428278, "question_id": 42428194, "link": "https://stackoverflow.com/questions/42428194/new-line-indentation-haskell/42428278#42428278", "title": "New line indentation Haskell", "body": "<p>Your function works. If you\u2019re running this in GHCi or using <code>print</code>, you might be confused by the fact that it calls <code>show</code> on the result of your computation, which formats a value as a Haskell term for debugging. For strings, that means including quotes and escapes.</p>\n\n<p><code>putStrLn (onThreeLines \"Life\" \"is\" \"wonderful\")</code> should do exactly what you expect.</p>\n"}, {"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 4, "last_activity_date": 1487893510, "creation_date": 1487893510, "answer_id": 42428297, "question_id": 42428194, "link": "https://stackoverflow.com/questions/42428194/new-line-indentation-haskell/42428297#42428297", "title": "New line indentation Haskell", "body": "<p>Executing it like this should make it work:</p>\n\n<pre><code>main :: IO ()\nmain = putStrLn $ onThreeLines \"hello\" \"world\" \"test\"\n</code></pre>\n\n<p>Executing the program, I get:</p>\n\n<pre><code>$ ./test.hs\nhello\nworld\ntest\n</code></pre>\n\n<p>The reason you are getting <code>\"Life\\nis\\nwonderful\"</code> is because the <code>Show</code> instance is being used for displaying  which will escape the newline.</p>\n\n<pre><code>\u03bb&gt; putStrLn \"hello\\nworld\"\nhello\nworld\n\u03bb&gt; print \"hello\\nworld\"\n\"hello\\nworld\"\n</code></pre>\n\n<p>Note that <code>print</code> uses the <code>Show</code> instance for displaying.</p>\n"}, {"tags": [], "owner": {"reputation": 936, "user_id": 4884579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fca1fac3b94fed8f0291116e9b4ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4884579/erik"}, "is_accepted": false, "score": 2, "last_activity_date": 1487893715, "creation_date": 1487893715, "answer_id": 42428329, "question_id": 42428194, "link": "https://stackoverflow.com/questions/42428194/new-line-indentation-haskell/42428329#42428329", "title": "New line indentation Haskell", "body": "<p>There's nothing wrong with your function. \"Life\\nis\\nwonderful\" is the resulting String you want. Just remember that if you want the newlines rendered correctly, pass it to a function like <code>putStrLn</code></p>\n\n<pre><code>putStrLn (onThreeLines \"Life\" \"is\" \"wonderful\")\n</code></pre>\n\n<p>Also, be sure to check out the <code>unlines</code> function which concatenates a list of strings, separating each element with a newline character.</p>\n"}], "owner": {"reputation": 35, "user_id": 7607634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b0642c5271eeb1ad1e1cb41fe751ab2?s=128&d=identicon&r=PG&f=1", "display_name": "Yunodo", "link": "https://stackoverflow.com/users/7607634/yunodo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "closed_date": 1487901166, "accepted_answer_id": 42428278, "answer_count": 3, "score": 2, "last_activity_date": 1487893715, "creation_date": 1487892954, "question_id": 42428194, "link": "https://stackoverflow.com/questions/42428194/new-line-indentation-haskell", "closed_reason": "Duplicate", "title": "New line indentation Haskell", "body": "<p>I am a complete novice in Haskell and have the following question:\nI intend to create the function, which puts three Strings on different lines. Here is the code: </p>\n\n<pre><code>onThreeLines :: String -&gt; String -&gt; String -&gt; String\nonThreeLines a b c = a++\"\\n\"++b++\"\\n\"++c\n</code></pre>\n\n<p>Here is what I run:</p>\n\n<pre><code>  onThreeLines \"Life\" \"is\" \"wonderful\"\n</code></pre>\n\n<p>And what I get:</p>\n\n<pre><code> \"Life\\nis\\nwonderful\"\n</code></pre>\n\n<p>I have also tried the following character, but it doesn't work as well.</p>\n\n<pre><code>\"'\\n'\"\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1487884798, "post_id": 42425939, "comment_id": 71998262, "body": "The <code>withSession</code> function is precisely the function which provides a session. You &#39;get&#39; the session by manipulating the <code>sess</code> parameter within the body of the the function passed to <code>withSession</code>. In other words, if you have <code>main = withSession ..</code> then just type <code>main</code> (or <code>:main</code>) at the ghci prompt to run the action. As far &quot;evaluate the continuation line by line&quot;, you have to implement that logic yourself."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1487885276, "post_id": 42425939, "comment_id": 71998498, "body": "Wow, wonderful question! It would indeed be nice to be able to re-enter the GHCi repl for CPS-style library functions."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 12, "last_activity_date": 1487887231, "last_edit_date": 1487887231, "creation_date": 1487886122, "answer_id": 42426723, "question_id": 42425939, "link": "https://stackoverflow.com/questions/42425939/how-can-i-use-repl-with-cps-function/42426723#42426723", "title": "How can I use REPL with CPS function?", "body": "<p>Wonderful question.</p>\n\n<p>I am aware of no methods that can re-enter the GHCi REPL, so that we can use that in CPS functions. Perhaps others can suggest some way.</p>\n\n<p>However, I can suggest an hack. Basically, one can exploit concurrency to turn CPS inside out, if it is based on the IO monad as in this case.</p>\n\n<p>Here's the hack: use this in a GHCi session</p>\n\n<pre><code>&gt; sess &lt;- newEmptyMVar :: IO (MVar Session)\n&gt; stop &lt;- newEmptyMVar :: IO (MVar ())\n&gt; forkIO $ withSession $ \\s -&gt; putMVar sess s &gt;&gt; takeMVar stop\n&gt; s &lt;- takeMVar sess\n&gt; -- use s here as if you were inside withSession\n&gt; let s = () -- recommended\n&gt; putMVar stop ()\n&gt; -- we are now \"outside\" withSession, don't try to access s here!\n</code></pre>\n\n<p>A small library to automatize the hack:</p>\n\n<pre><code>data CPSControl b = CPSControl (MVar ()) (MVar b)\n\nstartDebugCps :: ((a -&gt; IO ()) -&gt; IO b) -&gt; IO (a, CPSControl b)\nstartDebugCps cps = do\n   cpsVal &lt;- newEmptyMVar\n   retVal &lt;- newEmptyMVar\n   stop   &lt;- newEmptyMVar\n   _ &lt;- forkIO $ do\n      x &lt;- cps $ \\c -&gt; putMVar cpsVal c &gt;&gt; takeMVar stop\n      putMVar retVal x\n   s &lt;- takeMVar cpsVal\n   return (s, CPSControl stop retVal)\n\nstopDebugCps :: CPSControl b -&gt; IO b\nstopDebugCps (CPSControl stop retVal) = do\n   putMVar stop ()\n   takeMVar retVal\n\ntestCps :: (String -&gt; IO ()) -&gt; IO String\ntestCps act = do\n   putStrLn \"testCps: begin\"\n   act \"here's some string!\"\n   putStrLn \"testCps: end\"\n   return \"some return value\"\n</code></pre>\n\n<p>A quick test:</p>\n\n<pre><code>&gt; (x, ctrl) &lt;- startDebugCps testCps\ntestCps: begin\n&gt; x\n\"here's some string!\"\n&gt; stopDebugCps ctrl\ntestCps: end\n\"some return value\"\n</code></pre>\n"}], "owner": {"reputation": 1106, "user_id": 4197293, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fdd3542179c9735316f934724992b7ce?s=128&d=identicon&r=PG", "display_name": "jeiea", "link": "https://stackoverflow.com/users/4197293/jeiea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 7, "accepted_answer_id": 42426723, "answer_count": 1, "score": 10, "last_activity_date": 1492993523, "creation_date": 1487883079, "last_edit_date": 1492993523, "question_id": 42425939, "link": "https://stackoverflow.com/questions/42425939/how-can-i-use-repl-with-cps-function", "title": "How can I use REPL with CPS function?", "body": "<p>I've just encountered <code>withSession :: (Session -&gt; IO a) -&gt; IO a</code> of <code>wreq</code> package. I want to evaluate the continuation line by line, but I can't find any way for this.</p>\n\n<pre><code>import Network.Wreq.Session as S\nwithSession $ \\sess -&gt; do\n  res &lt;- S.getWith opts sess \"http://stackoverflow.com/questions\"\n  -- print res\n  -- .. other things\n</code></pre>\n\n<p>In above snippet how can I evaluate <code>print res</code> in ghci? In other words, can I get <code>Session</code> type in ghci?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1487882809, "post_id": 42425738, "comment_id": 71997068, "body": "Note that the definition of <code>Functor</code> is <code>class Functor f where ...</code> not <code>class Functor (f a) where ...</code>, so instances of <code>Functor</code> must look like <code>instance Functor Maybe where ...</code> and not like <code>instance Functor (Maybe a) where ...</code>."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1487883259, "post_id": 42425738, "comment_id": 71997345, "body": "It&#39;s currying for types."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1487884452, "post_id": 42425738, "comment_id": 71998077, "body": "The statement &quot;only type constructors that take exactly one parameter can be made an instance of Functor&quot;  is simply an oversimplification (as one would expect of a complete beginner level tutorial). The <i>kind</i> of <code>Functor</code> is <code>(* -&gt; *) -&gt; Constraint</code>, so <code>instance Functor F</code> is only valid if <code>F</code> has kind <code>* -&gt; *</code>. <code>Pair a b</code> has kind <code>*</code>. <code>Pair c</code> has kind <code>* -&gt; *</code> and is a type constructor taking a type <code>x</code> and giving you the type <code>Pair c x</code>, like <code>Maybe</code> is a type constructor taking a type <code>x</code> and giving you the type <code>Maybe x</code>."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1487885076, "post_id": 42425738, "comment_id": 71998412, "body": "Well, consider a binary function <code>f</code>. Now what is <code>f x</code>? It&#39;s a unary function! The same is true with type constructors. Given a binary type constructor <code>Pair</code>, what is <code>Pair a</code>? A unary type constructor, and hence it can be made an instance of <code>Functor</code>. (partial application of type constructors, however, has some restrictions due to type inference...)"}, {"owner": {"reputation": 1731, "user_id": 780350, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/afaa8b1a1e2fe1b53755564e5fa34568?s=128&d=identicon&r=PG", "display_name": "melston", "link": "https://stackoverflow.com/users/780350/melston"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1487964357, "post_id": 42425738, "comment_id": 72037001, "body": "Thanks to everyone who answered.  About an hour after I posted this question I started to get a (somewhat fuzzy) picture of the concepts you are outlining.  Although @user2407038, I am unfamiliar with the <i>kind</i> nomenclature you are using, I think I get the concept."}, {"owner": {"reputation": 1731, "user_id": 780350, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/afaa8b1a1e2fe1b53755564e5fa34568?s=128&d=identicon&r=PG", "display_name": "melston", "link": "https://stackoverflow.com/users/780350/melston"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1487964539, "post_id": 42425738, "comment_id": 72037092, "body": "@Bakuriu, I did start to see that (eventually) but it was just kind of &#39;thrown in&#39; the book without any explanation.  I have not seen, anywhere else, a description or explanation of partial application of types so I wasn&#39;t sure if the concept really translated from functions to types."}], "answers": [{"comments": [{"owner": {"reputation": 1731, "user_id": 780350, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/afaa8b1a1e2fe1b53755564e5fa34568?s=128&d=identicon&r=PG", "display_name": "melston", "link": "https://stackoverflow.com/users/780350/melston"}, "edited": false, "score": 1, "creation_date": 1487964876, "post_id": 42426715, "comment_id": 72037286, "body": "Thanks, Daniel.  This helps make it clearer.  After staring at the book for a while I began to recognize the similarities between <code>Pair c</code> and <code>Maybe</code> in the instance definitions for <code>Functor</code>.  I had never thought of the missing type in the <code>Maybe</code> definition case before (<code>instance Functor Maybe ...</code> as opposed to <code>instance Functor (Maybe a) ...</code>).  It never jumped out at me so I completely missed what was happening there.  Now that I see it I see that the instance definition for <code>Maybe</code> <i>already was</i> a partial application of types."}, {"owner": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "edited": false, "score": 0, "creation_date": 1589021745, "post_id": 42426715, "comment_id": 109129120, "body": "Is it possible to ignore the first type parameter more or less like <code>instance Functor (Pair _ b) where</code> so that applies <code>fmap :: (a -&gt; b) -&gt; Pair a c -&gt; Pair b c</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 3831, "user_id": 5536315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/38Cjm.png?s=128&g=1", "display_name": "scriptum", "link": "https://stackoverflow.com/users/5536315/scriptum"}, "edited": false, "score": 1, "creation_date": 1589046785, "post_id": 42426715, "comment_id": 109139539, "body": "@bob No, it is not possible. However, you can use the <a href=\"https://hackage.haskell.org/package/bifunctors-5.5.7/docs/Data-Bifunctor-Flip.html#t:Flip\" rel=\"nofollow noreferrer\"><code>Flip</code></a> newtype to get a similar effect."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 8, "last_activity_date": 1487886408, "last_edit_date": 1592644375, "creation_date": 1487886078, "answer_id": 42426715, "question_id": 42425738, "link": "https://stackoverflow.com/questions/42425738/partially-applying-a-type-in-a-type-constructor/42426715#42426715", "title": "Partially applying a type in a type constructor", "body": "<blockquote>\n<p>&quot;only type constructors that take exactly one parameter can be made an instance of Functor.&quot; I don't understand this statement. Where is this restriction ever described?</p>\n</blockquote>\n<p>The restriction comes from the type of <code>fmap</code> in the definition of <code>Functor</code>:</p>\n<pre><code>class Functor f where\n    fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n<p>Because the class variable <code>f</code> is applied to one argument in <code>f a</code>, the type used to instantiate <code>Functor</code> must be able to take one parameter. Because the application <code>f a</code> is part of a function type, <code>f</code> must not take more than one parameter. (There's one more subtle piece about what kinds of arguments <code>f</code> can take that's specified here, but I think it's worth skipping that for now; hopefully your tutorial will touch on this subtlety more later.)</p>\n<blockquote>\n<p>Given this, I would have thought that we could have used something like:</p>\n<pre><code>instance Functor (Pair a b) where ...\n</code></pre>\n<p>I would have thought that (Pair a b) would have substituted for 'f' in the definition of Functor without any problem. What keeps this from working?</p>\n</blockquote>\n<p>It is once again the type of <code>fmap</code> that keeps this from working. Filling in <code>Pair c d</code> for <code>f</code> (modifying <code>a</code> to <code>c</code> and <code>b</code> to <code>d</code> to avoid name clashes), we would get</p>\n<pre><code>fmap :: (a -&gt; b) -&gt; Pair c d a -&gt; Pair c d b\n</code></pre>\n<p>which doesn't make a lot of sense.</p>\n<blockquote>\n<p>Here is where I get lost. I don't recall ever seeing 'partially applying' types to a type constructor before.</p>\n</blockquote>\n<p>Well... now you have. =)</p>\n<blockquote>\n<p>I am not really sure what this even means in this context, let alone how it solves the problem identified above it.</p>\n</blockquote>\n<p>It means basically the same thing partial application at the term level means: <code>Pair a</code> is akin to a type function which takes another type as an argument. So, e.g., <code>Pair a</code> applied to <code>Int</code> would give the <code>Pair a Int</code> type. It solves the problem because now we are supplying a &quot;type-function-like&quot; thing rather than a &quot;type-like&quot; thing, so applying it to another type makes sense; that is, the substituted type of <code>fmap</code> for a <code>Pair c</code> instance would be</p>\n<pre><code>fmap :: (a -&gt; b) -&gt; Pair c a -&gt; Pair c b\n</code></pre>\n<p>which now makes sense because <code>Pair c a</code> and <code>Pair c b</code> are sensible types, whereas before <code>Pair c d a</code> and <code>Pair c d b</code> were over-applied and therefore not sensible types.</p>\n"}], "owner": {"reputation": 1731, "user_id": 780350, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/afaa8b1a1e2fe1b53755564e5fa34568?s=128&d=identicon&r=PG", "display_name": "melston", "link": "https://stackoverflow.com/users/780350/melston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 42426715, "answer_count": 1, "score": 6, "last_activity_date": 1487886408, "creation_date": 1487882245, "last_edit_date": 1495535380, "question_id": 42425738, "link": "https://stackoverflow.com/questions/42425738/partially-applying-a-type-in-a-type-constructor", "title": "Partially applying a type in a type constructor", "body": "<p>In the book \"Learn you a Haskell\", chapter 11 we have the introduction of the newtype keyword and it all makes sense to me up to the part where we see the Pair type being made an instance of a Functor.  </p>\n\n<p>This discussion begins with a problem statement that \"only type constructors that take exactly one parameter can be made an instance of Functor.\"  I don't understand this statement.  Where is this restriction ever described?</p>\n\n<p>In the context of the discussion we have a type Pair defined as:</p>\n\n<pre><code>newtype Pair b a = Pair { getPair :: (a,b) }\n</code></pre>\n\n<p>Given this, I would have thought that we could have used something like:</p>\n\n<pre><code>instance Functor (Pair a b) where ...\n</code></pre>\n\n<p>I would have thought that (Pair a b) would have substituted for 'f' in the definition of Functor without any problem.  What keeps this from working?</p>\n\n<p>Next, the author goes on to make Pair an instance of a Functor using the following:</p>\n\n<pre><code>instance Functor (Pair c) where ...\n</code></pre>\n\n<p>Here is where I get lost.  I don't recall ever seeing 'partially applying' types to a type constructor before.  I am not really sure what this even means in this context, let alone how it solves the problem identified above it.</p>\n\n<p>I think I have a misconception somewhere but I don't know where to go looking for it.  I did find <a href=\"https://stackoverflow.com/a/23900121/780350\" title=\"this\">this answer</a> but it only seems to go part of the way in answering the question.</p>\n"}, {"tags": ["haskell", "emacs", "intero"], "comments": [{"owner": {"reputation": 7219, "user_id": 326516, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/61292ea4b013ef2834a28f9ff390c6fd?s=128&d=identicon&r=PG", "display_name": "Micah Elliott", "link": "https://stackoverflow.com/users/326516/micah-elliott"}, "edited": false, "score": 0, "creation_date": 1487888044, "post_id": 42425544, "comment_id": 71999910, "body": "It installed fine for me. Current version from <code>package-list-packages</code> is intero-20170221.931, which looks newer than your reference."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 7401089, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/7tOHS.gif?s=128&g=1", "display_name": "pebblexe", "link": "https://stackoverflow.com/users/7401089/pebblexe"}, "edited": false, "score": 1, "creation_date": 1487952424, "post_id": 42438708, "comment_id": 72030079, "body": "That was it! Thank you!"}, {"owner": {"reputation": 1465, "user_id": 141830, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8218b2bfe3b134755128deccb2ba9b6c?s=128&d=identicon&r=PG", "display_name": "ZeroCool", "link": "https://stackoverflow.com/users/141830/zerocool"}, "edited": false, "score": 1, "creation_date": 1551894325, "post_id": 42438708, "comment_id": 96811140, "body": "Very helpful. Grazie mille!"}], "tags": [], "owner": {"reputation": 2593, "user_id": 4504245, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/GHZM4.png?s=128&g=1", "display_name": "SerialDev", "link": "https://stackoverflow.com/users/4504245/serialdev"}, "is_accepted": true, "score": 5, "last_activity_date": 1487939437, "creation_date": 1487939437, "answer_id": 42438708, "question_id": 42425544, "link": "https://stackoverflow.com/questions/42425544/why-cant-emacs-find-the-haskell-mode-package/42438708#42438708", "title": "Why can&#39;t emacs find the haskell-mode package?", "body": "<p>Try this:</p>\n\n<pre><code>(package-refresh-contents)\n</code></pre>\n\n<p>In case you do not have melpa, since it is not available on the elpa repository:</p>\n\n<pre><code>(setq package-archives '((\"gnu\" . \"https://elpa.gnu.org/packages/\")\n                     (\"marmalade\" . \"https://marmalade-repo.org/packages/\")\n                     (\"melpa\" . \"https://melpa.org/packages/\")))\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 7401089, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/7tOHS.gif?s=128&g=1", "display_name": "pebblexe", "link": "https://stackoverflow.com/users/7401089/pebblexe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 606, "favorite_count": 0, "accepted_answer_id": 42438708, "answer_count": 1, "score": 2, "last_activity_date": 1487939437, "creation_date": 1487881645, "last_edit_date": 1487889081, "question_id": 42425544, "link": "https://stackoverflow.com/questions/42425544/why-cant-emacs-find-the-haskell-mode-package", "title": "Why can&#39;t emacs find the haskell-mode package?", "body": "<p>The error I am currently getting is:</p>\n\n<pre><code>File error: http://melpa.org/packages/haskell-mode-20161110.316.tar, Not found\n</code></pre>\n\n<p>when installing <a href=\"https://commercialhaskell.github.io/intero/\" rel=\"nofollow noreferrer\">intero</a>. How do I go about fixing this?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["haskell", "applicative"], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1487879988, "post_id": 42424887, "comment_id": 71995452, "body": "I was trying something like this, and I couldn&#39;t get it to work even with InstanceSigs, RankNTypes, and ScopedTypeVariables, until I read your answer and added the <code>forall a b.</code> in the signature for <code>(&lt;*&gt;)</code>. Why is that one necessary? I am pretty inexperienced with RankNTypes, but I expected the <code>forall a b.</code> to be implicit there."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1487880338, "post_id": 42424887, "comment_id": 71995655, "body": "@amalloy This is, IMO, a mistake in the original definition of Haskell, where <code>let f :: a -&gt; ... ; f = ... where g :: a -&gt; ...</code> actually means <code>let f :: forall a1. a1 -&gt; ... ; f = ... where g :: forall a2. a2 -&gt; ...</code>. Yes, the innermost <code>a</code> is locally quantified, and has no relation with the outermost one. So spoke the Haskell Report. GHC currently does the same, except when using the non standard <code>forall a. </code> where it can safely diverge from the standard without breaking standard-compliant code."}, {"owner": {"reputation": 381, "user_id": 6162031, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c2087196e379c933f145a94453e5e592?s=128&d=identicon&r=PG&f=1", "display_name": "MLev", "link": "https://stackoverflow.com/users/6162031/mlev"}, "edited": false, "score": 0, "creation_date": 1487880369, "post_id": 42424887, "comment_id": 71995670, "body": "Thanks @chi !  Someone on freenode also gave me:  instance Applicative Foo where pure a = Foo a a f &lt;*&gt; a = Foo (field1 f $ field1 a) (field2 f $ field2 a)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1487879992, "last_edit_date": 1487879992, "creation_date": 1487879365, "answer_id": 42424887, "question_id": 42424530, "link": "https://stackoverflow.com/questions/42424530/error-on-defining-applicatives-with-record-accessors-cannot-construct-the/42424887#42424887", "title": "Error on defining Applicative&#39;s &lt;*&gt; with record accessors: cannot construct the infinite type: t ~ t -&gt; t1", "body": "<p>The definition</p>\n\n<pre><code>r g = g f $ g a\n</code></pre>\n\n<p>require <code>g</code> to be a polymorphic function -- GHC can not infer such a complex type.</p>\n\n<p>You need to be more explicit in your types, if you really want your code to compile:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, DeriveFunctor, InstanceSigs, Rank2Types #-}\ninstance Applicative Foo where\n  pure a = Foo a a\n  (&lt;*&gt;) :: forall a b. Foo (a-&gt;b) -&gt; Foo a -&gt; Foo b\n  f &lt;*&gt; a = Foo (r field1) (r field2)\n     where\n     r :: (forall t. Foo t -&gt; t) -&gt;  b\n     r g = g f $ g a\n</code></pre>\n\n<p>Alternatively, one can use a more direct approach:</p>\n\n<pre><code>instance Applicative Foo where\n  pure a = Foo a a\n  (Foo f1 f2) &lt;*&gt; (Foo a1 a2) = Foo (f1 a1) (f2 a2)\n</code></pre>\n"}], "owner": {"reputation": 381, "user_id": 6162031, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c2087196e379c933f145a94453e5e592?s=128&d=identicon&r=PG&f=1", "display_name": "MLev", "link": "https://stackoverflow.com/users/6162031/mlev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 42424887, "answer_count": 1, "score": 3, "last_activity_date": 1487880411, "creation_date": 1487878155, "last_edit_date": 1487880411, "question_id": 42424530, "link": "https://stackoverflow.com/questions/42424530/error-on-defining-applicatives-with-record-accessors-cannot-construct-the", "title": "Error on defining Applicative&#39;s &lt;*&gt; with record accessors: cannot construct the infinite type: t ~ t -&gt; t1", "body": "<p>I have the following code:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n\ndata Foo a = Foo { field1 :: a, field2 :: a} deriving (Functor)\n\ninstance Applicative Foo where\n  pure a = Foo a a\n  f &lt;*&gt; a = Foo (r field1) (r field2)\n    where r g = g f $ g a\n</code></pre>\n\n<p>I am getting the following errors in GHCi:</p>\n\n<pre><code>help.hs:8:23: error:\n    \u2022 Occurs check: cannot construct the infinite type: t ~ t -&gt; t1\n    \u2022 In the second argument of \u2018($)\u2019, namely \u2018g a\u2019\n      In the expression: g f $ g a\n      In an equation for \u2018r\u2019: r g = g f $ g a\n    \u2022 Relevant bindings include\n        g :: Foo (a -&gt; b) -&gt; t -&gt; t1 (bound at help.hs:8:13)\n        r :: (Foo (a -&gt; b) -&gt; t -&gt; t1) -&gt; t1 (bound at help.hs:8:11)\n\nhelp.hs:8:25: error:\n    \u2022 Couldn't match type \u2018a\u2019 with \u2018a -&gt; b\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n        the type signature for:\n          (&lt;*&gt;) :: forall a b. Foo (a -&gt; b) -&gt; Foo a -&gt; Foo b\n        at help.hs:7:5\n      Expected type: Foo (a -&gt; b)\n        Actual type: Foo a\n    \u2022 In the first argument of \u2018g\u2019, namely \u2018a\u2019\n      In the second argument of \u2018($)\u2019, namely \u2018g a\u2019\n      In the expression: g f $ g a\n    \u2022 Relevant bindings include\n        g :: Foo (a -&gt; b) -&gt; t -&gt; t1 (bound at help.hs:8:13)\n        r :: (Foo (a -&gt; b) -&gt; t -&gt; t1) -&gt; t1 (bound at help.hs:8:11)\n        a :: Foo a (bound at help.hs:7:9)\n        f :: Foo (a -&gt; b) (bound at help.hs:7:3)\n        (&lt;*&gt;) :: Foo (a -&gt; b) -&gt; Foo a -&gt; Foo b (bound at help.hs:7:3)\n</code></pre>\n\n<p>How can I implement this applicative functor instance of Foo so that it compiles?</p>\n"}, {"tags": ["json", "postgresql", "haskell", "haskell-spock", "postgresql-simple"], "answers": [{"comments": [{"owner": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "edited": false, "score": 0, "creation_date": 1487924256, "post_id": 42424574, "comment_id": 72011986, "body": "What, thats it? After all that thinking headaches ? Thank you so much, that works. It is very confusing for me why with two parameters you can simply do ( parA:Int,parB:Int), but with oneparam  you have to do the <code>Only</code> notation. But after you pointed me towards it I found some comments on that in the Postgres-Simple Docs, so I guess I will understand it later."}, {"owner": {"reputation": 974, "user_id": 3829232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d2de116df80bc024b799e84dcdbc97?s=128&d=identicon&r=PG", "display_name": "soupi", "link": "https://stackoverflow.com/users/3829232/soupi"}, "reply_to_user": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "edited": false, "score": 0, "creation_date": 1487925406, "post_id": 42424574, "comment_id": 72012533, "body": "In this context you can think of types like <code>Int</code> as a column and of a tuple as a row with two columns and of <code>Only</code> as a row with one column. <code>query</code> only deals with rows, so you need to place your column inside a row. This is a bit similar to using <code>values</code> in an insert statement in sql. You can&#39;t just pass 1, you need <code>values (1)</code> or <code>select 1</code>."}, {"owner": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "edited": false, "score": 0, "creation_date": 1487928300, "post_id": 42424574, "comment_id": 72014216, "body": "Makes more sense now. Thanks."}], "tags": [], "owner": {"reputation": 974, "user_id": 3829232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3d2de116df80bc024b799e84dcdbc97?s=128&d=identicon&r=PG", "display_name": "soupi", "link": "https://stackoverflow.com/users/3829232/soupi"}, "is_accepted": true, "score": 5, "last_activity_date": 1487878287, "creation_date": 1487878287, "answer_id": 42424574, "question_id": 42423736, "link": "https://stackoverflow.com/questions/42423736/postgres-simple-no-instance-for-torow-int-arising-from-a-use-of-query/42424574#42424574", "title": "postgres-simple - No instance for (ToRow Int) arising from a use of \u2018query\u2019", "body": "<p>What the error basically says is that you can't pass an <code>Int</code> to <code>query</code> as the third argument. <code>query</code> expects something that has an instance of the typeclass <a href=\"http://hackage.haskell.org/package/postgresql-simple-0.5.2.1/docs/Database-PostgreSQL-Simple-ToRow.html\" rel=\"noreferrer\"><code>ToRow</code></a> and <code>Int</code> is not one. What you might want to do in your case considering you only want to pass one value to <code>query</code> is to use <a href=\"http://hackage.haskell.org/package/postgresql-simple-0.5.2.1/docs/Database-PostgreSQL-Simple-Types.html#t:Only\" rel=\"noreferrer\"><code>Only</code></a>. So that line becomes:</p>\n\n<pre><code>query conn  \"select id,data from envelope where id = ?\" (Only (eid :: Int))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "is_accepted": false, "score": 1, "last_activity_date": 1487924923, "creation_date": 1487924923, "answer_id": 42433947, "question_id": 42423736, "link": "https://stackoverflow.com/questions/42423736/postgres-simple-no-instance-for-torow-int-arising-from-a-use-of-query/42433947#42433947", "title": "postgres-simple - No instance for (ToRow Int) arising from a use of \u2018query\u2019", "body": "<p>Based on soupis help I also find the corresponding part in the Postgres- Simple documentation. Just for completion, the docs mention an alternative Syntax, using a singleton list. So instead of using normal brackets you can use simply square brackets and it works too:</p>\n\n<p><code>query conn  \"select id,data from envelope where id = ?\" [eid :: Int]</code></p>\n\n<p>Additionally, in particular in my example, it makes more sense to return only the first row from the result, which then turned out to be simply straight forward with the <code>head</code> function. For anyone else who needs it, here is how you do it:</p>\n\n<p>Spock and Prelude both include a <code>head</code> function. To avoid conflicts I decided to hide Spocks function since I am not using it anyway.</p>\n\n<p>Add to your script at the top:</p>\n\n<p><code>import Web.Spock hiding(head)</code></p>\n\n<p>Then change the <code>get</code> part to:</p>\n\n<pre><code>get ( \"json\" &lt;//&gt; var  ) $ \\eid -&gt; do\n      xs&lt;-runQuery $ \\conn -&gt; \n        query conn  \"select id,data from envelope where id = ?\" [eid :: Int]\n      json $ head (xs::[Envelope])\n</code></pre>\n\n<p>Done.</p>\n"}], "owner": {"reputation": 354, "user_id": 5466699, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/OLqQc.png?s=128&g=1", "display_name": "Bj&#246;rn Grambow", "link": "https://stackoverflow.com/users/5466699/bj%c3%b6rn-grambow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1165, "favorite_count": 0, "accepted_answer_id": 42424574, "answer_count": 2, "score": 2, "last_activity_date": 1577636156, "creation_date": 1487875403, "last_edit_date": 1577636156, "question_id": 42423736, "link": "https://stackoverflow.com/questions/42423736/postgres-simple-no-instance-for-torow-int-arising-from-a-use-of-query", "title": "postgres-simple - No instance for (ToRow Int) arising from a use of \u2018query\u2019", "body": "<p>I am new to haskell and have honestly hard times with it. But it expands my thinking, so here we go. \nI am trying to run a really simple Webserver that queries a Postgres DB and should return the result as JSON.</p>\n\n<p>The query is absolutely simple:\n\"Select id,data from MYTABLE where id = 1\"</p>\n\n<p>But the type system of haskell is killing me right now and the final type of my actions doesn't match up.\nI am using <a href=\"https://hackage.haskell.org/package/Spock\" rel=\"nofollow noreferrer\">Spock</a> and <a href=\"https://hackage.haskell.org/package/postgresql-simple\" rel=\"nofollow noreferrer\">PostgreSQL-Simple</a> as a Combo.</p>\n\n<p>Most tutorials are either to simple for what I want to do or to difficult. I am somewhere inbetween and miss a lot of Haskell understanding, a lot of my previous problems I have already solved by simple copy and pasting and got a simple version working.</p>\n\n<p>But as soon as I try to pass on a route variable I am failing.\nHere is my working version. My Database Table is here called \"Envelope\", The important call is where it says <code>get \"json\"</code> :</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE FlexibleInstances #-}\n\nmodule Main where\n\nimport Web.Spock\nimport Web.Spock.Config\nimport Database.PostgreSQL.Simple\nimport Data.Pool\nimport Data.Aeson (ToJSON(toJSON), object, (.=),Value)\nimport  Database.PostgreSQL.Simple.FromRow\n\ntype AppAction a = SpockActionCtx () Connection AppSession AppState a\n\ndata AppState = EmptyState\ndata AppSession = EmptySession\n\ndata Envelope = Envelope { envId :: Int, envData :: Value } deriving Show\n\ninstance FromRow Envelope where\n  fromRow = Envelope &lt;$&gt; field &lt;*&gt; field\n\ninstance ToJSON Envelope where\n   toJSON (Envelope envA envB) = object [ \"id\" .= envA, \"data\" .= envB ]\n\nmain :: IO ()\nmain =\n  do pool&lt;-createPool (connect (ConnectInfo \"localhost\" 5432 \"\" \"\" \"envelopes\") ) close 1 10 10\n     spockCfg &lt;- defaultSpockCfg EmptySession (PCPool pool) EmptyState\n     runSpock 8080 (spock spockCfg app)\n\napp :: SpockM Connection AppSession AppState ()\napp = do \n    get root $\n      text \"Hello World!\"\n    get \"json\" $ do\n      xs&lt;-runQuery $ \\conn -&gt; \n        query_ conn  \"select id,data from envelope where id = 1\"\n      json (xs::[Envelope])\n</code></pre>\n\n<p>Then I try to pass on the Envelope ID with a lambda function, for that i also need to change PostgreSQL-Simple <code>query_</code> to <code>query</code>:</p>\n\n<pre><code>    get ( \"json\" &lt;//&gt; var  ) $ \\eid -&gt; do\n      xs&lt;-runQuery $ \\conn -&gt; \n        query conn  \"select id,data from envelope where id = ?\" (eid :: Int)\n      json (xs::[Envelope])\n</code></pre>\n\n<p>The error I get says:</p>\n\n<pre><code> No instance for (ToRow Int) arising from a use of \u2018query\u2019\n   In the expression:\n      query conn \"select id,data from envelope where id = ?\" (eid :: Int)\n    In the second argument of \u2018($)\u2019, namely\n      \u2018\\ conn\n         -&gt; query\n              conn \"select id,data from envelope where id = ?\" (eid :: Int)\u2019\n    In a stmt of a 'do' block:\n      xs &lt;- runQuery\n            $ \\ conn\n                -&gt; query\n                     conn \"select id,data from envelope where id = ?\" (eid :: Int)\n</code></pre>\n\n<p>I also have problem to return just the first item from the query, even without the lambda function.</p>\n\n<p>Full Source can be found on <a href=\"https://bitbucket.org/bjng/envelopes-server\" rel=\"nofollow noreferrer\">bitbucket</a></p>\n\n<p>I hope someone has the time to help me out here.\nThanks for reading already.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1487874923, "post_id": 42423232, "comment_id": 71992700, "body": "It is times like these that I regret having &quot;dupehammer&quot; powers. Possible duplicate of <a href=\"http://stackoverflow.com/questions/33005903/how-do-i-deal-with-many-levels-of-indentation\">How do I deal with many levels of indentation?</a>, but I am unusually uncertain about this; if you think that answers your question, let me know, and I will close this one. Or if other folks agree, free to start a close vote; I&#39;ll act as if I have three votes instead of five, and cast them towards closing."}, {"owner": {"reputation": 9485, "user_id": 20371, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32c7a412ad0caf812ae974df5eb8ffcd?s=128&d=identicon&r=PG", "display_name": "Yawar", "link": "https://stackoverflow.com/users/20371/yawar"}, "edited": false, "score": 5, "creation_date": 1487875154, "post_id": 42423232, "comment_id": 71992823, "body": "You probably want your main operation to have type <code>EitherT Text IO ()</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1487879147, "post_id": 42423232, "comment_id": 71994979, "body": "@DanielWagner What I find really annoying is that if I were to act on your suggestion and dupehammer the question myself, your useful comment <a href=\"http://meta.stackexchange.com/a/195654/242059\">would be automatically deleted</a> =/"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1487884281, "post_id": 42423232, "comment_id": 71997969, "body": "@duplode I can un-delete it if you like :)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1487884734, "post_id": 42423232, "comment_id": 71998233, "body": "@BenjaminHodgson How convenient :) I will accept your offer; thank you."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1487885792, "post_id": 42423232, "comment_id": 71998752, "body": "@vidi If you feel the suggested question doesn&#39;t solve your problem, just ping me and we&#39;ll have a second look at it."}, {"owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1487920984, "post_id": 42423232, "comment_id": 72010530, "body": "@duplode This is my first Haskell project so I try to use the simplest constructions available in order to keep the complexity under control. I preferred using IO (Either Text ()) because it was simpler to reason about. Now I have to read about ExceptT. I&#39;ll try that and be back if I have any questions. Thanks!"}, {"owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1487923603, "post_id": 42423232, "comment_id": 72011670, "body": "@duplode In the meanwhile I&#39;ve just read that &quot;It is almost always wrong to wrap an ExceptT, EitherT, or ErrorT around an IO-based transformer stack.&quot; ( <a href=\"https://www.fpcomplete.com/blog/2016/11/exceptions-best-practices-haskell\" rel=\"nofollow noreferrer\">fpcomplete.com/blog/2016/11/exceptions-best-practices-haskel&zwnj;&#8203;l</a> ) So I should to reconsider the approach"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1487927842, "post_id": 42423232, "comment_id": 72013951, "body": "I suggest you still try rewriting your code with <code>ExceptT IO</code>, even if you eventually switch back to <code>IO (Either ...)</code> or to something else -- if nothing else, it makes for a nice first exercise with monad transformers. By the way, in spite of that strongly-worded quote, the advice in that article is not motivated by some catastrophic flaw with <code>ExceptT IO</code>. The issue is more nuanced than that -- it involves trade-offs between different ways of doing sound exception handling. Also note that the author describes the stance taken as &quot;opinionated&quot;, in the second paragraph."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1487928917, "post_id": 42423232, "comment_id": 72014636, "body": "(By the way, with my comment just above I don&#39;t mean to say that article is wrong. It makes a very reasonable argument, and it is good to keep in mind the potential issues it mentions. It&#39;s just that it won&#39;t be the end of the world if you choose not to follow the advice against <code>Except IO</code> there for the moment.)"}, {"owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1487936641, "post_id": 42423232, "comment_id": 72019603, "body": "@duplode I&#39;ve just updated the question code with the result of my research. I&#39;ll have to read about transformers and ExceptT and maybe I will switch to that later. Other comments are welcome. Thanks!"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1487948168, "post_id": 42423232, "comment_id": 72027215, "body": "(1) Your solution effectively makes the question not a duplicate; that being so, I reopened it so that you can post it as an answer. (2) If you plan on recovering from a <code>RegistrationException</code>, I suggest having a look at the <a href=\"https://www.stackage.org/lts-8.2/package/safe-exceptions-0.1.4.0\" rel=\"nofollow noreferrer\">readme of the <i>safe-exceptions</i> package</a> (expand the first collapsible panel at the linked Stackage page), if you haven&#39;t already done so. It is largely consistent with the point of view of the article you found, and offers more immediately applicable practical suggestions than said article."}], "answers": [{"tags": [], "owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "is_accepted": true, "score": 1, "last_activity_date": 1487952228, "last_edit_date": 1487952228, "creation_date": 1487950351, "answer_id": 42442474, "question_id": 42423232, "link": "https://stackoverflow.com/questions/42423232/how-to-use-fmap-bind-instead-of-case-in-this-code-involving-either-and-io/42442474#42442474", "title": "How to use fmap/bind instead of case in this code involving Either and IO?", "body": "<p>After following the comments and reading a bit about exception handling in Haskell I did the following:</p>\n\n<p>I changed my potentially failing non-<code>IO</code> functions from <code>Either Text a</code> to <code>Either MyException a</code>.</p>\n\n<p>Then I changed the <code>IO</code> functions from <code>IO (Either e a)</code> to simply <code>IO a</code>, since exceptions are present in <code>IO</code> anyway. </p>\n\n<p>Then I also added the <code>raise</code> helper function.</p>\n\n<p>This made the code nice and clean. See below:</p>\n\n<pre><code>raise :: Exception e =&gt; Either e a -&gt; IO a\nraise = either throwIO return\n\ndoConfirmation :: Registration -&gt; IO ()\nfindRegistration :: Text -&gt; DbData -&gt; Either RegistrationException Registration\n\nreadTVarIO\n&gt;&gt;= raise . findRegistration rid\n&gt;&gt;= doConfirmation\n</code></pre>\n\n<p>Probably this can be improved further on but for now I'm happy with the result</p>\n"}], "owner": {"reputation": 1722, "user_id": 1593986, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/8b55a5d33dee71102db716c72e166974?s=128&d=identicon&r=PG", "display_name": "vidi", "link": "https://stackoverflow.com/users/1593986/vidi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "accepted_answer_id": 42442474, "answer_count": 1, "score": 1, "last_activity_date": 1487952228, "creation_date": 1487873653, "last_edit_date": 1487952121, "question_id": 42423232, "link": "https://stackoverflow.com/questions/42423232/how-to-use-fmap-bind-instead-of-case-in-this-code-involving-either-and-io", "title": "How to use fmap/bind instead of case in this code involving Either and IO?", "body": "<p>In the code below the case-expression looks similar to the bind implementation for <code>Either</code>. </p>\n\n<pre><code>doConfirmation :: Registration -&gt; IO (Either Text ())\nfindRegistration :: Text -&gt; DbData -&gt; Either Text Registration\n\ndbData &lt;- readTVarIO db\ncase findRegistration rid dbData of\n  Right r -&gt; doConfirmation r\n  Left err -&gt; return $ Left err\n</code></pre>\n\n<p>How can I write it to take advantage of that and not explicitly <code>return Left</code> in case of errors?</p>\n"}, {"tags": ["list", "haskell", "ghc", "compiler-optimization"], "comments": [{"owner": {"reputation": 15429, "user_id": 308668, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/1760ce981f53c8ccc1ef62493d3805cc?s=128&d=identicon&r=PG&f=1", "display_name": "mike3996", "link": "https://stackoverflow.com/users/308668/mike3996"}, "edited": false, "score": 1, "creation_date": 1487867254, "post_id": 42421157, "comment_id": 71987767, "body": "Good q. Just wanted to link this in here. <a href=\"http://stackoverflow.com/questions/40145318\">stackoverflow.com/questions/40145318</a>"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 1, "creation_date": 1487867536, "post_id": 42421157, "comment_id": 71987979, "body": "Haskell won&#39;t infer anything unless the developers of the language program it to make the inference. There is no free lunch. Obviously you <i>could</i> design the language so that certain lists are automatically marked as being increasing, but that would increase the complexity of what is already a pretty complicated language."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1487867675, "post_id": 42421157, "comment_id": 71988082, "body": "@JohnColeman That&#39;s fair, it just seems like a logical jump to me in managing infinite lists. I assumed the designers/developers of Haskell are much more proficient in language design/abstract mathematics and there was a good theoretical reason as to why this hasn&#39;t been done rather than a pragmatic one."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 4, "creation_date": 1487867983, "post_id": 42421157, "comment_id": 71988283, "body": "List comprehensions work uniformly for all types of lists and do not take into account any further structure (i.e. the fact that <code>[1..]</code> has type <code>Enum t, Num t =&gt; [t]</code> instead of just <code>[t]</code>). Secondly the predicate <code>x &lt;= 4</code> is opaque to the filtering mechanism and is just a function <code>t -&gt; Bool</code> so no information about its behaviour is available as the list elements increase."}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 1, "creation_date": 1487869233, "post_id": 42421157, "comment_id": 71989248, "body": "As others mentioned, once a list is created, the information about <i>how</i> it was created is lost. You need to preserve it somehow; the typical way is to create your own type that preserves the ordering information. Make your type conform to the <code>List</code> typeclass, and you could use it everywhere where a normal <code>Ord a =&gt; List a</code> fits."}], "answers": [{"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 6, "last_activity_date": 1487871445, "last_edit_date": 1487871445, "creation_date": 1487868112, "answer_id": 42421532, "question_id": 42421157, "link": "https://stackoverflow.com/questions/42421157/why-cant-ghc-reason-about-some-infinite-lists/42421532#42421532", "title": "Why can&#39;t GHC reason about some infinite lists?", "body": "<blockquote>\n  <p>So why can't it reason about this infinite list to turn <code>[x | x &lt;- list1, x &lt;= 4]</code> into <code>takeWhile (&lt;= 4) list1</code> automatically?</p>\n</blockquote>\n\n<p>The answer isn't any more specific than \"It doesn't use <code>takeWhile</code> because it doesn't use <code>takeWhile</code>\". <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-420003.11\" rel=\"nofollow noreferrer\">The spec says</a>:</p>\n\n<blockquote>\n  <p><strong>Translation</strong>: List comprehensions satisfy these identities, which may\n  be used as a translation into the kernel:</p>\n\n<pre><code>[ e | True ]         = [ e ]\n[ e | q ]            = [ e | q, True ]\n[ e | b, Q ]         = if b then [ e | Q ] else []\n[ e | p &lt;- l, Q ]    = let ok p = [ e | Q ]\n                           ok _ = []\n                       in concatMap ok l\n[ e | let decls, Q ] = let decls in [ e | Q ]\n</code></pre>\n</blockquote>\n\n<p>That is, the meaning of a list comprehension is given by translation into a simpler language with <code>if</code>-expressions, <code>let</code>-bindings, and calls to <code>concatMap</code>. We can figure out the meaning of your example by translating it through the following steps:</p>\n\n<pre><code>[x | x &lt;- [1..], x &lt;= 4]\n\n-- apply rule 4 --\nlet ok x = [ x | x &lt;= 4 ]\n    ok _ = []\nin concatMap ok [1..]\n\n-- eliminate unreachable clause in ok --\nlet ok x = [ x | x &lt;= 4 ]\nin concatMap ok [1..]\n\n-- apply rule 2 --\nlet ok x = [ x | x &lt;= 4, True ]\nin concatMap ok [1..]\n\n-- apply rule 3 --\nlet ok x = if x &lt;= 4 then [ x | True ] else []\nin concatMap ok [1..]\n\n-- apply rule 1 --\nlet ok x = if x &lt;= 4 then [ x ] else []\nin concatMap ok [1..]\n\n-- inline ok --\nconcatMap (\\x -&gt; if x &lt;= 4 then [ x ] else []) [1..]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 9, "last_activity_date": 1487898791, "last_edit_date": 1487898791, "creation_date": 1487868275, "answer_id": 42421584, "question_id": 42421157, "link": "https://stackoverflow.com/questions/42421157/why-cant-ghc-reason-about-some-infinite-lists/42421584#42421584", "title": "Why can&#39;t GHC reason about some infinite lists?", "body": "<p>Theoretically, one could imagine a rewrite rule such as</p>\n\n<pre><code>{-# RULES\n  \"filterEnumFrom\" forall (n :: Int) (m :: Int).\n                     filter (&lt; n) (enumFrom m) = [m..(n-1)]\n  #-}\n</code></pre>\n\n<p>And that automatically would convert expressions such as <code>filter (&lt; 4) (enumFrom 1)</code> to <code>[1..3]</code>. So it is <em>possible</em>. There is a glaring problem though: any variation from this <em>exact</em> syntactical pattern won't work. The result is that you end up defining a <em>bunch</em> of rules and you can longer ever be sure if they are triggering or not. If you can't rely on the rules, you eventually just don't use them. (Also, note I've specialized the rule to <code>Int</code>s - as was briefly posted as a comment, this may break down in subtle ways for other types.)</p>\n\n<p>At the end of the day, to perform more advanced analysis, GHC would have to have some tracking information attached to lists to say how they were generated. That would either make lists less lightweight of an abstraction  or mean that GHC would have some special machinery in it <em>just</em> for optimizing lists at compile time. Neither of these options is nice.</p>\n\n<p>That said, you can always add your <em>own</em> tracking information by making a list type on <em>top</em> of lists.</p>\n\n<pre><code>data List a where\n  EnumFromTo :: Enum a =&gt; a -&gt; Maybe a -&gt; List a\n  Filter :: (a -&gt; Bool) -&gt; List a -&gt; List a \n  Unstructured :: [a] -&gt; List a\n</code></pre>\n\n<p>This <em>may</em> end up being easier to optimize.</p>\n"}], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 42421584, "answer_count": 2, "score": 3, "last_activity_date": 1487899217, "creation_date": 1487867080, "last_edit_date": 1495539976, "question_id": 42421157, "link": "https://stackoverflow.com/questions/42421157/why-cant-ghc-reason-about-some-infinite-lists", "title": "Why can&#39;t GHC reason about some infinite lists?", "body": "<p><a href=\"https://stackoverflow.com/questions/42417446/haskell-list-frozen\">This recent question</a> got me thinking about Haskell's ability to work with infinite lists. There are <a href=\"https://stackoverflow.com/questions/7371730/how-to-tell-if-a-list-is-infinite?rq=1\">plenty</a> <a href=\"https://stackoverflow.com/questions/9889347/can-you-recognize-an-infinite-list-in-a-haskell-program?noredirect=1&amp;lq=1\">of</a> <a href=\"https://stackoverflow.com/questions/10936633/filtering-an-infinite-list-in-haskell?rq=1\">other</a> questions and answers about infinite lists on StackOverflow, and I understand why we can't have a general solution for all infinite lists, but why can't Haskell reason about <em>some</em> infinite lists?</p>\n\n<p>Let's use the example from the first linked question:</p>\n\n<pre><code>list1 = [1..]\nlist2 = [x | x &lt;- list1, x &lt;= 4]\nprint list2\n$ [1,2,3,4\n</code></pre>\n\n<p>@user2297560 writes in the comments: </p>\n\n<blockquote>\n  <p>Pretend you're GHCI. Your user gives you an infinite list and asks you to find all the values in that list that are less than or equal to 4. How would you go about doing it? (Keep in mind that you don't know that the list is in order.)</p>\n</blockquote>\n\n<p>In this case, the <em>user</em> didn't give you an infinite list. GHC generated it! In fact, it generated it following it's own rules. The <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch6.html#x13-1310006.3.4\" rel=\"nofollow noreferrer\">Haskell 2010 Standard</a> states the following:</p>\n\n<pre><code>enumFrom       :: a -&gt; [a]            -- [n..]  \n</code></pre>\n\n<blockquote>\n  <p>For the types Int and Integer, the enumeration functions have the following meaning:</p>\n  \n  <ul>\n  <li>The sequence enumFrom <code>e1</code> is the list [<code>e1</code>,<code>e1</code> + 1,<code>e1</code> + 2,\u2026].</li>\n  </ul>\n</blockquote>\n\n<p>In his answer to the other question, @chepner writes:</p>\n\n<blockquote>\n  <p>You know that the list is monotonically increasing, but Haskell does not. </p>\n</blockquote>\n\n<p>The statements these users made don't seem to line up with the standard to me. Haskell created the list in an ordered fashion using a monotonic increase. Haskell <strong>should</strong> know that the list is both ordered and monotonic. So why can't it reason about this infinite list to turn <code>[x | x &lt;- list1, x &lt;= 4]</code> into <code>takeWhile (&lt;= 4) list1</code> automatically?</p>\n"}, {"tags": ["haskell", "parsec"], "comments": [{"owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1487868265, "post_id": 42421096, "comment_id": 71988498, "body": "Did you mean <code>a = char &#39;a&#39;</code>?  If so, isn&#39;t this just <code>many a</code>?"}, {"owner": {"reputation": 4734, "user_id": 736508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2b30f4fcb5b2b34a8468a8d378cab9d1?s=128&d=identicon&r=PG", "display_name": "Gal", "link": "https://stackoverflow.com/users/736508/gal"}, "reply_to_user": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "edited": false, "score": 0, "creation_date": 1487869103, "post_id": 42421096, "comment_id": 71989144, "body": "Well I feel like a moron :| For some reason I thought that <code>many</code> must parse until <code>eof</code>. Thanks! (And yes, I did many <code>let a = char &#39;a&#39;</code>.) If you answer, I&#39;ll accept it."}], "answers": [{"tags": [], "owner": {"reputation": 12213, "user_id": 671703, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/96ac349a9c65277e304401ea92a62ff4?s=128&d=identicon&r=PG", "display_name": "pat", "link": "https://stackoverflow.com/users/671703/pat"}, "is_accepted": true, "score": 2, "last_activity_date": 1487870675, "creation_date": 1487870675, "answer_id": 42422395, "question_id": 42421096, "link": "https://stackoverflow.com/questions/42421096/haskell-parsec-primitive-for-greedy-many/42422395#42422395", "title": "Haskell Parsec: primitive for greedy many?", "body": "<p>You want to use <code>many a</code>, which will parse as many <code>a</code>'s as it can.</p>\n"}], "owner": {"reputation": 4734, "user_id": 736508, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2b30f4fcb5b2b34a8468a8d378cab9d1?s=128&d=identicon&r=PG", "display_name": "Gal", "link": "https://stackoverflow.com/users/736508/gal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 42422395, "answer_count": 1, "score": 1, "last_activity_date": 1487870675, "creation_date": 1487866930, "last_edit_date": 1487868862, "question_id": 42421096, "link": "https://stackoverflow.com/questions/42421096/haskell-parsec-primitive-for-greedy-many", "title": "Haskell Parsec: primitive for greedy many?", "body": "<p>I'm only just starting to learn the Parsec library, and I was wondering if there is any primitive in the library that can do the following: given a parser <code>let a = char 'a'</code>, and a string <code>aaab</code>, would return <code>Right ['a', 'a', 'a']</code>, with <code>\"b\"</code> remaining, i.e., would parse as much as it can, but no more. I feel this is so necessary that it has to exist in some form or another in the library.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1487862507, "post_id": 42419341, "comment_id": 71984203, "body": "<code>type</code> is a reserved work, I don&#39;t think there is any way to use it. I think standard procedure would be to add an underscore (like <code>_type</code> or <code>type_</code>), or choose a different name."}, {"owner": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1487862818, "post_id": 42419341, "comment_id": 71984453, "body": "why not <code>type&#39;</code> ?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1487862820, "post_id": 42419341, "comment_id": 71984457, "body": "Yes, <code>_type</code> is what I&#39;m currently doing."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 2691, "user_id": 5477287, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/yKMgF.jpg?s=128&g=1", "display_name": "Babra Cunningham", "link": "https://stackoverflow.com/users/5477287/babra-cunningham"}, "edited": false, "score": 0, "creation_date": 1487862897, "post_id": 42419341, "comment_id": 71984507, "body": "@BabraCunningham What is it supposed to do ?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 1, "creation_date": 1487863041, "post_id": 42419341, "comment_id": 71984615, "body": "Thank you for the edit @Lee. Using Google Translate to translate the French &quot;r&#233;serv&#233;&quot;,  I understood that the meaning of &quot;reserved&quot; is &quot;shy&quot; only ^^"}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1487863360, "post_id": 42419341, "comment_id": 71984841, "body": "@St&#233;phaneLaurent The apostrophe character is valid in identifiers, so adding it would function the same as using an underscore. It&#39;s largely personal preference - most people I think have a convention for when they choose to use underscores and apostrophes."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1487864289, "post_id": 42419341, "comment_id": 71985550, "body": "I realize this is more of a question in an of itself, but does Haskell have an established convention for this?  (Python, for example, tends to use <code>keyword_</code> as the name of a variable that conflicts with <code>keyword</code>.)"}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1487864767, "post_id": 42419341, "comment_id": 71985932, "body": "@chepner The most prominent example I&#39;m familiar with is probably <code>blaze-html</code> which chooses an underscore suffix in the cases when HTML attributes correspond to reserved words. I would be interested if anybody knows of other popular libraries that make the same or contradicting choices."}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1487862793, "post_id": 42419468, "comment_id": 71984426, "body": "I&#39;m not the one who downvoted, but do you mean it&#39;s not possible ?"}, {"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1487862960, "post_id": 42419468, "comment_id": 71984557, "body": "I believe that is not possible to use keywords as record fields. But it should be possible to use <code>_type</code> or some other variants."}], "tags": [], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "is_accepted": true, "score": 4, "last_activity_date": 1487863168, "last_edit_date": 1487863168, "creation_date": 1487862503, "answer_id": 42419468, "question_id": 42419341, "link": "https://stackoverflow.com/questions/42419341/how-to-use-name-type-for-a-key-field/42419468#42419468", "title": "How to use name &quot;type&quot; for a key field?", "body": "<p>Note that <code>type</code> is a keyword in Haskell used to define type synonyms. Look: <a href=\"https://wiki.haskell.org/Keywords#type\" rel=\"noreferrer\">type is a keyword</a>.</p>\n\n<p>Also tested this on ghc-8.0.1, and it worked.</p>\n\n<pre><code>    data DirTree = DirTree {\n            name     :: FilePath,\n            _type    :: Text,\n            children :: Maybe [DirTree]\n          }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1201, "user_id": 7506861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa43944dd74a96c82dfd990626da2d5?s=128&d=identicon&r=PG&f=1", "display_name": "Emily", "link": "https://stackoverflow.com/users/7506861/emily"}, "is_accepted": false, "score": 0, "last_activity_date": 1487863086, "creation_date": 1487863086, "answer_id": 42419668, "question_id": 42419341, "link": "https://stackoverflow.com/questions/42419341/how-to-use-name-type-for-a-key-field/42419668#42419668", "title": "How to use name &quot;type&quot; for a key field?", "body": "<p>As you have gathered, you can't use a reserved word as an identifier.</p>\n\n<hr>\n\n<p>What I like to do is prefix my names in record syntax with the type name, such as this:</p>\n\n<pre><code>data DirTree = DirTree { dirTreeName     :: FilePath,\n                         dirTreeType     :: Text,\n                         dirTreeChildren :: Maybe [DirTree] }\n</code></pre>\n\n<p>This also prevents potential name clashes with other functions with common names.</p>\n\n<p>Alternatively, as it's pointed out in the comments, you could add a symbol like <code>_</code> or <code>'</code> to your name to distinguish it from the keyword.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 42419468, "answer_count": 2, "score": 3, "last_activity_date": 1487863168, "creation_date": 1487862184, "last_edit_date": 1487862538, "question_id": 42419341, "link": "https://stackoverflow.com/questions/42419341/how-to-use-name-type-for-a-key-field", "title": "How to use name &quot;type&quot; for a key field?", "body": "<p>I would like to use this data type in Haskell:</p>\n\n<pre><code>data DirTree = DirTree {\n                name     :: FilePath,\n                type    :: Text,\n                children :: Maybe [DirTree]\n              }\n</code></pre>\n\n<p>But the name <code>type</code> is not accepted by Haskell, because it is a reserved keyword. </p>\n\n<p>Is there a way to use it ? Since <code>type</code> is not an object exported from a package, I can't solve this issue by doing <code>import ... hiding (type)</code>.</p>\n"}]