[{"tags": ["haskell", "queue", "dependent-type", "gadt"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460595571, "post_id": 36611533, "comment_id": 60820885, "body": "I don&#39;t think I understand this queue type - what would the types of <code>exec</code> and <code>rotate</code> be with the vector implementation?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1460595633, "post_id": 36611533, "comment_id": 60820898, "body": "What does <code>forall x . { ... ; schedule :: Vec sl x }</code> give you? It seems to me <code>schedule</code> is essentially a natural number, because the only thing you know about it is its length, since its contents is existentially quantified. So the type of <code>schedule</code> probably should be <code>Sing sl</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 2, "creation_date": 1460595795, "post_id": 36611533, "comment_id": 60820939, "body": "@user3237465, <code>schedule</code> is indeed representing a natural number (and I introduced <code>x</code> specifically to make sure it&#39;s used <i>only</i> as a natural number), but it&#39;s actually a portion of the front list, so pattern matching on it drives incremental calculation of that list."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460596132, "post_id": 36611533, "comment_id": 60821008, "body": "@user2407038, the type of <code>exec</code> could be expressed in various ways, depending on what works best, but one valid expression, I believe, is <code>Vec (sl1 :+ rl) a -&gt; Vec rl a -&gt; Vec (&#39;S sl1) a -&gt; Queue a</code>"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1477500171, "post_id": 36611533, "comment_id": 67795835, "body": "So did you get things working? BTW, you should probably accept <a href=\"http://stackoverflow.com/a/40252235/3237465\">the Alec&#39;s answer</a> as it&#39;s clearly more informative."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1460599671, "post_id": 36612493, "comment_id": 60822062, "body": "Wowzers. That <code>grotate</code> bit is going to take some thinking, since I have very little experience with this sort of programming. Is <code>subst</code> some sort of operation for pushing equalities into expressions? The restriction on <code>r</code> could be annoying, and that was my fault for a bad comment. Sorry about that. I doubt it would be horrible, but probably annoying."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1460600437, "post_id": 36612493, "comment_id": 60822283, "body": "@dfeuer, yes, <code>subst</code> rewrites the type of a term by an equation. In your comment it&#39;s a <code>schedule</code> must be non-empty (a typo?), while in mine it&#39;s a <code>rear</code>. That&#39;s just what other types enforced me to do. BTW, <a href=\"https://gist.github.com/gallais/7bcb261f97dd395aa9d2\" rel=\"nofollow noreferrer\">here</a> is an example of how <code>foldl</code> can be translated to Haskell, you&#39;ll probably need to do a similar thing to translate <code>grotate</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478047515, "post_id": 36612493, "comment_id": 67995057, "body": "I&#39;m sorry for failing to award the bounty! I had no cell service for two days."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1478065998, "post_id": 36612493, "comment_id": 67999495, "body": "@dfeuer, no worries, the other answer deserves it better (even though it got only half of it)."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 7, "last_activity_date": 1460639705, "last_edit_date": 1495542798, "creation_date": 1460598826, "answer_id": 36612493, "question_id": 36611533, "link": "https://stackoverflow.com/questions/36611533/total-real-time-persistent-queues/36612493#36612493", "title": "Total real-time persistent queues", "body": "<p>Here is what I got:</p>\n\n<pre><code>open import Function\nopen import Data.Nat.Base\nopen import Data.Vec\n\ngrotate : \u2200 {n m} {A : Set}\n        -&gt; (B : \u2115 -&gt; Set)\n        -&gt; (\u2200 {n} -&gt; A -&gt; B n -&gt; B (suc n))\n        -&gt; Vec A n\n        -&gt; Vec A (suc n + m)\n        -&gt; B m\n        -&gt; B (suc n + m)\ngrotate B cons  []      (y \u2237 ys) a = cons y a\ngrotate B cons (x \u2237 xs) (y \u2237 ys) a = grotate (B \u2218 suc) cons xs ys (cons y a)\n\nrotate : \u2200 {n m} {A : Set} -&gt; Vec A n -&gt; Vec A (suc n + m) -&gt; Vec A m -&gt; Vec A (suc n + m)\nrotate = grotate (Vec _) _\u2237_\n\nrecord Queue (A : Set) : Set\u2081 where\n  constructor queue\n  field\n    {X}      : Set\n    {n m}    : \u2115\n    front    : Vec A (n + m)\n    rear     : Vec A m\n    schedule : Vec X n\n\nopen import Relation.Binary.PropositionalEquality\nopen import Data.Nat.Properties.Simple\n\nexec : \u2200 {m n A} -&gt; Vec A (n + m) -&gt; Vec A (suc m) -&gt; Vec A n -&gt; Queue A\nexec {m} {suc n} f r (_ \u2237 s) = queue (subst (Vec _) (sym (+-suc n m)) f) r s\nexec {m}         f r  []     = queue (with-zero f') [] f' where\n with-zero    = subst (Vec _ \u2218 suc) (sym (+-right-identity m))\n without-zero = subst (Vec _ \u2218 suc) (+-right-identity m)\n\n f' = without-zero (rotate f (with-zero r) [])\n</code></pre>\n\n<p><code>rotate</code> is defined in terms of <code>grotate</code> for the same reason <a href=\"https://github.com/agda/agda-stdlib/blob/master/src/Data/Vec.agda#L150\" rel=\"nofollow noreferrer\"><code>reverse</code> is defined in terms of <code>foldl</code></a> (or <a href=\"https://stackoverflow.com/questions/33345899/how-to-enumerate-the-elements-of-a-list-by-fins-in-linear-time\"><code>enumerate</code> in terms of <code>genumerate</code></a>): because <code>Vec A (suc n + m)</code> is not definitionally <code>Vec A (n + suc m)</code>, while <code>(B \u2218 suc) m</code> is definitionally <code>B (suc m)</code>.</p>\n\n<p><code>exec</code> has the same implementation as you provided (modulo those <code>subst</code>s), but I'm not sure about the types: is it OK that <code>r</code> must be non-empty?</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1477786701, "post_id": 40252235, "comment_id": 67905325, "body": "This is very helpful indeed. I worked out the Agda <code>foldl</code> translation myself, but hadn&#39;t yet attempted this one. Note that <code>\\a -&gt; Bump . cons a . lower = (Bump .) . (. lower) . cons = ((Bump .) . (. lower)) #. cons</code>, which should be a free coercion. That leaves just <code>plusZero</code> and <code>plusSucc</code> to be optimized with unsafe coercions."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 3, "last_activity_date": 1477445895, "last_edit_date": 1495541208, "creation_date": 1477444863, "answer_id": 40252235, "question_id": 36611533, "link": "https://stackoverflow.com/questions/36611533/total-real-time-persistent-queues/40252235#40252235", "title": "Total real-time persistent queues", "body": "<p>The <a href=\"https://stackoverflow.com/a/36612493/3072788\">other answer</a> is super clever (please take a moment to upvote it), but as someone not familiar with Agda, how this would be implemented in Haskell was not obvious to me. Here's a full Haskell version. We'll need a whole slew of extensions, as well as <code>Data.Type.Equality</code> (since we will need to do some limited amount of type-proofs).</p>\n\n<pre><code>{-# LANGUAGE GADTs, ScopedTypeVariables,RankNTypes,\n             TypeInType, TypeFamilies, TypeOperators #-}\n\nimport Data.Type.Equality\n</code></pre>\n\n<h3>Defining <code>Nat</code>, <code>Vec</code>, and <code>Queue</code></h3>\n\n<p>Next, we define the usual type-level natural numbers (this looks like just a regular <code>data</code> definition, but because we have <code>TypeInType</code> enabled, it will get automatically promoted when we use it in a type) and a type function (a <code>type family</code>) for addition. Note that although there are multiple ways of defining <code>+</code>, our choice here will impact what follows. We'll also define the usual <code>Vec</code> which is very much like a list except that it encodes its length in the phantom type <code>n</code>. With that, we can go ahead and define the type of our queue.</p>\n\n<pre><code>data Nat = Z | S Nat\n\ntype family n + m where\n    Z   + m = m\n    S n + m = S (n + m)\n\ndata Vec a n where\n    Nil   :: Vec a Z\n    (:::) :: a -&gt; Vec a n -&gt; Vec a (S n)\n\ndata Queue a where\n    Queue :: { front :: Vec a (n + m)\n             , rear :: Vec a m\n             , schedule :: Vec x n } -&gt; Queue a\n</code></pre>\n\n<h3>Defining <code>rotate</code></h3>\n\n<p>Now, things start to get hairier. We want to define a function <code>rotate</code> that has type <code>rotate :: Vec a n -&gt; Vec a (S n + m) -&gt; Vec a m -&gt; Vec a (S n + m)</code>, but you quickly run into a variety of proof related problems with just defining this recursively. The solution is instead to define a slightly more general <code>grotate</code>, which <em>can</em> be defined recursively, and for which <code>rotate</code> is a special case.</p>\n\n<p>The point of <code>Bump</code> is to circumvent the fact that there is no such thing as type level composition in Haskell. There is no way of writing things an operator like <code>(\u2218)</code> such that <code>(S \u2218 S) x</code> is <code>S (S x)</code>. The workaround is to continuously wrap/unwrap with <code>Bump</code>/<code>lower</code>.</p>\n\n<pre><code>newtype Bump p n = Bump { lower :: p (S n) }\n\ngrotate :: forall p n m a.\n           (forall n. a -&gt; p n -&gt; p (S n)) -&gt;\n           Vec a n -&gt;\n           Vec a (S n + m) -&gt;\n           p m -&gt;\n           p (S n + m)\ngrotate cons Nil        (y ::: _)  zs = cons y zs\ngrotate cons (x ::: xs) (y ::: ys) zs = lower (grotate consS xs ys (Bump (cons y zs))) \n  where\n    consS :: forall n. a -&gt; Bump p n -&gt; Bump p (S n)\n    consS = \\a -&gt; Bump . cons a . lower \n\nrotate :: Vec a n -&gt; Vec a (S n + m) -&gt; Vec a m -&gt; Vec a (S n + m)\nrotate = grotate (:::)\n</code></pre>\n\n<p>We need explicit <code>forall</code>s here to make it very clear which type variables are getting captured and which aren't, as well as to denote higher-rank types.</p>\n\n<h3>Singleton natural numbers <code>SNat</code></h3>\n\n<p>Before we proceed to <code>exec</code>, we set up some machinery that will allow us to prove some type-level arithmetic claims (which we need to get <code>exec</code> to typecheck). We start by making an <code>SNat</code> type (which is a singleton type corresponding to <code>Nat</code>). <code>SNat</code> reflects its value in a phantom type variable.</p>\n\n<pre><code>data SNat n where\n  SZero :: SNat Z\n  SSucc :: SNat n -&gt; SNat (S n)\n</code></pre>\n\n<p>We can then make a couple useful functions to do things with <code>SNat</code>.</p>\n\n<pre><code>sub1 :: SNat (S n) -&gt; SNat n\nsub1 (SSucc x) = x\n\nsize :: Vec a n -&gt; SNat n\nsize Nil = SZero\nsize (_ ::: xs) = SSucc (size xs)\n</code></pre>\n\n<p>Finally, we are prepared to prove some arithmetic, namely that <code>n + S m ~ S (n + m)</code> and <code>n + Z ~ n</code>. </p>\n\n<pre><code>plusSucc :: (SNat n) -&gt; (SNat m) -&gt; (n + S m) :~: S (n + m)\nplusSucc SZero _ = Refl\nplusSucc (SSucc n) m = gcastWith (plusSucc n m) Refl\n\nplusZero :: SNat n -&gt; (n + Z) :~: n\nplusZero SZero = Refl\nplusZero (SSucc n) = gcastWith (plusZero n) Refl \n</code></pre>\n\n<h1>Defining <code>exec</code></h1>\n\n<p>Now that we have <code>rotate</code>, we can define <code>exec</code>. This definition looks almost identical to the one in the question (with lists), except annotated with <code>gcastWith &lt;some-proof&gt;</code>.</p>\n\n<pre><code>exec :: Vec a (n + m) -&gt; Vec a (S m) -&gt; Vec a n -&gt; Queue a\nexec f r (_ ::: s) = gcastWith (plusSucc (size s) (sub1 (size r))) $ Queue f r s\nexec f r Nil       = gcastWith (plusZero (sub1 (size r))) $\n  let f' = rotate f r Nil in (Queue f' Nil f')\n</code></pre>\n\n<hr>\n\n<p>It is probably worth noting that we can get some stuff for free by using <a href=\"https://github.com/goldfirere/singletons\" rel=\"nofollow noreferrer\"><code>singletons</code></a>. With the right extensions enabled, the following more readable code</p>\n\n<pre><code>import Data.Singletons.TH \n\nsingletons [d|\n    data Nat = Z | S Nat\n\n    (+) :: Nat -&gt; Nat -&gt; Nat\n    Z   + n = n\n    S m + n = S (m + n)\n  |]\n</code></pre>\n\n<p>defines, <code>Nat</code>, the type family <code>:+</code> (equivalent to my <code>+</code>), and the singleton type <code>SNat</code> (with constructors <code>SZ</code> and <code>SS</code> equivalent to my <code>SZero</code> and <code>SSucc</code>) all in one.</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 3, "accepted_answer_id": 36612493, "answer_count": 2, "score": 15, "last_activity_date": 1477445895, "creation_date": 1460591737, "last_edit_date": 1461704286, "question_id": 36611533, "link": "https://stackoverflow.com/questions/36611533/total-real-time-persistent-queues", "title": "Total real-time persistent queues", "body": "<p>Okasaki describes persistent real-time queues which can be realized in Haskell using the type</p>\n\n<pre><code>data Queue a = forall x . Queue\n  { front :: [a]\n  , rear :: [a]\n  , schedule :: [x]\n  }\n</code></pre>\n\n<p>where incremental rotations maintain the invariant</p>\n\n<pre><code>length schedule = length front - length rear\n</code></pre>\n\n<h3>More details</h3>\n\n<p>If you're familiar with the queues involved, you can skip this section.</p>\n\n<p>The rotation function looks like</p>\n\n<pre><code>rotate :: [a] -&gt; [a] -&gt; [a] -&gt; [a]\nrotate [] (y : _) a = y : a\nrotate (x : xs) (y : ys) a =\n  x : rotate xs ys (y : a)\n</code></pre>\n\n<p>and it's called by a smart constructor</p>\n\n<pre><code>exec :: [a] -&gt; [a] -&gt; [x] -&gt; Queue a\nexec f r (_ : s) = Queue f r s\nexec f r [] = Queue f' [] f' where\n  f' = rotate f r []\n</code></pre>\n\n<p>after each queue operation. The smart constructor is always called when <code>length s = length f - length r + 1</code>, ensuring that the pattern match in <code>rotate</code> will succeed.</p>\n\n<h3>The problem</h3>\n\n<p>I hate partial functions! I'd love to find a way to express the structural invariant in the types. The usual dependent vector seems a likely choice:</p>\n\n<pre><code>data Nat = Z | S Nat\n\ndata Vec n a where\n  Nil :: Vec 'Z a\n  Cons :: a -&gt; Vec n a -&gt; Vec ('S n) a\n</code></pre>\n\n<p>and then (perhaps)</p>\n\n<pre><code>data Queue a = forall x rl sl . Queue\n  { front :: Vec (sl :+ rl) a\n  , rear :: Vec rl a\n  , schedule :: Vec sl x\n  }\n</code></pre>\n\n<p>The trouble is that I haven't been able to figure out how to juggle the types. It seems extremely likely that <em>some</em> amount of <code>unsafeCoerce</code> will be needed to make this efficient. However, I haven't been able to come up with an approach that's even vaguely manageable. Is it possible to do this nicely in Haskell?</p>\n"}, {"tags": ["haskell", "recursion", "iteration"], "answers": [{"tags": [], "owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "is_accepted": true, "score": 2, "last_activity_date": 1460591366, "last_edit_date": 1460591366, "creation_date": 1460590275, "answer_id": 36611320, "question_id": 36611056, "link": "https://stackoverflow.com/questions/36611056/haskell-recursive-call-many-arguments/36611320#36611320", "title": "Haskell, recursive call, many arguments", "body": "<p>I think what you want is this:</p>\n\n<pre><code>f1 k a b c t = (iterate (f0 a b c) t) !! k\n</code></pre>\n\n<p>However, type is a keyword in Haskell, so be careful with using it as a variable name.</p>\n\n<p>Also, in case you are curious as to how <code>iterate</code> works, here is an implementation:</p>\n\n<pre><code>iterate :: (a -&gt; a) -&gt; a -&gt; [a]\niterate f x = x : iterate f (f x)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5525481, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f03ae342914dcc7d1ed0ccbf4b00ace?s=128&d=identicon&r=PG&f=1", "display_name": "NorwegianViking", "link": "https://stackoverflow.com/users/5525481/norwegianviking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 36611320, "answer_count": 1, "score": 0, "last_activity_date": 1460591366, "creation_date": 1460588584, "last_edit_date": 1460589193, "question_id": 36611056, "link": "https://stackoverflow.com/questions/36611056/haskell-recursive-call-many-arguments", "title": "Haskell, recursive call, many arguments", "body": "<p>I am having some trouble implementing a function that is supposed to call itself multiple times. Each time it updates it's values and improves it's accuracy. In the process it calls on other functions, but I know it works up 'till: </p>\n\n<pre><code>Type = [Double] \n*All lists; including type: Same, but not predetermined length. \n\n\nf0 :: Double -&gt; [[Double]] -&gt; [Double] -&gt; Type -&gt; Type  \n</code></pre>\n\n<p>Typical example of function call: </p>\n\n<pre><code>f0 1.0 [[1.0, 0.5, 1.0], [1.0, -1.0, 1.0]] [1.0, 0.0] (initTypeLength 2)\n</code></pre>\n\n<p>What I want to do: </p>\n\n<pre><code>f1 :: Int -&gt; Double -&gt; [[Double]] -&gt; [Double] -&gt; Type -&gt; Type  \n</code></pre>\n\n<p>... where \"Int\" (i) calls for number of iterations, using f0 recursively, keeping all parameters the same except the type, which is updated. </p>\n\n<p>Unsure if f0 is relevant, but in case: </p>\n\n<pre><code>f0 a (x:xs) (y:ys) type = f_other a xs ys\n                         $ f_yet_another a x y type \n</code></pre>\n\n<p>What confuses me is where and how the arguments are to be stated. </p>\n\n<p>So to sum up: Everything here is static, except the one list; \"Type\", which is updated every iteration. How do I call this? Im getting the feeling that it's obvious, but I just can't seem to figure it out in a way that haskell understands. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1460587594, "post_id": 36610763, "comment_id": 60818517, "body": "\u201cperhaps I need to consider something other than type-classes\u201d \u2014 indeed. It looks a lot like you try to (ab)use type classes as OO classes here. Don&#39;t do that; the proper way (if there is any) to translate OO classes to Haskell is as plain data records with functions (\u224c methods) as fields. Inheritance is simply a matter of updating those fields."}, {"owner": {"reputation": 372, "user_id": 2722784, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17935d19c83cba797a7c8e1470dc20bb?s=128&d=identicon&r=PG", "display_name": "Feenaboccles", "link": "https://stackoverflow.com/users/2722784/feenaboccles"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460618576, "post_id": 36610763, "comment_id": 60829016, "body": "I&#39;m thinking more about OCaml&#39;s module system (mod-signature + type+ mod-implementation) than OOP here. I&#39;m just curious can I: (a) make the monadic functions as short as possible by defining business logic in pure code and (b) wholly isolate the monadic code from changes in the underlying data-representation."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1460633618, "post_id": 36610763, "comment_id": 60839465, "body": "I think this is an <a href=\"http://meta.stackexchange.com/a/66378/312922\">XY problem</a>. Give us the context - what you&#39;re actually trying to achieve - and we&#39;ll be able to offer a better solution."}, {"owner": {"reputation": 372, "user_id": 2722784, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17935d19c83cba797a7c8e1470dc20bb?s=128&d=identicon&r=PG", "display_name": "Feenaboccles", "link": "https://stackoverflow.com/users/2722784/feenaboccles"}, "edited": false, "score": 0, "creation_date": 1460636876, "post_id": 36610763, "comment_id": 60841976, "body": "I&#39;ve provided the concrete code in the edit to the main question (initially I tried doing this in comments, but it was unreadable so I deleted them)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460649037, "post_id": 36610763, "comment_id": 60852125, "body": "will there ever be more than one thing that is an instance of <code>HasLevel</code>? - or simply: why don&#39;t you just use a <code>Level</code> type/structure? (Obviously same question for the <code>HasPlayer</code>/ <code>Player</code>)"}, {"owner": {"reputation": 372, "user_id": 2722784, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17935d19c83cba797a7c8e1470dc20bb?s=128&d=identicon&r=PG", "display_name": "Feenaboccles", "link": "https://stackoverflow.com/users/2722784/feenaboccles"}, "edited": false, "score": 0, "creation_date": 1460651285, "post_id": 36610763, "comment_id": 60853533, "body": "In the same way that <code>goto</code> uses <code>HasPlayer</code> but not, say, <code>HasInventory</code> aspects of the <code>MonadState</code>, there are some functions that will <code>HasLevel</code> and some that will only <code>HasPlayerInfo</code> (e.g. a game-save action). I prefer this effects style approach of writing signatures instead of just writing <code>goto :: Direction -&gt; MysteryMonad MoveResult</code>. In terms of the level information itself, I can&#39;t yet think of any other type I&#39;d use to represent that information: but I&#39;d like to be able to structure my code such that I could opt into a different representation if I wished."}, {"owner": {"reputation": 372, "user_id": 2722784, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17935d19c83cba797a7c8e1470dc20bb?s=128&d=identicon&r=PG", "display_name": "Feenaboccles", "link": "https://stackoverflow.com/users/2722784/feenaboccles"}, "edited": false, "score": 0, "creation_date": 1460651415, "post_id": 36610763, "comment_id": 60853626, "body": "Just to add, my main query is can I make functions, particularly monadic functions, wholly independent of the underlying data representation. The particular concrete problem I have is accessing one type-class through another type-class."}], "answers": [{"comments": [{"owner": {"reputation": 372, "user_id": 2722784, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17935d19c83cba797a7c8e1470dc20bb?s=128&d=identicon&r=PG", "display_name": "Feenaboccles", "link": "https://stackoverflow.com/users/2722784/feenaboccles"}, "edited": false, "score": 0, "creation_date": 1460921303, "post_id": 36646751, "comment_id": 60952150, "body": "I was waiting to see if anyone could suggest anything wrong with this, or a better solution, but since no-one has, I&#39;ll just accept my own answer."}], "tags": [], "owner": {"reputation": 372, "user_id": 2722784, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17935d19c83cba797a7c8e1470dc20bb?s=128&d=identicon&r=PG", "display_name": "Feenaboccles", "link": "https://stackoverflow.com/users/2722784/feenaboccles"}, "is_accepted": true, "score": 0, "last_activity_date": 1460727278, "last_edit_date": 1460727278, "creation_date": 1460722117, "answer_id": 36646751, "question_id": 36610763, "link": "https://stackoverflow.com/questions/36610763/how-to-define-a-type-class-the-returns-a-value-of-another-type-class/36646751#36646751", "title": "How to define a type-class the returns a value of another type-class", "body": "<p>The solution to this is <code>TypeFamilies</code> extension.</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n</code></pre>\n\n<p>Using it we can add a place-holder, called <code>FuncsResults</code> to our <code>HasReadables</code> type-class declaration, which will identity the concrete type which each instance will return. We can constrain this placeholder to ensure that whatever type is picked in the instance is itself an instance of the <code>Funcs</code> class.</p>\n\n<pre><code>class Funcs f where\n  func1 :: f -&gt; Int\n\nclass (Funcs FuncsResult) =&gt; HasReadables r where\n  type FuncsResult :: *\n  readable1 :: r -&gt; FuncsResult\n</code></pre>\n\n<p>Here are the concrete data-types</p>\n\n<pre><code>data FuncsRepr = FuncsRepr {\n  returnValue :: Int\n}\n\ndata Wrapper = Wrapper {\n  repr :: FuncsRepr\n}\n</code></pre>\n\n<p>And here is how to implement the classes, where we now replace the placeholder <code>FuncsResult</code> with an actual concrete type, <code>FuncsRepr</code> which is an instance of the <code>Funcs</code> class.</p>\n\n<pre><code>instance Funcs FuncsRepr where\n  func1 = returnValue\n\ninstance HasReadables Wrapper where\n  type FuncsResult = FuncsRepr\n  readable1 = repr\n</code></pre>\n\n<p>The use of this placeholder fixes the ambiguity that previously tripped up the type-inference engine.</p>\n\n<p>And finally here is a sample monadic function</p>\n\n<pre><code>monadFunc :: (HasReadables r, MonadReader r m)\n          =&gt; String -&gt; m String\nmonadFunc s = do\n  val &lt;- liftM (func1 . readable1) ask\n  return (s ++ show val)\n</code></pre>\n\n<p>Which we can run</p>\n\n<pre><code>runReader \n   (monadFunc \"Hello\") \n   Wrapper { repr = FuncsRepr { returnValue = 2 } }\n</code></pre>\n\n<p>and obtain the desired result.</p>\n\n<pre><code>Hello2\n</code></pre>\n"}], "owner": {"reputation": 372, "user_id": 2722784, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17935d19c83cba797a7c8e1470dc20bb?s=128&d=identicon&r=PG", "display_name": "Feenaboccles", "link": "https://stackoverflow.com/users/2722784/feenaboccles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 36646751, "answer_count": 1, "score": 1, "last_activity_date": 1460727464, "creation_date": 1460586958, "last_edit_date": 1460727464, "question_id": 36610763, "link": "https://stackoverflow.com/questions/36610763/how-to-define-a-type-class-the-returns-a-value-of-another-type-class", "title": "How to define a type-class the returns a value of another type-class", "body": "<p>How can I say that a monad m is</p>\n\n<ul>\n<li>An instance of MonadReader</li>\n<li>For which <code>ask</code> returns a value belonging to a type-class <code>HasReadables</code></li>\n<li>Such that that type-class in turn define a function returning a value belonging a second <code>FuncsClass</code></li>\n<li>Such that I can call functions in the second type-class, <code>FuncsClass</code></li>\n<li>e.g. <code>val &lt;- lift (funcs1 . readables1) ask</code>, where <code>funcs1</code> and <code>readables1</code> are functions defined in the two type-classes</li>\n</ul>\n\n<p>My <em>primary problem</em> is how to make my monadic code entirely independent of the underlying data-types: perhaps I need to consider something other than type-classes.</p>\n\n<p>Here's a sketch of the code</p>\n\n<p>E.g.</p>\n\n<pre><code>class FuncsClass f where\n   func1 f = ...\n   func2 f = ...\n   ...\ndata MyFuncsData = ...\ninstance FuncsClass MyFuncsData where ...\n\nclass HasReadables i where\n   readables1 = forall f. FuncsClass f =&gt; i -&gt; f\n   readables2 = ...\ndata ReadOnlyData = ReadOnlyData { r1 :: MyFuncsData, etc :: etc }\ninstance HasReadables ReadOnlyData where ... ** Can't figure this out **\n\nmonadFunc :: (MonadReader r m, HasReadables r) =&gt; ContreteType -&gt; m OtherType\nmonadFunc input = \n    val &lt;- liftM (func1 . readables1) ask\n    -- do stuff and return\n</code></pre>\n\n<hr>\n\n<p><strong>Edit 2</strong> You don't need to read the rest of this question to understand the answer below :)</p>\n\n<hr>\n\n<p><strong>Edit</strong>\nSo here's my actual problem for those suspecting an XY Problem. I'm writing an adventure game. The monad stack is</p>\n\n<pre><code>type AdventureGame = RWS GameInfo GameState GameLog\n</code></pre>\n\n<p>The type <code>GameLevel</code> contains the rules of the world. The type <code>GameInfo</code> contains <code>GameLevel</code> and <code>PlayerInfo</code> (name, save-file). The type <code>GameState</code> has the mutable state of the world. I want to write</p>\n\n<pre><code>goto :: (HasLevel r, MonadReader r m, HasPlayer s, MonadState s m)\n     =&gt; Direction -&gt; m MoveResult\ngoto d = do\n  src &lt;- liftM (playerLocation) get\n  dst &lt;- liftM (locationAt src direction . getLevel) ask\n  case dst of\n    Nothing  -&gt; return (CantMoveInDirection d)\n    (Just l) -&gt; do\n      modify (setPlayerLocation l)\n      return (EnteredLocation l)\n</code></pre>\n\n<p>The state part of this works. The <code>HasPlayer</code> class defines both the <code>playerLocation</code> and <code>setPlayerLocation</code> functions; it's implemented for a <code>GameState</code> type; and a <code>GameState</code> value is passed into <code>runStateT</code></p>\n\n<p>The reader part of this fails. The <code>locationAt</code> function is defined in a Level type class, and an implementation is provided for <code>GameLevel</code>. However <code>runReaderT</code> is passed a <code>GameInfo</code> type which contains both a <code>GameLevel</code> value and <code>PlayerInfo</code> value. This indirection means that to make things similarly generic I would like to have something like</p>\n\n<pre><code>class HasLevel i where\n  getLevel :: forall l. Level l =&gt; getLevel :: i -&gt; l\n\ninstance HasLevel GameInfo where\n  getLevel = giLevel -- ^ giLevel is just a field of GameInfo\n</code></pre>\n\n<p>but this won't compile due to <code>Could not deduce (l ~ GameLevel)</code>.</p>\n\n<p>The primary issue, as mentioned in the abstract example above, is how to work around this indirection and keep the monadic code independent of implementation details.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1460581193, "post_id": 36609288, "comment_id": 60815540, "body": "Usually you have <code>State s a = State (s -&gt; (s, a))</code> so indeed <code>g</code> is a function with type <code>s -&gt; (s, a)</code> (i.e. it takes a state and produces a result (<code>a</code> in this case) and a new state (<code>s1</code>)). This <code>Functor</code> instance simply applies <code>f</code> to the result of the computation before returning the value."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1460585232, "post_id": 36609288, "comment_id": 60817547, "body": "The name state is indeed confusing and the state is a monad itself. What is a monad is something which access and or modify a state."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1460581592, "post_id": 36609548, "comment_id": 60815771, "body": "<i>&quot;while the state is unchanged.&quot;</i> is somewhat ambiguous. &quot;while the state originally returned by <code>g</code> is unchanged&quot; could be better."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 9, "last_activity_date": 1460582391, "last_edit_date": 1460582391, "creation_date": 1460581481, "answer_id": 36609548, "question_id": 36609288, "link": "https://stackoverflow.com/questions/36609288/functor-instance-of-state/36609548#36609548", "title": "Functor instance of State", "body": "<p>It looks like your state type looks like:</p>\n\n<pre><code>data State s a = State (s -&gt; (a ,s))\n</code></pre>\n\n<p>so your <code>fmap</code> function should have type:</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; (State s a) -&gt; (State s b)\n</code></pre>\n\n<p>when you match on the input state value in</p>\n\n<pre><code>fmap f (State g) = State $ \\s0 -&gt; \n</code></pre>\n\n<p><code>g</code> is a function <code>s -&gt; (a, s)</code> and you need to construct one of type <code>s -&gt; (b, s)</code>.</p>\n\n<pre><code>(a, s1) = g s0\n</code></pre>\n\n<p>applies the input state to the existing stateful computation, binding <code>a</code> to the result and <code>s1</code> to the new state. It then applies <code>f</code> to <code>a</code> to obtain the mapped result value in</p>\n\n<pre><code>(f a, s1)\n</code></pre>\n\n<p>while the state returned from <code>g</code> is unchanged.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1457, "favorite_count": 0, "accepted_answer_id": 36609548, "answer_count": 1, "score": 6, "last_activity_date": 1460601450, "creation_date": 1460580480, "last_edit_date": 1460601450, "question_id": 36609288, "link": "https://stackoverflow.com/questions/36609288/functor-instance-of-state", "title": "Functor instance of State", "body": "<pre><code>instance Functor (State s) where\n  fmap f (State g) = State $ \\s0 -&gt; \n      let (a, s1) = g s0\n      in (f a, s1)\n</code></pre>\n\n<p>It is implementation of <code>Functor</code> for <code>State</code>. I cannot understand how does it work? Especially, <code>g</code> is used as it would be a function but on my eye it is not a function. It is just object ( perhaps function) but I cannot understand why it is function. After all, it should be some state so it can for example <code>Int</code></p>\n\n<p>Please make clear.</p>\n"}, {"tags": ["haskell", "functional-programming", "type-mismatch"], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 6, "last_activity_date": 1460579476, "creation_date": 1460579476, "answer_id": 36609010, "question_id": 36608918, "link": "https://stackoverflow.com/questions/36608918/haskell-couldnt-match-expected-type-io-t0-with-actual-type-integer/36609010#36609010", "title": "Haskell: Couldn&#39;t match expected type &#39;IO t0&#39; with actual type &#39;Integer&#39;", "body": "<p>If <code>main</code> is in the main module (usually called <code>Main</code>), it must have the type <code>IO a</code> (usually <code>IO ()</code>).</p>\n\n<p>Since <code>bell 9</code> has type <code>Integer</code> the types don't match. You need to print the <code>Integer</code> with <code>print&nbsp;::&nbsp;Show&nbsp;a&nbsp;=>&nbsp;a&nbsp;->&nbsp;IO&nbsp;()</code> the <code>Integer</code>:</p>\n\n<pre><code>main = print (bell 9)\n</code></pre>\n\n<p>Note that <code>(/)</code> does not work for <code>Integer</code>, you need to use <code>div</code> instead:</p>\n\n<pre><code>| otherwise = factorial(n) `div` (factorial(n-k) * factorial(k))\n</code></pre>\n"}], "owner": {"reputation": 231, "user_id": 4798600, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh6.googleusercontent.com/-zFS_9EBn1_4/AAAAAAAAAAI/AAAAAAAAAD0/pDWfYurHBwk/photo.jpg?sz=128", "display_name": "Brian Sizemore", "link": "https://stackoverflow.com/users/4798600/brian-sizemore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6525, "favorite_count": 1, "accepted_answer_id": 36609010, "answer_count": 1, "score": 1, "last_activity_date": 1460579476, "creation_date": 1460579189, "question_id": 36608918, "link": "https://stackoverflow.com/questions/36608918/haskell-couldnt-match-expected-type-io-t0-with-actual-type-integer", "title": "Haskell: Couldn&#39;t match expected type &#39;IO t0&#39; with actual type &#39;Integer&#39;", "body": "<p>When trying to compile my code i'm getting:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( survey2.hs, survey2.o )\n\nsurvey2.hs:20:1:\n    Couldn't match expected type \u2018IO t0\u2019 with actual type \u2018Integer\u2019\n    In the expression: main\n    When checking the type of the IO action \u2018main\u2019\n</code></pre>\n\n<p>I've tried messing around with specifying the '9' that is being input to main as a bunch of different types including IO, IO t, IO t0, int, etc. I understand that based on the function definitions I have in other places, that if an Integer is not input into the function that none of the other functions will work properly. I'm not sure How to put the proper type into the main.</p>\n\n<pre><code>factorial:: Integer -&gt; Integer\nfactorial n\n  | n &lt;= 1    = 1 \n  | otherwise =  n * factorial(n-1)\n\nbinomial :: (Integer, Integer) -&gt; Integer\nbinomial (n, k)\n  | k &gt; n     = 0 \n  | k &lt; 0     = 0 \n  | otherwise = factorial(n) / (factorial(n-k) * factorial(k))\n\nbell :: Integer -&gt; Integer\nbell n\n  | n &lt;= 1    = 1 \n  | otherwise = sum [ binomial(n-1, k-1)  * bell (k-1) | k&lt;-[0..n-1] ] \n\nbellSum :: Integer -&gt; Integer  \nbellSum n = sum [ bell(k) | k&lt;-[0..n] ]\n\nmain = bell(9 :: Integer )\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 3, "creation_date": 1460578767, "post_id": 36608620, "comment_id": 60814232, "body": "You already have a <code>Monoid a</code> constraint, so you should use <code>mappend</code> and <code>mempty</code>."}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1460579476, "post_id": 36608775, "comment_id": 60814633, "body": "<code>Monoid</code> isn&#39;t just convenient btw, its laws are also exactly what you need to get a law-abiding <code>Applicative</code> &quot;for free&quot;. To see what I mean, try to prove the <code>Applicative</code> laws for <code>((,) a)</code> without left- and right-identity of <code>mempty</code> or associativity of <code>mappend</code>."}, {"owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "edited": false, "score": 1, "creation_date": 1460650156, "post_id": 36608775, "comment_id": 60852824, "body": "mempty was probably my missing piece, so I end up having <code>pure b = Two mempty b</code>. Thanks!"}, {"owner": {"reputation": 841, "user_id": 2272506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d910c6f729897b6af6fa867a794001?s=128&d=identicon&r=PG", "display_name": "Jesin", "link": "https://stackoverflow.com/users/2272506/jesin"}, "edited": false, "score": 0, "creation_date": 1473112927, "post_id": 36608775, "comment_id": 66007585, "body": "Due to Haskell&#39;s lazy evaluation, you technically <i>can</i> have it without a constraint, though you probably don&#39;t <i>want</i> to. <code>pure x = Two undefined x</code>"}], "tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": true, "score": 3, "last_activity_date": 1460578692, "creation_date": 1460578692, "answer_id": 36608775, "question_id": 36608620, "link": "https://stackoverflow.com/questions/36608620/what-is-the-applicatives-pure-for-data-two-a-b-two-a-b/36608775#36608775", "title": "What is the Applicative&#39;s pure for Data Two a b = Two a b", "body": "<p>You can't have it without a constraint. You need to do something about <code>a</code> and to be able to you need to have operations for that type, which you can get two ways: either use a specific type (e.g., <code>Int</code>, or an abstract one, requiring a typeclass instance).</p>\n\n<p>The most general constraint that comes to mind in such a case is <code>Monoid</code>, which renders your instance the same as for the 2-element tuple:</p>\n\n<pre><code>instance Monoid a =&gt; Applicative ((,) a) where\n    pure x = (mempty, x)\n    (u, f) &lt;*&gt; (v, x) = (u `mappend` v, f x)\n</code></pre>\n"}], "owner": {"reputation": 813, "user_id": 750039, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/dd083a563230226543fcab3e1395b1fd?s=128&d=identicon&r=PG", "display_name": "amitaibu", "link": "https://stackoverflow.com/users/750039/amitaibu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 36608775, "answer_count": 1, "score": 2, "last_activity_date": 1460578692, "creation_date": 1460578257, "question_id": 36608620, "link": "https://stackoverflow.com/questions/36608620/what-is-the-applicatives-pure-for-data-two-a-b-two-a-b", "title": "What is the Applicative&#39;s pure for Data Two a b = Two a b", "body": "<p>Given this type:</p>\n\n<pre><code>data Two a b = Two a b deriving (Eq, Show)\n</code></pre>\n\n<p>What would be the Applicative definition. I'm not able to get the <code>pure</code> right without adding a constraint on <code>a</code> like for example <code>Num a</code></p>\n\n<pre><code>instance (Num a, Monoid a) =&gt; Applicative (Two a) where\n  pure b = Two 1 b\n  Two f f' &lt;*&gt; Two a b = Two a (f' b)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 12923, "user_id": 1530508, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/fG8z0.png?s=128&g=1", "display_name": "ApproachingDarknessFish", "link": "https://stackoverflow.com/users/1530508/approachingdarknessfish"}, "edited": false, "score": 0, "creation_date": 1460578864, "post_id": 36608564, "comment_id": 60814284, "body": "@WillSmyth No. <code>foldl</code> takes its arguments in reverse order so when you write <code>\\x y -&gt; 1 + y</code> you&#39;re adding 1 to the element being processed and not the accumulator. That&#39;s why in chi&#39;s example it gives 401."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6137776"}, "edited": false, "score": 0, "creation_date": 1460579084, "post_id": 36608564, "comment_id": 60814435, "body": "Sorry Is that not what I am showing in my answer? I am not using the accumulator and the answer is not carried over."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1460580822, "post_id": 36608564, "comment_id": 60815363, "body": "@WillSmyth Your last update looks OK: at every step you discard the accumulator and return the current list item + 1."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 6, "last_activity_date": 1460578068, "creation_date": 1460578068, "answer_id": 36608564, "question_id": 36608507, "link": "https://stackoverflow.com/questions/36608507/use-of-foldr-vs-foldl-in-defining-length/36608564#36608564", "title": "Use of foldr vs foldl in defining length", "body": "<p>Hint:</p>\n\n<pre><code>&gt; foldl (\\x y -&gt; 1 + y) 0 [1,2,3,400]\n401\n</code></pre>\n\n<p>Also note that these two function types take arguments in a different order:</p>\n\n<pre><code>&gt; :t foldr\nfoldr :: Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b\n                       ^^^^^^^^^^^^^\n&gt; :t foldl\nfoldl :: Foldable t =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b\n                       ^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1460656026, "creation_date": 1460656026, "answer_id": 36630389, "question_id": 36608507, "link": "https://stackoverflow.com/questions/36608507/use-of-foldr-vs-foldl-in-defining-length/36630389#36630389", "title": "Use of foldr vs foldl in defining length", "body": "<p>If you actually define your length function (call it <code>length'</code> or something) and ask GHCi for its type using <code>:t length'</code>, you will see that it does not have the type you would expect. If you define it with the correct type signature, <code>length' :: Foldable f =&gt; f a -&gt; Int</code>, the type error should give you a hint about what you did wrong.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6137776"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 36608564, "answer_count": 2, "score": 0, "last_activity_date": 1460656026, "creation_date": 1460577933, "last_edit_date": 1460578665, "question_id": 36608507, "link": "https://stackoverflow.com/questions/36608507/use-of-foldr-vs-foldl-in-defining-length", "title": "Use of foldr vs foldl in defining length", "body": "<p>I know that <strong>foldr</strong> can be used to define a length function on the list [1,2,3,4] like this:</p>\n\n<pre><code>ghci &gt; foldr (\\x y -&gt; 1 + y) 0 [1,2,3,4]\n</code></pre>\n\n<p>and that it works like this:</p>\n\n<pre><code>Starting accumulator = 0\n1 + 0 = 1\n1 + 1 = 2\n1 + 2 = 3\n1 + 3 = 4\nAnswer = 4\n</code></pre>\n\n<p>But I am unsure why the equivalent <strong>foldl</strong> function evaluates to 5 not 4:</p>\n\n<pre><code>ghci &gt; foldl (\\x y -&gt; 1 + y) 0 [1,2,3,4]\n</code></pre>\n\n<hr>\n\n<p>How I think it work from chi's hint:</p>\n\n<pre><code>Starting accumulator = 0 (not used) \n1 + 1 = 2\n1 + 2 = 3\n1 + 3 = 4\n1 + 4 = 5\nAnswer = 5\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "factorial", "type-mismatch"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1460577804, "post_id": 36608331, "comment_id": 60813678, "body": "The symbol for a function type is <code>-&gt;</code>, not <code>=&gt;</code>.  <code>=&gt;</code> is for typeclass constraints (which I guess you haven&#39;t learned about yet)."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1460577876, "post_id": 36608331, "comment_id": 60813723, "body": "And a definition for an <code>(Integer, Integer) -&gt; Integer</code> function looks like <code>binomial (n,k) = ...</code>.  The one you have corresponds to an <code>Integer -&gt; Integer -&gt; Integer</code> function (which, in haskell, is a much more common pattern)."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1460578023, "post_id": 36608331, "comment_id": 60813813, "body": "<a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">LYAH</a> is highly recommended."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1460578318, "post_id": 36608331, "comment_id": 60813993, "body": "<code>factorial(n) &#47; factorial(n-k) * factorial(k)</code> is equal to <code>(factorial(n) &#47; factorial(n-k)) * factorial(k)</code> not <code>factorial(n) &#47; (factorial(n-k) * factorial(k))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 231, "user_id": 4798600, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh6.googleusercontent.com/-zFS_9EBn1_4/AAAAAAAAAAI/AAAAAAAAAD0/pDWfYurHBwk/photo.jpg?sz=128", "display_name": "Brian Sizemore", "link": "https://stackoverflow.com/users/4798600/brian-sizemore"}, "edited": false, "score": 0, "creation_date": 1460578340, "post_id": 36608562, "comment_id": 60814008, "body": "Thank you. Any major advantages/disadvantages to the Integer -&gt; Integer -&gt; Integer vs (Integer, Integer) -&gt; Integer? I my program to the (n, k) and now I&#39;m getting a different, issue with the same program. Should I open a new question or modify the existing one? Not really sure on proper etiquette for the question."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 231, "user_id": 4798600, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh6.googleusercontent.com/-zFS_9EBn1_4/AAAAAAAAAAI/AAAAAAAAAD0/pDWfYurHBwk/photo.jpg?sz=128", "display_name": "Brian Sizemore", "link": "https://stackoverflow.com/users/4798600/brian-sizemore"}, "edited": false, "score": 1, "creation_date": 1460578411, "post_id": 36608562, "comment_id": 60814057, "body": "if the two arguments are not naturally is a pair better to use <code>Integer -&gt; Integer -&gt; Integer</code> which will be more natural in Haskell and more flexible."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 1, "last_activity_date": 1460579515, "last_edit_date": 1460579515, "creation_date": 1460578060, "answer_id": 36608562, "question_id": 36608331, "link": "https://stackoverflow.com/questions/36608331/haskell-implementation-of-bell-numbers/36608562#36608562", "title": "Haskell Implementation of Bell Numbers", "body": "<p>Note that this is not consistent (<code>=&gt;</code> should be <code>-&gt;</code>)</p>\n\n<pre><code>binomial :: (Integer, Integer) -&gt; Integer\nbinomial n k \n</code></pre>\n\n<p>either change to </p>\n\n<pre><code>binomial :: Integer -&gt; Integer -&gt; Integer\nbinomial n k \n</code></pre>\n\n<p>or</p>\n\n<pre><code>binomial :: (Integer, Integer) -&gt; Integer\nbinomial (n, k)\n</code></pre>\n\n<p>Another hint for you, you can compute binomial without the factorial function (or even multiplication)</p>\n\n<pre><code>binomial n k | k==0 || k==n = 1\n             | k==1 = n\n             | otherwise = binomial (n-1) (k-1) + binomial (n-1) k\n</code></pre>\n\n<p>this is still very inefficient but it can be memoized.</p>\n"}], "owner": {"reputation": 231, "user_id": 4798600, "user_type": "registered", "accept_rate": 73, "profile_image": "https://lh6.googleusercontent.com/-zFS_9EBn1_4/AAAAAAAAAAI/AAAAAAAAAD0/pDWfYurHBwk/photo.jpg?sz=128", "display_name": "Brian Sizemore", "link": "https://stackoverflow.com/users/4798600/brian-sizemore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 36608562, "answer_count": 1, "score": 0, "last_activity_date": 1460579515, "creation_date": 1460577379, "last_edit_date": 1460577753, "question_id": 36608331, "link": "https://stackoverflow.com/questions/36608331/haskell-implementation-of-bell-numbers", "title": "Haskell Implementation of Bell Numbers", "body": "<p>I'm trying to implement a bell number finder + summation in Haskell. I'm fairly confident that my methods are correct, but I'm having problems with some errors at compile time. My current error message is:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( survey2.hs, survey2.o )\nsurvey2.hs:5:14:**\n    Expected a constraint, but \u2018Integer\u2019 has kind \u2018*\u2019\n    In the type signature for \u2018binomial\u2019:\n      binomial :: (Integer, Integer) =&gt; Integer\n\nsurvey2.hs:15:12:\n    Expected a constraint, but \u2018Integer\u2019 has kind \u2018*\u2019\n    In the type signature for \u2018bellSum\u2019: bellSum :: Integer =&gt; Integer**\n</code></pre>\n\n<p>I'm totally new to haskell and new to functional languages in general. Based on this error, I have tried changing my \"function definitions\" (Or whatever you call them in Haskell), but I just seem to cause more errors. </p>\n\n<p>The end goal of the program is to print the sum of the bell numbers 0-9.</p>\n\n<pre><code>factorial n\n  | n &lt;= 1    = 1 \n  | otherwise =  n * factorial(n-1)\n\nbinomial :: (Integer, Integer) =&gt; Integer\nbinomial n k \n  | k &gt; n     = 0 \n  | k &lt; 0     = 0 \n  | otherwise = factorial(n) / factorial(n-k) * factorial(k)\n\nbell n\n  | n &lt;= 1    = 1 \n  | otherwise = sum [ binomial (n-1, k-1)  * bell (k-1) | k&lt;-[0..n-1] ] \n\nbellSum :: Integer =&gt; Integer  \nbellSum n = sum [ bell(k) | k&lt;-[0..n] ]\n\nmain = bell(9 :: Integer)\n</code></pre>\n"}, {"tags": ["haskell", "monad-transformers"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 2, "creation_date": 1460574090, "post_id": 36606701, "comment_id": 60811423, "body": "<code>mapStateT</code> is perfectly fine, IMO. I&#39;d just use <code>Just . runIdentity</code> as its argument."}, {"owner": {"reputation": 55, "user_id": 2240422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca9c7157a98d067cfc4e614a4949090?s=128&d=identicon&r=PG", "display_name": "gcnew", "link": "https://stackoverflow.com/users/2240422/gcnew"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1460589627, "post_id": 36606701, "comment_id": 60819245, "body": "Roughly the same question (though more theoretical): <a href=\"http://stackoverflow.com/questions/4138671/combining-statet-and-state-monads\" title=\"combining statet and state monads\">stackoverflow.com/questions/4138671/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 2240422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca9c7157a98d067cfc4e614a4949090?s=128&d=identicon&r=PG", "display_name": "gcnew", "link": "https://stackoverflow.com/users/2240422/gcnew"}, "edited": false, "score": 0, "creation_date": 1460588056, "post_id": 36608908, "comment_id": 60818677, "body": "Yes, by &quot;promote&quot; I was refering to (1). The <code>Monad m =&gt; StateT s m a</code> is a neat trick though not obvous and I feel slightly misleading from API stand point. Of course it totally makes sense - &quot;I&#39;m not dependent on the type of the inner monad&quot;. <code>mmorph</code> looks like the right tool for the job, thanks."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 55, "user_id": 2240422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca9c7157a98d067cfc4e614a4949090?s=128&d=identicon&r=PG", "display_name": "gcnew", "link": "https://stackoverflow.com/users/2240422/gcnew"}, "edited": false, "score": 0, "creation_date": 1460591151, "post_id": 36608908, "comment_id": 60819721, "body": "&quot;The <code>Monad m =&gt; StateT s m a</code> is a neat trick though not obvous and I feel slightly misleading from API stand point.&quot;  I agree it&#39;s less clear but I&#39;d say it&#39;s, strictly speaking, <i>not</i> misleading, because the type would be <b>isomorphic</b> to <code>State s a</code>.  See my edit to the answer."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 1, "last_activity_date": 1460591338, "last_edit_date": 1460591338, "creation_date": 1460579151, "answer_id": 36608908, "question_id": 36606701, "link": "https://stackoverflow.com/questions/36606701/composing-state-and-state-transformer-actions/36608908#36608908", "title": "Composing State and State transformer actions", "body": "<blockquote>\n  <p>I don't want to promote the <code>State</code> actions to <code>StateT Maybe</code> either, because it poses an inaccurate model.</p>\n</blockquote>\n\n<p>What do you mean by \"promote\"?  I can't tell which of these you mean:</p>\n\n<ol>\n<li>Rewrite the definitions of the <code>State</code> actions so that their type is now <code>StateT Maybe</code>, even though they don't rely on <code>Maybe</code> at all;</li>\n<li>Use an adapter function that transforms <code>State s a</code> into <code>StateT s Maybe a</code>.</li>\n</ol>\n\n<p>I agree with rejecting (1), but to me that mean either:</p>\n\n<ul>\n<li>Go for (2).  One useful tool for this is to use the <a href=\"https://hackage.haskell.org/package/mmorph\" rel=\"nofollow\"><code>mmorph</code> library</a> (<a href=\"http://www.haskellforall.com/2013/03/mmorph-100-monad-morphisms.html\" rel=\"nofollow\">blog entry</a>).  </li>\n<li>Rewrite the actions from <code>State s a</code> to use <code>Monad m =&gt; StateT s m a</code>.</li>\n</ul>\n\n<p>In the second case, the type is <em>compatible</em> with any Monad <code>m</code> but does not allow the code to assume any specific base monad, so you get the same purity as <code>State s a</code>.</p>\n\n<p>I'd give <code>mmorph</code> a shot.  Note that:</p>\n\n<ul>\n<li><code>State s a</code> = <code>StateT s Identity a</code>;</li>\n<li><code>hoist generalize :: (MFunctor t, Monad m) =&gt; t Identity a -&gt; t m a</code>;</li>\n<li>And that specializes to <code>hoist generalize :: State s a -&gt; StateT s Maybe a</code>. </li>\n</ul>\n\n<hr>\n\n<p><strong>EDIT:</strong> It's worth nothing that there is an isomorphism between the <code>State s a</code> and <code>forall m. StateT s m a</code> types, given by these inverse functions:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nimport Control.Monad.Morph\nimport Control.Monad.Trans\nimport Control.Monad.Trans.State\nimport Control.Monad.Identity\n\nfwd :: (MFunctor t, Monad m) =&gt; t Identity a -&gt; t m a\nfwd = hoist generalize\n\n-- The `forall` in the signature forbids callers from demanding any\n-- specific choice of type for `m`, which allows *us* to choose \n-- `Identity` for `m` here.\nbck :: MFunctor t =&gt; (forall m. t m a) -&gt; t Identity a\nbck = hoist generalize\n</code></pre>\n\n<p>So the <code>Monad m =&gt; StateT s m a</code> and <code>mmorph</code> solutions are, effectively, the same.  I prefer using <code>mmorph</code> here, though.</p>\n"}], "owner": {"reputation": 55, "user_id": 2240422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fca9c7157a98d067cfc4e614a4949090?s=128&d=identicon&r=PG", "display_name": "gcnew", "link": "https://stackoverflow.com/users/2240422/gcnew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 36608908, "answer_count": 1, "score": 2, "last_activity_date": 1460591338, "creation_date": 1460572256, "last_edit_date": 1460573624, "question_id": 36606701, "link": "https://stackoverflow.com/questions/36606701/composing-state-and-state-transformer-actions", "title": "Composing State and State transformer actions", "body": "<p>I have several <code>State</code> monad actions. Some of the actions make decisions based on the current state and other input optionally generating result. The two types of actions invoke each other.</p>\n\n<p>I have modeled these two action types with <code>State</code> and <code>StateT Maybe</code>. The following (contrived) example shows my current approach.</p>\n\n<pre><code>{-# LANGUAGE MultiWayIf #-}\n\nimport Control.Monad (guard)\nimport Control.Monad.Identity (runIdentity)\nimport Control.Monad.Trans.State\n\ntype Producer      = Int -&gt; State  [Int] Int\ntype MaybeProducer = Int -&gt; StateT [Int] Maybe Int\n\nproduce :: Producer\nproduce n\n    | n &lt;= 0    = return 0\n\n    | otherwise = do accum &lt;- get\n                     let mRes = runStateT (maybeProduce n) accum\n\n                     if | Just res &lt;- mRes -&gt; StateT $ const (return res)\n                        | otherwise        -&gt; do res &lt;- produce (n - 1)\n                                                 return $ res + n\n\nmaybeProduce :: MaybeProducer\nmaybeProduce n = do guard $ odd n\n                    modify (n:)\n\n                    mapStateT (return . runIdentity) $\n                        do res &lt;- produce (n - 1)\n                           return $ res + n\n</code></pre>\n\n<p>I have factored out separating the checks from the actions (thus transforming them into simple State actions) because the check itself is very involved (80% of the work) and provides the bindings needed in the action. I don't want to promote the <code>State</code> actions to <code>StateT Maybe</code> either, because it poses an inaccurate model.</p>\n\n<p>Is there a better or more elegan way that I'm missing? In particular I don't like the <code>mapStateT</code>/<code>runStateT</code> duo, but it seems necessary.</p>\n\n<p>PS: I know the example is actually a <code>Writer</code>, but I used <code>State</code> to better reflect the real case</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "state-monad", "io-monad"], "comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1460573609, "post_id": 36606586, "comment_id": 60811132, "body": "Do you know how to do it <i>without</i> transformers? Can you make an <code>IO + State</code> monad by hand?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460574992, "post_id": 36606586, "comment_id": 60811969, "body": "The way this function is written currently shows a pretty critical misunderstanding of the &quot;monad&quot; abstraction. before moving onto transformers, you should first try to implement your current function so as to not be partial, and potentially use monad combinators."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1460575100, "post_id": 36606586, "comment_id": 60812039, "body": "@HaskellFun Do you understand the State monad by itself (how to implement it)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1460576607, "post_id": 36606586, "comment_id": 60812967, "body": "Yes, I can implement bind and return."}], "answers": [{"tags": [], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "is_accepted": true, "score": 3, "last_activity_date": 1460767570, "last_edit_date": 1460767570, "creation_date": 1460575473, "answer_id": 36607772, "question_id": 36606586, "link": "https://stackoverflow.com/questions/36606586/combining-io-monad-with-state-monad-in-example/36607772#36607772", "title": "combining IO monad with State Monad in example", "body": "<p>Here's a basic program outline </p>\n\n<pre><code>newtype StateIO s a = SIO {runSIO :: s -&gt; IO (a, s)}\n\nput :: s -&gt; StateIO s ()\nput s' = SIO $ \\_s -&gt; return ((), s')\n\nliftIO :: IO a -&gt; StateIO s a\nliftIO ia = SIO $ \\s -&gt; do\n    a &lt;- ia\n    return (a, s)\n\ninstance Functor (StateIO s) where\n    fmap ab (SIO sa) = SIO $ \\s -&gt; do\n        (a, s') &lt;- sa s\n        let b = ab a\n        return (b, s')\n\ninstance Applicative (StateIO s) where\n    pure a = SIO $ \\s -&gt; return (a, s)\n    (SIO sab) &lt;*&gt; (SIO sa) = SIO $ \\s -&gt; do\n        (ab, s' ) &lt;- sab s\n        (a , s'') &lt;- sa  s'\n        let b = ab a\n        return (b, s')\n</code></pre>\n\n<p><code>StateIO s a</code> is something that takes an input state (of type <code>s</code>), and returns an IO action to produce something of type <code>a</code> as well as a new state.</p>\n\n<p>To check for understanding, do the following</p>\n\n<ul>\n<li>Write a value of <code>get :: StateIO s s</code> which retrieves the state.</li>\n<li>Write an instance for <code>Monad (StateIO s)</code> (it will be similar to the code above).</li>\n<li>Finally, and this is the big step to understanding transformers, is to define <code>newtype StateT m s a = StateT {run :: s -&gt; m (a, s)}</code>, and translate the above code to that (with the constraint <code>Monad m</code>). This will show you how monad transformers work.</li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 1, "accepted_answer_id": 36607772, "answer_count": 1, "score": 0, "last_activity_date": 1460767570, "creation_date": 1460571964, "last_edit_date": 1460575002, "question_id": 36606586, "link": "https://stackoverflow.com/questions/36606586/combining-io-monad-with-state-monad-in-example", "title": "combining IO monad with State Monad in example", "body": "<p>I created simple evaluator for statements. \nI would like to do it using transformers - mix IO monad with State.<br>\nCould somebody explain how to do it ?  It is something that I can't deal with it - transformers.  </p>\n\n<pre><code>execStmt :: Stmt -&gt; State (Map.Map String Int) ()\nexecStmt s = case s of\n      SAssigment v e -&gt; get &gt;&gt;= (\\s -&gt; put (Map.insert v (fromJust (runReader (evalExpM e) s)) s))\n      SIf e s1 s2 -&gt; get &gt;&gt;=  (\\s -&gt; case (fromJust (runReader (evalExpM e) s)) of\n                                        0 -&gt; execStmt s2\n                                        _ -&gt; execStmt s1\n                              )\n      SSkip -&gt; return ()\n      SSequence s1 s2 -&gt; get &gt;&gt;= (\\s -&gt; (execStmt s1) &gt;&gt;= (\\s' -&gt; execStmt s2))\n      SWhile e s1 -&gt; get &gt;&gt;= (\\s -&gt; case (fromJust (runReader (evalExpM e) s)) of\n                                        0 -&gt; return ()\n                                        _ -&gt; (execStmt s1) &gt;&gt;= (\\s' -&gt; execStmt (SWhile e s1)))\n\nexecStmt' :: Stmt -&gt; IO ()\nexecStmt' stmt =  putStrLn $ show $ snd $ runState (execStmt  stmt) Map.empty\n</code></pre>\n"}, {"tags": ["haskell", "tree", "monads", "state-monad"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460573795, "post_id": 36606053, "comment_id": 60811235, "body": "A stack would not be appropriate here, but it looks like <code>Store</code> is a type of map that is handling the mapping of a piece of data to an integer."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 5, "last_activity_date": 1460576196, "last_edit_date": 1460576196, "creation_date": 1460571310, "answer_id": 36606376, "question_id": 36606053, "link": "https://stackoverflow.com/questions/36606053/labeling-trees-in-haskell/36606376#36606376", "title": "labeling trees in haskell", "body": "<p>If you have a traversal function</p>\n\n<pre><code>traverse :: (Traversable t, Applicative f) =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)\n</code></pre>\n\n<p>as given by the <code>Traversable</code> typeclass, then you have <code>f ~ State (Store a Int)</code>, so</p>\n\n<pre><code>traverse label :: (Ord a, Traversable t) =&gt; t a -&gt; State (Store a Int) (t Int)\n</code></pre>\n\n<p>so you should just be able to apply <code>traverse label</code> to your tree, then execute that state action to get your labeled tree, so in full it would be</p>\n\n<pre><code>labelTree :: (Tree t, Ord a) =&gt; t a -&gt; Store a Int -&gt; (t Int, Store a Int)\nlabelTree tree labelStore = runState (traverse label tree) labelStore\n</code></pre>\n\n<p>I've provided <code>labelStore</code> as an argument because it may be desirable to provide this function with a set of existing labels, and because it isn't clear how to construct a new <code>Store</code>.</p>\n\n<p>However, I'll point out that there's nothing special about even using a tree here, any <code>Traversable</code> would be sufficient, so you could apply this to lists, <code>Map</code>s, custom types, or whatever, provided it's a <code>Traversable</code> container holding <code>Ord a =&gt; a</code> values.</p>\n"}], "owner": {"reputation": 49, "user_id": 4805466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07b55e090f6da07d81e357292ca1c6d0?s=128&d=identicon&r=PG&f=1", "display_name": "N....F", "link": "https://stackoverflow.com/users/4805466/n-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "accepted_answer_id": 36606376, "answer_count": 1, "score": 1, "last_activity_date": 1460576439, "creation_date": 1460570195, "last_edit_date": 1460576439, "question_id": 36606053, "link": "https://stackoverflow.com/questions/36606053/labeling-trees-in-haskell", "title": "labeling trees in haskell", "body": "<p>I have an arbitrary tree and want to transform it into a tree of integers, the original values should be replaced by integers.  The same value has to be replaced by the same number at every occurrence.</p>\n\n<p>function for traversing tree is provided, and this is my labeling function</p>\n\n<pre><code>label :: Ord a =&gt; a -&gt; State (Store a Int) Int\n</code></pre>\n\n<p>I believe i need a stack to store labels, but i'm not sure how to apply it\n, any guidance would be appreciated </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "is_accepted": false, "score": 0, "last_activity_date": 1460569789, "creation_date": 1460569789, "answer_id": 36605934, "question_id": 36605821, "link": "https://stackoverflow.com/questions/36605821/how-to-apply-some-function-to-each-line-of-file-in-haskell/36605934#36605934", "title": "How to apply some function to each line of file in Haskell", "body": "<p>You might be looking to do something like this:</p>\n\n<pre><code>parseFile = do\n    f &lt;- readFile \"myfile.txt\"\n    map myFunc $ lines f\n</code></pre>\n\n<p><code>lines</code> splits a file into a list of <code>String</code>s, and <code>map</code> lets you apply a function (supplied in the first argument) to each element of the list. The result is a list of values. (<code>:t map</code> in GHCi yields <code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 0, "last_activity_date": 1460569851, "creation_date": 1460569851, "answer_id": 36605953, "question_id": 36605821, "link": "https://stackoverflow.com/questions/36605821/how-to-apply-some-function-to-each-line-of-file-in-haskell/36605953#36605953", "title": "How to apply some function to each line of file in Haskell", "body": "<p>First, get the contents of the file using readFile</p>\n\n<pre><code>contents &lt;- readFile \"filename\"\n</code></pre>\n\n<p>Then, split the file into lines using the function appropriately named function</p>\n\n<pre><code>let fileLines = lines contents\n</code></pre>\n\n<p>Finally, convert each line to your structure</p>\n\n<pre><code>let objects = map parseMessage fileLines\n</code></pre>\n\n<p>This will be an array of structures representing the original file.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1460571490, "creation_date": 1460571490, "answer_id": 36606434, "question_id": 36605821, "link": "https://stackoverflow.com/questions/36605821/how-to-apply-some-function-to-each-line-of-file-in-haskell/36606434#36606434", "title": "How to apply some function to each line of file in Haskell", "body": "<p>First, you have to recognize that <code>parseFile</code> has to operate in the IO monad, since it involves file I/O. This means extracting the contents from the IO action produced by <code>readFile</code>, then packaging the results back into an IO action. Here it is first in two steps, separating the pure computation from the IO actions:</p>\n\n<pre><code>parseContents :: String -&gt; [SpecificDataStructure]\nparseContents contents = map parseMessage (lines contents)\n\nparseFile :: String -&gt; IO [SpecificDataStructure]\nparseFile fileName = readFile fileName &gt;&gt;= return . parseContents\n</code></pre>\n\n<p>and here it is written as one function</p>\n\n<pre><code>parseFile :: String -&gt; IO [SpecificDataStructure]\nparseFile fileName = do\n                   contents &lt;- readFile fileName\n                   let parsed = map parseMessage (lines contents)\n                   return parsed\n</code></pre>\n"}], "owner": {"reputation": 11760, "user_id": 2926641, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/962e08aff17872bda3f89a9ee6849ab3?s=128&d=identicon&r=PG", "display_name": "asiniy", "link": "https://stackoverflow.com/users/2926641/asiniy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 705, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1460571490, "creation_date": 1460569421, "question_id": 36605821, "link": "https://stackoverflow.com/questions/36605821/how-to-apply-some-function-to-each-line-of-file-in-haskell", "title": "How to apply some function to each line of file in Haskell", "body": "<p>Let's say I have a <code>parseMessage</code> function, and I want it to apply to every line of file and get array of results. How can I do that?</p>\n\n<pre><code>parseMessage :: String -&gt; SpecificDataStructure\n\ntype Path = String\nparseFile :: Path -&gt; [SpecificDataStructure]\nparseFile what_do_I_need_here?\n</code></pre>\n"}, {"tags": ["haskell", "types", "list-comprehension", "type-signature"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 1, "creation_date": 1460616265, "post_id": 36605541, "comment_id": 60827605, "body": "Three minor notes that I hope will help you to learn Haskell: 1) <code>allList</code> and <code>newList</code> don&#39;t need their first cases. 2) You don&#39;t need <code>Eq</code> for pattern matching, so <code>allList</code> doesn&#39;t actually need the <code>Eq a</code> constraint. 3) If you remove the unnecessary code I mentioned, then <code>allList</code> is simply an alias for <code>(++)</code>. You could write <code>x ++ y</code> instead of <code>allList x y</code> in <code>newList</code>, and delete the <code>allList</code> function (unless the exercise somehow requires you to define and use it, or if you think the code is more readable with it)."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 1, "creation_date": 1460615193, "post_id": 36605627, "comment_id": 60827031, "body": "Please always write spaces around the composition operator. If you don&#39;t, it looks too much like name qualification."}], "tags": [], "owner": {"reputation": 25744, "user_id": 2089675, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/sBz5q.jpg?s=128&g=1", "display_name": "smac89", "link": "https://stackoverflow.com/users/2089675/smac89"}, "is_accepted": true, "score": 3, "last_activity_date": 1460622420, "last_edit_date": 1460622420, "creation_date": 1460568808, "answer_id": 36605627, "question_id": 36605541, "link": "https://stackoverflow.com/questions/36605541/haskell-couldnt-match-expected-type-a-with-actual-type-a0/36605627#36605627", "title": "Haskell &quot;Couldn&#39;t match expected type \u2018a\u2019 with actual type \u2018[a0]\u2019&quot;", "body": "<p>The problem lies here:</p>\n\n<pre><code>newList x y = [checkDup z | z &lt;- allList x y]\n</code></pre>\n\n<p><code>z</code> is supposed to be a list you pass to <code>checkDup</code>, but in this case, <code>z</code> is just a single element</p>\n\n<p>Maybe you want:</p>\n\n<pre><code>newList x y = checkDup $ allList x y\n</code></pre>\n\n<p><code>newList</code> can be declared as follows:</p>\n\n<pre><code>newList :: (Eq a) =&gt; [a] -&gt; [a] -&gt; [a]\nnewList = checkDup . allList\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 63, "user_id": 5259489, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153279163504635/picture?type=large", "display_name": "Elsa Sl&#228;tteg&#229;rd", "link": "https://stackoverflow.com/users/5259489/elsa-sl%c3%a4tteg%c3%a5rd"}, "edited": false, "score": 0, "creation_date": 1460572241, "post_id": 36605796, "comment_id": 60810253, "body": "Yes normally I would but it is for a school project and we aren&#39;t allowed to use any imports."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 0, "last_activity_date": 1460622435, "last_edit_date": 1460622435, "creation_date": 1460569351, "answer_id": 36605796, "question_id": 36605541, "link": "https://stackoverflow.com/questions/36605541/haskell-couldnt-match-expected-type-a-with-actual-type-a0/36605796#36605796", "title": "Haskell &quot;Couldn&#39;t match expected type \u2018a\u2019 with actual type \u2018[a0]\u2019&quot;", "body": "<p>Since @Smac89 answered your question, why not use a data representation like <code>Data.Set</code>?</p>\n\n<pre><code>import qualified Data.Set as S\n\nallList :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nallList xs ys = S.toList $ S.union (S.fromList xs) (S.fromList ys)\n</code></pre>\n\n<p>(although the continued use of <code>Set</code>s is probably even more meaningful.)</p>\n\n<p>Or by using <code>Data.List</code>:</p>\n\n<pre><code>import Data.List\n\nnewList :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]\nnewList xs ys = nub $ xs ++ ys\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5259489, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153279163504635/picture?type=large", "display_name": "Elsa Sl&#228;tteg&#229;rd", "link": "https://stackoverflow.com/users/5259489/elsa-sl%c3%a4tteg%c3%a5rd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5554, "favorite_count": 0, "accepted_answer_id": 36605627, "answer_count": 2, "score": 3, "last_activity_date": 1460622435, "creation_date": 1460568537, "last_edit_date": 1460622372, "question_id": 36605541, "link": "https://stackoverflow.com/questions/36605541/haskell-couldnt-match-expected-type-a-with-actual-type-a0", "title": "Haskell &quot;Couldn&#39;t match expected type \u2018a\u2019 with actual type \u2018[a0]\u2019&quot;", "body": "<p>Im doing a project in Haskell where I am trying to create a function which takes two list inputs and then returns a union of the list but without any duplicates. </p>\n\n<p>The problem is that I keep getting the error message:</p>\n\n<pre><code>Couldn't match expected type \u2018a\u2019 with actual type \u2018[t0]\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n          the type signature for newList :: [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>allList :: (Eq a) =&gt; [a] -&gt; [a] -&gt; [a]\nallList [] [] = []\nallList x y = (x ++ y)\n\ncheckDup [] = []\ncheckDup (z:zs)\n    | z `elem` zs = checkDup zs\n    | otherwise = z : checkDup zs\n\nnewList :: (Eq a) =&gt; [a] -&gt; [a] -&gt; [a]\nnewList [] [] = []\nnewList x y = [checkDup z | z &lt;- allList x y]\n</code></pre>\n\n<p>The first <code>allList</code> function creates a list of the two list, the <code>checkDup</code> creates a new list without any duplicates and the <code>newList</code> uses list comprehension to pass the combined list to the <code>checkDup</code>. </p>\n\n<p>Anyone know where I am going wrong?</p>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 3, "creation_date": 1460567568, "post_id": 36605036, "comment_id": 60807455, "body": "Are you sure you are not using any tabs? They aren&#39;t forbidden, but they can do unpredictable things."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1460569506, "post_id": 36605036, "comment_id": 60808591, "body": "the snippet as it is copy&amp;pasted into a fresh file works as declared - btw: are you aware that <code>x</code> will do nothing?"}, {"owner": {"reputation": 63, "user_id": 4434955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1e232b39d005d84a2c140bb82864e8a?s=128&d=identicon&r=PG&f=1", "display_name": "S_FLUID", "link": "https://stackoverflow.com/users/4434955/s-fluid"}, "reply_to_user": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1460582479, "post_id": 36605036, "comment_id": 60816249, "body": "I figured it out! See my answer. @PaulJohnson there&#39;s no tabs."}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 4434955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1e232b39d005d84a2c140bb82864e8a?s=128&d=identicon&r=PG&f=1", "display_name": "S_FLUID", "link": "https://stackoverflow.com/users/4434955/s-fluid"}, "is_accepted": true, "score": 3, "last_activity_date": 1460582421, "creation_date": 1460582421, "answer_id": 36609769, "question_id": 36605036, "link": "https://stackoverflow.com/questions/36605036/cabal-build-gives-parse-error-but-code-works-fine-in-ghci/36609769#36609769", "title": "cabal build gives parse error, but code works fine in GHCi", "body": "<p>It turns out that my GHCi is set up to use the <code>-XNondecreasingIndentation</code> extension, which can be seen with the command <code>:show language</code></p>\n\n<pre><code>base language is: Haskell2010\nwith the following modifiers:\n  -XNoDatatypeContexts\n  -XNondecreasingIndentation\n</code></pre>\n\n<p>Without this extension this is bad syntax:</p>\n\n<pre><code>foo :: IO ()\nfoo = do\n    let x = do\n        b &lt;- getLine\n        return b\n    return ()\n</code></pre>\n\n<p>but this is okay:</p>\n\n<pre><code>foo :: IO ()\nfoo = do\n    let \n        x = do\n            b &lt;- getLine\n            return b\n    return ()\n</code></pre>\n\n<p>To fix the problem, add </p>\n\n<pre><code>  default-extensions: \n    NondecreasingIndentation\n</code></pre>\n\n<p>to the .cabal file, or if you prefer add <code>{-# language NondecreasingIndentation #-}</code> to just this one module. Alternatively, reformat the code as above, or use Haskell98 instead of Haskell2010.</p>\n"}], "owner": {"reputation": 63, "user_id": 4434955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1e232b39d005d84a2c140bb82864e8a?s=128&d=identicon&r=PG&f=1", "display_name": "S_FLUID", "link": "https://stackoverflow.com/users/4434955/s-fluid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "accepted_answer_id": 36609769, "answer_count": 1, "score": 3, "last_activity_date": 1460582421, "creation_date": 1460566913, "question_id": 36605036, "link": "https://stackoverflow.com/questions/36605036/cabal-build-gives-parse-error-but-code-works-fine-in-ghci", "title": "cabal build gives parse error, but code works fine in GHCi", "body": "<p>My code works in GHCi, but when I try to build the project with <code>cabal build</code>, it gives the error \n<code>parse error on input \u2018&lt;-\u2019</code></p>\n\n<p>Here's a minimal example:</p>\n\n<pre><code>foo :: IO ()\nfoo = do\n    let x = do\n        b &lt;- getLine\n        return b\n    return ()\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1460559757, "post_id": 36602353, "comment_id": 60801835, "body": "You can use <code>fromMaybe</code> or <code>maybe</code> for this purpose.  See <a href=\"http://stackoverflow.com/questions/3375483/operating-on-a-return-from-a-maybe-that-contains-just\" title=\"operating on a return from a maybe that contains just\">stackoverflow.com/questions/3375483/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1460559776, "post_id": 36602353, "comment_id": 60801854, "body": "@ThomasM.DuBuisson, from a Monad."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1460559937, "post_id": 36602353, "comment_id": 60801998, "body": "That doesn&#39;t change my understanding of the question.  You have a <code>value :: Maybe a</code> and a function of type <code>a -&gt; Maybe b</code> and wish to use them in a monadic style?  If that&#39;s true then <code>value &gt;&gt;= function</code>.  That is, the bind operator is what you want, <code>do v &lt;- value; function v</code>"}, {"owner": {"reputation": 1825, "user_id": 2671214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v464b.jpg?s=128&g=1", "display_name": "Tomasz Lewowski", "link": "https://stackoverflow.com/users/2671214/tomasz-lewowski"}, "edited": false, "score": 1, "creation_date": 1460559988, "post_id": 36602353, "comment_id": 60802035, "body": "for general extracting values from monads, you may take a look at <a href=\"http://stackoverflow.com/questions/8567743/how-to-extract-value-from-monadic-action\" title=\"how to extract value from monadic action\">stackoverflow.com/questions/8567743/&hellip;</a>"}], "owner": {"user_type": "does_not_exist", "display_name": "user266003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "closed_date": 1460563233, "answer_count": 0, "score": 0, "last_activity_date": 1460559862, "creation_date": 1460559551, "last_edit_date": 1460559862, "question_id": 36602353, "link": "https://stackoverflow.com/questions/36602353/extract-a-real-or-default-value-from-a-monad-with-fmap-or-or-the-likes-ho", "closed_reason": "Duplicate", "title": "Extract a real or default value from a Monad with fmap or &lt;$&gt; or the likes -- how?", "body": "<p>Suppose, I have this function which accepts a Maybe arg:</p>\n\n<pre><code>func1 :: Maybe Int -&gt; Int\nfunc1 mbArg = \n  let var1 = case myArg of\n               Just x -&gt; x\n               Nothing -&gt; -1\n  -- ....\n</code></pre>\n\n<p>I wonder, is there any other way to do the same thing but using something like <code>mapM</code>, <code>mapM_</code> or <code>fmap</code> or <code>&lt;$&gt;</code> or anything similar? That is, check if it's Just or Nothing and extract the real value or return the default value respectively.</p>\n\n<p>My question is about Maybe as a Monad.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1460559428, "post_id": 36602157, "comment_id": 60801504, "body": "This may be useful to you: <a href=\"http://chrisdone.com/posts/path-package\" rel=\"nofollow noreferrer\">chrisdone.com/posts/path-package</a>"}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 1, "creation_date": 1460562055, "post_id": 36602157, "comment_id": 60803675, "body": "this too: <a href=\"https://hackage.haskell.org/package/path-io-1.0.1/docs/Path-IO.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/path-io-1.0.1/docs/Path-IO.html</a> (is able to represent relative and absolute paths as <i>different types</i> \u2013 super useful for scripting in Haskell \u2013 and there&#39;s an operator <code>&lt;&#47;&gt;</code> for gluing directories and filenames together)"}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1460658826, "post_id": 36602157, "comment_id": 60857880, "body": "Thanks. path-io looks right, and I am now using it. Though  it is inconvenient that I have to go via System.FilePath for getting basename, dirname, extension."}], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1460559134, "creation_date": 1460559134, "question_id": 36602157, "link": "https://stackoverflow.com/questions/36602157/abstract-file-handling-library-for-haskell", "title": "abstract file handling library for Haskell?", "body": "<p>Is there a Haskell library for handling files and traversing directories that represents files not by <code>String</code>s (which are relative paths) but actual file objects?  You'd think that <code>ls -lR</code> could be done like this:</p>\n\n<pre><code>walk f = do\n  d &lt;- doesDirectoryExist f\n  case d of\n    False -&gt; putStrLn $ unwords [ \"file\", f ]\n    True -&gt;  listDirectory f &gt;&gt;= mapM_ walk\n</code></pre>\n\n<p>using <a href=\"http://hackage.haskell.org/package/directory-1.2.5.1/docs/System-Directory.html\" rel=\"nofollow\">http://hackage.haskell.org/package/directory-1.2.5.1/docs/System-Directory.html</a> but actually it cannot - I have to manually splice files' names together. I know how this works, but it's definitely ugly.</p>\n\n<p>For reference, Java gets this somewhat more right, because they have <code>Path</code>? <a href=\"http://docs.oracle.com/javase/8/docs/api/java/nio/file/Path.html\" rel=\"nofollow\">http://docs.oracle.com/javase/8/docs/api/java/nio/file/Path.html</a></p>\n\n<pre><code>DirectoryStream&lt;Path&gt; s = Files.newDirectoryStream(p);\nfor (Path f : s) { System.out.println (f); }\n</code></pre>\n"}, {"tags": ["haskell", "hugs"], "comments": [{"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 1, "creation_date": 1460556357, "post_id": 36600794, "comment_id": 60798764, "body": "Cannot reproduce. Which version of GHC do you use?"}, {"owner": {"reputation": 1210, "user_id": 2111053, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c8ba83ffd4f4d9a0f448df0a9e9d5958?s=128&d=identicon&r=PG", "display_name": "Luc DUZAN", "link": "https://stackoverflow.com/users/2111053/luc-duzan"}, "edited": false, "score": 0, "creation_date": 1460556435, "post_id": 36600794, "comment_id": 60798844, "body": "Same for me can&#39;t reproduce it"}, {"owner": {"reputation": 2555, "user_id": 3669613, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/054dcbe4dc6996000b0673791cd85465?s=128&d=identicon&r=PG&f=1", "display_name": "wastl", "link": "https://stackoverflow.com/users/3669613/wastl"}, "edited": false, "score": 0, "creation_date": 1460556468, "post_id": 36600794, "comment_id": 60798866, "body": "I&#39;m using Hugs, edited the question accordingly"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1460556696, "post_id": 36600794, "comment_id": 60799049, "body": "Well, Hugs isn&#39;t maintained. It would be a good idea to just switch to GHCi. That said: if you have tuples of size &gt;3, you&#39;re probably doing something wrong anyway..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1460556706, "post_id": 36600794, "comment_id": 60799057, "body": "I fear that Hugs is limited in this aspect. This is no surprise for a software which today is ancient -- it has not been maintained for many years."}, {"owner": {"reputation": 1342, "user_id": 1574374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6f66f66b0b5781a51040183831d6403?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Harris", "link": "https://stackoverflow.com/users/1574374/mike-harris"}, "edited": false, "score": 5, "creation_date": 1460556816, "post_id": 36600794, "comment_id": 60799149, "body": "According to <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#g:23\" rel=\"nofollow noreferrer\">hackage.haskell.org</a>, <code>Show</code>should be implemented for tuples with up to 15 elements. Hugs might be using its own version of the standard prelude."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1460562723, "post_id": 36600794, "comment_id": 60804196, "body": "I&#39;m voting to close this question as off-topic because it reports a bug in an obsolete language implementation."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1460632588, "post_id": 36600794, "comment_id": 60838662, "body": "@dfeuer Maybe it&#39;s useful to have findable questions warning people not to use Hugs anymore. (?)"}], "answers": [{"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1486417783, "post_id": 36601202, "comment_id": 71327324, "body": "Yes GHCi has a limit. Hugs also has a limit, it&#39;s just lower. (I agree with the O.P. 5 elements is OK, 6 is not.) What&#39;s easy in Hugs is to find where in the Prelude Show instances are defined; copy the code; add your own instances. In GHC not so much."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1460558896, "last_edit_date": 1460558896, "creation_date": 1460556989, "answer_id": 36601202, "question_id": 36600794, "link": "https://stackoverflow.com/questions/36600794/why-can-i-print-a-tuple-with-5-elements-but-not-with-6-in-haskell/36601202#36601202", "title": "Why can I print a tuple with 5 elements but not with 6 in Haskell?", "body": "<p>Here is my test on <code>ghci</code></p>\n\n<pre><code>Prelude&gt; (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,5 1,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100)\n\n&lt;interactive&gt;:445:1:\n    A 100-tuple is too large for GHC\n      (max size is 62)\n      Workaround: use nested tuples or define a data type\n</code></pre>\n\n<p>However, for printing 15 is the limit</p>\n\n<pre><code>Prelude&gt; (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16)\n\n&lt;interactive&gt;:450:1:\n    No instance for (Show\n                       (t0,\n                        t1,\n                        t2,\n                        t3,\n                        t4,\n                        t5,\n                        t6,\n                        t7,\n                        t8,\n                        t9,\n                        t10,\n                        t11,\n                        t12,\n                        t13,\n                        t14,\n                        t15))\n      arising from a use of `print'\n    Possible fix:\n      add an instance declaration for\n      (Show\n         (t0,\n          t1,\n          t2,\n          t3,\n          t4,\n          t5,\n          t6,\n          t7,\n          t8,\n          t9,\n          t10,\n          t11,\n          t12,\n          t13,\n          t14,\n          t15))\n    In a stmt of an interactive GHCi command: print it\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1486418195, "post_id": 36601425, "comment_id": 71327527, "body": "Hugs is great for getting a painless start with Haskell. I still use it occasionally (on an iPad), despite ~15 years using GHC.   GHC is now so crammed-full of Higher-level typing/kinding that understanding its error messages needs a PhD in abstruse math. Not good to encourage people into Functional Programming. And I think there are introductory CompSci courses that recommend Hugs over GHC"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "edited": false, "score": 0, "creation_date": 1486478600, "post_id": 36601425, "comment_id": 71355554, "body": "@AntC: \u201cHint: the mapping <code>compiler :: ProgrammingLanguage -&gt; Program</code> may not be injective...\u201d \u2014 yeah, GHC&#39;s error messages were never the most beginner-friendly and especially the <a href=\"https://wiki.haskell.org/Foldable_Traversable_In_Prelude\" rel=\"nofollow noreferrer\">FTP</a> has made it rather worse. But then, times they are a-changing \u2013 a lot of the selling point of Haskell is now that it&#39;s actually a competitive, full-featured ecosystem that thanks to Stack you can quickly get to run on most platforms. As opposed to the kind of academic, nifty, simple but not-for-production interpreter many Lisps have always stuck with."}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1486501386, "post_id": 36601425, "comment_id": 71370037, "body": "@leftaroundabout: (StackOverflow is not the place to debate this but ...) yes GHC is leading the charge in getting FP recognised for serious industrial-strength programming. I&#39;m worried about how we give a leg-up to newbies to experience the elegance of programming in Haskell. (Esp. coming from an OO paradigm.) What works in Hugs will work in GHC, so it&#39;s a good learning platform. IMO."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 7, "last_activity_date": 1460557450, "creation_date": 1460557450, "answer_id": 36601425, "question_id": 36600794, "link": "https://stackoverflow.com/questions/36600794/why-can-i-print-a-tuple-with-5-elements-but-not-with-6-in-haskell/36601425#36601425", "title": "Why can I print a tuple with 5 elements but not with 6 in Haskell?", "body": "<p>Don't use Hugs.</p>\n\n<p>It hasn't been maintained for years, and doesn't support half the stuff that a modern Haskell implementation is supposed to support. (Hugs supports \"most of\" Haskell '98, which is the previous revision of the language specification.)</p>\n\n<p>You will probably find example code on the Internet that works perfectly with GHC, but fails miserably with Hugs. You will spend ages trying to figure out why your code doesn't work, only to eventually realise \"oh, it <em>does</em> work &mdash; just not with Hugs\".</p>\n"}, {"tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": true, "score": 1, "last_activity_date": 1486425894, "creation_date": 1486425894, "answer_id": 42079502, "question_id": 36600794, "link": "https://stackoverflow.com/questions/36600794/why-can-i-print-a-tuple-with-5-elements-but-not-with-6-in-haskell/42079502#42079502", "title": "Why can I print a tuple with 5 elements but not with 6 in Haskell?", "body": "<p>Here you go. Include this instance of Show for a 6-tuple</p>\n\n<pre><code>-- Tuples   -- for ref, def'n from the Prelude\n{-\ninstance  (Show a, Show b) =&gt; Show (a,b)  where\n  showsPrec p (x,y) = showChar '(' . shows x . showChar ',' .\n                                   shows y . showChar ')'\n\n\ninstance  (Read a, Read b) =&gt; Read (a,b)  where\n    readsPrec p       = readParen False\n                        (\\r -&gt; [((x,y), w) | (\"(\",s) &lt;- lex r,\n                                             (x,t)   &lt;- reads s,\n                                             (\",\",u) &lt;- lex t,\n                                             (y,v)   &lt;- reads u,\n                                             (\")\",w) &lt;- lex v ] )\n-}\n-- Other tuples have similar Read and Show instances\n\ninstance  (Show a, Show b, Show c, Show d, Show e, Show f) \n      =&gt; Show (a,b,c,d,e,f)  where\n  showsPrec p (x1,x2,x3,x4,x5,x6) = showChar '(' . shows x1 . showChar ',' .\n                                   shows x2 . showChar ',' . \n                                   shows x3 . showChar ',' .\n                                   shows x4 . showChar ',' .\n                                   shows x5 . showChar ',' .\n                                   shows x6 . showChar ')'\n</code></pre>\n"}], "owner": {"reputation": 2555, "user_id": 3669613, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/054dcbe4dc6996000b0673791cd85465?s=128&d=identicon&r=PG&f=1", "display_name": "wastl", "link": "https://stackoverflow.com/users/3669613/wastl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 42079502, "answer_count": 3, "score": 2, "last_activity_date": 1486425894, "creation_date": 1460556068, "last_edit_date": 1460556551, "question_id": 36600794, "link": "https://stackoverflow.com/questions/36600794/why-can-i-print-a-tuple-with-5-elements-but-not-with-6-in-haskell", "title": "Why can I print a tuple with 5 elements but not with 6 in Haskell?", "body": "<p>I tried printing the following tuple</p>\n\n<pre><code>(1,2,3,4,5,6)\n</code></pre>\n\n<p>which gave me the following error</p>\n\n<pre><code>ERROR - Cannot find \"show\" function for:\n*** Expression : (1,2,3,4,5,6)\n*** Of type    : (Integer,Integer,Integer,Integer,Integer,Integer)\n</code></pre>\n\n<p>But if I try it with the following tuple</p>\n\n<pre><code>(1,2,3,4,5)\n</code></pre>\n\n<p>everything works like a charm.</p>\n\n<p>My guess is that Haskell only defines <code>Show</code> for tuples up to five elements (since a tuple of with 5 elements is apparently another type than a tuple with 6 elements). But somehow I am to stupid to find proof for that.</p>\n\n<p>So my question is:</p>\n\n<p>Why is this so, and how can I print a tuple with 6 elements (since it seems that I cannot put tuples in the head of an <code>instance</code> definition)?</p>\n\n<p><strong>Edit:</strong> I'm using Hugs</p>\n"}, {"tags": ["forms", "haskell", "yesod"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1460556012, "post_id": 36600691, "comment_id": 60798472, "body": "Please make this a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and add the actual error you&#39;re  getting."}], "owner": {"reputation": 21, "user_id": 5612021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/700d87e6185af74986bd6393b77a784f?s=128&d=identicon&r=PG&f=1", "display_name": "J. Wypych", "link": "https://stackoverflow.com/users/5612021/j-wypych"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1460555835, "creation_date": 1460555835, "question_id": 36600691, "link": "https://stackoverflow.com/questions/36600691/how-to-create-a-button-for-every-row-in-a-table", "title": "How to create a button for every row in a table?", "body": "<p>I have a table and I would like to have a button in each row that will allow me to mark this position as returned.\nI have tried to create a form:</p>\n\n<pre><code>data EndBorrowing = EndBorrowing BorrowingId\nreturnGameButton :: BorrowingId -&gt; Form EndBorrowing\nreturnGameButton borrowingId = renderBootstrap3 (BootstrapHorizontalForm  (ColXs 0) (ColXs 2) (ColXs 0) (ColXs 10)) $ EndBorrowingButton\n    &lt;$&gt; pure borroowingId\n    &lt;*  bootstrapSubmit (\"Return\" :: BootstrapSubmit Text)\n</code></pre>\n\n<p>and then just map it over a list of IDs, but it does not work. When I try to extract data from this form with <code>runFormPost $ returnGameButton</code> Haskell wants me to provide an ID (and when I give it some fake ID it returns this fake ID, and not the one that was a form parameter).<br>\nIs there a nice way to make a button for every row?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1460547687, "post_id": 36597079, "comment_id": 60791174, "body": "I guess it&#39;s historical reasons - but your guess is as good as mine - of course you can argue that in each of these cases the behavior is exceptional and you should take care that it will never happen (I surely would not want to use <code>Maybe</code> everywhere I use <code>div</code>, <code>mod</code>, etc. ... that would be ugly and horrible to work with - <code>tail</code> is fine to similar reasons too (of course usually you don&#39;t need it) - and there are safe versions around"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460575544, "post_id": 36597079, "comment_id": 60812300, "body": "The haskell 2010 report makes no mention of non-IO exceptions (i.e. there is no pattern match failure exception, no <code>ErrorCall</code> exception, etc). In the report <code>error</code> is a primitive, with no real specific semantics other than those given by its type. Presumably GHC tries to comply with the report (historically and now), but it also provides a lot of added functionality (i.e. extensible exceptions). It makes sense to actually implement <code>error</code> as throwing an <code>ErrorCall</code> exception as opposed to inventing a brand new &quot;error&quot; mechanism simply for the <code>error</code> function."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1460555342, "post_id": 36597704, "comment_id": 60797865, "body": "There is a third alternative: choose the argument type(s) to <i>only contain values that fulfill the precondition</i>."}, {"owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460745440, "post_id": 36597704, "comment_id": 60902223, "body": "@leftaroundabout: If you want Agda, you know where to find it.  (What is the type of <code>tail . tail . tail . tail . tail . tail</code> in that case?)"}], "tags": [], "owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "is_accepted": false, "score": 3, "last_activity_date": 1460548801, "creation_date": 1460548801, "answer_id": 36597704, "question_id": 36597079, "link": "https://stackoverflow.com/questions/36597079/what-is-the-purpose-of-throwing-exceptions-in-pure-functions/36597704#36597704", "title": "What is the purpose of throwing exceptions in pure functions?", "body": "<p>Certain functions have preconditions associated to them (<code>!!</code> requires a valid index, <code>tail</code> requires non-empty list, <code>div</code> requires non-zero divisor). A violation of a precondition should result in an exception, because you did not obey the contract.</p>\n\n<p>The alternative is to not use preconditions, but to use a return value that indicates whether the call succeeded or not.</p>\n\n<p>These are all core functions, so they need to be simple to use, which is a big point in favour of preconditions with exceptions. They are also pure, so there is never a surprise when they fail: you know exactly when that will happen, namely when you pass arguments that violate the preconditions. But, in the end, it comes down to a design choice, with points in favour and against both solutions.</p>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460557522, "post_id": 36600725, "comment_id": 60799783, "body": "Hm. That raises a good point that I&#39;m not sure how to address. Haskell can detect some such partial functions; <code>head []</code>, for instance, explicitly raises an &quot;empty list&quot; exception rather than a generic &quot;Non-exhaustive patterns&quot; exception. The OP is probably asking why <code>head :: [a] -&gt; a</code> is defined at all, rather than only providing <code>head :: [a] -&gt; Maybe a</code>. (Oops, the comment this was in response to has been deleted.)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1460557810, "post_id": 36600725, "comment_id": 60800054, "body": "I wouldn&#39;t consider a program made only (or most) of total functions a practical impossibility. From what is posted on SO, beginners quickly tend to resort to partial functions when there is no need to. Partiality should not be completely ruled out, yet it should be used with deep care, and only when safe alternatives are unsatisfactory. In my own opinion, <code>head</code> has very few uses I would approve or recommend. Instead, while <code>div</code> is partial, I find it reasonable."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1460558041, "post_id": 36600725, "comment_id": 60800250, "body": "I think that&#39;s partly due to the lack of dependent types (I think that&#39;s the term I mean here.) While it&#39;s not(?) impossible to define a type representing non-zero integers, it&#39;s far easier to define a function that stays undefined for a zero divisor."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1460558203, "post_id": 36600725, "comment_id": 60800385, "body": "(I&#39;m also starting to think I would downvote this answer as being too opinion-based.)"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 6, "last_activity_date": 1460557935, "last_edit_date": 1460557935, "creation_date": 1460555910, "answer_id": 36600725, "question_id": 36597079, "link": "https://stackoverflow.com/questions/36597079/what-is-the-purpose-of-throwing-exceptions-in-pure-functions/36600725#36600725", "title": "What is the purpose of throwing exceptions in pure functions?", "body": "<p>The unsafe functions are all examples of <em>partial</em> functions; they aren't defined for every value in their domain. Consider <code>head :: [a] -&gt; a</code>. Its domain is <code>[a]</code>, but <code>head</code> is not defined for <code>[]</code>: there is no value of type <code>a</code> that would be correct to return. Something like <code>safeHead :: [a] -&gt; Maybe a</code> is a <em>total</em> function, because you can return a valid <code>Maybe a</code> for any list; <code>safeHead [] = Nothing</code>, and <code>safeHead (x:xs) = Just x</code>.</p>\n\n<p>Ideally, your program would consist only of total functions, but in practice that isn't always possible. (Perhaps there are too many undefined values to anticipate, or you can't know ahead of time which values cause problems.) The exception is an obvious indication that your program is not well defined. When you get an exception, it means you need to change your code to either</p>\n\n<ol>\n<li>Avoid calling the function on the value for which it is not defined</li>\n<li>Replace your function with a function that <em>is</em> defined on the problem value.</li>\n</ol>\n\n<p>Under no circumstances should \"3. Continue running with an undefined value in place of the return value of your function\" be considered acceptable.</p>\n\n<p>(Some conjecture to follow, but I believe it is mostly correct.) Historically, Haskell didn't have a good way of handling exceptions. It was probably easier to check if a list were empty before calling <code>head :: [a] -&gt; a</code> than to deal with a return value like <code>Maybe a</code>. That became less of an issue once monads were introduced, which provided a generic framework for feeding the output of <code>safeHead :: [a] -&gt; Maybe a</code> to functions of type <code>a -&gt; b</code>. Given that it is easy to recognize that <code>head []</code> is not defined, it is at least simple to provide a helpful, specific error message than to rely on the generic error message. Now that functions like <code>safeHead</code> are easier to work with, functions like <code>head</code> can be considered historical relics rather than a model to emulate.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 4, "last_activity_date": 1460589663, "last_edit_date": 1592644375, "creation_date": 1460563913, "answer_id": 36604054, "question_id": 36597079, "link": "https://stackoverflow.com/questions/36597079/what-is-the-purpose-of-throwing-exceptions-in-pure-functions/36604054#36604054", "title": "What is the purpose of throwing exceptions in pure functions?", "body": "<p>Sometimes, something that is <em>true</em> about how a program behaves is not <em>provable</em> within its source language. Other times, it may be provable, but not <em>efficiently</em> so. Still other times, it may be provable, but proving it would require a tremendous amount of time and effort on the part of the programmer.</p>\n<h3>An example</h3>\n<p><code>Data.Sequence</code> represents sequences as size-annotated finger trees. It maintains the invariant that the number of elements in any subtree equals the annotation stored in its root. The implementation of <code>zipWith</code> for sequences splits the longer sequence to match the length of the shorter one, then uses an efficient, operationally lazy technique to zip them together.</p>\n<p>This technique involves splitting the second sequence multiple times along the natural structure of the first sequence. When it reaches a leaf of the first sequence, it relies on the associated fragment of the second sequence having exactly one element. This is guaranteed to happen as long as the annotation invariant is maintained. If this invariant fails, <code>zipWith</code> has no option but to throw an error.</p>\n<p>To encode the annotation invariant in Haskell, you'd need to index the underlying pieces of finger tree with their lengths. You'd then need each operation to <em>prove</em> that it maintains the invariant. This sort of thing is possible, and languages like Coq, Agda, and Idris try to reduce the pain and inefficiency. But they still have pain, and sometimes massive inefficiency. Haskell isn't really properly set up for such work as yet, and may never be great for it (that's just not its main goal as a language). It would be extremely painful, and also extremely inefficient. Since efficiency was the reason for choosing this implementation in the first place, that's just not an option.</p>\n"}], "owner": {"reputation": 10772, "user_id": 427598, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/Fq5PZ.jpg?s=128&g=1", "display_name": "Konstantin Milyutin", "link": "https://stackoverflow.com/users/427598/konstantin-milyutin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 1, "answer_count": 3, "score": 10, "last_activity_date": 1460589663, "creation_date": 1460547136, "question_id": 36597079, "link": "https://stackoverflow.com/questions/36597079/what-is-the-purpose-of-throwing-exceptions-in-pure-functions", "title": "What is the purpose of throwing exceptions in pure functions?", "body": "<p>Since the main source of non-deterministic exceptions is IO and you can catch exception only inside IO monad, it seams reasonable not to throw exceptions from pure functions. </p>\n\n<p>Indeed what could so \"exceptional\" happen in a pure function? Empty list or division by zero are not really exceptional and can be expected. So why not use only <code>Maybe</code>, <code>Either</code> or <code>[]</code> to represent such cases in pure code.</p>\n\n<p>There is a number of pure functions like <code>(!!)</code>, <code>tail</code>, <code>div</code> which do throw exceptions. What is the reason for making them unsafe?</p>\n"}, {"tags": ["haskell", "functional-programming", "monads", "io-monad"], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1460547088, "creation_date": 1460547088, "answer_id": 36597064, "question_id": 36596701, "link": "https://stackoverflow.com/questions/36596701/in-what-sense-is-io-monad-special-if-at-all/36597064#36597064", "title": "In what sense is IO monad special (if at all)?", "body": "<p>Similar statements could be made about the <code>ST</code> monad, or arguably the <code>STM</code> monad (although you can actually implement that one on top of <code>IO</code>).</p>\n\n<p>Basically things like the Reader monad, Error monad, Writer monad, etc., are all just pure code. The <code>ST</code> and <code>IO</code> monads are the only ones that really do impure things (state mutation, etc), so they aren't definable in pure Haskell. They have to be \"hard-wired\" into the compiler somewhere.</p>\n"}, {"comments": [{"owner": {"reputation": 10772, "user_id": 427598, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/Fq5PZ.jpg?s=128&g=1", "display_name": "Konstantin Milyutin", "link": "https://stackoverflow.com/users/427598/konstantin-milyutin"}, "edited": false, "score": 0, "creation_date": 1460552672, "post_id": 36597723, "comment_id": 60795534, "body": "when I say escape or run, I mean run* functions that allow us to execute state or reader actions. I think there is no safe run IO function. It would be nice to understand why"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 10772, "user_id": 427598, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/Fq5PZ.jpg?s=128&g=1", "display_name": "Konstantin Milyutin", "link": "https://stackoverflow.com/users/427598/konstantin-milyutin"}, "edited": false, "score": 0, "creation_date": 1460552977, "post_id": 36597723, "comment_id": 60795819, "body": "These <code>run*</code> functions do <i>not</i> \u201cexecute\u201d anything. They indeed just unwrap the internal representation. In the case of <code>IO</code>, this is not officially exported (but, as I said twice, there are alternative implementations of <code>IO</code> which boil down to a simple state monad)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 10772, "user_id": 427598, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/Fq5PZ.jpg?s=128&g=1", "display_name": "Konstantin Milyutin", "link": "https://stackoverflow.com/users/427598/konstantin-milyutin"}, "edited": false, "score": 1, "creation_date": 1460555336, "post_id": 36597723, "comment_id": 60797860, "body": "@damluar Referential transparency. With a pure function, the compiler is free to replace, for example, <code>(\\x -&gt; x * x) y</code> with <code>y * y</code>. If <code>y</code> is an impure function, though, such a transformation changes the semantics, as <code>y</code>&#39;s side effect takes place twice instead of once. Placing a function in the <code>IO</code> monad (by having it return an <code>IO</code> action) prevents you from being allowed to write unsafe code like this. You would have to write <code>y &gt;&gt;= (\\x -&gt; return (x * x))</code>, and the definition of <code>&gt;&gt;=</code> for the particular monad prevents unsafe expansion."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 10772, "user_id": 427598, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/Fq5PZ.jpg?s=128&g=1", "display_name": "Konstantin Milyutin", "link": "https://stackoverflow.com/users/427598/konstantin-milyutin"}, "edited": false, "score": 1, "creation_date": 1460555424, "post_id": 36597723, "comment_id": 60797933, "body": "@damluar The <code>IO</code> monad is special in that <code>&gt;&gt;=</code> is not implemented in Haskell code, but in the interpreter/compiler itself, because that is the only piece allowed to deal directly with the external world. (Haskell code like <code>getChar</code> remains pure by only returning a <i>promise</i> to read a character, rather than actually returning a character that could be used to &quot;infect&quot; otherwise pure code.)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1460576213, "post_id": 36597723, "comment_id": 60812716, "body": "@chepner This isn&#39;t actually true, <code>&gt;&gt;=</code> for IO is a <a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/src/GHC-Base.html\" rel=\"nofollow noreferrer\">regular function</a> (see <code>bindIO</code>). The runtime does know that <code>State# RealWorld</code> is a dummy parameter and to never e.g. allocated memory for it, and to not reorder cases on such parameters during compilation, for example. <code>IO</code> itself is really not primitive - <code>State#</code> is primtive."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460577463, "post_id": 36597723, "comment_id": 60813506, "body": "@user2407038 Nice. I had actually been looking for that (to show that <code>IO</code> is basically a state monad), but assumed it wasn&#39;t there when I couldn&#39;t find an explicit <code>data IO a = ...</code> definition."}, {"owner": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "edited": false, "score": 0, "creation_date": 1547034953, "post_id": 36597723, "comment_id": 95051205, "body": "I&#39;m confused by your <code>take 10 $ foldr (\\h t -&gt; h `seq` (h:t)) [] [0..]</code> example. It always returns <code>[0..9]</code> on my machine."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "edited": false, "score": 0, "creation_date": 1547036871, "post_id": 36597723, "comment_id": 95052390, "body": "@MateenUlhaq yeah, sure. As I wrote, that terminates just fine. The expression that doesn&#39;t terminate is <code>take 10 $ foldr (\\h t -&gt; t `seq` (h:t)) [] [0..]</code>."}, {"owner": {"reputation": 17989, "user_id": 365102, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/e3139989e6548e7deac2cd45253d60df?s=128&d=identicon&r=PG", "display_name": "Mateen Ulhaq", "link": "https://stackoverflow.com/users/365102/mateen-ulhaq"}, "edited": false, "score": 0, "creation_date": 1547037016, "post_id": 36597723, "comment_id": 95052482, "body": "Whoops missed that the <code>h</code> became a <code>t</code>"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 7, "last_activity_date": 1460553847, "last_edit_date": 1460553847, "creation_date": 1460548862, "answer_id": 36597723, "question_id": 36596701, "link": "https://stackoverflow.com/questions/36596701/in-what-sense-is-io-monad-special-if-at-all/36597723#36597723", "title": "In what sense is IO monad special (if at all)?", "body": "<blockquote>\n  <p>you cannot escape IO monad like you can with other monads</p>\n</blockquote>\n\n<p>I'm not sure what you mean by &ldquo;escape&rdquo;. If you mean, somehow unwrap the internal representation of the monadic values (e.g. list -> sequence of cons-cells) &ndash; that is an implementation detail. In fact, you can define <a href=\"http://chrisdone.com/posts/pure-io-tryhaskell\" rel=\"nofollow\">an <code>IO</code> <em>emulation</em> in pure Haskell</a> &ndash; basically just a <code>State</code> over a lot of globally-available data. That would have all the semantics of <code>IO</code>, but without actually interacting with the real world, only a simulation thereof.</p>\n\n<p>If you mean, you can &ldquo;extract values&rdquo; from within the monad &ndash; nope, that's not in general possible, even for most pure-haskell monads. For instance, you can't extract a value from <code>Maybe a</code> (could be <code>Nothing</code>) or <code>Reader b a</code> (what if <code>b</code> is uninhabited?)</p>\n\n<blockquote>\n  <p><code>IO</code> action can only be run by the <code>main</code> function</p>\n</blockquote>\n\n<p>Well, in a sense, <em>everything</em> can only be run by the <code>main</code> function. Code that's not in some way invoked from <code>main</code> will only sit there, you could replace it with <code>undefined</code> without changing anything.</p>\n\n<blockquote>\n  <p>IO is always at the bottom of a monad transformers chain</p>\n</blockquote>\n\n<p>True, but that's also the case for e.g. <code>ST</code>.</p>\n\n<blockquote>\n  <p>Implementation of <code>IO</code> monad is unclear and source code shows some Haskell internals</p>\n</blockquote>\n\n<p>Again: implementation is just, well, an implementation detail. The complexity of <code>IO</code> implementations actually has a lot to do with it being highly optimised; the same is also true for specialised pure monads (e.g. <a href=\"http://hackage.haskell.org/package/attoparsec-0.13.0.1/docs/Data-Attoparsec-Internal-Types.html#t:Parser\" rel=\"nofollow\">attoparsec</a>).</p>\n\n<p><a href=\"http://chrisdone.com/posts/pure-io-tryhaskell\" rel=\"nofollow\">As I already said</a>), much simpler implementations are possible, they just wouldn't be as useful as the full-fledged optimised real-world <code>IO</code> type.</p>\n\n<p>Fortunately, implementation needn't really bother you; the <em>inside</em> of <code>IO</code> may be unclear but the <em>outside</em>, the actual monadic interface, is pretty simple.</p>\n\n<blockquote>\n  <p>in pure code evaluation order doesn't matter</p>\n</blockquote>\n\n<p>First of all &ndash; evaluation order <em>can</em> matter in pure code!</p>\n\n<pre><code>Prelude&gt; take 10 $ foldr (\\h t -&gt; h `seq` (h:t)) [] [0..]\n[0,1,2,3,4,5,6,7,8,9]\nPrelude&gt; take 10 $ foldr (\\h t -&gt; t `seq` (h:t)) [] [0..]\n^CInterrupted.\n</code></pre>\n\n<p>But indeed you can never get a wrong, <em>non-&perp;</em> result due to misordered pure-code evaluation. That actually doesn't apply to reordering monadic actions (<code>IO</code> or otherwise) though, because changing the sequence order changes the actual <em>structure</em> of the resultant action, not just the evaluation order that the runtime will use to <em>construct</em> this structure.</p>\n\n<p>For example (list monad):</p>\n\n<pre><code>Prelude&gt; [1,2,3] &gt;&gt;= \\e -&gt; [10,20,30] &gt;&gt;= \\z -&gt; [e+z]\n[11,21,31,12,22,32,13,23,33]\nPrelude&gt; [10,20,30] &gt;&gt;= \\z -&gt; [1,2,3] &gt;&gt;= \\e -&gt; [e+z]\n[11,12,13,21,22,23,31,32,33]\n</code></pre>\n\n<hr>\n\n<p>All that said, certainly <code>IO</code> is quite special, indeed I think some people hesitate to call it a monad (it's a bit unclear what it's actually supposed to mean for <code>IO</code> to fulfill the monad laws). In particular, <em>lazy IO</em> is one massive troublemaker (and best just avoided, at all times).</p>\n"}], "owner": {"reputation": 10772, "user_id": 427598, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/Fq5PZ.jpg?s=128&g=1", "display_name": "Konstantin Milyutin", "link": "https://stackoverflow.com/users/427598/konstantin-milyutin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 404, "favorite_count": 2, "answer_count": 2, "score": 4, "last_activity_date": 1460553847, "creation_date": 1460546198, "last_edit_date": 1460547498, "question_id": 36596701, "link": "https://stackoverflow.com/questions/36596701/in-what-sense-is-io-monad-special-if-at-all", "title": "In what sense is IO monad special (if at all)?", "body": "<p>After diving into monads I understand that they are a general concept to allow chaining computations inside some context (failing, non-determinism, state, etc) and there is no magic behind them.</p>\n\n<p>Still IO monad feels even if not magic, but special. </p>\n\n<ul>\n<li>you cannot escape IO monad like you can with other monads</li>\n<li>IO action can only be run by the <code>main</code> function</li>\n<li>IO is always at the bottom of a monad transformers chain</li>\n<li>implementation of IO monad is unclear and source code shows some Haskell internals</li>\n</ul>\n\n<p>What are the reasons for the points above? What makes IO so special?</p>\n\n<p><strong>Update</strong>: in pure code evaluation order doesn't matter. But it does matter when doing IO (we want to save customer before we read it). From what I understand IO monad gives us such ordering guarantees. Is it a property of a monad in general or it is something specific to IO monad?</p>\n"}, {"tags": ["haskell", "yesod", "hamlet", "servant"], "comments": [{"owner": {"reputation": 2647, "user_id": 2141650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/68388df031850463b7bbb5a9e6034abe?s=128&d=identicon&r=PG", "display_name": "user2141650", "link": "https://stackoverflow.com/users/2141650/user2141650"}, "edited": false, "score": 1, "creation_date": 1460547025, "post_id": 36596601, "comment_id": 60790668, "body": "Can you add the compiler error you&#39;re getting?"}, {"owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "reply_to_user": {"reputation": 2647, "user_id": 2141650, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/68388df031850463b7bbb5a9e6034abe?s=128&d=identicon&r=PG", "display_name": "user2141650", "link": "https://stackoverflow.com/users/2141650/user2141650"}, "edited": false, "score": 0, "creation_date": 1460548045, "post_id": 36596601, "comment_id": 60791444, "body": "Error: Couldn&#39;t match expected type \u2018t0 -&gt; Css\u2019                 with actual type \u2018blaze-markup-0.7.0.3:Text.Blaze.Internal.MarkupM                                     a0\u2019     The lambda expression \u2018\\ _render_alwD                              -&gt; (shakespeare-2.0.8:Text.Css.CssNoWhitespace . (foldr ($) ...))                                   ...\u2019"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 5, "creation_date": 1460549602, "post_id": 36596601, "comment_id": 60792749, "body": "When will people learn that it&#39;s not a good idea to omit type signatures?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1460551538, "post_id": 36596601, "comment_id": 60794508, "body": "Well, the fact that type signature s are not needed is a selling point of Haskell. So no wonder people uses this &quot;feature&quot;"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1460553030, "post_id": 36596601, "comment_id": 60795859, "body": "@mb14 maybe the seller should add &quot;as long as you keep your hands off most of the extensions&quot; in his <i>small print</i> ;)"}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1460556040, "post_id": 36596601, "comment_id": 60798499, "body": "in the first place, those sellers should read SPJ&#39;s position paper in &quot;Masterminds of Programming&quot; about the usefulness of expressing the design by type declarations - in the source and machine-checked, as opposed to UML diagrams. There are already a lot of languages where &quot;type signatures are not needed&quot;. How can that be a selling point?"}], "answers": [{"tags": [], "owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "is_accepted": false, "score": 2, "last_activity_date": 1460702316, "creation_date": 1460702316, "answer_id": 36639879, "question_id": 36596601, "link": "https://stackoverflow.com/questions/36596601/using-licius-hamlet-julius-in-servant/36639879#36639879", "title": "Using Licius + Hamlet + Julius in Servant", "body": "<p>I was able to solve the question.\nThe following code works!</p>\n\n<pre><code>data Page_LoginHTML = Page_LoginHTML\n\ninstance H.ToMarkup Page_LoginHTML where\n    toMarkup Page_LoginHTML = builderHtml  \n\nloginHtml = return Page_LoginHTML\n\ncssStyle :: Html \ncssStyle = toHtml $ renderCssUrl undefined \n    [cassius|\n        .q-test-2 \n            color: green\n    |]\n\nhtmlBody :: Html \nhtmlBody =   \n    [shamlet|\n        &lt;h1&gt; Hamlet Login Render\n    |]\n\nbuilderHtml = H.docTypeHtml $ do\n    H.head $ do\n        H.title \"Login\"\n        H.style cssStyle\n    H.body htmlBody\n</code></pre>\n\n<p>Maybe it will be useful for somebody.</p>\n"}], "owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1460702316, "creation_date": 1460545942, "last_edit_date": 1495539961, "question_id": 36596601, "link": "https://stackoverflow.com/questions/36596601/using-licius-hamlet-julius-in-servant", "title": "Using Licius + Hamlet + Julius in Servant", "body": "<p>I would like to use Shakespearean Templates (Licius + Hamlet + Julius) from the Yesod.But I have some difficulty with this. The following code from <a href=\"https://stackoverflow.com/questions/36567481/using-servant-with-yesod-shakespeare-hamlet-julius-lucius\">enter link description here</a> works:</p>\n\n<pre><code>type TestAPI \n    = \"tests\" :&gt; Get '[JSON] [Test]\n    :&lt;|&gt; \"test\" :&gt; Get '[JSON] Test\n    :&lt;|&gt; \"TestHTML.html\" :&gt; Get '[HTML] Page_TestHTML \n\nserverTestAPI :: ServerT TestAPI AppM\nserverTestAPI = tests \n           :&lt;|&gt; test\n           :&lt;|&gt; testHtml\n\ndata Page_TestHTML = Page_TestHTML\n\ninstance ToMarkup Page_TestHTML where\n    toMarkup Page_TestHTML = builderHtml  \n\ntestHtml = return Page_TestHTML\n\nbuilderHtml = [shamlet|\n                $doctype 5\n                &lt;html&gt;\n                    &lt;head&gt;\n                        &lt;title&gt;Greeting2\n                &lt;body&gt;\n                    &lt;h2&gt; Hello world HTML Qqqqq |]\n</code></pre>\n\n<p>But next code is not working:</p>\n\n<pre><code>data Page_TestHTML_2 = Page_TestHTML_2\n\ninstance ToMarkup Page_TestHTML_2 where\n    toMarkup Page_TestHTML_2 = builderHtml_2\n\ntestHtml_2 = return Page_TestHTML_2\n\nbuilderHtml_2 = do \n    $(luciusFile \"templates/test/TestHTML2.lucius\")\n    $(shamletFile \"templates/test/TestHTML2.hamlet\")\n</code></pre>\n\n<p>How I can constructing together Licius + Hamlet + Julius for Servant (without whole Yesod)?</p>\n"}, {"tags": ["haskell", "compiler-errors", "monads"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1460544221, "post_id": 36595669, "comment_id": 60788669, "body": "<a href=\"http://stackoverflow.com/questions/31652475/defining-a-new-monad-in-haskell-raises-no-instance-for-applicative/31652592#31652592\" title=\"defining a new monad in haskell raises no instance for applicative\">stackoverflow.com/questions/31652475/&hellip;</a> Basically, the rules changed in GHC 7.10"}], "answers": [{"tags": [], "owner": {"reputation": 1235, "user_id": 3086454, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7fe13e8bdaaf213c71c5413ea1f17819?s=128&d=identicon&r=PG&f=1", "display_name": "d12frosted", "link": "https://stackoverflow.com/users/3086454/d12frosted"}, "is_accepted": true, "score": 1, "last_activity_date": 1460543760, "creation_date": 1460543760, "answer_id": 36595795, "question_id": 36595669, "link": "https://stackoverflow.com/questions/36595669/haskell-no-instance-for-applicative-m/36595795#36595795", "title": "Haskell, No instance for (Applicative M)", "body": "<p>Checkout definition of <a href=\"https://wiki.haskell.org/Typeclassopedia#Definition_3\" rel=\"nofollow\"><code>Monad</code></a>. Long story short - in order to become <code>Monad</code>, <code>M</code> must be <a href=\"https://wiki.haskell.org/Typeclassopedia#Definition_2\" rel=\"nofollow\"><code>Applicative</code></a>. Which in turns require <code>M</code> to be <a href=\"https://wiki.haskell.org/Typeclassopedia#Definition\" rel=\"nofollow\"><code>Functor</code></a>.</p>\n\n<pre><code>class Applicative m =&gt; Monad m where\nclass Functor f =&gt; Applicative f where\nclass Functor f where\n</code></pre>\n\n<p>So this is what the error says. </p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1460544639, "post_id": 36595864, "comment_id": 60788941, "body": "Can you give more details ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460547785, "post_id": 36595864, "comment_id": 60791242, "body": "You mean, explain how to define the <code>Functor</code> and <code>Applicative</code> instances for <code>M</code>? I could, but that&#39;s a good exercise to do yourself. Just look at the types. <code>fmap</code> is usually very simple to implement (in fact, the <code>-XDeriveFunctor</code> extension can do it for you), <code>pure</code> is the same as <code>return</code>. The only tricky one is <code>&lt;*&gt;</code>, but that should also be doable. (If you can&#39;t be bothered to define it yourself: you can always use <a href=\"http://hackage.haskell.org/package/base/docs/Control-Monad.html#v:ap\" rel=\"nofollow noreferrer\"><code>(&lt;*&gt;) = ap</code></a>, if the monad instance is finished already.)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 5, "last_activity_date": 1460543914, "creation_date": 1460543914, "answer_id": 36595864, "question_id": 36595669, "link": "https://stackoverflow.com/questions/36595669/haskell-no-instance-for-applicative-m/36595864#36595864", "title": "Haskell, No instance for (Applicative M)", "body": "<p>The error is exactly what it says: you neglected to give <code>M</code> an applicative instance.</p>\n\n<p>Every monad is an applicative functor. By historical accident, it was in the past not required to make this fact explicit, but this lead to all kinds of inconveniences when writing generic code. <a href=\"https://wiki.haskell.org/Functor-Applicative-Monad_Proposal\" rel=\"noreferrer\">The omission has since been fixed</a>, so now to define a <code>Monad</code> instance you must first also define <a href=\"http://hackage.haskell.org/package/base/docs/Prelude.html#t:Functor\" rel=\"noreferrer\"><code>Functor</code></a> and <a href=\"http://hackage.haskell.org/package/base/docs/Prelude.html#t:Applicative\" rel=\"noreferrer\"><code>Applicative</code></a> instances.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 672, "favorite_count": 1, "closed_date": 1460557062, "accepted_answer_id": 36595795, "answer_count": 2, "score": 0, "last_activity_date": 1460543914, "creation_date": 1460543431, "question_id": 36595669, "link": "https://stackoverflow.com/questions/36595669/haskell-no-instance-for-applicative-m", "closed_reason": "Duplicate", "title": "Haskell, No instance for (Applicative M)", "body": "<p>Look at my code. ghci told that </p>\n\n<p>No instance for (Applicative M)\n  arising from the superclasses of an instance declaration\nIn the instance declaration for \u2018Monad M\u2019</p>\n\n<p>I don't understand this error, and I don't know how to fix it. Could you help me ?</p>\n\n<pre><code>newtype M a = StOut (Stack -&gt; (a, Stack, String))\n\nunStOut (StOut f) = f\n--unStout is used to extract the emeded function from monadic capsule\n\ninstance Monad M where\n    return x = StOut (\\n -&gt; (x, n, \"\"))\n    e &gt;&gt;= f = StOut (\\n -&gt;  let     (a, n1, s1) = (unStOut e) n\n                                    (b, n2, s2) = (unStOut (f a)) n1\n                            in      (b, n2, s1++s2))\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1460541886, "post_id": 36594968, "comment_id": 60786932, "body": "It is not a syntax error for me. Which version of GHC are you using?"}], "answers": [{"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": true, "score": 0, "last_activity_date": 1460552806, "last_edit_date": 1460552806, "creation_date": 1460541995, "answer_id": 36595122, "question_id": 36594968, "link": "https://stackoverflow.com/questions/36594968/many-definions-in-let-why-error/36595122#36595122", "title": "many definions in let - why error", "body": "<p>The problem is probably not in that code snippet: lambdabot accepts <code>@letlpaste 4789689228613124096</code> just fine (which loads <a href=\"http://lpaste.net/4789689228613124096\" rel=\"nofollow\">http://lpaste.net/4789689228613124096</a> into its ghci). Try pasting the entire code file that leads to this error.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 36595122, "answer_count": 1, "score": 0, "last_activity_date": 1460552806, "creation_date": 1460541673, "question_id": 36594968, "link": "https://stackoverflow.com/questions/36594968/many-definions-in-let-why-error", "title": "many definions in let - why error", "body": "<p>look at it:</p>\n\n<pre><code>e &gt;&gt;= f = StOut (\\n -&gt;  let     (a, n1, s1) = (unStOut e) n\n                                (b, n2, s2) = (unStOut (f a)) n1\n                        in      (b, n2, s1++s2))\n</code></pre>\n\n<p>The ghci complains about:  <code>parse error on input \u2018=\u2019</code>\nHowever, for     </p>\n\n<pre><code>e &gt;&gt;= f = StOut (\\n -&gt;  let     (a, n1, s1) = (unStOut e) n\n                            in  (a, n1, s1))\n</code></pre>\n\n<p>ghci likes it :)\nWhere is the error ?</p>\n"}, {"tags": ["haskell", "list-comprehension", "ghc", "pattern-guards"], "comments": [{"owner": {"reputation": 816, "user_id": 4153209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14bd54eebccc6829e45b653c41b217bd?s=128&d=identicon&r=PG", "display_name": "Thomas Francois", "link": "https://stackoverflow.com/users/4153209/thomas-francois"}, "edited": false, "score": 0, "creation_date": 1460539063, "post_id": 36593732, "comment_id": 60784667, "body": "Is the modulo forbidden as well ?"}, {"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "reply_to_user": {"reputation": 816, "user_id": 4153209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14bd54eebccc6829e45b653c41b217bd?s=128&d=identicon&r=PG", "display_name": "Thomas Francois", "link": "https://stackoverflow.com/users/4153209/thomas-francois"}, "edited": false, "score": 0, "creation_date": 1460539176, "post_id": 36593732, "comment_id": 60784747, "body": "no it isn&#39;t. but i wanted to do it with a list-comprehension. i don&#39;t get the mistake"}, {"owner": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "edited": false, "score": 0, "creation_date": 1460562065, "post_id": 36593732, "comment_id": 60803680, "body": "<code>not . even</code> ? :-) More in the spirit of your effort so far would be <code>ungerade x = Data.Maybe.fromJust (lookup x (zip [1..] (cycle [True,False])))</code> which at least terminates for positive <code>x</code>."}, {"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "edited": false, "score": 0, "creation_date": 1460654724, "post_id": 36593732, "comment_id": 60855476, "body": "i solved it with modulo. did not think about that first but is obviously the easiest way if you do not want to use even"}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "edited": false, "score": 1, "creation_date": 1460539603, "post_id": 36594080, "comment_id": 60785101, "body": "thanks. That works! At least no error, but it is not terminating either"}, {"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "edited": false, "score": 1, "creation_date": 1460539662, "post_id": 36594080, "comment_id": 60785152, "body": "just realized.. it will search the list forever"}], "tags": [], "owner": {"reputation": 44721, "user_id": 546084, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/wMoWk.jpg?s=128&g=1", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/546084/chris-taylor"}, "is_accepted": true, "score": 4, "last_activity_date": 1460539720, "last_edit_date": 1460539720, "creation_date": 1460539515, "answer_id": 36594080, "question_id": 36593732, "link": "https://stackoverflow.com/questions/36593732/haskell-function-checking-if-number-is-odd-without-using-the-odd-function/36594080#36594080", "title": "Haskell function checking if number is odd, without using the odd function", "body": "<p>The problem is in the line</p>\n\n<pre><code>x elem oddList\n</code></pre>\n\n<p>which should either say</p>\n\n<pre><code>elem x oddList\n</code></pre>\n\n<p>since <code>elem</code> is a function <code>elem :: Eq a =&gt; a -&gt; [a] -&gt; Bool</code>, or</p>\n\n<pre><code>x `elem` oddList\n</code></pre>\n\n<p>where you are using backticks to indicate infix function application.</p>\n\n<hr>\n\n<p>Note that your function does not work as you intended. For odd numbers it will eventually return <code>True</code> (although it takes a long time for large arguments) but for even numbers it will never return, because the function cannot prove that an even number is never in the list <code>oddList</code>.</p>\n\n<p>Also note that writing</p>\n\n<pre><code>oddList = [ x | x &lt;- [1,3..] ]\n</code></pre>\n\n<p>is redundant, you could just write</p>\n\n<pre><code>oddList = [1,3..]\n</code></pre>\n\n<p>instead, and also writing</p>\n\n<pre><code>f x | x `elem` oddList = True\n    | otherwise        = False\n</code></pre>\n\n<p>is redundant, where you could just write</p>\n\n<pre><code>f x = x `elem` oddList\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>f x = x `elem` [1,3..]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>f = (`elem` [1,3..])\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1647, "favorite_count": 0, "accepted_answer_id": 36594080, "answer_count": 1, "score": 2, "last_activity_date": 1460539720, "creation_date": 1460538761, "last_edit_date": 1460539238, "question_id": 36593732, "link": "https://stackoverflow.com/questions/36593732/haskell-function-checking-if-number-is-odd-without-using-the-odd-function", "title": "Haskell function checking if number is odd, without using the odd function", "body": "<p>Can anyone help me with that? I am trying to write a function checking if an x is odd, without using the odd function.\nLike this it does not work but i don't know why.  </p>\n\n<pre><code>   ugerade :: Integral a =&gt; a -&gt; Bool\n   ugerade x\n    |x elem oddList  = True\n    |otherwise = False\n    where\n     oddList=[x | x&lt;-[1,3..]]\n</code></pre>\n\n<p>Error</p>\n\n<pre><code>    Could not deduce (Num t0) arising from the literal \u20181\u2019\nfrom the context (Integral a)\n  bound by the type signature for ugerade :: Integral a =&gt; a -&gt; Bool\n  at /Users/Mauritius/Desktop/Haskell/u02/2-2/funktionen.hs:24:11-33\nThe type variable \u2018t0\u2019 is ambiguous\nRelevant bindings include\n  oddList :: [t0]\n    (bound at /Users/Mauritius/Desktop/Haskell/u02/2-2/funktionen.hs:29:4)\nNote: there are several potential instances:\n  instance Integral a =&gt; Num (GHC.Real.Ratio a)\n    -- Defined in \u2018GHC.Real\u2019\n  instance Num Integer -- Defined in \u2018GHC.Num\u2019\n  instance Num Double -- Defined in \u2018GHC.Float\u2019\n  ...plus three others\nIn the expression: 1\nIn the expression: [1, 3 .. ]\nIn a stmt of a list comprehension: x &lt;- [1, 3 .. ]\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1460521708, "post_id": 36588501, "comment_id": 60775273, "body": "the compiler tells you: your <code>readtree</code> needs two curried arguments but you only give them 1 - as it is now you probably have to parse your input because some of your tokens have length two <code>L1</code>, <code>R2</code>, ... and some only one <code>D</code> and <code>R</code> ..."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1460527269, "creation_date": 1460527269, "answer_id": 36589831, "question_id": 36588501, "link": "https://stackoverflow.com/questions/36588501/how-to-char-list-into-a-maybe-list/36589831#36589831", "title": "how to char list into a maybe list", "body": "<p>Perhaps something like</p>\n\n<pre><code>x $: xs = (x:) &lt;$&gt; xs\n\nreadTrees ('L':'1':rest) = L1  $: readTrees rest\nreadTrees ('T':rest)     = Top $: readTrees rest\nreadTrees []             = Just []\nreadTrees _              = Nothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 0, "last_activity_date": 1460541427, "creation_date": 1460541427, "answer_id": 36594854, "question_id": 36588501, "link": "https://stackoverflow.com/questions/36588501/how-to-char-list-into-a-maybe-list/36594854#36594854", "title": "how to char list into a maybe list", "body": "<p>Perhaps something like</p>\n\n<pre><code>import Control.Monad.Trans.State\n\nreadTrees = evalStateT $ many readTree &lt;* (gets null &gt;&gt;= guard) where\n  readTree = StateT uncons &gt;&gt;= \\case\n    'L' -&gt; StateT uncons &gt;&gt;= \\case\n      '1' -&gt; return L1\n      '2' -&gt; return L2\n      _   -&gt; empty\n    'R' -&gt; StateT uncons &gt;&gt;= \\case\n      '1' -&gt; return L1\n      '2' -&gt; return L2\n      _   -&gt; empty\n    'T' -&gt; return Top\n    'D' -&gt; return Down\n    _   -&gt; empty\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6165390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad035214660d26a3b717e2d0b17f1f63?s=128&d=identicon&r=PG&f=1", "display_name": "Feng Sidong", "link": "https://stackoverflow.com/users/6165390/feng-sidong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1460541427, "creation_date": 1460521174, "question_id": 36588501, "link": "https://stackoverflow.com/questions/36588501/how-to-char-list-into-a-maybe-list", "title": "how to char list into a maybe list", "body": "<pre><code>readtree :: Char -&gt; Char -&gt; Maybe Tree\nreadtree x y = case x of\n    'L' -&gt; case y of\n        '1' -&gt; Just L1\n        '2' -&gt; Just L2\n        _   -&gt; Nothing\n    'R' -&gt; case y of\n        '1' -&gt; Just R1\n        '2' -&gt; Just R2\n        _   -&gt; Nothing\n    'T' -&gt; Just Top\n    'D' -&gt; Just Down\n    _   -&gt; Nothing\ntreelist :: String -&gt; Maybe [Tree]\ntreelist = mapM readtree\n</code></pre>\n\n<p>If I type \"L1TDR2\", I wanna it change to Just [L1,Top,Down,R2] a list.But it looks failed.</p>\n\n<pre><code>Couldn't match type \u2018Char -&gt; Maybe Tree\u2019 with \u2018Maybe Tree\u2019\nExpected type: Char -&gt; Maybe Tree\n  Actual type: Char -&gt; Char -&gt; Maybe Tree\nProbable cause: \u2018readtree\u2019 is applied to too few arguments\nIn the first argument of \u2018mapM\u2019, namely \u2018readtree\u2019\nIn the expression: mapM readtree\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1460517679, "post_id": 36587837, "comment_id": 60774235, "body": "You need KindSignatures and perhaps EmptyDataDecls."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1460517764, "post_id": 36587837, "comment_id": 60774260, "body": "trivia: EmptyDataDecls was added in Haskell 2010 so you don&#39;t need to turn it on, usually"}], "tags": [], "owner": {"reputation": 2371, "user_id": 270006, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/874bcba40024d48919097b29a25e852d?s=128&d=identicon&r=PG", "display_name": "\u0179V -", "link": "https://stackoverflow.com/users/270006/%c5%b9v"}, "is_accepted": false, "score": 3, "last_activity_date": 1460516840, "creation_date": 1460516840, "answer_id": 36587837, "question_id": 36587703, "link": "https://stackoverflow.com/questions/36587703/data-queryparam-sym-symbol-a-what-does-that-mean/36587837#36587837", "title": "data QueryParam (sym :: Symbol) a -- what does that mean?", "body": "<p>Yes, this is a data declaration without a constructor -- declarations like this indicate that the type <code>QueryParam</code> has a <em>kind</em> of type <code>Symbol</code></p>\n\n<p>It is used with information that works at a type level -- it's comparable to  <code>data QueryParam a = QueryParam Symbol a</code> but at the type level instead of the value level.</p>\n"}], "owner": {"reputation": 21726, "user_id": 1708058, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/4a0b611077fcb9f7ede011fdc46e4d4c?s=128&d=identicon&r=PG", "display_name": "Alan Coromano", "link": "https://stackoverflow.com/users/1708058/alan-coromano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460516840, "creation_date": 1460516012, "question_id": 36587703, "link": "https://stackoverflow.com/questions/36587703/data-queryparam-sym-symbol-a-what-does-that-mean", "title": "data QueryParam (sym :: Symbol) a -- what does that mean?", "body": "<p>I've seen this in Haskell code:</p>\n\n<pre><code>data QueryParam (sym :: Symbol) a\n</code></pre>\n\n<p>What does this mean? Where is a constructor? Is it valid code without any extension?</p>\n"}, {"tags": ["haskell", "polymorphism", "type-inference"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1460517711, "post_id": 36587571, "comment_id": 60774246, "body": "is <a href=\"http://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\" title=\"what is the monomorphism restriction\">stackoverflow.com/questions/32496864/&hellip;</a> what you want?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 5, "creation_date": 1460518110, "post_id": 36587571, "comment_id": 60774371, "body": "@haoformayor No, this is about <code>forall</code>, not the monomorphism restriction, I think. The inferred type for <code>foo</code> would have to be <code>(forall a . a -&gt; a) -&gt; a -&gt; b -&gt; (a, b)</code>, but AFAIK haskell never infers types with a <code>forall</code> (called rank-2 types, I think?), even with the monomorphism restriction disabled."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 1, "creation_date": 1460518611, "post_id": 36587571, "comment_id": 60774484, "body": "ah, that&#39;s the answer. ghc infers the rank-1 type <code>forall a b. (a -&gt; b) -&gt; a -&gt; a -&gt; (b, b)</code>, but you really want <code>(forall a. a -&gt; a) -&gt; a -&gt; b -&gt; (a, b)</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1460518901, "post_id": 36587571, "comment_id": 60774552, "body": "I don&#39;t really have time to flesh this out into an answer, but feel free to do so if you&#39;ve got time, @haoformayor."}], "answers": [{"comments": [{"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 3, "creation_date": 1460528207, "post_id": 36588295, "comment_id": 60777881, "body": "It&#39;s worth noting that neither of these two types is more general than the other. Each can be used in ways that the other can&#39;t. So <code>foo f a b = (f a, f b)</code> taken in isolation is ambiguous about what function is actually being defined; at the moment that ambiguity is resolved by taking the interpretation with a rank-1 type. In a hypothetical world where GHC had perfect rank-2 inference and no historical baggage preferring the rank-1 interpretation, you&#39;d likely be required to add something that pins down the choice, as that&#39;s not the kind of thing we&#39;d like a compiler to choose for you."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1460541730, "post_id": 36588295, "comment_id": 60786819, "body": "As an aside, the type <code>forall a. a -&gt; a</code> is inhabited by precisely one non-bottom value (<code>id</code>) so <code>foo&#39;</code> is essentially isomorphic to <code>(,)</code>."}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": false, "score": 10, "last_activity_date": 1460519825, "last_edit_date": 1495540789, "creation_date": 1460519825, "answer_id": 36588295, "question_id": 36587571, "link": "https://stackoverflow.com/questions/36587571/confusing-about-haskell-type-inference/36588295#36588295", "title": "Confusing about Haskell type inference", "body": "<p>All right, this is a weird spooky corner of Haskell's type system. The problem here is that there are two ways to type inference your function <code>foo</code>.</p>\n\n<pre><code>-- rank 1\nfoo :: forall a b. (a -&gt; b) -&gt; a -&gt; a -&gt; (b, b)\nfoo f a b = (f a, f b)\n\n-- rank 2\nfoo' :: (forall a. a -&gt; a) -&gt; a -&gt; b -&gt; (a, b)\nfoo' f a b = (f a, f b)\n</code></pre>\n\n<p>The second type is the one you want, but the first type is the one you're getting. The second type, as amalloy pointed out, is a rank-2 type (we're going to ignore what the two means but read the introduction in <a href=\"http://research.microsoft.com/en-us/um/people/simonpj/papers/higher-rank/putting.pdf\" rel=\"nofollow noreferrer\">\"Practical type inference for arbitrary-rank types\"</a> if you want a good explanation of ranks \u2013 don't be put off by the academic nature of the PDF file as the beginning is accessibly and clearly written).</p>\n\n<p>We'll defer the definition of higher-ranked types for now and just say that the problem is that GHC is unable to infer the rank-2 type. Quote the paper:</p>\n\n<blockquote>\n  <p>Complete type inference is known to be undecidable for higher-rank (impredicative) type systems, but in practice programmers are more than willing to add type annotations to guide the type inference engine, and to document their code....</p>\n  \n  <p>Kfoury and Wells show that typeability is decidable for rank \u2264 2, and undecidable for all ranks \u2265 3 (Kfoury &amp; Wells, 1994). For the rank-2 fragment, the same paper gives a type inference algorithm. This inference algorithm is somewhat subtle, does not interact well with user-supplied type annotations, and has not, to our knowledge, been implemented in a production compiler.</p>\n</blockquote>\n\n<p>Undecidable means there can be no algorithm that always leads to a correct yes-or-no decision. So there you have it: impossible to infer a rank-3-or-higher type, and it's too gosh-darn-hard to infer the rank-2 type.</p>\n\n<p>Now, back to rank 2. The <code>(forall a. a -&gt; a)</code> is what makes it rank-2. <a href=\"https://stackoverflow.com/questions/3071136/what-does-the-forall-keyword-in-haskell-ghc-do\">There's already an excellent Stack Overflow question about what the <code>forall</code> keyword means</a> so I'll refer you to that, but basically it means you're able to call <code>f a</code> and <code>f b</code> in the expression <code>(f a, f b)</code> while <strong>having <code>a</code> and <code>b</code> be different types</strong>, which is what you wanted in the first place, before all this hot mess.</p>\n\n<p>One last thing: The reason you don't normally see <code>forall</code>s in GHCi is that any <code>forall</code>s on the very outer scope are left off. So <code>forall a b. (a -&gt; b) -&gt; a -&gt; a -&gt; (b, b)</code> is equivalent to <code>(a -&gt; b) -&gt; a -&gt; a -&gt; (b, b)</code>.</p>\n\n<p>Overall this is a pain point of the language that's poorly explained.</p>\n\n<p>(Hat tip to @amalloy in the comments.)</p>\n"}], "owner": {"reputation": 994, "user_id": 5357260, "user_type": "registered", "accept_rate": 9, "profile_image": "https://graph.facebook.com/973030389423513/picture?type=large", "display_name": "Xiaojun Chen", "link": "https://stackoverflow.com/users/5357260/xiaojun-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1460519825, "creation_date": 1460515163, "question_id": 36587571, "link": "https://stackoverflow.com/questions/36587571/confusing-about-haskell-type-inference", "title": "Confusing about Haskell type inference", "body": "<p>I have just started learning Haskell. As Haskell is static typed and has polymorphic type inference, the type of the identity function is</p>\n\n<pre><code>id :: a -&gt; a\n</code></pre>\n\n<p>suggesting id can take any type as its parameter and return itself. It works fine when I try:</p>\n\n<pre><code>a = (id 1, id True)\n</code></pre>\n\n<p>I just suppose that at compile time, the first id is Num a :: a -> a, and the second id is Bool -> Bool. When I try the following code, it gives an error:</p>\n\n<pre><code>foo f a b = (f a, f b)\nresult = foo id 1 True\n</code></pre>\n\n<p>It shows the type of a must be the same type of b, since it works fine with</p>\n\n<pre><code>result = foo id 1 2\n</code></pre>\n\n<p>But is that true that the type of id's parameter can be polymorphic, so that a and b can be different type?</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460543071, "post_id": 36587381, "comment_id": 60787792, "body": "I&#39;m not sure how much lens would help you here. You could write this in a slightly different way - <code>node</code> will return the updated AST with the &quot;collected&quot; nodes removes, and the collected nodes are stored by e.g. a writer effect. Probably the simplest way to do this is without monads - <code>State</code> seems to quite complicate the logic of the problem - it seems you are just using state in order to return multiple values from a function."}, {"owner": {"reputation": 4387, "user_id": 2103996, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ef9ecd30591995af2cf62cde10b26e49?s=128&d=identicon&r=PG", "display_name": "wincent", "link": "https://stackoverflow.com/users/2103996/wincent"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460554573, "post_id": 36587381, "comment_id": 60797229, "body": "I (think I) also need <code>State</code> to toggle capturing on and off."}], "answers": [{"comments": [{"owner": {"reputation": 4387, "user_id": 2103996, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ef9ecd30591995af2cf62cde10b26e49?s=128&d=identicon&r=PG", "display_name": "wincent", "link": "https://stackoverflow.com/users/2103996/wincent"}, "edited": false, "score": 0, "creation_date": 1460683523, "post_id": 36612622, "comment_id": 60868366, "body": "Thanks for the very thorough answer. Lots to digest here, but it looks like this will do the trick."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 2, "last_activity_date": 1460599740, "creation_date": 1460599740, "answer_id": 36612622, "question_id": 36587381, "link": "https://stackoverflow.com/questions/36587381/how-to-use-lens-package-to-extract-arbitrary-subtrees-from-an-ast/36612622#36612622", "title": "How to use lens package to extract arbitrary subtrees from an AST", "body": "<p>Lens style uniplate lets us break down a problem working with an entire data structure into pieces that work on only one place in the data structure at a time. We will apply an operation on a single node to every node in the AST.</p>\n\n<h2>Operate on a Node</h2>\n\n<p>The operation on a single node will extracting any footers, which we'll <a href=\"http://hackage.haskell.org/package/transformers/docs/Control-Monad-Trans-Writer-Lazy.html#v:tell\" rel=\"nofollow\"><code>tell</code></a> to a <a href=\"http://hackage.haskell.org/package/transformers/docs/Control-Monad-Trans-Writer-Lazy.html#t:Writer\" rel=\"nofollow\"><code>Writer</code></a>, and <code>return</code> the modified node with the footers removed. From your question, I'm assuming you only want to remove footers from <code>DocBlock</code>; you can remove them from other nodes the same way. The other nodes will be <code>return</code>ed unmodified.</p>\n\n<pre><code>import qualified Data.DList as DList\nimport Control.Monad.Trans.Writer\n\nextractNodeFooters :: Node -&gt; Writer (DList.DList [Node]) Node\nextractNodeFooters (DocBlock nodes) = do\n    let (footers, remainder) = extractFooters nodes\n    tell (DList.fromList footers)\n    return (DocBlock remainder)\nextractNodeFooters node = return node\n</code></pre>\n\n<p>The difference list <a href=\"https://hackage.haskell.org/package/dlist/docs/Data-DList.html#t:DList\" rel=\"nofollow\"><code>DList</code></a> avoids quadratic performance accumulating the extracted footers.</p>\n\n<h3>Some boring parsing</h3>\n\n<p><code>extractFooters</code> pull out blocks starting at footers and ending at the next annotation or the end of the list. It is written in terms of extracting blocks from lists in general. This is a parsing problem; it's curious that we need to apply it to an already parsed AST.</p>\n\n<pre><code>import Control.Applicative\n\nisAnnotation :: Node -&gt; Bool\nisAnnotation x = case x of\n    PluginAnnotation _ _   -&gt; True\n    FunctionAnnotation _   -&gt; True\n    IndentAnnotation       -&gt; True\n    DedentAnnotation       -&gt; True\n    CommandAnnotation _    -&gt; True\n    FooterAnnotation       -&gt; True\n    MappingsAnnotation     -&gt; True\n    MappingAnnotation _    -&gt; True\n    OptionAnnotation _ _ _ -&gt; True\n    HeadingAnnotation _    -&gt; True\n    SubheadingAnnotation _ -&gt; True\n    otherwise              -&gt; False\n\n\nextractBlocks :: Alternative f =&gt; (a -&gt; Maybe (a -&gt; Bool)) -&gt; [a] -&gt; (f [a], [a])\nextractBlocks start = go\n    where\n        go     [] = (empty, [])\n        go (x:xs) = maybe no_extract extract (start x)\n            where\n                no_extract = (extracted, x:unextracted)\n                    where\n                        ~(extracted, unextracted) = go xs\n                extract stop = (pure (x:block) &lt;|&gt; extracted, unextracted)\n                    where\n                        ~(block, remainder) = break stop xs\n                        ~(extracted, unextracted) = go remainder\n\nextractFooters :: Alternative f =&gt; [Node] -&gt; (f [Node], [Node])\nextractFooters = extractBlocks (\\x -&gt; if (x==FooterAnnotation) then Just isAnnotation else Nothing)\n</code></pre>\n\n<h2>Operate on every node</h2>\n\n<p>We're going to operate on every node of the following AST</p>\n\n<pre><code>example = Unit [\n    Code \"Unit Code\",\n    DocBlock [\n        Code \"DocBlock Code\",\n        DocBlock [\n            Code \"DocBlock DocBlock Code\",\n            FooterAnnotation,\n            Code \"DocBlock DocBlock FooterAnnotation Code\"\n        ],\n        FooterAnnotation,\n        Code \"DocBlock FooterAnnotation Code\",\n        DocBlock [\n            Code \"DocBlock FooterAnnotation DocBlock Code\",\n            FooterAnnotation,\n            Code \"DocBlock FooterAnnotation DocBlock FooterAnnotation Code\"\n        ]\n    ],\n    FooterAnnotation,\n    Code \"Unit FooterAnnotation Code\"]\n</code></pre>\n\n<p>If we applied <code>extractNodeFooters</code> to <code>example</code> it would do nothing, because <code>extractNodeFooters</code> only changes <code>DocBlock</code> nodes and <code>example</code> is a root <code>Unit</code>.</p>\n\n<h3>Direct descendants</h3>\n\n<p>The generic <a href=\"https://hackage.haskell.org/package/lens/docs/Data-Data-Lens.html#v:uniplate\" rel=\"nofollow\"><code>uniplate</code></a> traversal derived for types with a <code>Data</code> instance applies an operation to every direct descendant of a node. It does not recursively modify the deeper descendants. If we applied <code>uniplate extractNodeFooters</code> to <code>example</code>, it should remove the footer from the outermost <code>DocBlock</code>, which is a direct descendant of the root <code>Unit</code>. It won't change any of the other <code>DocBlock</code>s. That's exactly what it does.</p>\n\n<p><code>print . uniplate extractNodeFooters $ example</code> removes only the <code>FooterAnnotation</code> in the <code>DocBlock</code> that's a descendent of <code>Unit</code></p>\n\n<pre><code>Unit [\n    Code \"Unit Code\",\n    DocBlock [\n        Code \"DocBlock Code\",\n        DocBlock [\n            Code \"DocBlock DocBlock Code\",\n            FooterAnnotation,\n            Code \"DocBlock DocBlock Footer Annotation Code\"\n        ]\n    ],\n    FooterAnnotation,\n    Code \"Unit FooterAnnotation Code\"\n]\n</code></pre>\n\n<p>It logs the one annotation it removed</p>\n\n<pre><code>[\n\n    [\n        FooterAnnotation,\n        Code \"DocBlock FooterAnnotation Code\",\n        DocBlock [\n            Code \"DocBlock FooterAnnotation DocBlock Code\",\n            FooterAnnotation,\n            Code \"DocBlock FooterAnnotation DocBlock FooterAnnotation Code\"\n        ]\n    ]\n]\n</code></pre>\n\n<h3>Deeper</h3>\n\n<p>To remove the annotations everywhere we'll have to recursively apply <code>uniplate</code> on each descendant node. We have two generic choices. We can apply our operation to a node before applying it to all the descendants or we can do it afterwards. These are called preorder or postorder traversals. When transforming data, we usually want the postorder traversal because all of the descendants will already be transformed whenever we deal with them.</p>\n\n<pre><code>import Control.Monad\n\npostorder :: Monad m =&gt; ((a -&gt; m c) -&gt; (a -&gt; m b)) -&gt; (b -&gt; m c) -&gt; (a -&gt; m c)\npostorder t f = go\n    where \n        go = t go &gt;=&gt; f\n\npreorder :: Monad m =&gt; ((a -&gt; m c) -&gt; (b -&gt; m c)) -&gt; (a -&gt; m b) -&gt; (a -&gt; m c)\npreorder t f = go\n    where \n        go = f &gt;=&gt; t go\n</code></pre>\n\n<h3>Postorder</h3>\n\n<p>The <code>postorder</code> traversal will extract all of the footers from inner nodes before extracting footers from outer nodes. This means that not only will every footer be extracted, but every footer that is inside another footer will be extracted from the footer. <code>print . postorder uniplate extractNodeFooters $ example</code> removes every footer and logs each footer separately.</p>\n\n<pre><code>Unit [\n    Code \"Unit Code\",\n    DocBlock [\n        Code \"DocBlock Code\",\n        DocBlock [\n            Code \"DocBlock DocBlock Code\"\n        ]\n    ],\n    FooterAnnotation,\n    Code \"Unit FooterAnnotation Code\"\n]\n</code></pre>\n\n<p>None of the three logged footers contain footers.</p>\n\n<pre><code>[\n    [FooterAnnotation,Code \"DocBlock DocBlock FooterAnnotation Code\"],\n    [FooterAnnotation,Code \"DocBlock FooterAnnotation DocBlock FooterAnnotation Code\"],\n    [\n        FooterAnnotation,\n        Code \"DocBlock FooterAnnotation Code\",\n        DocBlock [\n            Code \"DocBlock FooterAnnotation DocBlock Code\"\n        ]\n    ]\n]\n</code></pre>\n\n<h3>Preorder</h3>\n\n<p>The <code>preorder</code> traversal will extract all of the footers from outer nodes before extracting footers from inner nodes. This means that every footer will be extracted intact. <code>print . preorder uniplate extractNodeFooters $ example</code> removes every footer and logs it intact. The resulting AST is the same as for the postorder traversal; all of the footers have been removed from <code>DocBlock</code>s.</p>\n\n<pre><code>Unit [\n    Code \"Unit Code\",\n    DocBlock [\n        Code \"DocBlock Code\",\n        DocBlock [\n            Code \"DocBlock DocBlock Code\"\n        ]\n    ],\n    FooterAnnotation,\n    Code \"Unit FooterAnnotation Code\"\n]\n</code></pre>\n\n<p>One of the two logged footers contains another footer which wasn't extracted and logged separately.</p>\n\n<pre><code>[\n    [\n        FooterAnnotation,\n        Code \"DocBlock FooterAnnotation Code\",\n        DocBlock [\n            Code \"DocBlock FooterAnnotation DocBlock Code\",\n            FooterAnnotation,\n            Code \"DocBlock FooterAnnotation DocBlock FooterAnnotation Code\"\n        ]\n    ],\n    [FooterAnnotation, Code \"DocBlock DocBlock FooterAnnotation Code\"]\n]\n</code></pre>\n"}], "owner": {"reputation": 4387, "user_id": 2103996, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ef9ecd30591995af2cf62cde10b26e49?s=128&d=identicon&r=PG", "display_name": "wincent", "link": "https://stackoverflow.com/users/2103996/wincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 2, "accepted_answer_id": 36612622, "answer_count": 1, "score": 3, "last_activity_date": 1460599740, "creation_date": 1460513914, "question_id": 36587381, "link": "https://stackoverflow.com/questions/36587381/how-to-use-lens-package-to-extract-arbitrary-subtrees-from-an-ast", "title": "How to use lens package to extract arbitrary subtrees from an AST", "body": "<p>I'm exploring the use of <a href=\"https://hackage.haskell.org/package/lens-4.13.2.1\" rel=\"nofollow\">the lens package</a> for the purposes of analyzing and transforming <a href=\"https://github.com/wincent/docvim/blob/70c21fb69aa5c06571f7e47a144d2d976e63e094/lib/Docvim/AST.hs#L14-L66\" rel=\"nofollow\">this AST</a>, but I am unsure of whether it is a good fit for this task. I think it could be, but its surface area is so large and dense that I can't tell.</p>\n\n<p>A representative operation I want to do is the following. Given an AST, I want to extract \"footer\" sections from the tree:</p>\n\n<ul>\n<li>Traverse it looking for <code>FooterAnnotation</code> nodes.</li>\n<li>Once I find such a node, accumulate all of the following nodes into a list, up until the end of a <code>DocBlock</code> or any other <code>Annotation</code> node.</li>\n<li>Ideally at the end of this, I have not only extracted those nodes into a list, but I've also pruned them out of the original AST, so I can pass whatever is left on to the next phase.</li>\n</ul>\n\n<p>At the moment I have <a href=\"https://github.com/wincent/docvim/blob/70c21fb69aa5c06571f7e47a144d2d976e63e094/lib/Docvim/Visitor/Footer.hs\" rel=\"nofollow\">this code</a> which does part of the job. Here's the meat of it:</p>\n\n<pre><code>node :: Node -&gt; Env\nnode n = case n of\n  CommandAnnotation _  -&gt; stop\n  DocBlock d           -&gt; do\n    (_, acc)           &lt;- get\n    ns                 &lt;- nodes d\n    put (False, acc)   -- Make sure we reset state on exiting docblock.\n    return $ acc ++ ns\n  FooterAnnotation     -&gt; start\n  MappingAnnotation _  -&gt; stop\n  MappingsAnnotation   -&gt; stop\n  OptionAnnotation {}  -&gt; stop\n  PluginAnnotation {}  -&gt; stop\n  Unit u               -&gt; nodes u\n  _                    -&gt; do\n    (capture, acc)     &lt;- get\n    return $ if capture\n             then acc ++ [n]\n             else acc\n</code></pre>\n\n<p>What this is doing is traversing the AST, and using the State monad to indicate whether or not I am capturing \"footer\" nodes. I turn capturing on and off with those <code>start</code> and <code>stop</code> functions, which just update the state. When capturing, I accumulate every node into the list.</p>\n\n<p>So, this works, but I notably am <em>not</em> modifying the original AST in any way, and this is where I think the lens package could come in handy, given that it provides <a href=\"https://hackage.haskell.org/package/lens-4.13.2.1/docs/Control-Lens-Operators.html\" rel=\"nofollow\">a bunch of operators</a>, some of which are explicitly designed to work with the State monad. However, with my limited fu, I am finding the documentation a bit inaccessible and am not sure where to start.</p>\n\n<p>Additionally, I haven't been able to find any examples of using the lens library to remove elements from a structure. A traversal, for example, <a href=\"https://hackage.haskell.org/package/lens-4.13.2.1/docs/Control-Lens-Traversal.html\" rel=\"nofollow\">should</a> \"leave the same number of elements as a candidate for subsequent Traversal that it started with\", so I am wondering if I need to replace \"pruned\" nodes with a new AST <code>Empty</code> node that just fills in the gap where they were. Is this right?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 56, "user_id": 5864821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ROlt.png?s=128&g=1", "display_name": "SANK", "link": "https://stackoverflow.com/users/5864821/sank"}, "edited": false, "score": 0, "creation_date": 1460506184, "post_id": 36585863, "comment_id": 60771297, "body": "take a look at the haskell wiki (<a href=\"https://wiki.haskell.org/State_Monad\" rel=\"nofollow noreferrer\">wiki.haskell.org/State_Monad</a>) as it explains how to construct your own state monad."}], "answers": [{"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 6, "last_activity_date": 1460511046, "creation_date": 1460511046, "answer_id": 36586976, "question_id": 36585863, "link": "https://stackoverflow.com/questions/36585863/state-monad-and-put-function-in-haskell/36586976#36586976", "title": "State Monad and &#39;put&#39; function in Haskell", "body": "<p>The easiest way to understand the state monad, I think, is just to write your own and play around with it a bit.  Study this code, play with other people's examples, and come back and review it from time to time until you're able to write it from memory:</p>\n\n<pre><code>-- | 'State' is just a newtype wrapper around the type @s -&gt; (a, s)@.\n-- These are functions which are fed a state value (type @s@) as input,\n-- and produce as a pair of an @a@ (the *result* of the state action)\n-- and an @s@ (the *new state* after the action).\n--\n-- The 'State' type is fundamentally a shortcut for chaining functions\n-- of types like that.\nnewtype State s a = State { runState :: s -&gt; (a, s) }\n\ninstance Functor (State s) where\n  fmap f (State g) = State $ \\s0 -&gt; \n      let (a, s1) = g s \n      in (f a, s1)\n\ninstance Applicative (State s) where\n  pure a = State $ \\s -&gt; (a, s)\n  State ff &lt;*&gt; State fa = State $ \\s0 -&gt; \n      let (s1, f) = ff s0\n          (s2, a) = fa s1\n      in (s2, f a)\n\ninstance Monad (State s) where\n  return = pure\n  State fa &gt;&gt;= f = State $ \\s0 -&gt;\n      let (s1, a) = fa s0\n          (s2, b) = runState (f a) s1\n      in (s2, b)\n\n-- | 'get' is just a wrapper around a function that takes the \n-- incoming @s@ value and exposes it in the position where @a@ \n-- normally goes.\nget :: State s s\nget = State $ \\s -&gt; (s, s)\n\n-- | 'put' is a wrapper around a function that discards the\n-- the incoming @s@ value and replaces it with another.\nput :: s -&gt; State s ()\nput s = State $ \\_ -&gt; ((), s)\n</code></pre>\n\n<p>This is written directly in terms of a <code>State</code> type without using the <code>MonadState</code> class, which is a bit simpler to understand at first.  As an exercise, once you feel comfortable with this, you can try writing it with the <code>MonadState</code> class.</p>\n\n<blockquote>\n  <p>And the second issue: Why returned value is <code>m ()</code> and not <code>m s</code>?</p>\n</blockquote>\n\n<p>It's mostly an arbitrary design choice, as far as I can tell.  If I were designing the <code>State</code> type I might have written <code>get</code> and <code>put</code> like this, which is more similar to your expectation:</p>\n\n<pre><code>-- | Modify the incoming state by applying the given function to it.\n-- Produces the previous, now discarded state as a result, which is \n-- often useful.\nmodify :: (s -&gt; s) -&gt; State s s\nmodify f = State $ \\s0 -&gt; (s, f s)\n\n-- Now 'get' and 'put' can be written in terms of 'modify':\n\nget :: State s s\nget = modify (\\s -&gt; s)\n\n-- | This version of 'put' returns the original, discarded state,\n-- which again is often useful.\nput :: s -&gt; State s s\nput s = modify (\\_ -&gt; s)\n</code></pre>\n\n<p>If you have the standard 'get' and 'put' you can use that to write my modified 'put' as well:</p>\n\n<pre><code>-- | 'get' the incoming state, 'put' a new one in, and 'return' the old one.\nreplace :: s -&gt; State s s\nreplace s1 = do\n  s0 &lt;- get\n  put s1\n  return s0\n</code></pre>\n\n<p>So it doesn't make a big difference whether <code>put</code> produces <code>()</code> or <code>s</code>, anyway.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 1, "accepted_answer_id": 36586976, "answer_count": 1, "score": 2, "last_activity_date": 1520481394, "creation_date": 1460503605, "last_edit_date": 1592644375, "question_id": 36585863, "link": "https://stackoverflow.com/questions/36585863/state-monad-and-put-function-in-haskell", "title": "State Monad and &#39;put&#39; function in Haskell", "body": "<p><a href=\"https://hackage.haskell.org/package/mtl-2.2.2/docs/Control-Monad-State-Lazy.html#v:put\" rel=\"nofollow noreferrer\">The Documentation about the State Monad</a> says:</p>\n<blockquote>\n<pre><code>put :: s -&gt; m ()\n</code></pre>\n<p>Replace the state inside the monad.</p>\n</blockquote>\n<p>I cannot understand that. Does it mean that function replace state <strong>inside</strong> Monad? And The second issue: Why returned value is <code>m ()</code> and not <code>m s</code></p>\n"}, {"tags": ["haskell", "ghc", "atom-editor", "cabal"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1460499153, "post_id": 36584033, "comment_id": 60768840, "body": "Try setting up a stack project. For ghc-mod to work you need either a cabal project or a stack project (and then place your source code inside the project). ghc-mod requires the project metadata to find and then check your code. It&#39;s kind of a hassle. For my money I think it&#39;s easier to get started with stack. Documentation here: <a href=\"http://docs.haskellstack.org/en/stable/README/#quick-start-guide\" rel=\"nofollow noreferrer\">docs.haskellstack.org/en/stable/README/#quick-start-guide</a> / And if you&#39;re just writing a single Haskell file I find that hlint and ghci are Good Enough.\u2122"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 3, "creation_date": 1460509291, "post_id": 36584033, "comment_id": 60772095, "body": "Try doing <code>cabal init</code> on your root source directory and then try again."}, {"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "edited": false, "score": 0, "creation_date": 1460537346, "post_id": 36584033, "comment_id": 60783455, "body": "i will try both. Thanks for response"}], "owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2662, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484838646, "creation_date": 1460495162, "last_edit_date": 1484838646, "question_id": 36584033, "link": "https://stackoverflow.com/questions/36584033/no-cabal-file-found-haskell-in-atom", "title": "No cabal file found - Haskell in Atom", "body": "<p>I installed Haskell ghc-mod and all the other haskell packages in atom and had some problems with the paths and so on.</p>\n\n<p>Now this seems all to work okay,  but I get the message: \"no cabal file found\" as an error in the toggle panel.</p>\n\n<p><a href=\"https://i.stack.imgur.com/wOxTW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wOxTW.png\" alt=\"Screenshot showing error message\"></a></p>\n\n<p>Does anyone know how to solve that? I don't get what cabal is at all and why my haskell in atom is still not working fine.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1460495855, "post_id": 36584027, "comment_id": 60767308, "body": "You have too many commas in the sample value: <code>G [[RGB 50 50 50, RGB 100 200 200], [RGB 75 75 75, RGB 80 80 80]]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 2836840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9572e2102bad38bfc2426c50f6beda30?s=128&d=identicon&r=PG&f=1", "display_name": "bfergs", "link": "https://stackoverflow.com/users/2836840/bfergs"}, "edited": false, "score": 0, "creation_date": 1460514443, "post_id": 36584178, "comment_id": 60773440, "body": "Thank you! this worked great!"}], "tags": [], "owner": {"reputation": 1858, "user_id": 1352240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5650ebc3479d59a5266767a26b0e6649?s=128&d=identicon&r=PG", "display_name": "YuriAlbuquerque", "link": "https://stackoverflow.com/users/1352240/yurialbuquerque"}, "is_accepted": false, "score": 2, "last_activity_date": 1460495704, "creation_date": 1460495704, "answer_id": 36584178, "question_id": 36584027, "link": "https://stackoverflow.com/questions/36584027/haskell-double-array-pattern-matching/36584178#36584178", "title": "Haskell double array pattern matching", "body": "<p>What you want is</p>\n\n<pre><code>returnFirstRed (G ((RGB x _ _):_):_)) = x\n</code></pre>\n\n<p>Notice that the x is the first element inside the RGB, which is the head of a list, which is the head of another list, which is the only element inside the G.</p>\n\n<p>You could, of course, NOT use pattern matching at all, or use some pattern matching, or any intermediate between those. An example of that in practice would be:</p>\n\n<pre><code>returnFirstRed (G x) = extractFromRGB $ head $ head x\n  where extractFromRGB (RGB y _ _) = y\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1460498446, "post_id": 36584247, "comment_id": 60768560, "body": "<code>head</code> is not quite as bad as <code>!!0</code>, but it should still be avoided."}, {"owner": {"reputation": 39, "user_id": 2836840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9572e2102bad38bfc2426c50f6beda30?s=128&d=identicon&r=PG&f=1", "display_name": "bfergs", "link": "https://stackoverflow.com/users/2836840/bfergs"}, "edited": false, "score": 0, "creation_date": 1460513993, "post_id": 36584247, "comment_id": 60773340, "body": "Thank you so much for your help! This worked perfectly!"}], "tags": [], "owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "is_accepted": false, "score": 7, "last_activity_date": 1460495945, "creation_date": 1460495945, "answer_id": 36584247, "question_id": 36584027, "link": "https://stackoverflow.com/questions/36584027/haskell-double-array-pattern-matching/36584247#36584247", "title": "Haskell double array pattern matching", "body": "<p>You can pattern match all the way down without using <code>head</code> or <code>!! 0</code> (of which <code>head</code> is considered much nicer btw). <code>[1,2,3]</code> is syntactic sugar for <code>1:2:3:[]</code> (try it in <code>ghci</code>) so you can match the head of the list with <code>x:rest</code> and if you don't need the rest, just <code>x:_</code>.</p>\n\n<p>But what do you return for <code>returnFirstRed (G [[]])</code>, i.e. if the input list is empty? I'd propose returning a <code>Maybe</code> instead, so you can return <code>Nothing</code> for the input of the empty list.</p>\n\n<pre><code>returnFirstRed :: Grid RGB -&gt; Maybe Int\nreturnFirstRed (G (((RGB r _ _):_):_)) = Just r\nreturnFirstRed _ = Nothing\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 2836840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9572e2102bad38bfc2426c50f6beda30?s=128&d=identicon&r=PG&f=1", "display_name": "bfergs", "link": "https://stackoverflow.com/users/2836840/bfergs"}, "edited": false, "score": 0, "creation_date": 1460514326, "post_id": 36584325, "comment_id": 60773409, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1460496220, "creation_date": 1460496220, "answer_id": 36584325, "question_id": 36584027, "link": "https://stackoverflow.com/questions/36584027/haskell-double-array-pattern-matching/36584325#36584325", "title": "Haskell double array pattern matching", "body": "<p>The smallest change to make to get your code working is to pattern match on the extracted <code>RGB</code> value.</p>\n\n<pre><code>returnFirstRed (G xs) = let RGB x _ _ = (head xs) !! 0 in x\n</code></pre>\n\n<p>Note that <code>head xs</code> is the same as <code>xs !! 0</code>, if you want to write that more uniformly:</p>\n\n<pre><code>returnFirstRed (G xs) = let RGB x _ _ = xs !! 0 !! 0 in x\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 2836840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9572e2102bad38bfc2426c50f6beda30?s=128&d=identicon&r=PG&f=1", "display_name": "bfergs", "link": "https://stackoverflow.com/users/2836840/bfergs"}, "edited": false, "score": 0, "creation_date": 1460514414, "post_id": 36584415, "comment_id": 60773431, "body": "Thank you so much for the help!"}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1460496593, "creation_date": 1460496593, "answer_id": 36584415, "question_id": 36584027, "link": "https://stackoverflow.com/questions/36584027/haskell-double-array-pattern-matching/36584415#36584415", "title": "Haskell double array pattern matching", "body": "<p>define your accessor methods</p>\n\n<pre><code>red,green,blue :: RGB -&gt; Int\nred (RGB r _ _) = r\ngreen (RGB _ g _) = g\nblue (RGB _ _ b) = b\n\nfirst :: Grid a -&gt; [a]\nfirst (G as) = head as\n</code></pre>\n\n<p>now you can write</p>\n\n<pre><code>&gt; grid = G [[RGB 50 50 50, RGB 100 200 200], [RGB 75 75 75, RGB 80 80 80]]\n\n&gt; red $ head $ first grid\n50\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 2836840, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9572e2102bad38bfc2426c50f6beda30?s=128&d=identicon&r=PG&f=1", "display_name": "bfergs", "link": "https://stackoverflow.com/users/2836840/bfergs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 413, "favorite_count": 0, "closed_date": 1460524648, "answer_count": 4, "score": 0, "last_activity_date": 1460496593, "creation_date": 1460495121, "question_id": 36584027, "link": "https://stackoverflow.com/questions/36584027/haskell-double-array-pattern-matching", "closed_reason": "Not suitable for this site", "title": "Haskell double array pattern matching", "body": "<p>I have a these datatypes </p>\n\n<pre><code>data RGB = RGB Int Int Int \n\ndata Grid a = G [[a]] \n</code></pre>\n\n<p>and a function</p>\n\n<pre><code>returnFirstRed :: Grid RGB -&gt; Int\n</code></pre>\n\n<p>So basically, the function returns the first color value from a double array of RGB values.</p>\n\n<p>A grid RGB looks like</p>\n\n<pre><code> G[[RGB 50, 50, 50, RGB 100,200, 200],\n   [RGB, 75,75,75, RGB 80,80,80]]\n</code></pre>\n\n<p>So for this grid, I would want to return 50. </p>\n\n<p>My problem is pattern matching and extracting the RGB values out of the Grid.</p>\n\n<p>Doing </p>\n\n<pre><code>returnFirstRed (G xs) = (head xs) !! 0 \n</code></pre>\n\n<p>results in an RGB Value rather than an int</p>\n\n<p>I've tried a lot of different ways to get the r value but I can't get it to work and I can't find a similar example online anywhere. I'm trying to learn Haskell and pretty lost on what to do here.. </p>\n"}, {"tags": ["haskell", "chess", "function-composition", "dot-operator"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6195498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2bd60699562119198bb2bd0ef0329d6?s=128&d=identicon&r=PG&f=1", "display_name": "SnDnFn", "link": "https://stackoverflow.com/users/6195498/sndnfn"}, "edited": false, "score": 0, "creation_date": 1460499758, "post_id": 36584860, "comment_id": 60769095, "body": "thanks 9000. my focus is on the &quot;immutable&quot; knightProblem = kSelector . kFilter . kGenerator chain equation. I only &quot;solved&quot; the problem by introducing compound datatypes so that every component function has only one argument, like kGenerator :: Job -&gt; ..., but that&#39;s a different problem and not the specified one :)"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "reply_to_user": {"reputation": 1, "user_id": 6195498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2bd60699562119198bb2bd0ef0329d6?s=128&d=identicon&r=PG&f=1", "display_name": "SnDnFn", "link": "https://stackoverflow.com/users/6195498/sndnfn"}, "edited": false, "score": 0, "creation_date": 1460515646, "post_id": 36584860, "comment_id": 60773715, "body": "If you need, you can pass an argument &quot;through&quot; a function without changing it. For instance, <code>kFilter</code> can accept a tuple <code>(Position, [Moves])</code> and return <code>(Position, [Moves])</code>, just passing the position to <code>kSelector</code> which needs it."}], "tags": [], "owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "is_accepted": false, "score": 1, "last_activity_date": 1460498584, "creation_date": 1460498584, "answer_id": 36584860, "question_id": 36583962, "link": "https://stackoverflow.com/questions/36583962/haskell-chess-knight-tour-function-composition/36584860#36584860", "title": "haskell Chess Knight Tour: Function composition", "body": "<p>Try writing down type signatures for the other functions.</p>\n\n<pre><code>-- kSelector: keep all moves which terminate at TargetPos\n-- something like\nkSelector :: Position -&gt; [Moves] -&gt; [Moves]\n\n-- kFilter: remove all moves which contain invalid positions\n-- something like\nkFilter :: [Moves] -&gt; [Moves]\n</code></pre>\n\n<p>So it looks like <code>kGenerator</code> should provide <code>kFilter</code> with <code>[Moves]</code>:</p>\n\n<pre><code>kGenerator :: Position -&gt; [Moves]\n</code></pre>\n\n<p>Think about what <code>[Moves]</code> are; this is likely something like <code>[[Position]]</code>, a list of position lists representing the chain of moves.</p>\n\n<p>An obvious way to generate moves from a given position would be doing the 8 possible moves, and then recursively generating more moves from each of these positions.</p>\n\n<p>Hopefully this will help you get through your assignment :)</p>\n"}], "owner": {"reputation": 1, "user_id": 6195498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2bd60699562119198bb2bd0ef0329d6?s=128&d=identicon&r=PG&f=1", "display_name": "SnDnFn", "link": "https://stackoverflow.com/users/6195498/sndnfn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 0, "closed_date": 1461426166, "answer_count": 1, "score": -3, "last_activity_date": 1460498584, "creation_date": 1460494887, "question_id": 36583962, "link": "https://stackoverflow.com/questions/36583962/haskell-chess-knight-tour-function-composition", "closed_reason": "Needs more focus", "title": "haskell Chess Knight Tour: Function composition", "body": "<p>I've a hard time understanding a Chess Knight problem concerning\nfunction composition. The exercise is a generator/filter/selector \nchain with a given wrapper function (knightProblem) which glues everything together.</p>\n\n<p>It is unclear to me how the function kGenerator as the first piece in the chain should handle multiple parameters:</p>\n\n<pre>\n<code>\n-- Chess Knight Problem: Generate all Knight moves of length NrMoves\n-- that end at the target position\nknightProblem :: StartPos -> NrMoves -> TargetPos -> [Moves]\nknightProblem =  kSelector . kFilter . kGenerator \n\n-- kGenerator: needs StartPos, NrMoves, generates all sequences of length NrMoves\n-- kFilter: remove all moves which contain invalid positions\n-- kSelector: keep all moves which terminate at TargetPos\n\nkGenerator :: ???\n???\n\n</code>\n</pre>\n\n<p>I'm looking for hints on how to handle this kind of problems.</p>\n\n<p>Best regards.</p>\n"}, {"tags": ["function", "haskell", "greatest-common-divisor"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5606469, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/833416456756499/picture?type=large", "display_name": "Nikolay Ivanov", "link": "https://stackoverflow.com/users/5606469/nikolay-ivanov"}, "edited": false, "score": 0, "creation_date": 1460492906, "post_id": 36583247, "comment_id": 60765785, "body": "Oh, I see! I tried it and it turned out that it is already in it. However, I corrected a mistake of yours, before where --&gt; combine n m = (x1, y1, gcdx n m) gcd** . Anyway, Haskell is an unusual language and I do not know its libraries yet. Thanks for the fast response, explanation and help! P.S [Idk why I get -3 rate already] :D"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1460494696, "post_id": 36583247, "comment_id": 60766716, "body": "You can also use <code>(q, r) = divMod n m</code>."}], "tags": [], "owner": {"reputation": 1825, "user_id": 2671214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v464b.jpg?s=128&g=1", "display_name": "Tomasz Lewowski", "link": "https://stackoverflow.com/users/2671214/tomasz-lewowski"}, "is_accepted": true, "score": 0, "last_activity_date": 1460492993, "last_edit_date": 1460492993, "creation_date": 1460492220, "answer_id": 36583247, "question_id": 36582754, "link": "https://stackoverflow.com/questions/36582754/implementing-extended-euclidean-algorithm/36583247#36583247", "title": "Implementing Extended Euclidean algorithm", "body": "<p>I think you might be looking for something like this:</p>\n\n<pre><code>combine :: Int -&gt;Int -&gt; (Int,Int,Int)\ncombine n m = (x1, y1, gcd n m) where\n  (x1, y1) = gcdext n m\n\ngcdext :: Int -&gt; Int -&gt; (Int, Int)\ngcdext n m = gcdexthelper n m 1 0 0 1 where\n  gcdexthelper n m x1 y1 x2 y2 \n   | m == 0 = (x1, y1)\n   | otherwise = gcdexthelper m r x1p y1p x2p y2p where\n     q = div n m\n     r = mod n m\n     x1p = x2\n     y1p = y2\n     x2p = x1 - q * x2\n     y2p = y1 - q * y2\n</code></pre>\n\n<p>You can of course implement the same with a <code>while</code> loop, but I believe recursion is much more readable in Haskell, so I used it here.</p>\n\n<p>And by the way, GCD is a standard library function in Haskell, so no need to write your own.</p>\n"}], "owner": {"reputation": 3, "user_id": 5606469, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/833416456756499/picture?type=large", "display_name": "Nikolay Ivanov", "link": "https://stackoverflow.com/users/5606469/nikolay-ivanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 1, "accepted_answer_id": 36583247, "answer_count": 1, "score": -4, "last_activity_date": 1460492993, "creation_date": 1460490463, "last_edit_date": 1460491079, "question_id": 36582754, "link": "https://stackoverflow.com/questions/36582754/implementing-extended-euclidean-algorithm", "title": "Implementing Extended Euclidean algorithm", "body": "<p>I want to make a function combine which given two integers n and m, returns a triple of integers\n(a, b, gcd(n, m)) such that:\nam + bn = gcd(n, m)\nShould not assume that the integers will always be positive.</p>\n\n<pre><code> gcd :: Int -&gt; Int -&gt; Int\n gcd n m \n | n == m  = n\n | n &gt; m = gcd (n-m) m\n | n &lt; m  = gcd n (m-n)\n\n combine :: Int -&gt;Int -&gt; (Int,Int,Int)\n x1=1; y1=0; x2=0; y2=1\n while ( m /=0 ) \n (    q=div n m ; r=mod n m ; n=m ; m=r\n     t=x2 ; x2=x1-q*x2 ; x1=t\n     t=y2 ; y2=y1-q*y2 ; y1=t    )\n combine n m = (x1,y1,gcd(n,m))\n</code></pre>\n\n<p>You will find a screen capture picture link. Click me---> ![link] <a href=\"http://prikachi.com/images.php?images/238/8749238o.png\" rel=\"nofollow\">http://prikachi.com/images.php?images/238/8749238o.png</a> Please if someone have a solution and have idea what I could replace to create the function, would be much appreciated. \nTest for the function:  combine 3 2  should give this result => (1,-1,1)</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "state-monad"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1460485239, "post_id": 36580945, "comment_id": 60761206, "body": "I don&#39;t see why you need to alter <code>play</code>. Whatever calls <code>parseFromFile</code> should be deciding, based on that result, whether or not to call <code>play</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4424299"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460485381, "post_id": 36580945, "comment_id": 60761295, "body": "@chepner Ok, but how can I call play with the <code>[[String]]</code> instead of the <code>IO (Either ParseError [[String]])</code>? I don&#39;t have access to the <code>[[String]]</code> rightaway."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1460487244, "post_id": 36580945, "comment_id": 60762384, "body": "You can use <code>lift :: IO (Either ParseError [[String]]) -&gt; StateT GameState IO (Either ...)</code> and then use monadic bind (<code>&gt;&gt;=</code> or inside a <code>do</code> block) on this value. You will still need to deal with the <code>ParseError</code> - perhaps throwing an exception or changing your monad to <code>StateT GameState (ErrorT SomeErrorType IO)</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4424299"}, "edited": false, "score": 0, "creation_date": 1460538113, "post_id": 36583527, "comment_id": 60784002, "body": "Thank you very much! This works as expected :) The input is used in another function that I didn&#39;t include in this implementation of play ;)"}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": true, "score": 3, "last_activity_date": 1460538307, "last_edit_date": 1460538307, "creation_date": 1460493202, "answer_id": 36583527, "question_id": 36580945, "link": "https://stackoverflow.com/questions/36580945/how-to-properly-use-the-statet-monad-here/36583527#36583527", "title": "How to properly use the StateT monad here?", "body": "<p>The caller should be handling that.</p>\n\n<pre><code>main :: IO ()\nmain = do\n  parsed &lt;- parseFromFileStuff\n  case parsed of\n    Left parseerror -&gt; handleErrorStuff\n    Right input -&gt; evalStateT (play input) initialState\n</code></pre>\n\n<p>By the way, you never actually return a score, so the return type of <code>play</code> should be <code>Void</code>, not <code>Score</code>. Also you should tighten that recursion by removing <code>play</code>s last line, changing its return type to <code>()</code>, and replacing <code>play input</code> by <code>forever (play input)</code>. Oh and you never use the input.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4424299"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 36583527, "answer_count": 1, "score": 1, "last_activity_date": 1460538307, "creation_date": 1460484531, "question_id": 36580945, "link": "https://stackoverflow.com/questions/36580945/how-to-properly-use-the-statet-monad-here", "title": "How to properly use the StateT monad here?", "body": "<p>I'm have to make a very small game in Haskell for a course I follow. So I created the play-function, but now I have trouble changing it's type signature.</p>\n\n<pre><code>play :: [[String]] -&gt; StateT GameState IO Score\nplay input = \ndo \n    liftIO $ clearScreen\n    (answered, correct) &lt;- get\n    if True\n    then\n        do\n            liftIO $ putStrLn \"Well done! Your answer was correct!\"\n            liftIO $ putStrLn (\"So far, you answered \" ++ (show answered) ++ \" questions\")\n            put (answered + 1, correct + 1)\n            liftIO $\n                do\n                    temp &lt;- getLine\n                    putStrLn temp\n    else\n        do\n            liftIO $ putStrLn \"I'm sorry, you're wrong...\"\n            put (answered + 1, correct)\n    play input\n</code></pre>\n\n<p>Now, please don't mind the if True statement, that's just for testing. Now this function works, but I have to make it work with another type signature to. The type signature of the function play should be:</p>\n\n<pre><code>play :: IO (Either ParseError [[String]]) -&gt; StateT GameState IO Score\n</code></pre>\n\n<p>But I have absolutely no idea on how to use my <code>StateT</code> monad then? How can I do this? The IO <code>(Either ParseError [[String]])</code> monad is a result of the parseFromFile-function from the missingH-package.</p>\n"}, {"tags": ["list", "sorting", "haskell", "indexing"], "answers": [{"comments": [{"owner": {"reputation": 2802, "user_id": 3334375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7ea497db44ae233839e211fdcf141f10?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/3334375/david"}, "edited": false, "score": 0, "creation_date": 1460484867, "post_id": 36580938, "comment_id": 60761000, "body": "Thanks for your answer but what is <code>Prelude</code> after implementing it in my code I get Not in scope: data constructor <code>Prelute</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1460485408, "post_id": 36580938, "comment_id": 60761312, "body": "<code>Prelude&gt;</code> is just the prompt from the interactive interpreter, not part of the code."}, {"owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "edited": false, "score": 0, "creation_date": 1460488884, "post_id": 36580938, "comment_id": 60763350, "body": "Hi Dave, sorry if the <code>Prelude&gt;</code> part was confusing, I just wrote it quickly in <code>ghci</code> and copy pasted from the terminal."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 3, "creation_date": 1460490281, "post_id": 36580938, "comment_id": 60764179, "body": "Note that this is String sorting and may not be accurate for numbers.  For example  <code>sort [&quot;1&quot;,&quot;2&quot;,&quot;11&quot;]</code> will give <code>[&quot;1&quot;,&quot;11&quot;,&quot;2&quot;]</code>"}], "tags": [], "owner": {"reputation": 34030, "user_id": 1993366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/dGJXl.png?s=128&g=1", "display_name": "vikingsteve", "link": "https://stackoverflow.com/users/1993366/vikingsteve"}, "is_accepted": true, "score": 6, "last_activity_date": 1590084484, "last_edit_date": 1590084484, "creation_date": 1460484519, "answer_id": 36580938, "question_id": 36580815, "link": "https://stackoverflow.com/questions/36580815/haskell-sort-values-from-list/36580938#36580938", "title": "Haskell sort values from list", "body": "<p>You can do it easily with <code>map</code> and a niftry trick to use <code>words</code>, <code>sort</code> and then <code>unwords</code> (to restore the whitespace).</p>\n\n<pre><code>Prelude&gt; let ff=[\"1 8 8 5 6\", \"1 4 2 3\", \"5 4 9 7 9 9\"]\nPrelude&gt; import Data.List\nPrelude Data.List&gt; map (unwords . sort . words) ff\n[\"1 5 6 8 8\",\"1 2 3 4\",\"4 5 7 9 9 9\"]\n</code></pre>\n\n<p>Edit: Improvement to correctly sort numeric values:</p>\n\n<pre><code>import Data.List\nlet ff=[\"11 8 8 5 6\", \"11 4 2 3\", \"5 4 9 7 99 9\"]\nlet sortNumeric = (map show) . sort . (map (read :: String -&gt; Int))\nmap (unwords . sortNumeric . words) ff\n</code></pre>\n\n<p>result:</p>\n\n<pre><code>[\"5 6 8 8 11\",\"2 3 4 11\",\"4 5 7 9 9 99\"]\n</code></pre>\n"}], "owner": {"reputation": 2802, "user_id": 3334375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7ea497db44ae233839e211fdcf141f10?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/3334375/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "accepted_answer_id": 36580938, "answer_count": 1, "score": 0, "last_activity_date": 1590084484, "creation_date": 1460484109, "last_edit_date": 1460487058, "question_id": 36580815, "link": "https://stackoverflow.com/questions/36580815/haskell-sort-values-from-list", "title": "Haskell sort values from list", "body": "<p>I'm new to haskell and I want to sort list of strings. For example I have a list that is in my variable <code>ff</code> that contain three strings <code>[\"1 8 8 5 6\", \"1 4 2 3\", \"5 4 9 7 9 9\"]</code> and I want to sort them so my result should look like  <code>[\"1 5 6 8 8\", \"1 2 3 4\", \"4 5 7 9 9 9\"]</code> Here's my code that perfectly works</p>\n\n<pre><code>import System.IO  \nimport Control.Monad\nimport Data.List\nimport Data.Function\nimport Data.Array\nimport Data.Char\n\nsortNumeric = sortBy (compare `on` (read :: String -&gt; Int))\nwordsWhen :: (Char -&gt; Bool) -&gt; String -&gt; [String]\nwordsWhen p s =  case dropWhile p s of\n                      \"\" -&gt; []\n                      s' -&gt; w : wordsWhen p s''\n                            where (w, s'') = break p s'\nmain = do\n  file &lt;- readFile \"test.txt\"\n  let ff = map ((!!) (lines file)) [1,3..(length (lines file) - 1)]\n  let splitString =  wordsWhen (==' ') (ff!!0)\n  let sortedResult = sortNumeric (splitString)\n  print sortedResult\n</code></pre>\n\n<p>Problem is with this line <code>let splitString =  wordsWhen (==' ') (ff!!0)</code> I always get first element of the list, so only first element is sorted. How can I pass all values of a list? Here's what I tryied to do <code>let splitString =  wordsWhen (==' ') (ff!![0..(length(ff)-1)])</code> unfortunately this doesn't work. Any ideas how to solve this problem?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 11760, "user_id": 2926641, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/962e08aff17872bda3f89a9ee6849ab3?s=128&d=identicon&r=PG", "display_name": "asiniy", "link": "https://stackoverflow.com/users/2926641/asiniy"}, "edited": false, "score": 0, "creation_date": 1460482116, "post_id": 36580024, "comment_id": 60759349, "body": "LogAnalysis.hs:11:46:     Couldn&#39;t match expected type <code>String -&gt; LogMessage&#39;                 with actual type </code>LogMessage&#39;     The function <code>LogMessage&#39; is applied to four arguments,     but its type </code>MessageType -&gt; TimeStamp -&gt; String -&gt; LogMessage&#39;     has only three     In the expression: LogMessage Info read (timestamp) message     In an equation for `createLogMessage&#39;:         createLogMessage [&quot;I&quot;, timestamp, message]           = LogMessage Info read (timestamp) message"}, {"owner": {"reputation": 11760, "user_id": 2926641, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/962e08aff17872bda3f89a9ee6849ab3?s=128&d=identicon&r=PG", "display_name": "asiniy", "link": "https://stackoverflow.com/users/2926641/asiniy"}, "edited": false, "score": 0, "creation_date": 1460482131, "post_id": 36580024, "comment_id": 60759355, "body": "LogAnalysis.hs:11:62:     Couldn&#39;t match type <code>String -&gt; a0&#39; with </code>Int&#39;     Expected type: TimeStamp       Actual type: String -&gt; a0     In the second argument of <code>LogMessage&#39;, namely </code>read&#39;     In the expression: LogMessage Info read (timestamp) message     In an equation for `createLogMessage&#39;:         createLogMessage [&quot;I&quot;, timestamp, message]           = LogMessage Info read (timestamp) message Failed, modules loaded: Log."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 11760, "user_id": 2926641, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/962e08aff17872bda3f89a9ee6849ab3?s=128&d=identicon&r=PG", "display_name": "asiniy", "link": "https://stackoverflow.com/users/2926641/asiniy"}, "edited": false, "score": 2, "creation_date": 1460482166, "post_id": 36580024, "comment_id": 60759379, "body": "You misplaced the parentheses; it&#39;s <code>(read timestamp)</code>, not <code>read (timestamp)</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 4, "last_activity_date": 1460483238, "last_edit_date": 1460483238, "creation_date": 1460481574, "answer_id": 36580024, "question_id": 36579845, "link": "https://stackoverflow.com/questions/36579845/haskell-how-can-i-convert-string-to-integer-and-pass-it-to-created-structure/36580024#36580024", "title": "Haskell - how can I convert string to integer and pass it to created structure?", "body": "<p>The <code>Read</code> class provides the function <code>read :: Read a =&gt; String -&gt; a</code> for just this type of conversion. (Also, you need to unpack <code>message</code> from the list as well, so that <code>LogMessage</code> gets a <code>String</code>, not a <code>[String]</code>, as its third argument.)</p>\n\n<pre><code>createLogMessage :: [String] -&gt; LogMessage\ncreateLogMessage (\"I\":timestamp:message:[]) = LogMessage Info (read timestamp) message\n</code></pre>\n\n<p>or more simply</p>\n\n<pre><code>createLogMessage [\"I\", timestamp, message] = LogMessage Info (read timestamp) message\n</code></pre>\n\n<p>The <code>Int</code> class is an instance of <code>Read</code>, and Haskell can infer that <code>read</code> needs to return an <code>Int</code> here.</p>\n\n<p>Note that if your <code>MessageType</code> is an instance of <code>Read</code>, you can simplify <code>createLogMessage</code>.</p>\n\n<pre><code>instance Read MessageType where\n    read \"I\" = Info\n    read \"D\" = Debug\n    -- etc\n\ncreateLogMessage :: [String] -&gt; LogMessage\ncreateLogMessage [msgType, timestamp, message] = LogMessage (read msgType) (read timestamp) message\n</code></pre>\n"}], "owner": {"reputation": 11760, "user_id": 2926641, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/962e08aff17872bda3f89a9ee6849ab3?s=128&d=identicon&r=PG", "display_name": "asiniy", "link": "https://stackoverflow.com/users/2926641/asiniy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 36580024, "answer_count": 1, "score": 0, "last_activity_date": 1460483238, "creation_date": 1460481005, "question_id": 36579845, "link": "https://stackoverflow.com/questions/36579845/haskell-how-can-i-convert-string-to-integer-and-pass-it-to-created-structure", "title": "Haskell - how can I convert string to integer and pass it to created structure?", "body": "<p>I'm implementing <a href=\"http://www.cis.upenn.edu/~cis194/spring13/lectures.html\" rel=\"nofollow\">CIS 194</a> course and found one task I can't solve.</p>\n\n<p>I have a <code>LogMessage</code> data:</p>\n\n<pre><code>type TimeStamp = Int\ndata LogMessage = LogMessage MessageType TimeStamp String\n                | Unknown String\n  deriving (Show, Eq)\n</code></pre>\n\n<p>And I want to create a <code>LogMessage</code> by sending array (like <code>[\"I\", \"215\" \"somesomesome\"]</code>) to it:</p>\n\n<pre><code>createLogMessage :: [String] -&gt; LogMessage\ncreateLogMessage (\"I\":timestamp:message) = LogMessage Info timestamp message\n</code></pre>\n\n<p>The problem is that timestamp should be converted to integer. How can I convert timestamp to integer and pass it to create a <code>LogMessage</code>?</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460487806, "post_id": 36579793, "comment_id": 60762696, "body": "I don&#39;t think this use of <code>withState</code> makes any sense, you only call it on <code>get</code> so it is precisely <code>modify (+1) &gt;&gt; get</code>. <code>withState</code> should probably be applied to the recursive case."}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 1, "last_activity_date": 1460498720, "last_edit_date": 1460498720, "creation_date": 1460480848, "answer_id": 36579793, "question_id": 36579653, "link": "https://stackoverflow.com/questions/36579653/haskell-using-withstate-in-place-of-put/36579793#36579793", "title": "haskell - Using withState in place of put", "body": "<p>Yes. Here's what <code>withState</code> looks like:</p>\n\n<pre><code>renumberTree2Inorder :: Tree a -&gt; StateT Int Identity (Tree Int)\nrenumberTree2Inorder Empty =\n  return Empty\nrenumberTree2Inorder (Node _ l r) = do\n  l' &lt;- renumberTree2Inorder l\n  i &lt;- get\n  withState (+ 1) $ do\n    r' &lt;- renumberTree2Inorder r\n    return (Node i l' r')\n</code></pre>\n\n<p>You still need the <code>i &lt;- get</code> so you can construct the <code>Node</code> at the end.</p>\n\n\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 36579793, "answer_count": 1, "score": 0, "last_activity_date": 1460498720, "creation_date": 1460480419, "question_id": 36579653, "link": "https://stackoverflow.com/questions/36579653/haskell-using-withstate-in-place-of-put", "title": "haskell - Using withState in place of put", "body": "<p>I have written numbering tree in inorder. As you can see, I used <code>put</code>. Is it possible to use <code>withState</code> here ?</p>\n\n<pre><code>renumberTree2Inorder :: Tree a -&gt; StateT Int Identity (Tree Int)\nrenumberTree2Inorder Empty = return Empty\nrenumberTree2Inorder (Node _ l r) = (renumberTree2Inorder l) &gt;&gt;= (\\l' -&gt; \n        get &gt;&gt;= (\\i -&gt; put (i + 1) &gt;&gt;= (\\_ -&gt; renumberTree2Inorder r) &gt;&gt;= (\\r' -&gt; return (Node i l' r'))))\n\n\n\nrenumberTree2Inorder' :: Tree a -&gt; Tree Int\nrenumberTree2Inorder' t = evalState (renumberTree2Inorder t) 0\n</code></pre>\n"}, {"tags": ["haskell", "memory", "serialization", "memory-leaks"], "comments": [{"owner": {"reputation": 56, "user_id": 5864821, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9ROlt.png?s=128&g=1", "display_name": "SANK", "link": "https://stackoverflow.com/users/5864821/sank"}, "edited": false, "score": 1, "creation_date": 1460481168, "post_id": 36579157, "comment_id": 60758761, "body": "you could take a look at streams if you don&#39;t need the entire file in memory at once. This might help: <a href=\"http://people.cs.aau.dk/~normark/prog3-03/html/notes/eval-order_themes-delay-stream-section.html\" rel=\"nofollow noreferrer\">people.cs.aau.dk/~normark/prog3-03/html/notes/&hellip;</a>"}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1460481252, "post_id": 36579157, "comment_id": 60758821, "body": "bigger dataset =&gt; more memory? Not if you are streaming the data, and I think binary uses lazy bytestring exactly because of that. Check the laziness in your code (when are you forcing/sharing values)."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1460499063, "post_id": 36579157, "comment_id": 60768806, "body": "why does <code>feedWithInputData</code> reverse your input list?  That will not stream."}, {"owner": {"reputation": 77, "user_id": 6194369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d941916bf82889eb6d81938e52a51f?s=128&d=identicon&r=PG&f=1", "display_name": "road42", "link": "https://stackoverflow.com/users/6194369/road42"}, "edited": false, "score": 0, "creation_date": 1460538789, "post_id": 36579157, "comment_id": 60784471, "body": "Thanks fot the streaming hint, but I think streaming is not an option. The code here is actually a simplified example for the project I&#39;m working on. Here I&#39;m using a simple datastructure like: data DualNo = DualNo Int Int."}, {"owner": {"reputation": 77, "user_id": 6194369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d941916bf82889eb6d81938e52a51f?s=128&d=identicon&r=PG&f=1", "display_name": "road42", "link": "https://stackoverflow.com/users/6194369/road42"}, "edited": false, "score": 0, "creation_date": 1460538803, "post_id": 36579157, "comment_id": 60784486, "body": "But in my actual program I have a tree-like datastructure: data Tree = Tree Int [Tree]. So, I don&#39;t need the entire file in memory at once, but I need some branches of my tree-like datastructure in memory. So I think, streaming is not an option, because I won&#39;t add new data to the end of the file. I&#39;m going to process my tree-like datastructure (add new nodes or edit existing nodes). But I have edited my post and added a further question."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1460563326, "post_id": 36579157, "comment_id": 60804620, "body": "102 MB is the memory the program allocated, not the memory it occupied (heap peak). Mainly during GC some data may have to be copied and moved. The heap peak of your program (<code>dataset1 empty</code>) is around 10MB by heap graph. For how to produce a heap graph of your program please <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/prof-heap.html\" rel=\"nofollow noreferrer\">read this</a>."}], "owner": {"reputation": 77, "user_id": 6194369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00d941916bf82889eb6d81938e52a51f?s=128&d=identicon&r=PG&f=1", "display_name": "road42", "link": "https://stackoverflow.com/users/6194369/road42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1460538722, "creation_date": 1460478802, "last_edit_date": 1460538722, "question_id": 36579157, "link": "https://stackoverflow.com/questions/36579157/improving-memory-usage-during-serialization-data-binary", "title": "Improving memory usage during serialization (Data.Binary)", "body": "<p>I'm still kinda new to Haskell and learning new things every day. My problem is a too high memory usage during seralization using the Data.Binary library. Maybe I'm just using the library the wrong way, but I can't figure it out.</p>\n\n<p>The actual idea is, that I read binary data from disk, add new data und write everything back to disk. Here's the code:</p>\n\n<pre><code>module Main\n  where\n\nimport Data.Binary\nimport System.Environment\nimport Data.List (foldl')\n\ndata DualNo = DualNo Int Int deriving (Show)\n\ninstance Data.Binary.Binary DualNo where\n  put (DualNo a b) = do\n    put a\n    put b\n  get = do\n    a &lt;- get\n    b &lt;- get\n    return (DualNo a b)\n\n-- read DualNo from HDD\nreadData :: FilePath -&gt; IO [DualNo]\nreadData filename = do\n  no &lt;- decodeFile filename :: IO [DualNo]\n  return no\n\n-- write DualNo to HDD\nwriteData  :: [DualNo] -&gt; String -&gt; IO ()\nwriteData no filename = encodeFile filename (no :: [DualNo])\n\nwriteEmptyDataToDisk :: String -&gt; IO ()\nwriteEmptyDataToDisk filename = writeData [] filename\n\n-- feed a the list with a new dataset\nfeedWithInputData :: [DualNo] -&gt; [(Int, Int)] -&gt; [DualNo]\nfeedWithInputData existData newData = foldl' func existData newData\n  where\n    func dataset (a,b) = DualNo a b : dataset\n\nmain :: IO ()\nmain = do\n  [newInputData, toPutIntoExistingData] &lt;- System.Environment.getArgs\n  if toPutIntoExistingData == \"empty\"\n    then writeEmptyDataToDisk \"myData.dat\"\n    else return ()\n  loadedData &lt;- readData \"myData.dat\"\n  newData &lt;- return (case newInputData of\n                        \"dataset1\" -&gt; feedWithInputData loadedData dataset1\n                        \"dataset2\" -&gt; feedWithInputData loadedData dataset2\n                        otherwise  -&gt; feedWithInputData loadedData dataset3)\n  writeData newData \"myData.dat\"\n\ndataset1 = zip [1..100000]    [2,4..200000]\ndataset2 = zip [5,10..500000] [3,6..300000]\ndataset3 = zip [4,8..400000]  [6,12..600000]\n</code></pre>\n\n<p>I'm pretty sure, there's a lot to improve in this code. But my biggest problem is the memory usage with big datasets.</p>\n\n<p>I profiled my programm with GHC.</p>\n\n<pre><code>$ ghc -O2 --make -prof -fprof-auto -auto-all -caf-all -rtsopts -fforce-recomp Main.hs\n$ ./Main dataset1 empty +RTS -p -sstderr\n     165,085,864 bytes allocated in the heap\n      70,643,992 bytes copied during GC\n      12,298,128 bytes maximum residency (7 sample(s))\n         424,696 bytes maximum slop\n              35 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0       306 colls,     0 par    0.035s   0.035s     0.0001s    0.0015s\n  Gen  1         7 colls,     0 par    0.053s   0.053s     0.0076s    0.0180s\n\n  INIT    time    0.001s  (  0.001s elapsed)\n  MUT     time    0.059s  (  0.062s elapsed)\n  GC      time    0.088s  (  0.088s elapsed)\n  RP      time    0.000s  (  0.000s elapsed)\n  PROF    time    0.000s  (  0.000s elapsed)\n  EXIT    time    0.003s  (  0.003s elapsed)\n  Total   time    0.154s  (  0.154s elapsed)\n\n  %GC     time      57.0%  (57.3% elapsed)\n\n  Alloc rate    2,781,155,968 bytes per MUT second\n\n  Productivity  42.3% of total user, 42.5% of total elapsed\n</code></pre>\n\n<p>Looking at the prof-file:</p>\n\n<pre><code>    Tue Apr 12 18:11 2016 Time and Allocation Profiling Report  (Final)\n\n       Main +RTS -p -sstderr -RTS dataset1 empty\n\n    total time  =        0.06 secs   (60 ticks @ 1000 us, 1 processor)\n    total alloc = 102,613,008 bytes  (excludes profiling overheads)\n\nCOST CENTRE            MODULE    %time %alloc\n\nput                    Main       48.3   53.0\nwriteData              Main       30.0   18.8\ndataset1               Main       13.3   23.4\nfeedWithInputData      Main        6.7    0.0\nfeedWithInputData.func Main        1.7    4.7\n\n\n                                                                    individual     inherited\nCOST CENTRE               MODULE                  no.     entries  %time %alloc   %time %alloc\n\nMAIN                      MAIN                     68           0    0.0    0.0   100.0  100.0\n main                     Main                    137           0    0.0    0.0    86.7   76.6\n  feedWithInputData       Main                    150           1    6.7    0.0     8.3    4.7\n   feedWithInputData.func Main                    154      100000    1.7    4.7     1.7    4.7\n  writeData               Main                    148           1   30.0   18.8    78.3   71.8\n   put                    Main                    155      100000   48.3   53.0    48.3   53.0\n  readData                Main                    147           0    0.0    0.1     0.0    0.1\n  writeEmptyDataToDisk    Main                    142           0    0.0    0.0     0.0    0.1\n   writeData              Main                    143           0    0.0    0.1     0.0    0.1\n CAF:main1                Main                    133           0    0.0    0.0     0.0    0.0\n  main                    Main                    136           1    0.0    0.0     0.0    0.0\n CAF:main2                Main                    132           0    0.0    0.0     0.0    0.0\n  main                    Main                    139           0    0.0    0.0     0.0    0.0\n   writeEmptyDataToDisk   Main                    140           1    0.0    0.0     0.0    0.0\n    writeData             Main                    141           1    0.0    0.0     0.0    0.0\n CAF:main7                Main                    131           0    0.0    0.0     0.0    0.0\n  main                    Main                    145           0    0.0    0.0     0.0    0.0\n   readData               Main                    146           1    0.0    0.0     0.0    0.0\n CAF:dataset1             Main                    123           0    0.0    0.0     5.0    7.8\n  dataset1                Main                    151           1    5.0    7.8     5.0    7.8\n CAF:dataset4             Main                    122           0    0.0    0.0     5.0    7.8\n  dataset1                Main                    153           0    5.0    7.8     5.0    7.8\n CAF:dataset5             Main                    121           0    0.0    0.0     3.3    7.8\n  dataset1                Main                    152           0    3.3    7.8     3.3    7.8\n CAF:main4                Main                    116           0    0.0    0.0     0.0    0.0\n  main                    Main                    138           0    0.0    0.0     0.0    0.0\n CAF:main6                Main                    115           0    0.0    0.0     0.0    0.0\n  main                    Main                    149           0    0.0    0.0     0.0    0.0\n CAF:main3                Main                    113           0    0.0    0.0     0.0    0.0\n  main                    Main                    144           0    0.0    0.0     0.0    0.0\n CAF                      GHC.Conc.Signal         107           0    0.0    0.0     0.0    0.0\n CAF                      GHC.IO.Encoding         103           0    0.0    0.0     0.0    0.0\n CAF                      GHC.IO.Encoding.Iconv   101           0    0.0    0.0     0.0    0.0\n CAF                      GHC.IO.Handle.FD         94           0    0.0    0.0     0.0    0.0\n CAF                      GHC.IO.FD                86           0    0.0    0.0     0.0    0.0\n</code></pre>\n\n<p>Now I add further data:</p>\n\n<pre><code>$ ./Main dataset2 myData.dat +RTS -p -sstderr\n     343,601,008 bytes allocated in the heap\n     175,650,728 bytes copied during GC\n      34,113,936 bytes maximum residency (8 sample(s))\n         971,896 bytes maximum slop\n              78 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0       640 colls,     0 par    0.082s   0.083s     0.0001s    0.0017s\n  Gen  1         8 colls,     0 par    0.140s   0.141s     0.0176s    0.0484s\n\n  INIT    time    0.001s  (  0.001s elapsed)\n  MUT     time    0.138s  (  0.139s elapsed)\n  GC      time    0.221s  (  0.224s elapsed)\n  RP      time    0.000s  (  0.000s elapsed)\n  PROF    time    0.000s  (  0.000s elapsed)\n  EXIT    time    0.006s  (  0.006s elapsed)\n  Total   time    0.370s  (  0.370s elapsed)\n\n  %GC     time      59.8%  (60.5% elapsed)\n\n  Alloc rate    2,485,518,518 bytes per MUT second\n\n  Productivity  39.9% of total user, 39.8% of total elapsed\n</code></pre>\n\n<p>Looking at the new prof-file:</p>\n\n<pre><code>    Tue Apr 12 18:15 2016 Time and Allocation Profiling Report  (Final)\n\n       Main +RTS -p -sstderr -RTS dataset2 myData.dat\n\n    total time  =        0.14 secs   (139 ticks @ 1000 us, 1 processor)\n    total alloc = 213,866,232 bytes  (excludes profiling overheads)\n\nCOST CENTRE            MODULE    %time %alloc\n\nput                    Main       41.0   50.9\nwriteData              Main       25.9   18.0\nget                    Main       25.2   16.8\ndataset2               Main        4.3   11.2\nreadData               Main        1.4    0.8\nfeedWithInputData.func Main        1.4    2.2\n\n\n                                                                    individual     inherited\nCOST CENTRE               MODULE                  no.     entries  %time %alloc   %time %alloc\n\nMAIN                      MAIN                     68           0    0.0    0.0   100.0  100.0\n main                     Main                    137           0    0.0    0.0    95.7   88.8\n  feedWithInputData       Main                    148           1    0.7    0.0     2.2    2.2\n   feedWithInputData.func Main                    152      100000    1.4    2.2     1.4    2.2\n  writeData               Main                    145           1   25.9   18.0    66.9   68.9\n   put                    Main                    153      200000   41.0   50.9    41.0   50.9\n  readData                Main                    141           0    1.4    0.8    26.6   17.6\n   get                    Main                    144           0   25.2   16.8    25.2   16.8\n CAF:main1                Main                    133           0    0.0    0.0     0.0    0.0\n  main                    Main                    136           1    0.0    0.0     0.0    0.0\n CAF:main7                Main                    131           0    0.0    0.0     0.0    0.0\n  main                    Main                    139           0    0.0    0.0     0.0    0.0\n   readData               Main                    140           1    0.0    0.0     0.0    0.0\n CAF:dataset2             Main                    126           0    0.0    0.0     0.7    3.7\n  dataset2                Main                    149           1    0.7    3.7     0.7    3.7\n CAF:dataset6             Main                    125           0    0.0    0.0     2.2    3.7\n  dataset2                Main                    151           0    2.2    3.7     2.2    3.7\n CAF:dataset7             Main                    124           0    0.0    0.0     1.4    3.7\n  dataset2                Main                    150           0    1.4    3.7     1.4    3.7\n CAF:$fBinaryDualNo1      Main                    120           0    0.0    0.0     0.0    0.0\n  get                     Main                    143           1    0.0    0.0     0.0    0.0\n CAF:main4                Main                    116           0    0.0    0.0     0.0    0.0\n  main                    Main                    138           0    0.0    0.0     0.0    0.0\n CAF:main6                Main                    115           0    0.0    0.0     0.0    0.0\n  main                    Main                    146           0    0.0    0.0     0.0    0.0\n CAF:main5                Main                    114           0    0.0    0.0     0.0    0.0\n  main                    Main                    147           0    0.0    0.0     0.0    0.0\n CAF:main3                Main                    113           0    0.0    0.0     0.0    0.0\n  main                    Main                    142           0    0.0    0.0     0.0    0.0\n CAF                      GHC.Conc.Signal         107           0    0.0    0.0     0.0    0.0\n CAF                      GHC.IO.Encoding         103           0    0.0    0.0     0.0    0.0\n CAF                      GHC.IO.Encoding.Iconv   101           0    0.0    0.0     0.0    0.0\n CAF                      GHC.IO.Handle.FD         94           0    0.0    0.0     0.0    0.0\n CAF                      GHC.IO.FD                86           0    0.0    0.0     0.0    0.0\n</code></pre>\n\n<p>The more often I add new data, the higher the memory usage becomes. I mean, it's clear, that I need more memory for a bigger dataset. But isn't there a better solution for this problem (like gradually writing data back to disk).</p>\n\n<p><strong>Edit:</strong>\nActually the most important thing, that bothers me, is the following observation:</p>\n\n<ol>\n<li>I run the program for the first time and add new data to an existing (empty) file on my disk.\nThe size of the saved file on my disk is: 1.53 MByte.\nBut (looking at the first prof-file) the program allocated more than 102 MByte. More than 50% was allocated by the put function from the Data.Binary package.</li>\n<li>I run the program a second time and add new data to an existing (not empty) file on my disk.\nThe size of the saved file on my disk is 3.05 MByte.\nBut (looking at the second prof-file) the program allocated more than 213 MByte. More than 66% was allocated by the put and get function together.</li>\n</ol>\n\n<p>=> Conclusion: In the first example I needed 102/1.53 = 66 times more memory running the program than space for the binary file on my disk.\nIn the second example I needed 213/3.05 = 69 times more memory running the programm than space for the binary file on my disk.</p>\n\n<p><strong>Question:</strong>\nIs the Data.Binary package for serialization so efficient (and awesome), that it can decrease the needed memory to such an extent.\nAnalogous question:\nDo I really need so much more memory for loading the data in my program than space for the the same data in a binary-file on disk?</p>\n"}, {"tags": ["list", "haskell", "filter", "sublist"], "comments": [{"owner": {"reputation": 965, "user_id": 3783565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Yhgn8.png?s=128&g=1", "display_name": "Kevin W.", "link": "https://stackoverflow.com/users/3783565/kevin-w"}, "edited": false, "score": 0, "creation_date": 1460477075, "post_id": 36578438, "comment_id": 60756146, "body": "Your code looks like you don&#39;t understand the principles of immutability.  The statement <code>t : sublist</code> doesn&#39;t change sublist at all, it simply yields a list just containing <code>t</code> (<code>sublist</code> will always be empty as that&#39;s how immutability works - the binding won&#39;t change)."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1460477798, "post_id": 36578438, "comment_id": 60756639, "body": "You don&#39;t need <code>do</code>s here. Don&#39;t use <code>do</code> until you learn about monads. (Okay, you can probably get away with using <code>do</code> notation with <code>IO</code> before you use monads, but for nothing else.)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1460483618, "post_id": 36578438, "comment_id": 60760259, "body": "Working out why this code compiles at all and, once it compiles, why it behaves as it does is a lovely exercise for the mid-level Haskell programmer. =D"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 5943974, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1vici.png?s=128&g=1", "display_name": "possum_pendulum", "link": "https://stackoverflow.com/users/5943974/possum-pendulum"}, "edited": false, "score": 0, "creation_date": 1460480594, "post_id": 36578668, "comment_id": 60758428, "body": "Thank you, this code was very helpful. Is there a resource that you or somebody else could recommend to help me make the mental switch to functional style? I&#39;ve tried to grasp recursive functions in Prolog as well and I cannot understand it well enough to effectively solve problems that would be easy for me in a language like C++."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 129, "user_id": 5943974, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1vici.png?s=128&g=1", "display_name": "possum_pendulum", "link": "https://stackoverflow.com/users/5943974/possum-pendulum"}, "edited": false, "score": 0, "creation_date": 1460480832, "post_id": 36578668, "comment_id": 60758574, "body": "If you&#39;re starting fresh perhaps a book is more useful.  I can recommend Bird&#39;s Thinking Functionally in Haskell, but there are many others, perhaps the free option LYAH but I didn&#39;t read it."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 3, "last_activity_date": 1460477641, "last_edit_date": 1460477641, "creation_date": 1460477345, "answer_id": 36578668, "question_id": 36578438, "link": "https://stackoverflow.com/questions/36578438/haskell-filter-multiples-of-3-from-a-list-to-a-sublist/36578668#36578668", "title": "Haskell Filter Multiples of 3 from a List to a Sublist", "body": "<p>I think you need to first switch over mentally to functional style.</p>\n\n<p>for example, this is to get even numbers from a list</p>\n\n<pre><code>&gt; filter even [1..10]\n[2,4,6,8,10]\n</code></pre>\n\n<p>without using the existing functions you can implement the same functionality</p>\n\n<pre><code>filter' :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter' _ [] = []\nfilter' condition (x:xs) = if condition x\n                              then x : filter' condition xs\n                              else     filter' condition xs\n\ndivisibleBy3 n = mod n 3 == 0\n</code></pre>\n\n<p>now, your program can be written as</p>\n\n<pre><code>filter' divisibleBy3 inputList   \n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 5943974, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/1vici.png?s=128&g=1", "display_name": "possum_pendulum", "link": "https://stackoverflow.com/users/5943974/possum-pendulum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 979, "favorite_count": 0, "accepted_answer_id": 36578668, "answer_count": 1, "score": 0, "last_activity_date": 1460477641, "creation_date": 1460476691, "question_id": 36578438, "link": "https://stackoverflow.com/questions/36578438/haskell-filter-multiples-of-3-from-a-list-to-a-sublist", "title": "Haskell Filter Multiples of 3 from a List to a Sublist", "body": "<p>I am still trying to grasp the way Haskell and Functional Programming works, and I need help understanding why my function is not working. I am trying to create a function that takes a list of integers as a parameter and filters out/returns a sublist which contains any multiples of 3 from the first list. Here is my code:</p>\n\n<pre><code>module Main where\n\nsublist = []\n\nmyFunc :: [Int] -&gt; [Int]\n\nmyFunc [] = []\n\nmyFunc [t] = do\n    if t `mod` 3 == 0\n        then t : sublist\n    else myFunc []\n\nmyFunc (h:t) = do\n    if h `mod` 3 /= 0\n        then myFunc t\n        else do\n            h : sublist\n            myFunc t\n</code></pre>\n\n<p>This only returns a list containing the last value passed to the function, and still sublist = []. Thanks for any advice you can give me in advance.</p>\n"}, {"tags": ["string", "haskell", "dictionary", "recursion"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1460477216, "post_id": 36578365, "comment_id": 60756254, "body": "Other than the use of <code>head</code> and <code>tail</code> (which do not work on empty lists), it looks OK; are you sure that <code>linesList</code> has type <code>[String]</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": true, "score": 1, "last_activity_date": 1460477269, "last_edit_date": 1460477269, "creation_date": 1460476947, "answer_id": 36578526, "question_id": 36578365, "link": "https://stackoverflow.com/questions/36578365/haskell-recursive-function-eating-a-string-list/36578526#36578526", "title": "Haskell - Recursive function, eating a string list", "body": "<blockquote>\n  <p>How can I fix/improve this function without using libraries ?</p>\n</blockquote>\n\n<p>First notice that your function is:</p>\n\n<pre><code>pacHead :: String -&gt; String\npacHead = tail . dropWhile (/= '\"')\n\nPrelude&gt; let pacHead = tail.dropWhile (/= '\"')\nPrelude&gt; pacHead \"bla bla bla bla \\\"citation\\\" bla bla\"\n\"citation\\\" bla bla\"\n</code></pre>\n\n<p>Recursive version (with patternt matching):</p>\n\n<pre><code>pacHead :: String -&gt; String\npacHead \"\" = \"\"\npacHead (x:xs) | x == '\"'  = xs\n               | otherwise = pacHead xs\n</code></pre>\n\n<p>You first check if the string is empty, where you return an empty string, otherwise yo pattern match the string, <code>x</code> becomes the first char and <code>xs</code> the remaining string, if x is equal to <code>\"</code> you return the remaining string otherwise you continue computing the string.</p>\n\n<blockquote>\n  <p>Where I can find a good about functions definitions (especially\n  recursion) with examples done over string lists instead of dummy\n  numbers ?</p>\n</blockquote>\n\n<p>Almost any example about list can be applied to string, becouse string is just a <code>type alias</code> for <code>[char]</code></p>\n"}], "owner": {"reputation": 13, "user_id": 6194284, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cIKeR.png?s=128&g=1", "display_name": "danvinci", "link": "https://stackoverflow.com/users/6194284/danvinci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1341, "favorite_count": 0, "accepted_answer_id": 36578526, "answer_count": 1, "score": 0, "last_activity_date": 1460484525, "creation_date": 1460476501, "last_edit_date": 1460484525, "question_id": 36578365, "link": "https://stackoverflow.com/questions/36578365/haskell-recursive-function-eating-a-string-list", "title": "Haskell - Recursive function, eating a string list", "body": "<p><br>\nI'm new to haskell and trying to learn something while building a personal project.</p>\n\n<p>I've defined a function:</p>\n\n<pre><code>pacHead :: String -&gt; String\npacHead textrow =\n   let first = head textrow\n      in if first /= '\"'\n         then pacHead (tail textrow)\n         else textrow\n</code></pre>\n\n<p>I want it to take a string, verify if it's head is a certain char (\") and 'eat' the string up to the point the char is removed. Example:</p>\n\n<p>IN: bla bla bla bla \"citation\" bla bla -> OUT: citation\" bla bla</p>\n\n<p>But, when I apply it to a list of strings (using map) it just returns an empty list.</p>\n\n<pre><code>let firstPac = map pacHead linesList\n</code></pre>\n\n<ol>\n<li>How can I fix/improve this function without using libraries ?</li>\n<li>Where I can find a <em>good</em> intro about function definitions (especially recursion) with examples done over string lists instead of dummy numbers ?</li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1460474756, "post_id": 36577386, "comment_id": 60754180, "body": "In general this isn&#39;t possible because <code>a</code> is going from the negative to the positive position (I think). You might get better help if you elaborated on your problem on a little. Which LevelDB function are you looking at with this type? Is this the leveldb-haskell library?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1460474767, "post_id": 36577386, "comment_id": 60754187, "body": "Why do you want to do that ? If you to perform any IO action inside it, use <code>liftIO</code>."}, {"owner": {"reputation": 142, "user_id": 337263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd98240358ebb23f0e5c27e6ea6e5075?s=128&d=identicon&r=PG", "display_name": "sfultong", "link": "https://stackoverflow.com/users/337263/sfultong"}, "edited": false, "score": 0, "creation_date": 1460477243, "post_id": 36577386, "comment_id": 60756271, "body": "This is the leveldb-haskell library."}, {"owner": {"reputation": 142, "user_id": 337263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd98240358ebb23f0e5c27e6ea6e5075?s=128&d=identicon&r=PG", "display_name": "sfultong", "link": "https://stackoverflow.com/users/337263/sfultong"}, "edited": false, "score": 0, "creation_date": 1460478010, "post_id": 36577386, "comment_id": 60756808, "body": "The problem is, there&#39;s a data type used extensively in the code base I&#39;m working on, which is essentially a grab bag of IO functions. changing them to be MonadResource functions means a lot of refactoring."}], "answers": [{"tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 3, "last_activity_date": 1460480323, "creation_date": 1460480323, "answer_id": 36579624, "question_id": 36577386, "link": "https://stackoverflow.com/questions/36577386/strip-off-layer-from-monadresource/36579624#36579624", "title": "Strip off layer from MonadResource", "body": "<p>It can definitely be done, but it's dangerous. Let's demonstrate first the how, by extracting the internal state of the <code>ResourceT</code>:</p>\n\n<pre><code>import Control.Monad.IO.Class\nimport Control.Monad.Trans.Resource\nimport Control.Monad.Trans.Resource.Internal\n\ndata Foo = Foo Int\n    deriving Show\n\ngetFoo :: MonadResource m =&gt; Int -&gt; m Foo\ngetFoo i = fmap snd $ allocate\n    (do\n        putStrLn $ \"allocating Foo with \" ++ show i\n        return $ Foo i)\n    (\\(Foo x) -&gt; putStrLn $ \"Freeing Foo \" ++ show x)\n\nstripLayer :: MonadResource m =&gt; (a -&gt; ResourceT IO b) -&gt; m (a -&gt; IO b)\nstripLayer f = do\n    is &lt;- liftResourceT getInternalState\n    return $ \\a -&gt; runInternalState (f a) is\n\nmain :: IO ()\nmain = do\n    getFoo' &lt;- runResourceT $ stripLayer $ getFoo\n    getFoo' 42 &gt;&gt;= print\n</code></pre>\n\n<p>Unfortunately the output from this isn't what we'd hope for:</p>\n\n<pre><code>allocating Foo with 42\nFoo 42\n</code></pre>\n\n<p>Notice how the \"Freeing\" line is never called. This is because, by the time we use <code>getFoo'</code>, the <code>runResourceT</code> call has already exited, which is how we guarantee that all resources are freed. You <em>can</em> safely get away with this trick if you're disciplined and make sure everything lives inside the <code>runResourceT</code> call, but the type system won't help you. To see what this will look like:</p>\n\n<pre><code>main :: IO ()\nmain = runResourceT $ do\n    getFoo' &lt;- stripLayer $ getFoo\n    liftIO $ getFoo' 42 &gt;&gt;= print\n</code></pre>\n"}], "owner": {"reputation": 142, "user_id": 337263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd98240358ebb23f0e5c27e6ea6e5075?s=128&d=identicon&r=PG", "display_name": "sfultong", "link": "https://stackoverflow.com/users/337263/sfultong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 36579624, "answer_count": 1, "score": 0, "last_activity_date": 1460480323, "creation_date": 1460474007, "question_id": 36577386, "link": "https://stackoverflow.com/questions/36577386/strip-off-layer-from-monadresource", "title": "Strip off layer from MonadResource", "body": "<p>I'm playing around with the leveldb bindings.</p>\n\n<p>I'm wondering if it's possible to take a function like</p>\n\n<pre><code>MonadResource m =&gt; a -&gt; m b\n</code></pre>\n\n<p>And convert it to</p>\n\n<pre><code>MonadResource m =&gt; m (a -&gt; IO b))\n</code></pre>\n"}, {"tags": ["haskell", "shake-build-system"], "answers": [{"tags": [], "owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "is_accepted": true, "score": 2, "last_activity_date": 1460491262, "creation_date": 1460491262, "answer_id": 36582970, "question_id": 36576654, "link": "https://stackoverflow.com/questions/36576654/shake-how-to-proceed-when-file-name-is-not-known-a-priori/36582970#36582970", "title": "Shake: how to proceed when file name is not known a-priori", "body": "<p>Will the <code>index.html</code> need to refer to the hashed Javascript files? If so, one approach is:</p>\n\n<pre><code>\"hash-js.txt\" %&gt; \\out -&gt; do\n    src &lt;- readFile' \"app.min.js\"\n    let file = \"app-\" ++ show (hash src) ++ \".min.js\"\n    writeFile' file src\n    writeFile' out file\n\n\"index.html\" %&gt; \\out -&gt;\n    js &lt;- readFile' \"hash-js.txt\"\n    writeFile' out $ \"&lt;script src='\" ++ js ++ \"&gt;\"\n</code></pre>\n\n<p>Here you have a constantly named rule (<code>hash-js.txt</code>) which both produces the file you want (at an unknown location), and the name of that file (to a fixed location). That way when you need the file from <code>index.html</code> you both depend on it and get the resulting filename out, which is likely to be required.</p>\n\n<p>This trick works equally well if you don't need the filename in <code>index.html</code> - then you just throw away the contents of the file - but it feels a bit uglier.</p>\n"}], "owner": {"reputation": 1095, "user_id": 1485671, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b1c53ba4c9d794097f9c0405ea009e64?s=128&d=identicon&r=PG", "display_name": "Aton", "link": "https://stackoverflow.com/users/1485671/aton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 166, "favorite_count": 0, "accepted_answer_id": 36582970, "answer_count": 1, "score": 4, "last_activity_date": 1460491262, "creation_date": 1460472208, "last_edit_date": 1460474567, "question_id": 36576654, "link": "https://stackoverflow.com/questions/36576654/shake-how-to-proceed-when-file-name-is-not-known-a-priori", "title": "Shake: how to proceed when file name is not known a-priori", "body": "<p>I'm trying to set up <code>Shake</code> for building a web application. At the end of my build process I would like to rename the resulting <code>.js</code> and <code>.css</code> files according to a content hash (for cache busting purposes).</p>\n\n<p>This means of course that I do not know the final names of the files which look something like <code>app-&lt;hash&gt;.min.js</code>.</p>\n\n<p>Since the rule for building the final <code>index.html</code> needs to know\nabout the names, I would need something like</p>\n\n<pre><code>\"index.html\" %&gt; \\out -&gt; do\n  need [ \"app-&lt;hash&gt;.min.js\" ]\n  ...\n</code></pre>\n\n<p>I've tried using a <code>phony</code> action along the lines of</p>\n\n<pre><code>\"index.html\" %&gt; \\out -&gt; do\n  need [ \"revJsAndCssFiles\" ]\n  ...\n\nphony \"revJsAndCssFiles\" $ do\n  ... -- Hash and copy files to appropriate locations\n</code></pre>\n\n<p>This works but seems ugly since a <code>phony</code> action isn't supposed to\nproduce a file.</p>\n\n<p>What would be the best way to approach this problem?</p>\n"}, {"tags": ["haskell", "io"], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 3, "last_activity_date": 1460472941, "creation_date": 1460472941, "answer_id": 36576952, "question_id": 36576548, "link": "https://stackoverflow.com/questions/36576548/haskell-get-every-second-line-from-text-file/36576952#36576952", "title": "Haskell get every second line from text file", "body": "<p>The do notation is a syntax sugar over monads. So your code when desugared will look like this:</p>\n\n<pre><code>readFile \"test.txt\" &gt;&gt;= \\file -&gt;\nprint (lines file) &gt;&gt; \nlet ff = map ((!!) (lines file)) [1,3..(length (lines file) - 1)]\nin ....\n</code></pre>\n\n<p>Now you can see that the expression isn't proper. You can learn more about this <a href=\"https://en.wikibooks.org/wiki/Haskell/do_notation\" rel=\"nofollow\">here</a>.</p>\n\n<p>A simple fix would be to just use <code>return ()</code>:</p>\n\n<pre><code>main = do\n  file &lt;- readFile \"test.txt\"\n  print (lines file)\n  let ff = map ((!!) (lines file)) [1,3..(length (lines file) - 1)]\n  return ()\n</code></pre>\n\n<p>which will make the code typecheck:</p>\n\n<pre><code>readFile \"test.txt\" &gt;&gt;= \\file -&gt;\nprint (lines file) &gt;&gt; \nlet ff = map ((!!) (lines file)) [1,3..(length (lines file) - 1)]\nin return ()\n</code></pre>\n\n<p>But what you want probably is this:</p>\n\n<pre><code>main = do\n  file &lt;- readFile \"test.txt\"\n  let ff = map ((!!) (lines file)) [1,3..(length (lines file) - 1)]\n  print ff\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 0, "last_activity_date": 1460473268, "creation_date": 1460473268, "answer_id": 36577075, "question_id": 36576548, "link": "https://stackoverflow.com/questions/36576548/haskell-get-every-second-line-from-text-file/36577075#36577075", "title": "Haskell get every second line from text file", "body": "<p>The (!!) suggested in the other answer is smelly.</p>\n\n<pre><code>everyOther :: [a] -&gt; [a]\neveryOther = catMaybes . zipWith ($) (cycle [const Nothing, Just])\n</code></pre>\n\n<p>Alternatively:</p>\n\n<pre><code>everyOther :: [a] -&gt; [a]\neveryOther (x:x':xs) = x : everyOther xs\neveryOther _ = []\n</code></pre>\n"}], "owner": {"reputation": 2802, "user_id": 3334375, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7ea497db44ae233839e211fdcf141f10?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/3334375/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "accepted_answer_id": 36576952, "answer_count": 2, "score": 0, "last_activity_date": 1460473268, "creation_date": 1460471967, "question_id": 36576548, "link": "https://stackoverflow.com/questions/36576548/haskell-get-every-second-line-from-text-file", "title": "Haskell get every second line from text file", "body": "<p>I'm new to haskell. I'm trying to read every second line from file for example here's my text file</p>\n\n<pre><code>5\n1 4 8 6 8\n5\n2 4 7 9 2\n0\n</code></pre>\n\n<p>So result should be</p>\n\n<pre><code>1 4 8 6 8\n2 4 7 9 2\n</code></pre>\n\n<p>Here how my code looks like</p>\n\n<pre><code>import System.IO  \nimport Control.Monad\nimport Data.List\nimport Data.Function\nimport Data.Array\nimport Data.Char\n\nmain = do\n  file &lt;- readFile \"test.txt\"\n  print (lines file)\n  let ff = map ((!!) (lines file)) [1,3..(length (lines file) - 1)]\n</code></pre>\n\n<p>I think this code should wor fine (please correct me if not) but I get error:\nThe last statement in a do block must be an expression. Why I get this error?</p>\n"}, {"tags": ["haskell", "c2hs"], "answers": [{"tags": [], "owner": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "is_accepted": true, "score": 1, "last_activity_date": 1460701409, "creation_date": 1460701409, "answer_id": 36639645, "question_id": 36575623, "link": "https://stackoverflow.com/questions/36575623/c2hs-marshalling-double-pointer/36639645#36639645", "title": "C2HS marshalling double pointer", "body": "<p>I think I've figured it out, I just wrote the following marshallers:</p>\n\n<pre><code>nullableM :: (Ptr a -&gt; IO b) -&gt; Ptr a -&gt; IO (Maybe b)\nnullableM f ptr = if ptr == nullPtr\n    then return Nothing\n    else liftM Just $ f ptr\n{-# INLINE nullableM #-}\n\ntoStringMaybe :: CString -&gt; IO (Maybe String)\ntoStringMaybe = nullableM peekCString \n{-# INLINE toStringMaybe #-}\n\npeekStringMaybe :: Ptr CString -&gt; IO (Maybe String)\npeekStringMaybe x = peek x &gt;&gt;= toStringMaybe\n{-# INLINE peekStringMaybe #-}\n</code></pre>\n"}], "owner": {"reputation": 7207, "user_id": 338846, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/f1871f7b7f5b4b39d59b72dfbe42b8f5?s=128&d=identicon&r=PG", "display_name": "Alexey Raga", "link": "https://stackoverflow.com/users/338846/alexey-raga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 1, "accepted_answer_id": 36639645, "answer_count": 1, "score": 1, "last_activity_date": 1460701409, "creation_date": 1460469768, "question_id": 36575623, "link": "https://stackoverflow.com/questions/36575623/c2hs-marshalling-double-pointer", "title": "C2HS marshalling double pointer", "body": "<p>When there is a function like:</p>\n\n<pre><code>some_type_t* some_type_create(const char* name, char** errptr);\n</code></pre>\n\n<p>is there a way to get C2HS to generate a Haskell binding with the following signature?</p>\n\n<pre><code>someTypeCreate :: String -&gt; IO (SomeTypeFPtr, String)\n</code></pre>\n\n<p>Here is what I can get so far:</p>\n\n<pre><code>{#fun some_type_create as ^ \n    {`String', alloca- `Ptr CChar' peek*} -&gt; `SomeTypeFPtr' #}\n</code></pre>\n\n<p>and it works in a way that I get </p>\n\n<pre><code>someTypeCreate :: String -&gt; IO (SomeTypeFPtr, (Ptr CChar))\n</code></pre>\n\n<p>but how do I make it return <code>IO (SomeTypeFPtr, String)</code><br>\n(or better <code>IO (Either String SomeTypeFPtr))</code> since <code>String</code> represents the error)?</p>\n\n<p>I assume that I should use/write a different marshaller to use instead of <code>peek</code> which would convert the result type but I don't quite understand how to do it.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1460467178, "post_id": 36574321, "comment_id": 60747784, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/14178889/reader-monad-purpose\">Reader Monad Purpose</a>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1460467202, "post_id": 36574321, "comment_id": 60747804, "body": "This is the second or third question I&#39;ve seen this week about binary trees and reader monads (<a href=\"http://stackoverflow.com/questions/36474647/haskell-reader-monads-depth-for-each-node-in-binary-tree\">eg</a>). Is it from a MOOC course assignment or something?"}], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 4, "last_activity_date": 1460466984, "creation_date": 1460466984, "answer_id": 36574497, "question_id": 36574321, "link": "https://stackoverflow.com/questions/36574321/how-does-the-reader-monads-ask-function-work/36574497#36574497", "title": "How does the Reader monad&#39;s &quot;ask&quot; function work?", "body": "<p>That's kind of what the Reader monad <em>does</em>; it gives you an <code>ask</code> function, which \"magically\" pops up a value out of thin air. To actually <em>use</em> this, you need to call <code>runReader</code>, and give it the <code>Int</code> environment. The <code>Reader</code> type then automatically propagates that from the <code>runReader</code> call to each of the <code>ask</code> calls.</p>\n"}, {"comments": [{"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1460500354, "post_id": 36577408, "comment_id": 60769353, "body": "&quot;The Reader Int (T Int) value is essentially just a wrapped-up function of type Int -&gt; (T Int)&quot; It is not obvious for me, please explain :)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1460509579, "post_id": 36577408, "comment_id": 60772167, "body": "I was going to attempt it, but perhaps it would be better to point you to <a href=\"http://www.mjoldfield.com/atelier/2014/08/monads-reader.html\" rel=\"nofollow noreferrer\">this explanation</a> instead. It defines a <code>Reader</code> monad directly, rather than building it up from a transformer (that implements a type class) applied to the identity monad."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 2, "last_activity_date": 1460482070, "last_edit_date": 1460482070, "creation_date": 1460474074, "answer_id": 36577408, "question_id": 36574321, "link": "https://stackoverflow.com/questions/36574321/how-does-the-reader-monads-ask-function-work/36577408#36577408", "title": "How does the Reader monad&#39;s &quot;ask&quot; function work?", "body": "<p>Short, hand-wavy answer. The <code>Reader Int (T Int)</code> value is essentially just a wrapped-up function of type <code>Int -&gt; (T Int)</code>. In order to run that function, we first need to extract it. We do that with <code>runReader</code>.</p>\n\n<pre><code>data T b = ... deriving (Show)\n\nmain = let tree = (N 10 (N 8 E E) E)\n           g = f tree\n           h = runReader g\n       in print $ h 20\n</code></pre>\n\n<p>(Typically, you would simply write <code>print $ runReader (f tree) 20</code>; I split it up to correspond to the sketchy analogy below.)</p>\n\n<p><code>ask</code> (defined by the <code>MonadReader</code> typeclass and as implemented by the <code>ReaderT</code> monad transformer used to define the <code>Reader</code> type) essentially retrieves the value of the argument passed to <code>h</code>.</p>\n\n<p>In some sense, the <code>Reader Int (T Int)</code> is an object that contains a function <code>g</code> that calls a function <code>ask</code>. <code>runReader g</code> creates a new function which, when called, defines a function <code>ask</code> that simply returns its argument, then calls <code>g</code>. Now when <code>g</code> calls <code>ask</code>, it gets back the argument originally passed to <code>h</code>.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1288, "favorite_count": 2, "accepted_answer_id": 36577408, "answer_count": 2, "score": 3, "last_activity_date": 1460482070, "creation_date": 1460466573, "last_edit_date": 1460470802, "question_id": 36574321, "link": "https://stackoverflow.com/questions/36574321/how-does-the-reader-monads-ask-function-work", "title": "How does the Reader monad&#39;s &quot;ask&quot; function work?", "body": "<pre><code>data T b = E | N b (T b) (T b) \n\n\nf :: T b -&gt; Reader Int (T Int)\nf (N i l r) = ask &gt;&gt;= \\x -&gt;  local ((-)4) (f l) &gt;&gt;= \\l' -&gt; local ((-)1) (f r) &gt;&gt;= \\r' -&gt; return (N x l' r')\nf E = return E\n</code></pre>\n\n<p>I have a problem with understanding how this code works. Especially, how does <code>ask</code> know where the environment is (in our case just <code>Int</code>)?</p>\n\n<p>To be more precise: I am an imperative programmer and in such languages it is easy. Methods can be called on any object like: <code>obj.f()</code>, or we have to pass data by argument when we want function use external data.</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1460464561, "post_id": 36569994, "comment_id": 60745421, "body": "What&#39;s your use-case? Modulo index-bounds errors <code>Example</code> looks like a variation on the <a href=\"https://hackage.haskell.org/package/comonad-5/docs/Control-Comonad-Trans-Store.html\" rel=\"nofollow noreferrer\">Store comonad</a>. I wonder whether that machinery might be a better fit for what you need"}, {"owner": {"reputation": 1373, "user_id": 1122720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3917f1f4e64e60f28f301e8369a201d4?s=128&d=identicon&r=PG", "display_name": "sukhmel", "link": "https://stackoverflow.com/users/1122720/sukhmel"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1460467431, "post_id": 36569994, "comment_id": 60748015, "body": "My actual use-case does not require bound check, but does require to use some data stored in object to construct a lens. But as restrain was also interesting case, I will take a look at Store, thank you."}], "answers": [{"comments": [{"owner": {"reputation": 1373, "user_id": 1122720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3917f1f4e64e60f28f301e8369a201d4?s=128&d=identicon&r=PG", "display_name": "sukhmel", "link": "https://stackoverflow.com/users/1122720/sukhmel"}, "edited": false, "score": 0, "creation_date": 1460467950, "post_id": 36570684, "comment_id": 60748490, "body": "main point was to create setter/getter without peeking into object I will focus lens on. Prism will allow to modify/view values, but is it really inevitable to pattern match <code>Example p s</code>, or is it possible to achieve that using only lens? This is main problem at hand: creating lens (or prism) that is not tightly bound to exact implementation, by combining lenses."}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1460472107, "post_id": 36570684, "comment_id": 60751971, "body": "Prisms are Traversals that traverse over up to one value and that if they do traverse over a value, traverse over all available information. We traverse neither over the position part of the record, nor the rest of the storage, so this is not a Prism."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1460472655, "last_edit_date": 1460472655, "creation_date": 1460457199, "answer_id": 36570684, "question_id": 36569994, "link": "https://stackoverflow.com/questions/36569994/haskell-use-first-level-lenses-to-create-complex-lens/36570684#36570684", "title": "Haskell use first level lenses to create complex lens", "body": "<p>I think prisms should be better for this situation as <code>pos</code> could be an integer not larger than your list list long, or negative.</p>\n\n<p>I think you could use something like the <a href=\"https://hackage.haskell.org/package/lens-4.13.2.1/docs/Control-Lens-Prism.html\" rel=\"nofollow\">docu for prisms</a> provide</p>\n\n<blockquote>\n<pre><code>nat :: Prism' Integer Natural\nnat = prism toInteger $ \\ i -&gt;\n   if i &lt; 0\n   then Left i\n   else Right (fromInteger i)\n</code></pre>\n</blockquote>\n\n<pre><code>storageAtPos Prism' Example Int\nstorageAtPos = prism $ aux\n  where aux (Example p s) | p &lt; 0 || p &gt;= length s = Nothing\n                          | otherwise = Just (s !! p)\n</code></pre>\n\n<p>note: i did not run this code - just made an analogue to the docu (have no ghc right now)</p>\n\n<h2>UPDATE</h2>\n\n<p>Maybe something like </p>\n\n<p><code><s>storageAtPos = \\p -> (p^.storage)^?(ix $ p^.pos)</s></code></p>\n\n<p>works, but again - I do not have ghc right now to test - as @Gurkenglas pointed out this is no <code>Prism</code></p>\n"}, {"comments": [{"owner": {"reputation": 1373, "user_id": 1122720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3917f1f4e64e60f28f301e8369a201d4?s=128&d=identicon&r=PG", "display_name": "sukhmel", "link": "https://stackoverflow.com/users/1122720/sukhmel"}, "edited": false, "score": 0, "creation_date": 1460473093, "post_id": 36576151, "comment_id": 60752826, "body": "when I write <code>storage . ix position</code> I get a type error, namely <code>Couldn&#39;t match type &#39;Int&#39;                    with &#39;(Int -&gt; f0 Int) -&gt; Example -&gt; f0 Example&#39;     Expected type: Control.Lens.At.Index [Int]       Actual type: (Int -&gt; f0 Int) -&gt; Example -&gt; f0 Example     In the first argument of &#39;ix&#39;, namely &#39;position&#39;     In the second argument of &#39;(.)&#39;, namely &#39;ix position&#39;</code>"}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "reply_to_user": {"reputation": 1373, "user_id": 1122720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3917f1f4e64e60f28f301e8369a201d4?s=128&d=identicon&r=PG", "display_name": "sukhmel", "link": "https://stackoverflow.com/users/1122720/sukhmel"}, "edited": false, "score": 0, "creation_date": 1460473861, "post_id": 36576151, "comment_id": 60753464, "body": "Shoot, I thought you shadowed position with a local variable of type Int that already pointed to the correct position in the list. I now understand the problem. Hmm."}, {"owner": {"reputation": 1373, "user_id": 1122720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3917f1f4e64e60f28f301e8369a201d4?s=128&d=identicon&r=PG", "display_name": "sukhmel", "link": "https://stackoverflow.com/users/1122720/sukhmel"}, "edited": false, "score": 0, "creation_date": 1460474404, "post_id": 36576151, "comment_id": 60753907, "body": "I have found this <a href=\"http://stackoverflow.com/questions/21255541/how-do-you-write-a-complex-lens-that-depend-on-other-lenses-using-the-lens-libra\" title=\"how do you write a complex lens that depend on other lenses using the lens libra\">stackoverflow.com/questions/21255541/&hellip;</a> question to deal with same problem (although with a twist), now I am trying to create lens with <code>lens get set</code>, but to no avail yet."}, {"owner": {"reputation": 1373, "user_id": 1122720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3917f1f4e64e60f28f301e8369a201d4?s=128&d=identicon&r=PG", "display_name": "sukhmel", "link": "https://stackoverflow.com/users/1122720/sukhmel"}, "edited": false, "score": 0, "creation_date": 1460494941, "post_id": 36576151, "comment_id": 60766868, "body": "wow, that <code>^&gt;&gt;=</code> is so cryptic to me, but that seems to be really what I though of -- like an additional socket to insert object into. I will try playing around with that, thank you."}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": true, "score": 4, "last_activity_date": 1460552767, "last_edit_date": 1460552767, "creation_date": 1460470993, "answer_id": 36576151, "question_id": 36569994, "link": "https://stackoverflow.com/questions/36569994/haskell-use-first-level-lenses-to-create-complex-lens/36576151#36576151", "title": "Haskell use first level lenses to create complex lens", "body": "<p>Edit: I misunderstood the problem, original answer follows at the end.</p>\n\n<p>I don't know any combinator that does what you want, so I wrote one.</p>\n\n<pre><code>(^&gt;&gt;=) :: Lens' s a -&gt; (a -&gt; Lens' s b) -&gt; Lens' s b\n--        Lens' s a -&gt; (a -&gt; (b -&gt; f b) -&gt; s -&gt; f s) -&gt; (b -&gt; f b) -&gt; s -&gt; f s\n-- (That previous line disregards a forall and the Functor constraints)\n(x ^&gt;&gt;= f) btofb s = f (s ^. x) btofb s\n</code></pre>\n\n<p>Leaving out the type signature and asking ghci for it should give us the most general one, so here goes:</p>\n\n<pre><code>:t (^&gt;&gt;=)\nGetting a s a -&gt; (a -&gt; t1 -&gt; s -&gt; t) -&gt; t1 -&gt; s -&gt; t\n</code></pre>\n\n<p>Getting's doc: \"When you see this in a type signature it indicates that you can pass the function a Lens, Getter, Traversal, Fold, Prism, Iso, or one of the indexed variants, and it will just \"do the right thing\".\"</p>\n\n<p>The right side is similarly general, allowing Traversals/Prisms/etc..</p>\n\n<p>Note that this only produces lawful lenslikes if the pointer is not to itself.</p>\n\n<p>Now to apply this combinator - the composition you wanted is:</p>\n\n<pre><code>position ^&gt;&gt;= \\p -&gt; storage . ix p\n</code></pre>\n\n<p>This comes out to be a Traversal, see the original answer.</p>\n\n<p>Or, using another combinator I like:</p>\n\n<pre><code>let (f .: g) x = f . g x in position ^&gt;&gt;= (storage .: ix)\n</code></pre>\n\n<p>Any with some infix declarations you could even get rid of those brackets.</p>\n\n<hr>\n\n<p>(This original answer assumes <code>position :: Int</code> locally shadows the position lens.)</p>\n\n<p>We do not know whether the list has a value at that position, so this is not a Lens', but a Traversal', which stands for \"traversing over any number of values\" rather than \"lensing onto one value\".</p>\n\n<pre><code>storage . ix position :: Traversal' Example Int\n</code></pre>\n\n<p>(^?) will return the first value traversed over if any, and thus this term will give you the Int if that position is valid, or Nothing if it isn't.</p>\n\n<pre><code>(^? storage . ix position) :: Example -&gt; Maybe Int\n</code></pre>\n\n<p>This partial version of that will assume that the position is valid and crash if it isn't.</p>\n\n<pre><code>(^?! storage . ix position) :: Example -&gt; Int\n</code></pre>\n\n<p>(%~), which applies the function on the right to everything traversed over on the left, works not only for Lenses but all Traversals. (Every Lens is a Traversal by clever ekmett-trickery, and can be inserted anywhere a Traversal can go.)</p>\n\n<pre><code>storage . ix position %~ (+1) :: Example -&gt; Example\n</code></pre>\n\n<p>And if you absolutely must work with a Lens, any of these partial terms will crash if you try to apply them at invalid positions.</p>\n\n<pre><code>singular $ storage . ix position :: Lens' Example Int\nstorage . singular (ix position) :: Lens' Example Int\n</code></pre>\n\n<p>PS: Your record looks like you might want zippers instead: If you only ever move forward/backward incrementally, you'd do less smelly (!!) stuff if you keep track of the list of values to the left of your current position, the value at your current position, and the list of values to the right of your current position, rather than the list of all values and your position in it. For more lensy fun, check out <a href=\"https://hackage.haskell.org/package/lens-3.2/docs/Control-Lens-Zipper.html\" rel=\"nofollow\">Control.Lens.Zipper</a>, but those are optimized to gracefully nest multiple levels of zippering.</p>\n"}, {"tags": [], "owner": {"reputation": 1373, "user_id": 1122720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3917f1f4e64e60f28f301e8369a201d4?s=128&d=identicon&r=PG", "display_name": "sukhmel", "link": "https://stackoverflow.com/users/1122720/sukhmel"}, "is_accepted": false, "score": 2, "last_activity_date": 1460476260, "last_edit_date": 1460476260, "creation_date": 1460475154, "answer_id": 36577846, "question_id": 36569994, "link": "https://stackoverflow.com/questions/36569994/haskell-use-first-level-lenses-to-create-complex-lens/36577846#36577846", "title": "Haskell use first level lenses to create complex lens", "body": "<p>It seems, that easiest way to achieve this is to write getter and setter using lenses, and then compose a lens:</p>\n\n<pre><code>at_position :: Functor f =&gt; (Int -&gt; f Int) -&gt; Example -&gt; f Example\nat_position = lens get set\n    where\n        get :: Example -&gt; Int\n        get e = fromJust $ e ^? storage . ix (e^.position)\n\n        set :: Example -&gt; Int -&gt; Example\n        set e v = e &amp; storage . ix (e^.position) .~ v\n</code></pre>\n\n<p>although this maybe could improved, but the code is clear enough, and is not restricted to object structure.</p>\n"}], "owner": {"reputation": 1373, "user_id": 1122720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3917f1f4e64e60f28f301e8369a201d4?s=128&d=identicon&r=PG", "display_name": "sukhmel", "link": "https://stackoverflow.com/users/1122720/sukhmel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 2, "accepted_answer_id": 36576151, "answer_count": 3, "score": 3, "last_activity_date": 1460552767, "creation_date": 1460455498, "question_id": 36569994, "link": "https://stackoverflow.com/questions/36569994/haskell-use-first-level-lenses-to-create-complex-lens", "title": "Haskell use first level lenses to create complex lens", "body": "<p>Let's say, I have an object with two fields:</p>\n\n<pre><code>data Example = Example { _position :: Int\n                       , _storage  :: [Int]}\n</code></pre>\n\n<p>how do I construct a lens that focuses on <code>position</code> element inside <code>storage</code>?</p>\n\n<p>Also, will it be possible to restrict <code>position</code> values being modified via lenses to a range based on <code>storage</code> size?</p>\n\n<p>It seems like <a href=\"http://hackage.haskell.org/package/lens-4.5/docs/Control-Lens-Lens.html#v:alongside\" rel=\"nofollow\">alongside</a> could be used somehow, since <code>Example</code> is isomorphic to a tuple, but I can't comprehend the way to do that.</p>\n\n<p>I'm not sure how to phrase the question, so I was unable to find much relevant info.</p>\n"}, {"tags": ["haskell", "yesod", "servant"], "comments": [{"owner": {"reputation": 7086, "user_id": 3461955, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/4FV5L.png?s=128&g=1", "display_name": "KittMedia", "link": "https://stackoverflow.com/users/3461955/kittmedia"}, "edited": false, "score": 0, "creation_date": 1460451175, "post_id": 36567481, "comment_id": 60735630, "body": "Which error is displayed?"}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1460455262, "post_id": 36567481, "comment_id": 60738646, "body": "Looking at the documentation of <code>shakespeare</code>, it looks like the <code>hamlet</code> QQ produces things of type <code>HtmlUrl</code>, but <code>shamlet</code> produces things of type <code>Html</code>. Does using <code>shamlet</code> in place of <code>hamlet</code> work?"}, {"owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "edited": false, "score": 0, "creation_date": 1460455987, "post_id": 36567481, "comment_id": 60739202, "body": "Error on display: Couldn&#39;t match type \u2018t0 -&gt; Markup\u2019                    with \u2018transformers-0.4.2.0:Control.Monad.Trans.Reader.ReaderT                            Config                            (Control.Monad.Trans.Either.EitherT ServantErr IO)                            (blaze-markup-0.7.0.3:Text.Blaze.Internal.MarkupM ())\u2019     Expected type: ServerT TestAPI AppM       Actual type: AppM [Test] :&lt;|&gt; (AppM Test :&lt;|&gt; (t0 -&gt; Markup))     In the expression: tests :&lt;|&gt; test :&lt;|&gt; testHtml     In an equation for \u2018serverTestAPI\u2019:         serverTestAPI = tests :&lt;|&gt; test :&lt;|&gt; testHtml"}, {"owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "edited": false, "score": 0, "creation_date": 1460456504, "post_id": 36567481, "comment_id": 60739537, "body": "hamlet and shamlet does not work!"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460458714, "post_id": 36567481, "comment_id": 60741024, "body": "I would recommend to add the signature to <code>testHtml</code> (probably <code>testHtml :: HTML</code>) - then you the error should point you to the hamlet part instead"}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1460464200, "post_id": 36567481, "comment_id": 60745146, "body": "All in all, there&#39;s too much unclear here. Please provide an example that makes it possible to actually reproduce the error."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 1, "last_activity_date": 1460464591, "creation_date": 1460464591, "answer_id": 36573488, "question_id": 36567481, "link": "https://stackoverflow.com/questions/36567481/using-servant-with-yesod-shakespeare-hamlet-julius-lucius/36573488#36573488", "title": "Using Servant with Yesod shakespeare (Hamlet, Julius, Lucius)", "body": "<p>As @Carsten points out, in this case what you want is <code>shamlet</code>. The key thing is implementing proper instances of the <code>ToMarkup</code> typeclass. I recommend you to read this <a href=\"http://www.yesodweb.com/book/shakespearean-templates\" rel=\"nofollow\">excellent introduction</a> on Shakespeare templates. A working example:</p>\n\n<pre><code>data Person = Person\n  { firstName :: String\n  , lastName  :: String\n  } deriving Generic \n\ninstance ToJSON Person\n\ntype PersonAPI = \"persons\" :&gt; Get '[JSON, HTML] [Person]\n\npeople :: [Person]\npeople =\n  [ Person \"Isaac\"  \"Newton\"\n  , Person \"Albert\" \"Einstein\"\n  ]\n\ninstance ToMarkup Person where\n  toMarkup person = showPerson person\n\n  -- this isn't properly implemented\n  preEscapedToMarkup p = showPerson p\n\n-- HTML serialization of a list of persons\ninstance ToMarkup [Person] where\n  toMarkup persons = showPersons persons\n\n  preEscapedToMarkup p = showPersons p\n\nshowPerson :: Person -&gt; Html\nshowPerson p = [shamlet|\n&lt;body&gt;\n    &lt;p&gt;This is my page.\n    &lt;h1&gt;#{firstName p}\n|]\n\nshowPersons :: [Person] -&gt; Html\nshowPersons p = [shamlet|\n&lt;body&gt;\n    &lt;p&gt;This is my page.\n     $forall person &lt;- p\n      &lt;h1&gt;#{firstName person}\n|]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": false, "score": 2, "last_activity_date": 1460465177, "creation_date": 1460465177, "answer_id": 36573722, "question_id": 36567481, "link": "https://stackoverflow.com/questions/36567481/using-servant-with-yesod-shakespeare-hamlet-julius-lucius/36573722#36573722", "title": "Using Servant with Yesod shakespeare (Hamlet, Julius, Lucius)", "body": "<p>Here is a small complete example that works for me:</p>\n\n<pre><code>{-# LANGUAGE DataKinds, PolyKinds, TypeOperators, DeriveGeneric #-}\n{-# LANGUAGE QuasiQuotes #-}\nmodule Main where\n\nimport Data.Aeson\nimport Data.Proxy\nimport GHC.Generics\nimport Network.Wai.Handler.Warp\nimport Servant.API\nimport Servant.HTML.Blaze\nimport Servant.Server\nimport Text.Blaze.Html\nimport Text.Hamlet\n\ndata Test = Test Int String\n  deriving (Generic)\n\ninstance ToJSON Test\n\ntype TestAPI \n    =    \"tests\" :&gt; Get '[JSON] [Test]\n    :&lt;|&gt; \"Test.html\" :&gt; Get '[HTML] Html\n\nmain :: IO ()\nmain = run 8080 (serve (Proxy :: Proxy TestAPI) serverTestAPI)\n\nserverTestAPI :: Server TestAPI\nserverTestAPI = tests :&lt;|&gt; testHtml\n\ntests = return [ Test 1 \"Test 1\"\n               , Test 2 \"Test 2\"\n               ]\n\ntestHtml = return [shamlet|\n  $doctype 5\n  &lt;html&gt;\n     &lt;head&gt;\n       &lt;title&gt;This is a title\n     &lt;body&gt;\n       &lt;p&gt;This is text\n  |]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "is_accepted": false, "score": 1, "last_activity_date": 1460465817, "creation_date": 1460465817, "answer_id": 36573998, "question_id": 36567481, "link": "https://stackoverflow.com/questions/36567481/using-servant-with-yesod-shakespeare-hamlet-julius-lucius/36573998#36573998", "title": "Using Servant with Yesod shakespeare (Hamlet, Julius, Lucius)", "body": "<p>Thank you all for your help! \n<BR> \nImplemented as follows: \n<BR></p>\n\n<pre><code>&lt;code&gt;type TestAPI \n    = \"tests\" :&gt; Get '[JSON] [Test]\n    :&lt;|&gt; \"test\" :&gt; Get '[JSON] Test\n    :&lt;|&gt; \"TestHTML.html\" :&gt; Get '[HTML] Page_TestHTML \n\nserverTestAPI :: ServerT TestAPI AppM\nserverTestAPI = tests \n           :&lt;|&gt; test\n           :&lt;|&gt; testHtml\n\ndata Page_TestHTML = Page_TestHTML\n\ninstance ToMarkup Page_TestHTML where\n    toMarkup Page_TestHTML = builderHtml  \n\ntestHtml = return Page_TestHTML\n\nbuilderHtml = [shamlet|\n                $doctype 5\n                &lt;html&gt;\n                    &lt;head&gt;\n                        &lt;title&gt;Greeting2\n                &lt;body&gt;\n                    &lt;h2&gt; Hello world HTML Qqqqq |]&lt;/code&gt;\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 1, "accepted_answer_id": 36573488, "answer_count": 3, "score": 1, "last_activity_date": 1460465817, "creation_date": 1460449314, "last_edit_date": 1460452636, "question_id": 36567481, "link": "https://stackoverflow.com/questions/36567481/using-servant-with-yesod-shakespeare-hamlet-julius-lucius", "title": "Using Servant with Yesod shakespeare (Hamlet, Julius, Lucius)", "body": "<p>How i can use shakespeare (from yesod) for servant webservices APIs?</p>\n\n<p>I try:</p>\n\n<pre><code>type TestAPI \n    = \"tests\" :&gt; Get '[JSON] [Test]\n    :&lt;|&gt; \"Test.html\" :&gt; Get '[HTML] Html\n\nserverTestAPI :: ServerT TestAPI AppM\nserverTestAPI = tests \n           :&lt;|&gt; test\n           :&lt;|&gt; testHtml\n\ntests :: AppM [Test]\ntests = do return [ Test 1 \"Test 1\"\n                  , Test 2 \"Test 2\"\n                  ]\n\ntestHtml = [hamlet|\n                $doctype 5\n                 .........\n                 |]\n</code></pre>\n\n<p>But I get error!</p>\n"}, {"tags": ["haskell", "parsec"], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 5367513, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7bc3967ca71ebcd3dbb20b5b7552a904?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Syn&#225;\u010dek", "link": "https://stackoverflow.com/users/5367513/jan-syn%c3%a1%c4%8dek"}, "edited": false, "score": 0, "creation_date": 1460446736, "post_id": 36566346, "comment_id": 60732713, "body": "Unfortunately, this doesn&#39;t work. Even doing something similar to the &#39;command&#39; function still makes the parser complain about spaces."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 315, "user_id": 5367513, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7bc3967ca71ebcd3dbb20b5b7552a904?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Syn&#225;\u010dek", "link": "https://stackoverflow.com/users/5367513/jan-syn%c3%a1%c4%8dek"}, "edited": false, "score": 0, "creation_date": 1460447277, "post_id": 36566346, "comment_id": 60733071, "body": "@JanSyn&#225;\u010dek Edited and tested. This works, but there might be a more efficient way."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1460447251, "last_edit_date": 1460447251, "creation_date": 1460445898, "answer_id": 36566346, "question_id": 36565943, "link": "https://stackoverflow.com/questions/36565943/parsec-how-to-silence-parser-errors-about-white-spaces/36566346#36566346", "title": "Parsec: How to silence parser errors about white spaces", "body": "<p>This appears to work</p>\n\n<pre><code>lineRedirect = do\n  lcmd &lt;- P.try (P.spaces *&gt; P.many1 command) P.&lt;?&gt; \"command\"\n  ...\n</code></pre>\n\n<p>I don't like the <code>try</code>, though.</p>\n"}, {"tags": [], "owner": {"reputation": 315, "user_id": 5367513, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7bc3967ca71ebcd3dbb20b5b7552a904?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Syn&#225;\u010dek", "link": "https://stackoverflow.com/users/5367513/jan-syn%c3%a1%c4%8dek"}, "is_accepted": true, "score": 2, "last_activity_date": 1460451166, "creation_date": 1460451166, "answer_id": 36568176, "question_id": 36565943, "link": "https://stackoverflow.com/questions/36565943/parsec-how-to-silence-parser-errors-about-white-spaces/36568176#36568176", "title": "Parsec: How to silence parser errors about white spaces", "body": "<p>After realizing that <code>spaces</code> is already a composite parser with its own error message, everything was easy...</p>\n\n<p>Here is what I came up with:</p>\n\n<pre><code>lineRedirect :: P.Parsec String () (String, String)\nlineRedirect = do\n  cmd &lt;- spaces' *&gt; command\n  P.char '&gt;'\n  tgt &lt;- spaces' *&gt; target\n  return (cmd, tgt)\n\n  where\n    command :: P.Parsec String () String\n    command = (P.many1 (P.noneOf \"&gt;\") P.&lt;?&gt; \"command\")  &lt;* spaces'\n\n    target :: P.Parsec String () String\n    target = (P.many1 P.anyChar P.&lt;?&gt; \"redirection target\") &lt;* spaces' &lt;* P.eof\n\n    spaces' = P.skipMany (P.space P.&lt;?&gt; \"\")\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 5367513, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/7bc3967ca71ebcd3dbb20b5b7552a904?s=128&d=identicon&r=PG&f=1", "display_name": "Jan Syn&#225;\u010dek", "link": "https://stackoverflow.com/users/5367513/jan-syn%c3%a1%c4%8dek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 36568176, "answer_count": 2, "score": 2, "last_activity_date": 1460451166, "creation_date": 1460444787, "question_id": 36565943, "link": "https://stackoverflow.com/questions/36565943/parsec-how-to-silence-parser-errors-about-white-spaces", "title": "Parsec: How to silence parser errors about white spaces", "body": "<p>I have the following parser for parsing BASH-like lines containing redirection.</p>\n\n<pre><code>lineRedirect :: P.Parsec String () String\nlineRedirect = do\n  lcmd &lt;- P.spaces *&gt; (P.many1 command P.&lt;?&gt; \"command\")\n  P.char '&gt;'\n  rcmd &lt;- P.spaces *&gt; (P.many1 command P.&lt;?&gt; \"redirection target\")\n  return $ (intercalate \";\" lcmd) ++ \" ++ \" ++ (intercalate \";\" rcmd)   \n  where\n    command :: P.Parsec String () String\n    command = P.many1 P.alphaNum &lt;* P.spaces\n</code></pre>\n\n<p>It seems to be working just fine, but I'd like to silence any \"expecting space\" or \"expecting whitespace\" that appear.</p>\n\n<p>For example:</p>\n\n<pre><code>&gt; P.parseTest lineRedirect \"   &gt; target\"\nparse error at (line 1, column 4):\nunexpected \"&gt;\"\nexpecting space or command\n</code></pre>\n\n<p>I'd like to have just \"expecting command\" here.</p>\n\n<pre><code>&gt; P.parseTest lineRedirect \"invalid! &gt; target\"\nparse error at (line 1, column 8):\nunexpected \"!\"\nexpecting letter or digit, white space or \"&gt;\"\n</code></pre>\n\n<p>Same here, without the \"white space\".</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1460435630, "post_id": 36563660, "comment_id": 60727545, "body": "it&#39;s probably because you try to <i>draw out</i>  <code>result</code> from a <i>sum</i> - I guess you wanted <code>let squareSum list = [ x^2 + y^2 + z^2 | (x, y, z) &lt;- list]</code>?"}, {"owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460435981, "post_id": 36563660, "comment_id": 60727653, "body": "Thanks Carsten. I tried, but still facing same issue.      Prelude&gt; let squareSum list = [ x^2 + y^2 + z^2 | (x, y, z) &lt;- list] Prelude&gt; squareSum [1, 2, 3]  &lt;interactive&gt;:33:1:     Non type-variable argument in the constraint: Num (t, t, t)     (Use FlexibleContexts to permit this)     When checking that \u2018it\u2019 has the inferred type       it :: forall t. (Num t, Num (t, t, t)) =&gt; [t]"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460436425, "post_id": 36563660, "comment_id": 60727788, "body": "because the way you defined it with your tuple in the first place you have to call it like <code>[(1,2,3),(4,5,6)]</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460436476, "post_id": 36563660, "comment_id": 60727803, "body": "to get your <i>example</i>  working use <code>let squareSum xs = sum [ x^2 | x &lt;- xs]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "is_accepted": false, "score": -1, "last_activity_date": 1460436979, "last_edit_date": 1460436979, "creation_date": 1460436886, "answer_id": 36563906, "question_id": 36563660, "link": "https://stackoverflow.com/questions/36563660/haskell-list-comprehension-non-type-variable-argument-in-the-constraint-num/36563906#36563906", "title": "Haskell: list comprehension: Non type-variable argument in the constraint: Num [t]", "body": "<p>Following snippet solved my problem.</p>\n\n<pre><code>Prelude&gt; let processData fun list = [y | x &lt;- list, let y = fun x]\nPrelude&gt; let sumSquare (x, y, z) = x^2 + y^2 + z^2\nPrelude&gt; \nPrelude&gt; processData sumSquare [(1, 2, 3), (4, 5, 6)]\n[14,77]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 5, "last_activity_date": 1460453582, "last_edit_date": 1592644375, "creation_date": 1460436899, "answer_id": 36563908, "question_id": 36563660, "link": "https://stackoverflow.com/questions/36563660/haskell-list-comprehension-non-type-variable-argument-in-the-constraint-num/36563908#36563908", "title": "Haskell: list comprehension: Non type-variable argument in the constraint: Num [t]", "body": "<h1>Original Question</h1>\n<p>You posted:</p>\n<pre><code>Prelude&gt; let squareSum list = [result | (x, y, z) &lt;- list, result &lt;- x^2 + y^2 + z^2]\n\n&lt;interactive&gt;:3:5:\n    Non type-variable argument in the constraint: Num [t]\n    (Use FlexibleContexts to permit this)\n    When checking that \u2018squareSum\u2019 has the inferred type\n      squareSum :: forall t. Num [t] =&gt; [([t], [t], [t])] -&gt; [t]\n</code></pre>\n<p>This is coming from the inference that is the computation <code>x^2 + y^2 + z^2</code> must be a list, due to using it as a source of values in a list comprehension (<code>result &lt;- ...</code>).  And if that is a list, then the mathematical operators are over list typed value, which means your initial variables, <code>list</code> must be a list of tuples of lists (<code>[([t],[t],[t])]</code>) and each list must in some way be valid numbers (<code>Num [t]</code>).</p>\n<h1>Comment Question</h1>\n<pre><code>Prelude&gt; let squareSum list = [ x^2 + y^2 + z^2 | (x, y, z) &lt;- list]\nPrelude&gt; squareSum [1,2,3]\n\n&lt;interactive&gt;:9:1:\n    Non type-variable argument in the constraint: Num (t, t, t)\n    (Use FlexibleContexts to permit this)\n    When checking that \u2018it\u2019 has the inferred type\n      it :: forall t. (Num t, Num (t, t, t)) =&gt; [t]\n</code></pre>\n<p>Now you say that the variable <code>list</code> contains tuples (<code>(x, y, z) &lt;- list</code>) but then you define list as <code>[1,2,3]</code>.  To satisfy both, the numeric literals of <code>1</code>, <code>2</code> and <code>3</code> must represent tuples, which is possible if you defined a class instance <code>Num (t, t, t)</code>.</p>\n<h1>What You Want</h1>\n<p>Carter already told you the solution, but you didn't apply it to a sensible list.  How about we define a solution and give it an explicit type so there is less confusion!</p>\n<pre><code>Prelude&gt; :{\nPrelude| let squareSum :: [(Int,Int,Int)] -&gt; [Int]\nPrelude|     squareSum list = [ x^2 + y^2 + z^2 | (x, y, z) &lt;- list]\nPrelude| :}\nPrelude&gt; squareSum [(1,2,3), (4,5,6)]\n[14,77]\n</code></pre>\n<p>Success!  We provided two tuples and get two Int results, yay!</p>\n"}], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1171, "favorite_count": 1, "accepted_answer_id": 36563908, "answer_count": 2, "score": -1, "last_activity_date": 1460453582, "creation_date": 1460435498, "question_id": 36563660, "link": "https://stackoverflow.com/questions/36563660/haskell-list-comprehension-non-type-variable-argument-in-the-constraint-num", "title": "Haskell: list comprehension: Non type-variable argument in the constraint: Num [t]", "body": "<p>When I am trying to run following function, I am getting error.</p>\n\n<pre><code>Prelude&gt; let squareSum list = [result | (x, y, z) &lt;- list, result &lt;- x^2 + y^2 + z^2] \n\n&lt;interactive&gt;:4:5:\n    Non type-variable argument in the constraint: Num [t]\n    (Use FlexibleContexts to permit this)\n    When checking that \u2018squareSum\u2019 has the inferred type\n     squareSum :: forall t. Num [t] =&gt; [([t], [t], [t])] -&gt; [t]\n</code></pre>\n\n<p>Can some one explain me, How to fix this? What is this error conveying exactly?</p>\n"}, {"tags": ["parsing", "csv", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 5, "last_activity_date": 1460434730, "creation_date": 1460434730, "answer_id": 36563549, "question_id": 36563479, "link": "https://stackoverflow.com/questions/36563479/real-world-haskells-csv-parser-implementation/36563549#36563549", "title": "Real World Haskell&#39;s CSV Parser implementation", "body": "<p>it's the <a href=\"https://hackage.haskell.org/package/parsec-3.1.9/docs/Text-Parsec.html#t:SourceName\" rel=\"noreferrer\"><code>SourceName</code></a> - it's used to give you some better representation in the error case.</p>\n\n<p>It's part of the <code>SourcePos</code> you will get with many things in <em>Parsec</em> - for example the <a href=\"https://hackage.haskell.org/package/parsec-3.1.9/docs/Text-Parsec.html#t:ParseError\" rel=\"noreferrer\"><code>ParseError</code></a> you get in the error-case.</p>\n\n<p>You might want to have something like \"error in file SourceName on line x / column y\" ;)</p>\n\n<p>From inside your own computations you can get it with <a href=\"https://hackage.haskell.org/package/parsec-3.1.9/docs/Text-Parsec.html#v:getPosition\" rel=\"noreferrer\"><code>getPosition</code></a> (which gives you a <code>SourcePos</code> again - from there you can use <code>sourceName</code> on to get this parameter)</p>\n"}], "owner": {"reputation": 2534, "user_id": 2122392, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/oBPqA.jpg?s=128&g=1", "display_name": "David Shaked", "link": "https://stackoverflow.com/users/2122392/david-shaked"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 1, "accepted_answer_id": 36563549, "answer_count": 1, "score": 2, "last_activity_date": 1460434730, "creation_date": 1460434172, "question_id": 36563479, "link": "https://stackoverflow.com/questions/36563479/real-world-haskells-csv-parser-implementation", "title": "Real World Haskell&#39;s CSV Parser implementation", "body": "<p>Goerzen et al <a href=\"http://book.realworldhaskell.org/read/using-parsec.html\" rel=\"nofollow\">present</a> a simple implementation of a CSV file parser to teach readers of <em>Real World Haskell</em> about the Parsec parsing combinator library.</p>\n\n<p>Here's a version of their concise program:</p>\n\n<pre><code>import Text.ParserCombinators.Parsec\n\ncsvFile = endBy line eol\nline = sepBy cell (char ',')\ncell = many (noneOf \",\\n\")\neol = char '\\n'\n\nparseCSV :: String -&gt; Either ParseError [[String]]\nparseCSV input = parse csvFile \"(unknown)\" input\n</code></pre>\n\n<p>The code runs as expected, but <strong>I don't understand the purpose of passing the string \"(unknown)\" argument in the final line</strong>. Is this some idiom I'm not aware of?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1460435113, "post_id": 36563365, "comment_id": 60727381, "body": "those probably have all different types right? If not you should be able to translate this into a list-representation using <code>mapM</code> or <code>forM</code> - but it will not get much nicer I guess - but if you look closely it seems that you only use 2 values together so instead of a really long list why don&#39;t you make use of this?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1460435214, "post_id": 36563365, "comment_id": 60727415, "body": "I don&#39;t think there&#39;s any need for some fancy refactoring technique, a simple function will probably do the trick. e.g. something like <code>f :: (States -&gt; Reference a) -&gt; (States -&gt; Reference b) -&gt; (a -&gt; b -&gt; IO a) -&gt; IO a = \\val dval f -&gt; join (f &lt;$&gt; readReference (val states) &lt;*&gt; readReference (dval states)) &gt;&gt;= writeReference (val states)</code> - obviously without knowing exact types (at least) I couldn&#39;t say exactly how it would look. If all the references have the same type, use some sort of <code>map</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1679, "user_id": 1722752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef35ad86b627ba3176b6aea8a184f51c?s=128&d=identicon&r=PG", "display_name": "MigMit", "link": "https://stackoverflow.com/users/1722752/migmit"}, "is_accepted": false, "score": 1, "last_activity_date": 1460443849, "creation_date": 1460443849, "answer_id": 36565600, "question_id": 36563365, "link": "https://stackoverflow.com/questions/36563365/is-there-a-way-to-repeat-a-binding/36565600#36565600", "title": "Is there a way to repeat a binding?", "body": "<p>First of all: is it possible to rearrange read and write operations? If so, you can get away with something as simple as</p>\n\n<pre><code>let updateOne val dval = do\n    _val = readReference (val states)\n    _dval = readReference (dval states)\n    writeReference (val states) (euler _val _dval)\n</code></pre>\n\n<p>and then just use it like</p>\n\n<pre><code>eulerUpdate states timestep = do\n    updateOne val1 dval1\n    updateOne val2 dval2\n    ...\n</code></pre>\n\n<p>If not, and writing upsets the reading, well, you might want to get creative and keep read and write operations separate, but in the same structure:</p>\n\n<pre><code>data ReadWriteReference where\n    ReadWriteReference :: (States -&gt; IO a) -&gt; (States -&gt; a -&gt; IO ()) -&gt; ReadWriteReference\nperformReadWrite :: States -&gt; ReadWriteReference -&gt; IO ()\nperformReadWrite states (ReadWriteReference read write) = do\n    a &lt;- read states\n    write states a\nmakeRW :: (States -&gt; Reference) -&gt; (States -&gt; Reference) -&gt; ReadWriteReference\nmakeRW val dval = ReadWriteReference read write where\n    read states = do\n        _val &lt;- readReference (val states)\n        _dval &lt;- readReference (dval states)\n        writeReference (val states) (euler _val _dval)\n(&lt;+&gt;) :: ReadWriteReference -&gt; ReadWriteReference -&gt; ReadWriteReference\nReadWriteReference read1 write1 &lt;+&gt; ReadWriteReference read2 write2 = ReadWriteReference read write where\n    read states = do\n        a &lt;- read1 states\n        b &lt;- read2 states\n        return (a, b)\n    write states (a, b) = do\n        write1 states a\n        write2 states b\n</code></pre>\n\n<p>Now you can use it like this:</p>\n\n<pre><code>performReadWrite states $ makeRW val1 dval1 &lt;+&gt; makeRW val2 dval2 &lt;+&gt; ... &lt;+&gt; makeRW valn dvaln\n</code></pre>\n\n<p>You can even make ReadWriteReference an instance of Monoid and use standard combinators.</p>\n"}], "owner": {"reputation": 11, "user_id": 5719459, "user_type": "registered", "profile_image": "https://graph.facebook.com/925706187518815/picture?type=large", "display_name": "Jonathan Merklin", "link": "https://stackoverflow.com/users/5719459/jonathan-merklin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1460443849, "creation_date": 1460433411, "question_id": 36563365, "link": "https://stackoverflow.com/questions/36563365/is-there-a-way-to-repeat-a-binding", "title": "Is there a way to repeat a binding?", "body": "<p>I'm maintaining some code where there is, unfortunately, a wide use of references to keep track of states within the program. There's a particularly egregious use of them in one module which updates numerous values via Euler's method:</p>\n\n<pre><code>eulerUpdate states timestep = do\n  _val1  &lt;- readReference (val1 states)\n  _dval1 &lt;- readReference (dval1 states) \n  _val2  &lt;- readReference (val2 states)\n  _dval2 &lt;- readReference (dval2 states)\n    -- ...\n  _valn  &lt;- readReference (valn states)\n  _dvaln &lt;- readReference (dvaln states)\n  let euler val deriv = val + deriv * timestep\n  writeReference (val1 states) euler _val1 _dval1\n    -- ...\n  writeReference (valn states) euler _valn _dvaln\n</code></pre>\n\n<p>I'm relatively new to Haskell, but my understanding is that this a terrible, horrible, no good, very bad thing. Instead of refactoring everything else around it, I was hoping there might be some way to at least compact it into fewer LOC for readability. Is there anything that could be done here to \"map\" the <code>readReference (x states)</code> into a bunch of identifiers? I've looked more into Kliesli arrows but I don't see much that will help me here.</p>\n"}, {"tags": ["user-interface", "haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1460416473, "post_id": 36560373, "comment_id": 60722162, "body": "There are almost 500 packages in the <a href=\"http://hackage.haskell.org/packages/#cat:Graphics\" rel=\"nofollow noreferrer\">graphics section of Hackage</a>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1460421018, "post_id": 36560373, "comment_id": 60723515, "body": "You can certainly do this with gtk2hs alone, in fact I daresay this is overall going to be easiest (because it&#39;s so fully featured and well-supported). As far as examples go, I&#39;d reckommend my <a href=\"http://hackage.haskell.org/package/dynamic-plot-0.1.2.0/docs/Graphics-Dynamic-Plot-R2.html\" rel=\"nofollow noreferrer\">dynamic-plot library</a>, which actually focuses on exactly this kind of task (but I haven&#39;t used it for anything fractal yet)."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1460425266, "post_id": 36560373, "comment_id": 60724706, "body": "@DanielWagner That&#39;s what makes this a good question."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1460439755, "post_id": 36560373, "comment_id": 60728880, "body": "@PyRulez: <i>&quot;Do you have any suggestions of what GUI\\Graphics Libarary I should be using?&quot;</i> makes it an off-topic question, see the <a href=\"https://stackoverflow.com/help/on-topic\">help center</a>."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460452843, "post_id": 36560373, "comment_id": 60736813, "body": "@Zeta You can take a look at <a href=\"https://www.reddit.com/r/haskell/comments/4edxwz/zoomable_gui_library/\" rel=\"nofollow noreferrer\">reddit.com/r/haskell/comments/4edxwz/zoomable_gui_library</a>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1460454402, "post_id": 36560373, "comment_id": 60737953, "body": "@PyRulez I think you&#39;ve missed my point. Daniel&#39;s comment exactly states why this question <b><i>isn&#39;t</i></b> a good one (for StackOverflow). Also, I&#39;ve already commented on the reddit topic three hours ago."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460454711, "post_id": 36560373, "comment_id": 60738188, "body": "@Zeta Oh wait, I thought you where the OP asking that question to me (and didn&#39;t see the second half of the comment). Sorry."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1460455095, "post_id": 36560373, "comment_id": 60738503, "body": "@PyRulez No problem. Was just slightly confused. (I usually put quotes in italics in comments, since <code>&gt; blockquote</code> syntax doesn&#39;t work :/)."}], "owner": {"reputation": 143, "user_id": 4160007, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f2a65f6107f9689e0140606f6c344c2e?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/4160007/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 640, "favorite_count": 0, "closed_date": 1460425986, "answer_count": 0, "score": 3, "last_activity_date": 1492348252, "creation_date": 1460413541, "last_edit_date": 1492348252, "question_id": 36560373, "link": "https://stackoverflow.com/questions/36560373/haskel-gui-libraries", "closed_reason": "Not suitable for this site", "title": "Haskel, GUI Libraries", "body": "<p>I am implementing the Mandelbrot-set in Haskell. I am want to create zoomable version of the mandeblrot set hence I want to create a GUI application where mandelbrot image takes all the screen and <strong>the user can draw a rectangle on the screen by holding down the mouse and dragging to create a rectangle</strong> the area under the rectangle will then be zoomed in. </p>\n\n<p>I have manged to create mandelbrot computation functions in Haskell, However I am having trouble finding a library that allows me to generate an image and implenent the interactive zooming functionality that I want.</p>\n\n<p>Do you have any suggestions of what GUI\\Graphics Library I should be using? Ideally the library should be well documented with samples as i am an amature in functional programming </p>\n"}, {"tags": ["haskell", "vector"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1460409931, "post_id": 36559428, "comment_id": 60719554, "body": "I think the only documentation is in the cited papers. You will likely find it difficult to find people who fully understand that part of the code, unfortunately."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1460721473, "post_id": 36559428, "comment_id": 60886271, "body": "Is there any reason not to use the <code>Stream</code> infrastructure for the use case you are imagining? It is much older (and thus more stable) than the new <code>Bundle</code> material, and is universally well understood, as e.g. the corresponding material in <code>text</code> and <code>stream-fusion</code> will show."}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "edited": false, "score": 0, "creation_date": 1460721955, "post_id": 36559428, "comment_id": 60886636, "body": "To be honest I haven&#39;t looked at the <code>Stream</code> interface. The <code>Bundle</code> one was the one I found first. So from looking at it more closely the <code>Bundle</code> interface in fact <i>is</i> the <code>Stream</code> interface that was just renamed to <code>Bundle</code> in 2012."}], "answers": [{"comments": [{"owner": {"reputation": 16, "user_id": 6193683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42938916ca3cd0d228fd0f8c5031dff1?s=128&d=identicon&r=PG&f=1", "display_name": "Blackett", "link": "https://stackoverflow.com/users/6193683/blackett"}, "edited": false, "score": 0, "creation_date": 1460834322, "post_id": 36575289, "comment_id": 60929027, "body": "In fact, looking at the bundle type in detail, I came across this very interesting paper clarifing the meaning of &quot;a bundle of streams&quot;: <a href=\"http://dx.doi.org/10.1145/2500365.2500601\" rel=\"nofollow noreferrer\">dx.doi.org/10.1145/2500365.2500601</a>. Certainly a good read and highly informative."}], "tags": [], "owner": {"reputation": 16, "user_id": 6193683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42938916ca3cd0d228fd0f8c5031dff1?s=128&d=identicon&r=PG&f=1", "display_name": "Blackett", "link": "https://stackoverflow.com/users/6193683/blackett"}, "is_accepted": true, "score": 0, "last_activity_date": 1460468974, "creation_date": 1460468974, "answer_id": 36575289, "question_id": 36559428, "link": "https://stackoverflow.com/questions/36559428/can-i-use-the-bundle-module-of-the-vector-library/36575289#36575289", "title": "Can I use the Bundle module of the vector library?", "body": "<p>I think what you're looking for is the function: <code>unstream :: Vector v a =&gt; Bundle v a -&gt; v a</code> as implemented in the data.vector.generic.(new) module.\nRefering to your <code>toVector</code> code example, I would rather suggest to avoid relying on the size hint given for the manually constructed stream/bundle and instead use a (possibly) more efficient method for the construction of the vector, e.g. by using the function: <code>generateM :: Monad m =&gt; Int -&gt; (Int -&gt; m a) -&gt; m (Vector a)</code>. </p>\n\n<p>In addition, from a pure conceptual view, I'm wondering whether <code>Leaf a</code> as it stands is basically equivalent to <code>Node a Empty Empty</code> and therefore possibly redundant? How's this: <code>type Leaf a = Node a Empty Empty</code>?</p>\n"}], "owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 36575289, "answer_count": 1, "score": 0, "last_activity_date": 1460468974, "creation_date": 1460409533, "question_id": 36559428, "link": "https://stackoverflow.com/questions/36559428/can-i-use-the-bundle-module-of-the-vector-library", "title": "Can I use the Bundle module of the vector library?", "body": "<p>Simple question: can I use the API under <code>Data.Vector.Fusion.Bundle</code>? Is it considered public and stable? And if yes: is there more information available how to use it?</p>\n\n<p>An example would be writing gathering operations in trees where data is stored in vectors in the leaves:</p>\n\n<pre><code>data Tree a = Empty | Node a (Tree a) (Tree a) | Leaf a\n\ntoBundle Empty        = B.empty\ntoBundle (Leaf x)     = B.singleton x\ntoBundle (Node x l r) = toBundle l B.++ B.singleton x B.++ toBundle r\n\ntoVector t = V.unfoldrN s (\\b -&gt; Just (B.head b, B.tail b)) b\n     where b        = toBundle t\n           (Just s) = B.upperBound (B.size b)\n</code></pre>\n\n<p>(There are no vectors in the leaves ... just imagine them :) )</p>\n\n<p>As I wrote this I found out there is no <code>Bundle v a -&gt; v a</code> function converting the bundle back to a vector ... am I missing something?</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1460409452, "creation_date": 1460409452, "answer_id": 36559407, "question_id": 36558986, "link": "https://stackoverflow.com/questions/36558986/haskell-why-does-it-has-correct-types/36559407#36559407", "title": "Haskell - why does it has correct types?", "body": "<blockquote>\n  <p>After all, we have that: <code>(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b</code></p>\n</blockquote>\n\n<pre><code>&gt; :type (&gt;&gt;=)\n(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>True.</p>\n\n<blockquote>\n  <p>get is not of type <code>m a</code> as expected [by] bind.</p>\n</blockquote>\n\n<pre><code>&gt; import Control.Monad.State\n&gt; :type get\nget :: MonadState s m =&gt; m s\n</code></pre>\n\n<p>No, <code>get</code> is of type <code>m a</code> (though it does carry a constraint).</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1460411911, "post_id": 36559494, "comment_id": 60720541, "body": "It seemed to me that monad always has type, it mean no <code>m</code>, always <code>m a</code>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1460414556, "post_id": 36559494, "comment_id": 60721532, "body": "@HaskellFun I think you&#39;re 80% of the way to understanding it fully. Here are a few points for you to research further. Only types with a kind of <code>*</code> can have values. Any type which you expect to have a value, such as one which appears to the right of <code>-&gt;</code>, must be of kind <code>*</code>. Monads have a kind of <code>* -&gt; *</code>, which means you have to give them an argument of kind <code>*</code> to get a type of kind <code>*</code> out. However, you can still use your monad <code>m</code> on its own in other type expressions, such as <code>MonadTrans t =&gt; t m a</code>."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 6, "last_activity_date": 1460409761, "creation_date": 1460409761, "answer_id": 36559494, "question_id": 36558986, "link": "https://stackoverflow.com/questions/36558986/haskell-why-does-it-has-correct-types/36559494#36559494", "title": "Haskell - why does it has correct types?", "body": "<p>You are mistaken in your reading of the types.  You can treat higher kinded types (those with type parameters) much like you would functions with precedence.  If you have a function</p>\n\n<pre><code>f :: a -&gt; b -&gt; c -&gt; d -&gt; e\nf a b c d = undefined\n</code></pre>\n\n<p>Then calling it</p>\n\n<pre><code>let e = f a b c d\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>let e = (((f a) b) c) d\n</code></pre>\n\n<p>Since <code>f a :: b -&gt; c -&gt; d -&gt; e</code>, and so on for <code>(f a) b</code>, etc.</p>\n\n<p>When you see the type <code>StateT s m a</code>, you can also read it as <code>((StateT s) m) a</code>, the types are equivalent and GHC will happily accept that syntax.  In this way it may be easier to see how <code>Monad m =&gt; StateT s m a</code> can be aligned with <code>Monad m' =&gt; m' a'</code>:</p>\n\n<pre><code>m' ~ StateT s m\na' ~ a\n</code></pre>\n\n<p>This implies that the <code>Monad m'</code> in question is <code>StateT s m</code>.  A simpler example that works in the exact same way is the <code>Functor</code> instance for <code>Either a</code>.  It isn't <code>Either</code> that has a <code>Functor</code> instance, but <code>Either a</code>, since a <code>Functor</code> is a type with kind <code>* -&gt; *</code>, meaning a type that takes only one type parameter.</p>\n"}, {"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1460409881, "creation_date": 1460409881, "answer_id": 36559514, "question_id": 36558986, "link": "https://stackoverflow.com/questions/36558986/haskell-why-does-it-has-correct-types/36559514#36559514", "title": "Haskell - why does it has correct types?", "body": "<p><code>get</code> has type <code>m s</code> where <code>s</code> is the state type. The <code>MonadState</code> instance for <code>StateT</code> has context:</p>\n\n<pre><code>Monad m =&gt; MonadState s (StateT s m)\n</code></pre>\n\n<p>so the monad type <code>m</code> is <code>StateT s m</code>. Therefore the type of <code>get</code> for <code>StateT</code> is:</p>\n\n<pre><code>(StateT s m) s\n</code></pre>\n\n<p>The function given to <code>(&gt;&gt;=)</code> must have type <code>s -&gt; StateT s m b</code> for some result type <code>b</code>.</p>\n\n<pre><code>return (Empty)\n</code></pre>\n\n<p>has type <code>StateT s m (Tree Int)</code> as required since <code>StateT s m</code> is a monad .</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 36559494, "answer_count": 3, "score": 1, "last_activity_date": 1460409881, "creation_date": 1460407808, "question_id": 36558986, "link": "https://stackoverflow.com/questions/36558986/haskell-why-does-it-has-correct-types", "title": "Haskell - why does it has correct types?", "body": "<p>I was disappointed about fact that it correct typing:   </p>\n\n<pre><code>renumberTree2' :: Tree a -&gt; StateT Int Identity (Tree Int)\nrenumberTree2' t = get &gt;&gt;= (\\v -&gt; return (Empty))\n</code></pre>\n\n<p>After all, we have that:<br>\n<code>(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b</code>. Due to the fact that <code>StateT s m a</code> we can't give to bind <code>get :: StateT s m s</code>.  get is not of type <code>m a</code> as expected bind.<br>\nHowever, <code>get s</code> where <code>s :: s-&gt;(a, s')</code>  is correct type which should be given to bind.  Where am I wrong ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460418627, "post_id": 36558560, "comment_id": 60722793, "body": "The core problem is that the type <code>Port</code> is uninhabited, because the type <code>Nat</code> is uninhabited. singletons will generate <code>type DemoteRep (&#39;KProxy :: KProxy Port) = Port</code> so any implementation of <code>{to&#47;from}Sing</code> will necessarily be wrong. The simplest solution is to define <code>data Port a = Port a</code> and make singletons for that type, which allows you to have <code>DemoteRep (&#39;Port (n :: Nat)) ~ Port Integer</code>. This will properly give you e.g. <code>toSing (Port (10 :: Integer)) :: SomeSing (&#39;KProxy :: KProxy (Port Nat))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 3, "last_activity_date": 1460425261, "creation_date": 1460425261, "answer_id": 36562187, "question_id": 36558560, "link": "https://stackoverflow.com/questions/36558560/how-to-use-type-level-literal-numbers-in-singletons/36562187#36562187", "title": "How to use type-level literal numbers in singletons?", "body": "<p>Would something much simpler, without singletons, work for you?</p>\n\n<pre><code>{-# language DataKinds, ScopedTypeVariables #-}\n\nimport Data.Proxy\nimport GHC.TypeLits\n\ndata Port = Port{ portNumber :: Integer }\ndata PortT = PortT Nat\n\nwebPort :: Proxy ('PortT 80)\nwebPort = Proxy\n\nreify :: forall n. (KnownNat n) =&gt; Proxy ('PortT n) -&gt; Port\nreify _ = Port (natVal (Proxy :: Proxy n))\n</code></pre>\n\n<p>this gives you</p>\n\n<pre><code>*Main&gt; portNumber $ reify webPort\n80\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": false, "score": 5, "last_activity_date": 1460516831, "last_edit_date": 1460516831, "creation_date": 1460430245, "answer_id": 36562893, "question_id": 36558560, "link": "https://stackoverflow.com/questions/36558560/how-to-use-type-level-literal-numbers-in-singletons/36562893#36562893", "title": "How to use type-level literal numbers in singletons?", "body": "<p>The main <em>singletons</em> idiom right now is to parameterize <code>Port</code>:</p>\n\n<pre><code>data Port nat = Port nat\n</code></pre>\n\n<p>(wrapped in the corresponding singletons quasiquoter, of course)</p>\n\n<p>And, your normal data-level <code>Port</code> would be:</p>\n\n<pre><code>type Port' = Port Integer\n</code></pre>\n\n<p>and your type-level <code>Port</code> would be:</p>\n\n<pre><code>Port Nat\n</code></pre>\n\n<p>(which isn't yet allowed as a kind synonym, but should be allowed in GHC 8.0)</p>\n\n<p>So, you have the <em>type</em> <code>Port Integer</code> inhabited by the values <code>Port 1</code>, <code>Port 2</code>, etc., and the <em>kind</em> <code>Port Nat</code> inhabited by the types <code>Port 1</code>, <code>Port 2</code>, etc.</p>\n\n<p>The reason why this works out with the <em>singletons</em> library is because <code>Integer</code> is the singleton for <code>Nat</code>, so the singleton for <code>Port Nat</code> is <code>Port Integer</code>, automatically, for free.  So everything works out like you'd expect when you use <code>SingI</code>, <code>Sing</code>, <code>toSomeSing</code>, etc. -- reflecting a <code>Port Nat</code>-kinded type will give you a <code>Port Integer</code>-type value, and reifying a <code>Port Integer</code>-type value will give you a <code>Port Nat</code>-kinded type. </p>\n"}], "owner": {"reputation": 597, "user_id": 512596, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ce84bd6e6f9723451f1daf95a6670874?s=128&d=identicon&r=PG&f=1", "display_name": "Joey", "link": "https://stackoverflow.com/users/512596/joey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 382, "favorite_count": 2, "answer_count": 2, "score": 7, "last_activity_date": 1460516831, "creation_date": 1460406245, "question_id": 36558560, "link": "https://stackoverflow.com/questions/36558560/how-to-use-type-level-literal-numbers-in-singletons", "title": "How to use type-level literal numbers in singletons?", "body": "<p>I want to use singletons to represent ports at the type level, with type literals for the port numbers. Something like this:</p>\n\n<pre><code>data Port = Port Integer\n\nfoo :: Sing ('Port 80)\nfoo = sing\n\nbar :: Port\nbar = fromSing foo\n</code></pre>\n\n<p>Short form of question is, how to implement this, or something resembling it?</p>\n\n<p>I tried using singletons-2.0.1 with ghc-7.10.3</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, TemplateHaskell, TypeFamilies, GADTs, KindSignatures, DataKinds, PolyKinds, TypeOperators, FlexibleContexts, RankNTypes, UndecidableInstances, FlexibleInstances,  InstanceSigs, DefaultSignatures, DataKinds, PolyKinds #-}\n\nimport Data.Singletons\nimport Data.Singletons.TH\nimport Data.Singletons.Prelude\nimport GHC.TypeLits\n\n$(singletons [d|\n   data Port = Port Nat\n  |])\n\nfoo.hs:8:3:\n     Couldn't match type \u2018Integer\u2019 with \u2018Nat\u2019\n     Expected type: DemoteRep 'KProxy\n       Actual type: Nat\n     In the first argument of \u2018toSing\u2019, namely \u2018b_a4Vk\u2019\n     In the expression: toSing b_a4Vk :: SomeSing (KProxy :: KProxy Nat)\n</code></pre>\n\n<p>So, sounds like it wants data Port = Port Integer, but that also fails to build too:</p>\n\n<pre><code>foo.hs:8:3:\n    \u2018Port\u2019 of kind \u2018*\u2019 is not promotable\n    In the kind \u2018Port -&gt; *\u2019\n    In the type \u2018(Sing :: Port -&gt; *)\u2019\n    In the type declaration for \u2018SPort\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I managed to get further than this, although not all the way, by not using the singletons library, but implementing a simplified version myself.</p>\n\n<pre><code>{-# LANGUAGE DataKinds, PolyKinds, TypeOperators, TypeFamilies, GADTs, FlexibleInstances, UndecidableInstances, ScopedTypeVariables, FlexibleContexts #-}\n\nimport GHC.TypeLits\nimport Data.Proxy (KProxy(..), Proxy(..))\n\ndata Port = Port Nat\n\ndata family Sing (x :: k)\n\nclass SingI t where\n    sing :: Sing t\n\nclass (kparam ~ 'KProxy) =&gt; SingKind (kparam :: KProxy k) where\n    type DemoteRep kparam :: *\n    fromSing :: Sing (a :: k) -&gt; DemoteRep kparam\n\ntype SNat (x :: Nat) = Sing x\ndata instance Sing (n :: Nat) = KnownNat n =&gt; SNat\ninstance KnownNat n =&gt; SingI n where sing = SNat\ninstance SingKind ('KProxy :: KProxy Nat) where\n    type DemoteRep ('KProxy :: KProxy Nat) = Integer\n    fromSing (SNat :: Sing n) = natVal (Proxy :: Proxy n)\n\ndata instance Sing (x :: Port) where\n        SPort :: Sing n -&gt; Sing ('Port n)\ninstance KnownNat n =&gt; SingI ('Port (n :: Nat)) where sing = SPort sing\n</code></pre>\n\n<p>So far, so good, now this works:</p>\n\n<pre><code>foo :: Sing ('Port 80)\nfoo = sing\n</code></pre>\n\n<p>But I'm stuck implementing fromSing for Port.</p>\n\n<pre><code>instance SingKind ('KProxy :: KProxy Port) where\n        type DemoteRep ('KProxy :: KProxy Port) = Port\n        fromSing (SPort n) = Port (fromSing n)\n</code></pre>\n\n<p>This fails with the same type error as shown for the first use of the singletons library above. And now, it's clear why: the SingKind instance for Nat produces an Integer, not a Nat. It seems it has to, because natVal produces an Integer.</p>\n\n<p>So, I'm stuck!</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1460407019, "post_id": 36558475, "comment_id": 60717957, "body": "<code>iterate</code> just returns a list whose <i>i</i>th element is the result of applying a function <i>i</i> times starting with an initial value. For instance, <code>iterate f sv</code> evaluates to <code>[sv, (f sv), (f (f sv)), (f (f (f sv))), ...]</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1460415548, "post_id": 36558475, "comment_id": 60721888, "body": "Two side notes which you may find instructive. One: lists are not a good choice of data structure if you frequently need to reach the far end. Two: iterating a function <code>n</code> times is <a href=\"http://www.cakesolutions.net/teamblogs/2012/09/30/fold-over-natural-numbers\" rel=\"nofollow noreferrer\">a fold over the number <code>n</code></a>."}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 4964866, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152801637182397/picture?type=large", "display_name": "Raul \u0160pilev", "link": "https://stackoverflow.com/users/4964866/raul-%c5%a0pilev"}, "edited": false, "score": 0, "creation_date": 1460407064, "post_id": 36558565, "comment_id": 60717980, "body": "Oh, I see. Iterate creates an infinite list of the results of that function calling itself over and over. So I just use &quot;!!&quot; to take the appropriate index of that list. I see now how iterate works. Thank you."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 149, "user_id": 4964866, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152801637182397/picture?type=large", "display_name": "Raul \u0160pilev", "link": "https://stackoverflow.com/users/4964866/raul-%c5%a0pilev"}, "edited": false, "score": 0, "creation_date": 1460407211, "post_id": 36558565, "comment_id": 60718058, "body": "correct, isn&#39;t Haskell amazing! with few recursive definitions you can do a lot."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 4, "last_activity_date": 1460407137, "last_edit_date": 1460407137, "creation_date": 1460406265, "answer_id": 36558565, "question_id": 36558475, "link": "https://stackoverflow.com/questions/36558475/haskell-feeding-back-the-result-of-a-function-to-itself-n-times/36558565#36558565", "title": "Haskell - feeding back the result of a function to itself n times", "body": "<p>the function you're looking for is <code>iterate</code></p>\n\n<p>e.g.</p>\n\n<pre><code>&gt; (iterate flipBack' [1..3])!!3\n[1,2,3]\n</code></pre>\n\n<p>so you can write </p>\n\n<pre><code>rotate xs n = (iterate flipBack' xs)!!n\n</code></pre>\n\n<p>note that <code>iterate</code> is very easy to define yourself as well</p>\n\n<pre><code>iterate f x =  x : iterate f (f x)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 4, "last_activity_date": 1460409324, "creation_date": 1460409324, "answer_id": 36559380, "question_id": 36558475, "link": "https://stackoverflow.com/questions/36558475/haskell-feeding-back-the-result-of-a-function-to-itself-n-times/36559380#36559380", "title": "Haskell - feeding back the result of a function to itself n times", "body": "<p>This is not a good way to implement the <code>rotate</code> function! <code>flipBack'</code> is <code>O(length xs)</code>, and you're iterating it; this is terribly expensive. How can you do better?</p>\n\n<h3>One way: do arithmetic</h3>\n\n<p>First, note that performing <code>flipBack'</code> <code>length xs</code> times gives you back <code>xs</code>. So you can start by reducing <code>n</code>.</p>\n\n<pre><code>rotate n xs = rotate' (lenx - n `mod` lenx) xs where\n   lenx = length xs\n</code></pre>\n\n<p>Ok, so now how do we <code>rotate'</code>? By splitting!</p>\n\n<pre><code>rotate' shift xs = end ++ beginning where\n  (beginning, end) = splitAt shift xs\n</code></pre>\n\n<h3>Make things lazy</h3>\n\n<p>If <code>n</code> is much smaller than the length of the list, the above approach of traversing the list to get the length before actually producing anything is unfortunate. If that's likely to be the case, it's likely better to traverse the list with a simplified queue. This approach is too complicated for me to code blindly on my phone, so I'll just leave it as an idea to think about.</p>\n"}], "owner": {"reputation": 149, "user_id": 4964866, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152801637182397/picture?type=large", "display_name": "Raul \u0160pilev", "link": "https://stackoverflow.com/users/4964866/raul-%c5%a0pilev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 36558565, "answer_count": 2, "score": 1, "last_activity_date": 1460409324, "creation_date": 1460405967, "question_id": 36558475, "link": "https://stackoverflow.com/questions/36558475/haskell-feeding-back-the-result-of-a-function-to-itself-n-times", "title": "Haskell - feeding back the result of a function to itself n times", "body": "<p>I'm trying to write a function that takes the last element of a list and puts that element in front of the list. I need this function to run an n amount of times.</p>\n\n<p>The function, that does the flipping.</p>\n\n<pre><code>flipBack' :: [a] -&gt; [a]\nflipBack' xs = [last xs] ++ reverse (drop 1 (reverse xs))\n</code></pre>\n\n<p>So the above is like a helper function for the lower one, which takes in the initial string and the number of times that it needs the above function to run.</p>\n\n<pre><code>rotate :: String -&gt; Int -&gt; String\nrotate xs n =  flipBack' xs\n</code></pre>\n\n<p>So for example if n is 3 then the rotate function should do the following:</p>\n\n<pre><code>flipBack'(flipBack'(flipBack' xs))\n</code></pre>\n\n<p>It seems like iterate should be used here somehow, but I am having trouble implementing it here, because I don't fully understand how it works.</p>\n"}, {"tags": ["haskell", "cabal", "htf"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1460437898, "post_id": 36558397, "comment_id": 60728203, "body": "TBH: I don&#39;t know (if there even is one) - but in this case why don&#39;t you make this a default in your implementation (using <a href=\"https://hackage.haskell.org/package/HTF-0.13.1.0/docs/Test-Framework.html#v:htfMainWithArgs\" rel=\"nofollow noreferrer\"><code>htfMainWithArgs</code></a>)? - look for the args in your main, if none are there pass your default ... yes it&#39;s a hack and maybe someone knows the correct flag but till then it should work for you"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460437968, "post_id": 36558397, "comment_id": 60728228, "body": "also I think this could be a duplicate of <a href=\"https://stackoverflow.com/questions/28902169/put-command-line-arguments-for-tests-in-cabal-file\" title=\"put command line arguments for tests in cabal file\">stackoverflow.com/questions/28902169/&hellip;</a>"}, {"owner": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460829687, "post_id": 36558397, "comment_id": 60927352, "body": "great idea - did work immediately! <code>htfMainWithArgs [&quot;--quiet&quot;] htf_importedTests</code> does the trick!"}, {"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 0, "creation_date": 1461820515, "post_id": 36558397, "comment_id": 61375041, "body": "@Cartsen since your comment provided an answer, care to post it as one?"}], "owner": {"reputation": 1479, "user_id": 855443, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/d880e98c9fffc6253f3868babc99b8c1?s=128&d=identicon&r=PG", "display_name": "user855443", "link": "https://stackoverflow.com/users/855443/user855443"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1460405888, "creation_date": 1460405636, "last_edit_date": 1460405888, "question_id": 36558397, "link": "https://stackoverflow.com/questions/36558397/cabal-testsuite-how-can-i-pass-a-flag", "title": "Cabal testsuite - How can I pass a flag?", "body": "<p>I use cabal with test-suites. The processor I use (HTF) allows flags (e.g. <code>--quiet</code>). How can I add such flags in the cabal file in order to be passed automatically to the test suite program when it is executed? </p>\n"}, {"tags": ["matlab", "haskell", "math"], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 4, "last_activity_date": 1460404576, "creation_date": 1460404576, "answer_id": 36558080, "question_id": 36557777, "link": "https://stackoverflow.com/questions/36557777/chebyshev-nodes-in-haskell/36558080#36558080", "title": "Chebyshev nodes in Haskell", "body": "<p>You can define the terms as usual</p>\n\n<pre><code>cheb a b n k = 0.5*(b+a) + 0.5*(b-a)*cos( (2*k-1)*pi / (2*n) )\n</code></pre>\n\n<p>and define the function as</p>\n\n<pre><code>chebfun a b n = map (cheb a b n) [1..n]\n</code></pre>\n\n<p>this will give a list of n terms, evaluation is just summing it up.</p>\n"}, {"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 1, "last_activity_date": 1460404837, "creation_date": 1460404837, "answer_id": 36558161, "question_id": 36557777, "link": "https://stackoverflow.com/questions/36557777/chebyshev-nodes-in-haskell/36558161#36558161", "title": "Chebyshev nodes in Haskell", "body": "<p>Use a list comprehension.</p>\n\n<pre><code>[ 0.5*((b+a) + (b-a)*cos((2*i-1)*pi/(2*n))) | i &lt;- [1..n] ]\n</code></pre>\n\n<p>(I fixed an error in your parenthesization.)</p>\n"}], "owner": {"reputation": 3, "user_id": 6189868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a1b72c7ca3fa861bbbcb9b4b1c1cba?s=128&d=identicon&r=PG&f=1", "display_name": "D B", "link": "https://stackoverflow.com/users/6189868/d-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 36558080, "answer_count": 2, "score": 0, "last_activity_date": 1460404837, "creation_date": 1460403561, "last_edit_date": 1460404082, "question_id": 36557777, "link": "https://stackoverflow.com/questions/36557777/chebyshev-nodes-in-haskell", "title": "Chebyshev nodes in Haskell", "body": "<p>I want to use Haskell to compute the <code>n</code> Chebyshev nodes between <code>a</code> and <code>b</code>, which are given by the formula</p>\n\n<p><code>x_i = 0.5*((b+a) + (b-a)*cos((2*i-1)*pi)/(2*n))</code> where <code>i</code> goes from <code>1</code> to <code>n</code>.</p>\n\n<p>I have so far focused on the cosine bit and came up with:</p>\n\n<pre><code>map (b-a)/(2*n)*cos (map (*pi) (map (-1) (map (*2) [1..n]))) \n</code></pre>\n\n<p>However, this seems to me too convoluted and tedious given that my first motivation to learn this language is that it is portrayed to be mathematically friendly and so on.</p>\n\n<p>Is my approach fundamentally wrong and there may be ways to make my code much more smarter and neater?</p>\n\n<p>In matlab I would accomplish this with just two lines like this:</p>\n\n<pre><code>k = (1:n)';\nx = 0.5*((b+a) + (b-a)*cos(((2*k-1)*pi)./(2*n)));\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 1, "creation_date": 1460397896, "post_id": 36555865, "comment_id": 60712325, "body": "Just always use <code>fmap</code>, <code>pure</code> and <code>(*&gt;)</code>"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1460401877, "post_id": 36555865, "comment_id": 60714849, "body": "@ZhekaKozlov will do of course, but other people write code that I may have to interact with, and there are more cases than just <code>fmap</code> <code>pure</code> and <code>*&gt;</code> that I may not know all of."}], "answers": [{"comments": [{"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 0, "creation_date": 1460399147, "post_id": 36556305, "comment_id": 60713113, "body": "actually both of my examples are bad, <code>pure 1 &gt;&gt;= safedivide 0</code> DOES typecheck, again, because <code>Maybe</code> is both an applicative and a monad."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460401295, "post_id": 36556305, "comment_id": 60714452, "body": "They are equivalent in the sense that <code>return</code> can ALWAYS be replaced with <code>pure</code>, and so on. Maybe I used the wrong word but my intended meaning is not wrong. I figured my use of &quot;(from most to least generic)&quot; made it clear that I understood they could only be replaced in one direction."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460401984, "post_id": 36556305, "comment_id": 60714904, "body": "Also when both type-check, they ARE equivalent. The only difference that I know of is how generic the types are."}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "reply_to_user": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460402552, "post_id": 36556305, "comment_id": 60715241, "body": "I guess it comes down to the fact that they were not all added to the language at the same time. also, there are cases when restricting the type signature of a function is desireable (well it&#39;s imaginable at any rate)."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 1, "creation_date": 1460403685, "post_id": 36556305, "comment_id": 60715919, "body": "I would say that while it is sometimes desirable, it should not be done for you in the standard library. It should be something that YOU do when desired, by simply adjusting your top level function&#39;s type signature to what you want. Such as <code>monadicAddTwo :: (Monad m, Num b) =&gt; f b -&gt; fb)</code> then <code>monadicAddTwo = fmap (+ 2)</code>. Since you should write out top level type signatures anyway."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1460408105, "post_id": 36556305, "comment_id": 60718582, "body": "@kai The problem is: Why should something like <code>return</code> exist, when it is completely subsumed by <code>pure</code> (since all monads are applicatives)? There really isn&#39;t a technical reason. It exists for historical reasons (the <code>Monad</code> type class was implemented before <code>Functor</code> and <code>Applicative</code>) and things like <code>ap</code> can sometimes be useful when implementing instances: if you already wrote a <code>Monad</code> instance, you can say <code>instance Applicative ... where pure = return; (&lt;*&gt;) = ap</code>. As for restricting type signatures, the restriction would go in the opposite direction, towards less general not more."}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1460410182, "post_id": 36556305, "comment_id": 60719672, "body": "@DavidYoung like you say, <code>return</code> was there first, and simply removing it, replacing it with <code>pure</code> would break a lot of existing code for no real good reason. this is a thing that simply happens with programming languages. what I try to highlight in my answer is that even though the are largely interchangeable, they are not equivalent, and so we can&#39;t simply substitute one for the other in all cases."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460427097, "post_id": 36556305, "comment_id": 60725176, "body": "@kai But you CAN substitute <code>return</code> for <code>pure</code> in all cases, even if the opposite isn&#39;t always true. And I would love to see a deprecation warning on <code>return</code>, honestly even if there was no timeline or even plan at all for it to be removed, just getting it out of active codebases would be nice IMO. It would also limit the confusion felt by people coming from C-like languages where return means something similar-ish but not similar enough to not cause some confusion."}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 0, "creation_date": 1460440948, "post_id": 36556305, "comment_id": 60729401, "body": "correction: you can&#39;t always substitute one for the other without changing the semantics of the program (if only ever so slightly). I agree though, that it&#39;s probably a good idea to encourage the use of <code>pure</code> over <code>return</code>"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460668345, "post_id": 36556305, "comment_id": 60863327, "body": "@kai Can you give an example of when changing <code>return</code> to <code>pure</code> breaks something?"}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 0, "creation_date": 1460669405, "post_id": 36556305, "comment_id": 60863817, "body": "none that I can think of, but then again, I am still a beginner, so it&#39;s not impossible. a better point would be that you can&#39;t remove an existing function without breaking stuff, but I&#39;ll have to concede that substitution always works in that direction until I see some evidence for the contrary (I really underestimated how strong haskells type inference is)."}], "tags": [], "owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "is_accepted": false, "score": 1, "last_activity_date": 1460400032, "last_edit_date": 1495542375, "creation_date": 1460398884, "answer_id": 36556305, "question_id": 36555865, "link": "https://stackoverflow.com/questions/36555865/why-does-haskell-contain-so-many-equivalent-functions/36556305#36556305", "title": "Why does Haskell contain so many equivalent functions", "body": "<p>They aren't equivalent though. equivalent things in haskell can be interchanged with no difference at all in functionality. Consider for example <code>pure</code> and <code>return</code></p>\n\n<p>EDIT: I wrote some examples down, but they were really bad since they involved <code>Maybe a</code>, a type that is both an applicative and a monad, so the functions could be used pretty interchangeably.</p>\n\n<p>There are types that are applicatives but not monads though (see <a href=\"https://stackoverflow.com/questions/7220436/good-examples-of-not-a-functor-functor-applicative-monad\">this</a> question for examples), and by studying the type of the following expression, we can see that this could lead to some roadbumps:</p>\n\n<pre><code>pure 1 &gt;&gt;= pure :: (Monad m, Num b) =&gt; m b\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460400531, "post_id": 36556398, "comment_id": 60713997, "body": "Mathematically, a monad is just a special type of functor (it is the composition of two adjoint functors). While one is not forced to define a <code>Functor</code> instance for a type with a <code>Monad</code> instance, it is always possible to do so (<code>fmap f xs  ==  xs &gt;&gt;= return . f</code>)."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460401525, "post_id": 36556398, "comment_id": 60714605, "body": "That makes sense, what about my suggestion to deprecate all the less generic functions?"}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 2, "creation_date": 1460430414, "post_id": 36556398, "comment_id": 60726052, "body": "Your story for <code>fmap</code> has some very slight inaccuracies.  When <code>Functor</code> came out, <code>map</code> was immediately generalized to work on all <code>Functor</code>s, not just lists.  However, people got upset at the type errors that would pop up when someone misused <code>map</code> (asking about Functors when people just wanted to use it for lists), so after that, <code>map</code> was renamed <code>fmap</code>, and the original <code>map</code> was re-introduced to be specialized only on lists."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 0, "creation_date": 1460434214, "post_id": 36556398, "comment_id": 60727134, "body": "@JustinL. I really wish there was something like <code>EasyPrelude</code> for stuff like that. I can see how it is useful for beginners, but I think it gets a little annoying."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 5, "last_activity_date": 1460403153, "last_edit_date": 1460403153, "creation_date": 1460399213, "answer_id": 36556398, "question_id": 36555865, "link": "https://stackoverflow.com/questions/36555865/why-does-haskell-contain-so-many-equivalent-functions/36556398#36556398", "title": "Why does Haskell contain so many equivalent functions", "body": "<p>The short answers are \"history\" and \"regularity\".</p>\n\n<p>Originally \"map\" was defined for lists. Then type-classes were introduced, with the Functor type class, so the generalised version of \"map\" for any functor had to be called something different, otherwise existing code would be broken. Hence \"fmap\".</p>\n\n<p>Then monads came along. Instances of monads did not need to be functors, so \"liftM\" was created, along with \"liftM2\", \"liftM3\" etc. Of course if a type is an instance of both Monad and Functor then fmap = liftM.</p>\n\n<p>Monads also have \"ap\", used in expressions like <code>f `ap` arg1 `ap` arg2</code>. This was very handy, but then Applicative Functors were added. (&lt;*>) did the same job for applicative functors as 'ap', but because many applicative functors are not monads it had to be called something different. Likewise liftAx versus liftMx and \"pure\" versus \"return\".</p>\n"}, {"comments": [{"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460405787, "post_id": 36557937, "comment_id": 60717277, "body": "By that logic do you define <code>lengthList :: [a] -&gt; Int</code> and <code>foldrTraversable :: Traversable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b</code>, what about <code>(+.+) :: Double -&gt; Double -&gt; Double</code>. Now obviously you don&#39;t because that would be idiotic, so why use <code>liftM</code>? Now you are probably going to respond &quot;but those aren&#39;t already available&quot;, well if they were, would you use them? Also why aren&#39;t they available when <code>liftM</code>, <code>liftA</code> and <code>&gt;&gt;</code> are? It seems as though you either have to include specific functions for every combination, not have any unnecessarily specific functions, or be inconsistent."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460406008, "post_id": 36557937, "comment_id": 60717396, "body": "Also I would argue that the increased &quot;clarity&quot; you get from using functions that have needlessly specific types is not worth the increased number of functions you have to have memorized. Taken to the logical extreme as in my previous comment, there would be something like an order of magnitude more functions (Functor can become Monad, Applicative, List, Maybe, IO, Either, ZipList etc.), all of which you would want memorized. By simply not having any overly specific functions, you save a lot of mental overhead, and sure you have to do a tiny bit more reasoning, but it really isn&#39;t difficult."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460408488, "post_id": 36557937, "comment_id": 60718787, "body": "I don&#39;t define my own type-restricted synonyms. I just use the ones from the Haskell standard, that Haskell programmers already know, because I am writing a Haskell program. Of course the exact contents of any standard library are inevitably somewhat arbitrary. In the long run, learning a few extra names like <code>map = fmap</code> or <code>(.) = (&lt;$&gt;)</code> is a lot cheaper than a lifetime of wading through <code>fmap</code> soup."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460408572, "post_id": 36557937, "comment_id": 60718832, "body": "So basically you only use historical accidents, and making one intentionally would be a bad idea? And if the historical accident never occurred, you would be perfectly OK with not having any of those needlessly restricted versions. So by that logic historical accidents are a good thing? As they arbitrarily throw in some needlessly type restricted functions and people then get used to them?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 2, "creation_date": 1460409298, "post_id": 36557937, "comment_id": 60719214, "body": "The contents of the standard library are not entirely a historical accident. They also reflect the way human programmers think about their programs. Function composition <code>(.)</code> is an essential concept, even though <code>(.)</code> is itself a type-restricted form of <code>(&lt;$&gt;)</code> or <code>fmap</code>. Would you argue that one should not use <code>(.)</code> either?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460411932, "post_id": 36557937, "comment_id": 60720554, "body": "Let me try to summarize. Any standard library function has some cost and some value. The cost is that one needs to learn the function. The value can be letting you do something more conveniently, or it can be letting you express your intent more clearly. This answer explains that a function can have value of the latter sort by supplying additional type information. This value is partly dependent on what you call the &quot;historical accident&quot; that other Haskell programmers know the function, just like English words (all historical accident) have value because other English speakers understand them."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1460419631, "post_id": 36557937, "comment_id": 60723098, "body": "On the topic of catching bugs - using more general functions allows you to give a more general type signature (i.e., more parametric) to the function you are trying to write. This can rule out a very large number of bogus implementations by virtue of typechecking. There is only one interesting function of type <code>Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code> but infinitely many of type <code>Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b</code>."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460426585, "post_id": 36557937, "comment_id": 60725044, "body": "I mean <code>(.)</code> also has <code>infixr 9</code> instead of <code>infixl 4</code> so using <code>&lt;$&gt;</code> everywhere can potentially break things. <code>(.)</code> is also more concise and quicker to type. It admittedly still is an example of one of the extremely few cases where I could understand having a type restricted variant. Although honestly if <code>&lt;$&gt;</code> was never made and <code>(.)</code> was used for both mapping and composition, I wouldn&#39;t really complain. I would argue things like <code>liftA</code> and <code>liftM</code> are not worth the cost though."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460469289, "post_id": 36557937, "comment_id": 60749643, "body": "@user2407038, the benefits you mention are a direct result of the type you chose in step 1 for the function you are writing. (By their very nature, they can only depend on the type, not the implementation!) It&#39;s true that in order to implement a general function, you need to use other general functions or your program won&#39;t type check. But there&#39;s no further benefit to using an overly general function, and there are costs (e.g. masking bugs). So pick a general type in step 1, but always use the most specific functions that will let your program type check in step 2."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 0, "last_activity_date": 1460409039, "last_edit_date": 1460409039, "creation_date": 1460404128, "answer_id": 36557937, "question_id": 36555865, "link": "https://stackoverflow.com/questions/36555865/why-does-haskell-contain-so-many-equivalent-functions/36557937#36557937", "title": "Why does Haskell contain so many equivalent functions", "body": "<blockquote>\n  <p>I personally find this annoying, as it means that if I need to do x, and some function such as liftM allows me to do x, then I will have made my function less generic than it could have been</p>\n</blockquote>\n\n<p>This logic is backwards.</p>\n\n<p>Normally you know in advance the type of the thing you want to write, be it <code>IO String</code> or <code>(Foldable f, Monoid t, Monad m) =&gt; f (m t) -&gt; m t</code> or whatever. Let's take the first case, <code>getLineCapitalized :: IO String</code>. You could write it as</p>\n\n<pre><code>getLineCapitalized = liftM (map toUpper) getLine\n</code></pre>\n\n<p>or</p>\n\n<pre><code>getLineCapitalized = fmap (fmap toUpper) getLine\n</code></pre>\n\n<p>Is the former \"less generic\" because it uses the specialized functions <code>liftM</code> and <code>map</code>? Of course not. This is intrinsically an IO action that produces a list. It cannot become \"more generic\" by changing it to the second version since those <code>fmap</code>s will have their types fixed to <code>IO</code> and <code>[]</code> anyways. So, there is no advantage to the second version.</p>\n\n<p>By writing the first version, you provide contextual information to the reader for free. In <code>liftM (map foo) bar</code>, the reader knows that <code>bar</code> is going to be an action in some monad that returns a list. In <code>fmap (fmap foo) bar</code>, it could be any sort of doubly-nested structure whatsoever. If <code>bar</code> is something complicated rather than just <code>getLine</code>, then this kind of information is helpful for understanding more easily what is going on in <code>bar</code>.</p>\n\n<p>In general, you should write a function in two steps.</p>\n\n<ol>\n<li><p>Decide what the type of the function should be. Make it as general or as specific as you want. The more general the type of the function, the stronger guarantees you get on its behavior from parametricity.</p></li>\n<li><p>Once you have decided on the type of your function, implement it using the most specific available functions. By doing so, you are providing the most information to the reader of your function. You never lose any generality or parametricity guarantees by doing so, since those only depend on the type, which you already determined in step 1.</p></li>\n</ol>\n\n<hr>\n\n<p>Edit in response to comments: I was reminded of the biggest reason to use the most specific function available, which is <strong>catching bugs</strong>. The type <code>length :: [a] -&gt; Int</code> is essentially the entire reason that I still use GHC 7.8. It's never happened that I wanted to take the length of an unknown <code>Foldable</code> structure. On the other hand, I definitely do not want to ever accidentally take the length of a pair, or take the length of <code>foo bar baz</code> which I think has type <code>[a]</code>, but actually has type <code>Maybe [a]</code>.</p>\n\n<p>In the use cases for Foldable that are not already covered by the rest of the Haskell standard, lens is a vastly more powerful alternative. If I want the \"length\" of a <code>Maybe t</code>, <code>lengthOf _Just :: Maybe t -&gt; Int</code> expresses my intent clearly, and the compiler can check that the program actually matches my intent; and I can go on to write <code>lengthOf _Nothing</code>, <code>lengthOf _Left</code>, etc. Explicit is better than implicit.</p>\n"}, {"comments": [{"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460433783, "post_id": 36563000, "comment_id": 60727015, "body": "Wouldn&#39;t a better alternative to that whole &quot;using redundant functions to implement superclasses&quot; be allowing automatic deriving of those superclasses. So if you don&#39;t manually specify <code>instance Functor Foo where</code> or whatever, but you have <code>instance Monad Foo where</code>, have the compiler simply derive <code>fmap</code>, <code>pure</code> and <code>&lt;*&gt;</code>."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1460433877, "post_id": 36563000, "comment_id": 60727045, "body": "To extend that a little bit, I think <code>instance Monad Foo where</code>, <code>(&gt;&gt;=) = ...</code>, <code>pure = ...</code> should be a valid way to make <code>Foo</code> a <code>Monad</code>, an <code>Applicative</code>, and a <code>Functor</code>."}], "tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1460430892, "creation_date": 1460430892, "answer_id": 36563000, "question_id": 36555865, "link": "https://stackoverflow.com/questions/36555865/why-does-haskell-contain-so-many-equivalent-functions/36563000#36563000", "title": "Why does Haskell contain so many equivalent functions", "body": "<p>There are some \"redundant\" functions like <code>liftM</code>, <code>ap</code>, and <code>liftA</code> that have a very real use and taking them out would cause loss of functionality --- you can use <code>liftM</code>, <code>ap</code>, and <code>liftA</code> to implement your <code>Functor</code> or <code>Applicative</code> instances if all you've written is a <code>Monad</code> instance.  It lets you be lazy and do, say:</p>\n\n<pre><code>instance Monad Foo where\n    return = ...\n    (&gt;&gt;=) = ...\n</code></pre>\n\n<p>Now you've done all of the rewarding work of defining a <code>Monad</code> instance, but this won't compile.  Why?  Because you also need a <code>Functor</code> and <code>Applicative</code> instance.</p>\n\n<p>So, because you're quickly prototyping, or lazy, or can't think of a better way, you can just get a free <code>Functor</code> and <code>Applicative</code> instance:</p>\n\n<pre><code>instance Functor Foo where\n    fmap = liftM\n\ninstance Applicative Foo where\n    pure  = return\n    (&lt;*&gt;) = ap\n</code></pre>\n\n<p>In fact, you can just copy-and-paste that chunk of code everywhere you need to quickly define a <code>Functor</code> or <code>Applicative</code> instance when you already have a <code>Monad</code> instance defined.</p>\n\n<p>The same goes for <code>fmapDefault</code> from <code>Data.Traversable</code>.  If you've implemented <code>Traversable</code>, you can also implement <code>Foldable</code> and <code>Functor</code>:</p>\n\n<pre><code>instance Functor Bar where\n    fmap = fmapDefault\n</code></pre>\n\n<p>no extra work required!</p>\n\n<p>There are some redundant functions, however, that really have no actual usage other than being historical accidents from a time when <code>Functor</code> was not a superclass of <code>Monad</code>.  These have literally zero use/point in existing...and include things like the <code>liftM2</code>, <code>liftM3</code> etc., and <code>(&gt;&gt;)</code> and friends.</p>\n"}], "owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 2, "accepted_answer_id": 36556398, "answer_count": 4, "score": 6, "last_activity_date": 1494273976, "creation_date": 1460397483, "last_edit_date": 1494273976, "question_id": 36555865, "link": "https://stackoverflow.com/questions/36555865/why-does-haskell-contain-so-many-equivalent-functions", "title": "Why does Haskell contain so many equivalent functions", "body": "<p>It seems like there are a lot of functions that do the same thing, particularly relating to Monads, Functors, and Applicatives.</p>\n\n<p>Examples (from most to least generic):</p>\n\n<pre><code>fmap == liftA == liftM\n(&lt;*&gt;) == ap\nliftA[2345] == liftM[2345]\npure == return\n(*&gt;) == (&gt;&gt;)\n</code></pre>\n\n<p>An example not directly based on the FAM class tree:</p>\n\n<pre><code>fmap == map\n</code></pre>\n\n<p>(I thought there were quite a few more with List, Foldable, Traversable, but it looks like most were made more generic some time ago, as I only see the old, less generic type signatures in old stack overflow / message board questions)</p>\n\n<p>I personally find this annoying, as it means that if I need to do x, and some function such as liftM allows me to do x, then I will have made my function less generic than it could have been, and I am only going to notice that kind of thing by thoroughly reasoning about the differences between types (such as FAM, or perhaps List, Foldable, Traversable combinations as well), which is not beginner friendly at all, as while simply using those types isn't all that hard, reasoning about their properties and laws requires a lot more mental effort.</p>\n\n<p>I am guessing a lot of these equivalencies come from the Applicative Monad Proposal. If that is the reason for them (and not some other reason I am missing for having less generic functions available for confusion), are they going to be deprecated / deleted ever? I can understand waiting a long time to delete them, due to breaking existing code, but surely deprecation is a good idea?</p>\n"}, {"tags": ["haskell", "ghcjs"], "comments": [{"owner": {"reputation": 2861, "user_id": 2847643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmATO.jpg?s=128&g=1", "display_name": "user2847643", "link": "https://stackoverflow.com/users/2847643/user2847643"}, "edited": false, "score": 0, "creation_date": 1460468802, "post_id": 36555030, "comment_id": 60749223, "body": "Regarding TH: the current TH implementation in GHCJS is rather resource intensive during compile time. It seems to help <i>a lot</i> in some cases, if it&#39;s possible, to place all your TH code in a separate module. Then you only pay for TH when you change something in that module. For larger projects that could save minutes on each compile depending on how much you rely on TH."}, {"owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "reply_to_user": {"reputation": 2861, "user_id": 2847643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmATO.jpg?s=128&g=1", "display_name": "user2847643", "link": "https://stackoverflow.com/users/2847643/user2847643"}, "edited": false, "score": 0, "creation_date": 1460522700, "post_id": 36555030, "comment_id": 60775583, "body": "I actually do have the TH (my foreign import javascript statements) in a separate module, and I still pay the Linking Template Haskell cost on every compile, even if I touch an unrelated module."}, {"owner": {"reputation": 2861, "user_id": 2847643, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PmATO.jpg?s=128&g=1", "display_name": "user2847643", "link": "https://stackoverflow.com/users/2847643/user2847643"}, "edited": false, "score": 0, "creation_date": 1460534007, "post_id": 36555030, "comment_id": 60781247, "body": "In that case I&#39;m not sure what else you can do except develop using GHC + webkitgtk."}], "owner": {"reputation": 1431, "user_id": 1553741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/6daac35161547a75785e69de774334b8?s=128&d=identicon&r=PG", "display_name": "ajp", "link": "https://stackoverflow.com/users/1553741/ajp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 247, "favorite_count": 0, "answer_count": 0, "score": 7, "last_activity_date": 1460403378, "creation_date": 1460394664, "last_edit_date": 1460403378, "question_id": 36555030, "link": "https://stackoverflow.com/questions/36555030/how-can-i-reduce-incremental-compilation-times-with-ghcjs", "title": "How can I reduce (incremental) compilation times with ghcjs?", "body": "<p>I have a small project using ghcjs, which currently has a best-case incremental recompilation time of 8 seconds, for a measly 637 lines of source code (as counted by <code>find -L . -name '*.hs' | xargs wc -l | grep total</code>).</p>\n\n<p>The worst offender is the final <code>Linking client/Main.jsexe</code> step, which takes 3.8 seconds and happens on every incremental build.</p>\n\n<p>The second worst offender is a <code>Linking Template Haskell</code> step, which takes about 2 seconds. This also happens on every incremental rebuild, and it comes from having a couple <code>foreign import javascript</code> declarations. Even if I move those declarations to a separate module/file which I never touch again, incremental builds from touching any file in the codebase cause this linking step to happen.</p>\n\n<p>The final couple of seconds comes from actually compiling my source files. It would be great to get this down as well, but it's less of a problem.</p>\n\n<p>How can I achieve a tighter compilation/feedback loop?</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1460393562, "post_id": 36554602, "comment_id": 60709771, "body": "I&#39;d have to run some tests to be sure but this might be a more efficient solution than mine"}, {"owner": {"reputation": 149, "user_id": 4964866, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152801637182397/picture?type=large", "display_name": "Raul \u0160pilev", "link": "https://stackoverflow.com/users/4964866/raul-%c5%a0pilev"}, "edited": false, "score": 0, "creation_date": 1460393946, "post_id": 36554602, "comment_id": 60710007, "body": "This is pretty much exactly what I was looking for. I was thinking about using &quot;Nothing&quot; and &quot;Just (char)&quot;, but wasn&#39;t sure how without getting &quot;Couldn&#39;t match expected type&quot; errors.&quot;mapMaybe&quot; solves this. Also, now I understand how the map function works much better.Thanks."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 5, "last_activity_date": 1460393189, "creation_date": 1460393189, "answer_id": 36554602, "question_id": 36554499, "link": "https://stackoverflow.com/questions/36554499/haskell-have-a-function-return-an-empty-character/36554602#36554602", "title": "Haskell - have a function return an empty character", "body": "<p><code>map</code> preserves the structure of the list, while your operations modifies it by removing elements. This means you can't use <code>map</code>, but you can use <code>mapMaybe</code> which allows you to provide a function which returns <code>Nothing</code> for elements you want to remove from the output:</p>\n\n<pre><code>import Data.Maybe (mapMaybe)\ndropEvery str n = mapMaybe (\\(char, indx) -&gt; if indx `mod` n /= 0 then Just(char) else Nothing) (zip str [1..])\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 149, "user_id": 4964866, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152801637182397/picture?type=large", "display_name": "Raul \u0160pilev", "link": "https://stackoverflow.com/users/4964866/raul-%c5%a0pilev"}, "edited": false, "score": 0, "creation_date": 1460394597, "post_id": 36554607, "comment_id": 60710372, "body": "I did attempt to put &quot;[]&quot; after &quot;else&quot;, but of course ended up getting type errors. concatMap is a good idea."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 149, "user_id": 4964866, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152801637182397/picture?type=large", "display_name": "Raul \u0160pilev", "link": "https://stackoverflow.com/users/4964866/raul-%c5%a0pilev"}, "edited": false, "score": 0, "creation_date": 1460464166, "post_id": 36554607, "comment_id": 60745120, "body": "@Raul\u0160pilev The problem comes from assuming that there is something called an &quot;empty <code>Char</code>&quot;.  This would be like an &quot;empty <code>Int</code>&quot; or an &quot;empty <code>Bool</code>&quot;, you can have an <code>Int</code> that is 0, but not one that doesn&#39;t have a value at all (not counting <code>undefined</code>).  In order to have emptiness, you need a container.  Strings are containers, since they&#39;re simply a list of <code>Char</code>s, so by having a function <code>(Char, Int) -&gt; [Char]</code>, you can use <code>concatMap</code> over a <code>[(Char, Int)] to get out a </code>[Char]`."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 7, "last_activity_date": 1460393205, "creation_date": 1460393205, "answer_id": 36554607, "question_id": 36554499, "link": "https://stackoverflow.com/questions/36554499/haskell-have-a-function-return-an-empty-character/36554607#36554607", "title": "Haskell - have a function return an empty character", "body": "<p>You can't do this with just <code>map</code>, by definition it can't change the length of the collection it's applied to.  However, you can get this to work without too many changes by switching to <code>concatMap</code>.  This function requires the your function that you're mapping return a list, then it concatenates all the results together.  All you'd need to do is</p>\n\n<pre><code>dropEvery str n =\n    concatMap (\\(char, indx) -&gt; if indx `mod` n /= 0 then [char] else []) (zip str [1..])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1460395820, "last_edit_date": 1460395820, "creation_date": 1460394246, "answer_id": 36554923, "question_id": 36554499, "link": "https://stackoverflow.com/questions/36554499/haskell-have-a-function-return-an-empty-character/36554923#36554923", "title": "Haskell - have a function return an empty character", "body": "<p>You can do this without <code>mod</code>. I'm going to flip the order of the arguments to make this more idiomatic.</p>\n\n<pre><code>dropEvery :: Int -&gt; [a] -&gt; [a]\ndropEvery n xs = map fst . filter ((/= n) . snd) $ zip xs (cycle [1..n])\n</code></pre>\n\n<p>If speed is critical, it would likely be most efficient to use this technique with explicit recursion or <code>foldr</code>. Something like this:</p>\n\n<pre><code>dropEvery n xs = foldr go (`seq` []) xs n where\n  go _ r 1 = r n\n  go x r k = x : r (k - 1)\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 4964866, "user_type": "registered", "profile_image": "https://graph.facebook.com/10152801637182397/picture?type=large", "display_name": "Raul \u0160pilev", "link": "https://stackoverflow.com/users/4964866/raul-%c5%a0pilev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2074, "favorite_count": 0, "accepted_answer_id": 36554607, "answer_count": 3, "score": 6, "last_activity_date": 1460395820, "creation_date": 1460392873, "question_id": 36554499, "link": "https://stackoverflow.com/questions/36554499/haskell-have-a-function-return-an-empty-character", "title": "Haskell - have a function return an empty character", "body": "<p>I'm trying to create a function that drops every n'th element from a string.</p>\n\n<pre><code>dropEvery :: String -&gt; Int -&gt; String\ndropEvery str n = map (\\(char, indx) -&gt; if indx `mod` n /= 0 then char else ' ') (zip str [1..])\n</code></pre>\n\n<p>Right now it simply replaces every n'th element with a space, but what am I supposed to put after the \"else\" if I want it to return an \"empty char\". I understand that such a thing doesn't exist in Haskell so the question is - how am I supposed to tell Haskell to not return anything and just move on to the next char?</p>\n"}, {"tags": ["haskell", "haskell-lens", "arrows"], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460422485, "post_id": 36561090, "comment_id": 60723942, "body": "I think it&#39;s quite a stretch to say arrows are about being able to act both as a getter and a setter."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460422523, "post_id": 36561090, "comment_id": 60723952, "body": "just the arrows in twanvl&#39;s blog post"}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460422709, "post_id": 36561090, "comment_id": 60723999, "body": "first link in the answer"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460452469, "post_id": 36561090, "comment_id": 60736559, "body": "The first link says nothing about arrows."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460465702, "post_id": 36561090, "comment_id": 60746436, "body": "&#39;references, arrows, and categories&#39;"}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": false, "score": 3, "last_activity_date": 1460417659, "creation_date": 1460417659, "answer_id": 36561090, "question_id": 36553821, "link": "https://stackoverflow.com/questions/36553821/lens-or-arrows-for-updating-a-tree-structures/36561090#36561090", "title": "Lens or arrows for updating a tree structures?", "body": "<p><a href=\"http://twanvl.nl/tag/lens\" rel=\"nofollow\">Lenses and arrows are theoretical cousins</a>, both attempts to create compositional, functional values that could act as both getters and setters. But, and this is a subjective opinion, I think that if you're on the fence you should use lens. It comes down to library support. Lens is</p>\n\n<ul>\n<li><p>More actively maintained, with commits landing almost every day</p></li>\n<li><p>Basically the same user interface (use <code>.</code> to smash lenses together to form new lenses vs. use <code>.</code> to smash arrows together)</p></li>\n<li><p>Possible to <a href=\"https://www.reddit.com/r/haskell/comments/1nwetz/lenses_that_work_with_arrows/ccmrn33\" rel=\"nofollow\">lift arrows into lenses</a> (sort of; more of a demonstration than anything)</p></li>\n<li><p>Possible to <a href=\"https://hackage.haskell.org/package/xml-lens-0.1.6.3/docs/Text-XML-Lens.html\" rel=\"nofollow\">lens into XML with xml-lenses</a></p></li>\n<li><p>Filled with other goodies (like traversals and folds and isomorphisms) and helpers (think: lensing into generics, uniplate, MonadReader/MonadState)</p></li>\n<li><p>Currently more popular in the Haskell community, with e.g. more people knowledgable and answering questions on Stack Overflow</p></li>\n</ul>\n\n<p>One downside: <code>lens</code> is a big ol' package with gnarly types.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1460417659, "creation_date": 1460390781, "question_id": 36553821, "link": "https://stackoverflow.com/questions/36553821/lens-or-arrows-for-updating-a-tree-structures", "title": "Lens or arrows for updating a tree structures?", "body": "<p>I ran into an example (from 2010) of <a href=\"https://github.com/silkapp/xml-arrow/blob/master/examples/Test.hs\" rel=\"nofollow\">using arrows for XML manipulation</a></p>\n\n<p>Are there advantages to <code>arrow</code> abstraction over more recent <code>lens</code> for use-case demonstrated there?</p>\n"}, {"tags": ["list", "function", "haskell", "permutation"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1460389578, "post_id": 36553183, "comment_id": 60707123, "body": "It would be helpful if you could explain the intended meaning and/or purpose of this function. This smells like it could be something mathematical. Thinking about the underlying meaning could lead to a simpler, cleaner solution than staring at code."}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 1395518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5d1b90f84ba434d5f6b4e67f2d557c1d?s=128&d=identicon&r=PG", "display_name": "Ian Stewart", "link": "https://stackoverflow.com/users/1395518/ian-stewart"}, "edited": false, "score": 0, "creation_date": 1460477815, "post_id": 36553294, "comment_id": 60756658, "body": "Thanks for that, it did not occur to me that pattern matching could be used on functions."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 1, "last_activity_date": 1460389392, "creation_date": 1460389392, "answer_id": 36553294, "question_id": 36553183, "link": "https://stackoverflow.com/questions/36553183/defining-a-constant-value-at-begining-haskell-function/36553294#36553294", "title": "Defining a constant value at begining Haskell function", "body": "<p>You can pattern match to separate the cases</p>\n\n<pre><code>fullFunction theList | even (length theList) = funcEven theList\nfullFunction theList = funcOdd theList\n</code></pre>\n\n<p>when you call <code>fullFunction</code>, it will try the first case, checking if the length of the list is even.  If this fails it will fallback to the second case.</p>\n"}, {"comments": [{"owner": {"reputation": 343, "user_id": 1395518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5d1b90f84ba434d5f6b4e67f2d557c1d?s=128&d=identicon&r=PG", "display_name": "Ian Stewart", "link": "https://stackoverflow.com/users/1395518/ian-stewart"}, "edited": false, "score": 0, "creation_date": 1460478145, "post_id": 36554045, "comment_id": 60756902, "body": "Thanks karakfa. I have used <code>zipWith const ... </code>  in a derivation of your function now but cannot work out how it works.  How does the <code>zipWith</code>  work in relation to the go function? Does <code>(go xs) xs</code>  act as a list?"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 343, "user_id": 1395518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5d1b90f84ba434d5f6b4e67f2d557c1d?s=128&d=identicon&r=PG", "display_name": "Ian Stewart", "link": "https://stackoverflow.com/users/1395518/ian-stewart"}, "edited": false, "score": 0, "creation_date": 1460478596, "post_id": 36554045, "comment_id": 60757185, "body": "it zips <code>(go xs)</code> with <code>xs</code> and picks the first element.  That&#39;s to limit the length of the list to min length of the two which is length of <code>xs</code> in this case.  fyi: <code>const a b = a</code>.  I think here you can use <code>take x</code> since length is already calculated."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1460391423, "creation_date": 1460391423, "answer_id": 36554045, "question_id": 36553183, "link": "https://stackoverflow.com/questions/36553183/defining-a-constant-value-at-begining-haskell-function/36554045#36554045", "title": "Defining a constant value at begining Haskell function", "body": "<p>Perhaps cleaner this way</p>\n\n<pre><code>func xs = zipWith const (go xs) xs\n     where go [] = []\n           go (x:xs) = 2*x : ((length xs)-off-x) : go xs\n           off = mod (length xs) 2\n</code></pre>\n\n<p>the only difference I see between the two functions is use of <code>pred n</code> vs <code>n</code> which is replaced with off(set) derived from the length of the original list.  </p>\n\n<p><code>zipWith const ...</code> truncates the result with the length of the original list to replace <code>take (n+1)</code>.</p>\n"}], "owner": {"reputation": 343, "user_id": 1395518, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5d1b90f84ba434d5f6b4e67f2d557c1d?s=128&d=identicon&r=PG", "display_name": "Ian Stewart", "link": "https://stackoverflow.com/users/1395518/ian-stewart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1460391423, "creation_date": 1460389142, "question_id": 36553183, "link": "https://stackoverflow.com/questions/36553183/defining-a-constant-value-at-begining-haskell-function", "title": "Defining a constant value at begining Haskell function", "body": "<p>I have just started learning Haskell and have written two functions, one for lists with even lengths and one for lists odd lengths. This means the 'even' function with [0..7] returns [0,7,2,5,4,3,6,1], and the 'odd' function with [0..8] returns [0,7,2,5,4,3,6,1,8] - these are the results I need.\nHowever I after a lot of work I am still not able to combine them so that just one function works for both lists. Here are the functions and I wondered if more experienced Haskell coders know of a solution.</p>\n\n<pre><code>funcOdd :: [Int] -&gt; [Int]\nfuncOdd [] = []\nfuncOdd (x:xs) = take (n+1) ((x*2) : (pred n - x):funcOdd(xs))  where n = length xs\n\nfuncEven :: [Int] -&gt; [Int]\nfuncEven [] = []\nfuncEven (x:xs) = take (n+1) ((x*2) : (n - x):funcEven(xs))  where n = length xs\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "atom-editor"], "comments": [{"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "edited": false, "score": 0, "creation_date": 1460384783, "post_id": 36551523, "comment_id": 60703638, "body": "can anyone help me? i fail to get haskell running in atom."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 0, "creation_date": 1460384911, "post_id": 36551523, "comment_id": 60703749, "body": "What did you do to get this error?  Is this haskell or Javascript?"}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1460385576, "post_id": 36551523, "comment_id": 60704252, "body": "what&#39;s the output of <code>ghc-mod debug</code> when you run it in the project directory?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1460389777, "post_id": 36551523, "comment_id": 60707252, "body": "Is it an error message from Atom? I guess either you didn&#39;t install ghc-mod or it&#39;s not in your PATH."}, {"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "edited": false, "score": 0, "creation_date": 1460494756, "post_id": 36551523, "comment_id": 60766753, "body": "was not in path, i solved it thanks. As i am not good with terminal i had some problems."}], "answers": [{"tags": [], "owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "is_accepted": false, "score": 2, "last_activity_date": 1461181577, "last_edit_date": 1461181577, "creation_date": 1461179649, "answer_id": 36753105, "question_id": 36551523, "link": "https://stackoverflow.com/questions/36551523/haskell-ghc-mod-ghc-mod-failed-to-launch-it-is-probably-missing-or-misconfigur/36753105#36753105", "title": "Haskell-ghc-mod: ghc-mod failed to launch. It is probably missing or misconfigured. ENOENT", "body": "<p>i ran into this problem right now, what i have done is to go Atom , in the header press Atom ->Preferences then Package, for the <a href=\"https://i.stack.imgur.com/pbSBe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pbSBe.png\" alt=\"enter image description here\"></a>ide-haskell package go to setting and set the path for stylish-haskell, then for haskell-ghc-mode package also set up ghc mod and ghc modi path</p>\n"}], "owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1484838669, "creation_date": 1460384761, "last_edit_date": 1484838669, "question_id": 36551523, "link": "https://stackoverflow.com/questions/36551523/haskell-ghc-mod-ghc-mod-failed-to-launch-it-is-probably-missing-or-misconfigur", "title": "Haskell-ghc-mod: ghc-mod failed to launch. It is probably missing or misconfigured. ENOENT", "body": "<pre><code>Error: spawn ghc-mod ENOENT\nPATH: /usr/bin:/bin:/usr/sbin:/sbin\npath: undefined\nPath: undefined\nHide Stack Trace\nError\n    at /Users/Mauritius/.atom/packages/haskell-ghc-mod/lib/ghc-mod/ghc-modi-process.coffee:60:28\n    at exithandler (child_process.js:222:5)\n    at ChildProcess.errorhandler (child_process.js:229:5)\n    at emitOne (events.js:77:13)\n    at ChildProcess.emit (events.js:169:7)\n    at Process.ChildProcess._handle.onexit (internal/child_process.js:198:12)\n    at onErrorNT (internal/child_process.js:344:16)\n    at doNTCallback2 (node.js:441:9)\n    at process._tickCallback (node.js:355:17\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460377264, "post_id": 36548493, "comment_id": 60697670, "body": "the <code>theWorld :: [Cell]</code> part? I tells you that the world consist of a <i>list of cells</i> ... the <code>[a]</code> is just a <i>list of <code>a</code></i>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460377445, "post_id": 36548493, "comment_id": 60697825, "body": "you should probably write <code>old_cells = theWorld squareWorld</code> and then <code>old_cellstates = map cellState old_cells</code>, ... - usually this is the point where <i>lenses</i>  come in but if you have trouble with lists I would not recommend poking into this ant-nest ^^ of a type-mess"}, {"owner": {"reputation": 9, "user_id": 6165221, "user_type": "registered", "profile_image": "https://graph.facebook.com/737180216384995/picture?type=large", "display_name": "Jonathan  Zhuang", "link": "https://stackoverflow.com/users/6165221/jonathan-zhuang"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460378941, "post_id": 36548493, "comment_id": 60698975, "body": "Thanks a lot. I think I should escape from this ant-nest now."}], "owner": {"reputation": 9, "user_id": 6165221, "user_type": "registered", "profile_image": "https://graph.facebook.com/737180216384995/picture?type=large", "display_name": "Jonathan  Zhuang", "link": "https://stackoverflow.com/users/6165221/jonathan-zhuang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 200, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460377063, "creation_date": 1460377063, "question_id": 36548493, "link": "https://stackoverflow.com/questions/36548493/when-define-a-data-as-xxx-in-what-form-should-i-use-it-in-code", "title": "When define a data as &quot;[xxx]&quot; , in what form should I use it in code?", "body": "<p>Data definitions are as follow: </p>\n\n<pre><code>data SquareWorld = SquareWorld { theAnt :: Ant, theWorld :: [Cell]}\nderiving Show\n\ndata Coord = Coord {xCoord :: XCoord, yCoord :: YCoord}\nderiving (Show, Eq)\n\ndata Cell = Cell {cellPosition :: Coord, cellState :: CellState}\nderiving (Show, Eq)\n\ndata Ant = Ant { antPosition :: Coord\n           , antOrientation :: Direction\n           , antTransition :: [Transition SquareTurn]}\nderiving (Show, Eq)\n</code></pre>\n\n<p>I write:</p>\n\n<pre><code>changecolour :: SquareWorld -&gt; SquareWorld \nchangecolour squareWorld =\n  let \n  old_cell = theWorld squareWorld\n  old_cellstate = cellState old_cell\n  new_cellstate =nextCellState old_cellstate \n  new_cell = old_cell { cellState = new_cellstate}\n  newsquareWorld = squareWorld { theWorld = new_cell}\n  in\n  newsquareWorld\n\nchangedirection :: SquareWorld -&gt; SquareWorld\nchangedirection squareWorld =\n  let\n  oldant = theAnt squareWorld\n  old_cell = theWorld squareWorld\n  old_cellstate = cellState old_cell\n  olddirection = antOrientation oldant\n  newant = case getStateColour old_cellstate of \n      1 -&gt; oldant { antOrientation = succ' olddirection}\n      0 -&gt; oldant { antOrientation = pred' olddirection}\n  newsquareWorld = squareWorld { theAnt = newant}\n  in\n  newsquareWorld\n</code></pre>\n\n<p>Error massage :</p>\n\n<pre><code>src/StudentSources/LangtonsAnt.hs:152:31:\nCouldn't match expected type \u2018Cell\u2019 with actual type \u2018[Cell]\u2019\nIn the first argument of \u2018cellState\u2019, namely \u2018old_cell\u2019\nIn the expression: cellState old_cell\n\nsrc/StudentSources/LangtonsAnt.hs:154:16:\nCouldn't match expected type \u2018Cell\u2019 with actual type \u2018[Cell]\u2019\nIn the expression: old_cell\nIn the expression: old_cell {cellState = new_cellstate}\n\nsrc/StudentSources/LangtonsAnt.hs:155:47:\nCouldn't match expected type \u2018[Cell]\u2019 with actual type \u2018Cell\u2019\nIn the \u2018theWorld\u2019 field of a record\nIn the expression: squareWorld {theWorld = new_cell}\n\nsrc/StudentSources/LangtonsAnt.hs:164:31:\nCouldn't match expected type \u2018Cell\u2019 with actual type \u2018[Cell]\u2019\nIn the first argument of \u2018cellState\u2019, namely \u2018old_cell\u2019\nIn the expression: cellState old_cell\n</code></pre>\n\n<p>It must be something wrong with my grammar but I have no idea about it.\nSince type\"Cell\" is actually type[Cell], should I put\"[]\" in my code?</p>\n\n<p>I am really confused about the meaning of \"[]\" in the data definition.</p>\n"}, {"tags": ["haskell", "generics", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 617, "user_id": 2036930, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5611c46bb33e051bf692b69cf4411377?s=128&d=identicon&r=PG", "display_name": "statusfailed", "link": "https://stackoverflow.com/users/2036930/statusfailed"}, "edited": false, "score": 0, "creation_date": 1460386459, "post_id": 36551078, "comment_id": 60704907, "body": "Cool! Who do I talk to / where do I go to fix them?"}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "reply_to_user": {"reputation": 617, "user_id": 2036930, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5611c46bb33e051bf692b69cf4411377?s=128&d=identicon&r=PG", "display_name": "statusfailed", "link": "https://stackoverflow.com/users/2036930/statusfailed"}, "edited": false, "score": 1, "creation_date": 1460398745, "post_id": 36551078, "comment_id": 60712859, "body": "@statusfailed Actually, it&#39;s already fixed: <a href=\"http://downloads.haskell.org/~ghc/master/libraries/html/base/GHC-Generics.html#g:13\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/master/libraries/html/base/&hellip;</a> (thanks to Ben Gamari)."}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": true, "score": 4, "last_activity_date": 1460383677, "creation_date": 1460383677, "answer_id": 36551078, "question_id": 36544459, "link": "https://stackoverflow.com/questions/36544459/haskell-ghc-generics-documentation-example-missing-a-typeclass-constraint/36551078#36551078", "title": "Haskell/GHC Generics documentation example missing a typeclass constraint?", "body": "<p>Yes, I think the docs are wrong. The constraint is required.</p>\n"}], "owner": {"reputation": 617, "user_id": 2036930, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/5611c46bb33e051bf692b69cf4411377?s=128&d=identicon&r=PG", "display_name": "statusfailed", "link": "https://stackoverflow.com/users/2036930/statusfailed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 36551078, "answer_count": 1, "score": 4, "last_activity_date": 1460383677, "creation_date": 1460366037, "question_id": 36544459, "link": "https://stackoverflow.com/questions/36544459/haskell-ghc-generics-documentation-example-missing-a-typeclass-constraint", "title": "Haskell/GHC Generics documentation example missing a typeclass constraint?", "body": "<p>I'm following the tutorial for building a Generic \"encode\" function for datatypes from the <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/GHC-Generics.html\" rel=\"nofollow\">hackage documentation</a> for <code>GHC.Generics</code>. I've copy-pasted the code up to (and including) the section \"The wrapper and generic default\", but I get the following error:</p>\n\n<pre><code>Main.hs:35:14:\n    Could not deduce (Encode' (Rep a)) arising from a use of \u2018encode'\u2019\n    from the context (Encode a)\n      bound by the class declaration for \u2018Encode\u2019\n      at Main.hs:(32,1)-(35,29)\n    or from (Generic a)\n      bound by the type signature for encode :: Generic a =&gt; a -&gt; [Bool]\n      at Main.hs:33:13-23\n    In the expression: encode' (from x)\n    In an equation for \u2018encode\u2019: encode x = encode' (from x)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>The code I've copied is as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DeriveGeneric #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE DefaultSignatures #-}\n{-# LANGUAGE FlexibleContexts  #-}\n{-# LANGUAGE DeriveAnyClass    #-}\nmodule Main where\n\nimport GHC.Generics\n\nclass Encode' f where\n  encode' :: f p -&gt; [Bool]\n\ninstance Encode' V1 where\n  encode' x = undefined\n\ninstance Encode' U1 where\n  encode' U1 = []\n\ninstance (Encode' f, Encode' g) =&gt; Encode' (f :+: g) where\n  encode' (L1 x) = False : encode' x\n  encode' (R1 x) = True  : encode' x\n\ninstance (Encode' f, Encode' g) =&gt; Encode' (f :*: g) where\n  encode' (x :*: y) = encode' x ++ encode' y\n\ninstance (Encode c) =&gt; Encode' (K1 i c) where\n  encode' (K1 x) = encode x\n\ninstance (Encode' f) =&gt; Encode' (M1 i t f) where\n  encode' (M1 x) = encode' x\n\nclass Encode a where\n  encode :: a -&gt; [Bool]\n  default encode :: (Generic a) =&gt; a -&gt; [Bool]\n  encode x = encode' (from x)\n</code></pre>\n\n<p>I think the problem is at the final class declaration (<code>class Encode a where ...</code>). I've fixed it by adding an extra constraint, to get this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Encode a where\n  encode :: a -&gt; [Bool]                                                                                                                                                              \n  default encode :: (Generic a, Encode' (Rep a)) =&gt; a -&gt; [Bool]\n  encode x = encode' (from x)\n</code></pre>\n\n<p>This seems to work as advertised - I can declare new datatypes and make them encodable with <code>DeriveAnyClass</code> and <code>deriving</code>. However, I'm not really sure why my fix is necessary. My question is:</p>\n\n<ul>\n<li>Are the docs wrong?</li>\n<li>Should the <code>Encode' (Rep a)</code> constraint be present in the example code on hackage?</li>\n<li>If not, what should I add to make the code work?</li>\n</ul>\n"}, {"tags": ["haskell", "happy"], "comments": [{"owner": {"reputation": 585, "user_id": 2844582, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/dc74eb3fe99c52ceaec1db7e8a720fe1?s=128&d=identicon&r=PG&f=1", "display_name": "Xandaros", "link": "https://stackoverflow.com/users/2844582/xandaros"}, "edited": false, "score": 1, "creation_date": 1460383084, "post_id": 36544041, "comment_id": 60702336, "body": "happy 1.19.5 actually compiles fine for me with GHC 7.10.3. Are you sure you were trying to compile 1.19.5 and not an older version?"}], "answers": [{"tags": [], "owner": {"reputation": 5306, "user_id": 638427, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/69cc8a4ecce6d41b1a3cc3c710219098?s=128&d=identicon&r=PG", "display_name": "Martin Ring", "link": "https://stackoverflow.com/users/638427/martin-ring"}, "is_accepted": false, "score": 1, "last_activity_date": 1460366296, "creation_date": 1460366296, "answer_id": 36544570, "question_id": 36544041, "link": "https://stackoverflow.com/questions/36544041/haskell-problems-using-happy-1-19-5-with-ghc-7-10-3/36544570#36544570", "title": "Haskell: Problems using Happy 1.19.5 with GHC 7.10.3", "body": "<p>Begining with GHC 7.10 the <a href=\"https://wiki.haskell.org/Functor-Applicative-Monad_Proposal\" rel=\"nofollow\">\"Applicative Monad Proposal\"</a> has been implemented. This is a breaking change and the Happy library has not yet been updated to address this.</p>\n\n<p>There is a <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Migration/7.10#GHCsaysNoinstanceforApplicative...\" rel=\"nofollow\">migration guide</a> in the haskell wiki, which addresses exactly this problem.</p>\n\n<p>Basically since <code>Applicative</code> and <code>Functor</code> are now superclasses of <code>Monad</code> you need to add instance declarations. In this case <code>HappyIdentity</code> is an instance of <code>Monad</code> so you need to add instances <code>Applicative HappyIdentity</code> and <code>Functor HappyIdentity</code>. In addition the <code>Monad</code> instance can be removed since it is now redundant.</p>\n\n<p>Without modifying the library yourself, the only option is to donwgrade to an earlier GHC release or wait until the library maintainer updates the library.</p>\n"}], "owner": {"reputation": 11, "user_id": 6187261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f9708bd938ef4b5c13ffa644e783b99a?s=128&d=identicon&r=PG&f=1", "display_name": "Berthold Hoffmann", "link": "https://stackoverflow.com/users/6187261/berthold-hoffmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1460366296, "creation_date": 1460364890, "question_id": 36544041, "link": "https://stackoverflow.com/questions/36544041/haskell-problems-using-happy-1-19-5-with-ghc-7-10-3", "title": "Haskell: Problems using Happy 1.19.5 with GHC 7.10.3", "body": "<p>the latest version of Happy gives the following error message with GHC 7.10.4</p>\n\n<p>No instance for (Applicative HappyIdentity)\n      arising from the superclasses of an instance declaration</p>\n\n<p>I think I should nof mess up Happy, but how can I solve my problem?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1460358663, "post_id": 36541963, "comment_id": 60685573, "body": "if you want to <i>cheat</i>  you can always use <a href=\"http://pointfree.io/\" rel=\"nofollow noreferrer\">Pointfree.io</a>"}, {"owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460360390, "post_id": 36541963, "comment_id": 60686531, "body": "I used it at a moment but I also want to understand what it does."}], "answers": [{"tags": [], "owner": {"reputation": 167922, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 2, "last_activity_date": 1460358567, "creation_date": 1460358567, "answer_id": 36542043, "question_id": 36541963, "link": "https://stackoverflow.com/questions/36541963/haskell-pointfree-programming/36542043#36542043", "title": "Haskell pointfree programming", "body": "<p><code>myCycle = foldr (++) [] $ repeat</code> is equivalent to <code>myCycle z = (foldr (++) [] $ repeat) z</code>.</p>\n\n<p><code>(x $ y) z</code> is equal to <code>(x y) z</code>; <code>(x . y) z</code> is equal to <code>x (y z)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "edited": false, "score": 0, "creation_date": 1460385565, "post_id": 36542287, "comment_id": 60704242, "body": "Can you explain how did you get <code>((.) (zipWith (+) (map (+2))) l1</code> from <code>zipWith (+) (map (+2) l1)</code> ?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "edited": false, "score": 0, "creation_date": 1460388441, "post_id": 36542287, "comment_id": 60706334, "body": "<code>f (g x)</code> is <code>(f . g) x</code>. If you add additional parentheses, you&#39;ll see that <code>f = zipWith (+)</code> and <code>g = map (+2)</code>."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 6, "last_activity_date": 1460388393, "last_edit_date": 1460388393, "creation_date": 1460359367, "answer_id": 36542287, "question_id": 36541963, "link": "https://stackoverflow.com/questions/36541963/haskell-pointfree-programming/36542287#36542287", "title": "Haskell pointfree programming", "body": "<p>First of all, let's list all types:</p>\n\n<pre><code>foldr  :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\n(++)   :: [a] -&gt; [a] -&gt; [a]\n[]     :: [a]\nrepeat ::  a  -&gt; [a]\n(.)    :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n($)    :: (a -&gt; b) -&gt; a -&gt; b\n\nfoldr (++)          :: [a] -&gt; [[a]] -&gt; [a]\nfoldr (++) []       ::        [[a]] -&gt; [a]\n</code></pre>\n\n<p>Now, as you can see, <code>($)</code> doesn't change the type at all. It's just so that its fixity makes sure that you can use it instead of parentheses. Let's see how they differ:</p>\n\n<pre><code>($) (foldr (++) []) :: [[a]]             -&gt; [a]\n(.) (foldr (++) []) :: (b -&gt; [[a]]) -&gt; b -&gt; [a]\n</code></pre>\n\n<p>Since <code>repeat</code> has type <code>c -&gt; [c]</code>, it doesn't work with <code>($)</code>. It sure does with <code>(.)</code>, since <code>c ~ [a]</code> works fine.</p>\n\n<p>So always keep in mind that <code>($)</code> doesn't do anything on its own. It merely changes the precedence/fixity. Also, it sometimes helps if you use prefix notation instead of infix if you try to understand/come to pointfree code:</p>\n\n<pre><code>sum l1 l2 = zipWith (+) (map (+2) l1) l2\n          = zipWith (+) (map (+2) l1) $ l2\n          = ($) (zipWith (+) (map (+2) l1)) l2\n-- get rid  of both ($) and l2:\nsum l1    = zipWith (+) (map (+2) l1)\n          = (zipWith (+)) ((map (+2)) l1)\n          = f (g l1)                           -- f = zipWith (+), g = map (+2) \n          = (f . g) l1\n          = (zipWith (+) . (map (+2)) l1       -- substitute f and g again\n          = zipWith (+) . (map (+2) $ l1\n-- get rid of $ and l1:\nsum       = zipWith (+) . map (+2)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 760, "user_id": 6165079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f16b76fbe5a1972323696457c211571b?s=128&d=identicon&r=PG", "display_name": "Marvin Sielenkemper", "link": "https://stackoverflow.com/users/6165079/marvin-sielenkemper"}, "is_accepted": false, "score": 4, "last_activity_date": 1460361677, "creation_date": 1460361677, "answer_id": 36543000, "question_id": 36541963, "link": "https://stackoverflow.com/questions/36541963/haskell-pointfree-programming/36543000#36543000", "title": "Haskell pointfree programming", "body": "<p>If you check the signatures in GHCi you get</p>\n\n<pre><code>Prelude&gt; :t (.)\n(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nPrelude&gt; :t ($)\n($) :: (a -&gt; b) -&gt; a -&gt; b\n</code></pre>\n\n<p>This shows that the dot operator operates on functions while the dollar operator is just a strange version of the normal function application (it allows you to write e.g. <code>f (g (h x))</code> as <code>f $ g $ h $ x</code>).</p>\n\n<p>In your <code>mycycle</code> example <code>foldr (++) []</code> has signature <code>[[a]] -&gt; [a]</code> and <code>repeat</code> has <code>a -&gt; [a]</code>. So when typing <code>foldr (++) [] $ repeat</code> Haskell tries to match the function signature <code>a -&gt; [a]</code> with the first argument of the <code>foldr</code> expression which is <code>[[a]]</code>, a list of lists. This fails and gives an error. The dot operator actually expects a function and everything is fine.</p>\n\n<p>In your second example, <code>sum s = zipWith (+) . map (+ 2) $ s</code> is equivalent to <code>sum = zipWith (+) . map (+ 2)</code>. Type inference regards <code>zipWith (+)</code> as a unary function returning a unary function and is able to match it to the argument expected by the dot operator. So here the functions are first composed and then applied to <code>s</code>. In <code>sum s = zipWith (+) $ map (+ 2) s</code> there is no composition, just application: first <code>map (+ 2)</code> is applied to <code>s</code> and then <code>zipWith (+)</code> is applied to the result.</p>\n\n<p>The point of pointfree programming is to use less function application and more function composition.</p>\n"}, {"tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": false, "score": 1, "last_activity_date": 1460431479, "creation_date": 1460431479, "answer_id": 36563092, "question_id": 36541963, "link": "https://stackoverflow.com/questions/36541963/haskell-pointfree-programming/36563092#36563092", "title": "Haskell pointfree programming", "body": "<p>The best way to gain insight on these things in haskell is to just manually expand things out, based on their definitions.</p>\n\n<pre><code>(f . g) = \\x -&gt; f (g x)\nf $ x   = f x\n</code></pre>\n\n<p>So, whenever we see <code>(f . g)</code>, we can replace it with <code>\\x -&gt; f (g x)</code>.  and when we see <code>f $ x</code>, we can replace it with <code>f x</code>.  let's see where this takes us!</p>\n\n<pre><code>myCycle = foldr (++) [] . repeat\n</code></pre>\n\n<p>Hm, let's expand out the definition of <code>.</code>:</p>\n\n<pre><code>myCycle = \\x -&gt; foldr (++) [] (repeat x)\nmyCycle x = foldr (++) [] (repeat x)\n</code></pre>\n\n<p>Sweet, this basically does exactly what we'd want it to do.  Concatenate a list of repeating x's.</p>\n\n<p>Now, let's see if you had done <code>$</code>:</p>\n\n<pre><code>myCycle = foldr (++) [] $ repeat\n</code></pre>\n\n<p>That becomes:</p>\n\n<pre><code>myCycle = foldr (++) [] repeat\n</code></pre>\n\n<p>That's nice and all, but this doesn't make any sense.  the third argument of <code>foldr</code> should be a list, but you gave it a function (<code>repeat</code>).  <code>repeat</code> is definitely not a list, so this whole affair is kind of silly.</p>\n\n<p>We can try the same thing here:</p>\n\n<pre><code>sum s = zipWith (+) . map (+ 2) $ s\nsum s = (zipWith (+) . map (+ 2)) s\nsum s = zipWith (+) (map (+ 2) s)    -- (f . g) x = f (g x)\n</code></pre>\n\n<p>And look at the other formulation:</p>\n\n<pre><code>sum s = zipWith (+) $ map (+ 2) s\nsum s = (zipWith (+)) (map (+ 2) s)\nsum s = zipWith (+) (map (+ 2) s)      -- redundant parentheses\n</code></pre>\n\n<p>and...they're the same thing!</p>\n\n<p>Let's try seeing what the last one does:</p>\n\n<pre><code>sum l1 l2 = zipWith (+) . map (+ 2) $ l1 $ l2\nsum l1 l2 = zipWith (+) . map (+ 2) $ (l1 l2)\n</code></pre>\n\n<p>Oops...you're trying to do <code>l1 l2</code>, or apply <code>l1</code> as if it were a function.  That doesn't make any sense.  <code>l1</code> is a list, not a function.  So, already here you can see why this is nonsense :)</p>\n"}], "owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 1, "accepted_answer_id": 36542287, "answer_count": 4, "score": 0, "last_activity_date": 1460431479, "creation_date": 1460358304, "question_id": 36541963, "link": "https://stackoverflow.com/questions/36541963/haskell-pointfree-programming", "title": "Haskell pointfree programming", "body": "<p>I am trying to understand pointfree programming in Haskell and I questions on some examples, because I don't really understand the explanation given when the errors occur.</p>\n\n<p>1) I have a cycle function defined below:</p>\n\n<pre><code>myCycle :: [a] -&gt; [a]\nmyCycle = foldr (++) [] . repeat\n</code></pre>\n\n<p>Why does <code>myCycle = foldr (++) [] $ repeat</code> not work?</p>\n\n<p>2) Add every element of a list with 2 then add with another list</p>\n\n<pre><code>sum :: [Int] -&gt; [Int] -&gt; [Int]\nsum s = zipWith (+) . map (+ 2) $ s\n</code></pre>\n\n<p>Why does the function has the same result with <code>sum s = zipWith (+) $ map (+ 2) s</code> and why does <code>sum l1 l2 = zipWith (+) . map (+ 2) $ l1 $ l2</code> not work</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 7628, "user_id": 4885784, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b10fe019f6c7800bef029835802cb38?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Kobe", "link": "https://stackoverflow.com/users/4885784/daniel-kobe"}, "edited": false, "score": 0, "creation_date": 1460341876, "post_id": 36537943, "comment_id": 60680126, "body": "Thanks, what does this line do <code>checkappend _ _ _ = Nothing</code> and how is different then <code>otherwise = Nothing</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 7628, "user_id": 4885784, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b10fe019f6c7800bef029835802cb38?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Kobe", "link": "https://stackoverflow.com/users/4885784/daniel-kobe"}, "edited": false, "score": 0, "creation_date": 1460348719, "post_id": 36537943, "comment_id": 60681727, "body": "@DanielKobe, the <code>otherwise = Nothing</code> doesn&#39;t handle the case where one or both of the arguments is <code>Nothing</code>. <code>_</code> is a wildcard pattern that matches anything and ignores it. If the <code>all test l1</code> guard fails, the matcher will try the next line, <code>checkappend _ _ _</code>, which will succeed."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1460334736, "last_edit_date": 1460334736, "creation_date": 1460333620, "answer_id": 36537943, "question_id": 36537897, "link": "https://stackoverflow.com/questions/36537897/haskell-where-statement-returns-parse-error-on-input/36537943#36537943", "title": "Haskell where statement returns parse error on input \u2018=\u2019", "body": "<p>The <code>where</code> needs to be indented less than the function body, any consistently:</p>\n\n<pre><code>checkappend ml1 ml2 test =\n    if all test l1\n     then Just (l1 ++ l2)\n     else Nothing\n  where l1 = fromJust ml1\n        l2 = fromJust ml2\n</code></pre>\n\n<p>BTW, using partial functions like <code>head</code> or <code>fromJust</code> is bad style. Better use pattern matching on <code>Maybe</code> arguments! Also, <code>if</code> <code>then</code> <code>else</code> is somewhat unpopular in Haskell &ndash; guards tend to look nicer:</p>\n\n<pre><code>checkappend (Just l1) (Just l2) test\n  | all test l1  = Just $ l1 ++ l2\n  | otherwise    = Nothing\n</code></pre>\n\n<p>Of course, the pattern match is still incomplete... what to do if one of the arguments is <code>Nothing</code>? I reckon you want to result to be <code>Nothing</code> then, too; that's possible with a catch-all pattern:</p>\n\n<pre><code>checkappend (Just l1) (Just l2) test\n  | all test l1   = Just $ l1 ++ l2\ncheckappend _ _ _ = Nothing\n</code></pre>\n\n<p>Note that this already includes the <code>| otherwise</code> guard: if no guard for a given pattern clause matches, Haskell just continues with the next clause.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1460346056, "creation_date": 1460346056, "answer_id": 36539453, "question_id": 36537897, "link": "https://stackoverflow.com/questions/36537897/haskell-where-statement-returns-parse-error-on-input/36539453#36539453", "title": "Haskell where statement returns parse error on input \u2018=\u2019", "body": "<p>A really slick way to write it:</p>\n\n<pre><code>import Control.Monad (guard)\n\ncheckAppend m1 m2 test =\n  do\n    l1 &lt;- m1\n    l2 &lt;- m2\n    guard $ all test l1\n    return $ l1 ++ l2\n</code></pre>\n\n<p>This uses the fact that <code>Maybe</code> is a monad with a notion of failure. If either of the arguments is nothing, it fails to extract <code>l1</code> or <code>l2</code> and gives <code>Nothing</code>. If the <code>guard</code> argument is false, it gives <code>Nothing</code>. Finally, if all goes well, it gives <code>Just (l1 ++ l2)</code>.</p>\n\n<p>For fun, try writing the function I just gave and applying it to two lists of lists, instead of two maybe lists. What does it do? Can you figure out why?</p>\n"}], "owner": {"reputation": 7628, "user_id": 4885784, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b10fe019f6c7800bef029835802cb38?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Kobe", "link": "https://stackoverflow.com/users/4885784/daniel-kobe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 36537943, "answer_count": 2, "score": 0, "last_activity_date": 1460346056, "creation_date": 1460333234, "question_id": 36537897, "link": "https://stackoverflow.com/questions/36537897/haskell-where-statement-returns-parse-error-on-input", "title": "Haskell where statement returns parse error on input \u2018=\u2019", "body": "<p>This function I made returns a <code>parse error on input \u2018=\u2019</code></p>\n\n<pre><code>checkappend :: Maybe [a] -&gt; Maybe [a] -&gt; (a -&gt; Bool) -&gt; Maybe [a]\ncheckappend ml1 ml2 test =\n    if all test l1\n    then (Just (l1 ++ l2))\n    else Nothing\n    where l1 = fromJust(ml1)\n        l2 = fromJust(ml2)\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 4, "creation_date": 1460332317, "post_id": 36536745, "comment_id": 60678115, "body": "You seem very keen on point-free style, which makes your code rather hard to read (and, I can imagine, rather hard to write, too!) Don&#39;t be afraid of <code>let</code> bindings or <code>do</code> notation."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 3, "creation_date": 1460357162, "post_id": 36536745, "comment_id": 60684810, "body": "&quot;<code>let</code> go of point-free style: only use it <code>where</code> it makes sense, and you will <code>do</code> better&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1460348886, "post_id": 36537773, "comment_id": 60681765, "body": "<code>(.).(.)</code> is &quot;owl eyes&quot; in my mind, which seems rather more ... family friendly."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 5, "last_activity_date": 1561455436, "last_edit_date": 1561455436, "creation_date": 1460332104, "answer_id": 36537773, "question_id": 36536745, "link": "https://stackoverflow.com/questions/36536745/error-when-trying-to-compose-monadic-functions/36537773#36537773", "title": "Error when trying to compose monadic functions", "body": "<p>You were getting your type error because you were trying to compose a <strong>one-argument</strong> function <code>flatten</code> (which, incidentally, usually goes by the name of <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:join\" rel=\"nofollow noreferrer\"><code>join</code></a>) with a <strong>two-argument</strong> function <code>almostAp</code>. <code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; (a -&gt; c)</code> is meant for when the function on the right is a one-argument function. Unfortunately the error message was not very helpful.</p>\n\n<p><code>(.).(.)</code> (pronounced \"<em>dot</em>-dot-<em>dot</em>\", or \"owl eyes\") does what you want:</p>\n\n<pre><code>ghci&gt; let ap = ((.).(.)) flatten almostAp\nghci&gt; :t ap\nap :: Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b\n</code></pre>\n\n<p>But <code>ap</code> can be implemented much more simply with <code>do</code> notation. Is your version really easier to understand than this?</p>\n\n<pre><code>ap mf mx = do\n    f &lt;- mf\n    x &lt;- mx\n    return (f x)\n</code></pre>\n\n<p><code>do</code> notation is just syntactic sugar for <code>&gt;&gt;=</code>. Here's how it looks without it (though I much prefer the <code>do</code> version):</p>\n\n<pre><code>ap mf mx = mf &gt;&gt;= \\f -&gt; fmap f mx\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": false, "score": 3, "last_activity_date": 1460335011, "last_edit_date": 1495540364, "creation_date": 1460334701, "answer_id": 36538066, "question_id": 36536745, "link": "https://stackoverflow.com/questions/36536745/error-when-trying-to-compose-monadic-functions/36538066#36538066", "title": "Error when trying to compose monadic functions", "body": "<blockquote>\n  <p>But, <code>(flatten .)</code> has type <code>Monad m =&gt; (a -&gt; m (m b)) -&gt; a -&gt; m b</code> according to ghci, so why does this happen?</p>\n</blockquote>\n\n<p>Indeed, it does. Consider:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>flatten  :: Monad m =&gt; m (m a) -&gt; m a\n\nalmostAp :: Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m (m b)\n</code></pre>\n\n<p>Thus, the type of <code>(flatten .)</code> is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>flatten     :: Monad m =&gt; m (m a) -&gt; m a -- renaming a to b\n                          |     |    | |\n                          -------    ---\n                             |        |\n(.)         ::              (b    -&gt;  c) -&gt; (a -&gt;    b)    -&gt; a -&gt;  c\n                                                     |              |\n                                                  -------          ---\n                                                  |     |          | |\n(flatten .) :: Monad m =&gt;                   (a -&gt; m (m b)) -&gt; a -&gt; m b\n</code></pre>\n\n<p>However, you can't apply <code>(flatten .)</code> to <code>almostAp</code> because the types are incompatible:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>almostAp    :: Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m (m b)\n                          |        |    |            |\n                          ----------    --------------\n                               |               |\n                               |            -------\n                               |            |     |\n(flatten .) :: Monad m =&gt; (    a     -&gt;     m (m b))   -&gt; a -&gt; m b\n</code></pre>\n\n<p>You expected this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>almostAp    :: Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m (m b)\n                          |               |    |     |\n                          -----------------    -------\n                                  |               |\n                                  |            -------\n                                  |            |     |\n(flatten .) :: Monad m =&gt; (       a         -&gt; m (m b)) -&gt; a -&gt; m b\n</code></pre>\n\n<p>But, that's not the way <a href=\"https://en.wikipedia.org/wiki/Currying\" rel=\"nofollow noreferrer\">currying</a> works. A function of the type <code>a -&gt; b -&gt; c</code> means <code>a -&gt; (b -&gt; c)</code> and not <code>(a -&gt; b) -&gt; c</code>. The first function <code>a -&gt; (b -&gt; c)</code> takes two arguments<sup>1</sup>, <code>a</code> and <code>b</code>, and returns <code>c</code>. The second function <code>(a -&gt; b) -&gt; c</code> takes one argument <code>a -&gt; b</code> and returns <code>c</code>.</p>\n\n<p>So, how do you compose <code>flatten</code> and <code>almostAp</code>? You can't do it using normal function composition because <code>almostAp</code> requires two arguments:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n       |      |    |      |\n       --------    --------\n           |           |\n        flatten        +-- almostAp can't be used because it needs two arguments\n                        -- but (.) only gives it one argument (the `a` in a -&gt; b)\n</code></pre>\n\n<p>We need a special composition operator to compose them:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(.:) :: (c -&gt; d) -&gt; (a -&gt; b -&gt; c) -&gt; a -&gt; b -&gt; d\n        |      |    |           |\n        --------    -------------\n            |             |\n         flatten      almostAp\n\n(.:) f g x y = f (g x y)\n</code></pre>\n\n<p>Now, we can simply write <code>flatten .: almostAp</code>. Another way to write it would be <code>(flatten .) . almostAp</code>. This is because <code>(.:) = (.) . (.)</code>. Read the following for more details:</p>\n\n<p><a href=\"https://stackoverflow.com/q/20279306/783743\">What does (f .) . g mean in Haskell?</a></p>\n\n<hr>\n\n<p><sup>1</sup> Actually, a function of the type <code>a -&gt; (b -&gt; c)</code> only takes one argument <code>a</code> and returns another function <code>b -&gt; c</code> which takes the second argument <code>b</code> and returns <code>c</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 2695060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/875a1ce473a73108b22056a5deef5a6b?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Liskij", "link": "https://stackoverflow.com/users/2695060/nicholas-liskij"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 36537773, "answer_count": 2, "score": 2, "last_activity_date": 1561455436, "creation_date": 1460330770, "last_edit_date": 1460330959, "question_id": 36536745, "link": "https://stackoverflow.com/questions/36536745/error-when-trying-to-compose-monadic-functions", "title": "Error when trying to compose monadic functions", "body": "<p>I just learned about monads, and I've been trying to implement a lot of the functions in Control.Monad. I just got to <code>ap</code>, but I can't make it work. I made a function <code>almostAp :: Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m (m b)</code>, and I tried to compose it with another function I made, <code>flatten :: Monad m =&gt; m (m b) -&gt; m b</code>. The problem is when I try to use <code>ap = flatten . almostAp</code>, I get </p>\n\n<pre><code>Occurs check: cannot construct the infinite type: m ~ (-&gt;) (m a)\n  Expected type: m (a -&gt; b) -&gt; m a -&gt; m a -&gt; m b\n  Actual type: m (a -&gt; b) -&gt; m a -&gt; m (m b)\nIn the second argument of \u2018(.)\u2019, namely \u2018almostAp\u2019\nIn the expression: (flatten . almostAp)`\n</code></pre>\n\n<p>But, <code>(flatten .)</code> has type <code>Monad m =&gt; (a -&gt; m (m b)) -&gt; a -&gt; m b</code> according to ghci, so why does this happen?</p>\n\n<p>Here are the function definitions (I know I can clean them up with <code>=&lt;&lt;</code> and  the functor laws):</p>\n\n<pre><code>almostAp :: Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m (m b)\nalmostAp = (flip (\\x -&gt; fmap ($x))) . (fmap (flip (&gt;&gt;=))) . (fmap (return .))\n\nflatten :: Monad m =&gt; m (m a) -&gt; m a\nflatten = (&gt;&gt;= id)\n</code></pre>\n"}, {"tags": ["haskell", "f#", "functional-programming"], "comments": [{"owner": {"reputation": 27942, "user_id": 96982, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rX1ss.png?s=128&g=1", "display_name": "GS - Apologise to Monica", "link": "https://stackoverflow.com/users/96982/gs-apologise-to-monica"}, "edited": false, "score": 4, "creation_date": 1460324947, "post_id": 36535869, "comment_id": 60675478, "body": "Would the results be enough to roll back with anyway? I&#39;d probably go for a result type that accumulates the actual rollback operations, so at any step the value is a tuple of success/failure (as now) and a rollback function <code>() -&gt; ()</code>."}, {"owner": {"reputation": 21891, "user_id": 1243762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9b83cf6ca76699d7abfbba07f4675a3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Coder", "link": "https://stackoverflow.com/users/1243762/guy-coder"}, "edited": false, "score": 0, "creation_date": 1460324956, "post_id": 36535869, "comment_id": 60675481, "body": "To bad you asked this as a functional question. Using Prolog, or <a href=\"https://en.wikipedia.org/wiki/Inference_engine\" rel=\"nofollow noreferrer\">inferencing</a> instantly comes to mind. You can implement inferencing in F# and it works great."}, {"owner": {"reputation": 1562, "user_id": 69909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ad2c903e18745e5e61c8838bf79e200f?s=128&d=identicon&r=PG", "display_name": "Oenotria", "link": "https://stackoverflow.com/users/69909/oenotria"}, "edited": false, "score": 0, "creation_date": 1460325341, "post_id": 36535869, "comment_id": 60675591, "body": "Ganesh: Hmm that&#39;s an interesting idea. I&#39;ll have a play around and see how it works out!"}, {"owner": {"reputation": 21891, "user_id": 1243762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9b83cf6ca76699d7abfbba07f4675a3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Coder", "link": "https://stackoverflow.com/users/1243762/guy-coder"}, "edited": false, "score": 1, "creation_date": 1460325537, "post_id": 36535869, "comment_id": 60675653, "body": "In reading this in more detail and thinking about it what are the side effects. Can they all be rolled back? Another way to do this still using inferencing is to not do the side effects at first but accumulate the actions that lead to a success. If you get a success then you execute the actions accumulated to get to a success, if there is no success then there is nothing needed to roll back. Or even forgo the inferencing and if you get to a success at the end just executed the accumulated actions."}, {"owner": {"reputation": 1562, "user_id": 69909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ad2c903e18745e5e61c8838bf79e200f?s=128&d=identicon&r=PG", "display_name": "Oenotria", "link": "https://stackoverflow.com/users/69909/oenotria"}, "edited": false, "score": 0, "creation_date": 1460325630, "post_id": 36535869, "comment_id": 60675678, "body": "Guy: In my current scenario the side effects are: 1) making POST requests to a third-party API which I can rollback by sending the appropriate DELETE request. 2) writing files to disk (rollback by deleting) 3) writing to a database (again, easy to revert)  But I think this is widely encountered problem. I&#39;m surprised there aren&#39;t more articles written about it!  I don&#39;t know very much about prolog or inferencing beyond about two weeks playing with it at university but I will do some reading."}, {"owner": {"reputation": 21891, "user_id": 1243762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9b83cf6ca76699d7abfbba07f4675a3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Coder", "link": "https://stackoverflow.com/users/1243762/guy-coder"}, "edited": false, "score": 0, "creation_date": 1460326033, "post_id": 36535869, "comment_id": 60675796, "body": "Another idea, for each step if it completes successfully you pass on success with an accumulated roll back step. If the step fails you executed the accumulated roll back steps. At the end if you reach success you discard the roll back steps and if you fail you will have executed the roll back steps which can then be deleted."}, {"owner": {"reputation": 21891, "user_id": 1243762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9b83cf6ca76699d7abfbba07f4675a3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Coder", "link": "https://stackoverflow.com/users/1243762/guy-coder"}, "edited": false, "score": 0, "creation_date": 1460326308, "post_id": 36535869, "comment_id": 60675870, "body": "I only suggested inferencing in case you had much experience with it. Please don&#39;t spend too much time on it as it can quickly eat up your time. My best suggestion is to accumulate a roll back step with each successful step and pass that to the next step. No inferencing needed and should be easy to understand for others to follow. I am pretty sure there has been a lot written about it you just have to know where and which keywords to use."}, {"owner": {"reputation": 21891, "user_id": 1243762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9b83cf6ca76699d7abfbba07f4675a3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Coder", "link": "https://stackoverflow.com/users/1243762/guy-coder"}, "edited": false, "score": 0, "creation_date": 1460326597, "post_id": 36535869, "comment_id": 60675942, "body": "Did you use the search terms <code>roll-back recovery</code> or <code>checkpointing</code>? Did you search articles at <a href=\"http://citeseer.ist.psu.edu/index\" rel=\"nofollow noreferrer\">CiteSeer</a>"}, {"owner": {"reputation": 21891, "user_id": 1243762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9b83cf6ca76699d7abfbba07f4675a3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Coder", "link": "https://stackoverflow.com/users/1243762/guy-coder"}, "edited": false, "score": 0, "creation_date": 1460327030, "post_id": 36535869, "comment_id": 60676073, "body": "Also since you tagged Haskell (I don&#39;t know Haskell) and found <a href=\"https://hackage.haskell.org/package/monad-tx-0.0.1/docs/Control-Monad-Tx.html\" rel=\"nofollow noreferrer\">Control-Monad-Tx</a> are you aware of <a href=\"https://github.com/gmpl/FsControl\" rel=\"nofollow noreferrer\">FsControl</a> based on Haskell Control? It might have what you need. I can&#39;t say for sure as I have never used it and did not find the keyword <code>rollback</code> with a quick search."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1460330142, "post_id": 36535869, "comment_id": 60676902, "body": "The answer to this question depends, just as it would in an OO language, on how you want to model transactions in your system. There are lots of ways to implement transactions, each with their own advantages and disadvantages. Perhaps this question would be more likely to find an answer on <a href=\"http://programmers.stackexchange.com/\">Programmers</a>?"}, {"owner": {"reputation": 6198, "user_id": 839601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6db99aa846a8217f7e2aba6fa198e7c?s=128&d=identicon&r=PG", "display_name": "gnat", "link": "https://stackoverflow.com/users/839601/gnat"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1460330606, "post_id": 36535869, "comment_id": 60677012, "body": "@BenjaminHodgson when referring other sites, it is often helpful to point that <a href=\"http://meta.stackexchange.com/tags/cross-posting/info\">cross-posting is frowned upon</a>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 6198, "user_id": 839601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6db99aa846a8217f7e2aba6fa198e7c?s=128&d=identicon&r=PG", "display_name": "gnat", "link": "https://stackoverflow.com/users/839601/gnat"}, "edited": false, "score": 0, "creation_date": 1460330696, "post_id": 36535869, "comment_id": 60677027, "body": "@gnat Thanks. I meant it in the context of migration but I can see how it was ambiguous :)"}], "answers": [{"comments": [{"owner": {"reputation": 21891, "user_id": 1243762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9b83cf6ca76699d7abfbba07f4675a3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Coder", "link": "https://stackoverflow.com/users/1243762/guy-coder"}, "edited": false, "score": 3, "creation_date": 1460330003, "post_id": 36536576, "comment_id": 60676862, "body": "That was fast, nice answer. I can&#39;t believe you said <code>pattern</code> have you been assimilated."}, {"owner": {"reputation": 2634, "user_id": 1136133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26743454d396b65db61e38ccc833ecdb?s=128&d=identicon&r=PG", "display_name": "Grundoon", "link": "https://stackoverflow.com/users/1136133/grundoon"}, "reply_to_user": {"reputation": 21891, "user_id": 1243762, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9b83cf6ca76699d7abfbba07f4675a3?s=128&d=identicon&r=PG&f=1", "display_name": "Guy Coder", "link": "https://stackoverflow.com/users/1243762/guy-coder"}, "edited": false, "score": 2, "creation_date": 1460330878, "post_id": 36536576, "comment_id": 60677065, "body": "resistance is futile!"}], "tags": [], "owner": {"reputation": 2634, "user_id": 1136133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26743454d396b65db61e38ccc833ecdb?s=128&d=identicon&r=PG", "display_name": "Grundoon", "link": "https://stackoverflow.com/users/1136133/grundoon"}, "is_accepted": true, "score": 20, "last_activity_date": 1460395594, "last_edit_date": 1460395594, "creation_date": 1460329421, "answer_id": 36536576, "question_id": 36535869, "link": "https://stackoverflow.com/questions/36535869/how-to-deal-with-rollbacks-when-using-the-either-monad-railway-oriented-progra/36536576#36536576", "title": "How to deal with rollbacks when using the Either monad (&quot;railway-oriented programming&quot;)", "body": "<p>As people have pointed out in the comments, there are a couple of options that can be used to solve this.</p>\n\n<p>One way is to use <a href=\"https://msdn.microsoft.com/en-gb/library/dn589804.aspx\">compensating transactions</a>.</p>\n\n<p>In this approach, the <code>Success</code> case contains a list of \"undo\" functions. Every step that can be undone adds a function to this list.\nWhen any step fails, each undo function in the list is executed (in reverse order).</p>\n\n<p>There are more sophisticated ways to do this of course (e.g storing the undo functions persistently in case of crashes,\nor <a href=\"http://jpos.org/blog/2013/11/w55y/\">this kind of thing</a>).</p>\n\n<p>Here's some code that demonstrates this approach:</p>\n\n<pre><code>/// ROP design with compensating transactions    \nmodule RopWithUndo =\n\n    type Undo = unit -&gt; unit\n\n    type Result&lt;'success&gt; =\n        | Success of 'success * Undo list\n        | Failure of string\n\n    let bind f x =\n        match x with\n        | Failure e -&gt; Failure e \n        | Success (s1,undoList1) -&gt;\n            match f s1 with\n            | Failure e -&gt;\n                // undo everything in reverse order \n                undoList1 |&gt; List.rev |&gt; List.iter (fun undo -&gt; undo())\n                // return the error\n                Failure e \n            | Success (s2,undoList2) -&gt;\n                // concatenate the undo lists\n                Success (s2, undoList1 @ undoList2)\n\n/// Example\nmodule LaunchWithUndo =\n\n    open RopWithUndo\n\n    let undo_refuel() =\n        printfn \"undoing refuel\"\n\n    let refuel ok =\n        if ok then\n            printfn \"doing refuel\"\n            Success (\"refuel\", [undo_refuel])\n        else \n            Failure \"refuel failed\"\n\n    let undo_enterLaunchCodes() =\n        printfn \"undoing enterLaunchCodes\"\n\n    let enterLaunchCodes ok refuelInfo =\n        if ok then\n            printfn \"doing enterLaunchCodes\"\n            Success (\"enterLaunchCodes\", [undo_enterLaunchCodes])\n        else \n            Failure \"enterLaunchCodes failed\"\n\n    let fireMissile ok launchCodesInfo =\n        if ok then\n            printfn \"doing fireMissile \"\n            Success (\"fireMissile \", [])\n        else \n            Failure \"fireMissile failed\"\n\n    // test with failure at refuel\n    refuel false\n    |&gt; bind (enterLaunchCodes true)\n    |&gt; bind (fireMissile true)\n    (*\n    val it : Result&lt;string&gt; = Failure \"refuel failed\"\n    *)\n\n    // test with failure at enterLaunchCodes\n    refuel true\n    |&gt; bind (enterLaunchCodes false)\n    |&gt; bind (fireMissile true)\n    (*\n    doing refuel\n    undoing refuel\n    val it : Result&lt;string&gt; = Failure \"enterLaunchCodes failed\"\n    *)\n\n    // test with failure at fireMissile\n    refuel true\n    |&gt; bind (enterLaunchCodes true)\n    |&gt; bind (fireMissile false)\n    (*\n    doing refuel\n    doing enterLaunchCodes\n    undoing enterLaunchCodes\n    undoing refuel\n    val it : Result&lt;string&gt; = Failure \"fireMissile failed\"\n    *)\n\n    // test with no failure \n    refuel true\n    |&gt; bind (enterLaunchCodes true)\n    |&gt; bind (fireMissile true)\n    (*\n    doing refuel\n    doing enterLaunchCodes\n    doing fireMissile \n    val it : Result&lt;string&gt; =\n      Success (\"fireMissile \",[..functions..])\n    *)\n</code></pre>\n\n<p>If the results of each <em>cannot</em> be undone, a second option is not to do irreversible things in each step at all,\nbut to delay the irreversible bits until all steps are OK.</p>\n\n<p>In this approach, the <code>Success</code> case contains a list of \"execute\" functions. Every step that succeeds adds a function to this list.\nAt the very end, the entire list of functions is executed.</p>\n\n<p>The downside is that once committed, all the functions are run (although you could also chain those monadically too!)</p>\n\n<p>This is basically a very crude version of the interpreter pattern.</p>\n\n<p>Here's some code that demonstrates this approach:</p>\n\n<pre><code>/// ROP design with delayed executions\nmodule RopWithExec =\n\n    type Execute = unit -&gt; unit\n\n    type Result&lt;'success&gt; =\n        | Success of 'success * Execute list\n        | Failure of string\n\n    let bind f x =\n        match x with\n        | Failure e -&gt; Failure e \n        | Success (s1,execList1) -&gt;\n            match f s1 with\n            | Failure e -&gt;\n                // return the error\n                Failure e \n            | Success (s2,execList2) -&gt;\n                // concatenate the exec lists\n                Success (s2, execList1 @ execList2)\n\n    let execute x =\n        match x with\n        | Failure e -&gt; \n            Failure e \n        | Success (s,execList) -&gt;\n            execList |&gt; List.iter (fun exec -&gt; exec())\n            Success (s,[])\n\n/// Example\nmodule LaunchWithExec =\n\n    open RopWithExec\n\n    let exec_refuel() =\n        printfn \"refuel\"\n\n    let refuel ok =\n        if ok then\n            printfn \"checking if refuelling can be done\"\n            Success (\"refuel\", [exec_refuel])\n        else \n            Failure \"refuel failed\"\n\n    let exec_enterLaunchCodes() =\n        printfn \"entering launch codes\"\n\n    let enterLaunchCodes ok refuelInfo =\n        if ok then\n            printfn \"checking if launch codes can be entered\"\n            Success (\"enterLaunchCodes\", [exec_enterLaunchCodes])\n        else \n            Failure \"enterLaunchCodes failed\"\n\n    let exec_fireMissile() =\n        printfn \"firing missile\"\n\n    let fireMissile ok launchCodesInfo =\n        if ok then\n            printfn \"checking if missile can be fired\"\n            Success (\"fireMissile \", [exec_fireMissile])\n        else \n            Failure \"fireMissile failed\"\n\n    // test with failure at refuel\n    refuel false\n    |&gt; bind (enterLaunchCodes true)\n    |&gt; bind (fireMissile true)\n    |&gt; execute\n    (*\n    val it : Result&lt;string&gt; = Failure \"refuel failed\"\n    *)\n\n    // test with failure at enterLaunchCodes\n    refuel true\n    |&gt; bind (enterLaunchCodes false)\n    |&gt; bind (fireMissile true)\n    |&gt; execute\n    (*\n    checking if refuelling can be done\n    val it : Result&lt;string&gt; = Failure \"enterLaunchCodes failed\"\n    *)\n\n    // test with failure at fireMissile\n    refuel true\n    |&gt; bind (enterLaunchCodes true)\n    |&gt; bind (fireMissile false)\n    |&gt; execute\n    (*\n    checking if refuelling can be done\n    checking if launch codes can be entered\n    val it : Result&lt;string&gt; = Failure \"fireMissile failed\"\n    *)\n\n    // test with no failure \n    refuel true\n    |&gt; bind (enterLaunchCodes true)\n    |&gt; bind (fireMissile true)\n    |&gt; execute\n    (*\n    checking if refuelling can be done\n    checking if launch codes can be entered\n    checking if missile can be fired\n    refuel\n    entering launch codes\n    firing missile\n    val it : Result&lt;string&gt; = Success (\"fireMissile \",[])\n    *)\n</code></pre>\n\n<p>You get the idea, I hope. I'm sure there are other approaches as well -- these are two that are obvious and simple. :)</p>\n"}], "owner": {"reputation": 1562, "user_id": 69909, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/ad2c903e18745e5e61c8838bf79e200f?s=128&d=identicon&r=PG", "display_name": "Oenotria", "link": "https://stackoverflow.com/users/69909/oenotria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 5, "accepted_answer_id": 36536576, "answer_count": 1, "score": 20, "last_activity_date": 1460395594, "creation_date": 1460324582, "last_edit_date": 1460394987, "question_id": 36535869, "link": "https://stackoverflow.com/questions/36535869/how-to-deal-with-rollbacks-when-using-the-either-monad-railway-oriented-progra", "title": "How to deal with rollbacks when using the Either monad (&quot;railway-oriented programming&quot;)", "body": "<p>I am using F# and Chessie to compose a sequence of tasks (with side effects) that can succeed or fail.</p>\n\n<p>If anything fails, I want to stop executing the remaining tasks and rollback those that have already succeeded.</p>\n\n<p>Unfortunately once I hit the 'failure' path there is no longer a way to retrieve the results of the successful tasks so I can roll them back.</p>\n\n<p>Is there a functional programming \"pattern\" that deals with this scenario?</p>\n\n<p>Example:</p>\n\n<pre><code>let refuel =\n  async {\n    printfn \"1 executed\"\n    // Fill missile with fuel\n    return Result&lt;string,string&gt;.Succeed \"1\"\n  }  |&gt; AR\n\nlet enterLaunchCodes =\n  async {\n    printfn \"2 executed\"\n    // \n    return Result&lt;string,string&gt;.FailWith \"2\"\n  }  |&gt; AR\n\nlet fireMissile =\n  async {\n    printfn \"3 executed\"\n    return Result&lt;string,string&gt;.Succeed \"3\"\n  } |&gt; AR\n\nlet launchSequence =\n  asyncTrial {\n    let! a = refuel\n    let! b = enterLaunchCodes\n    let! c = fireMissile\n    return a,b,c\n  }\n\nlet result = launchSequence\n    |&gt; Chessie.ErrorHandling.AsyncExtensions.Async.ofAsyncResult\n    |&gt; Async.RunSynchronously\n\n// Result is a failure... how do I know the results of the successful operations here so I can roll them back?\n\nprintfn \"Result: %A\" result\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 1, "last_activity_date": 1460324771, "creation_date": 1460324771, "answer_id": 36535891, "question_id": 36535674, "link": "https://stackoverflow.com/questions/36535674/liftio-instead-of-composition-lift/36535891#36535891", "title": "liftIO instead of composition lift", "body": "<pre><code>class MonadTrans t where\n  lift :: Monad m =&gt; m a -&gt; t m a\n</code></pre>\n\n<p>If you want</p>\n\n<pre><code>foo :: Monad m =&gt; m a -&gt; ExceptT e (StateT s (ReaderT r m)) a\n</code></pre>\n\n<p>then you need to apply <code>lift</code> once for each of the type constructors. First we get</p>\n\n<pre><code>lift :: Monad m\n     =&gt; m a -&gt; ReaderT r m a\n</code></pre>\n\n<p>then</p>\n\n<pre><code>lift . lift :: Monad m\n   =&gt; m a -&gt; StateT s (ReaderT r m) a\n</code></pre>\n\n<p>then</p>\n\n<pre><code>foo = lift . lift . lift :: Monad m\n   =&gt; m a -&gt; ExceptT e (StateT s (ReaderT r m)) a\n</code></pre>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 36535891, "answer_count": 1, "score": 1, "last_activity_date": 1460324771, "creation_date": 1460323111, "question_id": 36535674, "link": "https://stackoverflow.com/questions/36535674/liftio-instead-of-composition-lift", "title": "liftIO instead of composition lift", "body": "<blockquote>\n  <p>Down in this document, we call liftIO in eval6 to perform I/O actions.\n  Why do we need to lift in this case? Because there is no IO class for\n  which we can instantiate a type as. Therefore, for I/O actions, we\n  have to call lift to send the commands inwards. For eval6 , we would\n  need to compose lift four times to print something. This is just\n  inconvenient, so people create a new class MonadIO such that we only\n  need to call liftIO once, without having to keep count of how many\n  times to compose lift:</p>\n</blockquote>\n\n<pre><code>class (Monad m) =&gt; MonadIO m where\nliftIO :: IO a -&gt; m a\ninstance MonadIO IO where\nliftIO = id\ninstance (Error e, MonadIO m) =&gt; MonadIO (ErrorT e m) where\nliftIO = lift . liftIO\ninstance (MonadIO m) =&gt; MonadIO (ReaderT r m) where\nliftIO = lift . liftIO\n</code></pre>\n\n<p>The citation comes from <a href=\"http://www.cs.virginia.edu/~wh5a/personal/Transformers.pdf\" rel=\"nofollow\">http://www.cs.virginia.edu/~wh5a/personal/Transformers.pdf</a></p>\n\n<p>And again, I cannot understand why withoud liftIO we would have to call liftIO four times. I cannot see it therefore please make clear it ;)</p>\n"}, {"tags": ["haskell", "data-representation"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460332855, "post_id": 36535198, "comment_id": 60678215, "body": "I would not use a list to represent this, it will be horrible inefficient. Furthermore, instead of manifesting the data in the different representations, you really should produce a lens - this would allow you to view and modify the matrix with the different views of your data without unnecessary conversion. e.g. <code>Access -&gt; Lens&#39; (Array (Int, Int) a) (Array Int a)</code> or <code>Access -&gt; Traversal&#39; (Array (Int, Int)  a) a</code>"}, {"owner": {"reputation": 1373, "user_id": 1122720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3917f1f4e64e60f28f301e8369a201d4?s=128&d=identicon&r=PG", "display_name": "sukhmel", "link": "https://stackoverflow.com/users/1122720/sukhmel"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460366128, "post_id": 36535198, "comment_id": 60689931, "body": "@user2407038 I thought that constructing a lens is only possible after I provide some kind of setter and getter, e.g using <code>index</code> function proposed by @AlexeyKuleshevich as getter, and corresponding setter. Is it possible to do it some other way?"}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 0, "last_activity_date": 1460343226, "creation_date": 1460343226, "answer_id": 36539082, "question_id": 36535198, "link": "https://stackoverflow.com/questions/36535198/haskell-create-different-representations-for-same-data/36539082#36539082", "title": "Haskell: create different representations for same data", "body": "<p>An inefficient implementation perhaps trigger better ideas</p>\n\n<pre><code>column,row :: Int -&gt; [((Int,Int),a)] -&gt; [a]\ncolumn n xs = map snd $ filter (\\((_,y),_) -&gt; y==n) xs \nrow n xs = map snd $ filter (\\((x,_),_) -&gt; x==n) xs   \n\ncell :: Int -&gt; Int -&gt; [((Int,Int),a)] -&gt; [a] \ncell n m xs = map snd $ filter (\\((x,y),_) -&gt; (div x 2 == n) &amp;&amp; (div y 2==m)) xs\n</code></pre>\n\n<p>here indexing the elements of 4x4 matrix</p>\n\n<pre><code>&gt; let a = zipWith (\\x y -&gt; ((div y 4,mod y 4),x)) [0..15] [0..]\n</code></pre>\n\n<p>cells are 2x2 blocks</p>\n\n<pre><code>&gt; cell 1 1 a \n[10,11,14,15]\n\n&gt; cell 0 0 a                                                   \n[0,1,4,5]\n\n&gt; column 2 a                \n[2,6,10,14]\n\n&gt; row 1 a \n[4,5,6,7]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": true, "score": 3, "last_activity_date": 1460354995, "last_edit_date": 1495540243, "creation_date": 1460354995, "answer_id": 36541019, "question_id": 36535198, "link": "https://stackoverflow.com/questions/36535198/haskell-create-different-representations-for-same-data/36541019#36541019", "title": "Haskell: create different representations for same data", "body": "<p>First of all, as <a href=\"https://stackoverflow.com/users/2407038/user2407038\">user2407038</a> has mentioned in the comments, <code>List</code> is not a very efficient data structure, especially for what you are trying to do. So I will provide an implementation using a boxed <code>Vector</code> from <a href=\"http://hackage.haskell.org/package/vector\" rel=\"nofollow noreferrer\">vector</a> package, which obviously has an advantage of a constant time lookup.</p>\n\n<p>Secondly, you cannot think while programming in a functional language the same way you would in imperative language. In Haskell you should choose a data structure that is most efficient in how you will handle the data, and the actual representation delegate to functions that operate on that data. What I mean is (because there is no mutation, unless you really really need it) you cannot set a value and expect it to change in all representations of the data, but rather should have data stored in a single data structure and all of the functions that operate on that data, take in account it's representation.</p>\n\n<p>In implementation below it always stores data as a flat <code>Vector</code> and lets all the functions that operate on <code>MyGrid</code> take in account it's current representation <code>Access</code>. You probably would rather pass <code>Access</code> around to functions, instead of making it part of <code>MyGrid</code> data type, but I made that choice just for simplicity.</p>\n\n<pre><code>import qualified Data.Vector as V\n\ndata Access = Rows | Columns | Cells\n\ndata MyGrid a = MyGrid { side :: Int -- square grid with each side = N\n                       , view :: Access \n                       , vect :: V.Vector a }\n</code></pre>\n\n<p>This approach allows you to create proper constructors, that do all the sanity checks, for instance:</p>\n\n<pre><code>-- | Constructs a grid from a list, while making sure no elements are lost.\nfromList :: [a] -&gt; Access -&gt; MyGrid a\nfromList ls a = MyGrid { side = if side'*side' == length ls\n                                then if even side'\n                                     then side'\n                                     else error \"grid cannot be split in the middle\"\n                                else error \"list cannot be represented as a square grid\"\n                       , view = a\n                       , vect = V.fromList ls } where\n  side' = floor . sqrt . fromIntegral . length $ ls\n</code></pre>\n\n<p>another constructor could possibly be the one that uses a function to generate elements by using indexes of the grid and current representation:</p>\n\n<pre><code>fromFunction :: Int -&gt; Access -&gt; ((Int, Int) -&gt; a) -&gt; MyGrid a\n</code></pre>\n\n<p>Now, here is the most important part that takes care of the representation, which is retrieving an element from the grid:</p>\n\n<pre><code>index :: MyGrid a -&gt; (Int, Int) -&gt; a\nindex grid (i, j) =\n  case view grid of\n    Rows    -&gt; vect grid V.! (i * side grid + j)\n    Columns -&gt; vect grid V.! (j * side grid + i)\n    Cells   -&gt; vect grid V.! if even i then k else k - d where\n      n = side grid\n      d = n `div` 2\n      k = (i + j `div` d) * n + j `mod` d\n</code></pre>\n\n<p>And now you can use that function to deal with representation of your data, for instance converting it to a list of lists, describe how it is printed, or mapped over, etc.:</p>\n\n<pre><code>toLists :: MyGrid a -&gt; [[a]]\ntoLists grid = map (map (index grid)) [[(j, i) | i &lt;- [0..n]] | j &lt;- [0..n]]\n  where n = side grid - 1\n\ninstance Show a =&gt; Show (MyGrid a) where\n  show grid = unlines . map show $ toLists grid\n\ninstance Functor MyGrid where\n  fmap f grid = grid { vect = V.map f $ vect grid}\n</code></pre>\n\n<p>Which now allows you to deal with <code>MyGrid</code>'s current representation (through using <code>show</code>, <code>fmap</code>, etc.):</p>\n\n<pre><code>\u03bb&gt; fromList [0..15] Rows\n[0,1,2,3]\n[4,5,6,7]\n[8,9,10,11]\n[12,13,14,15]\n\n\u03bb&gt; succ &lt;$&gt; fromList [0..15] Columns\n[1,5,9,13]\n[2,6,10,14]\n[3,7,11,15]\n[4,8,12,16]\n\n\u03bb&gt; fromList [0..15] Cells\n[0,1,4,5]\n[2,3,6,7]\n[8,9,12,13]\n[10,11,14,15]\n</code></pre>\n\n<p>Here is the assumption I made about how to split the cells for a grid with side bigger than <code>4</code>. Maybe the grid should have a side with powers of <code>2</code>, maybe cells should be <code>2</code> by <code>2</code>, I couldn't infer. Just adjust the math to what you need, but I chose to split larger grids for <code>Cells</code> in this way:</p>\n\n<pre><code>0  1  2  | 3  4  5 \n6  7  8  | 9  10 11\n---------+---------\n12 13 14 | 15 16 17\n18 19 20 | 21 22 23\n---------+---------\n24 25 26 | 27 28 29\n30 31 32 | 33 34 35\n</code></pre>\n\n<p>If you need further help with proper cell splitting, edit the question with some examples how it should be done and I'll adjust the implementation.</p>\n"}, {"tags": [], "owner": {"reputation": 1373, "user_id": 1122720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3917f1f4e64e60f28f301e8369a201d4?s=128&d=identicon&r=PG", "display_name": "sukhmel", "link": "https://stackoverflow.com/users/1122720/sukhmel"}, "is_accepted": false, "score": 1, "last_activity_date": 1460669401, "last_edit_date": 1495540243, "creation_date": 1460669401, "answer_id": 36634357, "question_id": 36535198, "link": "https://stackoverflow.com/questions/36535198/haskell-create-different-representations-for-same-data/36634357#36634357", "title": "Haskell: create different representations for same data", "body": "<p>For posterity and future reference, I will post an implementation based on ideas collected. Whole answer is a <a href=\"https://wiki.haskell.org/Literate_programming\" rel=\"nofollow noreferrer\">literate Haskell</a> program, and can be saved as <code>*.lhs</code> and be run (although due to formatting, it will need additional lines to separate code and text).</p>\n\n<pre><code>&gt; {-# LANGUAGE TemplateHaskell, FlexibleContexts #-}\n\n&gt; import Control.Lens (makeLenses, lens, (^.), ix, (.~), (.=), (^?), (%~))\n\n&gt; import qualified Data.Vector as V\n&gt; import Data.Vector.Lens (sliced)\n\n&gt; import Data.Maybe (fromJust)\n&gt; import Data.Function ((&amp;))\n&gt; import Data.List (sortBy)\n</code></pre>\n\n<p>Data representation accessor:</p>\n\n<ul>\n<li>Cells are non-overlapping squares such that the number of elements\nin each is equal to grid side;</li>\n<li>Rows are just data split into chunks of grid-side length;</li>\n<li>Columns are rows transposed.</li>\n</ul>\n\n<p><code>&gt; data Access = Rows | Columns | Cells</code></p>\n\n<p>Data structure itself, an sample representation would be</p>\n\n<pre><code> 1  2  3 |  4  5  6 |  7  8  9\n10 11 12 | 13 14 15 | 16 17 18\n19 20 21 | 22 23 24 | 25 26 27\n---------+----------+---------\n28 29 30 | 31 32 33 | 34 35 36\n37 38 39 | 40 41 42 | 43 44 45\n46 47 48 | 49 50 51 | 52 53 54\n---------+----------+---------\n55 56 57 | 58 59 60 | 61 62 63\n64 65 66 | 67 68 69 | 70 71 72\n73 74 75 | 76 77 78 | 79 80 81\n</code></pre>\n\n<p>Where a single cell is, e.g.</p>\n\n<pre><code> 1  2  3\n10 11 12\n19 20 21\n</code></pre>\n\n<p>A cell always holds same amount of elements as a row or column.</p>\n\n<pre><code>&gt; data MyGrid a = MyGrid { _cell :: Int -- size of cell in grid, whole grid \n&gt;                                       -- is a square of width `cell^2`\n&gt;                        , _vect :: V.Vector a -- internal data storage\n&gt;                        }\n&gt; makeLenses ''MyGrid \n</code></pre>\n\n<p>Convert 2D index of given representation and cell size to internal</p>\n\n<pre><code>&gt; reduce_index_dimension :: Access -&gt; Int -&gt; (Int, Int) -&gt; Int\n&gt; reduce_index_dimension a s (x,y) = \n&gt;   case a of\n&gt;     Cells   -&gt; (y`rem`s)\n&gt;              + (x`rem`s) * s\n&gt;              + (y`quot`s) * s^2\n&gt;              + (x`quot`s) * s^3\n&gt;     Rows    -&gt; x * s * s + y\n&gt;     Columns -&gt; y * s * s + x\n</code></pre>\n\n<p>Convert internal index for given representation and cell size to 2D</p>\n\n<pre><code>&gt; increase_index_dimension :: Access -&gt; Int -&gt; Int -&gt; (Int, Int)\n&gt; increase_index_dimension a s i = \n&gt;   case a of\n&gt;     Cells   -&gt; ( s *   i `quot` s^3\n&gt;                +      (i  `rem` s^2) `quot` s\n&gt;                , s * ((i `quot` s^2)  `rem` s)\n&gt;                +       i  `rem` s  )\n&gt;     Rows    -&gt; ( i  `rem` s^2\n&gt;                , i `quot` s^2)\n&gt;     Columns -&gt; ( i `quot` s^2\n&gt;                , i  `rem` s^2)\n</code></pre>\n\n<p>Constructs a grid from a list, while making sure no elements are lost.</p>\n\n<pre><code>&gt; fromList :: [a] -&gt; MyGrid a\n&gt; fromList ls = MyGrid { _cell = if side'^2 == length ls\n&gt;                                then if cell'^2 == side'\n&gt;                                     then cell'\n&gt;                                     else error \"can't represent cell as a square\"\n&gt;                                else error \"can't represent list as a square\"\n&gt;                      , _vect = V.fromList ls } where\n&gt;   side' = floor . sqrt . fromIntegral . length $ ls  -- grid width\n&gt;   cell' = floor . sqrt . fromIntegral $ side'        -- cell width\n</code></pre>\n\n<p>Convert given representation to internal</p>\n\n<pre><code>&gt; convert :: Access -&gt; [[a]] -&gt; [a]\n&gt; convert from list = map snd\n&gt;                   . sortBy compare_index\n&gt;                   . map reduce_index \n&gt;                   . concatMap prepend_index \n&gt;                   . zip [0..] $ list\n&gt;   where\n&gt;     size                        = floor . sqrt . fromIntegral . length $ list\n&gt;     prepend_index (a, xs)       = zipWith (\\b c -&gt; ((a, b), c)) [0..] xs\n&gt;     reduce_index  (i, x)        = (reduce_index_dimension from size i, x)\n&gt;     compare_index (i, _) (j, _) = compare i j\n</code></pre>\n\n<p>Constructs a grid from another grid, taking representation into account</p>\n\n<pre><code>&gt; fromListsAs :: Access -&gt; [[a]] -&gt; MyGrid a\n&gt; fromListsAs a l = MyGrid { _cell = if allEqualLength l\n&gt;                                    then if cell'^2 == side'\n&gt;                                         then cell'\n&gt;                                         else error \"can't represent cell as a square\"\n&gt;                                    else error \"lists have different length or do not fit\"\n&gt;                          , _vect = V.fromList . convert a $ l } where\n&gt;   side' = length l\n&gt;   cell' = floor . sqrt . fromIntegral $ side'        -- cell width\n&gt;   allEqualLength xs = and $ map ((== side') . length) (tail xs)\n</code></pre>\n\n<p>combining lenses over same object, see <a href=\"https://stackoverflow.com/questions/36569994\">Haskell use first level lenses to create complex lens</a></p>\n\n<pre><code>&gt; (x ^&gt;&gt;= f) btofb s = f (s ^. x) btofb s\n</code></pre>\n\n<p>lens to focus at element poited to in given representation with given 2d index</p>\n\n<pre><code>&gt; lens_as a i = cell ^&gt;&gt;= \\s -&gt; vect . sliced (reduce_index_dimension a s i) 1 . ix 0\n</code></pre>\n\n<p>convert to 2d representation</p>\n\n<pre><code>&gt; toListsAs :: MyGrid a -&gt; Access -&gt; [[a]]\n&gt; toListsAs g a = [[fromJust $ g^?(lens_as a (x, y)) | y &lt;- [0..n]] | x &lt;- [0..n]]\n&gt;   where n = (g^.cell)^2 - 1\n</code></pre>\n\n<p>defaults</p>\n\n<pre><code>&gt; toLists :: MyGrid a -&gt; [[a]]\n&gt; toLists g = g `toListsAs` Rows\n\n&gt; instance Show a =&gt; Show (MyGrid a) where\n&gt;   show grid = unlines . map show . toLists $ grid\n\n&gt; instance Functor MyGrid where\n&gt;   fmap f grid = grid &amp; vect %~ V.map f\n</code></pre>\n\n<p>sanity check</p>\n\n<pre><code>&gt; main = mapM_ (putStrLn . show) (fromList [0..(+80)0] `toListsAs` Cells)\n</code></pre>\n"}], "owner": {"reputation": 1373, "user_id": 1122720, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/3917f1f4e64e60f28f301e8369a201d4?s=128&d=identicon&r=PG", "display_name": "sukhmel", "link": "https://stackoverflow.com/users/1122720/sukhmel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 36541019, "answer_count": 3, "score": 3, "last_activity_date": 1460669401, "creation_date": 1460320186, "last_edit_date": 1495541761, "question_id": 36535198, "link": "https://stackoverflow.com/questions/36535198/haskell-create-different-representations-for-same-data", "title": "Haskell: create different representations for same data", "body": "<p>Suppose I have some data that is organized in a grid like this (dimensions may vary, but side of a grid is always <code>n**2</code>):</p>\n\n<pre><code>0 1 2 3\n4 5 6 7\n8 9 A B\nC D E F \n</code></pre>\n\n<p>What I would like to achieve is to have a list with the same data represented in different ways, i.e. split into column, rows, or (most importantly) cells which is</p>\n\n<pre><code>0 1 | 2 3\n4 5 | 6 7\n----+----\n8 9 | A B\nC D | E F\n</code></pre>\n\n<p>So that if I do some action I will be able to get data as a following list:</p>\n\n<pre><code>[[0, 1, 4, 5],\n [2, 3, 6, 7],\n [8, 9, C, D],\n [A, B, E, F]]\n</code></pre>\n\n<p>Where ordering does not matter.</p>\n\n<p>I would like to use this to later construct a lens, that will be able to set values considering different kinds of representations. This is something that could have been acheived with use of pointers or references in imperative languages (where applicable).</p>\n\n<p>Besides specifics, I would like to know if there is a general approach to having same internal data represented differently.</p>\n\n<p>Here's what I got so far, using <code>[Int]</code> as internal representation, and conversion function to get specific \"views\":</p>\n\n<pre><code>import Data.List (transpose)\n\ndata Access = Rows | Columns | Cells\n\nisqrt :: Int -&gt; Int\nisqrt = floor . sqrt . fromIntegral\n\ngroup :: Int -&gt; [a] -&gt; [[a]]\ngroup _ [] = []\ngroup n l\n  | n &gt; 0 = (take n l) : (group n (drop n l))\n  | otherwise = error \"inappropriate n\"\n\nrepresentAs :: [Int] -&gt; Access -&gt; [[Int]]\nrepresentAs list    Rows = group (isqrt . length $ list) list\nrepresentAs list Columns = transpose $ list `representAs` Rows\nrepresentAs list   Cells = let row_width  = isqrt . length $ list\n                               cell_width = isqrt row_width\n                               drops = map (\\x -&gt; cell_width \n                                                  * row_width\n                                                  * (x `quot` cell_width)\n                                                + cell_width \n                                                  * (x `rem` cell_width)\n                                           ) [0..row_width-1]\n                           in  (map ( (map snd)\n                                    . (filter ( (==0)\n                                              . (`quot` cell_width)\n                                              . (`rem` row_width)\n                                              . fst)\n                                      )\n                                    . (zip [0..])\n                                    . (take (row_width * cell_width))\n                                    . (`drop` list)\n                                    ) drops\n                               )\n\nmain = mapM_ (putStrLn . show) ([1..16] `representAs` Cells)\n</code></pre>\n\n<p>My question is based on the same idea as <a href=\"https://stackoverflow.com/questions/16575361/multiple-lookup-structures-for-same-data-memory-duplication\">this one</a>, but the answer there regards only memory issues, rather than construction. Besides, if I am to store same data differently in a few representations, I will have to update all of them up setting new value, as far as I understand.</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "edited": false, "score": 0, "creation_date": 1460322378, "post_id": 36535378, "comment_id": 60674724, "body": "Thank you very much! It took me a while to understand but I think I get it. Instead of trying to add something at the end of each string I should instead try to replicate the creation of said string from the first to the last element (which is always &quot;&quot;), right?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "edited": false, "score": 0, "creation_date": 1460334158, "post_id": 36535378, "comment_id": 60678464, "body": "Yes, that&#39;s the gist."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 4, "last_activity_date": 1460321207, "creation_date": 1460321207, "answer_id": 36535378, "question_id": 36535171, "link": "https://stackoverflow.com/questions/36535171/how-can-i-create-an-alternating-infinite-stream/36535378#36535378", "title": "How can I create an alternating infinite stream?", "body": "<p>Well <code>iterate</code> has some useful concepts but in and of itself isn't going to take you to a solution.  What you should probably do is recognize your pattern and build from there.</p>\n\n<pre><code>\"\" , a: \"\", b : \"\", c : \"\", a: a:\"\", b : a : \"\", c : a : \"\", a : b : \"\"\n</code></pre>\n\n<p>So clearly we have a base case of <code>\"\"</code> and three modifier functions of <code>'a':</code>, <code>'b':</code> and <code>'c':</code>.   Let's write that down!</p>\n\n<pre><code>mods :: [String -&gt; String]\nmods = [ (x:) | x &lt;- \"abc\" ]\n\nstrings :: [String]\nstrings = baseCase : stringsRecursiveCase\n where baseCase = \"\"\n</code></pre>\n\n<p>What is the recursive case?  Well you took the most recent string and applied each of the modifier functions one at a time:</p>\n\n<pre><code>stringsRecursiveCase = [ f s | s &lt;- strings , f &lt;- mods ]\n</code></pre>\n\n<p>Now we can test to observe and verify the functionallity:</p>\n\n<pre><code>take 15 strings\n[\"\",\"a\",\"b\",\"c\",\"aa\",\"ba\",\"ca\",\"ab\",\"bb\",\"cb\",\"ac\",\"bc\",\"cc\",\"aaa\",\"baa\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 2, "last_activity_date": 1460321280, "creation_date": 1460321280, "answer_id": 36535389, "question_id": 36535171, "link": "https://stackoverflow.com/questions/36535171/how-can-i-create-an-alternating-infinite-stream/36535389#36535389", "title": "How can I create an alternating infinite stream?", "body": "<p>Let's say we have already a list of strings like <code>[\"\", \"a\", \"b\", \"c\"]</code>. How can we produce the next elements from that string? Well, we can take every element and add <code>'a'</code>, <code>'b'</code> and <code>'c'</code> in front of it:</p>\n\n<pre><code>Prelude&gt; concatMap (\\xs -&gt; ['a' : xs, 'b' : xs, 'c' : xs]) [\"\", \"a\", \"b\", \"c\"]\n[\"a\",\"b\",\"c\",\"aa\",\"ba\",\"ca\",\"ab\",\"bb\",\"cb\",\"ac\",\"bc\",\"cc\"]\n</code></pre>\n\n<p>Seems good so far. Let's give that a name:</p>\n\n<pre><code>step :: [String] -&gt; [String]\nstep = concatMap (\\xs -&gt; ['a' : xs, 'b' : xs, 'c' : xs])\n</code></pre>\n\n<p>We can now define our infinite stream recursively with a base value and <code>step</code>:</p>\n\n<pre><code>stream :: [String]\nstream = \"\" : step stream\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1460344497, "creation_date": 1460344497, "answer_id": 36539252, "question_id": 36535171, "link": "https://stackoverflow.com/questions/36535171/how-can-i-create-an-alternating-infinite-stream/36539252#36539252", "title": "How can I create an alternating infinite stream?", "body": "<p>Here's a solution that does use <code>iterate</code>.</p>\n\n<pre><code>import Control.Applicative\ngen = [(++ \"a\"), (++ \"b\"), (++ \"c\")]\nexpand v = concatMap (&lt;$&gt; v) gen\nv = concat $ iterate expand [\"\"]\n</code></pre>\n\n<p>The tricky part is <code>expand</code>. It's a condensed version of the slightly more readable function</p>\n\n<pre><code>expand v = concat [ fmap f v | f &lt;- gen ]\n</code></pre>\n\n<p>which appends each letter of your generator to each string in a list. Looking at the first few iterations,</p>\n\n<pre><code>expand [\"\"] = [\"a\", \"b\", \"c\"]\nexpand [\"a\", \"b\", \"c\"] = [\"aa\", \"ba\", \"ca\", \"ab\", \"bb\", \"cb\", \"ac\", \"bc\", \"cc\"]\n</code></pre>\n\n<p>The <code>iterate</code> command ties it together by producing the infinite list of lists <code>[ [\"\"], expand [\"\"], expand . expand $ [\"\"], ...]</code>.</p>\n"}], "owner": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 1, "accepted_answer_id": 36535378, "answer_count": 3, "score": 1, "last_activity_date": 1460344497, "creation_date": 1460320038, "question_id": 36535171, "link": "https://stackoverflow.com/questions/36535171/how-can-i-create-an-alternating-infinite-stream", "title": "How can I create an alternating infinite stream?", "body": "<p>I want to create an infinite stream of chars like so:</p>\n\n<p>I start with \"\" and some chars, let's say \"abc\".</p>\n\n<p>How exactly do I end up with the infinite stream that looks like this:</p>\n\n<pre><code>[\"\", \"a\", \"b\", \"c\", \"aa\", \"ba\", \"ca\", \"ab\", ..]\n</code></pre>\n\n<p>The basic logic would be to take last elements of highest length and add each of the chars from my initial list \"abc\" to them and repeat. However, I'm not sure if this is the right way to do things in Haskell (seems more like a procedural solution of the problem).</p>\n\n<p>My first attempt was to create the stream given only one element so I made a stream of a's:</p>\n\n<pre><code>let as = iterate ((++) \"a\") \"\"\n</code></pre>\n\n<p>This works, but I am not sure how this could evolve so that I can get the first stream.</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1460358343, "post_id": 36534108, "comment_id": 60685407, "body": "Do you use <code>--solver</code>? IIRC <code>stack init</code> only tries snapshots in some order without it, so it should finish quite fast if there is snapshot with all needed dependencies"}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "reply_to_user": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "edited": false, "score": 0, "creation_date": 1460379190, "post_id": 36534108, "comment_id": 60699140, "body": "<code>--solver</code>: yes, see edit above."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1461446898, "post_id": 36534108, "comment_id": 61205721, "body": "There really isn&#39;t much value in keeping upper bounds on your dependencies when you&#39;re using stack unless there&#39;s a specific compatibility problem that you need to handle. For publishing your package you can always use <code>stack sdist --pvp-bounds upper</code> and let stack add the upper bounds."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1461447004, "post_id": 36534108, "comment_id": 61205758, "body": "You might be interested in this blog post on the <code>pvp-bounds</code> feature: <a href=\"https://www.fpcomplete.com/blog/2015/09/stack-pvp\" rel=\"nofollow noreferrer\">fpcomplete.com/blog/2015/09/stack-pvp</a>"}], "owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460379167, "creation_date": 1460314506, "last_edit_date": 1460379167, "question_id": 36534108, "link": "https://stackoverflow.com/questions/36534108/haskell-stack-init-does-not-finish-how-to-ignore-all-bounds-in-existing-cabal", "title": "(haskell) stack init does not finish. how to ignore all bounds in existing cabal files?", "body": "<p>I am converting a project (consisting of several cabalized packages) to stack. \"stack init\" does not seem to be able to \"calculate a build plan\" (it takes ages). </p>\n\n<p>Perhaps this gets easier when all version bounds are ignored. But how can I do this - other than actually removing them from the cabal files manually? </p>\n\n<p>EDIT: there is \"allow-newer\" in <a href=\"http://docs.haskellstack.org/en/stable/yaml_configuration/\" rel=\"nofollow\">http://docs.haskellstack.org/en/stable/yaml_configuration/</a> but this only helps if the initial stack.yaml file is already there.</p>\n\n<p>Anyway, I could work around my particular problem by manually removing some packages (that is, subdirs) to be built.</p>\n\n<p>My actual comand line was</p>\n\n<pre><code>stack init --verbose --resolver=lts-5   $(cat DIRS) --solver\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1460314712, "post_id": 36533962, "comment_id": 60671936, "body": "From first your piece of code: <code>return (Right m) :: *m* (Either e (m a))</code> I cannot understand why it is m ( I highlighted it by <i>m</i> ) and not for example <code>ErrorT</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1460315497, "post_id": 36533962, "comment_id": 60672243, "body": "@Gilgamesz You are correct: that it is actually <code>n (Either e (m a))</code> for any monad <code>n</code>, which can be different from <code>m</code>. The final result would then be <code>ErrorT ... :: ErrorT e n (m a)</code>, but since <code>lift</code> must return <code>ErrorT e m a</code>, this forces <code>n = m</code> (and <code>m a = a</code>, which is impossible and triggers a type error). I applied <code>n = m</code> earlier, being a bit less general. (and by the same token, <code>Right a</code> should be <code>Either z a</code> for all <code>z</code> including those different from <code>e</code> ... but eventually <code>z</code> must be <code>e</code> anyway)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1460314124, "last_edit_date": 1460314124, "creation_date": 1460313806, "answer_id": 36533962, "question_id": 36533857, "link": "https://stackoverflow.com/questions/36533857/unnecessary-assignment-in-do-sequence/36533962#36533962", "title": "Unnecessary assignment in do sequence", "body": "<pre><code>m :: m a\nRight m :: Either e (m a)\nreturn (Right m) :: m (Either e (m a))\nErrorT $ return (Right m) :: ErrorT e m (m a)\n</code></pre>\n\n<p>This has the wrong type: we wanted <code>ErrorT e m a</code>.</p>\n\n<p>Instead, when using <code>a &lt;- m</code>, we have:</p>\n\n<pre><code>a :: a\nRight a :: Either e a\nreturn (Right a) :: m (Either e a)\nErrorT $ return (Right a) :: ErrorT e m a\n</code></pre>\n\n<p>which is OK.</p>\n\n<p>(Above some value variables have the same name of type variables on the right of <code>::</code> -- this is just an incident.)</p>\n\n<p>Alternatives:</p>\n\n<pre><code>instance (Error e) =&gt; MonadTrans (ErrorT e) where\n  lift m = ErrorT $ fmap Right m\n</code></pre>\n\n<p>or with applicative notation,</p>\n\n<pre><code>instance (Error e) =&gt; MonadTrans (ErrorT e) where\n  lift m = ErrorT $ Right &lt;$&gt; m\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 4, "last_activity_date": 1460315821, "creation_date": 1460315821, "answer_id": 36534367, "question_id": 36533857, "link": "https://stackoverflow.com/questions/36533857/unnecessary-assignment-in-do-sequence/36534367#36534367", "title": "Unnecessary assignment in do sequence", "body": "<p>You're reading <code>a &lt;- m</code> as \"assign <code>a</code> the value <code>m</code>.\" That notation for assignment is common in pseudocode, but it means something different in Haskell. You can read it as \"Produce a value from <code>m</code> and bind that value to <code>a</code>.\" To be more precise, in a <code>do</code> block,</p>\n\n<pre><code>a &lt;- m\n...\n...\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>m &gt;&gt;= \\a -&gt;\n  do\n    ...\n    ...\n</code></pre>\n\n<p>So applying <code>Right</code> to <code>a</code> is sensible, but applying it to <code>m</code> gives you a monadic action wrapped in <code>Either</code>, which isn't usually what you're after.</p>\n\n<p>There <em>is</em>, however, a shorter way to write that instance:</p>\n\n<pre><code>instance Error e =&gt; MonadTrans (ErrorT e) where\n  lift m = ErrorT (Right &lt;$&gt; m)\n</code></pre>\n\n<p>Nota Bene: <code>ErrorT</code> has generally been supplanted by the more generally-useful <code>ExceptT</code>, which doesn't have the annoying and often-irrelevant <code>Error</code> context. In particular, it's very often useful to have an \"exception\" value that doesn't actually represent an error and isn't an instance of <code>Show</code>.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 36533962, "answer_count": 2, "score": 2, "last_activity_date": 1460315821, "creation_date": 1460313265, "last_edit_date": 1460313596, "question_id": 36533857, "link": "https://stackoverflow.com/questions/36533857/unnecessary-assignment-in-do-sequence", "title": "Unnecessary assignment in do sequence", "body": "<p>Let's look at:</p>\n\n<pre><code>instance (Error e) =&gt; MonadTrans (ErrorT e) where\n  lift m = ErrorT $ do\n    a &lt;- m\n    return (Right a)\n</code></pre>\n\n<p>I cannot understand why is necessary <code>a &lt;- m</code>. Why we don't write just:</p>\n\n<pre><code>instance (Error e) =&gt; MonadTrans (ErrorT e) where\n  lift m = ErrorT $ do\n    return (Right m)\n</code></pre>\n"}, {"tags": ["haskell", "build", "atom-editor", "cabal"], "comments": [{"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1460314087, "post_id": 36533636, "comment_id": 60671688, "body": "I get &quot;cabal: unrecognized option `--only&#39;&quot;, in atom"}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1460314673, "post_id": 36533636, "comment_id": 60671916, "body": "what is the command line (that atom uses to call cabal) exactly? I&#39;d say it&#39;s looking like a version mismatch, your setup (ghc-7.6) looks quite old and likely is not supported by atom&#39;s haskell mode."}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1460316454, "post_id": 36533636, "comment_id": 60672594, "body": "I have no idea. It should be in the docs, or the source. I&#39;d say that the minimal requirements for running atom/haskell are somewhat under-documented at <a href=\"https://github.com/atom-haskell/ide-haskell#requirements\" rel=\"nofollow noreferrer\">github.com/atom-haskell/ide-haskell#requirements</a> . But did you follow these steps? If yes, and it still does not work, then file a bug there."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1460318111, "post_id": 36533636, "comment_id": 60673233, "body": "Yes, I saw it before. I recognize I don&#39;t have a minimal toolchain installed : it&#39;s a complete install of ghc + cabal + other common libraries. I thought that if there were more libraries installed, it wouldn&#39;t be annoying. Do you think that was a mistake?"}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1460318304, "post_id": 36533636, "comment_id": 60673302, "body": "Try (in a shell)  &#39;stack install stylish-haskell&#39; etc (or &#39;cabal install ...&#39;) as mentioned on web site."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "reply_to_user": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1460318512, "post_id": 36533636, "comment_id": 60673389, "body": "Well, I&#39;m tired, I will do it tomorrow. Good night!"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1484838717, "creation_date": 1460312216, "last_edit_date": 1484838717, "question_id": 36533636, "link": "https://stackoverflow.com/questions/36533636/haskell-atom-cabal-build-fails-on-unrecognized-option-only", "title": "Haskell &amp; atom : cabal build fails on &quot;unrecognized option `--only&#39;&quot;", "body": "<p>I get this error while trying to build a project using cabal, on centOS 7.\nghc version is 7.6.3, cabals one is 1.16.1.0 for cabal-install, and 1.16.0 for the cabal library.</p>\n\n<p>the cabal file follows:</p>\n\n<pre><code>-- Initial premier_programme.cabal generated by cabal init.  For further\n-- documentation, see http://haskell.org/cabal/users-guide/\n\nname:                premierProgramme\nversion:             1.0\nsynopsis:            exemple de test\n-- description:\n-- license:\nlicense-file:        LICENSE\nauthor:              Olivier\nmaintainer:          abc@laposte.net\n-- copyright:\ncategory:            Development\nbuild-type:          Simple\ncabal-version:       &gt;=1.8\n\nexecutable premierProgramme\n  main-is: lanceur.hs\n  -- other-modules:\n  build-depends:       base ==4.6.*\n</code></pre>\n\n<p>and the haskell file is:</p>\n\n<pre><code>module Main where\n\nfibo :: Integer -&gt; Integer\nfibo 0  = 1\nfibo 1 = 1\nfibo n = fibo (n-1) + fibo (n-2)\n\n-- | This is the documentation for 'square', which\n--   uses the (*) operator from \"Prelude\".\n--   It multiplies the @x@ argument against itself.\nsquare :: Integer -&gt; Integer\nsquare x = x*x\n\nmain :: IO ()\nmain = do\n  putStrLn \"Hello World\"\n  print $ fibo 10\n  print $ square 17\n</code></pre>\n\n<p>thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1460311971, "post_id": 36532962, "comment_id": 60670835, "body": "As an exercise, try writing the instance yourself, from scratch, using GHC&#39;s typed holes."}], "answers": [{"comments": [{"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1460315923, "post_id": 36533687, "comment_id": 60672379, "body": "&quot;the latter can be converted into the former by the constructor ErrorT&quot; What do you mean by that? ( especially by &#39;former&#39;)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 1, "creation_date": 1460316428, "post_id": 36533687, "comment_id": 60672581, "body": "@Gilgamesz It means values of type <code>m (Either e a)</code> can be converted to values of type <code>ErrorT e m a</code> using the constructor <code>ErrorT</code> whose type is precisely <code>m (Either e a) -&gt; ErorrT e m a</code>."}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1461057335, "post_id": 36533687, "comment_id": 61013766, "body": "Why     <code>a &lt;- runErrorT m</code>. Why there is parameter <code>m</code> for <code>runErrorT</code>? Though, <code>runErrorT</code> is argumentless"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 1, "creation_date": 1461058714, "post_id": 36533687, "comment_id": 61014762, "body": "@Gilgamesz No, <code>runErrorT</code> takes a wrapped value of type <code>ErrorT e m a</code> and unwraps it exposing the internal type <code>m (Either e a)</code>. Ask GHCi about its type."}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1461060445, "post_id": 36533687, "comment_id": 61015989, "body": "&quot; takes a wrapped value of type <code>ErrorT e m a</code>&quot;. I didn&#39;t know that. It was a problem. It takes that because of definition: <code>newtype ErrorT e m a = ErrorT { runErrorT :: m (Either e a) }</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 1, "creation_date": 1461061639, "post_id": 36533687, "comment_id": 61016779, "body": "@Gilgamesz Yes, precisely. When you use <code>newtype T = K { unK :: S }</code> you automatically get a wrapping constructor <code>K :: S -&gt; T</code> and an unwrapping destructor <code>unK :: T -&gt; S</code>. This kind of wrapping/unwrapping is very commonly used when newtypes are involved."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1460312486, "creation_date": 1460312486, "answer_id": 36533687, "question_id": 36532962, "link": "https://stackoverflow.com/questions/36532962/understanding-the-errort-monad-transformer/36533687#36533687", "title": "Understanding the ErrorT monad transformer", "body": "<p><code>ErrorT</code> is just a wrapper. That is, the type <code>ErrorT e m a</code> is isomorphic to the type <code>m (Either e a)</code>: the latter can be converted into the former by the constructor <code>ErrorT</code>, while its associated destructor <code>runErrorT</code> converts in the other direction.</p>\n\n<p>The definitions of <code>return</code> and <code>&gt;&gt;=</code> must wrap/unwrap values to respect the types. This wrapping/unwrapping has no concrete effect at run time, it is just there so that the program type checks and the compiler can choose the correct monad instance (<code>m</code> or <code>ErrorT e m</code>, depending on whether a value it's wrapped).</p>\n\n<p>Here</p>\n\n<pre><code>return a = ErrorT $ return (Right a)\n</code></pre>\n\n<p>the part <code>return (Right a)</code> has type <code>m (Either e a)</code>, but we want <code>ErrorT e m a</code> instead. Applying <code>ErrorT</code> fixes that.</p>\n\n<p>Similarly, in this code:</p>\n\n<pre><code>m &gt;&gt;= k = ErrorT $ do\n    a &lt;- runErrorT m\n    case a of\n        Left l -&gt; return (Left l)\n        Right r -&gt; runErrorT (k r)\n</code></pre>\n\n<p>we need to return <code>ErrorT m e b</code>. This is done by using <code>ErrorT</code> applied to some value of type <code>m (Either e b)</code>. The part <code>Left l</code> has type <code>Either e b</code>, so <code>return</code> adds the last <code>m</code> on top. Instead the part <code>k r</code> has type <code>ErrorT e m b</code>, so we need to unwrap it with <code>runErrorT</code> (so that the whole <code>do</code> can be rewrapped again).</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 36533687, "answer_count": 1, "score": 0, "last_activity_date": 1460312486, "creation_date": 1460308784, "last_edit_date": 1460309381, "question_id": 36532962, "link": "https://stackoverflow.com/questions/36532962/understanding-the-errort-monad-transformer", "title": "Understanding the ErrorT monad transformer", "body": "<pre><code>newtype ErrorT e m a = ErrorT { runErrorT :: m (Either e a) }\n\ninstance (Monad m, Error e) =&gt; Monad (ErrorT e m) where\n\n    return a = ErrorT $ return (Right a)\n\n    m &gt;&gt;= k = ErrorT $ do\n        a &lt;- runErrorT m\n        case a of\n            Left l -&gt; return (Left l)\n            Right r -&gt; runErrorT (k r)\n\n    fail msg = ErrorT $ return (Left (strMsg msg))\n</code></pre>\n\n<p>Let's consider above piece of code. It makes me trouble to understand it. How does it work in context of Monads/Transormer Monads? Especially, the problem is understanding why <code>return a = ErrorT $ return (Right a)</code> return <code>return (Right a)</code>. I don't understand why just it.</p>\n\n<p>The second issue. <code>m &gt;&gt;= k</code> is basically understood by me ( I hope so ;) )but why in <code>Right r -&gt; runErrorT (k r)</code> appeared runError? </p>\n"}, {"tags": ["haskell", "yesod", "hspec"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1460385139, "post_id": 36532779, "comment_id": 60703947, "body": "I think you just need to throw away the <code>TestApp App</code> argument via <code>it &quot;todo&quot; $ \\_ -&gt; pending</code> or <code>it &quot;todo&quot; $ const pending</code>"}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 1, "creation_date": 1460386966, "post_id": 36532779, "comment_id": 60705287, "body": "I can confirm @MichaelSnoyman&#39;s fix works"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1460392537, "post_id": 36532779, "comment_id": 60709119, "body": "Wow, it works indeed. I tried <code>liftIO</code> but without success. I&#39;m still surprised that <code>it &quot;&quot; pending</code>  works outside of <code>withApp</code> but doesn&#39;t inside, there is probably some type inference magic there. @MichaelSnoyman could you post is as an answer so I can accept it ? Wouldn&#39;t it be worth doing adding a <code>ypending</code> or equivalent ?"}], "answers": [{"comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1460442875, "post_id": 36564404, "comment_id": 60730340, "body": "I&#39;m happy to do a pull request for it. However should it be ypending like yit ? I still don&#39;t understand why normal pending dosenst work in a normal it block ( not a yit block)"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1460454765, "post_id": 36564404, "comment_id": 60738237, "body": "Because the type of <code>pending</code> is <code>Expectation</code>, which is <code>IO ()</code>, not allowing for the extra argument. I don&#39;t fully understand the type magic in hspec, but it is present."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1460491319, "post_id": 36564404, "comment_id": 60764843, "body": "I had a look and it&#39;s more tricky that I thought. doing <code>ypending = const pending</code> doesn&#39;t work in a <code>yit</code> context which anyway I&#39;m not using. I understand enough of <code>yit</code> to do anything at the moment.IThere are type families involved in Hspec, which explains the magic. It might possible to modify <code>withApp</code> from the scaffolding to accept pending without the const."}, {"owner": {"reputation": 3057, "user_id": 3884713, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/57f1298138a8935d5bf982478e47f23d?s=128&d=identicon&r=PG&f=1", "display_name": "Josh.F", "link": "https://stackoverflow.com/users/3884713/josh-f"}, "edited": false, "score": 0, "creation_date": 1485993779, "post_id": 36564404, "comment_id": 71161217, "body": "this is a more general issue than OPs that I fought with for a few hours, trying to get App-independent tests to work, and it&#39;d be useful for my fellow Yesod newbies to have access to this in testing-relevant documentation, if possible!"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 3, "last_activity_date": 1460439384, "creation_date": 1460439384, "answer_id": 36564404, "question_id": 36532779, "link": "https://stackoverflow.com/questions/36532779/how-to-do-pending-spec-inside-yesod-specs/36564404#36564404", "title": "How to do pending spec inside Yesod specs", "body": "<p>Copying my comment to an answer:</p>\n\n<p>I think you just need to throw away the <code>TestApp App</code> argument via:</p>\n\n<pre><code>it \"todo\" $ \\_ -&gt; pending\n</code></pre>\n\n<p>or</p>\n\n<pre><code>it \"todo\" $ const pending\n</code></pre>\n\n<blockquote>\n  <p>Wouldn't it be worth doing adding a <code>ypending</code> or equivalent?</p>\n</blockquote>\n\n<p>Sounds like a good idea to me, I've actually never personally used <code>pending</code> which is why I'd never thought of it. Would you be able to send a PR to get that included?</p>\n"}, {"tags": [], "owner": {"reputation": 4538, "user_id": 499478, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/791526e67831fbd70e3d179a6c585b44?s=128&d=identicon&r=PG", "display_name": "Wizek", "link": "https://stackoverflow.com/users/499478/wizek"}, "is_accepted": false, "score": 1, "last_activity_date": 1490315126, "creation_date": 1490315126, "answer_id": 42989326, "question_id": 36532779, "link": "https://stackoverflow.com/questions/36532779/how-to-do-pending-spec-inside-yesod-specs/42989326#42989326", "title": "How to do pending spec inside Yesod specs", "body": "<p>This works like a charm for me with latest Yesod:</p>\n\n<pre><code>it \"should x\" $ do\n  liftIO pending\n</code></pre>\n"}], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 1, "accepted_answer_id": 36564404, "answer_count": 2, "score": 3, "last_activity_date": 1490315126, "creation_date": 1460307829, "question_id": 36532779, "link": "https://stackoverflow.com/questions/36532779/how-to-do-pending-spec-inside-yesod-specs", "title": "How to do pending spec inside Yesod specs", "body": "<p>I'm new to Yesod and I'm trying to add a pending spec within a <code>withApp</code> block (at the moment I'm just trying to modify the spec generated by the Yesod scaffholding).</p>\n\n<p>the code looks like :</p>\n\n<p>appSpec :: Spec\n   appSpec :: withApp $ do\n     describe \"getMyHandlerR\" $ do\n       it \"todo\" $ do\n          pending</p>\n\n<p>But I got the following error message :</p>\n\n<pre><code>Couldn't match type \u2018(App, wai-3.2.0:Network.Wai.Middleware)\u2019\n               with \u2018()\u2019\nExpected type: SpecWith (TestApp App)\n  Actual type: SpecWith (Arg Expectation)\nIn a stmt of a 'do' block: it \"todo\" $ do { pending }\nIn the second argument of \u2018($)\u2019, namely\n  \u2018do { it \"todo\" $ do { pending } }\u2019\nIn a stmt of a 'do' block:\n  describe \"upload a file without error\"\n  $ do { it \"todo\" $ do { pending } }\n</code></pre>\n\n<p>If I remove the <code>withApp</code> everything works. I understand <code>withApp</code> is changing somehow the expected type but how come <code>describe</code> and <code>it</code> have the correct type whereas <code>pending</code> doesn't ?</p>\n"}, {"tags": ["scala", "haskell", "monads", "scala-breeze"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1460306742, "creation_date": 1460306742, "answer_id": 36532580, "question_id": 36532414, "link": "https://stackoverflow.com/questions/36532414/implementing-flatmap-on-aggregate-monad/36532580#36532580", "title": "Implementing flatMap on aggregate monad", "body": "<p>A possible implementation could be</p>\n\n<pre><code>def flatMap[U](f: T =&gt; Gen[U]): Gen[U] = \n  Gen (dist.flatMap {f(_).dist})\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 878, "user_id": 1366423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ab21a7fe07af4e3a153d65c420e87e85?s=128&d=identicon&r=PG", "display_name": "NietzscheanAI", "link": "https://stackoverflow.com/users/1366423/nietzscheanai"}, "edited": false, "score": 0, "creation_date": 1460319888, "post_id": 36534159, "comment_id": 60673880, "body": "Fortunately, independence is the desired property."}], "tags": [], "owner": {"reputation": 4259, "user_id": 1393162, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/Gd5bN.jpg?s=128&g=1", "display_name": "Ben Kovitz", "link": "https://stackoverflow.com/users/1393162/ben-kovitz"}, "is_accepted": false, "score": 1, "last_activity_date": 1460315927, "last_edit_date": 1495539906, "creation_date": 1460314732, "answer_id": 36534159, "question_id": 36532414, "link": "https://stackoverflow.com/questions/36532414/implementing-flatmap-on-aggregate-monad/36534159#36534159", "title": "Implementing flatMap on aggregate monad", "body": "<p>Are the intended semantics of <code>Gen</code> something like the following?</p>\n\n<pre><code>val UnfairCoin = Gen(Rand(Heads -&gt; 0.9, Tails -&gt; 0.1))\nval UnfairDieHi = Gen(Rand(1 -&gt; 0.0, 2 -&gt; 0.0, 3 -&gt; 0.0, 4 -&gt; 0.0, 5 -&gt; 0.5. 6 -&gt; 0.5))\nval UnfairDieLo = Gen(Rand(1 -&gt; 0.25, 2 -&gt; 0.25, 3 -&gt; 0.25, 4 -&gt; 0.25, 5 -&gt; 0.0, 6 -&gt; 0.0))\n\ndef headsHiTailsLo(coinFlip: CoinFlip) = coinFlip match {\n  case Heads =&gt; UnfairDieHi\n  case Tails =&gt; UnfairDieLo\n}\n\nval flipAndRoll = UnfairCoin flatMap { headsHighTailsLo _ }\n</code></pre>\n\n<p>where:</p>\n\n<pre><code>flipAndRoll == Gen(1 -&gt; 0.025, 2 -&gt; 0.025, 3 -&gt; 0.025, 4 -&gt; 0.025, 5 -&gt; 0.45, 5 -&gt; 0.45)\n</code></pre>\n\n<p>If that's right, then the output of <code>Gen.flatMap</code> will either need to generate two random samples, one from each distribution, or <code>Rand</code> must provide a way to calculate the joint distribution and project it to <code>U</code>.</p>\n\n<p>I took a quick look at the documentation for <a href=\"http://www.scalanlp.org/api/breeze/#breeze.stats.distributions.Rand\" rel=\"nofollow noreferrer\"><code>Rand.flatMap</code></a>, and it appears that it generates a <code>Rand</code> that does the two consecutive random samples, although it's not entirely clear. If that's right, then <a href=\"https://stackoverflow.com/a/36532580/1393162\">chi's answer</a> is your winner.</p>\n\n<p>If the two random variables are not independent, then you might have some work to do.</p>\n"}], "owner": {"reputation": 878, "user_id": 1366423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ab21a7fe07af4e3a153d65c420e87e85?s=128&d=identicon&r=PG", "display_name": "NietzscheanAI", "link": "https://stackoverflow.com/users/1366423/nietzscheanai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 36532580, "answer_count": 2, "score": 3, "last_activity_date": 1460315927, "creation_date": 1460305923, "question_id": 36532414, "link": "https://stackoverflow.com/questions/36532414/implementing-flatmap-on-aggregate-monad", "title": "Implementing flatMap on aggregate monad", "body": "<p>I'm looking to implement a version of Generator combinators (e.g. analogous to those in ScalaCheck or Haskell's QuickCheck), in which a Generator contains an instance of Rand, a monad representing a probability distribution (taken from the breeze library). Since it is a monad, Rand implements map and flatMap. As is common, I also want to implement Gen as a monad. As shown below, the implementation of map for Gen is straightforward:</p>\n\n<pre><code>// Rand is from the breeze library\ntrait Rand[T] {\n    def map[U](f: T =&gt; U): Rand[U]\n    def flatMap[U](f: T =&gt; Rand[U]): Rand[U]\n}\n\ncase class Gen[T](dist: Rand[T]) {\n  def map[U](f: T =&gt; U): Gen[U] = Gen(dist.map { f })\n\n  def flatMap[U](f: T =&gt; Gen[U]): Gen[U] = {\n    // How to implement this?\n  }\n}\n</code></pre>\n\n<p>However, it is not clear to me how flatMap should be implemented. Is this easily achieved, or does it (for example) require a level of indirection via some intermediate datatype?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1460303336, "post_id": 36531891, "comment_id": 60667587, "body": "This is project Eluler?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460303616, "post_id": 36531891, "comment_id": 60667697, "body": "there seems to be some <code>*</code> missing (for example here: <code>ai(r^^...)</code> ... you know mathematicians are so lazy the don&#39;t even write the <code>*</code> / <code>\\cdot</code> ;)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1460303684, "post_id": 36531891, "comment_id": 60667714, "body": "Multiplication needs to be explicit. <code>ai*(r^^ ...</code>"}, {"owner": {"reputation": 81, "user_id": 5055758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6aac0826e8af0fcfea76a2da9e72d974?s=128&d=identicon&r=PG&f=1", "display_name": "v.sharath chandra", "link": "https://stackoverflow.com/users/5055758/v-sharath-chandra"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1460314296, "post_id": 36531891, "comment_id": 60671760, "body": "@WillemVanOnsem I found this at hackerrank"}], "answers": [{"comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1460317422, "post_id": 36531996, "comment_id": 60672976, "body": "I guess you have to <code>sum</code> the list as well."}, {"owner": {"reputation": 81, "user_id": 5055758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6aac0826e8af0fcfea76a2da9e72d974?s=128&d=identicon&r=PG&f=1", "display_name": "v.sharath chandra", "link": "https://stackoverflow.com/users/5055758/v-sharath-chandra"}, "edited": false, "score": 0, "creation_date": 1460351777, "post_id": 36531996, "comment_id": 60682566, "body": "I did that but need an even good estimation of the area of the curve."}, {"owner": {"reputation": 81, "user_id": 5055758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6aac0826e8af0fcfea76a2da9e72d974?s=128&d=identicon&r=PG&f=1", "display_name": "v.sharath chandra", "link": "https://stackoverflow.com/users/5055758/v-sharath-chandra"}, "edited": false, "score": 0, "creation_date": 1460353227, "post_id": 36531996, "comment_id": 60683018, "body": "I tried by using the limit definition of integral with sub interval length 0.001 ."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 81, "user_id": 5055758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6aac0826e8af0fcfea76a2da9e72d974?s=128&d=identicon&r=PG&f=1", "display_name": "v.sharath chandra", "link": "https://stackoverflow.com/users/5055758/v-sharath-chandra"}, "edited": false, "score": 0, "creation_date": 1460383304, "post_id": 36531996, "comment_id": 60702500, "body": "you can do the symbolical integration and evaluate at the end.  For the curves with non-negative powers there is no need for numerical integration.  I reworked the code please check."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 81, "user_id": 5055758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6aac0826e8af0fcfea76a2da9e72d974?s=128&d=identicon&r=PG&f=1", "display_name": "v.sharath chandra", "link": "https://stackoverflow.com/users/5055758/v-sharath-chandra"}, "edited": false, "score": 0, "creation_date": 1460386594, "post_id": 36531996, "comment_id": 60705004, "body": "Splitting up code in small tasks is nice and fine, but <code>powers</code>, <code>dot</code> and <code>minus</code> are hardly more descriptive, nor significantly shorter than their definition. I&#39;d not give them names of their own. If you do, then at least give them signatures! (Also @v.sharathchandra: <i>always give your top-level definitions type signatures.</i>)"}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 1, "last_activity_date": 1460383231, "last_edit_date": 1460383231, "creation_date": 1460303803, "answer_id": 36531996, "question_id": 36531891, "link": "https://stackoverflow.com/questions/36531891/calculating-area-of-curve-using-haskell/36531996#36531996", "title": "Calculating Area of Curve using Haskell?", "body": "<p>break down to easy pieces</p>\n\n<pre><code>powers x = map (x^)\ndot = zipWith (*)\nminus = zipWith (-)\n\ncurve x as ps = dot as $ powers x ps\n\nareacurve le ri as ps = minus (curve ri as ps) (curve le as ps)\n</code></pre>\n\n<p><strong>UPDATE:</strong>\nNote that I just refactored your code, didn't really looked into what it does.  If you want to evaluate integrals of the curves here is a more structured way</p>\n\n<p>assume powers are non-negative, I'll simplify it by fixing numerical type as Double but should be easy to generalize</p>\n\n<pre><code>type Curve = [(Double,Double)]\n\nparabola = [(1.0,2.0)] \nline     = [(1.0,1.0)] \nzero     = []  \n\nintegral :: Curve -&gt; Curve\nintegral = map (\\(a,p) -&gt; (a/(p+1),p+1))\n\neval :: Double -&gt; Curve -&gt; Double\neval :: Double -&gt; Curve -&gt; Double\neval x c = sum $ map (\\(a,p) -&gt; a*x**p) c\n</code></pre>\n\n<p>Now for example, the area under the curve of <code>3*x^2+1</code> for <code>2&lt;x&lt;3</code></p>\n\n<pre><code>&gt; curve = [(1.0,1.0),(3.0,2.0)]\n&gt; integral curve\n[(0.5,2.0),(1.0,3.0)]\n\n&gt;  map ($ integral curve) $ map eval [2,3]\n[10.0,31.5]\n</code></pre>\n\n<p>the area is the difference between these two values 21.5</p>\n\n<p>Similarly, you can define the area between two curves.</p>\n"}], "owner": {"reputation": 81, "user_id": 5055758, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6aac0826e8af0fcfea76a2da9e72d974?s=128&d=identicon&r=PG&f=1", "display_name": "v.sharath chandra", "link": "https://stackoverflow.com/users/5055758/v-sharath-chandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 36531996, "answer_count": 1, "score": 0, "last_activity_date": 1460383231, "creation_date": 1460303267, "last_edit_date": 1460303398, "question_id": 36531891, "link": "https://stackoverflow.com/questions/36531891/calculating-area-of-curve-using-haskell", "title": "Calculating Area of Curve using Haskell?", "body": "<p>I want to calculate Area For a given curve y = f(x) between the limits l and r.</p>\n\n<pre><code>  Input will be : l r [a1,a2,a3..] [b1,b2,b3,b4,..]\n  The curve will be (a1)x^(b1) + (a2)x^(b2)+....\n</code></pre>\n\n<p>My program:</p>\n\n<pre><code>  area_curve _ _ [] [] = 0 \n  area_curve l r (ai:as) (bi:bs) = (ai(r^^(bi+1)-l^^(bi+1))) + area_curve l r as bs \n</code></pre>\n\n<p>When I run the program I am getting the following error:</p>\n\n<blockquote>\n<pre><code>\"ghci&gt; \" area_curve 1 4 [1,2,3,4,5] [6,7,8,9,10]\n&lt;interactive&gt;:20:1:\n    Non type-variable argument in the constraint: Num (a1 -&gt; a)\n    (Use FlexibleContexts to permit this)\n    When checking that \u2018it\u2019 has the inferred type\n      it :: forall a a1. (Fractional a1, Num a, Num (a1 -&gt; a)) =&gt; a\n</code></pre>\n</blockquote>\n"}, {"tags": ["list", "haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "edited": false, "score": 0, "creation_date": 1460303222, "post_id": 36531829, "comment_id": 60667537, "body": "Thank you so much, exactly what I was looking for! Is there a good place where I can find similar functions that I could study? Not necessarily functions that do the same thing, but useful ones for beginners."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "edited": false, "score": 2, "creation_date": 1460303390, "post_id": 36531829, "comment_id": 60667609, "body": "@Xzenon You can use <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">hoogle</a> to find functions by name or type . For example in your case you wanted something with type <code>(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a] -&gt; [a]</code>, searching for thing produces <a href=\"https://www.haskell.org/hoogle/?hoogle=%28a+-%3E+a+-%3E+a%29+-%3E+%5Ba%5D+-%3E+%5Ba%5D+-%3E+%5Ba%5D\" rel=\"nofollow noreferrer\">these results</a> and you can see <code>zipWith</code> too among them. Also you should check the <code>Prelude</code> module to see the most useful functions."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 6, "last_activity_date": 1460302971, "creation_date": 1460302971, "answer_id": 36531829, "question_id": 36531776, "link": "https://stackoverflow.com/questions/36531776/apply-map-using-a-different-function-to-each-element-of-the-list/36531829#36531829", "title": "Apply map using a different function to each element of the list", "body": "<p>You want to associate one element of a list with one element of the other list.\nThis is often called <em>zipping</em>. The <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:zipWith\"><code>zipWith</code></a> seems to do exactly what you want:</p>\n\n<pre><code>Prelude Data.Bits&gt; zipWith xor [1, 3, 5] [10, 23, 44]\n[11,20,41]\n</code></pre>\n\n<p>It takes an <code>a -&gt; b -&gt; c</code> function, an <code>[a]</code> list and a <code>[b]</code> list and apply the function element wise with corresponding elements from the two lists.</p>\n\n<p>It is a generalization of the <code>zip</code> function that produces pairs of element (<code>zip = zipWith (,)</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1460330645, "last_edit_date": 1460330645, "creation_date": 1460305144, "answer_id": 36532263, "question_id": 36531776, "link": "https://stackoverflow.com/questions/36531776/apply-map-using-a-different-function-to-each-element-of-the-list/36532263#36532263", "title": "Apply map using a different function to each element of the list", "body": "<p>That's what the <code>ZipList</code> instance of type class <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Applicative.html\" rel=\"nofollow\"><code>Applicative</code></a> is doing:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code> &gt; getZipList $ xor      . ord &lt;$&gt; ZipList \"Test\" &lt;*&gt; ZipList [1,3,6,9, 11]\n[85,102,117,125]\n</code></pre>\n\n<p>The <code>get/ZipList</code>s serve as kind of markers to signal our intent to zip, instead of the regular list's cross-product behaviour. We're supposed to pretend--\"ignore\" them, reading it in our minds instead as</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- zipWith   ( xor       . ord )           \"Test\"             [1,3,6,9, 11]\n</code></pre>\n\n<p>which is the same as</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- zipWith     xor (map    ord             \"Test\" )           [1,3,6,9, 11]\n-- zipWith ($) (map (xor . ord)            \"Test\" )           [1,3,6,9, 11]\n-- map (uncurry ($)) (zip (map (xor . ord) \"Test\" )           [1,3,6,9, 11] )\n-- map (\\(a,b)-&gt; xor (ord a) b) (zip       \"Test\"             [1,3,6,9, 11] )\n</code></pre>\n\n<p><code>&lt;$&gt;</code> is a synonym for <code>fmap</code> which is a synonym for <code>map</code>, and <code>&lt;*&gt;</code> is \"apply\". </p>\n\n<p>Without the <code>ZipList</code> marker, we get</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code> &gt;    [ord] &lt;*&gt; \"Test\"\n[84,101,115,116]\n\n--     ord  &lt;$&gt; \"Test\"\n-- map ord      \"Test\"\n</code></pre>\n\n<p>Specifically, your code should be tweaked a little bit into</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>function :: [Char] -&gt; [Int] -&gt; [Int]\n-- function string keys = map (iterate xor keys) (map ord string)\nfunction string keys = zipWith ($) (map xor keys) (map ord string)\n      -- = getZipList $ (xor &lt;$&gt; ZipList keys) &lt;*&gt; (ord &lt;$&gt; ZipList string)\n</code></pre>\n\n<p><code>($)</code> is an application operator, <code>($) f x = f $ x = f x</code>.</p>\n"}], "owner": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 36531829, "answer_count": 2, "score": 0, "last_activity_date": 1460330645, "creation_date": 1460302693, "last_edit_date": 1460303157, "question_id": 36531776, "link": "https://stackoverflow.com/questions/36531776/apply-map-using-a-different-function-to-each-element-of-the-list", "title": "Apply map using a different function to each element of the list", "body": "<p>I currently have this bit of code:</p>\n\n<pre><code>function string keys = map (xor 1) (map ord string)\n</code></pre>\n\n<p>Which takes every element from the string and xor's it with 1.\nI would like to make the map function more advanced, by replacing 1 with any element from keys.</p>\n\n<p>So for example if <code>string == \"Test\"</code> and <code>keys = [1,3,6,9]</code> I would get:</p>\n\n<pre><code>'T' xor 1\n'e' xor 3\n's' xor 6\n't' xor 9\n</code></pre>\n\n<p>Is there a way to iterate over all element of keys so that I can achieve this? I'm pretty new to Haskell and I don't have a good grasp of its concepts.</p>\n\n<p>My attempt at solving this was:</p>\n\n<pre><code>function string keys = map (iterate xor keys) (map ord string)\n</code></pre>\n\n<p>but I got a few errors and I guess it's because of the iterate function.</p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<hr>\n\n<p>Just as I posted I noticed that iterate does a completely different thing so at this point I know why it doesn't work but I don't know how to replace it.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 4, "creation_date": 1460303418, "post_id": 36531773, "comment_id": 60667621, "body": "You really don&#39;t want a <a href=\"http://pointfree.io/\" rel=\"nofollow noreferrer\">pointfree version of that code</a>: <code>replaceAll = flip foldl ([]) . flip ((.) . (++)) . flip flip ([]) . ((:) .) . replace</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 2, "last_activity_date": 1460305748, "creation_date": 1460305748, "answer_id": 36532378, "question_id": 36531773, "link": "https://stackoverflow.com/questions/36531773/is-it-possible-to-write-any-function-without-explicit-parameters-in-haskell/36532378#36532378", "title": "Is it possible to write any function without explicit parameters in Haskell?", "body": "<p>This works for me</p>\n\n<pre><code>replaceAll = map . replace\n</code></pre>\n\n<p>Although I also like removing params, I think this is a bit easier to understand if you fill them the params for this definition....</p>\n\n<pre><code>replaceAll index vals = map (replace index) vals\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 36532378, "answer_count": 1, "score": 0, "last_activity_date": 1460305748, "creation_date": 1460302675, "last_edit_date": 1460305746, "question_id": 36531773, "link": "https://stackoverflow.com/questions/36531773/is-it-possible-to-write-any-function-without-explicit-parameters-in-haskell", "title": "Is it possible to write any function without explicit parameters in Haskell?", "body": "<p>For example I have a table <code>tab = [(1,11), (2,22), (3,33)]</code> and two functions. The first one will take as parameter the table and an Integer and will replace the Integer with the value from the table. Let's assume the Integer will be on the table. </p>\n\n<pre><code>replace :: [(Int, Int)] -&gt; Int -&gt; Int\nreplace t i = snd $ head [x | x &lt;- t, fst x == i]\n</code></pre>\n\n<p>The second function will replace all the occurrences of <code>1, 2, 3</code> from a list with the values from the table.</p>\n\n<pre><code>replaceAll :: [(Int, Int)] -&gt; [Int] -&gt; [Int]\n</code></pre>\n\n<p>First I got:</p>\n\n<pre><code>replaceAll = \\tab lst -&gt; foldl(\\acc x -&gt; acc ++ [replace tab x]) [] lst\n</code></pre>\n\n<p>then,</p>\n\n<pre><code>replaceAll = \\tab -&gt; foldl(\\acc x -&gt; acc ++ [replace tab x]) []\n</code></pre>\n\n<p>Is there a way to write this without the lambda function?\nEDIT: Not necessary using the fold function.</p>\n"}, {"tags": ["list", "haskell", "dictionary", "tuples"], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 4, "last_activity_date": 1460303815, "last_edit_date": 1460303815, "creation_date": 1460303040, "answer_id": 36531842, "question_id": 36531737, "link": "https://stackoverflow.com/questions/36531737/haskell-map-list-of-tuples-to-list-of-tuples/36531842#36531842", "title": "Haskell map list of tuples to list of tuples", "body": "<p>You have to use <code>concat</code> on your result or use <code>concatMap</code> instead of <code>map</code>. After all, you return lists in your map and therefore get a list of lists.</p>\n\n<hr>\n\n<p>Let's give your function a name and a type:</p>\n\n<pre><code>magic :: [([Char], [Char])] -&gt; [(Char, Char)]\n</code></pre>\n\n<p>Now, we can think of this as a two-step process: from every pair in the original list we're going to get a list:</p>\n\n<pre><code>magicPair :: ([Char], [Char]) -&gt; [(Char, Char)]\nmagicPair (a,b) = zip a b\n</code></pre>\n\n<p>Now we need to map <code>magicPair</code> over all elements in your original list and concatenate the result:</p>\n\n<pre><code>magic xs = concat (map magicPair xs)\n</code></pre>\n\n<p>The combination <code>concat . map f</code> is so common that there is a function called <code>concatMap</code> for this:</p>\n\n<pre><code>magic xs = concatMap magicPair xs\n</code></pre>\n\n<p>And using a function <code>f</code> on a pair instead of two arguments is also common, so <code>magicPair = uncurry zip</code>:</p>\n\n<pre><code>magic xs = concatMap (uncurry zip) xs\n</code></pre>\n\n<p>We can now remove <code>xs</code> on both sides to end up with the final variant of <code>magic</code>:</p>\n\n<pre><code>magic = concatMap (uncurry zip)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1460303156, "post_id": 36531851, "comment_id": 60667502, "body": "Which is completely obfuscated for any language beginner."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1460303300, "post_id": 36531851, "comment_id": 60667574, "body": "@Zeta - .... and which will entice them into wanting to learn more about how cool Haskell is."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 1, "last_activity_date": 1460303082, "creation_date": 1460303082, "answer_id": 36531851, "question_id": 36531737, "link": "https://stackoverflow.com/questions/36531737/haskell-map-list-of-tuples-to-list-of-tuples/36531851#36531851", "title": "Haskell map list of tuples to list of tuples", "body": "<p>Here is a quick way to give you the output</p>\n\n<pre><code>simplify = (&gt;&gt;= uncurry zip)\n</code></pre>\n"}], "owner": {"reputation": 604, "user_id": 3451247, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000086306445/picture?type=large", "display_name": "KameeCoding", "link": "https://stackoverflow.com/users/3451247/kameecoding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2829, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1460307255, "creation_date": 1460302507, "last_edit_date": 1460302781, "question_id": 36531737, "link": "https://stackoverflow.com/questions/36531737/haskell-map-list-of-tuples-to-list-of-tuples", "title": "Haskell map list of tuples to list of tuples", "body": "<p>I'm trying to map a list of tuples into a different list of tuples with no luck.</p>\n\n<p>Example input: </p>\n\n<pre><code>a = [(\"eo\",\"th\"),(\"or\",\"he\")]\n</code></pre>\n\n<p>Example output:</p>\n\n<pre><code>[('e','t'),('o','h'),('o','h'),('r','e')]\n</code></pre>\n\n<p>I have tried:</p>\n\n<pre><code>map (\\(a,b) -&gt; (a!!0,b!!0):(a!!1,b!!1):[]) a\n</code></pre>\n\n<p>but it produces:</p>\n\n<pre><code>[[('e','t'),('o','h')],[('o','h'),('r','e')]]\n</code></pre>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460304440, "post_id": 36531658, "comment_id": 60668027, "body": "your <code>doubleSecond</code> looks strange - seems it will only double anything at the end ... look at your otherwise case (also IMO you should rethink your cases and the way you work with the lists using <code>splitAt</code>, <code>fst</code> , <code>snd</code> , <code>(!!)</code> ... screams <b>pattern match me</b> ;))"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460304578, "post_id": 36531658, "comment_id": 60668070, "body": "btw guys: is <code>sum . map (\\_ -&gt; 1)</code> their way to circumvent the <code>length</code> <i>issue</i> now? ... are you using Hugs or GHC?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460306301, "post_id": 36531658, "comment_id": 60668675, "body": "@Carsten: <code>length :: [a] -&gt; Int</code> would have the wrong type. But to be honest, <code>numValid :: [Integer] -&gt; Int</code> would be much more appropriate."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460308488, "post_id": 36531658, "comment_id": 60669509, "body": "@Zeta true (did not look at it) - it&#39;s still strange and it&#39;s still interesting if FP101 uses GHC, Hugs or Miranda now ;)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6184475"}, "edited": false, "score": 0, "creation_date": 1460480963, "post_id": 36532286, "comment_id": 60758655, "body": "Thank you very much for your reply! I see what I did wrong."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 2, "last_activity_date": 1460305261, "creation_date": 1460305261, "answer_id": 36532286, "question_id": 36531658, "link": "https://stackoverflow.com/questions/36531658/fp101x-lab-2-sumdigits/36532286#36532286", "title": "FP101x Lab 2 sumDigits", "body": "<p>Let's try to find those errors. We're going to use <a href=\"https://hackage.haskell.org/package/QuickCheck\" rel=\"nofollow\">QuickCheck</a> to test several properties. Let's start with some properties for <code>toDigits</code>:</p>\n\n<pre><code>toDigits_prop n = n &gt;= 0 ==&gt; length (toDigit n) === length (show n)\n</code></pre>\n\n<p>It will fail after some tests with something like this:</p>\n\n<pre><code>*Main&gt; quickCheck toDigits_prop\n*** Failed! Falsifiable (after 24 tests):\n10\n1 /= 2\n</code></pre>\n\n<p>This means that we got only one digit on <code>10</code>, where we originally expected two. Let's check the result of <code>toDigits</code> on <code>10</code>:</p>\n\n<pre><code>*Main&gt; toDigits 10\n[10]\n</code></pre>\n\n<p>Aha. There's a logic error on <code>toDigits</code>, the behaviour on the bounds is wrong, <code>10</code> isn't a digit. So change that to <code>&lt;= 9</code> instead <code>&lt;= 10</code>. While we're at it let's simplify that function, since there is <code>quotRem</code> to get both the reminder and <code>quot</code> at the same time:</p>\n\n<pre><code>toDigits :: Integer -&gt; [Integer]\ntoDigits n = case n `quotRem` 10 of\n  (0, m) -&gt; [m] -- only one digit was left\n  (q, m) -&gt; toDigits q ++ [m]\n</code></pre>\n\n<p>Note that this function is somewhat inefficient, we can make it faster if we reverse the digits at the same time:</p>\n\n<pre><code>toDigitsRev :: Integer -&gt; Integer\ntoDigitsRev n = case n `quotRem` 10 of\n  (0, m) -&gt; [m]               -- only one digit was left\n  (q, m) -&gt; m : toDigitsRev q -- add current digit left\n</code></pre>\n\n<p>Either way, let's check whether the new version of <code>toDigits</code> holds:</p>\n\n<pre><code>*Main&gt; quickCheck toDigits_prop\n+++ OK, passed 100 tests.\n</code></pre>\n\n<p>Allright. Let's check whether this passes all tests:</p>\n\n<pre><code>*Main&gt; numValid creditcards\n94\n</code></pre>\n\n<p>Seems like now everything is fine. So the key is to check properties of your functions. Note that several functions can be written easier, e.g.</p>\n\n<pre><code>doubleSecond :: Num a =&gt; [a] -&gt; [a]\ndoubleSecond xs = zipWith ($) (cycle [id, (2*)]) xs\n-- or\ndoubleSecond (x:y:xs) = x : 2 * y : doubleSecond xs\ndoubleSecond xs       = xs\n\nsumDigits :: [Integer] -&gt; Integer\nsumDigits xs = sum (concatMap toDigits xs)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6184475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460305261, "creation_date": 1460302086, "last_edit_date": 1592644375, "question_id": 36531658, "link": "https://stackoverflow.com/questions/36531658/fp101x-lab-2-sumdigits", "title": "FP101x Lab 2 sumDigits", "body": "<p>I'm stuck on Lab 2 of the Functional Programming course on edX taught by Erik Meijer. I will copy paste the assignment here:</p>\n<blockquote>\n<p>In this lab, you will implement a validation algorithm for credit cards. The algorithm follows these steps:</p>\n<pre><code>   Double the value of every second digit beginning with the rightmost.\n   Add the digits of the doubled values and the undoubled digits from the original number.\n   Calculate the modulus of the sum divided by 10.\n</code></pre>\n<p>If the result equals 0, then the number is valid. Here is an example of the results of each step on the number 4012888888881881.</p>\n<pre><code>   In order to start with the rightmost digit, we produce a reversed list of digits. Then, we double every second digit.\n</code></pre>\n<p>Result: [1,16,8,2,8,16,8,16,8,16,8,16,2,2,0,8].</p>\n<p>We sum all of the digits of the resulting list above. Note that we must again split the elements of the list into their digits (e.g. 16 becomes [1, 6]).</p>\n<p>Result: 90.</p>\n<p>Finally, we calculate the modulus of 90 over 10.</p>\n<p>Result: 0.</p>\n</blockquote>\n<p>Since the final value is 0, we know that the above number is a valid credit card number. If we make a mistake in typing the credit card number and instead provide 4012888888881891, then the result of the last step is 2, proving that the number is invalid.</p>\n<p>My code:</p>\n<pre><code>toDigits   :: Integer -&gt; [Integer]\ntoDigits n = if 0 &lt;= n &amp;&amp; n &lt;= 10 then [n] else toDigits ((n - n `mod` 10) `quot` 10) ++ [n `mod` 10]\n\ntoDigitsRev :: Integer -&gt; [Integer]\ntoDigitsRev n = reverse (toDigits n)\n\n\ndoubleSecond :: [Integer] -&gt; [Integer]\ndoubleSecond xs | length xs &lt;= 1                   = xs\n                | 1 &lt; length xs  &amp;&amp; length xs &lt; 4  = [fst (splitAt 2 xs) !! 0 ,(*2) (fst (splitAt 2 xs) !! 1 )] ++ snd (splitAt 2 xs)\n                | otherwise                        = doubleSecond (fst (splitAt 2 xs)) ++ doubleSecond (snd (splitAt 2 xs))\n\n\nsumDigits :: [Integer] -&gt; Integer\nsumDigits xs | xs == []  = 0\n             | otherwise = sum (toDigits (head xs)) + sumDigits (tail xs)\n\nisValid :: Integer -&gt; Bool\nisValid n | sumDigits (doubleSecond (toDigitsRev n)) `mod` 10 == 0 = True\n          | otherwise                                              = False\n</code></pre>\n<p>Next, they give you this code:</p>\n<pre><code>numValid :: [Integer] -&gt; Integer\nnumValid xs = sum . map (\\_ -&gt; 1) $ filter isValid xs\n\n\ncreditcards :: [Integer]\ncreditcards = [ 4716347184862961,\n                4532899082537349,\n                4485429517622493,\n                4320635998241421,\n                4929778869082405,\n                5256283618614517,\n                5507514403575522,\n                5191806267524120,\n                5396452857080331,\n                5567798501168013,\n                6011798764103720,\n                6011970953092861,\n                6011486447384806,\n                6011337752144550,\n                6011442159205994,\n                4916188093226163,\n                4916699537435624,\n                4024607115319476,\n                4556945538735693,\n                4532818294886666,\n                5349308918130507,\n                5156469512589415,\n                5210896944802939,\n                5442782486960998,\n                5385907818416901,\n                6011920409800508,\n                6011978316213975,\n                6011221666280064,\n                6011285399268094,\n                6011111757787451,\n                4024007106747875,\n                4916148692391990,\n                4916918116659358,\n                4024007109091313,\n                4716815014741522,\n                5370975221279675,\n                5586822747605880,\n                5446122675080587,\n                5361718970369004,\n                5543878863367027,\n                6011996932510178,\n                6011475323876084,\n                6011358905586117,\n                6011672107152563,\n                6011660634944997,\n                4532917110736356,\n                4485548499291791,\n                4532098581822262,\n                4018626753711468,\n                4454290525773941,\n                5593710059099297,\n                5275213041261476,\n                5244162726358685,\n                5583726743957726,\n                5108718020905086,\n                6011887079002610,\n                6011119104045333,\n                6011296087222376,\n                6011183539053619,\n                6011067418196187,\n                4532462702719400,\n                4420029044272063,\n                4716494048062261,\n                4916853817750471,\n                4327554795485824,\n                5138477489321723,\n                5452898762612993,\n                5246310677063212,\n                5211257116158320,\n                5230793016257272,\n                6011265295282522,\n                6011034443437754,\n                6011582769987164,\n                6011821695998586,\n                6011420220198992,\n                4716625186530516,\n                4485290399115271,\n                4556449305907296,\n                4532036228186543,\n                4916950537496300,\n                5188481717181072,\n                5535021441100707,\n                5331217916806887,\n                5212754109160056,\n                5580039541241472,\n                6011450326200252,\n                6011141461689343,\n                6011886911067144,\n                6011835735645726,\n                6011063209139742,\n                379517444387209,\n                377250784667541,\n                347171902952673,\n                379852678889749,\n                345449316207827,\n                349968440887576,\n                347727987370269,\n                370147776002793,\n                374465794689268,\n                340860752032008,\n                349569393937707,\n                379610201376008,\n                346590844560212,\n                376638943222680,\n                378753384029375,\n                348159548355291,\n                345714137642682,\n                347556554119626,\n                370919740116903,\n                375059255910682,\n                373129538038460,\n                346734548488728,\n                370697814213115,\n                377968192654740,\n                379127496780069,\n                375213257576161,\n                379055805946370,\n                345835454524671,\n                377851536227201,\n                345763240913232\n              ]\n</code></pre>\n\n<p>You are supposed to run <code>numValid creditcards</code> and get 94, I'm getting 39.\nI suspect my mistake is in <code>sumDigits</code> but can't really find it, any help is much appreciated.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1460293684, "post_id": 36529465, "comment_id": 60664126, "body": "I believe the author was right some time ago, where <code>lookup</code> used to return <code>m a</code> for any monad <code>m</code>. Now, <code>lookup</code> only returns <code>Maybe a</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460293825, "post_id": 36529465, "comment_id": 60664175, "body": "When I was reading this paper a few weeks ago, I had the same question. I did find an updated version of the paper (or at least the code) that fixed this; I&#39;ll see if I can dig up the link."}], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": false, "score": 2, "last_activity_date": 1460292660, "creation_date": 1460292660, "answer_id": 36529974, "question_id": 36529465, "link": "https://stackoverflow.com/questions/36529465/monad-transformers-first-step/36529974#36529974", "title": "Monad Transformers. First step", "body": "<blockquote>\n  <p>The reason is that Map.lookup is defined to work within any monad by simply  calling the monad's fail function</p>\n</blockquote>\n\n<p>It's not true. In the text the definition of <code>Map.lookup</code> is different from the real definition in <code>containers</code> package. The author generalized <code>Map.lookup</code> to any monadic value, not only <code>Maybe</code>:</p>\n\n<pre><code>lookup' :: (Ord k, Monad m) =&gt; k -&gt; Map k a -&gt; m a \nlookup' k m = case Map.lookup k m of\n    Nothing -&gt; fail \"some_error_message\"\n    Just v  -&gt; return v\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 6, "last_activity_date": 1460312640, "last_edit_date": 1460312640, "creation_date": 1460294055, "answer_id": 36530235, "question_id": 36529465, "link": "https://stackoverflow.com/questions/36529465/monad-transformers-first-step/36530235#36530235", "title": "Monad Transformers. First step", "body": "<p>At the time that draft was written, <code>Data.Map.lookup</code> apparently did work with any monad. This is no longer true, but the author does provide an <a href=\"https://github.com/mgrabmueller/TransformersStepByStep/blob/master/Transformers.lhs\" rel=\"nofollow\">updated version</a> of the tutorial.</p>\n\n<p>Specifically, you have to examine the resulting <code>Maybe String</code> value and call <code>fail</code> explicitly.</p>\n\n<pre><code>-- Copied from the link above\neval1 env (Var n) = maybe (fail (\"undefined variable: \" ++ n)) return $ Map.lookup n env\n</code></pre>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 36530235, "answer_count": 2, "score": 5, "last_activity_date": 1460312640, "creation_date": 1460289811, "last_edit_date": 1460290132, "question_id": 36529465, "link": "https://stackoverflow.com/questions/36529465/monad-transformers-first-step", "title": "Monad Transformers. First step", "body": "<p>Let's consider:</p>\n\n<pre><code>type Name   =  String                -- variable names\n\ndata Exp    =  Lit Integer           -- expressions\n            |  Var Name\n            |  Plus Exp Exp\n            |  Abs Name Exp\n            |  App Exp Exp\n            deriving (Show)\n\ndata Value  =  IntVal Integer        -- values\n            |  FunVal Env Name Exp\n            deriving (Show)\n\ntype Env    =  Map.Map Name Value    -- mapping from names to values\n\neval0 :: Env -&gt; Exp -&gt; Value\neval0 env (Var n) = fromJust (Map.lookup n env )\n</code></pre>\n\n<p>And above is 0 version.</p>\n\n<p>Now, let's consider monadic, 1 version:</p>\n\n<pre><code>type Eval1 a = Identity a\neval1 :: Env -&gt; Exp -&gt; Eval1 Value\neval1 env (Var n)  =  Map.lookup n env\n</code></pre>\n\n<p>And now, the author said:</p>\n\n<blockquote>\n  <p>The next is that the Var case does not need a fromJust call anymore:\n  The reason is that Map.lookup is defined to work within any monad by\n  simply calling the monad\u2019s fail function \u2013 this fits nicely with our\n  monadic formulation here. (The fail function of the Maybe monad\n  returns Nothing, whereas the fail function in the Identity monad\n  throws an exception, which will lead to different error messages.)</p>\n</blockquote>\n\n<p>The content comes from: <a href=\"http://www.cs.virginia.edu/~wh5a/personal/Transformers.pdf\" rel=\"noreferrer\">http://www.cs.virginia.edu/~wh5a/personal/Transformers.pdf</a>\nand it is not clear for me. Please explain why introducing monad Eval1 allow us to don't care about <code>fromJust</code>. </p>\n\n<p>EDIT:</p>\n\n<p>Now, I tried to compile it and I got error and this error is consistent with my intuition and my doubts. The compiler says:</p>\n\n<pre><code>Couldn't match type `Maybe Value' with `Identity Value'\nExpected type: Eval1 Value\n  Actual type: Maybe Value\nIn the return type of a call of `Map.lookup'\nIn the expression: Map.lookup n env\nIn an equation for `eval1': eval1 env (Var n) = Map.lookup n env\n</code></pre>\n\n<p>So, who is right, author or compiler and how to repair it?</p>\n"}, {"tags": ["string", "haskell", "return", "monads", "guard-statement"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460284772, "post_id": 36528664, "comment_id": 60661418, "body": "well the <code>do</code> block is in the list-monad and the return is <code>return c = [c]</code> - you will never get any updated <code>s</code> here at all - I guess you tried to somehow use a state-monad?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460284861, "post_id": 36528664, "comment_id": 60661446, "body": "I guess <code>| otherwise = check (update s c) (next c)</code> should do the trick (don&#39;t see your <code>next</code> nor your <code>update</code> so I have no clue if this really fixes your problem)"}, {"owner": {"reputation": 249, "user_id": 4829273, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-emCrPqb11kI/AAAAAAAAAAI/AAAAAAAAABY/8ytVw4Vx1g8/photo.jpg?sz=128", "display_name": "Olenka", "link": "https://stackoverflow.com/users/4829273/olenka"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460285583, "post_id": 36528664, "comment_id": 60661631, "body": "@Carsten I&#39;ve updated my question, so that it is more clear (I hope). Your idea will not work for me, as I need to return value from check and use it into completely different function, together with updated list. I&#39;ve also tied &quot;&gt;&gt;&quot;.  And no, I didn&#39;t try state-monad, as I&#39;m not that familiar with that one. Can you please give me any tip how to apply it to this situation?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460286812, "post_id": 36528664, "comment_id": 60661938, "body": "of course <code>&gt;&gt;</code> won&#39;t work - it&#39;s the same! - look just rid yourself of the imperative thinking and don#t try to do this using monads/<code>do</code> notation - also have you treally tried it? because it seems to be doing what you described"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1460288452, "post_id": 36528664, "comment_id": 60662444, "body": "Are you sure it&#39;s not <code>check :: [String] -&gt; Char -&gt; [String]</code> what you actually want? It&#39;s hard to guess what is the aim here. Maybe you could add some examples of inputs and expected output."}], "answers": [{"tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": true, "score": 1, "last_activity_date": 1460357901, "creation_date": 1460357901, "answer_id": 36541830, "question_id": 36528664, "link": "https://stackoverflow.com/questions/36528664/returning-a-value-from-do-statement-in-a-guards-haskell/36541830#36541830", "title": "returning a value from do statement in a guards haskell", "body": "<p>Haskell is a functional language, hence you cannot (should not) think of mutating a data structure, instead a function should return an updated version of that data structure, and whatever else you need. Most common way to do it is returning a tuple of values you need. Here is what you are probably looking for:</p>\n\n<pre><code>check:: [String] -&gt; Char -&gt; (Char, [String])\ncheck s c \n    | any (elem c) s = check s (next c)\n    | otherwise = (c, s ++ [[c]])\n</code></pre>\n\n<p>This way you get \"this\" letter and updated version of the initial list of  <code>String</code>s.</p>\n"}], "owner": {"reputation": 249, "user_id": 4829273, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh6.googleusercontent.com/-emCrPqb11kI/AAAAAAAAAAI/AAAAAAAAABY/8ytVw4Vx1g8/photo.jpg?sz=128", "display_name": "Olenka", "link": "https://stackoverflow.com/users/4829273/olenka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 816, "favorite_count": 0, "accepted_answer_id": 36541830, "answer_count": 1, "score": 2, "last_activity_date": 1460357948, "creation_date": 1460284577, "last_edit_date": 1460357948, "question_id": 36528664, "link": "https://stackoverflow.com/questions/36528664/returning-a-value-from-do-statement-in-a-guards-haskell", "title": "returning a value from do statement in a guards haskell", "body": "<p>I'm trying to find if some letter is already used in any string in the list of strings. If yes - choose next letter to compare. If no - return this letter and update the initial list.</p>\n\n<p>To check in the list I'm using:</p>\n\n<pre><code>check:: [String] -&gt; Char -&gt; Char\ncheck s c \n    | any (elem c) s = check s (next c)\n    | otherwise = do update s c \n                     return c\n</code></pre>\n\n<p>But it gives me an error:</p>\n\n<blockquote>\n  <p>Couldn't match type \u2018[Char]\u2019 with \u2018Char\u2019 <br>\n  Expected type: [String] -> [Char] -> Char <br>\n  Actual type: [String] -> [Char] -> [Char] <br>\n  In a stmt of a 'do' block: update s c</p>\n</blockquote>\n\n<p>My update function has following declaration:</p>\n\n<pre><code>update:: [String] -&gt; Char -&gt; [String]\n</code></pre>\n\n<p>Is there any correct way to perform 2 actions in the guard <code>otherwise</code>? \nI need to return <strong>c</strong> in order to use it in another recursive function, which takes as the parameters both <code>Char</code> <strong>c</strong> and updated <code>[String]</code> <strong>s</strong></p>\n\n<p>When I had this functions returning only <strong>c</strong>, without updating the list, there where no errors:</p>\n\n<pre><code>check:: [String] -&gt; Char -&gt; Char\ncheck s c \n    | any (elem c) s = check s (next c)\n    | otherwise = c\n</code></pre>\n\n<p>Any tips are welcome.</p>\n\n<p><strong>Update</strong>:\nMy next function is:</p>\n\n<pre><code>next :: Char -&gt; Char\nnext 'Z' = 'A'\nnext c = chr (ord c + 1)\n</code></pre>\n\n<p>And for update I've tried:</p>\n\n<pre><code>update:: [String] -&gt; Char -&gt; [String]\nupdate s c = s ++ [[c]]\n</code></pre>\n\n<p>The thing is that later on, I need to use <code>[String]</code> which is the result of update, together with <code>Char</code> <strong>c</strong> (result from check) into another function. \nThat's why, after performing check, I need to return a value, and to update a list with it.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1460304693, "post_id": 36528426, "comment_id": 60668125, "body": "When I do this with a blank project (<code>stack new foo</code>), I <i>do</i> get a .prof. From your <code>.exe</code>, I&#39;m guessing you&#39;re on Windows? What&#39;s your <code>stack --version</code>? (You might also get better help by filing a issue on Stack&#39;s GitHub.)"}, {"owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1460350275, "post_id": 36528426, "comment_id": 60682153, "body": "My version is 1.0.4. Yes I am running on Windows."}, {"owner": {"reputation": 622, "user_id": 311524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c2067d97bbaec06933c9e1eeeb811a9?s=128&d=identicon&r=PG", "display_name": "Diogo Biazus", "link": "https://stackoverflow.com/users/311524/diogo-biazus"}, "edited": false, "score": 0, "creation_date": 1460825015, "post_id": 36528426, "comment_id": 60925554, "body": "I&#39;m running 1.0.4 on Mac OS and it works fine, perhaps it is a bug on the windows&#39; stack implementation."}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1460830168, "post_id": 36528426, "comment_id": 60927523, "body": "I reproduced this on Windows 7. It&#39;s only for RTS options, -ddump options still will produce the dumps in <code>.&#47;stack-work&#47;dist&#47;</code>."}, {"owner": {"reputation": 3231, "user_id": 1013393, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7bca51e5ae3eb8dc24a98616b4e5d6fd?s=128&d=identicon&r=PG", "display_name": "sjakobi", "link": "https://stackoverflow.com/users/1013393/sjakobi"}, "edited": false, "score": 0, "creation_date": 1461527719, "post_id": 36528426, "comment_id": 61227386, "body": "<a href=\"https://github.com/commercialhaskell/stack/issues/2022\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/2022</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 0, "last_activity_date": 1473298219, "creation_date": 1473298219, "answer_id": 39381280, "question_id": 36528426, "link": "https://stackoverflow.com/questions/36528426/getting-profiling-file-from-stack-exec/39381280#39381280", "title": "Getting profiling file from &quot;stack exec&quot;", "body": "<p><code>--</code> stops the RTS from processing further command-line arguments but is passed through to the program. So, your <code>--</code> is visible to both <code>stack</code> and <code>myProgram.exe</code> and therefore the <code>+RTS -p</code> flags are not visible to <code>myProgram.exe</code>'s RTS. Instead try</p>\n\n<pre><code>stack exec -- myProgram.exe inputArg +RTS -p\n</code></pre>\n"}], "owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 351, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1473298219, "creation_date": 1460283168, "last_edit_date": 1460284066, "question_id": 36528426, "link": "https://stackoverflow.com/questions/36528426/getting-profiling-file-from-stack-exec", "title": "Getting profiling file from &quot;stack exec&quot;", "body": "<p>I would like to profile a program that is being managed by Stack. The file was built using with the following command:</p>\n\n<p><code>stack build --executable-profiling --library-profiling --ghc-options=\"-fprof-auto -rtsopts\"</code></p>\n\n<p>And run with this command</p>\n\n<p><code>stack exec myProgram.exe -- inputArg +RTS -p</code></p>\n\n<p>I know that the program has run (from the output file) but I am expecting a <code>myProgram.prof</code> file to be produced as well, I cannot find this file.</p>\n\n<p>If I execute the program without using stack the profiling file is produced, but is there a way to get this to work using Stack? </p>\n"}, {"tags": ["list", "haskell", "key", "tuples"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1460281336, "post_id": 36528135, "comment_id": 60660478, "body": "What have you already tried, what error are you getting"}, {"owner": {"reputation": 604, "user_id": 3451247, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000086306445/picture?type=large", "display_name": "KameeCoding", "link": "https://stackoverflow.com/users/3451247/kameecoding"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1460288811, "post_id": 36528135, "comment_id": 60662556, "body": "@epsilonhalbe I have added my solution, but it&#39;s pretty ugly in my opinion"}], "answers": [{"tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 4, "last_activity_date": 1460292494, "last_edit_date": 1460292494, "creation_date": 1460291829, "answer_id": 36529808, "question_id": 36528135, "link": "https://stackoverflow.com/questions/36528135/removing-duplicate-keys-values-from-tuple-list/36529808#36529808", "title": "Removing duplicate keys/values from tuple-list", "body": "<p>You can just use the <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-List.html#v:nubBy\" rel=\"nofollow\"><code>nubBy</code></a> function from the <code>Data.List</code> package with the appropriate comparator:</p>\n\n<pre><code>removeDuplicates xs = nubBy cmpKeyAndVal xs \n  where\n    cmpKeyAndVal (x, y) (x', y') = x == x' || y == y'\n</code></pre>\n\n<p>Used as:</p>\n\n<pre><code>&gt; removeDuplicates [(\"r\",\"w\"),(\"n\",\"j\"),(\"a\",\"j\"),(\"d\",\"i\"),(\"s\",\"g\"),(\"r\",\"a\")]\n[(\"r\",\"w\"),(\"n\",\"j\"),(\"d\",\"i\"),(\"s\",\"g\")]\n</code></pre>\n\n<p>Also note that calling your implementation with <code>(\"\", \"\")</code> yields incorrect results when either a key or value is <code>\"\"</code>. The only way to choose a correct first argument is to put something that doesn't appear in the input, which is a bit annoying to do.</p>\n\n<hr>\n\n<p>Note that the above implementation takes O(n^2) time, which is optimal for <code>Eq</code> instances. If you can allow an <code>Ord</code> constraint you can use the <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-List.html#v:sortBy\" rel=\"nofollow\"><code>sortBy</code></a> function which implements a <em>stable</em> sorting algorithm, and then use <code>groupBy</code> to remove the contiguous duplicates:</p>\n\n<pre><code>import Data.List(sortBy, groupBy)\nimport Data.Ord(comparing)\nimport Data.Function(on)\n\nremoveDuplicates xs = sortAndGroupBy snd (sortAndGroupBy fst xs)\n  where\n    sortAndGroupBy f = map head . groupBy ((==) `on` f). sortBy (comparing f)\n</code></pre>\n\n<p>This takes O(nlog n) time instead, but obviously require an <code>Ord</code> constraint.</p>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1460291842, "creation_date": 1460291842, "answer_id": 36529812, "question_id": 36528135, "link": "https://stackoverflow.com/questions/36528135/removing-duplicate-keys-values-from-tuple-list/36529812#36529812", "title": "Removing duplicate keys/values from tuple-list", "body": "<p>So first of all, get in the habit of adding a type-signature when writing a function. It keeps you sane and honest, it captures what you want to do, and is best written before you implement your function.</p>\n\n<pre><code>removeDuplicates :: (Eq a, Eq a1) =&gt; ([a], [a1]) -&gt; [([a], [a1])] -&gt; [([a], [a1])]\n</code></pre>\n\n<p>If you want to have it being called without the additional parameter, I would propose something like this:</p>\n\n<pre><code>remove :: (Eq a, Eq a1) =&gt; [([a], [a1])] -&gt; [([a], [a1])]\nremove = removeDuplicates (\"\",\"\")\n</code></pre>\n\n<p>Another more general version which would not work only with lists as elements of your tuples, would be this:</p>\n\n<pre><code>removeX :: (Eq t, Eq s) =&gt; [(t, s)] -&gt; [(t, s)]\nremoveX [] = []\nremoveX (xx@(x,y):xs) = let xs' = filter (\\(a,b) -&gt; not (a == x || b ==y) ) xs\n                        in xx:removeX xs'\n</code></pre>\n\n<p>If you want to stick with standard functions - @Bakuriu has the right answer for you</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1460291851, "creation_date": 1460291851, "answer_id": 36529814, "question_id": 36528135, "link": "https://stackoverflow.com/questions/36528135/removing-duplicate-keys-values-from-tuple-list/36529814#36529814", "title": "Removing duplicate keys/values from tuple-list", "body": "<p>Put the accumulator in a helper function.</p>\n\n<pre><code>removeDuplicates lst = rd lst []\n                       where rd _ [] = []\n                             rd seen (x:xs) = ...\n</code></pre>\n"}], "owner": {"reputation": 604, "user_id": 3451247, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100000086306445/picture?type=large", "display_name": "KameeCoding", "link": "https://stackoverflow.com/users/3451247/kameecoding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 0, "accepted_answer_id": 36529808, "answer_count": 3, "score": 0, "last_activity_date": 1460292774, "creation_date": 1460281073, "last_edit_date": 1460292774, "question_id": 36528135, "link": "https://stackoverflow.com/questions/36528135/removing-duplicate-keys-values-from-tuple-list", "title": "Removing duplicate keys/values from tuple-list", "body": "<p>I have a list of tuples, <code>(key,value)</code> pairs. I need to remove elements that duplicate the key or the value, order of the list can change, but the first occurrence of the key or the value must remain in the list of tuples:</p>\n\n<p>Example:</p>\n\n<pre><code>input: [(\"r\",\"w\"),(\"n\",\"j\"),(\"a\",\"j\"),(\"d\",\"i\"),(\"s\",\"g\"),(\"r\",\"a\")]\noutput: [(\"r\",\"w\"),(\"n\",\"j\"),(\"d\",\"i\"),(\"s\",\"g\")]\n</code></pre>\n\n<p>What I made:</p>\n\n<pre><code>removeDuplicates  _   []  = []\nremoveDuplicates seen (x:xs) \n                        | elem (head $ fst x) (fst seen) = [] ++ removeDuplicates seen xs\n                        | elem (head $ snd x) (snd seen) = [] ++ removeDuplicates seen xs\n                        | otherwise  = x:removeDuplicates ((fst seen)++(fst x),(snd seen)++(snd x)) xs\n</code></pre>\n\n<p>But this needs to be called as <code>removeDuplicates (\"\",\"\") something</code> which is ugly.</p>\n"}, {"tags": ["haskell", "yesod", "persistent"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1460281532, "post_id": 36528061, "comment_id": 60660540, "body": "it&#39;s moved into the backend part - see <a href=\"https://hackage.haskell.org/package/persistent-2.2.4/docs/Database-Persist-Sql.html#fromSqlKey\" rel=\"nofollow noreferrer\">fromSqlKey</a>"}, {"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1460396073, "post_id": 36528061, "comment_id": 60711269, "body": "@Carsten do you want to make that an answer so Petr can accept it?"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 1, "last_activity_date": 1460398107, "creation_date": 1460398107, "answer_id": 36556056, "question_id": 36528061, "link": "https://stackoverflow.com/questions/36528061/how-to-get-a-raw-key-value-from-in-yesods-persistent/36556056#36556056", "title": "How to get a raw key value from in Yesod&#39;s Persistent?", "body": "<p>this functionality was moved into the backend-part of the framework</p>\n\n<p>for SQL it would be <a href=\"https://hackage.haskell.org/package/persistent-2.2.4/docs/Database-Persist-Sql.html#fromSqlKey\" rel=\"nofollow\"><code>fromSqlKey</code></a></p>\n\n<p>and there is indeed a <a href=\"https://hackage.haskell.org/package/persistent-2.2.4/docs/Database-Persist-Class.html#t:ToBackendKey\" rel=\"nofollow\">type class - <code>ToBackendKey</code></a> for it so just look for those in you used persistent-backend and you should find the function (it does not have to be an <code>Int64</code> everywhere - in MongoDB there seems to be quite a <a href=\"https://hackage.haskell.org/package/persistent-mongoDB-2.1.4/docs/Database-Persist-MongoDB.html\" rel=\"nofollow\">few helpers though</a>) </p>\n"}], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 36556056, "answer_count": 1, "score": 2, "last_activity_date": 1460398107, "creation_date": 1460280630, "question_id": 36528061, "link": "https://stackoverflow.com/questions/36528061/how-to-get-a-raw-key-value-from-in-yesods-persistent", "title": "How to get a raw key value from in Yesod&#39;s Persistent?", "body": "<p>Having an entity, such as <code>User</code>, I can retrieve it's type-safe key using <code>entityKey</code>, which gets me <code>Key User</code>. How can I retrieve the raw value of the key, for example as an <code>Int64</code>? There used to be functions for that in the early versions of <em>persistent</em>, such as <a href=\"https://hackage.haskell.org/package/persistent-0.1.0/docs/Database-Persist.html#v:fromPersistKey\" rel=\"nofollow\"><code>fromPersistKey</code></a> and <code>showPersistentKey</code>, but they're not available any more.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 95982, "user_id": 17279, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a08771c878da3724492f3056d5eca168?s=128&d=identicon&r=PG", "display_name": "zoul", "link": "https://stackoverflow.com/users/17279/zoul"}, "is_accepted": false, "score": 1, "last_activity_date": 1460282040, "last_edit_date": 1460282040, "creation_date": 1460280494, "answer_id": 36528048, "question_id": 36527998, "link": "https://stackoverflow.com/questions/36527998/haskell-what-is-wrong-with-factorial-function/36528048#36528048", "title": "Haskell: What is wrong with factorial function", "body": "<p>I think the compiler isn\u2019t smart enough to know that covering the three cases is exhaustive for the particular type. Simply use the <code>otherwise</code> pattern in the third rule instead of zero?</p>\n\n<p>(And by the way, factorial is usually only defined for positive integers, so I don\u2019t know how much your negative branch is correct.)</p>\n"}, {"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1460281246, "post_id": 36528063, "comment_id": 60660451, "body": "That is to say, add a case <code>| otherwise = error &quot;The impossible happened.&quot;</code> Or something along those lines."}, {"owner": {"reputation": 95982, "user_id": 17279, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/a08771c878da3724492f3056d5eca168?s=128&d=identicon&r=PG", "display_name": "zoul", "link": "https://stackoverflow.com/users/17279/zoul"}, "edited": false, "score": 0, "creation_date": 1460281332, "post_id": 36528063, "comment_id": 60660476, "body": "I think Paul means to handle one of the legitimate cases with a catch-all case. I would <a href=\"http://programmers.stackexchange.com/questions/252977/cleanest-way-to-report-errors-in-haskell\">stay away from <code>error</code> if possible</a>."}], "tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 4, "last_activity_date": 1460280677, "creation_date": 1460280677, "answer_id": 36528063, "question_id": 36527998, "link": "https://stackoverflow.com/questions/36527998/haskell-what-is-wrong-with-factorial-function/36528063#36528063", "title": "Haskell: What is wrong with factorial function", "body": "<p>This is ghc being conservative. Your code has all possible values of \"n\" covered, but ghc isn't smart enough to prove that, so it warns you.</p>\n\n<p>Try replacing your \"n &lt; 0\" with \"otherwise\" and putting it at the end. This is defined as </p>\n\n<pre><code>otherwise = True\n</code></pre>\n\n<p>That will become the catch-all case which will make ghc comfortable.</p>\n"}, {"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 2, "last_activity_date": 1460282233, "last_edit_date": 1460282233, "creation_date": 1460281846, "answer_id": 36528243, "question_id": 36527998, "link": "https://stackoverflow.com/questions/36527998/haskell-what-is-wrong-with-factorial-function/36528243#36528243", "title": "Haskell: What is wrong with factorial function", "body": "<p>The compiler can't tell that all inputs match at least one of three guards.</p>\n\n<p>Here's a suggestion to fix that and also remove some repetition:</p>\n\n<pre><code>factorial :: Integer -&gt; Integer\nfactorial n = case compare n 0 of\n  LT -&gt; -1\n  GT -&gt; n * factorial (n-1)\n  EQ -&gt; 1\n</code></pre>\n"}], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "closed_date": 1460281913, "answer_count": 3, "score": 2, "last_activity_date": 1460282233, "creation_date": 1460280139, "last_edit_date": 1460281483, "question_id": 36527998, "link": "https://stackoverflow.com/questions/36527998/haskell-what-is-wrong-with-factorial-function", "closed_reason": "Duplicate", "title": "Haskell: What is wrong with factorial function", "body": "<p>The following is my factorial function:</p>\n\n<pre><code>factorial :: Integer -&gt; Integer\nfactorial n\n  | n &lt; 0 = -1\n  | n &gt; 0 = n * factorial (n-1)\n  | n == 0 = 1\n</code></pre>\n\n<p>I guess, I covered all the cases (+ve, -ve, 0). When I try to load above code, I am getting following warnings. Why am I getting warnings?</p>\n\n<pre><code>Prelude&gt; :load Fact.hs \n[1 of 1] Compiling Main             ( Fact.hs, interpreted )\n\nFact.hs:2:1: Warning:\n   Pattern match(es) are non-exhaustive\nIn an equation for \u2018factorial\u2019: Patterns not matched: _\nOk, modules loaded: Main.\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "operator-precedence", "parsec"], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 2302260, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8f97ff66bdfe5674beb4b843bdea852d?s=128&d=identicon&r=PG", "display_name": "EdZhavoronkov", "link": "https://stackoverflow.com/users/2302260/edzhavoronkov"}, "edited": false, "score": 0, "creation_date": 1460290629, "post_id": 36529035, "comment_id": 60663079, "body": "Are there any ways to avoid left recurison? I can&#39;t remove <code>colonStmt</code>, i know that there is something like <code>chainl</code> combinator, but i am not sure how it works =("}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 187, "user_id": 2302260, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8f97ff66bdfe5674beb4b843bdea852d?s=128&d=identicon&r=PG", "display_name": "EdZhavoronkov", "link": "https://stackoverflow.com/users/2302260/edzhavoronkov"}, "edited": false, "score": 0, "creation_date": 1460317373, "post_id": 36529035, "comment_id": 60672954, "body": "@EdZhavoronkov Your grammar itself is left recursive, regardless of implementation or language, you will not be able to parse it with a top-down left-most derivation parser. The typical solution is to simply convert the grammar to an <a href=\"http://www.csd.uwo.ca/~moreno//CS447/Lectures/Syntax.html/node8.html\" rel=\"nofollow noreferrer\">equivalent</a> one which is not left-recursive."}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 1, "last_activity_date": 1460291426, "last_edit_date": 1460291426, "creation_date": 1460287142, "answer_id": 36529035, "question_id": 36527728, "link": "https://stackoverflow.com/questions/36527728/how-to-parse-simple-imperative-language-using-parsec/36529035#36529035", "title": "How to parse simple imperative language using Parsec?", "body": "<p>It's a common problem of parsers based on parser combinator: <code>statement</code> is left-recursive as its first pattern is <code>colonStmt</code>, and the first thing <code>colonStmt</code> will do is try parsing a <code>statement</code> again. Parser combinators are well-known won't terminate in this case.</p>\n\n<p>Removed the <code>colonStmt</code> pattern from <code>statement</code> parser and the other parts worked appropriately:</p>\n\n<pre><code>&gt; parseString \"if (1 == 1) then skip else skip\"\n&lt; IfCond (BinOp Eq (Num 1) (Num 1)) Skip Skip\n&gt; parseString \"x := 1\"\n&lt; Assign (Var \"x\") (Num 1)\n</code></pre>\n\n<hr>\n\n<p>The solution is fully described in <a href=\"https://github.com/budabudimir/imp_interpreter/blob/master/IMP_Parser.hs\" rel=\"nofollow\">this repo</a>, there's no license file so I don't really know if it's safe to refer to the code, the general idea is to add another layer of parser when parsing any statement:</p>\n\n<pre><code>statement :: Parser Stmt\nstatement = do\n    ss &lt;- sepBy1 statement' (reserved \";\")\n    if length ss == 1\n        then return $ head ss\n        else return $ foldr1 Colon ss\n\nstatement' :: Parser Stmt\nstatement' = assignStmt\n            &lt;|&gt; writeStmt\n            &lt;|&gt; readStmt\n            &lt;|&gt; whileStmt\n            &lt;|&gt; ifStmt\n            &lt;|&gt; skipStmt\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 2302260, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8f97ff66bdfe5674beb4b843bdea852d?s=128&d=identicon&r=PG", "display_name": "EdZhavoronkov", "link": "https://stackoverflow.com/users/2302260/edzhavoronkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 0, "accepted_answer_id": 36529035, "answer_count": 1, "score": 0, "last_activity_date": 1460291426, "creation_date": 1460278125, "question_id": 36527728, "link": "https://stackoverflow.com/questions/36527728/how-to-parse-simple-imperative-language-using-parsec", "title": "How to parse simple imperative language using Parsec?", "body": "<p>I have a simple language with following grammar</p>\n\n<pre><code>Expr -&gt; Var | Int | Expr Op Expr  \nOp -&gt; + | - | * | / | % | == | != | &lt; | &gt; | &lt;= | &gt;= | &amp;&amp; | ||  \nStmt -&gt; Skip | Var := Expr | Stmt ; Stmt | write Expr | read Expr | while Expr do Stmt | if Expr then Stmt else Stmt\n</code></pre>\n\n<p>I am writing simple parser for this language using Haskell's Parsec library and i am stuck with some things</p>\n\n<p>When i try to parse statement <code>skip ; skip</code> i get only first <code>Skip</code>, however i want go get something like <code>Colon Skip Skip</code></p>\n\n<p>Also when i try to parse the assignment, i get an infinite recursion. For example, when i try to parse <code>x := 1</code> my computer hangs up for long time.</p>\n\n<p>Here is full source code of my parser. Thanks for any help!</p>\n\n<pre><code>module Parser where\n\n\nimport Control.Monad\nimport Text.Parsec.Language\nimport Text.ParserCombinators.Parsec\nimport Text.ParserCombinators.Parsec.Expr\nimport Text.ParserCombinators.Parsec.Language\nimport qualified Text.ParserCombinators.Parsec.Token as Token\n\ntype Id = String\n\ndata Op = Add\n        | Sub\n        | Mul\n        | Div\n        | Mod\n        | Eq\n        | Neq\n        | Gt\n        | Geq\n        | Lt\n        | Leq\n        | And\n        | Or deriving (Eq, Show)\n\ndata Expr = Var Id\n          | Num Integer\n          | BinOp Op Expr Expr deriving (Eq, Show)\n\ndata Stmt = Skip\n          | Assign Expr Expr\n          | Colon Stmt Stmt\n          | Write Expr\n          | Read Expr\n          | WhileLoop Expr Stmt\n          | IfCond Expr Stmt Stmt deriving (Eq, Show)\n\nlanguageDef =\n     emptyDef    { Token.commentStart    = \"\"\n                 , Token.commentEnd      = \"\"\n                 , Token.commentLine     = \"\"\n                 , Token.nestedComments  = False\n                 , Token.caseSensitive   = True\n                 , Token.identStart      = letter\n                 , Token.identLetter     = alphaNum\n                 , Token.reservedNames   = [ \"skip\"\n                                           , \";\"\n                                           , \"write\"\n                                           , \"read\"\n                                           , \"while\"\n                                           , \"do\"\n                                           , \"if\"\n                                           , \"then\"\n                                           , \"else\"\n                                           ]\n                 , Token.reservedOpNames = [ \"+\"\n                                           , \"-\"\n                                           , \"*\"\n                                           , \"/\"\n                                           , \":=\"\n                                           , \"%\"\n                                           , \"==\"\n                                           , \"!=\"\n                                           , \"&gt;\"\n                                           , \"&gt;=\"\n                                           , \"&lt;\"\n                                           , \"&lt;=\"\n                                           , \"&amp;&amp;\"\n                                           , \"||\"\n                                           ]\n                }\n\nlexer = Token.makeTokenParser languageDef\n\nidentifier = Token.identifier lexer\nreserved   = Token.reserved   lexer\nreservedOp = Token.reservedOp lexer\nsemi       = Token.semi       lexer\nparens     = Token.parens     lexer\ninteger    = Token.integer    lexer\nwhiteSpace = Token.whiteSpace lexer\n\nifStmt :: Parser Stmt\nifStmt = do\n    reserved \"if\"\n    cond &lt;- expression\n    reserved \"then\"\n    action1 &lt;- statement\n    reserved \"else\"\n    action2 &lt;- statement\n    return $ IfCond cond action1 action2\n\nwhileStmt :: Parser Stmt\nwhileStmt = do\n    reserved \"while\"\n    cond &lt;- expression\n    reserved \"do\"\n    action &lt;- statement\n    return $ WhileLoop cond action\n\nassignStmt :: Parser Stmt\nassignStmt = do\n    var &lt;- expression\n    reservedOp \":=\"\n    expr &lt;- expression\n    return $ Assign var expr\n\nskipStmt :: Parser Stmt\nskipStmt = do\n    reserved \"skip\"\n    return Skip\n\ncolonStmt :: Parser Stmt\ncolonStmt = do\n    s1 &lt;- statement\n    reserved \";\"\n    s2 &lt;- statement\n    return $ Colon s1 s2\n\nreadStmt :: Parser Stmt\nreadStmt = do\n    reserved \"read\"\n    e &lt;- expression\n    return $ Read e\n\nwriteStmt :: Parser Stmt\nwriteStmt = do\n    reserved \"write\"\n    e &lt;- expression\n    return $ Write e\n\nstatement :: Parser Stmt\nstatement = colonStmt\n            &lt;|&gt; assignStmt\n            &lt;|&gt; writeStmt\n            &lt;|&gt; readStmt\n            &lt;|&gt; whileStmt\n            &lt;|&gt; ifStmt\n            &lt;|&gt; skipStmt\n\nexpression :: Parser Expr\nexpression = buildExpressionParser operators term\n\nterm = fmap Var identifier\n        &lt;|&gt; fmap Num integer\n        &lt;|&gt; parens expression\n\noperators = [ [Infix (reservedOp \"==\" &gt;&gt; return (BinOp Eq)) AssocNone,\n              Infix (reservedOp \"!=\" &gt;&gt; return (BinOp Neq)) AssocNone,\n              Infix (reservedOp \"&gt;\"  &gt;&gt; return (BinOp Gt)) AssocNone,\n              Infix (reservedOp \"&gt;=\" &gt;&gt; return (BinOp Geq)) AssocNone,\n              Infix (reservedOp \"&lt;\"  &gt;&gt; return (BinOp Lt)) AssocNone,\n              Infix (reservedOp \"&lt;=\" &gt;&gt; return (BinOp Leq)) AssocNone,\n              Infix (reservedOp \"&amp;&amp;\" &gt;&gt; return (BinOp And)) AssocNone,\n              Infix (reservedOp \"||\" &gt;&gt; return (BinOp Or)) AssocNone]\n\n            , [Infix (reservedOp \"*\"  &gt;&gt; return (BinOp Mul)) AssocLeft,\n              Infix (reservedOp \"/\"  &gt;&gt; return (BinOp Div)) AssocLeft,\n              Infix (reservedOp \"%\"  &gt;&gt; return (BinOp Mod)) AssocLeft]\n\n            , [Infix (reservedOp \"+\"  &gt;&gt; return (BinOp Add)) AssocLeft,\n               Infix (reservedOp \"-\"  &gt;&gt; return (BinOp Sub)) AssocLeft]\n            ]\n\nparser :: Parser Stmt\nparser = whiteSpace &gt;&gt; statement\n\nparseString :: String -&gt; Stmt\nparseString str =\n    case parse parser \"\" str of\n        Left e -&gt; error $ show e\n        Right r -&gt; r`\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack", "hsdev"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460272908, "post_id": 36526978, "comment_id": 60658228, "body": "have you tried the <b>recommended action</b>? (just edit the file and add those - then retry)"}, {"owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460273170, "post_id": 36526978, "comment_id": 60658286, "body": "Question updated with <code>stack solver</code> output"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460273496, "post_id": 36526978, "comment_id": 60658365, "body": "see <a href=\"http://docs.haskellstack.org/en/stable/GUIDE/#adding-dependencies\" rel=\"nofollow noreferrer\">here</a> please (look for the <code>acme-missle</code> example - your problem seems to be exactly that) - also did you add the <code>extra-deps</code> for your update or not?"}, {"owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460281254, "post_id": 36526978, "comment_id": 60660455, "body": "I did a <code>cabal install hsdev</code> and it installed ok. Will try with stack now."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1460282639, "post_id": 36526978, "comment_id": 60660826, "body": "Please include your stack.yaml, and if you are using cabal better use sandboxes otherwise you can run into problems in the near (or far) future"}, {"owner": {"reputation": 14821, "user_id": 60620, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/a4c50597f47ad4cb6e6d945500e7eea9?s=128&d=identicon&r=PG", "display_name": "dan-gph", "link": "https://stackoverflow.com/users/60620/dan-gph"}, "edited": false, "score": 2, "creation_date": 1461646710, "post_id": 36526978, "comment_id": 61279451, "body": "I came here looking for why <code>cabal install hsdev</code> wouldn&#39;t install on my machine, which is a different issue, but I figured it out, so I thought I would mention the solution here. The error was &quot;ExitFailure 1&quot;, scrolling up, there was a &quot;permission denied&quot;. The solution was to kill ghc, ghci, and hsdev via Task Manager, and then try again."}], "answers": [{"comments": [{"owner": {"reputation": 9946, "user_id": 467754, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/3rEtR.png?s=128&g=1", "display_name": "Nikos Baxevanis", "link": "https://stackoverflow.com/users/467754/nikos-baxevanis"}, "edited": false, "score": 0, "creation_date": 1479281897, "post_id": 36528910, "comment_id": 68486267, "body": "Works like a charm. Thank you!"}], "tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 12, "last_activity_date": 1460286305, "creation_date": 1460286305, "answer_id": 36528910, "question_id": 36526978, "link": "https://stackoverflow.com/questions/36526978/failure-to-install-hsev-on-windows-10-via-stack-install-hsdev/36528910#36528910", "title": "Failure to install hsev on Windows 10 via `stack install hsdev`", "body": "<p>I got <code>hsdev</code> installed on my windows machine by the following steps.</p>\n\n<ol>\n<li>Run <code>stack unpack hsdev</code> to download the source of hsdev to the working directory.</li>\n<li>Move into the directory, run <code>stack init --solver</code> to create a proper <code>stack.yaml</code> build config.</li>\n<li>Run <code>stack install</code> to build and copy the executables to your local bin directory. If stack reports an error about a missing LICENSE file create an empty <code>LICENSE</code> file under <code>./tests/test-package</code>.</li>\n</ol>\n"}], "owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2122, "favorite_count": 3, "accepted_answer_id": 36528910, "answer_count": 1, "score": 4, "last_activity_date": 1460286305, "creation_date": 1460272487, "last_edit_date": 1460273151, "question_id": 36526978, "link": "https://stackoverflow.com/questions/36526978/failure-to-install-hsev-on-windows-10-via-stack-install-hsdev", "title": "Failure to install hsev on Windows 10 via `stack install hsdev`", "body": "<p>I get this error when running <code>stack install hsdev</code> outside and inside of a project:</p>\n\n<pre><code>\u03bb stack install hsdev\nRun from outside a project, using implicit global project config\nUsing resolver: lts-5.11 from implicit global project's config file: C:\\Users\\atc\\AppData\\Roaming\\stack\\global-project\\stack.yaml\nWhile constructing the BuildPlan the following exceptions were encountered:\n\n--  While attempting to add dependency,\n    Could not find package hformat in known packages\n\n--  Failure when adding dependencies:\n      hformat: needed (&gt;=0.1), stack configuration has no specified version (latest applicable is 0.1.0.0)\n      simple-log: needed (&gt;=0.3.4), stack configuration has no specified version (latest applicable is 0.3.4)\n      text-region: needed (&gt;=0.1), stack configuration has no specified version (latest applicable is 0.1.0.0)\n    needed for package hsdev-0.1.8.2\n\n--  While attempting to add dependency,\n    Could not find package simple-log in known packages\n\n--  While attempting to add dependency,\n    Could not find package text-region in known packages\n\nRecommended action: try adding the following to your extra-deps in C:\\Users\\atc\\AppData\\Roaming\\stack\\global-project\\stack.yaml\n- hformat-0.1.0.0\n- simple-log-0.3.4\n- text-region-0.1.0.0\n</code></pre>\n\n<p>I have run <code>stack update</code> prior to attempting this. I want to install <code>hsdev</code> so I can use <a href=\"https://github.com/SublimeHaskell/SublimeHaskell\" rel=\"nofollow\">SublimeHaskell</a>.</p>\n\n<p><code>stack solver</code> gives:</p>\n\n<pre><code>\u03bb stack solver\nRun from outside a project, using implicit global project config\nUsing resolver: lts-5.11 from implicit global project's config file: C:\\Users\\atc\\AppData\\Roaming\\stack\\global-project\\stack.yaml\nUsing configuration file: AppData\\Roaming\\stack\\global-project\\stack.yaml\nThe following packages are missing from the config:\n\n&lt;snip long list of references to directories in AppData\\Local\\Temp\\stack14228\\&gt;\n\nNo cabal packages found in AppData\\Roaming\\stack\\global-project\\stack.yaml. Please add at least one directory containing a .cabal file. You can also use 'stack init' to automatically generate the config file.\n</code></pre>\n\n<p>Relevant stack info:</p>\n\n<pre><code>\u03bb stack --version\nVersion 1.0.4, Git revision cf18703b1392a96a5a4896a560309e501af63260 (3220 commits) x86_6\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1460268111, "post_id": 36526364, "comment_id": 60657156, "body": "What is the question? Does this code work? If so, what do you want to do differently?"}, {"owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1460268270, "post_id": 36526364, "comment_id": 60657181, "body": "This code works for equality checks like &#39;getEngineerId -&gt; 13&#39;. My question is Can I do the same thing for &gt;, &lt;, &gt;=, &lt;= checks.                                    For example, when i tried &quot;isSpecialEngineer (getEngineerId &lt; 50) = True&quot;, it throws me error"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "edited": false, "score": 0, "creation_date": 1460273628, "post_id": 36526425, "comment_id": 60658388, "body": "@HariKrishna Indeed, the first variant will crash the program if the <code>Employee</code> is not an <code>Engineer</code>. The second instead will just fail and allow the next pattern matching case to be attempted. I would avoid defining partial (i.e. potentially crashing) functions like <code>getEngineerId</code>: if you enable warnings with <code>-Wall</code> GHC will help you to notice those potential errors."}], "tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": true, "score": 5, "last_activity_date": 1460268537, "last_edit_date": 1460268537, "creation_date": 1460268200, "answer_id": 36526425, "question_id": 36526364, "link": "https://stackoverflow.com/questions/36526364/haskell-can-apply-view-pattern-on-conditional-operators/36526425#36526425", "title": "Haskell: Can apply view pattern on conditional operators", "body": "<p>This works</p>\n\n<pre><code>isSpecialEngineer (getEngineerId -&gt; x) | x &lt; 50 = True\n</code></pre>\n\n<p>although, you will have to complete your getEngineerId function to return values for every type of employee.  Note that you can just pattern match on Engineer using old fashioned patterns also, and do this more safely</p>\n\n<pre><code>isSpecialEngineer (Engineer _ x) | x &lt; 50 = True\n</code></pre>\n"}], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 36526425, "answer_count": 1, "score": 1, "last_activity_date": 1460268537, "creation_date": 1460267663, "question_id": 36526364, "link": "https://stackoverflow.com/questions/36526364/haskell-can-apply-view-pattern-on-conditional-operators", "title": "Haskell: Can apply view pattern on conditional operators", "body": "<p>Following is my sample code. An Engineer is said to be special, if his name is \u201cHari\u201d (or) id is 13. I did this by using View Patterns. Can I apply view patterns on conditional operators ? </p>\n\n<p><strong>Example</strong>\nAn Engineer is said to be special if his id is &lt; 50. </p>\n\n<pre><code>{-# LANGUAGE ViewPatterns #-}\n\nmodule ABC where\n    type Name = String\n    type NoOfReportees = Integer\n    type EngineerId = Integer\n    type ManagerId = Integer\n    type DirectorId = Integer\n\n    {- Define an employee type -}\n    data Employee = Engineer Name EngineerId\n               | Manager Name [EngineerId] ManagerId\n               | Director Name [ManagerId] DirectorId\n               deriving Show\n\n    getEngineerFirstName :: Employee -&gt; Name\n    getEngineerFirstName (Engineer name _) = name\n\n    getEngineerId :: Employee -&gt; EngineerId\n    getEngineerId (Engineer _ empId) = empId\n\n    isSpecialEngineer :: Employee -&gt; Bool\n    isSpecialEngineer (getEngineerFirstName -&gt; \"Hari\") = True\n    isSpecialEngineer (getEngineerId -&gt; 13) = True\n    isSpecialEngineer _ = False\n</code></pre>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1460244483, "post_id": 36523649, "comment_id": 60652635, "body": "<code>Num</code> implies <code>Eq</code>: <code>class  (Eq a, Show a) =&gt; Num a</code>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1460245797, "post_id": 36523649, "comment_id": 60652931, "body": "The constraints <code>Eq a, Show a</code> for <code>Num a</code> have been dropped since <code>base-4.5</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1460246072, "post_id": 36523649, "comment_id": 60652984, "body": "<code>UndecidableInstances</code> is fairly harmless. The worst it could happen is that you create a set of instances which get stuck in an infinite loop. Even in this case, as long as the compiler terminates its job, your program will be OK at runtime."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1460249213, "post_id": 36523649, "comment_id": 60653562, "body": "You say &quot;<code>Num</code> has a larger number of constructors [presumably you mean &quot;instances&quot; instead of &quot;constructors&quot;] than the<code>YesNo</code> class and hence the error&quot;. But this is not a correct characterization of the error -- it is not that the <i>number of instances</i> for <code>Num</code> is larger, it is that <i>the type in the instance you are looking for</i> is not structurally smaller, hence it is not clear that instance search will terminate from syntactic arguments alone."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1460255068, "post_id": 36524330, "comment_id": 60654782, "body": "Actually, <code>FlexibleInstances</code> can be worse than <code>UndecidableInstances</code>! Flexible instances don&#39;t always reduce as readily as one might wish."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1460283025, "post_id": 36524330, "comment_id": 60660919, "body": "Ok... example / link?"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1460248297, "last_edit_date": 1460248297, "creation_date": 1460247836, "answer_id": 36524330, "question_id": 36523649, "link": "https://stackoverflow.com/questions/36523649/how-to-extend-a-haskell-type-instance/36524330#36524330", "title": "How to extend a Haskell type instance?", "body": "<p>As chi already remarked, <code>-XUndecidableInstances</code> is not that much of a problem &ndash; alright, it's more intrusive than, say, <code>-XFlexibleInstances</code>; you should think for a moment whenever this is needed &ndash; but it's perfectly <em>safe</em>. It will never succeed in compiling code that doesn't work the intended way.</p>\n\n<p>That said, to achieve the goal of allowing <code>yesno 0</code> to work on its own, <code>instance (Num a) -&gt; YesNo a</code> is <em>not</em> the right thing. With that instance in place, it will still be totally ambiguous what concrete type the number <code>0</code> is supposed to have (<code>Num a =&gt; a</code> is <em>not</em> a concrete type). Hence the compiler must jump in with <em>defaulting</em> and, well, the default <code>Num</code> type is <code>Integer</code>. Hence, to get this working it's completely sufficient to declare that instance:</p>\n\n<pre><code>instance YesNo Integer where\n   yesno = (/=0)\n</code></pre>\n\n<p>Alternatively, if you prefer the calculation to be <em>always</em> done in <code>Int</code>, you can achieve that with an equational constraint:</p>\n\n<pre><code>instance (a ~ Int) =&gt; YesNo a where\n   yesno = (/=0)\n</code></pre>\n\n<p>This one does require <code>-XUndecidableInstances</code> though (plus the totally harmless <code>-XFlexibleInstances</code> and either of <code>-XGADTs</code> or <code>-XTypeFamilies</code>, to enable the equational constraint).</p>\n\n<p>None of this makes much sense <em>anyway</em>: the point of a type class is to make instances for types whose implementation looks <em>different</em>. If you restrict this to number types, which is what you do with these instances, then you might as well stay away from type classes entirely and just define</p>\n\n<pre><code>yesno :: (Num n, Eq n) =&gt; n -&gt; Bool\nyesno = (/=0)\n</code></pre>\n\n<p>In that sense: undecidable instances are a bit of a <em>code smell</em>; before writing one make sure you actually <em>need a class</em> at all!</p>\n"}], "owner": {"reputation": 2396, "user_id": 3669252, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tPykj.jpg?s=128&g=1", "display_name": "aa333", "link": "https://stackoverflow.com/users/3669252/aa333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 284, "favorite_count": 0, "accepted_answer_id": 36524330, "answer_count": 1, "score": 2, "last_activity_date": 1460248297, "creation_date": 1460242070, "last_edit_date": 1460242517, "question_id": 36523649, "link": "https://stackoverflow.com/questions/36523649/how-to-extend-a-haskell-type-instance", "title": "How to extend a Haskell type instance?", "body": "<p><a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#a-yes-no-typeclass\" rel=\"nofollow\">This</a> excellent tutorial, defines a <code>YesNo</code> typeclass and a <code>YesNo Int</code> instance as following:</p>\n\n<pre><code>class YesNo a where\n   yesno :: a -&gt; Bool\n\ninstance YesNo Int where\n   yesno 0 = False\n   yesno _ = True\n</code></pre>\n\n<p>This works fine with an explicit type declaration like:</p>\n\n<pre><code>*Main&gt; yesno (0::Int)\nFalse\n</code></pre>\n\n<p>I want to avoid the explicit type declaration and make it work with <code>Num a</code> class constraint:</p>\n\n<pre><code>instance (Num a) =&gt; YesNo a where\n   yesno 0 = False\n   yesno _ = True\n</code></pre>\n\n<p>But this instance definition does not compile with the error:\n<code>Constraint is no smaller than the instance head</code></p>\n\n<p>I understand that <code>Num</code> has a larger number of constructors than the <code>YesNo</code> class and hence the error. But how do I fix this without setting the <code>UndecidableInstances</code> compiler flag?</p>\n"}, {"tags": ["haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "is_accepted": false, "score": 3, "last_activity_date": 1460277500, "last_edit_date": 1460277500, "creation_date": 1460241644, "answer_id": 36523578, "question_id": 36523563, "link": "https://stackoverflow.com/questions/36523563/haskell-simple-function-definition/36523578#36523578", "title": "Haskell Simple Function Definition", "body": "<p>Your type should be</p>\n\n<pre><code>add2 :: Int -&gt; Int -&gt; Int\n</code></pre>\n\n<p>Adding the parentheses will show you what this type actually means.</p>\n\n<pre><code>add2 :: Int -&gt; (Int -&gt; Int)\n</code></pre>\n\n<p>So, add2 is a function that takes an int, and returns another function (type <code>Int -&gt; Int</code>).  You use this as follows</p>\n\n<pre><code>add2 1 -- this returns a function, type Int -&gt; Int\n</code></pre>\n\n<p>or, add the second parameter to get the final <code>Int</code> out</p>\n\n<pre><code>(add2 1) 2 --same as \"add2 1 2\", returns an Int value 1+2=3\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 2526001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b40226907e5dbdd4b0a8b94d59e374c?s=128&d=identicon&r=PG", "display_name": "Sergei Iashin", "link": "https://stackoverflow.com/users/2526001/sergei-iashin"}, "is_accepted": false, "score": 1, "last_activity_date": 1460242135, "creation_date": 1460242135, "answer_id": 36523664, "question_id": 36523563, "link": "https://stackoverflow.com/questions/36523563/haskell-simple-function-definition/36523664#36523664", "title": "Haskell Simple Function Definition", "body": "<p>Also you can use <strong>curry</strong> (<a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:curry\" rel=\"nofollow\">http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:curry</a>):</p>\n\n<pre><code>add2 :: Int -&gt; Int -&gt; Int\nadd2 = curry add1\n\n&gt; add1 (1,2)\n3\n&gt; add2 1 2\n3\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 6048440, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/43b99784b7b48ffbb5159451ac9c5f78?s=128&d=identicon&r=PG&f=1", "display_name": "mk4280", "link": "https://stackoverflow.com/users/6048440/mk4280"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1460277500, "creation_date": 1460241549, "question_id": 36523563, "link": "https://stackoverflow.com/questions/36523563/haskell-simple-function-definition", "title": "Haskell Simple Function Definition", "body": "<p>I started learning Haskell a few days ago, and I am now learning function types.</p>\n\n<p>Using tuples, below code works.</p>\n\n<pre><code>add1 :: (Int,Int) -&gt; Int\nadd1(x,y) = x + y\n</code></pre>\n\n<p>But what if I want to do the same function without using tuples?</p>\n\n<p>I've tried both function definitions</p>\n\n<pre><code>add2 :: Int, Int -&gt; Int\nadd2 :: Int Int -&gt; Int\n</code></pre>\n\n<p>with</p>\n\n<pre><code>add2 a b = a + b\n</code></pre>\n\n<p>But those two function definitions do not compile. What am I doing wrong?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460241186, "post_id": 36523461, "comment_id": 60651800, "body": "Why do you think you need to write <code>MyList a</code> in the <code>Cons</code>-pattern matching?"}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 2526001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b40226907e5dbdd4b0a8b94d59e374c?s=128&d=identicon&r=PG", "display_name": "Sergei Iashin", "link": "https://stackoverflow.com/users/2526001/sergei-iashin"}, "is_accepted": false, "score": 0, "last_activity_date": 1460241160, "creation_date": 1460241160, "answer_id": 36523518, "question_id": 36523461, "link": "https://stackoverflow.com/questions/36523461/haskell-beginner-defining-and-using-a-type/36523518#36523518", "title": "Haskell beginner - defining and using a type", "body": "<pre><code>  mylen :: MyList a -&gt; Int\n  mylen Nil = 0\n  mylen (Cons _ next) = 1 + mylen next\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1460242092, "post_id": 36523529, "comment_id": 60652029, "body": "BTW, wouldn&#39;t it be nice to match Cons first, and then only write <code>mylen _ = 0</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1460249756, "post_id": 36523529, "comment_id": 60653666, "body": "@bipll While that is marginally shorter code, it does throw away the ability to get a warning from the compiler to update the definition of <code>mylen</code> when the definition of <code>MyList</code> changes in the future."}], "tags": [], "owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "is_accepted": true, "score": 5, "last_activity_date": 1460241639, "last_edit_date": 1460241639, "creation_date": 1460241251, "answer_id": 36523529, "question_id": 36523461, "link": "https://stackoverflow.com/questions/36523461/haskell-beginner-defining-and-using-a-type/36523529#36523529", "title": "Haskell beginner - defining and using a type", "body": "<p>Your (reasonable) definition of <code>MyList</code>:</p>\n\n<pre><code>data MyList a = Nil | Cons a (MyList a)\n</code></pre>\n\n<p>...states that there are two constructors.</p>\n\n<ol>\n<li><code>Nil</code> (taking no arguments), and</li>\n<li><code>Cons</code>, which takes two arguments: the first of type <code>a</code>, the second of type <code>MyList a</code></li>\n</ol>\n\n<p>So to pattern match, you have to write something like <code>Cons item rest</code>, e.g.</p>\n\n<pre><code>mylen :: (MyList a) -&gt; Int\nmylen Nil = 0\nmylen (Cons item rest) = 1 + mylen rest\n</code></pre>\n\n<p>But since you never use <code>item</code>, it is customary to replace it with <code>_</code>.</p>\n\n<p>Notice how <code>a</code>, <code>Int</code> and <code>MyList a</code> are types. On the other hand, <code>item</code>, <code>0</code> and <code>1</code>, <code>rest</code>, and even <code>Nil</code> and <code>Cons item rest</code> are all instances of those types.</p>\n"}], "owner": {"reputation": 23, "user_id": 5890402, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MB820.png?s=128&g=1", "display_name": "martagnan", "link": "https://stackoverflow.com/users/5890402/martagnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 36523529, "answer_count": 2, "score": 0, "last_activity_date": 1460241639, "creation_date": 1460240819, "last_edit_date": 1460241062, "question_id": 36523461, "link": "https://stackoverflow.com/questions/36523461/haskell-beginner-defining-and-using-a-type", "title": "Haskell beginner - defining and using a type", "body": "<p>I am trying to do the equivalent of this correctly working code : </p>\n\n<pre><code>len   :: [a] -&gt; Int \nlen [] = 0 \nlen (x:xs) = 1 + len xs \n</code></pre>\n\n<p>But for the type MyList that I am defining as :</p>\n\n<pre><code>data MyList a = Nil | Cons a (MyList a)\n</code></pre>\n\n<p>Here is my attempt : </p>\n\n<pre><code>mylen :: (MyList a) -&gt; Int\nmylen Nil = 0\nmylen (Cons a (MyList a)) = 1 + mylen (MyList a)\n</code></pre>\n\n<p>But I get these errors: </p>\n\n<blockquote>\n  <p>Conflicting definitions for \u2018a\u2019\n  <br>Not in scope: data constructor \u2018MyList\u2019</p>\n</blockquote>\n\n<p>I can't figure out how to get it to work. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "edited": false, "score": 1, "creation_date": 1460239532, "post_id": 36523274, "comment_id": 60651320, "body": "have you tried looking it up on hoogle?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1460240549, "post_id": 36523274, "comment_id": 60651604, "body": "using <code>ghci</code> you can always check on functions by typing <code>:t</code> or <code>:type</code>, e.g. <code>ghci &gt; :t function</code>, note operators have to be wrapped in parens like this <code>ghci &gt; :t (++)</code>. For a bit more information you can use <code>:i</code> or <code>:info</code>, e.g. <code>ghci &gt; :info (++)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": true, "score": 4, "last_activity_date": 1460240003, "last_edit_date": 1460240003, "creation_date": 1460239560, "answer_id": 36523293, "question_id": 36523274, "link": "https://stackoverflow.com/questions/36523274/haskell-what-does-do/36523293#36523293", "title": "Haskell what does ++ do", "body": "<p>It's list concatenation.</p>\n\n<pre><code>(++) :: [a] -&gt; [a] -&gt; [a]\n[1, 2, 3] ++ [4, 5, 6] == [1, 2, 3, 4, 5, 6]\n</code></pre>\n\n<p>See <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch9.html#x16-1720009.1\" rel=\"nofollow\">https://www.haskell.org/onlinereport/haskell2010/haskellch9.html#x16-1720009.1</a></p>\n"}], "owner": {"reputation": 33, "user_id": 2444784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2d029fa10a0b8e15019a435d0f98e5d9?s=128&d=identicon&r=PG", "display_name": "user2444784", "link": "https://stackoverflow.com/users/2444784/user2444784"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 36523293, "answer_count": 1, "score": -2, "last_activity_date": 1460245208, "creation_date": 1460239430, "last_edit_date": 1460245208, "question_id": 36523274, "link": "https://stackoverflow.com/questions/36523274/haskell-what-does-do", "title": "Haskell what does ++ do", "body": "<p>What does \"++\" do? I tried looking it up, but couldn't find anything.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 6, "creation_date": 1460236106, "post_id": 36522521, "comment_id": 60650251, "body": "Instead of doing <code>Just (fromJust foo + fromJust bar)</code>, try <code>(+) &lt;$&gt; foo &lt;*&gt; bar</code>. Using the applicative here avoids the unsafe usage of <code>fromJust</code>, which throws the exception you&#39;re seeing when it encounters a <code>Nothing</code>. Whereas <code>(+) &lt;$&gt; foo &lt;*&gt; bar</code> correctly evaluates to <code>Nothing</code> when either foo or bar is <code>Nothing</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1460236924, "post_id": 36522521, "comment_id": 60650516, "body": "Thanks, Is there exists way without Applicative ? Applicative seems be very hard"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 4, "creation_date": 1460237185, "post_id": 36522521, "comment_id": 60650607, "body": "I agree <code>Applicative</code> may seem a bit complicated at first - but give it a week of real usage and you probably find it quite agreeable (and it is definitely worth learning)."}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 3, "last_activity_date": 1460238814, "creation_date": 1460238814, "answer_id": 36523177, "question_id": 36522521, "link": "https://stackoverflow.com/questions/36522521/haskell-simple-evaluator-of-expressions-with-monad-reader/36523177#36523177", "title": "Haskell, simple evaluator of expressions with monad Reader", "body": "<p>Firstly, the way to work with monadic computations is not to \"run\" the computation every time you encounter a value wrapped in the monad (in this case <code>Reader ..</code>). You should be using the <code>&gt;&gt;=</code> operator. Furthermore, you are trying to combine two monadic effects: <code>Reader</code> and <code>Maybe</code>. The \"standard\" way to do this is with a monad transformer, but luckily for you <code>Reader</code> (or more precisely <code>ReaderT</code>) is itself a monad transformer.</p>\n\n<p>Furthermore, you would benefit from some abstraction, i.e. :</p>\n\n<pre><code>import Control.Monad.Reader \nimport qualified Data.Map as M \n\ntype Env = M.Map String Int \n\ntype EvalM = ReaderT (M.Map String Int) Maybe\n\nlookupEnv :: String -&gt; EvalM Int \nlookupEnv x = ask &gt;&gt;= lift . M.lookup x\n\nwithBind :: String -&gt; Int -&gt; EvalM a -&gt; EvalM a \nwithBind x v = local (M.insert x v) \n</code></pre>\n\n<p>These functions define an interface to working with environments in which lookup can fail. You should write these functions once as opposed to inlining their definitions when you need them. Now the base cases of your function are trivial:</p>\n\n<pre><code>evalExpM :: Exp -&gt; EvalM Int \nevalExpM (EInt n) = return n \nevalExpM (EVar v) = lookupEnv v \n</code></pre>\n\n<p>Many people (including probably myself) would use applicative operators for the recursive cases, but you can avoid the soup of symbols:</p>\n\n<pre><code>evalExpM (EOp op e1 e2) = liftM2 \n  (case op of \n    OpAdd -&gt; (+) \n    OpMul -&gt; (-) \n    OpSub -&gt; (-)\n  ) (evalExpM e1) (evalExpM e2) \nevalExpM (ELet var e1 e2) = evalExpM e1 &gt;&gt;= \\e -&gt; withBind var e $ evalExpM e2\n</code></pre>\n\n<p>Running it is the same as before - just change <code>runReader</code> to <code>runReaderT</code> - but now you only ever run a computation when you are really done with the context.</p>\n\n<pre><code>evalExp :: Exp -&gt; Int\nevalExp e = maybe (error \"evalExp\") id $ runReaderT (evalExpM e) M.empty \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4798, "user_id": 460175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dUcwY.png?s=128&g=1", "display_name": "comonad", "link": "https://stackoverflow.com/users/460175/comonad"}, "is_accepted": false, "score": 2, "last_activity_date": 1460243413, "last_edit_date": 1460243413, "creation_date": 1460243082, "answer_id": 36523781, "question_id": 36522521, "link": "https://stackoverflow.com/questions/36522521/haskell-simple-evaluator-of-expressions-with-monad-reader/36523781#36523781", "title": "Haskell, simple evaluator of expressions with monad Reader", "body": "<p>what you intend is to use the Monad <code>Maybe</code>, which automatically passes the <code>Nothing</code> down so that you do not need to handle that manually.</p>\n\n<p>so, you could use the type <code>(ReaderT r Maybe)(a)</code> instead of <code>(Reader r)(Maybe a)</code>.</p>\n\n<p>but i guess you eventually want to simplify this to <code>r -&gt; Maybe a</code>.</p>\n\n<hr>\n\n<p>anyway, you are using Monad <code>Reader r</code> which is only a fancy way of supplying a parameter.\nbecause <code>r-&gt;a</code> is only syntactic sugar for <code>(-&gt;) r a</code> and <code>(-&gt;) r</code> is already a Reader Monad, you can use that instead: you could even replace <code>ask</code> with <code>id</code>.</p>\n\n<p>you probably do not want to use the silly <code>ask</code> function all the time, so you could use <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Reader.html#t:reader\" rel=\"nofollow\"><code>reader</code></a> to simply lift the function.</p>\n\n<pre><code>evalExpM :: Exp -&gt; Reader (Map.Map String Int) (Maybe Int)\nevalExpM (EVar var) = ask &gt;&gt;= (\\x -&gt; lift ( Map.lookup var x))\nevalExpM (EVar var) = reader $ \\x -&gt; Map.lookup var x\nevalExpM (EVar var) = reader $ Map.lookup var\n</code></pre>\n\n<p>it is more convenient to use <code>Reader</code> (or <code>ReaderT</code>) only when you want to automatically pass the param to inner functions. but even then you can just use the Monad <code>(-&gt;) r</code> or simply pass a parameter. you get a better feeling for this if you always use the Monad <code>(-&gt;) r</code> and <code>id</code> instead of <code>Reader r</code> and <code>ask</code>. for <code>ReaderT</code> on the other hand, you will see its need when you have to pass one param to most functions you use in <code>do</code> notation.</p>\n\n<pre><code>evalExp :: Exp -&gt; Map.Map String Int -&gt; Maybe Int\n\nevalExp (EOp OpSub e1 e2) = ask &gt;&gt;= (\\x -&gt; return (Just ((fromJust ({-runReader-} (evalExp e1) x)) - (fromJust ({-runReader-} (evalExp e2) x )))))\n\nevalExp (EOp OpSub e1 e2) = do -- Monad ((-&gt;) (Map.Map String Int))\n  x &lt;- id -- hehe, same as ask\n  return (Just ((fromJust ({-runReader-} (evalExp e1) x)) - (fromJust ({-runReader-} (evalExp e2) x ))))\n\nevalExp (EOp OpSub e1 e2) x = -- directly with param x\n  (Just ((fromJust ((evalExp e1) x)) - (fromJust ((evalExp e2) x ))))\n\nevalExp (EOp OpSub e1 e2) x = do -- Monad (Maybe)\n  let a = fromJust ((evalExp e1) x)\n  let b = fromJust ((evalExp e2) x)\n  Just $ a - b\n\nevalExp (EOp OpSub e1 e2) x = do -- Monad (Maybe)\n  a &lt;- return $ fromJust ((evalExp e1) x)\n  b &lt;- return $ fromJust ((evalExp e2) x)\n  Just $ a - b\n\n-- and without that bug:\nevalExp (EOp OpSub e1 e2) x = do -- because return=Just\n  a &lt;- evalExp e1 x\n  b &lt;- evalExp e2 x\n  return $ a - b\n\nevalExp (EOp OpSub e1 e2) = runReaderT $ do -- Monad (ReaderT (Map...) Maybe)\n  a &lt;- ReaderT $ evalExp e1\n  b &lt;- ReaderT $ evalExp e2 -- this is a nice example to use ReaderT\n  return $ a - b\n\n-- this is ugly unless we need that param wrapped quite often:\nevalExpM :: Exp -&gt; ReaderT (Map.Map String Int) Maybe Int\nevalExpM exp = ReaderT $ evalExp exp\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 36523177, "answer_count": 2, "score": 2, "last_activity_date": 1460243413, "creation_date": 1460234919, "last_edit_date": 1460235692, "question_id": 36522521, "link": "https://stackoverflow.com/questions/36522521/haskell-simple-evaluator-of-expressions-with-monad-reader", "title": "Haskell, simple evaluator of expressions with monad Reader", "body": "<p>I did write some working evaluator of expressions. However, sometimes I get exception: </p>\n\n<pre><code>*** Exception: Maybe.fromJust: Nothing\n</code></pre>\n\n<p>I know from what it is. However, I can't really solve it. My aim is return in such case <code>Nothing</code>.</p>\n\n<p>Could you help me with it?</p>\n\n<pre><code>type Var = String\n\ndata Exp = EInt Int\n     | EOp  Op Exp Exp\n     | EVar Var\n     | ELet Var Exp Exp  -- let var = e1 in e2\n\ndata Op = OpAdd | OpMul | OpSub\n\nevalExpM :: Exp -&gt; Reader (Map.Map String Int) (Maybe Int)\nevalExpM (EInt n) = return $ Just n\nevalExpM (EVar var) = ask &gt;&gt;= (\\x -&gt; return ( Map.lookup var x))\nevalExpM (EOp OpAdd e1 e2) = ask &gt;&gt;= (\\x -&gt; return (Just ((fromJust (runReader (evalExpM e1) x)) + (fromJust (runReader (evalExpM e2) x )))))\n\nevalExpM (EOp OpMul e1 e2) = ask &gt;&gt;= (\\x -&gt; return (Just ((fromJust (runReader (evalExpM e1) x)) * (fromJust (runReader (evalExpM e2) x )))))\n\nevalExpM (EOp OpSub e1 e2) = ask &gt;&gt;= (\\x -&gt; return (Just ((fromJust (runReader (evalExpM e1) x)) - (fromJust (runReader (evalExpM e2) x )))))\n\nevalExpM (ELet var e1 e2) = ask &gt;&gt;= (\\x -&gt; (local (Map.insert var (fromJust (runReader (evalExpM e1) x))) (evalExpM e2)) &gt;&gt;= (\\y -&gt; return y))\n\nevalExp :: Exp -&gt; Int\nevalExp exp = fromJust $ runReader (evalExpM exp) Map.empty\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460234153, "post_id": 36522060, "comment_id": 60649599, "body": "You don&#39;t need to define <code>iEqual</code>; <code>[a]</code> is already an instance of <code>Eq</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460234481, "post_id": 36522060, "comment_id": 60649708, "body": "@chepner This might be, I guess, an exercise/homework/whatever which includes &quot;define your own <code>iEqual</code>&quot; or &quot;reuse what we have done in class&quot;."}, {"owner": {"reputation": 33, "user_id": 5619403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0b8b137909fc961a090a412a85733a88?s=128&d=identicon&r=PG&f=1", "display_name": "deathskiller", "link": "https://stackoverflow.com/users/5619403/deathskiller"}, "edited": false, "score": 0, "creation_date": 1460234567, "post_id": 36522060, "comment_id": 60649735, "body": "yes we just have to finish the function given iEqual :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Bool"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5619403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0b8b137909fc961a090a412a85733a88?s=128&d=identicon&r=PG&f=1", "display_name": "deathskiller", "link": "https://stackoverflow.com/users/5619403/deathskiller"}, "edited": false, "score": 0, "creation_date": 1460234053, "post_id": 36522291, "comment_id": 60649568, "body": "I should have been more clear, i am given an input iEqual [4,4,3] [3,4,4] and i need to show that they are equal (True). I am given iEqual :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Bool and i have to continue from there. and im not allowed to import libraries."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 33, "user_id": 5619403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0b8b137909fc961a090a412a85733a88?s=128&d=identicon&r=PG&f=1", "display_name": "deathskiller", "link": "https://stackoverflow.com/users/5619403/deathskiller"}, "edited": false, "score": 1, "creation_date": 1460234902, "post_id": 36522291, "comment_id": 60649843, "body": "I don&#39;t care what you&#39;re \u201callowed\u201d to do, this is not HomeworkOverflow. \u2013 Just convert both lists to a <code>Multiset</code>, with <code>fromList</code>, and compare the results with <code>==</code>. If you then feel you need to fulfill some stupid assignment limitations, you can replace <code>fromList</code> with <code>allSort</code> and <code>==</code> with <code>iEqual</code>, but it&#39;s silly."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 5, "last_activity_date": 1460235169, "last_edit_date": 1460235169, "creation_date": 1460233639, "answer_id": 36522291, "question_id": 36522060, "link": "https://stackoverflow.com/questions/36522060/beginner-haskell-multiset-equality/36522291#36522291", "title": "Beginner Haskell multiset equality", "body": "<p>First, declare those multisets as a proper distinct type:</p>\n\n<pre><code>newtype Multiset a = Multiset { getOrderedList :: [a] }\n</code></pre>\n\n<p>You want to be able to generate such sets from any list, but guarantee it's always ordered. Well,</p>\n\n<pre><code>fromList :: Ord a =&gt; [a] -&gt; Multiset a\nfromList = Multiset . sort\n</code></pre>\n\n<p>(Of course you can also use your custom sort function, but <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v:sort\" rel=\"nofollow\">the standard one</a> will be more efficient.)</p>\n\n<p>Now, two multisets are equal iff they are equal as ordered lists. That's convenent, because we've ensured that the list in the <code>Multiset</code> constructor <em>is</em> always ordered! So we can just do</p>\n\n<pre><code>instance  (Eq a) =&gt; Eq (Multiset a) where\n  Multiset s == Multiset t = s == t\n</code></pre>\n\n<p>(Again, you can also use <code>iEqual s t</code> here, but the standard equality <code>==</code> is just fine.)</p>\n\n<p>Note that this <code>Eq</code> instance can also be generated automatically, if you just write</p>\n\n<pre><code>newtype Multiset a = Multiset { getOrderedList :: [a] }\n      deriving (Eq)\n</code></pre>\n\n<p>(You can also derive other useful classes, I'd suggest <code>Show</code>, <code>Generic</code> and <code>Functor</code>.)</p>\n\n<pre><code>Prelude&gt; newtype Multiset a = Multiset { getOrderedList :: [a] } deriving (Eq)\nPrelude&gt; :m +Data.List\nPrelude Data.List&gt; let fromList = Multiset . sort\nPrelude Data.List&gt; fromList [4,4,3] == fromList [3,4,4]\nTrue\nPrelude Data.List&gt; fromList [4,4,3] == fromList [3,4,5]\nFalse\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1460234817, "creation_date": 1460234817, "answer_id": 36522510, "question_id": 36522060, "link": "https://stackoverflow.com/questions/36522060/beginner-haskell-multiset-equality/36522510#36522510", "title": "Beginner Haskell multiset equality", "body": "<p>Since this looks as homework, I'll give a hint, only.</p>\n\n<p>Suppose we want to compare strings in a case-insensitive way. We are given two functions. The first one is <code>sameString</code> which checks if two strings are equal</p>\n\n<pre><code>sameString :: String -&gt; String -&gt; Bool\nsameString = (==)\n</code></pre>\n\n<p>The other one converts a string to lowercase:</p>\n\n<pre><code>lowerString :: String -&gt; String\nlowerString = map toLower\n</code></pre>\n\n<p>We can now combine them as follows:</p>\n\n<pre><code>caseInsensitiveMatch :: String -&gt; String -&gt; Bool\ncaseInsensitiveMatch s1 s2 = sameString (lowerString s1) (lowerString s2)\n</code></pre>\n\n<p>(OK, this is a big hint... ;-))</p>\n"}], "owner": {"reputation": 33, "user_id": 5619403, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0b8b137909fc961a090a412a85733a88?s=128&d=identicon&r=PG&f=1", "display_name": "deathskiller", "link": "https://stackoverflow.com/users/5619403/deathskiller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1460237411, "creation_date": 1460232372, "last_edit_date": 1460237411, "question_id": 36522060, "link": "https://stackoverflow.com/questions/36522060/beginner-haskell-multiset-equality", "title": "Beginner Haskell multiset equality", "body": "<p>I am making a function two check if two unordered multisets are equal. </p>\n\n<p>I have a sorting function:</p>\n\n<pre><code>allsort :: (Ord a) =&gt; [a] -&gt; [a]  \nallsort [] = []  \nallsort (x:xs) =   \n    let smallerSorted = allsort [a | a &lt;- xs, a &lt;= x]  \n        biggerSorted = allsort [a | a &lt;- xs, a &gt; x]  \n    in  smallerSorted ++ [x] ++ biggerSorted  \n</code></pre>\n\n<p>and a equality check function:</p>\n\n<pre><code>iEqual :: (Eq a) =&gt; [a] -&gt; [a] -&gt; Bool\niEqual [] [] = True \niEqual (x:xs) (y:ys) = x == y &amp;&amp; iEqual xs ys\niEqual _ _ = False\n</code></pre>\n\n<p>i just dont know how to combine them into one function or call allsort within iEqual...</p>\n\n<p>Then another idea is to check length and if x is subset of y.</p>\n\n<p>EDIT: I solved it, just compared lengths and then if they are subsets of eachother and it works. Thank you all..</p>\n"}]